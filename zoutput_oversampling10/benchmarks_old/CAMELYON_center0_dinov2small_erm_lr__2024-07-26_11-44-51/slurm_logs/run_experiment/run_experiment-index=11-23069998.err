Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 11:47:23 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/11.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=11
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_05_seed_0_23069998

 Experiment start at: 2024-07-26 11:58:05.866258
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9920384, 'precision': 0.9896674, 'recall': 0.9895372, 'specificity': 0.9895372, 'f1': 0.98960227, 'auroc': 0.9988053, 'binary_precision': 0.9847702, 'binary_recall': 0.9843686, 'binary_specificity': 0.99470574, 'binary_f1_score': 0.9845693}
confusion matrix:
       0      1
0  42086    224
1    230  14484
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.954023, 'precision': 0.6932415, 'recall': 0.8186854, 'specificity': 0.8186854, 'f1': 0.7382401, 'auroc': 0.93208325, 'binary_precision': 0.39834407, 'binary_recall': 0.6734059, 'binary_specificity': 0.96396494, 'binary_f1_score': 0.50057805}
confusion matrix:
       0    1
0  17495  654
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93160754, 'precision': 0.6633246, 'recall': 0.81406415, 'specificity': 0.81406415, 'f1': 0.70949155, 'auroc': 0.8955896, 'binary_precision': 0.34095237, 'binary_recall': 0.68582374, 'binary_specificity': 0.9423045, 'binary_f1_score': 0.45547074}
confusion matrix:
      0    1
0  5651  346
1    82  179
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 12:19:50.399583,epoch time: 0:21:44.533325,used: 0:21:44.533325,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_05_seed_0_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9945812, 'precision': 0.99453425, 'recall': 0.99129355, 'specificity': 0.99129355, 'f1': 0.9928999, 'auroc': 0.99931246, 'binary_precision': 0.99443835, 'binary_recall': 0.9845014, 'binary_specificity': 0.9980857, 'binary_f1_score': 0.9894449}
confusion matrix:
       0      1
0  42232     81
1    228  14483
---- Validation: 
scalar performance:
{'acc': 0.96466583, 'precision': 0.7321614, 'recall': 0.7251881, 'specificity': 0.7251881, 'f1': 0.7286152, 'auroc': 0.9298161, 'binary_precision': 0.48314607, 'binary_recall': 0.4681182, 'binary_specificity': 0.98225796, 'binary_f1_score': 0.47551343}
confusion matrix:
       0    1
0  17827  322
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93847877, 'precision': 0.6213199, 'recall': 0.6270865, 'specificity': 0.6270865, 'f1': 0.6241198, 'auroc': 0.85165346, 'binary_precision': 0.27372262, 'binary_recall': 0.28735632, 'binary_specificity': 0.9668167, 'binary_f1_score': 0.28037384}
confusion matrix:
      0    1
0  5798  199
1   186   75
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 12:41:31.495964,epoch time: 0:21:41.096381,used: 0:43:25.629706,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_05_seed_0_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9952301, 'precision': 0.99569035, 'recall': 0.9918416, 'specificity': 0.9918416, 'f1': 0.99374634, 'auroc': 0.99954104, 'binary_precision': 0.9966293, 'binary_recall': 0.9848413, 'binary_specificity': 0.99884194, 'binary_f1_score': 0.9907002}
confusion matrix:
       0      1
0  42264     49
1    223  14488
---- Validation: 
scalar performance:
{'acc': 0.9646126, 'precision': 0.7272376, 'recall': 0.6711566, 'specificity': 0.6711566, 'f1': 0.6947987, 'auroc': 0.93067974, 'binary_precision': 0.47708333, 'binary_recall': 0.3561431, 'binary_specificity': 0.98617005, 'binary_f1_score': 0.40783614}
confusion matrix:
       0    1
0  17898  251
1    414  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9154682, 'precision': 0.61499554, 'recall': 0.7268529, 'specificity': 0.7268529, 'f1': 0.6472099, 'auroc': 0.8614849, 'binary_precision': 0.25185186, 'binary_recall': 0.5210728, 'binary_specificity': 0.932633, 'binary_f1_score': 0.33957553}
confusion matrix:
      0    1
0  5593  404
1   125  136
early stop counter: 1
val acc:0.964612603187561, best validation acc: 0.9646658301353455, corresponding to test acc:                         0.9384787678718567 / 0.9384787678718567
after epoch: 3,now: 2024-07-26 13:02:33.063531,epoch time: 0:21:01.567567,used: 1:04:27.197273,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_05_seed_0_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9961595, 'precision': 0.99706095, 'recall': 0.99291134, 'specificity': 0.99291134, 'f1': 0.9949634, 'auroc': 0.9996554, 'binary_precision': 0.9988984, 'binary_recall': 0.9862008, 'binary_specificity': 0.99962187, 'binary_f1_score': 0.992509}
confusion matrix:
       0      1
0  42297     16
1    203  14508
---- Validation: 
scalar performance:
{'acc': 0.97083867, 'precision': 0.7835721, 'recall': 0.7493854, 'specificity': 0.7493854, 'f1': 0.7652706, 'auroc': 0.9481248, 'binary_precision': 0.5843694, 'binary_recall': 0.5116641, 'binary_specificity': 0.98710674, 'binary_f1_score': 0.5456053}
confusion matrix:
       0    1
0  17915  234
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.70019954, 'recall': 0.5795388, 'specificity': 0.5795388, 'f1': 0.610275, 'auroc': 0.89757335, 'binary_precision': 0.43564355, 'binary_recall': 0.16858238, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.24309392}
confusion matrix:
      0   1
0  5940  57
1   217  44
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 13:23:21.012625,epoch time: 0:20:47.949094,used: 1:25:15.146367,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_05_seed_0_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99647516, 'precision': 0.99664295, 'recall': 0.9941457, 'specificity': 0.9941457, 'f1': 0.99538606, 'auroc': 0.999582, 'binary_precision': 0.9969869, 'binary_recall': 0.98933136, 'binary_specificity': 0.99896, 'binary_f1_score': 0.99314433}
confusion matrix:
       0      1
0  42264     44
1    157  14559
---- Validation: 
scalar performance:
{'acc': 0.96929544, 'precision': 0.77439, 'recall': 0.7058333, 'specificity': 0.7058333, 'f1': 0.73472834, 'auroc': 0.9396586, 'binary_precision': 0.5690377, 'binary_recall': 0.4230171, 'binary_specificity': 0.9886495, 'binary_f1_score': 0.485281}
confusion matrix:
       0    1
0  17943  206
1    371  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9509428, 'precision': 0.6375662, 'recall': 0.5657934, 'specificity': 0.5657934, 'f1': 0.58656526, 'auroc': 0.88331074, 'binary_precision': 0.3114754, 'binary_recall': 0.14559387, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.19843341}
confusion matrix:
      0   1
0  5913  84
1   223  38
early stop counter: 1
val acc:0.9692954421043396, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.956216037273407 / 0.956216037273407
after epoch: 5,now: 2024-07-26 13:45:01.625787,epoch time: 0:21:40.613162,used: 1:46:55.759529,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_05_seed_0_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9970714, 'precision': 0.9979209, 'recall': 0.9944359, 'specificity': 0.9944359, 'f1': 0.9961624, 'auroc': 0.9998261, 'binary_precision': 0.9996565, 'binary_recall': 0.98899007, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.9942947}
confusion matrix:
       0      1
0  42305      5
1    162  14552
---- Validation: 
scalar performance:
{'acc': 0.97004044, 'precision': 0.7790756, 'recall': 0.72722054, 'specificity': 0.72722054, 'f1': 0.75022453, 'auroc': 0.9550066, 'binary_precision': 0.5769231, 'binary_recall': 0.466563, 'binary_specificity': 0.98787814, 'binary_f1_score': 0.5159071}
confusion matrix:
       0    1
0  17929  220
1    343  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9488655, 'precision': 0.62894636, 'recall': 0.5720389, 'specificity': 0.5720389, 'f1': 0.59075034, 'auroc': 0.89039636, 'binary_precision': 0.2937063, 'binary_recall': 0.16091955, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.2079208}
confusion matrix:
      0    1
0  5896  101
1   219   42
early stop counter: 2
val acc:0.9700404405593872, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.956216037273407 / 0.956216037273407
after epoch: 6,now: 2024-07-26 14:05:47.675754,epoch time: 0:20:46.049967,used: 2:07:41.809496,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_05_seed_0_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9973695, 'precision': 0.99749196, 'recall': 0.9956322, 'specificity': 0.9956322, 'f1': 0.9965575, 'auroc': 0.9997295, 'binary_precision': 0.9977431, 'binary_recall': 0.9920441, 'binary_specificity': 0.9992202, 'binary_f1_score': 0.99488544}
confusion matrix:
       0      1
0  42285     33
1    117  14589
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.79350543, 'recall': 0.66416085, 'specificity': 0.66416085, 'f1': 0.70892864, 'auroc': 0.94790655, 'binary_precision': 0.6101695, 'binary_recall': 0.33592534, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.4332999}
confusion matrix:
       0    1
0  18011  138
1    427  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9493448, 'precision': 0.5633301, 'recall': 0.5209837, 'specificity': 0.5209837, 'f1': 0.52755696, 'auroc': 0.8763116, 'binary_precision': 0.16666667, 'binary_recall': 0.053639848, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.08115942}
confusion matrix:
      0   1
0  5927  70
1   247  14
early stop counter: 3
val acc:0.9699339866638184, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.956216037273407 / 0.956216037273407
after epoch: 7,now: 2024-07-26 14:42:40.591291,epoch time: 0:36:52.915537,used: 2:44:34.725033,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_05_seed_0_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9950547, 'precision': 0.99188846, 'recall': 0.9952711, 'specificity': 0.9952711, 'f1': 0.9935643, 'auroc': 0.999738, 'binary_precision': 0.9852714, 'binary_recall': 0.99571806, 'binary_specificity': 0.99482405, 'binary_f1_score': 0.9904672}
confusion matrix:
       0      1
0  42092    219
1     63  14650
---- Validation: 
scalar performance:
{'acc': 0.9654108, 'precision': 0.7323514, 'recall': 0.63031673, 'specificity': 0.63031673, 'f1': 0.66546553, 'auroc': 0.93651736, 'binary_precision': 0.49014086, 'binary_recall': 0.27060652, 'binary_specificity': 0.990027, 'binary_f1_score': 0.3486974}
confusion matrix:
       0    1
0  17968  181
1    469  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9511026, 'precision': 0.61494905, 'recall': 0.5438888, 'specificity': 0.5438888, 'f1': 0.56004137, 'auroc': 0.90724224, 'binary_precision': 0.26804122, 'binary_recall': 0.099616855, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.1452514}
confusion matrix:
      0   1
0  5926  71
1   235  26
early stop counter: 4
val acc:0.9654108285903931, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.956216037273407 / 0.956216037273407
after epoch: 8,now: 2024-07-26 15:09:59.645961,epoch time: 0:27:19.054670,used: 3:11:53.779703,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_05_seed_0_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9956685, 'precision': 0.99709815, 'recall': 0.9916055, 'specificity': 0.9916055, 'f1': 0.99431205, 'auroc': 0.99978447, 'binary_precision': 1.0, 'binary_recall': 0.983211, 'binary_specificity': 1.0, 'binary_f1_score': 0.9915344}
confusion matrix:
       0      1
0  42312      0
1    247  14465
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.85857856, 'recall': 0.52074736, 'specificity': 0.52074736, 'f1': 0.5312967, 'auroc': 0.95401907, 'binary_precision': 0.75, 'binary_recall': 0.041990668, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.07952872}
confusion matrix:
       0   1
0  18140   9
1    616  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.93870944, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
new oracle model saved
early stop counter: 5
val acc:0.966741144657135, best validation acc: 0.9708386659622192, corresponding to test acc:                         0.956216037273407 / 0.9582933783531189
after epoch: 9,now: 2024-07-26 15:32:09.039793,epoch time: 0:22:09.393832,used: 3:34:03.173535,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_05_seed_0_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 3:34:03.173535 at 2024-07-26 15:32:09.039793
persisted model performance metric: 

scalar performance:
{'acc': 0.95621604, 'precision': 0.70019954, 'recall': 0.5795388, 'specificity': 0.5795388, 'f1': 0.610275, 'auroc': 0.89757335, 'binary_precision': 0.43564355, 'binary_recall': 0.16858238, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.24309392}
confusion matrix:
      0   1
0  5940  57
1   217  44
oracle model performance metric: 

scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.93870944, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/11.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 452684 KiB |   6932 MiB | 329355 GiB | 329354 GiB |
|       from large pool | 411879 KiB |   6897 MiB | 328190 GiB | 328189 GiB |
|       from small pool |  40805 KiB |     56 MiB |   1165 GiB |   1165 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 452684 KiB |   6932 MiB | 329355 GiB | 329354 GiB |
|       from large pool | 411879 KiB |   6897 MiB | 328190 GiB | 328189 GiB |
|       from small pool |  40805 KiB |     56 MiB |   1165 GiB |   1165 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   6928 MiB | 329332 GiB | 329332 GiB |
|       from large pool | 407075 KiB |   6894 MiB | 328168 GiB | 328168 GiB |
|       from small pool |  40679 KiB |     56 MiB |   1163 GiB |   1163 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7286 MiB |   7286 MiB |   7286 MiB |      0 B   |
|       from large pool |   7222 MiB |   7222 MiB |   7222 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 599987 KiB |    845 MiB | 147685 GiB | 147684 GiB |
|       from large pool | 591641 KiB |    840 MiB | 146476 GiB | 146476 GiB |
|       from small pool |   8346 KiB |     11 MiB |   1208 GiB |   1208 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1724    |    2767    |   16676 K  |   16674 K  |
|       from large pool |     187    |     311    |    8108 K  |    8108 K  |
|       from small pool |    1537    |    2579    |    8568 K  |    8566 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1724    |    2767    |   16676 K  |   16674 K  |
|       from large pool |     187    |     311    |    8108 K  |    8108 K  |
|       from small pool |    1537    |    2579    |    8568 K  |    8566 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     149    |     149    |     149    |       0    |
|       from large pool |     117    |     117    |     117    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      59    |     938    |    9715 K  |    9715 K  |
|       from large pool |      23    |     118    |    6236 K  |    6236 K  |
|       from small pool |      36    |     915    |    3479 K  |    3479 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6932 MiB | 329355 GiB | 329355 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 328190 GiB | 328190 GiB |
|       from small pool |      0 KiB |     56 MiB |   1165 GiB |   1165 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6932 MiB | 329355 GiB | 329355 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 328190 GiB | 328190 GiB |
|       from small pool |      0 KiB |     56 MiB |   1165 GiB |   1165 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6928 MiB | 329332 GiB | 329332 GiB |
|       from large pool |  16640 KiB |   6894 MiB | 328168 GiB | 328168 GiB |
|       from small pool |      0 KiB |     56 MiB |   1163 GiB |   1163 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1028 MiB |   7286 MiB |   7286 MiB |   6258 MiB |
|       from large pool |    980 MiB |   7222 MiB |   7222 MiB |   6242 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 147685 GiB | 147685 GiB |
|       from large pool |   3840 KiB |    840 MiB | 146476 GiB | 146476 GiB |
|       from small pool |      0 KiB |     21 MiB |   1208 GiB |   1208 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   16676 K  |   16676 K  |
|       from large pool |       2    |     311    |    8108 K  |    8108 K  |
|       from small pool |       0    |    2579    |    8568 K  |    8568 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   16676 K  |   16676 K  |
|       from large pool |       2    |     311    |    8108 K  |    8108 K  |
|       from small pool |       0    |    2579    |    8568 K  |    8568 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |     149    |     149    |      99    |
|       from large pool |      26    |     117    |     117    |      91    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     938    |    9716 K  |    9716 K  |
|       from large pool |       2    |     118    |    6236 K  |    6236 K  |
|       from small pool |       0    |     915    |    3479 K  |    3479 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6932 MiB | 329355 GiB | 329355 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 328190 GiB | 328190 GiB |
|       from small pool |      0 KiB |     56 MiB |   1165 GiB |   1165 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6932 MiB | 329355 GiB | 329355 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 328190 GiB | 328190 GiB |
|       from small pool |      0 KiB |     56 MiB |   1165 GiB |   1165 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6928 MiB | 329332 GiB | 329332 GiB |
|       from large pool |  16640 KiB |   6894 MiB | 328168 GiB | 328168 GiB |
|       from small pool |      0 KiB |     56 MiB |   1163 GiB |   1163 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1028 MiB |   7286 MiB |   7286 MiB |   6258 MiB |
|       from large pool |    980 MiB |   7222 MiB |   7222 MiB |   6242 MiB |
|       from small pool |     48 MiB |     64 MiB |     64 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 147685 GiB | 147685 GiB |
|       from large pool |   3840 KiB |    840 MiB | 146476 GiB | 146476 GiB |
|       from small pool |      0 KiB |     21 MiB |   1208 GiB |   1208 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   16676 K  |   16676 K  |
|       from large pool |       2    |     311    |    8108 K  |    8108 K  |
|       from small pool |       0    |    2579    |    8568 K  |    8568 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   16676 K  |   16676 K  |
|       from large pool |       2    |     311    |    8108 K  |    8108 K  |
|       from small pool |       0    |    2579    |    8568 K  |    8568 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |     149    |     149    |      99    |
|       from large pool |      26    |     117    |     117    |      91    |
|       from small pool |      24    |      32    |      32    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     938    |    9716 K  |    9716 K  |
|       from large pool |       2    |     118    |    6236 K  |    6236 K  |
|       from small pool |       0    |     915    |    3479 K  |    3479 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_15_40_40_seed_1_23069998

 Experiment start at: 2024-07-26 15:40:40.566130
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9920467, 'precision': 0.99188256, 'recall': 0.98707354, 'specificity': 0.98707354, 'f1': 0.98944795, 'auroc': 0.9990966, 'binary_precision': 0.9915541, 'binary_recall': 0.9769764, 'binary_specificity': 0.9971706, 'binary_f1_score': 0.98421127}
confusion matrix:
       0      1
0  42292    120
1    332  14088
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9473319, 'precision': 0.68121094, 'recall': 0.8253399, 'specificity': 0.8253399, 'f1': 0.7292242, 'auroc': 0.92933154, 'binary_precision': 0.3741987, 'binary_recall': 0.69390786, 'binary_specificity': 0.956772, 'binary_f1_score': 0.48620507}
confusion matrix:
       0    1
0  17286  781
1    206  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.7909566, 'recall': 0.8302938, 'specificity': 0.8302938, 'f1': 0.80921197, 'auroc': 0.93095875, 'binary_precision': 0.5959596, 'binary_recall': 0.6807692, 'binary_specificity': 0.97981834, 'binary_f1_score': 0.6355475}
confusion matrix:
      0    1
0  5826  120
1    83  177
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 16:04:07.031643,epoch time: 0:23:26.465513,used: 0:23:26.465513,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_15_40_40_seed_1_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99327844, 'precision': 0.99364084, 'recall': 0.98858464, 'specificity': 0.98858464, 'f1': 0.9910797, 'auroc': 0.99930114, 'binary_precision': 0.99436504, 'binary_recall': 0.9790554, 'binary_specificity': 0.9981138, 'binary_f1_score': 0.9866509}
confusion matrix:
       0      1
0  42333     80
1    302  14117
---- Validation: 
scalar performance:
{'acc': 0.97049093, 'precision': 0.8219938, 'recall': 0.67426986, 'specificity': 0.67426986, 'f1': 0.72422785, 'auroc': 0.94500434, 'binary_precision': 0.6675978, 'binary_recall': 0.3551263, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.46362758}
confusion matrix:
       0    1
0  17948  119
1    434  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.88511765, 'recall': 0.53235596, 'specificity': 0.53235596, 'f1': 0.5503177, 'auroc': 0.9213539, 'binary_precision': 0.8095238, 'binary_recall': 0.06538462, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.120996445}
confusion matrix:
      0   1
0  5942   4
1   243  17
better model found
persisted
after epoch: 2,now: 2024-07-26 16:27:04.087942,epoch time: 0:22:57.056299,used: 0:46:23.521812,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_15_40_40_seed_1_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9943694, 'precision': 0.99616015, 'recall': 0.9889951, 'specificity': 0.9889951, 'f1': 0.99251175, 'auroc': 0.9994484, 'binary_precision': 0.99971646, 'binary_recall': 0.97808444, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.98878217}
confusion matrix:
       0      1
0  42409      4
1    316  14103
---- Validation: 
scalar performance:
{'acc': 0.97139806, 'precision': 0.84215397, 'recall': 0.6704487, 'specificity': 0.6704487, 'f1': 0.725188, 'auroc': 0.9473892, 'binary_precision': 0.7082067, 'binary_recall': 0.346211, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.46506986}
confusion matrix:
       0    1
0  17971   96
1    440  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.86798745, 'recall': 0.54556525, 'specificity': 0.54556525, 'f1': 0.5724503, 'auroc': 0.905385, 'binary_precision': 0.7741935, 'binary_recall': 0.092307694, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.16494845}
confusion matrix:
      0   1
0  5939   7
1   236  24
better model found
persisted
after epoch: 3,now: 2024-07-26 16:49:04.691155,epoch time: 0:22:00.603213,used: 1:08:24.125025,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_15_40_40_seed_1_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99410546, 'precision': 0.99098134, 'recall': 0.9935104, 'specificity': 0.9935104, 'f1': 0.9922375, 'auroc': 0.9996451, 'binary_precision': 0.9845868, 'binary_recall': 0.99230236, 'binary_specificity': 0.9947185, 'binary_f1_score': 0.98842955}
confusion matrix:
       0      1
0  42188    224
1    111  14309
---- Validation: 
scalar performance:
{'acc': 0.94743866, 'precision': 0.65570235, 'recall': 0.7116678, 'specificity': 0.7116678, 'f1': 0.67865306, 'auroc': 0.8989487, 'binary_precision': 0.33189654, 'binary_recall': 0.4576523, 'binary_specificity': 0.9656833, 'binary_f1_score': 0.3847595}
confusion matrix:
       0    1
0  17447  620
1    365  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9521431, 'precision': 0.6979738, 'recall': 0.68262637, 'specificity': 0.68262637, 'f1': 0.6899395, 'auroc': 0.90310097, 'binary_precision': 0.42259413, 'binary_recall': 0.38846153, 'binary_specificity': 0.97679114, 'binary_f1_score': 0.40480962}
confusion matrix:
      0    1
0  5808  138
1   159  101
early stop counter: 1
val acc:0.947438657283783, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9608443379402161 / 0.9672897458076477
after epoch: 4,now: 2024-07-26 17:14:21.174479,epoch time: 0:25:16.483324,used: 1:33:40.608349,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_15_40_40_seed_1_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99681515, 'precision': 0.9952245, 'recall': 0.99637854, 'specificity': 0.99637854, 'f1': 0.9957998, 'auroc': 0.9998326, 'binary_precision': 0.9919834, 'binary_recall': 0.99549204, 'binary_specificity': 0.997265, 'binary_f1_score': 0.99373466}
confusion matrix:
       0      1
0  42297    116
1     65  14354
---- Validation: 
scalar performance:
{'acc': 0.9693703, 'precision': 0.7776662, 'recall': 0.789562, 'specificity': 0.789562, 'f1': 0.78347516, 'auroc': 0.9527303, 'binary_precision': 0.5704125, 'binary_recall': 0.5958395, 'binary_specificity': 0.9832844, 'binary_f1_score': 0.5828488}
confusion matrix:
       0    1
0  17765  302
1    272  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97147924, 'precision': 0.93401474, 'recall': 0.67984426, 'specificity': 0.67984426, 'f1': 0.7501881, 'auroc': 0.9388263, 'binary_precision': 0.8952381, 'binary_recall': 0.36153847, 'binary_specificity': 0.99815, 'binary_f1_score': 0.51506853}
confusion matrix:
      0   1
0  5935  11
1   166  94
new oracle model saved
early stop counter: 2
val acc:0.9693703055381775, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9608443379402161 / 0.9714792370796204
after epoch: 5,now: 2024-07-26 17:36:20.515651,epoch time: 0:21:59.341172,used: 1:55:39.949521,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_15_40_40_seed_1_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99765974, 'precision': 0.9976963, 'recall': 0.99612045, 'specificity': 0.99612045, 'f1': 0.9969052, 'auroc': 0.99982613, 'binary_precision': 0.99777, 'binary_recall': 0.9929954, 'binary_specificity': 0.9992455, 'binary_f1_score': 0.995377}
confusion matrix:
       0      1
0  42381     32
1    101  14318
---- Validation: 
scalar performance:
{'acc': 0.9711846, 'precision': 0.80410635, 'recall': 0.7382884, 'specificity': 0.7382884, 'f1': 0.7668062, 'auroc': 0.9476837, 'binary_precision': 0.6271511, 'binary_recall': 0.48736998, 'binary_specificity': 0.98920685, 'binary_f1_score': 0.548495}
confusion matrix:
       0    1
0  17872  195
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.8988037, 'recall': 0.5762504, 'specificity': 0.5762504, 'f1': 0.62045175, 'auroc': 0.9403586, 'binary_precision': 0.8333333, 'binary_recall': 0.15384616, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.2597403}
confusion matrix:
      0   1
0  5938   8
1   220  40
early stop counter: 3
val acc:0.9711846113204956, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9608443379402161 / 0.9714792370796204
after epoch: 6,now: 2024-07-26 17:59:53.413670,epoch time: 0:23:32.898019,used: 2:19:12.847540,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_15_40_40_seed_1_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99783576, 'precision': 0.9976999, 'recall': 0.9965817, 'specificity': 0.9965817, 'f1': 0.9971392, 'auroc': 0.99987626, 'binary_precision': 0.9974252, 'binary_recall': 0.99403566, 'binary_specificity': 0.9991276, 'binary_f1_score': 0.9957276}
confusion matrix:
       0      1
0  42376     37
1     86  14333
---- Validation: 
scalar performance:
{'acc': 0.97139806, 'precision': 0.836447, 'recall': 0.6776014, 'specificity': 0.6776014, 'f1': 0.73041815, 'auroc': 0.95268613, 'binary_precision': 0.69627506, 'binary_recall': 0.36106983, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.47553816}
confusion matrix:
       0    1
0  17961  106
1    430  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.8749373, 'recall': 0.5285098, 'specificity': 0.5285098, 'f1': 0.54350215, 'auroc': 0.9244914, 'binary_precision': 0.7894737, 'binary_recall': 0.057692308, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.10752688}
confusion matrix:
      0   1
0  5942   4
1   245  15
early stop counter: 4
val acc:0.9713980555534363, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9608443379402161 / 0.9714792370796204
after epoch: 7,now: 2024-07-26 18:23:25.427226,epoch time: 0:23:32.013556,used: 2:42:44.861096,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_15_40_40_seed_1_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99792373, 'precision': 0.99824184, 'recall': 0.9962746, 'specificity': 0.9962746, 'f1': 0.99725324, 'auroc': 0.99991465, 'binary_precision': 0.9988838, 'binary_recall': 0.9929265, 'binary_specificity': 0.99962276, 'binary_f1_score': 0.99589616}
confusion matrix:
       0      1
0  42396     16
1    102  14318
---- Validation: 
scalar performance:
{'acc': 0.9655283, 'precision': 0.75487685, 'recall': 0.647377, 'specificity': 0.647377, 'f1': 0.685261, 'auroc': 0.93739104, 'binary_precision': 0.53524804, 'binary_recall': 0.30460623, 'binary_specificity': 0.99014777, 'binary_f1_score': 0.3882576}
confusion matrix:
       0    1
0  17889  178
1    468  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95246536, 'precision': 0.641051, 'recall': 0.55406547, 'specificity': 0.55406547, 'f1': 0.57459915, 'auroc': 0.8987775, 'binary_precision': 0.31958762, 'binary_recall': 0.11923077, 'binary_specificity': 0.9889001, 'binary_f1_score': 0.17366947}
confusion matrix:
      0   1
0  5880  66
1   229  31
early stop counter: 5
val acc:0.9655283093452454, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9608443379402161 / 0.9714792370796204
after epoch: 8,now: 2024-07-26 18:46:49.509623,epoch time: 0:23:24.082397,used: 3:06:08.943493,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_15_40_40_seed_1_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 3:06:08.943493 at 2024-07-26 18:46:49.509623
persisted model performance metric: 

scalar performance:
{'acc': 0.96084434, 'precision': 0.86798745, 'recall': 0.54556525, 'specificity': 0.54556525, 'f1': 0.5724503, 'auroc': 0.905385, 'binary_precision': 0.7741935, 'binary_recall': 0.092307694, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.16494845}
confusion matrix:
      0   1
0  5939   7
1   236  24
oracle model performance metric: 

scalar performance:
{'acc': 0.97147924, 'precision': 0.93401474, 'recall': 0.67984426, 'specificity': 0.67984426, 'f1': 0.7501881, 'auroc': 0.9388263, 'binary_precision': 0.8952381, 'binary_recall': 0.36153847, 'binary_specificity': 0.99815, 'binary_f1_score': 0.51506853}
confusion matrix:
      0   1
0  5935  11
1   166  94
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 449893 KiB |   6932 MiB | 621466 GiB | 621466 GiB |
|       from large pool | 409091 KiB |   6897 MiB | 619267 GiB | 619267 GiB |
|       from small pool |  40802 KiB |     56 MiB |   2198 GiB |   2198 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 449893 KiB |   6932 MiB | 621466 GiB | 621466 GiB |
|       from large pool | 409091 KiB |   6897 MiB | 619267 GiB | 619267 GiB |
|       from small pool |  40802 KiB |     56 MiB |   2198 GiB |   2198 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   6928 MiB | 621358 GiB | 621357 GiB |
|       from large pool | 407075 KiB |   6894 MiB | 619162 GiB | 619162 GiB |
|       from small pool |  40676 KiB |     56 MiB |   2195 GiB |   2195 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7268 MiB |   7286 MiB |  13526 MiB |   6258 MiB |
|       from large pool |   7204 MiB |   7222 MiB |  13446 MiB |   6242 MiB |
|       from small pool |     64 MiB |     64 MiB |     80 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 711322 KiB |    845 MiB | 282369 GiB | 282368 GiB |
|       from large pool | 700925 KiB |    840 MiB | 280090 GiB | 280090 GiB |
|       from small pool |  10397 KiB |     21 MiB |   2278 GiB |   2278 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1718    |    2767    |   31462 K  |   31461 K  |
|       from large pool |     187    |     311    |   15297 K  |   15297 K  |
|       from small pool |    1531    |    2579    |   16165 K  |   16163 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1718    |    2767    |   31462 K  |   31461 K  |
|       from large pool |     187    |     311    |   15297 K  |   15297 K  |
|       from small pool |    1531    |    2579    |   16165 K  |   16163 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     146    |     149    |     245    |      99    |
|       from large pool |     114    |     117    |     205    |      91    |
|       from small pool |      32    |      32    |      40    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |     943    |   18293 K  |   18293 K  |
|       from large pool |      31    |     118    |   11740 K  |   11740 K  |
|       from small pool |      37    |     915    |    6552 K  |    6552 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6932 MiB | 621466 GiB | 621466 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 619267 GiB | 619267 GiB |
|       from small pool |      0 KiB |     56 MiB |   2198 GiB |   2198 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6932 MiB | 621466 GiB | 621466 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 619267 GiB | 619267 GiB |
|       from small pool |      0 KiB |     56 MiB |   2198 GiB |   2198 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6928 MiB | 621358 GiB | 621358 GiB |
|       from large pool |  16640 KiB |   6894 MiB | 619162 GiB | 619162 GiB |
|       from small pool |      0 KiB |     56 MiB |   2195 GiB |   2195 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1134 MiB |   7286 MiB |  13526 MiB |  12392 MiB |
|       from large pool |   1084 MiB |   7222 MiB |  13446 MiB |  12362 MiB |
|       from small pool |     50 MiB |     64 MiB |     80 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 282369 GiB | 282369 GiB |
|       from large pool |   3840 KiB |    840 MiB | 280091 GiB | 280091 GiB |
|       from small pool |      0 KiB |     26 MiB |   2278 GiB |   2278 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   31462 K  |   31462 K  |
|       from large pool |       2    |     311    |   15297 K  |   15297 K  |
|       from small pool |       0    |    2579    |   16165 K  |   16165 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   31462 K  |   31462 K  |
|       from large pool |       2    |     311    |   15297 K  |   15297 K  |
|       from small pool |       0    |    2579    |   16165 K  |   16165 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     149    |     245    |     190    |
|       from large pool |      30    |     117    |     205    |     175    |
|       from small pool |      25    |      32    |      40    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     943    |   18293 K  |   18293 K  |
|       from large pool |       2    |     118    |   11740 K  |   11740 K  |
|       from small pool |       0    |     915    |    6552 K  |    6552 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6932 MiB | 621466 GiB | 621466 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 619267 GiB | 619267 GiB |
|       from small pool |      0 KiB |     56 MiB |   2198 GiB |   2198 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6932 MiB | 621466 GiB | 621466 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 619267 GiB | 619267 GiB |
|       from small pool |      0 KiB |     56 MiB |   2198 GiB |   2198 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6928 MiB | 621358 GiB | 621358 GiB |
|       from large pool |  16640 KiB |   6894 MiB | 619162 GiB | 619162 GiB |
|       from small pool |      0 KiB |     56 MiB |   2195 GiB |   2195 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1134 MiB |   7286 MiB |  13526 MiB |  12392 MiB |
|       from large pool |   1084 MiB |   7222 MiB |  13446 MiB |  12362 MiB |
|       from small pool |     50 MiB |     64 MiB |     80 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 282369 GiB | 282369 GiB |
|       from large pool |   3840 KiB |    840 MiB | 280091 GiB | 280091 GiB |
|       from small pool |      0 KiB |     26 MiB |   2278 GiB |   2278 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   31462 K  |   31462 K  |
|       from large pool |       2    |     311    |   15297 K  |   15297 K  |
|       from small pool |       0    |    2579    |   16165 K  |   16165 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   31462 K  |   31462 K  |
|       from large pool |       2    |     311    |   15297 K  |   15297 K  |
|       from small pool |       0    |    2579    |   16165 K  |   16165 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     149    |     245    |     190    |
|       from large pool |      30    |     117    |     205    |     175    |
|       from small pool |      25    |      32    |      40    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     943    |   18293 K  |   18293 K  |
|       from large pool |       2    |     118    |   11740 K  |   11740 K  |
|       from small pool |       0    |     915    |    6552 K  |    6552 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_55_53_seed_2_23069998

 Experiment start at: 2024-07-26 18:55:53.800811
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9926317, 'precision': 0.9915508, 'recall': 0.9894345, 'specificity': 0.9894345, 'f1': 0.99048644, 'auroc': 0.9990433, 'binary_precision': 0.9892831, 'binary_recall': 0.98267657, 'binary_specificity': 0.9961924, 'binary_f1_score': 0.9859688}
confusion matrix:
       0      1
0  42123    161
1    262  14862
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.95408297, 'precision': 0.68032587, 'recall': 0.79961026, 'specificity': 0.79961026, 'f1': 0.7229334, 'auroc': 0.9163008, 'binary_precision': 0.37304688, 'binary_recall': 0.63455147, 'binary_specificity': 0.964669, 'binary_f1_score': 0.46986467}
confusion matrix:
       0    1
0  17529  642
1    220  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92867446, 'precision': 0.6068022, 'recall': 0.66746974, 'specificity': 0.66746974, 'f1': 0.628604, 'auroc': 0.83339244, 'binary_precision': 0.23907454, 'binary_recall': 0.38429752, 'binary_specificity': 0.950642, 'binary_f1_score': 0.29477018}
confusion matrix:
      0    1
0  5701  296
1   149   93
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 19:18:38.604042,epoch time: 0:22:44.803231,used: 0:22:44.803231,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_55_53_seed_2_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9951749, 'precision': 0.99626255, 'recall': 0.9913074, 'specificity': 0.9913074, 'f1': 0.9937513, 'auroc': 0.99970984, 'binary_precision': 0.9985222, 'binary_recall': 0.9831349, 'binary_specificity': 0.9994798, 'binary_f1_score': 0.99076885}
confusion matrix:
       0      1
0  42266     22
1    255  14865
---- Validation: 
scalar performance:
{'acc': 0.96660095, 'precision': 0.71475655, 'recall': 0.6012992, 'specificity': 0.6012992, 'f1': 0.635604, 'auroc': 0.9045603, 'binary_precision': 0.45519713, 'binary_recall': 0.21096346, 'binary_specificity': 0.991635, 'binary_f1_score': 0.28830874}
confusion matrix:
       0    1
0  18019  152
1    475  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9472672, 'precision': 0.54556286, 'recall': 0.5224875, 'specificity': 0.5224875, 'f1': 0.52820903, 'auroc': 0.7816868, 'binary_precision': 0.12820514, 'binary_recall': 0.06198347, 'binary_specificity': 0.9829915, 'binary_f1_score': 0.083565466}
confusion matrix:
      0    1
0  5895  102
1   227   15
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 19:40:23.973309,epoch time: 0:21:45.369267,used: 0:44:30.172498,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_55_53_seed_2_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9967426, 'precision': 0.99708426, 'recall': 0.9945169, 'specificity': 0.9945169, 'f1': 0.99579155, 'auroc': 0.9998142, 'binary_precision': 0.9977997, 'binary_recall': 0.98981416, 'binary_specificity': 0.99921966, 'binary_f1_score': 0.99379086}
confusion matrix:
       0      1
0  42256     33
1    154  14965
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.7542871, 'recall': 0.5718015, 'specificity': 0.5718015, 'f1': 0.6078643, 'auroc': 0.91708016, 'binary_precision': 0.53614455, 'binary_recall': 0.14784053, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.23177083}
confusion matrix:
       0   1
0  18094  77
1    513  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480686, 'precision': 0.4863748, 'recall': 0.49514598, 'specificity': 0.49514598, 'f1': 0.48973635, 'auroc': 0.79684865, 'binary_precision': 0.011904762, 'binary_recall': 0.004132231, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.006134969}
confusion matrix:
      0   1
0  5914  83
1   241   1
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 20:03:14.938064,epoch time: 0:22:50.964755,used: 1:07:21.137253,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_55_53_seed_2_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99658585, 'precision': 0.99623173, 'recall': 0.9949647, 'specificity': 0.9949647, 'f1': 0.99559605, 'auroc': 0.9997316, 'binary_precision': 0.9954865, 'binary_recall': 0.99153775, 'binary_specificity': 0.99839175, 'binary_f1_score': 0.99350816}
confusion matrix:
       0      1
0  42214     68
1    128  14998
---- Validation: 
scalar performance:
{'acc': 0.9680925, 'precision': 0.7412996, 'recall': 0.6767532, 'specificity': 0.6767532, 'f1': 0.7035382, 'auroc': 0.91089934, 'binary_precision': 0.5034325, 'binary_recall': 0.3654485, 'binary_specificity': 0.9880579, 'binary_f1_score': 0.42348415}
confusion matrix:
       0    1
0  17954  217
1    382  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95095366, 'precision': 0.56131697, 'recall': 0.5244051, 'specificity': 0.5244051, 'f1': 0.53204197, 'auroc': 0.8359929, 'binary_precision': 0.15957446, 'binary_recall': 0.06198347, 'binary_specificity': 0.9868267, 'binary_f1_score': 0.08928572}
confusion matrix:
      0   1
0  5918  79
1   227  15
new oracle model saved
early stop counter: 1
val acc:0.9680925011634827, best validation acc: 0.9685719013214111, corresponding to test acc:                         0.9480686187744141 / 0.9509536623954773
after epoch: 4,now: 2024-07-26 20:25:24.776438,epoch time: 0:22:09.838374,used: 1:29:30.975627,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_55_53_seed_2_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9977878, 'precision': 0.99760306, 'recall': 0.99669236, 'specificity': 0.99669236, 'f1': 0.9971466, 'auroc': 0.99980783, 'binary_precision': 0.99721414, 'binary_recall': 0.9943779, 'binary_specificity': 0.9990068, 'binary_f1_score': 0.995794}
confusion matrix:
       0      1
0  42247     42
1     85  15034
---- Validation: 
scalar performance:
{'acc': 0.9728866, 'precision': 0.8193321, 'recall': 0.65594125, 'specificity': 0.65594125, 'f1': 0.70742273, 'auroc': 0.9308165, 'binary_precision': 0.66089964, 'binary_recall': 0.31727573, 'binary_specificity': 0.9946068, 'binary_f1_score': 0.4287317}
confusion matrix:
       0    1
0  18073   98
1    411  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9544799, 'precision': 0.55614585, 'recall': 0.5143429, 'specificity': 0.5143429, 'f1': 0.51813906, 'auroc': 0.84099627, 'binary_precision': 0.15, 'binary_recall': 0.037190083, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.05960265}
confusion matrix:
      0   1
0  5946  51
1   233   9
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-26 20:47:19.137042,epoch time: 0:21:54.360604,used: 1:51:25.336231,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_55_53_seed_2_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9969865, 'precision': 0.9977238, 'recall': 0.9945146, 'specificity': 0.9945146, 'f1': 0.9961051, 'auroc': 0.9998323, 'binary_precision': 0.9992654, 'binary_recall': 0.9892893, 'binary_specificity': 0.9997398, 'binary_f1_score': 0.99425226}
confusion matrix:
       0      1
0  42272     11
1    162  14963
---- Validation: 
scalar performance:
{'acc': 0.9700634, 'precision': 0.791168, 'recall': 0.5910421, 'specificity': 0.5910421, 'f1': 0.6348494, 'auroc': 0.91622764, 'binary_precision': 0.6086956, 'binary_recall': 0.18604651, 'binary_specificity': 0.99603766, 'binary_f1_score': 0.28498727}
confusion matrix:
       0    1
0  18099   72
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597692, 'precision': 0.5261064, 'recall': 0.5012324, 'specificity': 0.5012324, 'f1': 0.49368674, 'auroc': 0.8489574, 'binary_precision': 0.09090909, 'binary_recall': 0.004132231, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.007905138}
confusion matrix:
      0   1
0  5987  10
1   241   1
new oracle model saved
early stop counter: 1
val acc:0.9700633883476257, best validation acc: 0.9728866219520569, corresponding to test acc:                         0.9544798731803894 / 0.9597691893577576
after epoch: 6,now: 2024-07-26 21:09:55.331278,epoch time: 0:22:36.194236,used: 2:14:01.530467,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_55_53_seed_2_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9968297, 'precision': 0.995375, 'recall': 0.99646723, 'specificity': 0.99646723, 'f1': 0.99591947, 'auroc': 0.9997936, 'binary_precision': 0.99228895, 'binary_recall': 0.9957013, 'binary_specificity': 0.9972332, 'binary_f1_score': 0.9939922}
confusion matrix:
       0      1
0  42170    117
1     65  15056
---- Validation: 
scalar performance:
{'acc': 0.9655356, 'precision': 0.7136121, 'recall': 0.6585684, 'specificity': 0.6585684, 'f1': 0.68156785, 'auroc': 0.92366886, 'binary_precision': 0.44920993, 'binary_recall': 0.3305648, 'binary_specificity': 0.986572, 'binary_f1_score': 0.38086125}
confusion matrix:
       0    1
0  17927  244
1    403  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9410162, 'precision': 0.52941835, 'recall': 0.51923585, 'specificity': 0.51923585, 'f1': 0.52245665, 'auroc': 0.75439924, 'binary_precision': 0.09615385, 'binary_recall': 0.06198347, 'binary_specificity': 0.97648823, 'binary_f1_score': 0.07537688}
confusion matrix:
      0    1
0  5856  141
1   227   15
early stop counter: 2
val acc:0.965535581111908, best validation acc: 0.9728866219520569, corresponding to test acc:                         0.9544798731803894 / 0.9597691893577576
after epoch: 7,now: 2024-07-26 21:31:51.288196,epoch time: 0:21:55.956918,used: 2:35:57.487385,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_55_53_seed_2_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.997631, 'precision': 0.9964259, 'recall': 0.9974785, 'specificity': 0.9974785, 'f1': 0.9969507, 'auroc': 0.99986255, 'binary_precision': 0.9938699, 'binary_recall': 0.99715626, 'binary_specificity': 0.99780077, 'binary_f1_score': 0.99551034}
confusion matrix:
       0      1
0  42194     93
1     43  15078
---- Validation: 
scalar performance:
{'acc': 0.9754435, 'precision': 0.84719384, 'recall': 0.6925962, 'specificity': 0.6925962, 'f1': 0.7461215, 'auroc': 0.9512049, 'binary_precision': 0.71428573, 'binary_recall': 0.39036545, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.5048335}
confusion matrix:
       0    1
0  18077   94
1    367  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9556019, 'precision': 0.5062862, 'recall': 0.5010474, 'specificity': 0.5010474, 'f1': 0.4957622, 'auroc': 0.8854932, 'binary_precision': 0.051282052, 'binary_recall': 0.008264462, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.014234874}
confusion matrix:
      0   1
0  5960  37
1   240   2
better model found
persisted
after epoch: 8,now: 2024-07-26 21:53:36.767015,epoch time: 0:21:45.478819,used: 2:57:42.966204,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_55_53_seed_2_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9983626, 'precision': 0.9980591, 'recall': 0.9977204, 'specificity': 0.9977204, 'f1': 0.99788964, 'auroc': 0.999933, 'binary_precision': 0.9974184, 'binary_recall': 0.99636316, 'binary_specificity': 0.9990777, 'binary_f1_score': 0.99689054}
confusion matrix:
       0      1
0  42246     39
1     55  15068
---- Validation: 
scalar performance:
{'acc': 0.9713951, 'precision': 0.76869786, 'recall': 0.78205246, 'specificity': 0.78205246, 'f1': 0.77519655, 'auroc': 0.94733024, 'binary_precision': 0.5513428, 'binary_recall': 0.5797342, 'binary_specificity': 0.9843707, 'binary_f1_score': 0.5651821}
confusion matrix:
       0    1
0  17887  284
1    253  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95816636, 'precision': 0.52417326, 'recall': 0.5023813, 'specificity': 0.5023813, 'f1': 0.49686185, 'auroc': 0.8933475, 'binary_precision': 0.08695652, 'binary_recall': 0.008264462, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.015094339}
confusion matrix:
      0   1
0  5976  21
1   240   2
early stop counter: 1
val acc:0.9713950753211975, best validation acc: 0.9754434823989868, corresponding to test acc:                         0.9556018710136414 / 0.9597691893577576
after epoch: 9,now: 2024-07-26 22:16:18.961889,epoch time: 0:22:42.194874,used: 3:20:25.161078,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_55_53_seed_2_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9973523, 'precision': 0.9977126, 'recall': 0.99546194, 'specificity': 0.99546194, 'f1': 0.99658036, 'auroc': 0.9996767, 'binary_precision': 0.998468, 'binary_recall': 0.9914677, 'binary_specificity': 0.9994561, 'binary_f1_score': 0.99495554}
confusion matrix:
       0      1
0  42266     23
1    129  14990
---- Validation: 
scalar performance:
{'acc': 0.9732062, 'precision': 0.92305374, 'recall': 0.59587777, 'specificity': 0.59587777, 'f1': 0.6509909, 'auroc': 0.9313321, 'binary_precision': 0.87218046, 'binary_recall': 0.19269103, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.31564623}
confusion matrix:
       0    1
0  18154   17
1    486  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.4805934, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48994443, 'auroc': 0.9043401, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   242  0
new oracle model saved
early stop counter: 2
val acc:0.9732062220573425, best validation acc: 0.9754434823989868, corresponding to test acc:                         0.9556018710136414 / 0.9605706334114075
after epoch: 10,now: 2024-07-26 22:40:25.169736,epoch time: 0:24:06.207847,used: 3:44:31.368925,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_55_53_seed_2_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9980142, 'precision': 0.99850476, 'recall': 0.99637985, 'specificity': 0.99637985, 'f1': 0.9974361, 'auroc': 0.99988735, 'binary_precision': 0.9995341, 'binary_recall': 0.99292517, 'binary_specificity': 0.9998345, 'binary_f1_score': 0.9962186}
confusion matrix:
       0      1
0  42277      7
1    107  15017
---- Validation: 
scalar performance:
{'acc': 0.9699036, 'precision': 0.84694606, 'recall': 0.549201, 'specificity': 0.549201, 'f1': 0.5799273, 'auroc': 0.9477382, 'binary_precision': 0.72289157, 'binary_recall': 0.09966777, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.17518248}
confusion matrix:
       0   1
0  18148  23
1    542  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549607, 'precision': 0.49275336, 'recall': 0.4987311, 'specificity': 0.4987311, 'f1': 0.49201244, 'auroc': 0.8641704, 'binary_precision': 0.024390243, 'binary_recall': 0.004132231, 'binary_specificity': 0.99333, 'binary_f1_score': 0.0070671374}
confusion matrix:
      0   1
0  5957  40
1   241   1
early stop counter: 3
val acc:0.9699035882949829, best validation acc: 0.9754434823989868, corresponding to test acc:                         0.9556018710136414 / 0.9605706334114075
after epoch: 11,now: 2024-07-26 23:02:36.287630,epoch time: 0:22:11.117894,used: 4:06:42.486819,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_55_53_seed_2_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9969865, 'precision': 0.99796283, 'recall': 0.9942791, 'specificity': 0.9942791, 'f1': 0.99610245, 'auroc': 0.99986064, 'binary_precision': 1.0, 'binary_recall': 0.9885582, 'binary_specificity': 1.0, 'binary_f1_score': 0.9942462}
confusion matrix:
       0      1
0  42288      0
1    173  14947
---- Validation: 
scalar performance:
{'acc': 0.9697971, 'precision': 0.92119104, 'recall': 0.53388804, 'specificity': 0.53388804, 'f1': 0.55549055, 'auroc': 0.94245654, 'binary_precision': 0.87234044, 'binary_recall': 0.06810631, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.12634823}
confusion matrix:
       0   1
0  18165   6
1    561  41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95752525, 'precision': 0.4805341, 'recall': 0.49808237, 'specificity': 0.49808237, 'f1': 0.4891509, 'auroc': 0.88305193, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5974  23
1   242   0
early stop counter: 4
val acc:0.9697970747947693, best validation acc: 0.9754434823989868, corresponding to test acc:                         0.9556018710136414 / 0.9605706334114075
after epoch: 12,now: 2024-07-26 23:25:08.351075,epoch time: 0:22:32.063445,used: 4:29:14.550264,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_55_53_seed_2_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99796194, 'precision': 0.9985341, 'recall': 0.9962164, 'specificity': 0.9962164, 'f1': 0.99736786, 'auroc': 0.9998733, 'binary_precision': 0.99973357, 'binary_recall': 0.9925274, 'binary_specificity': 0.9999054, 'binary_f1_score': 0.9961175}
confusion matrix:
       0      1
0  42282      4
1    113  15009
---- Validation: 
scalar performance:
{'acc': 0.97080916, 'precision': 0.8053689, 'recall': 0.60267, 'specificity': 0.60267, 'f1': 0.6500435, 'auroc': 0.94413763, 'binary_precision': 0.6363636, 'binary_recall': 0.20930232, 'binary_specificity': 0.99603766, 'binary_f1_score': 0.31500003}
confusion matrix:
       0    1
0  18099   72
1    476  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548004, 'precision': 0.5033568, 'recall': 0.5006305, 'specificity': 0.5006305, 'f1': 0.49542803, 'auroc': 0.90744185, 'binary_precision': 0.045454547, 'binary_recall': 0.008264462, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.013986014}
confusion matrix:
      0   1
0  5955  42
1   240   2
early stop counter: 5
val acc:0.9708091616630554, best validation acc: 0.9754434823989868, corresponding to test acc:                         0.9556018710136414 / 0.9605706334114075
after epoch: 13,now: 2024-07-26 23:49:52.380039,epoch time: 0:24:44.028964,used: 4:53:58.579228,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_55_53_seed_2_23069998
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 4:53:58.579228 at 2024-07-26 23:49:52.380039
persisted model performance metric: 

scalar performance:
{'acc': 0.9556019, 'precision': 0.5062862, 'recall': 0.5010474, 'specificity': 0.5010474, 'f1': 0.4957622, 'auroc': 0.8854932, 'binary_precision': 0.051282052, 'binary_recall': 0.008264462, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.014234874}
confusion matrix:
      0   1
0  5960  37
1   240   2
oracle model performance metric: 

scalar performance:
{'acc': 0.96057063, 'precision': 0.4805934, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48994443, 'auroc': 0.9043401, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   242  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/11.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/11.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 449896 KiB |   6932 MiB |   1073 TiB |   1073 TiB |
|       from large pool | 409091 KiB |   6897 MiB |   1069 TiB |   1069 TiB |
|       from small pool |  40805 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 449896 KiB |   6932 MiB |   1073 TiB |   1073 TiB |
|       from large pool | 409091 KiB |   6897 MiB |   1069 TiB |   1069 TiB |
|       from small pool |  40805 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |   6928 MiB |   1072 TiB |   1072 TiB |
|       from large pool | 407075 KiB |   6894 MiB |   1069 TiB |   1069 TiB |
|       from small pool |  40678 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7274 MiB |   7286 MiB |  19666 MiB |  12392 MiB |
|       from large pool |   7210 MiB |   7222 MiB |  19572 MiB |  12362 MiB |
|       from small pool |     64 MiB |     64 MiB |     94 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 711319 KiB |    845 MiB | 496623 GiB | 496622 GiB |
|       from large pool | 700925 KiB |    840 MiB | 492595 GiB | 492595 GiB |
|       from small pool |  10394 KiB |     26 MiB |   4027 GiB |   4027 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1724    |    2779    |   55619 K  |   55618 K  |
|       from large pool |     187    |     311    |   27049 K  |   27049 K  |
|       from small pool |    1537    |    2591    |   28570 K  |   28568 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1724    |    2779    |   55619 K  |   55618 K  |
|       from large pool |     187    |     311    |   27049 K  |   27049 K  |
|       from small pool |    1537    |    2591    |   28570 K  |   28568 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     149    |     149    |     339    |     190    |
|       from large pool |     117    |     117    |     292    |     175    |
|       from small pool |      32    |      32    |      47    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      67    |     953    |   32379 K  |   32379 K  |
|       from large pool |      31    |     118    |   20759 K  |   20759 K  |
|       from small pool |      36    |     922    |   11619 K  |   11619 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6932 MiB |   1073 TiB |   1073 TiB |
|       from large pool |  16640 KiB |   6897 MiB |   1069 TiB |   1069 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6932 MiB |   1073 TiB |   1073 TiB |
|       from large pool |  16640 KiB |   6897 MiB |   1069 TiB |   1069 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6928 MiB |   1072 TiB |   1072 TiB |
|       from large pool |  16640 KiB |   6894 MiB |   1069 TiB |   1069 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1134 MiB |   7286 MiB |  19666 MiB |  18532 MiB |
|       from large pool |   1084 MiB |   7222 MiB |  19572 MiB |  18488 MiB |
|       from small pool |     50 MiB |     64 MiB |     94 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 496623 GiB | 496623 GiB |
|       from large pool |   3840 KiB |    840 MiB | 492596 GiB | 492596 GiB |
|       from small pool |      0 KiB |     26 MiB |   4027 GiB |   4027 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2779    |   55619 K  |   55619 K  |
|       from large pool |       2    |     311    |   27049 K  |   27049 K  |
|       from small pool |       0    |    2591    |   28570 K  |   28570 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2779    |   55619 K  |   55619 K  |
|       from large pool |       2    |     311    |   27049 K  |   27049 K  |
|       from small pool |       0    |    2591    |   28570 K  |   28570 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     149    |     339    |     284    |
|       from large pool |      30    |     117    |     292    |     262    |
|       from small pool |      25    |      32    |      47    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     953    |   32379 K  |   32379 K  |
|       from large pool |       2    |     118    |   20759 K  |   20759 K  |
|       from small pool |       0    |     922    |   11620 K  |   11620 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 23:51:01 2024]
Finished job 0.
1 of 1 steps (100%) done
