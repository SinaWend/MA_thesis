Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 11:47:23 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23070000

 Experiment start at: 2024-07-26 11:57:16.533994
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93522024, 'precision': 0.95095277, 'recall': 0.8802345, 'specificity': 0.8802345, 'f1': 0.90860116, 'auroc': 0.9441136, 'binary_precision': 0.97738105, 'binary_recall': 0.7666372, 'binary_specificity': 0.9938317, 'binary_f1_score': 0.8592761}
confusion matrix:
       0      1
0  42052    261
1   3433  11278
---- Validation: 
scalar performance:
{'acc': 0.89357173, 'precision': 0.5311511, 'recall': 0.5758734, 'specificity': 0.5758734, 'f1': 0.53725207, 'auroc': 0.73682857, 'binary_precision': 0.091018684, 'binary_recall': 0.2348367, 'binary_specificity': 0.91691005, 'binary_f1_score': 0.13119027}
confusion matrix:
       0     1
0  16641  1508
1    492   151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9004474, 'precision': 0.54654765, 'recall': 0.58342296, 'specificity': 0.58342296, 'f1': 0.55653083, 'auroc': 0.7793137, 'binary_precision': 0.12757201, 'binary_recall': 0.23754789, 'binary_specificity': 0.929298, 'binary_f1_score': 0.16599733}
confusion matrix:
      0    1
0  5573  424
1   199   62
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 12:15:03.008912,epoch time: 0:17:46.474918,used: 0:17:46.474918,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.935571, 'precision': 0.9213501, 'recall': 0.90829134, 'specificity': 0.90829134, 'f1': 0.91454446, 'auroc': 0.9498329, 'binary_precision': 0.89335614, 'binary_recall': 0.8519375, 'binary_specificity': 0.96464527, 'binary_f1_score': 0.87215537}
confusion matrix:
       0      1
0  40818   1496
1   2178  12532
---- Validation: 
scalar performance:
{'acc': 0.6714559, 'precision': 0.52345, 'recall': 0.6588954, 'specificity': 0.6588954, 'f1': 0.4583035, 'auroc': 0.7234737, 'binary_precision': 0.065241314, 'binary_recall': 0.64541215, 'binary_specificity': 0.67237866, 'binary_f1_score': 0.11850371}
confusion matrix:
       0     1
0  12203  5946
1    228   415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.621125, 'precision': 0.5346618, 'recall': 0.7088688, 'specificity': 0.7088688, 'f1': 0.45333952, 'auroc': 0.8003893, 'binary_precision': 0.08300395, 'binary_recall': 0.8045977, 'binary_specificity': 0.6131399, 'binary_f1_score': 0.1504837}
confusion matrix:
      0     1
0  3677  2320
1    51   210
early stop counter: 1
val acc:0.6714559197425842, best validation acc: 0.8935717344284058, corresponding to test acc:                         0.900447428226471 / 0.900447428226471
after epoch: 2,now: 2024-07-26 12:28:10.972278,epoch time: 0:13:07.963366,used: 0:30:54.438284,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94241023, 'precision': 0.9408735, 'recall': 0.90628636, 'specificity': 0.90628636, 'f1': 0.9218017, 'auroc': 0.94682425, 'binary_precision': 0.93804157, 'binary_recall': 0.83166766, 'binary_specificity': 0.9809051, 'binary_f1_score': 0.88165766}
confusion matrix:
       0      1
0  41507    808
1   2476  12233
---- Validation: 
scalar performance:
{'acc': 0.9389634, 'precision': 0.5398203, 'recall': 0.54011893, 'specificity': 0.54011893, 'f1': 0.5399688, 'auroc': 0.7311162, 'binary_precision': 0.11111111, 'binary_recall': 0.11197512, 'binary_specificity': 0.96826273, 'binary_f1_score': 0.111541435}
confusion matrix:
       0    1
0  17573  576
1    571   72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9394375, 'precision': 0.5795509, 'recall': 0.55979043, 'specificity': 0.55979043, 'f1': 0.5678047, 'auroc': 0.8049063, 'binary_precision': 0.19587629, 'binary_recall': 0.14559387, 'binary_specificity': 0.973987, 'binary_f1_score': 0.16703297}
confusion matrix:
      0    1
0  5841  156
1   223   38
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 12:41:15.940681,epoch time: 0:13:04.968403,used: 0:43:59.406687,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9454616, 'precision': 0.96509534, 'recall': 0.89476156, 'specificity': 0.89476156, 'f1': 0.92327166, 'auroc': 0.9541808, 'binary_precision': 0.9982824, 'binary_recall': 0.7899959, 'binary_specificity': 0.9995273, 'binary_f1_score': 0.88200927}
confusion matrix:
       0      1
0  42290     20
1   3090  11624
---- Validation: 
scalar performance:
{'acc': 0.9598233, 'precision': 0.48278907, 'recall': 0.49691442, 'specificity': 0.49691442, 'f1': 0.4897499, 'auroc': 0.72600394, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.0}
confusion matrix:
       0    1
0  18037  112
1    643    0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95286036, 'precision': 0.47903278, 'recall': 0.49716526, 'specificity': 0.49716526, 'f1': 0.48793063, 'auroc': 0.81150913, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5963  34
1   261   0
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 12:54:16.617149,epoch time: 0:13:00.676468,used: 0:57:00.083155,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95233583, 'precision': 0.96354747, 'recall': 0.91218746, 'specificity': 0.91218746, 'f1': 0.93424904, 'auroc': 0.9564569, 'binary_precision': 0.9833938, 'binary_recall': 0.8292434, 'binary_specificity': 0.9951315, 'binary_f1_score': 0.899764}
confusion matrix:
       0      1
0  42107    206
1   2512  12199
---- Validation: 
scalar performance:
{'acc': 0.90868455, 'precision': 0.54445726, 'recall': 0.59269816, 'specificity': 0.59269816, 'f1': 0.55568326, 'auroc': 0.7237482, 'binary_precision': 0.11651179, 'binary_recall': 0.2534992, 'binary_specificity': 0.9318971, 'binary_f1_score': 0.1596474}
confusion matrix:
       0     1
0  16913  1236
1    480   163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8899009, 'precision': 0.5731866, 'recall': 0.6713692, 'specificity': 0.6713692, 'f1': 0.59380156, 'auroc': 0.7884511, 'binary_precision': 0.17278287, 'binary_recall': 0.4329502, 'binary_specificity': 0.90978825, 'binary_f1_score': 0.24699454}
confusion matrix:
      0    1
0  5456  541
1   148  113
early stop counter: 1
val acc:0.9086845517158508, best validation acc: 0.9598233103752136, corresponding to test acc:                         0.9528603553771973 / 0.9528603553771973
after epoch: 5,now: 2024-07-26 13:07:14.331160,epoch time: 0:12:57.714011,used: 1:09:57.797166,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95179224, 'precision': 0.96512234, 'recall': 0.9096807, 'specificity': 0.9096807, 'f1': 0.93321884, 'auroc': 0.9468534, 'binary_precision': 0.9884823, 'binary_recall': 0.8226936, 'binary_specificity': 0.99666786, 'binary_f1_score': 0.8980001}
confusion matrix:
       0      1
0  42174    141
1   2608  12101
---- Validation: 
scalar performance:
{'acc': 0.93779266, 'precision': 0.54677695, 'recall': 0.5507636, 'specificity': 0.5507636, 'f1': 0.5486522, 'auroc': 0.7402264, 'binary_precision': 0.12428571, 'binary_recall': 0.13530326, 'binary_specificity': 0.966224, 'binary_f1_score': 0.1295607}
confusion matrix:
       0    1
0  17536  613
1    556   87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9354426, 'precision': 0.57287806, 'recall': 0.56320304, 'specificity': 0.56320304, 'f1': 0.5675708, 'auroc': 0.798113, 'binary_precision': 0.18222222, 'binary_recall': 0.15708812, 'binary_specificity': 0.969318, 'binary_f1_score': 0.16872427}
confusion matrix:
      0    1
0  5813  184
1   220   41
early stop counter: 2
val acc:0.9377926588058472, best validation acc: 0.9598233103752136, corresponding to test acc:                         0.9528603553771973 / 0.9528603553771973
after epoch: 6,now: 2024-07-26 13:20:06.833663,epoch time: 0:12:52.502503,used: 1:22:50.299669,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9383067, 'precision': 0.9225689, 'recall': 0.9150859, 'specificity': 0.9150859, 'f1': 0.9187362, 'auroc': 0.94950473, 'binary_precision': 0.89094466, 'binary_recall': 0.8670925, 'binary_specificity': 0.9630794, 'binary_f1_score': 0.87885684}
confusion matrix:
       0      1
0  40745   1562
1   1956  12761
---- Validation: 
scalar performance:
{'acc': 0.601639, 'precision': 0.5191148, 'recall': 0.6400014, 'specificity': 0.6400014, 'f1': 0.42429137, 'auroc': 0.6794226, 'binary_precision': 0.0567431, 'binary_recall': 0.68118197, 'binary_specificity': 0.59882087, 'binary_f1_score': 0.104759626}
confusion matrix:
       0     1
0  10868  7281
1    205   438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45381913, 'precision': 0.5253145, 'recall': 0.65455717, 'specificity': 0.65455717, 'f1': 0.36109874, 'auroc': 0.7729048, 'binary_precision': 0.06310545, 'binary_recall': 0.87356323, 'binary_specificity': 0.4355511, 'binary_f1_score': 0.11770779}
confusion matrix:
      0     1
0  2612  3385
1    33   228
early stop counter: 3
val acc:0.6016389727592468, best validation acc: 0.9598233103752136, corresponding to test acc:                         0.9528603553771973 / 0.9528603553771973
after epoch: 7,now: 2024-07-26 13:32:50.471417,epoch time: 0:12:43.637754,used: 1:35:33.937423,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95165193, 'precision': 0.96158206, 'recall': 0.912037, 'specificity': 0.912037, 'f1': 0.9334187, 'auroc': 0.95538914, 'binary_precision': 0.9792335, 'binary_recall': 0.83019507, 'binary_specificity': 0.99387896, 'binary_f1_score': 0.8985763}
confusion matrix:
       0      1
0  42054    259
1   2498  12213
---- Validation: 
scalar performance:
{'acc': 0.9487548, 'precision': 0.50033975, 'recall': 0.5001848, 'specificity': 0.5001848, 'f1': 0.49900123, 'auroc': 0.74803597, 'binary_precision': 0.034883723, 'binary_recall': 0.01866252, 'binary_specificity': 0.981707, 'binary_f1_score': 0.02431611}
confusion matrix:
       0    1
0  17817  332
1    631   12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93144774, 'precision': 0.5499645, 'recall': 0.54462767, 'specificity': 0.54462767, 'f1': 0.54706794, 'auroc': 0.81079614, 'binary_precision': 0.13793103, 'binary_recall': 0.12260536, 'binary_specificity': 0.96665, 'binary_f1_score': 0.12981744}
confusion matrix:
      0    1
0  5797  200
1   229   32
early stop counter: 4
val acc:0.9487547874450684, best validation acc: 0.9598233103752136, corresponding to test acc:                         0.9528603553771973 / 0.9528603553771973
after epoch: 8,now: 2024-07-26 13:45:21.336590,epoch time: 0:12:30.865173,used: 1:48:04.802596,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9504244, 'precision': 0.95405835, 'recall': 0.9151616, 'specificity': 0.9151616, 'f1': 0.93245363, 'auroc': 0.9560759, 'binary_precision': 0.9606946, 'binary_recall': 0.8423056, 'binary_specificity': 0.98801756, 'binary_f1_score': 0.8976132}
confusion matrix:
       0      1
0  41805    507
1   2320  12392
---- Validation: 
scalar performance:
{'acc': 0.79012346, 'precision': 0.53532, 'recall': 0.6798283, 'specificity': 0.6798283, 'f1': 0.5174618, 'auroc': 0.7424034, 'binary_precision': 0.08973403, 'binary_recall': 0.5614308, 'binary_specificity': 0.7982258, 'binary_f1_score': 0.1547364}
confusion matrix:
       0     1
0  14487  3662
1    282   361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77916265, 'precision': 0.55193466, 'recall': 0.73452437, 'specificity': 0.73452437, 'f1': 0.5387496, 'auroc': 0.79351234, 'binary_precision': 0.12102772, 'binary_recall': 0.68582374, 'binary_specificity': 0.78322494, 'binary_f1_score': 0.20574713}
confusion matrix:
      0     1
0  4697  1300
1    82   179
early stop counter: 5
val acc:0.790123462677002, best validation acc: 0.9598233103752136, corresponding to test acc:                         0.9528603553771973 / 0.9528603553771973
after epoch: 9,now: 2024-07-26 13:58:12.932997,epoch time: 0:12:51.596407,used: 2:00:56.399003,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 2:00:56.399003 at 2024-07-26 13:58:12.932997
persisted model performance metric: 

scalar performance:
{'acc': 0.95286036, 'precision': 0.47903278, 'recall': 0.49716526, 'specificity': 0.49716526, 'f1': 0.48793063, 'auroc': 0.81150913, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5963  34
1   261   0
oracle model performance metric: 

scalar performance:
{'acc': 0.95286036, 'precision': 0.47903278, 'recall': 0.49716526, 'specificity': 0.49716526, 'f1': 0.48793063, 'auroc': 0.81150913, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5963  34
1   261   0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 502827 KiB |   3691 MiB | 350436 GiB | 350436 GiB |
|       from large pool | 461728 KiB |   3658 MiB | 348175 GiB | 348174 GiB |
|       from small pool |  41099 KiB |     57 MiB |   2261 GiB |   2261 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 502827 KiB |   3691 MiB | 350436 GiB | 350436 GiB |
|       from large pool | 461728 KiB |   3658 MiB | 348175 GiB | 348174 GiB |
|       from small pool |  41099 KiB |     57 MiB |   2261 GiB |   2261 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496650 KiB |   3689 MiB | 350348 GiB | 350347 GiB |
|       from large pool | 455971 KiB |   3656 MiB | 348090 GiB | 348090 GiB |
|       from small pool |  40679 KiB |     56 MiB |   2257 GiB |   2257 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4056 MiB |   4056 MiB |   4056 MiB |      0 B   |
|       from large pool |   3992 MiB |   3992 MiB |   3992 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 666580 KiB | 696332 KiB | 191108 GiB | 191108 GiB |
|       from large pool | 660576 KiB | 687904 KiB | 188742 GiB | 188741 GiB |
|       from small pool |   6004 KiB |  11568 KiB |   2366 GiB |   2366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2312    |    4549    |   33334 K  |   33331 K  |
|       from large pool |     187    |     311    |   16271 K  |   16271 K  |
|       from small pool |    2125    |    4361    |   17062 K  |   17060 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2312    |    4549    |   33334 K  |   33331 K  |
|       from large pool |     187    |     311    |   16271 K  |   16271 K  |
|       from small pool |    2125    |    4361    |   17062 K  |   17060 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     147    |     147    |     147    |       0    |
|       from large pool |     115    |     115    |     115    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    1835    |   19722 K  |   19722 K  |
|       from large pool |      32    |     113    |   13281 K  |   13281 K  |
|       from small pool |      31    |    1803    |    6441 K  |    6441 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   3691 MiB | 350436 GiB | 350436 GiB |
|       from large pool |  65536 KiB |   3658 MiB | 348175 GiB | 348175 GiB |
|       from small pool |      0 KiB |     57 MiB |   2261 GiB |   2261 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   3691 MiB | 350436 GiB | 350436 GiB |
|       from large pool |  65536 KiB |   3658 MiB | 348175 GiB | 348175 GiB |
|       from small pool |      0 KiB |     57 MiB |   2261 GiB |   2261 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   3689 MiB | 350348 GiB | 350348 GiB |
|       from large pool |  65536 KiB |   3656 MiB | 348090 GiB | 348090 GiB |
|       from small pool |      0 KiB |     56 MiB |   2257 GiB |   2257 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1142 MiB |   4056 MiB |   4056 MiB |   2914 MiB |
|       from large pool |   1096 MiB |   3992 MiB |   3992 MiB |   2896 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 726430 KiB | 191109 GiB | 191109 GiB |
|       from large pool |      0 B   | 710226 KiB | 188742 GiB | 188742 GiB |
|       from small pool |      0 B   |  20927 KiB |   2366 GiB |   2366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4549    |   33334 K  |   33334 K  |
|       from large pool |       2    |     311    |   16271 K  |   16271 K  |
|       from small pool |       0    |    4361    |   17062 K  |   17062 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4549    |   33334 K  |   33334 K  |
|       from large pool |       2    |     311    |   16271 K  |   16271 K  |
|       from small pool |       0    |    4361    |   17062 K  |   17062 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     147    |     147    |      86    |
|       from large pool |      38    |     115    |     115    |      77    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    1835    |   19723 K  |   19723 K  |
|       from large pool |       0    |     113    |   13281 K  |   13281 K  |
|       from small pool |       0    |    1803    |    6442 K  |    6442 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   3691 MiB | 350436 GiB | 350436 GiB |
|       from large pool |  65536 KiB |   3658 MiB | 348175 GiB | 348175 GiB |
|       from small pool |      0 KiB |     57 MiB |   2261 GiB |   2261 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   3691 MiB | 350436 GiB | 350436 GiB |
|       from large pool |  65536 KiB |   3658 MiB | 348175 GiB | 348175 GiB |
|       from small pool |      0 KiB |     57 MiB |   2261 GiB |   2261 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   3689 MiB | 350348 GiB | 350348 GiB |
|       from large pool |  65536 KiB |   3656 MiB | 348090 GiB | 348090 GiB |
|       from small pool |      0 KiB |     56 MiB |   2257 GiB |   2257 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1142 MiB |   4056 MiB |   4056 MiB |   2914 MiB |
|       from large pool |   1096 MiB |   3992 MiB |   3992 MiB |   2896 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 726430 KiB | 191109 GiB | 191109 GiB |
|       from large pool |      0 B   | 710226 KiB | 188742 GiB | 188742 GiB |
|       from small pool |      0 B   |  20927 KiB |   2366 GiB |   2366 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4549    |   33334 K  |   33334 K  |
|       from large pool |       2    |     311    |   16271 K  |   16271 K  |
|       from small pool |       0    |    4361    |   17062 K  |   17062 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4549    |   33334 K  |   33334 K  |
|       from large pool |       2    |     311    |   16271 K  |   16271 K  |
|       from small pool |       0    |    4361    |   17062 K  |   17062 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     147    |     147    |      86    |
|       from large pool |      38    |     115    |     115    |      77    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    1835    |   19723 K  |   19723 K  |
|       from large pool |       0    |     113    |   13281 K  |   13281 K  |
|       from small pool |       0    |    1803    |    6442 K  |    6442 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_04_23_seed_1_23070000

 Experiment start at: 2024-07-26 14:04:23.524982
before training, model accuracy: 0.6475991010665894
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9237753, 'precision': 0.9287912, 'recall': 0.8663522, 'specificity': 0.8663522, 'f1': 0.89184964, 'auroc': 0.91386104, 'binary_precision': 0.9372345, 'binary_recall': 0.7497746, 'binary_specificity': 0.98292977, 'binary_f1_score': 0.8330893}
confusion matrix:
       0      1
0  41689    724
1   3608  10811
---- Validation: 
scalar performance:
{'acc': 0.63127, 'precision': 0.51321864, 'recall': 0.5891803, 'specificity': 0.5891803, 'f1': 0.43210128, 'auroc': 0.613081, 'binary_precision': 0.052518297, 'binary_recall': 0.54383355, 'binary_specificity': 0.634527, 'binary_f1_score': 0.095786445}
confusion matrix:
       0     1
0  11464  6603
1    307   366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5103126, 'precision': 0.51533395, 'recall': 0.5954921, 'specificity': 0.5954921, 'f1': 0.38414115, 'auroc': 0.61167365, 'binary_precision': 0.057060886, 'binary_recall': 0.68846154, 'binary_specificity': 0.5025227, 'binary_f1_score': 0.10538711}
confusion matrix:
      0     1
0  2988  2958
1    81   179
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 14:22:00.309904,epoch time: 0:17:36.784922,used: 0:17:36.784922,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_04_23_seed_1_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.945594, 'precision': 0.93744004, 'recall': 0.91674376, 'specificity': 0.91674376, 'f1': 0.9264548, 'auroc': 0.95299757, 'binary_precision': 0.92198795, 'binary_recall': 0.85817325, 'binary_specificity': 0.9753142, 'binary_f1_score': 0.8889368}
confusion matrix:
       0      1
0  41366   1047
1   2045  12374
---- Validation: 
scalar performance:
{'acc': 0.73265743, 'precision': 0.5301875, 'recall': 0.67394936, 'specificity': 0.67394936, 'f1': 0.49132133, 'auroc': 0.75190663, 'binary_precision': 0.0796666, 'binary_recall': 0.61069834, 'binary_specificity': 0.73720044, 'binary_f1_score': 0.1409465}
confusion matrix:
       0     1
0  13319  4748
1    262   411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6508218, 'precision': 0.53352344, 'recall': 0.6945645, 'specificity': 0.6945645, 'f1': 0.46569777, 'auroc': 0.74763966, 'binary_precision': 0.08416921, 'binary_recall': 0.74230766, 'binary_specificity': 0.6468214, 'binary_f1_score': 0.15119466}
confusion matrix:
      0     1
0  3846  2100
1    67   193
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 14:43:15.316815,epoch time: 0:21:15.006911,used: 0:38:51.791833,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_04_23_seed_1_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.91840863, 'precision': 0.89287066, 'recall': 0.8912288, 'specificity': 0.8912288, 'f1': 0.892045, 'auroc': 0.94250345, 'binary_precision': 0.84135956, 'binary_recall': 0.8360497, 'binary_specificity': 0.9464079, 'binary_f1_score': 0.83869624}
confusion matrix:
       0      1
0  40140   2273
1   2364  12055
---- Validation: 
scalar performance:
{'acc': 0.5008538, 'precision': 0.5200558, 'recall': 0.64456916, 'specificity': 0.64456916, 'f1': 0.37867993, 'auroc': 0.7205267, 'binary_precision': 0.0551399, 'binary_recall': 0.79940563, 'binary_specificity': 0.48973265, 'binary_f1_score': 0.10316395}
confusion matrix:
      0     1
0  8848  9219
1   135   538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3617467, 'precision': 0.5216824, 'recall': 0.6191053, 'specificity': 0.6191053, 'f1': 0.3047439, 'auroc': 0.7478279, 'binary_precision': 0.05612857, 'binary_recall': 0.9, 'binary_specificity': 0.33821055, 'binary_f1_score': 0.105667196}
confusion matrix:
      0     1
0  2011  3935
1    26   234
early stop counter: 1
val acc:0.5008537769317627, best validation acc: 0.7326574325561523, corresponding to test acc:                         0.6508218050003052 / 0.6508218050003052
after epoch: 3,now: 2024-07-26 14:59:41.899737,epoch time: 0:16:26.582922,used: 0:55:18.374755,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_04_23_seed_1_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95096076, 'precision': 0.9580058, 'recall': 0.91171634, 'specificity': 0.91171634, 'f1': 0.9319315, 'auroc': 0.95233005, 'binary_precision': 0.97047645, 'binary_recall': 0.8320388, 'binary_specificity': 0.9913939, 'binary_f1_score': 0.89594144}
confusion matrix:
       0      1
0  42047    365
1   2422  11998
---- Validation: 
scalar performance:
{'acc': 0.79268944, 'precision': 0.53329307, 'recall': 0.65859115, 'specificity': 0.65859115, 'f1': 0.5165582, 'auroc': 0.70294464, 'binary_precision': 0.08862705, 'binary_recall': 0.51411587, 'binary_specificity': 0.8030664, 'binary_f1_score': 0.15119074}
confusion matrix:
       0     1
0  14509  3558
1    327   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7347728, 'precision': 0.5374978, 'recall': 0.68688387, 'specificity': 0.68688387, 'f1': 0.50464034, 'auroc': 0.73995316, 'binary_precision': 0.09615385, 'binary_recall': 0.63461536, 'binary_specificity': 0.7391524, 'binary_f1_score': 0.16700405}
confusion matrix:
      0     1
0  4395  1551
1    95   165
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 15:18:52.321363,epoch time: 0:19:10.421626,used: 1:14:28.796381,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_04_23_seed_1_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94269073, 'precision': 0.95370984, 'recall': 0.8944743, 'specificity': 0.8944743, 'f1': 0.91928697, 'auroc': 0.9553989, 'binary_precision': 0.97256565, 'binary_recall': 0.7965878, 'binary_specificity': 0.99236083, 'binary_f1_score': 0.87582445}
confusion matrix:
       0      1
0  42089    324
1   2933  11486
---- Validation: 
scalar performance:
{'acc': 0.652508, 'precision': 0.5192675, 'recall': 0.627375, 'specificity': 0.627375, 'f1': 0.44723368, 'auroc': 0.6862247, 'binary_precision': 0.0607793, 'binary_recall': 0.60029715, 'binary_specificity': 0.65445286, 'binary_f1_score': 0.11038253}
confusion matrix:
       0     1
0  11824  6243
1    269   404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49516597, 'precision': 0.5233036, 'recall': 0.6445962, 'specificity': 0.6445962, 'f1': 0.38227916, 'auroc': 0.72532535, 'binary_precision': 0.063771635, 'binary_recall': 0.8076923, 'binary_specificity': 0.48150018, 'binary_f1_score': 0.11820996}
confusion matrix:
      0     1
0  2863  3083
1    50   210
early stop counter: 1
val acc:0.652508020401001, best validation acc: 0.7926894426345825, corresponding to test acc:                         0.734772801399231 / 0.734772801399231
after epoch: 5,now: 2024-07-26 15:31:56.781349,epoch time: 0:13:04.459986,used: 1:27:33.256367,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_04_23_seed_1_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95857966, 'precision': 0.965068, 'recall': 0.92510056, 'specificity': 0.92510056, 'f1': 0.9429309, 'auroc': 0.9594892, 'binary_precision': 0.9767644, 'binary_recall': 0.857133, 'binary_specificity': 0.99306816, 'binary_f1_score': 0.9130467}
confusion matrix:
       0      1
0  42119    294
1   2060  12359
---- Validation: 
scalar performance:
{'acc': 0.95597655, 'precision': 0.48189694, 'recall': 0.49579343, 'specificity': 0.49579343, 'f1': 0.48874643, 'auroc': 0.68481785, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99158686, 'binary_f1_score': 0.0}
confusion matrix:
       0    1
0  17915  152
1    673    0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9506929, 'precision': 0.50796545, 'recall': 0.50164884, 'specificity': 0.50164884, 'f1': 0.49697077, 'auroc': 0.72410285, 'binary_precision': 0.057692308, 'binary_recall': 0.011538462, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.01923077}
confusion matrix:
      0   1
0  5897  49
1   257   3
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-26 15:45:00.668852,epoch time: 0:13:03.887503,used: 1:40:37.143870,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_04_23_seed_1_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96040964, 'precision': 0.9706938, 'recall': 0.92511857, 'specificity': 0.92511857, 'f1': 0.9451616, 'auroc': 0.9583817, 'binary_precision': 0.98899066, 'binary_recall': 0.8534674, 'binary_specificity': 0.9967698, 'binary_f1_score': 0.9162448}
confusion matrix:
       0      1
0  42275    137
1   2113  12307
---- Validation: 
scalar performance:
{'acc': 0.9170224, 'precision': 0.5009606, 'recall': 0.50134045, 'specificity': 0.50134045, 'f1': 0.50044084, 'auroc': 0.6511688, 'binary_precision': 0.03773585, 'binary_recall': 0.053491827, 'binary_specificity': 0.9491891, 'binary_f1_score': 0.044253223}
confusion matrix:
       0    1
0  17149  918
1    637   36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8983242, 'precision': 0.5082491, 'recall': 0.51293826, 'specificity': 0.51293826, 'f1': 0.5084561, 'auroc': 0.6849474, 'binary_precision': 0.057279237, 'binary_recall': 0.092307694, 'binary_specificity': 0.9335688, 'binary_f1_score': 0.0706922}
confusion matrix:
      0    1
0  5551  395
1   236   24
early stop counter: 1
val acc:0.9170224070549011, best validation acc: 0.9559765458106995, corresponding to test acc:                         0.950692892074585 / 0.950692892074585
after epoch: 7,now: 2024-07-26 16:09:05.091823,epoch time: 0:24:04.422971,used: 2:04:41.566841,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_04_23_seed_1_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95659137, 'precision': 0.97103226, 'recall': 0.91552305, 'specificity': 0.91552305, 'f1': 0.9392423, 'auroc': 0.9564518, 'binary_precision': 0.996098, 'binary_recall': 0.8321543, 'binary_specificity': 0.9988919, 'binary_f1_score': 0.9067755}
confusion matrix:
       0      1
0  42367     47
1   2420  11998
---- Validation: 
scalar performance:
{'acc': 0.9618997, 'precision': 0.48200437, 'recall': 0.49886534, 'specificity': 0.49886534, 'f1': 0.49028993, 'auroc': 0.70541304, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18026  41
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547212, 'precision': 0.4789814, 'recall': 0.4982341, 'specificity': 0.4982341, 'f1': 0.48841807, 'auroc': 0.73667574, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5925  21
1   260   0
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-26 16:24:23.460683,epoch time: 0:15:18.368860,used: 2:19:59.935701,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_04_23_seed_1_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96447426, 'precision': 0.97303176, 'recall': 0.9333298, 'specificity': 0.9333298, 'f1': 0.9511008, 'auroc': 0.96007335, 'binary_precision': 0.98849666, 'binary_recall': 0.8701019, 'binary_specificity': 0.99655765, 'binary_f1_score': 0.9255284}
confusion matrix:
       0      1
0  42267    146
1   1873  12546
---- Validation: 
scalar performance:
{'acc': 0.92203844, 'precision': 0.49563864, 'recall': 0.49464342, 'specificity': 0.49464342, 'f1': 0.49495518, 'auroc': 0.6429068, 'binary_precision': 0.027577939, 'binary_recall': 0.034175333, 'binary_specificity': 0.9551115, 'binary_f1_score': 0.03052422}
confusion matrix:
       0    1
0  17256  811
1    650   23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91105384, 'precision': 0.500978, 'recall': 0.5011915, 'specificity': 0.5011915, 'f1': 0.50081134, 'auroc': 0.67985463, 'binary_precision': 0.04375, 'binary_recall': 0.053846154, 'binary_specificity': 0.9485368, 'binary_f1_score': 0.048275862}
confusion matrix:
      0    1
0  5640  306
1   246   14
early stop counter: 1
val acc:0.9220384359359741, best validation acc: 0.9618996977806091, corresponding to test acc:                         0.954721212387085 / 0.954721212387085
after epoch: 9,now: 2024-07-26 16:37:08.199923,epoch time: 0:12:44.739240,used: 2:32:44.674941,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_04_23_seed_1_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9609375, 'precision': 0.97473, 'recall': 0.92331576, 'specificity': 0.92331576, 'f1': 0.9455839, 'auroc': 0.96462405, 'binary_precision': 0.9989366, 'binary_recall': 0.8469381, 'binary_specificity': 0.9996935, 'binary_f1_score': 0.9166792}
confusion matrix:
       0      1
0  42400     13
1   2207  12212
---- Validation: 
scalar performance:
{'acc': 0.95549625, 'precision': 0.48188815, 'recall': 0.49554437, 'specificity': 0.49554437, 'f1': 0.48862088, 'auroc': 0.5979849, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99108875, 'binary_f1_score': 0.0}
confusion matrix:
       0    1
0  17906  161
1    673    0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.950854, 'precision': 0.47889954, 'recall': 0.49621594, 'specificity': 0.49621594, 'f1': 0.48740396, 'auroc': 0.61742866, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5901  45
1   260   0
early stop counter: 2
val acc:0.9554962515830994, best validation acc: 0.9618996977806091, corresponding to test acc:                         0.954721212387085 / 0.954721212387085
after epoch: 10,now: 2024-07-26 16:49:41.840219,epoch time: 0:12:33.640296,used: 2:45:18.315237,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_04_23_seed_1_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96109587, 'precision': 0.9559666, 'recall': 0.94022477, 'specificity': 0.94022477, 'f1': 0.9477445, 'auroc': 0.969288, 'binary_precision': 0.94607234, 'binary_recall': 0.8978502, 'binary_specificity': 0.98259926, 'binary_f1_score': 0.92133075}
confusion matrix:
       0      1
0  41674    738
1   1473  12947
---- Validation: 
scalar performance:
{'acc': 0.5186233, 'precision': 0.51307786, 'recall': 0.5944177, 'specificity': 0.5944177, 'f1': 0.3820897, 'auroc': 0.66946566, 'binary_precision': 0.049146686, 'binary_recall': 0.67607725, 'binary_specificity': 0.5127581, 'binary_f1_score': 0.09163226}
confusion matrix:
      0     1
0  9264  8803
1   218   455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.23300032, 'precision': 0.5154551, 'recall': 0.56111217, 'specificity': 0.56111217, 'f1': 0.21387456, 'auroc': 0.6661427, 'binary_precision': 0.04801125, 'binary_recall': 0.91923076, 'binary_specificity': 0.20299362, 'binary_f1_score': 0.09125621}
confusion matrix:
      0     1
0  1207  4739
1    21   239
early stop counter: 3
val acc:0.5186232924461365, best validation acc: 0.9618996977806091, corresponding to test acc:                         0.954721212387085 / 0.954721212387085
after epoch: 11,now: 2024-07-26 17:02:12.733108,epoch time: 0:12:30.892889,used: 2:57:49.208126,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_04_23_seed_1_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9664977, 'precision': 0.9775189, 'recall': 0.9347497, 'specificity': 0.9347497, 'f1': 0.95375574, 'auroc': 0.97126853, 'binary_precision': 0.9972977, 'binary_recall': 0.870301, 'binary_specificity': 0.9991984, 'binary_f1_score': 0.92948145}
confusion matrix:
       0      1
0  42380     34
1   1870  12548
---- Validation: 
scalar performance:
{'acc': 0.95896477, 'precision': 0.4819513, 'recall': 0.4973432, 'specificity': 0.4973432, 'f1': 0.48952627, 'auroc': 0.69696534, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  17971  96
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9502095, 'precision': 0.47888583, 'recall': 0.4958796, 'specificity': 0.4958796, 'f1': 0.48723456, 'auroc': 0.66591763, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5897  49
1   260   0
early stop counter: 4
val acc:0.9589647650718689, best validation acc: 0.9618996977806091, corresponding to test acc:                         0.954721212387085 / 0.954721212387085
after epoch: 12,now: 2024-07-26 17:14:53.640743,epoch time: 0:12:40.907635,used: 3:10:30.115761,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_04_23_seed_1_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95801663, 'precision': 0.96042424, 'recall': 0.92767584, 'specificity': 0.92767584, 'f1': 0.9425758, 'auroc': 0.9636133, 'binary_precision': 0.96484584, 'binary_recall': 0.86607945, 'binary_specificity': 0.9892722, 'binary_f1_score': 0.91279876}
confusion matrix:
       0      1
0  41958    455
1   1931  12488
---- Validation: 
scalar performance:
{'acc': 0.5441302, 'precision': 0.5109027, 'recall': 0.57832026, 'specificity': 0.57832026, 'f1': 0.39221686, 'auroc': 0.58021796, 'binary_precision': 0.047597148, 'binary_recall': 0.615156, 'binary_specificity': 0.5414845, 'binary_f1_score': 0.088357694}
confusion matrix:
      0     1
0  9783  8284
1   259   414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.26071543, 'precision': 0.5169251, 'recall': 0.57373667, 'specificity': 0.57373667, 'f1': 0.23480463, 'auroc': 0.6062751, 'binary_precision': 0.049542047, 'binary_recall': 0.9153846, 'binary_specificity': 0.2320888, 'binary_f1_score': 0.09399684}
confusion matrix:
      0     1
0  1380  4566
1    22   238
early stop counter: 5
val acc:0.5441302061080933, best validation acc: 0.9618996977806091, corresponding to test acc:                         0.954721212387085 / 0.954721212387085
after epoch: 13,now: 2024-07-26 17:27:15.101721,epoch time: 0:12:21.460978,used: 3:22:51.576739,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_04_23_seed_1_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 3:22:51.576739 at 2024-07-26 17:27:15.101721
persisted model performance metric: 

scalar performance:
{'acc': 0.9547212, 'precision': 0.4789814, 'recall': 0.4982341, 'specificity': 0.4982341, 'f1': 0.48841807, 'auroc': 0.73667574, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5925  21
1   260   0
oracle model performance metric: 

scalar performance:
{'acc': 0.9547212, 'precision': 0.4789814, 'recall': 0.4982341, 'specificity': 0.4982341, 'f1': 0.48841807, 'auroc': 0.73667574, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5925  21
1   260   0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 501461 KiB |   3691 MiB |    833 TiB |    833 TiB |
|       from large pool | 460368 KiB |   3658 MiB |    828 TiB |    828 TiB |
|       from small pool |  41093 KiB |     57 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 501461 KiB |   3691 MiB |    833 TiB |    833 TiB |
|       from large pool | 460368 KiB |   3658 MiB |    828 TiB |    828 TiB |
|       from small pool |  41093 KiB |     57 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496647 KiB |   3689 MiB |    833 TiB |    833 TiB |
|       from large pool | 455971 KiB |   3656 MiB |    828 TiB |    828 TiB |
|       from small pool |  40676 KiB |     56 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4116 MiB |   4116 MiB |   7030 MiB |   2914 MiB |
|       from large pool |   4052 MiB |   4052 MiB |   6948 MiB |   2896 MiB |
|       from small pool |     64 MiB |     64 MiB |     82 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 596266 KiB | 726430 KiB | 488405 GiB | 488405 GiB |
|       from large pool | 590256 KiB | 710226 KiB | 482651 GiB | 482651 GiB |
|       from small pool |   6010 KiB |  20927 KiB |   5753 GiB |   5753 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2300    |    4549    |   81167 K  |   81165 K  |
|       from large pool |     187    |     311    |   39630 K  |   39630 K  |
|       from small pool |    2113    |    4361    |   41537 K  |   41535 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2300    |    4549    |   81167 K  |   81165 K  |
|       from large pool |     187    |     311    |   39630 K  |   39630 K  |
|       from small pool |    2113    |    4361    |   41537 K  |   41535 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     150    |     150    |     236    |      86    |
|       from large pool |     118    |     118    |     195    |      77    |
|       from small pool |      32    |      32    |      41    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    1835    |   47740 K  |   47740 K  |
|       from large pool |      38    |     117    |   31983 K  |   31983 K  |
|       from small pool |      32    |    1803    |   15756 K  |   15756 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   3691 MiB |    833 TiB |    833 TiB |
|       from large pool |  65536 KiB |   3658 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     57 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   3691 MiB |    833 TiB |    833 TiB |
|       from large pool |  65536 KiB |   3658 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     57 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   3689 MiB |    833 TiB |    833 TiB |
|       from large pool |  65536 KiB |   3656 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     56 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1072 MiB |   4116 MiB |   7030 MiB |   5958 MiB |
|       from large pool |   1026 MiB |   4052 MiB |   6948 MiB |   5922 MiB |
|       from small pool |     46 MiB |     64 MiB |     82 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 726430 KiB | 488405 GiB | 488405 GiB |
|       from large pool |      0 B   | 710226 KiB | 482651 GiB | 482651 GiB |
|       from small pool |      0 B   |  22981 KiB |   5753 GiB |   5753 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4549    |   81167 K  |   81167 K  |
|       from large pool |       2    |     311    |   39630 K  |   39630 K  |
|       from small pool |       0    |    4361    |   41537 K  |   41537 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4549    |   81167 K  |   81167 K  |
|       from large pool |       2    |     311    |   39630 K  |   39630 K  |
|       from small pool |       0    |    4361    |   41537 K  |   41537 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     150    |     236    |     171    |
|       from large pool |      42    |     118    |     195    |     153    |
|       from small pool |      23    |      32    |      41    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    1835    |   47741 K  |   47741 K  |
|       from large pool |       0    |     117    |   31983 K  |   31983 K  |
|       from small pool |       0    |    1803    |   15757 K  |   15757 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   3691 MiB |    833 TiB |    833 TiB |
|       from large pool |  65536 KiB |   3658 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     57 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   3691 MiB |    833 TiB |    833 TiB |
|       from large pool |  65536 KiB |   3658 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     57 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   3689 MiB |    833 TiB |    833 TiB |
|       from large pool |  65536 KiB |   3656 MiB |    828 TiB |    828 TiB |
|       from small pool |      0 KiB |     56 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1072 MiB |   4116 MiB |   7030 MiB |   5958 MiB |
|       from large pool |   1026 MiB |   4052 MiB |   6948 MiB |   5922 MiB |
|       from small pool |     46 MiB |     64 MiB |     82 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 726430 KiB | 488405 GiB | 488405 GiB |
|       from large pool |      0 B   | 710226 KiB | 482651 GiB | 482651 GiB |
|       from small pool |      0 B   |  22981 KiB |   5753 GiB |   5753 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4549    |   81167 K  |   81167 K  |
|       from large pool |       2    |     311    |   39630 K  |   39630 K  |
|       from small pool |       0    |    4361    |   41537 K  |   41537 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4549    |   81167 K  |   81167 K  |
|       from large pool |       2    |     311    |   39630 K  |   39630 K  |
|       from small pool |       0    |    4361    |   41537 K  |   41537 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     150    |     236    |     171    |
|       from large pool |      42    |     118    |     195    |     153    |
|       from small pool |      23    |      32    |      41    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    1835    |   47741 K  |   47741 K  |
|       from large pool |       0    |     117    |   31983 K  |   31983 K  |
|       from small pool |       0    |    1803    |   15757 K  |   15757 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_32_32_seed_2_23070000

 Experiment start at: 2024-07-26 17:32:32.181202
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91410166, 'precision': 0.9180769, 'recall': 0.85607415, 'specificity': 0.85607415, 'f1': 0.8809475, 'auroc': 0.9284307, 'binary_precision': 0.92490417, 'binary_recall': 0.7334435, 'binary_specificity': 0.9787048, 'binary_f1_score': 0.8181215}
confusion matrix:
       0      1
0  41409    901
1   4033  11097
---- Validation: 
scalar performance:
{'acc': 0.63543385, 'precision': 0.5206234, 'recall': 0.65588653, 'specificity': 0.65588653, 'f1': 0.43876195, 'auroc': 0.7310801, 'binary_precision': 0.057806745, 'binary_recall': 0.6777409, 'binary_specificity': 0.63403225, 'binary_f1_score': 0.106527425}
confusion matrix:
       0     1
0  11521  6650
1    194   408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6493028, 'precision': 0.532064, 'recall': 0.7005937, 'specificity': 0.7005937, 'f1': 0.46141446, 'auroc': 0.7633259, 'binary_precision': 0.07915225, 'binary_recall': 0.75619835, 'binary_specificity': 0.64498913, 'binary_f1_score': 0.14330462}
confusion matrix:
      0     1
0  3868  2129
1    59   183
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 17:46:05.449300,epoch time: 0:13:33.268098,used: 0:13:33.268098,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_32_32_seed_2_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94397634, 'precision': 0.9633379, 'recall': 0.8945185, 'specificity': 0.8945185, 'f1': 0.9223409, 'auroc': 0.9515062, 'binary_precision': 0.9965813, 'binary_recall': 0.7900059, 'binary_specificity': 0.999031, 'binary_f1_score': 0.8813509}
confusion matrix:
       0      1
0  42270     41
1   3177  11952
---- Validation: 
scalar performance:
{'acc': 0.95408297, 'precision': 0.48374116, 'recall': 0.49284574, 'specificity': 0.49284574, 'f1': 0.488251, 'auroc': 0.6457674, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9856915, 'binary_f1_score': 0.0}
confusion matrix:
       0    1
0  17911  260
1    602    0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95768553, 'precision': 0.48053724, 'recall': 0.49816576, 'specificity': 0.49816576, 'f1': 0.48919272, 'auroc': 0.6986965, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5975  22
1   242   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 17:59:28.522168,epoch time: 0:13:23.072868,used: 0:26:56.340966,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_32_32_seed_2_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95391715, 'precision': 0.9697492, 'recall': 0.913098, 'specificity': 0.913098, 'f1': 0.93698776, 'auroc': 0.9593433, 'binary_precision': 0.99784636, 'binary_recall': 0.8268341, 'binary_specificity': 0.9993619, 'binary_f1_score': 0.90432644}
confusion matrix:
       0      1
0  42283     27
1   2620  12510
---- Validation: 
scalar performance:
{'acc': 0.95184577, 'precision': 0.4853742, 'recall': 0.4924931, 'specificity': 0.4924931, 'f1': 0.48876753, 'auroc': 0.6046984, 'binary_precision': 0.0032894737, 'binary_recall': 0.0016611295, 'binary_specificity': 0.98332506, 'binary_f1_score': 0.0022075053}
confusion matrix:
       0    1
0  17868  303
1    601    1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9498317, 'precision': 0.49386543, 'recall': 0.49804586, 'specificity': 0.49804586, 'f1': 0.49344015, 'auroc': 0.6673282, 'binary_precision': 0.026666667, 'binary_recall': 0.008264462, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.012618296}
confusion matrix:
      0   1
0  5924  73
1   240   2
early stop counter: 1
val acc:0.9518457651138306, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.9576855301856995 / 0.9576855301856995
after epoch: 3,now: 2024-07-26 18:12:20.193981,epoch time: 0:12:51.671813,used: 0:39:48.012779,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_32_32_seed_2_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9475104, 'precision': 0.9491731, 'recall': 0.9139291, 'specificity': 0.9139291, 'f1': 0.9296913, 'auroc': 0.95079386, 'binary_precision': 0.9522885, 'binary_recall': 0.842961, 'binary_specificity': 0.9848972, 'binary_f1_score': 0.8942958}
confusion matrix:
       0      1
0  41671    639
1   2376  12754
---- Validation: 
scalar performance:
{'acc': 0.88840353, 'precision': 0.5295558, 'recall': 0.5825875, 'specificity': 0.5825875, 'f1': 0.5342798, 'auroc': 0.6853966, 'binary_precision': 0.08550805, 'binary_recall': 0.25581396, 'binary_specificity': 0.90936106, 'binary_f1_score': 0.12817311}
confusion matrix:
       0     1
0  16524  1647
1    448   154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90270877, 'precision': 0.51149064, 'recall': 0.5191366, 'specificity': 0.5191366, 'f1': 0.5123771, 'auroc': 0.67926663, 'binary_precision': 0.060240965, 'binary_recall': 0.10330579, 'binary_specificity': 0.93496746, 'binary_f1_score': 0.0761035}
confusion matrix:
      0    1
0  5607  390
1   217   25
early stop counter: 2
val acc:0.8884035348892212, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.9576855301856995 / 0.9576855301856995
after epoch: 4,now: 2024-07-26 18:25:05.788687,epoch time: 0:12:45.594706,used: 0:52:33.607485,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_32_32_seed_2_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.88266015, 'precision': 0.9248922, 'recall': 0.77995986, 'specificity': 0.77995986, 'f1': 0.82125866, 'auroc': 0.92171955, 'binary_precision': 0.98530775, 'binary_recall': 0.56292135, 'binary_specificity': 0.99699837, 'binary_f1_score': 0.71649706}
confusion matrix:
       0     1
0  42183   127
1   6613  8517
---- Validation: 
scalar performance:
{'acc': 0.96180683, 'precision': 0.4838675, 'recall': 0.49683562, 'specificity': 0.49683562, 'f1': 0.49026582, 'auroc': 0.68377674, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99367124, 'binary_f1_score': 0.0}
confusion matrix:
       0    1
0  18056  115
1    602    0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.5191072, 'recall': 0.5010656, 'specificity': 0.5010656, 'f1': 0.4935722, 'auroc': 0.72812575, 'binary_precision': 0.07692308, 'binary_recall': 0.004132231, 'binary_specificity': 0.997999, 'binary_f1_score': 0.007843137}
confusion matrix:
      0   1
0  5985  12
1   241   1
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-26 18:37:46.803312,epoch time: 0:12:41.014625,used: 1:05:14.622110,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_32_32_seed_2_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.92825556, 'precision': 0.9300926, 'recall': 0.8817668, 'specificity': 0.8817668, 'f1': 0.9022885, 'auroc': 0.9422338, 'binary_precision': 0.93338585, 'binary_recall': 0.7835283, 'binary_specificity': 0.9800052, 'binary_f1_score': 0.8519171}
confusion matrix:
       0      1
0  41465    846
1   3275  11854
---- Validation: 
scalar performance:
{'acc': 0.116017684, 'precision': 0.51545155, 'recall': 0.5385475, 'specificity': 0.5385475, 'f1': 0.113572404, 'auroc': 0.72614384, 'binary_precision': 0.03468141, 'binary_recall': 0.9900332, 'binary_specificity': 0.0870618, 'binary_f1_score': 0.06701524}
confusion matrix:
      0      1
0  1582  16589
1     6    596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.066997916, 'precision': 0.5199571, 'recall': 0.514674, 'specificity': 0.514674, 'f1': 0.066893496, 'auroc': 0.73130345, 'binary_precision': 0.039914235, 'binary_recall': 1.0, 'binary_specificity': 0.029348006, 'binary_f1_score': 0.07676447}
confusion matrix:
     0     1
0  176  5821
1    0   242
early stop counter: 1
val acc:0.11601768434047699, best validation acc: 0.9618068337440491, corresponding to test acc:                         0.9594486355781555 / 0.9594486355781555
after epoch: 6,now: 2024-07-26 18:50:11.431457,epoch time: 0:12:24.628145,used: 1:17:39.250255,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_32_32_seed_2_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93555015, 'precision': 0.948671, 'recall': 0.8850269, 'specificity': 0.8850269, 'f1': 0.91095495, 'auroc': 0.9567102, 'binary_precision': 0.97137433, 'binary_recall': 0.7782551, 'binary_specificity': 0.99179864, 'binary_f1_score': 0.8641567}
confusion matrix:
       0      1
0  41963    347
1   3355  11775
---- Validation: 
scalar performance:
{'acc': 0.62893516, 'precision': 0.5207685, 'recall': 0.6581509, 'specificity': 0.6581509, 'f1': 0.4361568, 'auroc': 0.71360946, 'binary_precision': 0.057686962, 'binary_recall': 0.6893688, 'binary_specificity': 0.62693304, 'binary_f1_score': 0.10646485}
confusion matrix:
       0     1
0  11392  6779
1    187   415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58695304, 'precision': 0.52613145, 'recall': 0.67212635, 'specificity': 0.67212635, 'f1': 0.42758527, 'auroc': 0.72594976, 'binary_precision': 0.06839187, 'binary_recall': 0.7644628, 'binary_specificity': 0.5797899, 'binary_f1_score': 0.12555142}
confusion matrix:
      0     1
0  3477  2520
1    57   185
early stop counter: 2
val acc:0.6289351582527161, best validation acc: 0.9618068337440491, corresponding to test acc:                         0.9594486355781555 / 0.9594486355781555
after epoch: 7,now: 2024-07-26 19:02:59.919340,epoch time: 0:12:48.487883,used: 1:30:27.738138,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_32_32_seed_2_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94399375, 'precision': 0.93189085, 'recall': 0.9224963, 'specificity': 0.9224963, 'f1': 0.92704934, 'auroc': 0.9584274, 'binary_precision': 0.9072264, 'binary_recall': 0.8770654, 'binary_specificity': 0.9679272, 'binary_f1_score': 0.89189106}
confusion matrix:
       0      1
0  40953   1357
1   1860  13270
---- Validation: 
scalar performance:
{'acc': 0.10696213, 'precision': 0.5128139, 'recall': 0.5290514, 'specificity': 0.5290514, 'f1': 0.105221495, 'auroc': 0.6740955, 'binary_precision': 0.03401949, 'binary_recall': 0.9800664, 'binary_specificity': 0.078036435, 'binary_f1_score': 0.06575648}
confusion matrix:
      0      1
0  1418  16753
1    12    590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.054015066, 'precision': 0.51969403, 'recall': 0.5079206, 'specificity': 0.5079206, 'f1': 0.053489614, 'auroc': 0.711017, 'binary_precision': 0.03938802, 'binary_recall': 1.0, 'binary_specificity': 0.015841253, 'binary_f1_score': 0.075790785}
confusion matrix:
    0     1
0  95  5902
1   0   242
early stop counter: 3
val acc:0.10696212947368622, best validation acc: 0.9618068337440491, corresponding to test acc:                         0.9594486355781555 / 0.9594486355781555
after epoch: 8,now: 2024-07-26 19:16:04.056233,epoch time: 0:13:04.136893,used: 1:43:31.875031,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_32_32_seed_2_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95546657, 'precision': 0.9660239, 'recall': 0.91951054, 'specificity': 0.91951054, 'f1': 0.9397165, 'auroc': 0.96393263, 'binary_precision': 0.9852532, 'binary_recall': 0.8435352, 'binary_specificity': 0.9954859, 'binary_f1_score': 0.9089031}
confusion matrix:
       0      1
0  42121    191
1   2367  12761
---- Validation: 
scalar performance:
{'acc': 0.8553774, 'precision': 0.48713568, 'recall': 0.45791888, 'specificity': 0.45791888, 'f1': 0.4682408, 'auroc': 0.6049435, 'binary_precision': 0.009289363, 'binary_recall': 0.03322259, 'binary_specificity': 0.88261515, 'binary_f1_score': 0.014519054}
confusion matrix:
       0     1
0  16038  2133
1    582    20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8807501, 'precision': 0.49517408, 'recall': 0.48986956, 'specificity': 0.48986956, 'f1': 0.48882908, 'auroc': 0.57996976, 'binary_precision': 0.029962547, 'binary_recall': 0.0661157, 'binary_specificity': 0.91362345, 'binary_f1_score': 0.041237116}
confusion matrix:
      0    1
0  5479  518
1   226   16
early stop counter: 4
val acc:0.8553773760795593, best validation acc: 0.9618068337440491, corresponding to test acc:                         0.9594486355781555 / 0.9594486355781555
after epoch: 9,now: 2024-07-26 19:28:39.254331,epoch time: 0:12:35.198098,used: 1:56:07.073129,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_32_32_seed_2_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9576776, 'precision': 0.9699006, 'recall': 0.9218283, 'specificity': 0.9218283, 'f1': 0.94264454, 'auroc': 0.9626392, 'binary_precision': 0.9920949, 'binary_recall': 0.8460674, 'binary_specificity': 0.99758923, 'binary_f1_score': 0.9132808}
confusion matrix:
       0      1
0  42208    102
1   2329  12801
---- Validation: 
scalar performance:
{'acc': 0.91157514, 'precision': 0.484003, 'recall': 0.47249377, 'specificity': 0.47249377, 'f1': 0.47807053, 'auroc': 0.56704366, 'binary_precision': 0.0018832391, 'binary_recall': 0.003322259, 'binary_specificity': 0.9416653, 'binary_f1_score': 0.0024038462}
confusion matrix:
       0     1
0  17111  1060
1    600     2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9294759, 'precision': 0.48507306, 'recall': 0.48745725, 'specificity': 0.48745725, 'f1': 0.48622298, 'auroc': 0.5757108, 'binary_precision': 0.00990099, 'binary_recall': 0.008264462, 'binary_specificity': 0.96665, 'binary_f1_score': 0.009009008}
confusion matrix:
      0    1
0  5797  200
1   240    2
early stop counter: 5
val acc:0.9115751385688782, best validation acc: 0.9618068337440491, corresponding to test acc:                         0.9594486355781555 / 0.9594486355781555
after epoch: 10,now: 2024-07-26 19:40:57.296401,epoch time: 0:12:18.042070,used: 2:08:25.115199,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_32_32_seed_2_23070000
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 2:08:25.115199 at 2024-07-26 19:40:57.296401
persisted model performance metric: 

scalar performance:
{'acc': 0.95944864, 'precision': 0.5191072, 'recall': 0.5010656, 'specificity': 0.5010656, 'f1': 0.4935722, 'auroc': 0.72812575, 'binary_precision': 0.07692308, 'binary_recall': 0.004132231, 'binary_specificity': 0.997999, 'binary_f1_score': 0.007843137}
confusion matrix:
      0   1
0  5985  12
1   241   1
oracle model performance metric: 

scalar performance:
{'acc': 0.95944864, 'precision': 0.5191072, 'recall': 0.5010656, 'specificity': 0.5010656, 'f1': 0.4935722, 'auroc': 0.72812575, 'binary_precision': 0.07692308, 'binary_recall': 0.004132231, 'binary_specificity': 0.997999, 'binary_f1_score': 0.007843137}
confusion matrix:
      0   1
0  5985  12
1   241   1
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 501464 KiB |   3691 MiB |   1215 TiB |   1215 TiB |
|       from large pool | 460368 KiB |   3658 MiB |   1208 TiB |   1208 TiB |
|       from small pool |  41096 KiB |     57 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 501464 KiB |   3691 MiB |   1215 TiB |   1215 TiB |
|       from large pool | 460368 KiB |   3658 MiB |   1208 TiB |   1208 TiB |
|       from small pool |  41096 KiB |     57 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496649 KiB |   3689 MiB |   1215 TiB |   1215 TiB |
|       from large pool | 455971 KiB |   3656 MiB |   1207 TiB |   1207 TiB |
|       from small pool |  40678 KiB |     56 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4124 MiB |   4124 MiB |  10082 MiB |   5958 MiB |
|       from large pool |   4060 MiB |   4060 MiB |   9982 MiB |   5922 MiB |
|       from small pool |     64 MiB |     64 MiB |    100 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 575783 KiB | 726430 KiB | 701132 GiB | 701131 GiB |
|       from large pool | 569776 KiB | 710226 KiB | 692720 GiB | 692719 GiB |
|       from small pool |   6007 KiB |  22981 KiB |   8412 GiB |   8412 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2306    |    4575    |  118386 K  |  118384 K  |
|       from large pool |     187    |     311    |   57806 K  |   57806 K  |
|       from small pool |    2119    |    4387    |   60580 K  |   60578 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2306    |    4575    |  118386 K  |  118384 K  |
|       from large pool |     187    |     311    |   57806 K  |   57806 K  |
|       from small pool |    2119    |    4387    |   60580 K  |   60578 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     157    |     157    |     328    |     171    |
|       from large pool |     125    |     125    |     278    |     153    |
|       from small pool |      32    |      32    |      50    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      65    |    1851    |   69741 K  |   69741 K  |
|       from large pool |      36    |     123    |   46863 K  |   46863 K  |
|       from small pool |      29    |    1815    |   22877 K  |   22877 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   3691 MiB |   1215 TiB |   1215 TiB |
|       from large pool |  65536 KiB |   3658 MiB |   1208 TiB |   1208 TiB |
|       from small pool |      0 KiB |     57 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   3691 MiB |   1215 TiB |   1215 TiB |
|       from large pool |  65536 KiB |   3658 MiB |   1208 TiB |   1208 TiB |
|       from small pool |      0 KiB |     57 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   3689 MiB |   1215 TiB |   1215 TiB |
|       from large pool |  65536 KiB |   3656 MiB |   1207 TiB |   1207 TiB |
|       from small pool |      0 KiB |     56 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1052 MiB |   4124 MiB |  10082 MiB |   9030 MiB |
|       from large pool |   1006 MiB |   4060 MiB |   9982 MiB |   8976 MiB |
|       from small pool |     46 MiB |     64 MiB |    100 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 726430 KiB | 701132 GiB | 701132 GiB |
|       from large pool |      0 B   | 710226 KiB | 692720 GiB | 692720 GiB |
|       from small pool |      0 B   |  22981 KiB |   8412 GiB |   8412 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4575    |  118386 K  |  118386 K  |
|       from large pool |       2    |     311    |   57806 K  |   57806 K  |
|       from small pool |       0    |    4387    |   60580 K  |   60580 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4575    |  118386 K  |  118386 K  |
|       from large pool |       2    |     311    |   57806 K  |   57806 K  |
|       from small pool |       0    |    4387    |   60580 K  |   60580 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     157    |     328    |     264    |
|       from large pool |      41    |     125    |     278    |     237    |
|       from small pool |      23    |      32    |      50    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    1851    |   69742 K  |   69742 K  |
|       from large pool |       0    |     123    |   46863 K  |   46863 K  |
|       from small pool |       0    |    1815    |   22878 K  |   22878 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 19:41:44 2024]
Finished job 0.
1 of 1 steps (100%) done
