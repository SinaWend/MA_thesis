Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 19:43:18 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006

 Experiment start at: 2024-07-26 19:51:18.936378
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.992777, 'precision': 0.9923728, 'recall': 0.988729, 'specificity': 0.988729, 'f1': 0.9905331, 'auroc': 0.99897724, 'binary_precision': 0.9915475, 'binary_recall': 0.9803642, 'binary_specificity': 0.99709374, 'binary_f1_score': 0.9859242}
confusion matrix:
       0      1
0  42199    123
1    289  14429
---- Validation: 
scalar performance:
{'acc': 0.9618987, 'precision': 0.72108555, 'recall': 0.7860101, 'specificity': 0.7860101, 'f1': 0.7488432, 'auroc': 0.93611276, 'binary_precision': 0.4565993, 'binary_recall': 0.59720063, 'binary_specificity': 0.97481954, 'binary_f1_score': 0.51752025}
confusion matrix:
       0    1
0  17692  457
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.78360367, 'recall': 0.7711059, 'specificity': 0.7711059, 'f1': 0.7771957, 'auroc': 0.9211726, 'binary_precision': 0.5863454, 'binary_recall': 0.55938697, 'binary_specificity': 0.98282474, 'binary_f1_score': 0.572549}
confusion matrix:
      0    1
0  5894  103
1   115  146
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 20:05:35.202399,epoch time: 0:14:16.266021,used: 0:14:16.266021,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9944425, 'precision': 0.9962134, 'recall': 0.9892966, 'specificity': 0.9892966, 'f1': 0.99269193, 'auroc': 0.99961865, 'binary_precision': 0.99979174, 'binary_recall': 0.9786641, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9891152}
confusion matrix:
       0      1
0  42320      3
1    314  14403
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.8172887, 'recall': 0.5320808, 'specificity': 0.5320808, 'f1': 0.55105686, 'auroc': 0.9463044, 'binary_precision': 0.6666667, 'binary_recall': 0.065318815, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.11898017}
confusion matrix:
       0   1
0  18128  21
1    601  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.9484966, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
better model found
persisted
after epoch: 2,now: 2024-07-26 20:19:17.715721,epoch time: 0:13:42.513322,used: 0:27:58.779343,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99588007, 'precision': 0.996874, 'recall': 0.99236965, 'specificity': 0.99236965, 'f1': 0.99459505, 'auroc': 0.9996743, 'binary_precision': 0.9988975, 'binary_recall': 0.98511726, 'binary_specificity': 0.999622, 'binary_f1_score': 0.9919595}
confusion matrix:
       0      1
0  42309     16
1    219  14496
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.76743424, 'recall': 0.73114234, 'specificity': 0.73114234, 'f1': 0.74782825, 'auroc': 0.9453454, 'binary_precision': 0.5533454, 'binary_recall': 0.47589424, 'binary_specificity': 0.9863904, 'binary_f1_score': 0.5117057}
confusion matrix:
       0    1
0  17902  247
1    337  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.79054964, 'recall': 0.63784385, 'specificity': 0.63784385, 'f1': 0.684075, 'auroc': 0.9345257, 'binary_precision': 0.61157024, 'binary_recall': 0.2835249, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.38743457}
confusion matrix:
      0   1
0  5950  47
1   187  74
better model found
persisted
after epoch: 3,now: 2024-07-26 20:33:01.734078,epoch time: 0:13:44.018357,used: 0:41:42.797700,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.996406, 'precision': 0.99619555, 'recall': 0.9944086, 'specificity': 0.9944086, 'f1': 0.9952978, 'auroc': 0.99979115, 'binary_precision': 0.9957633, 'binary_recall': 0.990282, 'binary_specificity': 0.99853516, 'binary_f1_score': 0.99301505}
confusion matrix:
       0      1
0  42263     62
1    143  14572
---- Validation: 
scalar performance:
{'acc': 0.97094506, 'precision': 0.7941388, 'recall': 0.70668733, 'specificity': 0.70668733, 'f1': 0.74206066, 'auroc': 0.95836306, 'binary_precision': 0.60850114, 'binary_recall': 0.4230171, 'binary_specificity': 0.9903576, 'binary_f1_score': 0.49908257}
confusion matrix:
       0    1
0  17974  175
1    371  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7469021, 'recall': 0.56446517, 'specificity': 0.56446517, 'f1': 0.59649134, 'auroc': 0.9194597, 'binary_precision': 0.530303, 'binary_recall': 0.13409962, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.21406728}
confusion matrix:
      0   1
0  5966  31
1   226  35
better model found
persisted
after epoch: 4,now: 2024-07-26 20:46:47.778147,epoch time: 0:13:46.044069,used: 0:55:28.841769,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9968969, 'precision': 0.9956541, 'recall': 0.99624676, 'specificity': 0.99624676, 'f1': 0.99595, 'auroc': 0.9998523, 'binary_precision': 0.99308145, 'binary_recall': 0.9949035, 'binary_specificity': 0.99759, 'binary_f1_score': 0.9939917}
confusion matrix:
       0      1
0  42222    102
1     75  14641
---- Validation: 
scalar performance:
{'acc': 0.965943, 'precision': 0.7429799, 'recall': 0.762602, 'specificity': 0.762602, 'f1': 0.752365, 'auroc': 0.95516753, 'binary_precision': 0.5021521, 'binary_recall': 0.5443235, 'binary_specificity': 0.9808805, 'binary_f1_score': 0.52238804}
confusion matrix:
       0    1
0  17802  347
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.83742183, 'recall': 0.5282354, 'specificity': 0.5282354, 'f1': 0.54289234, 'auroc': 0.9516487, 'binary_precision': 0.71428573, 'binary_recall': 0.057471264, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.10638297}
confusion matrix:
      0   1
0  5991   6
1   246  15
early stop counter: 1
val acc:0.9659429788589478, best validation acc: 0.9709450602531433, corresponding to test acc:                         0.9589325785636902 / 0.9651646018028259
after epoch: 5,now: 2024-07-26 21:00:24.097711,epoch time: 0:13:36.319564,used: 1:09:05.161333,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99796635, 'precision': 0.9982295, 'recall': 0.9964579, 'specificity': 0.9964579, 'f1': 0.99733955, 'auroc': 0.9999169, 'binary_precision': 0.99877024, 'binary_recall': 0.993341, 'binary_specificity': 0.9995747, 'binary_f1_score': 0.9960482}
confusion matrix:
       0      1
0  42305     18
1     98  14619
---- Validation: 
scalar performance:
{'acc': 0.97227544, 'precision': 0.86063486, 'recall': 0.6421213, 'specificity': 0.6421213, 'f1': 0.70053244, 'auroc': 0.9600394, 'binary_precision': 0.74596775, 'binary_recall': 0.28771386, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.41526374}
confusion matrix:
       0    1
0  18086   63
1    458  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.67928994, 'recall': 0.5035813, 'specificity': 0.5035813, 'f1': 0.49682495, 'auroc': 0.94359505, 'binary_precision': 0.4, 'binary_recall': 0.007662835, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.015037594}
confusion matrix:
      0  1
0  5994  3
1   259  2
better model found
persisted
after epoch: 6,now: 2024-07-26 21:14:07.447351,epoch time: 0:13:43.349640,used: 1:22:48.510973,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99712485, 'precision': 0.9980701, 'recall': 0.9944271, 'specificity': 0.9944271, 'f1': 0.9962311, 'auroc': 0.9997728, 'binary_precision': 1.0, 'binary_recall': 0.98885417, 'binary_specificity': 1.0, 'binary_f1_score': 0.99439585}
confusion matrix:
       0      1
0  42326      0
1    164  14550
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.88926554, 'recall': 0.5362444, 'specificity': 0.5362444, 'f1': 0.55881834, 'auroc': 0.9622247, 'binary_precision': 0.8103448, 'binary_recall': 0.07309487, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.13409415}
confusion matrix:
       0   1
0  18138  11
1    596  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.9443708, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
early stop counter: 1
val acc:0.9676989912986755, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9581335783004761 / 0.9651646018028259
after epoch: 7,now: 2024-07-26 21:28:04.613698,epoch time: 0:13:57.166347,used: 1:36:45.677320,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9957398, 'precision': 0.99308246, 'recall': 0.9958441, 'specificity': 0.9958441, 'f1': 0.994453, 'auroc': 0.99980396, 'binary_precision': 0.9875396, 'binary_recall': 0.9960598, 'binary_specificity': 0.99562854, 'binary_f1_score': 0.99178135}
confusion matrix:
       0      1
0  42135    185
1     58  14662
---- Validation: 
scalar performance:
{'acc': 0.96248406, 'precision': 0.7303045, 'recall': 0.8590685, 'specificity': 0.8590685, 'f1': 0.778728, 'auroc': 0.95609987, 'binary_precision': 0.46972656, 'binary_recall': 0.748056, 'binary_specificity': 0.970081, 'binary_f1_score': 0.5770846}
confusion matrix:
       0    1
0  17606  543
1    162  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9533397, 'precision': 0.6745865, 'recall': 0.5908644, 'specificity': 0.5908644, 'f1': 0.6173974, 'auroc': 0.9098203, 'binary_precision': 0.38345864, 'binary_recall': 0.1954023, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.25888324}
confusion matrix:
      0   1
0  5915  82
1   210  51
early stop counter: 2
val acc:0.9624840617179871, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9581335783004761 / 0.9651646018028259
after epoch: 8,now: 2024-07-26 21:43:43.969262,epoch time: 0:15:39.355564,used: 1:52:25.032884,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9984923, 'precision': 0.99885166, 'recall': 0.9972115, 'specificity': 0.9972115, 'f1': 0.998028, 'auroc': 0.9998815, 'binary_precision': 0.9995903, 'binary_recall': 0.99456483, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99707115}
confusion matrix:
       0      1
0  42315      6
1     80  14639
---- Validation: 
scalar performance:
{'acc': 0.97631973, 'precision': 0.8503876, 'recall': 0.7499728, 'specificity': 0.7499728, 'f1': 0.79107606, 'auroc': 0.9650173, 'binary_precision': 0.7180617, 'binary_recall': 0.5069984, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.5943482}
confusion matrix:
       0    1
0  18021  128
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9511026, 'precision': 0.5248194, 'recall': 0.5054098, 'specificity': 0.5054098, 'f1': 0.5032818, 'auroc': 0.897531, 'binary_precision': 0.09090909, 'binary_recall': 0.019157087, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.031645566}
confusion matrix:
      0   1
0  5947  50
1   256   5
better model found
persisted
after epoch: 9,now: 2024-07-26 22:00:35.588685,epoch time: 0:16:51.619423,used: 2:09:16.652307,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9984748, 'precision': 0.9989294, 'recall': 0.99708915, 'specificity': 0.99708915, 'f1': 0.9980048, 'auroc': 0.99990237, 'binary_precision': 0.9998634, 'binary_recall': 0.99422556, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9970365}
confusion matrix:
       0      1
0  42318      2
1     85  14635
---- Validation: 
scalar performance:
{'acc': 0.9713176, 'precision': 0.93290216, 'recall': 0.59137166, 'specificity': 0.59137166, 'f1': 0.64493644, 'auroc': 0.9602269, 'binary_precision': 0.8939394, 'binary_recall': 0.18351477, 'binary_specificity': 0.9992286, 'binary_f1_score': 0.30451614}
confusion matrix:
       0    1
0  18135   14
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.96656895, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
early stop counter: 1
val acc:0.9713175892829895, best validation acc: 0.9763197302818298, corresponding to test acc:                         0.951102614402771 / 0.9651646018028259
after epoch: 10,now: 2024-07-26 22:16:05.031011,epoch time: 0:15:29.442326,used: 2:24:46.094633,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9979839, 'precision': 0.99819666, 'recall': 0.9965357, 'specificity': 0.9965357, 'f1': 0.99736255, 'auroc': 0.9998605, 'binary_precision': 0.99863386, 'binary_recall': 0.993544, 'binary_specificity': 0.99952745, 'binary_f1_score': 0.9960824}
confusion matrix:
       0      1
0  42305     20
1     95  14620
---- Validation: 
scalar performance:
{'acc': 0.9702533, 'precision': 0.8314013, 'recall': 0.61707264, 'specificity': 0.61707264, 'f1': 0.66926676, 'auroc': 0.963536, 'binary_precision': 0.6891892, 'binary_recall': 0.23794712, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.35375723}
confusion matrix:
       0    1
0  18080   69
1    490  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.94338804, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
early stop counter: 2
val acc:0.9702532887458801, best validation acc: 0.9763197302818298, corresponding to test acc:                         0.951102614402771 / 0.9651646018028259
after epoch: 11,now: 2024-07-26 22:32:14.023886,epoch time: 0:16:08.992875,used: 2:40:55.087508,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9979313, 'precision': 0.99860984, 'recall': 0.995991, 'specificity': 0.995991, 'f1': 0.99729145, 'auroc': 0.99991024, 'binary_precision': 1.0, 'binary_recall': 0.99198204, 'binary_specificity': 1.0, 'binary_f1_score': 0.9959749}
confusion matrix:
       0      1
0  42323      0
1    118  14599
---- Validation: 
scalar performance:
{'acc': 0.9698276, 'precision': 0.9251541, 'recall': 0.56809866, 'specificity': 0.56809866, 'f1': 0.6107435, 'auroc': 0.9566605, 'binary_precision': 0.88, 'binary_recall': 0.13685848, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.23687753}
confusion matrix:
       0   1
0  18137  12
1    555  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.9592002, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
early stop counter: 3
val acc:0.9698275923728943, best validation acc: 0.9763197302818298, corresponding to test acc:                         0.951102614402771 / 0.9651646018028259
after epoch: 12,now: 2024-07-26 22:47:11.530296,epoch time: 0:14:57.506410,used: 2:55:52.593918,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9971599, 'precision': 0.9971503, 'recall': 0.9954264, 'specificity': 0.9954264, 'f1': 0.9962845, 'auroc': 0.99973077, 'binary_precision': 0.9971306, 'binary_recall': 0.9918451, 'binary_specificity': 0.9990077, 'binary_f1_score': 0.99448085}
confusion matrix:
       0      1
0  42283     42
1    120  14595
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7453251, 'recall': 0.7530441, 'specificity': 0.7530441, 'f1': 0.74911785, 'auroc': 0.9404912, 'binary_precision': 0.5075301, 'binary_recall': 0.5241057, 'binary_specificity': 0.98198247, 'binary_f1_score': 0.5156848}
confusion matrix:
       0    1
0  17822  327
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8763021, 'recall': 0.6173566, 'specificity': 0.6173566, 'f1': 0.673483, 'auroc': 0.93719673, 'binary_precision': 0.7848101, 'binary_recall': 0.23754789, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.36470586}
confusion matrix:
      0   1
0  5980  17
1   199  62
new oracle model saved
early stop counter: 4
val acc:0.9663154482841492, best validation acc: 0.9763197302818298, corresponding to test acc:                         0.951102614402771 / 0.9654842019081116
after epoch: 13,now: 2024-07-26 23:01:25.335941,epoch time: 0:14:13.805645,used: 3:10:06.399563,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9985624, 'precision': 0.9990331, 'recall': 0.9972143, 'specificity': 0.9972143, 'f1': 0.99811935, 'auroc': 0.99995875, 'binary_precision': 1.0, 'binary_recall': 0.9944286, 'binary_specificity': 1.0, 'binary_f1_score': 0.99720645}
confusion matrix:
       0      1
0  42322      0
1     82  14636
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.9743751, 'recall': 0.5388527, 'specificity': 0.5388527, 'f1': 0.5639952, 'auroc': 0.96043074, 'binary_precision': 0.98039216, 'binary_recall': 0.077760495, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.14409222}
confusion matrix:
       0   1
0  18148   1
1    593  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.942219, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
early stop counter: 5
val acc:0.9683908224105835, best validation acc: 0.9763197302818298, corresponding to test acc:                         0.951102614402771 / 0.9654842019081116
after epoch: 14,now: 2024-07-26 23:15:36.776670,epoch time: 0:14:11.440729,used: 3:24:17.840292,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_19_51_18_seed_0_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 3:24:17.840292 at 2024-07-26 23:15:36.776670
persisted model performance metric: 

scalar performance:
{'acc': 0.9511026, 'precision': 0.5248194, 'recall': 0.5054098, 'specificity': 0.5054098, 'f1': 0.5032818, 'auroc': 0.897531, 'binary_precision': 0.09090909, 'binary_recall': 0.019157087, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.031645566}
confusion matrix:
      0   1
0  5947  50
1   256   5
oracle model performance metric: 

scalar performance:
{'acc': 0.9654842, 'precision': 0.8763021, 'recall': 0.6173566, 'specificity': 0.6173566, 'f1': 0.673483, 'auroc': 0.93719673, 'binary_precision': 0.7848101, 'binary_recall': 0.23754789, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.36470586}
confusion matrix:
      0   1
0  5980  17
1   199  62
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 503616 KiB |   2050 MiB | 551792 GiB | 551792 GiB |
|       from large pool | 461928 KiB |   2017 MiB | 544891 GiB | 544891 GiB |
|       from small pool |  41687 KiB |     61 MiB |   6900 GiB |   6900 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 503616 KiB |   2050 MiB | 551792 GiB | 551792 GiB |
|       from large pool | 461928 KiB |   2017 MiB | 544891 GiB | 544891 GiB |
|       from small pool |  41687 KiB |     61 MiB |   6900 GiB |   6900 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496650 KiB |   2046 MiB | 551597 GiB | 551597 GiB |
|       from large pool | 455971 KiB |   2014 MiB | 544710 GiB | 544710 GiB |
|       from small pool |  40679 KiB |     60 MiB |   6887 GiB |   6887 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2326 MiB |   2326 MiB |   2326 MiB |      0 B   |
|       from large pool |   2256 MiB |   2256 MiB |   2256 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 340160 KiB | 375932 KiB | 443624 GiB | 443624 GiB |
|       from large pool | 332695 KiB | 370379 KiB | 436391 GiB | 436391 GiB |
|       from small pool |   7464 KiB |  12776 KiB |   7232 GiB |   7232 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8115    |  103341 K  |  103338 K  |
|       from large pool |     187    |     311    |   50475 K  |   50475 K  |
|       from small pool |    3301    |    7927    |   52865 K  |   52862 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8115    |  103341 K  |  103338 K  |
|       from large pool |     187    |     311    |   50475 K  |   50475 K  |
|       from small pool |    3301    |    7927    |   52865 K  |   52862 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     128    |     128    |       0    |
|       from large pool |      93    |      93    |      93    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      66    |    3615    |   53600 K  |   53600 K  |
|       from large pool |      35    |      88    |   33174 K  |   33174 K  |
|       from small pool |      31    |    3580    |   20425 K  |   20425 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   2050 MiB | 551792 GiB | 551792 GiB |
|       from large pool |  65536 KiB |   2017 MiB | 544891 GiB | 544891 GiB |
|       from small pool |      0 KiB |     61 MiB |   6900 GiB |   6900 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   2050 MiB | 551792 GiB | 551792 GiB |
|       from large pool |  65536 KiB |   2017 MiB | 544891 GiB | 544891 GiB |
|       from small pool |      0 KiB |     61 MiB |   6900 GiB |   6900 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   2046 MiB | 551597 GiB | 551597 GiB |
|       from large pool |  65536 KiB |   2014 MiB | 544710 GiB | 544710 GiB |
|       from small pool |      0 KiB |     60 MiB |   6887 GiB |   6887 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    824 MiB |   2326 MiB |   2326 MiB |   1502 MiB |
|       from large pool |    776 MiB |   2256 MiB |   2256 MiB |   1480 MiB |
|       from small pool |     48 MiB |     70 MiB |     70 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 424979 KiB | 443624 GiB | 443624 GiB |
|       from large pool |      0 B   | 403377 KiB | 436392 GiB | 436392 GiB |
|       from small pool |      0 B   |  23037 KiB |   7232 GiB |   7232 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |  103341 K  |  103341 K  |
|       from large pool |       2    |     311    |   50475 K  |   50475 K  |
|       from small pool |       0    |    7927    |   52865 K  |   52865 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |  103341 K  |  103341 K  |
|       from large pool |       2    |     311    |   50475 K  |   50475 K  |
|       from small pool |       0    |    7927    |   52865 K  |   52865 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     128    |     128    |      70    |
|       from large pool |      34    |      93    |      93    |      59    |
|       from small pool |      24    |      35    |      35    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3615    |   53601 K  |   53601 K  |
|       from large pool |       0    |      88    |   33174 K  |   33174 K  |
|       from small pool |       0    |    3580    |   20427 K  |   20427 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   2050 MiB | 551792 GiB | 551792 GiB |
|       from large pool |  65536 KiB |   2017 MiB | 544891 GiB | 544891 GiB |
|       from small pool |      0 KiB |     61 MiB |   6900 GiB |   6900 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   2050 MiB | 551792 GiB | 551792 GiB |
|       from large pool |  65536 KiB |   2017 MiB | 544891 GiB | 544891 GiB |
|       from small pool |      0 KiB |     61 MiB |   6900 GiB |   6900 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   2046 MiB | 551597 GiB | 551597 GiB |
|       from large pool |  65536 KiB |   2014 MiB | 544710 GiB | 544710 GiB |
|       from small pool |      0 KiB |     60 MiB |   6887 GiB |   6887 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    824 MiB |   2326 MiB |   2326 MiB |   1502 MiB |
|       from large pool |    776 MiB |   2256 MiB |   2256 MiB |   1480 MiB |
|       from small pool |     48 MiB |     70 MiB |     70 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 424979 KiB | 443624 GiB | 443624 GiB |
|       from large pool |      0 B   | 403377 KiB | 436392 GiB | 436392 GiB |
|       from small pool |      0 B   |  23037 KiB |   7232 GiB |   7232 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |  103341 K  |  103341 K  |
|       from large pool |       2    |     311    |   50475 K  |   50475 K  |
|       from small pool |       0    |    7927    |   52865 K  |   52865 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |  103341 K  |  103341 K  |
|       from large pool |       2    |     311    |   50475 K  |   50475 K  |
|       from small pool |       0    |    7927    |   52865 K  |   52865 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     128    |     128    |      70    |
|       from large pool |      34    |      93    |      93    |      59    |
|       from small pool |      24    |      35    |      35    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3615    |   53601 K  |   53601 K  |
|       from large pool |       0    |      88    |   33174 K  |   33174 K  |
|       from small pool |       0    |    3580    |   20427 K  |   20427 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_23_20_43_seed_1_23070006

 Experiment start at: 2024-07-26 23:20:43.167012
before training, model accuracy: 0.6475991010665894
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9928913, 'precision': 0.994275, 'recall': 0.98695195, 'specificity': 0.98695195, 'f1': 0.9905443, 'auroc': 0.99926174, 'binary_precision': 0.9970211, 'binary_recall': 0.9748942, 'binary_specificity': 0.9990097, 'binary_f1_score': 0.9858335}
confusion matrix:
       0      1
0  42371     42
1    362  14057
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.73990995, 'recall': 0.52652025, 'specificity': 0.52652025, 'f1': 0.54053146, 'auroc': 0.9240346, 'binary_precision': 0.5138889, 'binary_recall': 0.05497771, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.09932886}
confusion matrix:
       0   1
0  18032  35
1    636  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.83657503, 'recall': 0.5094472, 'specificity': 0.5094472, 'f1': 0.5081461, 'auroc': 0.9061878, 'binary_precision': 0.71428573, 'binary_recall': 0.01923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.037453186}
confusion matrix:
      0  1
0  5944  2
1   255  5
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 23:35:07.024840,epoch time: 0:14:23.857828,used: 0:14:23.857828,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_23_20_43_seed_1_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9950732, 'precision': 0.99289644, 'recall': 0.9941126, 'specificity': 0.9941126, 'f1': 0.9935026, 'auroc': 0.99966383, 'binary_precision': 0.9884605, 'binary_recall': 0.9921626, 'binary_specificity': 0.99606264, 'binary_f1_score': 0.9903081}
confusion matrix:
       0      1
0  42247    167
1    113  14305
---- Validation: 
scalar performance:
{'acc': 0.96574175, 'precision': 0.752632, 'recall': 0.752632, 'specificity': 0.752632, 'f1': 0.752632, 'auroc': 0.93923736, 'binary_precision': 0.5230312, 'binary_recall': 0.5230312, 'binary_specificity': 0.9822328, 'binary_f1_score': 0.5230312}
confusion matrix:
       0    1
0  17746  321
1    321  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.77075267, 'recall': 0.6320817, 'specificity': 0.6320817, 'f1': 0.674836, 'auroc': 0.94476765, 'binary_precision': 0.57258064, 'binary_recall': 0.27307692, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.36979166}
confusion matrix:
      0   1
0  5893  53
1   189  71
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 23:49:22.516924,epoch time: 0:14:15.492084,used: 0:28:39.349912,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_23_20_43_seed_1_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9958474, 'precision': 0.9966686, 'recall': 0.9923651, 'specificity': 0.9923651, 'f1': 0.994493, 'auroc': 0.9997283, 'binary_precision': 0.9983134, 'binary_recall': 0.98529613, 'binary_specificity': 0.9994342, 'binary_f1_score': 0.99176204}
confusion matrix:
       0      1
0  42390     24
1    212  14206
---- Validation: 
scalar performance:
{'acc': 0.97033083, 'precision': 0.83277214, 'recall': 0.6548746, 'specificity': 0.6548746, 'f1': 0.7087101, 'auroc': 0.93101215, 'binary_precision': 0.6905537, 'binary_recall': 0.31500742, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.43265307}
confusion matrix:
       0    1
0  17972   95
1    461  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.6042541, 'recall': 0.50501245, 'specificity': 0.50501245, 'f1': 0.5000739, 'auroc': 0.8968096, 'binary_precision': 0.25, 'binary_recall': 0.011538462, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.022058822}
confusion matrix:
      0  1
0  5937  9
1   257  3
better model found
persisted
after epoch: 3,now: 2024-07-27 00:03:34.490962,epoch time: 0:14:11.974038,used: 0:42:51.323950,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_23_20_43_seed_1_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99477404, 'precision': 0.9964992, 'recall': 0.9897239, 'specificity': 0.9897239, 'f1': 0.9930527, 'auroc': 0.99977744, 'binary_precision': 0.9999292, 'binary_recall': 0.9794715, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.98959464}
confusion matrix:
       0      1
0  42412      1
1    296  14123
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.86018157, 'recall': 0.5381625, 'specificity': 0.5381625, 'f1': 0.5613978, 'auroc': 0.9501671, 'binary_precision': 0.7536232, 'binary_recall': 0.07726597, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.14016172}
confusion matrix:
       0   1
0  18050  17
1    621  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.60411966, 'recall': 0.5016708, 'specificity': 0.5016708, 'f1': 0.4930042, 'auroc': 0.9238256, 'binary_precision': 0.25, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5943  3
1   259  1
early stop counter: 1
val acc:0.9659551978111267, best validation acc: 0.9703308343887329, corresponding to test acc:                         0.9571382403373718 / 0.961005449295044
after epoch: 4,now: 2024-07-27 00:17:43.884164,epoch time: 0:14:09.393202,used: 0:57:00.717152,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_23_20_43_seed_1_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9985923, 'precision': 0.99889696, 'recall': 0.99738574, 'specificity': 0.99738574, 'f1': 0.9981384, 'auroc': 0.99985236, 'binary_precision': 0.99951226, 'binary_recall': 0.9949365, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.99721915}
confusion matrix:
       0      1
0  42408      7
1     73  14344
---- Validation: 
scalar performance:
{'acc': 0.97337246, 'precision': 0.8536893, 'recall': 0.70294446, 'specificity': 0.70294446, 'f1': 0.75620854, 'auroc': 0.9609029, 'binary_precision': 0.72894734, 'binary_recall': 0.4115899, 'binary_specificity': 0.994299, 'binary_f1_score': 0.52611583}
confusion matrix:
       0    1
0  17964  103
1    396  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.83695555, 'recall': 0.51889443, 'specificity': 0.51889443, 'f1': 0.52603334, 'auroc': 0.9386331, 'binary_precision': 0.71428573, 'binary_recall': 0.03846154, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.072992705}
confusion matrix:
      0   1
0  5942   4
1   250  10
better model found
persisted
after epoch: 5,now: 2024-07-27 00:31:49.666996,epoch time: 0:14:05.782832,used: 1:11:06.499984,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_23_20_43_seed_1_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9979061, 'precision': 0.9984384, 'recall': 0.99603343, 'specificity': 0.99603343, 'f1': 0.9972285, 'auroc': 0.99992216, 'binary_precision': 0.99951094, 'binary_recall': 0.9922319, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.99585813}
confusion matrix:
       0      1
0  42407      7
1    112  14306
---- Validation: 
scalar performance:
{'acc': 0.973159, 'precision': 0.8601997, 'recall': 0.6906742, 'specificity': 0.6906742, 'f1': 0.7472559, 'auroc': 0.9561802, 'binary_precision': 0.74285716, 'binary_recall': 0.38632986, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.5083089}
confusion matrix:
       0    1
0  17977   90
1    413  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.5175508, 'recall': 0.500914, 'specificity': 0.500914, 'f1': 0.49250063, 'auroc': 0.9347262, 'binary_precision': 0.07692308, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.007326007}
confusion matrix:
      0   1
0  5934  12
1   259   1
early stop counter: 1
val acc:0.9731590151786804, best validation acc: 0.9733724594116211, corresponding to test acc:                         0.9590718746185303 / 0.961005449295044
after epoch: 6,now: 2024-07-27 00:46:08.247837,epoch time: 0:14:18.580841,used: 1:25:25.080825,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_23_20_43_seed_1_23070006
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
slurmstepd: error: *** JOB 23070006 ON supergpu15 CANCELLED AT 2024-07-27T00:53:28 ***
