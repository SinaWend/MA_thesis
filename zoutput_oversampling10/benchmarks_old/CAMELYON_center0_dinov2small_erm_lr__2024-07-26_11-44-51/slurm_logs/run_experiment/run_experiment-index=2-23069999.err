Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 11:47:23 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999

 Experiment start at: 2024-07-26 11:57:16.534083
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98799086, 'precision': 0.9901922, 'recall': 0.97843254, 'specificity': 0.97843254, 'f1': 0.98412824, 'auroc': 0.9985672, 'binary_precision': 0.99457175, 'binary_recall': 0.95868444, 'binary_specificity': 0.9981807, 'binary_f1_score': 0.97629845}
confusion matrix:
       0      1
0  42247     77
1    608  14108
---- Validation: 
scalar performance:
{'acc': 0.96035546, 'precision': 0.702864, 'recall': 0.71470594, 'specificity': 0.71470594, 'f1': 0.7085946, 'auroc': 0.9220278, 'binary_precision': 0.42521995, 'binary_recall': 0.45101088, 'binary_specificity': 0.978401, 'binary_f1_score': 0.43773586}
confusion matrix:
       0    1
0  17757  392
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97235537, 'precision': 0.88504255, 'recall': 0.7253847, 'specificity': 0.7253847, 'f1': 0.7823919, 'auroc': 0.90967214, 'binary_precision': 0.79333335, 'binary_recall': 0.4559387, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.5790754}
confusion matrix:
      0    1
0  5966   31
1   142  119
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 12:15:28.745988,epoch time: 0:18:12.211905,used: 0:18:12.211905,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99209327, 'precision': 0.9945162, 'recall': 0.98487604, 'specificity': 0.98487604, 'f1': 0.9895735, 'auroc': 0.99950755, 'binary_precision': 0.99936986, 'binary_recall': 0.9699647, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.9844477}
confusion matrix:
       0      1
0  42315      9
1    442  14274
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7759681, 'recall': 0.5424439, 'specificity': 0.5424439, 'f1': 0.56726944, 'auroc': 0.93430156, 'binary_precision': 0.5833333, 'binary_recall': 0.08709176, 'binary_specificity': 0.997796, 'binary_f1_score': 0.15155616}
confusion matrix:
       0   1
0  18109  40
1    587  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9546181, 'precision': 0.53101456, 'recall': 0.5035794, 'specificity': 0.5035794, 'f1': 0.49873024, 'auroc': 0.89942497, 'binary_precision': 0.10344828, 'binary_recall': 0.011494253, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.020689653}
confusion matrix:
      0   1
0  5971  26
1   258   3
better model found
persisted
after epoch: 2,now: 2024-07-26 12:30:06.556082,epoch time: 0:14:37.810094,used: 0:32:50.021999,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99235624, 'precision': 0.9881444, 'recall': 0.9920128, 'specificity': 0.9920128, 'f1': 0.9900582, 'auroc': 0.9994997, 'binary_precision': 0.97932607, 'binary_recall': 0.99130315, 'binary_specificity': 0.99272245, 'binary_f1_score': 0.98527825}
confusion matrix:
       0      1
0  42014    308
1    128  14590
---- Validation: 
scalar performance:
{'acc': 0.96290976, 'precision': 0.7216239, 'recall': 0.73853004, 'specificity': 0.73853004, 'f1': 0.7297272, 'auroc': 0.93664396, 'binary_precision': 0.4610951, 'binary_recall': 0.4976672, 'binary_specificity': 0.9793928, 'binary_f1_score': 0.47868362}
confusion matrix:
       0    1
0  17775  374
1    323  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.82077765, 'recall': 0.59378445, 'specificity': 0.59378445, 'f1': 0.63960755, 'auroc': 0.9093286, 'binary_precision': 0.6756757, 'binary_recall': 0.19157088, 'binary_specificity': 0.995998, 'binary_f1_score': 0.29850745}
confusion matrix:
      0   1
0  5973  24
1   211  50
early stop counter: 1
val acc:0.9629097580909729, best validation acc: 0.9666347503662109, corresponding to test acc:                         0.9546180963516235 / 0.9723553657531738
after epoch: 3,now: 2024-07-26 12:44:53.771179,epoch time: 0:14:47.215097,used: 0:47:37.237096,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99579245, 'precision': 0.99649775, 'recall': 0.99251145, 'specificity': 0.99251145, 'f1': 0.9944836, 'auroc': 0.99958646, 'binary_precision': 0.9979364, 'binary_recall': 0.9857318, 'binary_specificity': 0.9992911, 'binary_f1_score': 0.99179655}
confusion matrix:
       0      1
0  42292     30
1    210  14508
---- Validation: 
scalar performance:
{'acc': 0.96886975, 'precision': 0.80472565, 'recall': 0.6028553, 'specificity': 0.6028553, 'f1': 0.64993095, 'auroc': 0.95072424, 'binary_precision': 0.6367925, 'binary_recall': 0.20995334, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.31578946}
confusion matrix:
       0    1
0  18072   77
1    508  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.9297875, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
better model found
persisted
after epoch: 4,now: 2024-07-26 13:00:03.552064,epoch time: 0:15:09.780885,used: 1:02:47.017981,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9909888, 'precision': 0.9914697, 'recall': 0.9849545, 'specificity': 0.9849545, 'f1': 0.98815536, 'auroc': 0.9993448, 'binary_precision': 0.9924426, 'binary_recall': 0.9724845, 'binary_specificity': 0.9974244, 'binary_f1_score': 0.9823622}
confusion matrix:
       0      1
0  42212    109
1    405  14314
---- Validation: 
scalar performance:
{'acc': 0.9472648, 'precision': 0.6581687, 'recall': 0.7506819, 'specificity': 0.7506819, 'f1': 0.6921321, 'auroc': 0.9311422, 'binary_precision': 0.33301345, 'binary_recall': 0.53965783, 'binary_specificity': 0.96170586, 'binary_f1_score': 0.41186944}
confusion matrix:
       0    1
0  17454  695
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9186641, 'precision': 0.5459715, 'recall': 0.55811334, 'specificity': 0.55811334, 'f1': 0.55092, 'auroc': 0.88459957, 'binary_precision': 0.12874252, 'binary_recall': 0.16475096, 'binary_specificity': 0.95147574, 'binary_f1_score': 0.14453782}
confusion matrix:
      0    1
0  5706  291
1   218   43
early stop counter: 1
val acc:0.9472647905349731, best validation acc: 0.9688697457313538, corresponding to test acc:                         0.9579737782478333 / 0.9723553657531738
after epoch: 5,now: 2024-07-26 13:14:39.610536,epoch time: 0:14:36.058472,used: 1:17:23.076453,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.995249, 'precision': 0.9964746, 'recall': 0.99112535, 'specificity': 0.99112535, 'f1': 0.99376225, 'auroc': 0.99970305, 'binary_precision': 0.9989638, 'binary_recall': 0.98260516, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.99071693}
confusion matrix:
       0      1
0  42308     15
1    256  14461
---- Validation: 
scalar performance:
{'acc': 0.96897614, 'precision': 0.7997127, 'recall': 0.6134112, 'specificity': 0.6134112, 'f1': 0.6611839, 'auroc': 0.94724363, 'binary_precision': 0.6260504, 'binary_recall': 0.23172629, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.338252}
confusion matrix:
       0    1
0  18060   89
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9346583, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
better model found
persisted
after epoch: 6,now: 2024-07-26 13:29:22.047853,epoch time: 0:14:42.437317,used: 1:32:05.513770,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9972826, 'precision': 0.9972111, 'recall': 0.9956864, 'specificity': 0.9956864, 'f1': 0.99644566, 'auroc': 0.9996236, 'binary_precision': 0.99706405, 'binary_recall': 0.9923887, 'binary_specificity': 0.99898404, 'binary_f1_score': 0.9947209}
confusion matrix:
       0      1
0  42282     43
1    112  14603
---- Validation: 
scalar performance:
{'acc': 0.9701469, 'precision': 0.8342459, 'recall': 0.6117671, 'specificity': 0.6117671, 'f1': 0.663524, 'auroc': 0.9450881, 'binary_precision': 0.6952381, 'binary_recall': 0.22706065, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.34232122}
confusion matrix:
       0    1
0  18085   64
1    497  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95286036, 'precision': 0.47903278, 'recall': 0.49716526, 'specificity': 0.49716526, 'f1': 0.48793063, 'auroc': 0.9077414, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5963  34
1   261   0
better model found
persisted
after epoch: 7,now: 2024-07-26 13:44:17.688347,epoch time: 0:14:55.640494,used: 1:47:01.154264,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9967742, 'precision': 0.9977901, 'recall': 0.99379385, 'specificity': 0.99379385, 'f1': 0.99577093, 'auroc': 0.9997587, 'binary_precision': 0.99986243, 'binary_recall': 0.987635, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9937111}
confusion matrix:
       0      1
0  42319      2
1    182  14537
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.7880082, 'recall': 0.64274603, 'specificity': 0.64274603, 'f1': 0.68873525, 'auroc': 0.951895, 'binary_precision': 0.600639, 'binary_recall': 0.29237947, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.39330542}
confusion matrix:
       0    1
0  18024  125
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94582933, 'precision': 0.49122685, 'recall': 0.49716142, 'specificity': 0.49716142, 'f1': 0.49190667, 'auroc': 0.9116332, 'binary_precision': 0.024390243, 'binary_recall': 0.007662835, 'binary_specificity': 0.98666, 'binary_f1_score': 0.011661807}
confusion matrix:
      0   1
0  5917  80
1   259   2
early stop counter: 1
val acc:0.9691358208656311, best validation acc: 0.970146894454956, corresponding to test acc:                         0.9528603553771973 / 0.9723553657531738
after epoch: 8,now: 2024-07-26 13:59:06.912779,epoch time: 0:14:49.224432,used: 2:01:50.378696,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9949509, 'precision': 0.9965974, 'recall': 0.9902382, 'specificity': 0.9902382, 'f1': 0.9933646, 'auroc': 0.99974847, 'binary_precision': 0.9999307, 'binary_recall': 0.98050004, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99012005}
confusion matrix:
       0      1
0  42321      1
1    287  14431
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.8796948, 'recall': 0.5292735, 'specificity': 0.5292735, 'f1': 0.5466578, 'auroc': 0.9532752, 'binary_precision': 0.7916667, 'binary_recall': 0.05909798, 'binary_specificity': 0.999449, 'binary_f1_score': 0.10998553}
confusion matrix:
       0   1
0  18139  10
1    605  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9379107, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
early stop counter: 2
val acc:0.9672732949256897, best validation acc: 0.970146894454956, corresponding to test acc:                         0.9528603553771973 / 0.9723553657531738
after epoch: 9,now: 2024-07-26 14:18:58.369628,epoch time: 0:19:51.456849,used: 2:21:41.835545,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9955295, 'precision': 0.99589264, 'recall': 0.9924224, 'specificity': 0.9924224, 'f1': 0.9941415, 'auroc': 0.99952555, 'binary_precision': 0.9966346, 'binary_recall': 0.98600256, 'binary_specificity': 0.99884224, 'binary_f1_score': 0.99129003}
confusion matrix:
       0      1
0  42274     49
1    206  14511
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.76635236, 'recall': 0.5982786, 'specificity': 0.5982786, 'f1': 0.6401948, 'auroc': 0.92580855, 'binary_precision': 0.5603448, 'binary_recall': 0.2021773, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.2971429}
confusion matrix:
       0    1
0  18047  102
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.92676246, 'recall': 0.77411115, 'specificity': 0.77411115, 'f1': 0.832321, 'auroc': 0.9263152, 'binary_precision': 0.8727273, 'binary_recall': 0.55172414, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.6760564}
confusion matrix:
      0    1
0  5976   21
1   117  144
new oracle model saved
early stop counter: 3
val acc:0.9672732949256897, best validation acc: 0.970146894454956, corresponding to test acc:                         0.9528603553771973 / 0.9779482483863831
after epoch: 10,now: 2024-07-26 14:42:40.710698,epoch time: 0:23:42.341070,used: 2:45:24.176615,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99768585, 'precision': 0.9977727, 'recall': 0.9961797, 'specificity': 0.9961797, 'f1': 0.9969729, 'auroc': 0.9998373, 'binary_precision': 0.99795127, 'binary_recall': 0.9930683, 'binary_specificity': 0.9992912, 'binary_f1_score': 0.9955038}
confusion matrix:
       0      1
0  42295     30
1    102  14613
---- Validation: 
scalar performance:
{'acc': 0.97115797, 'precision': 0.83723426, 'recall': 0.6355423, 'specificity': 0.6355423, 'f1': 0.69015807, 'auroc': 0.9505604, 'binary_precision': 0.69960475, 'binary_recall': 0.27527216, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.3950893}
confusion matrix:
       0    1
0  18073   76
1    466  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95174176, 'precision': 0.47900918, 'recall': 0.4965816, 'specificity': 0.4965816, 'f1': 0.4876371, 'auroc': 0.8992603, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5956  41
1   261   0
better model found
persisted
after epoch: 11,now: 2024-07-26 15:00:03.250091,epoch time: 0:17:22.539393,used: 3:02:46.716008,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99737024, 'precision': 0.99809855, 'recall': 0.99503684, 'specificity': 0.99503684, 'f1': 0.9965554, 'auroc': 0.99989676, 'binary_precision': 0.99958843, 'binary_recall': 0.9902154, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.9948799}
confusion matrix:
       0      1
0  42317      6
1    144  14573
---- Validation: 
scalar performance:
{'acc': 0.971424, 'precision': 0.83801913, 'recall': 0.6416805, 'specificity': 0.6416805, 'f1': 0.6966485, 'auroc': 0.93543065, 'binary_precision': 0.70075756, 'binary_recall': 0.28771386, 'binary_specificity': 0.99564713, 'binary_f1_score': 0.40793827}
confusion matrix:
       0    1
0  18070   79
1    458  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9538191, 'precision': 0.47905296, 'recall': 0.4976655, 'specificity': 0.4976655, 'f1': 0.48818192, 'auroc': 0.91222334, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.995331, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5969  28
1   261   0
better model found
persisted
after epoch: 12,now: 2024-07-26 15:19:23.308003,epoch time: 0:19:20.057912,used: 3:22:06.773920,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99815917, 'precision': 0.998404, 'recall': 0.99678725, 'specificity': 0.99678725, 'f1': 0.9975922, 'auroc': 0.99984056, 'binary_precision': 0.9989074, 'binary_recall': 0.9939526, 'binary_specificity': 0.9996219, 'binary_f1_score': 0.99642384}
confusion matrix:
       0      1
0  42307     16
1     89  14628
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.763206, 'recall': 0.6427247, 'specificity': 0.6427247, 'f1': 0.6833771, 'auroc': 0.94020224, 'binary_precision': 0.5510204, 'binary_recall': 0.29393467, 'binary_specificity': 0.9915147, 'binary_f1_score': 0.38336712}
confusion matrix:
       0    1
0  17995  154
1    454  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949984, 'precision': 0.5050556, 'recall': 0.5011615, 'specificity': 0.5011615, 'f1': 0.49657336, 'auroc': 0.89454865, 'binary_precision': 0.05172414, 'binary_recall': 0.011494253, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.018808777}
confusion matrix:
      0   1
0  5942  55
1   258   3
early stop counter: 1
val acc:0.9676458239555359, best validation acc: 0.9714239835739136, corresponding to test acc:                         0.9538190960884094 / 0.9779482483863831
after epoch: 13,now: 2024-07-26 15:34:10.005001,epoch time: 0:14:46.696998,used: 3:36:53.470918,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9956171, 'precision': 0.99656147, 'recall': 0.9919919, 'specificity': 0.9919919, 'f1': 0.9942491, 'auroc': 0.9994853, 'binary_precision': 0.9984835, 'binary_recall': 0.9845035, 'binary_specificity': 0.99948025, 'binary_f1_score': 0.99144423}
confusion matrix:
       0      1
0  42305     22
1    228  14485
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.7534337, 'recall': 0.6574227, 'specificity': 0.6574227, 'f1': 0.6930744, 'auroc': 0.9051418, 'binary_precision': 0.53045684, 'binary_recall': 0.32503888, 'binary_specificity': 0.9898066, 'binary_f1_score': 0.40308586}
confusion matrix:
       0    1
0  17964  185
1    434  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.6983314, 'recall': 0.5307328, 'specificity': 0.5307328, 'f1': 0.5457793, 'auroc': 0.8837869, 'binary_precision': 0.43589744, 'binary_recall': 0.0651341, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.11333334}
confusion matrix:
      0   1
0  5975  22
1   244  17
early stop counter: 2
val acc:0.9670604467391968, best validation acc: 0.9714239835739136, corresponding to test acc:                         0.9538190960884094 / 0.9779482483863831
after epoch: 14,now: 2024-07-26 15:48:56.696746,epoch time: 0:14:46.691745,used: 3:51:40.162663,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9984572, 'precision': 0.9981833, 'recall': 0.99778545, 'specificity': 0.99778545, 'f1': 0.9979842, 'auroc': 0.9999352, 'binary_precision': 0.99761826, 'binary_recall': 0.99639773, 'binary_specificity': 0.9991731, 'binary_f1_score': 0.99700767}
confusion matrix:
       0      1
0  42292     35
1     53  14660
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.76002836, 'recall': 0.60491884, 'specificity': 0.60491884, 'f1': 0.6465247, 'auroc': 0.943246, 'binary_precision': 0.5472441, 'binary_recall': 0.21617419, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.30992195}
confusion matrix:
       0    1
0  18034  115
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.76303697, 'recall': 0.57587606, 'specificity': 0.57587606, 'f1': 0.6124114, 'auroc': 0.91079473, 'binary_precision': 0.56164384, 'binary_recall': 0.15708812, 'binary_specificity': 0.994664, 'binary_f1_score': 0.24550897}
confusion matrix:
      0   1
0  5965  32
1   220  41
early stop counter: 3
val acc:0.9670604467391968, best validation acc: 0.9714239835739136, corresponding to test acc:                         0.9538190960884094 / 0.9779482483863831
after epoch: 15,now: 2024-07-26 16:16:55.201692,epoch time: 0:27:58.504946,used: 4:19:38.667609,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9987903, 'precision': 0.99885166, 'recall': 0.99798805, 'specificity': 0.99798805, 'f1': 0.9984189, 'auroc': 0.9999733, 'binary_precision': 0.998978, 'binary_recall': 0.9963305, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.99765253}
confusion matrix:
       0      1
0  42309     15
1     54  14662
---- Validation: 
scalar performance:
{'acc': 0.96886975, 'precision': 0.8297498, 'recall': 0.58110374, 'specificity': 0.58110374, 'f1': 0.62504756, 'auroc': 0.94788057, 'binary_precision': 0.6883117, 'binary_recall': 0.16485226, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.2659975}
confusion matrix:
       0    1
0  18101   48
1    537  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95605624, 'precision': 0.5543203, 'recall': 0.50432974, 'specificity': 0.50432974, 'f1': 0.4994379, 'auroc': 0.93293655, 'binary_precision': 0.15, 'binary_recall': 0.011494253, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.021352313}
confusion matrix:
      0   1
0  5980  17
1   258   3
early stop counter: 4
val acc:0.9688697457313538, best validation acc: 0.9714239835739136, corresponding to test acc:                         0.9538190960884094 / 0.9779482483863831
after epoch: 16,now: 2024-07-26 16:32:09.952016,epoch time: 0:15:14.750324,used: 4:34:53.417933,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9984572, 'precision': 0.9986494, 'recall': 0.9973202, 'specificity': 0.9973202, 'f1': 0.9979825, 'auroc': 0.9999223, 'binary_precision': 0.9990447, 'binary_recall': 0.9949711, 'binary_specificity': 0.99966925, 'binary_f1_score': 0.9970038}
confusion matrix:
       0      1
0  42311     14
1     74  14641
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.8035093, 'recall': 0.54038656, 'specificity': 0.54038656, 'f1': 0.5645921, 'auroc': 0.94917023, 'binary_precision': 0.6385542, 'binary_recall': 0.08242613, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.14600551}
confusion matrix:
       0   1
0  18119  30
1    590  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.4791033, 'recall': 0.49891612, 'specificity': 0.49891612, 'f1': 0.48880902, 'auroc': 0.9231891, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5984  13
1   261   0
early stop counter: 5
val acc:0.9670072197914124, best validation acc: 0.9714239835739136, corresponding to test acc:                         0.9538190960884094 / 0.9779482483863831
after epoch: 17,now: 2024-07-26 16:46:51.366620,epoch time: 0:14:41.414604,used: 4:49:34.832537,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 17 with time: 4:49:34.832537 at 2024-07-26 16:46:51.366620
persisted model performance metric: 

scalar performance:
{'acc': 0.9538191, 'precision': 0.47905296, 'recall': 0.4976655, 'specificity': 0.4976655, 'f1': 0.48818192, 'auroc': 0.91222334, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.995331, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5969  28
1   261   0
oracle model performance metric: 

scalar performance:
{'acc': 0.97794825, 'precision': 0.92676246, 'recall': 0.77411115, 'specificity': 0.77411115, 'f1': 0.832321, 'auroc': 0.9263152, 'binary_precision': 0.8727273, 'binary_recall': 0.55172414, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.6760564}
confusion matrix:
      0    1
0  5976   21
1   117  144
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 504642 KiB |   2050 MiB | 669468 GiB | 669467 GiB |
|       from large pool | 462955 KiB |   2017 MiB | 661101 GiB | 661100 GiB |
|       from small pool |  41687 KiB |     61 MiB |   8366 GiB |   8366 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 504642 KiB |   2050 MiB | 669468 GiB | 669467 GiB |
|       from large pool | 462955 KiB |   2017 MiB | 661101 GiB | 661100 GiB |
|       from small pool |  41687 KiB |     61 MiB |   8366 GiB |   8366 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496650 KiB |   2046 MiB | 669183 GiB | 669182 GiB |
|       from large pool | 455971 KiB |   2014 MiB | 660832 GiB | 660832 GiB |
|       from small pool |  40679 KiB |     60 MiB |   8350 GiB |   8350 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2324 MiB |   2324 MiB |   2324 MiB |      0 B   |
|       from large pool |   2254 MiB |   2254 MiB |   2254 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 351421 KiB | 387189 KiB | 529722 GiB | 529722 GiB |
|       from large pool | 343957 KiB | 381636 KiB | 520962 GiB | 520961 GiB |
|       from small pool |   7464 KiB |  12776 KiB |   8760 GiB |   8760 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8115    |  125349 K  |  125346 K  |
|       from large pool |     187    |     311    |   61232 K  |   61232 K  |
|       from small pool |    3301    |    7927    |   64116 K  |   64113 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8115    |  125349 K  |  125346 K  |
|       from large pool |     187    |     311    |   61232 K  |   61232 K  |
|       from small pool |    3301    |    7927    |   64116 K  |   64113 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     128    |     128    |       0    |
|       from large pool |      93    |      93    |      93    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      62    |    3612    |   65493 K  |   65493 K  |
|       from large pool |      32    |      86    |   40623 K  |   40623 K  |
|       from small pool |      30    |    3580    |   24869 K  |   24869 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   2050 MiB | 669468 GiB | 669468 GiB |
|       from large pool |  65536 KiB |   2017 MiB | 661101 GiB | 661101 GiB |
|       from small pool |      0 KiB |     61 MiB |   8366 GiB |   8366 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   2050 MiB | 669468 GiB | 669468 GiB |
|       from large pool |  65536 KiB |   2017 MiB | 661101 GiB | 661101 GiB |
|       from small pool |      0 KiB |     61 MiB |   8366 GiB |   8366 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   2046 MiB | 669183 GiB | 669183 GiB |
|       from large pool |  65536 KiB |   2014 MiB | 660832 GiB | 660832 GiB |
|       from small pool |      0 KiB |     60 MiB |   8350 GiB |   8350 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    836 MiB |   2324 MiB |   2324 MiB |   1488 MiB |
|       from large pool |    788 MiB |   2254 MiB |   2254 MiB |   1466 MiB |
|       from small pool |     48 MiB |     70 MiB |     70 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 451353 KiB | 529723 GiB | 529723 GiB |
|       from large pool |      0 B   | 430097 KiB | 520962 GiB | 520962 GiB |
|       from small pool |      0 B   |  21264 KiB |   8760 GiB |   8760 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |  125349 K  |  125349 K  |
|       from large pool |       2    |     311    |   61232 K  |   61232 K  |
|       from small pool |       0    |    7927    |   64116 K  |   64116 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |  125349 K  |  125349 K  |
|       from large pool |       2    |     311    |   61232 K  |   61232 K  |
|       from small pool |       0    |    7927    |   64116 K  |   64116 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     128    |     128    |      69    |
|       from large pool |      35    |      93    |      93    |      58    |
|       from small pool |      24    |      35    |      35    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3612    |   65494 K  |   65494 K  |
|       from large pool |       0    |      86    |   40623 K  |   40623 K  |
|       from small pool |       0    |    3580    |   24871 K  |   24871 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   2050 MiB | 669468 GiB | 669468 GiB |
|       from large pool |  65536 KiB |   2017 MiB | 661101 GiB | 661101 GiB |
|       from small pool |      0 KiB |     61 MiB |   8366 GiB |   8366 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   2050 MiB | 669468 GiB | 669468 GiB |
|       from large pool |  65536 KiB |   2017 MiB | 661101 GiB | 661101 GiB |
|       from small pool |      0 KiB |     61 MiB |   8366 GiB |   8366 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   2046 MiB | 669183 GiB | 669183 GiB |
|       from large pool |  65536 KiB |   2014 MiB | 660832 GiB | 660832 GiB |
|       from small pool |      0 KiB |     60 MiB |   8350 GiB |   8350 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    836 MiB |   2324 MiB |   2324 MiB |   1488 MiB |
|       from large pool |    788 MiB |   2254 MiB |   2254 MiB |   1466 MiB |
|       from small pool |     48 MiB |     70 MiB |     70 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 451353 KiB | 529723 GiB | 529723 GiB |
|       from large pool |      0 B   | 430097 KiB | 520962 GiB | 520962 GiB |
|       from small pool |      0 B   |  21264 KiB |   8760 GiB |   8760 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |  125349 K  |  125349 K  |
|       from large pool |       2    |     311    |   61232 K  |   61232 K  |
|       from small pool |       0    |    7927    |   64116 K  |   64116 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |  125349 K  |  125349 K  |
|       from large pool |       2    |     311    |   61232 K  |   61232 K  |
|       from small pool |       0    |    7927    |   64116 K  |   64116 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     128    |     128    |      69    |
|       from large pool |      35    |      93    |      93    |      58    |
|       from small pool |      24    |      35    |      35    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3612    |   65494 K  |   65494 K  |
|       from large pool |       0    |      86    |   40623 K  |   40623 K  |
|       from small pool |       0    |    3580    |   24871 K  |   24871 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999

 Experiment start at: 2024-07-26 16:52:54.997133
before training, model accuracy: 0.6475991010665894
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9910438, 'precision': 0.9895574, 'recall': 0.9867434, 'specificity': 0.9867434, 'f1': 0.98814005, 'auroc': 0.99858844, 'binary_precision': 0.98656684, 'binary_recall': 0.9780136, 'binary_specificity': 0.9954732, 'binary_f1_score': 0.9822716}
confusion matrix:
       0      1
0  42222    192
1    317  14101
---- Validation: 
scalar performance:
{'acc': 0.956937, 'precision': 0.708778, 'recall': 0.79884964, 'specificity': 0.79884964, 'f1': 0.74463594, 'auroc': 0.92878234, 'binary_precision': 0.43163267, 'binary_recall': 0.62852895, 'binary_specificity': 0.96917033, 'binary_f1_score': 0.5117968}
confusion matrix:
       0    1
0  17510  557
1    250  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7486167, 'recall': 0.7876388, 'specificity': 0.7876388, 'f1': 0.76649547, 'auroc': 0.8895612, 'binary_precision': 0.5148515, 'binary_recall': 0.6, 'binary_specificity': 0.9752775, 'binary_f1_score': 0.5541741}
confusion matrix:
      0    1
0  5799  147
1   104  156
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 17:08:43.997283,epoch time: 0:15:49.000150,used: 0:15:49.000150,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9904455, 'precision': 0.99348235, 'recall': 0.9813551, 'specificity': 0.9813551, 'f1': 0.9872297, 'auroc': 0.9989829, 'binary_precision': 0.99942416, 'binary_recall': 0.96289873, 'binary_specificity': 0.99981135, 'binary_f1_score': 0.98082143}
confusion matrix:
       0      1
0  42404      8
1    535  13885
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.70968574, 'recall': 0.510646, 'specificity': 0.510646, 'f1': 0.51205516, 'auroc': 0.9330283, 'binary_precision': 0.45454547, 'binary_recall': 0.022288261, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.04249292}
confusion matrix:
       0   1
0  18049  18
1    658  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.8903073, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
better model found
persisted
after epoch: 2,now: 2024-07-26 17:24:26.586043,epoch time: 0:15:42.588760,used: 0:31:31.588910,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9928913, 'precision': 0.9898494, 'recall': 0.991415, 'specificity': 0.991415, 'f1': 0.990629, 'auroc': 0.99922836, 'binary_precision': 0.98364276, 'binary_recall': 0.98841804, 'binary_specificity': 0.99441206, 'binary_f1_score': 0.9860246}
confusion matrix:
       0      1
0  42176    237
1    167  14252
---- Validation: 
scalar performance:
{'acc': 0.9627001, 'precision': 0.73134834, 'recall': 0.73961025, 'specificity': 0.73961025, 'f1': 0.7353976, 'auroc': 0.93111503, 'binary_precision': 0.48137537, 'binary_recall': 0.49925706, 'binary_specificity': 0.9799635, 'binary_f1_score': 0.4901532}
confusion matrix:
       0    1
0  17705  362
1    337  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95391554, 'precision': 0.70099556, 'recall': 0.6486106, 'specificity': 0.6486106, 'f1': 0.6702677, 'auroc': 0.8909564, 'binary_precision': 0.43157893, 'binary_recall': 0.31538463, 'binary_specificity': 0.98183656, 'binary_f1_score': 0.36444443}
confusion matrix:
      0    1
0  5838  108
1   178   82
early stop counter: 1
val acc:0.9627001285552979, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9579439163208008 / 0.9595552682876587
after epoch: 3,now: 2024-07-26 17:40:09.883601,epoch time: 0:15:43.297558,used: 0:47:14.886468,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9873311, 'precision': 0.978968, 'recall': 0.9881245, 'specificity': 0.9881245, 'f1': 0.98343134, 'auroc': 0.9990935, 'binary_precision': 0.9614607, 'binary_recall': 0.98973507, 'binary_specificity': 0.9865139, 'binary_f1_score': 0.97539306}
confusion matrix:
       0      1
0  41842    572
1    148  14270
---- Validation: 
scalar performance:
{'acc': 0.92908216, 'precision': 0.64938277, 'recall': 0.8566454, 'specificity': 0.8566454, 'f1': 0.701516, 'auroc': 0.94097555, 'binary_precision': 0.30751175, 'binary_recall': 0.77860326, 'binary_specificity': 0.93468755, 'binary_f1_score': 0.4408919}
confusion matrix:
       0     1
0  16887  1180
1    149   524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9363519, 'precision': 0.679328, 'recall': 0.84357226, 'specificity': 0.84357226, 'f1': 0.73013854, 'auroc': 0.9300325, 'binary_precision': 0.37044147, 'binary_recall': 0.74230766, 'binary_specificity': 0.94483685, 'binary_f1_score': 0.49423814}
confusion matrix:
      0    1
0  5618  328
1    67  193
early stop counter: 2
val acc:0.9290821552276611, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9579439163208008 / 0.9595552682876587
after epoch: 4,now: 2024-07-26 17:55:30.446492,epoch time: 0:15:20.562891,used: 1:02:35.449359,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99517876, 'precision': 0.99577796, 'recall': 0.99148285, 'specificity': 0.99148285, 'f1': 0.9936066, 'auroc': 0.99956155, 'binary_precision': 0.9969784, 'binary_recall': 0.98397946, 'binary_specificity': 0.9989862, 'binary_f1_score': 0.99043626}
confusion matrix:
       0      1
0  42370     43
1    231  14188
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.7543396, 'recall': 0.68036234, 'specificity': 0.68036234, 'f1': 0.7103658, 'auroc': 0.93165076, 'binary_precision': 0.53177965, 'binary_recall': 0.3729569, 'binary_specificity': 0.98776776, 'binary_f1_score': 0.43842795}
confusion matrix:
       0    1
0  17846  221
1    422  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.7018981, 'recall': 0.54179215, 'specificity': 0.54179215, 'f1': 0.56272626, 'auroc': 0.8854996, 'binary_precision': 0.44230768, 'binary_recall': 0.08846154, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.1474359}
confusion matrix:
      0   1
0  5917  29
1   237  23
better model found
persisted
after epoch: 5,now: 2024-07-26 18:11:37.684027,epoch time: 0:16:07.237535,used: 1:18:42.686894,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99445736, 'precision': 0.99598, 'recall': 0.98939735, 'specificity': 0.98939735, 'f1': 0.99263304, 'auroc': 0.9995066, 'binary_precision': 0.9990093, 'binary_recall': 0.9791248, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.98896706}
confusion matrix:
       0      1
0  42399     14
1    301  14118
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.7658032, 'recall': 0.6002524, 'specificity': 0.6002524, 'f1': 0.6421289, 'auroc': 0.92746294, 'binary_precision': 0.5604839, 'binary_recall': 0.20653789, 'binary_specificity': 0.9939669, 'binary_f1_score': 0.30184582}
confusion matrix:
       0    1
0  17958  109
1    534  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.47901532, 'recall': 0.499075, 'specificity': 0.499075, 'f1': 0.48883948, 'auroc': 0.8461176, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99815, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5935  11
1   260   0
early stop counter: 1
val acc:0.9656883478164673, best validation acc: 0.9656883478164673, corresponding to test acc:                         0.9571382403373718 / 0.9595552682876587
after epoch: 6,now: 2024-07-26 18:25:45.697062,epoch time: 0:14:08.013035,used: 1:32:50.699929,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9944398, 'precision': 0.9963022, 'recall': 0.989043, 'specificity': 0.989043, 'f1': 0.99260503, 'auroc': 0.9996636, 'binary_precision': 1.0, 'binary_recall': 0.978086, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889216}
confusion matrix:
       0      1
0  42412      0
1    316  14104
---- Validation: 
scalar performance:
{'acc': 0.96782285, 'precision': 0.87129855, 'recall': 0.57274866, 'specificity': 0.57274866, 'f1': 0.6153755, 'auroc': 0.9501136, 'binary_precision': 0.7734375, 'binary_recall': 0.14710252, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.247191}
confusion matrix:
       0   1
0  18038  29
1    574  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.479039, 'recall': 0.49966365, 'specificity': 0.49966365, 'f1': 0.489134, 'auroc': 0.929193, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5942  4
1   260  0
better model found
persisted
after epoch: 7,now: 2024-07-26 18:39:50.227865,epoch time: 0:14:04.530803,used: 1:46:55.230732,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9969735, 'precision': 0.99709725, 'recall': 0.9949051, 'specificity': 0.9949051, 'f1': 0.995995, 'auroc': 0.99981284, 'binary_precision': 0.99734676, 'binary_recall': 0.9907061, 'binary_specificity': 0.9991041, 'binary_f1_score': 0.99401534}
confusion matrix:
       0      1
0  42376     38
1    134  14284
---- Validation: 
scalar performance:
{'acc': 0.96840984, 'precision': 0.7822854, 'recall': 0.69894016, 'specificity': 0.69894016, 'f1': 0.7326598, 'auroc': 0.947145, 'binary_precision': 0.58635396, 'binary_recall': 0.40861812, 'binary_specificity': 0.98926216, 'binary_f1_score': 0.4816112}
confusion matrix:
       0    1
0  17873  194
1    398  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7844546, 'recall': 0.52616626, 'specificity': 0.52616626, 'f1': 0.53895795, 'auroc': 0.9151757, 'binary_precision': 0.6086956, 'binary_recall': 0.053846154, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.09893993}
confusion matrix:
      0   1
0  5937   9
1   246  14
better model found
persisted
after epoch: 8,now: 2024-07-26 18:53:45.900350,epoch time: 0:13:55.672485,used: 2:00:50.903217,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.998258, 'precision': 0.99784756, 'recall': 0.9975512, 'specificity': 0.9975512, 'f1': 0.99769926, 'auroc': 0.99989307, 'binary_precision': 0.9970151, 'binary_recall': 0.9961162, 'binary_specificity': 0.9989862, 'binary_f1_score': 0.9965654}
confusion matrix:
       0      1
0  42370     43
1     56  14363
---- Validation: 
scalar performance:
{'acc': 0.97139806, 'precision': 0.8120587, 'recall': 0.7226632, 'specificity': 0.7226632, 'f1': 0.7591741, 'auroc': 0.9532255, 'binary_precision': 0.6442105, 'binary_recall': 0.45468053, 'binary_specificity': 0.99064595, 'binary_f1_score': 0.5331011}
confusion matrix:
       0    1
0  17898  169
1    367  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.6292608, 'recall': 0.5051806, 'specificity': 0.5051806, 'f1': 0.50023973, 'auroc': 0.93612206, 'binary_precision': 0.3, 'binary_recall': 0.011538462, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.02222222}
confusion matrix:
      0  1
0  5939  7
1   257  3
better model found
persisted
after epoch: 9,now: 2024-07-26 19:07:48.637063,epoch time: 0:14:02.736713,used: 2:14:53.639930,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99729025, 'precision': 0.9979112, 'recall': 0.9949338, 'specificity': 0.9949338, 'f1': 0.9964112, 'auroc': 0.99978364, 'binary_precision': 0.99916005, 'binary_recall': 0.9901505, 'binary_specificity': 0.99971706, 'binary_f1_score': 0.9946349}
confusion matrix:
       0      1
0  42403     12
1    142  14275
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.76866126, 'recall': 0.5259987, 'specificity': 0.5259987, 'f1': 0.53987753, 'auroc': 0.9386608, 'binary_precision': 0.5714286, 'binary_recall': 0.053491827, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.097826086}
confusion matrix:
       0   1
0  18040  27
1    637  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9537544, 'precision': 0.478961, 'recall': 0.49772957, 'specificity': 0.49772957, 'f1': 0.48816496, 'auroc': 0.8259493, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5919  27
1   260   0
early stop counter: 1
val acc:0.9645677804946899, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9574605226516724 / 0.9595552682876587
after epoch: 10,now: 2024-07-26 19:21:38.753363,epoch time: 0:13:50.116300,used: 2:28:43.756230,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99729025, 'precision': 0.997656, 'recall': 0.99518657, 'specificity': 0.99518657, 'f1': 0.99641347, 'auroc': 0.9997574, 'binary_precision': 0.99839294, 'binary_recall': 0.9909154, 'binary_specificity': 0.9994577, 'binary_f1_score': 0.9946401}
confusion matrix:
       0      1
0  42389     23
1    131  14289
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.75552094, 'recall': 0.5215964, 'specificity': 0.5215964, 'f1': 0.5321209, 'auroc': 0.9369221, 'binary_precision': 0.54545456, 'binary_recall': 0.044576522, 'binary_specificity': 0.9986163, 'binary_f1_score': 0.08241758}
confusion matrix:
       0   1
0  18042  25
1    643  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9555269, 'precision': 0.4789984, 'recall': 0.49865454, 'specificity': 0.49865454, 'f1': 0.48862886, 'auroc': 0.88668257, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5930  16
1   260   0
early stop counter: 2
val acc:0.9643543362617493, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9574605226516724 / 0.9595552682876587
after epoch: 11,now: 2024-07-26 19:35:13.089026,epoch time: 0:13:34.335663,used: 2:42:18.091893,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9950204, 'precision': 0.9945411, 'recall': 0.9922918, 'specificity': 0.9922918, 'f1': 0.99340993, 'auroc': 0.99963343, 'binary_precision': 0.993575, 'binary_recall': 0.9867527, 'binary_specificity': 0.9978309, 'binary_f1_score': 0.9901521}
confusion matrix:
       0      1
0  42322     92
1    191  14227
---- Validation: 
scalar performance:
{'acc': 0.9676094, 'precision': 0.7712074, 'recall': 0.7121151, 'specificity': 0.7121151, 'f1': 0.73766077, 'auroc': 0.9315484, 'binary_precision': 0.5632184, 'binary_recall': 0.43684992, 'binary_specificity': 0.9873803, 'binary_f1_score': 0.49205023}
confusion matrix:
       0    1
0  17839  228
1    379  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.7694297, 'recall': 0.6283196, 'specificity': 0.6283196, 'f1': 0.67100346, 'auroc': 0.865684, 'binary_precision': 0.57024795, 'binary_recall': 0.2653846, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.36220473}
confusion matrix:
      0   1
0  5894  52
1   191  69
new oracle model saved
early stop counter: 3
val acc:0.9676094055175781, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9574605226516724 / 0.9608443379402161
after epoch: 12,now: 2024-07-26 19:48:59.735562,epoch time: 0:13:46.646536,used: 2:56:04.738429,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99468607, 'precision': 0.99606055, 'recall': 0.98991746, 'specificity': 0.98991746, 'f1': 0.99294055, 'auroc': 0.9996457, 'binary_precision': 0.9987987, 'binary_recall': 0.98023576, 'binary_specificity': 0.99959916, 'binary_f1_score': 0.9894302}
confusion matrix:
       0      1
0  42395     17
1    285  14135
---- Validation: 
scalar performance:
{'acc': 0.9618997, 'precision': 0.63881445, 'recall': 0.5231844, 'specificity': 0.5231844, 'f1': 0.53375024, 'auroc': 0.9096458, 'binary_precision': 0.3119266, 'binary_recall': 0.05052006, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.086956516}
confusion matrix:
       0   1
0  17992  75
1    639  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9390912, 'precision': 0.4948204, 'recall': 0.4974333, 'specificity': 0.4974333, 'f1': 0.49464673, 'auroc': 0.81839037, 'binary_precision': 0.031746034, 'binary_recall': 0.015384615, 'binary_specificity': 0.979482, 'binary_f1_score': 0.02072539}
confusion matrix:
      0    1
0  5824  122
1   256    4
early stop counter: 4
val acc:0.9618996977806091, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9574605226516724 / 0.9608443379402161
after epoch: 13,now: 2024-07-26 20:02:45.338052,epoch time: 0:13:45.602490,used: 3:09:50.340919,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9971671, 'precision': 0.9979923, 'recall': 0.9945315, 'specificity': 0.9945315, 'f1': 0.9962465, 'auroc': 0.99975336, 'binary_precision': 0.9996496, 'binary_recall': 0.9891809, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.9943877}
confusion matrix:
       0      1
0  42408      5
1    156  14263
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.80953217, 'recall': 0.55169725, 'specificity': 0.55169725, 'f1': 0.58207303, 'auroc': 0.9337797, 'binary_precision': 0.6513761, 'binary_recall': 0.10549777, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.18158568}
confusion matrix:
       0   1
0  18029  38
1    602  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.5245506, 'recall': 0.5010822, 'specificity': 0.5010822, 'f1': 0.49261189, 'auroc': 0.8936617, 'binary_precision': 0.09090909, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.007380074}
confusion matrix:
      0   1
0  5936  10
1   259   1
early stop counter: 5
val acc:0.965848445892334, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9574605226516724 / 0.9608443379402161
after epoch: 14,now: 2024-07-26 20:16:35.207802,epoch time: 0:13:49.869750,used: 3:23:40.210669,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_16_52_54_seed_1_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 3:23:40.210669 at 2024-07-26 20:16:35.207802
persisted model performance metric: 

scalar performance:
{'acc': 0.9574605, 'precision': 0.6292608, 'recall': 0.5051806, 'specificity': 0.5051806, 'f1': 0.50023973, 'auroc': 0.93612206, 'binary_precision': 0.3, 'binary_recall': 0.011538462, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.02222222}
confusion matrix:
      0  1
0  5939  7
1   257  3
oracle model performance metric: 

scalar performance:
{'acc': 0.96084434, 'precision': 0.7694297, 'recall': 0.6283196, 'specificity': 0.6283196, 'f1': 0.67100346, 'auroc': 0.865684, 'binary_precision': 0.57024795, 'binary_recall': 0.2653846, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.36220473}
confusion matrix:
      0   1
0  5894  52
1   191  69
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 504485 KiB |   2051 MiB |   1190 TiB |   1190 TiB |
|       from large pool | 462809 KiB |   2018 MiB |   1175 TiB |   1175 TiB |
|       from small pool |  41675 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 504485 KiB |   2051 MiB |   1190 TiB |   1190 TiB |
|       from large pool | 462809 KiB |   2018 MiB |   1175 TiB |   1175 TiB |
|       from small pool |  41675 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496647 KiB |   2046 MiB |   1190 TiB |   1190 TiB |
|       from large pool | 455971 KiB |   2014 MiB |   1175 TiB |   1175 TiB |
|       from small pool |  40676 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2320 MiB |   2324 MiB |   3808 MiB |   1488 MiB |
|       from large pool |   2256 MiB |   2256 MiB |   3722 MiB |   1466 MiB |
|       from small pool |     64 MiB |     70 MiB |     86 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 357723 KiB | 451353 KiB |    926 TiB |    926 TiB |
|       from large pool | 350246 KiB | 430097 KiB |    910 TiB |    910 TiB |
|       from small pool |   7476 KiB |  21264 KiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8115    |  228298 K  |  228294 K  |
|       from large pool |     187    |     311    |  111521 K  |  111520 K  |
|       from small pool |    3277    |    7927    |  116777 K  |  116774 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8115    |  228298 K  |  228294 K  |
|       from large pool |     187    |     311    |  111521 K  |  111520 K  |
|       from small pool |    3277    |    7927    |  116777 K  |  116774 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     128    |     195    |      69    |
|       from large pool |      94    |      94    |     152    |      58    |
|       from small pool |      32    |      35    |      43    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      65    |    3612    |  117954 K  |  117954 K  |
|       from large pool |      34    |      89    |   72588 K  |   72588 K  |
|       from small pool |      31    |    3580    |   45365 K  |   45365 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   2051 MiB |   1190 TiB |   1190 TiB |
|       from large pool |  65536 KiB |   2018 MiB |   1175 TiB |   1175 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   2051 MiB |   1190 TiB |   1190 TiB |
|       from large pool |  65536 KiB |   2018 MiB |   1175 TiB |   1175 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   2046 MiB |   1190 TiB |   1190 TiB |
|       from large pool |  65536 KiB |   2014 MiB |   1175 TiB |   1175 TiB |
|       from small pool |      0 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    842 MiB |   2324 MiB |   3808 MiB |   2966 MiB |
|       from large pool |    794 MiB |   2256 MiB |   3722 MiB |   2928 MiB |
|       from small pool |     48 MiB |     70 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 451353 KiB |    926 TiB |    926 TiB |
|       from large pool |      0 B   | 430097 KiB |    910 TiB |    910 TiB |
|       from small pool |      0 B   |  22399 KiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |  228298 K  |  228298 K  |
|       from large pool |       2    |     311    |  111521 K  |  111521 K  |
|       from small pool |       0    |    7927    |  116777 K  |  116777 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |  228298 K  |  228298 K  |
|       from large pool |       2    |     311    |  111521 K  |  111521 K  |
|       from small pool |       0    |    7927    |  116777 K  |  116777 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     128    |     195    |     136    |
|       from large pool |      35    |      94    |     152    |     117    |
|       from small pool |      24    |      35    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3612    |  117956 K  |  117956 K  |
|       from large pool |       0    |      89    |   72588 K  |   72588 K  |
|       from small pool |       0    |    3580    |   45367 K  |   45367 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   2051 MiB |   1190 TiB |   1190 TiB |
|       from large pool |  65536 KiB |   2018 MiB |   1175 TiB |   1175 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   2051 MiB |   1190 TiB |   1190 TiB |
|       from large pool |  65536 KiB |   2018 MiB |   1175 TiB |   1175 TiB |
|       from small pool |      0 KiB |     61 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   2046 MiB |   1190 TiB |   1190 TiB |
|       from large pool |  65536 KiB |   2014 MiB |   1175 TiB |   1175 TiB |
|       from small pool |      0 KiB |     60 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    842 MiB |   2324 MiB |   3808 MiB |   2966 MiB |
|       from large pool |    794 MiB |   2256 MiB |   3722 MiB |   2928 MiB |
|       from small pool |     48 MiB |     70 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 451353 KiB |    926 TiB |    926 TiB |
|       from large pool |      0 B   | 430097 KiB |    910 TiB |    910 TiB |
|       from small pool |      0 B   |  22399 KiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |  228298 K  |  228298 K  |
|       from large pool |       2    |     311    |  111521 K  |  111521 K  |
|       from small pool |       0    |    7927    |  116777 K  |  116777 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |  228298 K  |  228298 K  |
|       from large pool |       2    |     311    |  111521 K  |  111521 K  |
|       from small pool |       0    |    7927    |  116777 K  |  116777 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     128    |     195    |     136    |
|       from large pool |      35    |      94    |     152    |     117    |
|       from small pool |      24    |      35    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3612    |  117956 K  |  117956 K  |
|       from large pool |       0    |      89    |   72588 K  |   72588 K  |
|       from small pool |       0    |    3580    |   45367 K  |   45367 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_21_51_seed_2_23069999

 Experiment start at: 2024-07-26 20:21:51.447271
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98356545, 'precision': 0.98891866, 'recall': 0.9689523, 'specificity': 0.9689523, 'f1': 0.97839, 'auroc': 0.9981218, 'binary_precision': 0.99950707, 'binary_recall': 0.93807006, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.9678145}
confusion matrix:
       0      1
0  42303      7
1    937  14193
---- Validation: 
scalar performance:
{'acc': 0.97198105, 'precision': 0.8405652, 'recall': 0.6064875, 'specificity': 0.6064875, 'f1': 0.65823984, 'auroc': 0.91260743, 'binary_precision': 0.70652175, 'binary_recall': 0.21594684, 'binary_specificity': 0.99702823, 'binary_f1_score': 0.3307888}
confusion matrix:
       0    1
0  18117   54
1    472  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.48057473, 'recall': 0.49916625, 'specificity': 0.49916625, 'f1': 0.4896941, 'auroc': 0.90448827, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5987  10
1   242   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 20:35:50.814743,epoch time: 0:13:59.367472,used: 0:13:59.367472,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_21_51_seed_2_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99329734, 'precision': 0.9923062, 'recall': 0.9903977, 'specificity': 0.9903977, 'f1': 0.99134684, 'auroc': 0.9992783, 'binary_precision': 0.99022543, 'binary_recall': 0.9842697, 'binary_specificity': 0.99652565, 'binary_f1_score': 0.9872386}
confusion matrix:
       0      1
0  42163    147
1    238  14892
---- Validation: 
scalar performance:
{'acc': 0.95450914, 'precision': 0.68962836, 'recall': 0.8456041, 'specificity': 0.8456041, 'f1': 0.7415415, 'auroc': 0.9355813, 'binary_precision': 0.38849556, 'binary_recall': 0.7292359, 'binary_specificity': 0.96197236, 'binary_f1_score': 0.5069284}
confusion matrix:
       0    1
0  17480  691
1    163  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97563714, 'precision': 0.86617017, 'recall': 0.7751738, 'specificity': 0.7751738, 'f1': 0.81360126, 'auroc': 0.9190589, 'binary_precision': 0.75, 'binary_recall': 0.55785125, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.6398104}
confusion matrix:
      0    1
0  5952   45
1   107  135
new oracle model saved
early stop counter: 1
val acc:0.9545091390609741, best validation acc: 0.9719810485839844, corresponding to test acc:                         0.9596089124679565 / 0.9756371378898621
after epoch: 2,now: 2024-07-26 20:49:33.217488,epoch time: 0:13:42.402745,used: 0:27:41.770217,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_21_51_seed_2_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9957695, 'precision': 0.9967073, 'recall': 0.99239373, 'specificity': 0.99239373, 'f1': 0.9945251, 'auroc': 0.9994997, 'binary_precision': 0.99866, 'binary_recall': 0.98526007, 'binary_specificity': 0.99952734, 'binary_f1_score': 0.99191475}
confusion matrix:
       0      1
0  42291     20
1    223  14906
---- Validation: 
scalar performance:
{'acc': 0.9701167, 'precision': 0.7811022, 'recall': 0.61194885, 'specificity': 0.61194885, 'f1': 0.65723336, 'auroc': 0.93799496, 'binary_precision': 0.587234, 'binary_recall': 0.22923589, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.3297491}
confusion matrix:
       0    1
0  18074   97
1    464  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.48058718, 'recall': 0.49949974, 'specificity': 0.49949974, 'f1': 0.48986098, 'auroc': 0.9184352, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5991  6
1   242  0
early stop counter: 2
val acc:0.9701166749000549, best validation acc: 0.9719810485839844, corresponding to test acc:                         0.9596089124679565 / 0.9756371378898621
after epoch: 3,now: 2024-07-26 21:03:11.531760,epoch time: 0:13:38.314272,used: 0:41:20.084489,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_21_51_seed_2_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9901114, 'precision': 0.9933537, 'recall': 0.98124933, 'specificity': 0.98124933, 'f1': 0.9871013, 'auroc': 0.99962914, 'binary_precision': 0.99993134, 'binary_recall': 0.9625223, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9808703}
confusion matrix:
       0      1
0  42310      1
1    567  14562
---- Validation: 
scalar performance:
{'acc': 0.9703297, 'precision': 0.87447095, 'recall': 0.5518303, 'specificity': 0.5518303, 'f1': 0.5846851, 'auroc': 0.93092066, 'binary_precision': 0.7777778, 'binary_recall': 0.10465116, 'binary_specificity': 0.99900943, 'binary_f1_score': 0.18448023}
confusion matrix:
       0   1
0  18153  18
1    539  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.9808371, 'recall': 0.50619835, 'specificity': 0.50619835, 'f1': 0.5024762, 'auroc': 0.9306134, 'binary_precision': 1.0, 'binary_recall': 0.012396694, 'binary_specificity': 1.0, 'binary_f1_score': 0.024489796}
confusion matrix:
      0  1
0  5997  0
1   239  3
early stop counter: 3
val acc:0.9703297019004822, best validation acc: 0.9719810485839844, corresponding to test acc:                         0.9596089124679565 / 0.9756371378898621
after epoch: 4,now: 2024-07-26 21:17:25.467594,epoch time: 0:14:13.935834,used: 0:55:34.020323,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_21_51_seed_2_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.996727, 'precision': 0.99626535, 'recall': 0.99529445, 'specificity': 0.99529445, 'f1': 0.9957786, 'auroc': 0.9996998, 'binary_precision': 0.995293, 'binary_recall': 0.992267, 'binary_specificity': 0.9983219, 'binary_f1_score': 0.99377775}
confusion matrix:
       0      1
0  42239     71
1    117  15013
---- Validation: 
scalar performance:
{'acc': 0.96601504, 'precision': 0.72773576, 'recall': 0.74233305, 'specificity': 0.74233305, 'f1': 0.73478174, 'auroc': 0.92631507, 'binary_precision': 0.47196263, 'binary_recall': 0.50332224, 'binary_specificity': 0.9813439, 'binary_f1_score': 0.48713827}
confusion matrix:
       0    1
0  17832  339
1    299  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95640326, 'precision': 0.61459386, 'recall': 0.53120536, 'specificity': 0.53120536, 'f1': 0.5443824, 'auroc': 0.9174628, 'binary_precision': 0.265625, 'binary_recall': 0.07024793, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.111111104}
confusion matrix:
      0   1
0  5950  47
1   225  17
early stop counter: 4
val acc:0.9660150408744812, best validation acc: 0.9719810485839844, corresponding to test acc:                         0.9596089124679565 / 0.9756371378898621
after epoch: 5,now: 2024-07-26 21:31:03.825626,epoch time: 0:13:38.358032,used: 1:09:12.378355,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_21_51_seed_2_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97691506, 'precision': 0.9726834, 'recall': 0.9675784, 'specificity': 0.9675784, 'f1': 0.97009283, 'auroc': 0.99595964, 'binary_precision': 0.963904, 'binary_recall': 0.9478485, 'binary_specificity': 0.98730826, 'binary_f1_score': 0.9558088}
confusion matrix:
       0      1
0  41774    537
1    789  14340
---- Validation: 
scalar performance:
{'acc': 0.95296437, 'precision': 0.65052557, 'recall': 0.69383305, 'specificity': 0.69383305, 'f1': 0.66901815, 'auroc': 0.87049496, 'binary_precision': 0.32056195, 'binary_recall': 0.41694352, 'binary_specificity': 0.97072256, 'binary_f1_score': 0.36245486}
confusion matrix:
       0    1
0  17639  532
1    351  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535182, 'precision': 0.4804555, 'recall': 0.495998, 'specificity': 0.495998, 'f1': 0.48810303, 'auroc': 0.872071, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.991996, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5949  48
1   242   0
early stop counter: 5
val acc:0.9529643654823303, best validation acc: 0.9719810485839844, corresponding to test acc:                         0.9596089124679565 / 0.9756371378898621
after epoch: 6,now: 2024-07-26 21:47:03.020728,epoch time: 0:15:59.195102,used: 1:25:11.573457,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_21_51_seed_2_23069999
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 1:25:11.573457 at 2024-07-26 21:47:03.020728
persisted model performance metric: 

scalar performance:
{'acc': 0.9596089, 'precision': 0.48057473, 'recall': 0.49916625, 'specificity': 0.49916625, 'f1': 0.4896941, 'auroc': 0.90448827, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5987  10
1   242   0
oracle model performance metric: 

scalar performance:
{'acc': 0.97563714, 'precision': 0.86617017, 'recall': 0.7751738, 'specificity': 0.7751738, 'f1': 0.81360126, 'auroc': 0.9190589, 'binary_precision': 0.75, 'binary_recall': 0.55785125, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.6398104}
confusion matrix:
      0    1
0  5952   45
1   107  135
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 504902 KiB |   2051 MiB |   1424 TiB |   1424 TiB |
|       from large pool | 463221 KiB |   2019 MiB |   1406 TiB |   1406 TiB |
|       from small pool |  41681 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 504902 KiB |   2051 MiB |   1424 TiB |   1424 TiB |
|       from large pool | 463221 KiB |   2019 MiB |   1406 TiB |   1406 TiB |
|       from small pool |  41681 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496649 KiB |   2046 MiB |   1424 TiB |   1424 TiB |
|       from large pool | 455971 KiB |   2014 MiB |   1406 TiB |   1406 TiB |
|       from small pool |  40678 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2320 MiB |   2324 MiB |   5286 MiB |   2966 MiB |
|       from large pool |   2256 MiB |   2256 MiB |   5184 MiB |   2928 MiB |
|       from small pool |     64 MiB |     70 MiB |    102 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 345017 KiB | 451353 KiB |   1098 TiB |   1098 TiB |
|       from large pool | 339595 KiB | 430097 KiB |   1080 TiB |   1080 TiB |
|       from small pool |   5422 KiB |  22399 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8165    |  273201 K  |  273198 K  |
|       from large pool |     187    |     311    |  133441 K  |  133441 K  |
|       from small pool |    3289    |    7977    |  139759 K  |  139756 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8165    |  273201 K  |  273198 K  |
|       from large pool |     187    |     311    |  133441 K  |  133441 K  |
|       from small pool |    3289    |    7977    |  139759 K  |  139756 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     128    |     262    |     136    |
|       from large pool |      94    |      94    |     211    |     117    |
|       from small pool |      32    |      35    |      51    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      58    |    3634    |  141712 K  |  141711 K  |
|       from large pool |      29    |      89    |   87473 K  |   87473 K  |
|       from small pool |      29    |    3605    |   54238 K  |   54238 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   2051 MiB |   1424 TiB |   1424 TiB |
|       from large pool |  65536 KiB |   2019 MiB |   1406 TiB |   1406 TiB |
|       from small pool |      0 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   2051 MiB |   1424 TiB |   1424 TiB |
|       from large pool |  65536 KiB |   2019 MiB |   1406 TiB |   1406 TiB |
|       from small pool |      0 KiB |     61 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   2046 MiB |   1424 TiB |   1424 TiB |
|       from large pool |  65536 KiB |   2014 MiB |   1406 TiB |   1406 TiB |
|       from small pool |      0 KiB |     60 MiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    830 MiB |   2324 MiB |   5286 MiB |   4456 MiB |
|       from large pool |    784 MiB |   2256 MiB |   5184 MiB |   4400 MiB |
|       from small pool |     46 MiB |     70 MiB |    102 MiB |     56 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 451353 KiB |   1098 TiB |   1098 TiB |
|       from large pool |      0 B   | 430097 KiB |   1080 TiB |   1080 TiB |
|       from small pool |      0 B   |  26321 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8165    |  273201 K  |  273201 K  |
|       from large pool |       2    |     311    |  133441 K  |  133441 K  |
|       from small pool |       0    |    7977    |  139759 K  |  139759 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8165    |  273201 K  |  273201 K  |
|       from large pool |       2    |     311    |  133441 K  |  133441 K  |
|       from small pool |       0    |    7977    |  139759 K  |  139759 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     128    |     262    |     206    |
|       from large pool |      33    |      94    |     211    |     178    |
|       from small pool |      23    |      35    |      51    |      28    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3634    |  141713 K  |  141713 K  |
|       from large pool |       0    |      89    |   87473 K  |   87473 K  |
|       from small pool |       0    |    3605    |   54239 K  |   54239 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 21:47:51 2024]
Finished job 0.
1 of 1 steps (100%) done
