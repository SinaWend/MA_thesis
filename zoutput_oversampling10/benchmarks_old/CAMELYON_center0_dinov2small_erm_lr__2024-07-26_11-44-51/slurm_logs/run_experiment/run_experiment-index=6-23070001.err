Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 11:47:27 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_04_seed_0_23070001

 Experiment start at: 2024-07-26 11:58:04.593368
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9871458, 'precision': 0.9866851, 'recall': 0.9796353, 'specificity': 0.9796353, 'f1': 0.983093, 'auroc': 0.9982291, 'binary_precision': 0.98575497, 'binary_recall': 0.9641158, 'binary_specificity': 0.9951548, 'binary_f1_score': 0.97481525}
confusion matrix:
       0      1
0  42105    205
1    528  14186
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.7306787, 'recall': 0.68851805, 'specificity': 0.68851805, 'f1': 0.7072341, 'auroc': 0.9095485, 'binary_precision': 0.4827586, 'binary_recall': 0.3919129, 'binary_specificity': 0.98512316, 'binary_f1_score': 0.43261802}
confusion matrix:
       0    1
0  17879  270
1    391  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8690648, 'recall': 0.57754356, 'specificity': 0.57754356, 'f1': 0.6210666, 'auroc': 0.91229594, 'binary_precision': 0.7735849, 'binary_recall': 0.15708812, 'binary_specificity': 0.997999, 'binary_f1_score': 0.2611465}
confusion matrix:
      0   1
0  5985  12
1   220  41
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 12:28:06.052355,epoch time: 0:30:01.458987,used: 0:30:01.458987,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_04_seed_0_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9940727, 'precision': 0.99356663, 'recall': 0.9909292, 'specificity': 0.9909292, 'f1': 0.99223864, 'auroc': 0.9992763, 'binary_precision': 0.99253017, 'binary_recall': 0.9844345, 'binary_specificity': 0.9974239, 'binary_f1_score': 0.9884657}
confusion matrix:
       0      1
0  42203    109
1    229  14483
---- Validation: 
scalar performance:
{'acc': 0.9626969, 'precision': 0.72147554, 'recall': 0.74892056, 'specificity': 0.74892056, 'f1': 0.73429537, 'auroc': 0.9212044, 'binary_precision': 0.46005508, 'binary_recall': 0.5194401, 'binary_specificity': 0.978401, 'binary_f1_score': 0.4879474}
confusion matrix:
       0    1
0  17757  392
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94646853, 'precision': 0.6666828, 'recall': 0.6697343, 'specificity': 0.6697343, 'f1': 0.668192, 'auroc': 0.87832916, 'binary_precision': 0.36090225, 'binary_recall': 0.3678161, 'binary_specificity': 0.9716525, 'binary_f1_score': 0.36432636}
confusion matrix:
      0    1
0  5827  170
1   165   96
early stop counter: 1
val acc:0.96269690990448, best validation acc: 0.964825451374054, corresponding to test acc:                         0.9629274606704712 / 0.9629274606704712
after epoch: 2,now: 2024-07-26 12:58:38.134345,epoch time: 0:30:32.081990,used: 1:00:33.540977,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_04_seed_0_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9924418, 'precision': 0.9885074, 'recall': 0.99184686, 'specificity': 0.99184686, 'f1': 0.9901619, 'auroc': 0.99952424, 'binary_precision': 0.98028797, 'binary_recall': 0.990618, 'binary_specificity': 0.9930757, 'binary_f1_score': 0.9854259}
confusion matrix:
       0      1
0  42022    293
1    138  14571
---- Validation: 
scalar performance:
{'acc': 0.9202852, 'precision': 0.6384663, 'recall': 0.89197564, 'specificity': 0.89197564, 'f1': 0.6911729, 'auroc': 0.94586694, 'binary_precision': 0.28222108, 'binary_recall': 0.86158633, 'binary_specificity': 0.9223649, 'binary_f1_score': 0.42517266}
confusion matrix:
       0     1
0  16740  1409
1     89   554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85746247, 'precision': 0.5957651, 'recall': 0.8358451, 'specificity': 0.8358451, 'f1': 0.6212728, 'auroc': 0.87981266, 'binary_precision': 0.20094787, 'binary_recall': 0.8122605, 'binary_specificity': 0.8594297, 'binary_f1_score': 0.32218844}
confusion matrix:
      0    1
0  5154  843
1    49  212
early stop counter: 2
val acc:0.9202852249145508, best validation acc: 0.964825451374054, corresponding to test acc:                         0.9629274606704712 / 0.9629274606704712
after epoch: 3,now: 2024-07-26 13:28:04.505325,epoch time: 0:29:26.370980,used: 1:29:59.911957,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_04_seed_0_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9924769, 'precision': 0.99495816, 'recall': 0.9854393, 'specificity': 0.9854393, 'f1': 0.9900793, 'auroc': 0.9996172, 'binary_precision': 0.99992996, 'binary_recall': 0.97090214, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.98520225}
confusion matrix:
       0      1
0  42314      1
1    428  14281
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.89729786, 'recall': 0.51852477, 'specificity': 0.51852477, 'f1': 0.52726173, 'auroc': 0.94019127, 'binary_precision': 0.82758623, 'binary_recall': 0.03732504, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.071428575}
confusion matrix:
       0   1
0  18144   5
1    619  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.9334107, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
better model found
persisted
after epoch: 4,now: 2024-07-26 13:57:02.866239,epoch time: 0:28:58.360914,used: 1:58:58.272871,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_04_seed_0_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.996405, 'precision': 0.9974978, 'recall': 0.9931239, 'specificity': 0.9931239, 'f1': 0.9952856, 'auroc': 0.9997755, 'binary_precision': 0.9997245, 'binary_recall': 0.9863423, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9929883}
confusion matrix:
       0      1
0  42303      4
1    201  14516
---- Validation: 
scalar performance:
{'acc': 0.97227544, 'precision': 0.79925275, 'recall': 0.74637896, 'specificity': 0.74637896, 'f1': 0.7700063, 'auroc': 0.95140845, 'binary_precision': 0.6159696, 'binary_recall': 0.503888, 'binary_specificity': 0.9888699, 'binary_f1_score': 0.5543199}
confusion matrix:
       0    1
0  17947  202
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8477267, 'recall': 0.5867052, 'specificity': 0.5867052, 'f1': 0.63246095, 'auroc': 0.9298375, 'binary_precision': 0.73015875, 'binary_recall': 0.17624521, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.28395063}
confusion matrix:
      0   1
0  5980  17
1   215  46
better model found
persisted
after epoch: 5,now: 2024-07-26 14:45:06.136344,epoch time: 0:48:03.270105,used: 2:47:01.542976,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_04_seed_0_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99545807, 'precision': 0.99486464, 'recall': 0.99325794, 'specificity': 0.99325794, 'f1': 0.99405783, 'auroc': 0.9996364, 'binary_precision': 0.99364537, 'binary_recall': 0.9887136, 'binary_specificity': 0.99780226, 'binary_f1_score': 0.9911734}
confusion matrix:
       0      1
0  42223     93
1    166  14542
---- Validation: 
scalar performance:
{'acc': 0.9539698, 'precision': 0.6954197, 'recall': 0.833659, 'specificity': 0.833659, 'f1': 0.7437111, 'auroc': 0.94157577, 'binary_precision': 0.40159574, 'binary_recall': 0.7045101, 'binary_specificity': 0.9628079, 'binary_f1_score': 0.5115754}
confusion matrix:
       0    1
0  17474  675
1    190  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95238096, 'precision': 0.72174, 'recall': 0.84505856, 'specificity': 0.84505856, 'f1': 0.7676494, 'auroc': 0.92523205, 'binary_precision': 0.4556355, 'binary_recall': 0.72796935, 'binary_specificity': 0.9621477, 'binary_f1_score': 0.56047195}
confusion matrix:
      0    1
0  5770  227
1    71  190
early stop counter: 1
val acc:0.9539697766304016, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9629274606704712 / 0.9629274606704712
after epoch: 6,now: 2024-07-26 15:24:34.101944,epoch time: 0:39:27.965600,used: 3:26:29.508576,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_04_seed_0_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9947566, 'precision': 0.9960313, 'recall': 0.99028033, 'specificity': 0.99028033, 'f1': 0.99311215, 'auroc': 0.99933434, 'binary_precision': 0.99861604, 'binary_recall': 0.9810333, 'binary_specificity': 0.99952734, 'binary_f1_score': 0.98974663}
confusion matrix:
       0      1
0  42294     20
1    279  14431
---- Validation: 
scalar performance:
{'acc': 0.9623776, 'precision': 0.65615547, 'recall': 0.55074066, 'specificity': 0.55074066, 'f1': 0.5730222, 'auroc': 0.9363741, 'binary_precision': 0.34313726, 'binary_recall': 0.108864695, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.16528925}
confusion matrix:
       0    1
0  18015  134
1    573   70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542985, 'precision': 0.47906306, 'recall': 0.49791563, 'specificity': 0.49791563, 'f1': 0.48830748, 'auroc': 0.8749466, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5972  25
1   261   0
early stop counter: 2
val acc:0.9623776078224182, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9629274606704712 / 0.9629274606704712
after epoch: 7,now: 2024-07-26 15:53:59.277849,epoch time: 0:29:25.175905,used: 3:55:54.684481,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_04_seed_0_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99603677, 'precision': 0.99480325, 'recall': 0.9948471, 'specificity': 0.9948471, 'f1': 0.9948252, 'auroc': 0.9997288, 'binary_precision': 0.99225384, 'binary_recall': 0.9923887, 'binary_specificity': 0.9973055, 'binary_f1_score': 0.9923213}
confusion matrix:
       0      1
0  42195    114
1    112  14603
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.7685813, 'recall': 0.7508091, 'specificity': 0.7508091, 'f1': 0.7593585, 'auroc': 0.93927, 'binary_precision': 0.5542571, 'binary_recall': 0.5163297, 'binary_specificity': 0.98528844, 'binary_f1_score': 0.53462154}
confusion matrix:
       0    1
0  17882  267
1    311  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8259197, 'recall': 0.5863717, 'specificity': 0.5863717, 'f1': 0.63056225, 'auroc': 0.9315962, 'binary_precision': 0.6865672, 'binary_recall': 0.17624521, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.2804878}
confusion matrix:
      0   1
0  5976  21
1   215  46
early stop counter: 3
val acc:0.9692422151565552, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9629274606704712 / 0.9629274606704712
after epoch: 8,now: 2024-07-26 16:22:58.161496,epoch time: 0:28:58.883647,used: 4:24:53.568128,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_04_seed_0_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9978079, 'precision': 0.9978994, 'recall': 0.99637187, 'specificity': 0.99637187, 'f1': 0.99713254, 'auroc': 0.9998814, 'binary_precision': 0.9980874, 'binary_recall': 0.9934054, 'binary_specificity': 0.99933827, 'binary_f1_score': 0.99574095}
confusion matrix:
       0      1
0  42287     28
1     97  14612
---- Validation: 
scalar performance:
{'acc': 0.9720626, 'precision': 0.8180995, 'recall': 0.68776447, 'specificity': 0.68776447, 'f1': 0.73470926, 'auroc': 0.96053326, 'binary_precision': 0.657754, 'binary_recall': 0.38258165, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.4837758}
confusion matrix:
       0    1
0  18021  128
1    397  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.60428, 'recall': 0.5033312, 'specificity': 0.5033312, 'f1': 0.49661598, 'auroc': 0.9617815, 'binary_precision': 0.25, 'binary_recall': 0.007662835, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.014869888}
confusion matrix:
      0  1
0  5991  6
1   259  2
early stop counter: 4
val acc:0.9720625877380371, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9629274606704712 / 0.9629274606704712
after epoch: 9,now: 2024-07-26 16:52:07.374321,epoch time: 0:29:09.212825,used: 4:54:02.780953,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_04_seed_0_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.992547, 'precision': 0.9880347, 'recall': 0.9926502, 'specificity': 0.9926502, 'f1': 0.9903133, 'auroc': 0.9995506, 'binary_precision': 0.9785638, 'binary_recall': 0.9928635, 'binary_specificity': 0.99243695, 'binary_f1_score': 0.9856618}
confusion matrix:
       0      1
0  41991    320
1    105  14608
---- Validation: 
scalar performance:
{'acc': 0.95780116, 'precision': 0.6864375, 'recall': 0.70288277, 'specificity': 0.70288277, 'f1': 0.6942632, 'auroc': 0.93204445, 'binary_precision': 0.3931624, 'binary_recall': 0.42923796, 'binary_specificity': 0.97652763, 'binary_f1_score': 0.41040894}
confusion matrix:
       0    1
0  17723  426
1    367  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.47912335, 'recall': 0.49941638, 'specificity': 0.49941638, 'f1': 0.48905948, 'auroc': 0.9578439, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5990  7
1   261  0
early stop counter: 5
val acc:0.9578011631965637, best validation acc: 0.97227543592453, corresponding to test acc:                         0.9629274606704712 / 0.9629274606704712
after epoch: 10,now: 2024-07-26 17:21:01.282580,epoch time: 0:28:53.908259,used: 5:22:56.689212,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_58_04_seed_0_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 5:22:56.689212 at 2024-07-26 17:21:01.282580
persisted model performance metric: 

scalar performance:
{'acc': 0.96292746, 'precision': 0.8477267, 'recall': 0.5867052, 'specificity': 0.5867052, 'f1': 0.63246095, 'auroc': 0.9298375, 'binary_precision': 0.73015875, 'binary_recall': 0.17624521, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.28395063}
confusion matrix:
      0   1
0  5980  17
1   215  46
oracle model performance metric: 

scalar performance:
{'acc': 0.96292746, 'precision': 0.8690648, 'recall': 0.57754356, 'specificity': 0.57754356, 'f1': 0.6210666, 'auroc': 0.91229594, 'binary_precision': 0.7735849, 'binary_recall': 0.15708812, 'binary_specificity': 0.997999, 'binary_f1_score': 0.2611465}
confusion matrix:
      0   1
0  5985  12
1   220  41
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454018 KiB |   3644 MiB | 369922 GiB | 369922 GiB |
|       from large pool | 412919 KiB |   3611 MiB | 367413 GiB | 367412 GiB |
|       from small pool |  41099 KiB |     57 MiB |   2509 GiB |   2509 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454018 KiB |   3644 MiB | 369922 GiB | 369922 GiB |
|       from large pool | 412919 KiB |   3611 MiB | 367413 GiB | 367412 GiB |
|       from small pool |  41099 KiB |     57 MiB |   2509 GiB |   2509 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   3642 MiB | 369801 GiB | 369801 GiB |
|       from large pool | 407075 KiB |   3608 MiB | 367296 GiB | 367296 GiB |
|       from small pool |  40679 KiB |     56 MiB |   2505 GiB |   2505 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3944 MiB |   3944 MiB |   3944 MiB |      0 B   |
|       from large pool |   3880 MiB |   3880 MiB |   3880 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 565885 KiB | 640882 KiB | 199682 GiB | 199681 GiB |
|       from large pool | 559881 KiB | 634037 KiB | 197057 GiB | 197056 GiB |
|       from small pool |   6004 KiB |  11568 KiB |   2624 GiB |   2624 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2312    |    4549    |   37001 K  |   36999 K  |
|       from large pool |     187    |     311    |   18020 K  |   18020 K  |
|       from small pool |    2125    |    4361    |   18981 K  |   18979 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2312    |    4549    |   37001 K  |   36999 K  |
|       from large pool |     187    |     311    |   18020 K  |   18020 K  |
|       from small pool |    2125    |    4361    |   18981 K  |   18979 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     151    |     151    |     151    |       0    |
|       from large pool |     119    |     119    |     119    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    1835    |   20700 K  |   20700 K  |
|       from large pool |      32    |     119    |   13556 K  |   13556 K  |
|       from small pool |      31    |    1803    |    7143 K  |    7143 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3644 MiB | 369922 GiB | 369922 GiB |
|       from large pool |  16640 KiB |   3611 MiB | 367413 GiB | 367413 GiB |
|       from small pool |      0 KiB |     57 MiB |   2509 GiB |   2509 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3644 MiB | 369922 GiB | 369922 GiB |
|       from large pool |  16640 KiB |   3611 MiB | 367413 GiB | 367413 GiB |
|       from small pool |      0 KiB |     57 MiB |   2509 GiB |   2509 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3642 MiB | 369801 GiB | 369801 GiB |
|       from large pool |  16640 KiB |   3608 MiB | 367296 GiB | 367296 GiB |
|       from small pool |      0 KiB |     56 MiB |   2505 GiB |   2505 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    996 MiB |   3944 MiB |   3944 MiB |   2948 MiB |
|       from large pool |    950 MiB |   3880 MiB |   3880 MiB |   2930 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB | 640882 KiB | 199682 GiB | 199682 GiB |
|       from large pool |   3840 KiB | 634037 KiB | 197057 GiB | 197057 GiB |
|       from small pool |      0 KiB |  19804 KiB |   2625 GiB |   2625 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4549    |   37001 K  |   37001 K  |
|       from large pool |       2    |     311    |   18020 K  |   18020 K  |
|       from small pool |       0    |    4361    |   18981 K  |   18981 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4549    |   37001 K  |   37001 K  |
|       from large pool |       2    |     311    |   18020 K  |   18020 K  |
|       from small pool |       0    |    4361    |   18981 K  |   18981 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     151    |     151    |      91    |
|       from large pool |      37    |     119    |     119    |      82    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1835    |   20701 K  |   20701 K  |
|       from large pool |       1    |     119    |   13556 K  |   13556 K  |
|       from small pool |       0    |    1803    |    7144 K  |    7144 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3644 MiB | 369922 GiB | 369922 GiB |
|       from large pool |  16640 KiB |   3611 MiB | 367413 GiB | 367413 GiB |
|       from small pool |      0 KiB |     57 MiB |   2509 GiB |   2509 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3644 MiB | 369922 GiB | 369922 GiB |
|       from large pool |  16640 KiB |   3611 MiB | 367413 GiB | 367413 GiB |
|       from small pool |      0 KiB |     57 MiB |   2509 GiB |   2509 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3642 MiB | 369801 GiB | 369801 GiB |
|       from large pool |  16640 KiB |   3608 MiB | 367296 GiB | 367296 GiB |
|       from small pool |      0 KiB |     56 MiB |   2505 GiB |   2505 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    996 MiB |   3944 MiB |   3944 MiB |   2948 MiB |
|       from large pool |    950 MiB |   3880 MiB |   3880 MiB |   2930 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB | 640882 KiB | 199682 GiB | 199682 GiB |
|       from large pool |   3840 KiB | 634037 KiB | 197057 GiB | 197057 GiB |
|       from small pool |      0 KiB |  19804 KiB |   2625 GiB |   2625 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4549    |   37001 K  |   37001 K  |
|       from large pool |       2    |     311    |   18020 K  |   18020 K  |
|       from small pool |       0    |    4361    |   18981 K  |   18981 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4549    |   37001 K  |   37001 K  |
|       from large pool |       2    |     311    |   18020 K  |   18020 K  |
|       from small pool |       0    |    4361    |   18981 K  |   18981 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      60    |     151    |     151    |      91    |
|       from large pool |      37    |     119    |     119    |      82    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1835    |   20701 K  |   20701 K  |
|       from large pool |       1    |     119    |   13556 K  |   13556 K  |
|       from small pool |       0    |    1803    |    7144 K  |    7144 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001

 Experiment start at: 2024-07-26 17:29:49.373022
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9757179, 'precision': 0.98244673, 'recall': 0.95365703, 'specificity': 0.95365703, 'f1': 0.9669746, 'auroc': 0.99645877, 'binary_precision': 0.994989, 'binary_recall': 0.9088702, 'binary_specificity': 0.9984439, 'binary_f1_score': 0.94998187}
confusion matrix:
       0      1
0  42347     66
1   1314  13105
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.74287283, 'recall': 0.7033573, 'specificity': 0.7033573, 'f1': 0.72115934, 'auroc': 0.94486105, 'binary_precision': 0.50714284, 'binary_recall': 0.42199108, 'binary_specificity': 0.9847235, 'binary_f1_score': 0.46066508}
confusion matrix:
       0    1
0  17791  276
1    389  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.9153745, 'recall': 0.53820926, 'specificity': 0.53820926, 'f1': 0.5606541, 'auroc': 0.9421817, 'binary_precision': 0.8695652, 'binary_recall': 0.07692308, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.14134276}
confusion matrix:
      0   1
0  5943   3
1   240  20
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 17:59:38.141913,epoch time: 0:29:48.768891,used: 0:29:48.768891,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99477404, 'precision': 0.9946035, 'recall': 0.99157834, 'specificity': 0.99157834, 'f1': 0.9930791, 'auroc': 0.99947214, 'binary_precision': 0.9942605, 'binary_recall': 0.98509014, 'binary_specificity': 0.9980666, 'binary_f1_score': 0.9896541}
confusion matrix:
       0      1
0  42330     82
1    215  14205
---- Validation: 
scalar performance:
{'acc': 0.96835643, 'precision': 0.7871057, 'recall': 0.6774545, 'specificity': 0.6774545, 'f1': 0.7180772, 'auroc': 0.94732606, 'binary_precision': 0.597561, 'binary_recall': 0.3640416, 'binary_specificity': 0.9908673, 'binary_f1_score': 0.4524469}
confusion matrix:
       0    1
0  17902  165
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.479039, 'recall': 0.49966365, 'specificity': 0.49966365, 'f1': 0.489134, 'auroc': 0.93772674, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5942  4
1   260  0
better model found
persisted
after epoch: 2,now: 2024-07-26 18:28:57.108469,epoch time: 0:29:18.966556,used: 0:59:07.735447,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9938767, 'precision': 0.99493134, 'recall': 0.9888946, 'specificity': 0.9888946, 'f1': 0.991866, 'auroc': 0.99939454, 'binary_precision': 0.99703306, 'binary_recall': 0.9787795, 'binary_specificity': 0.9990097, 'binary_f1_score': 0.98782194}
confusion matrix:
       0      1
0  42370     42
1    306  14114
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.78803533, 'recall': 0.5261094, 'specificity': 0.5261094, 'f1': 0.54020023, 'auroc': 0.9480318, 'binary_precision': 0.6101695, 'binary_recall': 0.053491827, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.09836065}
confusion matrix:
       0   1
0  18044  23
1    637  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.94889486, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
early stop counter: 1
val acc:0.9647812247276306, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9574605226516724 / 0.9608443379402161
after epoch: 3,now: 2024-07-26 18:58:25.272543,epoch time: 0:29:28.164074,used: 1:28:35.899521,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9962697, 'precision': 0.99637073, 'recall': 0.9937693, 'specificity': 0.9937693, 'f1': 0.9950613, 'auroc': 0.9996569, 'binary_precision': 0.99657416, 'binary_recall': 0.9886939, 'binary_specificity': 0.99884474, 'binary_f1_score': 0.9926184}
confusion matrix:
       0      1
0  42366     49
1    163  14254
---- Validation: 
scalar performance:
{'acc': 0.96227324, 'precision': 0.7306407, 'recall': 0.76442325, 'specificity': 0.76442325, 'f1': 0.7462277, 'auroc': 0.94602096, 'binary_precision': 0.4780928, 'binary_recall': 0.551263, 'binary_specificity': 0.97758347, 'binary_f1_score': 0.5120773}
confusion matrix:
       0    1
0  17662  405
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9429584, 'precision': 0.5116629, 'recall': 0.50496846, 'specificity': 0.50496846, 'f1': 0.5043256, 'auroc': 0.8770919, 'binary_precision': 0.06481481, 'binary_recall': 0.026923077, 'binary_specificity': 0.9830138, 'binary_f1_score': 0.03804348}
confusion matrix:
      0    1
0  5845  101
1   253    7
early stop counter: 2
val acc:0.9622732400894165, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9574605226516724 / 0.9608443379402161
after epoch: 4,now: 2024-07-26 19:28:01.026137,epoch time: 0:29:35.753594,used: 1:58:11.653115,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9892314, 'precision': 0.9928877, 'recall': 0.97877944, 'specificity': 0.97877944, 'f1': 0.98557806, 'auroc': 0.999503, 'binary_precision': 1.0, 'binary_recall': 0.95755893, 'binary_specificity': 1.0, 'binary_f1_score': 0.9783194}
confusion matrix:
       0      1
0  42412      0
1    612  13808
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.4820428, 'recall': 0.4999723, 'specificity': 0.4999723, 'f1': 0.49084386, 'auroc': 0.9514477, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9999446, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18066  1
1    673  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.9211333, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
early stop counter: 3
val acc:0.9640341401100159, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9574605226516724 / 0.9608443379402161
after epoch: 5,now: 2024-07-26 19:57:12.218082,epoch time: 0:29:11.191945,used: 2:27:22.845060,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99327844, 'precision': 0.99541616, 'recall': 0.9868689, 'specificity': 0.9868689, 'f1': 0.9910488, 'auroc': 0.99968064, 'binary_precision': 0.9996441, 'binary_recall': 0.97385573, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.98658144}
confusion matrix:
       0      1
0  42407      5
1    377  14043
---- Validation: 
scalar performance:
{'acc': 0.9710246, 'precision': 0.89414334, 'recall': 0.6237626, 'specificity': 0.6237626, 'f1': 0.6837084, 'auroc': 0.951624, 'binary_precision': 0.815534, 'binary_recall': 0.24962853, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.38225257}
confusion matrix:
       0    1
0  18029   38
1    505  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.9181697, 'recall': 0.54013234, 'specificity': 0.54013234, 'f1': 0.56396675, 'auroc': 0.9299419, 'binary_precision': 0.875, 'binary_recall': 0.08076923, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.14788732}
confusion matrix:
      0   1
0  5943   3
1   239  21
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-26 20:26:15.142224,epoch time: 0:29:02.924142,used: 2:56:25.769202,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9959002, 'precision': 0.9971973, 'recall': 0.9919896, 'specificity': 0.9919896, 'f1': 0.99455863, 'auroc': 0.9997809, 'binary_precision': 0.99978864, 'binary_recall': 0.9840499, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9918569}
confusion matrix:
       0      1
0  42409      3
1    230  14190
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.8927484, 'recall': 0.5464179, 'specificity': 0.5464179, 'f1': 0.5755056, 'auroc': 0.95318615, 'binary_precision': 0.8181818, 'binary_recall': 0.0936107, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.168}
confusion matrix:
       0   1
0  18053  14
1    610  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.479039, 'recall': 0.49966365, 'specificity': 0.49966365, 'f1': 0.489134, 'auroc': 0.91435903, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5942  4
1   260  0
early stop counter: 1
val acc:0.9667022228240967, best validation acc: 0.9710245728492737, corresponding to test acc:                         0.961005449295044 / 0.961005449295044
after epoch: 7,now: 2024-07-26 20:55:03.219377,epoch time: 0:28:48.077153,used: 3:25:13.846355,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9974486, 'precision': 0.9978083, 'recall': 0.9954529, 'specificity': 0.9954529, 'f1': 0.99662346, 'auroc': 0.99977064, 'binary_precision': 0.9985332, 'binary_recall': 0.99140084, 'binary_specificity': 0.99950486, 'binary_f1_score': 0.9949543}
confusion matrix:
       0      1
0  42391     21
1    124  14296
---- Validation: 
scalar performance:
{'acc': 0.9685165, 'precision': 0.7804267, 'recall': 0.71401614, 'specificity': 0.71401614, 'f1': 0.74229586, 'auroc': 0.9507376, 'binary_precision': 0.5815324, 'binary_recall': 0.4398217, 'binary_specificity': 0.98821056, 'binary_f1_score': 0.500846}
confusion matrix:
       0    1
0  17854  213
1    377  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95568806, 'precision': 0.5793723, 'recall': 0.50793356, 'specificity': 0.50793356, 'f1': 0.5062055, 'auroc': 0.95380056, 'binary_precision': 0.2, 'binary_recall': 0.01923077, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.03508772}
confusion matrix:
      0   1
0  5926  20
1   255   5
early stop counter: 2
val acc:0.9685165286064148, best validation acc: 0.9710245728492737, corresponding to test acc:                         0.961005449295044 / 0.961005449295044
after epoch: 8,now: 2024-07-26 21:23:57.289939,epoch time: 0:28:54.070562,used: 3:54:07.916917,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9983812, 'precision': 0.99868643, 'recall': 0.99703884, 'specificity': 0.99703884, 'f1': 0.9978591, 'auroc': 0.9998076, 'binary_precision': 0.99930304, 'binary_recall': 0.9943135, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.996802}
confusion matrix:
       0      1
0  42402     10
1     82  14338
---- Validation: 
scalar performance:
{'acc': 0.97139806, 'precision': 0.82730424, 'recall': 0.6911915, 'specificity': 0.6911915, 'f1': 0.7398112, 'auroc': 0.9456332, 'binary_precision': 0.6770026, 'binary_recall': 0.38930163, 'binary_specificity': 0.99308133, 'binary_f1_score': 0.49433962}
confusion matrix:
       0    1
0  17942  125
1    411  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.81390333, 'recall': 0.53762066, 'specificity': 0.53762066, 'f1': 0.5586537, 'auroc': 0.94478625, 'binary_precision': 0.6666667, 'binary_recall': 0.07692308, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.13793105}
confusion matrix:
      0   1
0  5936  10
1   240  20
better model found
persisted
after epoch: 9,now: 2024-07-26 21:52:59.328580,epoch time: 0:29:02.038641,used: 4:23:09.955558,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99692076, 'precision': 0.9963527, 'recall': 0.9955109, 'specificity': 0.9955109, 'f1': 0.9959309, 'auroc': 0.9997703, 'binary_precision': 0.99520236, 'binary_recall': 0.9926486, 'binary_specificity': 0.99837315, 'binary_f1_score': 0.9939239}
confusion matrix:
       0      1
0  42344     69
1    106  14313
---- Validation: 
scalar performance:
{'acc': 0.971238, 'precision': 0.8006692, 'recall': 0.7526214, 'specificity': 0.7526214, 'f1': 0.7743459, 'auroc': 0.9491421, 'binary_precision': 0.6192171, 'binary_recall': 0.51708764, 'binary_specificity': 0.9881552, 'binary_f1_score': 0.56356275}
confusion matrix:
       0    1
0  17853  214
1    325  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.77099955, 'recall': 0.5912036, 'specificity': 0.5912036, 'f1': 0.63179445, 'auroc': 0.9314966, 'binary_precision': 0.5764706, 'binary_recall': 0.18846154, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.28405797}
confusion matrix:
      0   1
0  5910  36
1   211  49
early stop counter: 1
val acc:0.9712380170822144, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9597163796424866 / 0.961005449295044
after epoch: 10,now: 2024-07-26 22:21:54.669135,epoch time: 0:28:55.340555,used: 4:52:05.296113,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.997607, 'precision': 0.998402, 'recall': 0.995283, 'specificity': 0.995283, 'f1': 0.99683, 'auroc': 0.99994886, 'binary_precision': 1.0, 'binary_recall': 0.990566, 'binary_specificity': 1.0, 'binary_f1_score': 0.99526066}
confusion matrix:
       0      1
0  42416      0
1    136  14280
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.7381712, 'recall': 0.51647884, 'specificity': 0.51647884, 'f1': 0.52289355, 'auroc': 0.94298625, 'binary_precision': 0.51111114, 'binary_recall': 0.034175333, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.06406685}
confusion matrix:
       0   1
0  18045  22
1    650  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.47901532, 'recall': 0.499075, 'specificity': 0.499075, 'f1': 0.48883948, 'auroc': 0.9428507, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99815, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5935  11
1   260   0
early stop counter: 2
val acc:0.9641408920288086, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9597163796424866 / 0.961005449295044
after epoch: 11,now: 2024-07-26 22:50:53.252388,epoch time: 0:28:58.583253,used: 5:21:03.879366,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9959178, 'precision': 0.9969499, 'recall': 0.9922755, 'specificity': 0.9922755, 'f1': 0.9945846, 'auroc': 0.9994887, 'binary_precision': 0.99901515, 'binary_recall': 0.98488104, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.9918977}
confusion matrix:
       0      1
0  42399     14
1    218  14201
---- Validation: 
scalar performance:
{'acc': 0.96334046, 'precision': 0.68547887, 'recall': 0.52107054, 'specificity': 0.52107054, 'f1': 0.53080934, 'auroc': 0.92516494, 'binary_precision': 0.4054054, 'binary_recall': 0.044576522, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.08032128}
confusion matrix:
       0   1
0  18023  44
1    643  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.47901195, 'recall': 0.49899092, 'specificity': 0.49899092, 'f1': 0.48879734, 'auroc': 0.9317403, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5934  12
1   260   0
early stop counter: 3
val acc:0.9633404612541199, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9597163796424866 / 0.961005449295044
after epoch: 12,now: 2024-07-26 23:19:42.729009,epoch time: 0:28:49.476621,used: 5:49:53.355987,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9975542, 'precision': 0.99811065, 'recall': 0.9954318, 'specificity': 0.9954318, 'f1': 0.996762, 'auroc': 0.9998925, 'binary_precision': 0.99923086, 'binary_recall': 0.99112284, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.99516034}
confusion matrix:
       0      1
0  42402     11
1    128  14291
---- Validation: 
scalar performance:
{'acc': 0.96168625, 'precision': 0.6729402, 'recall': 0.54882336, 'specificity': 0.54882336, 'f1': 0.57178223, 'auroc': 0.954705, 'binary_precision': 0.3783784, 'binary_recall': 0.104011886, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.16317017}
confusion matrix:
       0    1
0  17952  115
1    603   70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9479536, 'precision': 0.4788377, 'recall': 0.4947023, 'specificity': 0.4947023, 'f1': 0.48664075, 'auroc': 0.93678004, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5883  63
1   260   0
early stop counter: 4
val acc:0.9616862535476685, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9597163796424866 / 0.961005449295044
after epoch: 13,now: 2024-07-26 23:48:40.936147,epoch time: 0:28:58.207138,used: 6:18:51.563125,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99729025, 'precision': 0.9980976, 'recall': 0.99475175, 'specificity': 0.99475175, 'f1': 0.99641037, 'auroc': 0.9998374, 'binary_precision': 0.9997198, 'binary_recall': 0.9895978, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.994633}
confusion matrix:
       0      1
0  42408      4
1    150  14270
---- Validation: 
scalar performance:
{'acc': 0.96750265, 'precision': 0.9007634, 'recall': 0.55899256, 'specificity': 0.55899256, 'f1': 0.59573674, 'auroc': 0.9617631, 'binary_precision': 0.8333333, 'binary_recall': 0.11887073, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.20806243}
confusion matrix:
       0   1
0  18051  16
1    593  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.479039, 'recall': 0.49966365, 'specificity': 0.49966365, 'f1': 0.489134, 'auroc': 0.9415936, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5942  4
1   260  0
early stop counter: 5
val acc:0.9675026535987854, best validation acc: 0.9713980555534363, corresponding to test acc:                         0.9597163796424866 / 0.961005449295044
after epoch: 14,now: 2024-07-27 00:17:54.946649,epoch time: 0:29:14.010502,used: 6:48:05.573627,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_29_49_seed_1_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 6:48:05.573627 at 2024-07-27 00:17:54.946649
persisted model performance metric: 

scalar performance:
{'acc': 0.9597164, 'precision': 0.81390333, 'recall': 0.53762066, 'specificity': 0.53762066, 'f1': 0.5586537, 'auroc': 0.94478625, 'binary_precision': 0.6666667, 'binary_recall': 0.07692308, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.13793105}
confusion matrix:
      0   1
0  5936  10
1   240  20
oracle model performance metric: 

scalar performance:
{'acc': 0.96100545, 'precision': 0.9181697, 'recall': 0.54013234, 'specificity': 0.54013234, 'f1': 0.56396675, 'auroc': 0.9299419, 'binary_precision': 0.875, 'binary_recall': 0.08076923, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.14788732}
confusion matrix:
      0   1
0  5943   3
1   239  21
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 452515 KiB |   3644 MiB |    864 TiB |    864 TiB |
|       from large pool | 411422 KiB |   3611 MiB |    858 TiB |    858 TiB |
|       from small pool |  41093 KiB |     57 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 452515 KiB |   3644 MiB |    864 TiB |    864 TiB |
|       from large pool | 411422 KiB |   3611 MiB |    858 TiB |    858 TiB |
|       from small pool |  41093 KiB |     57 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   3642 MiB |    863 TiB |    863 TiB |
|       from large pool | 407075 KiB |   3608 MiB |    858 TiB |    858 TiB |
|       from small pool |  40676 KiB |     56 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3998 MiB |   3998 MiB |   6946 MiB |   2948 MiB |
|       from large pool |   3934 MiB |   3934 MiB |   6864 MiB |   2930 MiB |
|       from small pool |     64 MiB |     64 MiB |     82 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 551004 KiB | 662353 KiB | 474659 GiB | 474659 GiB |
|       from large pool | 544994 KiB | 657915 KiB | 468386 GiB | 468386 GiB |
|       from small pool |   6010 KiB |  19804 KiB |   6272 GiB |   6272 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2300    |    4549    |   88488 K  |   88486 K  |
|       from large pool |     187    |     311    |   43103 K  |   43103 K  |
|       from small pool |    2113    |    4361    |   45385 K  |   45382 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2300    |    4549    |   88488 K  |   88486 K  |
|       from large pool |     187    |     311    |   43103 K  |   43103 K  |
|       from small pool |    2113    |    4361    |   45385 K  |   45382 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     157    |     157    |     248    |      91    |
|       from large pool |     125    |     125    |     207    |      82    |
|       from small pool |      32    |      32    |      41    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      65    |    1835    |   49589 K  |   49589 K  |
|       from large pool |      33    |     126    |   32371 K  |   32371 K  |
|       from small pool |      32    |    1803    |   17218 K  |   17218 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3644 MiB |    864 TiB |    864 TiB |
|       from large pool |  16640 KiB |   3611 MiB |    858 TiB |    858 TiB |
|       from small pool |      0 KiB |     57 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3644 MiB |    864 TiB |    864 TiB |
|       from large pool |  16640 KiB |   3611 MiB |    858 TiB |    858 TiB |
|       from small pool |      0 KiB |     57 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3642 MiB |    863 TiB |    863 TiB |
|       from large pool |  16640 KiB |   3608 MiB |    858 TiB |    858 TiB |
|       from small pool |      0 KiB |     56 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    980 MiB |   3998 MiB |   6946 MiB |   5966 MiB |
|       from large pool |    934 MiB |   3934 MiB |   6864 MiB |   5930 MiB |
|       from small pool |     46 MiB |     64 MiB |     82 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB | 662353 KiB | 474659 GiB | 474659 GiB |
|       from large pool |   3840 KiB | 657915 KiB | 468387 GiB | 468387 GiB |
|       from small pool |      0 KiB |  22981 KiB |   6272 GiB |   6272 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4549    |   88488 K  |   88488 K  |
|       from large pool |       2    |     311    |   43103 K  |   43103 K  |
|       from small pool |       0    |    4361    |   45385 K  |   45385 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4549    |   88488 K  |   88488 K  |
|       from large pool |       2    |     311    |   43103 K  |   43103 K  |
|       from small pool |       0    |    4361    |   45385 K  |   45385 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     157    |     248    |     187    |
|       from large pool |      38    |     125    |     207    |     169    |
|       from small pool |      23    |      32    |      41    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1835    |   49590 K  |   49590 K  |
|       from large pool |       1    |     126    |   32371 K  |   32371 K  |
|       from small pool |       0    |    1803    |   17218 K  |   17218 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   3644 MiB |    864 TiB |    864 TiB |
|       from large pool |  16640 KiB |   3611 MiB |    858 TiB |    858 TiB |
|       from small pool |      0 KiB |     57 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   3644 MiB |    864 TiB |    864 TiB |
|       from large pool |  16640 KiB |   3611 MiB |    858 TiB |    858 TiB |
|       from small pool |      0 KiB |     57 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   3642 MiB |    863 TiB |    863 TiB |
|       from large pool |  16640 KiB |   3608 MiB |    858 TiB |    858 TiB |
|       from small pool |      0 KiB |     56 MiB |      5 TiB |      5 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    980 MiB |   3998 MiB |   6946 MiB |   5966 MiB |
|       from large pool |    934 MiB |   3934 MiB |   6864 MiB |   5930 MiB |
|       from small pool |     46 MiB |     64 MiB |     82 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB | 662353 KiB | 474659 GiB | 474659 GiB |
|       from large pool |   3840 KiB | 657915 KiB | 468387 GiB | 468387 GiB |
|       from small pool |      0 KiB |  22981 KiB |   6272 GiB |   6272 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4549    |   88488 K  |   88488 K  |
|       from large pool |       2    |     311    |   43103 K  |   43103 K  |
|       from small pool |       0    |    4361    |   45385 K  |   45385 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4549    |   88488 K  |   88488 K  |
|       from large pool |       2    |     311    |   43103 K  |   43103 K  |
|       from small pool |       0    |    4361    |   45385 K  |   45385 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     157    |     248    |     187    |
|       from large pool |      38    |     125    |     207    |     169    |
|       from small pool |      23    |      32    |      41    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |    1835    |   49590 K  |   49590 K  |
|       from large pool |       1    |     126    |   32371 K  |   32371 K  |
|       from small pool |       0    |    1803    |   17218 K  |   17218 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_00_26_20_seed_2_23070001

 Experiment start at: 2024-07-27 00:26:20.446047
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9927751, 'precision': 0.99070084, 'recall': 0.99068, 'specificity': 0.99068, 'f1': 0.99069047, 'auroc': 0.9993937, 'binary_precision': 0.9863177, 'binary_recall': 0.9862525, 'binary_specificity': 0.99510753, 'binary_f1_score': 0.9862851}
confusion matrix:
       0      1
0  42103    207
1    208  14922
---- Validation: 
scalar performance:
{'acc': 0.9700634, 'precision': 0.76009125, 'recall': 0.73157555, 'specificity': 0.73157555, 'f1': 0.74492323, 'auroc': 0.932089, 'binary_precision': 0.5374532, 'binary_recall': 0.47674417, 'binary_specificity': 0.9864069, 'binary_f1_score': 0.5052817}
confusion matrix:
       0    1
0  17924  247
1    315  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709889, 'precision': 0.8878751, 'recall': 0.66568786, 'specificity': 0.66568786, 'f1': 0.72869384, 'auroc': 0.9167049, 'binary_precision': 0.8019802, 'binary_recall': 0.33471075, 'binary_specificity': 0.996665, 'binary_f1_score': 0.4723032}
confusion matrix:
      0   1
0  5977  20
1   161  81
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-27 00:56:12.472162,epoch time: 0:29:52.026115,used: 0:29:52.026115,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_27_00_26_20_seed_2_23070001
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
slurmstepd: error: *** JOB 23070001 ON gpusrv52 CANCELLED AT 2024-07-27T01:19:24 ***
