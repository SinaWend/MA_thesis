Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 29 18:11:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981

 Experiment start at: 2024-06-29 18:17:34.793157
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99135697, 'precision': 0.98919094, 'recall': 0.9882135, 'specificity': 0.9882135, 'f1': 0.988701, 'auroc': 0.9992234, 'binary_precision': 0.9847307, 'binary_recall': 0.9817193, 'binary_specificity': 0.99470764, 'binary_f1_score': 0.9832227}
confusion matrix:
       0      1
0  42101    224
1    269  14446
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9526394, 'precision': 0.67209345, 'recall': 0.7362131, 'specificity': 0.7362131, 'f1': 0.6983178, 'auroc': 0.93220735, 'binary_precision': 0.36201116, 'binary_recall': 0.503888, 'binary_specificity': 0.9685382, 'binary_f1_score': 0.42132637}
confusion matrix:
       0    1
0  17578  571
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9127517, 'precision': 0.61791945, 'recall': 0.7492559, 'specificity': 0.7492559, 'f1': 0.6531509, 'auroc': 0.8766626, 'binary_precision': 0.2555746, 'binary_recall': 0.57088125, 'binary_specificity': 0.9276305, 'binary_f1_score': 0.35308057}
confusion matrix:
      0    1
0  5563  434
1   112  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-29 18:41:10.374522,epoch time: 0:23:35.581365,used: 0:23:35.581365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9931627, 'precision': 0.9949687, 'recall': 0.9871924, 'specificity': 0.9871924, 'f1': 0.99100065, 'auroc': 0.9993797, 'binary_precision': 0.9986078, 'binary_recall': 0.9748573, 'binary_specificity': 0.99952745, 'binary_f1_score': 0.9865896}
confusion matrix:
       0      1
0  42304     20
1    370  14346
---- Validation: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.785233, 'recall': 0.70480156, 'specificity': 0.70480156, 'f1': 0.73778, 'auroc': 0.9338517, 'binary_precision': 0.59080964, 'binary_recall': 0.41990668, 'binary_specificity': 0.9896964, 'binary_f1_score': 0.4909091}
confusion matrix:
       0    1
0  17962  187
1    373  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501438, 'precision': 0.62621516, 'recall': 0.55987954, 'specificity': 0.55987954, 'f1': 0.5787666, 'auroc': 0.8833989, 'binary_precision': 0.2892562, 'binary_recall': 0.13409962, 'binary_specificity': 0.9856595, 'binary_f1_score': 0.18324608}
confusion matrix:
      0   1
0  5911  86
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-29 19:04:03.684769,epoch time: 0:22:53.310247,used: 0:46:28.891612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9942321, 'precision': 0.994815, 'recall': 0.9901078, 'specificity': 0.9901078, 'f1': 0.99243194, 'auroc': 0.9995372, 'binary_precision': 0.9960011, 'binary_recall': 0.9815859, 'binary_specificity': 0.99862957, 'binary_f1_score': 0.988741}
confusion matrix:
       0      1
0  42265     58
1    271  14446
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.754634, 'recall': 0.7003412, 'specificity': 0.7003412, 'f1': 0.72390306, 'auroc': 0.94260526, 'binary_precision': 0.52988046, 'binary_recall': 0.41368586, 'binary_specificity': 0.98699653, 'binary_f1_score': 0.46462882}
confusion matrix:
       0    1
0  17913  236
1    377  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.79466015, 'recall': 0.57462734, 'specificity': 0.57462734, 'f1': 0.6130285, 'auroc': 0.9125867, 'binary_precision': 0.625, 'binary_recall': 0.1532567, 'binary_specificity': 0.995998, 'binary_f1_score': 0.24615385}
confusion matrix:
      0   1
0  5973  24
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_3.png
new oracle model saved
early stop counter: 1
val acc:0.9673797488212585, best validation acc: 0.9702000617980957, corresponding to test acc:                         0.9501438140869141 / 0.9608501195907593
after epoch: 3,now: 2024-06-29 19:27:08.612363,epoch time: 0:23:04.927594,used: 1:09:33.819206,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9940568, 'precision': 0.9958645, 'recall': 0.9886378, 'specificity': 0.9886378, 'f1': 0.99218225, 'auroc': 0.9994889, 'binary_precision': 0.9995136, 'binary_recall': 0.9774411, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.98835415}
confusion matrix:
       0      1
0  42316      7
1    332  14385
---- Validation: 
scalar performance:
{'acc': 0.97035974, 'precision': 0.8430145, 'recall': 0.61037725, 'specificity': 0.61037725, 'f1': 0.6628337, 'auroc': 0.93674564, 'binary_precision': 0.7128713, 'binary_recall': 0.22395024, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.34082842}
confusion matrix:
       0    1
0  18091   58
1    499  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.53807366, 'recall': 0.5025808, 'specificity': 0.5025808, 'f1': 0.4959996, 'auroc': 0.89620596, 'binary_precision': 0.11764706, 'binary_recall': 0.007662835, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.014388489}
confusion matrix:
      0   1
0  5982  15
1   259   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_4.png
better model found
persisted
after epoch: 4,now: 2024-06-29 19:51:13.167640,epoch time: 0:24:04.555277,used: 1:33:38.374483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99379385, 'precision': 0.9937329, 'recall': 0.9900352, 'specificity': 0.9900352, 'f1': 0.9918658, 'auroc': 0.99946326, 'binary_precision': 0.9936087, 'binary_recall': 0.9822678, 'binary_specificity': 0.9978025, 'binary_f1_score': 0.9879057}
confusion matrix:
       0      1
0  42228     93
1    261  14458
---- Validation: 
scalar performance:
{'acc': 0.9657833, 'precision': 0.7396506, 'recall': 0.6987646, 'specificity': 0.6987646, 'f1': 0.71708673, 'auroc': 0.95644635, 'binary_precision': 0.5, 'binary_recall': 0.41213062, 'binary_specificity': 0.98539865, 'binary_f1_score': 0.45183292}
confusion matrix:
       0    1
0  17884  265
1    378  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7523175, 'recall': 0.5110774, 'specificity': 0.5110774, 'f1': 0.5114414, 'auroc': 0.9508947, 'binary_precision': 0.54545456, 'binary_recall': 0.022988506, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.04411765}
confusion matrix:
      0  1
0  5992  5
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_5.png
early stop counter: 1
val acc:0.9657832980155945, best validation acc: 0.970359742641449, corresponding to test acc:                         0.956216037273407 / 0.9608501195907593
after epoch: 5,now: 2024-06-29 20:14:06.437827,epoch time: 0:22:53.270187,used: 1:56:31.644670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99475807, 'precision': 0.99485564, 'recall': 0.99143624, 'specificity': 0.99143624, 'f1': 0.99313045, 'auroc': 0.99964654, 'binary_precision': 0.99505496, 'binary_recall': 0.98457354, 'binary_specificity': 0.9982989, 'binary_f1_score': 0.9897865}
confusion matrix:
       0      1
0  42253     72
1    227  14488
---- Validation: 
scalar performance:
{'acc': 0.9710515, 'precision': 0.7981127, 'recall': 0.6984919, 'specificity': 0.6984919, 'f1': 0.7373922, 'auroc': 0.9572059, 'binary_precision': 0.61702126, 'binary_recall': 0.4059098, 'binary_specificity': 0.9910739, 'binary_f1_score': 0.48968107}
confusion matrix:
       0    1
0  17987  162
1    382  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.92146814, 'recall': 0.52856886, 'specificity': 0.52856886, 'f1': 0.5438245, 'auroc': 0.9201742, 'binary_precision': 0.88235295, 'binary_recall': 0.057471264, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10791367}
confusion matrix:
      0   1
0  5995   2
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_6.png
better model found
persisted
after epoch: 6,now: 2024-06-29 20:37:01.451073,epoch time: 0:22:55.013246,used: 2:19:26.657916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99551195, 'precision': 0.99552286, 'recall': 0.992743, 'specificity': 0.992743, 'f1': 0.9941226, 'auroc': 0.99964374, 'binary_precision': 0.9955452, 'binary_recall': 0.9870218, 'binary_specificity': 0.99846417, 'binary_f1_score': 0.9912652}
confusion matrix:
       0      1
0  42258     65
1    191  14526
---- Validation: 
scalar performance:
{'acc': 0.97035974, 'precision': 0.79863673, 'recall': 0.66888154, 'specificity': 0.66888154, 'f1': 0.7141654, 'auroc': 0.95600486, 'binary_precision': 0.6201117, 'binary_recall': 0.3452566, 'binary_specificity': 0.99250644, 'binary_f1_score': 0.44355646}
confusion matrix:
       0    1
0  18013  136
1    421  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.7195317, 'recall': 0.60752404, 'specificity': 0.60752404, 'f1': 0.6418027, 'auroc': 0.9036595, 'binary_precision': 0.472, 'binary_recall': 0.22605364, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.30569947}
confusion matrix:
      0   1
0  5931  66
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_7.png
early stop counter: 1
val acc:0.970359742641449, best validation acc: 0.9710515141487122, corresponding to test acc:                         0.9603707194328308 / 0.9608501195907593
after epoch: 7,now: 2024-06-29 20:59:58.348416,epoch time: 0:22:56.897343,used: 2:42:23.555259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99274194, 'precision': 0.99186295, 'recall': 0.9891473, 'specificity': 0.9891473, 'f1': 0.9904952, 'auroc': 0.9991704, 'binary_precision': 0.9900631, 'binary_recall': 0.98172057, 'binary_specificity': 0.99657404, 'binary_f1_score': 0.9858741}
confusion matrix:
       0      1
0  42179    145
1    269  14447
---- Validation: 
scalar performance:
{'acc': 0.9725415, 'precision': 0.81471515, 'recall': 0.71051407, 'specificity': 0.71051407, 'f1': 0.75136155, 'auroc': 0.9339206, 'binary_precision': 0.64941174, 'binary_recall': 0.42923796, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.5168539}
confusion matrix:
       0    1
0  18000  149
1    367  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.8926514, 'recall': 0.63468134, 'specificity': 0.63468134, 'f1': 0.6955582, 'auroc': 0.9267666, 'binary_precision': 0.81609195, 'binary_recall': 0.27203065, 'binary_specificity': 0.997332, 'binary_f1_score': 0.40804598}
confusion matrix:
      0   1
0  5981  16
1   190  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-29 21:23:02.391718,epoch time: 0:23:04.043302,used: 3:05:27.598561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9947931, 'precision': 0.9964928, 'recall': 0.9899304, 'specificity': 0.9899304, 'f1': 0.9931549, 'auroc': 0.99980974, 'binary_precision': 0.9999307, 'binary_recall': 0.97988445, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.98980606}
confusion matrix:
       0      1
0  42324      1
1    296  14419
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.9186769, 'recall': 0.5409927, 'specificity': 0.5409927, 'f1': 0.5671767, 'auroc': 0.96032035, 'binary_precision': 0.86885244, 'binary_recall': 0.08242613, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.15056819}
confusion matrix:
       0   1
0  18141   8
1    590  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.5792734, 'recall': 0.5031644, 'specificity': 0.5031644, 'f1': 0.4964777, 'auroc': 0.95462495, 'binary_precision': 0.2, 'binary_recall': 0.007662835, 'binary_specificity': 0.998666, 'binary_f1_score': 0.014760148}
confusion matrix:
      0  1
0  5989  8
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_9.png
early stop counter: 1
val acc:0.9681779742240906, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 9,now: 2024-06-29 21:46:01.223330,epoch time: 0:22:58.831612,used: 3:28:26.430173,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99626577, 'precision': 0.995769, 'recall': 0.9944699, 'specificity': 0.9944699, 'f1': 0.9951172, 'auroc': 0.99975467, 'binary_precision': 0.9947469, 'binary_recall': 0.990759, 'binary_specificity': 0.9981807, 'binary_f1_score': 0.9927489}
confusion matrix:
       0      1
0  42246     77
1    136  14581
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.7431926, 'recall': 0.8732245, 'specificity': 0.8732245, 'f1': 0.7927182, 'auroc': 0.96616083, 'binary_precision': 0.49453822, 'binary_recall': 0.7744945, 'binary_specificity': 0.9719544, 'binary_f1_score': 0.6036364}
confusion matrix:
       0    1
0  17640  509
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9483861, 'precision': 0.68096864, 'recall': 0.69089043, 'specificity': 0.69089043, 'f1': 0.68577325, 'auroc': 0.9248068, 'binary_precision': 0.38768116, 'binary_recall': 0.4099617, 'binary_specificity': 0.9718192, 'binary_f1_score': 0.39851028}
confusion matrix:
      0    1
0  5828  169
1   154  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_10.png
early stop counter: 2
val acc:0.9651979804039001, best validation acc: 0.9725415110588074, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 10,now: 2024-06-29 22:09:11.064156,epoch time: 0:23:09.840826,used: 3:51:36.270999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.996967, 'precision': 0.9978285, 'recall': 0.99425465, 'specificity': 0.99425465, 'f1': 0.9960247, 'auroc': 0.9998615, 'binary_precision': 0.9995877, 'binary_recall': 0.98865104, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.9940893}
confusion matrix:
       0      1
0  42319      6
1    167  14548
---- Validation: 
scalar performance:
{'acc': 0.974404, 'precision': 0.9186859, 'recall': 0.6492237, 'specificity': 0.6492237, 'f1': 0.7160566, 'auroc': 0.9574481, 'binary_precision': 0.86160713, 'binary_recall': 0.30015552, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.44521338}
confusion matrix:
       0    1
0  18118   31
1    450  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.9177147, 'recall': 0.5266532, 'specificity': 0.5266532, 'f1': 0.5403691, 'auroc': 0.95708454, 'binary_precision': 0.875, 'binary_recall': 0.053639848, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10108303}
confusion matrix:
      0   1
0  5995   2
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_11.png
better model found
persisted
after epoch: 11,now: 2024-06-29 22:32:28.973929,epoch time: 0:23:17.909773,used: 4:14:54.180772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9967742, 'precision': 0.9977902, 'recall': 0.993793, 'specificity': 0.993793, 'f1': 0.9957706, 'auroc': 0.9998369, 'binary_precision': 0.99986243, 'binary_recall': 0.98763335, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9937103}
confusion matrix:
       0      1
0  42321      2
1    182  14535
---- Validation: 
scalar performance:
{'acc': 0.9728076, 'precision': 0.84309137, 'recall': 0.671649, 'specificity': 0.671649, 'f1': 0.7266005, 'auroc': 0.9577214, 'binary_precision': 0.70886075, 'binary_recall': 0.34836704, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.46715328}
confusion matrix:
       0    1
0  18057   92
1    419  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.9416025, 'recall': 0.5229051, 'specificity': 0.5229051, 'f1': 0.5335849, 'auroc': 0.96109426, 'binary_precision': 0.9230769, 'binary_recall': 0.04597701, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.08759124}
confusion matrix:
      0   1
0  5996   1
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_12.png
early stop counter: 1
val acc:0.9728075861930847, best validation acc: 0.974403977394104, corresponding to test acc:                         0.960210919380188 / 0.967082142829895
after epoch: 12,now: 2024-06-29 22:55:44.577639,epoch time: 0:23:15.603710,used: 4:38:09.784482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9973878, 'precision': 0.9973935, 'recall': 0.99578017, 'specificity': 0.99578017, 'f1': 0.9965834, 'auroc': 0.9998765, 'binary_precision': 0.99740523, 'binary_recall': 0.9924582, 'binary_specificity': 0.9991021, 'binary_f1_score': 0.9949256}
confusion matrix:
       0      1
0  42284     38
1    111  14607
---- Validation: 
scalar performance:
{'acc': 0.9709983, 'precision': 0.86825705, 'recall': 0.60920775, 'specificity': 0.60920775, 'f1': 0.6638768, 'auroc': 0.9576547, 'binary_precision': 0.76344085, 'binary_recall': 0.22083981, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.34258142}
confusion matrix:
       0    1
0  18105   44
1    501  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8961932, 'recall': 0.50949514, 'specificity': 0.50949514, 'f1': 0.50823593, 'auroc': 0.93133104, 'binary_precision': 0.8333333, 'binary_recall': 0.019157087, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.037453182}
confusion matrix:
      0  1
0  5996  1
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_13.png
early stop counter: 2
val acc:0.9709982872009277, best validation acc: 0.974403977394104, corresponding to test acc:                         0.960210919380188 / 0.967082142829895
after epoch: 13,now: 2024-06-29 23:19:00.950415,epoch time: 0:23:16.372776,used: 5:01:26.157258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99537164, 'precision': 0.9928241, 'recall': 0.9951304, 'specificity': 0.9951304, 'f1': 0.99397004, 'auroc': 0.99976563, 'binary_precision': 0.9875194, 'binary_recall': 0.99463207, 'binary_specificity': 0.99562883, 'binary_f1_score': 0.99106294}
confusion matrix:
       0      1
0  42138    185
1     79  14638
---- Validation: 
scalar performance:
{'acc': 0.9680183, 'precision': 0.75688934, 'recall': 0.8641838, 'specificity': 0.8641838, 'f1': 0.800133, 'auroc': 0.96882415, 'binary_precision': 0.5226782, 'binary_recall': 0.7527216, 'binary_specificity': 0.975646, 'binary_f1_score': 0.6169535}
confusion matrix:
       0    1
0  17707  442
1    159  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9435922, 'precision': 0.665215, 'recall': 0.69938326, 'specificity': 0.69938326, 'f1': 0.6803781, 'auroc': 0.9205209, 'binary_precision': 0.3553459, 'binary_recall': 0.4329502, 'binary_specificity': 0.96581626, 'binary_f1_score': 0.39032817}
confusion matrix:
      0    1
0  5792  205
1   148  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_14.png
early stop counter: 3
val acc:0.9680182933807373, best validation acc: 0.974403977394104, corresponding to test acc:                         0.960210919380188 / 0.967082142829895
after epoch: 14,now: 2024-06-29 23:42:20.497256,epoch time: 0:23:19.546841,used: 5:24:45.704099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9971424, 'precision': 0.99772024, 'recall': 0.9948174, 'specificity': 0.9948174, 'f1': 0.99625766, 'auroc': 0.9998146, 'binary_precision': 0.9989032, 'binary_recall': 0.9900129, 'binary_specificity': 0.9996219, 'binary_f1_score': 0.9944382}
confusion matrix:
       0      1
0  42305     16
1    147  14572
---- Validation: 
scalar performance:
{'acc': 0.97631973, 'precision': 0.86264783, 'recall': 0.7319715, 'specificity': 0.7319715, 'f1': 0.7818032, 'auroc': 0.9697839, 'binary_precision': 0.74384236, 'binary_recall': 0.4696734, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.5757865}
confusion matrix:
       0    1
0  18045  104
1    341  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8086343, 'recall': 0.5636333, 'specificity': 0.5636333, 'f1': 0.5985877, 'auroc': 0.9566997, 'binary_precision': 0.65384614, 'binary_recall': 0.1302682, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.21725239}
confusion matrix:
      0   1
0  5979  18
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_15.png
better model found
persisted
after epoch: 15,now: 2024-06-30 00:05:29.898156,epoch time: 0:23:09.400900,used: 5:47:55.104999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9966164, 'precision': 0.9947292, 'recall': 0.9964567, 'specificity': 0.9964567, 'f1': 0.99558896, 'auroc': 0.99983156, 'binary_precision': 0.9908077, 'binary_recall': 0.99612665, 'binary_specificity': 0.9967867, 'binary_f1_score': 0.99346}
confusion matrix:
       0      1
0  42188    136
1     57  14659
---- Validation: 
scalar performance:
{'acc': 0.9638144, 'precision': 0.7373214, 'recall': 0.87850857, 'specificity': 0.87850857, 'f1': 0.78958154, 'auroc': 0.96835256, 'binary_precision': 0.48236415, 'binary_recall': 0.7869362, 'binary_specificity': 0.970081, 'binary_f1_score': 0.59810877}
confusion matrix:
       0    1
0  17606  543
1    137  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7472871, 'recall': 0.676571, 'specificity': 0.676571, 'f1': 0.7052507, 'auroc': 0.9513007, 'binary_precision': 0.5217391, 'binary_recall': 0.3678161, 'binary_specificity': 0.985326, 'binary_f1_score': 0.43146065}
confusion matrix:
      0   1
0  5909  88
1   165  96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_16.png
early stop counter: 1
val acc:0.963814377784729, best validation acc: 0.9763197302818298, corresponding to test acc:                         0.9608501195907593 / 0.967082142829895
after epoch: 16,now: 2024-06-30 00:28:19.336941,epoch time: 0:22:49.438785,used: 6:10:44.543784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9976332, 'precision': 0.9980277, 'recall': 0.9957899, 'specificity': 0.9957899, 'f1': 0.9969022, 'auroc': 0.999827, 'binary_precision': 0.9988368, 'binary_recall': 0.9919815, 'binary_specificity': 0.9995983, 'binary_f1_score': 0.9953973}
confusion matrix:
       0      1
0  42307     17
1    118  14598
---- Validation: 
scalar performance:
{'acc': 0.9782354, 'precision': 0.89802897, 'recall': 0.7337134, 'specificity': 0.7337134, 'f1': 0.79293, 'auroc': 0.969974, 'binary_precision': 0.8145161, 'binary_recall': 0.47122863, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.5970443}
confusion matrix:
       0    1
0  18080   69
1    340  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.9243773, 'recall': 0.5590535, 'specificity': 0.5590535, 'f1': 0.5951553, 'auroc': 0.9503379, 'binary_precision': 0.8857143, 'binary_recall': 0.118773945, 'binary_specificity': 0.999333, 'binary_f1_score': 0.20945947}
confusion matrix:
      0   1
0  5993   4
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_17.png
better model found
persisted
after epoch: 17,now: 2024-06-30 00:51:25.652845,epoch time: 0:23:06.315904,used: 6:33:50.859688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9965989, 'precision': 0.9976504, 'recall': 0.9934746, 'specificity': 0.9934746, 'f1': 0.9955394, 'auroc': 0.9998083, 'binary_precision': 0.99979347, 'binary_recall': 0.9870201, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9933657}
confusion matrix:
       0      1
0  42322      3
1    191  14524
---- Validation: 
scalar performance:
{'acc': 0.97094506, 'precision': 0.95802546, 'recall': 0.57992804, 'specificity': 0.57992804, 'f1': 0.62955606, 'auroc': 0.965913, 'binary_precision': 0.94495416, 'binary_recall': 0.16018662, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.27393615}
confusion matrix:
       0    1
0  18143    6
1    540  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.938913, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_18.png
early stop counter: 1
val acc:0.9709450602531433, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9626078605651855 / 0.967082142829895
after epoch: 18,now: 2024-06-30 01:14:24.990106,epoch time: 0:22:59.337261,used: 6:56:50.196949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.996669, 'precision': 0.99762905, 'recall': 0.99367744, 'specificity': 0.99367744, 'f1': 0.99563265, 'auroc': 0.9997932, 'binary_precision': 0.9995873, 'binary_recall': 0.9874966, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.9935052}
confusion matrix:
       0      1
0  42318      6
1    184  14532
---- Validation: 
scalar performance:
{'acc': 0.97616005, 'precision': 0.92418957, 'recall': 0.6771349, 'specificity': 0.6771349, 'f1': 0.7466522, 'auroc': 0.96627355, 'binary_precision': 0.8707224, 'binary_recall': 0.3561431, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.5055188}
confusion matrix:
       0    1
0  18115   34
1    414  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.5701791, 'recall': 0.5030811, 'specificity': 0.5030811, 'f1': 0.49640882, 'auroc': 0.95748657, 'binary_precision': 0.18181819, 'binary_recall': 0.007662835, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.0147058815}
confusion matrix:
      0  1
0  5988  9
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_19.png
early stop counter: 2
val acc:0.9761600494384766, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9626078605651855 / 0.967082142829895
after epoch: 19,now: 2024-06-30 01:37:25.647834,epoch time: 0:23:00.657728,used: 7:19:50.854677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99673915, 'precision': 0.99713445, 'recall': 0.9943456, 'specificity': 0.9943456, 'f1': 0.99572974, 'auroc': 0.9998255, 'binary_precision': 0.99794394, 'binary_recall': 0.9894, 'binary_specificity': 0.9992912, 'binary_f1_score': 0.9936536}
confusion matrix:
       0      1
0  42293     30
1    156  14561
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.7844231, 'recall': 0.6289971, 'specificity': 0.6289971, 'f1': 0.6749581, 'auroc': 0.9453595, 'binary_precision': 0.5944056, 'binary_recall': 0.2643857, 'binary_specificity': 0.9936085, 'binary_f1_score': 0.36598495}
confusion matrix:
       0    1
0  18033  116
1    473  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.833902, 'recall': 0.54514325, 'specificity': 0.54514325, 'f1': 0.5712503, 'auroc': 0.9503157, 'binary_precision': 0.7058824, 'binary_recall': 0.09195402, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.16271184}
confusion matrix:
      0   1
0  5987  10
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_20.png
early stop counter: 3
val acc:0.9686568975448608, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9626078605651855 / 0.967082142829895
after epoch: 20,now: 2024-06-30 02:00:22.018411,epoch time: 0:22:56.370577,used: 7:42:47.225254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9970547, 'precision': 0.99788713, 'recall': 0.994426, 'specificity': 0.994426, 'f1': 0.9961407, 'auroc': 0.99983186, 'binary_precision': 0.999588, 'binary_recall': 0.9889938, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99426264}
confusion matrix:
       0      1
0  42315      6
1    162  14557
---- Validation: 
scalar performance:
{'acc': 0.97200936, 'precision': 0.8884354, 'recall': 0.61948186, 'specificity': 0.61948186, 'f1': 0.67824984, 'auroc': 0.9667653, 'binary_precision': 0.8031088, 'binary_recall': 0.24105754, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.3708134}
confusion matrix:
       0    1
0  18111   38
1    488  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.6718113, 'recall': 0.50891155, 'specificity': 0.50891155, 'f1': 0.5074656, 'auroc': 0.9394978, 'binary_precision': 0.3846154, 'binary_recall': 0.019157087, 'binary_specificity': 0.998666, 'binary_f1_score': 0.03649635}
confusion matrix:
      0  1
0  5989  8
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_21.png
early stop counter: 4
val acc:0.9720093607902527, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9626078605651855 / 0.967082142829895
after epoch: 21,now: 2024-06-30 02:23:15.481219,epoch time: 0:22:53.462808,used: 8:05:40.688062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99805397, 'precision': 0.99835557, 'recall': 0.99656105, 'specificity': 0.99656105, 'f1': 0.99745405, 'auroc': 0.99989426, 'binary_precision': 0.99897504, 'binary_recall': 0.9934765, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.9962182}
confusion matrix:
       0      1
0  42309     15
1     96  14620
---- Validation: 
scalar performance:
{'acc': 0.95961046, 'precision': 0.7168546, 'recall': 0.84182966, 'specificity': 0.84182966, 'f1': 0.76340306, 'auroc': 0.9617817, 'binary_precision': 0.44401544, 'binary_recall': 0.7153966, 'binary_specificity': 0.96826273, 'binary_f1_score': 0.5479452}
confusion matrix:
       0    1
0  17573  576
1    183  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.7944821, 'recall': 0.8052551, 'specificity': 0.8052551, 'f1': 0.7997593, 'auroc': 0.96250486, 'binary_precision': 0.6051661, 'binary_recall': 0.62835246, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.6165413}
confusion matrix:
      0    1
0  5890  107
1    97  164
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_22.png
new oracle model saved
early stop counter: 5
val acc:0.9596104621887207, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9626078605651855 / 0.9674017429351807
after epoch: 22,now: 2024-06-30 02:46:14.975595,epoch time: 0:22:59.494376,used: 8:28:40.182438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9977034, 'precision': 0.9982095, 'recall': 0.9957934, 'specificity': 0.9957934, 'f1': 0.99699366, 'auroc': 0.99990773, 'binary_precision': 0.999247, 'binary_recall': 0.99184674, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.9955331}
confusion matrix:
       0      1
0  42311     11
1    120  14598
---- Validation: 
scalar performance:
{'acc': 0.9731269, 'precision': 0.81275535, 'recall': 0.73556894, 'specificity': 0.73556894, 'f1': 0.7682306, 'auroc': 0.9656366, 'binary_precision': 0.64375, 'binary_recall': 0.4805599, 'binary_specificity': 0.990578, 'binary_f1_score': 0.5503117}
confusion matrix:
       0    1
0  17978  171
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95557684, 'precision': 0.6978482, 'recall': 0.59386396, 'specificity': 0.59386396, 'f1': 0.62467027, 'auroc': 0.92456305, 'binary_precision': 0.42975205, 'binary_recall': 0.19923371, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.2722513}
confusion matrix:
      0   1
0  5928  69
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_23.png
early stop counter: 6
val acc:0.9731268882751465, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9626078605651855 / 0.9674017429351807
after epoch: 23,now: 2024-06-30 03:09:08.202848,epoch time: 0:22:53.227253,used: 8:51:33.409691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9981066, 'precision': 0.99865985, 'recall': 0.9963975, 'specificity': 0.9963975, 'f1': 0.99752194, 'auroc': 0.99987733, 'binary_precision': 0.9997947, 'binary_recall': 0.99286586, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9963183}
confusion matrix:
       0      1
0  42319      3
1    105  14613
---- Validation: 
scalar performance:
{'acc': 0.97094506, 'precision': 0.7893366, 'recall': 0.7254387, 'specificity': 0.7254387, 'f1': 0.75303537, 'auroc': 0.95290387, 'binary_precision': 0.5975855, 'binary_recall': 0.46189734, 'binary_specificity': 0.9889801, 'binary_f1_score': 0.5210526}
confusion matrix:
       0    1
0  17949  200
1    346  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9483861, 'precision': 0.63825774, 'recall': 0.5882798, 'specificity': 0.5882798, 'f1': 0.60664296, 'auroc': 0.92766607, 'binary_precision': 0.3109756, 'binary_recall': 0.1954023, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.23999998}
confusion matrix:
      0    1
0  5884  113
1   210   51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_24.png
early stop counter: 7
val acc:0.9709450602531433, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9626078605651855 / 0.9674017429351807
after epoch: 24,now: 2024-06-30 03:32:15.692897,epoch time: 0:23:07.490049,used: 9:14:40.899740,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99824685, 'precision': 0.9979747, 'recall': 0.9974444, 'specificity': 0.9974444, 'f1': 0.99770916, 'auroc': 0.9998984, 'binary_precision': 0.9974134, 'binary_recall': 0.9957866, 'binary_specificity': 0.9991022, 'binary_f1_score': 0.9965993}
confusion matrix:
       0      1
0  42287     38
1     62  14653
---- Validation: 
scalar performance:
{'acc': 0.97961897, 'precision': 0.90885913, 'recall': 0.75018084, 'specificity': 0.75018084, 'f1': 0.809019, 'auroc': 0.9723142, 'binary_precision': 0.83505154, 'binary_recall': 0.503888, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.628516}
confusion matrix:
       0    1
0  18085   64
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.7155653, 'recall': 0.5655471, 'specificity': 0.5655471, 'f1': 0.5955875, 'auroc': 0.9454328, 'binary_precision': 0.46753246, 'binary_recall': 0.13793103, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.21301775}
confusion matrix:
      0   1
0  5956  41
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_25.png
better model found
persisted
after epoch: 25,now: 2024-06-30 03:55:12.963443,epoch time: 0:22:57.270546,used: 9:37:38.170286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9963359, 'precision': 0.997543, 'recall': 0.9928999, 'specificity': 0.9928999, 'f1': 0.995193, 'auroc': 0.9998882, 'binary_precision': 1.0, 'binary_recall': 0.98579973, 'binary_specificity': 1.0, 'binary_f1_score': 0.99284905}
confusion matrix:
       0      1
0  42322      0
1    209  14509
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.9701251, 'recall': 0.55204445, 'specificity': 0.55204445, 'f1': 0.5862632, 'auroc': 0.9772513, 'binary_precision': 0.9710145, 'binary_recall': 0.10419907, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.18820225}
confusion matrix:
       0   1
0  18147   2
1    576  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.94995356, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_26.png
early stop counter: 1
val acc:0.9692422151565552, best validation acc: 0.9796189665794373, corresponding to test acc:                         0.9574943780899048 / 0.9674017429351807
after epoch: 26,now: 2024-06-30 04:18:00.605562,epoch time: 0:22:47.642119,used: 10:00:25.812405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9973527, 'precision': 0.9962489, 'recall': 0.99684215, 'specificity': 0.99684215, 'f1': 0.9965451, 'auroc': 0.99988234, 'binary_precision': 0.99396366, 'binary_recall': 0.9957872, 'binary_specificity': 0.99789715, 'binary_f1_score': 0.9948746}
confusion matrix:
       0      1
0  42234     89
1     62  14655
---- Validation: 
scalar performance:
{'acc': 0.96934867, 'precision': 0.7677472, 'recall': 0.77336586, 'specificity': 0.77336586, 'f1': 0.77052414, 'auroc': 0.9519065, 'binary_precision': 0.55098933, 'binary_recall': 0.562986, 'binary_specificity': 0.98374563, 'binary_f1_score': 0.5569231}
confusion matrix:
       0    1
0  17854  295
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.79147553, 'recall': 0.55780286, 'specificity': 0.55780286, 'f1': 0.58947766, 'auroc': 0.91275144, 'binary_precision': 0.62, 'binary_recall': 0.118773945, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.19935691}
confusion matrix:
      0   1
0  5978  19
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_27.png
early stop counter: 2
val acc:0.969348669052124, best validation acc: 0.9796189665794373, corresponding to test acc:                         0.9574943780899048 / 0.9674017429351807
after epoch: 27,now: 2024-06-30 04:41:06.971866,epoch time: 0:23:06.366304,used: 10:23:32.178709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9975631, 'precision': 0.9964149, 'recall': 0.9972278, 'specificity': 0.9972278, 'f1': 0.99682045, 'auroc': 0.9998681, 'binary_precision': 0.9940359, 'binary_recall': 0.9965349, 'binary_specificity': 0.9979207, 'binary_f1_score': 0.99528384}
confusion matrix:
       0      1
0  42234     88
1     51  14667
---- Validation: 
scalar performance:
{'acc': 0.9620051, 'precision': 0.72246903, 'recall': 0.7943158, 'specificity': 0.7943158, 'f1': 0.7527383, 'auroc': 0.9518881, 'binary_precision': 0.45876887, 'binary_recall': 0.61430794, 'binary_specificity': 0.97432363, 'binary_f1_score': 0.52526593}
confusion matrix:
       0    1
0  17683  466
1    248  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9348034, 'precision': 0.6029882, 'recall': 0.61051023, 'specificity': 0.61051023, 'f1': 0.6065793, 'auroc': 0.88225514, 'binary_precision': 0.23843417, 'binary_recall': 0.256705, 'binary_specificity': 0.9643155, 'binary_f1_score': 0.24723247}
confusion matrix:
      0    1
0  5783  214
1   194   67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_28.png
early stop counter: 3
val acc:0.962005078792572, best validation acc: 0.9796189665794373, corresponding to test acc:                         0.9574943780899048 / 0.9674017429351807
after epoch: 28,now: 2024-06-30 05:03:54.830120,epoch time: 0:22:47.858254,used: 10:46:20.036963,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9965638, 'precision': 0.9976497, 'recall': 0.9933845, 'specificity': 0.9933845, 'f1': 0.9954931, 'auroc': 0.99992216, 'binary_precision': 0.9998623, 'binary_recall': 0.98681617, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9932964}
confusion matrix:
       0      1
0  42323      2
1    194  14521
---- Validation: 
scalar performance:
{'acc': 0.97200936, 'precision': 0.90193164, 'recall': 0.61348146, 'specificity': 0.61348146, 'f1': 0.67211455, 'auroc': 0.9656633, 'binary_precision': 0.8305085, 'binary_recall': 0.22861587, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.35853657}
confusion matrix:
       0    1
0  18119   30
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.67986524, 'recall': 0.5179065, 'specificity': 0.5179065, 'f1': 0.5240901, 'auroc': 0.9212023, 'binary_precision': 0.4, 'binary_recall': 0.038314175, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.06993007}
confusion matrix:
      0   1
0  5982  15
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_29.png
early stop counter: 4
val acc:0.9720093607902527, best validation acc: 0.9796189665794373, corresponding to test acc:                         0.9574943780899048 / 0.9674017429351807
after epoch: 29,now: 2024-06-30 05:26:43.018500,epoch time: 0:22:48.188380,used: 11:09:08.225343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9967742, 'precision': 0.9978358, 'recall': 0.9937475, 'specificity': 0.9937475, 'f1': 0.9957696, 'auroc': 0.9999031, 'binary_precision': 1.0, 'binary_recall': 0.9874949, 'binary_specificity': 1.0, 'binary_f1_score': 0.9937081}
confusion matrix:
       0      1
0  42326      0
1    184  14530
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.9347424, 'recall': 0.5557672, 'specificity': 0.5557672, 'f1': 0.59173125, 'auroc': 0.9534504, 'binary_precision': 0.9, 'binary_recall': 0.11197512, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.19917014}
confusion matrix:
       0   1
0  18141   8
1    571  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9521718, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_30.png
early stop counter: 5
val acc:0.9691889882087708, best validation acc: 0.9796189665794373, corresponding to test acc:                         0.9574943780899048 / 0.9674017429351807
after epoch: 30,now: 2024-06-30 05:49:29.934726,epoch time: 0:22:46.916226,used: 11:31:55.141569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_34_seed_0_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:31:55.141569 at 2024-06-30 05:49:29.934726
persisted model performance metric: 

scalar performance:
{'acc': 0.9574944, 'precision': 0.7155653, 'recall': 0.5655471, 'specificity': 0.5655471, 'f1': 0.5955875, 'auroc': 0.9454328, 'binary_precision': 0.46753246, 'binary_recall': 0.13793103, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.21301775}
confusion matrix:
      0   1
0  5956  41
1   225  36
oracle model performance metric: 

scalar performance:
{'acc': 0.96740174, 'precision': 0.7944821, 'recall': 0.8052551, 'specificity': 0.8052551, 'f1': 0.7997593, 'auroc': 0.96250486, 'binary_precision': 0.6051661, 'binary_recall': 0.62835246, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.6165413}
confusion matrix:
      0    1
0  5890  107
1    97  164
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 369815 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool | 337956 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |  31859 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 369815 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool | 337956 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |  31859 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362641 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |  30851 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10022 MiB |  10022 MiB |  10022 MiB |      0 B   |
|       from large pool |   9962 MiB |   9962 MiB |   9962 MiB |      0 B   |
|       from small pool |     60 MiB |     60 MiB |     60 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 357224 KiB |    877 MiB |    880 TiB |    880 TiB |
|       from large pool | 350172 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |   7052 KiB |     11 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3317    |    7964    |  221734 K  |  221730 K  |
|       from large pool |     151    |     986    |  113526 K  |  113526 K  |
|       from small pool |    3166    |    7811    |  108207 K  |  108204 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3317    |    7964    |  221734 K  |  221730 K  |
|       from large pool |     151    |     986    |  113526 K  |  113526 K  |
|       from small pool |    3166    |    7811    |  108207 K  |  108204 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     445    |     445    |     445    |       0    |
|       from large pool |     415    |     415    |     415    |       0    |
|       from small pool |      30    |      30    |      30    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      66    |    3614    |  140569 K  |  140569 K  |
|       from large pool |      32    |     417    |   88579 K  |   88579 K  |
|       from small pool |      34    |    3583    |   51990 K  |   51990 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |      0 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 727040 KiB |  10022 MiB |  10022 MiB |   9312 MiB |
|       from large pool | 688128 KiB |   9962 MiB |   9962 MiB |   9290 MiB |
|       from small pool |  38912 KiB |     60 MiB |     60 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    877 MiB |    880 TiB |    880 TiB |
|       from large pool |  24320 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |      0 KiB |     30 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  221734 K  |  221734 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108207 K  |  108207 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  221734 K  |  221734 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108207 K  |  108207 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |     445    |     445    |     396    |
|       from large pool |      30    |     415    |     415    |     385    |
|       from small pool |      19    |      30    |      30    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3614    |  140570 K  |  140570 K  |
|       from large pool |       3    |     417    |   88579 K  |   88579 K  |
|       from small pool |       0    |    3583    |   51991 K  |   51991 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |      0 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 727040 KiB |  10022 MiB |  10022 MiB |   9312 MiB |
|       from large pool | 688128 KiB |   9962 MiB |   9962 MiB |   9290 MiB |
|       from small pool |  38912 KiB |     60 MiB |     60 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    877 MiB |    880 TiB |    880 TiB |
|       from large pool |  24320 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |      0 KiB |     30 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  221734 K  |  221734 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108207 K  |  108207 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  221734 K  |  221734 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108207 K  |  108207 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |     445    |     445    |     396    |
|       from large pool |      30    |     415    |     415    |     385    |
|       from small pool |      19    |      30    |      30    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3614    |  140570 K  |  140570 K  |
|       from large pool |       3    |     417    |   88579 K  |   88579 K  |
|       from small pool |       0    |    3583    |   51991 K  |   51991 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981

 Experiment start at: 2024-06-30 05:57:28.201594
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9914133, 'precision': 0.99397063, 'recall': 0.9833971, 'specificity': 0.9833971, 'f1': 0.9885403, 'auroc': 0.9991912, 'binary_precision': 0.998997, 'binary_recall': 0.9671244, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.98280233}
confusion matrix:
       0      1
0  42400     14
1    474  13944
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7655976, 'recall': 0.68017286, 'specificity': 0.68017286, 'f1': 0.7138381, 'auroc': 0.9306017, 'binary_precision': 0.55432373, 'binary_recall': 0.37147102, 'binary_specificity': 0.98887473, 'binary_f1_score': 0.44483986}
confusion matrix:
       0    1
0  17866  201
1    423  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550435, 'precision': 0.65268445, 'recall': 0.537021, 'specificity': 0.537021, 'f1': 0.5538831, 'auroc': 0.9011658, 'binary_precision': 0.3442623, 'binary_recall': 0.08076923, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.13084112}
confusion matrix:
      0   1
0  5906  40
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-30 06:20:35.503919,epoch time: 0:23:07.302325,used: 0:23:07.302325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99384147, 'precision': 0.9953339, 'recall': 0.98841333, 'specificity': 0.98841333, 'f1': 0.991812, 'auroc': 0.99954003, 'binary_precision': 0.9983, 'binary_recall': 0.9773925, 'binary_specificity': 0.9994341, 'binary_f1_score': 0.9877356}
confusion matrix:
       0      1
0  42388     24
1    326  14094
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.7636688, 'recall': 0.71962327, 'specificity': 0.71962327, 'f1': 0.73941576, 'auroc': 0.9442774, 'binary_precision': 0.5475763, 'binary_recall': 0.45319465, 'binary_specificity': 0.9860519, 'binary_f1_score': 0.49593496}
confusion matrix:
       0    1
0  17815  252
1    368  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.7083226, 'recall': 0.61283994, 'specificity': 0.61283994, 'f1': 0.6443755, 'auroc': 0.9162254, 'binary_precision': 0.44927537, 'binary_recall': 0.23846154, 'binary_specificity': 0.9872183, 'binary_f1_score': 0.3115578}
confusion matrix:
      0   1
0  5870  76
1   198  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-30 06:43:08.761271,epoch time: 0:22:33.257352,used: 0:45:40.559677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9939647, 'precision': 0.99266636, 'recall': 0.991378, 'specificity': 0.991378, 'f1': 0.99202, 'auroc': 0.9993688, 'binary_precision': 0.9900418, 'binary_recall': 0.9861275, 'binary_specificity': 0.9966285, 'binary_f1_score': 0.98808074}
confusion matrix:
       0      1
0  42272    143
1    200  14217
---- Validation: 
scalar performance:
{'acc': 0.9453575, 'precision': 0.6794485, 'recall': 0.8443434, 'specificity': 0.8443434, 'f1': 0.73134315, 'auroc': 0.9469428, 'binary_precision': 0.3691275, 'binary_recall': 0.7355126, 'binary_specificity': 0.9531743, 'binary_f1_score': 0.49155906}
confusion matrix:
       0    1
0  17221  846
1    178  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.931679, 'precision': 0.6615693, 'recall': 0.8025149, 'specificity': 0.8025149, 'f1': 0.70575154, 'auroc': 0.9102677, 'binary_precision': 0.33858266, 'binary_recall': 0.6615385, 'binary_specificity': 0.9434914, 'binary_f1_score': 0.4479167}
confusion matrix:
      0    1
0  5610  336
1    88  172
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_3.png
early stop counter: 1
val acc:0.9453575015068054, best validation acc: 0.9669156670570374, corresponding to test acc:                         0.9558491706848145 / 0.9558491706848145
after epoch: 3,now: 2024-06-30 07:05:35.919018,epoch time: 0:22:27.157747,used: 1:08:07.717424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9946685, 'precision': 0.9928827, 'recall': 0.9930406, 'specificity': 0.9930406, 'f1': 0.99296165, 'auroc': 0.99961495, 'binary_precision': 0.9892555, 'binary_recall': 0.9897358, 'binary_specificity': 0.99634546, 'binary_f1_score': 0.9894956}
confusion matrix:
       0      1
0  42258    155
1    148  14271
---- Validation: 
scalar performance:
{'acc': 0.9672892, 'precision': 0.76134, 'recall': 0.83926666, 'specificity': 0.83926666, 'f1': 0.7946149, 'auroc': 0.9579699, 'binary_precision': 0.5339367, 'binary_recall': 0.7013373, 'binary_specificity': 0.977196, 'binary_f1_score': 0.60629416}
confusion matrix:
       0    1
0  17655  412
1    201  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.7867423, 'recall': 0.6177062, 'specificity': 0.6177062, 'f1': 0.6631998, 'auroc': 0.9335798, 'binary_precision': 0.6057692, 'binary_recall': 0.2423077, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.34615386}
confusion matrix:
      0   1
0  5905  41
1   197  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-30 07:28:07.991900,epoch time: 0:22:32.072882,used: 1:30:39.790306,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99614656, 'precision': 0.99624205, 'recall': 0.99357355, 'specificity': 0.99357355, 'f1': 0.9948986, 'auroc': 0.9997808, 'binary_precision': 0.99643433, 'binary_recall': 0.9883495, 'binary_specificity': 0.99879754, 'binary_f1_score': 0.99237543}
confusion matrix:
       0      1
0  42361     51
1    168  14252
---- Validation: 
scalar performance:
{'acc': 0.97187835, 'precision': 0.7978362, 'recall': 0.7922932, 'specificity': 0.7922932, 'f1': 0.7950359, 'auroc': 0.9600748, 'binary_precision': 0.6106061, 'binary_recall': 0.59881127, 'binary_specificity': 0.9857752, 'binary_f1_score': 0.60465115}
confusion matrix:
       0    1
0  17810  257
1    270  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.9208931, 'recall': 0.6070196, 'specificity': 0.6070196, 'f1': 0.6640705, 'auroc': 0.9336272, 'binary_precision': 0.875, 'binary_recall': 0.21538462, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.34567901}
confusion matrix:
      0   1
0  5938   8
1   204  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-30 07:50:29.510256,epoch time: 0:22:21.518356,used: 1:53:01.308662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99461573, 'precision': 0.99159706, 'recall': 0.9942412, 'specificity': 0.9942412, 'f1': 0.9929099, 'auroc': 0.99978364, 'binary_precision': 0.98541653, 'binary_recall': 0.9934808, 'binary_specificity': 0.99500155, 'binary_f1_score': 0.9894322}
confusion matrix:
       0      1
0  42201    212
1     94  14325
---- Validation: 
scalar performance:
{'acc': 0.9527748, 'precision': 0.7035795, 'recall': 0.8682177, 'specificity': 0.8682177, 'f1': 0.7583965, 'auroc': 0.94515944, 'binary_precision': 0.41573927, 'binary_recall': 0.7771174, 'binary_specificity': 0.9593181, 'binary_f1_score': 0.54168826}
confusion matrix:
       0    1
0  17332  735
1    150  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9756687, 'precision': 0.8807601, 'recall': 0.7886918, 'specificity': 0.7886918, 'f1': 0.82775164, 'auroc': 0.92963207, 'binary_precision': 0.7794872, 'binary_recall': 0.5846154, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.6681319}
confusion matrix:
      0    1
0  5903   43
1   108  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_6.png
new oracle model saved
early stop counter: 1
val acc:0.9527748227119446, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.9658395051956177 / 0.975668728351593
after epoch: 6,now: 2024-06-30 08:12:54.805210,epoch time: 0:22:25.294954,used: 2:15:26.603616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9950204, 'precision': 0.99472415, 'recall': 0.9921091, 'specificity': 0.9921091, 'f1': 0.9934077, 'auroc': 0.9994477, 'binary_precision': 0.9941275, 'binary_recall': 0.9861988, 'binary_specificity': 0.99801946, 'binary_f1_score': 0.9901473}
confusion matrix:
       0      1
0  42329     84
1    199  14220
---- Validation: 
scalar performance:
{'acc': 0.9583778, 'precision': 0.71507514, 'recall': 0.8010274, 'specificity': 0.8010274, 'f1': 0.74985754, 'auroc': 0.94605577, 'binary_precision': 0.44409615, 'binary_recall': 0.6315007, 'binary_specificity': 0.97055405, 'binary_f1_score': 0.5214724}
confusion matrix:
       0    1
0  17535  532
1    248  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9511763, 'precision': 0.7041344, 'recall': 0.7391304, 'specificity': 0.7391304, 'f1': 0.72001404, 'auroc': 0.9171783, 'binary_precision': 0.42996743, 'binary_recall': 0.50769234, 'binary_specificity': 0.9705685, 'binary_f1_score': 0.4656085}
confusion matrix:
      0    1
0  5771  175
1   128  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_7.png
early stop counter: 2
val acc:0.9583777785301208, best validation acc: 0.9718783497810364, corresponding to test acc:                         0.9658395051956177 / 0.975668728351593
after epoch: 7,now: 2024-06-30 08:35:24.872100,epoch time: 0:22:30.066890,used: 2:37:56.670506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99649847, 'precision': 0.9957713, 'recall': 0.9949759, 'specificity': 0.9949759, 'f1': 0.9953728, 'auroc': 0.99970365, 'binary_precision': 0.9942988, 'binary_recall': 0.9918851, 'binary_specificity': 0.99806666, 'binary_f1_score': 0.9930905}
confusion matrix:
       0      1
0  42332     82
1    117  14301
---- Validation: 
scalar performance:
{'acc': 0.9733191, 'precision': 0.80236673, 'recall': 0.83166486, 'specificity': 0.83166486, 'f1': 0.81626487, 'auroc': 0.96343434, 'binary_precision': 0.61673415, 'binary_recall': 0.679049, 'binary_specificity': 0.9842807, 'binary_f1_score': 0.64639324}
confusion matrix:
       0    1
0  17783  284
1    216  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709958, 'precision': 0.8866549, 'recall': 0.7034988, 'specificity': 0.7034988, 'f1': 0.7640848, 'auroc': 0.92941844, 'binary_precision': 0.79850745, 'binary_recall': 0.41153845, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.5431472}
confusion matrix:
      0    1
0  5919   27
1   153  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_8.png
better model found
persisted
after epoch: 8,now: 2024-06-30 08:57:55.947002,epoch time: 0:22:31.074902,used: 3:00:27.745408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99561864, 'precision': 0.9949244, 'recall': 0.9934938, 'specificity': 0.9934938, 'f1': 0.9942064, 'auroc': 0.9996538, 'binary_precision': 0.9935214, 'binary_recall': 0.9891802, 'binary_specificity': 0.9978073, 'binary_f1_score': 0.99134606}
confusion matrix:
       0      1
0  42321     93
1    156  14262
---- Validation: 
scalar performance:
{'acc': 0.9567236, 'precision': 0.6870651, 'recall': 0.6857267, 'specificity': 0.6857267, 'f1': 0.68639314, 'auroc': 0.92622244, 'binary_precision': 0.39670658, 'binary_recall': 0.39375928, 'binary_specificity': 0.97769415, 'binary_f1_score': 0.39522743}
confusion matrix:
       0    1
0  17664  403
1    408  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.7210177, 'recall': 0.56227326, 'specificity': 0.56227326, 'f1': 0.5918342, 'auroc': 0.9467082, 'binary_precision': 0.47887325, 'binary_recall': 0.13076924, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.20543808}
confusion matrix:
      0   1
0  5909  37
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_9.png
early stop counter: 1
val acc:0.9567235708236694, best validation acc: 0.9733191132545471, corresponding to test acc:                         0.9709957838058472 / 0.975668728351593
after epoch: 9,now: 2024-06-30 09:20:24.102565,epoch time: 0:22:28.155563,used: 3:22:55.900971,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99519634, 'precision': 0.99649394, 'recall': 0.9908315, 'specificity': 0.9908315, 'f1': 0.9936215, 'auroc': 0.99973226, 'binary_precision': 0.99908274, 'binary_recall': 0.9819695, 'binary_specificity': 0.99969345, 'binary_f1_score': 0.9904522}
confusion matrix:
       0      1
0  42399     13
1    260  14160
---- Validation: 
scalar performance:
{'acc': 0.9707577, 'precision': 0.84478605, 'recall': 0.6522349, 'specificity': 0.6522349, 'f1': 0.7082641, 'auroc': 0.96228886, 'binary_precision': 0.71477664, 'binary_recall': 0.30906388, 'binary_specificity': 0.995406, 'binary_f1_score': 0.43153524}
confusion matrix:
       0    1
0  17984   83
1    465  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.855427, 'recall': 0.53411084, 'specificity': 0.53411084, 'f1': 0.553156, 'auroc': 0.94275594, 'binary_precision': 0.75, 'binary_recall': 0.06923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.12676057}
confusion matrix:
      0   1
0  5940   6
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_10.png
early stop counter: 2
val acc:0.9707577228546143, best validation acc: 0.9733191132545471, corresponding to test acc:                         0.9709957838058472 / 0.975668728351593
after epoch: 10,now: 2024-06-30 09:43:13.926068,epoch time: 0:22:49.823503,used: 3:45:45.724474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98529, 'precision': 0.9733978, 'recall': 0.9890917, 'specificity': 0.9890917, 'f1': 0.98089844, 'auroc': 0.9996439, 'binary_precision': 0.9478995, 'binary_recall': 0.9968098, 'binary_specificity': 0.9813736, 'binary_f1_score': 0.9717396}
confusion matrix:
       0      1
0  41623    790
1     46  14373
---- Validation: 
scalar performance:
{'acc': 0.88377804, 'precision': 0.6049647, 'recall': 0.8681976, 'specificity': 0.8681976, 'f1': 0.64049953, 'auroc': 0.93744755, 'binary_precision': 0.21614484, 'binary_recall': 0.8514116, 'binary_specificity': 0.88498366, 'binary_f1_score': 0.34476534}
confusion matrix:
       0     1
0  15989  2078
1    100   573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9049307, 'precision': 0.5718688, 'recall': 0.63408107, 'specificity': 0.63408107, 'f1': 0.5895519, 'auroc': 0.87316895, 'binary_precision': 0.17391305, 'binary_recall': 0.33846155, 'binary_specificity': 0.9297006, 'binary_f1_score': 0.22976503}
confusion matrix:
      0    1
0  5528  418
1   172   88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_11.png
early stop counter: 3
val acc:0.8837780356407166, best validation acc: 0.9733191132545471, corresponding to test acc:                         0.9709957838058472 / 0.975668728351593
after epoch: 11,now: 2024-06-30 10:05:57.382703,epoch time: 0:22:43.456635,used: 4:08:29.181109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99729025, 'precision': 0.9980276, 'recall': 0.99482, 'specificity': 0.99482, 'f1': 0.99641067, 'auroc': 0.999765, 'binary_precision': 0.99950975, 'binary_recall': 0.9898051, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.9946338}
confusion matrix:
       0      1
0  42406      7
1    147  14272
---- Validation: 
scalar performance:
{'acc': 0.9707577, 'precision': 0.92747974, 'recall': 0.6064578, 'specificity': 0.6064578, 'f1': 0.66477144, 'auroc': 0.96103764, 'binary_precision': 0.8834356, 'binary_recall': 0.21396731, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.3444976}
confusion matrix:
       0    1
0  18048   19
1    529  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.60418683, 'recall': 0.5033416, 'specificity': 0.5033416, 'f1': 0.49659312, 'auroc': 0.9201455, 'binary_precision': 0.25, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.014925373}
confusion matrix:
      0  1
0  5940  6
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_12.png
early stop counter: 4
val acc:0.9707577228546143, best validation acc: 0.9733191132545471, corresponding to test acc:                         0.9709957838058472 / 0.975668728351593
after epoch: 12,now: 2024-06-30 10:28:42.272620,epoch time: 0:22:44.889917,used: 4:31:14.071026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9969032, 'precision': 0.9976997, 'recall': 0.99412537, 'specificity': 0.99412537, 'f1': 0.9958961, 'auroc': 0.9998543, 'binary_precision': 0.9992988, 'binary_recall': 0.9884866, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.9938633}
confusion matrix:
       0      1
0  42404     10
1    166  14252
---- Validation: 
scalar performance:
{'acc': 0.97033083, 'precision': 0.8352183, 'recall': 0.65201354, 'specificity': 0.65201354, 'f1': 0.706377, 'auroc': 0.94408745, 'binary_precision': 0.6956522, 'binary_recall': 0.30906388, 'binary_specificity': 0.99496317, 'binary_f1_score': 0.42798355}
confusion matrix:
       0    1
0  17976   91
1    465  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.71641904, 'recall': 0.5310946, 'specificity': 0.5310946, 'f1': 0.54662025, 'auroc': 0.9394957, 'binary_precision': 0.4722222, 'binary_recall': 0.06538462, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.11486486}
confusion matrix:
      0   1
0  5927  19
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_13.png
early stop counter: 5
val acc:0.9703308343887329, best validation acc: 0.9733191132545471, corresponding to test acc:                         0.9709957838058472 / 0.975668728351593
after epoch: 13,now: 2024-06-30 10:51:20.725693,epoch time: 0:22:38.453073,used: 4:53:52.524099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9975542, 'precision': 0.9969631, 'recall': 0.9965761, 'specificity': 0.9965761, 'f1': 0.99676937, 'auroc': 0.9997855, 'binary_precision': 0.9957645, 'binary_recall': 0.99459046, 'binary_specificity': 0.99856174, 'binary_f1_score': 0.9951771}
confusion matrix:
       0      1
0  42352     61
1     78  14341
---- Validation: 
scalar performance:
{'acc': 0.9716649, 'precision': 0.81348735, 'recall': 0.7278085, 'specificity': 0.7278085, 'f1': 0.7632178, 'auroc': 0.9539256, 'binary_precision': 0.64669424, 'binary_recall': 0.46508172, 'binary_specificity': 0.99053526, 'binary_f1_score': 0.5410544}
confusion matrix:
       0    1
0  17896  171
1    360  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535933, 'precision': 0.63608056, 'recall': 0.5399422, 'specificity': 0.5399422, 'f1': 0.5569398, 'auroc': 0.89804053, 'binary_precision': 0.3108108, 'binary_recall': 0.08846154, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.13772455}
confusion matrix:
      0   1
0  5895  51
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_14.png
early stop counter: 6
val acc:0.9716649055480957, best validation acc: 0.9733191132545471, corresponding to test acc:                         0.9709957838058472 / 0.975668728351593
after epoch: 14,now: 2024-06-30 11:13:55.279210,epoch time: 0:22:34.553517,used: 5:16:27.077616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9971671, 'precision': 0.9968606, 'recall': 0.9956528, 'specificity': 0.9956528, 'f1': 0.9962548, 'auroc': 0.9997498, 'binary_precision': 0.99624085, 'binary_recall': 0.99257874, 'binary_specificity': 0.99872684, 'binary_f1_score': 0.9944064}
confusion matrix:
       0      1
0  42360     54
1    107  14311
---- Validation: 
scalar performance:
{'acc': 0.97214514, 'precision': 0.87103915, 'recall': 0.6593919, 'specificity': 0.6593919, 'f1': 0.7198415, 'auroc': 0.9540555, 'binary_precision': 0.7667844, 'binary_recall': 0.32243684, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.4539749}
confusion matrix:
       0    1
0  18001   66
1    456  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.74099416, 'recall': 0.54798186, 'specificity': 0.54798186, 'f1': 0.57321155, 'auroc': 0.9508071, 'binary_precision': 0.52, 'binary_recall': 0.1, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.16774192}
confusion matrix:
      0   1
0  5922  24
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_15.png
early stop counter: 7
val acc:0.972145140171051, best validation acc: 0.9733191132545471, corresponding to test acc:                         0.9709957838058472 / 0.975668728351593
after epoch: 15,now: 2024-06-30 11:36:38.622156,epoch time: 0:22:43.342946,used: 5:39:10.420562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9964281, 'precision': 0.9976182, 'recall': 0.99296117, 'specificity': 0.99296117, 'f1': 0.9952619, 'auroc': 0.9998291, 'binary_precision': 1.0, 'binary_recall': 0.98592234, 'binary_specificity': 1.0, 'binary_f1_score': 0.9929113}
confusion matrix:
       0      1
0  42412      0
1    203  14217
---- Validation: 
scalar performance:
{'acc': 0.9672892, 'precision': 0.9680171, 'recall': 0.54600704, 'specificity': 0.54600704, 'f1': 0.57578313, 'auroc': 0.95644176, 'binary_precision': 0.96875, 'binary_recall': 0.09212481, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.16824967}
confusion matrix:
       0   1
0  18065   2
1    611  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.92788965, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_16.png
early stop counter: 8
val acc:0.9672892093658447, best validation acc: 0.9733191132545471, corresponding to test acc:                         0.9709957838058472 / 0.975668728351593
after epoch: 16,now: 2024-06-30 11:59:10.104700,epoch time: 0:22:31.482544,used: 6:01:41.903106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9960586, 'precision': 0.9973495, 'recall': 0.9922559, 'specificity': 0.9922559, 'f1': 0.99476945, 'auroc': 0.9998078, 'binary_precision': 0.99992955, 'binary_recall': 0.9845354, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9921728}
confusion matrix:
       0      1
0  42411      1
1    223  14197
---- Validation: 
scalar performance:
{'acc': 0.9689968, 'precision': 0.91182363, 'recall': 0.5819407, 'specificity': 0.5819407, 'f1': 0.63031113, 'auroc': 0.94567645, 'binary_precision': 0.85384613, 'binary_recall': 0.16493313, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.27646327}
confusion matrix:
       0    1
0  18048   19
1    562  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.79776216, 'recall': 0.5131252, 'specificity': 0.5131252, 'f1': 0.5152463, 'auroc': 0.8943745, 'binary_precision': 0.6363636, 'binary_recall': 0.026923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.05166052}
confusion matrix:
      0  1
0  5942  4
1   253  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_17.png
early stop counter: 9
val acc:0.9689968228340149, best validation acc: 0.9733191132545471, corresponding to test acc:                         0.9709957838058472 / 0.975668728351593
after epoch: 17,now: 2024-06-30 12:21:45.529785,epoch time: 0:22:35.425085,used: 6:24:17.328191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99700874, 'precision': 0.9977234, 'recall': 0.99437964, 'specificity': 0.99437964, 'f1': 0.99603724, 'auroc': 0.9998331, 'binary_precision': 0.9991593, 'binary_recall': 0.9890422, 'binary_specificity': 0.99971706, 'binary_f1_score': 0.99407506}
confusion matrix:
       0      1
0  42401     12
1    158  14261
---- Validation: 
scalar performance:
{'acc': 0.97395945, 'precision': 0.82845026, 'recall': 0.7611855, 'specificity': 0.7611855, 'f1': 0.790616, 'auroc': 0.9612445, 'binary_precision': 0.67419964, 'binary_recall': 0.5319465, 'binary_specificity': 0.9904245, 'binary_f1_score': 0.5946844}
confusion matrix:
       0    1
0  17894  173
1    315  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.842723, 'recall': 0.5397119, 'specificity': 0.5397119, 'f1': 0.5624771, 'auroc': 0.9360399, 'binary_precision': 0.7241379, 'binary_recall': 0.08076923, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.14532872}
confusion matrix:
      0   1
0  5938   8
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_18.png
better model found
persisted
after epoch: 18,now: 2024-06-30 12:44:18.258530,epoch time: 0:22:32.728745,used: 6:46:50.056936,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99785334, 'precision': 0.99764323, 'recall': 0.99668515, 'specificity': 0.99668515, 'f1': 0.99716306, 'auroc': 0.9998095, 'binary_precision': 0.99721795, 'binary_recall': 0.9943135, 'binary_specificity': 0.9990569, 'binary_f1_score': 0.9957636}
confusion matrix:
       0      1
0  42372     40
1     82  14338
---- Validation: 
scalar performance:
{'acc': 0.9772145, 'precision': 0.8381332, 'recall': 0.827963, 'specificity': 0.827963, 'f1': 0.83296275, 'auroc': 0.96913517, 'binary_precision': 0.6886503, 'binary_recall': 0.66716194, 'binary_specificity': 0.98876405, 'binary_f1_score': 0.6777358}
confusion matrix:
       0    1
0  17864  203
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7798686, 'recall': 0.5634505, 'specificity': 0.5634505, 'f1': 0.596962, 'auroc': 0.9479561, 'binary_precision': 0.5964912, 'binary_recall': 0.13076924, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.21451104}
confusion matrix:
      0   1
0  5923  23
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_19.png
better model found
persisted
after epoch: 19,now: 2024-06-30 13:08:08.203254,epoch time: 0:23:49.944724,used: 7:10:40.001660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9973958, 'precision': 0.998238, 'recall': 0.9948901, 'specificity': 0.9948901, 'f1': 0.99654967, 'auroc': 0.9998952, 'binary_precision': 0.9999299, 'binary_recall': 0.98980373, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99484104}
confusion matrix:
       0      1
0  42414      1
1    147  14270
---- Validation: 
scalar performance:
{'acc': 0.97182494, 'precision': 0.7936177, 'recall': 0.81372356, 'specificity': 0.81372356, 'f1': 0.8033011, 'auroc': 0.96486855, 'binary_precision': 0.60055476, 'binary_recall': 0.6433878, 'binary_specificity': 0.98405933, 'binary_f1_score': 0.6212339}
confusion matrix:
       0    1
0  17779  288
1    240  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95246536, 'precision': 0.66788983, 'recall': 0.5890062, 'specificity': 0.5890062, 'f1': 0.614308, 'auroc': 0.9107493, 'binary_precision': 0.37037036, 'binary_recall': 0.1923077, 'binary_specificity': 0.98570466, 'binary_f1_score': 0.25316456}
confusion matrix:
      0   1
0  5861  85
1   210  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_20.png
early stop counter: 1
val acc:0.9718249440193176, best validation acc: 0.977214515209198, corresponding to test acc:                         0.9598775506019592 / 0.975668728351593
after epoch: 20,now: 2024-06-30 13:31:46.213874,epoch time: 0:23:38.010620,used: 7:34:18.012280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9966392, 'precision': 0.9974303, 'recall': 0.9936972, 'specificity': 0.9936972, 'f1': 0.99554586, 'auroc': 0.99977875, 'binary_precision': 0.99901795, 'binary_recall': 0.98772454, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.9933391}
confusion matrix:
       0      1
0  42399     14
1    177  14242
---- Validation: 
scalar performance:
{'acc': 0.9758271, 'precision': 0.8689754, 'recall': 0.73783505, 'specificity': 0.73783505, 'f1': 0.78805184, 'auroc': 0.96514165, 'binary_precision': 0.7570093, 'binary_recall': 0.48142645, 'binary_specificity': 0.9942436, 'binary_f1_score': 0.5885559}
confusion matrix:
       0    1
0  17963  104
1    349  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.944417, 'recall': 0.5709016, 'specificity': 0.5709016, 'f1': 0.6140038, 'auroc': 0.93913704, 'binary_precision': 0.925, 'binary_recall': 0.1423077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.24666667}
confusion matrix:
      0   1
0  5943   3
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_21.png
early stop counter: 2
val acc:0.9758270978927612, best validation acc: 0.977214515209198, corresponding to test acc:                         0.9598775506019592 / 0.975668728351593
after epoch: 21,now: 2024-06-30 13:55:20.832671,epoch time: 0:23:34.618797,used: 7:57:52.631077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9980293, 'precision': 0.998567, 'recall': 0.99623066, 'specificity': 0.99623066, 'f1': 0.9973918, 'auroc': 0.9998605, 'binary_precision': 0.9996508, 'binary_recall': 0.9925792, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.99610245}
confusion matrix:
       0      1
0  42408      5
1    107  14312
---- Validation: 
scalar performance:
{'acc': 0.9729456, 'precision': 0.85664034, 'recall': 0.68984824, 'specificity': 0.68984824, 'f1': 0.74572915, 'auroc': 0.96157914, 'binary_precision': 0.73579544, 'binary_recall': 0.38484398, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.50536585}
confusion matrix:
       0    1
0  17974   93
1    414  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.8840287, 'recall': 0.56278884, 'specificity': 0.56278884, 'f1': 0.5999327, 'auroc': 0.9628252, 'binary_precision': 0.80487806, 'binary_recall': 0.12692308, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.21926913}
confusion matrix:
      0   1
0  5938   8
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_22.png
early stop counter: 3
val acc:0.9729455709457397, best validation acc: 0.977214515209198, corresponding to test acc:                         0.9598775506019592 / 0.975668728351593
after epoch: 22,now: 2024-06-30 14:18:48.386784,epoch time: 0:23:27.554113,used: 8:21:20.185190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.9939716, 'recall': 0.9939942, 'specificity': 0.9939942, 'f1': 0.99398285, 'auroc': 0.9996745, 'binary_precision': 0.99098474, 'binary_recall': 0.99105346, 'binary_specificity': 0.9969349, 'binary_f1_score': 0.99101907}
confusion matrix:
       0      1
0  42283    130
1    129  14290
---- Validation: 
scalar performance:
{'acc': 0.9513874, 'precision': 0.6939377, 'recall': 0.8310195, 'specificity': 0.8310195, 'f1': 0.7416614, 'auroc': 0.9417833, 'binary_precision': 0.3993232, 'binary_recall': 0.7013373, 'binary_specificity': 0.9607018, 'binary_f1_score': 0.50889486}
confusion matrix:
       0    1
0  17357  710
1    201  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.73469746, 'recall': 0.66910267, 'specificity': 0.66910267, 'f1': 0.69583654, 'auroc': 0.9227119, 'binary_precision': 0.4972973, 'binary_recall': 0.35384616, 'binary_specificity': 0.9843592, 'binary_f1_score': 0.41348314}
confusion matrix:
      0   1
0  5853  93
1   168  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_23.png
early stop counter: 4
val acc:0.9513874053955078, best validation acc: 0.977214515209198, corresponding to test acc:                         0.9598775506019592 / 0.975668728351593
after epoch: 23,now: 2024-06-30 14:41:58.675272,epoch time: 0:23:10.288488,used: 8:44:30.473678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9979589, 'precision': 0.99847364, 'recall': 0.99613774, 'specificity': 0.99613774, 'f1': 0.9972987, 'auroc': 0.99992037, 'binary_precision': 0.99951106, 'binary_recall': 0.9924405, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.9959632}
confusion matrix:
       0      1
0  42406      7
1    109  14310
---- Validation: 
scalar performance:
{'acc': 0.9755603, 'precision': 0.92584777, 'recall': 0.68548214, 'specificity': 0.68548214, 'f1': 0.75518787, 'auroc': 0.9701656, 'binary_precision': 0.87456447, 'binary_recall': 0.3729569, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.5229167}
confusion matrix:
       0    1
0  18031   36
1    422  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.7066916, 'recall': 0.5091108, 'specificity': 0.5091108, 'f1': 0.50770146, 'auroc': 0.9434138, 'binary_precision': 0.45454547, 'binary_recall': 0.01923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.03690037}
confusion matrix:
      0  1
0  5940  6
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_24.png
early stop counter: 5
val acc:0.9755603075027466, best validation acc: 0.977214515209198, corresponding to test acc:                         0.9598775506019592 / 0.975668728351593
after epoch: 24,now: 2024-06-30 15:05:16.694360,epoch time: 0:23:18.019088,used: 9:07:48.492766,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9955835, 'precision': 0.992901, 'recall': 0.9954847, 'specificity': 0.9954847, 'f1': 0.99418414, 'auroc': 0.9998018, 'binary_precision': 0.9874097, 'binary_recall': 0.9952843, 'binary_specificity': 0.99568516, 'binary_f1_score': 0.9913314}
confusion matrix:
       0      1
0  42229    183
1     68  14352
---- Validation: 
scalar performance:
{'acc': 0.9252401, 'precision': 0.6534306, 'recall': 0.90901315, 'specificity': 0.90901315, 'f1': 0.7105968, 'auroc': 0.961909, 'binary_precision': 0.31120333, 'binary_recall': 0.89153045, 'binary_specificity': 0.92649585, 'binary_f1_score': 0.46136105}
confusion matrix:
       0     1
0  16739  1328
1     73   600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.7795251, 'recall': 0.82744575, 'specificity': 0.82744575, 'f1': 0.8013301, 'auroc': 0.96383417, 'binary_precision': 0.57328993, 'binary_recall': 0.6769231, 'binary_specificity': 0.9779684, 'binary_f1_score': 0.62081134}
confusion matrix:
      0    1
0  5815  131
1    84  176
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_25.png
early stop counter: 6
val acc:0.9252400994300842, best validation acc: 0.977214515209198, corresponding to test acc:                         0.9598775506019592 / 0.975668728351593
after epoch: 25,now: 2024-06-30 15:28:33.636302,epoch time: 0:23:16.941942,used: 9:31:05.434708,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99817, 'precision': 0.99794793, 'recall': 0.9972178, 'specificity': 0.9972178, 'f1': 0.99758214, 'auroc': 0.9998151, 'binary_precision': 0.9974979, 'binary_recall': 0.9952843, 'binary_specificity': 0.9991512, 'binary_f1_score': 0.99638987}
confusion matrix:
       0      1
0  42376     36
1     68  14352
---- Validation: 
scalar performance:
{'acc': 0.9765742, 'precision': 0.86179686, 'recall': 0.7639721, 'specificity': 0.7639721, 'f1': 0.80456924, 'auroc': 0.9575712, 'binary_precision': 0.7407407, 'binary_recall': 0.53491825, 'binary_specificity': 0.99302596, 'binary_f1_score': 0.6212252}
confusion matrix:
       0    1
0  17941  126
1    313  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8285857, 'recall': 0.5641233, 'specificity': 0.5641233, 'f1': 0.60007614, 'auroc': 0.956256, 'binary_precision': 0.6938776, 'binary_recall': 0.13076924, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.22006473}
confusion matrix:
      0   1
0  5931  15
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_26.png
early stop counter: 7
val acc:0.976574182510376, best validation acc: 0.977214515209198, corresponding to test acc:                         0.9598775506019592 / 0.975668728351593
after epoch: 26,now: 2024-06-30 15:51:53.627176,epoch time: 0:23:19.990874,used: 9:54:25.425582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9980469, 'precision': 0.9985788, 'recall': 0.99626505, 'specificity': 0.99626505, 'f1': 0.99741507, 'auroc': 0.99989605, 'binary_precision': 0.9996508, 'binary_recall': 0.99264807, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.9961371}
confusion matrix:
       0      1
0  42409      5
1    106  14312
---- Validation: 
scalar performance:
{'acc': 0.97769475, 'precision': 0.923605, 'recall': 0.7223525, 'specificity': 0.7223525, 'f1': 0.7893657, 'auroc': 0.968235, 'binary_precision': 0.86743516, 'binary_recall': 0.4472511, 'binary_specificity': 0.9974539, 'binary_f1_score': 0.5901961}
confusion matrix:
       0    1
0  18021   46
1    372  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.8018429, 'recall': 0.5337745, 'specificity': 0.5337745, 'f1': 0.55210733, 'auroc': 0.9503333, 'binary_precision': 0.64285713, 'binary_recall': 0.06923077, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.125}
confusion matrix:
      0   1
0  5936  10
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_27.png
better model found
persisted
after epoch: 27,now: 2024-06-30 16:15:25.661572,epoch time: 0:23:32.034396,used: 10:17:57.459978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9970967, 'precision': 0.9980155, 'recall': 0.99432415, 'specificity': 0.99432415, 'f1': 0.9961524, 'auroc': 0.99988854, 'binary_precision': 0.99985975, 'binary_recall': 0.98869544, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9942463}
confusion matrix:
       0      1
0  42411      2
1    163  14256
---- Validation: 
scalar performance:
{'acc': 0.9749733, 'precision': 0.9063995, 'recall': 0.6873235, 'specificity': 0.6873235, 'f1': 0.7535554, 'auroc': 0.9728179, 'binary_precision': 0.8355263, 'binary_recall': 0.37741455, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.51995903}
confusion matrix:
       0    1
0  18017   50
1    419  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.62204736, 'recall': 0.5034257, 'specificity': 0.5034257, 'f1': 0.49666312, 'auroc': 0.9545535, 'binary_precision': 0.2857143, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.014981274}
confusion matrix:
      0  1
0  5941  5
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_28.png
early stop counter: 1
val acc:0.9749733209609985, best validation acc: 0.9776947498321533, corresponding to test acc:                         0.9593941569328308 / 0.975668728351593
after epoch: 28,now: 2024-06-30 16:38:59.809084,epoch time: 0:23:34.147512,used: 10:41:31.607490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9979061, 'precision': 0.997428, 'recall': 0.9970406, 'specificity': 0.9970406, 'f1': 0.9972341, 'auroc': 0.9999014, 'binary_precision': 0.9964586, 'binary_recall': 0.99528366, 'binary_specificity': 0.9987976, 'binary_f1_score': 0.99587077}
confusion matrix:
       0      1
0  42363     51
1     68  14350
---- Validation: 
scalar performance:
{'acc': 0.9748132, 'precision': 0.8143158, 'recall': 0.83315504, 'specificity': 0.83315504, 'f1': 0.8234323, 'auroc': 0.9701157, 'binary_precision': 0.64055943, 'binary_recall': 0.6805349, 'binary_specificity': 0.9857752, 'binary_f1_score': 0.6599424}
confusion matrix:
       0    1
0  17810  257
1    215  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7577995, 'recall': 0.6038242, 'specificity': 0.6038242, 'f1': 0.64432275, 'auroc': 0.95079696, 'binary_precision': 0.54901963, 'binary_recall': 0.21538462, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.30939227}
confusion matrix:
      0   1
0  5900  46
1   204  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_29.png
early stop counter: 2
val acc:0.9748132228851318, best validation acc: 0.9776947498321533, corresponding to test acc:                         0.9593941569328308 / 0.975668728351593
after epoch: 29,now: 2024-06-30 17:02:34.923049,epoch time: 0:23:35.113965,used: 11:05:06.721455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9967448, 'precision': 0.99782854, 'recall': 0.9935849, 'specificity': 0.9935849, 'f1': 0.9956836, 'auroc': 0.99978626, 'binary_precision': 1.0, 'binary_recall': 0.9871697, 'binary_specificity': 1.0, 'binary_f1_score': 0.9935434}
confusion matrix:
       0      1
0  42413      0
1    185  14234
---- Validation: 
scalar performance:
{'acc': 0.97310567, 'precision': 0.9470376, 'recall': 0.63700145, 'specificity': 0.63700145, 'f1': 0.7047864, 'auroc': 0.95972395, 'binary_precision': 0.920398, 'binary_recall': 0.27488855, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.42334098}
confusion matrix:
       0    1
0  18051   16
1    488  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.93849564, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_30.png
early stop counter: 3
val acc:0.9731056690216064, best validation acc: 0.9776947498321533, corresponding to test acc:                         0.9593941569328308 / 0.975668728351593
after epoch: 30,now: 2024-06-30 17:26:07.687074,epoch time: 0:23:32.764025,used: 11:28:39.485480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_57_28_seed_1_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:28:39.485480 at 2024-06-30 17:26:07.687074
persisted model performance metric: 

scalar performance:
{'acc': 0.95939416, 'precision': 0.8018429, 'recall': 0.5337745, 'specificity': 0.5337745, 'f1': 0.55210733, 'auroc': 0.9503333, 'binary_precision': 0.64285713, 'binary_recall': 0.06923077, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.125}
confusion matrix:
      0   1
0  5936  10
1   242  18
oracle model performance metric: 

scalar performance:
{'acc': 0.9756687, 'precision': 0.8807601, 'recall': 0.7886918, 'specificity': 0.7886918, 'f1': 0.82775164, 'auroc': 0.92963207, 'binary_precision': 0.7794872, 'binary_recall': 0.5846154, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.6681319}
confusion matrix:
      0    1
0  5903   43
1   108  152
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 368857 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool | 337010 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |  31847 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 368857 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool | 337010 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |  31847 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362638 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |  30848 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10006 MiB |  10022 MiB |  19318 MiB |   9312 MiB |
|       from large pool |   9950 MiB |   9962 MiB |  19240 MiB |   9290 MiB |
|       from small pool |     56 MiB |     60 MiB |     78 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 386854 KiB |    877 MiB |   1755 TiB |   1755 TiB |
|       from large pool | 377742 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |   9112 KiB |     30 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3293    |    7964    |  441872 K  |  441869 K  |
|       from large pool |     151    |     986    |  226164 K  |  226164 K  |
|       from small pool |    3142    |    7811    |  215707 K  |  215704 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3293    |    7964    |  441872 K  |  441869 K  |
|       from large pool |     151    |     986    |  226164 K  |  226164 K  |
|       from small pool |    3142    |    7811    |  215707 K  |  215704 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     443    |     445    |     839    |     396    |
|       from large pool |     415    |     415    |     800    |     385    |
|       from small pool |      28    |      30    |      39    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |    3614    |  286164 K  |  286164 K  |
|       from large pool |      35    |     417    |  181913 K  |  181913 K  |
|       from small pool |      37    |    3583    |  104251 K  |  104251 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |      0 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  19318 MiB |  18580 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  19240 MiB |  18542 MiB |
|       from small pool |  40960 KiB |     60 MiB |     78 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    877 MiB |   1755 TiB |   1755 TiB |
|       from large pool |  24320 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |      0 KiB |     32 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  441872 K  |  441872 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215707 K  |  215707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  441872 K  |  441872 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215707 K  |  215707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |     839    |     788    |
|       from large pool |      31    |     415    |     800    |     769    |
|       from small pool |      20    |      30    |      39    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3614    |  286165 K  |  286165 K  |
|       from large pool |       3    |     417    |  181913 K  |  181913 K  |
|       from small pool |       0    |    3583    |  104252 K  |  104252 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |      0 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  19318 MiB |  18580 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  19240 MiB |  18542 MiB |
|       from small pool |  40960 KiB |     60 MiB |     78 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    877 MiB |   1755 TiB |   1755 TiB |
|       from large pool |  24320 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |      0 KiB |     32 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  441872 K  |  441872 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215707 K  |  215707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  441872 K  |  441872 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215707 K  |  215707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |     839    |     788    |
|       from large pool |      31    |     415    |     800    |     769    |
|       from small pool |      20    |      30    |      39    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3614    |  286165 K  |  286165 K  |
|       from large pool |       3    |     417    |  181913 K  |  181913 K  |
|       from small pool |       0    |    3583    |  104252 K  |  104252 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981

 Experiment start at: 2024-06-30 17:34:22.977458
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99051183, 'precision': 0.9872826, 'recall': 0.98829454, 'specificity': 0.98829454, 'f1': 0.9877871, 'auroc': 0.9988879, 'binary_precision': 0.98043346, 'binary_recall': 0.9836087, 'binary_specificity': 0.99298036, 'binary_f1_score': 0.98201853}
confusion matrix:
       0      1
0  42013    297
1    248  14882
---- Validation: 
scalar performance:
{'acc': 0.9461461, 'precision': 0.66214126, 'recall': 0.8220109, 'specificity': 0.8220109, 'f1': 0.7112633, 'auroc': 0.9290515, 'binary_precision': 0.33494753, 'binary_recall': 0.6893688, 'binary_specificity': 0.954653, 'binary_f1_score': 0.45084193}
confusion matrix:
       0    1
0  17347  824
1    187  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94053537, 'precision': 0.6580287, 'recall': 0.7489836, 'specificity': 0.7489836, 'f1': 0.6912904, 'auroc': 0.8858768, 'binary_precision': 0.33503836, 'binary_recall': 0.5413223, 'binary_specificity': 0.956645, 'binary_f1_score': 0.41390204}
confusion matrix:
      0    1
0  5737  260
1   111  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-30 17:58:17.895850,epoch time: 0:23:54.918392,used: 0:23:54.918392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9942897, 'precision': 0.99395967, 'recall': 0.99130476, 'specificity': 0.99130476, 'f1': 0.99262244, 'auroc': 0.99941754, 'binary_precision': 0.9932685, 'binary_recall': 0.9849967, 'binary_specificity': 0.99761283, 'binary_f1_score': 0.98911524}
confusion matrix:
       0      1
0  42209    101
1    227  14903
---- Validation: 
scalar performance:
{'acc': 0.9573323, 'precision': 0.69987684, 'recall': 0.8518808, 'specificity': 0.8518808, 'f1': 0.75198793, 'auroc': 0.9424206, 'binary_precision': 0.40863177, 'binary_recall': 0.7392027, 'binary_specificity': 0.9645589, 'binary_f1_score': 0.5263158}
confusion matrix:
       0    1
0  17527  644
1    157  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93957365, 'precision': 0.67153925, 'recall': 0.81986207, 'specificity': 0.81986207, 'f1': 0.7188611, 'auroc': 0.8964019, 'binary_precision': 0.35607675, 'binary_recall': 0.69008267, 'binary_specificity': 0.94964147, 'binary_f1_score': 0.46976092}
confusion matrix:
      0    1
0  5695  302
1    75  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_2.png
better model found
persisted
after epoch: 2,now: 2024-06-30 18:21:12.943127,epoch time: 0:22:55.047277,used: 0:46:49.965669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9944638, 'precision': 0.99261975, 'recall': 0.99312127, 'specificity': 0.99312127, 'f1': 0.99287015, 'auroc': 0.99950445, 'binary_precision': 0.9887158, 'binary_recall': 0.9902842, 'binary_specificity': 0.9959584, 'binary_f1_score': 0.98949933}
confusion matrix:
       0      1
0  42139    171
1    147  14983
---- Validation: 
scalar performance:
{'acc': 0.9628722, 'precision': 0.7201447, 'recall': 0.8410907, 'specificity': 0.8410907, 'f1': 0.76591325, 'auroc': 0.94920254, 'binary_precision': 0.4500526, 'binary_recall': 0.7109634, 'binary_specificity': 0.9712179, 'binary_f1_score': 0.5511913}
confusion matrix:
       0    1
0  17648  523
1    174  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93236095, 'precision': 0.6136077, 'recall': 0.66740465, 'specificity': 0.66740465, 'f1': 0.63404226, 'auroc': 0.87343556, 'binary_precision': 0.25274727, 'binary_recall': 0.38016528, 'binary_specificity': 0.95464396, 'binary_f1_score': 0.30363038}
confusion matrix:
      0    1
0  5725  272
1   150   92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_3.png
better model found
persisted
after epoch: 3,now: 2024-06-30 18:45:08.141727,epoch time: 0:23:55.198600,used: 1:10:45.164269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99089485, 'precision': 0.9938494, 'recall': 0.9827578, 'specificity': 0.9827578, 'f1': 0.98813546, 'auroc': 0.99954206, 'binary_precision': 0.9998631, 'binary_recall': 0.9655628, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9824136}
confusion matrix:
       0      1
0  42309      2
1    521  14608
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.7599529, 'recall': 0.64291, 'specificity': 0.64291, 'f1': 0.68289506, 'auroc': 0.94210213, 'binary_precision': 0.5429448, 'binary_recall': 0.29401994, 'binary_specificity': 0.9918001, 'binary_f1_score': 0.3814655}
confusion matrix:
       0    1
0  18022  149
1    425  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584869, 'precision': 0.64124435, 'recall': 0.52832377, 'specificity': 0.52832377, 'f1': 0.5412788, 'auroc': 0.9037878, 'binary_precision': 0.31914893, 'binary_recall': 0.06198347, 'binary_specificity': 0.994664, 'binary_f1_score': 0.10380623}
confusion matrix:
      0   1
0  5965  32
1   227  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-30 19:08:24.931928,epoch time: 0:23:16.790201,used: 1:34:01.954470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.995578, 'precision': 0.9937251, 'recall': 0.99489665, 'specificity': 0.99489665, 'f1': 0.994309, 'auroc': 0.99967796, 'binary_precision': 0.98979324, 'binary_recall': 0.9934567, 'binary_specificity': 0.9963366, 'binary_f1_score': 0.9916216}
confusion matrix:
       0      1
0  42155    155
1     99  15031
---- Validation: 
scalar performance:
{'acc': 0.94998133, 'precision': 0.683071, 'recall': 0.8858268, 'specificity': 0.8858268, 'f1': 0.74267054, 'auroc': 0.9533738, 'binary_precision': 0.3724451, 'binary_recall': 0.81727576, 'binary_specificity': 0.95437783, 'binary_f1_score': 0.5117005}
confusion matrix:
       0    1
0  17342  829
1    110  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.918737, 'precision': 0.5993097, 'recall': 0.68807614, 'specificity': 0.68807614, 'f1': 0.62586904, 'auroc': 0.8816061, 'binary_precision': 0.22222222, 'binary_recall': 0.43801653, 'binary_specificity': 0.93813574, 'binary_f1_score': 0.294854}
confusion matrix:
      0    1
0  5626  371
1   136  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_5.png
early stop counter: 1
val acc:0.9499813318252563, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9584869146347046 / 0.9584869146347046
after epoch: 5,now: 2024-06-30 19:31:11.939782,epoch time: 0:22:47.007854,used: 1:56:48.962324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9954213, 'precision': 0.9948634, 'recall': 0.9933255, 'specificity': 0.9933255, 'f1': 0.99409115, 'auroc': 0.999738, 'binary_precision': 0.99369067, 'binary_recall': 0.98889625, 'binary_specificity': 0.9977547, 'binary_f1_score': 0.99128765}
confusion matrix:
       0      1
0  42215     95
1    168  14962
---- Validation: 
scalar performance:
{'acc': 0.9756033, 'precision': 0.79485095, 'recall': 0.8540914, 'specificity': 0.8540914, 'f1': 0.82149637, 'auroc': 0.9599963, 'binary_precision': 0.5989011, 'binary_recall': 0.72425246, 'binary_specificity': 0.9839304, 'binary_f1_score': 0.6556391}
confusion matrix:
       0    1
0  17879  292
1    166  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.7582303, 'recall': 0.6835794, 'specificity': 0.6835794, 'f1': 0.71385294, 'auroc': 0.9284148, 'binary_precision': 0.5411765, 'binary_recall': 0.38016528, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.44660196}
confusion matrix:
      0   1
0  5919  78
1   150  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-30 19:54:02.118417,epoch time: 0:22:50.178635,used: 2:19:39.140959,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99711, 'precision': 0.99752724, 'recall': 0.99502337, 'specificity': 0.99502337, 'f1': 0.9962667, 'auroc': 0.9998456, 'binary_precision': 0.99840117, 'binary_recall': 0.99061406, 'binary_specificity': 0.99943274, 'binary_f1_score': 0.99449235}
confusion matrix:
       0      1
0  42287     24
1    142  14987
---- Validation: 
scalar performance:
{'acc': 0.9773611, 'precision': 0.8150633, 'recall': 0.82769585, 'specificity': 0.82769585, 'f1': 0.82124394, 'auroc': 0.96542054, 'binary_precision': 0.6411483, 'binary_recall': 0.6677741, 'binary_specificity': 0.9876176, 'binary_f1_score': 0.6541904}
confusion matrix:
       0    1
0  17946  225
1    200  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.78545666, 'recall': 0.59452283, 'specificity': 0.59452283, 'f1': 0.6375807, 'auroc': 0.936655, 'binary_precision': 0.6025641, 'binary_recall': 0.19421488, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.29375002}
confusion matrix:
      0   1
0  5966  31
1   195  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-30 20:16:47.364622,epoch time: 0:22:45.246205,used: 2:42:24.387164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9952298, 'precision': 0.9954341, 'recall': 0.99226135, 'specificity': 0.99226135, 'f1': 0.9938339, 'auroc': 0.9997048, 'binary_precision': 0.9958612, 'binary_recall': 0.9859881, 'binary_specificity': 0.9985346, 'binary_f1_score': 0.99090004}
confusion matrix:
       0      1
0  42248     62
1    212  14918
---- Validation: 
scalar performance:
{'acc': 0.97661537, 'precision': 0.8216444, 'recall': 0.7775216, 'specificity': 0.7775216, 'f1': 0.797817, 'auroc': 0.9649677, 'binary_precision': 0.6576402, 'binary_recall': 0.56478405, 'binary_specificity': 0.99025923, 'binary_f1_score': 0.60768545}
confusion matrix:
       0    1
0  17994  177
1    262  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.823196, 'recall': 0.56891394, 'specificity': 0.56891394, 'f1': 0.6072475, 'auroc': 0.95520765, 'binary_precision': 0.68, 'binary_recall': 0.14049587, 'binary_specificity': 0.997332, 'binary_f1_score': 0.23287673}
confusion matrix:
      0   1
0  5981  16
1   208  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_8.png
new oracle model saved
early stop counter: 1
val acc:0.9766153693199158, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9637762308120728 / 0.9640967845916748
after epoch: 8,now: 2024-06-30 20:39:34.486751,epoch time: 0:22:47.122129,used: 3:05:11.509293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9944986, 'precision': 0.9915509, 'recall': 0.9943338, 'specificity': 0.9943338, 'f1': 0.9929315, 'auroc': 0.9996999, 'binary_precision': 0.9852594, 'binary_recall': 0.9939855, 'binary_specificity': 0.99468213, 'binary_f1_score': 0.98960316}
confusion matrix:
       0      1
0  42085    225
1     91  15039
---- Validation: 
scalar performance:
{'acc': 0.908166, 'precision': 0.6141317, 'recall': 0.8674387, 'specificity': 0.8674387, 'f1': 0.65787274, 'auroc': 0.93614614, 'binary_precision': 0.23462631, 'binary_recall': 0.82392025, 'binary_specificity': 0.91095704, 'binary_f1_score': 0.36524302}
confusion matrix:
       0     1
0  16553  1618
1    106   496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90046483, 'precision': 0.5607336, 'recall': 0.62900287, 'specificity': 0.62900287, 'f1': 0.57689846, 'auroc': 0.84489834, 'binary_precision': 0.14972274, 'binary_recall': 0.33471075, 'binary_specificity': 0.92329496, 'binary_f1_score': 0.20689656}
confusion matrix:
      0    1
0  5537  460
1   161   81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_9.png
early stop counter: 2
val acc:0.9081659913063049, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9637762308120728 / 0.9640967845916748
after epoch: 9,now: 2024-06-30 21:02:25.638405,epoch time: 0:22:51.151654,used: 3:28:02.660947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99627435, 'precision': 0.99709153, 'recall': 0.9933097, 'specificity': 0.9933097, 'f1': 0.995181, 'auroc': 0.99978065, 'binary_precision': 0.99879605, 'binary_recall': 0.98704475, 'binary_specificity': 0.9995746, 'binary_f1_score': 0.99288565}
confusion matrix:
       0      1
0  42293     18
1    196  14933
---- Validation: 
scalar performance:
{'acc': 0.974165, 'precision': 0.80207986, 'recall': 0.74493694, 'specificity': 0.74493694, 'f1': 0.7702576, 'auroc': 0.95142555, 'binary_precision': 0.6206186, 'binary_recall': 0.5, 'binary_specificity': 0.98987395, 'binary_f1_score': 0.55381787}
confusion matrix:
       0    1
0  17987  184
1    301  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95752525, 'precision': 0.5666943, 'recall': 0.50997883, 'specificity': 0.50997883, 'f1': 0.5108009, 'auroc': 0.8907644, 'binary_precision': 0.17142858, 'binary_recall': 0.024793388, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.0433213}
confusion matrix:
      0   1
0  5968  29
1   236   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_10.png
early stop counter: 3
val acc:0.9741650223731995, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9637762308120728 / 0.9640967845916748
after epoch: 10,now: 2024-06-30 21:25:18.421770,epoch time: 0:22:52.783365,used: 3:50:55.444312,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99777156, 'precision': 0.9973179, 'recall': 0.99693763, 'specificity': 0.99693763, 'f1': 0.9971276, 'auroc': 0.99987924, 'binary_precision': 0.9963605, 'binary_recall': 0.9951751, 'binary_specificity': 0.9987001, 'binary_f1_score': 0.9957674}
confusion matrix:
       0      1
0  42255     55
1     73  15057
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.7587035, 'recall': 0.65334964, 'specificity': 0.65334964, 'f1': 0.69131815, 'auroc': 0.9431572, 'binary_precision': 0.53977275, 'binary_recall': 0.3156146, 'binary_specificity': 0.9910847, 'binary_f1_score': 0.39832285}
confusion matrix:
       0    1
0  18009  162
1    412  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7315709, 'recall': 0.5257756, 'specificity': 0.5257756, 'f1': 0.5385976, 'auroc': 0.90989244, 'binary_precision': 0.5, 'binary_recall': 0.053719006, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.09701493}
confusion matrix:
      0   1
0  5984  13
1   229  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_11.png
early stop counter: 4
val acc:0.9694241881370544, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9637762308120728 / 0.9640967845916748
after epoch: 11,now: 2024-06-30 21:48:09.955263,epoch time: 0:22:51.533493,used: 4:13:46.977805,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9943071, 'precision': 0.9961431, 'recall': 0.9892149, 'specificity': 0.9892149, 'f1': 0.9926133, 'auroc': 0.9998343, 'binary_precision': 0.99993247, 'binary_recall': 0.9784534, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.98907626}
confusion matrix:
       0      1
0  42309      1
1    326  14804
---- Validation: 
scalar performance:
{'acc': 0.9720343, 'precision': 0.9067688, 'recall': 0.57840836, 'specificity': 0.57840836, 'f1': 0.62574005, 'auroc': 0.9431553, 'binary_precision': 0.84070796, 'binary_recall': 0.1578073, 'binary_specificity': 0.99900943, 'binary_f1_score': 0.26573426}
confusion matrix:
       0   1
0  18153  18
1    507  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.58794606, 'recall': 0.5052812, 'specificity': 0.5052812, 'f1': 0.5014913, 'auroc': 0.8749926, 'binary_precision': 0.21428572, 'binary_recall': 0.012396694, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.0234375}
confusion matrix:
      0   1
0  5986  11
1   239   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_12.png
early stop counter: 5
val acc:0.9720342755317688, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9637762308120728 / 0.9640967845916748
after epoch: 12,now: 2024-06-30 22:11:08.056692,epoch time: 0:22:58.101429,used: 4:36:45.079234,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9970056, 'precision': 0.9978019, 'recall': 0.99448574, 'specificity': 0.99448574, 'f1': 0.9961288, 'auroc': 0.99991465, 'binary_precision': 0.99946576, 'binary_recall': 0.9891606, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.9942865}
confusion matrix:
       0      1
0  42302      8
1    164  14966
---- Validation: 
scalar performance:
{'acc': 0.97347254, 'precision': 0.8093104, 'recall': 0.69559336, 'specificity': 0.69559336, 'f1': 0.7385896, 'auroc': 0.9535621, 'binary_precision': 0.63829786, 'binary_recall': 0.3986711, 'binary_specificity': 0.99251556, 'binary_f1_score': 0.49079755}
confusion matrix:
       0    1
0  18035  136
1    362  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95576215, 'precision': 0.58484286, 'recall': 0.5209581, 'specificity': 0.5209581, 'f1': 0.5286681, 'auroc': 0.8955232, 'binary_precision': 0.20689656, 'binary_recall': 0.049586777, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.07999999}
confusion matrix:
      0   1
0  5951  46
1   230  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_13.png
early stop counter: 6
val acc:0.973472535610199, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9637762308120728 / 0.9640967845916748
after epoch: 13,now: 2024-06-30 22:33:58.843131,epoch time: 0:22:50.786439,used: 4:59:35.865673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9968315, 'precision': 0.9976194, 'recall': 0.99421895, 'specificity': 0.99421895, 'f1': 0.9959034, 'auroc': 0.9998338, 'binary_precision': 0.9992652, 'binary_recall': 0.98869795, 'binary_specificity': 0.99974, 'binary_f1_score': 0.9939534}
confusion matrix:
       0      1
0  42299     11
1    171  14959
---- Validation: 
scalar performance:
{'acc': 0.97347254, 'precision': 0.8869784, 'recall': 0.61448544, 'specificity': 0.61448544, 'f1': 0.6723519, 'auroc': 0.9542408, 'binary_precision': 0.7988506, 'binary_recall': 0.23089701, 'binary_specificity': 0.9980739, 'binary_f1_score': 0.35824743}
confusion matrix:
       0    1
0  18136   35
1    463  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.7537806, 'recall': 0.5119798, 'specificity': 0.5119798, 'f1': 0.51385856, 'auroc': 0.9587171, 'binary_precision': 0.54545456, 'binary_recall': 0.024793388, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.047430832}
confusion matrix:
      0  1
0  5992  5
1   236  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_14.png
early stop counter: 7
val acc:0.973472535610199, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9637762308120728 / 0.9640967845916748
after epoch: 14,now: 2024-06-30 22:57:01.337586,epoch time: 0:23:02.494455,used: 5:22:38.360128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9960306, 'precision': 0.99406135, 'recall': 0.99573463, 'specificity': 0.99573463, 'f1': 0.9948941, 'auroc': 0.99983776, 'binary_precision': 0.9898751, 'binary_recall': 0.9951091, 'binary_specificity': 0.9963602, 'binary_f1_score': 0.99248517}
confusion matrix:
       0      1
0  42156    154
1     74  15056
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.74860024, 'recall': 0.8520379, 'specificity': 0.8520379, 'f1': 0.7903782, 'auroc': 0.95551205, 'binary_precision': 0.5063584, 'binary_recall': 0.72757477, 'binary_specificity': 0.97650105, 'binary_f1_score': 0.59713703}
confusion matrix:
       0    1
0  17744  427
1    164  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9560827, 'precision': 0.6873992, 'recall': 0.6301756, 'specificity': 0.6301756, 'f1': 0.65286523, 'auroc': 0.9136021, 'binary_precision': 0.40361446, 'binary_recall': 0.2768595, 'binary_specificity': 0.9834917, 'binary_f1_score': 0.32843137}
confusion matrix:
      0   1
0  5898  99
1   175  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_15.png
early stop counter: 8
val acc:0.9685186147689819, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9637762308120728 / 0.9640967845916748
after epoch: 15,now: 2024-06-30 23:20:32.844951,epoch time: 0:23:31.507365,used: 5:46:09.867493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99622214, 'precision': 0.9974487, 'recall': 0.99282885, 'specificity': 0.99282885, 'f1': 0.99510956, 'auroc': 0.99981606, 'binary_precision': 1.0, 'binary_recall': 0.98565763, 'binary_specificity': 1.0, 'binary_f1_score': 0.992777}
confusion matrix:
       0      1
0  42310      0
1    217  14913
---- Validation: 
scalar performance:
{'acc': 0.9717147, 'precision': 0.9191216, 'recall': 0.5694097, 'specificity': 0.5694097, 'f1': 0.61296624, 'auroc': 0.9527513, 'binary_precision': 0.8659794, 'binary_recall': 0.13953489, 'binary_specificity': 0.99928457, 'binary_f1_score': 0.24034335}
confusion matrix:
       0   1
0  18158  13
1    518  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.6056736, 'recall': 0.501816, 'specificity': 0.501816, 'f1': 0.49409118, 'auroc': 0.89281833, 'binary_precision': 0.25, 'binary_recall': 0.004132231, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.008130081}
confusion matrix:
      0  1
0  5994  3
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_16.png
early stop counter: 9
val acc:0.9717146754264832, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9637762308120728 / 0.9640967845916748
after epoch: 16,now: 2024-06-30 23:43:55.600513,epoch time: 0:23:22.755562,used: 6:09:32.623055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.997406, 'precision': 0.99811554, 'recall': 0.9952028, 'specificity': 0.9952028, 'f1': 0.9966475, 'auroc': 0.99986994, 'binary_precision': 0.99959975, 'binary_recall': 0.99054736, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99505293}
confusion matrix:
       0      1
0  42306      6
1    143  14985
---- Validation: 
scalar performance:
{'acc': 0.95999575, 'precision': 0.66973007, 'recall': 0.6524945, 'specificity': 0.6524945, 'f1': 0.66058815, 'auroc': 0.9167862, 'binary_precision': 0.3617811, 'binary_recall': 0.32392028, 'binary_specificity': 0.98106873, 'binary_f1_score': 0.34180543}
confusion matrix:
       0    1
0  17827  344
1    407  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94486296, 'precision': 0.53204453, 'recall': 0.5172714, 'specificity': 0.5172714, 'f1': 0.5209297, 'auroc': 0.8236935, 'binary_precision': 0.1015625, 'binary_recall': 0.053719006, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.07027026}
confusion matrix:
      0    1
0  5882  115
1   229   13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_17.png
early stop counter: 10
val acc:0.9599957466125488, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9637762308120728 / 0.9640967845916748
after epoch: 17,now: 2024-07-01 00:07:12.155984,epoch time: 0:23:16.555471,used: 6:32:49.178526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99528205, 'precision': 0.9968178, 'recall': 0.9910443, 'specificity': 0.9910443, 'f1': 0.9938855, 'auroc': 0.99989194, 'binary_precision': 1.0, 'binary_recall': 0.98208857, 'binary_specificity': 1.0, 'binary_f1_score': 0.99096334}
confusion matrix:
       0      1
0  42310      0
1    271  14859
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.8146088, 'recall': 0.54408, 'specificity': 0.54408, 'f1': 0.57113445, 'auroc': 0.9308965, 'binary_precision': 0.6585366, 'binary_recall': 0.089701, 'binary_specificity': 0.9984591, 'binary_f1_score': 0.15789475}
confusion matrix:
       0   1
0  18143  28
1    548  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.58067054, 'recall': 0.50173265, 'specificity': 0.50173265, 'f1': 0.49403307, 'auroc': 0.85782146, 'binary_precision': 0.2, 'binary_recall': 0.004132231, 'binary_specificity': 0.999333, 'binary_f1_score': 0.008097166}
confusion matrix:
      0  1
0  5993  4
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_18.png
early stop counter: 11
val acc:0.969317615032196, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9637762308120728 / 0.9640967845916748
after epoch: 18,now: 2024-07-01 00:30:29.476069,epoch time: 0:23:17.320085,used: 6:56:06.498611,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9969011, 'precision': 0.9972996, 'recall': 0.99471205, 'specificity': 0.99471205, 'f1': 0.9959966, 'auroc': 0.99975157, 'binary_precision': 0.9981343, 'binary_recall': 0.9900859, 'binary_specificity': 0.9993382, 'binary_f1_score': 0.9940938}
confusion matrix:
       0      1
0  42282     28
1    150  14980
---- Validation: 
scalar performance:
{'acc': 0.97262025, 'precision': 0.8557708, 'recall': 0.61243904, 'specificity': 0.61243904, 'f1': 0.6668662, 'auroc': 0.95405287, 'binary_precision': 0.73655915, 'binary_recall': 0.22757475, 'binary_specificity': 0.99730337, 'binary_f1_score': 0.34771574}
confusion matrix:
       0    1
0  18122   49
1    465  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.6308155, 'recall': 0.50561476, 'specificity': 0.50561476, 'f1': 0.5018442, 'auroc': 0.9407038, 'binary_precision': 0.3, 'binary_recall': 0.012396694, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.023809522}
confusion matrix:
      0  1
0  5990  7
1   239  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_19.png
early stop counter: 12
val acc:0.9726202487945557, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9637762308120728 / 0.9640967845916748
after epoch: 19,now: 2024-07-01 00:53:46.798381,epoch time: 0:23:17.322312,used: 7:19:23.820923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9918872, 'precision': 0.98588717, 'recall': 0.9935378, 'specificity': 0.9935378, 'f1': 0.98962843, 'auroc': 0.99984515, 'binary_precision': 0.97284746, 'binary_recall': 0.9970256, 'binary_specificity': 0.9900499, 'binary_f1_score': 0.9847882}
confusion matrix:
       0      1
0  41890    421
1     45  15084
---- Validation: 
scalar performance:
{'acc': 0.86906725, 'precision': 0.5834595, 'recall': 0.84563553, 'specificity': 0.84563553, 'f1': 0.6073135, 'auroc': 0.9151107, 'binary_precision': 0.17369902, 'binary_recall': 0.820598, 'binary_specificity': 0.87067306, 'binary_f1_score': 0.28670925}
confusion matrix:
       0     1
0  15821  2350
1    108   494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75861514, 'precision': 0.5341069, 'recall': 0.6702149, 'specificity': 0.6702149, 'f1': 0.5075015, 'auroc': 0.7640396, 'binary_precision': 0.090142675, 'binary_recall': 0.57438016, 'binary_specificity': 0.7660497, 'binary_f1_score': 0.1558296}
confusion matrix:
      0     1
0  4594  1403
1   103   139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_20.png
early stop counter: 13
val acc:0.8690672516822815, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9637762308120728 / 0.9640967845916748
after epoch: 20,now: 2024-07-01 01:16:57.430983,epoch time: 0:23:10.632602,used: 7:42:34.453525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99756265, 'precision': 0.99665034, 'recall': 0.9970718, 'specificity': 0.9970718, 'f1': 0.99686074, 'auroc': 0.9998975, 'binary_precision': 0.99471945, 'binary_recall': 0.9960344, 'binary_specificity': 0.9981092, 'binary_f1_score': 0.9953764}
confusion matrix:
       0      1
0  42230     80
1     60  15070
---- Validation: 
scalar performance:
{'acc': 0.97784054, 'precision': 0.8284068, 'recall': 0.7998368, 'specificity': 0.7998368, 'f1': 0.8134155, 'auroc': 0.9597453, 'binary_precision': 0.669708, 'binary_recall': 0.6096346, 'binary_specificity': 0.99003905, 'binary_f1_score': 0.63826084}
confusion matrix:
       0    1
0  17990  181
1    235  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.67990667, 'recall': 0.53683835, 'specificity': 0.53683835, 'f1': 0.55517924, 'auroc': 0.9008957, 'binary_precision': 0.39583334, 'binary_recall': 0.0785124, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.1310345}
confusion matrix:
      0   1
0  5968  29
1   223  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_21.png
better model found
persisted
after epoch: 21,now: 2024-07-01 01:40:17.622615,epoch time: 0:23:20.191632,used: 8:05:54.645157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99771935, 'precision': 0.9983487, 'recall': 0.995777, 'specificity': 0.995777, 'f1': 0.99705386, 'auroc': 0.9998881, 'binary_precision': 0.99966687, 'binary_recall': 0.99167216, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.9956535}
confusion matrix:
       0      1
0  42305      5
1    126  15004
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.7475542, 'recall': 0.71479917, 'specificity': 0.71479917, 'f1': 0.7298963, 'auroc': 0.9370756, 'binary_precision': 0.51346153, 'binary_recall': 0.4435216, 'binary_specificity': 0.9860767, 'binary_f1_score': 0.47593585}
confusion matrix:
       0    1
0  17918  253
1    335  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9411765, 'precision': 0.54233146, 'recall': 0.5292329, 'specificity': 0.5292329, 'f1': 0.53393835, 'auroc': 0.8332887, 'binary_precision': 0.121212125, 'binary_recall': 0.08264463, 'binary_specificity': 0.97582126, 'binary_f1_score': 0.0982801}
confusion matrix:
      0    1
0  5852  145
1   222   20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_22.png
early stop counter: 1
val acc:0.9686784148216248, best validation acc: 0.9778405427932739, corresponding to test acc:                         0.9596089124679565 / 0.9640967845916748
after epoch: 22,now: 2024-07-01 02:03:33.492280,epoch time: 0:23:15.869665,used: 8:29:10.514822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9971448, 'precision': 0.998026, 'recall': 0.9946224, 'specificity': 0.9946224, 'f1': 0.9963084, 'auroc': 0.9998684, 'binary_precision': 0.99986637, 'binary_recall': 0.9892921, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9945511}
confusion matrix:
       0      1
0  42309      2
1    162  14967
---- Validation: 
scalar performance:
{'acc': 0.9743781, 'precision': 0.97170377, 'recall': 0.60371053, 'specificity': 0.60371053, 'f1': 0.66446596, 'auroc': 0.9595226, 'binary_precision': 0.96899223, 'binary_recall': 0.2076412, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.34199724}
confusion matrix:
       0    1
0  18167    4
1    477  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.9423537, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_23.png
early stop counter: 2
val acc:0.9743781089782715, best validation acc: 0.9778405427932739, corresponding to test acc:                         0.9596089124679565 / 0.9640967845916748
after epoch: 23,now: 2024-07-01 02:26:50.294684,epoch time: 0:23:16.802404,used: 8:52:27.317226,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99806756, 'precision': 0.9980917, 'recall': 0.9969262, 'specificity': 0.9969262, 'f1': 0.9975071, 'auroc': 0.99984294, 'binary_precision': 0.9981426, 'binary_recall': 0.9945142, 'binary_specificity': 0.9993382, 'binary_f1_score': 0.99632514}
confusion matrix:
       0      1
0  42282     28
1     83  15047
---- Validation: 
scalar performance:
{'acc': 0.96692055, 'precision': 0.73338, 'recall': 0.73075515, 'specificity': 0.73075515, 'f1': 0.7320593, 'auroc': 0.94178605, 'binary_precision': 0.4840336, 'binary_recall': 0.47840533, 'binary_specificity': 0.98310494, 'binary_f1_score': 0.481203}
confusion matrix:
       0    1
0  17864  307
1    314  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957365, 'precision': 0.696495, 'recall': 0.6268771, 'specificity': 0.6268771, 'f1': 0.6531333, 'auroc': 0.91028786, 'binary_precision': 0.42207792, 'binary_recall': 0.26859504, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.3282828}
confusion matrix:
      0   1
0  5908  89
1   177  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_24.png
early stop counter: 3
val acc:0.9669205546379089, best validation acc: 0.9778405427932739, corresponding to test acc:                         0.9596089124679565 / 0.9640967845916748
after epoch: 24,now: 2024-07-01 02:50:06.717332,epoch time: 0:23:16.422648,used: 9:15:43.739874,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99791086, 'precision': 0.99785745, 'recall': 0.9967562, 'specificity': 0.9967562, 'f1': 0.99730515, 'auroc': 0.9998908, 'binary_precision': 0.99774504, 'binary_recall': 0.9943159, 'binary_specificity': 0.9991964, 'binary_f1_score': 0.9960275}
confusion matrix:
       0      1
0  42276     34
1     86  15044
---- Validation: 
scalar performance:
{'acc': 0.974165, 'precision': 0.7832001, 'recall': 0.8637881, 'specificity': 0.8637881, 'f1': 0.8179508, 'auroc': 0.9655682, 'binary_precision': 0.57490396, 'binary_recall': 0.74584717, 'binary_specificity': 0.98172915, 'binary_f1_score': 0.64931303}
confusion matrix:
       0    1
0  17839  332
1    153  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9721109, 'precision': 0.86179686, 'recall': 0.7098918, 'specificity': 0.7098918, 'f1': 0.7638614, 'auroc': 0.9403428, 'binary_precision': 0.7463768, 'binary_recall': 0.42561984, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.5421053}
confusion matrix:
      0    1
0  5962   35
1   139  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_25.png
new oracle model saved
early stop counter: 4
val acc:0.9741650223731995, best validation acc: 0.9778405427932739, corresponding to test acc:                         0.9596089124679565 / 0.97211092710495
after epoch: 25,now: 2024-07-01 03:13:20.596214,epoch time: 0:23:13.878882,used: 9:38:57.618756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99766713, 'precision': 0.9983998, 'recall': 0.99559295, 'specificity': 0.99559295, 'f1': 0.9969856, 'auroc': 0.99991006, 'binary_precision': 0.9999333, 'binary_recall': 0.9912095, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.99555236}
confusion matrix:
       0      1
0  42309      1
1    133  14997
---- Validation: 
scalar performance:
{'acc': 0.97853297, 'precision': 0.8820858, 'recall': 0.7271171, 'specificity': 0.7271171, 'f1': 0.7834984, 'auroc': 0.9629339, 'binary_precision': 0.7818697, 'binary_recall': 0.45847178, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.5780105}
confusion matrix:
       0    1
0  18094   77
1    326  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95656353, 'precision': 0.620321, 'recall': 0.5332715, 'specificity': 0.5332715, 'f1': 0.54749894, 'auroc': 0.8854186, 'binary_precision': 0.2769231, 'binary_recall': 0.07438017, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.11726385}
confusion matrix:
      0   1
0  5950  47
1   224  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_26.png
better model found
persisted
after epoch: 26,now: 2024-07-01 03:36:28.675371,epoch time: 0:23:08.079157,used: 10:02:05.697913,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99735373, 'precision': 0.9980802, 'recall': 0.99510425, 'specificity': 0.99510425, 'f1': 0.9965801, 'auroc': 0.99992025, 'binary_precision': 0.99959975, 'binary_recall': 0.9903503, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9949536}
confusion matrix:
       0      1
0  42304      6
1    146  14984
---- Validation: 
scalar performance:
{'acc': 0.9751238, 'precision': 0.8788716, 'recall': 0.6546878, 'specificity': 0.6546878, 'f1': 0.71665114, 'auroc': 0.9594977, 'binary_precision': 0.780083, 'binary_recall': 0.31229237, 'binary_specificity': 0.99708325, 'binary_f1_score': 0.44602612}
confusion matrix:
       0    1
0  18118   53
1    414  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.66875505, 'recall': 0.5173444, 'specificity': 0.5173444, 'f1': 0.5236806, 'auroc': 0.90794694, 'binary_precision': 0.375, 'binary_recall': 0.037190083, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.067669176}
confusion matrix:
      0   1
0  5982  15
1   233   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_27.png
early stop counter: 1
val acc:0.9751238226890564, best validation acc: 0.9785329699516296, corresponding to test acc:                         0.9565635323524475 / 0.97211092710495
after epoch: 27,now: 2024-07-01 03:59:37.778482,epoch time: 0:23:09.103111,used: 10:25:14.801024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9969708, 'precision': 0.99713254, 'recall': 0.9950563, 'specificity': 0.9950563, 'f1': 0.9960885, 'auroc': 0.99984646, 'binary_precision': 0.99747187, 'binary_recall': 0.99101067, 'binary_specificity': 0.9991019, 'binary_f1_score': 0.9942308}
confusion matrix:
       0      1
0  42273     38
1    136  14993
---- Validation: 
scalar performance:
{'acc': 0.93581206, 'precision': 0.60791665, 'recall': 0.69782156, 'specificity': 0.69782156, 'f1': 0.6367102, 'auroc': 0.904683, 'binary_precision': 0.2348285, 'binary_recall': 0.4435216, 'binary_specificity': 0.9521215, 'binary_f1_score': 0.30707303}
confusion matrix:
       0    1
0  17301  870
1    335  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9128065, 'precision': 0.5457423, 'recall': 0.5739578, 'specificity': 0.5739578, 'f1': 0.55465513, 'auroc': 0.86102295, 'binary_precision': 0.12437811, 'binary_recall': 0.20661157, 'binary_specificity': 0.94130397, 'binary_f1_score': 0.1552795}
confusion matrix:
      0    1
0  5645  352
1   192   50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_28.png
early stop counter: 2
val acc:0.9358120560646057, best validation acc: 0.9785329699516296, corresponding to test acc:                         0.9565635323524475 / 0.97211092710495
after epoch: 28,now: 2024-07-01 04:22:31.448317,epoch time: 0:22:53.669835,used: 10:48:08.470859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9983809, 'precision': 0.9984965, 'recall': 0.99733, 'specificity': 0.99733, 'f1': 0.99791133, 'auroc': 0.9999504, 'binary_precision': 0.99873966, 'binary_recall': 0.9951091, 'binary_specificity': 0.99955094, 'binary_f1_score': 0.996921}
confusion matrix:
       0      1
0  42291     19
1     74  15056
---- Validation: 
scalar performance:
{'acc': 0.9728866, 'precision': 0.7906208, 'recall': 0.7290187, 'specificity': 0.7290187, 'f1': 0.7558368, 'auroc': 0.9610797, 'binary_precision': 0.5987261, 'binary_recall': 0.46843854, 'binary_specificity': 0.9895988, 'binary_f1_score': 0.52562904}
confusion matrix:
       0    1
0  17982  189
1    320  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95512104, 'precision': 0.6358002, 'recall': 0.556314, 'specificity': 0.556314, 'f1': 0.5767012, 'auroc': 0.8862606, 'binary_precision': 0.30612245, 'binary_recall': 0.12396694, 'binary_specificity': 0.988661, 'binary_f1_score': 0.1764706}
confusion matrix:
      0   1
0  5929  68
1   212  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_29.png
early stop counter: 3
val acc:0.9728866219520569, best validation acc: 0.9785329699516296, corresponding to test acc:                         0.9565635323524475 / 0.97211092710495
after epoch: 29,now: 2024-07-01 04:45:29.876403,epoch time: 0:22:58.428086,used: 11:11:06.898945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9984157, 'precision': 0.99888396, 'recall': 0.997035, 'specificity': 0.997035, 'f1': 0.99795485, 'auroc': 0.9999004, 'binary_precision': 0.999867, 'binary_recall': 0.99411726, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9969839}
confusion matrix:
       0      1
0  42309      2
1     89  15040
---- Validation: 
scalar performance:
{'acc': 0.97800034, 'precision': 0.8895987, 'recall': 0.7083719, 'specificity': 0.7083719, 'f1': 0.7696613, 'auroc': 0.9664111, 'binary_precision': 0.79810727, 'binary_recall': 0.4202658, 'binary_specificity': 0.9964779, 'binary_f1_score': 0.5505985}
confusion matrix:
       0    1
0  18107   64
1    349  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.6923034, 'recall': 0.5312236, 'specificity': 0.5312236, 'f1': 0.5469772, 'auroc': 0.9352836, 'binary_precision': 0.42105263, 'binary_recall': 0.0661157, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.11428571}
confusion matrix:
      0   1
0  5975  22
1   226  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628981_30.png
early stop counter: 4
val acc:0.9780003428459167, best validation acc: 0.9785329699516296, corresponding to test acc:                         0.9565635323524475 / 0.97211092710495
after epoch: 30,now: 2024-07-01 05:08:35.041458,epoch time: 0:23:05.165055,used: 11:34:12.064000,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_34_22_seed_2_21628981
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:34:12.064000 at 2024-07-01 05:08:35.041458
persisted model performance metric: 

scalar performance:
{'acc': 0.95656353, 'precision': 0.620321, 'recall': 0.5332715, 'specificity': 0.5332715, 'f1': 0.54749894, 'auroc': 0.8854186, 'binary_precision': 0.2769231, 'binary_recall': 0.07438017, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.11726385}
confusion matrix:
      0   1
0  5950  47
1   224  18
oracle model performance metric: 

scalar performance:
{'acc': 0.9721109, 'precision': 0.86179686, 'recall': 0.7098918, 'specificity': 0.7098918, 'f1': 0.7638614, 'auroc': 0.9403428, 'binary_precision': 0.7463768, 'binary_recall': 0.42561984, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.5421053}
confusion matrix:
      0    1
0  5962   35
1   139  103
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 369159 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool | 337306 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |  31853 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 369159 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool | 337306 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |  31853 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362640 KiB |   9125 MiB |   3660 TiB |   3660 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   3612 TiB |   3612 TiB |
|       from small pool |  30850 KiB |     50 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10006 MiB |  10022 MiB |  28586 MiB |  18580 MiB |
|       from large pool |   9950 MiB |   9962 MiB |  28492 MiB |  18542 MiB |
|       from small pool |     56 MiB |     60 MiB |     94 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 386552 KiB |    877 MiB |   2635 TiB |   2635 TiB |
|       from large pool | 377446 KiB |    872 MiB |   2587 TiB |   2587 TiB |
|       from small pool |   9106 KiB |     32 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3305    |    8014    |  663609 K  |  663606 K  |
|       from large pool |     151    |     986    |  339597 K  |  339597 K  |
|       from small pool |    3154    |    7861    |  324011 K  |  324008 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3305    |    8014    |  663609 K  |  663606 K  |
|       from large pool |     151    |     986    |  339597 K  |  339597 K  |
|       from small pool |    3154    |    7861    |  324011 K  |  324008 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     443    |     445    |    1231    |     788    |
|       from large pool |     415    |     415    |    1184    |     769    |
|       from small pool |      28    |      30    |      47    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3641    |  438125 K  |  438125 K  |
|       from large pool |      35    |     417    |  275898 K  |  275898 K  |
|       from small pool |      35    |    3607    |  162227 K  |  162227 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |      0 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |      0 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   3660 TiB |   3660 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   3612 TiB |   3612 TiB |
|       from small pool |      0 KiB |     50 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  28586 MiB |  27848 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  28492 MiB |  27794 MiB |
|       from small pool |  40960 KiB |     60 MiB |     94 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    877 MiB |   2635 TiB |   2635 TiB |
|       from large pool |  24320 KiB |    872 MiB |   2587 TiB |   2587 TiB |
|       from small pool |      0 KiB |     32 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8014    |  663609 K  |  663609 K  |
|       from large pool |       2    |     986    |  339597 K  |  339597 K  |
|       from small pool |       0    |    7861    |  324011 K  |  324011 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8014    |  663609 K  |  663609 K  |
|       from large pool |       2    |     986    |  339597 K  |  339597 K  |
|       from small pool |       0    |    7861    |  324011 K  |  324011 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |    1231    |    1180    |
|       from large pool |      31    |     415    |    1184    |    1153    |
|       from small pool |      20    |      30    |      47    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3641    |  438127 K  |  438127 K  |
|       from large pool |       3    |     417    |  275898 K  |  275898 K  |
|       from small pool |       0    |    3607    |  162228 K  |  162228 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul  1 05:09:55 2024]
Finished job 0.
1 of 1 steps (100%) done
