Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 29 18:11:54 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983

 Experiment start at: 2024-06-29 18:17:54.163112
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9799965, 'precision': 0.9656263, 'recall': 0.98419356, 'specificity': 0.98419356, 'f1': 0.9743961, 'auroc': 0.9990964, 'binary_precision': 0.93378925, 'binary_recall': 0.9928649, 'binary_specificity': 0.97552216, 'binary_f1_score': 0.9624214}
confusion matrix:
       0      1
0  41288   1036
1    105  14611
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.82253087, 'precision': 0.5753936, 'recall': 0.87436914, 'specificity': 0.87436914, 'f1': 0.58153045, 'auroc': 0.9455756, 'binary_precision': 0.15380658, 'binary_recall': 0.93001556, 'binary_specificity': 0.8187228, 'binary_f1_score': 0.2639594}
confusion matrix:
       0     1
0  14859  3290
1     45   598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65420264, 'precision': 0.54587317, 'recall': 0.77010345, 'specificity': 0.77010345, 'f1': 0.47943595, 'auroc': 0.8850428, 'binary_precision': 0.09869254, 'binary_recall': 0.8965517, 'binary_specificity': 0.6436552, 'binary_f1_score': 0.17781155}
confusion matrix:
      0     1
0  3860  2137
1    27   234
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-29 18:42:40.503210,epoch time: 0:24:46.340098,used: 0:24:46.340098,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99314517, 'precision': 0.9916838, 'recall': 0.9903956, 'specificity': 0.9903956, 'f1': 0.9910375, 'auroc': 0.99927765, 'binary_precision': 0.98867667, 'binary_recall': 0.9847136, 'binary_specificity': 0.9960776, 'binary_f1_score': 0.9866911}
confusion matrix:
       0      1
0  42155    166
1    225  14494
---- Validation: 
scalar performance:
{'acc': 0.9669008, 'precision': 0.7496198, 'recall': 0.7578475, 'specificity': 0.7578475, 'f1': 0.75365925, 'auroc': 0.9370963, 'binary_precision': 0.51578945, 'binary_recall': 0.533437, 'binary_specificity': 0.98225796, 'binary_f1_score': 0.5244648}
confusion matrix:
       0    1
0  17827  322
1    300  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.84508204, 'recall': 0.65442014, 'specificity': 0.65442014, 'f1': 0.7099771, 'auroc': 0.9120691, 'binary_precision': 0.71929824, 'binary_recall': 0.31417623, 'binary_specificity': 0.994664, 'binary_f1_score': 0.43733332}
confusion matrix:
      0   1
0  5965  32
1   179  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-29 19:06:43.430616,epoch time: 0:24:02.927406,used: 0:48:49.267504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.991094, 'precision': 0.9850191, 'recall': 0.99202645, 'specificity': 0.99202645, 'f1': 0.9884547, 'auroc': 0.9995912, 'binary_precision': 0.9721576, 'binary_recall': 0.9939534, 'binary_specificity': 0.9900995, 'binary_f1_score': 0.9829347}
confusion matrix:
       0      1
0  41902    419
1     89  14630
---- Validation: 
scalar performance:
{'acc': 0.9454555, 'precision': 0.66131103, 'recall': 0.7849978, 'specificity': 0.7849978, 'f1': 0.7029921, 'auroc': 0.9323808, 'binary_precision': 0.33675215, 'binary_recall': 0.61275274, 'binary_specificity': 0.95724285, 'binary_f1_score': 0.43463874}
confusion matrix:
       0    1
0  17373  776
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89181846, 'precision': 0.609456, 'recall': 0.7988007, 'specificity': 0.7988007, 'f1': 0.64533293, 'auroc': 0.89288706, 'binary_precision': 0.23333333, 'binary_recall': 0.697318, 'binary_specificity': 0.90028346, 'binary_f1_score': 0.3496638}
confusion matrix:
      0    1
0  5399  598
1    79  182
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_3.png
early stop counter: 1
val acc:0.9454554915428162, best validation acc: 0.9669008255004883, corresponding to test acc:                         0.9662831425666809 / 0.9662831425666809
after epoch: 3,now: 2024-06-29 19:30:37.160079,epoch time: 0:23:53.729463,used: 1:12:42.996967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99416196, 'precision': 0.99598074, 'recall': 0.98879737, 'specificity': 0.98879737, 'f1': 0.992321, 'auroc': 0.9996363, 'binary_precision': 0.9996526, 'binary_recall': 0.97771287, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.98856103}
confusion matrix:
       0      1
0  42318      5
1    328  14389
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.8170173, 'recall': 0.5839938, 'specificity': 0.5839938, 'f1': 0.6279622, 'auroc': 0.95768017, 'binary_precision': 0.6626506, 'binary_recall': 0.1710731, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.27194068}
confusion matrix:
       0    1
0  18093   56
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.81911576, 'recall': 0.54314417, 'specificity': 0.54314417, 'f1': 0.56777877, 'auroc': 0.9592502, 'binary_precision': 0.6764706, 'binary_recall': 0.08812261, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.1559322}
confusion matrix:
      0   1
0  5986  11
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_4.png
better model found
persisted
after epoch: 4,now: 2024-06-29 19:54:38.134093,epoch time: 0:24:00.974014,used: 1:36:43.970981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99635345, 'precision': 0.99587274, 'recall': 0.99459535, 'specificity': 0.99459535, 'f1': 0.99523187, 'auroc': 0.99974453, 'binary_precision': 0.9948837, 'binary_recall': 0.9909628, 'binary_specificity': 0.9982279, 'binary_f1_score': 0.9929194}
confusion matrix:
       0      1
0  42248     75
1    133  14584
---- Validation: 
scalar performance:
{'acc': 0.97392505, 'precision': 0.82804894, 'recall': 0.7254814, 'specificity': 0.7254814, 'f1': 0.7664366, 'auroc': 0.9645791, 'binary_precision': 0.67505723, 'binary_recall': 0.45878693, 'binary_specificity': 0.9921759, 'binary_f1_score': 0.5462963}
confusion matrix:
       0    1
0  18007  142
1    348  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.8891252, 'recall': 0.70847684, 'specificity': 0.70847684, 'f1': 0.7690375, 'auroc': 0.9537617, 'binary_precision': 0.8029197, 'binary_recall': 0.42145595, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.5527638}
confusion matrix:
      0    1
0  5970   27
1   151  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-29 20:18:18.698363,epoch time: 0:23:40.564270,used: 2:00:24.535251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99549437, 'precision': 0.994496, 'recall': 0.9937278, 'specificity': 0.9937278, 'f1': 0.9941112, 'auroc': 0.99974775, 'binary_precision': 0.9924387, 'binary_recall': 0.99007815, 'binary_specificity': 0.99737746, 'binary_f1_score': 0.9912571}
confusion matrix:
       0      1
0  42214    111
1    146  14569
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7515091, 'recall': 0.81946224, 'specificity': 0.81946224, 'f1': 0.78095376, 'auroc': 0.9605925, 'binary_precision': 0.5151515, 'binary_recall': 0.66096425, 'binary_specificity': 0.9779602, 'binary_f1_score': 0.57901907}
confusion matrix:
       0    1
0  17749  400
1    218  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.81605434, 'recall': 0.6535864, 'specificity': 0.6535864, 'f1': 0.7038781, 'auroc': 0.9530008, 'binary_precision': 0.66129035, 'binary_recall': 0.31417623, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.42597398}
confusion matrix:
      0   1
0  5955  42
1   179  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_6.png
early stop counter: 1
val acc:0.9671136736869812, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9715564250946045 / 0.9715564250946045
after epoch: 6,now: 2024-06-29 20:42:16.526206,epoch time: 0:23:57.827843,used: 2:24:22.363094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9948983, 'precision': 0.9965396, 'recall': 0.9901564, 'specificity': 0.9901564, 'f1': 0.99329436, 'auroc': 0.9997554, 'binary_precision': 0.99986136, 'binary_recall': 0.98036015, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99001473}
confusion matrix:
       0      1
0  42323      2
1    289  14426
---- Validation: 
scalar performance:
{'acc': 0.96855044, 'precision': 0.81992906, 'recall': 0.57868826, 'specificity': 0.57868826, 'f1': 0.62120193, 'auroc': 0.9581096, 'binary_precision': 0.66883117, 'binary_recall': 0.16018662, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.25846925}
confusion matrix:
       0    1
0  18098   51
1    540  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8232146, 'recall': 0.5488079, 'specificity': 0.5488079, 'f1': 0.5768476, 'auroc': 0.92839634, 'binary_precision': 0.68421054, 'binary_recall': 0.099616855, 'binary_specificity': 0.997999, 'binary_f1_score': 0.17391303}
confusion matrix:
      0   1
0  5985  12
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_7.png
early stop counter: 2
val acc:0.968550443649292, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9715564250946045 / 0.9715564250946045
after epoch: 7,now: 2024-06-29 21:05:59.040204,epoch time: 0:23:42.513998,used: 2:48:04.877092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9957223, 'precision': 0.9969508, 'recall': 0.99188757, 'specificity': 0.99188757, 'f1': 0.99438536, 'auroc': 0.99979496, 'binary_precision': 0.9994479, 'binary_recall': 0.98396415, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9916456}
confusion matrix:
       0      1
0  42315      8
1    236  14481
---- Validation: 
scalar performance:
{'acc': 0.9680183, 'precision': 0.88018167, 'recall': 0.54391026, 'specificity': 0.54391026, 'f1': 0.5715698, 'auroc': 0.9500421, 'binary_precision': 0.7916667, 'binary_recall': 0.08864697, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.15944056}
confusion matrix:
       0   1
0  18134  15
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.8366661, 'recall': 0.5094118, 'specificity': 0.5094118, 'f1': 0.50812435, 'auroc': 0.93615997, 'binary_precision': 0.71428573, 'binary_recall': 0.019157087, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.037313428}
confusion matrix:
      0  1
0  5995  2
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_8.png
early stop counter: 3
val acc:0.9680182933807373, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9715564250946045 / 0.9715564250946045
after epoch: 8,now: 2024-06-29 21:29:21.925005,epoch time: 0:23:22.884801,used: 3:11:27.761893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99465287, 'precision': 0.9963073, 'recall': 0.98974586, 'specificity': 0.98974586, 'f1': 0.9929699, 'auroc': 0.999838, 'binary_precision': 0.9996532, 'binary_recall': 0.97960985, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9895301}
confusion matrix:
       0      1
0  42322      5
1    300  14413
---- Validation: 
scalar performance:
{'acc': 0.96780545, 'precision': 0.90373766, 'recall': 0.53629947, 'specificity': 0.53629947, 'f1': 0.55903774, 'auroc': 0.96712625, 'binary_precision': 0.83928573, 'binary_recall': 0.07309487, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.13447784}
confusion matrix:
       0   1
0  18140   9
1    596  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.95554996, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_9.png
early stop counter: 4
val acc:0.9678054451942444, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9715564250946045 / 0.9715564250946045
after epoch: 9,now: 2024-06-29 21:52:44.099391,epoch time: 0:23:22.174386,used: 3:34:49.936279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.995284, 'precision': 0.99658966, 'recall': 0.99110353, 'specificity': 0.99110353, 'f1': 0.99380684, 'auroc': 0.9997045, 'binary_precision': 0.9992397, 'binary_recall': 0.9824669, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.99078226}
confusion matrix:
       0      1
0  42314     11
1    258  14457
---- Validation: 
scalar performance:
{'acc': 0.9732865, 'precision': 0.80775565, 'recall': 0.75665313, 'specificity': 0.75665313, 'f1': 0.77967054, 'auroc': 0.95732915, 'binary_precision': 0.63227016, 'binary_recall': 0.5241057, 'binary_specificity': 0.98920053, 'binary_f1_score': 0.57312924}
confusion matrix:
       0    1
0  17953  196
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.81814456, 'recall': 0.6910668, 'specificity': 0.6910668, 'f1': 0.73706484, 'auroc': 0.95626694, 'binary_precision': 0.66233766, 'binary_recall': 0.3908046, 'binary_specificity': 0.991329, 'binary_f1_score': 0.4915662}
confusion matrix:
      0    1
0  5945   52
1   159  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_10.png
early stop counter: 5
val acc:0.973286509513855, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9715564250946045 / 0.9715564250946045
after epoch: 10,now: 2024-06-29 22:16:26.387211,epoch time: 0:23:42.287820,used: 3:58:32.224099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9963008, 'precision': 0.99659246, 'recall': 0.99373996, 'specificity': 0.99373996, 'f1': 0.99515545, 'auroc': 0.9997208, 'binary_precision': 0.99718946, 'binary_recall': 0.98844874, 'binary_specificity': 0.99903125, 'binary_f1_score': 0.99279994}
confusion matrix:
       0      1
0  42282     41
1    170  14547
---- Validation: 
scalar performance:
{'acc': 0.9729672, 'precision': 0.8272587, 'recall': 0.69873357, 'specificity': 0.69873357, 'f1': 0.74597, 'auroc': 0.95671636, 'binary_precision': 0.6753247, 'binary_recall': 0.4043546, 'binary_specificity': 0.99311256, 'binary_f1_score': 0.5058366}
confusion matrix:
       0    1
0  18024  125
1    383  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.75276256, 'recall': 0.52215475, 'specificity': 0.52215475, 'f1': 0.53181666, 'auroc': 0.9574727, 'binary_precision': 0.54545456, 'binary_recall': 0.04597701, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.08480566}
confusion matrix:
      0   1
0  5987  10
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_11.png
early stop counter: 6
val acc:0.9729672074317932, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9715564250946045 / 0.9715564250946045
after epoch: 11,now: 2024-06-29 22:40:01.467542,epoch time: 0:23:35.080331,used: 4:22:07.304430,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9975281, 'precision': 0.997644, 'recall': 0.9958966, 'specificity': 0.9958966, 'f1': 0.99676627, 'auroc': 0.99973536, 'binary_precision': 0.99788225, 'binary_recall': 0.99252564, 'binary_specificity': 0.9992675, 'binary_f1_score': 0.99519676}
confusion matrix:
       0      1
0  42292     31
1    110  14607
---- Validation: 
scalar performance:
{'acc': 0.96471906, 'precision': 0.72956717, 'recall': 0.6862128, 'specificity': 0.6862128, 'f1': 0.7053689, 'auroc': 0.9295412, 'binary_precision': 0.48069498, 'binary_recall': 0.38724726, 'binary_specificity': 0.98517823, 'binary_f1_score': 0.42894056}
confusion matrix:
       0    1
0  17880  269
1    394  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7807068, 'recall': 0.61152416, 'specificity': 0.61152416, 'f1': 0.6557903, 'auroc': 0.93520546, 'binary_precision': 0.5940594, 'binary_recall': 0.22988506, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.33149174}
confusion matrix:
      0   1
0  5956  41
1   201  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_12.png
early stop counter: 7
val acc:0.9647190570831299, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9715564250946045 / 0.9715564250946045
after epoch: 12,now: 2024-06-29 23:03:42.443228,epoch time: 0:23:40.975686,used: 4:45:48.280116,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9948808, 'precision': 0.99129176, 'recall': 0.9954424, 'specificity': 0.9954424, 'f1': 0.9933437, 'auroc': 0.9997727, 'binary_precision': 0.9837704, 'binary_recall': 0.996603, 'binary_specificity': 0.9942818, 'binary_f1_score': 0.9901451}
confusion matrix:
       0      1
0  42079    242
1     50  14669
---- Validation: 
scalar performance:
{'acc': 0.9638676, 'precision': 0.7319874, 'recall': 0.79227984, 'specificity': 0.79227984, 'f1': 0.75822645, 'auroc': 0.93542993, 'binary_precision': 0.4779951, 'binary_recall': 0.60808706, 'binary_specificity': 0.97647256, 'binary_f1_score': 0.5352498}
confusion matrix:
       0    1
0  17722  427
1    252  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95222116, 'precision': 0.6859419, 'recall': 0.63975376, 'specificity': 0.63975376, 'f1': 0.65903324, 'auroc': 0.8908469, 'binary_precision': 0.40206185, 'binary_recall': 0.29885057, 'binary_specificity': 0.980657, 'binary_f1_score': 0.34285715}
confusion matrix:
      0    1
0  5881  116
1   183   78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_13.png
early stop counter: 8
val acc:0.9638676047325134, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9715564250946045 / 0.9715564250946045
after epoch: 13,now: 2024-06-29 23:27:30.500613,epoch time: 0:23:48.057385,used: 5:09:36.337501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99437237, 'precision': 0.9902334, 'recall': 0.9952105, 'specificity': 0.9952105, 'f1': 0.99268824, 'auroc': 0.999864, 'binary_precision': 0.981536, 'binary_recall': 0.99694234, 'binary_specificity': 0.9934787, 'binary_f1_score': 0.98917913}
confusion matrix:
       0      1
0  42047    276
1     45  14672
---- Validation: 
scalar performance:
{'acc': 0.8414219, 'precision': 0.5728674, 'recall': 0.8248949, 'specificity': 0.8248949, 'f1': 0.5847786, 'auroc': 0.89418566, 'binary_precision': 0.15377778, 'binary_recall': 0.80715394, 'binary_specificity': 0.8426359, 'binary_f1_score': 0.25833747}
confusion matrix:
       0     1
0  15293  2856
1    124   519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81208056, 'precision': 0.54662794, 'recall': 0.6802386, 'specificity': 0.6802386, 'f1': 0.5429893, 'auroc': 0.79422975, 'binary_precision': 0.117154814, 'binary_recall': 0.5363985, 'binary_specificity': 0.8240787, 'binary_f1_score': 0.19230768}
confusion matrix:
      0     1
0  4942  1055
1   121   140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_14.png
early stop counter: 9
val acc:0.841421902179718, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9715564250946045 / 0.9715564250946045
after epoch: 14,now: 2024-06-29 23:51:31.771752,epoch time: 0:24:01.271139,used: 5:33:37.608640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9982293, 'precision': 0.9982953, 'recall': 0.99707794, 'specificity': 0.99707794, 'f1': 0.9976847, 'auroc': 0.999876, 'binary_precision': 0.9984311, 'binary_recall': 0.9946993, 'binary_specificity': 0.9994566, 'binary_f1_score': 0.9965617}
confusion matrix:
       0      1
0  42302     23
1     78  14637
---- Validation: 
scalar performance:
{'acc': 0.97035974, 'precision': 0.773221, 'recall': 0.80464154, 'specificity': 0.80464154, 'f1': 0.7879824, 'auroc': 0.94973063, 'binary_precision': 0.55972224, 'binary_recall': 0.62674963, 'binary_specificity': 0.98253345, 'binary_f1_score': 0.5913426}
confusion matrix:
       0    1
0  17832  317
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.78845614, 'recall': 0.57079595, 'specificity': 0.57079595, 'f1': 0.6075183, 'auroc': 0.9244522, 'binary_precision': 0.61290324, 'binary_recall': 0.14559387, 'binary_specificity': 0.995998, 'binary_f1_score': 0.23529412}
confusion matrix:
      0   1
0  5973  24
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_15.png
early stop counter: 10
val acc:0.970359742641449, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9715564250946045 / 0.9715564250946045
after epoch: 15,now: 2024-06-30 00:15:33.167618,epoch time: 0:24:01.395866,used: 5:57:39.004506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9964937, 'precision': 0.99466574, 'recall': 0.9961967, 'specificity': 0.9961967, 'f1': 0.9954281, 'auroc': 0.9998301, 'binary_precision': 0.99086976, 'binary_recall': 0.99558306, 'binary_specificity': 0.9968103, 'binary_f1_score': 0.99322087}
confusion matrix:
       0      1
0  42189    135
1     65  14651
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.7591242, 'recall': 0.7517307, 'specificity': 0.7517307, 'f1': 0.755368, 'auroc': 0.9494276, 'binary_precision': 0.5352564, 'binary_recall': 0.5194401, 'binary_specificity': 0.9840212, 'binary_f1_score': 0.52722967}
confusion matrix:
       0    1
0  17859  290
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93112814, 'precision': 0.5798146, 'recall': 0.5847723, 'specificity': 0.5847723, 'f1': 0.58219266, 'auroc': 0.8942832, 'binary_precision': 0.19424461, 'binary_recall': 0.20689656, 'binary_specificity': 0.962648, 'binary_f1_score': 0.20037106}
confusion matrix:
      0    1
0  5773  224
1   207   54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_16.png
early stop counter: 11
val acc:0.9681247472763062, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9715564250946045 / 0.9715564250946045
after epoch: 16,now: 2024-06-30 00:39:24.200303,epoch time: 0:23:51.032685,used: 6:21:30.037191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9980189, 'precision': 0.99784255, 'recall': 0.99698085, 'specificity': 0.99698085, 'f1': 0.9974107, 'auroc': 0.9998837, 'binary_precision': 0.9974792, 'binary_recall': 0.9948359, 'binary_specificity': 0.9991258, 'binary_f1_score': 0.9961558}
confusion matrix:
       0      1
0  42286     37
1     76  14641
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.76558554, 'recall': 0.7973125, 'specificity': 0.7973125, 'f1': 0.7804539, 'auroc': 0.9594735, 'binary_precision': 0.5449516, 'binary_recall': 0.61275274, 'binary_specificity': 0.98187226, 'binary_f1_score': 0.5768668}
confusion matrix:
       0    1
0  17820  329
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7364514, 'recall': 0.7033057, 'specificity': 0.7033057, 'f1': 0.7184512, 'auroc': 0.94313586, 'binary_precision': 0.49775785, 'binary_recall': 0.42528737, 'binary_specificity': 0.981324, 'binary_f1_score': 0.4586777}
confusion matrix:
      0    1
0  5885  112
1   150  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_17.png
early stop counter: 12
val acc:0.9692422151565552, best validation acc: 0.9739250540733337, corresponding to test acc:                         0.9715564250946045 / 0.9715564250946045
after epoch: 17,now: 2024-06-30 01:03:14.118288,epoch time: 0:23:49.917985,used: 6:45:19.955176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9978962, 'precision': 0.99856377, 'recall': 0.9959452, 'specificity': 0.9959452, 'f1': 0.99724543, 'auroc': 0.99992883, 'binary_precision': 0.9999315, 'binary_recall': 0.9919141, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99590665}
confusion matrix:
       0      1
0  42322      1
1    119  14598
---- Validation: 
scalar performance:
{'acc': 0.97557473, 'precision': 0.8698014, 'recall': 0.706834, 'specificity': 0.706834, 'f1': 0.7635367, 'auroc': 0.964365, 'binary_precision': 0.759887, 'binary_recall': 0.41835147, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.53961885}
confusion matrix:
       0    1
0  18064   85
1    374  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.67986524, 'recall': 0.5179065, 'specificity': 0.5179065, 'f1': 0.5240901, 'auroc': 0.92699766, 'binary_precision': 0.4, 'binary_recall': 0.038314175, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.06993007}
confusion matrix:
      0   1
0  5982  15
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_18.png
better model found
persisted
after epoch: 18,now: 2024-06-30 01:27:08.965540,epoch time: 0:23:54.847252,used: 7:09:14.802428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9979313, 'precision': 0.9983402, 'recall': 0.9962574, 'specificity': 0.9962574, 'f1': 0.99729306, 'auroc': 0.999823, 'binary_precision': 0.9991795, 'binary_recall': 0.99279845, 'binary_specificity': 0.99971646, 'binary_f1_score': 0.9959787}
confusion matrix:
       0      1
0  42309     12
1    106  14613
---- Validation: 
scalar performance:
{'acc': 0.97110474, 'precision': 0.84865475, 'recall': 0.6242639, 'specificity': 0.6242639, 'f1': 0.67945683, 'auroc': 0.95802164, 'binary_precision': 0.72321427, 'binary_recall': 0.251944, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.37370244}
confusion matrix:
       0    1
0  18087   62
1    481  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949185, 'precision': 0.5029863, 'recall': 0.50074464, 'specificity': 0.50074464, 'f1': 0.49621794, 'auroc': 0.8782846, 'binary_precision': 0.04761905, 'binary_recall': 0.011494253, 'binary_specificity': 0.989995, 'binary_f1_score': 0.018518519}
confusion matrix:
      0   1
0  5937  60
1   258   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_19.png
early stop counter: 1
val acc:0.9711047410964966, best validation acc: 0.9755747318267822, corresponding to test acc:                         0.9574943780899048 / 0.9715564250946045
after epoch: 19,now: 2024-06-30 01:51:02.029952,epoch time: 0:23:53.064412,used: 7:33:07.866840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99719495, 'precision': 0.9968198, 'recall': 0.9958494, 'specificity': 0.9958494, 'f1': 0.99633336, 'auroc': 0.99982834, 'binary_precision': 0.99604714, 'binary_recall': 0.99306923, 'binary_specificity': 0.99862957, 'binary_f1_score': 0.99455595}
confusion matrix:
       0      1
0  42265     58
1    102  14615
---- Validation: 
scalar performance:
{'acc': 0.9729672, 'precision': 0.786373, 'recall': 0.86374575, 'specificity': 0.86374575, 'f1': 0.8199426, 'auroc': 0.9687236, 'binary_precision': 0.58181816, 'binary_recall': 0.7465008, 'binary_specificity': 0.9809907, 'binary_f1_score': 0.6539509}
confusion matrix:
       0    1
0  17804  345
1    163  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9752317, 'precision': 0.86656463, 'recall': 0.8001788, 'specificity': 0.8001788, 'f1': 0.8297169, 'auroc': 0.95260465, 'binary_precision': 0.75, 'binary_recall': 0.6091954, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.6723044}
confusion matrix:
      0    1
0  5944   53
1   102  159
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_20.png
new oracle model saved
early stop counter: 2
val acc:0.9729672074317932, best validation acc: 0.9755747318267822, corresponding to test acc:                         0.9574943780899048 / 0.9752317070960999
after epoch: 20,now: 2024-06-30 02:14:57.049192,epoch time: 0:23:55.019240,used: 7:57:02.886080,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9929699, 'precision': 0.9951434, 'recall': 0.9865296, 'specificity': 0.9865296, 'f1': 0.99073863, 'auroc': 0.99971586, 'binary_precision': 0.9995114, 'binary_recall': 0.9732246, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.9861928}
confusion matrix:
       0      1
0  42318      7
1    394  14321
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.7673427, 'recall': 0.68211323, 'specificity': 0.68211323, 'f1': 0.7158425, 'auroc': 0.9512148, 'binary_precision': 0.556582, 'binary_recall': 0.3748056, 'binary_specificity': 0.9894209, 'binary_f1_score': 0.4479554}
confusion matrix:
       0    1
0  17957  192
1    402  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9475871, 'precision': 0.55364525, 'recall': 0.52006656, 'specificity': 0.52006656, 'f1': 0.525839, 'auroc': 0.9146433, 'binary_precision': 0.14736842, 'binary_recall': 0.053639848, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.07865169}
confusion matrix:
      0   1
0  5916  81
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_21.png
early stop counter: 3
val acc:0.9683908224105835, best validation acc: 0.9755747318267822, corresponding to test acc:                         0.9574943780899048 / 0.9752317070960999
after epoch: 21,now: 2024-06-30 02:38:49.014010,epoch time: 0:23:51.964818,used: 8:20:54.850898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9965989, 'precision': 0.9945464, 'recall': 0.99660003, 'specificity': 0.99660003, 'f1': 0.99556756, 'auroc': 0.9998846, 'binary_precision': 0.9902768, 'binary_recall': 0.99660236, 'binary_specificity': 0.99659765, 'binary_f1_score': 0.99342954}
confusion matrix:
       0      1
0  42180    144
1     50  14666
---- Validation: 
scalar performance:
{'acc': 0.9771711, 'precision': 0.8269483, 'recall': 0.8284194, 'specificity': 0.8284194, 'f1': 0.827682, 'auroc': 0.9700293, 'binary_precision': 0.6656347, 'binary_recall': 0.6687403, 'binary_specificity': 0.9880985, 'binary_f1_score': 0.6671839}
confusion matrix:
       0    1
0  17933  216
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9511026, 'precision': 0.6704071, 'recall': 0.61718214, 'specificity': 0.61718214, 'f1': 0.6380173, 'auroc': 0.91981244, 'binary_precision': 0.37288135, 'binary_recall': 0.25287357, 'binary_specificity': 0.98149073, 'binary_f1_score': 0.30136985}
confusion matrix:
      0    1
0  5886  111
1   195   66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_22.png
better model found
persisted
after epoch: 22,now: 2024-06-30 03:02:37.141704,epoch time: 0:23:48.127694,used: 8:44:42.978592,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9979839, 'precision': 0.9981967, 'recall': 0.99653596, 'specificity': 0.99653596, 'f1': 0.99736273, 'auroc': 0.99989605, 'binary_precision': 0.998634, 'binary_recall': 0.99354446, 'binary_specificity': 0.99952745, 'binary_f1_score': 0.9960827}
confusion matrix:
       0      1
0  42304     20
1     95  14621
---- Validation: 
scalar performance:
{'acc': 0.9770115, 'precision': 0.9031335, 'recall': 0.70607775, 'specificity': 0.70607775, 'f1': 0.77049875, 'auroc': 0.9627433, 'binary_precision': 0.8266254, 'binary_recall': 0.41524106, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.55279505}
confusion matrix:
       0    1
0  18093   56
1    376  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.92122036, 'recall': 0.5818752, 'specificity': 0.5818752, 'f1': 0.6295339, 'auroc': 0.9586174, 'binary_precision': 0.877551, 'binary_recall': 0.16475096, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.27741933}
confusion matrix:
      0   1
0  5991   6
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_23.png
early stop counter: 1
val acc:0.977011501789093, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.951102614402771 / 0.9752317070960999
after epoch: 23,now: 2024-06-30 03:26:24.054454,epoch time: 0:23:46.912750,used: 9:08:29.891342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99652874, 'precision': 0.997558, 'recall': 0.9933834, 'specificity': 0.9933834, 'f1': 0.99544775, 'auroc': 0.9998818, 'binary_precision': 0.99965584, 'binary_recall': 0.986885, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99322945}
confusion matrix:
       0      1
0  42319      5
1    193  14523
---- Validation: 
scalar performance:
{'acc': 0.9767454, 'precision': 0.89776754, 'recall': 0.70518994, 'specificity': 0.70518994, 'f1': 0.7685423, 'auroc': 0.97026896, 'binary_precision': 0.81595093, 'binary_recall': 0.41368586, 'binary_specificity': 0.996694, 'binary_f1_score': 0.54901963}
confusion matrix:
       0    1
0  18089   60
1    377  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.85103154, 'recall': 0.5377306, 'specificity': 0.5377306, 'f1': 0.55930376, 'auroc': 0.9430205, 'binary_precision': 0.7407407, 'binary_recall': 0.07662835, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.13888888}
confusion matrix:
      0   1
0  5990   7
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_24.png
early stop counter: 2
val acc:0.9767454266548157, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.951102614402771 / 0.9752317070960999
after epoch: 24,now: 2024-06-30 03:50:02.690983,epoch time: 0:23:38.636529,used: 9:32:08.527871,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9975456, 'precision': 0.99823856, 'recall': 0.9953547, 'specificity': 0.9953547, 'f1': 0.9967857, 'auroc': 0.999882, 'binary_precision': 0.9996573, 'binary_recall': 0.99082756, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99522287}
confusion matrix:
       0      1
0  42317      5
1    135  14583
---- Validation: 
scalar performance:
{'acc': 0.97126436, 'precision': 0.94183064, 'recall': 0.5883439, 'specificity': 0.5883439, 'f1': 0.64110374, 'auroc': 0.9474949, 'binary_precision': 0.912, 'binary_recall': 0.17729394, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.296875}
confusion matrix:
       0    1
0  18138   11
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.6458833, 'recall': 0.501749, 'specificity': 0.501749, 'f1': 0.49309576, 'auroc': 0.9285871, 'binary_precision': 0.33333334, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5995  2
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_25.png
early stop counter: 3
val acc:0.9712643623352051, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.951102614402771 / 0.9752317070960999
after epoch: 25,now: 2024-06-30 04:13:30.167947,epoch time: 0:23:27.476964,used: 9:55:36.004835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9982819, 'precision': 0.9986655, 'recall': 0.996847, 'specificity': 0.996847, 'f1': 0.9977519, 'auroc': 0.99985814, 'binary_precision': 0.9994532, 'binary_recall': 0.99388295, 'binary_specificity': 0.999811, 'binary_f1_score': 0.99666023}
confusion matrix:
       0      1
0  42319      8
1     90  14623
---- Validation: 
scalar performance:
{'acc': 0.97482973, 'precision': 0.8779347, 'recall': 0.6831966, 'specificity': 0.6831966, 'f1': 0.7443347, 'auroc': 0.9678477, 'binary_precision': 0.7777778, 'binary_recall': 0.37013996, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.5015806}
confusion matrix:
       0    1
0  18081   68
1    405  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.8126024, 'recall': 0.57304513, 'specificity': 0.57304513, 'f1': 0.61195374, 'auroc': 0.9482262, 'binary_precision': 0.66101694, 'binary_recall': 0.14942528, 'binary_specificity': 0.996665, 'binary_f1_score': 0.24375}
confusion matrix:
      0   1
0  5977  20
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_26.png
early stop counter: 4
val acc:0.9748297333717346, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.951102614402771 / 0.9752317070960999
after epoch: 26,now: 2024-06-30 04:36:58.207052,epoch time: 0:23:28.039105,used: 10:19:04.043940,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.996669, 'precision': 0.99500144, 'recall': 0.99631494, 'specificity': 0.99631494, 'f1': 0.9956559, 'auroc': 0.9999044, 'binary_precision': 0.9915409, 'binary_recall': 0.99558336, 'binary_specificity': 0.99704653, 'binary_f1_score': 0.99355805}
confusion matrix:
       0      1
0  42198    125
1     65  14652
---- Validation: 
scalar performance:
{'acc': 0.95466155, 'precision': 0.7025166, 'recall': 0.8677696, 'specificity': 0.8677696, 'f1': 0.7575598, 'auroc': 0.9592788, 'binary_precision': 0.413278, 'binary_recall': 0.7744945, 'binary_specificity': 0.96104467, 'binary_f1_score': 0.53896105}
confusion matrix:
       0    1
0  17442  707
1    145  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91051453, 'precision': 0.61388427, 'recall': 0.744424, 'specificity': 0.744424, 'f1': 0.6481216, 'auroc': 0.89052635, 'binary_precision': 0.24789207, 'binary_recall': 0.5632184, 'binary_specificity': 0.9256295, 'binary_f1_score': 0.3442623}
confusion matrix:
      0    1
0  5551  446
1   114  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_27.png
early stop counter: 5
val acc:0.9546615481376648, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.951102614402771 / 0.9752317070960999
after epoch: 27,now: 2024-06-30 05:00:34.772744,epoch time: 0:23:36.565692,used: 10:42:40.609632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9982118, 'precision': 0.99875295, 'recall': 0.9965782, 'specificity': 0.9965782, 'f1': 0.99765944, 'auroc': 0.99984753, 'binary_precision': 0.99986315, 'binary_recall': 0.99320376, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99652237}
confusion matrix:
       0      1
0  42324      2
1    100  14614
---- Validation: 
scalar performance:
{'acc': 0.9752554, 'precision': 0.94591355, 'recall': 0.6519147, 'specificity': 0.6519147, 'f1': 0.7223743, 'auroc': 0.9677323, 'binary_precision': 0.91588783, 'binary_recall': 0.30482116, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.4574096}
confusion matrix:
       0    1
0  18131   18
1    447  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.9438325, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_28.png
early stop counter: 6
val acc:0.9752554297447205, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.951102614402771 / 0.9752317070960999
after epoch: 28,now: 2024-06-30 05:24:21.324799,epoch time: 0:23:46.552055,used: 11:06:27.161687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9982118, 'precision': 0.998328, 'recall': 0.9969996, 'specificity': 0.9969996, 'f1': 0.9976615, 'auroc': 0.9999379, 'binary_precision': 0.99856704, 'binary_recall': 0.9944954, 'binary_specificity': 0.99950385, 'binary_f1_score': 0.996527}
confusion matrix:
       0      1
0  42304     21
1     81  14634
---- Validation: 
scalar performance:
{'acc': 0.9752554, 'precision': 0.8399204, 'recall': 0.7404212, 'specificity': 0.7404212, 'f1': 0.78091127, 'auroc': 0.963512, 'binary_precision': 0.69777775, 'binary_recall': 0.48833594, 'binary_specificity': 0.99250644, 'binary_f1_score': 0.5745654}
confusion matrix:
       0    1
0  18013  136
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.78845614, 'recall': 0.57079595, 'specificity': 0.57079595, 'f1': 0.6075183, 'auroc': 0.92241204, 'binary_precision': 0.61290324, 'binary_recall': 0.14559387, 'binary_specificity': 0.995998, 'binary_f1_score': 0.23529412}
confusion matrix:
      0   1
0  5973  24
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_29.png
early stop counter: 7
val acc:0.9752554297447205, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.951102614402771 / 0.9752317070960999
after epoch: 29,now: 2024-06-30 05:48:08.135089,epoch time: 0:23:46.810290,used: 11:30:13.971977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9979313, 'precision': 0.9976728, 'recall': 0.99692214, 'specificity': 0.99692214, 'f1': 0.9972967, 'auroc': 0.99984413, 'binary_precision': 0.99713993, 'binary_recall': 0.9948366, 'binary_specificity': 0.9990076, 'binary_f1_score': 0.995987}
confusion matrix:
       0      1
0  42279     42
1     76  14643
---- Validation: 
scalar performance:
{'acc': 0.9738719, 'precision': 0.7955632, 'recall': 0.8409624, 'specificity': 0.8409624, 'f1': 0.81647146, 'auroc': 0.96983445, 'binary_precision': 0.6018767, 'binary_recall': 0.6982893, 'binary_specificity': 0.9836355, 'binary_f1_score': 0.64650834}
confusion matrix:
       0    1
0  17852  297
1    194  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95158195, 'precision': 0.65152514, 'recall': 0.5771209, 'specificity': 0.5771209, 'f1': 0.60003716, 'auroc': 0.93364835, 'binary_precision': 0.33846155, 'binary_recall': 0.16858238, 'binary_specificity': 0.9856595, 'binary_f1_score': 0.22506393}
confusion matrix:
      0   1
0  5911  86
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_30.png
early stop counter: 8
val acc:0.9738718867301941, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.951102614402771 / 0.9752317070960999
after epoch: 30,now: 2024-06-30 06:11:58.620961,epoch time: 0:23:50.485872,used: 11:54:04.457849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_54_seed_0_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:54:04.457849 at 2024-06-30 06:11:58.620961
persisted model performance metric: 

scalar performance:
{'acc': 0.9511026, 'precision': 0.6704071, 'recall': 0.61718214, 'specificity': 0.61718214, 'f1': 0.6380173, 'auroc': 0.91981244, 'binary_precision': 0.37288135, 'binary_recall': 0.25287357, 'binary_specificity': 0.98149073, 'binary_f1_score': 0.30136985}
confusion matrix:
      0    1
0  5886  111
1   195   66
oracle model performance metric: 

scalar performance:
{'acc': 0.9752317, 'precision': 0.86656463, 'recall': 0.8001788, 'specificity': 0.8001788, 'f1': 0.8297169, 'auroc': 0.95260465, 'binary_precision': 0.75, 'binary_recall': 0.6091954, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.6723044}
confusion matrix:
      0    1
0  5944   53
1   102  159
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 369815 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool | 337956 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |  31859 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 369815 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool | 337956 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |  31859 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362641 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |  30851 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10022 MiB |  10022 MiB |  10022 MiB |      0 B   |
|       from large pool |   9962 MiB |   9962 MiB |   9962 MiB |      0 B   |
|       from small pool |     60 MiB |     60 MiB |     60 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 357224 KiB |    876 MiB |    880 TiB |    880 TiB |
|       from large pool | 350172 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |   7052 KiB |     11 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3317    |    7964    |  221732 K  |  221729 K  |
|       from large pool |     151    |     986    |  113526 K  |  113526 K  |
|       from small pool |    3166    |    7811    |  108206 K  |  108203 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3317    |    7964    |  221732 K  |  221729 K  |
|       from large pool |     151    |     986    |  113526 K  |  113526 K  |
|       from small pool |    3166    |    7811    |  108206 K  |  108203 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     445    |     445    |     445    |       0    |
|       from large pool |     415    |     415    |     415    |       0    |
|       from small pool |      30    |      30    |      30    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    3613    |  140459 K  |  140459 K  |
|       from large pool |      32    |     417    |   88579 K  |   88579 K  |
|       from small pool |      31    |    3582    |   51880 K  |   51880 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |      0 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 727040 KiB |  10022 MiB |  10022 MiB |   9312 MiB |
|       from large pool | 688128 KiB |   9962 MiB |   9962 MiB |   9290 MiB |
|       from small pool |  38912 KiB |     60 MiB |     60 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |    880 TiB |    880 TiB |
|       from large pool |  24320 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |      0 KiB |     30 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  221732 K  |  221732 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108206 K  |  108206 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  221732 K  |  221732 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108206 K  |  108206 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |     445    |     445    |     396    |
|       from large pool |      30    |     415    |     415    |     385    |
|       from small pool |      19    |      30    |      30    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3613    |  140460 K  |  140460 K  |
|       from large pool |       3    |     417    |   88579 K  |   88579 K  |
|       from small pool |       0    |    3582    |   51881 K  |   51881 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |      0 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 727040 KiB |  10022 MiB |  10022 MiB |   9312 MiB |
|       from large pool | 688128 KiB |   9962 MiB |   9962 MiB |   9290 MiB |
|       from small pool |  38912 KiB |     60 MiB |     60 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |    880 TiB |    880 TiB |
|       from large pool |  24320 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |      0 KiB |     30 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  221732 K  |  221732 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108206 K  |  108206 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  221732 K  |  221732 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108206 K  |  108206 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |     445    |     445    |     396    |
|       from large pool |      30    |     415    |     415    |     385    |
|       from small pool |      19    |      30    |      30    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3613    |  140460 K  |  140460 K  |
|       from large pool |       3    |     417    |   88579 K  |   88579 K  |
|       from small pool |       0    |    3582    |   51881 K  |   51881 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983

 Experiment start at: 2024-06-30 06:19:39.507103
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9896361, 'precision': 0.9866084, 'recall': 0.9860063, 'specificity': 0.9860063, 'f1': 0.9863069, 'auroc': 0.9987677, 'binary_precision': 0.98047394, 'binary_recall': 0.9786378, 'binary_specificity': 0.9933748, 'binary_f1_score': 0.979555}
confusion matrix:
       0      1
0  42133    281
1    308  14110
---- Validation: 
scalar performance:
{'acc': 0.9288687, 'precision': 0.65370506, 'recall': 0.8808538, 'specificity': 0.8808538, 'f1': 0.70882213, 'auroc': 0.93600225, 'binary_precision': 0.3141892, 'binary_recall': 0.8291233, 'binary_specificity': 0.9325843, 'binary_f1_score': 0.45569625}
confusion matrix:
       0     1
0  16849  1218
1    115   558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8438608, 'precision': 0.5865725, 'recall': 0.81921136, 'specificity': 0.81921136, 'f1': 0.6052456, 'auroc': 0.8857752, 'binary_precision': 0.1837645, 'binary_recall': 0.7923077, 'binary_specificity': 0.84611505, 'binary_f1_score': 0.29833454}
confusion matrix:
      0    1
0  5031  915
1    54  206
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-30 06:44:08.294474,epoch time: 0:24:28.787371,used: 0:24:28.787371,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99144846, 'precision': 0.99203587, 'recall': 0.98534536, 'specificity': 0.98534536, 'f1': 0.98863256, 'auroc': 0.99911237, 'binary_precision': 0.993204, 'binary_recall': 0.9729542, 'binary_specificity': 0.9977365, 'binary_f1_score': 0.9829749}
confusion matrix:
       0      1
0  42316     96
1    390  14030
---- Validation: 
scalar performance:
{'acc': 0.960619, 'precision': 0.7197735, 'recall': 0.7485447, 'specificity': 0.7485447, 'f1': 0.73315555, 'auroc': 0.9412065, 'binary_precision': 0.45751634, 'binary_recall': 0.5200594, 'binary_specificity': 0.9770299, 'binary_f1_score': 0.48678717}
confusion matrix:
       0    1
0  17652  415
1    323  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91959393, 'precision': 0.5674645, 'recall': 0.59208065, 'specificity': 0.59208065, 'f1': 0.5770685, 'auroc': 0.8580429, 'binary_precision': 0.16897507, 'binary_recall': 0.23461539, 'binary_specificity': 0.9495459, 'binary_f1_score': 0.19645734}
confusion matrix:
      0    1
0  5646  300
1   199   61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-30 07:07:49.623047,epoch time: 0:23:41.328573,used: 0:48:10.115944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99194115, 'precision': 0.9931197, 'recall': 0.98558116, 'specificity': 0.98558116, 'f1': 0.989277, 'auroc': 0.9992107, 'binary_precision': 0.9954568, 'binary_recall': 0.97267115, 'binary_specificity': 0.9984911, 'binary_f1_score': 0.9839321}
confusion matrix:
       0      1
0  42351     64
1    394  14023
---- Validation: 
scalar performance:
{'acc': 0.9624333, 'precision': 0.731143, 'recall': 0.75878406, 'specificity': 0.75878406, 'f1': 0.744082, 'auroc': 0.9340315, 'binary_precision': 0.47952443, 'binary_recall': 0.5393759, 'binary_specificity': 0.97819227, 'binary_f1_score': 0.5076923}
confusion matrix:
       0    1
0  17673  394
1    310  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9311956, 'precision': 0.59980994, 'recall': 0.618364, 'specificity': 0.618364, 'f1': 0.608064, 'auroc': 0.89331937, 'binary_precision': 0.23151125, 'binary_recall': 0.2769231, 'binary_specificity': 0.9598049, 'binary_f1_score': 0.25218913}
confusion matrix:
      0    1
0  5707  239
1   188   72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-30 07:31:33.168820,epoch time: 0:23:43.545773,used: 1:11:53.661717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99399984, 'precision': 0.99584436, 'recall': 0.9883348, 'specificity': 0.9883348, 'f1': 0.99201727, 'auroc': 0.9995519, 'binary_precision': 0.99950325, 'binary_recall': 0.97683454, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.9880389}
confusion matrix:
       0      1
0  42407      7
1    334  14084
---- Validation: 
scalar performance:
{'acc': 0.958698, 'precision': 0.6784241, 'recall': 0.6173698, 'specificity': 0.6173698, 'f1': 0.6407107, 'auroc': 0.92106426, 'binary_precision': 0.38443935, 'binary_recall': 0.24962853, 'binary_specificity': 0.985111, 'binary_f1_score': 0.3027027}
confusion matrix:
       0    1
0  17798  269
1    505  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95294875, 'precision': 0.5628721, 'recall': 0.512021, 'specificity': 0.512021, 'f1': 0.5139119, 'auroc': 0.9150728, 'binary_precision': 0.16666667, 'binary_recall': 0.03076923, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.051948052}
confusion matrix:
      0   1
0  5906  40
1   252   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_4.png
new oracle model saved
early stop counter: 1
val acc:0.9586979746818542, best validation acc: 0.9624332785606384, corresponding to test acc:                         0.9311956167221069 / 0.9529487490653992
after epoch: 4,now: 2024-06-30 07:55:10.663362,epoch time: 0:23:37.494542,used: 1:35:31.156259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9955835, 'precision': 0.9968219, 'recall': 0.99152446, 'specificity': 0.99152446, 'f1': 0.99413717, 'auroc': 0.99965477, 'binary_precision': 0.9992951, 'binary_recall': 0.9832848, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.9912253}
confusion matrix:
       0      1
0  42404     10
1    241  14177
---- Validation: 
scalar performance:
{'acc': 0.9720918, 'precision': 0.8042861, 'recall': 0.7723764, 'specificity': 0.7723764, 'f1': 0.78735733, 'auroc': 0.95542574, 'binary_precision': 0.625, 'binary_recall': 0.5572065, 'binary_specificity': 0.9875464, 'binary_f1_score': 0.5891595}
confusion matrix:
       0    1
0  17842  225
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7854358, 'recall': 0.602742, 'specificity': 0.602742, 'f1': 0.6467043, 'auroc': 0.9462402, 'binary_precision': 0.6043956, 'binary_recall': 0.21153846, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.3133903}
confusion matrix:
      0   1
0  5910  36
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-30 08:18:51.035950,epoch time: 0:23:40.372588,used: 1:59:11.528847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99496764, 'precision': 0.99655575, 'recall': 0.99017406, 'specificity': 0.99017406, 'f1': 0.9933127, 'auroc': 0.9994489, 'binary_precision': 0.9997171, 'binary_recall': 0.98044246, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.989986}
confusion matrix:
       0      1
0  42409      4
1    282  14137
---- Validation: 
scalar performance:
{'acc': 0.9710246, 'precision': 0.8756229, 'recall': 0.63377637, 'specificity': 0.63377637, 'f1': 0.69323796, 'auroc': 0.94743747, 'binary_precision': 0.7777778, 'binary_recall': 0.2704309, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.401323}
confusion matrix:
       0    1
0  18015   52
1    491  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.9343679, 'recall': 0.5191467, 'specificity': 0.5191467, 'f1': 0.52656347, 'auroc': 0.95829, 'binary_precision': 0.90909094, 'binary_recall': 0.03846154, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.07380074}
confusion matrix:
      0   1
0  5945   1
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_6.png
early stop counter: 1
val acc:0.9710245728492737, best validation acc: 0.972091794013977, corresponding to test acc:                         0.9611666202545166 / 0.9611666202545166
after epoch: 6,now: 2024-06-30 08:42:28.283040,epoch time: 0:23:37.247090,used: 2:22:48.775937,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99426377, 'precision': 0.9905766, 'recall': 0.99437153, 'specificity': 0.99437153, 'f1': 0.99245507, 'auroc': 0.99972785, 'binary_precision': 0.98299974, 'binary_recall': 0.9945901, 'binary_specificity': 0.9941529, 'binary_f1_score': 0.98876095}
confusion matrix:
       0      1
0  42166    248
1     78  14340
---- Validation: 
scalar performance:
{'acc': 0.93345785, 'precision': 0.66586614, 'recall': 0.90683764, 'specificity': 0.90683764, 'f1': 0.7255216, 'auroc': 0.9549012, 'binary_precision': 0.33656037, 'binary_recall': 0.8781575, 'binary_specificity': 0.9355178, 'binary_f1_score': 0.48661998}
confusion matrix:
       0     1
0  16902  1165
1     82   591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90654206, 'precision': 0.6399557, 'recall': 0.87215126, 'specificity': 0.87215126, 'f1': 0.68856084, 'auroc': 0.9183367, 'binary_precision': 0.2877984, 'binary_recall': 0.8346154, 'binary_specificity': 0.90968716, 'binary_f1_score': 0.42800787}
confusion matrix:
      0    1
0  5409  537
1    43  217
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_7.png
early stop counter: 2
val acc:0.9334578514099121, best validation acc: 0.972091794013977, corresponding to test acc:                         0.9611666202545166 / 0.9611666202545166
after epoch: 7,now: 2024-06-30 09:06:08.440570,epoch time: 0:23:40.157530,used: 2:46:28.933467,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9971319, 'precision': 0.99741125, 'recall': 0.99501145, 'specificity': 0.99501145, 'f1': 0.9962039, 'auroc': 0.99982667, 'binary_precision': 0.99797404, 'binary_recall': 0.9907067, 'binary_specificity': 0.9993163, 'binary_f1_score': 0.99432707}
confusion matrix:
       0      1
0  42384     29
1    134  14285
---- Validation: 
scalar performance:
{'acc': 0.9721985, 'precision': 0.87722486, 'recall': 0.6558432, 'specificity': 0.6558432, 'f1': 0.7172085, 'auroc': 0.9542494, 'binary_precision': 0.7794118, 'binary_recall': 0.31500742, 'binary_specificity': 0.996679, 'binary_f1_score': 0.44867724}
confusion matrix:
       0    1
0  18007   60
1    461  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95520467, 'precision': 0.5562111, 'recall': 0.5058423, 'specificity': 0.5058423, 'f1': 0.502523, 'auroc': 0.92004776, 'binary_precision': 0.15384616, 'binary_recall': 0.015384615, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.027972028}
confusion matrix:
      0   1
0  5924  22
1   256   4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_8.png
better model found
persisted
after epoch: 8,now: 2024-06-30 09:29:38.693470,epoch time: 0:23:30.252900,used: 3:09:59.186367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99665684, 'precision': 0.9971394, 'recall': 0.9940294, 'specificity': 0.9940294, 'f1': 0.995572, 'auroc': 0.9996581, 'binary_precision': 0.99810964, 'binary_recall': 0.98869544, 'binary_specificity': 0.9993634, 'binary_f1_score': 0.99338025}
confusion matrix:
       0      1
0  42386     27
1    163  14256
---- Validation: 
scalar performance:
{'acc': 0.96643543, 'precision': 0.76466346, 'recall': 0.66358334, 'specificity': 0.66358334, 'f1': 0.7009621, 'auroc': 0.94988096, 'binary_precision': 0.55365855, 'binary_recall': 0.33729568, 'binary_specificity': 0.989871, 'binary_f1_score': 0.4192059}
confusion matrix:
       0    1
0  17884  183
1    446  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95278764, 'precision': 0.61416143, 'recall': 0.53216577, 'specificity': 0.53216577, 'f1': 0.5452754, 'auroc': 0.9341831, 'binary_precision': 0.26760563, 'binary_recall': 0.073076926, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.114803635}
confusion matrix:
      0   1
0  5894  52
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_9.png
early stop counter: 1
val acc:0.966435432434082, best validation acc: 0.972198486328125, corresponding to test acc:                         0.9552046656608582 / 0.9611666202545166
after epoch: 9,now: 2024-06-30 09:53:12.983754,epoch time: 0:23:34.290284,used: 3:33:33.476651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99560106, 'precision': 0.996999, 'recall': 0.9913995, 'specificity': 0.9913995, 'f1': 0.9941591, 'auroc': 0.99973035, 'binary_precision': 0.99978834, 'binary_recall': 0.9828698, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9912569}
confusion matrix:
       0      1
0  42410      3
1    247  14172
---- Validation: 
scalar performance:
{'acc': 0.9698506, 'precision': 0.9527817, 'recall': 0.58595985, 'specificity': 0.58595985, 'f1': 0.6378447, 'auroc': 0.9645808, 'binary_precision': 0.9354839, 'binary_recall': 0.17236255, 'binary_specificity': 0.9995572, 'binary_f1_score': 0.2910916}
confusion matrix:
       0    1
0  18059    8
1    557  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.97951615, 'recall': 0.51153845, 'specificity': 0.51153845, 'f1': 0.5121002, 'auroc': 0.9533448, 'binary_precision': 1.0, 'binary_recall': 0.023076924, 'binary_specificity': 1.0, 'binary_f1_score': 0.045112785}
confusion matrix:
      0  1
0  5946  0
1   254  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_10.png
early stop counter: 2
val acc:0.9698505997657776, best validation acc: 0.972198486328125, corresponding to test acc:                         0.9552046656608582 / 0.9611666202545166
after epoch: 10,now: 2024-06-30 10:16:31.150608,epoch time: 0:23:18.166854,used: 3:56:51.643505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9970967, 'precision': 0.9980155, 'recall': 0.99432415, 'specificity': 0.99432415, 'f1': 0.9961524, 'auroc': 0.99969506, 'binary_precision': 0.99985975, 'binary_recall': 0.98869544, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9942463}
confusion matrix:
       0      1
0  42411      2
1    163  14256
---- Validation: 
scalar performance:
{'acc': 0.9745998, 'precision': 0.84612966, 'recall': 0.7429207, 'specificity': 0.7429207, 'f1': 0.7846788, 'auroc': 0.9595225, 'binary_precision': 0.71092075, 'binary_recall': 0.49331352, 'binary_specificity': 0.99252784, 'binary_f1_score': 0.5824562}
confusion matrix:
       0    1
0  17932  135
1    341  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.66719913, 'recall': 0.51604635, 'specificity': 0.51604635, 'f1': 0.52072376, 'auroc': 0.90796316, 'binary_precision': 0.375, 'binary_recall': 0.034615386, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.063380286}
confusion matrix:
      0   1
0  5931  15
1   251   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_11.png
better model found
persisted
after epoch: 11,now: 2024-06-30 10:39:51.820282,epoch time: 0:23:20.669674,used: 4:20:12.313179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9944398, 'precision': 0.99630225, 'recall': 0.9890422, 'specificity': 0.9890422, 'f1': 0.99260473, 'auroc': 0.99973005, 'binary_precision': 1.0, 'binary_recall': 0.97808444, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889208}
confusion matrix:
       0      1
0  42413      0
1    316  14103
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.84791106, 'recall': 0.51392215, 'specificity': 0.51392215, 'f1': 0.5181961, 'auroc': 0.9651282, 'binary_precision': 0.7307692, 'binary_recall': 0.028231798, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.054363377}
confusion matrix:
       0   1
0  18060   7
1    654  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.77927756, 'recall': 0.50560105, 'specificity': 0.50560105, 'f1': 0.5006597, 'auroc': 0.92434716, 'binary_precision': 0.6, 'binary_recall': 0.011538462, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.02264151}
confusion matrix:
      0  1
0  5944  2
1   257  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_12.png
early stop counter: 1
val acc:0.9647278785705566, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9571382403373718 / 0.9611666202545166
after epoch: 12,now: 2024-06-30 11:03:17.813534,epoch time: 0:23:25.993252,used: 4:43:38.306431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99737823, 'precision': 0.9976456, 'recall': 0.99542826, 'specificity': 0.99542826, 'f1': 0.9965306, 'auroc': 0.999827, 'binary_precision': 0.9981846, 'binary_recall': 0.99146956, 'binary_specificity': 0.99938697, 'binary_f1_score': 0.99481577}
confusion matrix:
       0      1
0  42387     26
1    123  14296
---- Validation: 
scalar performance:
{'acc': 0.9727855, 'precision': 0.8734237, 'recall': 0.670453, 'specificity': 0.670453, 'f1': 0.73120785, 'auroc': 0.94659007, 'binary_precision': 0.7707641, 'binary_recall': 0.3447251, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.476386}
confusion matrix:
       0    1
0  17998   69
1    441  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.52075934, 'recall': 0.5009981, 'specificity': 0.5009981, 'f1': 0.4925562, 'auroc': 0.92249525, 'binary_precision': 0.083333336, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99815, 'binary_f1_score': 0.007352941}
confusion matrix:
      0   1
0  5935  11
1   259   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_13.png
early stop counter: 2
val acc:0.972785472869873, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9571382403373718 / 0.9611666202545166
after epoch: 13,now: 2024-06-30 11:26:58.280586,epoch time: 0:23:40.467052,used: 5:07:18.773483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9959354, 'precision': 0.99707925, 'recall': 0.9921952, 'specificity': 0.9921952, 'f1': 0.9946066, 'auroc': 0.99973893, 'binary_precision': 0.9993664, 'binary_recall': 0.9846026, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.9919296}
confusion matrix:
       0      1
0  42405      9
1    222  14196
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.7440493, 'recall': 0.68198234, 'specificity': 0.68198234, 'f1': 0.70797807, 'auroc': 0.9313842, 'binary_precision': 0.5110664, 'binary_recall': 0.37741455, 'binary_specificity': 0.9865501, 'binary_f1_score': 0.43418804}
confusion matrix:
       0    1
0  17824  243
1    419  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9431196, 'precision': 0.5160313, 'recall': 0.50689155, 'specificity': 0.50689155, 'f1': 0.5070244, 'auroc': 0.8044041, 'binary_precision': 0.07339449, 'binary_recall': 0.03076923, 'binary_specificity': 0.9830138, 'binary_f1_score': 0.043360434}
confusion matrix:
      0    1
0  5845  101
1   252    8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_14.png
early stop counter: 3
val acc:0.9646744728088379, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9571382403373718 / 0.9611666202545166
after epoch: 14,now: 2024-06-30 11:50:27.871924,epoch time: 0:23:29.591338,used: 5:30:48.364821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99678, 'precision': 0.99778146, 'recall': 0.9937233, 'specificity': 0.9937233, 'f1': 0.99573123, 'auroc': 0.9997643, 'binary_precision': 0.99978936, 'binary_recall': 0.98751736, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.99361545}
confusion matrix:
       0      1
0  42409      3
1    180  14240
---- Validation: 
scalar performance:
{'acc': 0.9704376, 'precision': 0.90975934, 'recall': 0.607007, 'specificity': 0.607007, 'f1': 0.6642401, 'auroc': 0.9437865, 'binary_precision': 0.8479532, 'binary_recall': 0.2154532, 'binary_specificity': 0.9985609, 'binary_f1_score': 0.3436019}
confusion matrix:
       0    1
0  18041   26
1    528  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7919289, 'recall': 0.5093631, 'specificity': 0.5093631, 'f1': 0.50803417, 'auroc': 0.93756664, 'binary_precision': 0.625, 'binary_recall': 0.01923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.03731343}
confusion matrix:
      0  1
0  5943  3
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_15.png
early stop counter: 4
val acc:0.9704375863075256, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9571382403373718 / 0.9611666202545166
after epoch: 15,now: 2024-06-30 12:14:06.379284,epoch time: 0:23:38.507360,used: 5:54:26.872181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99730784, 'precision': 0.9979462, 'recall': 0.99494624, 'specificity': 0.99494624, 'f1': 0.9964347, 'auroc': 0.99985623, 'binary_precision': 0.99923015, 'binary_recall': 0.9901519, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.9946703}
confusion matrix:
       0      1
0  42402     11
1    142  14277
---- Validation: 
scalar performance:
{'acc': 0.972572, 'precision': 0.8969567, 'recall': 0.6503148, 'specificity': 0.6503148, 'f1': 0.7142283, 'auroc': 0.95715845, 'binary_precision': 0.8192771, 'binary_recall': 0.30312034, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.44251627}
confusion matrix:
       0    1
0  18022   45
1    469  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.5902946, 'recall': 0.5032575, 'specificity': 0.5032575, 'f1': 0.4965233, 'auroc': 0.9314734, 'binary_precision': 0.22222222, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.014869888}
confusion matrix:
      0  1
0  5939  7
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_16.png
early stop counter: 5
val acc:0.9725720286369324, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9571382403373718 / 0.9611666202545166
after epoch: 16,now: 2024-06-30 12:38:08.130011,epoch time: 0:24:01.750727,used: 6:18:28.622908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9963929, 'precision': 0.9949349, 'recall': 0.9955461, 'specificity': 0.9955461, 'f1': 0.99524003, 'auroc': 0.99976957, 'binary_precision': 0.9919695, 'binary_recall': 0.99382716, 'binary_specificity': 0.99726504, 'binary_f1_score': 0.9928975}
confusion matrix:
       0      1
0  42298    116
1     89  14329
---- Validation: 
scalar performance:
{'acc': 0.82657415, 'precision': 0.5709621, 'recall': 0.8235097, 'specificity': 0.8235097, 'f1': 0.5777248, 'auroc': 0.90170944, 'binary_precision': 0.14995925, 'binary_recall': 0.820208, 'binary_specificity': 0.8268113, 'binary_f1_score': 0.25355995}
confusion matrix:
       0     1
0  14938  3129
1    121   552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8894618, 'precision': 0.57688737, 'recall': 0.683017, 'specificity': 0.683017, 'f1': 0.5989306, 'auroc': 0.83536315, 'binary_precision': 0.17921686, 'binary_recall': 0.4576923, 'binary_specificity': 0.90834177, 'binary_f1_score': 0.25757575}
confusion matrix:
      0    1
0  5401  545
1   141  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_17.png
early stop counter: 6
val acc:0.8265741467475891, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9571382403373718 / 0.9611666202545166
after epoch: 17,now: 2024-06-30 13:01:52.456396,epoch time: 0:23:44.326385,used: 6:42:12.949293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99714947, 'precision': 0.9975618, 'recall': 0.9949088, 'specificity': 0.9949088, 'f1': 0.9962263, 'auroc': 0.99979943, 'binary_precision': 0.9983919, 'binary_recall': 0.99035996, 'binary_specificity': 0.9994577, 'binary_f1_score': 0.99435973}
confusion matrix:
       0      1
0  42390     23
1    139  14280
---- Validation: 
scalar performance:
{'acc': 0.97310567, 'precision': 0.8382724, 'recall': 0.718542, 'specificity': 0.718542, 'f1': 0.7643976, 'auroc': 0.95636463, 'binary_precision': 0.6969697, 'binary_recall': 0.44427934, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.5426497}
confusion matrix:
       0    1
0  17937  130
1    374  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.79140025, 'recall': 0.5580177, 'specificity': 0.5580177, 'f1': 0.58975375, 'auroc': 0.9304068, 'binary_precision': 0.62, 'binary_recall': 0.11923077, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.20000002}
confusion matrix:
      0   1
0  5927  19
1   229  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_18.png
early stop counter: 7
val acc:0.9731056690216064, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9571382403373718 / 0.9611666202545166
after epoch: 18,now: 2024-06-30 13:25:49.675504,epoch time: 0:23:57.219108,used: 7:06:10.168401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99741346, 'precision': 0.99780786, 'recall': 0.9953603, 'specificity': 0.9953603, 'f1': 0.9965764, 'auroc': 0.9997959, 'binary_precision': 0.99860257, 'binary_recall': 0.99119216, 'binary_specificity': 0.99952847, 'binary_f1_score': 0.99488354}
confusion matrix:
       0      1
0  42393     20
1    127  14292
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.78596, 'recall': 0.6737951, 'specificity': 0.6737951, 'f1': 0.7148624, 'auroc': 0.94566345, 'binary_precision': 0.5955335, 'binary_recall': 0.35661218, 'binary_specificity': 0.990978, 'binary_f1_score': 0.44609663}
confusion matrix:
       0    1
0  17904  163
1    433  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9429584, 'precision': 0.5575189, 'recall': 0.5307142, 'specificity': 0.5307142, 'f1': 0.5382999, 'auroc': 0.86381406, 'binary_precision': 0.15441176, 'binary_recall': 0.08076923, 'binary_specificity': 0.98065925, 'binary_f1_score': 0.1060606}
confusion matrix:
      0    1
0  5831  115
1   239   21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_19.png
early stop counter: 8
val acc:0.9681963920593262, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9571382403373718 / 0.9611666202545166
after epoch: 19,now: 2024-06-30 13:50:12.114727,epoch time: 0:24:22.439223,used: 7:30:32.607624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99792373, 'precision': 0.99803436, 'recall': 0.99648035, 'specificity': 0.99648035, 'f1': 0.99725425, 'auroc': 0.99992037, 'binary_precision': 0.99825794, 'binary_recall': 0.9935502, 'binary_specificity': 0.99941057, 'binary_f1_score': 0.9958985}
confusion matrix:
       0      1
0  42388     25
1     93  14326
---- Validation: 
scalar performance:
{'acc': 0.97604054, 'precision': 0.8289237, 'recall': 0.8209168, 'specificity': 0.8209168, 'f1': 0.82486594, 'auroc': 0.96670485, 'binary_precision': 0.6707317, 'binary_recall': 0.653789, 'binary_specificity': 0.9880445, 'binary_f1_score': 0.662152}
confusion matrix:
       0    1
0  17851  216
1    233  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.79712343, 'recall': 0.6011553, 'specificity': 0.6011553, 'f1': 0.6462069, 'auroc': 0.955951, 'binary_precision': 0.627907, 'binary_recall': 0.20769231, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.3121387}
confusion matrix:
      0   1
0  5914  32
1   206  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_20.png
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-06-30 14:14:49.085011,epoch time: 0:24:36.970284,used: 7:55:09.577908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9984692, 'precision': 0.9983319, 'recall': 0.99762386, 'specificity': 0.99762386, 'f1': 0.9979772, 'auroc': 0.99986327, 'binary_precision': 0.9980538, 'binary_recall': 0.9959079, 'binary_specificity': 0.9993398, 'binary_f1_score': 0.9969797}
confusion matrix:
       0      1
0  42386     28
1     59  14359
---- Validation: 
scalar performance:
{'acc': 0.9707044, 'precision': 0.7967738, 'recall': 0.7459073, 'specificity': 0.7459073, 'f1': 0.7687118, 'auroc': 0.9627979, 'binary_precision': 0.6119134, 'binary_recall': 0.5037147, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.55256724}
confusion matrix:
       0    1
0  17852  215
1    334  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95278764, 'precision': 0.6383398, 'recall': 0.54871666, 'specificity': 0.54871666, 'f1': 0.56808466, 'auroc': 0.9160698, 'binary_precision': 0.31460676, 'binary_recall': 0.10769231, 'binary_specificity': 0.989741, 'binary_f1_score': 0.16045846}
confusion matrix:
      0   1
0  5885  61
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_21.png
early stop counter: 1
val acc:0.9707043766975403, best validation acc: 0.9760405421257019, corresponding to test acc:                         0.961650013923645 / 0.961650013923645
after epoch: 21,now: 2024-06-30 14:39:12.850009,epoch time: 0:24:23.764998,used: 8:19:33.342906,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.995777, 'precision': 0.9971629, 'recall': 0.9917011, 'specificity': 0.9917011, 'f1': 0.99439377, 'auroc': 0.99973464, 'binary_precision': 0.9999295, 'binary_recall': 0.9834258, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.991609}
confusion matrix:
       0      1
0  42411      1
1    239  14181
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.89851093, 'recall': 0.5980364, 'specificity': 0.5980364, 'f1': 0.65172255, 'auroc': 0.9415163, 'binary_precision': 0.82608694, 'binary_recall': 0.19762258, 'binary_specificity': 0.9984502, 'binary_f1_score': 0.3189448}
confusion matrix:
       0    1
0  18039   28
1    540  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9080843, 'recall': 0.51145434, 'specificity': 0.51145434, 'f1': 0.5119738, 'auroc': 0.9127345, 'binary_precision': 0.85714287, 'binary_recall': 0.023076924, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.04494382}
confusion matrix:
      0  1
0  5945  1
1   254  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_22.png
early stop counter: 2
val acc:0.9696905016899109, best validation acc: 0.9760405421257019, corresponding to test acc:                         0.961650013923645 / 0.961650013923645
after epoch: 22,now: 2024-06-30 15:03:40.409550,epoch time: 0:24:27.559541,used: 8:44:00.902447,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99649847, 'precision': 0.9976649, 'recall': 0.99309987, 'specificity': 0.99309987, 'f1': 0.9953557, 'auroc': 0.99992573, 'binary_precision': 1.0, 'binary_recall': 0.98619974, 'binary_specificity': 1.0, 'binary_f1_score': 0.99305195}
confusion matrix:
       0      1
0  42412      0
1    199  14221
---- Validation: 
scalar performance:
{'acc': 0.96931696, 'precision': 0.95350415, 'recall': 0.5778152, 'specificity': 0.5778152, 'f1': 0.6259231, 'auroc': 0.9703387, 'binary_precision': 0.9375, 'binary_recall': 0.15601783, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.26751593}
confusion matrix:
       0    1
0  18060    7
1    568  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.60411966, 'recall': 0.5016708, 'specificity': 0.5016708, 'f1': 0.4930042, 'auroc': 0.94388455, 'binary_precision': 0.25, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5943  3
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_23.png
early stop counter: 3
val acc:0.9693169593811035, best validation acc: 0.9760405421257019, corresponding to test acc:                         0.961650013923645 / 0.961650013923645
after epoch: 23,now: 2024-06-30 15:28:02.715457,epoch time: 0:24:22.305907,used: 9:08:23.208354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9974838, 'precision': 0.9963738, 'recall': 0.99698675, 'specificity': 0.99698675, 'f1': 0.9966798, 'auroc': 0.99990785, 'binary_precision': 0.994116, 'binary_recall': 0.9959775, 'binary_specificity': 0.9979959, 'binary_f1_score': 0.9950459}
confusion matrix:
       0      1
0  42328     85
1     58  14361
---- Validation: 
scalar performance:
{'acc': 0.97577375, 'precision': 0.8266095, 'recall': 0.8200631, 'specificity': 0.8200631, 'f1': 0.8232999, 'auroc': 0.96491814, 'binary_precision': 0.6661608, 'binary_recall': 0.6523031, 'binary_specificity': 0.9878231, 'binary_f1_score': 0.6591592}
confusion matrix:
       0    1
0  17847  220
1    234  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7299417, 'recall': 0.52206784, 'specificity': 0.52206784, 'f1': 0.53153455, 'auroc': 0.9290494, 'binary_precision': 0.5, 'binary_recall': 0.046153847, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.08450705}
confusion matrix:
      0   1
0  5934  12
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_24.png
early stop counter: 4
val acc:0.9757737517356873, best validation acc: 0.9760405421257019, corresponding to test acc:                         0.961650013923645 / 0.961650013923645
after epoch: 24,now: 2024-06-30 15:52:15.269110,epoch time: 0:24:12.553653,used: 9:32:35.762007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99860996, 'precision': 0.99844944, 'recall': 0.99787855, 'specificity': 0.99787855, 'f1': 0.9981636, 'auroc': 0.9999408, 'binary_precision': 0.99812424, 'binary_recall': 0.9963936, 'binary_specificity': 0.9993634, 'binary_f1_score': 0.9972582}
confusion matrix:
       0      1
0  42386     27
1     52  14367
---- Validation: 
scalar performance:
{'acc': 0.97860193, 'precision': 0.9075842, 'recall': 0.75071836, 'specificity': 0.75071836, 'f1': 0.80901515, 'auroc': 0.96484655, 'binary_precision': 0.8333333, 'binary_recall': 0.50520056, 'binary_specificity': 0.9962362, 'binary_f1_score': 0.62904716}
confusion matrix:
       0    1
0  17999   68
1    333  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.70186025, 'recall': 0.5145437, 'specificity': 0.5145437, 'f1': 0.5179809, 'auroc': 0.91348755, 'binary_precision': 0.44444445, 'binary_recall': 0.03076923, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.05755396}
confusion matrix:
      0   1
0  5936  10
1   252   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_25.png
better model found
persisted
after epoch: 25,now: 2024-06-30 16:16:10.676116,epoch time: 0:23:55.407006,used: 9:56:31.169013,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99808204, 'precision': 0.9985327, 'recall': 0.99640334, 'specificity': 0.99640334, 'f1': 0.9974623, 'auroc': 0.9999057, 'binary_precision': 0.99944156, 'binary_recall': 0.9929954, 'binary_specificity': 0.99981135, 'binary_f1_score': 0.9962081}
confusion matrix:
       0      1
0  42405      8
1    101  14318
---- Validation: 
scalar performance:
{'acc': 0.97411954, 'precision': 0.9472107, 'recall': 0.6525479, 'specificity': 0.6525479, 'f1': 0.7230257, 'auroc': 0.9645175, 'binary_precision': 0.91964287, 'binary_recall': 0.3060921, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.4593088}
confusion matrix:
       0    1
0  18049   18
1    467  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.9389287, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_26.png
early stop counter: 1
val acc:0.9741195440292358, best validation acc: 0.9786019325256348, corresponding to test acc:                         0.9577828049659729 / 0.961650013923645
after epoch: 26,now: 2024-06-30 16:39:53.674731,epoch time: 0:23:42.998615,used: 10:20:14.167628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99820524, 'precision': 0.99870765, 'recall': 0.99655455, 'specificity': 0.99655455, 'f1': 0.9976251, 'auroc': 0.9999496, 'binary_precision': 0.99972075, 'binary_recall': 0.9932034, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9964514}
confusion matrix:
       0      1
0  42409      4
1     98  14321
---- Validation: 
scalar performance:
{'acc': 0.97395945, 'precision': 0.8213727, 'recall': 0.7797824, 'specificity': 0.7797824, 'f1': 0.79899657, 'auroc': 0.95874274, 'binary_precision': 0.6586621, 'binary_recall': 0.57057947, 'binary_specificity': 0.9889854, 'binary_f1_score': 0.6114649}
confusion matrix:
       0    1
0  17868  199
1    289  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550435, 'precision': 0.69990647, 'recall': 0.61058044, 'specificity': 0.61058044, 'f1': 0.6405053, 'auroc': 0.90502065, 'binary_precision': 0.4326241, 'binary_recall': 0.23461539, 'binary_specificity': 0.98654556, 'binary_f1_score': 0.3042394}
confusion matrix:
      0   1
0  5866  80
1   199  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_27.png
early stop counter: 2
val acc:0.9739594459533691, best validation acc: 0.9786019325256348, corresponding to test acc:                         0.9577828049659729 / 0.961650013923645
after epoch: 27,now: 2024-06-30 17:03:36.756097,epoch time: 0:23:43.081366,used: 10:43:57.248994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99765974, 'precision': 0.9984369, 'recall': 0.9953884, 'specificity': 0.9953884, 'f1': 0.9969008, 'auroc': 0.9999083, 'binary_precision': 1.0, 'binary_recall': 0.9907767, 'binary_specificity': 1.0, 'binary_f1_score': 0.995367}
confusion matrix:
       0      1
0  42412      0
1    133  14287
---- Validation: 
scalar performance:
{'acc': 0.9725187, 'precision': 0.94020915, 'recall': 0.63025963, 'specificity': 0.63025963, 'f1': 0.6959658, 'auroc': 0.9601944, 'binary_precision': 0.9072165, 'binary_recall': 0.2615156, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.4059977}
confusion matrix:
       0    1
0  18049   18
1    497  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.8796643, 'recall': 0.51521647, 'specificity': 0.51521647, 'f1': 0.5191701, 'auroc': 0.932562, 'binary_precision': 0.8, 'binary_recall': 0.03076923, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.05925926}
confusion matrix:
      0  1
0  5944  2
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_28.png
early stop counter: 3
val acc:0.9725186824798584, best validation acc: 0.9786019325256348, corresponding to test acc:                         0.9577828049659729 / 0.961650013923645
after epoch: 28,now: 2024-06-30 17:27:18.215436,epoch time: 0:23:41.459339,used: 11:07:38.708333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99818766, 'precision': 0.99874234, 'recall': 0.99647385, 'specificity': 0.99647385, 'f1': 0.99760145, 'auroc': 0.9999372, 'binary_precision': 0.99986035, 'binary_recall': 0.99299484, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.99641573}
confusion matrix:
       0      1
0  42412      2
1    101  14317
---- Validation: 
scalar performance:
{'acc': 0.97508, 'precision': 0.9655341, 'recall': 0.66019875, 'specificity': 0.66019875, 'f1': 0.73388386, 'auroc': 0.9653256, 'binary_precision': 0.9557522, 'binary_recall': 0.32095096, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.48053393}
confusion matrix:
       0    1
0  18057   10
1    457  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6457897, 'recall': 0.5017549, 'specificity': 0.5017549, 'f1': 0.49306068, 'auroc': 0.9538494, 'binary_precision': 0.33333334, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5944  2
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_29.png
early stop counter: 4
val acc:0.9750800132751465, best validation acc: 0.9786019325256348, corresponding to test acc:                         0.9577828049659729 / 0.961650013923645
after epoch: 29,now: 2024-06-30 17:51:19.446966,epoch time: 0:24:01.231530,used: 11:31:39.939863,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99588263, 'precision': 0.99267673, 'recall': 0.9965319, 'specificity': 0.9965319, 'f1': 0.9945848, 'auroc': 0.9999294, 'binary_precision': 0.9860873, 'binary_recall': 0.99785006, 'binary_specificity': 0.99521375, 'binary_f1_score': 0.9919338}
confusion matrix:
       0      1
0  42210    203
1     31  14388
---- Validation: 
scalar performance:
{'acc': 0.94210243, 'precision': 0.6712671, 'recall': 0.84194005, 'specificity': 0.84194005, 'f1': 0.72298014, 'auroc': 0.9419349, 'binary_precision': 0.35285714, 'binary_recall': 0.73402673, 'binary_specificity': 0.9498533, 'binary_f1_score': 0.47660393}
confusion matrix:
       0    1
0  17161  906
1    179  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9545601, 'precision': 0.70033133, 'recall': 0.6268791, 'specificity': 0.6268791, 'f1': 0.654117, 'auroc': 0.924493, 'binary_precision': 0.43209878, 'binary_recall': 0.26923078, 'binary_specificity': 0.9845274, 'binary_f1_score': 0.33175355}
confusion matrix:
      0   1
0  5854  92
1   190  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_30.png
early stop counter: 5
val acc:0.9421024322509766, best validation acc: 0.9786019325256348, corresponding to test acc:                         0.9577828049659729 / 0.961650013923645
after epoch: 30,now: 2024-06-30 18:15:48.580287,epoch time: 0:24:29.133321,used: 11:56:09.073184,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_06_19_39_seed_1_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:56:09.073184 at 2024-06-30 18:15:48.580287
persisted model performance metric: 

scalar performance:
{'acc': 0.9577828, 'precision': 0.70186025, 'recall': 0.5145437, 'specificity': 0.5145437, 'f1': 0.5179809, 'auroc': 0.91348755, 'binary_precision': 0.44444445, 'binary_recall': 0.03076923, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.05755396}
confusion matrix:
      0   1
0  5936  10
1   252   8
oracle model performance metric: 

scalar performance:
{'acc': 0.96165, 'precision': 0.79712343, 'recall': 0.6011553, 'specificity': 0.6011553, 'f1': 0.6462069, 'auroc': 0.955951, 'binary_precision': 0.627907, 'binary_recall': 0.20769231, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.3121387}
confusion matrix:
      0   1
0  5914  32
1   206  54
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 368857 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool | 337010 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |  31847 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 368857 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool | 337010 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |  31847 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362638 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |  30848 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10006 MiB |  10022 MiB |  19318 MiB |   9312 MiB |
|       from large pool |   9950 MiB |   9962 MiB |  19240 MiB |   9290 MiB |
|       from small pool |     56 MiB |     60 MiB |     78 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 386854 KiB |    876 MiB |   1755 TiB |   1755 TiB |
|       from large pool | 377742 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |   9112 KiB |     30 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3293    |    7964    |  441871 K  |  441868 K  |
|       from large pool |     151    |     986    |  226164 K  |  226164 K  |
|       from small pool |    3142    |    7811    |  215706 K  |  215703 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3293    |    7964    |  441871 K  |  441868 K  |
|       from large pool |     151    |     986    |  226164 K  |  226164 K  |
|       from small pool |    3142    |    7811    |  215706 K  |  215703 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     443    |     445    |     839    |     396    |
|       from large pool |     415    |     415    |     800    |     385    |
|       from small pool |      28    |      30    |      39    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3613    |  285764 K  |  285763 K  |
|       from large pool |      35    |     417    |  181913 K  |  181913 K  |
|       from small pool |      36    |    3582    |  103850 K  |  103850 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |      0 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  19318 MiB |  18580 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  19240 MiB |  18542 MiB |
|       from small pool |  40960 KiB |     60 MiB |     78 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |   1755 TiB |   1755 TiB |
|       from large pool |  24320 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |      0 KiB |     32 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  441871 K  |  441871 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215706 K  |  215706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  441871 K  |  441871 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215706 K  |  215706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |     839    |     788    |
|       from large pool |      31    |     415    |     800    |     769    |
|       from small pool |      20    |      30    |      39    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3613    |  285765 K  |  285765 K  |
|       from large pool |       3    |     417    |  181913 K  |  181913 K  |
|       from small pool |       0    |    3582    |  103851 K  |  103851 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |      0 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  19318 MiB |  18580 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  19240 MiB |  18542 MiB |
|       from small pool |  40960 KiB |     60 MiB |     78 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |   1755 TiB |   1755 TiB |
|       from large pool |  24320 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |      0 KiB |     32 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  441871 K  |  441871 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215706 K  |  215706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  441871 K  |  441871 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215706 K  |  215706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |     839    |     788    |
|       from large pool |      31    |     415    |     800    |     769    |
|       from small pool |      20    |      30    |      39    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3613    |  285765 K  |  285765 K  |
|       from large pool |       3    |     417    |  181913 K  |  181913 K  |
|       from small pool |       0    |    3582    |  103851 K  |  103851 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983

 Experiment start at: 2024-06-30 18:23:51.409913
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9909645, 'precision': 0.9896832, 'recall': 0.9869884, 'specificity': 0.9869884, 'f1': 0.98832566, 'auroc': 0.9989441, 'binary_precision': 0.9870009, 'binary_recall': 0.9785856, 'binary_specificity': 0.9953912, 'binary_f1_score': 0.9827753}
confusion matrix:
       0      1
0  42115    195
1    324  14806
---- Validation: 
scalar performance:
{'acc': 0.9615938, 'precision': 0.7141452, 'recall': 0.83641505, 'specificity': 0.83641505, 'f1': 0.7599228, 'auroc': 0.93352675, 'binary_precision': 0.43834198, 'binary_recall': 0.7026578, 'binary_specificity': 0.9701722, 'binary_f1_score': 0.5398851}
confusion matrix:
       0    1
0  17629  542
1    179  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95095366, 'precision': 0.7036633, 'recall': 0.8277644, 'specificity': 0.8277644, 'f1': 0.7487556, 'auroc': 0.90634006, 'binary_precision': 0.42, 'binary_recall': 0.6942149, 'binary_specificity': 0.96131396, 'binary_f1_score': 0.5233645}
confusion matrix:
      0    1
0  5765  232
1    74  168
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-30 18:49:09.516101,epoch time: 0:25:18.106188,used: 0:25:18.106188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99371517, 'precision': 0.9951045, 'recall': 0.98870695, 'specificity': 0.98870695, 'f1': 0.99184954, 'auroc': 0.99965686, 'binary_precision': 0.99797696, 'binary_recall': 0.97812295, 'binary_specificity': 0.99929094, 'binary_f1_score': 0.9879502}
confusion matrix:
       0      1
0  42280     30
1    331  14799
---- Validation: 
scalar performance:
{'acc': 0.97293985, 'precision': 0.7881764, 'recall': 0.74350107, 'specificity': 0.74350107, 'f1': 0.7637874, 'auroc': 0.9493742, 'binary_precision': 0.5928854, 'binary_recall': 0.49833888, 'binary_specificity': 0.98866326, 'binary_f1_score': 0.5415163}
confusion matrix:
       0    1
0  17965  206
1    302  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.8325236, 'recall': 0.6420435, 'specificity': 0.6420435, 'f1': 0.69571733, 'auroc': 0.9182923, 'binary_precision': 0.6930693, 'binary_recall': 0.2892562, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.40816325}
confusion matrix:
      0   1
0  5966  31
1   172  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-30 19:13:51.705948,epoch time: 0:24:42.189847,used: 0:50:00.296035,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9944638, 'precision': 0.9953683, 'recall': 0.99036145, 'specificity': 0.99036145, 'f1': 0.9928305, 'auroc': 0.99953985, 'binary_precision': 0.9972472, 'binary_recall': 0.981692, 'binary_specificity': 0.99903095, 'binary_f1_score': 0.9894085}
confusion matrix:
       0      1
0  42269     41
1    277  14853
---- Validation: 
scalar performance:
{'acc': 0.9752836, 'precision': 0.87281084, 'recall': 0.66280085, 'specificity': 0.66280085, 'f1': 0.72390866, 'auroc': 0.95223427, 'binary_precision': 0.76744187, 'binary_recall': 0.32890365, 'binary_specificity': 0.996698, 'binary_f1_score': 0.4604651}
confusion matrix:
       0    1
0  18111   60
1    404  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7306798, 'recall': 0.50198275, 'specificity': 0.50198275, 'f1': 0.4942079, 'auroc': 0.92623246, 'binary_precision': 0.5, 'binary_recall': 0.004132231, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.008196721}
confusion matrix:
      0  1
0  5996  1
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_3.png
better model found
persisted
after epoch: 3,now: 2024-06-30 19:38:25.830772,epoch time: 0:24:34.124824,used: 1:14:34.420859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9956825, 'precision': 0.99669224, 'recall': 0.9921865, 'specificity': 0.9921865, 'f1': 0.9944116, 'auroc': 0.9996978, 'binary_precision': 0.9987934, 'binary_recall': 0.98479843, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.9917466}
confusion matrix:
       0      1
0  42292     18
1    230  14900
---- Validation: 
scalar performance:
{'acc': 0.9709157, 'precision': 0.77192926, 'recall': 0.70230305, 'specificity': 0.70230305, 'f1': 0.73152626, 'auroc': 0.93346995, 'binary_precision': 0.5630631, 'binary_recall': 0.4152824, 'binary_specificity': 0.9893237, 'binary_f1_score': 0.47801146}
confusion matrix:
       0    1
0  17977  194
1    352  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.62931365, 'recall': 0.5149448, 'specificity': 0.5149448, 'f1': 0.5193786, 'auroc': 0.84578604, 'binary_precision': 0.2962963, 'binary_recall': 0.03305785, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.059479557}
confusion matrix:
      0   1
0  5978  19
1   234   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_4.png
early stop counter: 1
val acc:0.970915675163269, best validation acc: 0.9752836227416992, corresponding to test acc:                         0.9612117409706116 / 0.9674627184867859
after epoch: 4,now: 2024-06-30 20:02:59.704228,epoch time: 0:24:33.873456,used: 1:39:08.294315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99639624, 'precision': 0.9969791, 'recall': 0.99373245, 'specificity': 0.99373245, 'f1': 0.99534136, 'auroc': 0.99970776, 'binary_precision': 0.99819726, 'binary_recall': 0.9881031, 'binary_specificity': 0.9993619, 'binary_f1_score': 0.99312454}
confusion matrix:
       0      1
0  42283     27
1    180  14950
---- Validation: 
scalar performance:
{'acc': 0.97698826, 'precision': 0.8595378, 'recall': 0.71668255, 'specificity': 0.71668255, 'f1': 0.7690961, 'auroc': 0.95436466, 'binary_precision': 0.73743016, 'binary_recall': 0.4385382, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.54999995}
confusion matrix:
       0    1
0  18077   94
1    338  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.69790995, 'recall': 0.5430367, 'specificity': 0.5430367, 'f1': 0.56486785, 'auroc': 0.890166, 'binary_precision': 0.43137255, 'binary_recall': 0.09090909, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.15017065}
confusion matrix:
      0   1
0  5968  29
1   220  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_5.png
better model found
persisted
after epoch: 5,now: 2024-06-30 20:27:45.789002,epoch time: 0:24:46.084774,used: 2:03:54.379089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99474233, 'precision': 0.9957964, 'recall': 0.99065673, 'specificity': 0.99065673, 'f1': 0.99319035, 'auroc': 0.9995396, 'binary_precision': 0.99798495, 'binary_recall': 0.98202246, 'binary_specificity': 0.99929094, 'binary_f1_score': 0.9899394}
confusion matrix:
       0      1
0  42280     30
1    272  14858
---- Validation: 
scalar performance:
{'acc': 0.9738454, 'precision': 0.8962314, 'recall': 0.61789024, 'specificity': 0.61789024, 'f1': 0.67736435, 'auroc': 0.9567855, 'binary_precision': 0.81714284, 'binary_recall': 0.23754153, 'binary_specificity': 0.998239, 'binary_f1_score': 0.36808234}
confusion matrix:
       0    1
0  18139   32
1    459  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.6474853, 'recall': 0.5056981, 'specificity': 0.5056981, 'f1': 0.5019334, 'auroc': 0.9273614, 'binary_precision': 0.33333334, 'binary_recall': 0.012396694, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.023904383}
confusion matrix:
      0  1
0  5991  6
1   239  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_6.png
early stop counter: 1
val acc:0.9738454222679138, best validation acc: 0.9769882559776306, corresponding to test acc:                         0.9600897431373596 / 0.9674627184867859
after epoch: 6,now: 2024-06-30 20:52:24.528895,epoch time: 0:24:38.739893,used: 2:28:33.118982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9958914, 'precision': 0.99685484, 'recall': 0.9925618, 'specificity': 0.9925618, 'f1': 0.9946831, 'auroc': 0.99962914, 'binary_precision': 0.9988612, 'binary_recall': 0.9855254, 'binary_specificity': 0.9995982, 'binary_f1_score': 0.9921485}
confusion matrix:
       0      1
0  42293     17
1    219  14911
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.7392466, 'recall': 0.7967702, 'specificity': 0.7967702, 'f1': 0.7645661, 'auroc': 0.9476452, 'binary_precision': 0.49136788, 'binary_recall': 0.61461794, 'binary_specificity': 0.9789225, 'binary_f1_score': 0.5461254}
confusion matrix:
       0    1
0  17788  383
1    232  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.6991846, 'recall': 0.56261396, 'specificity': 0.56261396, 'f1': 0.59090567, 'auroc': 0.8744243, 'binary_precision': 0.43243244, 'binary_recall': 0.1322314, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.20253164}
confusion matrix:
      0   1
0  5955  42
1   210  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_7.png
early stop counter: 2
val acc:0.9672402143478394, best validation acc: 0.9769882559776306, corresponding to test acc:                         0.9600897431373596 / 0.9674627184867859
after epoch: 7,now: 2024-06-30 21:16:59.338394,epoch time: 0:24:34.809499,used: 2:53:07.928481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9972493, 'precision': 0.99738604, 'recall': 0.9955216, 'specificity': 0.9955216, 'f1': 0.99644905, 'auroc': 0.9998592, 'binary_precision': 0.99767315, 'binary_recall': 0.99187046, 'binary_specificity': 0.99917275, 'binary_f1_score': 0.9947633}
confusion matrix:
       0      1
0  42275     35
1    123  15007
---- Validation: 
scalar performance:
{'acc': 0.9717147, 'precision': 0.76939034, 'recall': 0.8111273, 'specificity': 0.8111273, 'f1': 0.7886011, 'auroc': 0.95818824, 'binary_precision': 0.55078685, 'binary_recall': 0.6395349, 'binary_specificity': 0.9827197, 'binary_f1_score': 0.5918525}
confusion matrix:
       0    1
0  17857  314
1    217  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95816636, 'precision': 0.7064298, 'recall': 0.63919044, 'specificity': 0.63919044, 'f1': 0.66537124, 'auroc': 0.89492404, 'binary_precision': 0.4409938, 'binary_recall': 0.29338843, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.35235733}
confusion matrix:
      0   1
0  5907  90
1   171  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_8.png
early stop counter: 3
val acc:0.9717146754264832, best validation acc: 0.9769882559776306, corresponding to test acc:                         0.9600897431373596 / 0.9674627184867859
after epoch: 8,now: 2024-06-30 21:41:35.117114,epoch time: 0:24:35.778720,used: 3:17:43.707201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9972841, 'precision': 0.99753803, 'recall': 0.99546033, 'specificity': 0.99546033, 'f1': 0.9964932, 'auroc': 0.9997952, 'binary_precision': 0.9980708, 'binary_recall': 0.99160606, 'binary_specificity': 0.9993146, 'binary_f1_score': 0.9948279}
confusion matrix:
       0      1
0  42281     29
1    127  15003
---- Validation: 
scalar performance:
{'acc': 0.97858626, 'precision': 0.8589729, 'recall': 0.7576605, 'specificity': 0.7576605, 'f1': 0.79934996, 'auroc': 0.96383286, 'binary_precision': 0.73364484, 'binary_recall': 0.5215947, 'binary_specificity': 0.99372625, 'binary_f1_score': 0.6097088}
confusion matrix:
       0    1
0  18057  114
1    288  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9588075, 'precision': 0.65837103, 'recall': 0.5344387, 'specificity': 0.5344387, 'f1': 0.5508877, 'auroc': 0.9188849, 'binary_precision': 0.3529412, 'binary_recall': 0.07438017, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.1228669}
confusion matrix:
      0   1
0  5964  33
1   224  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_9.png
better model found
persisted
after epoch: 9,now: 2024-06-30 22:06:04.036364,epoch time: 0:24:28.919250,used: 3:42:12.626451,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9956825, 'precision': 0.99702036, 'recall': 0.991868, 'specificity': 0.991868, 'f1': 0.99440795, 'auroc': 0.9997969, 'binary_precision': 0.9997985, 'binary_recall': 0.983807, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9917383}
confusion matrix:
       0      1
0  42307      3
1    245  14885
---- Validation: 
scalar performance:
{'acc': 0.9750706, 'precision': 0.88815135, 'recall': 0.64743286, 'specificity': 0.64743286, 'f1': 0.7103345, 'auroc': 0.95629275, 'binary_precision': 0.79910713, 'binary_recall': 0.29734218, 'binary_specificity': 0.99752355, 'binary_f1_score': 0.433414}
confusion matrix:
       0    1
0  18126   45
1    423  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.6198405, 'recall': 0.5092467, 'specificity': 0.5092467, 'f1': 0.509, 'auroc': 0.89087284, 'binary_precision': 0.2777778, 'binary_recall': 0.020661157, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.03846154}
confusion matrix:
      0   1
0  5984  13
1   237   5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_10.png
early stop counter: 1
val acc:0.975070595741272, best validation acc: 0.9785862565040588, corresponding to test acc:                         0.9588075280189514 / 0.9674627184867859
after epoch: 10,now: 2024-06-30 22:30:36.124704,epoch time: 0:24:32.088340,used: 4:06:44.714791,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99756265, 'precision': 0.997877, 'recall': 0.99584043, 'specificity': 0.99584043, 'f1': 0.996853, 'auroc': 0.99984324, 'binary_precision': 0.99853665, 'binary_recall': 0.9922009, 'binary_specificity': 0.99948, 'binary_f1_score': 0.99535865}
confusion matrix:
       0      1
0  42288     22
1    118  15012
---- Validation: 
scalar performance:
{'acc': 0.9802376, 'precision': 0.8642918, 'recall': 0.79063547, 'specificity': 0.79063547, 'f1': 0.8229948, 'auroc': 0.96268725, 'binary_precision': 0.7421384, 'binary_recall': 0.5880399, 'binary_specificity': 0.993231, 'binary_f1_score': 0.65616316}
confusion matrix:
       0    1
0  18048  123
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.89785457, 'recall': 0.5696643, 'specificity': 0.5696643, 'f1': 0.6113262, 'auroc': 0.937832, 'binary_precision': 0.8292683, 'binary_recall': 0.14049587, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.2402827}
confusion matrix:
      0   1
0  5990   7
1   208  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_11.png
better model found
persisted
after epoch: 11,now: 2024-06-30 22:55:07.770210,epoch time: 0:24:31.645506,used: 4:31:16.360297,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99752784, 'precision': 0.99783194, 'recall': 0.9957956, 'specificity': 0.9957956, 'f1': 0.9968082, 'auroc': 0.9998219, 'binary_precision': 0.9984701, 'binary_recall': 0.9921348, 'binary_specificity': 0.9994564, 'binary_f1_score': 0.9952924}
confusion matrix:
       0      1
0  42287     23
1    119  15011
---- Validation: 
scalar performance:
{'acc': 0.97762746, 'precision': 0.8647579, 'recall': 0.7258463, 'specificity': 0.7258463, 'f1': 0.7777637, 'auroc': 0.959499, 'binary_precision': 0.7472826, 'binary_recall': 0.45681062, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.56701034}
confusion matrix:
       0    1
0  18078   93
1    327  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7314964, 'recall': 0.5237929, 'specificity': 0.5237929, 'f1': 0.53520447, 'auroc': 0.9301517, 'binary_precision': 0.5, 'binary_recall': 0.049586777, 'binary_specificity': 0.997999, 'binary_f1_score': 0.09022556}
confusion matrix:
      0   1
0  5985  12
1   230  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_12.png
early stop counter: 1
val acc:0.9776274561882019, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9674627184867859
after epoch: 12,now: 2024-06-30 23:19:54.520706,epoch time: 0:24:46.750496,used: 4:56:03.110793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99489903, 'precision': 0.99640673, 'recall': 0.9904652, 'specificity': 0.9904652, 'f1': 0.9933877, 'auroc': 0.99958396, 'binary_precision': 0.99952865, 'binary_recall': 0.9810959, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.99022645}
confusion matrix:
       0      1
0  42304      7
1    286  14843
---- Validation: 
scalar performance:
{'acc': 0.9750173, 'precision': 0.89311975, 'recall': 0.6433901, 'specificity': 0.6433901, 'f1': 0.7065897, 'auroc': 0.9656337, 'binary_precision': 0.80930233, 'binary_recall': 0.28903654, 'binary_specificity': 0.99774367, 'binary_f1_score': 0.42594862}
confusion matrix:
       0    1
0  18130   41
1    428  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95816636, 'precision': 0.5407692, 'recall': 0.50436413, 'specificity': 0.50436413, 'f1': 0.50054884, 'auroc': 0.93838227, 'binary_precision': 0.12, 'binary_recall': 0.012396694, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.022471908}
confusion matrix:
      0   1
0  5975  22
1   239   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_13.png
early stop counter: 2
val acc:0.9750173091888428, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9674627184867859
after epoch: 13,now: 2024-06-30 23:44:10.371547,epoch time: 0:24:15.850841,used: 5:20:18.961634,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99695337, 'precision': 0.9977884, 'recall': 0.994365, 'specificity': 0.994365, 'f1': 0.9960607, 'auroc': 0.9998275, 'binary_precision': 0.99953234, 'binary_recall': 0.9888955, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.99418545}
confusion matrix:
       0      1
0  42304      7
1    168  14961
---- Validation: 
scalar performance:
{'acc': 0.97842646, 'precision': 0.8382106, 'recall': 0.792912, 'specificity': 0.792912, 'f1': 0.8137983, 'auroc': 0.9566791, 'binary_precision': 0.68978804, 'binary_recall': 0.59468436, 'binary_specificity': 0.9911397, 'binary_f1_score': 0.6387154}
confusion matrix:
       0    1
0  18010  161
1    244  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.8748424, 'recall': 0.6225496, 'specificity': 0.6225496, 'f1': 0.6799045, 'auroc': 0.91722566, 'binary_precision': 0.77922076, 'binary_recall': 0.24793388, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.37617552}
confusion matrix:
      0   1
0  5980  17
1   182  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_14.png
new oracle model saved
early stop counter: 3
val acc:0.978426456451416, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9681038856506348
after epoch: 14,now: 2024-07-01 00:08:30.142913,epoch time: 0:24:19.771366,used: 5:44:38.733000,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99651814, 'precision': 0.9948716, 'recall': 0.9961716, 'specificity': 0.9961716, 'f1': 0.9955193, 'auroc': 0.99975395, 'binary_precision': 0.99137646, 'binary_recall': 0.99543923, 'binary_specificity': 0.9969039, 'binary_f1_score': 0.9934037}
confusion matrix:
       0      1
0  42180    131
1     69  15060
---- Validation: 
scalar performance:
{'acc': 0.93597186, 'precision': 0.65342605, 'recall': 0.8858174, 'specificity': 0.8858174, 'f1': 0.7103087, 'auroc': 0.94969773, 'binary_precision': 0.3127341, 'binary_recall': 0.8322259, 'binary_specificity': 0.93940896, 'binary_f1_score': 0.45462793}
confusion matrix:
       0     1
0  17070  1101
1    101   501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.848854, 'precision': 0.5532167, 'recall': 0.68344843, 'specificity': 0.68344843, 'f1': 0.5610212, 'auroc': 0.8431888, 'binary_precision': 0.12910053, 'binary_recall': 0.5041322, 'binary_specificity': 0.8627647, 'binary_f1_score': 0.20556024}
confusion matrix:
      0    1
0  5174  823
1   120  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_15.png
early stop counter: 4
val acc:0.9359718561172485, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9681038856506348
after epoch: 15,now: 2024-07-01 00:32:49.683264,epoch time: 0:24:19.540351,used: 6:08:58.273351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9973363, 'precision': 0.9967672, 'recall': 0.99636614, 'specificity': 0.99636614, 'f1': 0.99656653, 'auroc': 0.9998789, 'binary_precision': 0.9955661, 'binary_recall': 0.9943159, 'binary_specificity': 0.9984164, 'binary_f1_score': 0.9949407}
confusion matrix:
       0      1
0  42243     67
1     86  15044
---- Validation: 
scalar performance:
{'acc': 0.94619936, 'precision': 0.6738266, 'recall': 0.8854792, 'specificity': 0.8854792, 'f1': 0.7330411, 'auroc': 0.95293427, 'binary_precision': 0.3538682, 'binary_recall': 0.820598, 'binary_specificity': 0.9503605, 'binary_f1_score': 0.4944945}
confusion matrix:
       0    1
0  17269  902
1    108  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.7352174, 'recall': 0.66051865, 'specificity': 0.66051865, 'f1': 0.6899362, 'auroc': 0.93498194, 'binary_precision': 0.4969325, 'binary_recall': 0.33471075, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.40000004}
confusion matrix:
      0   1
0  5915  82
1   161  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_16.png
early stop counter: 5
val acc:0.946199357509613, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9681038856506348
after epoch: 16,now: 2024-07-01 00:57:13.248713,epoch time: 0:24:23.565449,used: 6:33:21.838800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9971274, 'precision': 0.9979492, 'recall': 0.99465305, 'specificity': 0.99465305, 'f1': 0.9962863, 'auroc': 0.99984896, 'binary_precision': 0.9996661, 'binary_recall': 0.9894243, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.99451876}
confusion matrix:
       0      1
0  42306      5
1    160  14969
---- Validation: 
scalar performance:
{'acc': 0.9765088, 'precision': 0.83628535, 'recall': 0.7397233, 'specificity': 0.7397233, 'f1': 0.7792591, 'auroc': 0.96380544, 'binary_precision': 0.68941176, 'binary_recall': 0.48671097, 'binary_specificity': 0.9927357, 'binary_f1_score': 0.570594}
confusion matrix:
       0    1
0  18039  132
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.81092155, 'recall': 0.5465202, 'specificity': 0.5465202, 'f1': 0.5735661, 'auroc': 0.9542389, 'binary_precision': 0.6571429, 'binary_recall': 0.09504132, 'binary_specificity': 0.997999, 'binary_f1_score': 0.16606498}
confusion matrix:
      0   1
0  5985  12
1   219  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_17.png
early stop counter: 6
val acc:0.9765087962150574, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9681038856506348
after epoch: 17,now: 2024-07-01 01:21:37.194325,epoch time: 0:24:23.945612,used: 6:57:45.784412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9969185, 'precision': 0.99787354, 'recall': 0.9941932, 'specificity': 0.9941932, 'f1': 0.99601483, 'auroc': 0.99982446, 'binary_precision': 0.9998663, 'binary_recall': 0.9884336, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99411714}
confusion matrix:
       0      1
0  42308      2
1    175  14955
---- Validation: 
scalar performance:
{'acc': 0.97757417, 'precision': 0.9287554, 'recall': 0.6736206, 'specificity': 0.6736206, 'f1': 0.7439678, 'auroc': 0.9608083, 'binary_precision': 0.8786611, 'binary_recall': 0.3488372, 'binary_specificity': 0.998404, 'binary_f1_score': 0.49940544}
confusion matrix:
       0    1
0  18142   29
1    392  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.78890014, 'recall': 0.516112, 'specificity': 0.516112, 'f1': 0.5215959, 'auroc': 0.89793074, 'binary_precision': 0.61538464, 'binary_recall': 0.03305785, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.062745094}
confusion matrix:
      0  1
0  5992  5
1   234  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_18.png
early stop counter: 7
val acc:0.9775741696357727, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9681038856506348
after epoch: 18,now: 2024-07-01 01:46:06.638278,epoch time: 0:24:29.443953,used: 7:22:15.228365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9968315, 'precision': 0.9978584, 'recall': 0.9939855, 'specificity': 0.9939855, 'f1': 0.99590147, 'auroc': 0.99987125, 'binary_precision': 1.0, 'binary_recall': 0.98797095, 'binary_specificity': 1.0, 'binary_f1_score': 0.99394906}
confusion matrix:
       0      1
0  42310      0
1    182  14948
---- Validation: 
scalar performance:
{'acc': 0.97240716, 'precision': 0.80890274, 'recall': 0.65649664, 'specificity': 0.65649664, 'f1': 0.7057923, 'auroc': 0.94414306, 'binary_precision': 0.64, 'binary_recall': 0.31893688, 'binary_specificity': 0.99405646, 'binary_f1_score': 0.42572063}
confusion matrix:
       0    1
0  18063  108
1    410  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.6477699, 'recall': 0.5132956, 'specificity': 0.5132956, 'f1': 0.5164236, 'auroc': 0.8854305, 'binary_precision': 0.33333334, 'binary_recall': 0.02892562, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.05323194}
confusion matrix:
      0   1
0  5983  14
1   235   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_19.png
early stop counter: 8
val acc:0.9724071621894836, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9681038856506348
after epoch: 19,now: 2024-07-01 02:10:33.580266,epoch time: 0:24:26.941988,used: 7:46:42.170353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9981894, 'precision': 0.9983878, 'recall': 0.99694526, 'specificity': 0.99694526, 'f1': 0.9976636, 'auroc': 0.9998986, 'binary_precision': 0.9988049, 'binary_recall': 0.9943159, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.9965553}
confusion matrix:
       0      1
0  42292     18
1     86  15044
---- Validation: 
scalar performance:
{'acc': 0.9752304, 'precision': 0.79621136, 'recall': 0.8241861, 'specificity': 0.8241861, 'f1': 0.80950654, 'auroc': 0.9628471, 'binary_precision': 0.60363084, 'binary_recall': 0.6627907, 'binary_specificity': 0.9855814, 'binary_f1_score': 0.63182896}
confusion matrix:
       0    1
0  17909  262
1    203  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957365, 'precision': 0.67463744, 'recall': 0.5753259, 'specificity': 0.5753259, 'f1': 0.60241115, 'auroc': 0.92612714, 'binary_precision': 0.38235295, 'binary_recall': 0.16115703, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.22674419}
confusion matrix:
      0   1
0  5934  63
1   203  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_20.png
early stop counter: 9
val acc:0.9752303957939148, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9681038856506348
after epoch: 20,now: 2024-07-01 02:34:59.473966,epoch time: 0:24:25.893700,used: 8:11:08.064053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9976149, 'precision': 0.99838626, 'recall': 0.9954723, 'specificity': 0.9954723, 'f1': 0.9969176, 'auroc': 0.9998924, 'binary_precision': 1.0, 'binary_recall': 0.99094456, 'binary_specificity': 1.0, 'binary_f1_score': 0.9954516}
confusion matrix:
       0      1
0  42311      0
1    137  14992
---- Validation: 
scalar performance:
{'acc': 0.9742183, 'precision': 0.91749156, 'recall': 0.6164768, 'specificity': 0.6164768, 'f1': 0.67749345, 'auroc': 0.9477379, 'binary_precision': 0.8597561, 'binary_recall': 0.23421927, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.3681462}
confusion matrix:
       0    1
0  18148   23
1    461  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.48057473, 'recall': 0.49916625, 'specificity': 0.49916625, 'f1': 0.4896941, 'auroc': 0.90850246, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5987  10
1   242   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_21.png
early stop counter: 10
val acc:0.9742183089256287, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9681038856506348
after epoch: 21,now: 2024-07-01 02:59:21.675073,epoch time: 0:24:22.201107,used: 8:35:30.265160,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99820685, 'precision': 0.9987212, 'recall': 0.9966594, 'specificity': 0.9966594, 'f1': 0.9976845, 'auroc': 0.99991834, 'binary_precision': 0.9998004, 'binary_recall': 0.9933897, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9965848}
confusion matrix:
       0      1
0  42309      3
1    100  15028
---- Validation: 
scalar performance:
{'acc': 0.9765088, 'precision': 0.91038007, 'recall': 0.66343373, 'specificity': 0.66343373, 'f1': 0.73055243, 'auroc': 0.9606948, 'binary_precision': 0.8425532, 'binary_recall': 0.32890365, 'binary_specificity': 0.9979638, 'binary_f1_score': 0.4731183}
confusion matrix:
       0    1
0  18134   37
1    404  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.6476275, 'recall': 0.5094968, 'specificity': 0.5094968, 'f1': 0.50934964, 'auroc': 0.9189646, 'binary_precision': 0.33333334, 'binary_recall': 0.020661157, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.038910504}
confusion matrix:
      0   1
0  5987  10
1   237   5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_22.png
early stop counter: 11
val acc:0.9765087962150574, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9681038856506348
after epoch: 22,now: 2024-07-01 03:23:48.365131,epoch time: 0:24:26.690058,used: 8:59:56.955218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9983809, 'precision': 0.9987316, 'recall': 0.9970963, 'specificity': 0.9970963, 'f1': 0.99791026, 'auroc': 0.9999169, 'binary_precision': 0.9994685, 'binary_recall': 0.99438167, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.99691856}
confusion matrix:
       0      1
0  42303      8
1     85  15044
---- Validation: 
scalar performance:
{'acc': 0.9760294, 'precision': 0.79854214, 'recall': 0.8519025, 'specificity': 0.8519025, 'f1': 0.8228171, 'auroc': 0.96606696, 'binary_precision': 0.6064426, 'binary_recall': 0.7192691, 'binary_specificity': 0.9845358, 'binary_f1_score': 0.6580547}
confusion matrix:
       0    1
0  17890  281
1    169  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.7695703, 'recall': 0.6541718, 'specificity': 0.6541718, 'f1': 0.6944475, 'auroc': 0.949005, 'binary_precision': 0.5661765, 'binary_recall': 0.3181818, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.4074074}
confusion matrix:
      0   1
0  5938  59
1   165  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_23.png
early stop counter: 12
val acc:0.9760293960571289, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9681038856506348
after epoch: 23,now: 2024-07-01 03:48:08.181413,epoch time: 0:24:19.816282,used: 9:24:16.771500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9976497, 'precision': 0.9982369, 'recall': 0.9957082, 'specificity': 0.9957082, 'f1': 0.9969638, 'auroc': 0.99983215, 'binary_precision': 0.999467, 'binary_recall': 0.9916055, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.9955208}
confusion matrix:
       0      1
0  42303      8
1    127  15002
---- Validation: 
scalar performance:
{'acc': 0.9766686, 'precision': 0.8346046, 'recall': 0.74783635, 'specificity': 0.74783635, 'f1': 0.78423023, 'auroc': 0.9563783, 'binary_precision': 0.68552035, 'binary_recall': 0.50332224, 'binary_specificity': 0.99235046, 'binary_f1_score': 0.5804598}
confusion matrix:
       0    1
0  18032  139
1    299  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.70666504, 'recall': 0.551051, 'specificity': 0.551051, 'f1': 0.5764844, 'auroc': 0.9225386, 'binary_precision': 0.44827586, 'binary_recall': 0.10743801, 'binary_specificity': 0.994664, 'binary_f1_score': 0.17333332}
confusion matrix:
      0   1
0  5965  32
1   216  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_24.png
early stop counter: 13
val acc:0.9766685962677002, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9681038856506348
after epoch: 24,now: 2024-07-01 04:12:23.700239,epoch time: 0:24:15.518826,used: 9:48:32.290326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99808496, 'precision': 0.9987035, 'recall': 0.99636483, 'specificity': 0.99636483, 'f1': 0.99752665, 'auroc': 0.99998164, 'binary_precision': 1.0, 'binary_recall': 0.99272966, 'binary_specificity': 1.0, 'binary_f1_score': 0.99635154}
confusion matrix:
       0      1
0  42310      0
1    110  15020
---- Validation: 
scalar performance:
{'acc': 0.9753902, 'precision': 0.94386816, 'recall': 0.6283248, 'specificity': 0.6283248, 'f1': 0.6944956, 'auroc': 0.9571814, 'binary_precision': 0.9117647, 'binary_recall': 0.25747508, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.40155438}
confusion matrix:
       0    1
0  18156   15
1    447  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.6474143, 'recall': 0.5037987, 'specificity': 0.5037987, 'f1': 0.49808905, 'auroc': 0.9301295, 'binary_precision': 0.33333334, 'binary_recall': 0.008264462, 'binary_specificity': 0.999333, 'binary_f1_score': 0.016129032}
confusion matrix:
      0  1
0  5993  4
1   240  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_25.png
early stop counter: 14
val acc:0.9753901958465576, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9681038856506348
after epoch: 25,now: 2024-07-01 04:36:39.208612,epoch time: 0:24:15.508373,used: 10:12:47.798699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99780643, 'precision': 0.99810654, 'recall': 0.99623895, 'specificity': 0.99623895, 'f1': 0.99716794, 'auroc': 0.9998664, 'binary_precision': 0.9987367, 'binary_recall': 0.992927, 'binary_specificity': 0.99955094, 'binary_f1_score': 0.9958234}
confusion matrix:
       0      1
0  42293     19
1    107  15021
---- Validation: 
scalar performance:
{'acc': 0.97762746, 'precision': 0.8189193, 'recall': 0.82301515, 'specificity': 0.82301515, 'f1': 0.82095295, 'auroc': 0.9665725, 'binary_precision': 0.64918035, 'binary_recall': 0.6578073, 'binary_specificity': 0.988223, 'binary_f1_score': 0.65346533}
confusion matrix:
       0    1
0  17957  214
1    206  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.72790384, 'recall': 0.6068179, 'specificity': 0.6068179, 'f1': 0.6428714, 'auroc': 0.93150103, 'binary_precision': 0.4864865, 'binary_recall': 0.2231405, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.305949}
confusion matrix:
      0   1
0  5940  57
1   188  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_26.png
early stop counter: 15
val acc:0.9776274561882019, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9681038856506348
after epoch: 26,now: 2024-07-01 05:00:35.328717,epoch time: 0:23:56.120105,used: 10:36:43.918804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99756265, 'precision': 0.9983077, 'recall': 0.99541557, 'specificity': 0.99541557, 'f1': 0.99685025, 'auroc': 0.99985784, 'binary_precision': 0.9998666, 'binary_recall': 0.99087846, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9953522}
confusion matrix:
       0      1
0  42309      2
1    138  14991
---- Validation: 
scalar performance:
{'acc': 0.97922546, 'precision': 0.9006911, 'recall': 0.7242626, 'specificity': 0.7242626, 'f1': 0.7858944, 'auroc': 0.9630958, 'binary_precision': 0.8192771, 'binary_recall': 0.45182723, 'binary_specificity': 0.996698, 'binary_f1_score': 0.5824411}
confusion matrix:
       0    1
0  18111   60
1    330  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9578458, 'precision': 0.57189524, 'recall': 0.5101456, 'specificity': 0.5101456, 'f1': 0.5110421, 'auroc': 0.9248229, 'binary_precision': 0.18181819, 'binary_recall': 0.024793388, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.043636367}
confusion matrix:
      0   1
0  5970  27
1   236   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_27.png
early stop counter: 16
val acc:0.9792254567146301, best validation acc: 0.980237603187561, corresponding to test acc:                         0.9655393362045288 / 0.9681038856506348
after epoch: 27,now: 2024-07-01 05:24:32.287202,epoch time: 0:23:56.958485,used: 11:00:40.877289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9982765, 'precision': 0.9987898, 'recall': 0.9967706, 'specificity': 0.9967706, 'f1': 0.9977746, 'auroc': 0.9999088, 'binary_precision': 0.99986696, 'binary_recall': 0.99358845, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9967178}
confusion matrix:
       0      1
0  42309      2
1     97  15032
---- Validation: 
scalar performance:
{'acc': 0.980717, 'precision': 0.886104, 'recall': 0.7708069, 'specificity': 0.7708069, 'f1': 0.8175937, 'auroc': 0.9722668, 'binary_precision': 0.78708136, 'binary_recall': 0.54651165, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.6450981}
confusion matrix:
       0    1
0  18082   89
1    273  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.7502812, 'recall': 0.5797265, 'specificity': 0.5797265, 'f1': 0.6164387, 'auroc': 0.9459149, 'binary_precision': 0.53333336, 'binary_recall': 0.16528925, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.25236595}
confusion matrix:
      0   1
0  5962  35
1   202  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_28.png
better model found
persisted
after epoch: 28,now: 2024-07-01 05:48:33.398509,epoch time: 0:24:01.111307,used: 11:24:41.988596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9975975, 'precision': 0.99732566, 'recall': 0.99647975, 'specificity': 0.99647975, 'f1': 0.99690163, 'auroc': 0.9999278, 'binary_precision': 0.9967528, 'binary_recall': 0.9941176, 'binary_specificity': 0.9988419, 'binary_f1_score': 0.9954334}
confusion matrix:
       0      1
0  42261     49
1     89  15041
---- Validation: 
scalar performance:
{'acc': 0.97379214, 'precision': 0.7917772, 'recall': 0.772048, 'specificity': 0.772048, 'f1': 0.7815348, 'auroc': 0.96206635, 'binary_precision': 0.59821427, 'binary_recall': 0.5564784, 'binary_specificity': 0.9876176, 'binary_f1_score': 0.5765921}
confusion matrix:
       0    1
0  17946  225
1    267  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.72933733, 'recall': 0.5653471, 'specificity': 0.5653471, 'f1': 0.5968118, 'auroc': 0.9571079, 'binary_precision': 0.49253732, 'binary_recall': 0.13636364, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.21359225}
confusion matrix:
      0   1
0  5963  34
1   209  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_29.png
early stop counter: 1
val acc:0.9737921357154846, best validation acc: 0.9807170033454895, corresponding to test acc:                         0.9620131254196167 / 0.9681038856506348
after epoch: 29,now: 2024-07-01 06:12:40.944701,epoch time: 0:24:07.546192,used: 11:48:49.534788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9972841, 'precision': 0.9978173, 'recall': 0.99518406, 'specificity': 0.99518406, 'f1': 0.9964912, 'auroc': 0.9999007, 'binary_precision': 0.9989337, 'binary_recall': 0.99074626, 'binary_specificity': 0.99962187, 'binary_f1_score': 0.99482316}
confusion matrix:
       0      1
0  42295     16
1    140  14989
---- Validation: 
scalar performance:
{'acc': 0.974165, 'precision': 0.9337175, 'recall': 0.61002487, 'specificity': 0.61002487, 'f1': 0.6705066, 'auroc': 0.967735, 'binary_precision': 0.89261746, 'binary_recall': 0.22093023, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.3541944}
confusion matrix:
       0    1
0  18155   16
1    469  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.9296199, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628983_30.png
early stop counter: 2
val acc:0.9741650223731995, best validation acc: 0.9807170033454895, corresponding to test acc:                         0.9620131254196167 / 0.9681038856506348
after epoch: 30,now: 2024-07-01 06:36:51.274199,epoch time: 0:24:10.329498,used: 12:12:59.864286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_18_23_51_seed_2_21628983
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:12:59.864286 at 2024-07-01 06:36:51.274199
persisted model performance metric: 

scalar performance:
{'acc': 0.9620131, 'precision': 0.7502812, 'recall': 0.5797265, 'specificity': 0.5797265, 'f1': 0.6164387, 'auroc': 0.9459149, 'binary_precision': 0.53333336, 'binary_recall': 0.16528925, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.25236595}
confusion matrix:
      0   1
0  5962  35
1   202  40
oracle model performance metric: 

scalar performance:
{'acc': 0.9681039, 'precision': 0.8748424, 'recall': 0.6225496, 'specificity': 0.6225496, 'f1': 0.6799045, 'auroc': 0.91722566, 'binary_precision': 0.77922076, 'binary_recall': 0.24793388, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.37617552}
confusion matrix:
      0   1
0  5980  17
1   182  60
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 369159 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool | 337306 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |  31853 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 369159 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool | 337306 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |  31853 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362640 KiB |   9125 MiB |   3660 TiB |   3660 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   3612 TiB |   3612 TiB |
|       from small pool |  30850 KiB |     50 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10006 MiB |  10022 MiB |  28586 MiB |  18580 MiB |
|       from large pool |   9950 MiB |   9962 MiB |  28492 MiB |  18542 MiB |
|       from small pool |     56 MiB |     60 MiB |     94 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 386552 KiB |    876 MiB |   2635 TiB |   2635 TiB |
|       from large pool | 377446 KiB |    872 MiB |   2587 TiB |   2587 TiB |
|       from small pool |   9106 KiB |     32 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3305    |    8014    |  663607 K  |  663603 K  |
|       from large pool |     151    |     986    |  339597 K  |  339597 K  |
|       from small pool |    3154    |    7861    |  324009 K  |  324006 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3305    |    8014    |  663607 K  |  663603 K  |
|       from large pool |     151    |     986    |  339597 K  |  339597 K  |
|       from small pool |    3154    |    7861    |  324009 K  |  324006 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     443    |     445    |    1231    |     788    |
|       from large pool |     415    |     415    |    1184    |     769    |
|       from small pool |      28    |      30    |      47    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3642    |  432270 K  |  432270 K  |
|       from large pool |      35    |     417    |  275898 K  |  275898 K  |
|       from small pool |      39    |    3608    |  156371 K  |  156371 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |      0 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |      0 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   3660 TiB |   3660 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   3612 TiB |   3612 TiB |
|       from small pool |      0 KiB |     50 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  28586 MiB |  27848 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  28492 MiB |  27794 MiB |
|       from small pool |  40960 KiB |     60 MiB |     94 MiB |     54 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |   2635 TiB |   2635 TiB |
|       from large pool |  24320 KiB |    872 MiB |   2587 TiB |   2587 TiB |
|       from small pool |      0 KiB |     32 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8014    |  663607 K  |  663607 K  |
|       from large pool |       2    |     986    |  339597 K  |  339597 K  |
|       from small pool |       0    |    7861    |  324009 K  |  324009 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8014    |  663607 K  |  663607 K  |
|       from large pool |       2    |     986    |  339597 K  |  339597 K  |
|       from small pool |       0    |    7861    |  324009 K  |  324009 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |    1231    |    1180    |
|       from large pool |      31    |     415    |    1184    |    1153    |
|       from small pool |      20    |      30    |      47    |      27    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3642    |  432271 K  |  432271 K  |
|       from large pool |       3    |     417    |  275898 K  |  275898 K  |
|       from small pool |       0    |    3608    |  156373 K  |  156373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul  1 06:38:16 2024]
Finished job 0.
1 of 1 steps (100%) done
