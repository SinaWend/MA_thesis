Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 29 17:37:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977

 Experiment start at: 2024-06-29 17:44:37.883179
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9887272, 'precision': 0.9924691, 'recall': 0.97819734, 'specificity': 0.97819734, 'f1': 0.9850645, 'auroc': 0.99933827, 'binary_precision': 0.9998579, 'binary_recall': 0.95644194, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9776682}
confusion matrix:
       0      1
0  42322      2
1    641  14075
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.966688, 'precision': 0.8170855, 'recall': 0.5259702, 'specificity': 0.5259702, 'f1': 0.54050666, 'auroc': 0.9399928, 'binary_precision': 0.6666667, 'binary_recall': 0.05287714, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.09798271}
confusion matrix:
       0   1
0  18132  17
1    609  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.78552353, 'recall': 0.52048916, 'specificity': 0.52048916, 'f1': 0.5289256, 'auroc': 0.9275634, 'binary_precision': 0.6111111, 'binary_recall': 0.042145595, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.07885305}
confusion matrix:
      0   1
0  5990   7
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-29 18:07:52.189802,epoch time: 0:23:14.306623,used: 0:23:14.306623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9928997, 'precision': 0.9951438, 'recall': 0.98634934, 'specificity': 0.98634934, 'f1': 0.9906446, 'auroc': 0.9995233, 'binary_precision': 0.99965084, 'binary_recall': 0.9728168, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.98605126}
confusion matrix:
       0      1
0  42320      5
1    400  14315
---- Validation: 
scalar performance:
{'acc': 0.9695083, 'precision': 0.9293926, 'recall': 0.5619329, 'specificity': 0.5619329, 'f1': 0.601366, 'auroc': 0.95601207, 'binary_precision': 0.8888889, 'binary_recall': 0.1244168, 'binary_specificity': 0.999449, 'binary_f1_score': 0.21828105}
confusion matrix:
       0   1
0  18139  10
1    563  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.81262994, 'recall': 0.50374806, 'specificity': 0.50374806, 'f1': 0.49696523, 'auroc': 0.9359156, 'binary_precision': 0.6666667, 'binary_recall': 0.007662835, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5996  1
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_2.png
better model found
persisted
after epoch: 2,now: 2024-06-29 18:30:34.045324,epoch time: 0:22:41.855522,used: 0:45:56.162145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99481064, 'precision': 0.9961361, 'recall': 0.990321, 'specificity': 0.990321, 'f1': 0.9931839, 'auroc': 0.9997107, 'binary_precision': 0.998824, 'binary_recall': 0.98104364, 'binary_specificity': 0.9995983, 'binary_f1_score': 0.989854}
confusion matrix:
       0      1
0  42305     17
1    279  14439
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.77645725, 'recall': 0.5924434, 'specificity': 0.5924434, 'f1': 0.63473463, 'auroc': 0.95504737, 'binary_precision': 0.5809524, 'binary_recall': 0.18973562, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.28604925}
confusion matrix:
       0    1
0  18061   88
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.84969115, 'recall': 0.5528061, 'specificity': 0.5528061, 'f1': 0.58370036, 'auroc': 0.93841475, 'binary_precision': 0.7368421, 'binary_recall': 0.107279696, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.18729097}
confusion matrix:
      0   1
0  5987  10
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_3.png
new oracle model saved
early stop counter: 1
val acc:0.9675925970077515, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9584531784057617 / 0.9611697196960449
after epoch: 3,now: 2024-06-29 18:52:56.392146,epoch time: 0:22:22.346822,used: 1:08:18.508967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99388146, 'precision': 0.9959109, 'recall': 0.98814136, 'specificity': 0.98814136, 'f1': 0.9919465, 'auroc': 0.9996556, 'binary_precision': 1.0, 'binary_recall': 0.9762827, 'binary_specificity': 1.0, 'binary_f1_score': 0.987999}
confusion matrix:
       0      1
0  42325      0
1    349  14366
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.98348343, 'recall': 0.5178849, 'specificity': 0.5178849, 'f1': 0.52613753, 'auroc': 0.95586383, 'binary_precision': 1.0, 'binary_recall': 0.035769828, 'binary_specificity': 1.0, 'binary_f1_score': 0.069069065}
confusion matrix:
       0   1
0  18149   0
1    620  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.93476176, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_4.png
early stop counter: 2
val acc:0.9670072197914124, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9584531784057617 / 0.9611697196960449
after epoch: 4,now: 2024-06-29 19:15:18.686267,epoch time: 0:22:22.294121,used: 1:30:40.803088,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9914446, 'precision': 0.99430037, 'recall': 0.9834217, 'specificity': 0.9834217, 'f1': 0.9887049, 'auroc': 0.99956137, 'binary_precision': 1.0, 'binary_recall': 0.9668433, 'binary_specificity': 1.0, 'binary_f1_score': 0.98314214}
confusion matrix:
       0      1
0  42322      0
1    488  14230
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.8511542, 'recall': 0.52763563, 'specificity': 0.52763563, 'f1': 0.5436202, 'auroc': 0.9611511, 'binary_precision': 0.7346939, 'binary_recall': 0.05598756, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.10404625}
confusion matrix:
       0   1
0  18136  13
1    607  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8543732, 'recall': 0.50566375, 'specificity': 0.50566375, 'f1': 0.5007502, 'auroc': 0.95385367, 'binary_precision': 0.75, 'binary_recall': 0.011494253, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.022641508}
confusion matrix:
      0  1
0  5996  1
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_5.png
early stop counter: 3
val acc:0.9670072197914124, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9584531784057617 / 0.9611697196960449
after epoch: 5,now: 2024-06-29 19:37:40.862074,epoch time: 0:22:22.175807,used: 1:53:02.978895,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9950561, 'precision': 0.99352145, 'recall': 0.9935652, 'specificity': 0.9935652, 'f1': 0.99354327, 'auroc': 0.99968725, 'binary_precision': 0.99035066, 'binary_recall': 0.99048525, 'binary_specificity': 0.9966451, 'binary_f1_score': 0.99041796}
confusion matrix:
       0      1
0  42184    142
1    140  14574
---- Validation: 
scalar performance:
{'acc': 0.9538633, 'precision': 0.6821344, 'recall': 0.7608485, 'specificity': 0.7608485, 'f1': 0.71341914, 'auroc': 0.9427346, 'binary_precision': 0.3803419, 'binary_recall': 0.55365473, 'binary_specificity': 0.9680423, 'binary_f1_score': 0.4509183}
confusion matrix:
       0    1
0  17569  580
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94662833, 'precision': 0.6760543, 'recall': 0.699135, 'specificity': 0.699135, 'f1': 0.6867513, 'auroc': 0.91276723, 'binary_precision': 0.37710437, 'binary_recall': 0.42911878, 'binary_specificity': 0.96915126, 'binary_f1_score': 0.4014337}
confusion matrix:
      0    1
0  5812  185
1   149  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_6.png
early stop counter: 4
val acc:0.9538633227348328, best validation acc: 0.9695082902908325, corresponding to test acc:                         0.9584531784057617 / 0.9611697196960449
after epoch: 6,now: 2024-06-29 20:00:18.809110,epoch time: 0:22:37.947036,used: 2:15:40.925931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9970547, 'precision': 0.9976614, 'recall': 0.9946451, 'specificity': 0.9946451, 'f1': 0.99614125, 'auroc': 0.9998046, 'binary_precision': 0.9989023, 'binary_recall': 0.9896683, 'binary_specificity': 0.999622, 'binary_f1_score': 0.9942638}
confusion matrix:
       0      1
0  42312     16
1    152  14560
---- Validation: 
scalar performance:
{'acc': 0.9741379, 'precision': 0.8525133, 'recall': 0.6933392, 'specificity': 0.6933392, 'f1': 0.747905, 'auroc': 0.95645535, 'binary_precision': 0.7262248, 'binary_recall': 0.3919129, 'binary_specificity': 0.9947656, 'binary_f1_score': 0.5090909}
confusion matrix:
       0    1
0  18054   95
1    391  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.80764055, 'recall': 0.5767098, 'specificity': 0.5767098, 'f1': 0.6166187, 'auroc': 0.943604, 'binary_precision': 0.6507937, 'binary_recall': 0.15708812, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.25308642}
confusion matrix:
      0   1
0  5975  22
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-29 20:22:42.557880,epoch time: 0:22:23.748770,used: 2:38:04.674701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9967917, 'precision': 0.9968568, 'recall': 0.9947572, 'specificity': 0.9947572, 'f1': 0.99580115, 'auroc': 0.99979395, 'binary_precision': 0.99699044, 'binary_recall': 0.99055386, 'binary_specificity': 0.99896044, 'binary_f1_score': 0.9937617}
confusion matrix:
       0      1
0  42281     44
1    139  14576
---- Validation: 
scalar performance:
{'acc': 0.9729672, 'precision': 0.82357776, 'recall': 0.70548403, 'specificity': 0.70548403, 'f1': 0.7502185, 'auroc': 0.9579091, 'binary_precision': 0.6674938, 'binary_recall': 0.41835147, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.51434034}
confusion matrix:
       0    1
0  18015  134
1    374  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.8663963, 'recall': 0.67382735, 'specificity': 0.67382735, 'f1': 0.73267883, 'auroc': 0.94450563, 'binary_precision': 0.76033056, 'binary_recall': 0.35249043, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.4816754}
confusion matrix:
      0   1
0  5968  29
1   169  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_8.png
new oracle model saved
early stop counter: 1
val acc:0.9729672074317932, best validation acc: 0.9741379022598267, corresponding to test acc:                         0.9613295197486877 / 0.9683604836463928
after epoch: 8,now: 2024-06-29 20:45:03.752259,epoch time: 0:22:21.194379,used: 3:00:25.869080,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9965814, 'precision': 0.9968264, 'recall': 0.9942389, 'specificity': 0.9942389, 'f1': 0.9955238, 'auroc': 0.99977803, 'binary_precision': 0.9973286, 'binary_recall': 0.9893993, 'binary_specificity': 0.9990785, 'binary_f1_score': 0.99334806}
confusion matrix:
       0      1
0  42285     39
1    156  14560
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7435915, 'recall': 0.77088016, 'specificity': 0.77088016, 'f1': 0.75642574, 'auroc': 0.94837224, 'binary_precision': 0.5027855, 'binary_recall': 0.5614308, 'binary_specificity': 0.9803295, 'binary_f1_score': 0.53049225}
confusion matrix:
       0    1
0  17792  357
1    282  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.914829, 'precision': 0.58920944, 'recall': 0.653226, 'specificity': 0.653226, 'f1': 0.6098118, 'auroc': 0.8862822, 'binary_precision': 0.20689656, 'binary_recall': 0.3678161, 'binary_specificity': 0.938636, 'binary_f1_score': 0.26482758}
confusion matrix:
      0    1
0  5629  368
1   165   96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_9.png
early stop counter: 2
val acc:0.9659961462020874, best validation acc: 0.9741379022598267, corresponding to test acc:                         0.9613295197486877 / 0.9683604836463928
after epoch: 9,now: 2024-06-29 21:07:16.367631,epoch time: 0:22:12.615372,used: 3:22:38.484452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99579245, 'precision': 0.9971577, 'recall': 0.9918684, 'specificity': 0.9918684, 'f1': 0.99447614, 'auroc': 0.9996442, 'binary_precision': 0.9999309, 'binary_recall': 0.9837603, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9917797}
confusion matrix:
       0      1
0  42322      1
1    239  14478
---- Validation: 
scalar performance:
{'acc': 0.97200936, 'precision': 0.89322174, 'recall': 0.6172317, 'specificity': 0.6172317, 'f1': 0.6759769, 'auroc': 0.95075345, 'binary_precision': 0.8128342, 'binary_recall': 0.23639192, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.36626506}
confusion matrix:
       0    1
0  18114   35
1    491  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.9039017, 'recall': 0.5418121, 'specificity': 0.5418121, 'f1': 0.56671965, 'auroc': 0.931261, 'binary_precision': 0.84615386, 'binary_recall': 0.08429119, 'binary_specificity': 0.999333, 'binary_f1_score': 0.1533101}
confusion matrix:
      0   1
0  5993   4
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_10.png
early stop counter: 3
val acc:0.9720093607902527, best validation acc: 0.9741379022598267, corresponding to test acc:                         0.9613295197486877 / 0.9683604836463928
after epoch: 10,now: 2024-06-29 21:29:37.518701,epoch time: 0:22:21.151070,used: 3:44:59.635522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9956697, 'precision': 0.9955408, 'recall': 0.9931374, 'specificity': 0.9931374, 'f1': 0.9943315, 'auroc': 0.99948275, 'binary_precision': 0.9952766, 'binary_recall': 0.98790514, 'binary_specificity': 0.9983697, 'binary_f1_score': 0.99157715}
confusion matrix:
       0      1
0  42254     69
1    178  14539
---- Validation: 
scalar performance:
{'acc': 0.97121114, 'precision': 0.8089306, 'recall': 0.67757297, 'specificity': 0.67757297, 'f1': 0.72398496, 'auroc': 0.95081556, 'binary_precision': 0.6401099, 'binary_recall': 0.3623639, 'binary_specificity': 0.992782, 'binary_f1_score': 0.46276066}
confusion matrix:
       0    1
0  18018  131
1    410  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7303984, 'recall': 0.5311497, 'specificity': 0.5311497, 'f1': 0.5469488, 'auroc': 0.9339503, 'binary_precision': 0.5, 'binary_recall': 0.0651341, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.11525424}
confusion matrix:
      0   1
0  5980  17
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_11.png
early stop counter: 4
val acc:0.9712111353874207, best validation acc: 0.9741379022598267, corresponding to test acc:                         0.9613295197486877 / 0.9683604836463928
after epoch: 11,now: 2024-06-29 21:51:59.917404,epoch time: 0:22:22.398703,used: 4:07:22.034225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9973352, 'precision': 0.99814296, 'recall': 0.99490136, 'specificity': 0.99490136, 'f1': 0.9965083, 'auroc': 0.99981314, 'binary_precision': 0.99979407, 'binary_recall': 0.9898736, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9948091}
confusion matrix:
       0      1
0  42323      3
1    149  14565
---- Validation: 
scalar performance:
{'acc': 0.9792465, 'precision': 0.88171804, 'recall': 0.7717396, 'specificity': 0.7717396, 'f1': 0.8167361, 'auroc': 0.97330034, 'binary_precision': 0.7792494, 'binary_recall': 0.5489891, 'binary_specificity': 0.99449, 'binary_f1_score': 0.6441606}
confusion matrix:
       0    1
0  18049  100
1    290  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.8815857, 'recall': 0.5606357, 'specificity': 0.5606357, 'f1': 0.5966111, 'auroc': 0.96267104, 'binary_precision': 0.8, 'binary_recall': 0.12260536, 'binary_specificity': 0.998666, 'binary_f1_score': 0.21262458}
confusion matrix:
      0   1
0  5989   8
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_12.png
better model found
persisted
after epoch: 12,now: 2024-06-29 22:14:40.101948,epoch time: 0:22:40.184544,used: 4:30:02.218769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9957398, 'precision': 0.997077, 'recall': 0.99180907, 'specificity': 0.99180907, 'f1': 0.9944065, 'auroc': 0.99981666, 'binary_precision': 0.99979275, 'binary_recall': 0.983689, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.99167556}
confusion matrix:
       0      1
0  42323      3
1    240  14474
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.8359146, 'recall': 0.5666323, 'specificity': 0.5666323, 'f1': 0.6053756, 'auroc': 0.95981294, 'binary_precision': 0.7016129, 'binary_recall': 0.13530326, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.22685787}
confusion matrix:
       0   1
0  18112  37
1    556  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.6638547, 'recall': 0.51240945, 'specificity': 0.51240945, 'f1': 0.5141305, 'auroc': 0.9224184, 'binary_precision': 0.36842105, 'binary_recall': 0.026819924, 'binary_specificity': 0.997999, 'binary_f1_score': 0.05}
confusion matrix:
      0   1
0  5985  12
1   254   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_13.png
early stop counter: 1
val acc:0.9684439897537231, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9683604836463928
after epoch: 13,now: 2024-06-29 22:37:08.540298,epoch time: 0:22:28.438350,used: 4:52:30.657119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9975456, 'precision': 0.9980136, 'recall': 0.9955757, 'specificity': 0.9955757, 'f1': 0.99678683, 'auroc': 0.9998635, 'binary_precision': 0.998973, 'binary_recall': 0.99150586, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.9952254}
confusion matrix:
       0      1
0  42309     15
1    125  14591
---- Validation: 
scalar performance:
{'acc': 0.97839504, 'precision': 0.8933477, 'recall': 0.7412965, 'specificity': 0.7412965, 'f1': 0.7977408, 'auroc': 0.9689102, 'binary_precision': 0.80462724, 'binary_recall': 0.4867807, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.60658914}
confusion matrix:
       0    1
0  18073   76
1    330  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8032893, 'recall': 0.567298, 'specificity': 0.567298, 'f1': 0.60352284, 'auroc': 0.9533969, 'binary_precision': 0.64285713, 'binary_recall': 0.13793103, 'binary_specificity': 0.996665, 'binary_f1_score': 0.22712933}
confusion matrix:
      0   1
0  5977  20
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_14.png
early stop counter: 2
val acc:0.9783950448036194, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9683604836463928
after epoch: 14,now: 2024-06-29 22:59:34.582244,epoch time: 0:22:26.041946,used: 5:14:56.699065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99765074, 'precision': 0.99777144, 'recall': 0.9960903, 'specificity': 0.9960903, 'f1': 0.99692714, 'auroc': 0.9997122, 'binary_precision': 0.9980194, 'binary_recall': 0.99286586, 'binary_specificity': 0.9993148, 'binary_f1_score': 0.99543595}
confusion matrix:
       0      1
0  42293     29
1    105  14613
---- Validation: 
scalar performance:
{'acc': 0.97153044, 'precision': 0.78256524, 'recall': 0.8007473, 'specificity': 0.8007473, 'f1': 0.79134256, 'auroc': 0.95906353, 'binary_precision': 0.5787172, 'binary_recall': 0.61741835, 'binary_specificity': 0.98407626, 'binary_f1_score': 0.5974417}
confusion matrix:
       0    1
0  17860  289
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95302016, 'precision': 0.6032965, 'recall': 0.52656597, 'specificity': 0.52656597, 'f1': 0.5370207, 'auroc': 0.922175, 'binary_precision': 0.24615385, 'binary_recall': 0.06130268, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.09815951}
confusion matrix:
      0   1
0  5948  49
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_15.png
early stop counter: 3
val acc:0.9715304374694824, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9683604836463928
after epoch: 15,now: 2024-06-29 23:21:58.847537,epoch time: 0:22:24.265293,used: 5:37:20.964358,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9969495, 'precision': 0.99788463, 'recall': 0.99415535, 'specificity': 0.99415535, 'f1': 0.99600166, 'auroc': 0.99983597, 'binary_precision': 0.9997938, 'binary_recall': 0.98838156, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9940549}
confusion matrix:
       0      1
0  42319      3
1    171  14547
---- Validation: 
scalar performance:
{'acc': 0.9611537, 'precision': 0.5986436, 'recall': 0.5253552, 'specificity': 0.5253552, 'f1': 0.53609604, 'auroc': 0.8771079, 'binary_precision': 0.22981367, 'binary_recall': 0.057542767, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.0920398}
confusion matrix:
       0    1
0  18025  124
1    606   37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.53807366, 'recall': 0.5025808, 'specificity': 0.5025808, 'f1': 0.4959996, 'auroc': 0.83880305, 'binary_precision': 0.11764706, 'binary_recall': 0.007662835, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.014388489}
confusion matrix:
      0   1
0  5982  15
1   259   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_16.png
early stop counter: 4
val acc:0.9611536860466003, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9683604836463928
after epoch: 16,now: 2024-06-29 23:44:23.969073,epoch time: 0:22:25.121536,used: 5:59:46.085894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9971424, 'precision': 0.99785554, 'recall': 0.9946827, 'specificity': 0.9946827, 'f1': 0.9962559, 'auroc': 0.999888, 'binary_precision': 0.9993137, 'binary_recall': 0.98960173, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.994434}
confusion matrix:
       0      1
0  42316     10
1    153  14561
---- Validation: 
scalar performance:
{'acc': 0.97051936, 'precision': 0.803651, 'recall': 0.6637138, 'specificity': 0.6637138, 'f1': 0.7109276, 'auroc': 0.9576979, 'binary_precision': 0.6304985, 'binary_recall': 0.33437014, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.43699187}
confusion matrix:
       0    1
0  18023  126
1    428  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7424609, 'recall': 0.5680465, 'specificity': 0.5680465, 'f1': 0.60085815, 'auroc': 0.94876826, 'binary_precision': 0.52112675, 'binary_recall': 0.14176245, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.22289155}
confusion matrix:
      0   1
0  5963  34
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_17.png
early stop counter: 5
val acc:0.9705193638801575, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9683604836463928
after epoch: 17,now: 2024-06-30 00:06:59.895387,epoch time: 0:22:35.926314,used: 6:22:22.012208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9978436, 'precision': 0.99787927, 'recall': 0.99648577, 'specificity': 0.99648577, 'f1': 0.99718, 'auroc': 0.9997945, 'binary_precision': 0.99795264, 'binary_recall': 0.99368036, 'binary_specificity': 0.9992912, 'binary_f1_score': 0.99581194}
confusion matrix:
       0      1
0  42294     30
1     93  14623
---- Validation: 
scalar performance:
{'acc': 0.9714772, 'precision': 0.7790983, 'recall': 0.83147204, 'specificity': 0.83147204, 'f1': 0.8027892, 'auroc': 0.9618926, 'binary_precision': 0.5695709, 'binary_recall': 0.68118197, 'binary_specificity': 0.98176205, 'binary_f1_score': 0.62039655}
confusion matrix:
       0    1
0  17818  331
1    205  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.799977, 'recall': 0.64000964, 'specificity': 0.64000964, 'f1': 0.6878925, 'auroc': 0.9546574, 'binary_precision': 0.6302521, 'binary_recall': 0.28735632, 'binary_specificity': 0.992663, 'binary_f1_score': 0.39473683}
confusion matrix:
      0   1
0  5953  44
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_18.png
early stop counter: 6
val acc:0.971477210521698, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9683604836463928
after epoch: 18,now: 2024-06-30 00:29:25.050935,epoch time: 0:22:25.155548,used: 6:44:47.167756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99624825, 'precision': 0.99525297, 'recall': 0.9949455, 'specificity': 0.9949455, 'f1': 0.9950991, 'auroc': 0.9996598, 'binary_precision': 0.9931987, 'binary_recall': 0.99225384, 'binary_specificity': 0.9976372, 'binary_f1_score': 0.992726}
confusion matrix:
       0      1
0  42223    100
1    114  14603
---- Validation: 
scalar performance:
{'acc': 0.97679865, 'precision': 0.82129264, 'recall': 0.8357271, 'specificity': 0.8357271, 'f1': 0.8283357, 'auroc': 0.9634105, 'binary_precision': 0.653789, 'binary_recall': 0.6842924, 'binary_specificity': 0.9871618, 'binary_f1_score': 0.668693}
confusion matrix:
       0    1
0  17916  233
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.8717495, 'recall': 0.6720784, 'specificity': 0.6720784, 'f1': 0.73198986, 'auroc': 0.96156764, 'binary_precision': 0.7711864, 'binary_recall': 0.348659, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.48021108}
confusion matrix:
      0   1
0  5970  27
1   170  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_19.png
new oracle model saved
early stop counter: 7
val acc:0.9767986536026001, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 19,now: 2024-06-30 00:51:51.174507,epoch time: 0:22:26.123572,used: 7:07:13.291328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9980891, 'precision': 0.9982899, 'recall': 0.99671763, 'specificity': 0.99671763, 'f1': 0.9975005, 'auroc': 0.9998858, 'binary_precision': 0.99870265, 'binary_recall': 0.9938842, 'binary_specificity': 0.99955106, 'binary_f1_score': 0.9962876}
confusion matrix:
       0      1
0  42305     19
1     90  14626
---- Validation: 
scalar performance:
{'acc': 0.9768519, 'precision': 0.81675434, 'recall': 0.85600615, 'specificity': 0.85600615, 'f1': 0.83511907, 'auroc': 0.964373, 'binary_precision': 0.6432507, 'binary_recall': 0.7262831, 'binary_specificity': 0.9857292, 'binary_f1_score': 0.68224984}
confusion matrix:
       0    1
0  17890  259
1    176  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95158195, 'precision': 0.6576741, 'recall': 0.5862826, 'specificity': 0.5862826, 'f1': 0.60968935, 'auroc': 0.920741, 'binary_precision': 0.35, 'binary_recall': 0.18773946, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.24438901}
confusion matrix:
      0   1
0  5906  91
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_20.png
early stop counter: 8
val acc:0.9768518805503845, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 20,now: 2024-06-30 01:14:15.882665,epoch time: 0:22:24.708158,used: 7:29:37.999486,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99710727, 'precision': 0.99794495, 'recall': 0.99450576, 'specificity': 0.99450576, 'f1': 0.99620974, 'auroc': 0.99982023, 'binary_precision': 0.9996567, 'binary_recall': 0.9891297, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99436533}
confusion matrix:
       0      1
0  42316      5
1    160  14559
---- Validation: 
scalar performance:
{'acc': 0.9701469, 'precision': 0.85533, 'recall': 0.59751606, 'specificity': 0.59751606, 'f1': 0.6481995, 'auroc': 0.9548662, 'binary_precision': 0.7383721, 'binary_recall': 0.19751166, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.31165645}
confusion matrix:
       0    1
0  18104   45
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95653564, 'precision': 0.5846669, 'recall': 0.5064122, 'specificity': 0.5064122, 'f1': 0.503171, 'auroc': 0.89666593, 'binary_precision': 0.21052632, 'binary_recall': 0.01532567, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.028571429}
confusion matrix:
      0   1
0  5982  15
1   257   4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_21.png
early stop counter: 9
val acc:0.970146894454956, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 21,now: 2024-06-30 01:36:40.734171,epoch time: 0:22:24.851506,used: 7:52:02.850992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9978962, 'precision': 0.99849623, 'recall': 0.9960122, 'specificity': 0.9960122, 'f1': 0.9972461, 'auroc': 0.99987173, 'binary_precision': 0.9997262, 'binary_recall': 0.992119, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9959081}
confusion matrix:
       0      1
0  42317      4
1    116  14603
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.7495449, 'recall': 0.6948153, 'specificity': 0.6948153, 'f1': 0.71844625, 'auroc': 0.9417989, 'binary_precision': 0.5200803, 'binary_recall': 0.40279937, 'binary_specificity': 0.98683125, 'binary_f1_score': 0.45398775}
confusion matrix:
       0    1
0  17910  239
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92026204, 'precision': 0.53375584, 'recall': 0.5387914, 'specificity': 0.5387914, 'f1': 0.53596497, 'auroc': 0.8511081, 'binary_precision': 0.105960265, 'binary_recall': 0.12260536, 'binary_specificity': 0.9549775, 'binary_f1_score': 0.11367673}
confusion matrix:
      0    1
0  5727  270
1   229   32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_22.png
early stop counter: 10
val acc:0.9668475985527039, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 22,now: 2024-06-30 01:59:01.904617,epoch time: 0:22:21.170446,used: 8:14:24.021438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99824685, 'precision': 0.9982627, 'recall': 0.9971564, 'specificity': 0.9971564, 'f1': 0.99770796, 'auroc': 0.99987745, 'binary_precision': 0.99829537, 'binary_recall': 0.9949035, 'binary_specificity': 0.9994093, 'binary_f1_score': 0.9965966}
confusion matrix:
       0      1
0  42299     25
1     75  14641
---- Validation: 
scalar performance:
{'acc': 0.9742976, 'precision': 0.8049791, 'recall': 0.80818033, 'specificity': 0.80818033, 'f1': 0.80657053, 'auroc': 0.9622481, 'binary_precision': 0.6230769, 'binary_recall': 0.62986004, 'binary_specificity': 0.9865006, 'binary_f1_score': 0.6264501}
confusion matrix:
       0    1
0  17904  245
1    238  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9485459, 'precision': 0.57631356, 'recall': 0.5297285, 'specificity': 0.5297285, 'f1': 0.5395333, 'auroc': 0.9000722, 'binary_precision': 0.1919192, 'binary_recall': 0.07279693, 'binary_specificity': 0.98666, 'binary_f1_score': 0.10555556}
confusion matrix:
      0   1
0  5917  80
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_23.png
early stop counter: 11
val acc:0.9742975831031799, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 23,now: 2024-06-30 02:21:24.345262,epoch time: 0:22:22.440645,used: 8:36:46.462083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99719495, 'precision': 0.99690795, 'recall': 0.9957603, 'specificity': 0.9957603, 'f1': 0.9963324, 'auroc': 0.99979305, 'binary_precision': 0.99631727, 'binary_recall': 0.9927965, 'binary_specificity': 0.99872416, 'binary_f1_score': 0.99455374}
confusion matrix:
       0      1
0  42271     54
1    106  14609
---- Validation: 
scalar performance:
{'acc': 0.96035546, 'precision': 0.705961, 'recall': 0.73270726, 'specificity': 0.73270726, 'f1': 0.71840936, 'auroc': 0.93280303, 'binary_precision': 0.43013698, 'binary_recall': 0.48833594, 'binary_specificity': 0.9770786, 'binary_f1_score': 0.45739257}
confusion matrix:
       0    1
0  17733  416
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91019493, 'precision': 0.52797496, 'recall': 0.5390358, 'specificity': 0.5390358, 'f1': 0.53173447, 'auroc': 0.83112323, 'binary_precision': 0.094339624, 'binary_recall': 0.13409962, 'binary_specificity': 0.943972, 'binary_f1_score': 0.1107595}
confusion matrix:
      0    1
0  5661  336
1   226   35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_24.png
early stop counter: 12
val acc:0.9603554606437683, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 24,now: 2024-06-30 02:43:42.742981,epoch time: 0:22:18.397719,used: 8:59:04.859802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9983696, 'precision': 0.9987244, 'recall': 0.9970175, 'specificity': 0.9970175, 'f1': 0.9978671, 'auroc': 0.9998747, 'binary_precision': 0.9994535, 'binary_recall': 0.99422395, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9968319}
confusion matrix:
       0      1
0  42316      8
1     85  14631
---- Validation: 
scalar performance:
{'acc': 0.97690505, 'precision': 0.9239044, 'recall': 0.6902715, 'specificity': 0.6902715, 'f1': 0.75973916, 'auroc': 0.95434374, 'binary_precision': 0.8692579, 'binary_recall': 0.38258165, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.5313175}
confusion matrix:
       0    1
0  18112   37
1    397  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.81911576, 'recall': 0.54314417, 'specificity': 0.54314417, 'f1': 0.56777877, 'auroc': 0.93866044, 'binary_precision': 0.6764706, 'binary_recall': 0.08812261, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.1559322}
confusion matrix:
      0   1
0  5986  11
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_25.png
early stop counter: 13
val acc:0.9769050478935242, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 25,now: 2024-06-30 03:06:03.710162,epoch time: 0:22:20.967181,used: 9:21:25.826983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9984748, 'precision': 0.9987728, 'recall': 0.997244, 'specificity': 0.997244, 'f1': 0.9980054, 'auroc': 0.99994713, 'binary_precision': 0.99938565, 'binary_recall': 0.99470073, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.9970377}
confusion matrix:
       0      1
0  42312      9
1     78  14641
---- Validation: 
scalar performance:
{'acc': 0.9770115, 'precision': 0.80970883, 'recall': 0.898842, 'specificity': 0.898842, 'f1': 0.84807134, 'auroc': 0.97439635, 'binary_precision': 0.6260454, 'binary_recall': 0.81493, 'binary_specificity': 0.9827539, 'binary_f1_score': 0.7081081}
confusion matrix:
       0    1
0  17836  313
1    119  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.8339045, 'recall': 0.6015307, 'specificity': 0.6015307, 'f1': 0.65032005, 'auroc': 0.9660584, 'binary_precision': 0.7012987, 'binary_recall': 0.20689656, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.31952664}
confusion matrix:
      0   1
0  5974  23
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_26.png
early stop counter: 14
val acc:0.977011501789093, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 26,now: 2024-06-30 03:28:20.496556,epoch time: 0:22:16.786394,used: 9:43:42.613377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99863255, 'precision': 0.9990355, 'recall': 0.9973943, 'specificity': 0.9973943, 'f1': 0.9982114, 'auroc': 0.9999504, 'binary_precision': 0.99986345, 'binary_recall': 0.9948359, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99734336}
confusion matrix:
       0      1
0  42321      2
1     76  14641
---- Validation: 
scalar performance:
{'acc': 0.9779161, 'precision': 0.89634883, 'recall': 0.7290477, 'specificity': 0.7290477, 'f1': 0.7886776, 'auroc': 0.9712958, 'binary_precision': 0.8114754, 'binary_recall': 0.46189734, 'binary_specificity': 0.9961981, 'binary_f1_score': 0.58870167}
confusion matrix:
       0    1
0  18080   69
1    346  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.72973406, 'recall': 0.5146587, 'specificity': 0.5146587, 'f1': 0.5182182, 'auroc': 0.91232795, 'binary_precision': 0.5, 'binary_recall': 0.03065134, 'binary_specificity': 0.998666, 'binary_f1_score': 0.057761732}
confusion matrix:
      0  1
0  5989  8
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_27.png
early stop counter: 15
val acc:0.9779161214828491, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 27,now: 2024-06-30 03:50:40.568356,epoch time: 0:22:20.071800,used: 10:06:02.685177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9979137, 'precision': 0.99844056, 'recall': 0.99611247, 'specificity': 0.99611247, 'f1': 0.9972694, 'auroc': 0.9997663, 'binary_precision': 0.99952096, 'binary_recall': 0.9923903, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.9959429}
confusion matrix:
       0      1
0  42315      7
1    112  14606
---- Validation: 
scalar performance:
{'acc': 0.97408473, 'precision': 0.897894, 'recall': 0.6543088, 'specificity': 0.6543088, 'f1': 0.7188437, 'auroc': 0.97121876, 'binary_precision': 0.8196721, 'binary_recall': 0.31104198, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.45095828}
confusion matrix:
       0    1
0  18105   44
1    443  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.79201996, 'recall': 0.5093284, 'specificity': 0.5093284, 'f1': 0.50801337, 'auroc': 0.95024717, 'binary_precision': 0.625, 'binary_recall': 0.019157087, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.03717472}
confusion matrix:
      0  1
0  5994  3
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_28.png
early stop counter: 16
val acc:0.974084734916687, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 28,now: 2024-06-30 04:13:04.040184,epoch time: 0:22:23.471828,used: 10:28:26.157005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9981943, 'precision': 0.99865144, 'recall': 0.99663246, 'specificity': 0.99663246, 'f1': 0.99763656, 'auroc': 0.9999056, 'binary_precision': 0.9995896, 'binary_recall': 0.9934067, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.9964886}
confusion matrix:
       0      1
0  42322      6
1     97  14615
---- Validation: 
scalar performance:
{'acc': 0.9777033, 'precision': 0.93137544, 'recall': 0.6996854, 'specificity': 0.6996854, 'f1': 0.77021945, 'auroc': 0.96911174, 'binary_precision': 0.8835617, 'binary_recall': 0.40124416, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.55187166}
confusion matrix:
       0    1
0  18115   34
1    385  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8147433, 'recall': 0.55622065, 'specificity': 0.55622065, 'f1': 0.5879655, 'auroc': 0.96440524, 'binary_precision': 0.6666667, 'binary_recall': 0.11494253, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.19607843}
confusion matrix:
      0   1
0  5982  15
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_29.png
early stop counter: 17
val acc:0.9777032732963562, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 29,now: 2024-06-30 04:35:28.246961,epoch time: 0:22:24.206777,used: 10:50:50.363782,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99835205, 'precision': 0.99884707, 'recall': 0.9968507, 'specificity': 0.9968507, 'f1': 0.9978436, 'auroc': 0.99989057, 'binary_precision': 0.99986327, 'binary_recall': 0.9937487, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99679655}
confusion matrix:
       0      1
0  42321      2
1     92  14625
---- Validation: 
scalar performance:
{'acc': 0.97541505, 'precision': 0.9173645, 'recall': 0.66774845, 'specificity': 0.66774845, 'f1': 0.73589116, 'auroc': 0.97228646, 'binary_precision': 0.8577075, 'binary_recall': 0.33748055, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.48437497}
confusion matrix:
       0    1
0  18113   36
1    426  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9086323, 'recall': 0.5228218, 'specificity': 0.5228218, 'f1': 0.5333839, 'auroc': 0.96299326, 'binary_precision': 0.85714287, 'binary_recall': 0.04597701, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.087272726}
confusion matrix:
      0   1
0  5995   2
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_30.png
early stop counter: 18
val acc:0.975415050983429, best validation acc: 0.9792464971542358, corresponding to test acc:                         0.9621284604072571 / 0.9685202836990356
after epoch: 30,now: 2024-06-30 04:57:57.096144,epoch time: 0:22:28.849183,used: 11:13:19.212965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:13:19.212965 at 2024-06-30 04:57:57.096144
persisted model performance metric: 

scalar performance:
{'acc': 0.96212846, 'precision': 0.8815857, 'recall': 0.5606357, 'specificity': 0.5606357, 'f1': 0.5966111, 'auroc': 0.96267104, 'binary_precision': 0.8, 'binary_recall': 0.12260536, 'binary_specificity': 0.998666, 'binary_f1_score': 0.21262458}
confusion matrix:
      0   1
0  5989   8
1   229  32
oracle model performance metric: 

scalar performance:
{'acc': 0.9685203, 'precision': 0.8717495, 'recall': 0.6720784, 'specificity': 0.6720784, 'f1': 0.73198986, 'auroc': 0.96156764, 'binary_precision': 0.7711864, 'binary_recall': 0.348659, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.48021108}
confusion matrix:
      0   1
0  5970  27
1   170  91
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 369815 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool | 337956 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |  31859 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 369815 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool | 337956 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |  31859 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362641 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |  30851 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10022 MiB |  10022 MiB |  10022 MiB |      0 B   |
|       from large pool |   9962 MiB |   9962 MiB |   9962 MiB |      0 B   |
|       from small pool |     60 MiB |     60 MiB |     60 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 357224 KiB |    879 MiB |    880 TiB |    880 TiB |
|       from large pool | 350172 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |   7052 KiB |     12 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3317    |    7964    |  221732 K  |  221729 K  |
|       from large pool |     151    |     986    |  113526 K  |  113526 K  |
|       from small pool |    3166    |    7811    |  108206 K  |  108203 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3317    |    7964    |  221732 K  |  221729 K  |
|       from large pool |     151    |     986    |  113526 K  |  113526 K  |
|       from small pool |    3166    |    7811    |  108206 K  |  108203 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     445    |     445    |     445    |       0    |
|       from large pool |     415    |     415    |     415    |       0    |
|       from small pool |      30    |      30    |      30    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      64    |    3613    |  142996 K  |  142996 K  |
|       from large pool |      32    |     417    |   88579 K  |   88579 K  |
|       from small pool |      32    |    3582    |   54417 K  |   54417 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |      0 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 727040 KiB |  10022 MiB |  10022 MiB |   9312 MiB |
|       from large pool | 688128 KiB |   9962 MiB |   9962 MiB |   9290 MiB |
|       from small pool |  38912 KiB |     60 MiB |     60 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    879 MiB |    880 TiB |    880 TiB |
|       from large pool |  24320 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |      0 KiB |     30 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  221732 K  |  221732 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108206 K  |  108206 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  221732 K  |  221732 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108206 K  |  108206 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |     445    |     445    |     396    |
|       from large pool |      30    |     415    |     415    |     385    |
|       from small pool |      19    |      30    |      30    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3613    |  142997 K  |  142997 K  |
|       from large pool |       3    |     417    |   88579 K  |   88579 K  |
|       from small pool |       0    |    3582    |   54418 K  |   54418 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |      0 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 727040 KiB |  10022 MiB |  10022 MiB |   9312 MiB |
|       from large pool | 688128 KiB |   9962 MiB |   9962 MiB |   9290 MiB |
|       from small pool |  38912 KiB |     60 MiB |     60 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    879 MiB |    880 TiB |    880 TiB |
|       from large pool |  24320 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |      0 KiB |     30 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  221732 K  |  221732 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108206 K  |  108206 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  221732 K  |  221732 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108206 K  |  108206 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |     445    |     445    |     396    |
|       from large pool |      30    |     415    |     415    |     385    |
|       from small pool |      19    |      30    |      30    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3613    |  142997 K  |  142997 K  |
|       from large pool |       3    |     417    |   88579 K  |   88579 K  |
|       from small pool |       0    |    3582    |   54418 K  |   54418 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977

 Experiment start at: 2024-06-30 05:04:58.648453
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98787653, 'precision': 0.9917811, 'recall': 0.97631395, 'specificity': 0.97631395, 'f1': 0.98374, 'auroc': 0.99896175, 'binary_precision': 0.99934536, 'binary_recall': 0.95284003, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.9755388}
confusion matrix:
       0      1
0  42404      9
1    680  13739
---- Validation: 
scalar performance:
{'acc': 0.96755606, 'precision': 0.85675615, 'recall': 0.5726103, 'specificity': 0.5726103, 'f1': 0.6145395, 'auroc': 0.93308175, 'binary_precision': 0.7443609, 'binary_recall': 0.14710252, 'binary_specificity': 0.9981181, 'binary_f1_score': 0.24565756}
confusion matrix:
       0   1
0  18033  34
1    574  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.69717455, 'recall': 0.5181376, 'specificity': 0.5181376, 'f1': 0.52449393, 'auroc': 0.92484605, 'binary_precision': 0.4347826, 'binary_recall': 0.03846154, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.07067138}
confusion matrix:
      0   1
0  5933  13
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-30 05:27:37.633069,epoch time: 0:22:38.984616,used: 0:22:38.984616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9851574, 'recall': 0.99100935, 'specificity': 0.99100935, 'f1': 0.9880374, 'auroc': 0.99940157, 'binary_precision': 0.9733043, 'binary_recall': 0.99126095, 'binary_specificity': 0.99075776, 'binary_f1_score': 0.9822005}
confusion matrix:
       0      1
0  42022    392
1    126  14292
---- Validation: 
scalar performance:
{'acc': 0.9477588, 'precision': 0.6935035, 'recall': 0.8949423, 'specificity': 0.8949423, 'f1': 0.7538409, 'auroc': 0.9493071, 'binary_precision': 0.39330545, 'binary_recall': 0.8380386, 'binary_specificity': 0.9518459, 'binary_f1_score': 0.5353583}
confusion matrix:
       0    1
0  17197  870
1    109  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.916049, 'precision': 0.644707, 'recall': 0.84033287, 'specificity': 0.84033287, 'f1': 0.69264245, 'auroc': 0.9102019, 'binary_precision': 0.30076337, 'binary_recall': 0.75769234, 'binary_specificity': 0.92297345, 'binary_f1_score': 0.4306011}
confusion matrix:
      0    1
0  5488  458
1    63  197
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_2.png
early stop counter: 1
val acc:0.9477587938308716, best validation acc: 0.9675560593605042, corresponding to test acc:                         0.9576216340065002 / 0.9576216340065002
after epoch: 2,now: 2024-06-30 05:49:49.793765,epoch time: 0:22:12.160696,used: 0:44:51.145312,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99306726, 'precision': 0.99410826, 'recall': 0.9875742, 'specificity': 0.9875742, 'f1': 0.99078614, 'auroc': 0.99945223, 'binary_precision': 0.9961794, 'binary_recall': 0.97642165, 'binary_specificity': 0.9987268, 'binary_f1_score': 0.9862016}
confusion matrix:
       0      1
0  42358     54
1    340  14080
---- Validation: 
scalar performance:
{'acc': 0.96334046, 'precision': 0.74009407, 'recall': 0.8250592, 'specificity': 0.8250592, 'f1': 0.7753364, 'auroc': 0.9461858, 'binary_precision': 0.49242425, 'binary_recall': 0.67607725, 'binary_specificity': 0.97404104, 'binary_f1_score': 0.5698184}
confusion matrix:
       0    1
0  17598  469
1    218  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.7400115, 'recall': 0.82332534, 'specificity': 0.82332534, 'f1': 0.7745241, 'auroc': 0.9256966, 'binary_precision': 0.49438202, 'binary_recall': 0.6769231, 'binary_specificity': 0.9697276, 'binary_f1_score': 0.5714286}
confusion matrix:
      0    1
0  5766  180
1    84  176
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_3.png
early stop counter: 2
val acc:0.9633404612541199, best validation acc: 0.9675560593605042, corresponding to test acc:                         0.9576216340065002 / 0.9576216340065002
after epoch: 3,now: 2024-06-30 06:12:05.710503,epoch time: 0:22:15.916738,used: 1:07:07.062050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99447495, 'precision': 0.9955894, 'recall': 0.9898211, 'specificity': 0.9898211, 'f1': 0.99266243, 'auroc': 0.99965346, 'binary_precision': 0.9978118, 'binary_recall': 0.98037314, 'binary_specificity': 0.99926907, 'binary_f1_score': 0.98901564}
confusion matrix:
       0      1
0  42382     31
1    283  14136
---- Validation: 
scalar performance:
{'acc': 0.9730523, 'precision': 0.8857775, 'recall': 0.66629976, 'specificity': 0.66629976, 'f1': 0.7292412, 'auroc': 0.94702595, 'binary_precision': 0.79577464, 'binary_recall': 0.3358098, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.47230932}
confusion matrix:
       0    1
0  18009   58
1    447  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.9260876, 'recall': 0.58988005, 'specificity': 0.58988005, 'f1': 0.64110947, 'auroc': 0.9075657, 'binary_precision': 0.8867925, 'binary_recall': 0.18076923, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.3003195}
confusion matrix:
      0   1
0  5940   6
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-30 06:34:23.012312,epoch time: 0:22:17.301809,used: 1:29:24.363859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9922051, 'precision': 0.9866438, 'recall': 0.99301517, 'specificity': 0.99301517, 'f1': 0.9897752, 'auroc': 0.9997029, 'binary_precision': 0.9751156, 'binary_recall': 0.99465984, 'binary_specificity': 0.99137056, 'binary_f1_score': 0.98479074}
confusion matrix:
       0      1
0  42047    366
1     77  14342
---- Validation: 
scalar performance:
{'acc': 0.9745998, 'precision': 0.81897646, 'recall': 0.80801, 'specificity': 0.80801, 'f1': 0.8133875, 'auroc': 0.9591527, 'binary_precision': 0.65177196, 'binary_recall': 0.62852895, 'binary_specificity': 0.987491, 'binary_f1_score': 0.6399395}
confusion matrix:
       0    1
0  17841  226
1    250  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.8809446, 'recall': 0.6311787, 'specificity': 0.6311787, 'f1': 0.6901858, 'auroc': 0.95048785, 'binary_precision': 0.79310346, 'binary_recall': 0.2653846, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.3976945}
confusion matrix:
      0   1
0  5928  18
1   191  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-30 06:56:38.525428,epoch time: 0:22:15.513116,used: 1:51:39.876975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99574184, 'precision': 0.99699783, 'recall': 0.9917685, 'specificity': 0.9917685, 'f1': 0.9943481, 'auroc': 0.9996569, 'binary_precision': 0.9995067, 'binary_recall': 0.98370206, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.99154145}
confusion matrix:
       0      1
0  42406      7
1    235  14184
---- Validation: 
scalar performance:
{'acc': 0.9707577, 'precision': 0.8500335, 'recall': 0.64722806, 'specificity': 0.64722806, 'f1': 0.70407826, 'auroc': 0.96092033, 'binary_precision': 0.7256318, 'binary_recall': 0.2986627, 'binary_specificity': 0.99579346, 'binary_f1_score': 0.42315787}
confusion matrix:
       0    1
0  17991   76
1    472  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.8131428, 'recall': 0.51881033, 'specificity': 0.51881033, 'f1': 0.5258586, 'auroc': 0.9507017, 'binary_precision': 0.6666667, 'binary_recall': 0.03846154, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.07272727}
confusion matrix:
      0   1
0  5941   5
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_6.png
early stop counter: 1
val acc:0.9707577228546143, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9663228988647461 / 0.9663228988647461
after epoch: 6,now: 2024-06-30 07:18:48.754402,epoch time: 0:22:10.228974,used: 2:13:50.105949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9945981, 'precision': 0.9910259, 'recall': 0.9948016, 'specificity': 0.9948016, 'f1': 0.992895, 'auroc': 0.99976575, 'binary_precision': 0.9836852, 'binary_recall': 0.99521464, 'binary_specificity': 0.9943885, 'binary_f1_score': 0.98941636}
confusion matrix:
       0      1
0  42175    238
1     69  14350
---- Validation: 
scalar performance:
{'acc': 0.92577374, 'precision': 0.6538611, 'recall': 0.90714407, 'specificity': 0.90714407, 'f1': 0.71101654, 'auroc': 0.95782465, 'binary_precision': 0.31223848, 'binary_recall': 0.8870728, 'binary_specificity': 0.92721534, 'binary_f1_score': 0.46189553}
confusion matrix:
       0     1
0  16752  1315
1     76   597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9344183, 'precision': 0.681692, 'recall': 0.8793429, 'specificity': 0.8793429, 'f1': 0.73812735, 'auroc': 0.9414176, 'binary_precision': 0.37172773, 'binary_recall': 0.8192308, 'binary_specificity': 0.9394551, 'binary_f1_score': 0.5114046}
confusion matrix:
      0    1
0  5586  360
1    47  213
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_7.png
early stop counter: 2
val acc:0.9257737398147583, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9663228988647461 / 0.9663228988647461
after epoch: 7,now: 2024-06-30 07:40:59.477517,epoch time: 0:22:10.723115,used: 2:36:00.829064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9967624, 'precision': 0.99758255, 'recall': 0.99387133, 'specificity': 0.99387133, 'f1': 0.99570924, 'auroc': 0.9997872, 'binary_precision': 0.9992285, 'binary_recall': 0.98800194, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.9935835}
confusion matrix:
       0      1
0  42402     11
1    173  14246
---- Validation: 
scalar performance:
{'acc': 0.97017074, 'precision': 0.9033498, 'recall': 0.60472286, 'specificity': 0.60472286, 'f1': 0.6608171, 'auroc': 0.9595696, 'binary_precision': 0.8352941, 'binary_recall': 0.21099554, 'binary_specificity': 0.9984502, 'binary_f1_score': 0.33689204}
confusion matrix:
       0    1
0  18039   28
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7297188, 'recall': 0.5165509, 'specificity': 0.5165509, 'f1': 0.5216604, 'auroc': 0.949108, 'binary_precision': 0.5, 'binary_recall': 0.034615386, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.064748205}
confusion matrix:
      0  1
0  5937  9
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_8.png
early stop counter: 3
val acc:0.9701707363128662, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9663228988647461 / 0.9663228988647461
after epoch: 8,now: 2024-06-30 08:03:11.903789,epoch time: 0:22:12.426272,used: 2:58:13.255336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99581224, 'precision': 0.99373746, 'recall': 0.9952258, 'specificity': 0.9952258, 'f1': 0.9944787, 'auroc': 0.99983275, 'binary_precision': 0.98950565, 'binary_recall': 0.99403524, 'binary_specificity': 0.9964163, 'binary_f1_score': 0.99176526}
confusion matrix:
       0      1
0  42262    152
1     86  14332
---- Validation: 
scalar performance:
{'acc': 0.9707044, 'precision': 0.7852839, 'recall': 0.81171185, 'specificity': 0.81171185, 'f1': 0.7978467, 'auroc': 0.96103835, 'binary_precision': 0.58401084, 'binary_recall': 0.640416, 'binary_specificity': 0.98300767, 'binary_f1_score': 0.61091423}
confusion matrix:
       0    1
0  17760  307
1    242  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9505317, 'precision': 0.6997018, 'recall': 0.72959906, 'specificity': 0.72959906, 'f1': 0.713429, 'auroc': 0.91043234, 'binary_precision': 0.42192692, 'binary_recall': 0.48846152, 'binary_specificity': 0.9707366, 'binary_f1_score': 0.45276293}
confusion matrix:
      0    1
0  5772  174
1   133  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_9.png
early stop counter: 4
val acc:0.9707043766975403, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9663228988647461 / 0.9663228988647461
after epoch: 9,now: 2024-06-30 08:25:25.987143,epoch time: 0:22:14.083354,used: 3:20:27.338690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99656886, 'precision': 0.99766463, 'recall': 0.99328434, 'specificity': 0.99328434, 'f1': 0.99544996, 'auroc': 0.99980146, 'binary_precision': 0.99985945, 'binary_recall': 0.98661584, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.99319357}
confusion matrix:
       0      1
0  42410      2
1    193  14227
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.8585745, 'recall': 0.54402304, 'specificity': 0.54402304, 'f1': 0.5710636, 'auroc': 0.95586705, 'binary_precision': 0.75, 'binary_recall': 0.089153044, 'binary_specificity': 0.998893, 'binary_f1_score': 0.15936254}
confusion matrix:
       0   1
0  18047  20
1    613  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.63317764, 'recall': 0.50693554, 'specificity': 0.50693554, 'f1': 0.5037368, 'auroc': 0.9338346, 'binary_precision': 0.30769232, 'binary_recall': 0.015384615, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.029304028}
confusion matrix:
      0  1
0  5937  9
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_10.png
early stop counter: 5
val acc:0.9662219882011414, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9663228988647461 / 0.9663228988647461
after epoch: 10,now: 2024-06-30 08:47:35.194172,epoch time: 0:22:09.207029,used: 3:42:36.545719,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99693835, 'precision': 0.9976298, 'recall': 0.9942867, 'specificity': 0.9942867, 'f1': 0.99594396, 'auroc': 0.99981797, 'binary_precision': 0.99901915, 'binary_recall': 0.9889035, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.99393564}
confusion matrix:
       0      1
0  42399     14
1    160  14259
---- Validation: 
scalar performance:
{'acc': 0.97203845, 'precision': 0.8361728, 'recall': 0.69438463, 'specificity': 0.69438463, 'f1': 0.7447009, 'auroc': 0.9475747, 'binary_precision': 0.69451696, 'binary_recall': 0.39524516, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.50378793}
confusion matrix:
       0    1
0  17950  117
1    407  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.80703795, 'recall': 0.5901213, 'specificity': 0.5901213, 'f1': 0.63385993, 'auroc': 0.95074594, 'binary_precision': 0.6486486, 'binary_recall': 0.18461539, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.28742516}
confusion matrix:
      0   1
0  5920  26
1   212  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_11.png
early stop counter: 6
val acc:0.9720384478569031, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9663228988647461 / 0.9663228988647461
after epoch: 11,now: 2024-06-30 09:09:48.247198,epoch time: 0:22:13.053026,used: 4:04:49.598745,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.995865, 'precision': 0.99403894, 'recall': 0.9950551, 'specificity': 0.9950551, 'f1': 0.9945457, 'auroc': 0.9998081, 'binary_precision': 0.99032015, 'binary_recall': 0.993411, 'binary_specificity': 0.9966992, 'binary_f1_score': 0.9918632}
confusion matrix:
       0      1
0  42274    140
1     95  14323
---- Validation: 
scalar performance:
{'acc': 0.95912486, 'precision': 0.72335625, 'recall': 0.850053, 'specificity': 0.850053, 'f1': 0.7706728, 'auroc': 0.9577709, 'binary_precision': 0.45690453, 'binary_recall': 0.73254085, 'binary_specificity': 0.9675652, 'binary_f1_score': 0.5627854}
confusion matrix:
       0    1
0  17481  586
1    180  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94875926, 'precision': 0.6670561, 'recall': 0.63856375, 'specificity': 0.63856375, 'f1': 0.65123814, 'auroc': 0.91300404, 'binary_precision': 0.36448598, 'binary_recall': 0.3, 'binary_specificity': 0.9771275, 'binary_f1_score': 0.32911393}
confusion matrix:
      0    1
0  5810  136
1   182   78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_12.png
early stop counter: 7
val acc:0.9591248631477356, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9663228988647461 / 0.9663228988647461
after epoch: 12,now: 2024-06-30 09:31:55.886001,epoch time: 0:22:07.638803,used: 4:26:57.237548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9963401, 'precision': 0.9969043, 'recall': 0.9934281, 'specificity': 0.9934281, 'f1': 0.9951507, 'auroc': 0.999745, 'binary_precision': 0.99803746, 'binary_recall': 0.98751646, 'binary_specificity': 0.9993398, 'binary_f1_score': 0.99274904}
confusion matrix:
       0      1
0  42385     28
1    180  14239
---- Validation: 
scalar performance:
{'acc': 0.9747599, 'precision': 0.8554838, 'recall': 0.7322747, 'specificity': 0.7322747, 'f1': 0.77985746, 'auroc': 0.9502125, 'binary_precision': 0.73041475, 'binary_recall': 0.47102526, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.57271904}
confusion matrix:
       0    1
0  17950  117
1    356  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.84329736, 'recall': 0.51513237, 'specificity': 0.51513237, 'f1': 0.51901865, 'auroc': 0.9190527, 'binary_precision': 0.72727275, 'binary_recall': 0.03076923, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.05904059}
confusion matrix:
      0  1
0  5943  3
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_13.png
better model found
persisted
after epoch: 13,now: 2024-06-30 09:54:05.884971,epoch time: 0:22:09.998970,used: 4:49:07.236518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99723744, 'precision': 0.99732065, 'recall': 0.9953798, 'specificity': 0.9953798, 'f1': 0.9963454, 'auroc': 0.9997873, 'binary_precision': 0.9974885, 'binary_recall': 0.9916083, 'binary_specificity': 0.99915123, 'binary_f1_score': 0.99453974}
confusion matrix:
       0      1
0  42377     36
1    121  14298
---- Validation: 
scalar performance:
{'acc': 0.9709178, 'precision': 0.7991868, 'recall': 0.7453027, 'specificity': 0.7453027, 'f1': 0.7693069, 'auroc': 0.9576545, 'binary_precision': 0.6167883, 'binary_recall': 0.5022288, 'binary_specificity': 0.9883766, 'binary_f1_score': 0.55364454}
confusion matrix:
       0    1
0  17857  210
1    335  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.77958375, 'recall': 0.66961825, 'specificity': 0.66961825, 'f1': 0.70956635, 'auroc': 0.9505826, 'binary_precision': 0.58709675, 'binary_recall': 0.35, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.4385542}
confusion matrix:
      0   1
0  5882  64
1   169  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_14.png
early stop counter: 1
val acc:0.970917820930481, best validation acc: 0.9747598767280579, corresponding to test acc:                         0.9589107036590576 / 0.9663228988647461
after epoch: 14,now: 2024-06-30 10:16:15.462859,epoch time: 0:22:09.577888,used: 5:11:16.814406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99678, 'precision': 0.9973844, 'recall': 0.9941124, 'specificity': 0.9941124, 'f1': 0.99573463, 'auroc': 0.99985564, 'binary_precision': 0.9985992, 'binary_recall': 0.9886963, 'binary_specificity': 0.9995284, 'binary_f1_score': 0.9936231}
confusion matrix:
       0      1
0  42392     20
1    163  14257
---- Validation: 
scalar performance:
{'acc': 0.9710779, 'precision': 0.9059133, 'recall': 0.61949867, 'specificity': 0.61949867, 'f1': 0.67966545, 'auroc': 0.966222, 'binary_precision': 0.83937824, 'binary_recall': 0.24071322, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.3741339}
confusion matrix:
       0    1
0  18036   31
1    511  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.81253695, 'recall': 0.50376207, 'specificity': 0.50376207, 'f1': 0.49694523, 'auroc': 0.93849665, 'binary_precision': 0.6666667, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5945  1
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_15.png
early stop counter: 2
val acc:0.9710779190063477, best validation acc: 0.9747598767280579, corresponding to test acc:                         0.9589107036590576 / 0.9663228988647461
after epoch: 15,now: 2024-06-30 10:38:33.003855,epoch time: 0:22:17.540996,used: 5:33:34.355402,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9974838, 'precision': 0.9979708, 'recall': 0.9953846, 'specificity': 0.9953846, 'f1': 0.99666905, 'auroc': 0.9999114, 'binary_precision': 0.9989515, 'binary_recall': 0.99112284, 'binary_specificity': 0.9996463, 'binary_f1_score': 0.9950217}
confusion matrix:
       0      1
0  42398     15
1    128  14291
---- Validation: 
scalar performance:
{'acc': 0.97310567, 'precision': 0.899485, 'recall': 0.6584595, 'specificity': 0.6584595, 'f1': 0.7232973, 'auroc': 0.96185243, 'binary_precision': 0.8237548, 'binary_recall': 0.31946507, 'binary_specificity': 0.9974539, 'binary_f1_score': 0.46038544}
confusion matrix:
       0    1
0  18021   46
1    458  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.6595423, 'recall': 0.5248208, 'specificity': 0.5248208, 'f1': 0.5356364, 'auroc': 0.90457284, 'binary_precision': 0.35897437, 'binary_recall': 0.053846154, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.09364549}
confusion matrix:
      0   1
0  5921  25
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_16.png
early stop counter: 3
val acc:0.9731056690216064, best validation acc: 0.9747598767280579, corresponding to test acc:                         0.9589107036590576 / 0.9663228988647461
after epoch: 16,now: 2024-06-30 11:00:47.379828,epoch time: 0:22:14.375973,used: 5:55:48.731375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9978885, 'precision': 0.99835706, 'recall': 0.9960677, 'specificity': 0.9960677, 'f1': 0.9972057, 'auroc': 0.9998736, 'binary_precision': 0.9993016, 'binary_recall': 0.9923712, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.99582434}
confusion matrix:
       0      1
0  42403     10
1    110  14309
---- Validation: 
scalar performance:
{'acc': 0.97337246, 'precision': 0.83802545, 'recall': 0.725833, 'specificity': 0.725833, 'f1': 0.76977247, 'auroc': 0.9486668, 'binary_precision': 0.6959459, 'binary_recall': 0.45913818, 'binary_specificity': 0.99252784, 'binary_f1_score': 0.55326766}
confusion matrix:
       0    1
0  17932  135
1    364  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9505317, 'precision': 0.6096321, 'recall': 0.5420224, 'specificity': 0.5420224, 'f1': 0.5572947, 'auroc': 0.9090693, 'binary_precision': 0.25773194, 'binary_recall': 0.09615385, 'binary_specificity': 0.987891, 'binary_f1_score': 0.14005601}
confusion matrix:
      0   1
0  5874  72
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_17.png
early stop counter: 4
val acc:0.9733724594116211, best validation acc: 0.9747598767280579, corresponding to test acc:                         0.9589107036590576 / 0.9663228988647461
after epoch: 17,now: 2024-06-30 11:23:18.582213,epoch time: 0:22:31.202385,used: 6:18:19.933760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9980997, 'precision': 0.9983135, 'recall': 0.9966669, 'specificity': 0.9966669, 'f1': 0.9974867, 'auroc': 0.9998949, 'binary_precision': 0.9987454, 'binary_recall': 0.99375826, 'binary_specificity': 0.9995756, 'binary_f1_score': 0.99624556}
confusion matrix:
       0      1
0  42395     18
1     90  14329
---- Validation: 
scalar performance:
{'acc': 0.9776414, 'precision': 0.87034893, 'recall': 0.77453935, 'specificity': 0.77453935, 'f1': 0.81471056, 'auroc': 0.9677963, 'binary_precision': 0.757085, 'binary_recall': 0.5557206, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.6409597}
confusion matrix:
       0    1
0  17947  120
1    299  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8326355, 'recall': 0.5622843, 'specificity': 0.5622843, 'f1': 0.5975373, 'auroc': 0.9430721, 'binary_precision': 0.70212764, 'binary_recall': 0.12692308, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.21498373}
confusion matrix:
      0   1
0  5932  14
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_18.png
better model found
persisted
after epoch: 18,now: 2024-06-30 11:45:32.826287,epoch time: 0:22:14.244074,used: 6:40:34.177834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99783576, 'precision': 0.9979984, 'recall': 0.99628437, 'specificity': 0.99628437, 'f1': 0.99713767, 'auroc': 0.99993706, 'binary_precision': 0.99832696, 'binary_recall': 0.99313456, 'binary_specificity': 0.9994341, 'binary_f1_score': 0.995724}
confusion matrix:
       0      1
0  42388     24
1     99  14321
---- Validation: 
scalar performance:
{'acc': 0.97145146, 'precision': 0.9008211, 'recall': 0.62827563, 'specificity': 0.62827563, 'f1': 0.68974614, 'auroc': 0.9691658, 'binary_precision': 0.82857144, 'binary_recall': 0.25854382, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.39411098}
confusion matrix:
       0    1
0  18031   36
1    499  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6791969, 'recall': 0.50359386, 'specificity': 0.50359386, 'f1': 0.49680376, 'auroc': 0.96407974, 'binary_precision': 0.4, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.01509434}
confusion matrix:
      0  1
0  5943  3
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_19.png
early stop counter: 1
val acc:0.971451461315155, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9611666202545166 / 0.9663228988647461
after epoch: 19,now: 2024-06-30 12:07:49.643439,epoch time: 0:22:16.817152,used: 7:02:50.994986,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9980117, 'precision': 0.9982085, 'recall': 0.9965395, 'specificity': 0.9965395, 'f1': 0.9973704, 'auroc': 0.99985445, 'binary_precision': 0.99860597, 'binary_recall': 0.9935506, 'binary_specificity': 0.9995284, 'binary_f1_score': 0.99607193}
confusion matrix:
       0      1
0  42392     20
1     93  14327
---- Validation: 
scalar performance:
{'acc': 0.97550696, 'precision': 0.93793344, 'recall': 0.6783018, 'specificity': 0.6783018, 'f1': 0.74982953, 'auroc': 0.9687356, 'binary_precision': 0.8992537, 'binary_recall': 0.35809806, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.51222104}
confusion matrix:
       0    1
0  18040   27
1    432  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6457897, 'recall': 0.5017549, 'specificity': 0.5017549, 'f1': 0.49306068, 'auroc': 0.9681737, 'binary_precision': 0.33333334, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5944  2
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_20.png
early stop counter: 2
val acc:0.9755069613456726, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9611666202545166 / 0.9663228988647461
after epoch: 20,now: 2024-06-30 12:30:14.360919,epoch time: 0:22:24.717480,used: 7:25:15.712466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9963577, 'precision': 0.9975481, 'recall': 0.99284387, 'specificity': 0.99284387, 'f1': 0.9951677, 'auroc': 0.9998879, 'binary_precision': 0.99992967, 'binary_recall': 0.98571134, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9927696}
confusion matrix:
       0      1
0  42414      1
1    206  14211
---- Validation: 
scalar performance:
{'acc': 0.9729989, 'precision': 0.91343266, 'recall': 0.64910567, 'specificity': 0.64910567, 'f1': 0.71505976, 'auroc': 0.9691162, 'binary_precision': 0.8523207, 'binary_recall': 0.30014858, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.44395602}
confusion matrix:
       0    1
0  18032   35
1    471  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.47901872, 'recall': 0.4991591, 'specificity': 0.4991591, 'f1': 0.4888816, 'auroc': 0.9468229, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5936  10
1   260   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_21.png
early stop counter: 3
val acc:0.9729989171028137, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9611666202545166 / 0.9663228988647461
after epoch: 21,now: 2024-06-30 12:52:40.096326,epoch time: 0:22:25.735407,used: 7:47:41.447873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9978005, 'precision': 0.9979979, 'recall': 0.9961921, 'specificity': 0.9961921, 'f1': 0.9970908, 'auroc': 0.99987066, 'binary_precision': 0.9983962, 'binary_recall': 0.9929265, 'binary_specificity': 0.9994577, 'binary_f1_score': 0.9956538}
confusion matrix:
       0      1
0  42389     23
1    102  14318
---- Validation: 
scalar performance:
{'acc': 0.96136606, 'precision': 0.7241885, 'recall': 0.75036263, 'specificity': 0.75036263, 'f1': 0.7364575, 'auroc': 0.93661165, 'binary_precision': 0.46622518, 'binary_recall': 0.5230312, 'binary_specificity': 0.97769415, 'binary_f1_score': 0.4929972}
confusion matrix:
       0    1
0  17664  403
1    321  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9476313, 'precision': 0.6092126, 'recall': 0.5570597, 'specificity': 0.5570597, 'f1': 0.57299376, 'auroc': 0.885887, 'binary_precision': 0.2556391, 'binary_recall': 0.13076924, 'binary_specificity': 0.98335016, 'binary_f1_score': 0.173028}
confusion matrix:
      0   1
0  5847  99
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_22.png
early stop counter: 4
val acc:0.9613660573959351, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9611666202545166 / 0.9663228988647461
after epoch: 22,now: 2024-06-30 13:15:00.328349,epoch time: 0:22:20.232023,used: 8:10:01.679896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99686795, 'precision': 0.99755955, 'recall': 0.9941709, 'specificity': 0.9941709, 'f1': 0.99585044, 'auroc': 0.9998669, 'binary_precision': 0.99894893, 'binary_recall': 0.98869544, 'binary_specificity': 0.9996463, 'binary_f1_score': 0.9937957}
confusion matrix:
       0      1
0  42398     15
1    163  14256
---- Validation: 
scalar performance:
{'acc': 0.97065103, 'precision': 0.8954428, 'recall': 0.6164162, 'specificity': 0.6164162, 'f1': 0.67493725, 'auroc': 0.95586824, 'binary_precision': 0.81865287, 'binary_recall': 0.23476969, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.36489606}
confusion matrix:
       0    1
0  18032   35
1    515  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.47903565, 'recall': 0.49957955, 'specificity': 0.49957955, 'f1': 0.489092, 'auroc': 0.9136212, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5941  5
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_23.png
early stop counter: 5
val acc:0.9706510305404663, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9611666202545166 / 0.9663228988647461
after epoch: 23,now: 2024-06-30 13:37:58.491568,epoch time: 0:22:58.163219,used: 8:32:59.843115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9982932, 'precision': 0.99846613, 'recall': 0.99702513, 'specificity': 0.99702513, 'f1': 0.997743, 'auroc': 0.99994373, 'binary_precision': 0.99881566, 'binary_recall': 0.994451, 'binary_specificity': 0.9995992, 'binary_f1_score': 0.9966286}
confusion matrix:
       0      1
0  42398     17
1     80  14337
---- Validation: 
scalar performance:
{'acc': 0.976254, 'precision': 0.9252622, 'recall': 0.6972862, 'specificity': 0.6972862, 'f1': 0.76663154, 'auroc': 0.96008444, 'binary_precision': 0.872549, 'binary_recall': 0.39673105, 'binary_specificity': 0.99784136, 'binary_f1_score': 0.5454545}
confusion matrix:
       0    1
0  18028   39
1    406  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95343214, 'precision': 0.5094056, 'recall': 0.50123936, 'specificity': 0.50123936, 'f1': 0.4949025, 'auroc': 0.8996624, 'binary_precision': 0.060606062, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.013651878}
confusion matrix:
      0   1
0  5915  31
1   258   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_24.png
early stop counter: 6
val acc:0.9762539863586426, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9611666202545166 / 0.9663228988647461
after epoch: 24,now: 2024-06-30 14:01:04.961447,epoch time: 0:23:06.469879,used: 8:56:06.312994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.994387, 'precision': 0.99607635, 'recall': 0.9891213, 'specificity': 0.9891213, 'f1': 0.9925367, 'auroc': 0.99964106, 'binary_precision': 0.9994333, 'binary_recall': 0.9784312, 'binary_specificity': 0.99981135, 'binary_f1_score': 0.98882073}
confusion matrix:
       0      1
0  42405      8
1    311  14108
---- Validation: 
scalar performance:
{'acc': 0.97113127, 'precision': 0.95282185, 'recall': 0.60522103, 'specificity': 0.60522103, 'f1': 0.6647416, 'auroc': 0.9522073, 'binary_precision': 0.93421054, 'binary_recall': 0.21099554, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.34424242}
confusion matrix:
       0    1
0  18057   10
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.9128481, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_25.png
early stop counter: 7
val acc:0.9711312651634216, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9611666202545166 / 0.9663228988647461
after epoch: 25,now: 2024-06-30 14:24:09.580890,epoch time: 0:23:04.619443,used: 9:19:10.932437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99707913, 'precision': 0.9980507, 'recall': 0.99424326, 'specificity': 0.99424326, 'f1': 0.99612844, 'auroc': 0.9998257, 'binary_precision': 1.0, 'binary_recall': 0.9884866, 'binary_specificity': 1.0, 'binary_f1_score': 0.99421}
confusion matrix:
       0      1
0  42414      0
1    166  14252
---- Validation: 
scalar performance:
{'acc': 0.9710246, 'precision': 0.952331, 'recall': 0.60373515, 'specificity': 0.60373515, 'f1': 0.6627029, 'auroc': 0.9706966, 'binary_precision': 0.93333334, 'binary_recall': 0.20802377, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.34021872}
confusion matrix:
       0    1
0  18057   10
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.4790424, 'recall': 0.49974772, 'specificity': 0.49974772, 'f1': 0.48917606, 'auroc': 0.95054626, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5943  3
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_26.png
early stop counter: 8
val acc:0.9710245728492737, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9611666202545166 / 0.9663228988647461
after epoch: 26,now: 2024-06-30 14:47:07.635921,epoch time: 0:22:58.055031,used: 9:42:08.987468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99678, 'precision': 0.99603033, 'recall': 0.99546206, 'specificity': 0.99546206, 'f1': 0.9957458, 'auroc': 0.99983203, 'binary_precision': 0.99451125, 'binary_recall': 0.99278677, 'binary_specificity': 0.9981374, 'binary_f1_score': 0.99364823}
confusion matrix:
       0      1
0  42335     79
1    104  14314
---- Validation: 
scalar performance:
{'acc': 0.9577908, 'precision': 0.69319963, 'recall': 0.6862802, 'specificity': 0.6862802, 'f1': 0.6896678, 'auroc': 0.91917825, 'binary_precision': 0.40895063, 'binary_recall': 0.39375928, 'binary_specificity': 0.97880113, 'binary_f1_score': 0.40121117}
confusion matrix:
       0    1
0  17684  383
1    408  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9329681, 'precision': 0.51997375, 'recall': 0.51446676, 'specificity': 0.51446676, 'f1': 0.5162497, 'auroc': 0.8358914, 'binary_precision': 0.08064516, 'binary_recall': 0.057692308, 'binary_specificity': 0.9712412, 'binary_f1_score': 0.06726458}
confusion matrix:
      0    1
0  5775  171
1   245   15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_27.png
early stop counter: 9
val acc:0.9577907919883728, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9611666202545166 / 0.9663228988647461
after epoch: 27,now: 2024-06-30 15:10:07.151308,epoch time: 0:22:59.515387,used: 10:05:08.502855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9970967, 'precision': 0.9956845, 'recall': 0.9966587, 'specificity': 0.9966587, 'f1': 0.99617034, 'auroc': 0.9998516, 'binary_precision': 0.99280876, 'binary_recall': 0.99576944, 'binary_specificity': 0.9975479, 'binary_f1_score': 0.9942869}
confusion matrix:
       0      1
0  42309    104
1     61  14358
---- Validation: 
scalar performance:
{'acc': 0.9747599, 'precision': 0.80548, 'recall': 0.87604344, 'specificity': 0.87604344, 'f1': 0.836699, 'auroc': 0.97031665, 'binary_precision': 0.6196172, 'binary_recall': 0.76968795, 'binary_specificity': 0.98239887, 'binary_f1_score': 0.6865474}
confusion matrix:
       0    1
0  17749  318
1    155  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95568806, 'precision': 0.71635073, 'recall': 0.6624085, 'specificity': 0.6624085, 'f1': 0.6849704, 'auroc': 0.94960463, 'binary_precision': 0.4611399, 'binary_recall': 0.3423077, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.39293596}
confusion matrix:
      0    1
0  5842  104
1   171   89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_28.png
early stop counter: 10
val acc:0.9747598767280579, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9611666202545166 / 0.9663228988647461
after epoch: 28,now: 2024-06-30 15:33:01.903110,epoch time: 0:22:54.751802,used: 10:28:03.254657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99808204, 'precision': 0.998579, 'recall': 0.99635756, 'specificity': 0.99635756, 'f1': 0.997462, 'auroc': 0.99975216, 'binary_precision': 0.99958104, 'binary_recall': 0.9928566, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.9962075}
confusion matrix:
       0      1
0  42407      6
1    103  14316
---- Validation: 
scalar performance:
{'acc': 0.97534686, 'precision': 0.92881536, 'recall': 0.6803646, 'specificity': 0.6803646, 'f1': 0.75051856, 'auroc': 0.9584632, 'binary_precision': 0.8808664, 'binary_recall': 0.3625557, 'binary_specificity': 0.9981735, 'binary_f1_score': 0.5136842}
confusion matrix:
       0    1
0  18034   33
1    429  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.63317764, 'recall': 0.50693554, 'specificity': 0.50693554, 'f1': 0.5037368, 'auroc': 0.9184761, 'binary_precision': 0.30769232, 'binary_recall': 0.015384615, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.029304028}
confusion matrix:
      0  1
0  5937  9
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_29.png
early stop counter: 11
val acc:0.9753468632698059, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9611666202545166 / 0.9663228988647461
after epoch: 29,now: 2024-06-30 15:55:43.010711,epoch time: 0:22:41.107601,used: 10:50:44.362258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99730784, 'precision': 0.99706995, 'recall': 0.99581623, 'specificity': 0.99581623, 'f1': 0.996441, 'auroc': 0.9997964, 'binary_precision': 0.99658895, 'binary_recall': 0.9927878, 'binary_specificity': 0.9988447, 'binary_f1_score': 0.9946847}
confusion matrix:
       0      1
0  42363     49
1    104  14316
---- Validation: 
scalar performance:
{'acc': 0.9727855, 'precision': 0.8247832, 'recall': 0.7355423, 'specificity': 0.7355423, 'f1': 0.77239156, 'auroc': 0.9517774, 'binary_precision': 0.66873705, 'binary_recall': 0.47994056, 'binary_specificity': 0.99114406, 'binary_f1_score': 0.5588235}
confusion matrix:
       0    1
0  17907  160
1    350  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95568806, 'precision': 0.5317814, 'recall': 0.5024166, 'specificity': 0.5024166, 'f1': 0.49583575, 'auroc': 0.92889386, 'binary_precision': 0.10526316, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.014336918}
confusion matrix:
      0   1
0  5929  17
1   258   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_30.png
early stop counter: 12
val acc:0.972785472869873, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9611666202545166 / 0.9663228988647461
after epoch: 30,now: 2024-06-30 16:18:05.447000,epoch time: 0:22:22.436289,used: 11:13:06.798547,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_58_seed_1_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:13:06.798547 at 2024-06-30 16:18:05.447000
persisted model performance metric: 

scalar performance:
{'acc': 0.9611666, 'precision': 0.8326355, 'recall': 0.5622843, 'specificity': 0.5622843, 'f1': 0.5975373, 'auroc': 0.9430721, 'binary_precision': 0.70212764, 'binary_recall': 0.12692308, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.21498373}
confusion matrix:
      0   1
0  5932  14
1   227  33
oracle model performance metric: 

scalar performance:
{'acc': 0.9663229, 'precision': 0.8809446, 'recall': 0.6311787, 'specificity': 0.6311787, 'f1': 0.6901858, 'auroc': 0.95048785, 'binary_precision': 0.79310346, 'binary_recall': 0.2653846, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.3976945}
confusion matrix:
      0   1
0  5928  18
1   191  69
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 368857 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool | 337010 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |  31847 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 368857 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool | 337010 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |  31847 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362638 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |  30848 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10006 MiB |  10022 MiB |  19318 MiB |   9312 MiB |
|       from large pool |   9950 MiB |   9962 MiB |  19240 MiB |   9290 MiB |
|       from small pool |     56 MiB |     60 MiB |     78 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 386854 KiB |    879 MiB |   1755 TiB |   1755 TiB |
|       from large pool | 377742 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |   9112 KiB |     30 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3293    |    7964    |  441868 K  |  441865 K  |
|       from large pool |     151    |     986    |  226164 K  |  226164 K  |
|       from small pool |    3142    |    7811    |  215704 K  |  215701 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3293    |    7964    |  441868 K  |  441865 K  |
|       from large pool |     151    |     986    |  226164 K  |  226164 K  |
|       from small pool |    3142    |    7811    |  215704 K  |  215701 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     443    |     445    |     839    |     396    |
|       from large pool |     415    |     415    |     800    |     385    |
|       from small pool |      28    |      30    |      39    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3613    |  288261 K  |  288261 K  |
|       from large pool |      35    |     417    |  181913 K  |  181913 K  |
|       from small pool |      38    |    3582    |  106347 K  |  106347 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |      0 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  19318 MiB |  18580 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  19240 MiB |  18542 MiB |
|       from small pool |  40960 KiB |     60 MiB |     78 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    879 MiB |   1755 TiB |   1755 TiB |
|       from large pool |  24320 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |      0 KiB |     32 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  441868 K  |  441868 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215704 K  |  215704 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  441868 K  |  441868 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215704 K  |  215704 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |     839    |     788    |
|       from large pool |      31    |     415    |     800    |     769    |
|       from small pool |      20    |      30    |      39    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3613    |  288262 K  |  288262 K  |
|       from large pool |       3    |     417    |  181913 K  |  181913 K  |
|       from small pool |       0    |    3582    |  106349 K  |  106349 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |      0 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  19318 MiB |  18580 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  19240 MiB |  18542 MiB |
|       from small pool |  40960 KiB |     60 MiB |     78 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    879 MiB |   1755 TiB |   1755 TiB |
|       from large pool |  24320 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |      0 KiB |     32 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  441868 K  |  441868 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215704 K  |  215704 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  441868 K  |  441868 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215704 K  |  215704 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |     839    |     788    |
|       from large pool |      31    |     415    |     800    |     769    |
|       from small pool |      20    |      30    |      39    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3613    |  288262 K  |  288262 K  |
|       from large pool |       3    |     417    |  181913 K  |  181913 K  |
|       from small pool |       0    |    3582    |  106349 K  |  106349 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977

 Experiment start at: 2024-06-30 16:25:12.025793
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9903029, 'precision': 0.98789984, 'recall': 0.9870907, 'specificity': 0.9870907, 'f1': 0.98749435, 'auroc': 0.9987134, 'binary_precision': 0.9828363, 'binary_recall': 0.98030275, 'binary_specificity': 0.99387866, 'binary_f1_score': 0.9815679}
confusion matrix:
       0      1
0  42052    259
1    298  14831
---- Validation: 
scalar performance:
{'acc': 0.91626275, 'precision': 0.61565673, 'recall': 0.83387786, 'specificity': 0.83387786, 'f1': 0.6593729, 'auroc': 0.91717803, 'binary_precision': 0.24036403, 'binary_recall': 0.74584717, 'binary_specificity': 0.92190856, 'binary_f1_score': 0.36356276}
confusion matrix:
       0     1
0  16752  1419
1    153   449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8087835, 'precision': 0.5495247, 'recall': 0.7121732, 'specificity': 0.7121732, 'f1': 0.5445851, 'auroc': 0.7922336, 'binary_precision': 0.118072286, 'binary_recall': 0.607438, 'binary_specificity': 0.8169085, 'binary_f1_score': 0.19771352}
confusion matrix:
      0     1
0  4899  1098
1    95   147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-30 16:48:19.559010,epoch time: 0:23:07.533217,used: 0:23:07.533217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99375, 'precision': 0.9936321, 'recall': 0.99023736, 'specificity': 0.99023736, 'f1': 0.9919188, 'auroc': 0.9993, 'binary_precision': 0.9933859, 'binary_recall': 0.9828145, 'binary_specificity': 0.99766016, 'binary_f1_score': 0.988072}
confusion matrix:
       0      1
0  42212     99
1    260  14869
---- Validation: 
scalar performance:
{'acc': 0.97182125, 'precision': 0.7719037, 'recall': 0.78628784, 'specificity': 0.78628784, 'f1': 0.77889156, 'auroc': 0.9343983, 'binary_precision': 0.55748034, 'binary_recall': 0.5880399, 'binary_specificity': 0.9845358, 'binary_f1_score': 0.57235247}
confusion matrix:
       0    1
0  17890  281
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.7898675, 'recall': 0.76332414, 'specificity': 0.76332414, 'f1': 0.77588487, 'auroc': 0.9132342, 'binary_precision': 0.5981735, 'binary_recall': 0.5413223, 'binary_specificity': 0.985326, 'binary_f1_score': 0.5683297}
confusion matrix:
      0    1
0  5909   88
1   111  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-30 17:11:00.479886,epoch time: 0:22:40.920876,used: 0:45:48.454093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9930884, 'precision': 0.99387085, 'recall': 0.98830134, 'specificity': 0.98830134, 'f1': 0.99104345, 'auroc': 0.9993944, 'binary_precision': 0.99549276, 'binary_recall': 0.97818613, 'binary_specificity': 0.99841654, 'binary_f1_score': 0.9867636}
confusion matrix:
       0      1
0  42245     67
1    330  14798
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.73710126, 'recall': 0.7310028, 'specificity': 0.7310028, 'f1': 0.7340079, 'auroc': 0.9419118, 'binary_precision': 0.49146757, 'binary_recall': 0.47840533, 'binary_specificity': 0.98360026, 'binary_f1_score': 0.48484847}
confusion matrix:
       0    1
0  17873  298
1    314  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9541593, 'precision': 0.6490972, 'recall': 0.58158934, 'specificity': 0.58158934, 'f1': 0.6037791, 'auroc': 0.92623794, 'binary_precision': 0.33076924, 'binary_recall': 0.17768595, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.2311828}
confusion matrix:
      0   1
0  5910  87
1   199  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_3.png
early stop counter: 1
val acc:0.9674000144004822, best validation acc: 0.9718212485313416, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 3,now: 2024-06-30 17:33:35.355893,epoch time: 0:22:34.876007,used: 1:08:23.330100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9930188, 'precision': 0.9952833, 'recall': 0.9867685, 'specificity': 0.9867685, 'f1': 0.99092686, 'auroc': 0.999652, 'binary_precision': 0.9999321, 'binary_recall': 0.9735607, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9865702}
confusion matrix:
       0      1
0  42310      1
1    400  14729
---- Validation: 
scalar performance:
{'acc': 0.9715549, 'precision': 0.91316247, 'recall': 0.56772107, 'specificity': 0.56772107, 'f1': 0.61023253, 'auroc': 0.95302004, 'binary_precision': 0.8541667, 'binary_recall': 0.13621262, 'binary_specificity': 0.99922955, 'binary_f1_score': 0.23495701}
confusion matrix:
       0   1
0  18157  14
1    520  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.5431612, 'recall': 0.5014825, 'specificity': 0.5014825, 'f1': 0.49385932, 'auroc': 0.903203, 'binary_precision': 0.125, 'binary_recall': 0.004132231, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.008}
confusion matrix:
      0  1
0  5990  7
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_4.png
early stop counter: 2
val acc:0.9715548753738403, best validation acc: 0.9718212485313416, corresponding to test acc:                         0.9681038856506348 / 0.9681038856506348
after epoch: 4,now: 2024-06-30 17:56:38.771732,epoch time: 0:23:03.415839,used: 1:31:26.745939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9971971, 'precision': 0.99707353, 'recall': 0.9956982, 'specificity': 0.9956982, 'f1': 0.99638325, 'auroc': 0.999838, 'binary_precision': 0.9968136, 'binary_recall': 0.9925309, 'binary_specificity': 0.99886554, 'binary_f1_score': 0.9946676}
confusion matrix:
       0      1
0  42263     48
1    113  15016
---- Validation: 
scalar performance:
{'acc': 0.9744846, 'precision': 0.8156954, 'recall': 0.7177984, 'specificity': 0.7177984, 'f1': 0.75701785, 'auroc': 0.9457908, 'binary_precision': 0.649635, 'binary_recall': 0.4435216, 'binary_specificity': 0.99207526, 'binary_f1_score': 0.5271471}
confusion matrix:
       0    1
0  18027  144
1    335  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535182, 'precision': 0.6215997, 'recall': 0.55548024, 'specificity': 0.55548024, 'f1': 0.5737585, 'auroc': 0.8493759, 'binary_precision': 0.2777778, 'binary_recall': 0.12396694, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.17142856}
confusion matrix:
      0   1
0  5919  78
1   212  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_5.png
better model found
persisted
after epoch: 5,now: 2024-06-30 18:19:55.410590,epoch time: 0:23:16.638858,used: 1:54:43.384797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99608284, 'precision': 0.9971801, 'recall': 0.9927343, 'specificity': 0.9927343, 'f1': 0.99493015, 'auroc': 0.999776, 'binary_precision': 0.99946386, 'binary_recall': 0.98565763, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.99251276}
confusion matrix:
       0      1
0  42302      8
1    217  14913
---- Validation: 
scalar performance:
{'acc': 0.9704363, 'precision': 0.8123517, 'recall': 0.58240116, 'specificity': 0.58240116, 'f1': 0.6258784, 'auroc': 0.955994, 'binary_precision': 0.6516129, 'binary_recall': 0.16777408, 'binary_specificity': 0.99702823, 'binary_f1_score': 0.2668428}
confusion matrix:
       0    1
0  18117   54
1    501  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.73105025, 'recall': 0.51189643, 'specificity': 0.51189643, 'f1': 0.5137235, 'auroc': 0.9514463, 'binary_precision': 0.5, 'binary_recall': 0.024793388, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.047244094}
confusion matrix:
      0  1
0  5991  6
1   236  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_6.png
early stop counter: 1
val acc:0.9704362750053406, best validation acc: 0.9744846224784851, corresponding to test acc:                         0.9535182118415833 / 0.9681038856506348
after epoch: 6,now: 2024-06-30 18:43:06.270372,epoch time: 0:23:10.859782,used: 2:17:54.244579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9915564, 'precision': 0.98521864, 'recall': 0.9933981, 'specificity': 0.9933981, 'f1': 0.989212, 'auroc': 0.99983263, 'binary_precision': 0.9714157, 'binary_recall': 0.99729013, 'binary_specificity': 0.989506, 'binary_f1_score': 0.9841829}
confusion matrix:
       0      1
0  41866    444
1     41  15089
---- Validation: 
scalar performance:
{'acc': 0.94619936, 'precision': 0.6719338, 'recall': 0.8742366, 'specificity': 0.8742366, 'f1': 0.7294599, 'auroc': 0.9467062, 'binary_precision': 0.3508772, 'binary_recall': 0.7973422, 'binary_specificity': 0.9511309, 'binary_f1_score': 0.48730963}
confusion matrix:
       0    1
0  17283  888
1    122  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8953358, 'precision': 0.6043335, 'recall': 0.79288507, 'specificity': 0.79288507, 'f1': 0.6394499, 'auroc': 0.8799865, 'binary_precision': 0.22267206, 'binary_recall': 0.6818182, 'binary_specificity': 0.903952, 'binary_f1_score': 0.33570704}
confusion matrix:
      0    1
0  5421  576
1    77  165
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_7.png
early stop counter: 2
val acc:0.946199357509613, best validation acc: 0.9744846224784851, corresponding to test acc:                         0.9535182118415833 / 0.9681038856506348
after epoch: 7,now: 2024-06-30 19:06:24.521426,epoch time: 0:23:18.251054,used: 2:41:12.495633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99529946, 'precision': 0.99293983, 'recall': 0.99498355, 'specificity': 0.99498355, 'f1': 0.99395585, 'auroc': 0.99981856, 'binary_precision': 0.987917, 'binary_recall': 0.9943159, 'binary_specificity': 0.9956511, 'binary_f1_score': 0.9911061}
confusion matrix:
       0      1
0  42126    184
1     86  15044
---- Validation: 
scalar performance:
{'acc': 0.939967, 'precision': 0.6568972, 'recall': 0.8645928, 'specificity': 0.8645928, 'f1': 0.7120248, 'auroc': 0.9470452, 'binary_precision': 0.321307, 'binary_recall': 0.78405315, 'binary_specificity': 0.9451324, 'binary_f1_score': 0.45581844}
confusion matrix:
       0    1
0  17174  997
1    130  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95512104, 'precision': 0.68175584, 'recall': 0.6336409, 'specificity': 0.6336409, 'f1': 0.6534631, 'auroc': 0.9211079, 'binary_precision': 0.39204547, 'binary_recall': 0.28512397, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.33014354}
confusion matrix:
      0    1
0  5890  107
1   173   69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_8.png
early stop counter: 3
val acc:0.9399669766426086, best validation acc: 0.9744846224784851, corresponding to test acc:                         0.9535182118415833 / 0.9681038856506348
after epoch: 8,now: 2024-06-30 19:29:34.745372,epoch time: 0:23:10.223946,used: 3:04:22.719579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99754524, 'precision': 0.9977581, 'recall': 0.9959133, 'specificity': 0.9959133, 'f1': 0.99683106, 'auroc': 0.9997791, 'binary_precision': 0.998205, 'binary_recall': 0.9924648, 'binary_specificity': 0.9993619, 'binary_f1_score': 0.99532664}
confusion matrix:
       0      1
0  42284     27
1    114  15015
---- Validation: 
scalar performance:
{'acc': 0.9745912, 'precision': 0.7918594, 'recall': 0.81662846, 'specificity': 0.81662846, 'f1': 0.8036903, 'auroc': 0.9595976, 'binary_precision': 0.5954198, 'binary_recall': 0.64784056, 'binary_specificity': 0.9854163, 'binary_f1_score': 0.62052506}
confusion matrix:
       0    1
0  17906  265
1    212  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.80110645, 'recall': 0.65732175, 'specificity': 0.65732175, 'f1': 0.70444566, 'auroc': 0.9347849, 'binary_precision': 0.62903225, 'binary_recall': 0.32231405, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.4262295}
confusion matrix:
      0   1
0  5951  46
1   164  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_9.png
better model found
persisted
after epoch: 9,now: 2024-06-30 19:52:36.519792,epoch time: 0:23:01.774420,used: 3:27:24.493999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99639624, 'precision': 0.9945817, 'recall': 0.9961525, 'specificity': 0.9961525, 'f1': 0.9953637, 'auroc': 0.9997664, 'binary_precision': 0.9907261, 'binary_recall': 0.99563754, 'binary_specificity': 0.9966675, 'binary_f1_score': 0.99317575}
confusion matrix:
       0      1
0  42170    141
1     66  15063
---- Validation: 
scalar performance:
{'acc': 0.9775209, 'precision': 0.8255873, 'recall': 0.79726255, 'specificity': 0.79726255, 'f1': 0.81072444, 'auroc': 0.96001387, 'binary_precision': 0.66423357, 'binary_recall': 0.60465115, 'binary_specificity': 0.98987395, 'binary_f1_score': 0.6330435}
confusion matrix:
       0    1
0  17987  184
1    238  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.78102505, 'recall': 0.5622987, 'specificity': 0.5622987, 'f1': 0.5959215, 'auroc': 0.933805, 'binary_precision': 0.59615386, 'binary_recall': 0.12809917, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.21088435}
confusion matrix:
      0   1
0  5976  21
1   211  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_10.png
better model found
persisted
after epoch: 10,now: 2024-06-30 20:15:40.712234,epoch time: 0:23:04.192442,used: 3:50:28.686441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9971274, 'precision': 0.9973246, 'recall': 0.99526906, 'specificity': 0.99526906, 'f1': 0.99629104, 'auroc': 0.99984664, 'binary_precision': 0.9977383, 'binary_recall': 0.9913417, 'binary_specificity': 0.9991964, 'binary_f1_score': 0.9945298}
confusion matrix:
       0      1
0  42276     34
1    131  14999
---- Validation: 
scalar performance:
{'acc': 0.97176796, 'precision': 0.7777114, 'recall': 0.7292439, 'specificity': 0.7292439, 'f1': 0.75094146, 'auroc': 0.95921665, 'binary_precision': 0.5728745, 'binary_recall': 0.47009966, 'binary_specificity': 0.98838806, 'binary_f1_score': 0.51642334}
confusion matrix:
       0    1
0  17960  211
1    319  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693861, 'precision': 0.86518854, 'recall': 0.6529577, 'specificity': 0.6529577, 'f1': 0.71207285, 'auroc': 0.93577623, 'binary_precision': 0.75757575, 'binary_recall': 0.30991736, 'binary_specificity': 0.995998, 'binary_f1_score': 0.4398827}
confusion matrix:
      0   1
0  5973  24
1   167  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_11.png
new oracle model saved
early stop counter: 1
val acc:0.9717679619789124, best validation acc: 0.9775208830833435, corresponding to test acc:                         0.9628145694732666 / 0.969386100769043
after epoch: 11,now: 2024-06-30 20:38:45.627543,epoch time: 0:23:04.915309,used: 4:13:33.601750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9954213, 'precision': 0.99691117, 'recall': 0.9913087, 'specificity': 0.9913087, 'f1': 0.9940671, 'auroc': 0.9997935, 'binary_precision': 1.0, 'binary_recall': 0.9826173, 'binary_specificity': 1.0, 'binary_f1_score': 0.99123245}
confusion matrix:
       0      1
0  42310      0
1    263  14867
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.8811068, 'recall': 0.5189379, 'specificity': 0.5189379, 'f1': 0.5285265, 'auroc': 0.9529679, 'binary_precision': 0.79310346, 'binary_recall': 0.03820598, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.07290016}
confusion matrix:
       0   1
0  18165   6
1    579  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.94511783, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_12.png
early stop counter: 2
val acc:0.9688382148742676, best validation acc: 0.9775208830833435, corresponding to test acc:                         0.9628145694732666 / 0.969386100769043
after epoch: 12,now: 2024-06-30 21:01:48.821453,epoch time: 0:23:03.193910,used: 4:36:36.795660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99754524, 'precision': 0.9982744, 'recall': 0.99540347, 'specificity': 0.99540347, 'f1': 0.9968277, 'auroc': 0.9998319, 'binary_precision': 0.9997999, 'binary_recall': 0.99087787, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9953189}
confusion matrix:
       0      1
0  42309      3
1    138  14990
---- Validation: 
scalar performance:
{'acc': 0.97826666, 'precision': 0.8382536, 'recall': 0.7880112, 'specificity': 0.7880112, 'f1': 0.81094754, 'auroc': 0.95683175, 'binary_precision': 0.6901961, 'binary_recall': 0.58471763, 'binary_specificity': 0.9913048, 'binary_f1_score': 0.6330935}
confusion matrix:
       0    1
0  18013  158
1    250  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.81652665, 'recall': 0.56883055, 'specificity': 0.56883055, 'f1': 0.6068083, 'auroc': 0.9052269, 'binary_precision': 0.6666667, 'binary_recall': 0.14049587, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.23208192}
confusion matrix:
      0   1
0  5980  17
1   208  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_13.png
better model found
persisted
after epoch: 13,now: 2024-06-30 21:24:53.647913,epoch time: 0:23:04.826460,used: 4:59:41.622120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9946727, 'precision': 0.99634343, 'recall': 0.98995066, 'specificity': 0.98995066, 'f1': 0.9930912, 'auroc': 0.9997504, 'binary_precision': 0.9997977, 'binary_recall': 0.97997224, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.98978573}
confusion matrix:
       0      1
0  42308      3
1    303  14826
---- Validation: 
scalar performance:
{'acc': 0.9728866, 'precision': 0.8269498, 'recall': 0.6455016, 'specificity': 0.6455016, 'f1': 0.69884217, 'auroc': 0.92480594, 'binary_precision': 0.6768061, 'binary_recall': 0.29568106, 'binary_specificity': 0.9953222, 'binary_f1_score': 0.41156068}
confusion matrix:
       0    1
0  18086   85
1    424  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9588075, 'precision': 0.6241595, 'recall': 0.5185768, 'specificity': 0.5185768, 'f1': 0.52556914, 'auroc': 0.86446214, 'binary_precision': 0.2857143, 'binary_recall': 0.041322313, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.07220216}
confusion matrix:
      0   1
0  5972  25
1   232  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_14.png
early stop counter: 1
val acc:0.9728866219520569, best validation acc: 0.9782666563987732, corresponding to test acc:                         0.9639365077018738 / 0.969386100769043
after epoch: 14,now: 2024-06-30 21:47:58.888237,epoch time: 0:23:05.240324,used: 5:22:46.862444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99658775, 'precision': 0.9970657, 'recall': 0.9941385, 'specificity': 0.9941385, 'f1': 0.9955903, 'auroc': 0.9998273, 'binary_precision': 0.99806565, 'binary_recall': 0.98896235, 'binary_specificity': 0.9993146, 'binary_f1_score': 0.99349314}
confusion matrix:
       0      1
0  42281     29
1    167  14963
---- Validation: 
scalar performance:
{'acc': 0.97831994, 'precision': 0.8285534, 'recall': 0.81534237, 'specificity': 0.81534237, 'f1': 0.82180035, 'auroc': 0.9599879, 'binary_precision': 0.6689775, 'binary_recall': 0.641196, 'binary_specificity': 0.9894887, 'binary_f1_score': 0.6547922}
confusion matrix:
       0    1
0  17980  191
1    216  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9716301, 'precision': 0.89793897, 'recall': 0.66998684, 'specificity': 0.66998684, 'f1': 0.73468953, 'auroc': 0.947389, 'binary_precision': 0.8217822, 'binary_recall': 0.3429752, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.483965}
confusion matrix:
      0   1
0  5979  18
1   159  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_15.png
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-06-30 22:11:01.307131,epoch time: 0:23:02.418894,used: 5:45:49.281338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99622214, 'precision': 0.9973613, 'recall': 0.99291277, 'specificity': 0.99291277, 'f1': 0.99511003, 'auroc': 0.9998889, 'binary_precision': 0.9997319, 'binary_recall': 0.98592013, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.992778}
confusion matrix:
       0      1
0  42308      4
1    213  14915
---- Validation: 
scalar performance:
{'acc': 0.9645235, 'precision': 0.675833, 'recall': 0.5785438, 'specificity': 0.5785438, 'f1': 0.6063949, 'auroc': 0.92428553, 'binary_precision': 0.37878788, 'binary_recall': 0.16611296, 'binary_specificity': 0.9909746, 'binary_f1_score': 0.23094688}
confusion matrix:
       0    1
0  18007  164
1    502  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9447027, 'precision': 0.51814795, 'recall': 0.5092571, 'specificity': 0.5092571, 'f1': 0.51055485, 'auroc': 0.8417069, 'binary_precision': 0.07438017, 'binary_recall': 0.037190083, 'binary_specificity': 0.981324, 'binary_f1_score': 0.049586777}
confusion matrix:
      0    1
0  5885  112
1   233    9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_16.png
early stop counter: 1
val acc:0.9645234942436218, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9716300964355469 / 0.9716300964355469
after epoch: 16,now: 2024-06-30 22:34:01.547619,epoch time: 0:23:00.240488,used: 6:08:49.521826,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99526465, 'precision': 0.9956511, 'recall': 0.99213636, 'specificity': 0.99213636, 'f1': 0.99387676, 'auroc': 0.9995973, 'binary_precision': 0.9964582, 'binary_recall': 0.9855254, 'binary_specificity': 0.99874735, 'binary_f1_score': 0.9909616}
confusion matrix:
       0      1
0  42257     53
1    219  14911
---- Validation: 
scalar performance:
{'acc': 0.94886273, 'precision': 0.65381956, 'recall': 0.752746, 'specificity': 0.752746, 'f1': 0.6892437, 'auroc': 0.9281877, 'binary_precision': 0.32312253, 'binary_recall': 0.54318935, 'binary_specificity': 0.96230257, 'binary_f1_score': 0.40520442}
confusion matrix:
       0    1
0  17486  685
1    275  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91248596, 'precision': 0.5494022, 'recall': 0.581722, 'specificity': 0.581722, 'f1': 0.5594802, 'auroc': 0.8321101, 'binary_precision': 0.13106796, 'binary_recall': 0.2231405, 'binary_specificity': 0.9403035, 'binary_f1_score': 0.1651376}
confusion matrix:
      0    1
0  5639  358
1   188   54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_17.png
early stop counter: 2
val acc:0.9488627314567566, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9716300964355469 / 0.9716300964355469
after epoch: 17,now: 2024-06-30 22:57:05.902096,epoch time: 0:23:04.354477,used: 6:31:53.876303,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9974756, 'precision': 0.99713653, 'recall': 0.9963544, 'specificity': 0.9963544, 'f1': 0.99674463, 'auroc': 0.9998388, 'binary_precision': 0.99642193, 'binary_recall': 0.99398506, 'binary_specificity': 0.99872375, 'binary_f1_score': 0.995202}
confusion matrix:
       0      1
0  42257     54
1     91  15038
---- Validation: 
scalar performance:
{'acc': 0.9555745, 'precision': 0.6940986, 'recall': 0.8525789, 'specificity': 0.8525789, 'f1': 0.74703836, 'auroc': 0.952755, 'binary_precision': 0.39698046, 'binary_recall': 0.7425249, 'binary_specificity': 0.9626328, 'binary_f1_score': 0.5173611}
confusion matrix:
       0    1
0  17492  679
1    155  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.956243, 'precision': 0.6892648, 'recall': 0.6322417, 'specificity': 0.6322417, 'f1': 0.6549492, 'auroc': 0.9164169, 'binary_precision': 0.4071856, 'binary_recall': 0.28099173, 'binary_specificity': 0.9834917, 'binary_f1_score': 0.33251834}
confusion matrix:
      0   1
0  5898  99
1   174  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_18.png
early stop counter: 3
val acc:0.9555745124816895, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9716300964355469 / 0.9716300964355469
after epoch: 18,now: 2024-06-30 23:20:25.341312,epoch time: 0:23:19.439216,used: 6:55:13.315519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9975801, 'precision': 0.99821144, 'recall': 0.9955548, 'specificity': 0.9955548, 'f1': 0.9968735, 'auroc': 0.9998842, 'binary_precision': 0.9995335, 'binary_recall': 0.991275, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.9953871}
confusion matrix:
       0      1
0  42304      7
1    132  14997
---- Validation: 
scalar performance:
{'acc': 0.97309965, 'precision': 0.8760432, 'recall': 0.61188364, 'specificity': 0.61188364, 'f1': 0.66816497, 'auroc': 0.95066226, 'binary_precision': 0.7771429, 'binary_recall': 0.22591361, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.3500643}
confusion matrix:
       0    1
0  18132   39
1    466  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.73090196, 'recall': 0.507931, 'specificity': 0.507931, 'f1': 0.50610465, 'auroc': 0.9334969, 'binary_precision': 0.5, 'binary_recall': 0.016528925, 'binary_specificity': 0.999333, 'binary_f1_score': 0.032}
confusion matrix:
      0  1
0  5993  4
1   238  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_19.png
early stop counter: 4
val acc:0.9730996489524841, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9716300964355469 / 0.9716300964355469
after epoch: 19,now: 2024-06-30 23:43:32.304248,epoch time: 0:23:06.962936,used: 7:18:20.278455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9961177, 'precision': 0.9970946, 'recall': 0.9929061, 'specificity': 0.9929061, 'f1': 0.9949763, 'auroc': 0.9998747, 'binary_precision': 0.9991294, 'binary_recall': 0.9861194, 'binary_specificity': 0.99969274, 'binary_f1_score': 0.9925818}
confusion matrix:
       0      1
0  42298     13
1    210  14919
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.71963954, 'recall': 0.6421447, 'specificity': 0.6421447, 'f1': 0.6717146, 'auroc': 0.915002, 'binary_precision': 0.46233767, 'binary_recall': 0.29568106, 'binary_specificity': 0.98860824, 'binary_f1_score': 0.36068895}
confusion matrix:
       0    1
0  17964  207
1    424  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.7922733, 'recall': 0.56849706, 'specificity': 0.56849706, 'f1': 0.6050782, 'auroc': 0.88849574, 'binary_precision': 0.6181818, 'binary_recall': 0.14049587, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.22895622}
confusion matrix:
      0   1
0  5976  21
1   208  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_20.png
early stop counter: 5
val acc:0.9663878679275513, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9716300964355469 / 0.9716300964355469
after epoch: 20,now: 2024-07-01 00:06:45.834207,epoch time: 0:23:13.529959,used: 7:41:33.808414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9981198, 'precision': 0.9978092, 'recall': 0.9973438, 'specificity': 0.9973438, 'f1': 0.9975762, 'auroc': 0.99990594, 'binary_precision': 0.9971538, 'binary_recall': 0.9957039, 'binary_specificity': 0.9989837, 'binary_f1_score': 0.9964283}
confusion matrix:
       0      1
0  42267     43
1     65  15065
---- Validation: 
scalar performance:
{'acc': 0.9691046, 'precision': 0.75176215, 'recall': 0.70618576, 'specificity': 0.70618576, 'f1': 0.726477, 'auroc': 0.9486084, 'binary_precision': 0.52244896, 'binary_recall': 0.42524916, 'binary_specificity': 0.98712236, 'binary_f1_score': 0.46886444}
confusion matrix:
       0    1
0  17937  234
1    346  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.7329781, 'recall': 0.6722483, 'specificity': 0.6722483, 'f1': 0.6974789, 'auroc': 0.9166927, 'binary_precision': 0.4915254, 'binary_recall': 0.35950413, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.41527447}
confusion matrix:
      0   1
0  5907  90
1   155  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_21.png
early stop counter: 6
val acc:0.9691045880317688, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9716300964355469 / 0.9716300964355469
after epoch: 21,now: 2024-07-01 00:29:52.554995,epoch time: 0:23:06.720788,used: 8:04:40.529202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9976149, 'precision': 0.998235, 'recall': 0.99562085, 'specificity': 0.99562085, 'f1': 0.99691856, 'auroc': 0.99982345, 'binary_precision': 0.99953353, 'binary_recall': 0.9914072, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.9954538}
confusion matrix:
       0      1
0  42304      7
1    130  14999
---- Validation: 
scalar performance:
{'acc': 0.9728866, 'precision': 0.91987765, 'recall': 0.59089434, 'specificity': 0.59089434, 'f1': 0.643979, 'auroc': 0.94633925, 'binary_precision': 0.86614174, 'binary_recall': 0.18272425, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.30178323}
confusion matrix:
       0    1
0  18154   17
1    492  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.6807507, 'recall': 0.5038821, 'specificity': 0.5038821, 'f1': 0.49816337, 'auroc': 0.91675365, 'binary_precision': 0.4, 'binary_recall': 0.008264462, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.016194332}
confusion matrix:
      0  1
0  5994  3
1   240  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_22.png
early stop counter: 7
val acc:0.9728866219520569, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9716300964355469 / 0.9716300964355469
after epoch: 22,now: 2024-07-01 00:52:56.452223,epoch time: 0:23:03.897228,used: 8:27:44.426430,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99695337, 'precision': 0.99794054, 'recall': 0.99421644, 'specificity': 0.99421644, 'f1': 0.99605954, 'auroc': 0.99992526, 'binary_precision': 1.0, 'binary_recall': 0.9884328, 'binary_specificity': 1.0, 'binary_f1_score': 0.99418277}
confusion matrix:
       0      1
0  42311      0
1    175  14954
---- Validation: 
scalar performance:
{'acc': 0.9732062, 'precision': 0.95965713, 'recall': 0.5870442, 'specificity': 0.5870442, 'f1': 0.64043695, 'auroc': 0.9609159, 'binary_precision': 0.9459459, 'binary_recall': 0.1744186, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.29453012}
confusion matrix:
       0    1
0  18165    6
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.9382318, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_23.png
early stop counter: 8
val acc:0.9732062220573425, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9716300964355469 / 0.9716300964355469
after epoch: 23,now: 2024-07-01 01:16:00.629721,epoch time: 0:23:04.177498,used: 8:50:48.603928,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99655294, 'precision': 0.997562, 'recall': 0.9935628, 'specificity': 0.9935628, 'f1': 0.9955406, 'auroc': 0.9997684, 'binary_precision': 0.9996654, 'binary_recall': 0.9872439, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.99341583}
confusion matrix:
       0      1
0  42305      5
1    193  14937
---- Validation: 
scalar performance:
{'acc': 0.9754435, 'precision': 0.9228232, 'recall': 0.6371859, 'specificity': 0.6371859, 'f1': 0.7030601, 'auroc': 0.9555626, 'binary_precision': 0.8691099, 'binary_recall': 0.2757475, 'binary_specificity': 0.9986242, 'binary_f1_score': 0.41866332}
confusion matrix:
       0    1
0  18146   25
1    436  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.9414321, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_24.png
early stop counter: 9
val acc:0.9754434823989868, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9716300964355469 / 0.9716300964355469
after epoch: 24,now: 2024-07-01 01:39:00.663121,epoch time: 0:23:00.033400,used: 9:13:48.637328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9984854, 'precision': 0.99880236, 'recall': 0.9972944, 'specificity': 0.9972944, 'f1': 0.9980453, 'auroc': 0.99991167, 'binary_precision': 0.9994687, 'binary_recall': 0.9947779, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.9971178}
confusion matrix:
       0      1
0  42304      8
1     79  15049
---- Validation: 
scalar performance:
{'acc': 0.96665424, 'precision': 0.7334456, 'recall': 0.7603303, 'specificity': 0.7603303, 'f1': 0.7460725, 'auroc': 0.93174696, 'binary_precision': 0.48219585, 'binary_recall': 0.5398671, 'binary_specificity': 0.9807936, 'binary_f1_score': 0.50940436}
confusion matrix:
       0    1
0  17822  349
1    277  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95576215, 'precision': 0.63593227, 'recall': 0.55069923, 'specificity': 0.55069923, 'f1': 0.5704583, 'auroc': 0.86803544, 'binary_precision': 0.3068182, 'binary_recall': 0.11157025, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.16363637}
confusion matrix:
      0   1
0  5936  61
1   215  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_25.png
early stop counter: 10
val acc:0.9666542410850525, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9716300964355469 / 0.9716300964355469
after epoch: 25,now: 2024-07-01 02:02:01.775744,epoch time: 0:23:01.112623,used: 9:36:49.749951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99801534, 'precision': 0.9984627, 'recall': 0.9964235, 'specificity': 0.9964235, 'f1': 0.9974374, 'auroc': 0.9999167, 'binary_precision': 0.99940133, 'binary_recall': 0.9930597, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.99622047}
confusion matrix:
       0      1
0  42302      9
1    105  15024
---- Validation: 
scalar performance:
{'acc': 0.98029083, 'precision': 0.8723156, 'recall': 0.77942026, 'specificity': 0.77942026, 'f1': 0.8187405, 'auroc': 0.96426004, 'binary_precision': 0.7589286, 'binary_recall': 0.56478405, 'binary_specificity': 0.99405646, 'binary_f1_score': 0.64761907}
confusion matrix:
       0    1
0  18063  108
1    262  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.6873557, 'recall': 0.5486514, 'specificity': 0.5486514, 'f1': 0.5721181, 'auroc': 0.90351754, 'binary_precision': 0.40983605, 'binary_recall': 0.10330579, 'binary_specificity': 0.993997, 'binary_f1_score': 0.16501649}
confusion matrix:
      0   1
0  5961  36
1   217  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_26.png
better model found
persisted
after epoch: 26,now: 2024-07-01 02:25:03.485003,epoch time: 0:23:01.709259,used: 9:59:51.459210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9974582, 'precision': 0.9975708, 'recall': 0.9958757, 'specificity': 0.9958757, 'f1': 0.9967193, 'auroc': 0.9998789, 'binary_precision': 0.9978073, 'binary_recall': 0.9925314, 'binary_specificity': 0.99922, 'binary_f1_score': 0.99516237}
confusion matrix:
       0      1
0  42277     33
1    113  15017
---- Validation: 
scalar performance:
{'acc': 0.97219414, 'precision': 0.87203443, 'recall': 0.5937488, 'specificity': 0.5937488, 'f1': 0.6449069, 'auroc': 0.95139945, 'binary_precision': 0.7702703, 'binary_recall': 0.18936877, 'binary_specificity': 0.9981289, 'binary_f1_score': 0.30400002}
confusion matrix:
       0    1
0  18137   34
1    488  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.6474853, 'recall': 0.5056981, 'specificity': 0.5056981, 'f1': 0.5019334, 'auroc': 0.93331087, 'binary_precision': 0.33333334, 'binary_recall': 0.012396694, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.023904383}
confusion matrix:
      0  1
0  5991  6
1   239  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_27.png
early stop counter: 1
val acc:0.9721941351890564, best validation acc: 0.9802908301353455, corresponding to test acc:                         0.9594486355781555 / 0.9716300964355469
after epoch: 27,now: 2024-07-01 02:47:57.267894,epoch time: 0:22:53.782891,used: 10:22:45.242101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.997789, 'precision': 0.9984604, 'recall': 0.9958455, 'specificity': 0.9958455, 'f1': 0.99714357, 'auroc': 0.9999232, 'binary_precision': 0.9998667, 'binary_recall': 0.99173826, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99578583}
confusion matrix:
       0      1
0  42308      2
1    125  15005
---- Validation: 
scalar performance:
{'acc': 0.97309965, 'precision': 0.9278053, 'recall': 0.59261054, 'specificity': 0.59261054, 'f1': 0.6467769, 'auroc': 0.95530367, 'binary_precision': 0.88188976, 'binary_recall': 0.18604651, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.30727023}
confusion matrix:
       0    1
0  18156   15
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.8850756, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_28.png
early stop counter: 2
val acc:0.9730996489524841, best validation acc: 0.9802908301353455, corresponding to test acc:                         0.9594486355781555 / 0.9716300964355469
after epoch: 28,now: 2024-07-01 03:10:55.468389,epoch time: 0:22:58.200495,used: 10:45:43.442596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99820685, 'precision': 0.99776316, 'recall': 0.9976152, 'specificity': 0.9976152, 'f1': 0.9976892, 'auroc': 0.99989116, 'binary_precision': 0.99682605, 'binary_recall': 0.99636483, 'binary_specificity': 0.99886554, 'binary_f1_score': 0.99659544}
confusion matrix:
       0      1
0  42262     48
1     55  15075
---- Validation: 
scalar performance:
{'acc': 0.94763756, 'precision': 0.65419114, 'recall': 0.76817405, 'specificity': 0.76817405, 'f1': 0.6932144, 'auroc': 0.9400208, 'binary_precision': 0.3227907, 'binary_recall': 0.57641196, 'binary_specificity': 0.95993614, 'binary_f1_score': 0.4138342}
confusion matrix:
       0    1
0  17443  728
1    255  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91553134, 'precision': 0.5317057, 'recall': 0.54563403, 'specificity': 0.54563403, 'f1': 0.5364482, 'auroc': 0.8473438, 'binary_precision': 0.09859155, 'binary_recall': 0.1446281, 'binary_specificity': 0.94664, 'binary_f1_score': 0.11725293}
confusion matrix:
      0    1
0  5677  320
1   207   35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_29.png
early stop counter: 3
val acc:0.9476375579833984, best validation acc: 0.9802908301353455, corresponding to test acc:                         0.9594486355781555 / 0.9716300964355469
after epoch: 29,now: 2024-07-01 03:33:46.466131,epoch time: 0:22:50.997742,used: 11:08:34.440338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99810237, 'precision': 0.9986291, 'recall': 0.9964824, 'specificity': 0.9964824, 'f1': 0.99754936, 'auroc': 0.9999652, 'binary_precision': 0.9997338, 'binary_recall': 0.9930592, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9963853}
confusion matrix:
       0      1
0  42308      4
1    105  15023
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.75958884, 'recall': 0.6267665, 'specificity': 0.6267665, 'f1': 0.66833586, 'auroc': 0.94320655, 'binary_precision': 0.5432526, 'binary_recall': 0.26079735, 'binary_specificity': 0.9927357, 'binary_f1_score': 0.35241303}
confusion matrix:
       0    1
0  18039  132
1    445  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549607, 'precision': 0.5038885, 'recall': 0.5007138, 'specificity': 0.5007138, 'f1': 0.49549454, 'auroc': 0.8767981, 'binary_precision': 0.046511628, 'binary_recall': 0.008264462, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.014035087}
confusion matrix:
      0   1
0  5956  41
1   240   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628977_30.png
early stop counter: 4
val acc:0.9692643880844116, best validation acc: 0.9802908301353455, corresponding to test acc:                         0.9594486355781555 / 0.9716300964355469
after epoch: 30,now: 2024-07-01 03:56:37.876598,epoch time: 0:22:51.410467,used: 11:31:25.850805,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_12_seed_2_21628977
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:31:25.850805 at 2024-07-01 03:56:37.876598
persisted model performance metric: 

scalar performance:
{'acc': 0.95944864, 'precision': 0.6873557, 'recall': 0.5486514, 'specificity': 0.5486514, 'f1': 0.5721181, 'auroc': 0.90351754, 'binary_precision': 0.40983605, 'binary_recall': 0.10330579, 'binary_specificity': 0.993997, 'binary_f1_score': 0.16501649}
confusion matrix:
      0   1
0  5961  36
1   217  25
oracle model performance metric: 

scalar performance:
{'acc': 0.9716301, 'precision': 0.89793897, 'recall': 0.66998684, 'specificity': 0.66998684, 'f1': 0.73468953, 'auroc': 0.947389, 'binary_precision': 0.8217822, 'binary_recall': 0.3429752, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.483965}
confusion matrix:
      0   1
0  5979  18
1   159  83
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 369159 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool | 337306 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |  31853 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 369159 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool | 337306 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |  31853 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362640 KiB |   9125 MiB |   3660 TiB |   3660 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   3612 TiB |   3612 TiB |
|       from small pool |  30850 KiB |     50 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10004 MiB |  10022 MiB |  28584 MiB |  18580 MiB |
|       from large pool |   9950 MiB |   9962 MiB |  28492 MiB |  18542 MiB |
|       from small pool |     54 MiB |     60 MiB |     92 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 386552 KiB |    879 MiB |   2635 TiB |   2635 TiB |
|       from large pool | 377446 KiB |    872 MiB |   2587 TiB |   2587 TiB |
|       from small pool |   9106 KiB |     32 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3305    |    8014    |  663605 K  |  663602 K  |
|       from large pool |     151    |     986    |  339597 K  |  339597 K  |
|       from small pool |    3154    |    7861    |  324008 K  |  324004 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3305    |    8014    |  663605 K  |  663602 K  |
|       from large pool |     151    |     986    |  339597 K  |  339597 K  |
|       from small pool |    3154    |    7861    |  324008 K  |  324004 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     442    |     445    |    1230    |     788    |
|       from large pool |     415    |     415    |    1184    |     769    |
|       from small pool |      27    |      30    |      46    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |    3641    |  434599 K  |  434599 K  |
|       from large pool |      35    |     417    |  275898 K  |  275898 K  |
|       from small pool |      38    |    3607    |  158700 K  |  158700 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |      0 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |      0 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   3660 TiB |   3660 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   3612 TiB |   3612 TiB |
|       from small pool |      0 KiB |     50 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  28584 MiB |  27846 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  28492 MiB |  27794 MiB |
|       from small pool |  40960 KiB |     60 MiB |     92 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    879 MiB |   2635 TiB |   2635 TiB |
|       from large pool |  24320 KiB |    872 MiB |   2587 TiB |   2587 TiB |
|       from small pool |      0 KiB |     32 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8014    |  663605 K  |  663605 K  |
|       from large pool |       2    |     986    |  339597 K  |  339597 K  |
|       from small pool |       0    |    7861    |  324008 K  |  324008 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8014    |  663605 K  |  663605 K  |
|       from large pool |       2    |     986    |  339597 K  |  339597 K  |
|       from small pool |       0    |    7861    |  324008 K  |  324008 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |    1230    |    1179    |
|       from large pool |      31    |     415    |    1184    |    1153    |
|       from small pool |      20    |      30    |      46    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3641    |  434600 K  |  434600 K  |
|       from large pool |       3    |     417    |  275898 K  |  275898 K  |
|       from small pool |       0    |    3607    |  158702 K  |  158702 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul  1 03:57:57 2024]
Finished job 0.
1 of 1 steps (100%) done
