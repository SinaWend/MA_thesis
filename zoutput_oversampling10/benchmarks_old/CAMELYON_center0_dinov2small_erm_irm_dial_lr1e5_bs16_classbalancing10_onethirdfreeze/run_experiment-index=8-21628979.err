Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 29 18:11:23 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979

 Experiment start at: 2024-06-29 18:16:31.361603
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99190044, 'precision': 0.9921776, 'recall': 0.9866291, 'specificity': 0.9866291, 'f1': 0.9893623, 'auroc': 0.9992376, 'binary_precision': 0.9927401, 'binary_recall': 0.97573906, 'binary_specificity': 0.9975192, 'binary_f1_score': 0.98416615}
confusion matrix:
       0      1
0  42220    105
1    357  14358
---- Validation: 
scalar performance:
{'acc': 0.9701469, 'precision': 0.83899957, 'recall': 0.60801685, 'specificity': 0.60801685, 'f1': 0.6596253, 'auroc': 0.95468414, 'binary_precision': 0.705, 'binary_recall': 0.21928461, 'binary_specificity': 0.9967491, 'binary_f1_score': 0.33451957}
confusion matrix:
       0    1
0  18090   59
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.951992, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-29 19:42:13.587133,epoch time: 1:25:42.225530,used: 1:25:42.225530,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9892882, 'precision': 0.9928843, 'recall': 0.9792431, 'specificity': 0.9792431, 'f1': 0.98581815, 'auroc': 0.99940896, 'binary_precision': 1.0, 'binary_recall': 0.9584862, 'binary_specificity': 1.0, 'binary_f1_score': 0.9788031}
confusion matrix:
       0      1
0  42322      0
1    611  14107
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.84713763, 'recall': 0.51841456, 'specificity': 0.51841456, 'f1': 0.5269953, 'auroc': 0.9642532, 'binary_precision': 0.72727275, 'binary_recall': 0.03732504, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.07100592}
confusion matrix:
       0   1
0  18140   9
1    619  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.9796833, 'recall': 0.51341, 'specificity': 0.51341, 'f1': 0.51575035, 'auroc': 0.96482474, 'binary_precision': 1.0, 'binary_recall': 0.026819924, 'binary_specificity': 1.0, 'binary_f1_score': 0.052238807}
confusion matrix:
      0  1
0  5997  0
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_2.png
new oracle model saved
early stop counter: 1
val acc:0.9665815234184265, best validation acc: 0.970146894454956, corresponding to test acc:                         0.9586129784584045 / 0.9594119787216187
after epoch: 2,now: 2024-06-29 21:05:41.155087,epoch time: 1:23:27.567954,used: 2:49:09.793484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99568725, 'precision': 0.9968361, 'recall': 0.9919071, 'specificity': 0.9919071, 'f1': 0.9943396, 'auroc': 0.99959135, 'binary_precision': 0.99917203, 'binary_recall': 0.98409784, 'binary_specificity': 0.99971646, 'binary_f1_score': 0.9915776}
confusion matrix:
       0      1
0  42313     12
1    234  14481
---- Validation: 
scalar performance:
{'acc': 0.9698276, 'precision': 0.84780276, 'recall': 0.5943506, 'specificity': 0.5943506, 'f1': 0.6435816, 'auroc': 0.95699894, 'binary_precision': 0.7235294, 'binary_recall': 0.19129083, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.30258304}
confusion matrix:
       0    1
0  18102   47
1    520  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7757369, 'recall': 0.5427273, 'specificity': 0.5427273, 'f1': 0.5662705, 'auroc': 0.9404167, 'binary_precision': 0.5897436, 'binary_recall': 0.08812261, 'binary_specificity': 0.997332, 'binary_f1_score': 0.15333334}
confusion matrix:
      0   1
0  5981  16
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_3.png
early stop counter: 2
val acc:0.9698275923728943, best validation acc: 0.970146894454956, corresponding to test acc:                         0.9586129784584045 / 0.9594119787216187
after epoch: 3,now: 2024-06-29 22:29:37.115208,epoch time: 1:23:55.960121,used: 4:13:05.753605,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.996406, 'precision': 0.99577653, 'recall': 0.99483025, 'specificity': 0.99483025, 'f1': 0.9953022, 'auroc': 0.9997376, 'binary_precision': 0.99448, 'binary_recall': 0.99157435, 'binary_specificity': 0.99808615, 'binary_f1_score': 0.993025}
confusion matrix:
       0      1
0  42242     81
1    124  14593
---- Validation: 
scalar performance:
{'acc': 0.9713176, 'precision': 0.78409564, 'recall': 0.7751352, 'specificity': 0.7751352, 'f1': 0.7795361, 'auroc': 0.94749904, 'binary_precision': 0.5836013, 'binary_recall': 0.5645412, 'binary_specificity': 0.9857292, 'binary_f1_score': 0.57391304}
confusion matrix:
       0    1
0  17890  259
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.8535429, 'recall': 0.65275455, 'specificity': 0.65275455, 'f1': 0.7097244, 'auroc': 0.96047336, 'binary_precision': 0.73636365, 'binary_recall': 0.31034482, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.43665767}
confusion matrix:
      0   1
0  5968  29
1   180  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-29 23:53:20.326144,epoch time: 1:23:43.210936,used: 5:36:48.964541,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99037516, 'precision': 0.993573, 'recall': 0.98137283, 'specificity': 0.98137283, 'f1': 0.98727655, 'auroc': 0.9996139, 'binary_precision': 0.9999294, 'binary_recall': 0.9627692, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9809975}
confusion matrix:
       0      1
0  42320      1
1    548  14171
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.77073884, 'recall': 0.6066945, 'specificity': 0.6066945, 'f1': 0.6499506, 'auroc': 0.94729376, 'binary_precision': 0.5685484, 'binary_recall': 0.21928461, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.31649834}
confusion matrix:
       0    1
0  18042  107
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.4791367, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.48922622, 'auroc': 0.95273995, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_5.png
early stop counter: 1
val acc:0.9675925970077515, best validation acc: 0.9713175892829895, corresponding to test acc:                         0.9666027426719666 / 0.9666027426719666
after epoch: 5,now: 2024-06-30 01:16:50.167097,epoch time: 1:23:29.840953,used: 7:00:18.805494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9954593, 'precision': 0.9935641, 'recall': 0.99459076, 'specificity': 0.99459076, 'f1': 0.9940761, 'auroc': 0.9998109, 'binary_precision': 0.9896355, 'binary_recall': 0.9927965, 'binary_specificity': 0.9963851, 'binary_f1_score': 0.9912135}
confusion matrix:
       0      1
0  42172    153
1    106  14609
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74668336, 'recall': 0.841468, 'specificity': 0.841468, 'f1': 0.78548384, 'auroc': 0.9613327, 'binary_precision': 0.503876, 'binary_recall': 0.7076205, 'binary_specificity': 0.97531545, 'binary_f1_score': 0.5886158}
confusion matrix:
       0    1
0  17701  448
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9506232, 'precision': 0.5839047, 'recall': 0.52714765, 'specificity': 0.52714765, 'f1': 0.53687066, 'auroc': 0.91751003, 'binary_precision': 0.20731707, 'binary_recall': 0.0651341, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.09912537}
confusion matrix:
      0   1
0  5932  65
1   244  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_6.png
early stop counter: 2
val acc:0.9661558270454407, best validation acc: 0.9713175892829895, corresponding to test acc:                         0.9666027426719666 / 0.9666027426719666
after epoch: 6,now: 2024-06-30 02:40:06.645049,epoch time: 1:23:16.477952,used: 8:23:35.283446,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9968794, 'precision': 0.9973186, 'recall': 0.99452806, 'specificity': 0.99452806, 'f1': 0.995913, 'auroc': 0.9996884, 'binary_precision': 0.9982178, 'binary_recall': 0.9896704, 'binary_specificity': 0.9993857, 'binary_f1_score': 0.99392575}
confusion matrix:
       0      1
0  42299     26
1    152  14563
---- Validation: 
scalar performance:
{'acc': 0.97184974, 'precision': 0.8189909, 'recall': 0.67940366, 'specificity': 0.67940366, 'f1': 0.7280055, 'auroc': 0.9420533, 'binary_precision': 0.6601124, 'binary_recall': 0.36547434, 'binary_specificity': 0.993333, 'binary_f1_score': 0.4704705}
confusion matrix:
       0    1
0  18028  121
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7757369, 'recall': 0.5427273, 'specificity': 0.5427273, 'f1': 0.5662705, 'auroc': 0.9024974, 'binary_precision': 0.5897436, 'binary_recall': 0.08812261, 'binary_specificity': 0.997332, 'binary_f1_score': 0.15333334}
confusion matrix:
      0   1
0  5981  16
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_7.png
better model found
persisted
after epoch: 7,now: 2024-06-30 04:03:19.819986,epoch time: 1:23:13.174937,used: 9:46:48.458383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.996669, 'precision': 0.99772, 'recall': 0.9935883, 'specificity': 0.9935883, 'f1': 0.9956317, 'auroc': 0.9997527, 'binary_precision': 0.9998624, 'binary_recall': 0.9872239, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9935029}
confusion matrix:
       0      1
0  42323      2
1    188  14527
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.80135053, 'recall': 0.56169116, 'specificity': 0.56169116, 'f1': 0.5967868, 'auroc': 0.94804645, 'binary_precision': 0.6328125, 'binary_recall': 0.125972, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.21011673}
confusion matrix:
       0   1
0  18102  47
1    562  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.9225799, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_8.png
early stop counter: 1
val acc:0.9675925970077515, best validation acc: 0.9718497395515442, corresponding to test acc:                         0.9594119787216187 / 0.9666027426719666
after epoch: 8,now: 2024-06-30 05:26:23.333987,epoch time: 1:23:03.514001,used: 11:09:51.972384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99701965, 'precision': 0.997977, 'recall': 0.9942461, 'specificity': 0.9942461, 'f1': 0.9960933, 'auroc': 0.9998369, 'binary_precision': 0.9999313, 'binary_recall': 0.9885159, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9941908}
confusion matrix:
       0      1
0  42323      1
1    169  14547
---- Validation: 
scalar performance:
{'acc': 0.97115797, 'precision': 0.9286277, 'recall': 0.5897889, 'specificity': 0.5897889, 'f1': 0.6425087, 'auroc': 0.9657228, 'binary_precision': 0.8854962, 'binary_recall': 0.18040435, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.2997416}
confusion matrix:
       0    1
0  18134   15
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.9374155, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_9.png
early stop counter: 2
val acc:0.971157968044281, best validation acc: 0.9718497395515442, corresponding to test acc:                         0.9594119787216187 / 0.9666027426719666
after epoch: 9,now: 2024-06-30 06:49:46.825471,epoch time: 1:23:23.491484,used: 12:33:15.463868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9965638, 'precision': 0.9965246, 'recall': 0.99449277, 'specificity': 0.99449277, 'f1': 0.9955032, 'auroc': 0.9998106, 'binary_precision': 0.996444, 'binary_recall': 0.99021405, 'binary_specificity': 0.9987714, 'binary_f1_score': 0.9933192}
confusion matrix:
       0      1
0  42273     52
1    144  14571
---- Validation: 
scalar performance:
{'acc': 0.94705194, 'precision': 0.64705867, 'recall': 0.71231884, 'specificity': 0.71231884, 'f1': 0.67269486, 'auroc': 0.92435765, 'binary_precision': 0.31355932, 'binary_recall': 0.46034214, 'binary_specificity': 0.96429557, 'binary_f1_score': 0.37303087}
confusion matrix:
       0    1
0  17501  648
1    347  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92793226, 'precision': 0.61657387, 'recall': 0.6728891, 'specificity': 0.6728891, 'f1': 0.63775814, 'auroc': 0.9153472, 'binary_precision': 0.26010102, 'binary_recall': 0.394636, 'binary_specificity': 0.95114225, 'binary_f1_score': 0.31354645}
confusion matrix:
      0    1
0  5704  293
1   158  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_10.png
early stop counter: 3
val acc:0.9470519423484802, best validation acc: 0.9718497395515442, corresponding to test acc:                         0.9594119787216187 / 0.9666027426719666
after epoch: 10,now: 2024-06-30 08:13:08.385866,epoch time: 1:23:21.560395,used: 13:56:37.024263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9957398, 'precision': 0.9970998, 'recall': 0.991788, 'specificity': 0.991788, 'f1': 0.9944067, 'auroc': 0.9997266, 'binary_precision': 0.99986184, 'binary_recall': 0.98362327, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9916761}
confusion matrix:
       0      1
0  42322      2
1    241  14475
---- Validation: 
scalar performance:
{'acc': 0.9720626, 'precision': 0.88594806, 'recall': 0.6217596, 'specificity': 0.6217596, 'f1': 0.6807273, 'auroc': 0.9567865, 'binary_precision': 0.7979798, 'binary_recall': 0.24572317, 'binary_specificity': 0.997796, 'binary_f1_score': 0.37574315}
confusion matrix:
       0    1
0  18109   40
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.96590406, 'recall': 0.5593036, 'specificity': 0.5593036, 'f1': 0.59635264, 'auroc': 0.9464953, 'binary_precision': 0.96875, 'binary_recall': 0.118773945, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.21160409}
confusion matrix:
      0   1
0  5996   1
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_11.png
better model found
persisted
after epoch: 11,now: 2024-06-30 09:36:09.952943,epoch time: 1:23:01.567077,used: 15:19:38.591340,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99635345, 'precision': 0.99719095, 'recall': 0.99328744, 'specificity': 0.99328744, 'f1': 0.9952191, 'auroc': 0.9997593, 'binary_precision': 0.9988996, 'binary_recall': 0.98695296, 'binary_specificity': 0.999622, 'binary_f1_score': 0.99289036}
confusion matrix:
       0      1
0  42308     16
1    192  14524
---- Validation: 
scalar performance:
{'acc': 0.97035974, 'precision': 0.8099545, 'recall': 0.6463799, 'specificity': 0.6463799, 'f1': 0.69643795, 'auroc': 0.9611192, 'binary_precision': 0.6442953, 'binary_recall': 0.29860032, 'binary_specificity': 0.99415946, 'binary_f1_score': 0.40807652}
confusion matrix:
       0    1
0  18043  106
1    451  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709172, 'precision': 0.89262646, 'recall': 0.69531703, 'specificity': 0.69531703, 'f1': 0.7579606, 'auroc': 0.9573438, 'binary_precision': 0.8110236, 'binary_recall': 0.394636, 'binary_specificity': 0.995998, 'binary_f1_score': 0.53092784}
confusion matrix:
      0    1
0  5973   24
1   158  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_12.png
new oracle model saved
early stop counter: 1
val acc:0.970359742641449, best validation acc: 0.9720625877380371, corresponding to test acc:                         0.963087260723114 / 0.9709172248840332
after epoch: 12,now: 2024-06-30 10:59:51.473107,epoch time: 1:23:41.520164,used: 16:43:20.111504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9978962, 'precision': 0.9983839, 'recall': 0.996123, 'specificity': 0.996123, 'f1': 0.9972467, 'auroc': 0.9999217, 'binary_precision': 0.9993843, 'binary_recall': 0.9924587, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.99590945}
confusion matrix:
       0      1
0  42312      9
1    111  14608
---- Validation: 
scalar performance:
{'acc': 0.9747765, 'precision': 0.9106951, 'recall': 0.65991735, 'specificity': 0.65991735, 'f1': 0.72664964, 'auroc': 0.9663738, 'binary_precision': 0.844898, 'binary_recall': 0.32192847, 'binary_specificity': 0.9979062, 'binary_f1_score': 0.4662162}
confusion matrix:
       0    1
0  18111   38
1    436  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.67928994, 'recall': 0.5035813, 'specificity': 0.5035813, 'f1': 0.49682495, 'auroc': 0.95080525, 'binary_precision': 0.4, 'binary_recall': 0.007662835, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.015037594}
confusion matrix:
      0  1
0  5994  3
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_13.png
better model found
persisted
after epoch: 13,now: 2024-06-30 12:23:09.664142,epoch time: 1:23:18.191035,used: 18:06:38.302539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9982118, 'precision': 0.9986856, 'recall': 0.99664545, 'specificity': 0.99664545, 'f1': 0.99766004, 'auroc': 0.9998901, 'binary_precision': 0.9996581, 'binary_recall': 0.993409, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9965238}
confusion matrix:
       0      1
0  42318      5
1     97  14620
---- Validation: 
scalar performance:
{'acc': 0.97349936, 'precision': 0.7922683, 'recall': 0.8445198, 'specificity': 0.8445198, 'f1': 0.8160192, 'auroc': 0.9654933, 'binary_precision': 0.59501964, 'binary_recall': 0.7060653, 'binary_specificity': 0.9829743, 'binary_f1_score': 0.64580363}
confusion matrix:
       0    1
0  17840  309
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.8943062, 'recall': 0.70672786, 'specificity': 0.70672786, 'f1': 0.76864797, 'auroc': 0.95471287, 'binary_precision': 0.8134328, 'binary_recall': 0.41762453, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.5518987}
confusion matrix:
      0    1
0  5972   25
1   152  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_14.png
new oracle model saved
early stop counter: 1
val acc:0.9734993577003479, best validation acc: 0.9747765064239502, corresponding to test acc:                         0.9581335783004761 / 0.9717162251472473
after epoch: 14,now: 2024-06-30 13:46:19.940675,epoch time: 1:23:10.276533,used: 19:29:48.579072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9978436, 'precision': 0.99839354, 'recall': 0.99597657, 'specificity': 0.99597657, 'f1': 0.9971773, 'auroc': 0.9998914, 'binary_precision': 0.99952084, 'binary_recall': 0.9921185, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.99580586}
confusion matrix:
       0      1
0  42315      7
1    116  14602
---- Validation: 
scalar performance:
{'acc': 0.97094506, 'precision': 0.9540421, 'recall': 0.58067805, 'specificity': 0.58067805, 'f1': 0.6305186, 'auroc': 0.97017366, 'binary_precision': 0.9369369, 'binary_recall': 0.16174184, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.2758621}
confusion matrix:
       0    1
0  18142    7
1    539  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9529034, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_15.png
early stop counter: 2
val acc:0.9709450602531433, best validation acc: 0.9747765064239502, corresponding to test acc:                         0.9581335783004761 / 0.9717162251472473
after epoch: 15,now: 2024-06-30 15:09:59.700113,epoch time: 1:23:39.759438,used: 20:53:28.338510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9978436, 'precision': 0.99658513, 'recall': 0.9977934, 'specificity': 0.9977934, 'f1': 0.9971874, 'auroc': 0.99990964, 'binary_precision': 0.9939747, 'binary_recall': 0.9976896, 'binary_specificity': 0.99789715, 'binary_f1_score': 0.9958287}
confusion matrix:
       0      1
0  42235     89
1     34  14682
---- Validation: 
scalar performance:
{'acc': 0.9784483, 'precision': 0.8619618, 'recall': 0.78257716, 'specificity': 0.78257716, 'f1': 0.8169675, 'auroc': 0.9697864, 'binary_precision': 0.7389558, 'binary_recall': 0.57231724, 'binary_specificity': 0.9928371, 'binary_f1_score': 0.6450482}
confusion matrix:
       0    1
0  18019  130
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.85103154, 'recall': 0.5377306, 'specificity': 0.5377306, 'f1': 0.55930376, 'auroc': 0.95744264, 'binary_precision': 0.7407407, 'binary_recall': 0.07662835, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.13888888}
confusion matrix:
      0   1
0  5990   7
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_16.png
better model found
persisted
after epoch: 16,now: 2024-06-30 16:33:20.688121,epoch time: 1:23:20.988008,used: 22:16:49.326518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99803644, 'precision': 0.99756753, 'recall': 0.9973028, 'specificity': 0.9973028, 'f1': 0.9974351, 'auroc': 0.99987495, 'binary_precision': 0.99659956, 'binary_recall': 0.9957869, 'binary_specificity': 0.99881864, 'binary_f1_score': 0.99619305}
confusion matrix:
       0      1
0  42274     50
1     62  14654
---- Validation: 
scalar performance:
{'acc': 0.97126436, 'precision': 0.80160034, 'recall': 0.69710195, 'specificity': 0.69710195, 'f1': 0.73740953, 'auroc': 0.9637689, 'binary_precision': 0.6240964, 'binary_recall': 0.40279937, 'binary_specificity': 0.9914045, 'binary_f1_score': 0.489603}
confusion matrix:
       0    1
0  17993  156
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.8077984, 'recall': 0.61035883, 'specificity': 0.61035883, 'f1': 0.6579951, 'auroc': 0.9390601, 'binary_precision': 0.64835167, 'binary_recall': 0.22605364, 'binary_specificity': 0.994664, 'binary_f1_score': 0.33522725}
confusion matrix:
      0   1
0  5965  32
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_17.png
early stop counter: 1
val acc:0.9712643623352051, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9603707194328308 / 0.9717162251472473
after epoch: 17,now: 2024-06-30 17:54:00.814952,epoch time: 1:20:40.126831,used: 23:37:29.453349,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9979313, 'precision': 0.9974083, 'recall': 0.99718773, 'specificity': 0.99718773, 'f1': 0.9972979, 'auroc': 0.99991536, 'binary_precision': 0.9963283, 'binary_recall': 0.9956513, 'binary_specificity': 0.9987241, 'binary_f1_score': 0.9959897}
confusion matrix:
       0      1
0  42269     54
1     64  14653
---- Validation: 
scalar performance:
{'acc': 0.9506173, 'precision': 0.68541604, 'recall': 0.83567363, 'specificity': 0.83567363, 'f1': 0.7353904, 'auroc': 0.9476495, 'binary_precision': 0.38134888, 'binary_recall': 0.7122862, 'binary_specificity': 0.9590611, 'binary_f1_score': 0.4967462}
confusion matrix:
       0    1
0  17406  743
1    185  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94135505, 'precision': 0.61026746, 'recall': 0.5919406, 'specificity': 0.5919406, 'f1': 0.60006183, 'auroc': 0.89166725, 'binary_precision': 0.25462964, 'binary_recall': 0.21072797, 'binary_specificity': 0.97315323, 'binary_f1_score': 0.23060797}
confusion matrix:
      0    1
0  5836  161
1   206   55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_18.png
early stop counter: 2
val acc:0.9506173133850098, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9603707194328308 / 0.9717162251472473
after epoch: 18,now: 2024-06-30 19:14:58.683039,epoch time: 1:20:57.868087,used: 1 day, 0:58:27.321436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99256665, 'precision': 0.9870075, 'recall': 0.9938384, 'specificity': 0.9938384, 'f1': 0.99035877, 'auroc': 0.9997488, 'binary_precision': 0.9752528, 'binary_recall': 0.99646544, 'binary_specificity': 0.9912115, 'binary_f1_score': 0.985745}
confusion matrix:
       0      1
0  41956    372
1     52  14660
---- Validation: 
scalar performance:
{'acc': 0.97376543, 'precision': 0.9306363, 'recall': 0.633142, 'specificity': 0.633142, 'f1': 0.6987878, 'auroc': 0.9577127, 'binary_precision': 0.88659793, 'binary_recall': 0.2674961, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.41099167}
confusion matrix:
       0    1
0  18127   22
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9584613, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_19.png
early stop counter: 3
val acc:0.9737654328346252, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9603707194328308 / 0.9717162251472473
after epoch: 19,now: 2024-06-30 20:36:02.118441,epoch time: 1:21:03.435402,used: 1 day, 2:19:30.756838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99873775, 'precision': 0.9988384, 'recall': 0.99786395, 'specificity': 0.99786395, 'f1': 0.9983499, 'auroc': 0.999956, 'binary_precision': 0.9990458, 'binary_recall': 0.9960587, 'binary_specificity': 0.9996692, 'binary_f1_score': 0.99754995}
confusion matrix:
       0      1
0  42310     14
1     58  14658
---- Validation: 
scalar performance:
{'acc': 0.9504044, 'precision': 0.6843984, 'recall': 0.8333132, 'specificity': 0.8333132, 'f1': 0.73397624, 'auroc': 0.950702, 'binary_precision': 0.3794829, 'binary_recall': 0.7076205, 'binary_specificity': 0.959006, 'binary_f1_score': 0.4940282}
confusion matrix:
       0    1
0  17405  744
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93176734, 'precision': 0.5201895, 'recall': 0.5154771, 'specificity': 0.5154771, 'f1': 0.5171508, 'auroc': 0.9028909, 'binary_precision': 0.08080808, 'binary_recall': 0.06130268, 'binary_specificity': 0.9696515, 'binary_f1_score': 0.069716774}
confusion matrix:
      0    1
0  5815  182
1   245   16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_20.png
early stop counter: 4
val acc:0.9504044055938721, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9603707194328308 / 0.9717162251472473
after epoch: 20,now: 2024-06-30 21:57:03.743273,epoch time: 1:21:01.624832,used: 1 day, 3:40:32.381670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9986501, 'precision': 0.9990248, 'recall': 0.99745065, 'specificity': 0.99745065, 'f1': 0.99823445, 'auroc': 0.9999602, 'binary_precision': 0.9997952, 'binary_recall': 0.99497217, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9973778}
confusion matrix:
       0      1
0  42319      3
1     74  14644
---- Validation: 
scalar performance:
{'acc': 0.97498935, 'precision': 0.8279626, 'recall': 0.75753474, 'specificity': 0.75753474, 'f1': 0.7881315, 'auroc': 0.96708673, 'binary_precision': 0.6726547, 'binary_recall': 0.5241057, 'binary_specificity': 0.9909637, 'binary_f1_score': 0.5891608}
confusion matrix:
       0    1
0  17985  164
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95557684, 'precision': 0.5445277, 'recall': 0.50407964, 'specificity': 0.50407964, 'f1': 0.49919972, 'auroc': 0.93000424, 'binary_precision': 0.13043478, 'binary_recall': 0.011494253, 'binary_specificity': 0.996665, 'binary_f1_score': 0.02112676}
confusion matrix:
      0   1
0  5977  20
1   258   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_21.png
early stop counter: 5
val acc:0.9749893546104431, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9603707194328308 / 0.9717162251472473
after epoch: 21,now: 2024-06-30 23:17:58.742834,epoch time: 1:20:54.999561,used: 1 day, 5:01:27.381231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9980891, 'precision': 0.9987156, 'recall': 0.99629676, 'specificity': 0.99629676, 'f1': 0.9974985, 'auroc': 0.9999343, 'binary_precision': 1.0, 'binary_recall': 0.9925936, 'binary_specificity': 1.0, 'binary_f1_score': 0.99628305}
confusion matrix:
       0      1
0  42323      0
1    109  14608
---- Validation: 
scalar performance:
{'acc': 0.9735526, 'precision': 0.9035249, 'recall': 0.6412824, 'specificity': 0.6412824, 'f1': 0.7052837, 'auroc': 0.96999043, 'binary_precision': 0.83181816, 'binary_recall': 0.28460342, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.42410198}
confusion matrix:
       0    1
0  18112   37
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.8132309, 'recall': 0.51874024, 'specificity': 0.51874024, 'f1': 0.52577436, 'auroc': 0.9441616, 'binary_precision': 0.6666667, 'binary_recall': 0.038314175, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.072463766}
confusion matrix:
      0   1
0  5992   5
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_22.png
early stop counter: 6
val acc:0.9735525846481323, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9603707194328308 / 0.9717162251472473
after epoch: 22,now: 2024-07-01 00:38:44.226041,epoch time: 1:20:45.483207,used: 1 day, 6:22:12.864438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9986501, 'precision': 0.99895775, 'recall': 0.99751645, 'specificity': 0.99751645, 'f1': 0.9982344, 'auroc': 0.9998921, 'binary_precision': 0.9995904, 'binary_recall': 0.99517465, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.99737763}
confusion matrix:
       0      1
0  42320      6
1     71  14643
---- Validation: 
scalar performance:
{'acc': 0.97679865, 'precision': 0.8435044, 'recall': 0.7749726, 'specificity': 0.7749726, 'f1': 0.8051077, 'auroc': 0.9724942, 'binary_precision': 0.70254403, 'binary_recall': 0.55832034, 'binary_specificity': 0.9916249, 'binary_f1_score': 0.6221837}
confusion matrix:
       0    1
0  17997  152
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.8716722, 'recall': 0.5473091, 'specificity': 0.5473091, 'f1': 0.5753839, 'auroc': 0.93995535, 'binary_precision': 0.78125, 'binary_recall': 0.09578544, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.17064846}
confusion matrix:
      0   1
0  5990   7
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_23.png
early stop counter: 7
val acc:0.9767986536026001, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9603707194328308 / 0.9717162251472473
after epoch: 23,now: 2024-07-01 01:59:24.621336,epoch time: 1:20:40.395295,used: 1 day, 7:42:53.259733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9985975, 'precision': 0.99894476, 'recall': 0.99739265, 'specificity': 0.99739265, 'f1': 0.99816555, 'auroc': 0.9999447, 'binary_precision': 0.9996586, 'binary_recall': 0.9949035, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99727535}
confusion matrix:
       0      1
0  42319      5
1     75  14641
---- Validation: 
scalar performance:
{'acc': 0.97333974, 'precision': 0.90648174, 'recall': 0.6359218, 'specificity': 0.6359218, 'f1': 0.69951075, 'auroc': 0.9739589, 'binary_precision': 0.83809525, 'binary_recall': 0.27371696, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.41266116}
confusion matrix:
       0    1
0  18115   34
1    467  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7651576, 'recall': 0.50741273, 'specificity': 0.50741273, 'f1': 0.5043114, 'auroc': 0.93860835, 'binary_precision': 0.5714286, 'binary_recall': 0.01532567, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.029850746}
confusion matrix:
      0  1
0  5994  3
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_24.png
early stop counter: 8
val acc:0.9733397364616394, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9603707194328308 / 0.9717162251472473
after epoch: 24,now: 2024-07-01 03:20:26.370728,epoch time: 1:21:01.749392,used: 1 day, 9:03:55.009125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9988429, 'precision': 0.9991321, 'recall': 0.9978465, 'specificity': 0.9978465, 'f1': 0.99848706, 'auroc': 0.99995863, 'binary_precision': 0.99972713, 'binary_recall': 0.99578744, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9977533}
confusion matrix:
       0      1
0  42318      4
1     62  14656
---- Validation: 
scalar performance:
{'acc': 0.9746169, 'precision': 0.88188845, 'recall': 0.67558587, 'specificity': 0.67558587, 'f1': 0.7378657, 'auroc': 0.97188985, 'binary_precision': 0.7862069, 'binary_recall': 0.35458788, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.48874602}
confusion matrix:
       0    1
0  18087   62
1    415  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.74010587, 'recall': 0.5239037, 'specificity': 0.5239037, 'f1': 0.53482497, 'auroc': 0.94229174, 'binary_precision': 0.52, 'binary_recall': 0.049808428, 'binary_specificity': 0.997999, 'binary_f1_score': 0.090909086}
confusion matrix:
      0   1
0  5985  12
1   248  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_25.png
early stop counter: 9
val acc:0.9746168851852417, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9603707194328308 / 0.9717162251472473
after epoch: 25,now: 2024-07-01 04:41:03.059479,epoch time: 1:20:36.688751,used: 1 day, 10:24:31.697876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99872017, 'precision': 0.9989157, 'recall': 0.99774104, 'specificity': 0.99774104, 'f1': 0.99832654, 'auroc': 0.9999672, 'binary_precision': 0.99931794, 'binary_recall': 0.99571836, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.9975149}
confusion matrix:
       0      1
0  42316     10
1     63  14651
---- Validation: 
scalar performance:
{'acc': 0.9762133, 'precision': 0.9093034, 'recall': 0.68691313, 'specificity': 0.68691313, 'f1': 0.7538378, 'auroc': 0.9715707, 'binary_precision': 0.8402778, 'binary_recall': 0.3763608, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.5198711}
confusion matrix:
       0    1
0  18103   46
1    401  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.92146814, 'recall': 0.52856886, 'specificity': 0.52856886, 'f1': 0.5438245, 'auroc': 0.94818723, 'binary_precision': 0.88235295, 'binary_recall': 0.057471264, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10791367}
confusion matrix:
      0   1
0  5995   2
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_26.png
early stop counter: 10
val acc:0.976213276386261, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9603707194328308 / 0.9717162251472473
after epoch: 26,now: 2024-07-01 06:01:51.837379,epoch time: 1:20:48.777900,used: 1 day, 11:45:20.475776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9984046, 'precision': 0.9988151, 'recall': 0.99701935, 'specificity': 0.99701935, 'f1': 0.997913, 'auroc': 0.9999119, 'binary_precision': 0.9996584, 'binary_recall': 0.99415684, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9969}
confusion matrix:
       0      1
0  42317      5
1     86  14632
---- Validation: 
scalar performance:
{'acc': 0.97307366, 'precision': 0.88978076, 'recall': 0.63953435, 'specificity': 0.63953435, 'f1': 0.70163465, 'auroc': 0.9598212, 'binary_precision': 0.80444443, 'binary_recall': 0.281493, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.41705066}
confusion matrix:
       0    1
0  18105   44
1    462  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.9267397, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_27.png
early stop counter: 11
val acc:0.9730736613273621, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9603707194328308 / 0.9717162251472473
after epoch: 27,now: 2024-07-01 07:22:38.443503,epoch time: 1:20:46.606124,used: 1 day, 13:06:07.081900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9978436, 'precision': 0.99855113, 'recall': 0.9958209, 'specificity': 0.9958209, 'f1': 0.9971762, 'auroc': 0.9998517, 'binary_precision': 1.0, 'binary_recall': 0.99164176, 'binary_specificity': 1.0, 'binary_f1_score': 0.99580336}
confusion matrix:
       0      1
0  42324      0
1    123  14593
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.97172576, 'recall': 0.53107667, 'specificity': 0.53107667, 'f1': 0.5502953, 'auroc': 0.9782696, 'binary_precision': 0.9756098, 'binary_recall': 0.0622084, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.116959065}
confusion matrix:
       0   1
0  18148   1
1    603  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.96203595, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_28.png
early stop counter: 12
val acc:0.9678586721420288, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9603707194328308 / 0.9717162251472473
after epoch: 28,now: 2024-07-01 08:43:47.182874,epoch time: 1:21:08.739371,used: 1 day, 14:27:15.821271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99908835, 'precision': 0.998942, 'recall': 0.99867654, 'specificity': 0.99867654, 'f1': 0.9988092, 'auroc': 0.9999665, 'binary_precision': 0.99863994, 'binary_recall': 0.9978256, 'binary_specificity': 0.99952745, 'binary_f1_score': 0.99823266}
confusion matrix:
       0      1
0  42303     20
1     32  14685
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.76985013, 'recall': 0.7908375, 'specificity': 0.7908375, 'f1': 0.7799075, 'auroc': 0.9525112, 'binary_precision': 0.5539568, 'binary_recall': 0.59875584, 'binary_specificity': 0.98291916, 'binary_f1_score': 0.57548577}
confusion matrix:
       0    1
0  17839  310
1    258  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9544583, 'precision': 0.51492774, 'recall': 0.5016637, 'specificity': 0.5016637, 'f1': 0.49526587, 'auroc': 0.9220929, 'binary_precision': 0.071428575, 'binary_recall': 0.007662835, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.013840831}
confusion matrix:
      0   1
0  5971  26
1   259   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_29.png
early stop counter: 13
val acc:0.9697743654251099, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9603707194328308 / 0.9717162251472473
after epoch: 29,now: 2024-07-01 10:04:32.620477,epoch time: 1:20:45.437603,used: 1 day, 15:48:01.258874,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9985799, 'precision': 0.9990225, 'recall': 0.9972702, 'specificity': 0.9972702, 'f1': 0.99814236, 'auroc': 0.99990046, 'binary_precision': 0.9999317, 'binary_recall': 0.9945641, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99724066}
confusion matrix:
       0      1
0  42322      1
1     80  14637
---- Validation: 
scalar performance:
{'acc': 0.9779161, 'precision': 0.953598, 'recall': 0.691545, 'specificity': 0.691545, 'f1': 0.7660694, 'auroc': 0.9719536, 'binary_precision': 0.9285714, 'binary_recall': 0.38413686, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.54345435}
confusion matrix:
       0    1
0  18130   19
1    396  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.96524894, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_30.png
early stop counter: 14
val acc:0.9779161214828491, best validation acc: 0.9784482717514038, corresponding to test acc:                         0.9603707194328308 / 0.9717162251472473
after epoch: 30,now: 2024-07-01 11:25:53.791634,epoch time: 1:21:21.171157,used: 1 day, 17:09:22.430031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_31_seed_0_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 1 day, 17:09:22.430031 at 2024-07-01 11:25:53.791634
persisted model performance metric: 

scalar performance:
{'acc': 0.9603707, 'precision': 0.85103154, 'recall': 0.5377306, 'specificity': 0.5377306, 'f1': 0.55930376, 'auroc': 0.95744264, 'binary_precision': 0.7407407, 'binary_recall': 0.07662835, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.13888888}
confusion matrix:
      0   1
0  5990   7
1   241  20
oracle model performance metric: 

scalar performance:
{'acc': 0.9717162, 'precision': 0.8943062, 'recall': 0.70672786, 'specificity': 0.70672786, 'f1': 0.76864797, 'auroc': 0.95471287, 'binary_precision': 0.8134328, 'binary_recall': 0.41762453, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.5518987}
confusion matrix:
      0    1
0  5972   25
1   152  109
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 370146 KiB |   6470 MiB |   5880 TiB |   5880 TiB |
|       from large pool | 338287 KiB |   6440 MiB |   5813 TiB |   5813 TiB |
|       from small pool |  31859 KiB |     51 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 370146 KiB |   6470 MiB |   5880 TiB |   5880 TiB |
|       from large pool | 338287 KiB |   6440 MiB |   5813 TiB |   5813 TiB |
|       from small pool |  31859 KiB |     51 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362641 KiB |   6466 MiB |   5869 TiB |   5869 TiB |
|       from large pool | 331790 KiB |   6436 MiB |   5802 TiB |   5802 TiB |
|       from small pool |  30851 KiB |     50 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7068 MiB |   7068 MiB |   7068 MiB |      0 B   |
|       from large pool |   7010 MiB |   7010 MiB |   7010 MiB |      0 B   |
|       from small pool |     58 MiB |     58 MiB |     58 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 234013 KiB | 658419 KiB |   3367 TiB |   3367 TiB |
|       from large pool | 224913 KiB | 654808 KiB |   3300 TiB |   3300 TiB |
|       from small pool |   9100 KiB |  10672 KiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3317    |    7944    |     789 M  |     789 M  |
|       from large pool |     151    |     723    |     544 M  |     544 M  |
|       from small pool |    3166    |    7792    |     244 M  |     244 M  |
|---------------------------------------------------------------------------|
| Active allocs         |    3317    |    7944    |     789 M  |     789 M  |
|       from large pool |     151    |     723    |     544 M  |     544 M  |
|       from small pool |    3166    |    7792    |     244 M  |     244 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     322    |     322    |     322    |       0    |
|       from large pool |     293    |     293    |     293    |       0    |
|       from small pool |      29    |      29    |      29    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |    3605    |  487209 K  |  487208 K  |
|       from large pool |      27    |     294    |  393184 K  |  393184 K  |
|       from small pool |      29    |    3578    |   94024 K  |   94024 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6470 MiB |   5880 TiB |   5880 TiB |
|       from large pool |  16640 KiB |   6440 MiB |   5813 TiB |   5813 TiB |
|       from small pool |      0 KiB |     51 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6470 MiB |   5880 TiB |   5880 TiB |
|       from large pool |  16640 KiB |   6440 MiB |   5813 TiB |   5813 TiB |
|       from small pool |      0 KiB |     51 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6466 MiB |   5869 TiB |   5869 TiB |
|       from large pool |  16640 KiB |   6436 MiB |   5802 TiB |   5802 TiB |
|       from small pool |      0 KiB |     50 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7068 MiB |   7068 MiB |   6478 MiB |
|       from large pool | 563200 KiB |   7010 MiB |   7010 MiB |   6460 MiB |
|       from small pool |  40960 KiB |     58 MiB |     58 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 658419 KiB |   3367 TiB |   3367 TiB |
|       from large pool |  24320 KiB | 654808 KiB |   3300 TiB |   3300 TiB |
|       from small pool |      0 KiB |  24437 KiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7944    |     789 M  |     789 M  |
|       from large pool |       2    |     723    |     544 M  |     544 M  |
|       from small pool |       0    |    7792    |     244 M  |     244 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7944    |     789 M  |     789 M  |
|       from large pool |       2    |     723    |     544 M  |     544 M  |
|       from small pool |       0    |    7792    |     244 M  |     244 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      46    |     322    |     322    |     276    |
|       from large pool |      26    |     293    |     293    |     267    |
|       from small pool |      20    |      29    |      29    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3605    |  487210 K  |  487210 K  |
|       from large pool |       3    |     294    |  393184 K  |  393184 K  |
|       from small pool |       0    |    3578    |   94026 K  |   94026 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6470 MiB |   5880 TiB |   5880 TiB |
|       from large pool |  16640 KiB |   6440 MiB |   5813 TiB |   5813 TiB |
|       from small pool |      0 KiB |     51 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6470 MiB |   5880 TiB |   5880 TiB |
|       from large pool |  16640 KiB |   6440 MiB |   5813 TiB |   5813 TiB |
|       from small pool |      0 KiB |     51 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6466 MiB |   5869 TiB |   5869 TiB |
|       from large pool |  16640 KiB |   6436 MiB |   5802 TiB |   5802 TiB |
|       from small pool |      0 KiB |     50 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7068 MiB |   7068 MiB |   6478 MiB |
|       from large pool | 563200 KiB |   7010 MiB |   7010 MiB |   6460 MiB |
|       from small pool |  40960 KiB |     58 MiB |     58 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 658419 KiB |   3367 TiB |   3367 TiB |
|       from large pool |  24320 KiB | 654808 KiB |   3300 TiB |   3300 TiB |
|       from small pool |      0 KiB |  24437 KiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7944    |     789 M  |     789 M  |
|       from large pool |       2    |     723    |     544 M  |     544 M  |
|       from small pool |       0    |    7792    |     244 M  |     244 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7944    |     789 M  |     789 M  |
|       from large pool |       2    |     723    |     544 M  |     544 M  |
|       from small pool |       0    |    7792    |     244 M  |     244 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      46    |     322    |     322    |     276    |
|       from large pool |      26    |     293    |     293    |     267    |
|       from small pool |      20    |      29    |      29    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3605    |  487210 K  |  487210 K  |
|       from large pool |       3    |     294    |  393184 K  |  393184 K  |
|       from small pool |       0    |    3578    |   94026 K  |   94026 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_11_33_05_seed_1_21628979

 Experiment start at: 2024-07-01 11:33:05.085654
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98851, 'precision': 0.98231006, 'recall': 0.9875863, 'specificity': 0.9875863, 'f1': 0.9849106, 'auroc': 0.99884444, 'binary_precision': 0.9695047, 'binary_recall': 0.98571134, 'binary_specificity': 0.9894613, 'binary_f1_score': 0.97754085}
confusion matrix:
       0      1
0  41968    447
1    206  14211
---- Validation: 
scalar performance:
{'acc': 0.94695836, 'precision': 0.6882191, 'recall': 0.87306917, 'specificity': 0.87306917, 'f1': 0.74493945, 'auroc': 0.947431, 'binary_precision': 0.38444924, 'binary_recall': 0.7934621, 'binary_specificity': 0.9526762, 'binary_f1_score': 0.51794374}
confusion matrix:
       0    1
0  17212  855
1    139  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9013858, 'precision': 0.62867373, 'recall': 0.8437146, 'specificity': 0.8437146, 'f1': 0.6725544, 'auroc': 0.92232674, 'binary_precision': 0.26781002, 'binary_recall': 0.7807692, 'binary_specificity': 0.90665996, 'binary_f1_score': 0.3988212}
confusion matrix:
      0    1
0  5391  555
1    57  203
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-01 12:55:13.931151,epoch time: 1:22:08.845497,used: 1:22:08.845497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_11_33_05_seed_1_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99306726, 'precision': 0.9947729, 'recall': 0.9869325, 'specificity': 0.9869325, 'f1': 0.9907737, 'auroc': 0.99943674, 'binary_precision': 0.99815303, 'binary_recall': 0.9744781, 'binary_specificity': 0.99938697, 'binary_f1_score': 0.9861735}
confusion matrix:
       0      1
0  42387     26
1    368  14051
---- Validation: 
scalar performance:
{'acc': 0.9688367, 'precision': 0.7765346, 'recall': 0.76067454, 'specificity': 0.76067454, 'f1': 0.7683444, 'auroc': 0.9578446, 'binary_precision': 0.57030016, 'binary_recall': 0.53640413, 'binary_specificity': 0.98494494, 'binary_f1_score': 0.5528331}
confusion matrix:
       0    1
0  17795  272
1    312  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.74802876, 'recall': 0.527753, 'specificity': 0.527753, 'f1': 0.5414433, 'auroc': 0.9460699, 'binary_precision': 0.53571427, 'binary_recall': 0.057692308, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.10416667}
confusion matrix:
      0   1
0  5933  13
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-01 14:16:36.975087,epoch time: 1:21:23.043936,used: 2:43:31.889433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_11_33_05_seed_1_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9947037, 'precision': 0.9921801, 'recall': 0.99386525, 'specificity': 0.99386525, 'f1': 0.99301887, 'auroc': 0.99961793, 'binary_precision': 0.98702914, 'binary_recall': 0.9921631, 'binary_specificity': 0.9955674, 'binary_f1_score': 0.98958945}
confusion matrix:
       0      1
0  42225    188
1    113  14306
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.74664676, 'recall': 0.8250081, 'specificity': 0.8250081, 'f1': 0.77975625, 'auroc': 0.9500534, 'binary_precision': 0.5055679, 'binary_recall': 0.67459136, 'binary_specificity': 0.9754248, 'binary_f1_score': 0.5779758}
confusion matrix:
       0    1
0  17623  444
1    219  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.7536905, 'recall': 0.6923478, 'specificity': 0.6923478, 'f1': 0.71824276, 'auroc': 0.90538824, 'binary_precision': 0.53333336, 'binary_recall': 0.4, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.45714286}
confusion matrix:
      0    1
0  5855   91
1   156  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_3.png
new oracle model saved
early stop counter: 1
val acc:0.9646211266517639, best validation acc: 0.9688367247581482, corresponding to test acc:                         0.9584273099899292 / 0.9601998329162598
after epoch: 3,now: 2024-07-01 15:37:30.350364,epoch time: 1:20:53.375277,used: 4:04:25.264710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_11_33_05_seed_1_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.994862, 'precision': 0.9965811, 'recall': 0.9898752, 'specificity': 0.9898752, 'f1': 0.9931705, 'auroc': 0.9997828, 'binary_precision': 1.0, 'binary_recall': 0.97975034, 'binary_specificity': 1.0, 'binary_f1_score': 0.9897716}
confusion matrix:
       0      1
0  42412      0
1    292  14128
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.91318667, 'recall': 0.5450427, 'specificity': 0.5450427, 'f1': 0.5735234, 'auroc': 0.9588108, 'binary_precision': 0.85915494, 'binary_recall': 0.09063893, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.16397849}
confusion matrix:
       0   1
0  18057  10
1    612  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.9604883, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628979_4.png
early stop counter: 2
val acc:0.9668089747428894, best validation acc: 0.9688367247581482, corresponding to test acc:                         0.9584273099899292 / 0.9601998329162598
after epoch: 4,now: 2024-07-01 16:58:18.006651,epoch time: 1:20:47.656287,used: 5:25:12.920997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_11_33_05_seed_1_21628979
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21628979 ON gpusrv43 CANCELLED AT 2024-07-01T18:11:41 DUE TO TIME LIMIT ***
