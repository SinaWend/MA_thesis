Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 29 18:11:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982

 Experiment start at: 2024-06-29 18:17:30.603528
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99191797, 'precision': 0.9898393, 'recall': 0.9890348, 'specificity': 0.9890348, 'f1': 0.98943615, 'auroc': 0.99908376, 'binary_precision': 0.9855566, 'binary_recall': 0.9830785, 'binary_specificity': 0.9949911, 'binary_f1_score': 0.98431593}
confusion matrix:
       0      1
0  42113    212
1    249  14466
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.90330994, 'precision': 0.62052834, 'recall': 0.89293796, 'specificity': 0.89293796, 'f1': 0.6659061, 'auroc': 0.94647217, 'binary_precision': 0.24566725, 'binary_recall': 0.88180405, 'binary_specificity': 0.90407187, 'binary_f1_score': 0.3842765}
confusion matrix:
       0     1
0  16408  1741
1     76   567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88143176, 'precision': 0.6102157, 'recall': 0.8373574, 'specificity': 0.8373574, 'f1': 0.6458568, 'auroc': 0.905645, 'binary_precision': 0.23068309, 'binary_recall': 0.789272, 'binary_specificity': 0.88544273, 'binary_f1_score': 0.35701904}
confusion matrix:
      0    1
0  5310  687
1    55  206
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-29 18:41:07.581457,epoch time: 0:23:36.977929,used: 0:23:36.977929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9941269, 'precision': 0.9957262, 'recall': 0.98895025, 'specificity': 0.98895025, 'f1': 0.9922777, 'auroc': 0.9993501, 'binary_precision': 0.9989591, 'binary_recall': 0.978255, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.9884987}
confusion matrix:
       0      1
0  42309     15
1    320  14396
---- Validation: 
scalar performance:
{'acc': 0.97232866, 'precision': 0.8672704, 'recall': 0.6383985, 'specificity': 0.6383985, 'f1': 0.6974618, 'auroc': 0.9422785, 'binary_precision': 0.75949365, 'binary_recall': 0.2799378, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.40909094}
confusion matrix:
       0    1
0  18092   57
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.9440254, 'recall': 0.547726, 'specificity': 0.547726, 'f1': 0.5770738, 'auroc': 0.94807506, 'binary_precision': 0.9259259, 'binary_recall': 0.09578544, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.1736111}
confusion matrix:
      0   1
0  5995   2
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-29 19:03:53.844617,epoch time: 0:22:46.263160,used: 0:46:23.241089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.992777, 'precision': 0.99513257, 'recall': 0.98604786, 'specificity': 0.98604786, 'f1': 0.9904813, 'auroc': 0.9996021, 'binary_precision': 0.9998602, 'binary_recall': 0.97214293, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.98580676}
confusion matrix:
       0      1
0  42320      2
1    410  14308
---- Validation: 
scalar performance:
{'acc': 0.96934867, 'precision': 0.9042131, 'recall': 0.5641004, 'specificity': 0.5641004, 'f1': 0.60404265, 'auroc': 0.9584973, 'binary_precision': 0.83838385, 'binary_recall': 0.12908243, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.22371967}
confusion matrix:
       0   1
0  18133  16
1    560  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.6459533, 'recall': 0.50349796, 'specificity': 0.50349796, 'f1': 0.4967551, 'auroc': 0.9339213, 'binary_precision': 0.33333334, 'binary_recall': 0.007662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.014981273}
confusion matrix:
      0  1
0  5993  4
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_3.png
early stop counter: 1
val acc:0.969348669052124, best validation acc: 0.9723286628723145, corresponding to test acc:                         0.9619686603546143 / 0.9619686603546143
after epoch: 3,now: 2024-06-29 19:27:01.282348,epoch time: 0:23:07.437731,used: 1:09:30.678820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99537164, 'precision': 0.9959439, 'recall': 0.99196255, 'specificity': 0.99196255, 'f1': 0.99393225, 'auroc': 0.9997516, 'binary_precision': 0.9971112, 'binary_recall': 0.98491746, 'binary_specificity': 0.9990076, 'binary_f1_score': 0.9909768}
confusion matrix:
       0      1
0  42279     42
1    222  14497
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7447781, 'recall': 0.83455217, 'specificity': 0.83455217, 'f1': 0.7818389, 'auroc': 0.9565411, 'binary_precision': 0.5005612, 'binary_recall': 0.69362366, 'binary_specificity': 0.97548074, 'binary_f1_score': 0.58148634}
confusion matrix:
       0    1
0  17704  445
1    197  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95557684, 'precision': 0.7188259, 'recall': 0.6946423, 'specificity': 0.6946423, 'f1': 0.70591944, 'auroc': 0.9128862, 'binary_precision': 0.46320346, 'binary_recall': 0.4099617, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.43495935}
confusion matrix:
      0    1
0  5873  124
1   154  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_4.png
early stop counter: 2
val acc:0.9658365249633789, best validation acc: 0.9723286628723145, corresponding to test acc:                         0.9619686603546143 / 0.9619686603546143
after epoch: 4,now: 2024-06-29 19:51:09.485948,epoch time: 0:24:08.203600,used: 1:33:38.882420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99465287, 'precision': 0.99616873, 'recall': 0.98988163, 'specificity': 0.98988163, 'f1': 0.99297297, 'auroc': 0.9997362, 'binary_precision': 0.9992379, 'binary_recall': 0.9800231, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.98953724}
confusion matrix:
       0      1
0  42312     11
1    294  14423
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.7929969, 'recall': 0.67249405, 'specificity': 0.67249405, 'f1': 0.71574086, 'auroc': 0.95153236, 'binary_precision': 0.6085791, 'binary_recall': 0.35303265, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.4468504}
confusion matrix:
       0    1
0  18003  146
1    416  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8557956, 'recall': 0.6358467, 'specificity': 0.6358467, 'f1': 0.69231653, 'auroc': 0.92695093, 'binary_precision': 0.742268, 'binary_recall': 0.27586207, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.40223464}
confusion matrix:
      0   1
0  5972  25
1   189  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_5.png
new oracle model saved
early stop counter: 3
val acc:0.9700936675071716, best validation acc: 0.9723286628723145, corresponding to test acc:                         0.9619686603546143 / 0.9658037424087524
after epoch: 5,now: 2024-06-29 20:13:57.263269,epoch time: 0:22:47.777321,used: 1:56:26.659741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9948633, 'precision': 0.99640095, 'recall': 0.99020064, 'specificity': 0.99020064, 'f1': 0.99325013, 'auroc': 0.9996111, 'binary_precision': 0.9995152, 'binary_recall': 0.9805667, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.9899503}
confusion matrix:
       0      1
0  42316      7
1    286  14431
---- Validation: 
scalar performance:
{'acc': 0.9690826, 'precision': 0.7870511, 'recall': 0.6427185, 'specificity': 0.6427185, 'f1': 0.68851596, 'auroc': 0.9518318, 'binary_precision': 0.5987261, 'binary_recall': 0.29237947, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.39289448}
confusion matrix:
       0    1
0  18023  126
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9533397, 'precision': 0.64411765, 'recall': 0.5505531, 'specificity': 0.5505531, 'f1': 0.5708565, 'auroc': 0.8944788, 'binary_precision': 0.3258427, 'binary_recall': 0.11111111, 'binary_specificity': 0.989995, 'binary_f1_score': 0.16571428}
confusion matrix:
      0   1
0  5937  60
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_6.png
early stop counter: 4
val acc:0.9690825939178467, best validation acc: 0.9723286628723145, corresponding to test acc:                         0.9619686603546143 / 0.9658037424087524
after epoch: 6,now: 2024-06-29 20:36:54.443879,epoch time: 0:22:57.180610,used: 2:19:23.840351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9967917, 'precision': 0.9975301, 'recall': 0.9940914, 'specificity': 0.9940914, 'f1': 0.99579513, 'auroc': 0.99987864, 'binary_precision': 0.99903834, 'binary_recall': 0.9885136, 'binary_specificity': 0.99966925, 'binary_f1_score': 0.99374807}
confusion matrix:
       0      1
0  42313     14
1    169  14544
---- Validation: 
scalar performance:
{'acc': 0.9698808, 'precision': 0.8149668, 'recall': 0.6236303, 'specificity': 0.6236303, 'f1': 0.67431, 'auroc': 0.96110153, 'binary_precision': 0.65587044, 'binary_recall': 0.251944, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.36404493}
confusion matrix:
       0    1
0  18064   85
1    481  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550975, 'precision': 0.59078, 'recall': 0.5129912, 'specificity': 0.5129912, 'f1': 0.51543754, 'auroc': 0.93791133, 'binary_precision': 0.22222222, 'binary_recall': 0.03065134, 'binary_specificity': 0.995331, 'binary_f1_score': 0.05387205}
confusion matrix:
      0   1
0  5969  28
1   253   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_7.png
early stop counter: 5
val acc:0.9698808193206787, best validation acc: 0.9723286628723145, corresponding to test acc:                         0.9619686603546143 / 0.9658037424087524
after epoch: 7,now: 2024-06-29 20:59:47.313649,epoch time: 0:22:52.869770,used: 2:42:16.710121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9953892, 'precision': 0.9928574, 'recall': 0.9951423, 'specificity': 0.9951423, 'f1': 0.9939928, 'auroc': 0.9997425, 'binary_precision': 0.987586, 'binary_recall': 0.99463207, 'binary_specificity': 0.9956525, 'binary_f1_score': 0.99109656}
confusion matrix:
       0      1
0  42139    184
1     79  14638
---- Validation: 
scalar performance:
{'acc': 0.95359725, 'precision': 0.69871914, 'recall': 0.8642184, 'specificity': 0.8642184, 'f1': 0.75338674, 'auroc': 0.95588493, 'binary_precision': 0.40591618, 'binary_recall': 0.7682737, 'binary_specificity': 0.9601631, 'binary_f1_score': 0.53118277}
confusion matrix:
       0    1
0  17426  723
1    149  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93128794, 'precision': 0.6225293, 'recall': 0.6709753, 'specificity': 0.6709753, 'f1': 0.64171857, 'auroc': 0.9033922, 'binary_precision': 0.2722372, 'binary_recall': 0.38697317, 'binary_specificity': 0.9549775, 'binary_f1_score': 0.31962025}
confusion matrix:
      0    1
0  5727  270
1   160  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_8.png
early stop counter: 6
val acc:0.9535972476005554, best validation acc: 0.9723286628723145, corresponding to test acc:                         0.9619686603546143 / 0.9658037424087524
after epoch: 8,now: 2024-06-29 21:22:50.294566,epoch time: 0:23:02.980917,used: 3:05:19.691038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9975456, 'precision': 0.99787915, 'recall': 0.9957087, 'specificity': 0.9957087, 'f1': 0.99678767, 'auroc': 0.99989945, 'binary_precision': 0.9985634, 'binary_recall': 0.99191356, 'binary_specificity': 0.99950385, 'binary_f1_score': 0.9952274}
confusion matrix:
       0      1
0  42303     21
1    119  14597
---- Validation: 
scalar performance:
{'acc': 0.9736058, 'precision': 0.8054024, 'recall': 0.77782, 'specificity': 0.77782, 'f1': 0.7908951, 'auroc': 0.9605503, 'binary_precision': 0.62607205, 'binary_recall': 0.5676516, 'binary_specificity': 0.9879883, 'binary_f1_score': 0.5954323}
confusion matrix:
       0    1
0  17931  218
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8283128, 'recall': 0.61643946, 'specificity': 0.61643946, 'f1': 0.6673081, 'auroc': 0.9321291, 'binary_precision': 0.6888889, 'binary_recall': 0.23754789, 'binary_specificity': 0.995331, 'binary_f1_score': 0.35327634}
confusion matrix:
      0   1
0  5969  28
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_9.png
better model found
persisted
after epoch: 9,now: 2024-06-29 21:45:55.183594,epoch time: 0:23:04.889028,used: 3:28:24.580066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9960028, 'precision': 0.99334913, 'recall': 0.99626493, 'specificity': 0.99626493, 'f1': 0.99479556, 'auroc': 0.9999154, 'binary_precision': 0.9878123, 'binary_recall': 0.99680644, 'binary_specificity': 0.99572337, 'binary_f1_score': 0.992289}
confusion matrix:
       0      1
0  42142    181
1     47  14670
---- Validation: 
scalar performance:
{'acc': 0.9450298, 'precision': 0.67048, 'recall': 0.83503103, 'specificity': 0.83503103, 'f1': 0.721309, 'auroc': 0.94158703, 'binary_precision': 0.35137194, 'binary_recall': 0.7169518, 'binary_specificity': 0.95311034, 'binary_f1_score': 0.47161123}
confusion matrix:
       0    1
0  17298  851
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92777246, 'precision': 0.6141564, 'recall': 0.66730875, 'specificity': 0.66730875, 'f1': 0.634325, 'auroc': 0.88618827, 'binary_precision': 0.25575447, 'binary_recall': 0.38314176, 'binary_specificity': 0.95147574, 'binary_f1_score': 0.30674845}
confusion matrix:
      0    1
0  5706  291
1   161  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_10.png
early stop counter: 1
val acc:0.9450297951698303, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9637264013290405 / 0.9658037424087524
after epoch: 10,now: 2024-06-29 22:09:09.176516,epoch time: 0:23:13.992922,used: 3:51:38.572988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.995547, 'precision': 0.9968567, 'recall': 0.99152565, 'specificity': 0.99152565, 'f1': 0.9941536, 'auroc': 0.999761, 'binary_precision': 0.9995165, 'binary_recall': 0.9832167, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.99129957}
confusion matrix:
       0      1
0  42316      7
1    247  14470
---- Validation: 
scalar performance:
{'acc': 0.97169006, 'precision': 0.85349625, 'recall': 0.6343177, 'specificity': 0.6343177, 'f1': 0.6911651, 'auroc': 0.95021755, 'binary_precision': 0.73221755, 'binary_recall': 0.27216175, 'binary_specificity': 0.9964736, 'binary_f1_score': 0.39682543}
confusion matrix:
       0    1
0  18085   64
1    468  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7870201, 'recall': 0.53539795, 'specificity': 0.53539795, 'f1': 0.5546791, 'auroc': 0.88801664, 'binary_precision': 0.61290324, 'binary_recall': 0.07279693, 'binary_specificity': 0.997999, 'binary_f1_score': 0.13013698}
confusion matrix:
      0   1
0  5985  12
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_11.png
early stop counter: 2
val acc:0.9716900587081909, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9637264013290405 / 0.9658037424087524
after epoch: 11,now: 2024-06-29 22:32:28.955015,epoch time: 0:23:19.778499,used: 4:14:58.351487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99654627, 'precision': 0.99547917, 'recall': 0.99550116, 'specificity': 0.99550116, 'f1': 0.9954902, 'auroc': 0.9997529, 'binary_precision': 0.993274, 'binary_recall': 0.9933415, 'binary_specificity': 0.9976608, 'binary_f1_score': 0.99330777}
confusion matrix:
       0      1
0  42223     99
1     98  14620
---- Validation: 
scalar performance:
{'acc': 0.97381866, 'precision': 0.8283836, 'recall': 0.721676, 'specificity': 0.721676, 'f1': 0.7637849, 'auroc': 0.9545748, 'binary_precision': 0.6759907, 'binary_recall': 0.45101088, 'binary_specificity': 0.99234116, 'binary_f1_score': 0.54104483}
confusion matrix:
       0    1
0  18010  139
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9539789, 'precision': 0.64083457, 'recall': 0.54172486, 'specificity': 0.54172486, 'f1': 0.5596059, 'auroc': 0.9250679, 'binary_precision': 0.32, 'binary_recall': 0.09195402, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.14285713}
confusion matrix:
      0   1
0  5946  51
1   237  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_12.png
better model found
persisted
after epoch: 12,now: 2024-06-29 22:55:41.752167,epoch time: 0:23:12.797152,used: 4:38:11.148639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99581, 'precision': 0.9932776, 'recall': 0.9958247, 'specificity': 0.9958247, 'f1': 0.99454236, 'auroc': 0.99985564, 'binary_precision': 0.9880005, 'binary_recall': 0.99585515, 'binary_specificity': 0.99579424, 'binary_f1_score': 0.99191225}
confusion matrix:
       0      1
0  42145    178
1     61  14656
---- Validation: 
scalar performance:
{'acc': 0.97530866, 'precision': 0.85094905, 'recall': 0.7239475, 'specificity': 0.7239475, 'f1': 0.77227604, 'auroc': 0.9655639, 'binary_precision': 0.7209877, 'binary_recall': 0.4541213, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.55725193}
confusion matrix:
       0    1
0  18036  113
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.84470093, 'recall': 0.569714, 'specificity': 0.569714, 'f1': 0.60883886, 'auroc': 0.9496381, 'binary_precision': 0.7254902, 'binary_recall': 0.14176245, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.23717949}
confusion matrix:
      0   1
0  5983  14
1   224  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_13.png
better model found
persisted
after epoch: 13,now: 2024-06-29 23:18:54.792636,epoch time: 0:23:13.040469,used: 5:01:24.189108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9965638, 'precision': 0.9955995, 'recall': 0.9954237, 'specificity': 0.9954237, 'f1': 0.99551153, 'auroc': 0.99975276, 'binary_precision': 0.9936085, 'binary_recall': 0.9930683, 'binary_specificity': 0.9977791, 'binary_f1_score': 0.9933383}
confusion matrix:
       0      1
0  42231     94
1    102  14613
---- Validation: 
scalar performance:
{'acc': 0.9753619, 'precision': 0.8247447, 'recall': 0.777229, 'specificity': 0.777229, 'f1': 0.7989378, 'auroc': 0.96352357, 'binary_precision': 0.66483516, 'binary_recall': 0.5645412, 'binary_specificity': 0.9899168, 'binary_f1_score': 0.61059713}
confusion matrix:
       0    1
0  17966  183
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8145511, 'recall': 0.68531966, 'specificity': 0.68531966, 'f1': 0.7314513, 'auroc': 0.9558592, 'binary_precision': 0.65562916, 'binary_recall': 0.37931034, 'binary_specificity': 0.991329, 'binary_f1_score': 0.48058254}
confusion matrix:
      0   1
0  5945  52
1   162  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_14.png
better model found
persisted
after epoch: 14,now: 2024-06-29 23:42:14.057637,epoch time: 0:23:19.265001,used: 5:24:43.454109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9972475, 'precision': 0.99703205, 'recall': 0.9957733, 'specificity': 0.9957733, 'f1': 0.9964006, 'auroc': 0.9998263, 'binary_precision': 0.99658865, 'binary_recall': 0.992728, 'binary_specificity': 0.9988187, 'binary_f1_score': 0.99465454}
confusion matrix:
       0      1
0  42276     50
1    107  14607
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.760393, 'recall': 0.77286994, 'specificity': 0.77286994, 'f1': 0.7664691, 'auroc': 0.9530293, 'binary_precision': 0.5362963, 'binary_recall': 0.562986, 'binary_specificity': 0.9827539, 'binary_f1_score': 0.5493172}
confusion matrix:
       0    1
0  17836  313
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495046, 'precision': 0.6637359, 'recall': 0.62367773, 'specificity': 0.62367773, 'f1': 0.64040756, 'auroc': 0.9294083, 'binary_precision': 0.35897437, 'binary_recall': 0.26819924, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.30701753}
confusion matrix:
      0    1
0  5872  125
1   191   70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_15.png
early stop counter: 1
val acc:0.9683908224105835, best validation acc: 0.9753618836402893, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 15,now: 2024-06-30 00:05:20.850563,epoch time: 0:23:06.792926,used: 5:47:50.247035,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9973352, 'precision': 0.9973577, 'recall': 0.99567723, 'specificity': 0.99567723, 'f1': 0.9965137, 'auroc': 0.99979126, 'binary_precision': 0.99740404, 'binary_recall': 0.9922523, 'binary_specificity': 0.99910223, 'binary_f1_score': 0.9948215}
confusion matrix:
       0      1
0  42288     38
1    114  14600
---- Validation: 
scalar performance:
{'acc': 0.9764261, 'precision': 0.8949384, 'recall': 0.7012744, 'specificity': 0.7012744, 'f1': 0.7644175, 'auroc': 0.9648329, 'binary_precision': 0.81055903, 'binary_recall': 0.4059098, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.54093266}
confusion matrix:
       0    1
0  18088   61
1    382  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7927695, 'recall': 0.5279853, 'specificity': 0.5279853, 'f1': 0.54220724, 'auroc': 0.94477665, 'binary_precision': 0.625, 'binary_recall': 0.057471264, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.10526315}
confusion matrix:
      0   1
0  5988   9
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_16.png
better model found
persisted
after epoch: 16,now: 2024-06-30 00:28:10.733776,epoch time: 0:22:49.883213,used: 6:10:40.130248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9970372, 'precision': 0.9968675, 'recall': 0.99538827, 'specificity': 0.99538827, 'f1': 0.9961249, 'auroc': 0.99979544, 'binary_precision': 0.99651855, 'binary_recall': 0.9919815, 'binary_specificity': 0.99879503, 'binary_f1_score': 0.9942448}
confusion matrix:
       0      1
0  42273     51
1    118  14598
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.8805739, 'recall': 0.567018, 'specificity': 0.567018, 'f1': 0.6076776, 'auroc': 0.95747674, 'binary_precision': 0.7909091, 'binary_recall': 0.13530326, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.23107567}
confusion matrix:
       0   1
0  18126  23
1    556  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8543732, 'recall': 0.50566375, 'specificity': 0.50566375, 'f1': 0.5007502, 'auroc': 0.94351757, 'binary_precision': 0.75, 'binary_recall': 0.011494253, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.022641508}
confusion matrix:
      0  1
0  5996  1
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_17.png
early stop counter: 1
val acc:0.9691889882087708, best validation acc: 0.9764261245727539, corresponding to test acc:                         0.9592521786689758 / 0.9658037424087524
after epoch: 17,now: 2024-06-30 00:51:14.468286,epoch time: 0:23:03.734510,used: 6:33:43.864758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99635345, 'precision': 0.9974863, 'recall': 0.9929998, 'specificity': 0.9929998, 'f1': 0.9952165, 'auroc': 0.99976385, 'binary_precision': 0.9997933, 'binary_recall': 0.9860705, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.99288446}
confusion matrix:
       0      1
0  42320      3
1    205  14512
---- Validation: 
scalar performance:
{'acc': 0.9703065, 'precision': 0.9171126, 'recall': 0.5780973, 'specificity': 0.5780973, 'f1': 0.62531817, 'auroc': 0.9348072, 'binary_precision': 0.8632479, 'binary_recall': 0.15707621, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.26578948}
confusion matrix:
       0    1
0  18133   16
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8543732, 'recall': 0.50566375, 'specificity': 0.50566375, 'f1': 0.5007502, 'auroc': 0.87969375, 'binary_precision': 0.75, 'binary_recall': 0.011494253, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.022641508}
confusion matrix:
      0  1
0  5996  1
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_18.png
early stop counter: 2
val acc:0.9703065156936646, best validation acc: 0.9764261245727539, corresponding to test acc:                         0.9592521786689758 / 0.9658037424087524
after epoch: 18,now: 2024-06-30 01:14:09.944356,epoch time: 0:22:55.476070,used: 6:56:39.340828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99796635, 'precision': 0.9977183, 'recall': 0.9969671, 'specificity': 0.9969671, 'f1': 0.99734193, 'auroc': 0.9998754, 'binary_precision': 0.9972071, 'binary_recall': 0.9949028, 'binary_specificity': 0.9990313, 'binary_f1_score': 0.99605364}
confusion matrix:
       0      1
0  42285     41
1     75  14639
---- Validation: 
scalar performance:
{'acc': 0.9791933, 'precision': 0.8545228, 'recall': 0.81446517, 'specificity': 0.81446517, 'f1': 0.8331883, 'auroc': 0.97119784, 'binary_precision': 0.72183096, 'binary_recall': 0.63763607, 'binary_specificity': 0.99129426, 'binary_f1_score': 0.67712635}
confusion matrix:
       0    1
0  17991  158
1    233  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7263467, 'recall': 0.5475573, 'specificity': 0.5475573, 'f1': 0.5720666, 'auroc': 0.94069207, 'binary_precision': 0.49056605, 'binary_recall': 0.099616855, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.16560508}
confusion matrix:
      0   1
0  5970  27
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_19.png
better model found
persisted
after epoch: 19,now: 2024-06-30 01:36:58.124790,epoch time: 0:22:48.180434,used: 7:19:27.521262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9984572, 'precision': 0.9983605, 'recall': 0.9976086, 'specificity': 0.9976086, 'f1': 0.9979838, 'auroc': 0.9999517, 'binary_precision': 0.99816114, 'binary_recall': 0.99585515, 'binary_specificity': 0.99936205, 'binary_f1_score': 0.99700683}
confusion matrix:
       0      1
0  42296     27
1     61  14656
---- Validation: 
scalar performance:
{'acc': 0.9750958, 'precision': 0.8043181, 'recall': 0.84609634, 'specificity': 0.84609634, 'f1': 0.8237257, 'auroc': 0.96605957, 'binary_precision': 0.61904764, 'binary_recall': 0.7076205, 'binary_specificity': 0.9845722, 'binary_f1_score': 0.6603774}
confusion matrix:
       0    1
0  17869  280
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94678813, 'precision': 0.6083877, 'recall': 0.5617933, 'specificity': 0.5617933, 'f1': 0.57715905, 'auroc': 0.88952124, 'binary_precision': 0.25342464, 'binary_recall': 0.14176245, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.18181819}
confusion matrix:
      0    1
0  5888  109
1   224   37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_20.png
early stop counter: 1
val acc:0.975095808506012, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9581335783004761 / 0.9658037424087524
after epoch: 20,now: 2024-06-30 01:59:45.990030,epoch time: 0:22:47.865240,used: 7:42:15.386502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9978261, 'precision': 0.99851686, 'recall': 0.9958088, 'specificity': 0.9958088, 'f1': 0.99715316, 'auroc': 0.9998793, 'binary_precision': 0.99993145, 'binary_recall': 0.99164116, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9957691}
confusion matrix:
       0      1
0  42324      1
1    123  14592
---- Validation: 
scalar performance:
{'acc': 0.97307366, 'precision': 0.9110587, 'recall': 0.62903357, 'specificity': 0.62903357, 'f1': 0.69192404, 'auroc': 0.9635122, 'binary_precision': 0.84771574, 'binary_recall': 0.25972006, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.39761904}
confusion matrix:
       0    1
0  18119   30
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7657528, 'recall': 0.52223814, 'specificity': 0.52223814, 'f1': 0.5320088, 'auroc': 0.93794024, 'binary_precision': 0.5714286, 'binary_recall': 0.04597701, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.08510638}
confusion matrix:
      0   1
0  5988   9
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_21.png
early stop counter: 2
val acc:0.9730736613273621, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9581335783004761 / 0.9658037424087524
after epoch: 21,now: 2024-06-30 02:22:30.844218,epoch time: 0:22:44.854188,used: 8:05:00.240690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9960554, 'precision': 0.9969686, 'recall': 0.9927316, 'specificity': 0.9927316, 'f1': 0.99482644, 'auroc': 0.9998496, 'binary_precision': 0.99882954, 'binary_recall': 0.98586476, 'binary_specificity': 0.9995983, 'binary_f1_score': 0.99230486}
confusion matrix:
       0      1
0  42308     17
1    208  14507
---- Validation: 
scalar performance:
{'acc': 0.9670072, 'precision': 0.8069669, 'recall': 0.5388864, 'specificity': 0.5388864, 'f1': 0.56222737, 'auroc': 0.9518412, 'binary_precision': 0.6455696, 'binary_recall': 0.07931571, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.14127423}
confusion matrix:
       0   1
0  18121  28
1    592  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.57921, 'recall': 0.5015822, 'specificity': 0.5015822, 'f1': 0.49298388, 'auroc': 0.9439963, 'binary_precision': 0.2, 'binary_recall': 0.0038314175, 'binary_specificity': 0.999333, 'binary_f1_score': 0.007518797}
confusion matrix:
      0  1
0  5993  4
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_22.png
early stop counter: 3
val acc:0.9670072197914124, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9581335783004761 / 0.9658037424087524
after epoch: 22,now: 2024-06-30 02:45:19.346818,epoch time: 0:22:48.502600,used: 8:27:48.743290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9977209, 'precision': 0.99693626, 'recall': 0.9971124, 'specificity': 0.9971124, 'f1': 0.9970243, 'auroc': 0.9999356, 'binary_precision': 0.9953141, 'binary_recall': 0.99585515, 'binary_specificity': 0.9983697, 'binary_f1_score': 0.9955846}
confusion matrix:
       0      1
0  42254     69
1     61  14656
---- Validation: 
scalar performance:
{'acc': 0.97349936, 'precision': 0.79714155, 'recall': 0.8122674, 'specificity': 0.8122674, 'f1': 0.8044973, 'auroc': 0.961984, 'binary_precision': 0.6070901, 'binary_recall': 0.63919127, 'binary_specificity': 0.9853435, 'binary_f1_score': 0.6227273}
confusion matrix:
       0    1
0  17883  266
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.85184026, 'recall': 0.6790742, 'specificity': 0.6790742, 'f1': 0.7346781, 'auroc': 0.9486543, 'binary_precision': 0.7307692, 'binary_recall': 0.36398467, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.4859335}
confusion matrix:
      0   1
0  5962  35
1   166  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_23.png
new oracle model saved
early stop counter: 4
val acc:0.9734993577003479, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9581335783004761 / 0.9678810834884644
after epoch: 23,now: 2024-06-30 03:08:00.943706,epoch time: 0:22:41.596888,used: 8:50:30.340178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9986851, 'precision': 0.998803, 'recall': 0.9977622, 'specificity': 0.9977622, 'f1': 0.9982811, 'auroc': 0.9999357, 'binary_precision': 0.99904567, 'binary_recall': 0.99585515, 'binary_specificity': 0.9996692, 'binary_f1_score': 0.99744785}
confusion matrix:
       0      1
0  42309     14
1     61  14656
---- Validation: 
scalar performance:
{'acc': 0.9777033, 'precision': 0.8444592, 'recall': 0.7971926, 'specificity': 0.7971926, 'f1': 0.81892896, 'auroc': 0.96229756, 'binary_precision': 0.70289856, 'binary_recall': 0.60342145, 'binary_specificity': 0.9909637, 'binary_f1_score': 0.6493724}
confusion matrix:
       0    1
0  17985  164
1    255  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.735351, 'recall': 0.5880354, 'specificity': 0.5880354, 'f1': 0.6241406, 'auroc': 0.91352075, 'binary_precision': 0.50526315, 'binary_recall': 0.18390805, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.26966292}
confusion matrix:
      0   1
0  5950  47
1   213  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_24.png
early stop counter: 5
val acc:0.9777032732963562, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9581335783004761 / 0.9678810834884644
after epoch: 24,now: 2024-06-30 03:30:52.719870,epoch time: 0:22:51.776164,used: 9:13:22.116342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99815917, 'precision': 0.9978492, 'recall': 0.9973413, 'specificity': 0.9973413, 'f1': 0.9975949, 'auroc': 0.99995005, 'binary_precision': 0.9972097, 'binary_recall': 0.9956513, 'binary_specificity': 0.99903125, 'binary_f1_score': 0.9964299}
confusion matrix:
       0      1
0  42282     41
1     64  14653
---- Validation: 
scalar performance:
{'acc': 0.9713176, 'precision': 0.80407304, 'recall': 0.69262916, 'specificity': 0.69262916, 'f1': 0.73472965, 'auroc': 0.9386437, 'binary_precision': 0.6293532, 'binary_recall': 0.3934681, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.48421055}
confusion matrix:
       0    1
0  18000  149
1    390  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542985, 'precision': 0.64011186, 'recall': 0.53822696, 'specificity': 0.53822696, 'f1': 0.55493194, 'auroc': 0.8657761, 'binary_precision': 0.3188406, 'binary_recall': 0.08429119, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.13333334}
confusion matrix:
      0   1
0  5950  47
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_25.png
early stop counter: 6
val acc:0.9713175892829895, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9581335783004761 / 0.9678810834884644
after epoch: 25,now: 2024-06-30 03:53:27.008830,epoch time: 0:22:34.288960,used: 9:35:56.405302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9975105, 'precision': 0.9981475, 'recall': 0.9953529, 'specificity': 0.9953529, 'f1': 0.9967399, 'auroc': 0.9997524, 'binary_precision': 0.9994517, 'binary_recall': 0.99089485, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9951549}
confusion matrix:
       0      1
0  42315      8
1    134  14583
---- Validation: 
scalar performance:
{'acc': 0.97647935, 'precision': 0.8648284, 'recall': 0.73280424, 'specificity': 0.73280424, 'f1': 0.7830733, 'auroc': 0.9712878, 'binary_precision': 0.74814814, 'binary_recall': 0.47122863, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.57824427}
confusion matrix:
       0    1
0  18047  102
1    340  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.8259349, 'recall': 0.55821973, 'specificity': 0.55821973, 'f1': 0.5913154, 'auroc': 0.9596885, 'binary_precision': 0.6888889, 'binary_recall': 0.118773945, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.20261438}
confusion matrix:
      0   1
0  5983  14
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_26.png
early stop counter: 7
val acc:0.9764793515205383, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9581335783004761 / 0.9678810834884644
after epoch: 26,now: 2024-06-30 04:15:51.045515,epoch time: 0:22:24.036685,used: 9:58:20.441987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9981241, 'precision': 0.9984699, 'recall': 0.99663067, 'specificity': 0.99663067, 'f1': 0.99754584, 'auroc': 0.9999074, 'binary_precision': 0.99918, 'binary_recall': 0.9935449, 'binary_specificity': 0.99971646, 'binary_f1_score': 0.9963545}
confusion matrix:
       0      1
0  42311     12
1     95  14622
---- Validation: 
scalar performance:
{'acc': 0.97227544, 'precision': 0.9081056, 'recall': 0.61586934, 'specificity': 0.61586934, 'f1': 0.6756181, 'auroc': 0.9636506, 'binary_precision': 0.8426966, 'binary_recall': 0.2332815, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.36540806}
confusion matrix:
       0    1
0  18121   28
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.77936995, 'recall': 0.50558037, 'specificity': 0.50558037, 'f1': 0.50066596, 'auroc': 0.94520694, 'binary_precision': 0.6, 'binary_recall': 0.011494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.02255639}
confusion matrix:
      0  1
0  5995  2
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_27.png
early stop counter: 8
val acc:0.97227543592453, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9581335783004761 / 0.9678810834884644
after epoch: 27,now: 2024-06-30 04:38:30.652680,epoch time: 0:22:39.607165,used: 10:21:00.049152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9978787, 'precision': 0.99852955, 'recall': 0.9959334, 'specificity': 0.9959334, 'f1': 0.99722254, 'auroc': 0.99994016, 'binary_precision': 0.999863, 'binary_recall': 0.9919141, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9958727}
confusion matrix:
       0      1
0  42321      2
1    119  14598
---- Validation: 
scalar performance:
{'acc': 0.97408473, 'precision': 0.94699335, 'recall': 0.6325572, 'specificity': 0.6325572, 'f1': 0.69964767, 'auroc': 0.9648154, 'binary_precision': 0.91935486, 'binary_recall': 0.2659409, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.41254523}
confusion matrix:
       0    1
0  18134   15
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.9452188, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_28.png
early stop counter: 9
val acc:0.974084734916687, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9581335783004761 / 0.9678810834884644
after epoch: 28,now: 2024-06-30 05:00:55.630861,epoch time: 0:22:24.978181,used: 10:43:25.027333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99779105, 'precision': 0.9982235, 'recall': 0.99600756, 'specificity': 0.99600756, 'f1': 0.99710906, 'auroc': 0.9998598, 'binary_precision': 0.9991107, 'binary_recall': 0.9923223, 'binary_specificity': 0.99969286, 'binary_f1_score': 0.99570495}
confusion matrix:
       0      1
0  42309     13
1    113  14605
---- Validation: 
scalar performance:
{'acc': 0.97541505, 'precision': 0.9106927, 'recall': 0.6714988, 'specificity': 0.6714988, 'f1': 0.738735, 'auroc': 0.96073085, 'binary_precision': 0.84410644, 'binary_recall': 0.3452566, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.4900662}
confusion matrix:
       0    1
0  18108   41
1    421  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.9513326, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_29.png
early stop counter: 10
val acc:0.975415050983429, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9581335783004761 / 0.9678810834884644
after epoch: 29,now: 2024-06-30 05:23:36.122059,epoch time: 0:22:40.491198,used: 11:06:05.518531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9951438, 'precision': 0.9921389, 'recall': 0.9952426, 'specificity': 0.9952426, 'f1': 0.99367774, 'auroc': 0.9997713, 'binary_precision': 0.9858662, 'binary_recall': 0.9954468, 'binary_specificity': 0.9950384, 'binary_f1_score': 0.99063337}
confusion matrix:
       0      1
0  42115    210
1     67  14648
---- Validation: 
scalar performance:
{'acc': 0.8873457, 'precision': 0.59128296, 'recall': 0.80816734, 'specificity': 0.80816734, 'f1': 0.6219608, 'auroc': 0.90795445, 'binary_precision': 0.19342762, 'binary_recall': 0.7231726, 'binary_specificity': 0.89316213, 'binary_f1_score': 0.30521822}
confusion matrix:
       0     1
0  16210  1939
1    178   465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88079256, 'precision': 0.52726114, 'recall': 0.5585092, 'specificity': 0.5585092, 'f1': 0.5312476, 'auroc': 0.82887423, 'binary_precision': 0.0910624, 'binary_recall': 0.20689656, 'binary_specificity': 0.91012174, 'binary_f1_score': 0.1264637}
confusion matrix:
      0    1
0  5458  539
1   207   54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_30.png
early stop counter: 11
val acc:0.8873456716537476, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9581335783004761 / 0.9678810834884644
after epoch: 30,now: 2024-06-30 05:46:14.405205,epoch time: 0:22:38.283146,used: 11:28:43.801677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_17_30_seed_0_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:28:43.801677 at 2024-06-30 05:46:14.405205
persisted model performance metric: 

scalar performance:
{'acc': 0.9581336, 'precision': 0.7263467, 'recall': 0.5475573, 'specificity': 0.5475573, 'f1': 0.5720666, 'auroc': 0.94069207, 'binary_precision': 0.49056605, 'binary_recall': 0.099616855, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.16560508}
confusion matrix:
      0   1
0  5970  27
1   235  26
oracle model performance metric: 

scalar performance:
{'acc': 0.9678811, 'precision': 0.85184026, 'recall': 0.6790742, 'specificity': 0.6790742, 'f1': 0.7346781, 'auroc': 0.9486543, 'binary_precision': 0.7307692, 'binary_recall': 0.36398467, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.4859335}
confusion matrix:
      0   1
0  5962  35
1   166  95
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 369815 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool | 337956 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |  31859 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 369815 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool | 337956 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |  31859 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362641 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |  30851 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10022 MiB |  10022 MiB |  10022 MiB |      0 B   |
|       from large pool |   9962 MiB |   9962 MiB |   9962 MiB |      0 B   |
|       from small pool |     60 MiB |     60 MiB |     60 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 359272 KiB |    876 MiB |    880 TiB |    880 TiB |
|       from large pool | 350172 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |   9100 KiB |     11 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3317    |    7964    |  221733 K  |  221730 K  |
|       from large pool |     151    |     986    |  113526 K  |  113526 K  |
|       from small pool |    3166    |    7811    |  108207 K  |  108203 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3317    |    7964    |  221733 K  |  221730 K  |
|       from large pool |     151    |     986    |  113526 K  |  113526 K  |
|       from small pool |    3166    |    7811    |  108207 K  |  108203 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     445    |     445    |     445    |       0    |
|       from large pool |     415    |     415    |     415    |       0    |
|       from small pool |      30    |      30    |      30    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3613    |  140743 K  |  140743 K  |
|       from large pool |      32    |     417    |   88579 K  |   88579 K  |
|       from small pool |      36    |    3582    |   52164 K  |   52164 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |      0 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 729088 KiB |  10022 MiB |  10022 MiB |   9310 MiB |
|       from large pool | 688128 KiB |   9962 MiB |   9962 MiB |   9290 MiB |
|       from small pool |  40960 KiB |     60 MiB |     60 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |    880 TiB |    880 TiB |
|       from large pool |  24320 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |      0 KiB |     28 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  221733 K  |  221733 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108207 K  |  108207 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  221733 K  |  221733 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108207 K  |  108207 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |     445    |     445    |     395    |
|       from large pool |      30    |     415    |     415    |     385    |
|       from small pool |      20    |      30    |      30    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3613    |  140744 K  |  140744 K  |
|       from large pool |       3    |     417    |   88579 K  |   88579 K  |
|       from small pool |       0    |    3582    |   52165 K  |   52165 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |      0 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 729088 KiB |  10022 MiB |  10022 MiB |   9310 MiB |
|       from large pool | 688128 KiB |   9962 MiB |   9962 MiB |   9290 MiB |
|       from small pool |  40960 KiB |     60 MiB |     60 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |    880 TiB |    880 TiB |
|       from large pool |  24320 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |      0 KiB |     28 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  221733 K  |  221733 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108207 K  |  108207 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  221733 K  |  221733 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108207 K  |  108207 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |     445    |     445    |     395    |
|       from large pool |      30    |     415    |     415    |     385    |
|       from small pool |      20    |      30    |      30    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3613    |  140744 K  |  140744 K  |
|       from large pool |       3    |     417    |   88579 K  |   88579 K  |
|       from small pool |       0    |    3582    |   52165 K  |   52165 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982

 Experiment start at: 2024-06-30 05:53:28.686125
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99278575, 'precision': 0.9935201, 'recall': 0.98740846, 'specificity': 0.98740846, 'f1': 0.99041593, 'auroc': 0.9988525, 'binary_precision': 0.994983, 'binary_recall': 0.976491, 'binary_specificity': 0.99832594, 'binary_f1_score': 0.9856503}
confusion matrix:
       0      1
0  42341     71
1    339  14081
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.76132405, 'recall': 0.77475417, 'specificity': 0.77475417, 'f1': 0.76785094, 'auroc': 0.94495344, 'binary_precision': 0.538787, 'binary_recall': 0.5676077, 'binary_specificity': 0.9819007, 'binary_f1_score': 0.55282193}
confusion matrix:
       0    1
0  17740  327
1    291  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.7262546, 'recall': 0.68681985, 'specificity': 0.68681985, 'f1': 0.7043792, 'auroc': 0.9130495, 'binary_precision': 0.47887325, 'binary_recall': 0.3923077, 'binary_specificity': 0.981332, 'binary_f1_score': 0.43128964}
confusion matrix:
      0    1
0  5835  111
1   158  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-30 06:16:28.841995,epoch time: 0:23:00.155870,used: 0:23:00.155870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9917652, 'precision': 0.99439675, 'recall': 0.98390764, 'specificity': 0.98390764, 'f1': 0.989011, 'auroc': 0.99930286, 'binary_precision': 0.99957025, 'binary_recall': 0.9679567, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.98350954}
confusion matrix:
       0      1
0  42408      6
1    462  13956
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7918751, 'recall': 0.5964866, 'specificity': 0.5964866, 'f1': 0.6409113, 'auroc': 0.9300606, 'binary_precision': 0.61290324, 'binary_recall': 0.19762258, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.2988764}
confusion matrix:
       0    1
0  17983   84
1    540  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8285857, 'recall': 0.5641233, 'specificity': 0.5641233, 'f1': 0.60007614, 'auroc': 0.9263859, 'binary_precision': 0.6938776, 'binary_recall': 0.13076924, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.22006473}
confusion matrix:
      0   1
0  5931  15
1   226  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_2.png
new oracle model saved
early stop counter: 1
val acc:0.9667022228240967, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9566548466682434 / 0.9611666202545166
after epoch: 2,now: 2024-06-30 06:38:58.824293,epoch time: 0:22:29.982298,used: 0:45:30.138168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9947213, 'precision': 0.99641657, 'recall': 0.98966646, 'specificity': 0.98966646, 'f1': 0.992983, 'auroc': 0.9995328, 'binary_precision': 0.9997876, 'binary_recall': 0.9794036, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9894906}
confusion matrix:
       0      1
0  42409      3
1    297  14123
---- Validation: 
scalar performance:
{'acc': 0.9698506, 'precision': 0.92279255, 'recall': 0.5931125, 'specificity': 0.5931125, 'f1': 0.64651746, 'auroc': 0.95239186, 'binary_precision': 0.875, 'binary_recall': 0.1872214, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.3084455}
confusion matrix:
       0    1
0  18049   18
1    547  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6458602, 'recall': 0.5035098, 'specificity': 0.5035098, 'f1': 0.49673337, 'auroc': 0.92591107, 'binary_precision': 0.33333334, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.015037594}
confusion matrix:
      0  1
0  5942  4
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_3.png
better model found
persisted
after epoch: 3,now: 2024-06-30 07:01:25.470673,epoch time: 0:22:26.646380,used: 1:07:56.784548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99357754, 'precision': 0.98994434, 'recall': 0.99317944, 'specificity': 0.99317944, 'f1': 0.99154806, 'auroc': 0.9994408, 'binary_precision': 0.9824911, 'binary_recall': 0.9923712, 'binary_specificity': 0.9939877, 'binary_f1_score': 0.9874064}
confusion matrix:
       0      1
0  42158    255
1    110  14309
---- Validation: 
scalar performance:
{'acc': 0.9236393, 'precision': 0.6471002, 'recall': 0.8867249, 'specificity': 0.8867249, 'f1': 0.70120746, 'auroc': 0.93996227, 'binary_precision': 0.30031613, 'binary_recall': 0.8469539, 'binary_specificity': 0.92649585, 'binary_f1_score': 0.4434072}
confusion matrix:
       0     1
0  16739  1328
1    103   570
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9386078, 'precision': 0.67580605, 'recall': 0.79877484, 'specificity': 0.79877484, 'f1': 0.7180206, 'auroc': 0.9077505, 'binary_precision': 0.36761487, 'binary_recall': 0.64615387, 'binary_specificity': 0.95139587, 'binary_f1_score': 0.46861926}
confusion matrix:
      0    1
0  5657  289
1    92  168
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_4.png
early stop counter: 1
val acc:0.9236392974853516, best validation acc: 0.9698505997657776, corresponding to test acc:                         0.9577828049659729 / 0.9611666202545166
after epoch: 4,now: 2024-06-30 07:24:06.417296,epoch time: 0:22:40.946623,used: 1:30:37.731171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9942814, 'precision': 0.9957209, 'recall': 0.9891872, 'specificity': 0.9891872, 'f1': 0.9923992, 'auroc': 0.9994461, 'binary_precision': 0.99858487, 'binary_recall': 0.9788459, 'binary_specificity': 0.99952847, 'binary_f1_score': 0.9886168}
confusion matrix:
       0      1
0  42394     20
1    305  14113
---- Validation: 
scalar performance:
{'acc': 0.9672892, 'precision': 0.79339755, 'recall': 0.6168185, 'specificity': 0.6168185, 'f1': 0.6638056, 'auroc': 0.946509, 'binary_precision': 0.6145038, 'binary_recall': 0.23922734, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.34438503}
confusion matrix:
       0    1
0  17966  101
1    512  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95568806, 'precision': 0.6002104, 'recall': 0.5116116, 'specificity': 0.5116116, 'f1': 0.5128794, 'auroc': 0.8797228, 'binary_precision': 0.2413793, 'binary_recall': 0.026923077, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.048442904}
confusion matrix:
      0   1
0  5924  22
1   253   7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_5.png
early stop counter: 2
val acc:0.9672892093658447, best validation acc: 0.9698505997657776, corresponding to test acc:                         0.9577828049659729 / 0.9611666202545166
after epoch: 5,now: 2024-06-30 07:46:37.763012,epoch time: 0:22:31.345716,used: 1:53:09.076887,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9955659, 'precision': 0.9967866, 'recall': 0.9915133, 'specificity': 0.9915133, 'f1': 0.9941143, 'auroc': 0.99969745, 'binary_precision': 0.9992247, 'binary_recall': 0.98328596, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.99119127}
confusion matrix:
       0      1
0  42402     11
1    241  14178
---- Validation: 
scalar performance:
{'acc': 0.96782285, 'precision': 0.78519857, 'recall': 0.6585808, 'specificity': 0.6585808, 'f1': 0.7021005, 'auroc': 0.9468531, 'binary_precision': 0.5951087, 'binary_recall': 0.3254086, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.42074928}
confusion matrix:
       0    1
0  17918  149
1    454  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9531099, 'precision': 0.60712415, 'recall': 0.526817, 'specificity': 0.526817, 'f1': 0.53749985, 'auroc': 0.9173795, 'binary_precision': 0.25396827, 'binary_recall': 0.06153846, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.09907121}
confusion matrix:
      0   1
0  5899  47
1   244  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_6.png
early stop counter: 3
val acc:0.9678228497505188, best validation acc: 0.9698505997657776, corresponding to test acc:                         0.9577828049659729 / 0.9611666202545166
after epoch: 6,now: 2024-06-30 08:09:07.144696,epoch time: 0:22:29.381684,used: 2:15:38.458571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99588263, 'precision': 0.9958799, 'recall': 0.9932353, 'specificity': 0.9932353, 'f1': 0.99454856, 'auroc': 0.9996693, 'binary_precision': 0.9958744, 'binary_recall': 0.9878616, 'binary_specificity': 0.998609, 'binary_f1_score': 0.99185175}
confusion matrix:
       0      1
0  42356     59
1    175  14242
---- Validation: 
scalar performance:
{'acc': 0.9744931, 'precision': 0.8207408, 'recall': 0.79865617, 'specificity': 0.79865617, 'f1': 0.809265, 'auroc': 0.9586209, 'binary_precision': 0.656, 'binary_recall': 0.60921246, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.6317411}
confusion matrix:
       0    1
0  17852  215
1    263  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95246536, 'precision': 0.6529595, 'recall': 0.56693834, 'specificity': 0.56693834, 'f1': 0.59017605, 'auroc': 0.90850425, 'binary_precision': 0.34234235, 'binary_recall': 0.14615385, 'binary_specificity': 0.9877228, 'binary_f1_score': 0.20485176}
confusion matrix:
      0   1
0  5873  73
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_7.png
better model found
persisted
after epoch: 7,now: 2024-06-30 08:31:37.709212,epoch time: 0:22:30.564516,used: 2:38:09.023087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99637526, 'precision': 0.9950572, 'recall': 0.9953743, 'specificity': 0.9953743, 'f1': 0.99521565, 'auroc': 0.99982154, 'binary_precision': 0.9923786, 'binary_recall': 0.9933421, 'binary_specificity': 0.9974065, 'binary_f1_score': 0.99286014}
confusion matrix:
       0      1
0  42303    110
1     96  14323
---- Validation: 
scalar performance:
{'acc': 0.8823906, 'precision': 0.60876644, 'recall': 0.8932277, 'specificity': 0.8932277, 'f1': 0.6456095, 'auroc': 0.9502781, 'binary_precision': 0.2215351, 'binary_recall': 0.9049034, 'binary_specificity': 0.881552, 'binary_f1_score': 0.3559322}
confusion matrix:
       0     1
0  15927  2140
1     64   609
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72848856, 'precision': 0.55816513, 'recall': 0.80681646, 'specificity': 0.80681646, 'f1': 0.5258662, 'auroc': 0.83930904, 'binary_precision': 0.1228163, 'binary_recall': 0.8923077, 'binary_specificity': 0.7213253, 'binary_f1_score': 0.21591438}
confusion matrix:
      0     1
0  4289  1657
1    28   232
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_8.png
early stop counter: 1
val acc:0.8823906183242798, best validation acc: 0.9744930863380432, corresponding to test acc:                         0.9524653553962708 / 0.9611666202545166
after epoch: 8,now: 2024-06-30 08:54:10.423162,epoch time: 0:22:32.713950,used: 3:00:41.737037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99646324, 'precision': 0.99694026, 'recall': 0.99371666, 'specificity': 0.99371666, 'f1': 0.9953151, 'auroc': 0.9996623, 'binary_precision': 0.9978989, 'binary_recall': 0.98814064, 'binary_specificity': 0.9992927, 'binary_f1_score': 0.9929958}
confusion matrix:
       0      1
0  42383     30
1    171  14248
---- Validation: 
scalar performance:
{'acc': 0.9604055, 'precision': 0.7281466, 'recall': 0.84571034, 'specificity': 0.84571034, 'f1': 0.7731743, 'auroc': 0.9576804, 'binary_precision': 0.4668588, 'binary_recall': 0.72213966, 'binary_specificity': 0.969281, 'binary_f1_score': 0.5670945}
confusion matrix:
       0    1
0  17512  555
1    187  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.7301173, 'recall': 0.69258904, 'specificity': 0.69258904, 'f1': 0.7094455, 'auroc': 0.92388916, 'binary_precision': 0.4861111, 'binary_recall': 0.40384614, 'binary_specificity': 0.981332, 'binary_f1_score': 0.44117647}
confusion matrix:
      0    1
0  5835  111
1   155  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_9.png
early stop counter: 2
val acc:0.9604055285453796, best validation acc: 0.9744930863380432, corresponding to test acc:                         0.9524653553962708 / 0.9611666202545166
after epoch: 9,now: 2024-06-30 09:16:38.454081,epoch time: 0:22:28.030919,used: 3:23:09.767956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99665684, 'precision': 0.9957434, 'recall': 0.9954256, 'specificity': 0.9954256, 'f1': 0.99558437, 'auroc': 0.99982196, 'binary_precision': 0.993891, 'binary_recall': 0.992926, 'binary_specificity': 0.99792516, 'binary_f1_score': 0.99340826}
confusion matrix:
       0      1
0  42325     88
1    102  14317
---- Validation: 
scalar performance:
{'acc': 0.9573639, 'precision': 0.69506806, 'recall': 0.705371, 'specificity': 0.705371, 'f1': 0.7000678, 'auroc': 0.93253434, 'binary_precision': 0.4112676, 'binary_recall': 0.43387815, 'binary_specificity': 0.9768639, 'binary_f1_score': 0.42227045}
confusion matrix:
       0    1
0  17649  418
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9123429, 'precision': 0.55015296, 'recall': 0.5735847, 'specificity': 0.5735847, 'f1': 0.55841315, 'auroc': 0.8148628, 'binary_precision': 0.13589744, 'binary_recall': 0.20384616, 'binary_specificity': 0.94332325, 'binary_f1_score': 0.16307692}
confusion matrix:
      0    1
0  5609  337
1   207   53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_10.png
early stop counter: 3
val acc:0.9573639035224915, best validation acc: 0.9744930863380432, corresponding to test acc:                         0.9524653553962708 / 0.9611666202545166
after epoch: 10,now: 2024-06-30 09:39:17.974936,epoch time: 0:22:39.520855,used: 3:45:49.288811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9972727, 'precision': 0.99769056, 'recall': 0.99510574, 'specificity': 0.99510574, 'f1': 0.99638957, 'auroc': 0.9998894, 'binary_precision': 0.99853206, 'binary_recall': 0.9907067, 'binary_specificity': 0.99950486, 'binary_f1_score': 0.994604}
confusion matrix:
       0      1
0  42392     21
1    134  14285
---- Validation: 
scalar performance:
{'acc': 0.958111, 'precision': 0.7158778, 'recall': 0.81734014, 'specificity': 0.81734014, 'f1': 0.75554407, 'auroc': 0.953686, 'binary_precision': 0.44444445, 'binary_recall': 0.66567606, 'binary_specificity': 0.9690043, 'binary_f1_score': 0.533016}
confusion matrix:
       0    1
0  17507  560
1    225  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94392526, 'precision': 0.6403265, 'recall': 0.6268461, 'specificity': 0.6268461, 'f1': 0.6331735, 'auroc': 0.9138464, 'binary_precision': 0.31196582, 'binary_recall': 0.28076923, 'binary_specificity': 0.972923, 'binary_f1_score': 0.29554656}
confusion matrix:
      0    1
0  5785  161
1   187   73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_11.png
early stop counter: 4
val acc:0.9581109881401062, best validation acc: 0.9744930863380432, corresponding to test acc:                         0.9524653553962708 / 0.9611666202545166
after epoch: 11,now: 2024-06-30 10:01:51.395745,epoch time: 0:22:33.420809,used: 4:08:22.709620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99637526, 'precision': 0.99727786, 'recall': 0.99315417, 'specificity': 0.99315417, 'f1': 0.9951942, 'auroc': 0.99982715, 'binary_precision': 0.99908704, 'binary_recall': 0.9866149, 'binary_specificity': 0.9996935, 'binary_f1_score': 0.9928118}
confusion matrix:
       0      1
0  42400     13
1    193  14226
---- Validation: 
scalar performance:
{'acc': 0.97097117, 'precision': 0.8468254, 'recall': 0.6552067, 'specificity': 0.6552067, 'f1': 0.71155864, 'auroc': 0.9528722, 'binary_precision': 0.7186441, 'binary_recall': 0.31500742, 'binary_specificity': 0.995406, 'binary_f1_score': 0.43801653}
confusion matrix:
       0    1
0  17984   83
1    461  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7971556, 'recall': 0.5356135, 'specificity': 0.5356135, 'f1': 0.5551229, 'auroc': 0.94432503, 'binary_precision': 0.6333333, 'binary_recall': 0.073076926, 'binary_specificity': 0.99815, 'binary_f1_score': 0.1310345}
confusion matrix:
      0   1
0  5935  11
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_12.png
early stop counter: 5
val acc:0.9709711670875549, best validation acc: 0.9744930863380432, corresponding to test acc:                         0.9524653553962708 / 0.9611666202545166
after epoch: 12,now: 2024-06-30 10:24:45.983650,epoch time: 0:22:54.587905,used: 4:31:17.297525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9942286, 'precision': 0.99078655, 'recall': 0.99405015, 'specificity': 0.99405015, 'f1': 0.99240434, 'auroc': 0.9996835, 'binary_precision': 0.9837259, 'binary_recall': 0.993688, 'binary_specificity': 0.99441236, 'binary_f1_score': 0.98868185}
confusion matrix:
       0      1
0  42178    237
1     91  14326
---- Validation: 
scalar performance:
{'acc': 0.95314837, 'precision': 0.69957733, 'recall': 0.8312175, 'specificity': 0.8312175, 'f1': 0.7464806, 'auroc': 0.9434157, 'binary_precision': 0.41063645, 'binary_recall': 0.6998514, 'binary_specificity': 0.9625837, 'binary_f1_score': 0.5175825}
confusion matrix:
       0    1
0  17391  676
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.7622025, 'recall': 0.81473, 'specificity': 0.81473, 'f1': 0.7857257, 'auroc': 0.9637125, 'binary_precision': 0.53968257, 'binary_recall': 0.65384614, 'binary_specificity': 0.97561383, 'binary_f1_score': 0.59130436}
confusion matrix:
      0    1
0  5801  145
1    90  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_13.png
new oracle model saved
early stop counter: 6
val acc:0.953148365020752, best validation acc: 0.9744930863380432, corresponding to test acc:                         0.9524653553962708 / 0.9621334075927734
after epoch: 13,now: 2024-06-30 10:47:17.199083,epoch time: 0:22:31.215433,used: 4:53:48.512958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99771255, 'precision': 0.99830925, 'recall': 0.99565256, 'specificity': 0.99565256, 'f1': 0.99697185, 'auroc': 0.9998746, 'binary_precision': 0.99951065, 'binary_recall': 0.99147016, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.99547416}
confusion matrix:
       0      1
0  42405      7
1    123  14297
---- Validation: 
scalar performance:
{'acc': 0.97353256, 'precision': 0.81451786, 'recall': 0.787429, 'specificity': 0.787429, 'f1': 0.800302, 'auroc': 0.96064645, 'binary_precision': 0.6443719, 'binary_recall': 0.5869242, 'binary_specificity': 0.9879338, 'binary_f1_score': 0.61430794}
confusion matrix:
       0    1
0  17849  218
1    278  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.79354286, 'recall': 0.6216364, 'specificity': 0.6216364, 'f1': 0.6683287, 'auroc': 0.9454758, 'binary_precision': 0.61904764, 'binary_recall': 0.25, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.3561644}
confusion matrix:
      0   1
0  5906  40
1   195  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_14.png
early stop counter: 7
val acc:0.9735325574874878, best validation acc: 0.9744930863380432, corresponding to test acc:                         0.9524653553962708 / 0.9621334075927734
after epoch: 14,now: 2024-06-30 11:09:46.683807,epoch time: 0:22:29.484724,used: 5:16:17.997682,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9979061, 'precision': 0.99788475, 'recall': 0.996583, 'specificity': 0.996583, 'f1': 0.99723166, 'auroc': 0.9998643, 'binary_precision': 0.99784154, 'binary_recall': 0.99389696, 'binary_specificity': 0.99926907, 'binary_f1_score': 0.9958653}
confusion matrix:
       0      1
0  42382     31
1     88  14331
---- Validation: 
scalar performance:
{'acc': 0.9498933, 'precision': 0.6989594, 'recall': 0.89461875, 'specificity': 0.89461875, 'f1': 0.7591624, 'auroc': 0.9614415, 'binary_precision': 0.40431654, 'binary_recall': 0.83506685, 'binary_specificity': 0.9541706, 'binary_f1_score': 0.5448376}
confusion matrix:
       0    1
0  17239  828
1    111  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94972605, 'precision': 0.6947814, 'recall': 0.7218227, 'specificity': 0.7218227, 'f1': 0.70726997, 'auroc': 0.9291463, 'binary_precision': 0.41275167, 'binary_recall': 0.4730769, 'binary_specificity': 0.9705685, 'binary_f1_score': 0.44086018}
confusion matrix:
      0    1
0  5771  175
1   137  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_15.png
early stop counter: 8
val acc:0.9498932957649231, best validation acc: 0.9744930863380432, corresponding to test acc:                         0.9524653553962708 / 0.9621334075927734
after epoch: 15,now: 2024-06-30 11:32:23.309551,epoch time: 0:22:36.625744,used: 5:38:54.623426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.998258, 'precision': 0.9981213, 'recall': 0.99727654, 'specificity': 0.99727654, 'f1': 0.99769807, 'auroc': 0.9998857, 'binary_precision': 0.9978445, 'binary_recall': 0.995284, 'binary_specificity': 0.99926907, 'binary_f1_score': 0.99656266}
confusion matrix:
       0      1
0  42382     31
1     68  14351
---- Validation: 
scalar performance:
{'acc': 0.9761473, 'precision': 0.82071745, 'recall': 0.8531591, 'specificity': 0.8531591, 'f1': 0.83607495, 'auroc': 0.96447754, 'binary_precision': 0.6518817, 'binary_recall': 0.7206538, 'binary_specificity': 0.9856645, 'binary_f1_score': 0.6845448}
confusion matrix:
       0    1
0  17808  259
1    188  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.8544961, 'recall': 0.6193039, 'specificity': 0.6193039, 'f1': 0.6735344, 'auroc': 0.93409026, 'binary_precision': 0.7411765, 'binary_recall': 0.2423077, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.3652174}
confusion matrix:
      0   1
0  5924  22
1   197  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_16.png
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-06-30 11:54:49.306055,epoch time: 0:22:25.996504,used: 6:01:20.619930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9980117, 'precision': 0.9983238, 'recall': 0.9964251, 'specificity': 0.9964251, 'f1': 0.99736977, 'auroc': 0.99984413, 'binary_precision': 0.99895376, 'binary_recall': 0.9932039, 'binary_specificity': 0.9996463, 'binary_f1_score': 0.99607044}
confusion matrix:
       0      1
0  42397     15
1     98  14322
---- Validation: 
scalar performance:
{'acc': 0.97155815, 'precision': 0.81410766, 'recall': 0.72274625, 'specificity': 0.72274625, 'f1': 0.7599144, 'auroc': 0.9354456, 'binary_precision': 0.64830506, 'binary_recall': 0.45468053, 'binary_specificity': 0.990812, 'binary_f1_score': 0.5344978}
confusion matrix:
       0    1
0  17901  166
1    367  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7590847, 'recall': 0.55567414, 'specificity': 0.55567414, 'f1': 0.58504385, 'auroc': 0.92130065, 'binary_precision': 0.5555556, 'binary_recall': 0.115384616, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.1910828}
confusion matrix:
      0   1
0  5922  24
1   230  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_17.png
early stop counter: 1
val acc:0.971558153629303, best validation acc: 0.9761472940444946, corresponding to test acc:                         0.9647115468978882 / 0.9647115468978882
after epoch: 17,now: 2024-06-30 12:17:27.526119,epoch time: 0:22:38.220064,used: 6:23:58.839994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99707913, 'precision': 0.9980273, 'recall': 0.99426615, 'specificity': 0.99426615, 'f1': 0.9961286, 'auroc': 0.9998332, 'binary_precision': 0.99992985, 'binary_recall': 0.98855597, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99421036}
confusion matrix:
       0      1
0  42413      1
1    165  14253
---- Validation: 
scalar performance:
{'acc': 0.9752401, 'precision': 0.9078628, 'recall': 0.69103825, 'specificity': 0.69103825, 'f1': 0.757391, 'auroc': 0.95942354, 'binary_precision': 0.8381877, 'binary_recall': 0.38484398, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.5274949}
confusion matrix:
       0    1
0  18017   50
1    414  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.67627645, 'recall': 0.5197243, 'specificity': 0.5197243, 'f1': 0.5272244, 'auroc': 0.9222572, 'binary_precision': 0.39285713, 'binary_recall': 0.042307694, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.076388896}
confusion matrix:
      0   1
0  5929  17
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_18.png
early stop counter: 2
val acc:0.9752401113510132, best validation acc: 0.9761472940444946, corresponding to test acc:                         0.9647115468978882 / 0.9647115468978882
after epoch: 18,now: 2024-06-30 12:40:00.316220,epoch time: 0:22:32.790101,used: 6:46:31.630095,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9963401, 'precision': 0.99575496, 'recall': 0.9945728, 'specificity': 0.9945728, 'f1': 0.995162, 'auroc': 0.9996679, 'binary_precision': 0.99457127, 'binary_recall': 0.99098474, 'binary_specificity': 0.9981609, 'binary_f1_score': 0.9927748}
confusion matrix:
       0      1
0  42334     78
1    130  14290
---- Validation: 
scalar performance:
{'acc': 0.971238, 'precision': 0.7887147, 'recall': 0.81628025, 'specificity': 0.81628025, 'f1': 0.8017988, 'auroc': 0.95768213, 'binary_precision': 0.5905405, 'binary_recall': 0.64933133, 'binary_specificity': 0.9832291, 'binary_f1_score': 0.6185421}
confusion matrix:
       0    1
0  17764  303
1    236  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.8027108, 'recall': 0.5900373, 'specificity': 0.5900373, 'f1': 0.63338876, 'auroc': 0.95541155, 'binary_precision': 0.64, 'binary_recall': 0.18461539, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.28656718}
confusion matrix:
      0   1
0  5919  27
1   212  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_19.png
early stop counter: 3
val acc:0.9712380170822144, best validation acc: 0.9761472940444946, corresponding to test acc:                         0.9647115468978882 / 0.9647115468978882
after epoch: 19,now: 2024-06-30 13:03:27.730773,epoch time: 0:23:27.414553,used: 7:09:59.044648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99862754, 'precision': 0.99866736, 'recall': 0.99770725, 'specificity': 0.99770725, 'f1': 0.9981861, 'auroc': 0.99991083, 'binary_precision': 0.998748, 'binary_recall': 0.9958388, 'binary_specificity': 0.9995756, 'binary_f1_score': 0.99729127}
confusion matrix:
       0      1
0  42395     18
1     60  14359
---- Validation: 
scalar performance:
{'acc': 0.97379935, 'precision': 0.8332732, 'recall': 0.7460818, 'specificity': 0.7460818, 'f1': 0.78251004, 'auroc': 0.9459472, 'binary_precision': 0.68495935, 'binary_recall': 0.5007429, 'binary_specificity': 0.9914208, 'binary_f1_score': 0.57854074}
confusion matrix:
       0    1
0  17912  155
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93425715, 'precision': 0.5415906, 'recall': 0.53169036, 'specificity': 0.53169036, 'f1': 0.53556895, 'auroc': 0.82002914, 'binary_precision': 0.12244898, 'binary_recall': 0.092307694, 'binary_specificity': 0.971073, 'binary_f1_score': 0.105263166}
confusion matrix:
      0    1
0  5774  172
1   236   24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_20.png
early stop counter: 4
val acc:0.9737993478775024, best validation acc: 0.9761472940444946, corresponding to test acc:                         0.9647115468978882 / 0.9647115468978882
after epoch: 20,now: 2024-06-30 13:27:06.719624,epoch time: 0:23:38.988851,used: 7:33:38.033499,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99723744, 'precision': 0.99801576, 'recall': 0.9946935, 'specificity': 0.9946935, 'f1': 0.99634045, 'auroc': 0.99993014, 'binary_precision': 0.99957967, 'binary_recall': 0.9895284, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.99452865}
confusion matrix:
       0      1
0  42406      6
1    151  14269
---- Validation: 
scalar performance:
{'acc': 0.97508, 'precision': 0.9376819, 'recall': 0.671643, 'specificity': 0.671643, 'f1': 0.7428057, 'auroc': 0.9561713, 'binary_precision': 0.8992248, 'binary_recall': 0.3447251, 'binary_specificity': 0.9985609, 'binary_f1_score': 0.49838883}
confusion matrix:
       0    1
0  18041   26
1    441  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.69355655, 'recall': 0.5054329, 'specificity': 0.5054329, 'f1': 0.5004908, 'auroc': 0.9106059, 'binary_precision': 0.42857143, 'binary_recall': 0.011538462, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.02247191}
confusion matrix:
      0  1
0  5942  4
1   257  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_21.png
early stop counter: 5
val acc:0.9750800132751465, best validation acc: 0.9761472940444946, corresponding to test acc:                         0.9647115468978882 / 0.9647115468978882
after epoch: 21,now: 2024-06-30 13:50:37.581643,epoch time: 0:23:30.862019,used: 7:57:08.895518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9983988, 'precision': 0.99886, 'recall': 0.9969131, 'specificity': 0.9969131, 'f1': 0.9978817, 'auroc': 0.99994946, 'binary_precision': 0.9997907, 'binary_recall': 0.99389696, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9968351}
confusion matrix:
       0      1
0  42410      3
1     88  14331
---- Validation: 
scalar performance:
{'acc': 0.97844183, 'precision': 0.8951484, 'recall': 0.7599338, 'specificity': 0.7599338, 'f1': 0.812464, 'auroc': 0.96184176, 'binary_precision': 0.8077803, 'binary_recall': 0.52451706, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.63603604}
confusion matrix:
       0    1
0  17983   84
1    320  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9553658, 'precision': 0.5444346, 'recall': 0.50408745, 'specificity': 0.50408745, 'f1': 0.49918184, 'auroc': 0.92062855, 'binary_precision': 0.13043478, 'binary_recall': 0.011538462, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.021201413}
confusion matrix:
      0   1
0  5926  20
1   257   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_22.png
better model found
persisted
after epoch: 22,now: 2024-06-30 14:13:59.709140,epoch time: 0:23:22.127497,used: 8:20:31.023015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9982228, 'precision': 0.9984882, 'recall': 0.99681807, 'specificity': 0.99681807, 'f1': 0.99764955, 'auroc': 0.99988806, 'binary_precision': 0.9990241, 'binary_recall': 0.9939663, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.9964888}
confusion matrix:
       0      1
0  42399     14
1     87  14332
---- Validation: 
scalar performance:
{'acc': 0.97844183, 'precision': 0.9045414, 'recall': 0.7506354, 'specificity': 0.7506354, 'f1': 0.8081031, 'auroc': 0.9683933, 'binary_precision': 0.8272506, 'binary_recall': 0.50520056, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.6273063}
confusion matrix:
       0    1
0  17996   71
1    333  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7720934, 'recall': 0.56704444, 'specificity': 0.56704444, 'f1': 0.6014621, 'auroc': 0.9538375, 'binary_precision': 0.58064514, 'binary_recall': 0.13846155, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.2236025}
confusion matrix:
      0   1
0  5920  26
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_23.png
early stop counter: 1
val acc:0.9784418344497681, best validation acc: 0.9784418344497681, corresponding to test acc:                         0.955365777015686 / 0.9647115468978882
after epoch: 23,now: 2024-06-30 14:37:12.612890,epoch time: 0:23:12.903750,used: 8:43:43.926765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99799407, 'precision': 0.9984971, 'recall': 0.9962071, 'specificity': 0.9962071, 'f1': 0.99734545, 'auroc': 0.9999305, 'binary_precision': 0.9995111, 'binary_recall': 0.9925792, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.99603313}
confusion matrix:
       0      1
0  42406      7
1    107  14312
---- Validation: 
scalar performance:
{'acc': 0.9764141, 'precision': 0.9088379, 'recall': 0.7109593, 'specificity': 0.7109593, 'f1': 0.77599084, 'auroc': 0.9672363, 'binary_precision': 0.83870965, 'binary_recall': 0.42496285, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.5641026}
confusion matrix:
       0    1
0  18012   55
1    387  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.7074027, 'recall': 0.5673698, 'specificity': 0.5673698, 'f1': 0.59708524, 'auroc': 0.8968055, 'binary_precision': 0.4512195, 'binary_recall': 0.1423077, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.21637428}
confusion matrix:
      0   1
0  5901  45
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_24.png
early stop counter: 2
val acc:0.9764140844345093, best validation acc: 0.9784418344497681, corresponding to test acc:                         0.955365777015686 / 0.9647115468978882
after epoch: 24,now: 2024-06-30 15:00:30.401436,epoch time: 0:23:17.788546,used: 9:07:01.715311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99695593, 'precision': 0.9971317, 'recall': 0.99482524, 'specificity': 0.99482524, 'f1': 0.9959716, 'auroc': 0.99967647, 'binary_precision': 0.9974859, 'binary_recall': 0.9904993, 'binary_specificity': 0.9991512, 'binary_f1_score': 0.99398035}
confusion matrix:
       0      1
0  42376     36
1    137  14283
---- Validation: 
scalar performance:
{'acc': 0.9747599, 'precision': 0.85159767, 'recall': 0.7379968, 'specificity': 0.7379968, 'f1': 0.7828984, 'auroc': 0.95592767, 'binary_precision': 0.7222222, 'binary_recall': 0.48291233, 'binary_specificity': 0.99308133, 'binary_f1_score': 0.5788068}
confusion matrix:
       0    1
0  17942  125
1    348  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.7220974, 'recall': 0.5275007, 'specificity': 0.5275007, 'f1': 0.5407799, 'auroc': 0.9311237, 'binary_precision': 0.48387095, 'binary_recall': 0.057692308, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.10309278}
confusion matrix:
      0   1
0  5930  16
1   245  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_25.png
early stop counter: 3
val acc:0.9747598767280579, best validation acc: 0.9784418344497681, corresponding to test acc:                         0.955365777015686 / 0.9647115468978882
after epoch: 25,now: 2024-06-30 15:23:39.240508,epoch time: 0:23:08.839072,used: 9:30:10.554383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.998258, 'precision': 0.99830467, 'recall': 0.99709344, 'specificity': 0.99709344, 'f1': 0.9976972, 'auroc': 0.99990404, 'binary_precision': 0.998399, 'binary_recall': 0.99472916, 'binary_specificity': 0.9994577, 'binary_f1_score': 0.99656075}
confusion matrix:
       0      1
0  42390     23
1     76  14343
---- Validation: 
scalar performance:
{'acc': 0.9803095, 'precision': 0.90063894, 'recall': 0.78879786, 'specificity': 0.78879786, 'f1': 0.83490384, 'auroc': 0.964219, 'binary_precision': 0.81666666, 'binary_recall': 0.58246654, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.6799653}
confusion matrix:
       0    1
0  17979   88
1    281  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7773577, 'recall': 0.5354453, 'specificity': 0.5354453, 'f1': 0.5545899, 'auroc': 0.91366076, 'binary_precision': 0.59375, 'binary_recall': 0.073076926, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.130137}
confusion matrix:
      0   1
0  5933  13
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_26.png
better model found
persisted
after epoch: 26,now: 2024-06-30 15:46:56.216309,epoch time: 0:23:16.975801,used: 9:53:27.530184,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99806446, 'precision': 0.9982669, 'recall': 0.9966204, 'specificity': 0.9966204, 'f1': 0.99744016, 'auroc': 0.99986064, 'binary_precision': 0.9986757, 'binary_recall': 0.9936889, 'binary_specificity': 0.999552, 'binary_f1_score': 0.996176}
confusion matrix:
       0      1
0  42394     19
1     91  14328
---- Validation: 
scalar performance:
{'acc': 0.9768943, 'precision': 0.8514494, 'recall': 0.78917253, 'specificity': 0.78917253, 'f1': 0.81700504, 'auroc': 0.96575934, 'binary_precision': 0.7181818, 'binary_recall': 0.5869242, 'binary_specificity': 0.9914208, 'binary_f1_score': 0.6459526}
confusion matrix:
       0    1
0  17912  155
1    278  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.70705926, 'recall': 0.5182217, 'specificity': 0.5182217, 'f1': 0.5246613, 'auroc': 0.92535996, 'binary_precision': 0.45454547, 'binary_recall': 0.03846154, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.07092199}
confusion matrix:
      0   1
0  5934  12
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_27.png
early stop counter: 1
val acc:0.9768943190574646, best validation acc: 0.9803094863891602, corresponding to test acc:                         0.9590718746185303 / 0.9647115468978882
after epoch: 27,now: 2024-06-30 16:10:12.752967,epoch time: 0:23:16.536658,used: 10:16:44.066842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99737823, 'precision': 0.9973922, 'recall': 0.99567974, 'specificity': 0.99567974, 'f1': 0.9965322, 'auroc': 0.9997277, 'binary_precision': 0.9974204, 'binary_recall': 0.9922319, 'binary_specificity': 0.9991276, 'binary_f1_score': 0.99481934}
confusion matrix:
       0      1
0  42377     37
1    112  14306
---- Validation: 
scalar performance:
{'acc': 0.97993594, 'precision': 0.90860033, 'recall': 0.77358353, 'specificity': 0.77358353, 'f1': 0.8266723, 'auroc': 0.97070444, 'binary_precision': 0.83370787, 'binary_recall': 0.551263, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.6636851}
confusion matrix:
       0    1
0  17993   74
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.8717631, 'recall': 0.612032, 'specificity': 0.612032, 'f1': 0.66656905, 'auroc': 0.94928026, 'binary_precision': 0.7763158, 'binary_recall': 0.22692308, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.35119048}
confusion matrix:
      0   1
0  5929  17
1   201  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_28.png
new oracle model saved
early stop counter: 2
val acc:0.9799359440803528, best validation acc: 0.9803094863891602, corresponding to test acc:                         0.9590718746185303 / 0.9648727178573608
after epoch: 28,now: 2024-06-30 16:33:33.682997,epoch time: 0:23:20.930030,used: 10:40:04.996872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99855715, 'precision': 0.99862015, 'recall': 0.99756837, 'specificity': 0.99756837, 'f1': 0.99809283, 'auroc': 0.9999274, 'binary_precision': 0.9987476, 'binary_recall': 0.9955611, 'binary_specificity': 0.9995756, 'binary_f1_score': 0.9971518}
confusion matrix:
       0      1
0  42396     18
1     64  14354
---- Validation: 
scalar performance:
{'acc': 0.976841, 'precision': 0.92546874, 'recall': 0.7068891, 'specificity': 0.7068891, 'f1': 0.77574265, 'auroc': 0.96548665, 'binary_precision': 0.87227416, 'binary_recall': 0.41604754, 'binary_specificity': 0.9977307, 'binary_f1_score': 0.5633803}
confusion matrix:
       0    1
0  18026   41
1    393  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7923061, 'recall': 0.5187262, 'specificity': 0.5187262, 'f1': 0.5256848, 'auroc': 0.9397851, 'binary_precision': 0.625, 'binary_recall': 0.03846154, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.072463766}
confusion matrix:
      0   1
0  5940   6
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_29.png
early stop counter: 3
val acc:0.9768409729003906, best validation acc: 0.9803094863891602, corresponding to test acc:                         0.9590718746185303 / 0.9648727178573608
after epoch: 29,now: 2024-06-30 16:56:51.038450,epoch time: 0:23:17.355453,used: 11:03:22.352325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99808204, 'precision': 0.99832475, 'recall': 0.99660933, 'specificity': 0.99660933, 'f1': 0.9974632, 'auroc': 0.99990493, 'binary_precision': 0.9988148, 'binary_recall': 0.9936195, 'binary_specificity': 0.99959916, 'binary_f1_score': 0.9962104}
confusion matrix:
       0      1
0  42396     17
1     92  14327
---- Validation: 
scalar performance:
{'acc': 0.97545356, 'precision': 0.8628808, 'recall': 0.73764133, 'specificity': 0.73764133, 'f1': 0.7860952, 'auroc': 0.96571577, 'binary_precision': 0.74482757, 'binary_recall': 0.48142645, 'binary_specificity': 0.9938562, 'binary_f1_score': 0.58483756}
confusion matrix:
       0    1
0  17956  111
1    349  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.780408, 'recall': 0.5336063, 'specificity': 0.5336063, 'f1': 0.5515922, 'auroc': 0.9486744, 'binary_precision': 0.6, 'binary_recall': 0.06923077, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.12413794}
confusion matrix:
      0   1
0  5934  12
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_30.png
early stop counter: 4
val acc:0.9754535555839539, best validation acc: 0.9803094863891602, corresponding to test acc:                         0.9590718746185303 / 0.9648727178573608
after epoch: 30,now: 2024-06-30 17:19:57.842017,epoch time: 0:23:06.803567,used: 11:26:29.155892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_53_28_seed_1_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:26:29.155892 at 2024-06-30 17:19:57.842017
persisted model performance metric: 

scalar performance:
{'acc': 0.9590719, 'precision': 0.7773577, 'recall': 0.5354453, 'specificity': 0.5354453, 'f1': 0.5545899, 'auroc': 0.91366076, 'binary_precision': 0.59375, 'binary_recall': 0.073076926, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.130137}
confusion matrix:
      0   1
0  5933  13
1   241  19
oracle model performance metric: 

scalar performance:
{'acc': 0.9648727, 'precision': 0.8717631, 'recall': 0.612032, 'specificity': 0.612032, 'f1': 0.66656905, 'auroc': 0.94928026, 'binary_precision': 0.7763158, 'binary_recall': 0.22692308, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.35119048}
confusion matrix:
      0   1
0  5929  17
1   201  59
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 368857 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool | 337010 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |  31847 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 368857 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool | 337010 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |  31847 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362638 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |  30848 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10006 MiB |  10022 MiB |  19316 MiB |   9310 MiB |
|       from large pool |   9950 MiB |   9962 MiB |  19240 MiB |   9290 MiB |
|       from small pool |     56 MiB |     60 MiB |     76 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 386854 KiB |    876 MiB |   1755 TiB |   1755 TiB |
|       from large pool | 377742 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |   9112 KiB |     28 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3293    |    7964    |  441871 K  |  441867 K  |
|       from large pool |     151    |     986    |  226164 K  |  226164 K  |
|       from small pool |    3142    |    7811    |  215706 K  |  215703 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3293    |    7964    |  441871 K  |  441867 K  |
|       from large pool |     151    |     986    |  226164 K  |  226164 K  |
|       from small pool |    3142    |    7811    |  215706 K  |  215703 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     443    |     445    |     838    |     395    |
|       from large pool |     415    |     415    |     800    |     385    |
|       from small pool |      28    |      30    |      38    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |    3613    |  286316 K  |  286315 K  |
|       from large pool |      35    |     417    |  181913 K  |  181913 K  |
|       from small pool |      33    |    3582    |  104402 K  |  104402 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |      0 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  19316 MiB |  18578 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  19240 MiB |  18542 MiB |
|       from small pool |  40960 KiB |     60 MiB |     76 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |   1755 TiB |   1755 TiB |
|       from large pool |  24320 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |      0 KiB |     32 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  441871 K  |  441871 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215706 K  |  215706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  441871 K  |  441871 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215706 K  |  215706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |     838    |     787    |
|       from large pool |      31    |     415    |     800    |     769    |
|       from small pool |      20    |      30    |      38    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3613    |  286317 K  |  286317 K  |
|       from large pool |       3    |     417    |  181913 K  |  181913 K  |
|       from small pool |       0    |    3582    |  104403 K  |  104403 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |      0 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  19316 MiB |  18578 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  19240 MiB |  18542 MiB |
|       from small pool |  40960 KiB |     60 MiB |     76 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |   1755 TiB |   1755 TiB |
|       from large pool |  24320 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |      0 KiB |     32 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  441871 K  |  441871 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215706 K  |  215706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  441871 K  |  441871 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215706 K  |  215706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |     838    |     787    |
|       from large pool |      31    |     415    |     800    |     769    |
|       from small pool |      20    |      30    |      38    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3613    |  286317 K  |  286317 K  |
|       from large pool |       3    |     417    |  181913 K  |  181913 K  |
|       from small pool |       0    |    3582    |  104403 K  |  104403 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982

 Experiment start at: 2024-06-30 17:27:32.784011
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99199164, 'precision': 0.9910872, 'recall': 0.988237, 'specificity': 0.988237, 'f1': 0.9896508, 'auroc': 0.99891174, 'binary_precision': 0.9891949, 'binary_recall': 0.98030275, 'binary_specificity': 0.99617124, 'binary_f1_score': 0.9847288}
confusion matrix:
       0      1
0  42149    162
1    298  14831
---- Validation: 
scalar performance:
{'acc': 0.97176796, 'precision': 0.7817954, 'recall': 0.7059555, 'specificity': 0.7059555, 'f1': 0.7374427, 'auroc': 0.93398607, 'binary_precision': 0.5825688, 'binary_recall': 0.42192692, 'binary_specificity': 0.98998404, 'binary_f1_score': 0.4894027}
confusion matrix:
       0    1
0  17989  182
1    348  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.6364124, 'recall': 0.51692754, 'specificity': 0.51692754, 'f1': 0.5228474, 'auroc': 0.9074141, 'binary_precision': 0.31034482, 'binary_recall': 0.037190083, 'binary_specificity': 0.996665, 'binary_f1_score': 0.06642067}
confusion matrix:
      0   1
0  5977  20
1   233   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-30 17:51:29.554143,epoch time: 0:23:56.770132,used: 0:23:56.770132,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9924443, 'precision': 0.9903461, 'recall': 0.99017954, 'specificity': 0.99017954, 'f1': 0.99026275, 'auroc': 0.9990802, 'binary_precision': 0.9859146, 'binary_recall': 0.9853933, 'binary_specificity': 0.99496573, 'binary_f1_score': 0.9856539}
confusion matrix:
       0      1
0  42097    213
1    221  14909
---- Validation: 
scalar performance:
{'acc': 0.9700634, 'precision': 0.75861204, 'recall': 0.7669097, 'specificity': 0.7669097, 'f1': 0.7626885, 'auroc': 0.93867445, 'binary_precision': 0.5321543, 'binary_recall': 0.5498339, 'binary_specificity': 0.9839855, 'binary_f1_score': 0.5408497}
confusion matrix:
       0    1
0  17880  291
1    271  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.7564988, 'recall': 0.5838587, 'specificity': 0.5838587, 'f1': 0.62199783, 'auroc': 0.91131014, 'binary_precision': 0.54545456, 'binary_recall': 0.17355372, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.2633229}
confusion matrix:
      0   1
0  5962  35
1   200  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_2.png
new oracle model saved
early stop counter: 1
val acc:0.9700633883476257, best validation acc: 0.9717679619789124, corresponding to test acc:                         0.9594486355781555 / 0.9623336791992188
after epoch: 2,now: 2024-06-30 18:14:25.625419,epoch time: 0:22:56.071276,used: 0:46:52.841408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9948468, 'precision': 0.99541056, 'recall': 0.99129975, 'specificity': 0.99129975, 'f1': 0.9933319, 'auroc': 0.99925184, 'binary_precision': 0.99658495, 'binary_recall': 0.9838049, 'binary_specificity': 0.9987947, 'binary_f1_score': 0.9901537}
confusion matrix:
       0      1
0  42261     51
1    245  14883
---- Validation: 
scalar performance:
{'acc': 0.97293985, 'precision': 0.8082962, 'recall': 0.67765105, 'specificity': 0.67765105, 'f1': 0.72399265, 'auroc': 0.92842364, 'binary_precision': 0.6374269, 'binary_recall': 0.36212623, 'binary_specificity': 0.9931759, 'binary_f1_score': 0.46186438}
confusion matrix:
       0    1
0  18047  124
1    384  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9567238, 'precision': 0.65322155, 'recall': 0.55714774, 'specificity': 0.55714774, 'f1': 0.57979614, 'auroc': 0.9078437, 'binary_precision': 0.3409091, 'binary_recall': 0.12396694, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.18181817}
confusion matrix:
      0   1
0  5939  58
1   212  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_3.png
better model found
persisted
after epoch: 3,now: 2024-06-30 18:37:56.780805,epoch time: 0:23:31.155386,used: 1:10:23.996794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9957695, 'precision': 0.9966421, 'recall': 0.9924574, 'specificity': 0.9924574, 'f1': 0.9945258, 'auroc': 0.9995299, 'binary_precision': 0.9984597, 'binary_recall': 0.9854584, 'binary_specificity': 0.9994564, 'binary_f1_score': 0.9919164}
confusion matrix:
       0      1
0  42288     23
1    220  14909
---- Validation: 
scalar performance:
{'acc': 0.9759229, 'precision': 0.8272172, 'recall': 0.74022365, 'specificity': 0.74022365, 'f1': 0.77650154, 'auroc': 0.9329376, 'binary_precision': 0.6712329, 'binary_recall': 0.4883721, 'binary_specificity': 0.99207526, 'binary_f1_score': 0.56538457}
confusion matrix:
       0    1
0  18027  144
1    308  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95383877, 'precision': 0.6374155, 'recall': 0.56952614, 'specificity': 0.56952614, 'f1': 0.5903248, 'auroc': 0.8585844, 'binary_precision': 0.30833334, 'binary_recall': 0.15289256, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.20441988}
confusion matrix:
      0   1
0  5914  83
1   205  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_4.png
better model found
persisted
after epoch: 4,now: 2024-06-30 19:01:40.693534,epoch time: 0:23:43.912729,used: 1:34:07.909523,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9959784, 'precision': 0.9956681, 'recall': 0.99395835, 'specificity': 0.99395835, 'f1': 0.99480915, 'auroc': 0.99967957, 'binary_precision': 0.9950163, 'binary_recall': 0.98968935, 'binary_specificity': 0.99822736, 'binary_f1_score': 0.99234563}
confusion matrix:
       0      1
0  42235     75
1    156  14974
---- Validation: 
scalar performance:
{'acc': 0.9544026, 'precision': 0.69456106, 'recall': 0.8808832, 'specificity': 0.8808832, 'f1': 0.75311255, 'auroc': 0.9584806, 'binary_precision': 0.39590165, 'binary_recall': 0.8023256, 'binary_specificity': 0.9594409, 'binary_f1_score': 0.5301866}
confusion matrix:
       0    1
0  17434  737
1    119  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9453438, 'precision': 0.68568116, 'recall': 0.8188981, 'specificity': 0.8188981, 'f1': 0.73146105, 'auroc': 0.9214704, 'binary_precision': 0.3846154, 'binary_recall': 0.6818182, 'binary_specificity': 0.955978, 'binary_f1_score': 0.4918033}
confusion matrix:
      0    1
0  5733  264
1    77  165
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_5.png
early stop counter: 1
val acc:0.9544026255607605, best validation acc: 0.9759228825569153, corresponding to test acc:                         0.9538387656211853 / 0.9623336791992188
after epoch: 5,now: 2024-06-30 19:24:44.463134,epoch time: 0:23:03.769600,used: 1:57:11.679123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9965007, 'precision': 0.9953766, 'recall': 0.99560785, 'specificity': 0.99560785, 'f1': 0.9954921, 'auroc': 0.9997051, 'binary_precision': 0.99299914, 'binary_recall': 0.99372107, 'binary_specificity': 0.9974947, 'binary_f1_score': 0.9933599}
confusion matrix:
       0      1
0  42204    106
1     95  15035
---- Validation: 
scalar performance:
{'acc': 0.9560006, 'precision': 0.6933545, 'recall': 0.8383441, 'specificity': 0.8383441, 'f1': 0.7432342, 'auroc': 0.94395435, 'binary_precision': 0.39648798, 'binary_recall': 0.7126246, 'binary_specificity': 0.96406364, 'binary_f1_score': 0.50950116}
confusion matrix:
       0    1
0  17518  653
1    173  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9753166, 'precision': 0.85842764, 'recall': 0.7809552, 'specificity': 0.7809552, 'f1': 0.8145391, 'auroc': 0.9296997, 'binary_precision': 0.7340425, 'binary_recall': 0.57024795, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.6418604}
confusion matrix:
      0    1
0  5947   50
1   104  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_6.png
new oracle model saved
early stop counter: 2
val acc:0.9560006260871887, best validation acc: 0.9759228825569153, corresponding to test acc:                         0.9538387656211853 / 0.97531658411026
after epoch: 6,now: 2024-06-30 19:47:35.734275,epoch time: 0:22:51.271141,used: 2:20:02.950264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99489903, 'precision': 0.99501586, 'recall': 0.9918245, 'specificity': 0.9918245, 'f1': 0.9934062, 'auroc': 0.9996184, 'binary_precision': 0.99526006, 'binary_recall': 0.9853272, 'binary_specificity': 0.9983219, 'binary_f1_score': 0.9902687}
confusion matrix:
       0      1
0  42239     71
1    222  14908
---- Validation: 
scalar performance:
{'acc': 0.97363234, 'precision': 0.79824305, 'recall': 0.7350252, 'specificity': 0.7350252, 'f1': 0.7625525, 'auroc': 0.95241976, 'binary_precision': 0.6135881, 'binary_recall': 0.48006645, 'binary_specificity': 0.98998404, 'binary_f1_score': 0.5386766}
confusion matrix:
       0    1
0  17989  182
1    313  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.7713288, 'recall': 0.56014925, 'specificity': 0.56014925, 'f1': 0.59243804, 'auroc': 0.90248203, 'binary_precision': 0.5769231, 'binary_recall': 0.12396694, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.20408164}
confusion matrix:
      0   1
0  5975  22
1   212  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_7.png
early stop counter: 3
val acc:0.9736323356628418, best validation acc: 0.9759228825569153, corresponding to test acc:                         0.9538387656211853 / 0.97531658411026
after epoch: 7,now: 2024-06-30 20:10:33.524716,epoch time: 0:22:57.790441,used: 2:43:00.740705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9928969, 'precision': 0.9886553, 'recall': 0.9931829, 'specificity': 0.9931829, 'f1': 0.99088997, 'auroc': 0.99974287, 'binary_precision': 0.979544, 'binary_recall': 0.99378717, 'binary_specificity': 0.99257857, 'binary_f1_score': 0.9866141}
confusion matrix:
       0      1
0  41996    314
1     94  15036
---- Validation: 
scalar performance:
{'acc': 0.96127415, 'precision': 0.71917725, 'recall': 0.89647853, 'specificity': 0.89647853, 'f1': 0.7788836, 'auroc': 0.967818, 'binary_precision': 0.4442462, 'binary_recall': 0.82724255, 'binary_specificity': 0.9657146, 'binary_f1_score': 0.57806146}
confusion matrix:
       0    1
0  17548  623
1    104  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.7516706, 'recall': 0.77056986, 'specificity': 0.77056986, 'f1': 0.76073265, 'auroc': 0.9370464, 'binary_precision': 0.5210728, 'binary_recall': 0.56198347, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.5407555}
confusion matrix:
      0    1
0  5872  125
1   106  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_8.png
early stop counter: 4
val acc:0.9612741470336914, best validation acc: 0.9759228825569153, corresponding to test acc:                         0.9538387656211853 / 0.97531658411026
after epoch: 8,now: 2024-06-30 20:33:31.291953,epoch time: 0:22:57.767237,used: 3:05:58.507942,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9952472, 'precision': 0.9932485, 'recall': 0.9945233, 'specificity': 0.9945233, 'f1': 0.9938836, 'auroc': 0.9996985, 'binary_precision': 0.9890059, 'binary_recall': 0.9929936, 'binary_specificity': 0.99605304, 'binary_f1_score': 0.9909957}
confusion matrix:
       0      1
0  42144    167
1    106  15023
---- Validation: 
scalar performance:
{'acc': 0.9765621, 'precision': 0.8470492, 'recall': 0.7228868, 'specificity': 0.7228868, 'f1': 0.77040553, 'auroc': 0.9526174, 'binary_precision': 0.7120419, 'binary_recall': 0.45182723, 'binary_specificity': 0.9939464, 'binary_f1_score': 0.55284554}
confusion matrix:
       0    1
0  18061  110
1    330  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.7542296, 'recall': 0.52395964, 'specificity': 0.52395964, 'f1': 0.53562975, 'auroc': 0.8981183, 'binary_precision': 0.54545456, 'binary_recall': 0.049586777, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.09090909}
confusion matrix:
      0   1
0  5987  10
1   230  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_9.png
better model found
persisted
after epoch: 9,now: 2024-06-30 20:56:35.087324,epoch time: 0:23:03.795371,used: 3:29:02.303313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9955084, 'precision': 0.9969256, 'recall': 0.99151576, 'specificity': 0.99151576, 'f1': 0.9941807, 'auroc': 0.99971354, 'binary_precision': 0.99986553, 'binary_recall': 0.98307884, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99140114}
confusion matrix:
       0      1
0  42309      2
1    256  14873
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.74505794, 'recall': 0.71064633, 'specificity': 0.71064633, 'f1': 0.7264177, 'auroc': 0.9476522, 'binary_precision': 0.50873786, 'binary_recall': 0.43521595, 'binary_specificity': 0.9860767, 'binary_f1_score': 0.46911368}
confusion matrix:
       0    1
0  17918  253
1    340  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9543196, 'precision': 0.6114086, 'recall': 0.5420179, 'specificity': 0.5420179, 'f1': 0.5577551, 'auroc': 0.8833992, 'binary_precision': 0.25842696, 'binary_recall': 0.09504132, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.1389728}
confusion matrix:
      0   1
0  5931  66
1   219  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_10.png
early stop counter: 1
val acc:0.9684121012687683, best validation acc: 0.9765620827674866, corresponding to test acc:                         0.9615322947502136 / 0.97531658411026
after epoch: 10,now: 2024-06-30 21:19:27.930059,epoch time: 0:22:52.842735,used: 3:51:55.146048,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99773675, 'precision': 0.9974631, 'recall': 0.9967017, 'specificity': 0.9967017, 'f1': 0.9970816, 'auroc': 0.9998448, 'binary_precision': 0.9968862, 'binary_recall': 0.9945142, 'binary_specificity': 0.99888915, 'binary_f1_score': 0.9956988}
confusion matrix:
       0      1
0  42263     47
1     83  15047
---- Validation: 
scalar performance:
{'acc': 0.96612155, 'precision': 0.7296623, 'recall': 0.756843, 'specificity': 0.756843, 'f1': 0.74240565, 'auroc': 0.94496197, 'binary_precision': 0.4748521, 'binary_recall': 0.5332226, 'binary_specificity': 0.9804634, 'binary_f1_score': 0.5023474}
confusion matrix:
       0    1
0  17816  355
1    281  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95688415, 'precision': 0.7205168, 'recall': 0.78524625, 'specificity': 0.78524625, 'f1': 0.7481073, 'auroc': 0.925254, 'binary_precision': 0.45741326, 'binary_recall': 0.59917355, 'binary_specificity': 0.971319, 'binary_f1_score': 0.51878357}
confusion matrix:
      0    1
0  5825  172
1    97  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_11.png
early stop counter: 2
val acc:0.9661215543746948, best validation acc: 0.9765620827674866, corresponding to test acc:                         0.9615322947502136 / 0.97531658411026
after epoch: 11,now: 2024-06-30 21:42:22.184055,epoch time: 0:22:54.253996,used: 4:14:49.400044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9961873, 'precision': 0.9940277, 'recall': 0.99618053, 'specificity': 0.99618053, 'f1': 0.99509764, 'auroc': 0.99980015, 'binary_precision': 0.9894295, 'binary_recall': 0.99616605, 'binary_specificity': 0.99619496, 'binary_f1_score': 0.99278635}
confusion matrix:
       0      1
0  42151    161
1     58  15070
---- Validation: 
scalar performance:
{'acc': 0.9322964, 'precision': 0.6445418, 'recall': 0.87107, 'specificity': 0.87107, 'f1': 0.698421, 'auroc': 0.9481698, 'binary_precision': 0.29591215, 'binary_recall': 0.80564785, 'binary_specificity': 0.9364922, 'binary_f1_score': 0.4328425}
confusion matrix:
       0     1
0  17017  1154
1    117   485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9398942, 'precision': 0.64700663, 'recall': 0.7149435, 'specificity': 0.7149435, 'f1': 0.6732652, 'auroc': 0.91181886, 'binary_precision': 0.31578946, 'binary_recall': 0.47107437, 'binary_specificity': 0.9588127, 'binary_f1_score': 0.37810946}
confusion matrix:
      0    1
0  5750  247
1   128  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_12.png
early stop counter: 3
val acc:0.9322963953018188, best validation acc: 0.9765620827674866, corresponding to test acc:                         0.9615322947502136 / 0.97531658411026
after epoch: 12,now: 2024-06-30 22:05:17.553596,epoch time: 0:22:55.369541,used: 4:37:44.769585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.995578, 'precision': 0.99692833, 'recall': 0.991691, 'specificity': 0.991691, 'f1': 0.9942722, 'auroc': 0.9998733, 'binary_precision': 0.99973124, 'binary_recall': 0.9834765, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99153733}
confusion matrix:
       0      1
0  42306      4
1    250  14880
---- Validation: 
scalar performance:
{'acc': 0.9701699, 'precision': 0.88126194, 'recall': 0.5469295, 'specificity': 0.5469295, 'f1': 0.57697594, 'auroc': 0.95213604, 'binary_precision': 0.7916667, 'binary_recall': 0.094684385, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.16913947}
confusion matrix:
       0   1
0  18156  15
1    545  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.6807507, 'recall': 0.5038821, 'specificity': 0.5038821, 'f1': 0.49816337, 'auroc': 0.9228226, 'binary_precision': 0.4, 'binary_recall': 0.008264462, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.016194332}
confusion matrix:
      0  1
0  5994  3
1   240  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_13.png
early stop counter: 4
val acc:0.9701699018478394, best validation acc: 0.9765620827674866, corresponding to test acc:                         0.9615322947502136 / 0.97531658411026
after epoch: 13,now: 2024-06-30 22:28:11.769279,epoch time: 0:22:54.215683,used: 5:00:38.985268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9970056, 'precision': 0.99758565, 'recall': 0.99469805, 'specificity': 0.99469805, 'f1': 0.99613047, 'auroc': 0.9998555, 'binary_precision': 0.9987995, 'binary_recall': 0.98982155, 'binary_specificity': 0.99957454, 'binary_f1_score': 0.9942903}
confusion matrix:
       0      1
0  42292     18
1    154  14976
---- Validation: 
scalar performance:
{'acc': 0.97645557, 'precision': 0.8384822, 'recall': 0.7340745, 'specificity': 0.7340745, 'f1': 0.77600175, 'auroc': 0.9497109, 'binary_precision': 0.69417477, 'binary_recall': 0.47508305, 'binary_specificity': 0.9930659, 'binary_f1_score': 0.56410253}
confusion matrix:
       0    1
0  18045  126
1    316  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9559224, 'precision': 0.547616, 'recall': 0.5091451, 'specificity': 0.5091451, 'f1': 0.5096271, 'auroc': 0.886754, 'binary_precision': 0.13333334, 'binary_recall': 0.024793388, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.04181185}
confusion matrix:
      0   1
0  5958  39
1   236   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_14.png
early stop counter: 5
val acc:0.976455569267273, best validation acc: 0.9765620827674866, corresponding to test acc:                         0.9615322947502136 / 0.97531658411026
after epoch: 14,now: 2024-06-30 22:51:05.623036,epoch time: 0:22:53.853757,used: 5:23:32.839025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9955606, 'precision': 0.99474895, 'recall': 0.9938021, 'specificity': 0.9938021, 'f1': 0.99427426, 'auroc': 0.9997667, 'binary_precision': 0.9930394, 'binary_recall': 0.9900859, 'binary_specificity': 0.9975183, 'binary_f1_score': 0.99156046}
confusion matrix:
       0      1
0  42205    105
1    150  14980
---- Validation: 
scalar performance:
{'acc': 0.9678261, 'precision': 0.7458253, 'recall': 0.87898386, 'specificity': 0.87898386, 'f1': 0.79652023, 'auroc': 0.9654077, 'binary_precision': 0.4989429, 'binary_recall': 0.78405315, 'binary_specificity': 0.9739145, 'binary_f1_score': 0.6098191}
confusion matrix:
       0    1
0  17697  474
1    130  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695464, 'precision': 0.82846487, 'recall': 0.69864404, 'specificity': 0.69864404, 'f1': 0.7460296, 'auroc': 0.9575578, 'binary_precision': 0.6805556, 'binary_recall': 0.40495867, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.507772}
confusion matrix:
      0   1
0  5951  46
1   144  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_15.png
early stop counter: 6
val acc:0.9678261280059814, best validation acc: 0.9765620827674866, corresponding to test acc:                         0.9615322947502136 / 0.97531658411026
after epoch: 15,now: 2024-06-30 23:14:18.267635,epoch time: 0:23:12.644599,used: 5:46:45.483624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9970752, 'precision': 0.9976328, 'recall': 0.9948299, 'specificity': 0.9948299, 'f1': 0.9962206, 'auroc': 0.9998638, 'binary_precision': 0.99879974, 'binary_recall': 0.99008524, 'binary_specificity': 0.9995746, 'binary_f1_score': 0.99442345}
confusion matrix:
       0      1
0  42293     18
1    150  14979
---- Validation: 
scalar performance:
{'acc': 0.9738987, 'precision': 0.7824458, 'recall': 0.8508018, 'specificity': 0.8508018, 'f1': 0.81255174, 'auroc': 0.9627485, 'binary_precision': 0.57427055, 'binary_recall': 0.7192691, 'binary_specificity': 0.9823345, 'binary_f1_score': 0.6386431}
confusion matrix:
       0    1
0  17850  321
1    169  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9525565, 'precision': 0.6996257, 'recall': 0.7651505, 'specificity': 0.7651505, 'f1': 0.72701013, 'auroc': 0.9294486, 'binary_precision': 0.41717792, 'binary_recall': 0.56198347, 'binary_specificity': 0.9683175, 'binary_f1_score': 0.47887325}
confusion matrix:
      0    1
0  5807  190
1   106  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_16.png
early stop counter: 7
val acc:0.973898708820343, best validation acc: 0.9765620827674866, corresponding to test acc:                         0.9615322947502136 / 0.97531658411026
after epoch: 16,now: 2024-06-30 23:37:46.902186,epoch time: 0:23:28.634551,used: 6:10:14.118175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9972841, 'precision': 0.99709034, 'recall': 0.9959057, 'specificity': 0.9959057, 'f1': 0.9964961, 'auroc': 0.99985445, 'binary_precision': 0.9966826, 'binary_recall': 0.9929931, 'binary_specificity': 0.9988183, 'binary_f1_score': 0.9948344}
confusion matrix:
       0      1
0  42262     50
1    106  15022
---- Validation: 
scalar performance:
{'acc': 0.96164703, 'precision': 0.71657145, 'recall': 0.85651875, 'specificity': 0.85651875, 'f1': 0.7672083, 'auroc': 0.9423058, 'binary_precision': 0.4418146, 'binary_recall': 0.74418604, 'binary_specificity': 0.96885145, 'binary_f1_score': 0.5544555}
confusion matrix:
       0    1
0  17605  566
1    154  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9182561, 'precision': 0.5917159, 'recall': 0.6679986, 'specificity': 0.6679986, 'f1': 0.61509794, 'auroc': 0.85154974, 'binary_precision': 0.20869565, 'binary_recall': 0.3966942, 'binary_specificity': 0.939303, 'binary_f1_score': 0.2735043}
confusion matrix:
      0    1
0  5633  364
1   146   96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_17.png
early stop counter: 8
val acc:0.9616470336914062, best validation acc: 0.9765620827674866, corresponding to test acc:                         0.9615322947502136 / 0.97531658411026
after epoch: 17,now: 2024-07-01 00:01:04.264250,epoch time: 0:23:17.362064,used: 6:33:31.480239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99695337, 'precision': 0.99533844, 'recall': 0.99682796, 'specificity': 0.99682796, 'f1': 0.9960801, 'auroc': 0.9998469, 'binary_precision': 0.9919079, 'binary_recall': 0.9965629, 'binary_specificity': 0.99709296, 'binary_f1_score': 0.99423}
confusion matrix:
       0      1
0  42188    123
1     52  15077
---- Validation: 
scalar performance:
{'acc': 0.92292124, 'precision': 0.6327947, 'recall': 0.879879, 'specificity': 0.879879, 'f1': 0.68419886, 'auroc': 0.9524826, 'binary_precision': 0.2714981, 'binary_recall': 0.83388704, 'binary_specificity': 0.9258709, 'binary_f1_score': 0.40962872}
confusion matrix:
       0     1
0  16824  1347
1    100   502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93877226, 'precision': 0.6377125, 'recall': 0.6945325, 'specificity': 0.6945325, 'f1': 0.6602046, 'auroc': 0.912747, 'binary_precision': 0.29885057, 'binary_recall': 0.42975205, 'binary_specificity': 0.959313, 'binary_f1_score': 0.35254237}
confusion matrix:
      0    1
0  5753  244
1   138  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_18.png
early stop counter: 9
val acc:0.9229212403297424, best validation acc: 0.9765620827674866, corresponding to test acc:                         0.9615322947502136 / 0.97531658411026
after epoch: 18,now: 2024-07-01 00:24:21.027377,epoch time: 0:23:16.763127,used: 6:56:48.243366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9969185, 'precision': 0.99780834, 'recall': 0.99425685, 'specificity': 0.99425685, 'f1': 0.9960153, 'auroc': 0.9998342, 'binary_precision': 0.99966586, 'binary_recall': 0.98863184, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.9941183}
confusion matrix:
       0      1
0  42305      5
1    172  14958
---- Validation: 
scalar performance:
{'acc': 0.9756033, 'precision': 0.93179286, 'recall': 0.6364654, 'specificity': 0.6364654, 'f1': 0.70316094, 'auroc': 0.9676232, 'binary_precision': 0.88709676, 'binary_recall': 0.2740864, 'binary_specificity': 0.9988443, 'binary_f1_score': 0.41878173}
confusion matrix:
       0    1
0  18150   21
1    437  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.827442, 'recall': 0.51826155, 'specificity': 0.51826155, 'f1': 0.5255993, 'auroc': 0.9537889, 'binary_precision': 0.6923077, 'binary_recall': 0.037190083, 'binary_specificity': 0.999333, 'binary_f1_score': 0.07058824}
confusion matrix:
      0  1
0  5993  4
1   233  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_19.png
early stop counter: 10
val acc:0.9756032824516296, best validation acc: 0.9765620827674866, corresponding to test acc:                         0.9615322947502136 / 0.97531658411026
after epoch: 19,now: 2024-07-01 00:47:33.749513,epoch time: 0:23:12.722136,used: 7:20:00.965502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99623954, 'precision': 0.99457526, 'recall': 0.9957489, 'specificity': 0.9957489, 'f1': 0.9951602, 'auroc': 0.99985075, 'binary_precision': 0.9910438, 'binary_recall': 0.9947121, 'binary_specificity': 0.9967857, 'binary_f1_score': 0.9928746}
confusion matrix:
       0      1
0  42175    136
1     80  15049
---- Validation: 
scalar performance:
{'acc': 0.95424277, 'precision': 0.6947541, 'recall': 0.8856189, 'specificity': 0.8856189, 'f1': 0.7541671, 'auroc': 0.96202797, 'binary_precision': 0.39595142, 'binary_recall': 0.81229234, 'binary_specificity': 0.9589456, 'binary_f1_score': 0.53238976}
confusion matrix:
       0    1
0  17425  746
1    113  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535182, 'precision': 0.71387804, 'recall': 0.84099483, 'specificity': 0.84099483, 'f1': 0.76048064, 'auroc': 0.9459635, 'binary_precision': 0.43939394, 'binary_recall': 0.71900827, 'binary_specificity': 0.96298146, 'binary_f1_score': 0.5454545}
confusion matrix:
      0    1
0  5775  222
1    68  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_20.png
early stop counter: 11
val acc:0.9542427659034729, best validation acc: 0.9765620827674866, corresponding to test acc:                         0.9615322947502136 / 0.97531658411026
after epoch: 20,now: 2024-07-01 01:10:40.900279,epoch time: 0:23:07.150766,used: 7:43:08.116268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9973363, 'precision': 0.99587166, 'recall': 0.997279, 'specificity': 0.997279, 'f1': 0.9965726, 'auroc': 0.9999046, 'binary_precision': 0.99276125, 'binary_recall': 0.99715775, 'binary_specificity': 0.9974002, 'binary_f1_score': 0.99495465}
confusion matrix:
       0      1
0  42201    110
1     43  15086
---- Validation: 
scalar performance:
{'acc': 0.9395941, 'precision': 0.659082, 'recall': 0.8804611, 'specificity': 0.8804611, 'f1': 0.71629035, 'auroc': 0.9522043, 'binary_precision': 0.32453826, 'binary_recall': 0.81727576, 'binary_specificity': 0.9436465, 'binary_f1_score': 0.46458924}
confusion matrix:
       0     1
0  17147  1024
1    110   492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.880109, 'precision': 0.59985775, 'recall': 0.8226365, 'specificity': 0.8226365, 'f1': 0.6319578, 'auroc': 0.9023024, 'binary_precision': 0.21052632, 'binary_recall': 0.76033056, 'binary_specificity': 0.8849425, 'binary_f1_score': 0.3297491}
confusion matrix:
      0    1
0  5307  690
1    58  184
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_21.png
early stop counter: 12
val acc:0.9395940899848938, best validation acc: 0.9765620827674866, corresponding to test acc:                         0.9615322947502136 / 0.97531658411026
after epoch: 21,now: 2024-07-01 01:33:49.021487,epoch time: 0:23:08.121208,used: 8:06:16.237476,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9985202, 'precision': 0.99869764, 'recall': 0.9974879, 'specificity': 0.9974879, 'f1': 0.99809074, 'auroc': 0.9999362, 'binary_precision': 0.99907106, 'binary_recall': 0.99530673, 'binary_specificity': 0.99966913, 'binary_f1_score': 0.9971853}
confusion matrix:
       0      1
0  42298     14
1     71  15057
---- Validation: 
scalar performance:
{'acc': 0.96713364, 'precision': 0.7349718, 'recall': 0.7300621, 'specificity': 0.7300621, 'f1': 0.7324882, 'auroc': 0.9461006, 'binary_precision': 0.48726654, 'binary_recall': 0.47674417, 'binary_specificity': 0.98338014, 'binary_f1_score': 0.48194793}
confusion matrix:
       0    1
0  17869  302
1    315  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94502324, 'precision': 0.6206253, 'recall': 0.61054355, 'specificity': 0.61054355, 'f1': 0.6153158, 'auroc': 0.88348925, 'binary_precision': 0.27149323, 'binary_recall': 0.24793388, 'binary_specificity': 0.97315323, 'binary_f1_score': 0.25917926}
confusion matrix:
      0    1
0  5836  161
1   182   60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_22.png
early stop counter: 13
val acc:0.967133641242981, best validation acc: 0.9765620827674866, corresponding to test acc:                         0.9615322947502136 / 0.97531658411026
after epoch: 22,now: 2024-07-01 01:57:03.808088,epoch time: 0:23:14.786601,used: 8:29:31.024077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99784124, 'precision': 0.9983233, 'recall': 0.9961145, 'specificity': 0.9961145, 'f1': 0.9972123, 'auroc': 0.99987197, 'binary_precision': 0.9993345, 'binary_recall': 0.9924653, 'binary_specificity': 0.99976367, 'binary_f1_score': 0.99588805}
confusion matrix:
       0      1
0  42300     10
1    114  15016
---- Validation: 
scalar performance:
{'acc': 0.9803441, 'precision': 0.8709797, 'recall': 0.78266, 'specificity': 0.78266, 'f1': 0.820393, 'auroc': 0.9636019, 'binary_precision': 0.756044, 'binary_recall': 0.5714286, 'binary_specificity': 0.99389136, 'binary_f1_score': 0.65089875}
confusion matrix:
       0    1
0  18060  111
1    258  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.8316555, 'recall': 0.60147154, 'specificity': 0.60147154, 'f1': 0.6504392, 'auroc': 0.918105, 'binary_precision': 0.6944444, 'binary_recall': 0.20661157, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.31847134}
confusion matrix:
      0   1
0  5975  22
1   192  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_23.png
better model found
persisted
after epoch: 23,now: 2024-07-01 02:20:18.292290,epoch time: 0:23:14.484202,used: 8:52:45.508279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9983113, 'precision': 0.9984065, 'recall': 0.9972403, 'specificity': 0.9972403, 'f1': 0.9978215, 'auroc': 0.99983644, 'binary_precision': 0.998607, 'binary_recall': 0.9949769, 'binary_specificity': 0.9995037, 'binary_f1_score': 0.99678856}
confusion matrix:
       0      1
0  42289     21
1     76  15054
---- Validation: 
scalar performance:
{'acc': 0.9776807, 'precision': 0.932464, 'recall': 0.67367566, 'specificity': 0.67367566, 'f1': 0.74459064, 'auroc': 0.9571901, 'binary_precision': 0.886076, 'binary_recall': 0.3488372, 'binary_specificity': 0.9985141, 'binary_f1_score': 0.5005959}
confusion matrix:
       0    1
0  18144   27
1    392  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.9812229, 'recall': 0.5165289, 'specificity': 0.5165289, 'f1': 0.5224318, 'auroc': 0.9419425, 'binary_precision': 1.0, 'binary_recall': 0.03305785, 'binary_specificity': 1.0, 'binary_f1_score': 0.064}
confusion matrix:
      0  1
0  5997  0
1   234  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_24.png
early stop counter: 1
val acc:0.9776806831359863, best validation acc: 0.9803441166877747, corresponding to test acc:                         0.9656996130943298 / 0.97531658411026
after epoch: 24,now: 2024-07-01 02:43:33.086192,epoch time: 0:23:14.793902,used: 9:16:00.302181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9973189, 'precision': 0.9981433, 'recall': 0.9949533, 'specificity': 0.9949533, 'f1': 0.99653435, 'auroc': 0.99986064, 'binary_precision': 0.9998665, 'binary_recall': 0.98995376, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99488544}
confusion matrix:
       0      1
0  42308      2
1    152  14978
---- Validation: 
scalar performance:
{'acc': 0.9760294, 'precision': 0.91961265, 'recall': 0.6495342, 'specificity': 0.6495342, 'f1': 0.71678126, 'auroc': 0.9536168, 'binary_precision': 0.86190474, 'binary_recall': 0.30066445, 'binary_specificity': 0.998404, 'binary_f1_score': 0.44581282}
confusion matrix:
       0    1
0  18142   29
1    421  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.81409025, 'recall': 0.5040488, 'specificity': 0.5040488, 'f1': 0.49831286, 'auroc': 0.91620517, 'binary_precision': 0.6666667, 'binary_recall': 0.008264462, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.01632653}
confusion matrix:
      0  1
0  5996  1
1   240  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_25.png
early stop counter: 2
val acc:0.9760293960571289, best validation acc: 0.9803441166877747, corresponding to test acc:                         0.9656996130943298 / 0.97531658411026
after epoch: 25,now: 2024-07-01 03:06:39.183763,epoch time: 0:23:06.097571,used: 9:39:06.399752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9969359, 'precision': 0.9961984, 'recall': 0.9959033, 'specificity': 0.9959033, 'f1': 0.9960507, 'auroc': 0.9998047, 'binary_precision': 0.9946414, 'binary_recall': 0.99372107, 'binary_specificity': 0.99808556, 'binary_f1_score': 0.994181}
confusion matrix:
       0      1
0  42229     81
1     95  15035
---- Validation: 
scalar performance:
{'acc': 0.9563202, 'precision': 0.62603146, 'recall': 0.603216, 'specificity': 0.603216, 'f1': 0.6132951, 'auroc': 0.9082099, 'binary_precision': 0.27755103, 'binary_recall': 0.22591361, 'binary_specificity': 0.9805184, 'binary_f1_score': 0.24908423}
confusion matrix:
       0    1
0  17817  354
1    466  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94598496, 'precision': 0.53827095, 'recall': 0.51983774, 'specificity': 0.51983774, 'f1': 0.5244455, 'auroc': 0.82425493, 'binary_precision': 0.11382114, 'binary_recall': 0.05785124, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.07671233}
confusion matrix:
      0    1
0  5888  109
1   228   14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_26.png
early stop counter: 3
val acc:0.9563202261924744, best validation acc: 0.9803441166877747, corresponding to test acc:                         0.9656996130943298 / 0.97531658411026
after epoch: 26,now: 2024-07-01 03:29:19.841604,epoch time: 0:22:40.657841,used: 10:01:47.057593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99799794, 'precision': 0.9982792, 'recall': 0.9965603, 'specificity': 0.9965603, 'f1': 0.9974158, 'auroc': 0.99995077, 'binary_precision': 0.99887025, 'binary_recall': 0.99352235, 'binary_specificity': 0.9995982, 'binary_f1_score': 0.9961892}
confusion matrix:
       0      1
0  42294     17
1     98  15031
---- Validation: 
scalar performance:
{'acc': 0.9709157, 'precision': 0.76569355, 'recall': 0.7665469, 'specificity': 0.7665469, 'f1': 0.7661195, 'auroc': 0.95459986, 'binary_precision': 0.54635763, 'binary_recall': 0.5481728, 'binary_specificity': 0.98492104, 'binary_f1_score': 0.54726374}
confusion matrix:
       0    1
0  17897  274
1    272  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.81946933, 'recall': 0.6457588, 'specificity': 0.6457588, 'f1': 0.6972215, 'auroc': 0.96258473, 'binary_precision': 0.6666667, 'binary_recall': 0.29752067, 'binary_specificity': 0.993997, 'binary_f1_score': 0.41142857}
confusion matrix:
      0   1
0  5961  36
1   170  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_27.png
early stop counter: 4
val acc:0.970915675163269, best validation acc: 0.9803441166877747, corresponding to test acc:                         0.9656996130943298 / 0.97531658411026
after epoch: 27,now: 2024-07-01 03:52:06.933998,epoch time: 0:22:47.092394,used: 10:24:34.149987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99735373, 'precision': 0.99801534, 'recall': 0.9951679, 'specificity': 0.9951679, 'f1': 0.99658054, 'auroc': 0.99989474, 'binary_precision': 0.99939984, 'binary_recall': 0.99054855, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.9949545}
confusion matrix:
       0      1
0  42301      9
1    143  14987
---- Validation: 
scalar performance:
{'acc': 0.97997123, 'precision': 0.9047204, 'recall': 0.7358905, 'specificity': 0.7358905, 'f1': 0.79655087, 'auroc': 0.9697027, 'binary_precision': 0.8265896, 'binary_recall': 0.47508305, 'binary_specificity': 0.996698, 'binary_f1_score': 0.6033755}
confusion matrix:
       0    1
0  18111   60
1    316  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.98091424, 'recall': 0.5082645, 'specificity': 0.5082645, 'f1': 0.5065316, 'auroc': 0.9423115, 'binary_precision': 1.0, 'binary_recall': 0.016528925, 'binary_specificity': 1.0, 'binary_f1_score': 0.032520324}
confusion matrix:
      0  1
0  5997  0
1   238  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_28.png
early stop counter: 5
val acc:0.9799712300300598, best validation acc: 0.9803441166877747, corresponding to test acc:                         0.9656996130943298 / 0.97531658411026
after epoch: 28,now: 2024-07-01 04:14:50.498416,epoch time: 0:22:43.564418,used: 10:47:17.714405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9979805, 'precision': 0.9978624, 'recall': 0.99693084, 'specificity': 0.99693084, 'f1': 0.9973954, 'auroc': 0.99991935, 'binary_precision': 0.99761367, 'binary_recall': 0.9947125, 'binary_specificity': 0.99914914, 'binary_f1_score': 0.996161}
confusion matrix:
       0      1
0  42274     36
1     80  15050
---- Validation: 
scalar performance:
{'acc': 0.9808768, 'precision': 0.8496733, 'recall': 0.83673936, 'specificity': 0.83673936, 'f1': 0.8430741, 'auroc': 0.96590304, 'binary_precision': 0.7098446, 'binary_recall': 0.68272424, 'binary_specificity': 0.9907545, 'binary_f1_score': 0.69602036}
confusion matrix:
       0    1
0  18003  168
1    191  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.83654845, 'recall': 0.6015549, 'specificity': 0.6015549, 'f1': 0.6509898, 'auroc': 0.92044926, 'binary_precision': 0.70422536, 'binary_recall': 0.20661157, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.31948882}
confusion matrix:
      0   1
0  5976  21
1   192  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_29.png
better model found
persisted
after epoch: 29,now: 2024-07-01 04:37:17.504963,epoch time: 0:22:27.006547,used: 11:09:44.720952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99735373, 'precision': 0.9981885, 'recall': 0.9949981, 'specificity': 0.9949981, 'f1': 0.9965794, 'auroc': 0.9999243, 'binary_precision': 0.99993324, 'binary_recall': 0.99001986, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9949519}
confusion matrix:
       0      1
0  42309      1
1    151  14979
---- Validation: 
scalar performance:
{'acc': 0.97730786, 'precision': 0.92121434, 'recall': 0.67268, 'specificity': 0.67268, 'f1': 0.74182683, 'auroc': 0.9593849, 'binary_precision': 0.8636364, 'binary_recall': 0.34717607, 'binary_specificity': 0.9981839, 'binary_f1_score': 0.4952607}
confusion matrix:
       0    1
0  18138   33
1    393  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.6810411, 'recall': 0.51164633, 'specificity': 0.51164633, 'f1': 0.5133226, 'auroc': 0.94099057, 'binary_precision': 0.4, 'binary_recall': 0.024793388, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.046692606}
confusion matrix:
      0  1
0  5988  9
1   236  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628982_30.png
early stop counter: 1
val acc:0.9773078560829163, best validation acc: 0.9808768033981323, corresponding to test acc:                         0.9658598899841309 / 0.97531658411026
after epoch: 30,now: 2024-07-01 05:00:12.349637,epoch time: 0:22:54.844674,used: 11:32:39.565626,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_17_27_32_seed_2_21628982
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:32:39.565626 at 2024-07-01 05:00:12.349637
persisted model performance metric: 

scalar performance:
{'acc': 0.9658599, 'precision': 0.83654845, 'recall': 0.6015549, 'specificity': 0.6015549, 'f1': 0.6509898, 'auroc': 0.92044926, 'binary_precision': 0.70422536, 'binary_recall': 0.20661157, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.31948882}
confusion matrix:
      0   1
0  5976  21
1   192  50
oracle model performance metric: 

scalar performance:
{'acc': 0.9753166, 'precision': 0.85842764, 'recall': 0.7809552, 'specificity': 0.7809552, 'f1': 0.8145391, 'auroc': 0.9296997, 'binary_precision': 0.7340425, 'binary_recall': 0.57024795, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.6418604}
confusion matrix:
      0    1
0  5947   50
1   104  138
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 369159 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool | 337306 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |  31853 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 369159 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool | 337306 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |  31853 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362640 KiB |   9125 MiB |   3660 TiB |   3660 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   3612 TiB |   3612 TiB |
|       from small pool |  30850 KiB |     50 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10006 MiB |  10022 MiB |  28584 MiB |  18578 MiB |
|       from large pool |   9950 MiB |   9962 MiB |  28492 MiB |  18542 MiB |
|       from small pool |     56 MiB |     60 MiB |     92 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 386552 KiB |    876 MiB |   2635 TiB |   2635 TiB |
|       from large pool | 377446 KiB |    872 MiB |   2587 TiB |   2587 TiB |
|       from small pool |   9106 KiB |     32 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3305    |    8014    |  663606 K  |  663603 K  |
|       from large pool |     151    |     986    |  339597 K  |  339597 K  |
|       from small pool |    3154    |    7861    |  324009 K  |  324005 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3305    |    8014    |  663606 K  |  663603 K  |
|       from large pool |     151    |     986    |  339597 K  |  339597 K  |
|       from small pool |    3154    |    7861    |  324009 K  |  324005 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     443    |     445    |    1230    |     787    |
|       from large pool |     415    |     415    |    1184    |     769    |
|       from small pool |      28    |      30    |      46    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    3641    |  432667 K  |  432667 K  |
|       from large pool |      35    |     417    |  275898 K  |  275898 K  |
|       from small pool |      39    |    3607    |  156769 K  |  156769 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |      0 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |      0 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   3660 TiB |   3660 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   3612 TiB |   3612 TiB |
|       from small pool |      0 KiB |     50 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  28584 MiB |  27846 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  28492 MiB |  27794 MiB |
|       from small pool |  40960 KiB |     60 MiB |     92 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |   2635 TiB |   2635 TiB |
|       from large pool |  24320 KiB |    872 MiB |   2587 TiB |   2587 TiB |
|       from small pool |      0 KiB |     32 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8014    |  663606 K  |  663606 K  |
|       from large pool |       2    |     986    |  339597 K  |  339597 K  |
|       from small pool |       0    |    7861    |  324009 K  |  324009 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8014    |  663606 K  |  663606 K  |
|       from large pool |       2    |     986    |  339597 K  |  339597 K  |
|       from small pool |       0    |    7861    |  324009 K  |  324009 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |    1230    |    1179    |
|       from large pool |      31    |     415    |    1184    |    1153    |
|       from small pool |      20    |      30    |      46    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3641    |  432668 K  |  432668 K  |
|       from large pool |       3    |     417    |  275898 K  |  275898 K  |
|       from small pool |       0    |    3607    |  156770 K  |  156770 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul  1 05:01:32 2024]
Finished job 0.
1 of 1 steps (100%) done
