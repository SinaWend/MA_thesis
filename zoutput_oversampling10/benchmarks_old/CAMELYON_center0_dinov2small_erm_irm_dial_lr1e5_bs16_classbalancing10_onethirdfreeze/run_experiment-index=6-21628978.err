Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 29 17:38:00 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978

 Experiment start at: 2024-06-29 17:43:46.868012
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98600984, 'precision': 0.98642474, 'recall': 0.97691894, 'specificity': 0.97691894, 'f1': 0.98155, 'auroc': 0.99866605, 'binary_precision': 0.9872558, 'binary_recall': 0.9581379, 'binary_specificity': 0.99569994, 'binary_f1_score': 0.9724789}
confusion matrix:
       0      1
0  42143    182
1    616  14099
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.74305356, 'recall': 0.7394054, 'specificity': 0.7394054, 'f1': 0.74121404, 'auroc': 0.94488657, 'binary_precision': 0.50394946, 'binary_recall': 0.496112, 'binary_specificity': 0.9826988, 'binary_f1_score': 0.5}
confusion matrix:
       0    1
0  17835  314
1    324  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.9773589, 'recall': 0.74112916, 'specificity': 0.74112916, 'f1': 0.8173866, 'auroc': 0.9424087, 'binary_precision': 0.9767442, 'binary_recall': 0.4827586, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.6461538}
confusion matrix:
      0    1
0  5994    3
1   135  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-29 18:06:57.814863,epoch time: 0:23:10.946851,used: 0:23:10.946851,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99158484, 'precision': 0.99417996, 'recall': 0.98389286, 'specificity': 0.98389286, 'f1': 0.98889667, 'auroc': 0.9992608, 'binary_precision': 0.99936867, 'binary_recall': 0.9679984, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.9834334}
confusion matrix:
       0      1
0  42313      9
1    471  14247
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.7240841, 'recall': 0.5358924, 'specificity': 0.5358924, 'f1': 0.55582196, 'auroc': 0.93863106, 'binary_precision': 0.48, 'binary_recall': 0.07465008, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.12920593}
confusion matrix:
       0   1
0  18097  52
1    595  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95286036, 'precision': 0.56623554, 'recall': 0.51365626, 'specificity': 0.51365626, 'f1': 0.5166668, 'auroc': 0.927907, 'binary_precision': 0.17307693, 'binary_recall': 0.03448276, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.057507984}
confusion matrix:
      0   1
0  5954  43
1   252   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_2.png
early stop counter: 1
val acc:0.9655704498291016, best validation acc: 0.9660493731498718, corresponding to test acc:                         0.9779482483863831 / 0.9779482483863831
after epoch: 2,now: 2024-06-29 18:29:41.599080,epoch time: 0:22:43.784217,used: 0:45:54.731068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99347824, 'precision': 0.99300635, 'recall': 0.98993105, 'specificity': 0.98993105, 'f1': 0.99145603, 'auroc': 0.9993027, 'binary_precision': 0.9920412, 'binary_recall': 0.9826028, 'binary_specificity': 0.9972593, 'binary_f1_score': 0.98729944}
confusion matrix:
       0      1
0  42209    116
1    256  14459
---- Validation: 
scalar performance:
{'acc': 0.9684972, 'precision': 0.7780283, 'recall': 0.63866514, 'specificity': 0.63866514, 'f1': 0.68294126, 'auroc': 0.9492501, 'binary_precision': 0.5809524, 'binary_recall': 0.28460342, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.38204592}
confusion matrix:
       0    1
0  18017  132
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.8282572, 'recall': 0.5469756, 'specificity': 0.5469756, 'f1': 0.57406783, 'auroc': 0.9520403, 'binary_precision': 0.6944444, 'binary_recall': 0.09578544, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.16835018}
confusion matrix:
      0   1
0  5986  11
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_3.png
better model found
persisted
after epoch: 3,now: 2024-06-29 18:52:07.824150,epoch time: 0:22:26.225070,used: 1:08:20.956138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9970722, 'precision': 0.99778587, 'recall': 0.9945701, 'specificity': 0.9945701, 'f1': 0.9961643, 'auroc': 0.99970114, 'binary_precision': 0.9992451, 'binary_recall': 0.9894, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.9942982}
confusion matrix:
       0      1
0  42312     11
1    156  14561
---- Validation: 
scalar performance:
{'acc': 0.97035974, 'precision': 0.8159658, 'recall': 0.6373792, 'specificity': 0.6373792, 'f1': 0.68869686, 'auroc': 0.94235015, 'binary_precision': 0.6569343, 'binary_recall': 0.2799378, 'binary_specificity': 0.99482065, 'binary_f1_score': 0.3925845}
confusion matrix:
       0    1
0  18055   94
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.6460935, 'recall': 0.50699586, 'specificity': 0.50699586, 'f1': 0.5038295, 'auroc': 0.94381464, 'binary_precision': 0.33333334, 'binary_recall': 0.01532567, 'binary_specificity': 0.998666, 'binary_f1_score': 0.029304028}
confusion matrix:
      0  1
0  5989  8
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_4.png
better model found
persisted
after epoch: 4,now: 2024-06-29 19:14:30.999076,epoch time: 0:22:23.174926,used: 1:30:44.131064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9852034, 'precision': 0.9901987, 'recall': 0.97135174, 'specificity': 0.97135174, 'f1': 0.980306, 'auroc': 0.999195, 'binary_precision': 0.99992794, 'binary_recall': 0.9427271, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9704853}
confusion matrix:
       0      1
0  42320      1
1    843  13876
---- Validation: 
scalar performance:
{'acc': 0.9702533, 'precision': 0.8901268, 'recall': 0.5848203, 'specificity': 0.5848203, 'f1': 0.6336126, 'auroc': 0.957029, 'binary_precision': 0.8088235, 'binary_recall': 0.1710731, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.28241333}
confusion matrix:
       0    1
0  18123   26
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.9542362, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_5.png
early stop counter: 1
val acc:0.9702532887458801, best validation acc: 0.970359742641449, corresponding to test acc:                         0.9576541781425476 / 0.9779482483863831
after epoch: 5,now: 2024-06-29 19:37:07.539157,epoch time: 0:22:36.540081,used: 1:53:20.671145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9959502, 'precision': 0.9942039, 'recall': 0.99523187, 'specificity': 0.99523187, 'f1': 0.9947165, 'auroc': 0.9997722, 'binary_precision': 0.99058396, 'binary_recall': 0.9937479, 'binary_specificity': 0.9967159, 'binary_f1_score': 0.9921634}
confusion matrix:
       0      1
0  42186    139
1     92  14623
---- Validation: 
scalar performance:
{'acc': 0.9657301, 'precision': 0.74536574, 'recall': 0.86524934, 'specificity': 0.86524934, 'f1': 0.792036, 'auroc': 0.9594748, 'binary_precision': 0.4994872, 'binary_recall': 0.7573872, 'binary_specificity': 0.97311145, 'binary_f1_score': 0.60197777}
confusion matrix:
       0    1
0  17661  488
1    156  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.7801068, 'recall': 0.63934267, 'specificity': 0.63934267, 'f1': 0.68348694, 'auroc': 0.9402224, 'binary_precision': 0.5905512, 'binary_recall': 0.28735632, 'binary_specificity': 0.991329, 'binary_f1_score': 0.38659793}
confusion matrix:
      0   1
0  5945  52
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_6.png
early stop counter: 2
val acc:0.9657300710678101, best validation acc: 0.970359742641449, corresponding to test acc:                         0.9576541781425476 / 0.9779482483863831
after epoch: 6,now: 2024-06-29 20:00:11.793816,epoch time: 0:23:04.254659,used: 2:16:24.925804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9967567, 'precision': 0.99683315, 'recall': 0.9946892, 'specificity': 0.9946892, 'f1': 0.9957551, 'auroc': 0.9997773, 'binary_precision': 0.99699, 'binary_recall': 0.99041796, 'binary_specificity': 0.99896044, 'binary_f1_score': 0.9936932}
confusion matrix:
       0      1
0  42281     44
1    141  14574
---- Validation: 
scalar performance:
{'acc': 0.97115797, 'precision': 0.7833246, 'recall': 0.7705523, 'specificity': 0.7705523, 'f1': 0.77677584, 'auroc': 0.9522985, 'binary_precision': 0.5823817, 'binary_recall': 0.55520993, 'binary_specificity': 0.98589456, 'binary_f1_score': 0.5684713}
confusion matrix:
       0    1
0  17893  256
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.852154, 'recall': 0.7712765, 'specificity': 0.7712765, 'f1': 0.8059101, 'auroc': 0.9256918, 'binary_precision': 0.7236181, 'binary_recall': 0.55172414, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.62608695}
confusion matrix:
      0    1
0  5942   55
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_7.png
better model found
persisted
after epoch: 7,now: 2024-06-29 20:22:42.491982,epoch time: 0:22:30.698166,used: 2:38:55.623970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99509114, 'precision': 0.99666786, 'recall': 0.99053025, 'specificity': 0.99053025, 'f1': 0.9935494, 'auroc': 0.99981487, 'binary_precision': 0.9998615, 'binary_recall': 0.9811077, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99039584}
confusion matrix:
       0      1
0  42323      2
1    278  14437
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.8133201, 'recall': 0.56563425, 'specificity': 0.56563425, 'f1': 0.602934, 'auroc': 0.9445305, 'binary_precision': 0.65648854, 'binary_recall': 0.13374805, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.22222222}
confusion matrix:
       0   1
0  18104  45
1    557  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.5227084, 'recall': 0.50208056, 'specificity': 0.50208056, 'f1': 0.49559686, 'auroc': 0.89822817, 'binary_precision': 0.08695652, 'binary_recall': 0.007662835, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.014084507}
confusion matrix:
      0   1
0  5976  21
1   259   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_8.png
early stop counter: 1
val acc:0.9679650664329529, best validation acc: 0.971157968044281, corresponding to test acc:                         0.9725151658058167 / 0.9779482483863831
after epoch: 8,now: 2024-06-29 20:45:07.828342,epoch time: 0:22:25.336360,used: 3:01:20.960330,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99721247, 'precision': 0.99803805, 'recall': 0.99468637, 'specificity': 0.99468637, 'f1': 0.9963474, 'auroc': 0.99982387, 'binary_precision': 0.99972534, 'binary_recall': 0.98946726, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9945699}
confusion matrix:
       0      1
0  42320      4
1    155  14561
---- Validation: 
scalar performance:
{'acc': 0.97302043, 'precision': 0.91792375, 'recall': 0.6252557, 'specificity': 0.6252557, 'f1': 0.6880484, 'auroc': 0.96696013, 'binary_precision': 0.86170214, 'binary_recall': 0.251944, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.3898917}
confusion matrix:
       0    1
0  18123   26
1    481  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.6460935, 'recall': 0.50699586, 'specificity': 0.50699586, 'f1': 0.5038295, 'auroc': 0.94706726, 'binary_precision': 0.33333334, 'binary_recall': 0.01532567, 'binary_specificity': 0.998666, 'binary_f1_score': 0.029304028}
confusion matrix:
      0  1
0  5989  8
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_9.png
better model found
persisted
after epoch: 9,now: 2024-06-29 21:07:32.930035,epoch time: 0:22:25.101693,used: 3:23:46.062023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99779105, 'precision': 0.99840325, 'recall': 0.99582946, 'specificity': 0.99582946, 'f1': 0.9971076, 'auroc': 0.9998684, 'binary_precision': 0.9996575, 'binary_recall': 0.9917771, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99570173}
confusion matrix:
       0      1
0  42320      5
1    121  14594
---- Validation: 
scalar performance:
{'acc': 0.9635483, 'precision': 0.7277327, 'recall': 0.76136225, 'specificity': 0.76136225, 'f1': 0.74324596, 'auroc': 0.9574789, 'binary_precision': 0.4716981, 'binary_recall': 0.5443235, 'binary_specificity': 0.978401, 'binary_f1_score': 0.50541514}
confusion matrix:
       0    1
0  17757  392
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.75398296, 'recall': 0.7632744, 'specificity': 0.7632744, 'f1': 0.75853336, 'auroc': 0.9546349, 'binary_precision': 0.5276753, 'binary_recall': 0.54789275, 'binary_specificity': 0.978656, 'binary_f1_score': 0.5375941}
confusion matrix:
      0    1
0  5869  128
1   118  143
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_10.png
early stop counter: 1
val acc:0.9635483026504517, best validation acc: 0.9730204343795776, corresponding to test acc:                         0.9576541781425476 / 0.9779482483863831
after epoch: 10,now: 2024-06-29 21:30:02.616710,epoch time: 0:22:29.686675,used: 3:46:15.748698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99777347, 'precision': 0.998369, 'recall': 0.99581796, 'specificity': 0.99581796, 'f1': 0.99708486, 'auroc': 0.999902, 'binary_precision': 0.9995891, 'binary_recall': 0.99177766, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.99566805}
confusion matrix:
       0      1
0  42318      6
1    121  14595
---- Validation: 
scalar performance:
{'acc': 0.9750958, 'precision': 0.90367854, 'recall': 0.66983336, 'specificity': 0.66983336, 'f1': 0.73591053, 'auroc': 0.96675396, 'binary_precision': 0.8301887, 'binary_recall': 0.3421462, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.4845815}
confusion matrix:
       0    1
0  18104   45
1    423  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.94820714, 'recall': 0.5782939, 'specificity': 0.5782939, 'f1': 0.6252951, 'auroc': 0.9414476, 'binary_precision': 0.9318182, 'binary_recall': 0.15708812, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.26885244}
confusion matrix:
      0   1
0  5994   3
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_11.png
better model found
persisted
after epoch: 11,now: 2024-06-29 21:52:44.635106,epoch time: 0:22:42.018396,used: 4:08:57.767094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99617815, 'precision': 0.9972553, 'recall': 0.99277043, 'specificity': 0.99277043, 'f1': 0.9949863, 'auroc': 0.99972445, 'binary_precision': 0.99944884, 'binary_recall': 0.9857298, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9925419}
confusion matrix:
       0      1
0  42316      8
1    210  14506
---- Validation: 
scalar performance:
{'acc': 0.97158366, 'precision': 0.8673601, 'recall': 0.6222617, 'specificity': 0.6222617, 'f1': 0.67935085, 'auroc': 0.963283, 'binary_precision': 0.76076555, 'binary_recall': 0.24727838, 'binary_specificity': 0.997245, 'binary_f1_score': 0.37323946}
confusion matrix:
       0    1
0  18099   50
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8865026, 'recall': 0.5644671, 'specificity': 0.5644671, 'f1': 0.6025903, 'auroc': 0.9376583, 'binary_precision': 0.8095238, 'binary_recall': 0.1302682, 'binary_specificity': 0.998666, 'binary_f1_score': 0.22442244}
confusion matrix:
      0   1
0  5989   8
1   227  34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_12.png
early stop counter: 1
val acc:0.9715836644172668, best validation acc: 0.975095808506012, corresponding to test acc:                         0.9643656015396118 / 0.9779482483863831
after epoch: 12,now: 2024-06-29 22:15:35.628628,epoch time: 0:22:50.993522,used: 4:31:48.760616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9978787, 'precision': 0.9985745, 'recall': 0.99588966, 'specificity': 0.99588966, 'f1': 0.9972226, 'auroc': 0.9998922, 'binary_precision': 1.0, 'binary_recall': 0.9917793, 'binary_specificity': 1.0, 'binary_f1_score': 0.9958727}
confusion matrix:
       0      1
0  42321      0
1    121  14598
---- Validation: 
scalar performance:
{'acc': 0.9728608, 'precision': 0.904258, 'recall': 0.6281733, 'specificity': 0.6281733, 'f1': 0.6902094, 'auroc': 0.96510327, 'binary_precision': 0.8341709, 'binary_recall': 0.25816485, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.3942993}
confusion matrix:
       0    1
0  18116   33
1    477  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.77936995, 'recall': 0.50558037, 'specificity': 0.50558037, 'f1': 0.50066596, 'auroc': 0.91972184, 'binary_precision': 0.6, 'binary_recall': 0.011494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.02255639}
confusion matrix:
      0  1
0  5995  2
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_13.png
early stop counter: 2
val acc:0.9728608131408691, best validation acc: 0.975095808506012, corresponding to test acc:                         0.9643656015396118 / 0.9779482483863831
after epoch: 13,now: 2024-06-29 22:38:06.022708,epoch time: 0:22:30.394080,used: 4:54:19.154696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9981241, 'precision': 0.99853706, 'recall': 0.99656415, 'specificity': 0.99656415, 'f1': 0.9975455, 'auroc': 0.9998553, 'binary_precision': 0.99938476, 'binary_recall': 0.993341, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.99635375}
confusion matrix:
       0      1
0  42314      9
1     98  14619
---- Validation: 
scalar performance:
{'acc': 0.9725415, 'precision': 0.7968746, 'recall': 0.76826835, 'specificity': 0.76826835, 'f1': 0.7817754, 'auroc': 0.96380997, 'binary_precision': 0.60967183, 'binary_recall': 0.5489891, 'binary_specificity': 0.9875475, 'binary_f1_score': 0.57774144}
confusion matrix:
       0    1
0  17923  226
1    290  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.8245251, 'recall': 0.6163561, 'specificity': 0.6163561, 'f1': 0.66676444, 'auroc': 0.93631953, 'binary_precision': 0.6813187, 'binary_recall': 0.23754789, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.35227272}
confusion matrix:
      0   1
0  5968  29
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_14.png
early stop counter: 3
val acc:0.9725415110588074, best validation acc: 0.975095808506012, corresponding to test acc:                         0.9643656015396118 / 0.9779482483863831
after epoch: 14,now: 2024-06-29 23:00:33.213565,epoch time: 0:22:27.190857,used: 5:16:46.345553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9980891, 'precision': 0.99862564, 'recall': 0.9963857, 'specificity': 0.9963857, 'f1': 0.99749905, 'auroc': 0.9998996, 'binary_precision': 0.99972636, 'binary_recall': 0.99286586, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9962843}
confusion matrix:
       0      1
0  42318      4
1    105  14613
---- Validation: 
scalar performance:
{'acc': 0.97126436, 'precision': 0.94183064, 'recall': 0.5883439, 'specificity': 0.5883439, 'f1': 0.64110374, 'auroc': 0.9653778, 'binary_precision': 0.912, 'binary_recall': 0.17729394, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.296875}
confusion matrix:
       0    1
0  18138   11
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.6458833, 'recall': 0.501749, 'specificity': 0.501749, 'f1': 0.49309576, 'auroc': 0.9353558, 'binary_precision': 0.33333334, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5995  2
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_15.png
early stop counter: 4
val acc:0.9712643623352051, best validation acc: 0.975095808506012, corresponding to test acc:                         0.9643656015396118 / 0.9779482483863831
after epoch: 15,now: 2024-06-29 23:23:25.566742,epoch time: 0:22:52.353177,used: 5:39:38.698730,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9978436, 'precision': 0.9968455, 'recall': 0.9975274, 'specificity': 0.9975274, 'f1': 0.9971858, 'auroc': 0.99984455, 'binary_precision': 0.9947786, 'binary_recall': 0.99687415, 'binary_specificity': 0.9981807, 'binary_f1_score': 0.9958253}
confusion matrix:
       0      1
0  42247     77
1     46  14670
---- Validation: 
scalar performance:
{'acc': 0.9731269, 'precision': 0.7897413, 'recall': 0.84282684, 'specificity': 0.84282684, 'f1': 0.813815, 'auroc': 0.96898675, 'binary_precision': 0.59007835, 'binary_recall': 0.7029549, 'binary_specificity': 0.9826988, 'binary_f1_score': 0.6415898}
confusion matrix:
       0    1
0  17835  314
1    191  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.8756958, 'recall': 0.6230203, 'specificity': 0.6230203, 'f1': 0.6801628, 'auroc': 0.95476305, 'binary_precision': 0.78313255, 'binary_recall': 0.24904214, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.37790695}
confusion matrix:
      0   1
0  5979  18
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_16.png
early stop counter: 5
val acc:0.9731268882751465, best validation acc: 0.975095808506012, corresponding to test acc:                         0.9643656015396118 / 0.9779482483863831
after epoch: 16,now: 2024-06-29 23:46:00.096693,epoch time: 0:22:34.529951,used: 6:02:13.228681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9987728, 'precision': 0.99899566, 'recall': 0.9977989, 'specificity': 0.9977989, 'f1': 0.99839544, 'auroc': 0.9999203, 'binary_precision': 0.9994544, 'binary_recall': 0.9957869, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9976173}
confusion matrix:
       0      1
0  42316      8
1     62  14654
---- Validation: 
scalar performance:
{'acc': 0.9756811, 'precision': 0.871241, 'recall': 0.70763916, 'specificity': 0.70763916, 'f1': 0.764567, 'auroc': 0.9609946, 'binary_precision': 0.7627119, 'binary_recall': 0.41990668, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.54162484}
confusion matrix:
       0    1
0  18065   84
1    373  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94614893, 'precision': 0.57486856, 'recall': 0.53580713, 'specificity': 0.53580713, 'f1': 0.54616445, 'auroc': 0.8824574, 'binary_precision': 0.18852459, 'binary_recall': 0.08812261, 'binary_specificity': 0.9834917, 'binary_f1_score': 0.12010443}
confusion matrix:
      0   1
0  5898  99
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_17.png
better model found
persisted
after epoch: 17,now: 2024-06-30 00:08:33.127952,epoch time: 0:22:33.031259,used: 6:24:46.259940,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9982644, 'precision': 0.99834126, 'recall': 0.9971241, 'specificity': 0.9971241, 'f1': 0.99773073, 'auroc': 0.99991405, 'binary_precision': 0.9984995, 'binary_recall': 0.99476796, 'binary_specificity': 0.9994802, 'binary_f1_score': 0.99663025}
confusion matrix:
       0      1
0  42301     22
1     77  14640
---- Validation: 
scalar performance:
{'acc': 0.9732865, 'precision': 0.80888796, 'recall': 0.75290287, 'specificity': 0.75290287, 'f1': 0.7778419, 'auroc': 0.95939636, 'binary_precision': 0.63479924, 'binary_recall': 0.5163297, 'binary_specificity': 0.989476, 'binary_f1_score': 0.56946826}
confusion matrix:
       0    1
0  17958  191
1    311  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550975, 'precision': 0.5208935, 'recall': 0.5019972, 'specificity': 0.5019972, 'f1': 0.49553037, 'auroc': 0.904017, 'binary_precision': 0.083333336, 'binary_recall': 0.007662835, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.014035087}
confusion matrix:
      0   1
0  5975  22
1   259   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_18.png
early stop counter: 1
val acc:0.973286509513855, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9461489319801331 / 0.9779482483863831
after epoch: 18,now: 2024-06-30 00:31:00.308224,epoch time: 0:22:27.180272,used: 6:47:13.440212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9924439, 'precision': 0.98701745, 'recall': 0.99348974, 'specificity': 0.99348974, 'f1': 0.990196, 'auroc': 0.9997618, 'binary_precision': 0.9755578, 'binary_recall': 0.9956498, 'binary_specificity': 0.9913296, 'binary_f1_score': 0.9855014}
confusion matrix:
       0      1
0  41961    367
1     64  14648
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7443, 'recall': 0.6630375, 'specificity': 0.6630375, 'f1': 0.69470674, 'auroc': 0.94294834, 'binary_precision': 0.5117925, 'binary_recall': 0.33748055, 'binary_specificity': 0.9885944, 'binary_f1_score': 0.40674788}
confusion matrix:
       0    1
0  17942  207
1    426  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.95918715, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_19.png
early stop counter: 2
val acc:0.9663154482841492, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9461489319801331 / 0.9779482483863831
after epoch: 19,now: 2024-06-30 00:53:30.787262,epoch time: 0:22:30.479038,used: 7:09:43.919250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9988955, 'precision': 0.99918985, 'recall': 0.997926, 'specificity': 0.997926, 'f1': 0.9985558, 'auroc': 0.9999547, 'binary_precision': 0.9997954, 'binary_recall': 0.9959228, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9978553}
confusion matrix:
       0      1
0  42321      3
1     60  14656
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.73936033, 'recall': 0.7152108, 'specificity': 0.7152108, 'f1': 0.7265705, 'auroc': 0.95229554, 'binary_precision': 0.4982639, 'binary_recall': 0.44634527, 'binary_specificity': 0.98407626, 'binary_f1_score': 0.47087777}
confusion matrix:
       0    1
0  17860  289
1    356  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.54180706, 'recall': 0.50399625, 'specificity': 0.50399625, 'f1': 0.4991209, 'auroc': 0.94523954, 'binary_precision': 0.125, 'binary_recall': 0.011494253, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.021052632}
confusion matrix:
      0   1
0  5976  21
1   258   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_20.png
early stop counter: 3
val acc:0.9656769037246704, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9461489319801331 / 0.9779482483863831
after epoch: 20,now: 2024-06-30 01:15:43.628257,epoch time: 0:22:12.840995,used: 7:31:56.760245,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99786115, 'precision': 0.99851775, 'recall': 0.99589974, 'specificity': 0.99589974, 'f1': 0.9971998, 'auroc': 0.9999275, 'binary_precision': 0.999863, 'binary_recall': 0.99184674, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9958388}
confusion matrix:
       0      1
0  42320      2
1    120  14598
---- Validation: 
scalar performance:
{'acc': 0.9717965, 'precision': 0.9310452, 'recall': 0.5998702, 'specificity': 0.5998702, 'f1': 0.65650374, 'auroc': 0.9669251, 'binary_precision': 0.8896552, 'binary_recall': 0.20062208, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.32741117}
confusion matrix:
       0    1
0  18133   16
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.92081285, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_21.png
early stop counter: 4
val acc:0.9717965126037598, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9461489319801331 / 0.9779482483863831
after epoch: 21,now: 2024-06-30 01:37:48.332816,epoch time: 0:22:04.704559,used: 7:54:01.464804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9971599, 'precision': 0.9980935, 'recall': 0.99449617, 'specificity': 0.99449617, 'f1': 0.99627775, 'auroc': 0.9998677, 'binary_precision': 1.0, 'binary_recall': 0.98899233, 'binary_specificity': 1.0, 'binary_f1_score': 0.9944657}
confusion matrix:
       0      1
0  42323      0
1    162  14555
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.9362476, 'recall': 0.5294388, 'specificity': 0.5294388, 'f1': 0.5472222, 'auroc': 0.97102666, 'binary_precision': 0.9047619, 'binary_recall': 0.05909798, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.110948905}
confusion matrix:
       0   1
0  18145   4
1    605  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.9614756, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_22.png
early stop counter: 5
val acc:0.9675925970077515, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9461489319801331 / 0.9779482483863831
after epoch: 22,now: 2024-06-30 01:59:54.592062,epoch time: 0:22:06.259246,used: 8:16:07.724050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9975456, 'precision': 0.9980361, 'recall': 0.995553, 'specificity': 0.995553, 'f1': 0.99678636, 'auroc': 0.99984103, 'binary_precision': 0.9990412, 'binary_recall': 0.9914367, 'binary_specificity': 0.99966925, 'binary_f1_score': 0.9952245}
confusion matrix:
       0      1
0  42312     14
1    126  14588
---- Validation: 
scalar performance:
{'acc': 0.97333974, 'precision': 0.8716104, 'recall': 0.6569233, 'specificity': 0.6569233, 'f1': 0.7175922, 'auroc': 0.9580603, 'binary_precision': 0.7669173, 'binary_recall': 0.31726283, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.44884488}
confusion matrix:
       0    1
0  18087   62
1    439  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.82817894, 'recall': 0.53006774, 'specificity': 0.53006774, 'f1': 0.5460372, 'auroc': 0.93092525, 'binary_precision': 0.6956522, 'binary_recall': 0.06130268, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.112676054}
confusion matrix:
      0   1
0  5990   7
1   245  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_23.png
early stop counter: 6
val acc:0.9733397364616394, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9461489319801331 / 0.9779482483863831
after epoch: 23,now: 2024-06-30 02:21:48.406630,epoch time: 0:21:53.814568,used: 8:38:01.538618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9984748, 'precision': 0.99879515, 'recall': 0.99722135, 'specificity': 0.99722135, 'f1': 0.998005, 'auroc': 0.99994653, 'binary_precision': 0.9994537, 'binary_recall': 0.9946317, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9970369}
confusion matrix:
       0      1
0  42316      8
1     79  14637
---- Validation: 
scalar performance:
{'acc': 0.97227544, 'precision': 0.825639, 'recall': 0.68112415, 'specificity': 0.68112415, 'f1': 0.73107135, 'auroc': 0.96974427, 'binary_precision': 0.67329544, 'binary_recall': 0.36858475, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.47638193}
confusion matrix:
       0    1
0  18034  115
1    406  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.73017657, 'recall': 0.5256527, 'specificity': 0.5256527, 'f1': 0.53776985, 'auroc': 0.93958676, 'binary_precision': 0.5, 'binary_recall': 0.053639848, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.096885815}
confusion matrix:
      0   1
0  5983  14
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_24.png
early stop counter: 7
val acc:0.97227543592453, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9461489319801331 / 0.9779482483863831
after epoch: 24,now: 2024-06-30 02:43:36.538017,epoch time: 0:21:48.131387,used: 8:59:49.670005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9981943, 'precision': 0.9986962, 'recall': 0.99658954, 'specificity': 0.99658954, 'f1': 0.99763703, 'auroc': 0.99994135, 'binary_precision': 0.9997265, 'binary_recall': 0.99327356, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9964896}
confusion matrix:
       0      1
0  42318      4
1     99  14619
---- Validation: 
scalar performance:
{'acc': 0.9721158, 'precision': 0.8718805, 'recall': 0.63078785, 'specificity': 0.63078785, 'f1': 0.6896242, 'auroc': 0.9679995, 'binary_precision': 0.7692308, 'binary_recall': 0.2643857, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.3935185}
confusion matrix:
       0    1
0  18098   51
1    473  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.75766563, 'recall': 0.5184901, 'specificity': 0.5184901, 'f1': 0.5252596, 'auroc': 0.93068564, 'binary_precision': 0.5555556, 'binary_recall': 0.038314175, 'binary_specificity': 0.998666, 'binary_f1_score': 0.071684584}
confusion matrix:
      0   1
0  5989   8
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_25.png
early stop counter: 8
val acc:0.9721158146858215, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9461489319801331 / 0.9779482483863831
after epoch: 25,now: 2024-06-30 03:05:22.190027,epoch time: 0:21:45.652010,used: 9:21:35.322015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9987553, 'precision': 0.99898386, 'recall': 0.9977647, 'specificity': 0.9977647, 'f1': 0.9983723, 'auroc': 0.99994844, 'binary_precision': 0.99945426, 'binary_recall': 0.99571836, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9975828}
confusion matrix:
       0      1
0  42318      8
1     63  14651
---- Validation: 
scalar performance:
{'acc': 0.9720626, 'precision': 0.88164246, 'recall': 0.6240097, 'specificity': 0.6240097, 'f1': 0.68293726, 'auroc': 0.9664309, 'binary_precision': 0.7892157, 'binary_recall': 0.2503888, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.3801653}
confusion matrix:
       0    1
0  18106   43
1    482  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.9329806, 'recall': 0.5362317, 'specificity': 0.5362317, 'f1': 0.5574037, 'auroc': 0.9497784, 'binary_precision': 0.9047619, 'binary_recall': 0.07279693, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.13475177}
confusion matrix:
      0   1
0  5995   2
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_26.png
early stop counter: 9
val acc:0.9720625877380371, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9461489319801331 / 0.9779482483863831
after epoch: 26,now: 2024-06-30 03:27:15.288908,epoch time: 0:21:53.098881,used: 9:43:28.420896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99796635, 'precision': 0.99861073, 'recall': 0.9960814, 'specificity': 0.9960814, 'f1': 0.9973377, 'auroc': 0.9999161, 'binary_precision': 0.9999315, 'binary_recall': 0.9921864, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9960439}
confusion matrix:
       0      1
0  42321      1
1    115  14603
---- Validation: 
scalar performance:
{'acc': 0.9728608, 'precision': 0.90592885, 'recall': 0.6274232, 'specificity': 0.6274232, 'f1': 0.68948865, 'auroc': 0.96947885, 'binary_precision': 0.83756346, 'binary_recall': 0.25660965, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.39285716}
confusion matrix:
       0    1
0  18117   32
1    478  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7927695, 'recall': 0.5279853, 'specificity': 0.5279853, 'f1': 0.54220724, 'auroc': 0.9266172, 'binary_precision': 0.625, 'binary_recall': 0.057471264, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.10526315}
confusion matrix:
      0   1
0  5988   9
1   246  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_27.png
early stop counter: 10
val acc:0.9728608131408691, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9461489319801331 / 0.9779482483863831
after epoch: 27,now: 2024-06-30 03:49:12.816797,epoch time: 0:21:57.527889,used: 10:05:25.948785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9982644, 'precision': 0.9988332, 'recall': 0.9966363, 'specificity': 0.9966363, 'f1': 0.9977284, 'auroc': 0.999862, 'binary_precision': 1.0, 'binary_recall': 0.9932726, 'binary_specificity': 1.0, 'binary_f1_score': 0.996625}
confusion matrix:
       0      1
0  42324      0
1     99  14617
---- Validation: 
scalar performance:
{'acc': 0.972169, 'precision': 0.9600527, 'recall': 0.59856296, 'specificity': 0.59856296, 'f1': 0.65634453, 'auroc': 0.9781853, 'binary_precision': 0.9477612, 'binary_recall': 0.19751166, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.3268983}
confusion matrix:
       0    1
0  18142    7
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9711516, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_28.png
early stop counter: 11
val acc:0.9721689820289612, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9461489319801331 / 0.9779482483863831
after epoch: 28,now: 2024-06-30 04:11:05.631327,epoch time: 0:21:52.814530,used: 10:27:18.763315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99898314, 'precision': 0.99911505, 'recall': 0.9982289, 'specificity': 0.9982289, 'f1': 0.99867094, 'auroc': 0.99996734, 'binary_precision': 0.9993868, 'binary_recall': 0.99667054, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.99802685}
confusion matrix:
       0      1
0  42314      9
1     49  14668
---- Validation: 
scalar performance:
{'acc': 0.97467005, 'precision': 0.8312252, 'recall': 0.7408682, 'specificity': 0.7408682, 'f1': 0.7782857, 'auroc': 0.95661354, 'binary_precision': 0.6803456, 'binary_recall': 0.48989114, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.5696203}
confusion matrix:
       0    1
0  18001  148
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9541387, 'precision': 0.5261555, 'recall': 0.5033293, 'specificity': 0.5033293, 'f1': 0.49849877, 'auroc': 0.8946002, 'binary_precision': 0.09375, 'binary_recall': 0.011494253, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.020477816}
confusion matrix:
      0   1
0  5968  29
1   258   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_29.png
early stop counter: 12
val acc:0.9746700525283813, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9461489319801331 / 0.9779482483863831
after epoch: 29,now: 2024-06-30 04:33:10.998888,epoch time: 0:22:05.367561,used: 10:49:24.130876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9986676, 'precision': 0.99905896, 'recall': 0.9974623, 'specificity': 0.9974623, 'f1': 0.9982573, 'auroc': 0.99990916, 'binary_precision': 0.99986345, 'binary_recall': 0.9949718, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99741167}
confusion matrix:
       0      1
0  42321      2
1     74  14643
---- Validation: 
scalar performance:
{'acc': 0.977384, 'precision': 0.9353756, 'recall': 0.6920196, 'specificity': 0.6920196, 'f1': 0.7634765, 'auroc': 0.96388733, 'binary_precision': 0.8920863, 'binary_recall': 0.38569206, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.5385451}
confusion matrix:
       0    1
0  18119   30
1    395  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.92404616, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_30.png
better model found
persisted
after epoch: 30,now: 2024-06-30 04:55:02.764684,epoch time: 0:21:51.765796,used: 11:11:15.896672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_43_46_seed_0_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:11:15.896672 at 2024-06-30 04:55:02.764684
persisted model performance metric: 

scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.92404616, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
oracle model performance metric: 

scalar performance:
{'acc': 0.97794825, 'precision': 0.9773589, 'recall': 0.74112916, 'specificity': 0.74112916, 'f1': 0.8173866, 'auroc': 0.9424087, 'binary_precision': 0.9767442, 'binary_recall': 0.4827586, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.6461538}
confusion matrix:
      0    1
0  5994    3
1   135  126
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 419850 KiB |   5411 MiB |   3047 TiB |   3047 TiB |
|       from large pool | 387990 KiB |   5382 MiB |   3011 TiB |   3011 TiB |
|       from small pool |  31859 KiB |     51 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 419850 KiB |   5411 MiB |   3047 TiB |   3047 TiB |
|       from large pool | 387990 KiB |   5382 MiB |   3011 TiB |   3011 TiB |
|       from small pool |  31859 KiB |     51 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 411537 KiB |   5405 MiB |   3043 TiB |   3043 TiB |
|       from large pool | 380686 KiB |   5377 MiB |   3007 TiB |   3007 TiB |
|       from small pool |  30851 KiB |     50 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5948 MiB |   5948 MiB |   5948 MiB |      0 B   |
|       from large pool |   5890 MiB |   5890 MiB |   5890 MiB |      0 B   |
|       from small pool |     58 MiB |     58 MiB |     58 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 247798 KiB | 578757 KiB |   1916 TiB |   1916 TiB |
|       from large pool | 238697 KiB | 570940 KiB |   1880 TiB |   1880 TiB |
|       from small pool |   9100 KiB |  10672 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3317    |    7944    |  454849 K  |  454846 K  |
|       from large pool |     151    |     615    |  283211 K  |  283211 K  |
|       from small pool |    3166    |    7792    |  171638 K  |  171634 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3317    |    7944    |  454849 K  |  454846 K  |
|       from large pool |     151    |     615    |  283211 K  |  283211 K  |
|       from small pool |    3166    |    7792    |  171638 K  |  171634 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     275    |     275    |     275    |       0    |
|       from large pool |     246    |     246    |     246    |       0    |
|       from small pool |      29    |      29    |      29    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |    3602    |  257185 K  |  257184 K  |
|       from large pool |      25    |     244    |  181317 K  |  181317 K  |
|       from small pool |      31    |    3577    |   75867 K  |   75867 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   5411 MiB |   3047 TiB |   3047 TiB |
|       from large pool |  65536 KiB |   5382 MiB |   3011 TiB |   3011 TiB |
|       from small pool |      0 KiB |     51 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   5411 MiB |   3047 TiB |   3047 TiB |
|       from large pool |  65536 KiB |   5382 MiB |   3011 TiB |   3011 TiB |
|       from small pool |      0 KiB |     51 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   5405 MiB |   3043 TiB |   3043 TiB |
|       from large pool |  65536 KiB |   5377 MiB |   3007 TiB |   3007 TiB |
|       from small pool |      0 KiB |     50 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 667648 KiB |   5948 MiB |   5948 MiB |   5296 MiB |
|       from large pool | 626688 KiB |   5890 MiB |   5890 MiB |   5278 MiB |
|       from small pool |  40960 KiB |     58 MiB |     58 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 578757 KiB |   1916 TiB |   1916 TiB |
|       from large pool |      0 B   | 570940 KiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 B   |  24437 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7944    |  454849 K  |  454849 K  |
|       from large pool |       2    |     615    |  283211 K  |  283211 K  |
|       from small pool |       0    |    7792    |  171638 K  |  171638 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7944    |  454849 K  |  454849 K  |
|       from large pool |       2    |     615    |  283211 K  |  283211 K  |
|       from small pool |       0    |    7792    |  171638 K  |  171638 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      48    |     275    |     275    |     227    |
|       from large pool |      28    |     246    |     246    |     218    |
|       from small pool |      20    |      29    |      29    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3602    |  257186 K  |  257186 K  |
|       from large pool |       0    |     244    |  181317 K  |  181317 K  |
|       from small pool |       0    |    3577    |   75869 K  |   75869 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   5411 MiB |   3047 TiB |   3047 TiB |
|       from large pool |  65536 KiB |   5382 MiB |   3011 TiB |   3011 TiB |
|       from small pool |      0 KiB |     51 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   5411 MiB |   3047 TiB |   3047 TiB |
|       from large pool |  65536 KiB |   5382 MiB |   3011 TiB |   3011 TiB |
|       from small pool |      0 KiB |     51 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   5405 MiB |   3043 TiB |   3043 TiB |
|       from large pool |  65536 KiB |   5377 MiB |   3007 TiB |   3007 TiB |
|       from small pool |      0 KiB |     50 MiB |     35 TiB |     35 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 667648 KiB |   5948 MiB |   5948 MiB |   5296 MiB |
|       from large pool | 626688 KiB |   5890 MiB |   5890 MiB |   5278 MiB |
|       from small pool |  40960 KiB |     58 MiB |     58 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 578757 KiB |   1916 TiB |   1916 TiB |
|       from large pool |      0 B   | 570940 KiB |   1880 TiB |   1880 TiB |
|       from small pool |      0 B   |  24437 KiB |     36 TiB |     36 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7944    |  454849 K  |  454849 K  |
|       from large pool |       2    |     615    |  283211 K  |  283211 K  |
|       from small pool |       0    |    7792    |  171638 K  |  171638 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7944    |  454849 K  |  454849 K  |
|       from large pool |       2    |     615    |  283211 K  |  283211 K  |
|       from small pool |       0    |    7792    |  171638 K  |  171638 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      48    |     275    |     275    |     227    |
|       from large pool |      28    |     246    |     246    |     218    |
|       from small pool |      20    |      29    |      29    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3602    |  257186 K  |  257186 K  |
|       from large pool |       0    |     244    |  181317 K  |  181317 K  |
|       from small pool |       0    |    3577    |   75869 K  |   75869 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978

 Experiment start at: 2024-06-30 05:01:17.203640
before training, model accuracy: 0.6475991010665894
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9931025, 'precision': 0.9901046, 'recall': 0.99171615, 'specificity': 0.99171615, 'f1': 0.99090695, 'auroc': 0.999306, 'binary_precision': 0.98398787, 'binary_recall': 0.988902, 'binary_specificity': 0.99453026, 'binary_f1_score': 0.98643875}
confusion matrix:
       0      1
0  42183    232
1    160  14257
---- Validation: 
scalar performance:
{'acc': 0.9614194, 'precision': 0.73380446, 'recall': 0.8648331, 'specificity': 0.8648331, 'f1': 0.78295714, 'auroc': 0.9503573, 'binary_precision': 0.47672254, 'binary_recall': 0.76077265, 'binary_specificity': 0.9688936, 'binary_f1_score': 0.58614767}
confusion matrix:
       0    1
0  17505  562
1    161  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9545601, 'precision': 0.7322171, 'recall': 0.8714644, 'specificity': 0.8714644, 'f1': 0.7830315, 'auroc': 0.93618464, 'binary_precision': 0.47429907, 'binary_recall': 0.7807692, 'binary_specificity': 0.96215945, 'binary_f1_score': 0.59011626}
confusion matrix:
      0    1
0  5721  225
1    57  203
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-30 05:23:20.502239,epoch time: 0:22:03.298599,used: 0:22:03.298599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9908502, 'precision': 0.9938949, 'recall': 0.98201406, 'specificity': 0.98201406, 'f1': 0.98777336, 'auroc': 0.99940073, 'binary_precision': 0.9998562, 'binary_recall': 0.9640752, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9816398}
confusion matrix:
       0      1
0  42411      2
1    518  13901
---- Validation: 
scalar performance:
{'acc': 0.9738527, 'precision': 0.8495338, 'recall': 0.71964467, 'specificity': 0.71964467, 'f1': 0.76849675, 'auroc': 0.9592024, 'binary_precision': 0.7194245, 'binary_recall': 0.44576523, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.5504587}
confusion matrix:
       0    1
0  17950  117
1    373  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671286, 'precision': 0.95246863, 'recall': 0.6150483, 'specificity': 0.6150483, 'f1': 0.6767471, 'auroc': 0.95120287, 'binary_precision': 0.9375, 'binary_recall': 0.23076923, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.37037036}
confusion matrix:
      0   1
0  5942   4
1   200  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-30 05:44:57.473609,epoch time: 0:21:36.971370,used: 0:43:40.269969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99398226, 'precision': 0.9901233, 'recall': 0.9940914, 'specificity': 0.9940914, 'f1': 0.9920865, 'auroc': 0.9997091, 'binary_precision': 0.9821881, 'binary_recall': 0.99431306, 'binary_specificity': 0.9938698, 'binary_f1_score': 0.98821336}
confusion matrix:
       0      1
0  42153    260
1     82  14337
---- Validation: 
scalar performance:
{'acc': 0.9343116, 'precision': 0.664191, 'recall': 0.8886835, 'specificity': 0.8886835, 'f1': 0.7217793, 'auroc': 0.9503662, 'binary_precision': 0.33471563, 'binary_recall': 0.8395245, 'binary_specificity': 0.9378425, 'binary_f1_score': 0.47861078}
confusion matrix:
       0     1
0  16944  1123
1    108   565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9313567, 'precision': 0.6617062, 'recall': 0.80602473, 'specificity': 0.80602473, 'f1': 0.7065041, 'auroc': 0.9008707, 'binary_precision': 0.3385214, 'binary_recall': 0.66923076, 'binary_specificity': 0.9428187, 'binary_f1_score': 0.44961238}
confusion matrix:
      0    1
0  5606  340
1    86  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_3.png
early stop counter: 1
val acc:0.9343116283416748, best validation acc: 0.9738526940345764, corresponding to test acc:                         0.967128574848175 / 0.967128574848175
after epoch: 3,now: 2024-06-30 06:07:01.423780,epoch time: 0:22:03.950171,used: 1:05:44.220140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9935072, 'precision': 0.9955189, 'recall': 0.9873655, 'specificity': 0.9873655, 'f1': 0.99135685, 'auroc': 0.9994551, 'binary_precision': 0.9995023, 'binary_recall': 0.97489595, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.9870458}
confusion matrix:
       0      1
0  42405      7
1    362  14058
---- Validation: 
scalar performance:
{'acc': 0.9694237, 'precision': 0.7923738, 'recall': 0.7073339, 'specificity': 0.7073339, 'f1': 0.7418967, 'auroc': 0.9492752, 'binary_precision': 0.6059322, 'binary_recall': 0.42496285, 'binary_specificity': 0.98970497, 'binary_f1_score': 0.4995633}
confusion matrix:
       0    1
0  17881  186
1    387  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.84961426, 'recall': 0.5530053, 'specificity': 0.5530053, 'f1': 0.58397126, 'auroc': 0.9378621, 'binary_precision': 0.7368421, 'binary_recall': 0.10769231, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.18791947}
confusion matrix:
      0   1
0  5936  10
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_4.png
early stop counter: 2
val acc:0.9694237112998962, best validation acc: 0.9738526940345764, corresponding to test acc:                         0.967128574848175 / 0.967128574848175
after epoch: 4,now: 2024-06-30 06:28:58.356914,epoch time: 0:21:56.933134,used: 1:27:41.153274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9950028, 'precision': 0.9966742, 'recall': 0.9901526, 'specificity': 0.9901526, 'f1': 0.99335885, 'auroc': 0.99974513, 'binary_precision': 1.0, 'binary_recall': 0.98030514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9900546}
confusion matrix:
       0      1
0  42412      0
1    284  14136
---- Validation: 
scalar performance:
{'acc': 0.97363925, 'precision': 0.88318396, 'recall': 0.679479, 'specificity': 0.679479, 'f1': 0.741705, 'auroc': 0.9633312, 'binary_precision': 0.789644, 'binary_recall': 0.3625557, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.49694496}
confusion matrix:
       0    1
0  18002   65
1    429  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.56250674, 'recall': 0.50300527, 'specificity': 0.50300527, 'f1': 0.49631503, 'auroc': 0.94414234, 'binary_precision': 0.16666667, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.014705882}
confusion matrix:
      0   1
0  5936  10
1   258   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_5.png
early stop counter: 3
val acc:0.9736392498016357, best validation acc: 0.9738526940345764, corresponding to test acc:                         0.967128574848175 / 0.967128574848175
after epoch: 5,now: 2024-06-30 06:50:51.679202,epoch time: 0:21:53.322288,used: 1:49:34.475562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99737823, 'precision': 0.9980862, 'recall': 0.99499375, 'specificity': 0.99499375, 'f1': 0.99652773, 'auroc': 0.9998481, 'binary_precision': 0.99951, 'binary_recall': 0.99015254, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.99480927}
confusion matrix:
       0      1
0  42405      7
1    142  14278
---- Validation: 
scalar performance:
{'acc': 0.9745998, 'precision': 0.8264216, 'recall': 0.78512144, 'specificity': 0.78512144, 'f1': 0.8042402, 'auroc': 0.96358645, 'binary_precision': 0.6683761, 'binary_recall': 0.58098066, 'binary_specificity': 0.98926216, 'binary_f1_score': 0.6216216}
confusion matrix:
       0    1
0  17873  194
1    282  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.87818325, 'recall': 0.55133444, 'specificity': 0.55133444, 'f1': 0.58193415, 'auroc': 0.95539147, 'binary_precision': 0.7941176, 'binary_recall': 0.103846155, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.18367349}
confusion matrix:
      0   1
0  5939   7
1   233  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_6.png
better model found
persisted
after epoch: 6,now: 2024-06-30 07:12:43.024446,epoch time: 0:21:51.345244,used: 2:11:25.820806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99656886, 'precision': 0.9976647, 'recall': 0.99328387, 'specificity': 0.99328387, 'f1': 0.9954497, 'auroc': 0.99982786, 'binary_precision': 0.99985945, 'binary_recall': 0.9866149, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9931931}
confusion matrix:
       0      1
0  42411      2
1    193  14226
---- Validation: 
scalar performance:
{'acc': 0.9741729, 'precision': 0.845557, 'recall': 0.7334008, 'specificity': 0.7334008, 'f1': 0.7776577, 'auroc': 0.9631026, 'binary_precision': 0.7104677, 'binary_recall': 0.47399703, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.5686275}
confusion matrix:
       0    1
0  17937  130
1    354  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.6942145, 'recall': 0.5217315, 'specificity': 0.5217315, 'f1': 0.5307792, 'auroc': 0.9317343, 'binary_precision': 0.42857143, 'binary_recall': 0.046153847, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.083333336}
confusion matrix:
      0   1
0  5930  16
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_7.png
early stop counter: 1
val acc:0.9741728901863098, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9613277316093445 / 0.967128574848175
after epoch: 7,now: 2024-06-30 07:34:33.128513,epoch time: 0:21:50.104067,used: 2:33:15.924873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9959882, 'precision': 0.9970907, 'recall': 0.9923226, 'specificity': 0.9923226, 'f1': 0.9946775, 'auroc': 0.999753, 'binary_precision': 0.9992963, 'binary_recall': 0.98488104, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.9920363}
confusion matrix:
       0      1
0  42403     10
1    218  14201
---- Validation: 
scalar performance:
{'acc': 0.9708645, 'precision': 0.8827896, 'recall': 0.62654066, 'specificity': 0.62654066, 'f1': 0.6857974, 'auroc': 0.96021664, 'binary_precision': 0.79262674, 'binary_recall': 0.25557205, 'binary_specificity': 0.9975093, 'binary_f1_score': 0.38651684}
confusion matrix:
       0    1
0  18022   45
1    501  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9080843, 'recall': 0.51145434, 'specificity': 0.51145434, 'f1': 0.5119738, 'auroc': 0.9569117, 'binary_precision': 0.85714287, 'binary_recall': 0.023076924, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.04494382}
confusion matrix:
      0  1
0  5945  1
1   254  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_8.png
early stop counter: 2
val acc:0.970864474773407, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9613277316093445 / 0.967128574848175
after epoch: 8,now: 2024-06-30 07:56:22.788296,epoch time: 0:21:49.659783,used: 2:55:05.584656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99653363, 'precision': 0.9976177, 'recall': 0.99323785, 'specificity': 0.99323785, 'f1': 0.9954032, 'auroc': 0.9998038, 'binary_precision': 0.9997892, 'binary_recall': 0.98654646, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9931237}
confusion matrix:
       0      1
0  42409      3
1    194  14226
---- Validation: 
scalar performance:
{'acc': 0.97065103, 'precision': 0.87439126, 'recall': 0.62714523, 'specificity': 0.62714523, 'f1': 0.6855634, 'auroc': 0.95684856, 'binary_precision': 0.77578473, 'binary_recall': 0.25705793, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.3861607}
confusion matrix:
       0    1
0  18017   50
1    500  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.89610213, 'recall': 0.50953126, 'specificity': 0.50953126, 'f1': 0.5082585, 'auroc': 0.94373775, 'binary_precision': 0.8333333, 'binary_recall': 0.01923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.037593987}
confusion matrix:
      0  1
0  5945  1
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_9.png
early stop counter: 3
val acc:0.9706510305404663, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9613277316093445 / 0.967128574848175
after epoch: 9,now: 2024-06-30 08:18:14.284367,epoch time: 0:21:51.496071,used: 3:16:57.080727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9975894, 'precision': 0.997995, 'recall': 0.99563813, 'specificity': 0.99563813, 'f1': 0.9968095, 'auroc': 0.9999274, 'binary_precision': 0.99881244, 'binary_recall': 0.99167705, 'binary_specificity': 0.9995992, 'binary_f1_score': 0.995232}
confusion matrix:
       0      1
0  42397     17
1    120  14298
---- Validation: 
scalar performance:
{'acc': 0.9726788, 'precision': 0.83968645, 'recall': 0.70544577, 'specificity': 0.70544577, 'f1': 0.7546069, 'auroc': 0.9588537, 'binary_precision': 0.70074815, 'binary_recall': 0.41753343, 'binary_specificity': 0.9933581, 'binary_f1_score': 0.5232774}
confusion matrix:
       0    1
0  17947  120
1    392  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9498872, 'precision': 0.63456476, 'recall': 0.5692709, 'specificity': 0.5692709, 'f1': 0.5893661, 'auroc': 0.8956797, 'binary_precision': 0.3053435, 'binary_recall': 0.15384616, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.20460358}
confusion matrix:
      0   1
0  5855  91
1   220  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_10.png
early stop counter: 4
val acc:0.9726787805557251, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9613277316093445 / 0.967128574848175
after epoch: 10,now: 2024-06-30 08:40:00.020487,epoch time: 0:21:45.736120,used: 3:38:42.816847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9975366, 'precision': 0.99809885, 'recall': 0.99539673, 'specificity': 0.99539673, 'f1': 0.99673843, 'auroc': 0.9998188, 'binary_precision': 0.99923074, 'binary_recall': 0.99105287, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.995125}
confusion matrix:
       0      1
0  42403     11
1    129  14289
---- Validation: 
scalar performance:
{'acc': 0.97636074, 'precision': 0.8384304, 'recall': 0.80391634, 'specificity': 0.80391634, 'f1': 0.8201566, 'auroc': 0.9697819, 'binary_precision': 0.6910299, 'binary_recall': 0.61812776, 'binary_specificity': 0.98970497, 'binary_f1_score': 0.652549}
confusion matrix:
       0    1
0  17881  186
1    257  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94602, 'precision': 0.62923044, 'recall': 0.5911596, 'specificity': 0.5911596, 'f1': 0.60618925, 'auroc': 0.9331418, 'binary_precision': 0.29281768, 'binary_recall': 0.20384616, 'binary_specificity': 0.97847295, 'binary_f1_score': 0.24036282}
confusion matrix:
      0    1
0  5818  128
1   207   53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_11.png
better model found
persisted
after epoch: 11,now: 2024-06-30 09:01:39.852971,epoch time: 0:21:39.832484,used: 4:00:22.649331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99644566, 'precision': 0.9951279, 'recall': 0.9954903, 'specificity': 0.9954903, 'f1': 0.9953089, 'auroc': 0.99982536, 'binary_precision': 0.9924494, 'binary_recall': 0.9935506, 'binary_specificity': 0.99742997, 'binary_f1_score': 0.9929997}
confusion matrix:
       0      1
0  42303    109
1     93  14327
---- Validation: 
scalar performance:
{'acc': 0.9543223, 'precision': 0.70258653, 'recall': 0.8246737, 'specificity': 0.8246737, 'f1': 0.7472919, 'auroc': 0.95510066, 'binary_precision': 0.41719458, 'binary_recall': 0.68499255, 'binary_specificity': 0.9643549, 'binary_f1_score': 0.5185602}
confusion matrix:
       0    1
0  17423  644
1    212  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9226555, 'precision': 0.6151822, 'recall': 0.6929836, 'specificity': 0.6929836, 'f1': 0.64146256, 'auroc': 0.9153611, 'binary_precision': 0.25555557, 'binary_recall': 0.44230768, 'binary_specificity': 0.9436596, 'binary_f1_score': 0.32394367}
confusion matrix:
      0    1
0  5611  335
1   145  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_12.png
early stop counter: 1
val acc:0.9543222784996033, best validation acc: 0.9763607382774353, corresponding to test acc:                         0.9460200071334839 / 0.967128574848175
after epoch: 12,now: 2024-06-30 09:23:17.236020,epoch time: 0:21:37.383049,used: 4:22:00.032380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99440455, 'precision': 0.9906764, 'recall': 0.99464905, 'specificity': 0.99464905, 'f1': 0.9926419, 'auroc': 0.9998101, 'binary_precision': 0.98301023, 'binary_recall': 0.9951453, 'binary_specificity': 0.9941527, 'binary_f1_score': 0.98904055}
confusion matrix:
       0      1
0  42165    248
1     70  14349
---- Validation: 
scalar performance:
{'acc': 0.9751334, 'precision': 0.8593507, 'recall': 0.73532945, 'specificity': 0.73532945, 'f1': 0.78330517, 'auroc': 0.96336925, 'binary_precision': 0.737931, 'binary_recall': 0.4769688, 'binary_specificity': 0.99369013, 'binary_f1_score': 0.5794224}
confusion matrix:
       0    1
0  17953  114
1    352  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.73227125, 'recall': 0.5790764, 'specificity': 0.5790764, 'f1': 0.6135034, 'auroc': 0.94960463, 'binary_precision': 0.5, 'binary_recall': 0.16538462, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.24855492}
confusion matrix:
      0   1
0  5903  43
1   217  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_13.png
early stop counter: 2
val acc:0.9751334190368652, best validation acc: 0.9763607382774353, corresponding to test acc:                         0.9460200071334839 / 0.967128574848175
after epoch: 13,now: 2024-06-30 09:45:09.286202,epoch time: 0:21:52.050182,used: 4:43:52.082562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9979589, 'precision': 0.9979662, 'recall': 0.99664146, 'specificity': 0.99664146, 'f1': 0.9973016, 'auroc': 0.999908, 'binary_precision': 0.9979808, 'binary_recall': 0.9939667, 'binary_specificity': 0.9993162, 'binary_f1_score': 0.9959697}
confusion matrix:
       0      1
0  42383     29
1     87  14333
---- Validation: 
scalar performance:
{'acc': 0.97545356, 'precision': 0.8496572, 'recall': 0.7576688, 'specificity': 0.7576688, 'f1': 0.7960722, 'auroc': 0.9651396, 'binary_precision': 0.7169043, 'binary_recall': 0.5230312, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.604811}
confusion matrix:
       0    1
0  17928  139
1    321  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.59483445, 'recall': 0.50985664, 'specificity': 0.50985664, 'f1': 0.509681, 'auroc': 0.962149, 'binary_precision': 0.23076923, 'binary_recall': 0.023076924, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.04195804}
confusion matrix:
      0   1
0  5926  20
1   254   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_14.png
early stop counter: 3
val acc:0.9754535555839539, best validation acc: 0.9763607382774353, corresponding to test acc:                         0.9460200071334839 / 0.967128574848175
after epoch: 14,now: 2024-06-30 10:07:57.863005,epoch time: 0:22:48.576803,used: 5:06:40.659365,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99468607, 'precision': 0.9906635, 'recall': 0.99543273, 'specificity': 0.99543273, 'f1': 0.99301815, 'auroc': 0.9998286, 'binary_precision': 0.98236984, 'binary_recall': 0.99694866, 'binary_specificity': 0.9939168, 'binary_f1_score': 0.9896056}
confusion matrix:
       0      1
0  42154    258
1     44  14376
---- Validation: 
scalar performance:
{'acc': 0.975667, 'precision': 0.8646898, 'recall': 0.73989785, 'specificity': 0.73989785, 'f1': 0.78832567, 'auroc': 0.9489041, 'binary_precision': 0.74828374, 'binary_recall': 0.4858841, 'binary_specificity': 0.99391156, 'binary_f1_score': 0.58918923}
confusion matrix:
       0    1
0  17957  110
1    346  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.5542273, 'recall': 0.5043397, 'specificity': 0.5043397, 'f1': 0.49942183, 'auroc': 0.93115944, 'binary_precision': 0.15, 'binary_recall': 0.011538462, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.021428572}
confusion matrix:
      0   1
0  5929  17
1   257   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_15.png
early stop counter: 4
val acc:0.9756669998168945, best validation acc: 0.9763607382774353, corresponding to test acc:                         0.9460200071334839 / 0.967128574848175
after epoch: 15,now: 2024-06-30 10:30:19.073946,epoch time: 0:22:21.210941,used: 5:29:01.870306,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99815243, 'precision': 0.99867237, 'recall': 0.99645054, 'specificity': 0.99645054, 'f1': 0.99755514, 'auroc': 0.99994135, 'binary_precision': 0.9997207, 'binary_recall': 0.9929954, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9963467}
confusion matrix:
       0      1
0  42409      4
1    101  14318
---- Validation: 
scalar performance:
{'acc': 0.9747599, 'precision': 0.9347872, 'recall': 0.6679006, 'specificity': 0.6679006, 'f1': 0.7384059, 'auroc': 0.9690372, 'binary_precision': 0.8937008, 'binary_recall': 0.33729568, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.48975185}
confusion matrix:
       0    1
0  18040   27
1    446  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.97974825, 'recall': 0.5173077, 'specificity': 0.5173077, 'f1': 0.5231221, 'auroc': 0.9484104, 'binary_precision': 1.0, 'binary_recall': 0.034615386, 'binary_specificity': 1.0, 'binary_f1_score': 0.0669145}
confusion matrix:
      0  1
0  5946  0
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_16.png
early stop counter: 5
val acc:0.9747598767280579, best validation acc: 0.9763607382774353, corresponding to test acc:                         0.9460200071334839 / 0.967128574848175
after epoch: 16,now: 2024-06-30 10:52:50.195255,epoch time: 0:22:31.121309,used: 5:51:32.991615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9983284, 'precision': 0.9987204, 'recall': 0.996866, 'specificity': 0.996866, 'f1': 0.9977888, 'auroc': 0.99990773, 'binary_precision': 0.9995118, 'binary_recall': 0.99389696, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.9966965}
confusion matrix:
       0      1
0  42406      7
1     88  14331
---- Validation: 
scalar performance:
{'acc': 0.9770544, 'precision': 0.8423449, 'recall': 0.81285936, 'specificity': 0.81285936, 'f1': 0.82687473, 'auroc': 0.97006226, 'binary_precision': 0.69820553, 'binary_recall': 0.6359584, 'binary_specificity': 0.98976034, 'binary_f1_score': 0.66562986}
confusion matrix:
       0    1
0  17882  185
1    245  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.82090884, 'recall': 0.62799424, 'specificity': 0.62799424, 'f1': 0.6790303, 'auroc': 0.9512714, 'binary_precision': 0.6732673, 'binary_recall': 0.26153848, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.37673134}
confusion matrix:
      0   1
0  5913  33
1   192  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_17.png
better model found
persisted
after epoch: 17,now: 2024-06-30 11:14:43.887532,epoch time: 0:21:53.692277,used: 6:13:26.683892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9979061, 'precision': 0.99767876, 'recall': 0.996789, 'specificity': 0.996789, 'f1': 0.99723285, 'auroc': 0.9999037, 'binary_precision': 0.9972184, 'binary_recall': 0.99452114, 'binary_specificity': 0.9990569, 'binary_f1_score': 0.99586797}
confusion matrix:
       0      1
0  42373     40
1     79  14340
---- Validation: 
scalar performance:
{'acc': 0.97636074, 'precision': 0.86654794, 'recall': 0.7524171, 'specificity': 0.7524171, 'f1': 0.79806185, 'auroc': 0.96288884, 'binary_precision': 0.7510917, 'binary_recall': 0.5111441, 'binary_specificity': 0.99369013, 'binary_f1_score': 0.6083112}
confusion matrix:
       0    1
0  17953  114
1    329  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.6657013, 'recall': 0.52315, 'specificity': 0.52315, 'f1': 0.5329677, 'auroc': 0.9497183, 'binary_precision': 0.37142858, 'binary_recall': 0.05, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.08813559}
confusion matrix:
      0   1
0  5924  22
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_18.png
early stop counter: 1
val acc:0.9763607382774353, best validation acc: 0.9770544171333313, corresponding to test acc:                         0.9637447595596313 / 0.967128574848175
after epoch: 18,now: 2024-06-30 11:36:30.730890,epoch time: 0:21:46.843358,used: 6:35:13.527250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9983636, 'precision': 0.998906, 'recall': 0.9967751, 'specificity': 0.9967751, 'f1': 0.9978348, 'auroc': 0.999921, 'binary_precision': 1.0, 'binary_recall': 0.9935502, 'binary_specificity': 1.0, 'binary_f1_score': 0.99676466}
confusion matrix:
       0      1
0  42413      0
1     93  14326
---- Validation: 
scalar performance:
{'acc': 0.9754002, 'precision': 0.88669443, 'recall': 0.7104335, 'specificity': 0.7104335, 'f1': 0.7705393, 'auroc': 0.95444864, 'binary_precision': 0.79444444, 'binary_recall': 0.42496285, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.55372703}
confusion matrix:
       0    1
0  17993   74
1    387  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.479039, 'recall': 0.49966365, 'specificity': 0.49966365, 'f1': 0.489134, 'auroc': 0.909823, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5942  4
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_19.png
early stop counter: 2
val acc:0.9754002094268799, best validation acc: 0.9770544171333313, corresponding to test acc:                         0.9637447595596313 / 0.967128574848175
after epoch: 19,now: 2024-06-30 11:58:39.100795,epoch time: 0:22:08.369905,used: 6:57:21.897155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9985923, 'precision': 0.9988508, 'recall': 0.99743205, 'specificity': 0.99743205, 'f1': 0.99813884, 'auroc': 0.9999168, 'binary_precision': 0.9993732, 'binary_recall': 0.9950763, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.99722016}
confusion matrix:
       0      1
0  42403      9
1     71  14349
---- Validation: 
scalar performance:
{'acc': 0.97321236, 'precision': 0.93772316, 'recall': 0.6420637, 'specificity': 0.6420637, 'f1': 0.7098452, 'auroc': 0.93681586, 'binary_precision': 0.90140843, 'binary_recall': 0.28528973, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.43340856}
confusion matrix:
       0    1
0  18046   21
1    481  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7293482, 'recall': 0.507356, 'specificity': 0.507356, 'f1': 0.5042205, 'auroc': 0.87343806, 'binary_precision': 0.5, 'binary_recall': 0.015384615, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.029850746}
confusion matrix:
      0  1
0  5942  4
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_20.png
early stop counter: 3
val acc:0.9732123613357544, best validation acc: 0.9770544171333313, corresponding to test acc:                         0.9637447595596313 / 0.967128574848175
after epoch: 20,now: 2024-06-30 12:22:20.046748,epoch time: 0:23:40.945953,used: 7:21:02.843108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99857473, 'precision': 0.9990469, 'recall': 0.997191, 'specificity': 0.997191, 'f1': 0.9981146, 'auroc': 0.9999318, 'binary_precision': 1.0, 'binary_recall': 0.994382, 'binary_specificity': 1.0, 'binary_f1_score': 0.9971831}
confusion matrix:
       0      1
0  42414      0
1     81  14337
---- Validation: 
scalar performance:
{'acc': 0.97588044, 'precision': 0.86758786, 'recall': 0.7407238, 'specificity': 0.7407238, 'f1': 0.7898153, 'auroc': 0.9610434, 'binary_precision': 0.754023, 'binary_recall': 0.48736998, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.59205776}
confusion matrix:
       0    1
0  17960  107
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6791969, 'recall': 0.50359386, 'specificity': 0.50359386, 'f1': 0.49680376, 'auroc': 0.9401412, 'binary_precision': 0.4, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.01509434}
confusion matrix:
      0  1
0  5943  3
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_21.png
early stop counter: 4
val acc:0.9758804440498352, best validation acc: 0.9770544171333313, corresponding to test acc:                         0.9637447595596313 / 0.967128574848175
after epoch: 21,now: 2024-06-30 12:46:18.290130,epoch time: 0:23:58.243382,used: 7:45:01.086490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9982228, 'precision': 0.9987425, 'recall': 0.99656653, 'specificity': 0.99656653, 'f1': 0.9976485, 'auroc': 0.99979097, 'binary_precision': 0.99979055, 'binary_recall': 0.9932039, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.99648637}
confusion matrix:
       0      1
0  42409      3
1     98  14322
---- Validation: 
scalar performance:
{'acc': 0.9772145, 'precision': 0.86963654, 'recall': 0.76645005, 'specificity': 0.76645005, 'f1': 0.8089537, 'auroc': 0.9649106, 'binary_precision': 0.75625, 'binary_recall': 0.5393759, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.62966174}
confusion matrix:
       0    1
0  17950  117
1    310  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.6043215, 'recall': 0.50668323, 'specificity': 0.50668323, 'f1': 0.5034512, 'auroc': 0.95531255, 'binary_precision': 0.25, 'binary_recall': 0.015384615, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.028985508}
confusion matrix:
      0   1
0  5934  12
1   256   4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_22.png
better model found
persisted
after epoch: 22,now: 2024-06-30 13:08:09.194597,epoch time: 0:21:50.904467,used: 8:06:51.990957,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99773014, 'precision': 0.99848384, 'recall': 0.99552673, 'specificity': 0.99552673, 'f1': 0.9969941, 'auroc': 0.9999082, 'binary_precision': 1.0, 'binary_recall': 0.99105346, 'binary_specificity': 1.0, 'binary_f1_score': 0.99550664}
confusion matrix:
       0      1
0  42413      0
1    129  14290
---- Validation: 
scalar performance:
{'acc': 0.9707577, 'precision': 0.88873523, 'recall': 0.62147844, 'specificity': 0.62147844, 'f1': 0.6804412, 'auroc': 0.96485865, 'binary_precision': 0.80487806, 'binary_recall': 0.24517088, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.37585422}
confusion matrix:
       0    1
0  18027   40
1    508  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.62204736, 'recall': 0.5034257, 'specificity': 0.5034257, 'f1': 0.49666312, 'auroc': 0.9359698, 'binary_precision': 0.2857143, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.014981274}
confusion matrix:
      0  1
0  5941  5
1   258  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_23.png
early stop counter: 1
val acc:0.9707577228546143, best validation acc: 0.977214515209198, corresponding to test acc:                         0.9568159580230713 / 0.967128574848175
after epoch: 23,now: 2024-06-30 13:29:57.920784,epoch time: 0:21:48.726187,used: 8:28:40.717144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99857473, 'precision': 0.99888515, 'recall': 0.9973514, 'specificity': 0.9973514, 'f1': 0.9981153, 'auroc': 0.99990153, 'binary_precision': 0.99951226, 'binary_recall': 0.99486786, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.99718463}
confusion matrix:
       0      1
0  42406      7
1     74  14345
---- Validation: 
scalar performance:
{'acc': 0.9759872, 'precision': 0.83528674, 'recall': 0.80157685, 'specificity': 0.80157685, 'f1': 0.8174529, 'auroc': 0.9606564, 'binary_precision': 0.6849088, 'binary_recall': 0.6136701, 'binary_specificity': 0.9894836, 'binary_f1_score': 0.64733535}
confusion matrix:
       0    1
0  17877  190
1    260  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7372236, 'recall': 0.5350248, 'specificity': 0.5350248, 'f1': 0.5532838, 'auroc': 0.94701767, 'binary_precision': 0.5135135, 'binary_recall': 0.073076926, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.12794614}
confusion matrix:
      0   1
0  5928  18
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_24.png
early stop counter: 2
val acc:0.9759871959686279, best validation acc: 0.977214515209198, corresponding to test acc:                         0.9568159580230713 / 0.967128574848175
after epoch: 24,now: 2024-06-30 13:51:42.692932,epoch time: 0:21:44.772148,used: 8:50:25.489292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99765974, 'precision': 0.9982043, 'recall': 0.99561715, 'specificity': 0.99561715, 'f1': 0.99690217, 'auroc': 0.9998845, 'binary_precision': 0.999301, 'binary_recall': 0.99147016, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.9953702}
confusion matrix:
       0      1
0  42402     10
1    123  14297
---- Validation: 
scalar performance:
{'acc': 0.96873, 'precision': 0.8418812, 'recall': 0.60683674, 'specificity': 0.60683674, 'f1': 0.658282, 'auroc': 0.9518496, 'binary_precision': 0.7121951, 'binary_recall': 0.21693908, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.332574}
confusion matrix:
       0    1
0  18008   59
1    527  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.5702105, 'recall': 0.5061787, 'specificity': 0.5061787, 'f1': 0.5028901, 'auroc': 0.9212557, 'binary_precision': 0.18181819, 'binary_recall': 0.015384615, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.028368795}
confusion matrix:
      0   1
0  5928  18
1   256   4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_25.png
early stop counter: 3
val acc:0.9687299728393555, best validation acc: 0.977214515209198, corresponding to test acc:                         0.9568159580230713 / 0.967128574848175
after epoch: 25,now: 2024-06-30 14:13:25.168344,epoch time: 0:21:42.475412,used: 9:12:07.964704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9985923, 'precision': 0.99903554, 'recall': 0.99724853, 'specificity': 0.99724853, 'f1': 0.99813795, 'auroc': 0.9999459, 'binary_precision': 0.99993026, 'binary_recall': 0.9945207, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99721813}
confusion matrix:
       0      1
0  42413      1
1     79  14339
---- Validation: 
scalar performance:
{'acc': 0.9734258, 'precision': 0.89583695, 'recall': 0.6664935, 'specificity': 0.6664935, 'f1': 0.7310784, 'auroc': 0.9684093, 'binary_precision': 0.8158845, 'binary_recall': 0.3358098, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.47578943}
confusion matrix:
       0    1
0  18016   51
1    447  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.6573529, 'recall': 0.5300855, 'specificity': 0.5300855, 'f1': 0.54387623, 'auroc': 0.92838335, 'binary_precision': 0.35416666, 'binary_recall': 0.06538462, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.11038962}
confusion matrix:
      0   1
0  5915  31
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_26.png
early stop counter: 4
val acc:0.9734258055686951, best validation acc: 0.977214515209198, corresponding to test acc:                         0.9568159580230713 / 0.967128574848175
after epoch: 26,now: 2024-06-30 14:35:04.058569,epoch time: 0:21:38.890225,used: 9:33:46.854929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9983284, 'precision': 0.99888253, 'recall': 0.99670595, 'specificity': 0.99670595, 'f1': 0.9977882, 'auroc': 0.99987316, 'binary_precision': 1.0, 'binary_recall': 0.9934119, 'binary_specificity': 1.0, 'binary_f1_score': 0.99669504}
confusion matrix:
       0      1
0  42412      0
1     95  14325
---- Validation: 
scalar performance:
{'acc': 0.9776414, 'precision': 0.8941325, 'recall': 0.74592865, 'specificity': 0.74592865, 'f1': 0.8015111, 'auroc': 0.9664744, 'binary_precision': 0.8067633, 'binary_recall': 0.4962853, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.6145354}
confusion matrix:
       0    1
0  17987   80
1    339  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.58457464, 'recall': 0.506431, 'specificity': 0.506431, 'f1': 0.50316906, 'auroc': 0.9036919, 'binary_precision': 0.21052632, 'binary_recall': 0.015384615, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.028673835}
confusion matrix:
      0   1
0  5931  15
1   256   4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_27.png
better model found
persisted
after epoch: 27,now: 2024-06-30 14:57:54.703252,epoch time: 0:22:50.644683,used: 9:56:37.499612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9983988, 'precision': 0.9989063, 'recall': 0.99686754, 'specificity': 0.99686754, 'f1': 0.99788165, 'auroc': 0.99990356, 'binary_precision': 0.9999302, 'binary_recall': 0.9937587, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9968349}
confusion matrix:
       0      1
0  42411      1
1     90  14330
---- Validation: 
scalar performance:
{'acc': 0.9725187, 'precision': 0.938157, 'recall': 0.6309749, 'specificity': 0.6309749, 'f1': 0.696649, 'auroc': 0.9658706, 'binary_precision': 0.9030612, 'binary_recall': 0.26300147, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.40736476}
confusion matrix:
       0    1
0  18048   19
1    496  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.47901532, 'recall': 0.499075, 'specificity': 0.499075, 'f1': 0.48883948, 'auroc': 0.89330995, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99815, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5935  11
1   260   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_28.png
early stop counter: 1
val acc:0.9725186824798584, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9563325643539429 / 0.967128574848175
after epoch: 28,now: 2024-06-30 15:20:07.014207,epoch time: 0:22:12.310955,used: 10:18:49.810567,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9984692, 'precision': 0.99897647, 'recall': 0.99698335, 'specificity': 0.99698335, 'f1': 0.99797475, 'auroc': 0.99993825, 'binary_precision': 1.0, 'binary_recall': 0.9939667, 'binary_specificity': 1.0, 'binary_f1_score': 0.99697423}
confusion matrix:
       0      1
0  42412      0
1     87  14333
---- Validation: 
scalar performance:
{'acc': 0.973159, 'precision': 0.9603958, 'recall': 0.63345283, 'specificity': 0.63345283, 'f1': 0.70170635, 'auroc': 0.9685502, 'binary_precision': 0.94736844, 'binary_recall': 0.26745912, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.41714945}
confusion matrix:
       0    1
0  18057   10
1    493  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72912633, 'recall': 0.501839, 'specificity': 0.501839, 'f1': 0.49311718, 'auroc': 0.9342467, 'binary_precision': 0.5, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0076335873}
confusion matrix:
      0  1
0  5945  1
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_29.png
early stop counter: 2
val acc:0.9731590151786804, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9563325643539429 / 0.967128574848175
after epoch: 29,now: 2024-06-30 15:42:08.810227,epoch time: 0:22:01.796020,used: 10:40:51.606587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99764216, 'precision': 0.99837863, 'recall': 0.9953991, 'specificity': 0.9953991, 'f1': 0.9968775, 'auroc': 0.99995303, 'binary_precision': 0.99986005, 'binary_recall': 0.99084544, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9953323}
confusion matrix:
       0      1
0  42411      2
1    132  14287
---- Validation: 
scalar performance:
{'acc': 0.96947706, 'precision': 0.9470675, 'recall': 0.58147454, 'specificity': 0.58147454, 'f1': 0.6310935, 'auroc': 0.966923, 'binary_precision': 0.92436975, 'binary_recall': 0.16344725, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.2777778}
confusion matrix:
       0    1
0  18058    9
1    563  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.9461118, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_30.png
early stop counter: 3
val acc:0.9694770574569702, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9563325643539429 / 0.967128574848175
after epoch: 30,now: 2024-06-30 16:04:07.342382,epoch time: 0:21:58.532155,used: 11:02:50.138742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_01_17_seed_1_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:02:50.138742 at 2024-06-30 16:04:07.342382
persisted model performance metric: 

scalar performance:
{'acc': 0.95633256, 'precision': 0.58457464, 'recall': 0.506431, 'specificity': 0.506431, 'f1': 0.50316906, 'auroc': 0.9036919, 'binary_precision': 0.21052632, 'binary_recall': 0.015384615, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.028673835}
confusion matrix:
      0   1
0  5931  15
1   256   4
oracle model performance metric: 

scalar performance:
{'acc': 0.9671286, 'precision': 0.95246863, 'recall': 0.6150483, 'specificity': 0.6150483, 'f1': 0.6767471, 'auroc': 0.95120287, 'binary_precision': 0.9375, 'binary_recall': 0.23076923, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.37037036}
confusion matrix:
      0   1
0  5942   4
1   200  60
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 417564 KiB |   5411 MiB |   6080 TiB |   6080 TiB |
|       from large pool | 385717 KiB |   5382 MiB |   6008 TiB |   6008 TiB |
|       from small pool |  31847 KiB |     51 MiB |     71 TiB |     71 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 417564 KiB |   5411 MiB |   6080 TiB |   6080 TiB |
|       from large pool | 385717 KiB |   5382 MiB |   6008 TiB |   6008 TiB |
|       from small pool |  31847 KiB |     51 MiB |     71 TiB |     71 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 411534 KiB |   5405 MiB |   6075 TiB |   6075 TiB |
|       from large pool | 380686 KiB |   5377 MiB |   6003 TiB |   6003 TiB |
|       from small pool |  30848 KiB |     50 MiB |     71 TiB |     71 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5920 MiB |   5948 MiB |  11216 MiB |   5296 MiB |
|       from large pool |   5866 MiB |   5890 MiB |  11144 MiB |   5278 MiB |
|       from small pool |     54 MiB |     58 MiB |     72 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 243939 KiB | 578757 KiB |   3819 TiB |   3819 TiB |
|       from large pool | 234827 KiB | 570940 KiB |   3747 TiB |   3747 TiB |
|       from small pool |   9112 KiB |  24437 KiB |     72 TiB |     72 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3293    |    7944    |     907 M  |     907 M  |
|       from large pool |     151    |     615    |     565 M  |     565 M  |
|       from small pool |    3142    |    7792    |     342 M  |     342 M  |
|---------------------------------------------------------------------------|
| Active allocs         |    3293    |    7944    |     907 M  |     907 M  |
|       from large pool |     151    |     615    |     565 M  |     565 M  |
|       from small pool |    3142    |    7792    |     342 M  |     342 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     273    |     275    |     500    |     227    |
|       from large pool |     246    |     246    |     464    |     218    |
|       from small pool |      27    |      29    |      36    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      55    |    3602    |  531623 K  |  531622 K  |
|       from large pool |      23    |     244    |  382114 K  |  382114 K  |
|       from small pool |      32    |    3577    |  149508 K  |  149508 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   5411 MiB |   6080 TiB |   6080 TiB |
|       from large pool |  65536 KiB |   5382 MiB |   6008 TiB |   6008 TiB |
|       from small pool |      0 KiB |     51 MiB |     71 TiB |     71 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   5411 MiB |   6080 TiB |   6080 TiB |
|       from large pool |  65536 KiB |   5382 MiB |   6008 TiB |   6008 TiB |
|       from small pool |      0 KiB |     51 MiB |     71 TiB |     71 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   5405 MiB |   6075 TiB |   6075 TiB |
|       from large pool |  65536 KiB |   5377 MiB |   6003 TiB |   6003 TiB |
|       from small pool |      0 KiB |     50 MiB |     71 TiB |     71 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 661504 KiB |   5948 MiB |  11216 MiB |  10570 MiB |
|       from large pool | 620544 KiB |   5890 MiB |  11144 MiB |  10538 MiB |
|       from small pool |  40960 KiB |     58 MiB |     72 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 578757 KiB |   3819 TiB |   3819 TiB |
|       from large pool |      0 B   | 570940 KiB |   3747 TiB |   3747 TiB |
|       from small pool |      0 B   |  24449 KiB |     72 TiB |     72 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7944    |     907 M  |     907 M  |
|       from large pool |       2    |     615    |     565 M  |     565 M  |
|       from small pool |       0    |    7792    |     342 M  |     342 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7944    |     907 M  |     907 M  |
|       from large pool |       2    |     615    |     565 M  |     565 M  |
|       from small pool |       0    |    7792    |     342 M  |     342 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      48    |     275    |     500    |     452    |
|       from large pool |      28    |     246    |     464    |     436    |
|       from small pool |      20    |      29    |      36    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3602    |  531624 K  |  531624 K  |
|       from large pool |       0    |     244    |  382114 K  |  382114 K  |
|       from small pool |       0    |    3577    |  149510 K  |  149510 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   5411 MiB |   6080 TiB |   6080 TiB |
|       from large pool |  65536 KiB |   5382 MiB |   6008 TiB |   6008 TiB |
|       from small pool |      0 KiB |     51 MiB |     71 TiB |     71 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   5411 MiB |   6080 TiB |   6080 TiB |
|       from large pool |  65536 KiB |   5382 MiB |   6008 TiB |   6008 TiB |
|       from small pool |      0 KiB |     51 MiB |     71 TiB |     71 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   5405 MiB |   6075 TiB |   6075 TiB |
|       from large pool |  65536 KiB |   5377 MiB |   6003 TiB |   6003 TiB |
|       from small pool |      0 KiB |     50 MiB |     71 TiB |     71 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 661504 KiB |   5948 MiB |  11216 MiB |  10570 MiB |
|       from large pool | 620544 KiB |   5890 MiB |  11144 MiB |  10538 MiB |
|       from small pool |  40960 KiB |     58 MiB |     72 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 578757 KiB |   3819 TiB |   3819 TiB |
|       from large pool |      0 B   | 570940 KiB |   3747 TiB |   3747 TiB |
|       from small pool |      0 B   |  24449 KiB |     72 TiB |     72 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7944    |     907 M  |     907 M  |
|       from large pool |       2    |     615    |     565 M  |     565 M  |
|       from small pool |       0    |    7792    |     342 M  |     342 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7944    |     907 M  |     907 M  |
|       from large pool |       2    |     615    |     565 M  |     565 M  |
|       from small pool |       0    |    7792    |     342 M  |     342 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      48    |     275    |     500    |     452    |
|       from large pool |      28    |     246    |     464    |     436    |
|       from small pool |      20    |      29    |      36    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3602    |  531624 K  |  531624 K  |
|       from large pool |       0    |     244    |  382114 K  |  382114 K  |
|       from small pool |       0    |    3577    |  149510 K  |  149510 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978

 Experiment start at: 2024-06-30 16:10:16.201402
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98682106, 'precision': 0.99083567, 'recall': 0.9753199, 'specificity': 0.9753199, 'f1': 0.98274827, 'auroc': 0.9985839, 'binary_precision': 0.99888915, 'binary_recall': 0.951018, 'binary_specificity': 0.99962187, 'binary_f1_score': 0.97436595}
confusion matrix:
       0      1
0  42296     16
1    741  14387
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.6441583, 'recall': 0.50617677, 'specificity': 0.50617677, 'f1': 0.5044843, 'auroc': 0.88399184, 'binary_precision': 0.32, 'binary_recall': 0.013289036, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.025518341}
confusion matrix:
       0   1
0  18154  17
1    594   8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.48058096, 'recall': 0.499333, 'specificity': 0.499333, 'f1': 0.48977754, 'auroc': 0.790625, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5989  8
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-30 16:32:48.993764,epoch time: 0:22:32.792362,used: 0:22:32.792362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9900766, 'precision': 0.98329586, 'recall': 0.99154437, 'specificity': 0.99154437, 'f1': 0.98732156, 'auroc': 0.999532, 'binary_precision': 0.9685247, 'binary_recall': 0.9946457, 'binary_specificity': 0.988443, 'binary_f1_score': 0.9814114}
confusion matrix:
       0      1
0  41823    489
1     81  15047
---- Validation: 
scalar performance:
{'acc': 0.9308049, 'precision': 0.6414317, 'recall': 0.86708736, 'specificity': 0.86708736, 'f1': 0.69433045, 'auroc': 0.9424808, 'binary_precision': 0.28993368, 'binary_recall': 0.7990033, 'binary_specificity': 0.9351714, 'binary_f1_score': 0.42547542}
confusion matrix:
       0     1
0  16993  1178
1    121   481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9379708, 'precision': 0.6657755, 'recall': 0.8091146, 'specificity': 0.8091146, 'f1': 0.7114038, 'auroc': 0.9187114, 'binary_precision': 0.34541577, 'binary_recall': 0.6694215, 'binary_specificity': 0.9488077, 'binary_f1_score': 0.4556962}
confusion matrix:
      0    1
0  5690  307
1    80  162
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_2.png
early stop counter: 1
val acc:0.9308049082756042, best validation acc: 0.9674532413482666, corresponding to test acc:                         0.9599294662475586 / 0.9599294662475586
after epoch: 2,now: 2024-06-30 16:54:50.216867,epoch time: 0:22:01.223103,used: 0:44:34.015465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9954213, 'precision': 0.9949266, 'recall': 0.99326146, 'specificity': 0.99326146, 'f1': 0.9940902, 'auroc': 0.99967825, 'binary_precision': 0.99388707, 'binary_recall': 0.98869723, 'binary_specificity': 0.9978256, 'binary_f1_score': 0.9912854}
confusion matrix:
       0      1
0  42219     92
1    171  14958
---- Validation: 
scalar performance:
{'acc': 0.9701167, 'precision': 0.76162803, 'recall': 0.7155421, 'specificity': 0.7155421, 'f1': 0.7361404, 'auroc': 0.94846827, 'binary_precision': 0.54158217, 'binary_recall': 0.4435216, 'binary_specificity': 0.9875626, 'binary_f1_score': 0.48767126}
confusion matrix:
       0    1
0  17945  226
1    335  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597692, 'precision': 0.5985214, 'recall': 0.5071806, 'specificity': 0.5071806, 'f1': 0.50517315, 'auroc': 0.9246965, 'binary_precision': 0.23529412, 'binary_recall': 0.016528925, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.03088803}
confusion matrix:
      0   1
0  5984  13
1   238   4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_3.png
better model found
persisted
after epoch: 3,now: 2024-06-30 17:16:54.962178,epoch time: 0:22:04.745311,used: 1:06:38.760776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9958914, 'precision': 0.99627054, 'recall': 0.99313504, 'specificity': 0.99313504, 'f1': 0.9946893, 'auroc': 0.99945056, 'binary_precision': 0.99706316, 'binary_recall': 0.98731, 'binary_specificity': 0.9989601, 'binary_f1_score': 0.99216264}
confusion matrix:
       0      1
0  42266     44
1    192  14938
---- Validation: 
scalar performance:
{'acc': 0.9708624, 'precision': 0.7714094, 'recall': 0.70147246, 'specificity': 0.70147246, 'f1': 0.7307846, 'auroc': 0.94250494, 'binary_precision': 0.56207675, 'binary_recall': 0.41362128, 'binary_specificity': 0.9893237, 'binary_f1_score': 0.47655505}
confusion matrix:
       0    1
0  17977  194
1    353  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.786008, 'recall': 0.52817523, 'specificity': 0.52817523, 'f1': 0.5431274, 'auroc': 0.9523658, 'binary_precision': 0.6086956, 'binary_recall': 0.05785124, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.10566038}
confusion matrix:
      0   1
0  5988   9
1   228  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-30 17:39:01.316641,epoch time: 0:22:06.354463,used: 1:28:45.115239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9963266, 'precision': 0.9969536, 'recall': 0.99357903, 'specificity': 0.99357903, 'f1': 0.9952507, 'auroc': 0.99974656, 'binary_precision': 0.9982633, 'binary_recall': 0.98777264, 'binary_specificity': 0.9993855, 'binary_f1_score': 0.99299026}
confusion matrix:
       0      1
0  42284     26
1    185  14945
---- Validation: 
scalar performance:
{'acc': 0.9761892, 'precision': 0.8128168, 'recall': 0.7901503, 'specificity': 0.7901503, 'f1': 0.801019, 'auroc': 0.9643434, 'binary_precision': 0.6391382, 'binary_recall': 0.5913621, 'binary_specificity': 0.9889384, 'binary_f1_score': 0.6143227}
confusion matrix:
       0    1
0  17970  201
1    246  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.8735999, 'recall': 0.57966137, 'specificity': 0.57966137, 'f1': 0.624781, 'auroc': 0.95396566, 'binary_precision': 0.78, 'binary_recall': 0.16115703, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.26712328}
confusion matrix:
      0   1
0  5986  11
1   203  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-30 18:01:09.584046,epoch time: 0:22:08.267405,used: 1:50:53.382644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9958217, 'precision': 0.9971579, 'recall': 0.9920894, 'specificity': 0.9920894, 'f1': 0.9945885, 'auroc': 0.9998126, 'binary_precision': 0.9999328, 'binary_recall': 0.9842025, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9920053}
confusion matrix:
       0      1
0  42310      1
1    239  14890
---- Validation: 
scalar performance:
{'acc': 0.9754435, 'precision': 0.9010445, 'recall': 0.64762545, 'specificity': 0.64762545, 'f1': 0.7122832, 'auroc': 0.95468485, 'binary_precision': 0.8248848, 'binary_recall': 0.29734218, 'binary_specificity': 0.9979088, 'binary_f1_score': 0.4371184}
confusion matrix:
       0    1
0  18133   38
1    423  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.6171761, 'recall': 0.5055314, 'specificity': 0.5055314, 'f1': 0.5017555, 'auroc': 0.94308865, 'binary_precision': 0.27272728, 'binary_recall': 0.012396694, 'binary_specificity': 0.998666, 'binary_f1_score': 0.023715416}
confusion matrix:
      0  1
0  5989  8
1   239  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_6.png
early stop counter: 1
val acc:0.9754434823989868, best validation acc: 0.9761891961097717, corresponding to test acc:                         0.9656996130943298 / 0.9656996130943298
after epoch: 6,now: 2024-06-30 18:23:17.929023,epoch time: 0:22:08.344977,used: 2:13:01.727621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9972841, 'precision': 0.99747384, 'recall': 0.99552405, 'specificity': 0.99552405, 'f1': 0.9964937, 'auroc': 0.99984884, 'binary_precision': 0.99787205, 'binary_recall': 0.99180436, 'binary_specificity': 0.9992437, 'binary_f1_score': 0.99482894}
confusion matrix:
       0      1
0  42278     32
1    124  15006
---- Validation: 
scalar performance:
{'acc': 0.9642039, 'precision': 0.72981393, 'recall': 0.88674927, 'specificity': 0.88674927, 'f1': 0.7857642, 'auroc': 0.9556594, 'binary_precision': 0.46628132, 'binary_recall': 0.8039867, 'binary_specificity': 0.96951187, 'binary_f1_score': 0.59024394}
confusion matrix:
       0    1
0  17617  554
1    118  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9543196, 'precision': 0.70950574, 'recall': 0.7839123, 'specificity': 0.7839123, 'f1': 0.7402021, 'auroc': 0.92387944, 'binary_precision': 0.43543544, 'binary_recall': 0.59917355, 'binary_specificity': 0.968651, 'binary_f1_score': 0.5043478}
confusion matrix:
      0    1
0  5809  188
1    97  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_7.png
early stop counter: 2
val acc:0.9642038941383362, best validation acc: 0.9761891961097717, corresponding to test acc:                         0.9656996130943298 / 0.9656996130943298
after epoch: 7,now: 2024-06-30 18:45:32.750071,epoch time: 0:22:14.821048,used: 2:35:16.548669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99606544, 'precision': 0.9951804, 'recall': 0.9946753, 'specificity': 0.9946753, 'f1': 0.9949275, 'auroc': 0.9998108, 'binary_precision': 0.9933135, 'binary_recall': 0.9917377, 'binary_specificity': 0.9976129, 'binary_f1_score': 0.99252504}
confusion matrix:
       0      1
0  42210    101
1    125  15004
---- Validation: 
scalar performance:
{'acc': 0.965216, 'precision': 0.7322169, 'recall': 0.8583623, 'specificity': 0.8583623, 'f1': 0.7801486, 'auroc': 0.9646307, 'binary_precision': 0.47307286, 'binary_recall': 0.74418604, 'binary_specificity': 0.97253865, 'binary_f1_score': 0.5784377}
confusion matrix:
       0    1
0  17672  499
1    154  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9588075, 'precision': 0.6443917, 'recall': 0.52650774, 'specificity': 0.52650774, 'f1': 0.538584, 'auroc': 0.93781304, 'binary_precision': 0.3255814, 'binary_recall': 0.05785124, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.09824562}
confusion matrix:
      0   1
0  5968  29
1   228  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_8.png
early stop counter: 3
val acc:0.9652159810066223, best validation acc: 0.9761891961097717, corresponding to test acc:                         0.9656996130943298 / 0.9656996130943298
after epoch: 8,now: 2024-06-30 19:07:52.236129,epoch time: 0:22:19.486058,used: 2:57:36.034727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99604803, 'precision': 0.99717855, 'recall': 0.99264646, 'specificity': 0.99264646, 'f1': 0.9948844, 'auroc': 0.9998005, 'binary_precision': 0.99953073, 'binary_recall': 0.9854584, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.99244463}
confusion matrix:
       0      1
0  42304      7
1    220  14909
---- Validation: 
scalar performance:
{'acc': 0.93117774, 'precision': 0.59900707, 'recall': 0.69382155, 'specificity': 0.69382155, 'f1': 0.62736154, 'auroc': 0.9054763, 'binary_precision': 0.21721311, 'binary_recall': 0.44019935, 'binary_specificity': 0.9474437, 'binary_f1_score': 0.29088914}
confusion matrix:
       0    1
0  17216  955
1    337  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95287704, 'precision': 0.56899047, 'recall': 0.52342284, 'specificity': 0.52342284, 'f1': 0.5313855, 'auroc': 0.8910054, 'binary_precision': 0.175, 'binary_recall': 0.05785124, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.08695652}
confusion matrix:
      0   1
0  5931  66
1   228  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_9.png
early stop counter: 4
val acc:0.9311777353286743, best validation acc: 0.9761891961097717, corresponding to test acc:                         0.9656996130943298 / 0.9656996130943298
after epoch: 9,now: 2024-06-30 19:29:50.899366,epoch time: 0:21:58.663237,used: 3:19:34.697964,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9971971, 'precision': 0.9979528, 'recall': 0.99482805, 'specificity': 0.99482805, 'f1': 0.9963771, 'auroc': 0.9998733, 'binary_precision': 0.9995328, 'binary_recall': 0.98982155, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.9946535}
confusion matrix:
       0      1
0  42303      7
1    154  14976
---- Validation: 
scalar performance:
{'acc': 0.9746977, 'precision': 0.84364784, 'recall': 0.6769531, 'specificity': 0.6769531, 'f1': 0.7316656, 'auroc': 0.9454731, 'binary_precision': 0.7081967, 'binary_recall': 0.358804, 'binary_specificity': 0.9951021, 'binary_f1_score': 0.47629553}
confusion matrix:
       0    1
0  18082   89
1    386  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7314964, 'recall': 0.5237929, 'specificity': 0.5237929, 'f1': 0.53520447, 'auroc': 0.92854416, 'binary_precision': 0.5, 'binary_recall': 0.049586777, 'binary_specificity': 0.997999, 'binary_f1_score': 0.09022556}
confusion matrix:
      0   1
0  5985  12
1   230  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_10.png
early stop counter: 5
val acc:0.9746977090835571, best validation acc: 0.9761891961097717, corresponding to test acc:                         0.9656996130943298 / 0.9656996130943298
after epoch: 10,now: 2024-06-30 19:52:01.199239,epoch time: 0:22:10.299873,used: 3:41:44.997837,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9976497, 'precision': 0.9978719, 'recall': 0.99606943, 'specificity': 0.99606943, 'f1': 0.9969662, 'auroc': 0.9998109, 'binary_precision': 0.99833834, 'binary_recall': 0.99272966, 'binary_specificity': 0.99940914, 'binary_f1_score': 0.99552613}
confusion matrix:
       0      1
0  42285     25
1    110  15020
---- Validation: 
scalar performance:
{'acc': 0.97315294, 'precision': 0.79286265, 'recall': 0.73317146, 'specificity': 0.73317146, 'f1': 0.7593236, 'auroc': 0.94869703, 'binary_precision': 0.60294116, 'binary_recall': 0.47674417, 'binary_specificity': 0.9895988, 'binary_f1_score': 0.5324675}
confusion matrix:
       0    1
0  17982  189
1    315  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.5597352, 'recall': 0.50486434, 'specificity': 0.50486434, 'f1': 0.501058, 'auroc': 0.90142715, 'binary_precision': 0.15789473, 'binary_recall': 0.012396694, 'binary_specificity': 0.997332, 'binary_f1_score': 0.022988508}
confusion matrix:
      0   1
0  5981  16
1   239   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_11.png
early stop counter: 6
val acc:0.9731529355049133, best validation acc: 0.9761891961097717, corresponding to test acc:                         0.9656996130943298 / 0.9656996130943298
after epoch: 11,now: 2024-06-30 20:14:08.287984,epoch time: 0:22:07.088745,used: 4:03:52.086582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99775416, 'precision': 0.99809265, 'recall': 0.99611884, 'specificity': 0.99611884, 'f1': 0.99710035, 'auroc': 0.99984527, 'binary_precision': 0.9988029, 'binary_recall': 0.9926631, 'binary_specificity': 0.9995746, 'binary_f1_score': 0.9957235}
confusion matrix:
       0      1
0  42293     18
1    111  15018
---- Validation: 
scalar performance:
{'acc': 0.97778726, 'precision': 0.81448007, 'recall': 0.8471892, 'specificity': 0.8471892, 'f1': 0.82995, 'auroc': 0.9665866, 'binary_precision': 0.63868064, 'binary_recall': 0.7076412, 'binary_specificity': 0.98673713, 'binary_f1_score': 0.67139477}
confusion matrix:
       0    1
0  17930  241
1    176  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722712, 'precision': 0.89300334, 'recall': 0.6841995, 'specificity': 0.6841995, 'f1': 0.7478235, 'auroc': 0.956856, 'binary_precision': 0.8108108, 'binary_recall': 0.37190083, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.50991505}
confusion matrix:
      0   1
0  5976  21
1   152  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_12.png
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-06-30 20:36:29.706389,epoch time: 0:22:21.418405,used: 4:26:13.504987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.998172, 'precision': 0.99816275, 'recall': 0.9971243, 'specificity': 0.9971243, 'f1': 0.99764204, 'auroc': 0.99990666, 'binary_precision': 0.99814326, 'binary_recall': 0.9949104, 'binary_specificity': 0.9993382, 'binary_f1_score': 0.9965242}
confusion matrix:
       0      1
0  42283     28
1     77  15052
---- Validation: 
scalar performance:
{'acc': 0.97890586, 'precision': 0.8493789, 'recall': 0.7827201, 'specificity': 0.7827201, 'f1': 0.81224895, 'auroc': 0.9652771, 'binary_precision': 0.7128099, 'binary_recall': 0.5730897, 'binary_specificity': 0.99235046, 'binary_f1_score': 0.6353591}
confusion matrix:
       0    1
0  18032  139
1    257  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.68886214, 'recall': 0.55063415, 'specificity': 0.55063415, 'f1': 0.5748541, 'auroc': 0.9410723, 'binary_precision': 0.41269842, 'binary_recall': 0.10743801, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.1704918}
confusion matrix:
      0   1
0  5960  37
1   216  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_13.png
better model found
persisted
after epoch: 13,now: 2024-06-30 20:58:37.039035,epoch time: 0:22:07.332646,used: 4:48:20.837633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9974756, 'precision': 0.9982923, 'recall': 0.9952079, 'specificity': 0.9952079, 'f1': 0.9967371, 'auroc': 0.99986756, 'binary_precision': 1.0, 'binary_recall': 0.99041575, 'binary_specificity': 1.0, 'binary_f1_score': 0.9951848}
confusion matrix:
       0      1
0  42311      0
1    145  14984
---- Validation: 
scalar performance:
{'acc': 0.9746977, 'precision': 0.9658327, 'recall': 0.6103, 'specificity': 0.6103, 'f1': 0.67303425, 'auroc': 0.9672675, 'binary_precision': 0.95683455, 'binary_recall': 0.22093023, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.35897437}
confusion matrix:
       0    1
0  18165    6
1    469  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.93237436, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_14.png
early stop counter: 1
val acc:0.9746977090835571, best validation acc: 0.9789058566093445, corresponding to test acc:                         0.9594486355781555 / 0.972271203994751
after epoch: 14,now: 2024-06-30 21:20:47.351774,epoch time: 0:22:10.312739,used: 5:10:31.150372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9983983, 'precision': 0.9988292, 'recall': 0.99704456, 'specificity': 0.99704456, 'f1': 0.9979325, 'auroc': 0.999947, 'binary_precision': 0.99973416, 'binary_recall': 0.9941837, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99695116}
confusion matrix:
       0      1
0  42306      4
1     88  15042
---- Validation: 
scalar performance:
{'acc': 0.97800034, 'precision': 0.9372315, 'recall': 0.677053, 'specificity': 0.677053, 'f1': 0.74883306, 'auroc': 0.9609302, 'binary_precision': 0.8953975, 'binary_recall': 0.3554817, 'binary_specificity': 0.9986242, 'binary_f1_score': 0.508918}
confusion matrix:
       0    1
0  18146   25
1    388  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597692, 'precision': 0.5261064, 'recall': 0.5012324, 'specificity': 0.5012324, 'f1': 0.49368674, 'auroc': 0.9291843, 'binary_precision': 0.09090909, 'binary_recall': 0.004132231, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.007905138}
confusion matrix:
      0   1
0  5987  10
1   241   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_15.png
early stop counter: 2
val acc:0.9780003428459167, best validation acc: 0.9789058566093445, corresponding to test acc:                         0.9594486355781555 / 0.972271203994751
after epoch: 15,now: 2024-06-30 21:42:58.147893,epoch time: 0:22:10.796119,used: 5:32:41.946491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9976149, 'precision': 0.9982997, 'recall': 0.9955572, 'specificity': 0.9955572, 'f1': 0.9969182, 'auroc': 0.9999149, 'binary_precision': 0.9997333, 'binary_recall': 0.9912089, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9954528}
confusion matrix:
       0      1
0  42307      4
1    133  14996
---- Validation: 
scalar performance:
{'acc': 0.9751771, 'precision': 0.8718496, 'recall': 0.6611397, 'specificity': 0.6611397, 'f1': 0.7220874, 'auroc': 0.9652964, 'binary_precision': 0.765625, 'binary_recall': 0.3255814, 'binary_specificity': 0.996698, 'binary_f1_score': 0.45687643}
confusion matrix:
       0    1
0  18111   60
1    406  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.73164546, 'recall': 0.52775836, 'specificity': 0.52775836, 'f1': 0.54194033, 'auroc': 0.9441623, 'binary_precision': 0.5, 'binary_recall': 0.05785124, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.1037037}
confusion matrix:
      0   1
0  5983  14
1   228  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_16.png
early stop counter: 3
val acc:0.9751771092414856, best validation acc: 0.9789058566093445, corresponding to test acc:                         0.9594486355781555 / 0.972271203994751
after epoch: 16,now: 2024-06-30 22:05:00.275694,epoch time: 0:22:02.127801,used: 5:54:44.074292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9983983, 'precision': 0.99887216, 'recall': 0.9970021, 'specificity': 0.9970021, 'f1': 0.9979323, 'auroc': 0.9999281, 'binary_precision': 0.999867, 'binary_recall': 0.9940516, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99695075}
confusion matrix:
       0      1
0  42308      2
1     90  15040
---- Validation: 
scalar performance:
{'acc': 0.9773611, 'precision': 0.92920756, 'recall': 0.66949534, 'specificity': 0.66949534, 'f1': 0.7397205, 'auroc': 0.9667823, 'binary_precision': 0.87982833, 'binary_recall': 0.34053156, 'binary_specificity': 0.9984591, 'binary_f1_score': 0.49101794}
confusion matrix:
       0    1
0  18143   28
1    397  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597692, 'precision': 0.62387997, 'recall': 0.51114607, 'specificity': 0.51114607, 'f1': 0.51253945, 'auroc': 0.9303247, 'binary_precision': 0.2857143, 'binary_recall': 0.024793388, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.045627378}
confusion matrix:
      0   1
0  5982  15
1   236   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_17.png
early stop counter: 4
val acc:0.9773610830307007, best validation acc: 0.9789058566093445, corresponding to test acc:                         0.9594486355781555 / 0.972271203994751
after epoch: 17,now: 2024-06-30 22:27:12.780038,epoch time: 0:22:12.504344,used: 6:16:56.578636,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99766713, 'precision': 0.998184, 'recall': 0.99580526, 'specificity': 0.99580526, 'f1': 0.9969869, 'auroc': 0.99991715, 'binary_precision': 0.9992675, 'binary_recall': 0.99187046, 'binary_specificity': 0.99974, 'binary_f1_score': 0.9955553}
confusion matrix:
       0      1
0  42299     11
1    123  15007
---- Validation: 
scalar performance:
{'acc': 0.9754967, 'precision': 0.84288716, 'recall': 0.69985116, 'specificity': 0.69985116, 'f1': 0.75109947, 'auroc': 0.96558356, 'binary_precision': 0.70520234, 'binary_recall': 0.4053156, 'binary_specificity': 0.9943867, 'binary_f1_score': 0.51476794}
confusion matrix:
       0    1
0  18069  102
1    358  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.9292816, 'recall': 0.53495723, 'specificity': 0.53495723, 'f1': 0.5558438, 'auroc': 0.94437355, 'binary_precision': 0.8947368, 'binary_recall': 0.07024793, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.13026819}
confusion matrix:
      0   1
0  5995   2
1   225  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_18.png
early stop counter: 5
val acc:0.9754967093467712, best validation acc: 0.9789058566093445, corresponding to test acc:                         0.9594486355781555 / 0.972271203994751
after epoch: 18,now: 2024-06-30 22:49:24.698000,epoch time: 0:22:11.917962,used: 6:39:08.496598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99805015, 'precision': 0.9984862, 'recall': 0.9964896, 'specificity': 0.9964896, 'f1': 0.9974824, 'auroc': 0.9998933, 'binary_precision': 0.9994014, 'binary_recall': 0.9931919, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.9962869}
confusion matrix:
       0      1
0  42302      9
1    103  15026
---- Validation: 
scalar performance:
{'acc': 0.97219414, 'precision': 0.7751639, 'recall': 0.7848743, 'specificity': 0.7848743, 'f1': 0.7799264, 'auroc': 0.9585655, 'binary_precision': 0.5641026, 'binary_recall': 0.58471763, 'binary_specificity': 0.98503107, 'binary_f1_score': 0.5742252}
confusion matrix:
       0    1
0  17899  272
1    250  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95832664, 'precision': 0.618868, 'recall': 0.5203094, 'specificity': 0.5203094, 'f1': 0.52834785, 'auroc': 0.9314743, 'binary_precision': 0.275, 'binary_recall': 0.045454547, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.07801419}
confusion matrix:
      0   1
0  5968  29
1   231  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_19.png
early stop counter: 6
val acc:0.9721941351890564, best validation acc: 0.9789058566093445, corresponding to test acc:                         0.9594486355781555 / 0.972271203994751
after epoch: 19,now: 2024-06-30 23:11:39.491789,epoch time: 0:22:14.793789,used: 7:01:23.290387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99787605, 'precision': 0.9985624, 'recall': 0.9959683, 'specificity': 0.9959683, 'f1': 0.99725616, 'auroc': 0.99990207, 'binary_precision': 1.0, 'binary_recall': 0.99193656, 'binary_specificity': 1.0, 'binary_f1_score': 0.99595195}
confusion matrix:
       0      1
0  42310      0
1    122  15008
---- Validation: 
scalar performance:
{'acc': 0.9760294, 'precision': 0.8716117, 'recall': 0.6808531, 'specificity': 0.6808531, 'f1': 0.7410528, 'auroc': 0.96160126, 'binary_precision': 0.7638889, 'binary_recall': 0.3654485, 'binary_specificity': 0.9962578, 'binary_f1_score': 0.494382}
confusion matrix:
       0    1
0  18103   68
1    382  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.898422, 'recall': 0.53074163, 'specificity': 0.53074163, 'f1': 0.54827994, 'auroc': 0.9352455, 'binary_precision': 0.8333333, 'binary_recall': 0.06198347, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.11538461}
confusion matrix:
      0   1
0  5994   3
1   227  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_20.png
early stop counter: 7
val acc:0.9760293960571289, best validation acc: 0.9789058566093445, corresponding to test acc:                         0.9594486355781555 / 0.972271203994751
after epoch: 20,now: 2024-06-30 23:33:51.629204,epoch time: 0:22:12.137415,used: 7:23:35.427802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.998851, 'precision': 0.9991143, 'recall': 0.99792504, 'specificity': 0.99792504, 'f1': 0.99851775, 'auroc': 0.9999397, 'binary_precision': 0.9996683, 'binary_recall': 0.9959683, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.99781483}
confusion matrix:
       0      1
0  42305      5
1     61  15069
---- Validation: 
scalar performance:
{'acc': 0.9810366, 'precision': 0.9082284, 'recall': 0.75410795, 'specificity': 0.75410795, 'f1': 0.81200564, 'auroc': 0.9680571, 'binary_precision': 0.83243245, 'binary_recall': 0.5116279, 'binary_specificity': 0.996588, 'binary_f1_score': 0.63374484}
confusion matrix:
       0    1
0  18109   62
1    294  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.9229348, 'recall': 0.530825, 'specificity': 0.530825, 'f1': 0.5485444, 'auroc': 0.94923186, 'binary_precision': 0.88235295, 'binary_recall': 0.06198347, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.11583011}
confusion matrix:
      0   1
0  5995   2
1   227  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_21.png
better model found
persisted
after epoch: 21,now: 2024-06-30 23:56:22.035745,epoch time: 0:22:30.406541,used: 7:46:05.834343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9987117, 'precision': 0.998913, 'recall': 0.99776673, 'specificity': 0.99776673, 'f1': 0.998338, 'auroc': 0.9999492, 'binary_precision': 0.99933666, 'binary_recall': 0.99576974, 'binary_specificity': 0.99976367, 'binary_f1_score': 0.99754995}
confusion matrix:
       0      1
0  42301     10
1     64  15065
---- Validation: 
scalar performance:
{'acc': 0.97746766, 'precision': 0.85811317, 'recall': 0.73058206, 'specificity': 0.73058206, 'f1': 0.7794943, 'auroc': 0.9532878, 'binary_precision': 0.73368144, 'binary_recall': 0.4667774, 'binary_specificity': 0.9943867, 'binary_f1_score': 0.57055837}
confusion matrix:
       0    1
0  18069  102
1    321  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.8620566, 'recall': 0.53875595, 'specificity': 0.53875595, 'f1': 0.5617842, 'auroc': 0.9147347, 'binary_precision': 0.76, 'binary_recall': 0.0785124, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.1423221}
confusion matrix:
      0   1
0  5991   6
1   223  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_22.png
early stop counter: 1
val acc:0.9774676561355591, best validation acc: 0.9810366034507751, corresponding to test acc:                         0.9632954001426697 / 0.972271203994751
after epoch: 22,now: 2024-07-01 00:18:14.049440,epoch time: 0:21:52.013695,used: 8:07:57.848038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9985376, 'precision': 0.99853903, 'recall': 0.9976911, 'specificity': 0.9976911, 'f1': 0.99811405, 'auroc': 0.9998449, 'binary_precision': 0.9985421, 'binary_recall': 0.9959022, 'binary_specificity': 0.99948, 'binary_f1_score': 0.99722034}
confusion matrix:
       0      1
0  42288     22
1     62  15068
---- Validation: 
scalar performance:
{'acc': 0.97805357, 'precision': 0.84569794, 'recall': 0.76621884, 'specificity': 0.76621884, 'f1': 0.80038, 'auroc': 0.96693134, 'binary_precision': 0.70652175, 'binary_recall': 0.5398671, 'binary_specificity': 0.9925706, 'binary_f1_score': 0.6120527}
confusion matrix:
       0    1
0  18036  135
1    277  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9580061, 'precision': 0.6866065, 'recall': 0.5835903, 'specificity': 0.5835903, 'f1': 0.6127635, 'auroc': 0.9212962, 'binary_precision': 0.4056604, 'binary_recall': 0.17768595, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.24712642}
confusion matrix:
      0   1
0  5934  63
1   199  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_23.png
early stop counter: 2
val acc:0.9780535697937012, best validation acc: 0.9810366034507751, corresponding to test acc:                         0.9632954001426697 / 0.972271203994751
after epoch: 23,now: 2024-07-01 00:40:06.892417,epoch time: 0:21:52.842977,used: 8:29:50.691015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9957695, 'precision': 0.9971447, 'recall': 0.9919696, 'specificity': 0.9919696, 'f1': 0.99452055, 'auroc': 0.9998639, 'binary_precision': 1.0, 'binary_recall': 0.9839392, 'binary_specificity': 1.0, 'binary_f1_score': 0.99190456}
confusion matrix:
       0      1
0  42310      0
1    243  14887
---- Validation: 
scalar performance:
{'acc': 0.9687317, 'precision': 0.81130946, 'recall': 0.5261103, 'specificity': 0.5261103, 'f1': 0.54120016, 'auroc': 0.9426804, 'binary_precision': 0.6530612, 'binary_recall': 0.053156145, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.0983103}
confusion matrix:
       0   1
0  18154  17
1    570  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.5431612, 'recall': 0.5014825, 'specificity': 0.5014825, 'f1': 0.49385932, 'auroc': 0.85533035, 'binary_precision': 0.125, 'binary_recall': 0.004132231, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.008}
confusion matrix:
      0  1
0  5990  7
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_24.png
early stop counter: 3
val acc:0.968731701374054, best validation acc: 0.9810366034507751, corresponding to test acc:                         0.9632954001426697 / 0.972271203994751
after epoch: 24,now: 2024-07-01 01:02:06.518938,epoch time: 0:21:59.626521,used: 8:51:50.317536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9970404, 'precision': 0.99773884, 'recall': 0.9946368, 'specificity': 0.9946368, 'f1': 0.9961747, 'auroc': 0.99988127, 'binary_precision': 0.99919915, 'binary_recall': 0.98955715, 'binary_specificity': 0.9997164, 'binary_f1_score': 0.9943548}
confusion matrix:
       0      1
0  42298     12
1    158  14972
---- Validation: 
scalar performance:
{'acc': 0.97357905, 'precision': 0.8015031, 'recall': 0.7213459, 'specificity': 0.7213459, 'f1': 0.754745, 'auroc': 0.9535936, 'binary_precision': 0.6210046, 'binary_recall': 0.45182723, 'binary_specificity': 0.9908646, 'binary_f1_score': 0.5230769}
confusion matrix:
       0    1
0  18005  166
1    330  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98220867, 'precision': 0.9081987, 'recall': 0.8380743, 'specificity': 0.8380743, 'f1': 0.8695389, 'auroc': 0.95463324, 'binary_precision': 0.8291457, 'binary_recall': 0.6818182, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.7482993}
confusion matrix:
      0    1
0  5963   34
1    77  165
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_25.png
new oracle model saved
early stop counter: 4
val acc:0.9735790491104126, best validation acc: 0.9810366034507751, corresponding to test acc:                         0.9632954001426697 / 0.9822086691856384
after epoch: 25,now: 2024-07-01 01:23:58.729679,epoch time: 0:21:52.210741,used: 9:13:42.528277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9987987, 'precision': 0.99912167, 'recall': 0.9977833, 'specificity': 0.9977833, 'f1': 0.99845004, 'auroc': 0.99991065, 'binary_precision': 0.99980086, 'binary_recall': 0.99563754, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.99771494}
confusion matrix:
       0      1
0  42308      3
1     66  15063
---- Validation: 
scalar performance:
{'acc': 0.97842646, 'precision': 0.8791313, 'recall': 0.7278651, 'specificity': 0.7278651, 'f1': 0.7833078, 'auroc': 0.95096505, 'binary_precision': 0.7759104, 'binary_recall': 0.4601329, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.5776851}
confusion matrix:
       0    1
0  18091   80
1    325  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.7934822, 'recall': 0.51008046, 'specificity': 0.51008046, 'f1': 0.51018643, 'auroc': 0.9025234, 'binary_precision': 0.625, 'binary_recall': 0.020661157, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.04}
confusion matrix:
      0  1
0  5994  3
1   237  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_26.png
early stop counter: 5
val acc:0.978426456451416, best validation acc: 0.9810366034507751, corresponding to test acc:                         0.9632954001426697 / 0.9822086691856384
after epoch: 26,now: 2024-07-01 01:46:03.694552,epoch time: 0:22:04.964873,used: 9:35:47.493150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99881613, 'precision': 0.9990052, 'recall': 0.9979439, 'specificity': 0.9979439, 'f1': 0.9984729, 'auroc': 0.99998116, 'binary_precision': 0.9994032, 'binary_recall': 0.9961005, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.9977491}
confusion matrix:
       0      1
0  42301      9
1     59  15071
---- Validation: 
scalar performance:
{'acc': 0.97816014, 'precision': 0.8508235, 'recall': 0.7598495, 'specificity': 0.7598495, 'f1': 0.7980237, 'auroc': 0.9502209, 'binary_precision': 0.71719456, 'binary_recall': 0.52657807, 'binary_specificity': 0.9931209, 'binary_f1_score': 0.6072797}
confusion matrix:
       0    1
0  18046  125
1    285  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.6171761, 'recall': 0.5055314, 'specificity': 0.5055314, 'f1': 0.5017555, 'auroc': 0.88804615, 'binary_precision': 0.27272728, 'binary_recall': 0.012396694, 'binary_specificity': 0.998666, 'binary_f1_score': 0.023715416}
confusion matrix:
      0  1
0  5989  8
1   239  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_27.png
early stop counter: 6
val acc:0.9781601428985596, best validation acc: 0.9810366034507751, corresponding to test acc:                         0.9632954001426697 / 0.9822086691856384
after epoch: 27,now: 2024-07-01 02:08:01.784830,epoch time: 0:21:58.090278,used: 9:57:45.583428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9984157, 'precision': 0.99852014, 'recall': 0.9973961, 'specificity': 0.9973961, 'f1': 0.9979564, 'auroc': 0.99991965, 'binary_precision': 0.9987398, 'binary_recall': 0.9952412, 'binary_specificity': 0.99955094, 'binary_f1_score': 0.99698746}
confusion matrix:
       0      1
0  42291     19
1     72  15058
---- Validation: 
scalar performance:
{'acc': 0.97347254, 'precision': 0.8263958, 'recall': 0.66427445, 'specificity': 0.66427445, 'f1': 0.71653855, 'auroc': 0.96097964, 'binary_precision': 0.67449665, 'binary_recall': 0.33388704, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.44666663}
confusion matrix:
       0    1
0  18074   97
1    401  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.76691914, 'recall': 0.51602864, 'specificity': 0.51602864, 'f1': 0.5214316, 'auroc': 0.9582436, 'binary_precision': 0.5714286, 'binary_recall': 0.03305785, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.062499993}
confusion matrix:
      0  1
0  5991  6
1   234  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_28.png
early stop counter: 7
val acc:0.973472535610199, best validation acc: 0.9810366034507751, corresponding to test acc:                         0.9632954001426697 / 0.9822086691856384
after epoch: 28,now: 2024-07-01 02:29:59.806787,epoch time: 0:21:58.021957,used: 10:19:43.605385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9987813, 'precision': 0.99900293, 'recall': 0.99785656, 'specificity': 0.99785656, 'f1': 0.9984279, 'auroc': 0.9999677, 'binary_precision': 0.99946934, 'binary_recall': 0.9959022, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.9976825}
confusion matrix:
       0      1
0  42302      8
1     62  15068
---- Validation: 
scalar performance:
{'acc': 0.9745379, 'precision': 0.90289474, 'recall': 0.6286876, 'specificity': 0.6286876, 'f1': 0.690966, 'auroc': 0.9636418, 'binary_precision': 0.82978725, 'binary_recall': 0.2591362, 'binary_specificity': 0.998239, 'binary_f1_score': 0.39493668}
confusion matrix:
       0    1
0  18139   32
1    446  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.9483504, 'recall': 0.5288422, 'specificity': 0.5288422, 'f1': 0.5451056, 'auroc': 0.93971527, 'binary_precision': 0.93333334, 'binary_recall': 0.05785124, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.108949415}
confusion matrix:
      0   1
0  5996   1
1   228  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_29.png
early stop counter: 8
val acc:0.9745379090309143, best validation acc: 0.9810366034507751, corresponding to test acc:                         0.9632954001426697 / 0.9822086691856384
after epoch: 29,now: 2024-07-01 02:51:50.214353,epoch time: 0:21:50.407566,used: 10:41:34.012951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99883354, 'precision': 0.9989743, 'recall': 0.99801934, 'specificity': 0.99801934, 'f1': 0.9984956, 'auroc': 0.99991876, 'binary_precision': 0.9992708, 'binary_recall': 0.99629873, 'binary_specificity': 0.99974, 'binary_f1_score': 0.9977826}
confusion matrix:
       0      1
0  42299     11
1     56  15074
---- Validation: 
scalar performance:
{'acc': 0.97762746, 'precision': 0.90477234, 'recall': 0.6889061, 'specificity': 0.6889061, 'f1': 0.755093, 'auroc': 0.9600588, 'binary_precision': 0.8297101, 'binary_recall': 0.38039866, 'binary_specificity': 0.99741346, 'binary_f1_score': 0.5216401}
confusion matrix:
       0    1
0  18124   47
1    373  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.9149368, 'recall': 0.52669275, 'specificity': 0.52669275, 'f1': 0.5411327, 'auroc': 0.93800133, 'binary_precision': 0.8666667, 'binary_recall': 0.053719006, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.101167314}
confusion matrix:
      0   1
0  5995   2
1   229  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628978_30.png
early stop counter: 9
val acc:0.9776274561882019, best validation acc: 0.9810366034507751, corresponding to test acc:                         0.9632954001426697 / 0.9822086691856384
after epoch: 30,now: 2024-07-01 03:13:45.547022,epoch time: 0:21:55.332669,used: 11:03:29.345620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_10_16_seed_2_21628978
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:03:29.345620 at 2024-07-01 03:13:45.547022
persisted model performance metric: 

scalar performance:
{'acc': 0.9632954, 'precision': 0.9229348, 'recall': 0.530825, 'specificity': 0.530825, 'f1': 0.5485444, 'auroc': 0.94923186, 'binary_precision': 0.88235295, 'binary_recall': 0.06198347, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.11583011}
confusion matrix:
      0   1
0  5995   2
1   227  15
oracle model performance metric: 

scalar performance:
{'acc': 0.98220867, 'precision': 0.9081987, 'recall': 0.8380743, 'specificity': 0.8380743, 'f1': 0.8695389, 'auroc': 0.95463324, 'binary_precision': 0.8291457, 'binary_recall': 0.6818182, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.7482993}
confusion matrix:
      0    1
0  5963   34
1    77  165
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 417330 KiB |   5411 MiB |   9144 TiB |   9144 TiB |
|       from large pool | 385477 KiB |   5382 MiB |   9036 TiB |   9036 TiB |
|       from small pool |  31853 KiB |     51 MiB |    107 TiB |    107 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 417330 KiB |   5411 MiB |   9144 TiB |   9144 TiB |
|       from large pool | 385477 KiB |   5382 MiB |   9036 TiB |   9036 TiB |
|       from small pool |  31853 KiB |     51 MiB |    107 TiB |    107 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 411536 KiB |   5405 MiB |   9138 TiB |   9138 TiB |
|       from large pool | 380686 KiB |   5377 MiB |   9031 TiB |   9031 TiB |
|       from small pool |  30850 KiB |     50 MiB |    107 TiB |    107 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5934 MiB |   5948 MiB |  16504 MiB |  10570 MiB |
|       from large pool |   5880 MiB |   5890 MiB |  16418 MiB |  10538 MiB |
|       from small pool |     54 MiB |     58 MiB |     86 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 260557 KiB | 578757 KiB |   5744 TiB |   5744 TiB |
|       from large pool | 249403 KiB | 570940 KiB |   5636 TiB |   5636 TiB |
|       from small pool |  11154 KiB |  24449 KiB |    108 TiB |    108 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3305    |    7994    |    1365 M  |    1365 M  |
|       from large pool |     151    |     615    |     850 M  |     850 M  |
|       from small pool |    3154    |    7842    |     515 M  |     515 M  |
|---------------------------------------------------------------------------|
| Active allocs         |    3305    |    7994    |    1365 M  |    1365 M  |
|       from large pool |     151    |     615    |     850 M  |     850 M  |
|       from small pool |    3154    |    7842    |     515 M  |     515 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     274    |     275    |     726    |     452    |
|       from large pool |     247    |     247    |     683    |     436    |
|       from small pool |      27    |      29    |      43    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      57    |    3626    |     787 M  |     787 M  |
|       from large pool |      25    |     244    |     567 M  |     567 M  |
|       from small pool |      32    |    3601    |     220 M  |     220 M  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   5411 MiB |   9144 TiB |   9144 TiB |
|       from large pool |  65536 KiB |   5382 MiB |   9036 TiB |   9036 TiB |
|       from small pool |      0 KiB |     51 MiB |    107 TiB |    107 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   5411 MiB |   9144 TiB |   9144 TiB |
|       from large pool |  65536 KiB |   5382 MiB |   9036 TiB |   9036 TiB |
|       from small pool |      0 KiB |     51 MiB |    107 TiB |    107 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   5405 MiB |   9138 TiB |   9138 TiB |
|       from large pool |  65536 KiB |   5377 MiB |   9031 TiB |   9031 TiB |
|       from small pool |      0 KiB |     50 MiB |    107 TiB |    107 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 677888 KiB |   5948 MiB |  16504 MiB |  15842 MiB |
|       from large pool | 634880 KiB |   5890 MiB |  16418 MiB |  15798 MiB |
|       from small pool |  43008 KiB |     58 MiB |     86 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 578757 KiB |   5744 TiB |   5744 TiB |
|       from large pool |      0 B   | 570940 KiB |   5636 TiB |   5636 TiB |
|       from small pool |      0 B   |  24449 KiB |    108 TiB |    108 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7994    |    1365 M  |    1365 M  |
|       from large pool |       2    |     615    |     850 M  |     850 M  |
|       from small pool |       0    |    7842    |     515 M  |     515 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7994    |    1365 M  |    1365 M  |
|       from large pool |       2    |     615    |     850 M  |     850 M  |
|       from small pool |       0    |    7842    |     515 M  |     515 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |     275    |     726    |     676    |
|       from large pool |      29    |     247    |     683    |     654    |
|       from small pool |      21    |      29    |      43    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3626    |     787 M  |     787 M  |
|       from large pool |       0    |     244    |     567 M  |     567 M  |
|       from small pool |       0    |    3601    |     220 M  |     220 M  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul  1 03:14:34 2024]
Finished job 0.
1 of 1 steps (100%) done
