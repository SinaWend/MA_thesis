Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 29 18:11:55 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984

 Experiment start at: 2024-06-29 18:16:49.457588
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9917602, 'precision': 0.9933618, 'recall': 0.98511505, 'specificity': 0.98511505, 'f1': 0.98914826, 'auroc': 0.9991933, 'binary_precision': 0.99658346, 'binary_recall': 0.9713878, 'binary_specificity': 0.9988423, 'binary_f1_score': 0.9838243}
confusion matrix:
       0      1
0  42277     49
1    421  14293
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.74553895, 'recall': 0.7118462, 'specificity': 0.7118462, 'f1': 0.72731304, 'auroc': 0.95296335, 'binary_precision': 0.51086956, 'binary_recall': 0.43856922, 'binary_specificity': 0.98512316, 'binary_f1_score': 0.47196653}
confusion matrix:
       0    1
0  17879  270
1    361  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97363377, 'precision': 0.8629637, 'recall': 0.77552474, 'specificity': 0.77552474, 'f1': 0.8126335, 'auroc': 0.9354039, 'binary_precision': 0.74489796, 'binary_recall': 0.55938697, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.63894963}
confusion matrix:
      0    1
0  5947   50
1   115  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-29 19:24:20.172779,epoch time: 1:07:30.715191,used: 1:07:30.715191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99198806, 'precision': 0.99458766, 'recall': 0.9845423, 'specificity': 0.9845423, 'f1': 0.98943186, 'auroc': 0.9996804, 'binary_precision': 0.9997897, 'binary_recall': 0.9691555, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9842343}
confusion matrix:
       0      1
0  42318      3
1    454  14265
---- Validation: 
scalar performance:
{'acc': 0.97035974, 'precision': 0.84843075, 'recall': 0.606627, 'specificity': 0.606627, 'f1': 0.65888864, 'auroc': 0.95526844, 'binary_precision': 0.7239583, 'binary_recall': 0.21617419, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.33293414}
confusion matrix:
       0    1
0  18096   53
1    504  139
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.9008515, 'recall': 0.58737224, 'specificity': 0.58737224, 'f1': 0.6363893, 'auroc': 0.9620663, 'binary_precision': 0.8363636, 'binary_recall': 0.17624521, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.29113927}
confusion matrix:
      0   1
0  5988   9
1   215  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_2.png
better model found
persisted
after epoch: 2,now: 2024-06-29 20:31:25.301092,epoch time: 1:07:05.128313,used: 2:14:35.843504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99570477, 'precision': 0.9954755, 'recall': 0.99329287, 'specificity': 0.99329287, 'f1': 0.99437785, 'auroc': 0.9995805, 'binary_precision': 0.99500513, 'binary_recall': 0.98831046, 'binary_specificity': 0.9982753, 'binary_f1_score': 0.9916465}
confusion matrix:
       0      1
0  42253     73
1    172  14542
---- Validation: 
scalar performance:
{'acc': 0.9750426, 'precision': 0.81611615, 'recall': 0.79281485, 'specificity': 0.79281485, 'f1': 0.8039768, 'auroc': 0.95778656, 'binary_precision': 0.64646465, 'binary_recall': 0.59720063, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.62085694}
confusion matrix:
       0    1
0  17939  210
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.8763535, 'recall': 0.6684137, 'specificity': 0.6684137, 'f1': 0.72922033, 'auroc': 0.9502171, 'binary_precision': 0.78070176, 'binary_recall': 0.34099618, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.47466668}
confusion matrix:
      0   1
0  5972  25
1   172  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_3.png
better model found
persisted
after epoch: 3,now: 2024-06-29 21:37:55.969927,epoch time: 1:06:30.668835,used: 3:21:06.512339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9964937, 'precision': 0.99760294, 'recall': 0.9932476, 'specificity': 0.9932476, 'f1': 0.9954003, 'auroc': 0.99977493, 'binary_precision': 0.99986225, 'binary_recall': 0.9865425, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99315774}
confusion matrix:
       0      1
0  42325      2
1    198  14515
---- Validation: 
scalar performance:
{'acc': 0.97041297, 'precision': 0.89685374, 'recall': 0.58565295, 'specificity': 0.58565295, 'f1': 0.6351204, 'auroc': 0.96015775, 'binary_precision': 0.82222223, 'binary_recall': 0.1726283, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.28534704}
confusion matrix:
       0    1
0  18125   24
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.47913337, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48918456, 'auroc': 0.95669, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_4.png
early stop counter: 1
val acc:0.9704129695892334, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 4,now: 2024-06-29 22:44:47.109120,epoch time: 1:06:51.139193,used: 4:27:57.651532,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9967216, 'precision': 0.99761885, 'recall': 0.99382365, 'specificity': 0.99382365, 'f1': 0.99570227, 'auroc': 0.9998257, 'binary_precision': 0.99944997, 'binary_recall': 0.98783636, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9936092}
confusion matrix:
       0      1
0  42316      8
1    179  14537
---- Validation: 
scalar performance:
{'acc': 0.97046614, 'precision': 0.86268663, 'recall': 0.6006816, 'specificity': 0.6006816, 'f1': 0.6527952, 'auroc': 0.9654138, 'binary_precision': 0.75287354, 'binary_recall': 0.2037325, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.32068545}
confusion matrix:
       0    1
0  18106   43
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.75276256, 'recall': 0.52215475, 'specificity': 0.52215475, 'f1': 0.53181666, 'auroc': 0.9462193, 'binary_precision': 0.54545456, 'binary_recall': 0.04597701, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.08480566}
confusion matrix:
      0   1
0  5987  10
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_5.png
early stop counter: 2
val acc:0.970466136932373, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 5,now: 2024-06-29 23:51:24.810495,epoch time: 1:06:37.701375,used: 5:34:35.352907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9971599, 'precision': 0.99684006, 'recall': 0.99573696, 'specificity': 0.99573696, 'f1': 0.99628687, 'auroc': 0.9997705, 'binary_precision': 0.99618167, 'binary_recall': 0.99279696, 'binary_specificity': 0.9986769, 'binary_f1_score': 0.9944864}
confusion matrix:
       0      1
0  42268     56
1    106  14610
---- Validation: 
scalar performance:
{'acc': 0.94141126, 'precision': 0.6714288, 'recall': 0.8856616, 'specificity': 0.8856616, 'f1': 0.7299507, 'auroc': 0.95464885, 'binary_precision': 0.3493421, 'binary_recall': 0.8258165, 'binary_specificity': 0.94550663, 'binary_f1_score': 0.49098474}
confusion matrix:
       0    1
0  17160  989
1    112  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.76299644, 'recall': 0.8154968, 'specificity': 0.8154968, 'f1': 0.7865188, 'auroc': 0.93975276, 'binary_precision': 0.54113925, 'binary_recall': 0.6551724, 'binary_specificity': 0.97582126, 'binary_f1_score': 0.592721}
confusion matrix:
      0    1
0  5852  145
1    90  171
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_6.png
early stop counter: 3
val acc:0.9414112567901611, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 6,now: 2024-06-30 00:58:08.404697,epoch time: 1:06:43.594202,used: 6:41:18.947109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9974404, 'precision': 0.997786, 'recall': 0.9955281, 'specificity': 0.9955281, 'f1': 0.99665034, 'auroc': 0.9997448, 'binary_precision': 0.998495, 'binary_recall': 0.9915761, 'binary_specificity': 0.9994801, 'binary_f1_score': 0.99502355}
confusion matrix:
       0      1
0  42298     22
1    124  14596
---- Validation: 
scalar performance:
{'acc': 0.9747233, 'precision': 0.8636936, 'recall': 0.6943923, 'specificity': 0.6943923, 'f1': 0.75141156, 'auroc': 0.95293665, 'binary_precision': 0.74852073, 'binary_recall': 0.3934681, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.5158002}
confusion matrix:
       0    1
0  18064   85
1    390  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9273977, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_7.png
early stop counter: 4
val acc:0.9747232794761658, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 7,now: 2024-06-30 02:04:49.966325,epoch time: 1:06:41.561628,used: 7:48:00.508737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9977209, 'precision': 0.9981539, 'recall': 0.99589276, 'specificity': 0.99589276, 'f1': 0.9970166, 'auroc': 0.9997677, 'binary_precision': 0.99904186, 'binary_recall': 0.99211633, 'binary_specificity': 0.99966925, 'binary_f1_score': 0.995567}
confusion matrix:
       0      1
0  42312     14
1    116  14598
---- Validation: 
scalar performance:
{'acc': 0.9733929, 'precision': 0.8243447, 'recall': 0.7169553, 'specificity': 0.7169553, 'f1': 0.75907135, 'auroc': 0.9651129, 'binary_precision': 0.6682353, 'binary_recall': 0.44167963, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.53183526}
confusion matrix:
       0    1
0  18008  141
1    359  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.8185448, 'recall': 0.55438834, 'specificity': 0.55438834, 'f1': 0.58532274, 'auroc': 0.95899594, 'binary_precision': 0.6744186, 'binary_recall': 0.11111111, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.19078949}
confusion matrix:
      0   1
0  5983  14
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_8.png
early stop counter: 5
val acc:0.973392903804779, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 8,now: 2024-06-30 03:11:38.774723,epoch time: 1:06:48.808398,used: 8:54:49.317135,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9975281, 'precision': 0.997957, 'recall': 0.99558663, 'specificity': 0.99558663, 'f1': 0.9967644, 'auroc': 0.99979556, 'binary_precision': 0.9988365, 'binary_recall': 0.99157494, 'binary_specificity': 0.9995983, 'binary_f1_score': 0.9951924}
confusion matrix:
       0      1
0  42305     17
1    124  14594
---- Validation: 
scalar performance:
{'acc': 0.9705726, 'precision': 0.79189646, 'recall': 0.69749385, 'specificity': 0.69749385, 'f1': 0.73473823, 'auroc': 0.96236575, 'binary_precision': 0.60465115, 'binary_recall': 0.4043546, 'binary_specificity': 0.9906331, 'binary_f1_score': 0.48462254}
confusion matrix:
       0    1
0  17979  170
1    383  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.74444175, 'recall': 0.5349811, 'specificity': 0.5349811, 'f1': 0.5533748, 'auroc': 0.95498824, 'binary_precision': 0.5277778, 'binary_recall': 0.07279693, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.12794612}
confusion matrix:
      0   1
0  5980  17
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_9.png
early stop counter: 6
val acc:0.9705725908279419, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 9,now: 2024-06-30 04:18:13.739514,epoch time: 1:06:34.964791,used: 10:01:24.281926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99635345, 'precision': 0.99755466, 'recall': 0.9929338, 'specificity': 0.9929338, 'f1': 0.9952161, 'auroc': 0.99970835, 'binary_precision': 1.0, 'binary_recall': 0.9858676, 'binary_specificity': 1.0, 'binary_f1_score': 0.9928835}
confusion matrix:
       0      1
0  42322      0
1    208  14510
---- Validation: 
scalar performance:
{'acc': 0.9723819, 'precision': 0.86366856, 'recall': 0.6421764, 'specificity': 0.6421764, 'f1': 0.7010272, 'auroc': 0.96077883, 'binary_precision': 0.7520325, 'binary_recall': 0.28771386, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.416198}
confusion matrix:
       0    1
0  18088   61
1    458  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.95826554, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_10.png
early stop counter: 7
val acc:0.9723818898200989, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 10,now: 2024-06-30 05:24:51.446651,epoch time: 1:06:37.707137,used: 11:08:01.989063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9975105, 'precision': 0.99826026, 'recall': 0.9952418, 'specificity': 0.9952418, 'f1': 0.99673903, 'auroc': 0.99993116, 'binary_precision': 0.99979424, 'binary_recall': 0.9905545, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.99515295}
confusion matrix:
       0      1
0  42321      3
1    139  14577
---- Validation: 
scalar performance:
{'acc': 0.97115797, 'precision': 0.92296726, 'recall': 0.59128904, 'specificity': 0.59128904, 'f1': 0.64430803, 'auroc': 0.96761, 'binary_precision': 0.8740741, 'binary_recall': 0.18351477, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.30334193}
confusion matrix:
       0    1
0  18132   17
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.96074283, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_11.png
early stop counter: 8
val acc:0.971157968044281, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 11,now: 2024-06-30 06:32:04.062492,epoch time: 1:07:12.615841,used: 12:15:14.604904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9960203, 'precision': 0.99733245, 'recall': 0.99228835, 'specificity': 0.99228835, 'f1': 0.9947769, 'auroc': 0.99982095, 'binary_precision': 1.0, 'binary_recall': 0.9845767, 'binary_specificity': 1.0, 'binary_f1_score': 0.99222845}
confusion matrix:
       0      1
0  42322      0
1    227  14491
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.9186769, 'recall': 0.5409927, 'specificity': 0.5409927, 'f1': 0.5671767, 'auroc': 0.9667107, 'binary_precision': 0.86885244, 'binary_recall': 0.08242613, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.15056819}
confusion matrix:
       0   1
0  18141   8
1    590  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.9609153, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_12.png
early stop counter: 9
val acc:0.9681779742240906, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 12,now: 2024-06-30 07:39:22.148183,epoch time: 1:07:18.085691,used: 13:22:32.690595,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99775594, 'precision': 0.99813265, 'recall': 0.9960048, 'specificity': 0.9960048, 'f1': 0.9970628, 'auroc': 0.99991894, 'binary_precision': 0.99890536, 'binary_recall': 0.9923877, 'binary_specificity': 0.999622, 'binary_f1_score': 0.99563587}
confusion matrix:
       0      1
0  42311     16
1    112  14601
---- Validation: 
scalar performance:
{'acc': 0.9717433, 'precision': 0.8210534, 'recall': 0.67259806, 'specificity': 0.67259806, 'f1': 0.7226545, 'auroc': 0.96147954, 'binary_precision': 0.6647059, 'binary_recall': 0.35147744, 'binary_specificity': 0.9937187, 'binary_f1_score': 0.45981684}
confusion matrix:
       0    1
0  18035  114
1    417  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8868393, 'recall': 0.5568876, 'specificity': 0.5568876, 'f1': 0.5909314, 'auroc': 0.9555517, 'binary_precision': 0.8108108, 'binary_recall': 0.11494253, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.20134228}
confusion matrix:
      0   1
0  5990   7
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_13.png
early stop counter: 10
val acc:0.9717432856559753, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 13,now: 2024-06-30 08:46:04.709112,epoch time: 1:06:42.560929,used: 14:29:15.251524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9961957, 'precision': 0.99735814, 'recall': 0.9927162, 'specificity': 0.9927162, 'f1': 0.99500877, 'auroc': 0.9997783, 'binary_precision': 0.99972427, 'binary_recall': 0.9855269, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9925748}
confusion matrix:
       0      1
0  42319      4
1    213  14504
---- Validation: 
scalar performance:
{'acc': 0.9634419, 'precision': 0.70046294, 'recall': 0.5977951, 'specificity': 0.5977951, 'f1': 0.62942445, 'auroc': 0.9263334, 'binary_precision': 0.42857143, 'binary_recall': 0.20528771, 'binary_specificity': 0.9903025, 'binary_f1_score': 0.27760252}
confusion matrix:
       0    1
0  17973  176
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9298498, 'precision': 0.5370294, 'recall': 0.5327999, 'specificity': 0.5327999, 'f1': 0.53469956, 'auroc': 0.8282359, 'binary_precision': 0.11304348, 'binary_recall': 0.099616855, 'binary_specificity': 0.965983, 'binary_f1_score': 0.10590631}
confusion matrix:
      0    1
0  5793  204
1   235   26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_14.png
early stop counter: 11
val acc:0.9634419083595276, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 14,now: 2024-06-30 09:52:34.698001,epoch time: 1:06:29.988889,used: 15:35:45.240413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99635345, 'precision': 0.9975548, 'recall': 0.99293286, 'specificity': 0.99293286, 'f1': 0.99521565, 'auroc': 0.9999311, 'binary_precision': 1.0, 'binary_recall': 0.9858657, 'binary_specificity': 1.0, 'binary_f1_score': 0.99288255}
confusion matrix:
       0      1
0  42324      0
1    208  14508
---- Validation: 
scalar performance:
{'acc': 0.9684972, 'precision': 0.90913856, 'recall': 0.5479084, 'specificity': 0.5479084, 'f1': 0.5785636, 'auroc': 0.96905553, 'binary_precision': 0.84931505, 'binary_recall': 0.096423015, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.17318435}
confusion matrix:
       0   1
0  18138  11
1    581  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.93624365, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_15.png
early stop counter: 12
val acc:0.9684972167015076, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 15,now: 2024-06-30 10:59:53.772291,epoch time: 1:07:19.074290,used: 16:43:04.314703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9981767, 'precision': 0.99859476, 'recall': 0.9966444, 'specificity': 0.9966444, 'f1': 0.99761456, 'auroc': 0.99994063, 'binary_precision': 0.9994532, 'binary_recall': 0.9934778, 'binary_specificity': 0.999811, 'binary_f1_score': 0.99645656}
confusion matrix:
       0      1
0  42313      8
1     96  14623
---- Validation: 
scalar performance:
{'acc': 0.9744572, 'precision': 0.861673, 'recall': 0.6905043, 'specificity': 0.6905043, 'f1': 0.7475424, 'auroc': 0.9722285, 'binary_precision': 0.7447447, 'binary_recall': 0.38569206, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.5081967}
confusion matrix:
       0    1
0  18064   85
1    395  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.646234, 'recall': 0.51049376, 'specificity': 0.51049376, 'f1': 0.51059586, 'auroc': 0.9634144, 'binary_precision': 0.33333334, 'binary_recall': 0.022988506, 'binary_specificity': 0.997999, 'binary_f1_score': 0.043010753}
confusion matrix:
      0   1
0  5985  12
1   255   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_16.png
early stop counter: 13
val acc:0.9744572043418884, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 16,now: 2024-06-30 12:06:55.936015,epoch time: 1:07:02.163724,used: 17:50:06.478427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9981066, 'precision': 0.9985925, 'recall': 0.99646395, 'specificity': 0.99646395, 'f1': 0.9975223, 'auroc': 0.9999342, 'binary_precision': 0.9995897, 'binary_recall': 0.9930697, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99631906}
confusion matrix:
       0      1
0  42316      6
1    102  14616
---- Validation: 
scalar performance:
{'acc': 0.96945506, 'precision': 0.89940906, 'recall': 0.5671557, 'specificity': 0.5671557, 'f1': 0.60851884, 'auroc': 0.96793336, 'binary_precision': 0.82857144, 'binary_recall': 0.13530326, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.23262031}
confusion matrix:
       0   1
0  18131  18
1    556  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.4791267, 'recall': 0.49949974, 'specificity': 0.49949974, 'f1': 0.48910117, 'auroc': 0.9497766, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5991  6
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_17.png
early stop counter: 14
val acc:0.9694550633430481, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 17,now: 2024-06-30 13:14:23.870065,epoch time: 1:07:27.934050,used: 18:57:34.412477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9978787, 'precision': 0.9985521, 'recall': 0.995911, 'specificity': 0.995911, 'f1': 0.9972223, 'auroc': 0.999904, 'binary_precision': 0.9999315, 'binary_recall': 0.9918456, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9958721}
confusion matrix:
       0      1
0  42323      1
1    120  14596
---- Validation: 
scalar performance:
{'acc': 0.97041297, 'precision': 0.9124204, 'recall': 0.5811526, 'specificity': 0.5811526, 'f1': 0.62952507, 'auroc': 0.96898925, 'binary_precision': 0.85365856, 'binary_recall': 0.16329704, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.2741514}
confusion matrix:
       0    1
0  18131   18
1    538  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.50296617, 'recall': 0.5002482, 'specificity': 0.5002482, 'f1': 0.49210256, 'auroc': 0.935539, 'binary_precision': 0.04761905, 'binary_recall': 0.0038314175, 'binary_specificity': 0.996665, 'binary_f1_score': 0.007092199}
confusion matrix:
      0   1
0  5977  20
1   260   1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_18.png
early stop counter: 15
val acc:0.9704129695892334, best validation acc: 0.9750425815582275, corresponding to test acc:                         0.9685202836990356 / 0.9736337661743164
after epoch: 18,now: 2024-06-30 14:20:58.608958,epoch time: 1:06:34.738893,used: 20:04:09.151370,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.998615, 'precision': 0.99873346, 'recall': 0.9976485, 'specificity': 0.9976485, 'f1': 0.99818945, 'auroc': 0.99994326, 'binary_precision': 0.99897736, 'binary_recall': 0.9956513, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.9973116}
confusion matrix:
       0      1
0  42308     15
1     64  14653
---- Validation: 
scalar performance:
{'acc': 0.97679865, 'precision': 0.89621496, 'recall': 0.7074677, 'specificity': 0.7074677, 'f1': 0.77022606, 'auroc': 0.9686706, 'binary_precision': 0.8126888, 'binary_recall': 0.41835147, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.5523614}
confusion matrix:
       0    1
0  18087   62
1    374  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8130804, 'recall': 0.5149922, 'specificity': 0.5149922, 'f1': 0.51880825, 'auroc': 0.9595944, 'binary_precision': 0.6666667, 'binary_recall': 0.03065134, 'binary_specificity': 0.999333, 'binary_f1_score': 0.058608055}
confusion matrix:
      0  1
0  5993  4
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_19.png
better model found
persisted
after epoch: 19,now: 2024-06-30 15:27:45.277898,epoch time: 1:06:46.668940,used: 21:10:55.820310,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99880785, 'precision': 0.99893016, 'recall': 0.9979553, 'specificity': 0.9979553, 'f1': 0.99844146, 'auroc': 0.99996215, 'binary_precision': 0.999182, 'binary_recall': 0.9961941, 'binary_specificity': 0.99971646, 'binary_f1_score': 0.9976858}
confusion matrix:
       0      1
0  42314     12
1     56  14658
---- Validation: 
scalar performance:
{'acc': 0.97631973, 'precision': 0.8344748, 'recall': 0.7814752, 'specificity': 0.7814752, 'f1': 0.8054882, 'auroc': 0.9681301, 'binary_precision': 0.68401486, 'binary_recall': 0.57231724, 'binary_specificity': 0.9906331, 'binary_f1_score': 0.62320065}
confusion matrix:
       0    1
0  17979  170
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.87744755, 'recall': 0.54356104, 'specificity': 0.54356104, 'f1': 0.5693316, 'auroc': 0.9387192, 'binary_precision': 0.79310346, 'binary_recall': 0.08812261, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.15862069}
confusion matrix:
      0   1
0  5991   6
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_20.png
early stop counter: 1
val acc:0.9763197302818298, best validation acc: 0.9767986536026001, corresponding to test acc:                         0.9589325785636902 / 0.9736337661743164
after epoch: 20,now: 2024-06-30 16:34:25.645081,epoch time: 1:06:40.367183,used: 22:17:36.187493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9983696, 'precision': 0.9988364, 'recall': 0.99690646, 'specificity': 0.99690646, 'f1': 0.9978666, 'auroc': 0.99991465, 'binary_precision': 0.9997949, 'binary_recall': 0.9938838, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9968306}
confusion matrix:
       0      1
0  42322      3
1     90  14625
---- Validation: 
scalar performance:
{'acc': 0.9713176, 'precision': 0.8794235, 'recall': 0.6101231, 'specificity': 0.6101231, 'f1': 0.6660018, 'auroc': 0.960687, 'binary_precision': 0.78571427, 'binary_recall': 0.22239502, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.34666666}
confusion matrix:
       0    1
0  18110   39
1    500  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7129905, 'recall': 0.51274294, 'specificity': 0.51274294, 'f1': 0.5146597, 'auroc': 0.9326247, 'binary_precision': 0.46666667, 'binary_recall': 0.026819924, 'binary_specificity': 0.998666, 'binary_f1_score': 0.05072464}
confusion matrix:
      0  1
0  5989  8
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_21.png
early stop counter: 2
val acc:0.9713175892829895, best validation acc: 0.9767986536026001, corresponding to test acc:                         0.9589325785636902 / 0.9736337661743164
after epoch: 21,now: 2024-06-30 17:40:12.908576,epoch time: 1:05:47.263495,used: 23:23:23.450988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9977209, 'precision': 0.99846894, 'recall': 0.99558306, 'specificity': 0.99558306, 'f1': 0.997015, 'auroc': 0.99994695, 'binary_precision': 1.0, 'binary_recall': 0.99116606, 'binary_specificity': 1.0, 'binary_f1_score': 0.9955634}
confusion matrix:
       0      1
0  42324      0
1    130  14586
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.9472822, 'recall': 0.52946633, 'specificity': 0.52946633, 'f1': 0.5473171, 'auroc': 0.967001, 'binary_precision': 0.9268293, 'binary_recall': 0.05909798, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.11111111}
confusion matrix:
       0   1
0  18146   3
1    605  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.958082, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_22.png
early stop counter: 3
val acc:0.9676458239555359, best validation acc: 0.9767986536026001, corresponding to test acc:                         0.9589325785636902 / 0.9736337661743164
after epoch: 22,now: 2024-06-30 18:45:33.071256,epoch time: 1:05:20.162680,used: 1 day, 0:28:43.613668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99719495, 'precision': 0.9980942, 'recall': 0.9945863, 'specificity': 0.9945863, 'f1': 0.99632406, 'auroc': 0.99991107, 'binary_precision': 0.99993134, 'binary_recall': 0.9891962, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9945348}
confusion matrix:
       0      1
0  42322      1
1    159  14558
---- Validation: 
scalar performance:
{'acc': 0.97041297, 'precision': 0.86339134, 'recall': 0.599154, 'specificity': 0.599154, 'f1': 0.65091616, 'auroc': 0.9690436, 'binary_precision': 0.75438595, 'binary_recall': 0.20062208, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.3169533}
confusion matrix:
       0    1
0  18107   42
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.77133363, 'recall': 0.5129931, 'specificity': 0.5129931, 'f1': 0.5150635, 'auroc': 0.9489861, 'binary_precision': 0.5833333, 'binary_recall': 0.026819924, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.05128205}
confusion matrix:
      0  1
0  5992  5
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_23.png
early stop counter: 4
val acc:0.9704129695892334, best validation acc: 0.9767986536026001, corresponding to test acc:                         0.9589325785636902 / 0.9736337661743164
after epoch: 23,now: 2024-06-30 19:50:50.531121,epoch time: 1:05:17.459865,used: 1 day, 1:34:01.073533,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9984046, 'precision': 0.99861395, 'recall': 0.99721825, 'specificity': 0.99721825, 'f1': 0.99791354, 'auroc': 0.99989104, 'binary_precision': 0.9990445, 'binary_recall': 0.99476725, 'binary_specificity': 0.99966925, 'binary_f1_score': 0.9969013}
confusion matrix:
       0      1
0  42311     14
1     77  14638
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.73968685, 'recall': 0.6852912, 'specificity': 0.6852912, 'f1': 0.7086225, 'auroc': 0.94343734, 'binary_precision': 0.5010142, 'binary_recall': 0.38413686, 'binary_specificity': 0.98644555, 'binary_f1_score': 0.43485913}
confusion matrix:
       0    1
0  17903  246
1    396  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95286036, 'precision': 0.55962306, 'recall': 0.51182395, 'specificity': 0.51182395, 'f1': 0.5136383, 'auroc': 0.8827205, 'binary_precision': 0.16, 'binary_recall': 0.03065134, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.05144694}
confusion matrix:
      0   1
0  5955  42
1   253   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_24.png
early stop counter: 5
val acc:0.9658365249633789, best validation acc: 0.9767986536026001, corresponding to test acc:                         0.9589325785636902 / 0.9736337661743164
after epoch: 24,now: 2024-06-30 20:55:59.733809,epoch time: 1:05:09.202688,used: 1 day, 2:39:10.276221,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9988955, 'precision': 0.99921215, 'recall': 0.99790365, 'specificity': 0.99790365, 'f1': 0.99855566, 'auroc': 0.99996674, 'binary_precision': 0.99986356, 'binary_recall': 0.99585456, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.997855}
confusion matrix:
       0      1
0  42323      2
1     61  14654
---- Validation: 
scalar performance:
{'acc': 0.97376543, 'precision': 0.8892381, 'recall': 0.65339345, 'specificity': 0.65339345, 'f1': 0.71662664, 'auroc': 0.96947813, 'binary_precision': 0.80241936, 'binary_recall': 0.30948678, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.4466891}
confusion matrix:
       0    1
0  18100   49
1    444  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.5506887, 'recall': 0.5028309, 'specificity': 0.5028309, 'f1': 0.4962034, 'auroc': 0.9548079, 'binary_precision': 0.14285715, 'binary_recall': 0.007662835, 'binary_specificity': 0.997999, 'binary_f1_score': 0.014545455}
confusion matrix:
      0   1
0  5985  12
1   259   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_25.png
early stop counter: 6
val acc:0.9737654328346252, best validation acc: 0.9767986536026001, corresponding to test acc:                         0.9589325785636902 / 0.9736337661743164
after epoch: 25,now: 2024-06-30 22:01:18.314698,epoch time: 1:05:18.580889,used: 1 day, 3:44:28.857110,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9989656, 'precision': 0.99928164, 'recall': 0.99801755, 'specificity': 0.99801755, 'f1': 0.9986475, 'auroc': 0.9999709, 'binary_precision': 0.9999318, 'binary_recall': 0.9960587, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9979915}
confusion matrix:
       0      1
0  42323      1
1     58  14658
---- Validation: 
scalar performance:
{'acc': 0.96871006, 'precision': 0.9228906, 'recall': 0.54951876, 'specificity': 0.54951876, 'f1': 0.58141106, 'auroc': 0.9691334, 'binary_precision': 0.8767123, 'binary_recall': 0.09953344, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.17877094}
confusion matrix:
       0   1
0  18140   9
1    579  64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.9542779, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_26.png
early stop counter: 7
val acc:0.9687100648880005, best validation acc: 0.9767986536026001, corresponding to test acc:                         0.9589325785636902 / 0.9736337661743164
after epoch: 26,now: 2024-06-30 23:07:30.107920,epoch time: 1:06:11.793222,used: 1 day, 4:50:40.650332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9972475, 'precision': 0.99812955, 'recall': 0.9946871, 'specificity': 0.9946871, 'f1': 0.9963927, 'auroc': 0.99994075, 'binary_precision': 0.99993134, 'binary_recall': 0.9893978, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9946367}
confusion matrix:
       0      1
0  42325      1
1    156  14558
---- Validation: 
scalar performance:
{'acc': 0.97046614, 'precision': 0.92198205, 'recall': 0.5796801, 'specificity': 0.5796801, 'f1': 0.62781215, 'auroc': 0.969556, 'binary_precision': 0.87288135, 'binary_recall': 0.16018662, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.27069646}
confusion matrix:
       0    1
0  18134   15
1    540  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.6458833, 'recall': 0.501749, 'specificity': 0.501749, 'f1': 0.49309576, 'auroc': 0.95660746, 'binary_precision': 0.33333334, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5995  2
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_27.png
early stop counter: 8
val acc:0.970466136932373, best validation acc: 0.9767986536026001, corresponding to test acc:                         0.9589325785636902 / 0.9736337661743164
after epoch: 27,now: 2024-07-01 00:13:28.370747,epoch time: 1:05:58.262827,used: 1 day, 5:56:38.913159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99852735, 'precision': 0.9989873, 'recall': 0.99716735, 'specificity': 0.99716735, 'f1': 0.998073, 'auroc': 0.9999528, 'binary_precision': 0.99993163, 'binary_recall': 0.99435836, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9971372}
confusion matrix:
       0      1
0  42327      1
1     83  14629
---- Validation: 
scalar performance:
{'acc': 0.9713176, 'precision': 0.9359072, 'recall': 0.59062165, 'specificity': 0.59062165, 'f1': 0.6440372, 'auroc': 0.9674634, 'binary_precision': 0.9, 'binary_recall': 0.18195957, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.30271673}
confusion matrix:
       0    1
0  18136   13
1    526  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.5417, 'recall': 0.5013321, 'specificity': 0.5013321, 'f1': 0.4928169, 'auroc': 0.9248662, 'binary_precision': 0.125, 'binary_recall': 0.0038314175, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.007434944}
confusion matrix:
      0  1
0  5990  7
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_28.png
early stop counter: 9
val acc:0.9713175892829895, best validation acc: 0.9767986536026001, corresponding to test acc:                         0.9589325785636902 / 0.9736337661743164
after epoch: 28,now: 2024-07-01 01:18:35.912457,epoch time: 1:05:07.541710,used: 1 day, 7:01:46.454869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99873775, 'precision': 0.99912846, 'recall': 0.9975759, 'specificity': 0.9975759, 'f1': 0.998349, 'auroc': 0.9999677, 'binary_precision': 0.9999317, 'binary_recall': 0.9951753, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99754786}
confusion matrix:
       0      1
0  42323      1
1     71  14645
---- Validation: 
scalar performance:
{'acc': 0.9698276, 'precision': 0.90800726, 'recall': 0.5718489, 'specificity': 0.5718489, 'f1': 0.61580867, 'auroc': 0.9682573, 'binary_precision': 0.8454546, 'binary_recall': 0.14463453, 'binary_specificity': 0.9990633, 'binary_f1_score': 0.24701196}
confusion matrix:
       0   1
0  18132  17
1    550  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.6612483, 'recall': 0.50707924, 'specificity': 0.50707924, 'f1': 0.5039251, 'auroc': 0.9491056, 'binary_precision': 0.36363637, 'binary_recall': 0.01532567, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.029411763}
confusion matrix:
      0  1
0  5990  7
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_29.png
early stop counter: 10
val acc:0.9698275923728943, best validation acc: 0.9767986536026001, corresponding to test acc:                         0.9589325785636902 / 0.9736337661743164
after epoch: 29,now: 2024-07-01 02:23:43.370717,epoch time: 1:05:07.458260,used: 1 day, 8:06:53.913129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99872017, 'precision': 0.99904954, 'recall': 0.99760866, 'specificity': 0.99760866, 'f1': 0.9983264, 'auroc': 0.99996793, 'binary_precision': 0.999727, 'binary_recall': 0.99531186, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99751455}
confusion matrix:
       0      1
0  42318      4
1     69  14649
---- Validation: 
scalar performance:
{'acc': 0.9742976, 'precision': 0.9415789, 'recall': 0.6379178, 'specificity': 0.6379178, 'f1': 0.705585, 'auroc': 0.9617034, 'binary_precision': 0.90816325, 'binary_recall': 0.27682737, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.42431462}
confusion matrix:
       0    1
0  18131   18
1    465  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292932, 'recall': 0.5036647, 'specificity': 0.5036647, 'f1': 0.496895, 'auroc': 0.94654113, 'binary_precision': 0.5, 'binary_recall': 0.007662835, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.015094339}
confusion matrix:
      0  1
0  5995  2
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_30.png
early stop counter: 11
val acc:0.9742975831031799, best validation acc: 0.9767986536026001, corresponding to test acc:                         0.9589325785636902 / 0.9736337661743164
after epoch: 30,now: 2024-07-01 03:28:47.495555,epoch time: 1:05:04.124838,used: 1 day, 9:11:58.037967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_18_16_49_seed_0_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 1 day, 9:11:58.037967 at 2024-07-01 03:28:47.495555
persisted model performance metric: 

scalar performance:
{'acc': 0.9589326, 'precision': 0.8130804, 'recall': 0.5149922, 'specificity': 0.5149922, 'f1': 0.51880825, 'auroc': 0.9595944, 'binary_precision': 0.6666667, 'binary_recall': 0.03065134, 'binary_specificity': 0.999333, 'binary_f1_score': 0.058608055}
confusion matrix:
      0  1
0  5993  4
1   253  8
oracle model performance metric: 

scalar performance:
{'acc': 0.97363377, 'precision': 0.8629637, 'recall': 0.77552474, 'specificity': 0.77552474, 'f1': 0.8126335, 'auroc': 0.9354039, 'binary_precision': 0.74489796, 'binary_recall': 0.55938697, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.63894963}
confusion matrix:
      0    1
0  5947   50
1   115  146
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 369706 KiB |   6461 MiB |   4448 TiB |   4448 TiB |
|       from large pool | 337847 KiB |   6431 MiB |   4396 TiB |   4396 TiB |
|       from small pool |  31859 KiB |     51 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 369706 KiB |   6461 MiB |   4448 TiB |   4448 TiB |
|       from large pool | 337847 KiB |   6431 MiB |   4396 TiB |   4396 TiB |
|       from small pool |  31859 KiB |     51 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362641 KiB |   6456 MiB |   4445 TiB |   4445 TiB |
|       from large pool | 331790 KiB |   6427 MiB |   4394 TiB |   4394 TiB |
|       from small pool |  30851 KiB |     50 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7074 MiB |   7074 MiB |   7074 MiB |      0 B   |
|       from large pool |   7016 MiB |   7016 MiB |   7016 MiB |      0 B   |
|       from small pool |     58 MiB |     58 MiB |     58 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 302037 KiB | 651631 KiB |   2660 TiB |   2660 TiB |
|       from large pool | 292937 KiB | 644424 KiB |   2608 TiB |   2608 TiB |
|       from small pool |   9100 KiB |  10672 KiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3317    |    7944    |  622010 K  |  622007 K  |
|       from large pool |     151    |     722    |  413630 K  |  413630 K  |
|       from small pool |    3166    |    7792    |  208380 K  |  208377 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3317    |    7944    |  622010 K  |  622007 K  |
|       from large pool |     151    |     722    |  413630 K  |  413630 K  |
|       from small pool |    3166    |    7792    |  208380 K  |  208377 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     322    |     322    |     322    |       0    |
|       from large pool |     293    |     293    |     293    |       0    |
|       from small pool |      29    |      29    |      29    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      61    |    3608    |  375364 K  |  375364 K  |
|       from large pool |      31    |     296    |  290652 K  |  290652 K  |
|       from small pool |      30    |    3577    |   84712 K  |   84712 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6461 MiB |   4448 TiB |   4448 TiB |
|       from large pool |  16640 KiB |   6431 MiB |   4396 TiB |   4396 TiB |
|       from small pool |      0 KiB |     51 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6461 MiB |   4448 TiB |   4448 TiB |
|       from large pool |  16640 KiB |   6431 MiB |   4396 TiB |   4396 TiB |
|       from small pool |      0 KiB |     51 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6456 MiB |   4445 TiB |   4445 TiB |
|       from large pool |  16640 KiB |   6427 MiB |   4394 TiB |   4394 TiB |
|       from small pool |      0 KiB |     50 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 671744 KiB |   7074 MiB |   7074 MiB |   6418 MiB |
|       from large pool | 630784 KiB |   7016 MiB |   7016 MiB |   6400 MiB |
|       from small pool |  40960 KiB |     58 MiB |     58 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 651631 KiB |   2660 TiB |   2660 TiB |
|       from large pool |  24320 KiB | 644424 KiB |   2608 TiB |   2608 TiB |
|       from small pool |      0 KiB |  24437 KiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7944    |  622010 K  |  622010 K  |
|       from large pool |       2    |     722    |  413630 K  |  413630 K  |
|       from small pool |       0    |    7792    |  208380 K  |  208380 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7944    |  622010 K  |  622010 K  |
|       from large pool |       2    |     722    |  413630 K  |  413630 K  |
|       from small pool |       0    |    7792    |  208380 K  |  208380 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |     322    |     322    |     273    |
|       from large pool |      29    |     293    |     293    |     264    |
|       from small pool |      20    |      29    |      29    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3608    |  375366 K  |  375366 K  |
|       from large pool |       3    |     296    |  290652 K  |  290652 K  |
|       from small pool |       0    |    3577    |   84713 K  |   84713 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6461 MiB |   4448 TiB |   4448 TiB |
|       from large pool |  16640 KiB |   6431 MiB |   4396 TiB |   4396 TiB |
|       from small pool |      0 KiB |     51 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6461 MiB |   4448 TiB |   4448 TiB |
|       from large pool |  16640 KiB |   6431 MiB |   4396 TiB |   4396 TiB |
|       from small pool |      0 KiB |     51 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6456 MiB |   4445 TiB |   4445 TiB |
|       from large pool |  16640 KiB |   6427 MiB |   4394 TiB |   4394 TiB |
|       from small pool |      0 KiB |     50 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 671744 KiB |   7074 MiB |   7074 MiB |   6418 MiB |
|       from large pool | 630784 KiB |   7016 MiB |   7016 MiB |   6400 MiB |
|       from small pool |  40960 KiB |     58 MiB |     58 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 651631 KiB |   2660 TiB |   2660 TiB |
|       from large pool |  24320 KiB | 644424 KiB |   2608 TiB |   2608 TiB |
|       from small pool |      0 KiB |  24437 KiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7944    |  622010 K  |  622010 K  |
|       from large pool |       2    |     722    |  413630 K  |  413630 K  |
|       from small pool |       0    |    7792    |  208380 K  |  208380 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7944    |  622010 K  |  622010 K  |
|       from large pool |       2    |     722    |  413630 K  |  413630 K  |
|       from small pool |       0    |    7792    |  208380 K  |  208380 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      49    |     322    |     322    |     273    |
|       from large pool |      29    |     293    |     293    |     264    |
|       from small pool |      20    |      29    |      29    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3608    |  375366 K  |  375366 K  |
|       from large pool |       3    |     296    |  290652 K  |  290652 K  |
|       from small pool |       0    |    3577    |   84713 K  |   84713 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_35_09_seed_1_21628984

 Experiment start at: 2024-07-01 03:35:09.196744
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98912585, 'precision': 0.9927942, 'recall': 0.9785928, 'specificity': 0.9785928, 'f1': 0.98543465, 'auroc': 0.9993888, 'binary_precision': 0.9999276, 'binary_recall': 0.9572092, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.97810215}
confusion matrix:
       0      1
0  42412      1
1    617  13802
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.9405956, 'recall': 0.5318358, 'specificity': 0.5318358, 'f1': 0.55109876, 'auroc': 0.94263387, 'binary_precision': 0.9148936, 'binary_recall': 0.06389301, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.11944444}
confusion matrix:
       0   1
0  18063   4
1    630  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.9336035, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-01 04:39:48.894921,epoch time: 1:04:39.698177,used: 1:04:39.698177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_35_09_seed_1_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99484444, 'precision': 0.9949964, 'recall': 0.9913733, 'specificity': 0.9913733, 'f1': 0.99316794, 'auroc': 0.9993943, 'binary_precision': 0.99530154, 'binary_recall': 0.98432624, 'binary_specificity': 0.9984203, 'binary_f1_score': 0.98978347}
confusion matrix:
       0      1
0  42346     67
1    226  14193
---- Validation: 
scalar performance:
{'acc': 0.9686233, 'precision': 0.7894436, 'recall': 0.68188447, 'specificity': 0.68188447, 'f1': 0.7221961, 'auroc': 0.94243276, 'binary_precision': 0.60191846, 'binary_recall': 0.3729569, 'binary_specificity': 0.990812, 'binary_f1_score': 0.46055046}
confusion matrix:
       0    1
0  17901  166
1    422  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96825653, 'precision': 0.84867656, 'recall': 0.6928743, 'specificity': 0.6928743, 'f1': 0.7461633, 'auroc': 0.9390892, 'binary_precision': 0.7234042, 'binary_recall': 0.3923077, 'binary_specificity': 0.993441, 'binary_f1_score': 0.5087282}
confusion matrix:
      0    1
0  5907   39
1   158  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-01 05:44:42.338758,epoch time: 1:04:53.443837,used: 2:09:33.142014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_35_09_seed_1_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9960058, 'precision': 0.9950524, 'recall': 0.9943946, 'specificity': 0.9943946, 'f1': 0.99472296, 'auroc': 0.9995955, 'binary_precision': 0.99312073, 'binary_recall': 0.99112344, 'binary_specificity': 0.99766576, 'binary_f1_score': 0.9921211}
confusion matrix:
       0      1
0  42313     99
1    128  14292
---- Validation: 
scalar performance:
{'acc': 0.9692636, 'precision': 0.77210265, 'recall': 0.8581723, 'specificity': 0.8581723, 'f1': 0.80854046, 'auroc': 0.9643264, 'binary_precision': 0.5540691, 'binary_recall': 0.7384844, 'binary_specificity': 0.9778602, 'binary_f1_score': 0.633121}
confusion matrix:
       0    1
0  17667  400
1    176  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.972446, 'precision': 0.8532088, 'recall': 0.7704592, 'specificity': 0.7704592, 'f1': 0.8057585, 'auroc': 0.9383695, 'binary_precision': 0.7258883, 'binary_recall': 0.55, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.6258206}
confusion matrix:
      0    1
0  5892   54
1   117  143
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-01 06:49:32.088648,epoch time: 1:04:49.749890,used: 3:14:22.891904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_35_09_seed_1_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99604094, 'precision': 0.99726725, 'recall': 0.9922883, 'specificity': 0.9922883, 'f1': 0.99474597, 'auroc': 0.99981093, 'binary_precision': 0.9997183, 'binary_recall': 0.9846709, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9921375}
confusion matrix:
       0      1
0  42411      4
1    221  14196
---- Validation: 
scalar performance:
{'acc': 0.97620064, 'precision': 0.86998194, 'recall': 0.7444662, 'specificity': 0.7444662, 'f1': 0.79332864, 'auroc': 0.9684103, 'binary_precision': 0.7585421, 'binary_recall': 0.4947994, 'binary_specificity': 0.99413294, 'binary_f1_score': 0.5989208}
confusion matrix:
       0    1
0  17961  106
1    340  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.83657503, 'recall': 0.5094472, 'specificity': 0.5094472, 'f1': 0.5081461, 'auroc': 0.9583264, 'binary_precision': 0.71428573, 'binary_recall': 0.01923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.037453186}
confusion matrix:
      0  1
0  5944  2
1   255  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_4.png
better model found
persisted
after epoch: 4,now: 2024-07-01 07:55:10.039738,epoch time: 1:05:37.951090,used: 4:20:00.842994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_35_09_seed_1_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9963225, 'precision': 0.9961766, 'recall': 0.994103, 'specificity': 0.994103, 'f1': 0.99513423, 'auroc': 0.9994759, 'binary_precision': 0.9958822, 'binary_recall': 0.9895971, 'binary_specificity': 0.99860895, 'binary_f1_score': 0.99272966}
confusion matrix:
       0      1
0  42354     59
1    150  14269
---- Validation: 
scalar performance:
{'acc': 0.9740662, 'precision': 0.8222579, 'recall': 0.7805531, 'specificity': 0.7805531, 'f1': 0.7998204, 'auroc': 0.9526719, 'binary_precision': 0.6603774, 'binary_recall': 0.57206535, 'binary_specificity': 0.9890408, 'binary_f1_score': 0.6130573}
confusion matrix:
       0    1
0  17869  198
1    288  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.8628533, 'recall': 0.5550124, 'specificity': 0.5550124, 'f1': 0.58740956, 'auroc': 0.9323847, 'binary_precision': 0.7631579, 'binary_recall': 0.11153846, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.19463088}
confusion matrix:
      0   1
0  5937   9
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_5.png
early stop counter: 1
val acc:0.9740661978721619, best validation acc: 0.9762006402015686, corresponding to test acc:                         0.9585884809494019 / 0.9724460244178772
after epoch: 5,now: 2024-07-01 09:00:44.036354,epoch time: 1:05:33.996616,used: 5:25:34.839610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_35_09_seed_1_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99630487, 'precision': 0.9973954, 'recall': 0.9928538, 'specificity': 0.9928538, 'f1': 0.9950981, 'auroc': 0.99982727, 'binary_precision': 0.999578, 'binary_recall': 0.9858491, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.992666}
confusion matrix:
       0      1
0  42410      6
1    204  14212
---- Validation: 
scalar performance:
{'acc': 0.97171825, 'precision': 0.9109292, 'recall': 0.628414, 'specificity': 0.628414, 'f1': 0.69093764, 'auroc': 0.95622456, 'binary_precision': 0.8487805, 'binary_recall': 0.25854382, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.39635533}
confusion matrix:
       0    1
0  18036   31
1    499  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6457897, 'recall': 0.5017549, 'specificity': 0.5017549, 'f1': 0.49306068, 'auroc': 0.9103565, 'binary_precision': 0.33333334, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5944  2
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_6.png
early stop counter: 2
val acc:0.9717182517051697, best validation acc: 0.9762006402015686, corresponding to test acc:                         0.9585884809494019 / 0.9724460244178772
after epoch: 6,now: 2024-07-01 10:06:15.929151,epoch time: 1:05:31.892797,used: 6:31:06.732407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_35_09_seed_1_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9943166, 'precision': 0.9961971, 'recall': 0.9888216, 'specificity': 0.9888216, 'f1': 0.9924396, 'auroc': 0.9997998, 'binary_precision': 0.9999291, 'binary_recall': 0.9776668, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9886727}
confusion matrix:
       0      1
0  42413      1
1    322  14096
---- Validation: 
scalar performance:
{'acc': 0.97203845, 'precision': 0.89684916, 'recall': 0.64073956, 'specificity': 0.64073956, 'f1': 0.7036532, 'auroc': 0.9616213, 'binary_precision': 0.8197425, 'binary_recall': 0.28380385, 'binary_specificity': 0.9976753, 'binary_f1_score': 0.42163354}
confusion matrix:
       0    1
0  18025   42
1    482  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.47903565, 'recall': 0.49957955, 'specificity': 0.49957955, 'f1': 0.489092, 'auroc': 0.9095693, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5941  5
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_7.png
early stop counter: 3
val acc:0.9720384478569031, best validation acc: 0.9762006402015686, corresponding to test acc:                         0.9585884809494019 / 0.9724460244178772
after epoch: 7,now: 2024-07-01 11:12:12.676330,epoch time: 1:05:56.747179,used: 7:37:03.479586,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_35_09_seed_1_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99721986, 'precision': 0.9976552, 'recall': 0.9950018, 'specificity': 0.9950018, 'f1': 0.9963195, 'auroc': 0.9997802, 'binary_precision': 0.99853176, 'binary_recall': 0.99049866, 'binary_specificity': 0.99950486, 'binary_f1_score': 0.994499}
confusion matrix:
       0      1
0  42392     21
1    137  14282
---- Validation: 
scalar performance:
{'acc': 0.9681964, 'precision': 0.7732326, 'recall': 0.7410302, 'specificity': 0.7410302, 'f1': 0.7560121, 'auroc': 0.9497131, 'binary_precision': 0.5651438, 'binary_recall': 0.4962853, 'binary_specificity': 0.9857752, 'binary_f1_score': 0.528481}
confusion matrix:
       0    1
0  17810  257
1    339  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.6946556, 'recall': 0.53259724, 'specificity': 0.53259724, 'f1': 0.54862005, 'auroc': 0.91937083, 'binary_precision': 0.42857143, 'binary_recall': 0.06923077, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.1192053}
confusion matrix:
      0   1
0  5922  24
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_8.png
early stop counter: 4
val acc:0.9681963920593262, best validation acc: 0.9762006402015686, corresponding to test acc:                         0.9585884809494019 / 0.9724460244178772
after epoch: 8,now: 2024-07-01 12:18:14.743178,epoch time: 1:06:02.066848,used: 8:43:05.546434,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_35_09_seed_1_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9974838, 'precision': 0.9978781, 'recall': 0.9954758, 'specificity': 0.9954758, 'f1': 0.99666953, 'auroc': 0.99985373, 'binary_precision': 0.99867254, 'binary_recall': 0.99139965, 'binary_specificity': 0.999552, 'binary_f1_score': 0.9950228}
confusion matrix:
       0      1
0  42395     19
1    124  14294
---- Validation: 
scalar performance:
{'acc': 0.9757204, 'precision': 0.8231216, 'recall': 0.83004916, 'specificity': 0.83004916, 'f1': 0.8265449, 'auroc': 0.9679321, 'binary_precision': 0.6584302, 'binary_recall': 0.6731055, 'binary_specificity': 0.98699284, 'binary_f1_score': 0.66568696}
confusion matrix:
       0    1
0  17832  235
1    220  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7395098, 'recall': 0.55901575, 'specificity': 0.55901575, 'f1': 0.5887089, 'auroc': 0.95088255, 'binary_precision': 0.516129, 'binary_recall': 0.12307692, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.19875775}
confusion matrix:
      0   1
0  5916  30
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_9.png
early stop counter: 5
val acc:0.9757204055786133, best validation acc: 0.9762006402015686, corresponding to test acc:                         0.9585884809494019 / 0.9724460244178772
after epoch: 9,now: 2024-07-01 13:24:31.986720,epoch time: 1:06:17.243542,used: 9:49:22.789976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_35_09_seed_1_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99750143, 'precision': 0.9970636, 'recall': 0.99633455, 'specificity': 0.99633455, 'f1': 0.9966984, 'auroc': 0.99990773, 'binary_precision': 0.99617684, 'binary_recall': 0.99396586, 'binary_specificity': 0.99870324, 'binary_f1_score': 0.9950701}
confusion matrix:
       0      1
0  42359     55
1     87  14331
---- Validation: 
scalar performance:
{'acc': 0.9683031, 'precision': 0.7986865, 'recall': 0.6452398, 'specificity': 0.6452398, 'f1': 0.6930671, 'auroc': 0.9451406, 'binary_precision': 0.62305295, 'binary_recall': 0.2971768, 'binary_specificity': 0.9933027, 'binary_f1_score': 0.40241444}
confusion matrix:
       0    1
0  17946  121
1    473  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95568806, 'precision': 0.5662546, 'recall': 0.50609463, 'specificity': 0.50609463, 'f1': 0.50279784, 'auroc': 0.89338434, 'binary_precision': 0.17391305, 'binary_recall': 0.015384615, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.028268553}
confusion matrix:
      0   1
0  5927  19
1   256   4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_10.png
early stop counter: 6
val acc:0.9683030843734741, best validation acc: 0.9762006402015686, corresponding to test acc:                         0.9585884809494019 / 0.9724460244178772
after epoch: 10,now: 2024-07-01 14:29:45.219409,epoch time: 1:05:13.232689,used: 10:54:36.022665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_35_09_seed_1_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99815243, 'precision': 0.99834883, 'recall': 0.996771, 'specificity': 0.996771, 'f1': 0.9975567, 'auroc': 0.9999187, 'binary_precision': 0.9987456, 'binary_recall': 0.9939663, 'binary_specificity': 0.9995756, 'binary_f1_score': 0.9963502}
confusion matrix:
       0      1
0  42395     18
1     87  14332
---- Validation: 
scalar performance:
{'acc': 0.97486657, 'precision': 0.8304157, 'recall': 0.7823987, 'specificity': 0.7823987, 'f1': 0.8043442, 'auroc': 0.96577704, 'binary_precision': 0.67657346, 'binary_recall': 0.5750371, 'binary_specificity': 0.98976034, 'binary_f1_score': 0.6216868}
confusion matrix:
       0    1
0  17882  185
1    286  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95149857, 'precision': 0.6931809, 'recall': 0.676773, 'specificity': 0.676773, 'f1': 0.68455195, 'auroc': 0.91620964, 'binary_precision': 0.4135021, 'binary_recall': 0.37692308, 'binary_specificity': 0.97662294, 'binary_f1_score': 0.3943662}
confusion matrix:
      0    1
0  5807  139
1   162   98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_11.png
early stop counter: 7
val acc:0.9748665690422058, best validation acc: 0.9762006402015686, corresponding to test acc:                         0.9585884809494019 / 0.9724460244178772
after epoch: 11,now: 2024-07-01 15:35:17.427126,epoch time: 1:05:32.207717,used: 12:00:08.230382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_35_09_seed_1_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9974662, 'precision': 0.99775076, 'recall': 0.9955562, 'specificity': 0.9955562, 'f1': 0.9966473, 'auroc': 0.999793, 'binary_precision': 0.9983245, 'binary_recall': 0.99167824, 'binary_specificity': 0.9994341, 'binary_f1_score': 0.9949903}
confusion matrix:
       0      1
0  42388     24
1    120  14300
---- Validation: 
scalar performance:
{'acc': 0.97113127, 'precision': 0.7826532, 'recall': 0.8677241, 'specificity': 0.8677241, 'f1': 0.81896096, 'auroc': 0.964592, 'binary_precision': 0.5744921, 'binary_recall': 0.756315, 'binary_specificity': 0.97913325, 'binary_f1_score': 0.6529827}
confusion matrix:
       0    1
0  17690  377
1    164  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.79972875, 'recall': 0.6311677, 'specificity': 0.6311677, 'f1': 0.67908704, 'auroc': 0.9264929, 'binary_precision': 0.6306306, 'binary_recall': 0.26923078, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.3773585}
confusion matrix:
      0   1
0  5905  41
1   190  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628984_12.png
early stop counter: 8
val acc:0.9711312651634216, best validation acc: 0.9762006402015686, corresponding to test acc:                         0.9585884809494019 / 0.9724460244178772
after epoch: 12,now: 2024-07-01 16:40:48.052914,epoch time: 1:05:30.625788,used: 13:05:38.856170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_35_09_seed_1_21628984
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9979413, 'precision': 0.9986012, 'recall': 0.9959657, 'specificity': 0.9959657, 'f1': 0.9972745, 'auroc': 0.99988306, 'binary_precision': 0.9999301, 'binary_recall': 0.99195504, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99592656}
confusion matrix:
       0      1
0  42412      1
1    116  14303
---- Validation: 
slurmstepd: error: *** JOB 21628984 ON gpusrv45 CANCELLED AT 2024-07-01T18:12:11 DUE TO TIME LIMIT ***
