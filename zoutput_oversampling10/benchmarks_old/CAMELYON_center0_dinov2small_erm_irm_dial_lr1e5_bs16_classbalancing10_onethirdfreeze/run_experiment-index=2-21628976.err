Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jun 29 17:37:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976

 Experiment start at: 2024-06-29 17:44:37.883231
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9920407, 'precision': 0.99144804, 'recall': 0.9877224, 'specificity': 0.9877224, 'f1': 0.9895667, 'auroc': 0.9991922, 'binary_precision': 0.99023855, 'binary_recall': 0.9788, 'binary_specificity': 0.99664485, 'binary_f1_score': 0.9844861}
confusion matrix:
       0      1
0  42181    142
1    312  14405
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96094084, 'precision': 0.72256696, 'recall': 0.8447685, 'specificity': 0.8447685, 'f1': 0.76869965, 'auroc': 0.9534403, 'binary_precision': 0.45526057, 'binary_recall': 0.7200622, 'binary_specificity': 0.9694749, 'binary_f1_score': 0.5578313}
confusion matrix:
       0    1
0  17595  554
1    180  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93783957, 'precision': 0.6814958, 'recall': 0.8411361, 'specificity': 0.8411361, 'f1': 0.73181987, 'auroc': 0.92017996, 'binary_precision': 0.375, 'binary_recall': 0.7356322, 'binary_specificity': 0.94664, 'binary_f1_score': 0.49676585}
confusion matrix:
      0    1
0  5677  320
1    69  192
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-29 18:07:52.623501,epoch time: 0:23:14.740270,used: 0:23:14.740270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99509114, 'precision': 0.9960499, 'recall': 0.9911299, 'specificity': 0.9911299, 'f1': 0.9935579, 'auroc': 0.9995973, 'binary_precision': 0.9979993, 'binary_recall': 0.9829449, 'binary_specificity': 0.9993148, 'binary_f1_score': 0.9904149}
confusion matrix:
       0      1
0  42294     29
1    251  14466
---- Validation: 
scalar performance:
{'acc': 0.94939333, 'precision': 0.67363477, 'recall': 0.7915368, 'specificity': 0.7915368, 'f1': 0.715171, 'auroc': 0.93616, 'binary_precision': 0.36101082, 'binary_recall': 0.62208396, 'binary_specificity': 0.9609896, 'binary_f1_score': 0.45688173}
confusion matrix:
       0    1
0  17441  708
1    243  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.868009, 'precision': 0.58234036, 'recall': 0.75156355, 'specificity': 0.75156355, 'f1': 0.6051502, 'auroc': 0.8585813, 'binary_precision': 0.18294051, 'binary_recall': 0.6245211, 'binary_specificity': 0.87860596, 'binary_f1_score': 0.2829861}
confusion matrix:
      0    1
0  5269  728
1    98  163
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_2.png
early stop counter: 1
val acc:0.9493933320045471, best validation acc: 0.9609408378601074, corresponding to test acc:                         0.9378395676612854 / 0.9378395676612854
after epoch: 2,now: 2024-06-29 18:30:29.434652,epoch time: 0:22:36.811151,used: 0:45:51.551421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99417955, 'precision': 0.9933325, 'recall': 0.99144626, 'specificity': 0.99144626, 'f1': 0.9923846, 'auroc': 0.99957275, 'binary_precision': 0.9915932, 'binary_recall': 0.9857987, 'binary_specificity': 0.9970938, 'binary_f1_score': 0.98868746}
confusion matrix:
       0      1
0  42200    123
1    209  14508
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.77603555, 'recall': 0.671888, 'specificity': 0.671888, 'f1': 0.71069986, 'auroc': 0.953977, 'binary_precision': 0.57468355, 'binary_recall': 0.35303265, 'binary_specificity': 0.9907433, 'binary_f1_score': 0.43737957}
confusion matrix:
       0    1
0  17981  168
1    416  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.66707385, 'recall': 0.5106605, 'specificity': 0.5106605, 'f1': 0.5108346, 'auroc': 0.9453967, 'binary_precision': 0.375, 'binary_recall': 0.022988506, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0433213}
confusion matrix:
      0   1
0  5987  10
1   255   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-29 18:52:52.521310,epoch time: 0:22:23.086658,used: 1:08:14.638079,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99512625, 'precision': 0.991939, 'recall': 0.9954082, 'specificity': 0.9954082, 'f1': 0.9936573, 'auroc': 0.999815, 'binary_precision': 0.9852773, 'binary_recall': 0.9959905, 'binary_specificity': 0.9948258, 'binary_f1_score': 0.99060494}
confusion matrix:
       0      1
0  42106    219
1     59  14656
---- Validation: 
scalar performance:
{'acc': 0.9562048, 'precision': 0.7061029, 'recall': 0.8565677, 'specificity': 0.8565677, 'f1': 0.75823045, 'auroc': 0.9538141, 'binary_precision': 0.42132866, 'binary_recall': 0.7496112, 'binary_specificity': 0.96352416, 'binary_f1_score': 0.53945154}
confusion matrix:
       0    1
0  17487  662
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9042825, 'precision': 0.6116052, 'recall': 0.761328, 'specificity': 0.761328, 'f1': 0.6468609, 'auroc': 0.90538293, 'binary_precision': 0.24159022, 'binary_recall': 0.60536397, 'binary_specificity': 0.917292, 'binary_f1_score': 0.34535518}
confusion matrix:
      0    1
0  5501  496
1   103  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_4.png
early stop counter: 1
val acc:0.9562047719955444, best validation acc: 0.9689229726791382, corresponding to test acc:                         0.9576541781425476 / 0.9576541781425476
after epoch: 4,now: 2024-06-29 19:15:20.317033,epoch time: 0:22:27.795723,used: 1:30:42.433802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99454767, 'precision': 0.9961448, 'recall': 0.9896327, 'specificity': 0.9896327, 'f1': 0.9928328, 'auroc': 0.99977505, 'binary_precision': 0.999376, 'binary_recall': 0.9794781, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.989327}
confusion matrix:
       0      1
0  42315      9
1    302  14414
---- Validation: 
scalar performance:
{'acc': 0.96897614, 'precision': 0.9133106, 'recall': 0.55565697, 'specificity': 0.55565697, 'f1': 0.59112823, 'auroc': 0.9578813, 'binary_precision': 0.85714287, 'binary_recall': 0.11197512, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.19807428}
confusion matrix:
       0   1
0  18137  12
1    571  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.72958696, 'recall': 0.510994, 'specificity': 0.510994, 'f1': 0.51131886, 'auroc': 0.9594922, 'binary_precision': 0.5, 'binary_recall': 0.022988506, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.043956045}
confusion matrix:
      0  1
0  5991  6
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-29 19:37:42.132663,epoch time: 0:22:21.815630,used: 1:53:04.249432,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9959502, 'precision': 0.99683005, 'recall': 0.9925957, 'specificity': 0.9925957, 'f1': 0.99468917, 'auroc': 0.9997659, 'binary_precision': 0.99862325, 'binary_recall': 0.98566383, 'binary_specificity': 0.99952745, 'binary_f1_score': 0.99210125}
confusion matrix:
       0      1
0  42302     20
1    211  14507
---- Validation: 
scalar performance:
{'acc': 0.97094506, 'precision': 0.91550624, 'recall': 0.5896787, 'specificity': 0.5896787, 'f1': 0.641683, 'auroc': 0.9667616, 'binary_precision': 0.85925925, 'binary_recall': 0.18040435, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.29820052}
confusion matrix:
       0    1
0  18130   19
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.9383205, 'recall': 0.5209894, 'specificity': 0.5209894, 'f1': 0.5300423, 'auroc': 0.9547187, 'binary_precision': 0.9166667, 'binary_recall': 0.042145595, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.08058608}
confusion matrix:
      0   1
0  5996   1
1   250  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-29 20:00:12.770779,epoch time: 0:22:30.638116,used: 2:15:34.887548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9939516, 'precision': 0.9957019, 'recall': 0.98852336, 'specificity': 0.98852336, 'f1': 0.99204457, 'auroc': 0.9995886, 'binary_precision': 0.99923587, 'binary_recall': 0.9773067, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.98814964}
confusion matrix:
       0      1
0  42311     11
1    334  14384
---- Validation: 
scalar performance:
{'acc': 0.9731269, 'precision': 0.8687539, 'recall': 0.65456295, 'specificity': 0.65456295, 'f1': 0.7147253, 'auroc': 0.9567528, 'binary_precision': 0.7613636, 'binary_recall': 0.31259722, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.44321945}
confusion matrix:
       0    1
0  18086   63
1    442  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.88892126, 'recall': 0.51707464, 'specificity': 0.51707464, 'f1': 0.5227158, 'auroc': 0.94530714, 'binary_precision': 0.8181818, 'binary_recall': 0.03448276, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.06617647}
confusion matrix:
      0  1
0  5995  2
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_7.png
better model found
persisted
after epoch: 7,now: 2024-06-29 20:22:23.228872,epoch time: 0:22:10.458093,used: 2:37:45.345641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99652874, 'precision': 0.9970828, 'recall': 0.9938493, 'specificity': 0.9938493, 'f1': 0.9954523, 'auroc': 0.9995797, 'binary_precision': 0.9982156, 'binary_recall': 0.98831284, 'binary_specificity': 0.99938565, 'binary_f1_score': 0.9932396}
confusion matrix:
       0      1
0  42297     26
1    172  14545
---- Validation: 
scalar performance:
{'acc': 0.97498935, 'precision': 0.9269592, 'recall': 0.65552723, 'specificity': 0.65552723, 'f1': 0.7241034, 'auroc': 0.9627705, 'binary_precision': 0.87772924, 'binary_recall': 0.31259722, 'binary_specificity': 0.9984572, 'binary_f1_score': 0.46100917}
confusion matrix:
       0    1
0  18121   28
1    442  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.93522215, 'recall': 0.53814745, 'specificity': 0.53814745, 'f1': 0.5607392, 'auroc': 0.9594323, 'binary_precision': 0.90909094, 'binary_recall': 0.07662835, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.14134276}
confusion matrix:
      0   1
0  5995   2
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-29 20:44:35.899415,epoch time: 0:22:12.670543,used: 2:59:58.016184,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9965112, 'precision': 0.9970261, 'recall': 0.9938608, 'specificity': 0.9938608, 'f1': 0.99543023, 'auroc': 0.9997487, 'binary_precision': 0.9980792, 'binary_recall': 0.9883832, 'binary_specificity': 0.9993384, 'binary_f1_score': 0.9932075}
confusion matrix:
       0      1
0  42292     28
1    171  14549
---- Validation: 
scalar performance:
{'acc': 0.96934867, 'precision': 0.80033445, 'recall': 0.626355, 'specificity': 0.626355, 'f1': 0.6749668, 'auroc': 0.9391302, 'binary_precision': 0.6264151, 'binary_recall': 0.25816485, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.36563876}
confusion matrix:
       0    1
0  18050   99
1    477  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94678813, 'precision': 0.53399426, 'recall': 0.51232034, 'specificity': 0.51232034, 'f1': 0.51463956, 'auroc': 0.87420195, 'binary_precision': 0.10869565, 'binary_recall': 0.038314175, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.05665722}
confusion matrix:
      0   1
0  5915  82
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_9.png
early stop counter: 1
val acc:0.969348669052124, best validation acc: 0.9749893546104431, corresponding to test acc:                         0.9611697196960449 / 0.9611697196960449
after epoch: 9,now: 2024-06-29 21:06:36.055948,epoch time: 0:22:00.156533,used: 3:21:58.172717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99624825, 'precision': 0.9960668, 'recall': 0.99412626, 'specificity': 0.99412626, 'f1': 0.99509156, 'auroc': 0.9995674, 'binary_precision': 0.9956941, 'binary_recall': 0.98974115, 'binary_specificity': 0.9985114, 'binary_f1_score': 0.9927087}
confusion matrix:
       0      1
0  42258     63
1    151  14568
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.75156903, 'recall': 0.7189548, 'specificity': 0.7189548, 'f1': 0.73400724, 'auroc': 0.9473507, 'binary_precision': 0.5224416, 'binary_recall': 0.4525661, 'binary_specificity': 0.9853435, 'binary_f1_score': 0.48499998}
confusion matrix:
       0    1
0  17883  266
1    352  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9432726, 'precision': 0.5863195, 'recall': 0.5544621, 'specificity': 0.5544621, 'f1': 0.56570035, 'auroc': 0.87480974, 'binary_precision': 0.20987654, 'binary_recall': 0.1302682, 'binary_specificity': 0.978656, 'binary_f1_score': 0.1607565}
confusion matrix:
      0    1
0  5869  128
1   227   34
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_10.png
early stop counter: 2
val acc:0.9671136736869812, best validation acc: 0.9749893546104431, corresponding to test acc:                         0.9611697196960449 / 0.9611697196960449
after epoch: 10,now: 2024-06-29 21:28:55.519703,epoch time: 0:22:19.463755,used: 3:44:17.636472,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9959502, 'precision': 0.99649096, 'recall': 0.99292666, 'specificity': 0.99292666, 'f1': 0.99469197, 'auroc': 0.99974346, 'binary_precision': 0.9975952, 'binary_recall': 0.98668027, 'binary_specificity': 0.99917305, 'binary_f1_score': 0.9921077}
confusion matrix:
       0      1
0  42290     35
1    196  14519
---- Validation: 
scalar performance:
{'acc': 0.9743508, 'precision': 0.8601444, 'recall': 0.6896992, 'specificity': 0.6896992, 'f1': 0.7464905, 'auroc': 0.9610213, 'binary_precision': 0.7417417, 'binary_recall': 0.38413686, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.5061475}
confusion matrix:
       0    1
0  18063   86
1    396  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542985, 'precision': 0.5772135, 'recall': 0.5125743, 'specificity': 0.5125743, 'f1': 0.5147822, 'auroc': 0.9363398, 'binary_precision': 0.19512194, 'binary_recall': 0.03065134, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.05298013}
confusion matrix:
      0   1
0  5964  33
1   253   8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_11.png
early stop counter: 3
val acc:0.9743508100509644, best validation acc: 0.9749893546104431, corresponding to test acc:                         0.9611697196960449 / 0.9611697196960449
after epoch: 11,now: 2024-06-29 21:51:23.527042,epoch time: 0:22:28.007339,used: 4:06:45.643811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9976332, 'precision': 0.997493, 'recall': 0.99632245, 'specificity': 0.99632245, 'f1': 0.9969059, 'auroc': 0.9998553, 'binary_precision': 0.9972044, 'binary_recall': 0.9936137, 'binary_specificity': 0.9990312, 'binary_f1_score': 0.99540585}
confusion matrix:
       0      1
0  42280     41
1     94  14625
---- Validation: 
scalar performance:
{'acc': 0.9741911, 'precision': 0.8271085, 'recall': 0.73536986, 'specificity': 0.73536986, 'f1': 0.77309877, 'auroc': 0.95875335, 'binary_precision': 0.6724891, 'binary_recall': 0.47900465, 'binary_specificity': 0.9917351, 'binary_f1_score': 0.55949134}
confusion matrix:
       0    1
0  17999  150
1    335  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7260873, 'recall': 0.545725, 'specificity': 0.545725, 'f1': 0.56939405, 'auroc': 0.9252214, 'binary_precision': 0.49019608, 'binary_recall': 0.09578544, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.16025642}
confusion matrix:
      0   1
0  5971  26
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_12.png
early stop counter: 4
val acc:0.9741911292076111, best validation acc: 0.9749893546104431, corresponding to test acc:                         0.9611697196960449 / 0.9611697196960449
after epoch: 12,now: 2024-06-29 22:14:04.229715,epoch time: 0:22:40.702673,used: 4:29:26.346484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99693197, 'precision': 0.99546266, 'recall': 0.9965366, 'specificity': 0.9965366, 'f1': 0.995998, 'auroc': 0.9998646, 'binary_precision': 0.99241555, 'binary_recall': 0.99571955, 'binary_specificity': 0.9973536, 'binary_f1_score': 0.9940648}
confusion matrix:
       0      1
0  42210    112
1     63  14655
---- Validation: 
scalar performance:
{'acc': 0.97722435, 'precision': 0.83607906, 'recall': 0.8036951, 'specificity': 0.8036951, 'f1': 0.81899196, 'auroc': 0.96404815, 'binary_precision': 0.68566495, 'binary_recall': 0.61741835, 'binary_specificity': 0.9899719, 'binary_f1_score': 0.64975446}
confusion matrix:
       0    1
0  17967  182
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7287141, 'recall': 0.5695453, 'specificity': 0.5695453, 'f1': 0.6016689, 'auroc': 0.9233947, 'binary_precision': 0.4935065, 'binary_recall': 0.14559387, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.22485207}
confusion matrix:
      0   1
0  5958  39
1   223  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_13.png
better model found
persisted
after epoch: 13,now: 2024-06-29 22:36:39.644177,epoch time: 0:22:35.414462,used: 4:52:01.760946,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99616057, 'precision': 0.9972891, 'recall': 0.9926926, 'specificity': 0.9926926, 'f1': 0.994963, 'auroc': 0.99975955, 'binary_precision': 0.99958646, 'binary_recall': 0.9855269, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.99250686}
confusion matrix:
       0      1
0  42317      6
1    213  14504
---- Validation: 
scalar performance:
{'acc': 0.97195613, 'precision': 0.88195676, 'recall': 0.6217045, 'specificity': 0.6217045, 'f1': 0.68025404, 'auroc': 0.96274835, 'binary_precision': 0.79, 'binary_recall': 0.24572317, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.37485173}
confusion matrix:
       0    1
0  18107   42
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.81489533, 'recall': 0.55996865, 'specificity': 0.55996865, 'f1': 0.59352463, 'auroc': 0.9479647, 'binary_precision': 0.6666667, 'binary_recall': 0.12260536, 'binary_specificity': 0.997332, 'binary_f1_score': 0.20711973}
confusion matrix:
      0   1
0  5981  16
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_14.png
early stop counter: 1
val acc:0.9719561338424683, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9611697196960449
after epoch: 14,now: 2024-06-29 22:59:07.867336,epoch time: 0:22:28.223159,used: 5:14:29.984105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99614304, 'precision': 0.9973004, 'recall': 0.9926345, 'specificity': 0.9926345, 'f1': 0.99493873, 'auroc': 0.99993753, 'binary_precision': 0.99965525, 'binary_recall': 0.9853871, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9924699}
confusion matrix:
       0      1
0  42322      5
1    215  14498
---- Validation: 
scalar performance:
{'acc': 0.97094506, 'precision': 0.939456, 'recall': 0.58367825, 'specificity': 0.58367825, 'f1': 0.6343182, 'auroc': 0.96325606, 'binary_precision': 0.90756303, 'binary_recall': 0.16796267, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.28346452}
confusion matrix:
       0    1
0  18138   11
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.95810115, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_15.png
early stop counter: 2
val acc:0.9709450602531433, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9611697196960449
after epoch: 15,now: 2024-06-29 23:21:42.950632,epoch time: 0:22:35.083296,used: 5:37:05.067401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9978436, 'precision': 0.9973048, 'recall': 0.9970623, 'specificity': 0.9970623, 'f1': 0.99718344, 'auroc': 0.9998697, 'binary_precision': 0.9961923, 'binary_recall': 0.99544775, 'binary_specificity': 0.99867684, 'binary_f1_score': 0.99581987}
confusion matrix:
       0      1
0  42266     56
1     67  14651
---- Validation: 
scalar performance:
{'acc': 0.96259046, 'precision': 0.72884315, 'recall': 0.8343718, 'specificity': 0.8343718, 'f1': 0.7704072, 'auroc': 0.9508492, 'binary_precision': 0.46861926, 'binary_recall': 0.6967341, 'binary_specificity': 0.9720095, 'binary_f1_score': 0.56035024}
confusion matrix:
       0    1
0  17641  508
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.8080291, 'recall': 0.8136684, 'specificity': 0.8136684, 'f1': 0.81082, 'auroc': 0.95626616, 'binary_precision': 0.6315789, 'binary_recall': 0.6436782, 'binary_specificity': 0.9836585, 'binary_f1_score': 0.63757116}
confusion matrix:
      0    1
0  5899   98
1    93  168
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_16.png
new oracle model saved
early stop counter: 3
val acc:0.9625904560089111, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 16,now: 2024-06-29 23:44:13.637288,epoch time: 0:22:30.686656,used: 5:59:35.754057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99693197, 'precision': 0.99600387, 'recall': 0.99598193, 'specificity': 0.99598193, 'f1': 0.9959929, 'auroc': 0.999871, 'binary_precision': 0.99408686, 'binary_recall': 0.9940193, 'binary_specificity': 0.99794453, 'binary_f1_score': 0.99405307}
confusion matrix:
       0      1
0  42239     87
1     88  14626
---- Validation: 
scalar performance:
{'acc': 0.9756811, 'precision': 0.8387896, 'recall': 0.7541426, 'specificity': 0.7541426, 'f1': 0.78989756, 'auroc': 0.96822864, 'binary_precision': 0.69456065, 'binary_recall': 0.5163297, 'binary_specificity': 0.99195546, 'binary_f1_score': 0.5923283}
confusion matrix:
       0    1
0  18003  146
1    311  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.850662, 'recall': 0.6093602, 'specificity': 0.6093602, 'f1': 0.6613898, 'auroc': 0.95926577, 'binary_precision': 0.73417723, 'binary_recall': 0.22222222, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.34117648}
confusion matrix:
      0   1
0  5976  21
1   203  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_17.png
early stop counter: 4
val acc:0.9756811261177063, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 17,now: 2024-06-30 00:06:59.603334,epoch time: 0:22:45.966046,used: 6:22:21.720103,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.996669, 'precision': 0.99765176, 'recall': 0.99365526, 'specificity': 0.99365526, 'f1': 0.99563247, 'auroc': 0.9998369, 'binary_precision': 0.999656, 'binary_recall': 0.98742867, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99350476}
confusion matrix:
       0      1
0  42319      5
1    185  14531
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.9306522, 'recall': 0.5634881, 'specificity': 0.5634881, 'f1': 0.6038168, 'auroc': 0.96290267, 'binary_precision': 0.8913044, 'binary_recall': 0.12752722, 'binary_specificity': 0.999449, 'binary_f1_score': 0.22312926}
confusion matrix:
       0   1
0  18139  10
1    561  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7798174, 'recall': 0.5167411, 'specificity': 0.5167411, 'f1': 0.5220695, 'auroc': 0.93069077, 'binary_precision': 0.6, 'binary_recall': 0.03448276, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.06521738}
confusion matrix:
      0  1
0  5991  6
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_18.png
early stop counter: 5
val acc:0.9696147441864014, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 18,now: 2024-06-30 00:29:27.064239,epoch time: 0:22:27.460905,used: 6:44:49.181008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9976332, 'precision': 0.99778175, 'recall': 0.9960335, 'specificity': 0.9960335, 'f1': 0.9969036, 'auroc': 0.99993765, 'binary_precision': 0.9980869, 'binary_recall': 0.99272853, 'binary_specificity': 0.99933845, 'binary_f1_score': 0.99540055}
confusion matrix:
       0      1
0  42297     28
1    107  14608
---- Validation: 
scalar performance:
{'acc': 0.97333974, 'precision': 0.9364641, 'recall': 0.6239209, 'specificity': 0.6239209, 'f1': 0.68807036, 'auroc': 0.9699609, 'binary_precision': 0.8988764, 'binary_recall': 0.2488336, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.38976857}
confusion matrix:
       0    1
0  18131   18
1    483  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9550245, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_19.png
early stop counter: 6
val acc:0.9733397364616394, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 19,now: 2024-06-30 00:51:50.335600,epoch time: 0:22:23.271361,used: 7:07:12.452369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9973352, 'precision': 0.99816555, 'recall': 0.9948795, 'specificity': 0.9948795, 'f1': 0.99650824, 'auroc': 0.99993885, 'binary_precision': 0.99986273, 'binary_recall': 0.9898063, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99480903}
confusion matrix:
       0      1
0  42323      2
1    150  14565
---- Validation: 
scalar performance:
{'acc': 0.97184974, 'precision': 0.9314492, 'recall': 0.60064787, 'specificity': 0.60064787, 'f1': 0.65757704, 'auroc': 0.969744, 'binary_precision': 0.89041096, 'binary_recall': 0.2021773, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.32953104}
confusion matrix:
       0    1
0  18133   16
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.97983676, 'recall': 0.51724136, 'specificity': 0.51724136, 'f1': 0.5230443, 'auroc': 0.9529184, 'binary_precision': 1.0, 'binary_recall': 0.03448276, 'binary_specificity': 1.0, 'binary_f1_score': 0.06666667}
confusion matrix:
      0  1
0  5997  0
1   252  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_20.png
early stop counter: 7
val acc:0.9718497395515442, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 20,now: 2024-06-30 01:14:13.824380,epoch time: 0:22:23.488780,used: 7:29:35.941149,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9978962, 'precision': 0.99836147, 'recall': 0.99614465, 'specificity': 0.99614465, 'f1': 0.99724656, 'auroc': 0.9999485, 'binary_precision': 0.99931586, 'binary_recall': 0.99252564, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.99590915}
confusion matrix:
       0      1
0  42313     10
1    110  14607
---- Validation: 
scalar performance:
{'acc': 0.9748829, 'precision': 0.9170663, 'recall': 0.6584723, 'specificity': 0.6584723, 'f1': 0.72599614, 'auroc': 0.9704746, 'binary_precision': 0.8577406, 'binary_recall': 0.31881803, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.4648526}
confusion matrix:
       0    1
0  18115   34
1    438  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7874361, 'recall': 0.5149088, 'specificity': 0.5149088, 'f1': 0.5186596, 'auroc': 0.95598423, 'binary_precision': 0.61538464, 'binary_recall': 0.03065134, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.058394164}
confusion matrix:
      0  1
0  5992  5
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_21.png
early stop counter: 8
val acc:0.9748829007148743, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 21,now: 2024-06-30 01:36:41.046421,epoch time: 0:22:27.222041,used: 7:52:03.163190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9976683, 'precision': 0.9982308, 'recall': 0.99568117, 'specificity': 0.99568117, 'f1': 0.9969474, 'auroc': 0.9998864, 'binary_precision': 0.9993837, 'binary_recall': 0.99157494, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.99546397}
confusion matrix:
       0      1
0  42313      9
1    124  14594
---- Validation: 
scalar performance:
{'acc': 0.9710515, 'precision': 0.8480079, 'recall': 0.6234863, 'specificity': 0.6234863, 'f1': 0.67850447, 'auroc': 0.9644976, 'binary_precision': 0.7219731, 'binary_recall': 0.2503888, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.3718245}
confusion matrix:
       0    1
0  18087   62
1    482  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.5626603, 'recall': 0.5044965, 'specificity': 0.5044965, 'f1': 0.49959797, 'auroc': 0.952431, 'binary_precision': 0.16666667, 'binary_recall': 0.011494253, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.021505376}
confusion matrix:
      0   1
0  5982  15
1   258   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_22.png
early stop counter: 9
val acc:0.9710515141487122, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 22,now: 2024-06-30 01:59:00.542912,epoch time: 0:22:19.496491,used: 8:14:22.659681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99635345, 'precision': 0.9944831, 'recall': 0.9960135, 'specificity': 0.9960135, 'f1': 0.9952452, 'auroc': 0.99982834, 'binary_precision': 0.9905992, 'binary_recall': 0.9953112, 'binary_specificity': 0.9967158, 'binary_f1_score': 0.99294966}
confusion matrix:
       0      1
0  42185    139
1     69  14647
---- Validation: 
scalar performance:
{'acc': 0.9593976, 'precision': 0.7111762, 'recall': 0.8012165, 'specificity': 0.8012165, 'f1': 0.7471832, 'auroc': 0.9487598, 'binary_precision': 0.4356223, 'binary_recall': 0.63141525, 'binary_specificity': 0.97101766, 'binary_f1_score': 0.51555556}
confusion matrix:
       0    1
0  17623  526
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88095236, 'precision': 0.5499294, 'recall': 0.6172272, 'specificity': 0.6172272, 'f1': 0.56166923, 'auroc': 0.82298493, 'binary_precision': 0.13109756, 'binary_recall': 0.32950193, 'binary_specificity': 0.90495247, 'binary_f1_score': 0.18756816}
confusion matrix:
      0    1
0  5427  570
1   175   86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_23.png
early stop counter: 10
val acc:0.9593976140022278, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 23,now: 2024-06-30 02:21:19.323038,epoch time: 0:22:18.780126,used: 8:36:41.439807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9975281, 'precision': 0.9980692, 'recall': 0.9954758, 'specificity': 0.9954758, 'f1': 0.99676365, 'auroc': 0.9998734, 'binary_precision': 0.9991781, 'binary_recall': 0.9912352, 'binary_specificity': 0.99971646, 'binary_f1_score': 0.9951908}
confusion matrix:
       0      1
0  42310     12
1    129  14589
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.76018417, 'recall': 0.73825717, 'specificity': 0.73825717, 'f1': 0.7486859, 'auroc': 0.9380397, 'binary_precision': 0.5383305, 'binary_recall': 0.49144635, 'binary_specificity': 0.985068, 'binary_f1_score': 0.5138211}
confusion matrix:
       0    1
0  17878  271
1    327  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94503033, 'precision': 0.5880842, 'recall': 0.54988223, 'specificity': 0.54988223, 'f1': 0.56215155, 'auroc': 0.8695911, 'binary_precision': 0.2137931, 'binary_recall': 0.118773945, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.15270936}
confusion matrix:
      0    1
0  5883  114
1   230   31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_24.png
early stop counter: 11
val acc:0.9681779742240906, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 24,now: 2024-06-30 02:43:35.366803,epoch time: 0:22:16.043765,used: 8:58:57.483572,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99654627, 'precision': 0.9953482, 'recall': 0.99563354, 'specificity': 0.99563354, 'f1': 0.9954908, 'auroc': 0.9998437, 'binary_precision': 0.99287075, 'binary_recall': 0.9937479, 'binary_specificity': 0.9975192, 'binary_f1_score': 0.99330914}
confusion matrix:
       0      1
0  42220    105
1     92  14623
---- Validation: 
scalar performance:
{'acc': 0.95077693, 'precision': 0.672353, 'recall': 0.7652511, 'specificity': 0.7652511, 'f1': 0.7073338, 'auroc': 0.9283011, 'binary_precision': 0.36039603, 'binary_recall': 0.5660964, 'binary_specificity': 0.9644058, 'binary_f1_score': 0.44041136}
confusion matrix:
       0    1
0  17503  646
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9474273, 'precision': 0.6802395, 'recall': 0.70321655, 'specificity': 0.70321655, 'f1': 0.6909125, 'auroc': 0.8988832, 'binary_precision': 0.38513514, 'binary_recall': 0.43678162, 'binary_specificity': 0.9696515, 'binary_f1_score': 0.40933573}
confusion matrix:
      0    1
0  5815  182
1   147  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_25.png
early stop counter: 12
val acc:0.9507769346237183, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 25,now: 2024-06-30 03:05:43.195095,epoch time: 0:22:07.828292,used: 9:21:05.311864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99831694, 'precision': 0.99862194, 'recall': 0.99698204, 'specificity': 0.99698204, 'f1': 0.99779844, 'auroc': 0.999885, 'binary_precision': 0.99924874, 'binary_recall': 0.99422395, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.99673}
confusion matrix:
       0      1
0  42313     11
1     85  14631
---- Validation: 
scalar performance:
{'acc': 0.97243506, 'precision': 0.88130397, 'recall': 0.63170314, 'specificity': 0.63170314, 'f1': 0.6917846, 'auroc': 0.962026, 'binary_precision': 0.7880184, 'binary_recall': 0.2659409, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.39767438}
confusion matrix:
       0    1
0  18103   46
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.68000966, 'recall': 0.5214878, 'specificity': 0.5214878, 'f1': 0.5303168, 'auroc': 0.9258422, 'binary_precision': 0.4, 'binary_recall': 0.04597701, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.082474224}
confusion matrix:
      0   1
0  5979  18
1   249  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_26.png
early stop counter: 13
val acc:0.9724350571632385, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 26,now: 2024-06-30 03:27:47.289697,epoch time: 0:22:04.094602,used: 9:43:09.406466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99803644, 'precision': 0.9983885, 'recall': 0.99648297, 'specificity': 0.99648297, 'f1': 0.9974309, 'auroc': 0.99993646, 'binary_precision': 0.9991115, 'binary_recall': 0.9932731, 'binary_specificity': 0.99969286, 'binary_f1_score': 0.9961837}
confusion matrix:
       0      1
0  42310     13
1     99  14618
---- Validation: 
scalar performance:
{'acc': 0.97451043, 'precision': 0.8599932, 'recall': 0.69353205, 'specificity': 0.69353205, 'f1': 0.7498145, 'auroc': 0.9696128, 'binary_precision': 0.7411765, 'binary_recall': 0.3919129, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.5127162}
confusion matrix:
       0    1
0  18061   88
1    391  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.68966216, 'recall': 0.5539695, 'specificity': 0.5539695, 'f1': 0.578886, 'auroc': 0.9486501, 'binary_precision': 0.41666666, 'binary_recall': 0.11494253, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.18018018}
confusion matrix:
      0   1
0  5955  42
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_27.png
early stop counter: 14
val acc:0.9745104312896729, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 27,now: 2024-06-30 03:50:04.839292,epoch time: 0:22:17.549595,used: 10:05:26.956061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9981241, 'precision': 0.9982021, 'recall': 0.9968964, 'specificity': 0.9968964, 'f1': 0.99754703, 'auroc': 0.9998865, 'binary_precision': 0.99836254, 'binary_recall': 0.99435985, 'binary_specificity': 0.9994329, 'binary_f1_score': 0.9963572}
confusion matrix:
       0      1
0  42300     24
1     83  14633
---- Validation: 
scalar performance:
{'acc': 0.97169006, 'precision': 0.7862656, 'recall': 0.7828286, 'specificity': 0.7828286, 'f1': 0.7845357, 'auroc': 0.9589778, 'binary_precision': 0.58740157, 'binary_recall': 0.5800933, 'binary_specificity': 0.98556393, 'binary_f1_score': 0.58372456}
confusion matrix:
       0    1
0  17887  262
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9434324, 'precision': 0.6284803, 'recall': 0.6095155, 'specificity': 0.6095155, 'f1': 0.6180718, 'auroc': 0.9173274, 'binary_precision': 0.28959277, 'binary_recall': 0.24521072, 'binary_specificity': 0.97382027, 'binary_f1_score': 0.26556015}
confusion matrix:
      0    1
0  5840  157
1   197   64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_28.png
early stop counter: 15
val acc:0.9716900587081909, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 28,now: 2024-06-30 04:12:30.709513,epoch time: 0:22:25.870221,used: 10:27:52.826282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9974229, 'precision': 0.9959067, 'recall': 0.9973766, 'specificity': 0.9973766, 'f1': 0.9966388, 'auroc': 0.99995506, 'binary_precision': 0.99276, 'binary_recall': 0.99728113, 'binary_specificity': 0.9974721, 'binary_f1_score': 0.99501544}
confusion matrix:
       0      1
0  42221    107
1     40  14672
---- Validation: 
scalar performance:
{'acc': 0.92933166, 'precision': 0.6496715, 'recall': 0.88465816, 'specificity': 0.88465816, 'f1': 0.70491934, 'auroc': 0.9546815, 'binary_precision': 0.30550823, 'binary_recall': 0.83670294, 'binary_specificity': 0.9326134, 'binary_f1_score': 0.44758734}
confusion matrix:
       0     1
0  16926  1223
1    105   538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84659636, 'precision': 0.51995987, 'recall': 0.5571579, 'specificity': 0.5571579, 'f1': 0.5160163, 'auroc': 0.7867457, 'binary_precision': 0.07636364, 'binary_recall': 0.2413793, 'binary_specificity': 0.8729365, 'binary_f1_score': 0.1160221}
confusion matrix:
      0    1
0  5235  762
1   198   63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_29.png
early stop counter: 16
val acc:0.9293316602706909, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 29,now: 2024-06-30 04:34:56.697215,epoch time: 0:22:25.987702,used: 10:50:18.813984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99596775, 'precision': 0.9935565, 'recall': 0.9959532, 'specificity': 0.9959532, 'f1': 0.99474716, 'auroc': 0.9998772, 'binary_precision': 0.98853445, 'binary_recall': 0.9959231, 'binary_specificity': 0.99598324, 'binary_f1_score': 0.99221504}
confusion matrix:
       0      1
0  42153    170
1     60  14657
---- Validation: 
scalar performance:
{'acc': 0.9636015, 'precision': 0.7364967, 'recall': 0.87989855, 'specificity': 0.87989855, 'f1': 0.7892928, 'auroc': 0.9620928, 'binary_precision': 0.48060548, 'binary_recall': 0.79004663, 'binary_specificity': 0.9697504, 'binary_f1_score': 0.5976471}
confusion matrix:
       0    1
0  17600  549
1    135  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547779, 'precision': 0.69151974, 'recall': 0.5989441, 'specificity': 0.5989441, 'f1': 0.62827706, 'auroc': 0.9239869, 'binary_precision': 0.41666666, 'binary_recall': 0.21072797, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.27989823}
confusion matrix:
      0   1
0  5920  77
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_30.png
early stop counter: 17
val acc:0.9636015295982361, best validation acc: 0.9772243499755859, corresponding to test acc:                         0.9581335783004761 / 0.9694790840148926
after epoch: 30,now: 2024-06-30 04:57:22.607952,epoch time: 0:22:25.910737,used: 11:12:44.724721,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_17_44_37_seed_0_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:12:44.724721 at 2024-06-30 04:57:22.607952
persisted model performance metric: 

scalar performance:
{'acc': 0.9581336, 'precision': 0.7287141, 'recall': 0.5695453, 'specificity': 0.5695453, 'f1': 0.6016689, 'auroc': 0.9233947, 'binary_precision': 0.4935065, 'binary_recall': 0.14559387, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.22485207}
confusion matrix:
      0   1
0  5958  39
1   223  38
oracle model performance metric: 

scalar performance:
{'acc': 0.9694791, 'precision': 0.8080291, 'recall': 0.8136684, 'specificity': 0.8136684, 'f1': 0.81082, 'auroc': 0.95626616, 'binary_precision': 0.6315789, 'binary_recall': 0.6436782, 'binary_specificity': 0.9836585, 'binary_f1_score': 0.63757116}
confusion matrix:
      0    1
0  5899   98
1    93  168
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 369815 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool | 337956 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |  31859 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 369815 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool | 337956 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |  31859 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362641 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |  30851 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10022 MiB |  10022 MiB |  10022 MiB |      0 B   |
|       from large pool |   9962 MiB |   9962 MiB |   9962 MiB |      0 B   |
|       from small pool |     60 MiB |     60 MiB |     60 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 359272 KiB |    876 MiB |    880 TiB |    880 TiB |
|       from large pool | 350172 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |   9100 KiB |     11 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3317    |    7964    |  221733 K  |  221730 K  |
|       from large pool |     151    |     986    |  113526 K  |  113526 K  |
|       from small pool |    3166    |    7811    |  108207 K  |  108204 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3317    |    7964    |  221733 K  |  221730 K  |
|       from large pool |     151    |     986    |  113526 K  |  113526 K  |
|       from small pool |    3166    |    7811    |  108207 K  |  108204 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     445    |     445    |     445    |       0    |
|       from large pool |     415    |     415    |     415    |       0    |
|       from small pool |      30    |      30    |      30    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      67    |    3614    |  140745 K  |  140745 K  |
|       from large pool |      32    |     417    |   88579 K  |   88579 K  |
|       from small pool |      35    |    3583    |   52166 K  |   52166 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |      0 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 729088 KiB |  10022 MiB |  10022 MiB |   9310 MiB |
|       from large pool | 688128 KiB |   9962 MiB |   9962 MiB |   9290 MiB |
|       from small pool |  40960 KiB |     60 MiB |     60 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |    880 TiB |    880 TiB |
|       from large pool |  24320 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |      0 KiB |     32 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  221733 K  |  221733 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108207 K  |  108207 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  221733 K  |  221733 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108207 K  |  108207 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |     445    |     445    |     395    |
|       from large pool |      30    |     415    |     415    |     385    |
|       from small pool |      20    |      30    |      30    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3614    |  140747 K  |  140747 K  |
|       from large pool |       3    |     417    |   88579 K  |   88579 K  |
|       from small pool |       0    |    3583    |   52167 K  |   52167 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9129 MiB |   1228 TiB |   1228 TiB |
|       from large pool |  16640 KiB |   9099 MiB |   1212 TiB |   1212 TiB |
|       from small pool |      0 KiB |     51 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   1223 TiB |   1223 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   1207 TiB |   1207 TiB |
|       from small pool |      0 KiB |     50 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 729088 KiB |  10022 MiB |  10022 MiB |   9310 MiB |
|       from large pool | 688128 KiB |   9962 MiB |   9962 MiB |   9290 MiB |
|       from small pool |  40960 KiB |     60 MiB |     60 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |    880 TiB |    880 TiB |
|       from large pool |  24320 KiB |    872 MiB |    864 TiB |    864 TiB |
|       from small pool |      0 KiB |     32 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  221733 K  |  221733 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108207 K  |  108207 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  221733 K  |  221733 K  |
|       from large pool |       2    |     986    |  113526 K  |  113526 K  |
|       from small pool |       0    |    7811    |  108207 K  |  108207 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      50    |     445    |     445    |     395    |
|       from large pool |      30    |     415    |     415    |     385    |
|       from small pool |      20    |      30    |      30    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3614    |  140747 K  |  140747 K  |
|       from large pool |       3    |     417    |   88579 K  |   88579 K  |
|       from small pool |       0    |    3583    |   52167 K  |   52167 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976

 Experiment start at: 2024-06-30 05:04:52.607174
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9905511, 'precision': 0.9920974, 'recall': 0.9829362, 'specificity': 0.9829362, 'f1': 0.9874083, 'auroc': 0.99898374, 'binary_precision': 0.99514943, 'binary_recall': 0.9674757, 'binary_specificity': 0.9983967, 'binary_f1_score': 0.9811175}
confusion matrix:
       0      1
0  42344     68
1    469  13951
---- Validation: 
scalar performance:
{'acc': 0.95400214, 'precision': 0.7020786, 'recall': 0.82879925, 'specificity': 0.82879925, 'f1': 0.747944, 'auroc': 0.9380202, 'binary_precision': 0.4158504, 'binary_recall': 0.69390786, 'binary_specificity': 0.9636907, 'binary_f1_score': 0.5200445}
confusion matrix:
       0    1
0  17411  656
1    206  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9431196, 'precision': 0.69203275, 'recall': 0.82503617, 'specificity': 0.82503617, 'f1': 0.7380575, 'auroc': 0.90856844, 'binary_precision': 0.3978022, 'binary_recall': 0.6961538, 'binary_specificity': 0.9539186, 'binary_f1_score': 0.5062937}
confusion matrix:
      0    1
0  5672  274
1    79  181
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-30 05:27:30.272360,epoch time: 0:22:37.665186,used: 0:22:37.665186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9916244, 'precision': 0.99427986, 'recall': 0.9836542, 'specificity': 0.9836542, 'f1': 0.9888221, 'auroc': 0.9993966, 'binary_precision': 0.9994985, 'binary_recall': 0.96747345, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.9832253}
confusion matrix:
       0      1
0  42406      7
1    469  13950
---- Validation: 
scalar performance:
{'acc': 0.96798295, 'precision': 0.787156, 'recall': 0.6600943, 'specificity': 0.6600943, 'f1': 0.7038589, 'auroc': 0.93404716, 'binary_precision': 0.598916, 'binary_recall': 0.32838038, 'binary_specificity': 0.9918083, 'binary_f1_score': 0.42418423}
confusion matrix:
       0    1
0  17919  148
1    452  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9553658, 'precision': 0.6262279, 'recall': 0.52063835, 'specificity': 0.52063835, 'f1': 0.52843124, 'auroc': 0.9083044, 'binary_precision': 0.29268292, 'binary_recall': 0.046153847, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.07973422}
confusion matrix:
      0   1
0  5917  29
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-30 05:49:36.546088,epoch time: 0:22:06.273728,used: 0:44:43.938914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9925218, 'precision': 0.99470055, 'recall': 0.98558193, 'specificity': 0.98558193, 'f1': 0.99003446, 'auroc': 0.9994253, 'binary_precision': 0.9990015, 'binary_recall': 0.97149396, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.98505574}
confusion matrix:
       0      1
0  42400     14
1    411  14007
---- Validation: 
scalar performance:
{'acc': 0.9692636, 'precision': 0.7864039, 'recall': 0.7244173, 'specificity': 0.7244173, 'f1': 0.7512599, 'auroc': 0.95245355, 'binary_precision': 0.5927342, 'binary_recall': 0.46062407, 'binary_specificity': 0.98821056, 'binary_f1_score': 0.51839465}
confusion matrix:
       0    1
0  17854  213
1    363  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7531314, 'recall': 0.599978, 'specificity': 0.599978, 'f1': 0.6395453, 'auroc': 0.92802525, 'binary_precision': 0.54, 'binary_recall': 0.20769231, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.29999998}
confusion matrix:
      0   1
0  5900  46
1   206  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-30 06:11:46.494581,epoch time: 0:22:09.948493,used: 1:06:53.887407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9947037, 'precision': 0.9960723, 'recall': 0.9899515, 'specificity': 0.9899515, 'f1': 0.9929638, 'auroc': 0.9996549, 'binary_precision': 0.9987987, 'binary_recall': 0.98030376, 'binary_specificity': 0.99959916, 'binary_f1_score': 0.9894648}
confusion matrix:
       0      1
0  42396     17
1    284  14135
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.8927484, 'recall': 0.5464179, 'specificity': 0.5464179, 'f1': 0.5755056, 'auroc': 0.95717645, 'binary_precision': 0.8181818, 'binary_recall': 0.0936107, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.168}
confusion matrix:
       0   1
0  18053  14
1    610  63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.47902548, 'recall': 0.49932727, 'specificity': 0.49932727, 'f1': 0.48896572, 'auroc': 0.9431508, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5938  8
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_4.png
early stop counter: 1
val acc:0.9667022228240967, best validation acc: 0.9692636132240295, corresponding to test acc:                         0.9593941569328308 / 0.9593941569328308
after epoch: 4,now: 2024-06-30 06:34:03.568652,epoch time: 0:22:17.074071,used: 1:29:10.961478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99646324, 'precision': 0.99707973, 'recall': 0.9935793, 'specificity': 0.9935793, 'f1': 0.99531376, 'auroc': 0.9997355, 'binary_precision': 0.99831766, 'binary_recall': 0.98772454, 'binary_specificity': 0.9994341, 'binary_f1_score': 0.9929928}
confusion matrix:
       0      1
0  42389     24
1    177  14242
---- Validation: 
scalar performance:
{'acc': 0.9311099, 'precision': 0.6387667, 'recall': 0.7918924, 'specificity': 0.7918924, 'f1': 0.68219084, 'auroc': 0.92271036, 'binary_precision': 0.29149798, 'binary_recall': 0.6419019, 'binary_specificity': 0.94188297, 'binary_f1_score': 0.40092805}
confusion matrix:
       0     1
0  17017  1050
1    241   432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8823719, 'precision': 0.56897545, 'recall': 0.6719611, 'specificity': 0.6719611, 'f1': 0.58791953, 'auroc': 0.8470923, 'binary_precision': 0.16428572, 'binary_recall': 0.44230768, 'binary_specificity': 0.90161455, 'binary_f1_score': 0.23958334}
confusion matrix:
      0    1
0  5361  585
1   145  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_5.png
early stop counter: 2
val acc:0.9311099052429199, best validation acc: 0.9692636132240295, corresponding to test acc:                         0.9593941569328308 / 0.9593941569328308
after epoch: 5,now: 2024-06-30 06:56:19.570130,epoch time: 0:22:16.001478,used: 1:51:26.962956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99468607, 'precision': 0.9922992, 'recall': 0.99369323, 'specificity': 0.99369323, 'f1': 0.9929937, 'auroc': 0.999688, 'binary_precision': 0.9874318, 'binary_recall': 0.99167764, 'binary_specificity': 0.9957089, 'binary_f1_score': 0.9895502}
confusion matrix:
       0      1
0  42231    182
1    120  14299
---- Validation: 
scalar performance:
{'acc': 0.9546425, 'precision': 0.7100569, 'recall': 0.87347794, 'specificity': 0.87347794, 'f1': 0.76530606, 'auroc': 0.9525872, 'binary_precision': 0.42834008, 'binary_recall': 0.7860327, 'binary_specificity': 0.96092325, 'binary_f1_score': 0.5545073}
confusion matrix:
       0    1
0  17361  706
1    144  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.79372466, 'recall': 0.70941424, 'specificity': 0.70941424, 'f1': 0.7436731, 'auroc': 0.9297662, 'binary_precision': 0.61202186, 'binary_recall': 0.43076923, 'binary_specificity': 0.9880592, 'binary_f1_score': 0.50564337}
confusion matrix:
      0    1
0  5875   71
1   148  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_6.png
new oracle model saved
early stop counter: 3
val acc:0.9546424746513367, best validation acc: 0.9692636132240295, corresponding to test acc:                         0.9593941569328308 / 0.9647115468978882
after epoch: 6,now: 2024-06-30 07:18:37.296013,epoch time: 0:22:17.725883,used: 2:13:44.688839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9953371, 'precision': 0.9936315, 'recall': 0.9940605, 'specificity': 0.9940605, 'f1': 0.99384576, 'auroc': 0.9997294, 'binary_precision': 0.99016416, 'binary_recall': 0.991469, 'binary_specificity': 0.99665207, 'binary_f1_score': 0.9908162}
confusion matrix:
       0      1
0  42272    142
1    123  14295
---- Validation: 
scalar performance:
{'acc': 0.94364995, 'precision': 0.6748774, 'recall': 0.8420273, 'specificity': 0.8420273, 'f1': 0.72653073, 'auroc': 0.9368882, 'binary_precision': 0.36011687, 'binary_recall': 0.73254085, 'binary_specificity': 0.9515138, 'binary_f1_score': 0.48285997}
confusion matrix:
       0    1
0  17191  876
1    180  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93731874, 'precision': 0.67186236, 'recall': 0.7944242, 'specificity': 0.7944242, 'f1': 0.713599, 'auroc': 0.9153993, 'binary_precision': 0.36008677, 'binary_recall': 0.63846153, 'binary_specificity': 0.9503868, 'binary_f1_score': 0.46047157}
confusion matrix:
      0    1
0  5651  295
1    94  166
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_7.png
early stop counter: 4
val acc:0.94364994764328, best validation acc: 0.9692636132240295, corresponding to test acc:                         0.9593941569328308 / 0.9647115468978882
after epoch: 7,now: 2024-06-30 07:40:51.308199,epoch time: 0:22:14.012186,used: 2:35:58.701025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99656886, 'precision': 0.99684876, 'recall': 0.99408495, 'specificity': 0.99408495, 'f1': 0.995457, 'auroc': 0.999714, 'binary_precision': 0.9974122, 'binary_recall': 0.9890422, 'binary_specificity': 0.9991276, 'binary_f1_score': 0.99320954}
confusion matrix:
       0      1
0  42376     37
1    158  14261
---- Validation: 
scalar performance:
{'acc': 0.9745998, 'precision': 0.8329942, 'recall': 0.7686703, 'specificity': 0.7686703, 'f1': 0.7970681, 'auroc': 0.95218635, 'binary_precision': 0.6827458, 'binary_recall': 0.5468053, 'binary_specificity': 0.99053526, 'binary_f1_score': 0.6072607}
confusion matrix:
       0    1
0  17896  171
1    305  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.8989581, 'recall': 0.629592, 'specificity': 0.629592, 'f1': 0.6902969, 'auroc': 0.9588052, 'binary_precision': 0.8292683, 'binary_recall': 0.26153848, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.39766085}
confusion matrix:
      0   1
0  5932  14
1   192  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-30 08:03:05.744856,epoch time: 0:22:14.436657,used: 2:58:13.137682,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9963577, 'precision': 0.994202, 'recall': 0.99620926, 'specificity': 0.99620926, 'f1': 0.9952004, 'auroc': 0.9998466, 'binary_precision': 0.989798, 'binary_recall': 0.9959079, 'binary_specificity': 0.99651057, 'binary_f1_score': 0.99284357}
confusion matrix:
       0      1
0  42266    148
1     59  14359
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.75368464, 'recall': 0.8599774, 'specificity': 0.8599774, 'f1': 0.7964232, 'auroc': 0.95787376, 'binary_precision': 0.5169928, 'binary_recall': 0.7459138, 'binary_specificity': 0.97404104, 'binary_f1_score': 0.6107056}
confusion matrix:
       0    1
0  17598  469
1    171  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93425715, 'precision': 0.6390743, 'recall': 0.69719917, 'specificity': 0.69719917, 'f1': 0.6619219, 'auroc': 0.90214056, 'binary_precision': 0.30319148, 'binary_recall': 0.43846154, 'binary_specificity': 0.9559368, 'binary_f1_score': 0.35849056}
confusion matrix:
      0    1
0  5684  262
1   146  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_9.png
early stop counter: 1
val acc:0.965848445892334, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9668062925338745 / 0.9668062925338745
after epoch: 9,now: 2024-06-30 08:25:18.730170,epoch time: 0:22:12.985314,used: 3:20:26.122996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99426377, 'precision': 0.99618614, 'recall': 0.9886955, 'specificity': 0.9886955, 'f1': 0.9923689, 'auroc': 0.9997164, 'binary_precision': 1.0, 'binary_recall': 0.97739094, 'binary_specificity': 1.0, 'binary_f1_score': 0.98856616}
confusion matrix:
       0      1
0  42413      0
1    326  14093
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.8797916, 'recall': 0.5198657, 'specificity': 0.5198657, 'f1': 0.5293107, 'auroc': 0.95580274, 'binary_precision': 0.7941176, 'binary_recall': 0.04011887, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.07637906}
confusion matrix:
       0   1
0  18060   7
1    646  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.9284133, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_10.png
early stop counter: 2
val acc:0.965154767036438, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9668062925338745 / 0.9668062925338745
after epoch: 10,now: 2024-06-30 08:47:27.810815,epoch time: 0:22:09.080645,used: 3:42:35.203641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99730784, 'precision': 0.9979695, 'recall': 0.994923, 'specificity': 0.994923, 'f1': 0.99643433, 'auroc': 0.9998508, 'binary_precision': 0.99929994, 'binary_recall': 0.99008185, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.9946695}
confusion matrix:
       0      1
0  42404     10
1    143  14275
---- Validation: 
scalar performance:
{'acc': 0.9678762, 'precision': 0.76825464, 'recall': 0.76518327, 'specificity': 0.76518327, 'f1': 0.7667091, 'auroc': 0.95286864, 'binary_precision': 0.55338347, 'binary_recall': 0.5468053, 'binary_specificity': 0.9835612, 'binary_f1_score': 0.55007476}
confusion matrix:
       0    1
0  17770  297
1    305  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9469868, 'precision': 0.67011493, 'recall': 0.6707405, 'specificity': 0.6707405, 'f1': 0.670427, 'auroc': 0.9035133, 'binary_precision': 0.3678161, 'binary_recall': 0.36923078, 'binary_specificity': 0.9722502, 'binary_f1_score': 0.36852208}
confusion matrix:
      0    1
0  5781  165
1   164   96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_11.png
early stop counter: 3
val acc:0.9678761959075928, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9668062925338745 / 0.9668062925338745
after epoch: 11,now: 2024-06-30 09:09:34.606211,epoch time: 0:22:06.795396,used: 4:04:41.999037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99616414, 'precision': 0.9972782, 'recall': 0.99260074, 'specificity': 0.99260074, 'f1': 0.99491143, 'auroc': 0.9997594, 'binary_precision': 0.99950755, 'binary_recall': 0.9853665, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.9923867}
confusion matrix:
       0      1
0  42406      7
1    211  14208
---- Validation: 
scalar performance:
{'acc': 0.97033083, 'precision': 0.80034375, 'recall': 0.71781814, 'specificity': 0.71781814, 'f1': 0.7518623, 'auroc': 0.9570861, 'binary_precision': 0.621118, 'binary_recall': 0.44576523, 'binary_specificity': 0.989871, 'binary_f1_score': 0.51903117}
confusion matrix:
       0    1
0  17884  183
1    373  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9521431, 'precision': 0.59991395, 'recall': 0.52815145, 'specificity': 0.52815145, 'f1': 0.5390675, 'auroc': 0.91148204, 'binary_precision': 0.23943663, 'binary_recall': 0.06538462, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.10271904}
confusion matrix:
      0   1
0  5892  54
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_12.png
early stop counter: 4
val acc:0.9703308343887329, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9668062925338745 / 0.9668062925338745
after epoch: 12,now: 2024-06-30 09:31:29.535483,epoch time: 0:21:54.929272,used: 4:26:36.928309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9949852, 'precision': 0.99226594, 'recall': 0.9945342, 'specificity': 0.9945342, 'f1': 0.9933933, 'auroc': 0.9997585, 'binary_precision': 0.98670614, 'binary_recall': 0.99361867, 'binary_specificity': 0.9954497, 'binary_f1_score': 0.99015033}
confusion matrix:
       0      1
0  42222    193
1     92  14325
---- Validation: 
scalar performance:
{'acc': 0.97492, 'precision': 0.8664435, 'recall': 0.7216287, 'specificity': 0.7216287, 'f1': 0.7747368, 'auroc': 0.9577449, 'binary_precision': 0.7531172, 'binary_recall': 0.448737, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.5623836}
confusion matrix:
       0    1
0  17968   99
1    371  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.91395575, 'recall': 0.5954811, 'specificity': 0.5954811, 'f1': 0.64822, 'auroc': 0.947138, 'binary_precision': 0.86206895, 'binary_recall': 0.1923077, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.31446543}
confusion matrix:
      0   1
0  5938   8
1   210  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_13.png
better model found
persisted
after epoch: 13,now: 2024-06-30 09:53:26.804951,epoch time: 0:21:57.269468,used: 4:48:34.197777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99692076, 'precision': 0.9963753, 'recall': 0.9954879, 'specificity': 0.9954879, 'f1': 0.9959307, 'auroc': 0.9997827, 'binary_precision': 0.9952712, 'binary_recall': 0.9925792, 'binary_specificity': 0.9983967, 'binary_f1_score': 0.9939234}
confusion matrix:
       0      1
0  42345     68
1    107  14312
---- Validation: 
scalar performance:
{'acc': 0.972572, 'precision': 0.8174243, 'recall': 0.7468759, 'specificity': 0.7468759, 'f1': 0.7773137, 'auroc': 0.9523454, 'binary_precision': 0.65317917, 'binary_recall': 0.5037147, 'binary_specificity': 0.9900371, 'binary_f1_score': 0.5687919}
confusion matrix:
       0    1
0  17887  180
1    334  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.72634697, 'recall': 0.67587, 'specificity': 0.67587, 'f1': 0.69748414, 'auroc': 0.93737745, 'binary_precision': 0.48, 'binary_recall': 0.36923078, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.41739133}
confusion matrix:
      0    1
0  5842  104
1   164   96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_14.png
early stop counter: 1
val acc:0.9725720286369324, best validation acc: 0.9749199748039246, corresponding to test acc:                         0.9648727178573608 / 0.9668062925338745
after epoch: 14,now: 2024-06-30 10:15:40.581829,epoch time: 0:22:13.776878,used: 5:10:47.974655,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9970439, 'precision': 0.99760723, 'recall': 0.9945867, 'specificity': 0.9945867, 'f1': 0.9960853, 'auroc': 0.9997494, 'binary_precision': 0.9987402, 'binary_recall': 0.9895978, 'binary_specificity': 0.9995756, 'binary_f1_score': 0.994148}
confusion matrix:
       0      1
0  42394     18
1    150  14270
---- Validation: 
scalar performance:
{'acc': 0.9730523, 'precision': 0.8531082, 'recall': 0.696341, 'specificity': 0.696341, 'f1': 0.75051534, 'auroc': 0.96164584, 'binary_precision': 0.7282609, 'binary_recall': 0.39821693, 'binary_specificity': 0.99446505, 'binary_f1_score': 0.5148895}
confusion matrix:
       0    1
0  17967  100
1    405  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.84631443, 'recall': 0.5662145, 'specificity': 0.5662145, 'f1': 0.6038049, 'auroc': 0.9514195, 'binary_precision': 0.7291667, 'binary_recall': 0.13461539, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.22727273}
confusion matrix:
      0   1
0  5933  13
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_15.png
early stop counter: 2
val acc:0.9730523228645325, best validation acc: 0.9749199748039246, corresponding to test acc:                         0.9648727178573608 / 0.9668062925338745
after epoch: 15,now: 2024-06-30 10:38:04.456134,epoch time: 0:22:23.874305,used: 5:33:11.848960,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9973255, 'precision': 0.9974028, 'recall': 0.9955305, 'specificity': 0.9955305, 'f1': 0.9964621, 'auroc': 0.99977, 'binary_precision': 0.99755895, 'binary_recall': 0.99188626, 'binary_specificity': 0.9991748, 'binary_f1_score': 0.9947145}
confusion matrix:
       0      1
0  42377     35
1    117  14303
---- Validation: 
scalar performance:
{'acc': 0.9692636, 'precision': 0.77155495, 'recall': 0.87104714, 'specificity': 0.87104714, 'f1': 0.81264436, 'auroc': 0.97009933, 'binary_precision': 0.5519829, 'binary_recall': 0.7652303, 'binary_specificity': 0.9768639, 'binary_f1_score': 0.64134496}
confusion matrix:
       0    1
0  17649  418
1    158  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.950854, 'precision': 0.69492304, 'recall': 0.69850445, 'specificity': 0.69850445, 'f1': 0.6966947, 'auroc': 0.9253874, 'binary_precision': 0.41509435, 'binary_recall': 0.42307693, 'binary_specificity': 0.973932, 'binary_f1_score': 0.41904765}
confusion matrix:
      0    1
0  5791  155
1   150  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_16.png
early stop counter: 3
val acc:0.9692636132240295, best validation acc: 0.9749199748039246, corresponding to test acc:                         0.9648727178573608 / 0.9668062925338745
after epoch: 16,now: 2024-06-30 11:00:21.606938,epoch time: 0:22:17.150804,used: 5:55:28.999764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99769497, 'precision': 0.99834394, 'recall': 0.9955721, 'specificity': 0.9955721, 'f1': 0.9969482, 'auroc': 0.99990296, 'binary_precision': 0.9996503, 'binary_recall': 0.99126214, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.9954385}
confusion matrix:
       0      1
0  42407      5
1    126  14294
---- Validation: 
scalar performance:
{'acc': 0.9779082, 'precision': 0.89471155, 'recall': 0.75035864, 'specificity': 0.75035864, 'f1': 0.8050971, 'auroc': 0.96988034, 'binary_precision': 0.807601, 'binary_recall': 0.50520056, 'binary_specificity': 0.9955167, 'binary_f1_score': 0.6215722}
confusion matrix:
       0    1
0  17986   81
1    333  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.80602497, 'recall': 0.54882276, 'specificity': 0.54882276, 'f1': 0.5764289, 'auroc': 0.9307325, 'binary_precision': 0.65, 'binary_recall': 0.1, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.17333333}
confusion matrix:
      0   1
0  5932  14
1   234  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_17.png
better model found
persisted
after epoch: 17,now: 2024-06-30 11:22:54.869014,epoch time: 0:22:33.262076,used: 6:18:02.261840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99765974, 'precision': 0.99762726, 'recall': 0.99618864, 'specificity': 0.99618864, 'f1': 0.9969053, 'auroc': 0.9999106, 'binary_precision': 0.99756163, 'binary_recall': 0.99320245, 'binary_specificity': 0.99917483, 'binary_f1_score': 0.99537724}
confusion matrix:
       0      1
0  42380     35
1     98  14319
---- Validation: 
scalar performance:
{'acc': 0.972572, 'precision': 0.81293315, 'recall': 0.7597507, 'specificity': 0.7597507, 'f1': 0.78362733, 'auroc': 0.95041347, 'binary_precision': 0.64324325, 'binary_recall': 0.5304606, 'binary_specificity': 0.9890408, 'binary_f1_score': 0.5814332}
confusion matrix:
       0    1
0  17869  198
1    316  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.70244914, 'recall': 0.5290874, 'specificity': 0.5290874, 'f1': 0.54315937, 'auroc': 0.91500103, 'binary_precision': 0.44444445, 'binary_recall': 0.06153846, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.1081081}
confusion matrix:
      0   1
0  5926  20
1   244  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_18.png
early stop counter: 1
val acc:0.9725720286369324, best validation acc: 0.977908194065094, corresponding to test acc:                         0.9600386619567871 / 0.9668062925338745
after epoch: 18,now: 2024-06-30 11:45:10.473753,epoch time: 0:22:15.604739,used: 6:40:17.866579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9959882, 'precision': 0.9946134, 'recall': 0.9947945, 'specificity': 0.9947945, 'f1': 0.9947039, 'auroc': 0.99978447, 'binary_precision': 0.9918209, 'binary_recall': 0.9923712, 'binary_specificity': 0.99721783, 'binary_f1_score': 0.99209595}
confusion matrix:
       0      1
0  42295    118
1    110  14309
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.74691236, 'recall': 0.8585426, 'specificity': 0.8585426, 'f1': 0.7910611, 'auroc': 0.9586207, 'binary_precision': 0.50351757, 'binary_recall': 0.7444279, 'binary_specificity': 0.9726573, 'binary_f1_score': 0.6007194}
confusion matrix:
       0    1
0  17573  494
1    172  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9286175, 'precision': 0.63866985, 'recall': 0.73471373, 'specificity': 0.73471373, 'f1': 0.67127335, 'auroc': 0.8876816, 'binary_precision': 0.2989011, 'binary_recall': 0.52307695, 'binary_specificity': 0.9463505, 'binary_f1_score': 0.3804196}
confusion matrix:
      0    1
0  5627  319
1   124  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_19.png
early stop counter: 2
val acc:0.9644610285758972, best validation acc: 0.977908194065094, corresponding to test acc:                         0.9600386619567871 / 0.9668062925338745
after epoch: 19,now: 2024-06-30 12:07:24.646265,epoch time: 0:22:14.172512,used: 7:02:32.039091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99808204, 'precision': 0.9984171, 'recall': 0.996518, 'specificity': 0.996518, 'f1': 0.99746287, 'auroc': 0.99987555, 'binary_precision': 0.99909323, 'binary_recall': 0.9933426, 'binary_specificity': 0.99969345, 'binary_f1_score': 0.99620956}
confusion matrix:
       0      1
0  42399     13
1     96  14324
---- Validation: 
scalar performance:
{'acc': 0.97716117, 'precision': 0.87927127, 'recall': 0.7528323, 'specificity': 0.7528323, 'f1': 0.8023588, 'auroc': 0.9644367, 'binary_precision': 0.7765237, 'binary_recall': 0.5111441, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.6164875}
confusion matrix:
       0    1
0  17968   99
1    329  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.950854, 'precision': 0.6387832, 'recall': 0.56609744, 'specificity': 0.56609744, 'f1': 0.58706194, 'auroc': 0.89562166, 'binary_precision': 0.3140496, 'binary_recall': 0.14615385, 'binary_specificity': 0.986041, 'binary_f1_score': 0.19947506}
confusion matrix:
      0   1
0  5863  83
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_20.png
early stop counter: 3
val acc:0.977161169052124, best validation acc: 0.977908194065094, corresponding to test acc:                         0.9600386619567871 / 0.9668062925338745
after epoch: 20,now: 2024-06-30 12:29:49.966334,epoch time: 0:22:25.320069,used: 7:24:57.359160,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9975542, 'precision': 0.99790204, 'recall': 0.9956374, 'specificity': 0.9956374, 'f1': 0.9967631, 'auroc': 0.9999151, 'binary_precision': 0.9986032, 'binary_recall': 0.9917464, 'binary_specificity': 0.99952847, 'binary_f1_score': 0.99516296}
confusion matrix:
       0      1
0  42394     20
1    119  14299
---- Validation: 
scalar performance:
{'acc': 0.9579509, 'precision': 0.72201425, 'recall': 0.8816312, 'specificity': 0.8816312, 'f1': 0.77756417, 'auroc': 0.9602921, 'binary_precision': 0.45172125, 'binary_recall': 0.79940563, 'binary_specificity': 0.96385676, 'binary_f1_score': 0.5772532}
confusion matrix:
       0    1
0  17414  653
1    135  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8865614, 'precision': 0.5831576, 'recall': 0.7109272, 'specificity': 0.7109272, 'f1': 0.6078291, 'auroc': 0.8705544, 'binary_precision': 0.18907563, 'binary_recall': 0.5192308, 'binary_specificity': 0.9026236, 'binary_f1_score': 0.27720737}
confusion matrix:
      0    1
0  5367  579
1   125  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_21.png
early stop counter: 4
val acc:0.9579508900642395, best validation acc: 0.977908194065094, corresponding to test acc:                         0.9600386619567871 / 0.9668062925338745
after epoch: 21,now: 2024-06-30 12:52:14.072256,epoch time: 0:22:24.105922,used: 7:47:21.465082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99765974, 'precision': 0.9975358, 'recall': 0.99628085, 'specificity': 0.99628085, 'f1': 0.9969063, 'auroc': 0.99988854, 'binary_precision': 0.99728507, 'binary_recall': 0.9934813, 'binary_specificity': 0.9990804, 'binary_f1_score': 0.99537957}
confusion matrix:
       0      1
0  42373     39
1     94  14326
---- Validation: 
scalar performance:
{'acc': 0.9511206, 'precision': 0.693209, 'recall': 0.83159643, 'specificity': 0.83159643, 'f1': 0.7411693, 'auroc': 0.95245266, 'binary_precision': 0.3978133, 'binary_recall': 0.70282316, 'binary_specificity': 0.9603697, 'binary_f1_score': 0.50805587}
confusion matrix:
       0    1
0  17351  716
1    200  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9278118, 'precision': 0.562801, 'recall': 0.56694543, 'specificity': 0.56694543, 'f1': 0.5647784, 'auroc': 0.90069115, 'binary_precision': 0.16187051, 'binary_recall': 0.17307693, 'binary_specificity': 0.960814, 'binary_f1_score': 0.16728626}
confusion matrix:
      0    1
0  5713  233
1   215   45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_22.png
early stop counter: 5
val acc:0.9511206150054932, best validation acc: 0.977908194065094, corresponding to test acc:                         0.9600386619567871 / 0.9668062925338745
after epoch: 22,now: 2024-06-30 13:14:34.788296,epoch time: 0:22:20.716040,used: 8:09:42.181122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99686795, 'precision': 0.99758285, 'recall': 0.9941484, 'specificity': 0.9941484, 'f1': 0.99585044, 'auroc': 0.99984753, 'binary_precision': 0.9990189, 'binary_recall': 0.9886269, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.9937957}
confusion matrix:
       0      1
0  42398     14
1    164  14256
---- Validation: 
scalar performance:
{'acc': 0.9700107, 'precision': 0.8677004, 'recall': 0.6182299, 'specificity': 0.6182299, 'f1': 0.67444825, 'auroc': 0.9516126, 'binary_precision': 0.76303315, 'binary_recall': 0.23922734, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.3642534}
confusion matrix:
       0    1
0  18017   50
1    512  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.47901532, 'recall': 0.499075, 'specificity': 0.499075, 'f1': 0.48883948, 'auroc': 0.9288762, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99815, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5935  11
1   260   0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_23.png
early stop counter: 6
val acc:0.9700106978416443, best validation acc: 0.977908194065094, corresponding to test acc:                         0.9600386619567871 / 0.9668062925338745
after epoch: 23,now: 2024-06-30 13:37:34.682350,epoch time: 0:22:59.894054,used: 8:32:42.075176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9972023, 'precision': 0.99537903, 'recall': 0.9972558, 'specificity': 0.9972558, 'f1': 0.99631286, 'auroc': 0.99981725, 'binary_precision': 0.99165577, 'binary_recall': 0.9973644, 'binary_specificity': 0.99714714, 'binary_f1_score': 0.99450195}
confusion matrix:
       0      1
0  42293    121
1     38  14380
---- Validation: 
scalar performance:
{'acc': 0.9788687, 'precision': 0.8587744, 'recall': 0.82166827, 'specificity': 0.82166827, 'f1': 0.83911526, 'auroc': 0.96669495, 'binary_precision': 0.73044926, 'binary_recall': 0.6523031, 'binary_specificity': 0.9910334, 'binary_f1_score': 0.6891679}
confusion matrix:
       0    1
0  17905  162
1    234  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7716323, 'recall': 0.54656327, 'specificity': 0.54656327, 'f1': 0.5720615, 'auroc': 0.95950866, 'binary_precision': 0.5813953, 'binary_recall': 0.09615385, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.1650165}
confusion matrix:
      0   1
0  5928  18
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_24.png
better model found
persisted
after epoch: 24,now: 2024-06-30 14:00:40.678851,epoch time: 0:23:05.996501,used: 8:55:48.071677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.998258, 'precision': 0.99839664, 'recall': 0.9970021, 'specificity': 0.9970021, 'f1': 0.9976968, 'auroc': 0.9998362, 'binary_precision': 0.9986768, 'binary_recall': 0.9944522, 'binary_specificity': 0.999552, 'binary_f1_score': 0.99656}
confusion matrix:
       0      1
0  42393     19
1     80  14340
---- Validation: 
scalar performance:
{'acc': 0.97097117, 'precision': 0.9437788, 'recall': 0.605138, 'specificity': 0.605138, 'f1': 0.66407645, 'auroc': 0.9558953, 'binary_precision': 0.91612905, 'binary_recall': 0.21099554, 'binary_specificity': 0.99928045, 'binary_f1_score': 0.34299517}
confusion matrix:
       0    1
0  18054   13
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.9451574, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_25.png
early stop counter: 1
val acc:0.9709711670875549, best validation acc: 0.9788687229156494, corresponding to test acc:                         0.9592329859733582 / 0.9668062925338745
after epoch: 25,now: 2024-06-30 14:23:50.252624,epoch time: 0:23:09.573773,used: 9:18:57.645450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9983108, 'precision': 0.99840903, 'recall': 0.99712896, 'specificity': 0.99712896, 'f1': 0.9977669, 'auroc': 0.99987465, 'binary_precision': 0.99860764, 'binary_recall': 0.9947295, 'binary_specificity': 0.9995284, 'binary_f1_score': 0.9966648}
confusion matrix:
       0      1
0  42392     20
1     76  14344
---- Validation: 
scalar performance:
{'acc': 0.9788154, 'precision': 0.9299555, 'recall': 0.73652375, 'specificity': 0.73652375, 'f1': 0.80313563, 'auroc': 0.96841735, 'binary_precision': 0.8791209, 'binary_recall': 0.4754829, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.6171649}
confusion matrix:
       0    1
0  18023   44
1    353  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.83492374, 'recall': 0.55476016, 'specificity': 0.55476016, 'f1': 0.58631337, 'auroc': 0.9387869, 'binary_precision': 0.70731705, 'binary_recall': 0.11153846, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.19269103}
confusion matrix:
      0   1
0  5934  12
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_26.png
early stop counter: 2
val acc:0.9788153767585754, best validation acc: 0.9788687229156494, corresponding to test acc:                         0.9592329859733582 / 0.9668062925338745
after epoch: 26,now: 2024-06-30 14:46:45.974727,epoch time: 0:22:55.722103,used: 9:41:53.367553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9978885, 'precision': 0.99851954, 'recall': 0.9959078, 'specificity': 0.9959078, 'f1': 0.9972049, 'auroc': 0.9999006, 'binary_precision': 0.9997903, 'binary_recall': 0.99188626, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9958226}
confusion matrix:
       0      1
0  42409      3
1    117  14303
---- Validation: 
scalar performance:
{'acc': 0.9748132, 'precision': 0.95334554, 'recall': 0.6607756, 'specificity': 0.6607756, 'f1': 0.7330617, 'auroc': 0.957156, 'binary_precision': 0.93133044, 'binary_recall': 0.32243684, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.47902867}
confusion matrix:
       0    1
0  18051   16
1    456  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.9792842, 'recall': 0.50576925, 'specificity': 0.50576925, 'f1': 0.5008299, 'auroc': 0.9535079, 'binary_precision': 1.0, 'binary_recall': 0.011538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.022813687}
confusion matrix:
      0  1
0  5946  0
1   257  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_27.png
early stop counter: 3
val acc:0.9748132228851318, best validation acc: 0.9788687229156494, corresponding to test acc:                         0.9592329859733582 / 0.9668062925338745
after epoch: 27,now: 2024-06-30 15:09:49.946163,epoch time: 0:23:03.971436,used: 10:04:57.338989,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9982404, 'precision': 0.99840784, 'recall': 0.99694455, 'specificity': 0.99694455, 'f1': 0.9976735, 'auroc': 0.9999013, 'binary_precision': 0.99874616, 'binary_recall': 0.9943135, 'binary_specificity': 0.9995756, 'binary_f1_score': 0.99652493}
confusion matrix:
       0      1
0  42394     18
1     82  14338
---- Validation: 
scalar performance:
{'acc': 0.97395945, 'precision': 0.9073925, 'recall': 0.66891605, 'specificity': 0.66891605, 'f1': 0.73539317, 'auroc': 0.9659276, 'binary_precision': 0.83882785, 'binary_recall': 0.34026745, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.48414376}
confusion matrix:
       0    1
0  18023   44
1    444  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7869375, 'recall': 0.5355294, 'specificity': 0.5355294, 'f1': 0.55485564, 'auroc': 0.95377064, 'binary_precision': 0.61290324, 'binary_recall': 0.073076926, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.1305842}
confusion matrix:
      0   1
0  5934  12
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_28.png
early stop counter: 4
val acc:0.9739594459533691, best validation acc: 0.9788687229156494, corresponding to test acc:                         0.9592329859733582 / 0.9668062925338745
after epoch: 28,now: 2024-06-30 15:32:41.236379,epoch time: 0:22:51.290216,used: 10:27:48.629205,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9986627, 'precision': 0.99875987, 'recall': 0.997708, 'specificity': 0.997708, 'f1': 0.99823254, 'auroc': 0.99994504, 'binary_precision': 0.99895644, 'binary_recall': 0.99576974, 'binary_specificity': 0.9996463, 'binary_f1_score': 0.9973605}
confusion matrix:
       0      1
0  42397     15
1     61  14359
---- Validation: 
scalar performance:
{'acc': 0.97844183, 'precision': 0.91437364, 'recall': 0.7420522, 'specificity': 0.7420522, 'f1': 0.8038876, 'auroc': 0.9670944, 'binary_precision': 0.8475452, 'binary_recall': 0.48736998, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.61886793}
confusion matrix:
       0    1
0  18008   59
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.8093687, 'recall': 0.5432217, 'specificity': 0.5432217, 'f1': 0.5676913, 'auroc': 0.9482483, 'binary_precision': 0.6571429, 'binary_recall': 0.08846154, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.1559322}
confusion matrix:
      0   1
0  5934  12
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_29.png
early stop counter: 5
val acc:0.9784418344497681, best validation acc: 0.9788687229156494, corresponding to test acc:                         0.9592329859733582 / 0.9668062925338745
after epoch: 29,now: 2024-06-30 15:55:15.992402,epoch time: 0:22:34.756023,used: 10:50:23.385228,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9983284, 'precision': 0.9984437, 'recall': 0.9971404, 'specificity': 0.9971404, 'f1': 0.99778986, 'auroc': 0.9999187, 'binary_precision': 0.99867696, 'binary_recall': 0.9947288, 'binary_specificity': 0.999552, 'binary_f1_score': 0.9966989}
confusion matrix:
       0      1
0  42395     19
1     76  14342
---- Validation: 
scalar performance:
{'acc': 0.9764141, 'precision': 0.88428164, 'recall': 0.73241735, 'specificity': 0.73241735, 'f1': 0.78815675, 'auroc': 0.9673574, 'binary_precision': 0.7880299, 'binary_recall': 0.46953937, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.58845437}
confusion matrix:
       0    1
0  17982   85
1    357  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.7100345, 'recall': 0.5310105, 'specificity': 0.5310105, 'f1': 0.54638475, 'auroc': 0.9151728, 'binary_precision': 0.45945945, 'binary_recall': 0.06538462, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.114478126}
confusion matrix:
      0   1
0  5926  20
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_30.png
early stop counter: 6
val acc:0.9764140844345093, best validation acc: 0.9788687229156494, corresponding to test acc:                         0.9592329859733582 / 0.9668062925338745
after epoch: 30,now: 2024-06-30 16:17:30.108260,epoch time: 0:22:14.115858,used: 11:12:37.501086,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_05_04_52_seed_1_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:12:37.501086 at 2024-06-30 16:17:30.108260
persisted model performance metric: 

scalar performance:
{'acc': 0.959233, 'precision': 0.7716323, 'recall': 0.54656327, 'specificity': 0.54656327, 'f1': 0.5720615, 'auroc': 0.95950866, 'binary_precision': 0.5813953, 'binary_recall': 0.09615385, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.1650165}
confusion matrix:
      0   1
0  5928  18
1   235  25
oracle model performance metric: 

scalar performance:
{'acc': 0.9668063, 'precision': 0.8989581, 'recall': 0.629592, 'specificity': 0.629592, 'f1': 0.6902969, 'auroc': 0.9588052, 'binary_precision': 0.8292683, 'binary_recall': 0.26153848, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.39766085}
confusion matrix:
      0   1
0  5932  14
1   192  68
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 368857 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool | 337010 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |  31847 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 368857 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool | 337010 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |  31847 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362638 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |  30848 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10004 MiB |  10022 MiB |  19314 MiB |   9310 MiB |
|       from large pool |   9950 MiB |   9962 MiB |  19240 MiB |   9290 MiB |
|       from small pool |     54 MiB |     60 MiB |     74 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 386854 KiB |    876 MiB |   1755 TiB |   1755 TiB |
|       from large pool | 377742 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |   9112 KiB |     32 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3293    |    7964    |  441871 K  |  441868 K  |
|       from large pool |     151    |     986    |  226164 K  |  226164 K  |
|       from small pool |    3142    |    7811    |  215706 K  |  215703 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3293    |    7964    |  441871 K  |  441868 K  |
|       from large pool |     151    |     986    |  226164 K  |  226164 K  |
|       from small pool |    3142    |    7811    |  215706 K  |  215703 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     442    |     445    |     837    |     395    |
|       from large pool |     415    |     415    |     800    |     385    |
|       from small pool |      27    |      30    |      37    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3614    |  286091 K  |  286091 K  |
|       from large pool |      35    |     417    |  181913 K  |  181913 K  |
|       from small pool |      36    |    3583    |  104178 K  |  104178 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |      0 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  19314 MiB |  18576 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  19240 MiB |  18542 MiB |
|       from small pool |  40960 KiB |     60 MiB |     74 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |   1755 TiB |   1755 TiB |
|       from large pool |  24320 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |      0 KiB |     32 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  441871 K  |  441871 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215706 K  |  215706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  441871 K  |  441871 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215706 K  |  215706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |     837    |     786    |
|       from large pool |      31    |     415    |     800    |     769    |
|       from small pool |      20    |      30    |      37    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3614    |  286092 K  |  286092 K  |
|       from large pool |       3    |     417    |  181913 K  |  181913 K  |
|       from small pool |       0    |    3583    |  104179 K  |  104179 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   2445 TiB |   2445 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   2413 TiB |   2413 TiB |
|       from small pool |      0 KiB |     51 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   2438 TiB |   2438 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   2406 TiB |   2406 TiB |
|       from small pool |      0 KiB |     50 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  19314 MiB |  18576 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  19240 MiB |  18542 MiB |
|       from small pool |  40960 KiB |     60 MiB |     74 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |   1755 TiB |   1755 TiB |
|       from large pool |  24320 KiB |    872 MiB |   1723 TiB |   1723 TiB |
|       from small pool |      0 KiB |     32 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7964    |  441871 K  |  441871 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215706 K  |  215706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7964    |  441871 K  |  441871 K  |
|       from large pool |       2    |     986    |  226164 K  |  226164 K  |
|       from small pool |       0    |    7811    |  215706 K  |  215706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |     837    |     786    |
|       from large pool |      31    |     415    |     800    |     769    |
|       from small pool |      20    |      30    |      37    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3614    |  286092 K  |  286092 K  |
|       from large pool |       3    |     417    |  181913 K  |  181913 K  |
|       from small pool |       0    |    3583    |  104179 K  |  104179 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976

 Experiment start at: 2024-06-30 16:25:07.253626
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9843315, 'precision': 0.9895619, 'recall': 0.970277, 'specificity': 0.970277, 'f1': 0.97941107, 'auroc': 0.99890995, 'binary_precision': 0.9999297, 'binary_recall': 0.9405777, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.96934605}
confusion matrix:
       0      1
0  42310      1
1    899  14230
---- Validation: 
scalar performance:
{'acc': 0.9717147, 'precision': 0.864362, 'recall': 0.5862737, 'specificity': 0.5862737, 'f1': 0.6344867, 'auroc': 0.9272443, 'binary_precision': 0.7553957, 'binary_recall': 0.1744186, 'binary_specificity': 0.9981289, 'binary_f1_score': 0.28340077}
confusion matrix:
       0    1
0  18137   34
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.7223881, 'recall': 0.547419, 'specificity': 0.547419, 'f1': 0.5721803, 'auroc': 0.88912123, 'binary_precision': 0.48, 'binary_recall': 0.09917355, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.16438356}
confusion matrix:
      0   1
0  5971  26
1   218  24
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-30 16:48:14.187096,epoch time: 0:23:06.933470,used: 0:23:06.933470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9900592, 'precision': 0.9925211, 'recall': 0.9818933, 'specificity': 0.9818933, 'f1': 0.9870522, 'auroc': 0.99915886, 'binary_precision': 0.9975393, 'binary_recall': 0.96463746, 'binary_specificity': 0.99914914, 'binary_f1_score': 0.9808125}
confusion matrix:
       0      1
0  42275     36
1    535  14594
---- Validation: 
scalar performance:
{'acc': 0.9697971, 'precision': 0.7571106, 'recall': 0.7442868, 'specificity': 0.7442868, 'f1': 0.75051785, 'auroc': 0.9425248, 'binary_precision': 0.530648, 'binary_recall': 0.50332224, 'binary_specificity': 0.98525125, 'binary_f1_score': 0.5166241}
confusion matrix:
       0    1
0  17903  268
1    299  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.8719951, 'recall': 0.59189135, 'specificity': 0.59189135, 'f1': 0.6413779, 'auroc': 0.92165214, 'binary_precision': 0.7758621, 'binary_recall': 0.18595041, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.3}
confusion matrix:
      0   1
0  5984  13
1   197  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_2.png
new oracle model saved
early stop counter: 1
val acc:0.9697970747947693, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9608911871910095 / 0.9663407802581787
after epoch: 2,now: 2024-06-30 17:10:55.438022,epoch time: 0:22:41.250926,used: 0:45:48.184396,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99547356, 'precision': 0.99489915, 'recall': 0.99342424, 'specificity': 0.99342424, 'f1': 0.9941587, 'auroc': 0.99966776, 'binary_precision': 0.9936915, 'binary_recall': 0.9890938, 'binary_specificity': 0.9977547, 'binary_f1_score': 0.9913873}
confusion matrix:
       0      1
0  42216     95
1    165  14964
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.75013655, 'recall': 0.7952416, 'specificity': 0.7952416, 'f1': 0.7706176, 'auroc': 0.9409959, 'binary_precision': 0.5132867, 'binary_recall': 0.6096346, 'binary_specificity': 0.9808486, 'binary_f1_score': 0.5573273}
confusion matrix:
       0    1
0  17823  348
1    235  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.73087025, 'recall': 0.66225123, 'specificity': 0.66225123, 'f1': 0.6898078, 'auroc': 0.9097593, 'binary_precision': 0.48809522, 'binary_recall': 0.338843, 'binary_specificity': 0.9856595, 'binary_f1_score': 0.4}
confusion matrix:
      0   1
0  5911  86
1   160  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_3.png
early stop counter: 2
val acc:0.968944787979126, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9608911871910095 / 0.9663407802581787
after epoch: 3,now: 2024-06-30 17:33:31.424972,epoch time: 0:22:35.986950,used: 1:08:24.171346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99514276, 'precision': 0.99333906, 'recall': 0.99415493, 'specificity': 0.99415493, 'f1': 0.99374604, 'auroc': 0.99966264, 'binary_precision': 0.98951674, 'binary_recall': 0.9920677, 'binary_specificity': 0.9962422, 'binary_f1_score': 0.99079055}
confusion matrix:
       0      1
0  42153    159
1    120  15008
---- Validation: 
scalar performance:
{'acc': 0.96585524, 'precision': 0.7272875, 'recall': 0.749478, 'specificity': 0.749478, 'f1': 0.7378065, 'auroc': 0.9168204, 'binary_precision': 0.47058824, 'binary_recall': 0.5182724, 'binary_specificity': 0.9806835, 'binary_f1_score': 0.49328062}
confusion matrix:
       0    1
0  17820  351
1    290  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9291553, 'precision': 0.53354824, 'recall': 0.5348762, 'specificity': 0.5348762, 'f1': 0.5341903, 'auroc': 0.83094317, 'binary_precision': 0.103174604, 'binary_recall': 0.10743801, 'binary_specificity': 0.9623145, 'binary_f1_score': 0.10526315}
confusion matrix:
      0    1
0  5771  226
1   216   26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_4.png
early stop counter: 3
val acc:0.9658552408218384, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9608911871910095 / 0.9663407802581787
after epoch: 4,now: 2024-06-30 17:56:32.710710,epoch time: 0:23:01.285738,used: 1:31:25.457084,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99375, 'precision': 0.99183357, 'recall': 0.9920633, 'specificity': 0.9920633, 'f1': 0.99194837, 'auroc': 0.9994632, 'binary_precision': 0.9877807, 'binary_recall': 0.9884989, 'binary_specificity': 0.99562764, 'binary_f1_score': 0.9881397}
confusion matrix:
       0      1
0  42126    185
1    174  14955
---- Validation: 
scalar performance:
{'acc': 0.8395035, 'precision': 0.5697007, 'recall': 0.83357614, 'specificity': 0.83357614, 'f1': 0.5793, 'auroc': 0.91208786, 'binary_precision': 0.14616965, 'binary_recall': 0.82724255, 'binary_specificity': 0.83990973, 'binary_f1_score': 0.248441}
confusion matrix:
       0     1
0  15262  2909
1    104   498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7461132, 'precision': 0.5356695, 'recall': 0.68552184, 'specificity': 0.68552184, 'f1': 0.50485855, 'auroc': 0.75257945, 'binary_precision': 0.09135201, 'binary_recall': 0.6198347, 'binary_specificity': 0.75120896, 'binary_f1_score': 0.15923567}
confusion matrix:
      0     1
0  4505  1492
1    92   150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_5.png
early stop counter: 4
val acc:0.8395035266876221, best validation acc: 0.9717146754264832, corresponding to test acc:                         0.9608911871910095 / 0.9663407802581787
after epoch: 5,now: 2024-06-30 18:19:50.766127,epoch time: 0:23:18.055417,used: 1:54:43.512501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99507314, 'precision': 0.99331164, 'recall': 0.994002, 'specificity': 0.994002, 'f1': 0.99365604, 'auroc': 0.9997511, 'binary_precision': 0.9895799, 'binary_recall': 0.99173826, 'binary_specificity': 0.99626565, 'binary_f1_score': 0.99065787}
confusion matrix:
       0      1
0  42152    158
1    125  15005
---- Validation: 
scalar performance:
{'acc': 0.973366, 'precision': 0.78630114, 'recall': 0.77985835, 'specificity': 0.77985835, 'f1': 0.78303957, 'auroc': 0.96070594, 'binary_precision': 0.5867347, 'binary_recall': 0.5730897, 'binary_specificity': 0.98662704, 'binary_f1_score': 0.57983196}
confusion matrix:
       0    1
0  17928  243
1    257  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589678, 'precision': 0.7070087, 'recall': 0.60986626, 'specificity': 0.60986626, 'f1': 0.6416041, 'auroc': 0.91438866, 'binary_precision': 0.44444445, 'binary_recall': 0.23140496, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.3043478}
confusion matrix:
      0   1
0  5927  70
1   186  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_6.png
better model found
persisted
after epoch: 6,now: 2024-06-30 18:43:09.169807,epoch time: 0:23:18.403680,used: 2:18:01.916181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9960306, 'precision': 0.9971887, 'recall': 0.9925922, 'specificity': 0.9925922, 'f1': 0.99486154, 'auroc': 0.999722, 'binary_precision': 0.99959767, 'binary_recall': 0.9853262, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9924106}
confusion matrix:
       0      1
0  42305      6
1    222  14907
---- Validation: 
scalar performance:
{'acc': 0.976349, 'precision': 0.9092829, 'recall': 0.660942, 'specificity': 0.660942, 'f1': 0.72776586, 'auroc': 0.9499717, 'binary_precision': 0.8405172, 'binary_recall': 0.32392028, 'binary_specificity': 0.9979638, 'binary_f1_score': 0.46762592}
confusion matrix:
       0    1
0  18134   37
1    407  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.64755636, 'recall': 0.50759745, 'specificity': 0.50759745, 'f1': 0.50568587, 'auroc': 0.8489085, 'binary_precision': 0.33333334, 'binary_recall': 0.016528925, 'binary_specificity': 0.998666, 'binary_f1_score': 0.031496063}
confusion matrix:
      0  1
0  5989  8
1   238  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_7.png
better model found
persisted
after epoch: 7,now: 2024-06-30 19:06:24.653429,epoch time: 0:23:15.483622,used: 2:41:17.399803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99526465, 'precision': 0.99665207, 'recall': 0.99115926, 'specificity': 0.99115926, 'f1': 0.9938644, 'auroc': 0.9996954, 'binary_precision': 0.9995293, 'binary_recall': 0.982484, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.99093336}
confusion matrix:
       0      1
0  42304      7
1    265  14864
---- Validation: 
scalar performance:
{'acc': 0.971182, 'precision': 0.7737694, 'recall': 0.71127415, 'specificity': 0.71127415, 'f1': 0.7381171, 'auroc': 0.9510915, 'binary_precision': 0.5661605, 'binary_recall': 0.43355483, 'binary_specificity': 0.98899347, 'binary_f1_score': 0.49106303}
confusion matrix:
       0    1
0  17971  200
1    341  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.8732639, 'recall': 0.60007244, 'specificity': 0.60007244, 'f1': 0.6521533, 'auroc': 0.951592, 'binary_precision': 0.7777778, 'binary_recall': 0.20247933, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.32131147}
confusion matrix:
      0   1
0  5983  14
1   193  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_8.png
new oracle model saved
early stop counter: 1
val acc:0.9711819887161255, best validation acc: 0.9763489961624146, corresponding to test acc:                         0.9605706334114075 / 0.9668216109275818
after epoch: 8,now: 2024-06-30 19:29:32.672306,epoch time: 0:23:08.018877,used: 3:04:25.418680,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9966922, 'precision': 0.99748206, 'recall': 0.9939967, 'specificity': 0.9939967, 'f1': 0.9957228, 'auroc': 0.9998064, 'binary_precision': 0.9991313, 'binary_recall': 0.9883006, 'binary_specificity': 0.99969274, 'binary_f1_score': 0.99368644}
confusion matrix:
       0      1
0  42298     13
1    177  14952
---- Validation: 
scalar performance:
{'acc': 0.9761892, 'precision': 0.853397, 'recall': 0.7042241, 'specificity': 0.7042241, 'f1': 0.7573857, 'auroc': 0.94905883, 'binary_precision': 0.7259475, 'binary_recall': 0.41362128, 'binary_specificity': 0.9948269, 'binary_f1_score': 0.52698416}
confusion matrix:
       0    1
0  18077   94
1    353  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95576215, 'precision': 0.5738375, 'recall': 0.5169927, 'specificity': 0.5169927, 'f1': 0.5224556, 'auroc': 0.8892236, 'binary_precision': 0.18518518, 'binary_recall': 0.041322313, 'binary_specificity': 0.992663, 'binary_f1_score': 0.067567565}
confusion matrix:
      0   1
0  5953  44
1   232  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_9.png
early stop counter: 2
val acc:0.9761891961097717, best validation acc: 0.9763489961624146, corresponding to test acc:                         0.9605706334114075 / 0.9668216109275818
after epoch: 9,now: 2024-06-30 19:52:35.256190,epoch time: 0:23:02.583884,used: 3:27:28.002564,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99549097, 'precision': 0.99669445, 'recall': 0.99169505, 'specificity': 0.99169505, 'f1': 0.99416053, 'auroc': 0.99970645, 'binary_precision': 0.9991943, 'binary_recall': 0.98367375, 'binary_specificity': 0.9997164, 'binary_f1_score': 0.9913733}
confusion matrix:
       0      1
0  42299     12
1    247  14882
---- Validation: 
scalar performance:
{'acc': 0.97874606, 'precision': 0.90181977, 'recall': 0.71357536, 'specificity': 0.71357536, 'f1': 0.77699625, 'auroc': 0.96397537, 'binary_precision': 0.82222223, 'binary_recall': 0.43023255, 'binary_specificity': 0.99691814, 'binary_f1_score': 0.5648855}
confusion matrix:
       0    1
0  18115   56
1    343  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.8980381, 'recall': 0.5204944, 'specificity': 0.5204944, 'f1': 0.52979875, 'auroc': 0.9405148, 'binary_precision': 0.8333333, 'binary_recall': 0.041322313, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.07874016}
confusion matrix:
      0   1
0  5995   2
1   232  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_10.png
better model found
persisted
after epoch: 10,now: 2024-06-30 20:15:37.805503,epoch time: 0:23:02.549313,used: 3:50:30.551877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9957695, 'precision': 0.9964036, 'recall': 0.9926909, 'specificity': 0.9926909, 'f1': 0.9945283, 'auroc': 0.99976695, 'binary_precision': 0.9977264, 'binary_recall': 0.9861855, 'binary_specificity': 0.9991964, 'binary_f1_score': 0.9919224}
confusion matrix:
       0      1
0  42277     34
1    209  14920
---- Validation: 
scalar performance:
{'acc': 0.97555, 'precision': 0.8187432, 'recall': 0.74806154, 'specificity': 0.74806154, 'f1': 0.77861965, 'auroc': 0.95096606, 'binary_precision': 0.6537634, 'binary_recall': 0.50498337, 'binary_specificity': 0.9911397, 'binary_f1_score': 0.5698219}
confusion matrix:
       0    1
0  18010  161
1    298  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95640326, 'precision': 0.6386335, 'recall': 0.5470673, 'specificity': 0.5470673, 'f1': 0.56645185, 'auroc': 0.9017129, 'binary_precision': 0.3125, 'binary_recall': 0.10330579, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.15527952}
confusion matrix:
      0   1
0  5942  55
1   217  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_11.png
early stop counter: 1
val acc:0.9755499958992004, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9668216109275818
after epoch: 11,now: 2024-06-30 20:38:43.391549,epoch time: 0:23:05.586046,used: 4:13:36.137923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99347144, 'precision': 0.99114907, 'recall': 0.9920443, 'specificity': 0.9920443, 'f1': 0.99159557, 'auroc': 0.9995722, 'binary_precision': 0.98622555, 'binary_recall': 0.9890284, 'binary_specificity': 0.99506027, 'binary_f1_score': 0.987625}
confusion matrix:
       0      1
0  42101    209
1    166  14964
---- Validation: 
scalar performance:
{'acc': 0.96633464, 'precision': 0.7367176, 'recall': 0.8436823, 'specificity': 0.8436823, 'f1': 0.7791553, 'auroc': 0.9499953, 'binary_precision': 0.4831081, 'binary_recall': 0.7126246, 'binary_specificity': 0.97473997, 'binary_f1_score': 0.5758389}
confusion matrix:
       0    1
0  17712  459
1    173  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.73420966, 'recall': 0.5951716, 'specificity': 0.5951716, 'f1': 0.6320448, 'auroc': 0.9253249, 'binary_precision': 0.5, 'binary_recall': 0.1983471, 'binary_specificity': 0.991996, 'binary_f1_score': 0.28402367}
confusion matrix:
      0   1
0  5949  48
1   194  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_12.png
early stop counter: 2
val acc:0.9663346409797668, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9668216109275818
after epoch: 12,now: 2024-06-30 21:01:49.414197,epoch time: 0:23:06.022648,used: 4:36:42.160571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99651814, 'precision': 0.995119, 'recall': 0.9959168, 'specificity': 0.9959168, 'f1': 0.99551696, 'auroc': 0.9997878, 'binary_precision': 0.992154, 'binary_recall': 0.9946461, 'binary_specificity': 0.9971875, 'binary_f1_score': 0.9933985}
confusion matrix:
       0      1
0  42192    119
1     81  15048
---- Validation: 
scalar performance:
{'acc': 0.96548235, 'precision': 0.7266169, 'recall': 0.7685585, 'specificity': 0.7685585, 'f1': 0.7456016, 'auroc': 0.9432504, 'binary_precision': 0.4679666, 'binary_recall': 0.55813956, 'binary_specificity': 0.9789775, 'binary_f1_score': 0.5090909}
confusion matrix:
       0    1
0  17789  382
1    266  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.7377002, 'recall': 0.6388752, 'specificity': 0.6388752, 'f1': 0.67376584, 'auroc': 0.94520724, 'binary_precision': 0.50359714, 'binary_recall': 0.2892562, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.36745402}
confusion matrix:
      0   1
0  5928  69
1   172  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_13.png
early stop counter: 3
val acc:0.9654823541641235, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9668216109275818
after epoch: 13,now: 2024-06-30 21:24:54.548928,epoch time: 0:23:05.134731,used: 4:59:47.295302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99366295, 'precision': 0.9894, 'recall': 0.9944247, 'specificity': 0.9944247, 'f1': 0.9918766, 'auroc': 0.99976486, 'binary_precision': 0.98022634, 'binary_recall': 0.9960344, 'binary_specificity': 0.99281496, 'binary_f1_score': 0.9880672}
confusion matrix:
       0      1
0  42006    304
1     60  15070
---- Validation: 
scalar performance:
{'acc': 0.94268364, 'precision': 0.6696186, 'recall': 0.90614855, 'specificity': 0.90614855, 'f1': 0.7310398, 'auroc': 0.9588078, 'binary_precision': 0.34387353, 'binary_recall': 0.86710966, 'binary_specificity': 0.9451874, 'binary_f1_score': 0.49245283}
confusion matrix:
       0    1
0  17175  996
1     80  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97146976, 'precision': 0.7964828, 'recall': 0.880074, 'specificity': 0.880074, 'f1': 0.83246285, 'auroc': 0.95660913, 'binary_precision': 0.6019108, 'binary_recall': 0.78099173, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.67985606}
confusion matrix:
      0    1
0  5872  125
1    53  189
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_14.png
new oracle model saved
early stop counter: 4
val acc:0.9426836371421814, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 14,now: 2024-06-30 21:47:58.829711,epoch time: 0:23:04.280783,used: 5:22:51.576085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9973363, 'precision': 0.99618196, 'recall': 0.9969605, 'specificity': 0.9969605, 'f1': 0.9965704, 'auroc': 0.9998806, 'binary_precision': 0.99373597, 'binary_recall': 0.9961663, 'binary_specificity': 0.9977547, 'binary_f1_score': 0.99494964}
confusion matrix:
       0      1
0  42216     95
1     58  15071
---- Validation: 
scalar performance:
{'acc': 0.94982153, 'precision': 0.68557554, 'recall': 0.9050174, 'specificity': 0.9050174, 'f1': 0.74815744, 'auroc': 0.9631618, 'binary_precision': 0.3760933, 'binary_recall': 0.85714287, 'binary_specificity': 0.95289195, 'binary_f1_score': 0.5227964}
confusion matrix:
       0    1
0  17315  856
1     86  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9036705, 'precision': 0.6155583, 'recall': 0.809117, 'specificity': 0.809117, 'f1': 0.655285, 'auroc': 0.89992034, 'binary_precision': 0.24393724, 'binary_recall': 0.7066116, 'binary_specificity': 0.91162246, 'binary_f1_score': 0.3626723}
confusion matrix:
      0    1
0  5467  530
1    71  171
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_15.png
early stop counter: 5
val acc:0.9498215317726135, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 15,now: 2024-06-30 22:10:56.282517,epoch time: 0:22:57.452806,used: 5:45:49.028891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.995665, 'precision': 0.99261475, 'recall': 0.9962932, 'specificity': 0.9962932, 'f1': 0.99443495, 'auroc': 0.99982893, 'binary_precision': 0.98608387, 'binary_recall': 0.99762046, 'binary_specificity': 0.99496585, 'binary_f1_score': 0.99181867}
confusion matrix:
       0      1
0  42098    213
1     36  15093
---- Validation: 
scalar performance:
{'acc': 0.86789536, 'precision': 0.5919283, 'recall': 0.8972283, 'specificity': 0.8972283, 'f1': 0.61883765, 'auroc': 0.9560666, 'binary_precision': 0.1865821, 'binary_recall': 0.9285714, 'binary_specificity': 0.8658852, 'binary_f1_score': 0.31072816}
confusion matrix:
       0     1
0  15734  2437
1     43   559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80413526, 'precision': 0.56379217, 'recall': 0.7910477, 'specificity': 0.7910477, 'f1': 0.561489, 'auroc': 0.8514223, 'binary_precision': 0.13864307, 'binary_recall': 0.7768595, 'binary_specificity': 0.8052359, 'binary_f1_score': 0.23529412}
confusion matrix:
      0     1
0  4829  1168
1    54   188
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_16.png
early stop counter: 6
val acc:0.8678953647613525, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 16,now: 2024-06-30 22:33:52.439246,epoch time: 0:22:56.156729,used: 6:08:45.185620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9974582, 'precision': 0.9980428, 'recall': 0.99540865, 'specificity': 0.99540865, 'f1': 0.99671626, 'auroc': 0.9998967, 'binary_precision': 0.999267, 'binary_recall': 0.9910773, 'binary_specificity': 0.99974, 'binary_f1_score': 0.99515533}
confusion matrix:
       0      1
0  42299     11
1    135  14995
---- Validation: 
scalar performance:
{'acc': 0.97858626, 'precision': 0.88398236, 'recall': 0.7263416, 'specificity': 0.7263416, 'f1': 0.7833729, 'auroc': 0.958435, 'binary_precision': 0.78571427, 'binary_recall': 0.45681062, 'binary_specificity': 0.99587256, 'binary_f1_score': 0.57773113}
confusion matrix:
       0    1
0  18096   75
1    327  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.8565202, 'recall': 0.5244599, 'specificity': 0.5244599, 'f1': 0.5369372, 'auroc': 0.92896724, 'binary_precision': 0.75, 'binary_recall': 0.049586777, 'binary_specificity': 0.999333, 'binary_f1_score': 0.093023255}
confusion matrix:
      0   1
0  5993   4
1   230  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_17.png
early stop counter: 7
val acc:0.9785862565040588, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 17,now: 2024-06-30 22:56:47.294348,epoch time: 0:22:54.855102,used: 6:31:40.040722,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9955606, 'precision': 0.99696076, 'recall': 0.9916144, 'specificity': 0.9916144, 'f1': 0.9942485, 'auroc': 0.99985623, 'binary_precision': 0.9998656, 'binary_recall': 0.98327607, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99150145}
confusion matrix:
       0      1
0  42310      2
1    253  14875
---- Validation: 
scalar performance:
{'acc': 0.9759229, 'precision': 0.8362, 'recall': 0.7225566, 'specificity': 0.7225566, 'f1': 0.76690906, 'auroc': 0.95811653, 'binary_precision': 0.6903553, 'binary_recall': 0.45182723, 'binary_specificity': 0.993286, 'binary_f1_score': 0.5461847}
confusion matrix:
       0    1
0  18049  122
1    330  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.6426047, 'recall': 0.5189103, 'specificity': 0.5189103, 'f1': 0.52626544, 'auroc': 0.90460104, 'binary_precision': 0.32258064, 'binary_recall': 0.041322313, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.07326007}
confusion matrix:
      0   1
0  5976  21
1   232  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_18.png
early stop counter: 8
val acc:0.9759228825569153, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 18,now: 2024-06-30 23:19:57.895908,epoch time: 0:23:10.601560,used: 6:54:50.642282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.997493, 'precision': 0.9981527, 'recall': 0.9953892, 'specificity': 0.9953892, 'f1': 0.9967605, 'auroc': 0.9999082, 'binary_precision': 0.9995333, 'binary_recall': 0.99094397, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.99522007}
confusion matrix:
       0      1
0  42305      7
1    137  14991
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.7466793, 'recall': 0.76209646, 'specificity': 0.76209646, 'f1': 0.7541289, 'auroc': 0.9458091, 'binary_precision': 0.5085803, 'binary_recall': 0.5415282, 'binary_specificity': 0.9826647, 'binary_f1_score': 0.5245374}
confusion matrix:
       0    1
0  17856  315
1    276  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95335793, 'precision': 0.65651906, 'recall': 0.60298264, 'specificity': 0.60298264, 'f1': 0.6232926, 'auroc': 0.90142214, 'binary_precision': 0.34394905, 'binary_recall': 0.2231405, 'binary_specificity': 0.98282474, 'binary_f1_score': 0.27067667}
confusion matrix:
      0    1
0  5894  103
1   188   54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_19.png
early stop counter: 9
val acc:0.9685186147689819, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 19,now: 2024-06-30 23:43:21.548424,epoch time: 0:23:23.652516,used: 7:18:14.294798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9973363, 'precision': 0.9974452, 'recall': 0.99568665, 'specificity': 0.99568665, 'f1': 0.99656165, 'auroc': 0.99975616, 'binary_precision': 0.9976738, 'binary_recall': 0.99220043, 'binary_specificity': 0.9991728, 'binary_f1_score': 0.99492955}
confusion matrix:
       0      1
0  42276     35
1    118  15011
---- Validation: 
scalar performance:
{'acc': 0.96713364, 'precision': 0.7397745, 'recall': 0.8208066, 'specificity': 0.8208066, 'f1': 0.7737477, 'auroc': 0.95397055, 'binary_precision': 0.49079755, 'binary_recall': 0.66445184, 'binary_specificity': 0.9771614, 'binary_f1_score': 0.5645731}
confusion matrix:
       0    1
0  17756  415
1    202  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96553934, 'precision': 0.7743449, 'recall': 0.71836984, 'specificity': 0.71836984, 'f1': 0.74280727, 'auroc': 0.9457146, 'binary_precision': 0.5706806, 'binary_recall': 0.45041323, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.5034642}
confusion matrix:
      0    1
0  5915   82
1   133  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_20.png
early stop counter: 10
val acc:0.967133641242981, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 20,now: 2024-07-01 00:06:47.356314,epoch time: 0:23:25.807890,used: 7:41:40.102688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99794567, 'precision': 0.9978812, 'recall': 0.9968221, 'specificity': 0.9968221, 'f1': 0.9973501, 'auroc': 0.9998914, 'binary_precision': 0.9977452, 'binary_recall': 0.99444777, 'binary_specificity': 0.9991964, 'binary_f1_score': 0.99609375}
confusion matrix:
       0      1
0  42277     34
1     84  15045
---- Validation: 
scalar performance:
{'acc': 0.97214085, 'precision': 0.7719966, 'recall': 0.82018095, 'specificity': 0.82018095, 'f1': 0.7939231, 'auroc': 0.9578563, 'binary_precision': 0.5553997, 'binary_recall': 0.6578073, 'binary_specificity': 0.9825546, 'binary_f1_score': 0.6022814}
confusion matrix:
       0    1
0  17854  317
1    206  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.77438354, 'recall': 0.55618376, 'specificity': 0.55618376, 'f1': 0.58695215, 'auroc': 0.95045114, 'binary_precision': 0.5833333, 'binary_recall': 0.11570248, 'binary_specificity': 0.996665, 'binary_f1_score': 0.19310346}
confusion matrix:
      0   1
0  5977  20
1   214  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_21.png
early stop counter: 11
val acc:0.9721408486366272, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 21,now: 2024-07-01 00:29:51.924880,epoch time: 0:23:04.568566,used: 8:04:44.671254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9981546, 'precision': 0.99862134, 'recall': 0.99662423, 'specificity': 0.99662423, 'f1': 0.99761736, 'auroc': 0.9999124, 'binary_precision': 0.99960095, 'binary_recall': 0.9933902, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9964858}
confusion matrix:
       0      1
0  42305      6
1    100  15029
---- Validation: 
scalar performance:
{'acc': 0.97805357, 'precision': 0.9073828, 'recall': 0.69555056, 'specificity': 0.69555056, 'f1': 0.76187515, 'auroc': 0.9655564, 'binary_precision': 0.83450705, 'binary_recall': 0.3936877, 'binary_specificity': 0.99741346, 'binary_f1_score': 0.53498876}
confusion matrix:
       0    1
0  18124   47
1    365  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9586472, 'precision': 0.5489603, 'recall': 0.50461423, 'specificity': 0.50461423, 'f1': 0.500802, 'auroc': 0.9254999, 'binary_precision': 0.13636364, 'binary_recall': 0.012396694, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.022727273}
confusion matrix:
      0   1
0  5978  19
1   239   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_22.png
early stop counter: 12
val acc:0.9780535697937012, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 22,now: 2024-07-01 00:52:56.079371,epoch time: 0:23:04.154491,used: 8:27:48.825745,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99775416, 'precision': 0.9984586, 'recall': 0.9957579, 'specificity': 0.9957579, 'f1': 0.99709827, 'auroc': 0.99994797, 'binary_precision': 0.99993336, 'binary_recall': 0.9915394, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9957187}
confusion matrix:
       0      1
0  42310      1
1    128  15001
---- Validation: 
scalar performance:
{'acc': 0.9751238, 'precision': 0.9611858, 'recall': 0.61855066, 'specificity': 0.61855066, 'f1': 0.6835607, 'auroc': 0.9686736, 'binary_precision': 0.9470199, 'binary_recall': 0.23754153, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.3798141}
confusion matrix:
       0    1
0  18163    8
1    459  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.9457439, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_23.png
early stop counter: 13
val acc:0.9751238226890564, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 23,now: 2024-07-01 01:15:57.148733,epoch time: 0:23:01.069362,used: 8:50:49.895107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9971797, 'precision': 0.9980929, 'recall': 0.99464643, 'specificity': 0.99464643, 'f1': 0.9963534, 'auroc': 0.9998963, 'binary_precision': 1.0, 'binary_recall': 0.9892928, 'binary_specificity': 1.0, 'binary_f1_score': 0.9946176}
confusion matrix:
       0      1
0  42310      0
1    162  14968
---- Validation: 
scalar performance:
{'acc': 0.97645557, 'precision': 0.9490373, 'recall': 0.6449361, 'specificity': 0.6449361, 'f1': 0.7149466, 'auroc': 0.9632708, 'binary_precision': 0.92105263, 'binary_recall': 0.29069766, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.44191918}
confusion matrix:
       0    1
0  18156   15
1    427  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.48058408, 'recall': 0.49941638, 'specificity': 0.49941638, 'f1': 0.48981926, 'auroc': 0.9274417, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5990  7
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_24.png
early stop counter: 14
val acc:0.976455569267273, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 24,now: 2024-07-01 01:38:58.952371,epoch time: 0:23:01.803638,used: 9:13:51.698745,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99810237, 'precision': 0.99862903, 'recall': 0.99648285, 'specificity': 0.99648285, 'f1': 0.99754965, 'auroc': 0.9999263, 'binary_precision': 0.99973387, 'binary_recall': 0.9930602, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9963859}
confusion matrix:
       0      1
0  42306      4
1    105  15025
---- Validation: 
scalar performance:
{'acc': 0.9765088, 'precision': 0.8996686, 'recall': 0.6698581, 'specificity': 0.6698581, 'f1': 0.7354913, 'auroc': 0.9584062, 'binary_precision': 0.82071716, 'binary_recall': 0.34219268, 'binary_specificity': 0.99752355, 'binary_f1_score': 0.48300117}
confusion matrix:
       0    1
0  18126   45
1    396  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.91009754, 'recall': 0.5246267, 'specificity': 0.5246267, 'f1': 0.5373839, 'auroc': 0.95365816, 'binary_precision': 0.85714287, 'binary_recall': 0.049586777, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.09375}
confusion matrix:
      0   1
0  5995   2
1   230  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_25.png
early stop counter: 15
val acc:0.9765087962150574, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 25,now: 2024-07-01 02:02:03.483100,epoch time: 0:23:04.530729,used: 9:36:56.229474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9983983, 'precision': 0.99852955, 'recall': 0.99734163, 'specificity': 0.99734163, 'f1': 0.9979336, 'auroc': 0.99981296, 'binary_precision': 0.9988058, 'binary_recall': 0.9951087, 'binary_specificity': 0.9995746, 'binary_f1_score': 0.9969538}
confusion matrix:
       0      1
0  42293     18
1     74  15055
---- Validation: 
scalar performance:
{'acc': 0.97778726, 'precision': 0.8621112, 'recall': 0.7331563, 'specificity': 0.7331563, 'f1': 0.7826221, 'auroc': 0.95815027, 'binary_precision': 0.7415144, 'binary_recall': 0.4717608, 'binary_specificity': 0.9945518, 'binary_f1_score': 0.5766498}
confusion matrix:
       0    1
0  18072   99
1    318  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.8203435, 'recall': 0.5506524, 'specificity': 0.5506524, 'f1': 0.58021975, 'auroc': 0.9580687, 'binary_precision': 0.6756757, 'binary_recall': 0.10330579, 'binary_specificity': 0.997999, 'binary_f1_score': 0.17921148}
confusion matrix:
      0   1
0  5985  12
1   217  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_26.png
early stop counter: 16
val acc:0.9777872562408447, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 26,now: 2024-07-01 02:25:01.963253,epoch time: 0:22:58.480153,used: 9:59:54.709627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.995961, 'precision': 0.99384975, 'recall': 0.99577224, 'specificity': 0.99577224, 'f1': 0.9948059, 'auroc': 0.999815, 'binary_precision': 0.98935753, 'binary_recall': 0.9953734, 'binary_specificity': 0.9961711, 'binary_f1_score': 0.99235636}
confusion matrix:
       0      1
0  42148    162
1     70  15060
---- Validation: 
scalar performance:
{'acc': 0.94721144, 'precision': 0.66932964, 'recall': 0.84584963, 'specificity': 0.84584963, 'f1': 0.7224035, 'auroc': 0.95264465, 'binary_precision': 0.3476899, 'binary_recall': 0.73754156, 'binary_specificity': 0.9541577, 'binary_f1_score': 0.47259182}
confusion matrix:
       0    1
0  17338  833
1    158  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9291553, 'precision': 0.5783758, 'recall': 0.60228944, 'specificity': 0.60228944, 'f1': 0.58821505, 'auroc': 0.893659, 'binary_precision': 0.1875, 'binary_recall': 0.24793388, 'binary_specificity': 0.956645, 'binary_f1_score': 0.21352313}
confusion matrix:
      0    1
0  5737  260
1   182   60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_27.png
early stop counter: 17
val acc:0.9472114443778992, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 27,now: 2024-07-01 02:47:55.543001,epoch time: 0:22:53.579748,used: 10:22:48.289375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9986595, 'precision': 0.99840987, 'recall': 0.9981346, 'specificity': 0.9981346, 'f1': 0.9982722, 'auroc': 0.9999234, 'binary_precision': 0.997883, 'binary_recall': 0.9970256, 'binary_specificity': 0.9992437, 'binary_f1_score': 0.99745417}
confusion matrix:
       0      1
0  42279     32
1     45  15084
---- Validation: 
scalar performance:
{'acc': 0.97357905, 'precision': 0.78259784, 'recall': 0.82413614, 'specificity': 0.82413614, 'f1': 0.8018006, 'auroc': 0.96259415, 'binary_precision': 0.57636887, 'binary_recall': 0.66445184, 'binary_specificity': 0.9838204, 'binary_f1_score': 0.617284}
confusion matrix:
       0    1
0  17877  294
1    202  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9580061, 'precision': 0.6734169, 'recall': 0.5617802, 'specificity': 0.5617802, 'f1': 0.5873794, 'auroc': 0.9219611, 'binary_precision': 0.3809524, 'binary_recall': 0.1322314, 'binary_specificity': 0.991329, 'binary_f1_score': 0.19631901}
confusion matrix:
      0   1
0  5945  52
1   210  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_28.png
early stop counter: 18
val acc:0.9735790491104126, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 28,now: 2024-07-01 03:10:53.022217,epoch time: 0:22:57.479216,used: 10:45:45.768591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99805015, 'precision': 0.99748755, 'recall': 0.99748755, 'specificity': 0.99748755, 'f1': 0.99748755, 'auroc': 0.99990714, 'binary_precision': 0.99629873, 'binary_recall': 0.99629873, 'binary_specificity': 0.9986764, 'binary_f1_score': 0.99629873}
confusion matrix:
       0      1
0  42254     56
1     56  15074
---- Validation: 
scalar performance:
{'acc': 0.9750173, 'precision': 0.7942718, 'recall': 0.82487905, 'specificity': 0.82487905, 'f1': 0.80874467, 'auroc': 0.95977455, 'binary_precision': 0.59970015, 'binary_recall': 0.66445184, 'binary_specificity': 0.98530626, 'binary_f1_score': 0.63041764}
confusion matrix:
       0    1
0  17904  267
1    202  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9588075, 'precision': 0.6765315, 'recall': 0.5503006, 'specificity': 0.5503006, 'f1': 0.57358277, 'auroc': 0.91755104, 'binary_precision': 0.3880597, 'binary_recall': 0.10743801, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.16828479}
confusion matrix:
      0   1
0  5956  41
1   216  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_29.png
early stop counter: 19
val acc:0.9750173091888428, best validation acc: 0.9787460565567017, corresponding to test acc:                         0.9624940156936646 / 0.9714697599411011
after epoch: 29,now: 2024-07-01 03:33:46.350168,epoch time: 0:22:53.327951,used: 11:08:39.096542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9981372, 'precision': 0.9977577, 'recall': 0.9974406, 'specificity': 0.9974406, 'f1': 0.997599, 'auroc': 0.9999249, 'binary_precision': 0.99695665, 'binary_recall': 0.9959683, 'binary_specificity': 0.9989128, 'binary_f1_score': 0.9964622}
confusion matrix:
       0      1
0  42264     46
1     61  15069
---- Validation: 
scalar performance:
{'acc': 0.9793853, 'precision': 0.853935, 'recall': 0.78698295, 'specificity': 0.78698295, 'f1': 0.81667984, 'auroc': 0.9617026, 'binary_precision': 0.72164947, 'binary_recall': 0.5813953, 'binary_specificity': 0.9925706, 'binary_f1_score': 0.6439742}
confusion matrix:
       0    1
0  18036  135
1    252  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.58794606, 'recall': 0.5052812, 'specificity': 0.5052812, 'f1': 0.5014913, 'auroc': 0.9260212, 'binary_precision': 0.21428572, 'binary_recall': 0.012396694, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.0234375}
confusion matrix:
      0   1
0  5986  11
1   239   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21628976_30.png
better model found
persisted
after epoch: 30,now: 2024-07-01 03:56:36.625189,epoch time: 0:22:50.275021,used: 11:31:29.371563,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_30_16_25_07_seed_2_21628976
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:31:29.371563 at 2024-07-01 03:56:36.625189
persisted model performance metric: 

scalar performance:
{'acc': 0.95992947, 'precision': 0.58794606, 'recall': 0.5052812, 'specificity': 0.5052812, 'f1': 0.5014913, 'auroc': 0.9260212, 'binary_precision': 0.21428572, 'binary_recall': 0.012396694, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.0234375}
confusion matrix:
      0   1
0  5986  11
1   239   3
oracle model performance metric: 

scalar performance:
{'acc': 0.97146976, 'precision': 0.7964828, 'recall': 0.880074, 'specificity': 0.880074, 'f1': 0.83246285, 'auroc': 0.95660913, 'binary_precision': 0.6019108, 'binary_recall': 0.78099173, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.67985606}
confusion matrix:
      0    1
0  5872  125
1    53  189
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_onethirdfreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 369159 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool | 337306 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |  31853 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 369159 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool | 337306 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |  31853 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 362640 KiB |   9125 MiB |   3660 TiB |   3660 TiB |
|       from large pool | 331790 KiB |   9096 MiB |   3612 TiB |   3612 TiB |
|       from small pool |  30850 KiB |     50 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10006 MiB |  10022 MiB |  28582 MiB |  18576 MiB |
|       from large pool |   9950 MiB |   9962 MiB |  28492 MiB |  18542 MiB |
|       from small pool |     56 MiB |     60 MiB |     90 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 386552 KiB |    876 MiB |   2635 TiB |   2635 TiB |
|       from large pool | 377446 KiB |    872 MiB |   2587 TiB |   2587 TiB |
|       from small pool |   9106 KiB |     32 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3305    |    8014    |  663607 K  |  663603 K  |
|       from large pool |     151    |     986    |  339597 K  |  339597 K  |
|       from small pool |    3154    |    7861    |  324009 K  |  324006 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3305    |    8014    |  663607 K  |  663603 K  |
|       from large pool |     151    |     986    |  339597 K  |  339597 K  |
|       from small pool |    3154    |    7861    |  324009 K  |  324006 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     443    |     445    |    1229    |     786    |
|       from large pool |     415    |     415    |    1184    |     769    |
|       from small pool |      28    |      30    |      45    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3641    |  432422 K  |  432422 K  |
|       from large pool |      35    |     417    |  275898 K  |  275898 K  |
|       from small pool |      36    |    3607    |  156524 K  |  156524 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |      0 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9131 MiB |   3668 TiB |   3668 TiB |
|       from large pool |  16640 KiB |   9101 MiB |   3620 TiB |   3620 TiB |
|       from small pool |      0 KiB |     51 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9125 MiB |   3660 TiB |   3660 TiB |
|       from large pool |  16640 KiB |   9096 MiB |   3612 TiB |   3612 TiB |
|       from small pool |      0 KiB |     50 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB |  10022 MiB |  28582 MiB |  27844 MiB |
|       from large pool | 714752 KiB |   9962 MiB |  28492 MiB |  27794 MiB |
|       from small pool |  40960 KiB |     60 MiB |     90 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    876 MiB |   2635 TiB |   2635 TiB |
|       from large pool |  24320 KiB |    872 MiB |   2587 TiB |   2587 TiB |
|       from small pool |      0 KiB |     32 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8014    |  663607 K  |  663607 K  |
|       from large pool |       2    |     986    |  339597 K  |  339597 K  |
|       from small pool |       0    |    7861    |  324009 K  |  324009 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8014    |  663607 K  |  663607 K  |
|       from large pool |       2    |     986    |  339597 K  |  339597 K  |
|       from small pool |       0    |    7861    |  324009 K  |  324009 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     445    |    1229    |    1178    |
|       from large pool |      31    |     415    |    1184    |    1153    |
|       from small pool |      20    |      30    |      45    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3641    |  432423 K  |  432423 K  |
|       from large pool |       3    |     417    |  275898 K  |  275898 K  |
|       from small pool |       0    |    3607    |  156525 K  |  156525 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul  1 03:57:55 2024]
Finished job 0.
1 of 1 steps (100%) done
