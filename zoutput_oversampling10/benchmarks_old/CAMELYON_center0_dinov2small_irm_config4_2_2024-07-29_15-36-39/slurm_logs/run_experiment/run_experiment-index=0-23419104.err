Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul 30 09:32:22 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_irm_config4_2_2024-07-29_15-36-39/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_irm_config4_2_2024-07-29_15-36-39/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104

 Experiment start at: 2024-07-30 09:41:41.824515
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99076086, 'precision': 0.9878195, 'recall': 0.9880572, 'specificity': 0.9880572, 'f1': 0.9879383, 'auroc': 0.99878895, 'binary_precision': 0.9817367, 'binary_recall': 0.98247045, 'binary_specificity': 0.99364394, 'binary_f1_score': 0.98210347}
confusion matrix:
       0      1
0  42053    269
1    258  14460
---- Validation: 
scalar performance:
{'acc': 0.9662622, 'precision': 0.745111, 'recall': 0.7605171, 'specificity': 0.7605171, 'f1': 0.7525518, 'auroc': 0.91526806, 'binary_precision': 0.5065693, 'binary_recall': 0.53965783, 'binary_specificity': 0.9813764, 'binary_f1_score': 0.52259034}
confusion matrix:
       0    1
0  17811  338
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97283477, 'precision': 0.8331462, 'recall': 0.8209162, 'specificity': 0.8209162, 'f1': 0.82690334, 'auroc': 0.9348456, 'binary_precision': 0.6812749, 'binary_recall': 0.6551724, 'binary_specificity': 0.98666, 'binary_f1_score': 0.66796875}
confusion matrix:
      0    1
0  5917   80
1    90  171
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-30 09:57:41.445300,epoch time: 0:15:59.620785,used: 0:15:59.620785,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99388146, 'precision': 0.9955398, 'recall': 0.98849523, 'specificity': 0.98849523, 'f1': 0.99195206, 'auroc': 0.99922454, 'binary_precision': 0.9988887, 'binary_recall': 0.9773685, 'binary_specificity': 0.999622, 'binary_f1_score': 0.9880114}
confusion matrix:
       0      1
0  42310     16
1    333  14381
---- Validation: 
scalar performance:
{'acc': 0.970679, 'precision': 0.7983296, 'recall': 0.68254787, 'specificity': 0.68254787, 'f1': 0.7252467, 'auroc': 0.9406916, 'binary_precision': 0.6185567, 'binary_recall': 0.3732504, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.46556738}
confusion matrix:
       0    1
0  18001  148
1    403  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.50416, 'recall': 0.5003316, 'specificity': 0.5003316, 'f1': 0.49215698, 'auroc': 0.90735674, 'binary_precision': 0.05, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.007117438}
confusion matrix:
      0   1
0  5978  19
1   260   1
better model found
persisted
after epoch: 2,now: 2024-07-30 10:11:26.494762,epoch time: 0:13:45.049462,used: 0:29:44.670247,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9966865, 'precision': 0.9968083, 'recall': 0.9945324, 'specificity': 0.9945324, 'f1': 0.9956635, 'auroc': 0.9997736, 'binary_precision': 0.99705803, 'binary_recall': 0.99008083, 'binary_specificity': 0.998984, 'binary_f1_score': 0.9935572}
confusion matrix:
       0      1
0  42278     43
1    146  14573
---- Validation: 
scalar performance:
{'acc': 0.9733929, 'precision': 0.83348495, 'recall': 0.7004541, 'specificity': 0.7004541, 'f1': 0.7490213, 'auroc': 0.9559128, 'binary_precision': 0.68766403, 'binary_recall': 0.407465, 'binary_specificity': 0.9934432, 'binary_f1_score': 0.51171875}
confusion matrix:
       0    1
0  18030  119
1    381  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.8472494, 'recall': 0.6714114, 'specificity': 0.6714114, 'f1': 0.7266913, 'auroc': 0.943136, 'binary_precision': 0.7222222, 'binary_recall': 0.348659, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.4702842}
confusion matrix:
      0   1
0  5962  35
1   170  91
better model found
persisted
after epoch: 3,now: 2024-07-30 10:25:01.657885,epoch time: 0:13:35.163123,used: 0:43:19.833370,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99454767, 'precision': 0.9963294, 'recall': 0.9894569, 'specificity': 0.9894569, 'f1': 0.9928309, 'auroc': 0.9997684, 'binary_precision': 0.9999306, 'binary_recall': 0.9789373, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9893226}
confusion matrix:
       0      1
0  42321      1
1    310  14408
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.8082197, 'recall': 0.509916, 'specificity': 0.509916, 'f1': 0.5109813, 'auroc': 0.9631587, 'binary_precision': 0.65, 'binary_recall': 0.02021773, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.039215688}
confusion matrix:
       0   1
0  18142   7
1    630  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9542067, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
early stop counter: 1
val acc:0.9661026000976562, best validation acc: 0.973392903804779, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 4,now: 2024-07-30 10:38:32.228177,epoch time: 0:13:30.570292,used: 0:56:50.403662,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99237376, 'precision': 0.99481916, 'recall': 0.98530877, 'specificity': 0.98530877, 'f1': 0.9899447, 'auroc': 0.9994905, 'binary_precision': 0.99972004, 'binary_recall': 0.9707121, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9850026}
confusion matrix:
       0      1
0  42320      4
1    431  14285
---- Validation: 
scalar performance:
{'acc': 0.9710515, 'precision': 0.78010434, 'recall': 0.7884985, 'specificity': 0.7884985, 'f1': 0.78423285, 'auroc': 0.96147704, 'binary_precision': 0.57466066, 'binary_recall': 0.592535, 'binary_specificity': 0.98446196, 'binary_f1_score': 0.583461}
confusion matrix:
       0    1
0  17867  282
1    262  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.86176306, 'recall': 0.5887877, 'specificity': 0.5887877, 'f1': 0.6361202, 'auroc': 0.95647824, 'binary_precision': 0.7580645, 'binary_recall': 0.18007663, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.29102167}
confusion matrix:
      0   1
0  5982  15
1   214  47
early stop counter: 2
val acc:0.9710515141487122, best validation acc: 0.973392903804779, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 5,now: 2024-07-30 10:52:21.498145,epoch time: 0:13:49.269968,used: 1:10:39.673630,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.996371, 'precision': 0.9968866, 'recall': 0.99363214, 'specificity': 0.99363214, 'f1': 0.9952454, 'auroc': 0.9996892, 'binary_precision': 0.99794096, 'binary_recall': 0.9879731, 'binary_specificity': 0.9992912, 'binary_f1_score': 0.992932}
confusion matrix:
       0      1
0  42293     30
1    177  14540
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.75662124, 'recall': 0.7132299, 'specificity': 0.7132299, 'f1': 0.7327069, 'auroc': 0.9474791, 'binary_precision': 0.53295666, 'binary_recall': 0.44012442, 'binary_specificity': 0.98633534, 'binary_f1_score': 0.4821124}
confusion matrix:
       0    1
0  17901  248
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93144774, 'precision': 0.5816968, 'recall': 0.58677137, 'specificity': 0.58677137, 'f1': 0.5841315, 'auroc': 0.9034412, 'binary_precision': 0.19784173, 'binary_recall': 0.21072797, 'binary_specificity': 0.96281475, 'binary_f1_score': 0.20408165}
confusion matrix:
      0    1
0  5774  223
1   206   55
early stop counter: 3
val acc:0.9676458239555359, best validation acc: 0.973392903804779, corresponding to test acc:                         0.9672419428825378 / 0.9728347659111023
after epoch: 6,now: 2024-07-30 11:06:43.683623,epoch time: 0:14:22.185478,used: 1:25:01.859108,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9978261, 'precision': 0.9972047, 'recall': 0.99711657, 'specificity': 0.99711657, 'f1': 0.9971607, 'auroc': 0.9998319, 'binary_precision': 0.99592143, 'binary_recall': 0.9956507, 'binary_specificity': 0.9985824, 'binary_f1_score': 0.9957861}
confusion matrix:
       0      1
0  42265     60
1     64  14651
---- Validation: 
scalar performance:
{'acc': 0.9687633, 'precision': 0.76130015, 'recall': 0.83381724, 'specificity': 0.83381724, 'f1': 0.792619, 'auroc': 0.966895, 'binary_precision': 0.5337349, 'binary_recall': 0.688958, 'binary_specificity': 0.9786765, 'binary_f1_score': 0.6014935}
confusion matrix:
       0    1
0  17762  387
1    200  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97299457, 'precision': 0.83137584, 'recall': 0.8301612, 'specificity': 0.8301612, 'f1': 0.8307674, 'auroc': 0.95685935, 'binary_precision': 0.6769231, 'binary_recall': 0.6743295, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.6756239}
confusion matrix:
      0    1
0  5913   84
1    85  176
new oracle model saved
early stop counter: 4
val acc:0.9687632918357849, best validation acc: 0.973392903804779, corresponding to test acc:                         0.9672419428825378 / 0.9729945659637451
after epoch: 7,now: 2024-07-30 11:21:42.265529,epoch time: 0:14:58.581906,used: 1:40:00.441014,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9968794, 'precision': 0.99736357, 'recall': 0.99448514, 'specificity': 0.99448514, 'f1': 0.9959134, 'auroc': 0.99968743, 'binary_precision': 0.9983549, 'binary_recall': 0.98953736, 'binary_specificity': 0.9994329, 'binary_f1_score': 0.9939266}
confusion matrix:
       0      1
0  42297     24
1    154  14565
---- Validation: 
scalar performance:
{'acc': 0.9713708, 'precision': 0.7794001, 'recall': 0.81941605, 'specificity': 0.81941605, 'f1': 0.79792404, 'auroc': 0.9572279, 'binary_precision': 0.57104194, 'binary_recall': 0.6562986, 'binary_specificity': 0.98253345, 'binary_f1_score': 0.61070913}
confusion matrix:
       0    1
0  17832  317
1    221  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.78219557, 'recall': 0.8708023, 'specificity': 0.8708023, 'f1': 0.81963086, 'auroc': 0.9517658, 'binary_precision': 0.57471263, 'binary_recall': 0.7662835, 'binary_specificity': 0.975321, 'binary_f1_score': 0.65681446}
confusion matrix:
      0    1
0  5849  148
1    61  200
early stop counter: 5
val acc:0.9713708162307739, best validation acc: 0.973392903804779, corresponding to test acc:                         0.9672419428825378 / 0.9729945659637451
after epoch: 8,now: 2024-07-30 11:37:51.350777,epoch time: 0:16:09.085248,used: 1:56:09.526262,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99708974, 'precision': 0.9973483, 'recall': 0.995047, 'specificity': 0.995047, 'f1': 0.99619067, 'auroc': 0.99968326, 'binary_precision': 0.99787843, 'binary_recall': 0.9908263, 'binary_specificity': 0.9992676, 'binary_f1_score': 0.99433994}
confusion matrix:
       0      1
0  42293     31
1    135  14581
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.8076928, 'recall': 0.64099175, 'specificity': 0.64099175, 'f1': 0.6908311, 'auroc': 0.9197359, 'binary_precision': 0.6401384, 'binary_recall': 0.28771386, 'binary_specificity': 0.99426967, 'binary_f1_score': 0.3969957}
confusion matrix:
       0    1
0  18045  104
1    458  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7305466, 'recall': 0.53481436, 'specificity': 0.53481436, 'f1': 0.5528633, 'auroc': 0.9344256, 'binary_precision': 0.5, 'binary_recall': 0.07279693, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.12709029}
confusion matrix:
      0   1
0  5978  19
1   242  19
early stop counter: 6
val acc:0.9700936675071716, best validation acc: 0.973392903804779, corresponding to test acc:                         0.9672419428825378 / 0.9729945659637451
after epoch: 9,now: 2024-07-30 11:51:49.108217,epoch time: 0:13:57.757440,used: 2:10:07.283702,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9973352, 'precision': 0.99787223, 'recall': 0.9951683, 'specificity': 0.9951683, 'f1': 0.9965106, 'auroc': 0.9997302, 'binary_precision': 0.99897224, 'binary_recall': 0.99069107, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.9948144}
confusion matrix:
       0      1
0  42308     15
1    137  14580
---- Validation: 
scalar performance:
{'acc': 0.96902937, 'precision': 0.8553721, 'recall': 0.5721857, 'specificity': 0.5721857, 'f1': 0.6141733, 'auroc': 0.96250457, 'binary_precision': 0.7401575, 'binary_recall': 0.14618973, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.24415584}
confusion matrix:
       0   1
0  18116  33
1    549  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.47912335, 'recall': 0.49941638, 'specificity': 0.49941638, 'f1': 0.48905948, 'auroc': 0.94567573, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5990  7
1   261  0
early stop counter: 7
val acc:0.9690293669700623, best validation acc: 0.973392903804779, corresponding to test acc:                         0.9672419428825378 / 0.9729945659637451
after epoch: 10,now: 2024-07-30 12:07:56.631593,epoch time: 0:16:07.523376,used: 2:26:14.807078,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.994723, 'precision': 0.99534893, 'recall': 0.99085784, 'specificity': 0.99085784, 'f1': 0.9930767, 'auroc': 0.9996283, 'binary_precision': 0.9966233, 'binary_recall': 0.98287344, 'binary_specificity': 0.9988423, 'binary_f1_score': 0.9897006}
confusion matrix:
       0      1
0  42277     49
1    252  14462
---- Validation: 
scalar performance:
{'acc': 0.96796507, 'precision': 0.76286936, 'recall': 0.6766425, 'specificity': 0.6766425, 'f1': 0.7104482, 'auroc': 0.94961184, 'binary_precision': 0.5480094, 'binary_recall': 0.36391914, 'binary_specificity': 0.9893658, 'binary_f1_score': 0.4373832}
confusion matrix:
       0    1
0  17956  193
1    409  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.74585146, 'recall': 0.67832, 'specificity': 0.67832, 'f1': 0.7059942, 'auroc': 0.93361676, 'binary_precision': 0.5187166, 'binary_recall': 0.3716475, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.43303573}
confusion matrix:
      0   1
0  5907  90
1   164  97
early stop counter: 8
val acc:0.9679650664329529, best validation acc: 0.973392903804779, corresponding to test acc:                         0.9672419428825378 / 0.9729945659637451
after epoch: 11,now: 2024-07-30 12:22:04.864235,epoch time: 0:14:08.232642,used: 2:40:23.039720,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9970547, 'precision': 0.99781924, 'recall': 0.9944929, 'specificity': 0.9944929, 'f1': 0.99614143, 'auroc': 0.999781, 'binary_precision': 0.9993823, 'binary_recall': 0.9891984, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.9942643}
confusion matrix:
       0      1
0  42311      9
1    159  14561
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.88926554, 'recall': 0.5362444, 'specificity': 0.5362444, 'f1': 0.55881834, 'auroc': 0.95733565, 'binary_precision': 0.8103448, 'binary_recall': 0.07309487, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.13409415}
confusion matrix:
       0   1
0  18138  11
1    596  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.6293534, 'recall': 0.5051635, 'specificity': 0.5051635, 'f1': 0.5002494, 'auroc': 0.93442136, 'binary_precision': 0.3, 'binary_recall': 0.011494253, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.022140222}
confusion matrix:
      0  1
0  5990  7
1   258  3
early stop counter: 9
val acc:0.9676989912986755, best validation acc: 0.973392903804779, corresponding to test acc:                         0.9672419428825378 / 0.9729945659637451
after epoch: 12,now: 2024-07-30 12:36:27.992527,epoch time: 0:14:23.128292,used: 2:54:46.168012,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99779105, 'precision': 0.9984257, 'recall': 0.9958081, 'specificity': 0.9958081, 'f1': 0.99710786, 'auroc': 0.99987745, 'binary_precision': 0.99972606, 'binary_recall': 0.99171084, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99570227}
confusion matrix:
       0      1
0  42318      4
1    122  14596
---- Validation: 
scalar performance:
{'acc': 0.97259474, 'precision': 0.92718685, 'recall': 0.61453456, 'specificity': 0.61453456, 'f1': 0.67548835, 'auroc': 0.96108276, 'binary_precision': 0.88095236, 'binary_recall': 0.23017107, 'binary_specificity': 0.998898, 'binary_f1_score': 0.36498147}
confusion matrix:
       0    1
0  18129   20
1    495  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.95300686, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
early stop counter: 10
val acc:0.9725947380065918, best validation acc: 0.973392903804779, corresponding to test acc:                         0.9672419428825378 / 0.9729945659637451
after epoch: 13,now: 2024-07-30 12:50:38.594928,epoch time: 0:14:10.602401,used: 3:08:56.770413,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99588007, 'precision': 0.99478304, 'recall': 0.9944539, 'specificity': 0.9944539, 'f1': 0.99461836, 'auroc': 0.9995976, 'binary_precision': 0.99251854, 'binary_recall': 0.991507, 'binary_specificity': 0.9974009, 'binary_f1_score': 0.99201256}
confusion matrix:
       0      1
0  42212    110
1    125  14593
---- Validation: 
scalar performance:
{'acc': 0.97200936, 'precision': 0.7984408, 'recall': 0.7379906, 'specificity': 0.7379906, 'f1': 0.76448244, 'auroc': 0.94943094, 'binary_precision': 0.6149312, 'binary_recall': 0.4867807, 'binary_specificity': 0.98920053, 'binary_f1_score': 0.54340273}
confusion matrix:
       0    1
0  17953  196
1    330  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.796233, 'recall': 0.62684983, 'specificity': 0.62684983, 'f1': 0.674151, 'auroc': 0.9466754, 'binary_precision': 0.6238532, 'binary_recall': 0.2605364, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.36756757}
confusion matrix:
      0   1
0  5956  41
1   193  68
early stop counter: 11
val acc:0.9720093607902527, best validation acc: 0.973392903804779, corresponding to test acc:                         0.9672419428825378 / 0.9729945659637451
after epoch: 14,now: 2024-07-30 13:04:50.442179,epoch time: 0:14:11.847251,used: 3:23:08.617664,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9970547, 'precision': 0.99797785, 'recall': 0.9943359, 'specificity': 0.9943359, 'f1': 0.99613935, 'auroc': 0.99984443, 'binary_precision': 0.99986255, 'binary_recall': 0.988719, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99425954}
confusion matrix:
       0      1
0  42323      2
1    166  14549
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.81657875, 'recall': 0.5106936, 'specificity': 0.5106936, 'f1': 0.5124711, 'auroc': 0.9659435, 'binary_precision': 0.6666667, 'binary_recall': 0.02177294, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.042168677}
confusion matrix:
       0   1
0  18142   7
1    629  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.4791267, 'recall': 0.49949974, 'specificity': 0.49949974, 'f1': 0.48910117, 'auroc': 0.95949066, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5991  6
1   261  0
early stop counter: 12
val acc:0.9661558270454407, best validation acc: 0.973392903804779, corresponding to test acc:                         0.9672419428825378 / 0.9729945659637451
after epoch: 15,now: 2024-07-30 13:19:20.884050,epoch time: 0:14:30.441871,used: 3:37:39.059535,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99863255, 'precision': 0.9983245, 'recall': 0.99810356, 'specificity': 0.99810356, 'f1': 0.998214, 'auroc': 0.9998802, 'binary_precision': 0.99768835, 'binary_recall': 0.99701047, 'binary_specificity': 0.99919665, 'binary_f1_score': 0.9973493}
confusion matrix:
       0      1
0  42288     34
1     44  14674
---- Validation: 
scalar performance:
{'acc': 0.97376543, 'precision': 0.84590507, 'recall': 0.69239634, 'specificity': 0.69239634, 'f1': 0.7455243, 'auroc': 0.95986414, 'binary_precision': 0.7130682, 'binary_recall': 0.3903577, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.5045226}
confusion matrix:
       0    1
0  18048  101
1    392  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.86604327, 'recall': 0.5567209, 'specificity': 0.5567209, 'f1': 0.5901768, 'auroc': 0.9273208, 'binary_precision': 0.7692308, 'binary_recall': 0.11494253, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5988   9
1   231  30
better model found
persisted
after epoch: 16,now: 2024-07-30 13:33:36.911341,epoch time: 0:14:16.027291,used: 3:51:55.086826,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.995845, 'precision': 0.99438965, 'recall': 0.994762, 'specificity': 0.994762, 'f1': 0.9945756, 'auroc': 0.9998487, 'binary_precision': 0.9913793, 'binary_recall': 0.9925246, 'binary_specificity': 0.9969994, 'binary_f1_score': 0.99195164}
confusion matrix:
       0      1
0  42198    127
1    110  14605
---- Validation: 
scalar performance:
{'acc': 0.96828437, 'precision': 0.7625506, 'recall': 0.7165607, 'specificity': 0.7165607, 'f1': 0.73711544, 'auroc': 0.9546208, 'binary_precision': 0.544592, 'binary_recall': 0.44634527, 'binary_specificity': 0.9867761, 'binary_f1_score': 0.4905983}
confusion matrix:
       0    1
0  17909  240
1    356  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.47913003, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.48914286, 'auroc': 0.94394386, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   261  0
early stop counter: 1
val acc:0.9682843685150146, best validation acc: 0.9737654328346252, corresponding to test acc:                         0.9616490602493286 / 0.9729945659637451
after epoch: 17,now: 2024-07-30 13:48:07.750568,epoch time: 0:14:30.839227,used: 4:06:25.926053,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9974229, 'precision': 0.9982693, 'recall': 0.99500644, 'specificity': 0.99500644, 'f1': 0.9966239, 'auroc': 0.9999518, 'binary_precision': 1.0, 'binary_recall': 0.9900129, 'binary_specificity': 1.0, 'binary_f1_score': 0.9949814}
confusion matrix:
       0      1
0  42321      0
1    147  14572
---- Validation: 
scalar performance:
{'acc': 0.97110474, 'precision': 0.9252728, 'recall': 0.5897614, 'specificity': 0.5897614, 'f1': 0.6423015, 'auroc': 0.96641576, 'binary_precision': 0.8787879, 'binary_recall': 0.18040435, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.29935482}
confusion matrix:
       0    1
0  18133   16
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.47913003, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.48914286, 'auroc': 0.9543252, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   261  0
early stop counter: 2
val acc:0.9711047410964966, best validation acc: 0.9737654328346252, corresponding to test acc:                         0.9616490602493286 / 0.9729945659637451
after epoch: 18,now: 2024-07-30 14:04:26.355702,epoch time: 0:16:18.605134,used: 4:22:44.531187,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9973527, 'precision': 0.9981772, 'recall': 0.9949142, 'specificity': 0.9949142, 'f1': 0.9965316, 'auroc': 0.9998727, 'binary_precision': 0.99986273, 'binary_recall': 0.9898757, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9948441}
confusion matrix:
       0      1
0  42321      2
1    149  14568
---- Validation: 
scalar performance:
{'acc': 0.97153044, 'precision': 0.84465635, 'recall': 0.63798535, 'specificity': 0.63798535, 'f1': 0.6938263, 'auroc': 0.9607376, 'binary_precision': 0.71428573, 'binary_recall': 0.2799378, 'binary_specificity': 0.99603283, 'binary_f1_score': 0.40223467}
confusion matrix:
       0    1
0  18077   72
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7708108, 'recall': 0.53339887, 'specificity': 0.53339887, 'f1': 0.5511726, 'auroc': 0.94684446, 'binary_precision': 0.58064514, 'binary_recall': 0.06896552, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.12328768}
confusion matrix:
      0   1
0  5984  13
1   243  18
early stop counter: 3
val acc:0.9715304374694824, best validation acc: 0.9737654328346252, corresponding to test acc:                         0.9616490602493286 / 0.9729945659637451
after epoch: 19,now: 2024-07-30 14:19:59.835474,epoch time: 0:15:33.479772,used: 4:38:18.010959,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9975631, 'precision': 0.997891, 'recall': 0.9957435, 'specificity': 0.9957435, 'f1': 0.99681115, 'auroc': 0.99984324, 'binary_precision': 0.9985638, 'binary_recall': 0.9919832, 'binary_specificity': 0.9995038, 'binary_f1_score': 0.9952626}
confusion matrix:
       0      1
0  42300     21
1    118  14601
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.8071104, 'recall': 0.63640875, 'specificity': 0.63640875, 'f1': 0.6862271, 'auroc': 0.95379126, 'binary_precision': 0.63928574, 'binary_recall': 0.27838257, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.38786566}
confusion matrix:
       0    1
0  18048  101
1    464  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.8324328, 'recall': 0.53573143, 'specificity': 0.53573143, 'f1': 0.5557498, 'auroc': 0.94889545, 'binary_precision': 0.7037037, 'binary_recall': 0.07279693, 'binary_specificity': 0.998666, 'binary_f1_score': 0.13194445}
confusion matrix:
      0   1
0  5989   8
1   242  19
early stop counter: 4
val acc:0.9699339866638184, best validation acc: 0.9737654328346252, corresponding to test acc:                         0.9616490602493286 / 0.9729945659637451
after epoch: 20,now: 2024-07-30 14:34:39.849937,epoch time: 0:14:40.014463,used: 4:52:58.025422,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9986851, 'precision': 0.99900365, 'recall': 0.99756306, 'specificity': 0.99756306, 'f1': 0.99828064, 'auroc': 0.9999517, 'binary_precision': 0.9996588, 'binary_recall': 0.99524426, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99744666}
confusion matrix:
       0      1
0  42316      5
1     70  14649
---- Validation: 
scalar performance:
{'acc': 0.97307366, 'precision': 0.91831577, 'recall': 0.6260333, 'specificity': 0.6260333, 'f1': 0.68902946, 'auroc': 0.9580382, 'binary_precision': 0.86243385, 'binary_recall': 0.2534992, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.39182693}
confusion matrix:
       0    1
0  18123   26
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.47912, 'recall': 0.499333, 'specificity': 0.499333, 'f1': 0.48901772, 'auroc': 0.9254565, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5989  8
1   261  0
early stop counter: 5
val acc:0.9730736613273621, best validation acc: 0.9737654328346252, corresponding to test acc:                         0.9616490602493286 / 0.9729945659637451
after epoch: 21,now: 2024-07-30 14:49:54.932544,epoch time: 0:15:15.082607,used: 5:08:13.108029,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9985624, 'precision': 0.9986758, 'recall': 0.99756896, 'specificity': 0.99756896, 'f1': 0.9981208, 'auroc': 0.9999064, 'binary_precision': 0.99890924, 'binary_recall': 0.995516, 'binary_specificity': 0.9996219, 'binary_f1_score': 0.9972097}
confusion matrix:
       0      1
0  42305     16
1     66  14653
---- Validation: 
scalar performance:
{'acc': 0.96934867, 'precision': 0.82387984, 'recall': 0.59860295, 'specificity': 0.59860295, 'f1': 0.6468395, 'auroc': 0.9003318, 'binary_precision': 0.6753927, 'binary_recall': 0.20062208, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.30935252}
confusion matrix:
       0    1
0  18087   62
1    514  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.73211396, 'recall': 0.5732933, 'specificity': 0.5732933, 'f1': 0.60658336, 'auroc': 0.92346716, 'binary_precision': 0.5, 'binary_recall': 0.1532567, 'binary_specificity': 0.99333, 'binary_f1_score': 0.23460409}
confusion matrix:
      0   1
0  5957  40
1   221  40
early stop counter: 6
val acc:0.969348669052124, best validation acc: 0.9737654328346252, corresponding to test acc:                         0.9616490602493286 / 0.9729945659637451
after epoch: 22,now: 2024-07-30 15:05:11.597697,epoch time: 0:15:16.665153,used: 5:23:29.773182,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9942321, 'precision': 0.99291086, 'recall': 0.99201393, 'specificity': 0.99201393, 'f1': 0.9924613, 'auroc': 0.9993672, 'binary_precision': 0.9901887, 'binary_recall': 0.98743033, 'binary_specificity': 0.9965975, 'binary_f1_score': 0.9888076}
confusion matrix:
       0      1
0  42178    144
1    185  14533
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.82886475, 'recall': 0.5221924, 'specificity': 0.5221924, 'f1': 0.53383964, 'auroc': 0.89384437, 'binary_precision': 0.6904762, 'binary_recall': 0.045101088, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.08467153}
confusion matrix:
       0   1
0  18136  13
1    614  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9224007, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
early stop counter: 7
val acc:0.9666347503662109, best validation acc: 0.9737654328346252, corresponding to test acc:                         0.9616490602493286 / 0.9729945659637451
after epoch: 23,now: 2024-07-30 15:20:49.497913,epoch time: 0:15:37.900216,used: 5:39:07.673398,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99814165, 'precision': 0.99848163, 'recall': 0.9966644, 'specificity': 0.9966644, 'f1': 0.9975687, 'auroc': 0.9999372, 'binary_precision': 0.99918, 'binary_recall': 0.9936124, 'binary_specificity': 0.99971646, 'binary_f1_score': 0.9963885}
confusion matrix:
       0      1
0  42312     12
1     94  14622
---- Validation: 
scalar performance:
{'acc': 0.9664219, 'precision': 0.74552596, 'recall': 0.7103461, 'specificity': 0.7103461, 'f1': 0.7264273, 'auroc': 0.9425382, 'binary_precision': 0.5109489, 'binary_recall': 0.43545878, 'binary_specificity': 0.98523337, 'binary_f1_score': 0.4701931}
confusion matrix:
       0    1
0  17881  268
1    363  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8770628, 'recall': 0.5984496, 'specificity': 0.5984496, 'f1': 0.64987385, 'auroc': 0.96355456, 'binary_precision': 0.7878788, 'binary_recall': 0.19923371, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.3180428}
confusion matrix:
      0   1
0  5983  14
1   209  52
early stop counter: 8
val acc:0.966421902179718, best validation acc: 0.9737654328346252, corresponding to test acc:                         0.9616490602493286 / 0.9729945659637451
after epoch: 24,now: 2024-07-30 15:36:33.703138,epoch time: 0:15:44.205225,used: 5:54:51.878623,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99815917, 'precision': 0.99791527, 'recall': 0.9972745, 'specificity': 0.9972745, 'f1': 0.99759436, 'auroc': 0.99990636, 'binary_precision': 0.9974125, 'binary_recall': 0.9954468, 'binary_specificity': 0.9991022, 'binary_f1_score': 0.99642867}
confusion matrix:
       0      1
0  42287     38
1     67  14648
---- Validation: 
scalar performance:
{'acc': 0.97115797, 'precision': 0.79176295, 'recall': 0.7255489, 'specificity': 0.7255489, 'f1': 0.7540084, 'auroc': 0.9631177, 'binary_precision': 0.6024341, 'binary_recall': 0.46189734, 'binary_specificity': 0.98920053, 'binary_f1_score': 0.52288735}
confusion matrix:
       0    1
0  17953  196
1    346  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292932, 'recall': 0.5036647, 'specificity': 0.5036647, 'f1': 0.496895, 'auroc': 0.94770914, 'binary_precision': 0.5, 'binary_recall': 0.007662835, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.015094339}
confusion matrix:
      0  1
0  5995  2
1   259  2
early stop counter: 9
val acc:0.971157968044281, best validation acc: 0.9737654328346252, corresponding to test acc:                         0.9616490602493286 / 0.9729945659637451
after epoch: 25,now: 2024-07-30 15:54:34.233147,epoch time: 0:18:00.530009,used: 6:12:52.408632,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99465287, 'precision': 0.9911079, 'recall': 0.99502265, 'specificity': 0.99502265, 'f1': 0.9930445, 'auroc': 0.99979377, 'binary_precision': 0.9836869, 'binary_recall': 0.9957866, 'binary_specificity': 0.9942587, 'binary_f1_score': 0.9896997}
confusion matrix:
       0      1
0  42082    243
1     62  14653
---- Validation: 
scalar performance:
{'acc': 0.9562048, 'precision': 0.7026749, 'recall': 0.8310658, 'specificity': 0.8310658, 'f1': 0.749143, 'auroc': 0.9545877, 'binary_precision': 0.4163569, 'binary_recall': 0.6967341, 'binary_specificity': 0.96539754, 'binary_f1_score': 0.52123326}
confusion matrix:
       0    1
0  17521  628
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97778845, 'precision': 0.8823751, 'recall': 0.8216685, 'specificity': 0.8216685, 'f1': 0.8491322, 'auroc': 0.9481218, 'binary_precision': 0.7798165, 'binary_recall': 0.651341, 'binary_specificity': 0.991996, 'binary_f1_score': 0.70981205}
confusion matrix:
      0    1
0  5949   48
1    91  170
new oracle model saved
early stop counter: 10
val acc:0.9562047719955444, best validation acc: 0.9737654328346252, corresponding to test acc:                         0.9616490602493286 / 0.9777884483337402
after epoch: 26,now: 2024-07-30 16:11:13.038120,epoch time: 0:16:38.804973,used: 6:29:31.213605,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9978962, 'precision': 0.99679434, 'recall': 0.9977179, 'specificity': 0.9977179, 'f1': 0.997255, 'auroc': 0.99993664, 'binary_precision': 0.99451107, 'binary_recall': 0.9973496, 'binary_specificity': 0.9980862, 'binary_f1_score': 0.99592835}
confusion matrix:
       0      1
0  42244     81
1     39  14676
---- Validation: 
scalar performance:
{'acc': 0.9713176, 'precision': 0.78296137, 'recall': 0.7833859, 'specificity': 0.7833859, 'f1': 0.78317344, 'auroc': 0.9555721, 'binary_precision': 0.58074534, 'binary_recall': 0.5816485, 'binary_specificity': 0.98512316, 'binary_f1_score': 0.5811966}
confusion matrix:
       0    1
0  17879  270
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8027017, 'recall': 0.64942145, 'specificity': 0.64942145, 'f1': 0.69736063, 'auroc': 0.9543198, 'binary_precision': 0.63492066, 'binary_recall': 0.3065134, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.41343668}
confusion matrix:
      0   1
0  5951  46
1   181  80
early stop counter: 11
val acc:0.9713175892829895, best validation acc: 0.9737654328346252, corresponding to test acc:                         0.9616490602493286 / 0.9777884483337402
after epoch: 27,now: 2024-07-30 16:28:38.531457,epoch time: 0:17:25.493337,used: 6:46:56.706942,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99824685, 'precision': 0.9988214, 'recall': 0.99660254, 'specificity': 0.99660254, 'f1': 0.9977056, 'auroc': 0.99995255, 'binary_precision': 1.0, 'binary_recall': 0.99320513, 'binary_specificity': 1.0, 'binary_f1_score': 0.99659103}
confusion matrix:
       0      1
0  42323      0
1    100  14617
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.9536917, 'recall': 0.5473237, 'specificity': 0.5473237, 'f1': 0.5782127, 'auroc': 0.9629379, 'binary_precision': 0.93846154, 'binary_recall': 0.09486781, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.17231639}
confusion matrix:
       0   1
0  18145   4
1    582  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.6042133, 'recall': 0.5016656, 'specificity': 0.5016656, 'f1': 0.49303976, 'auroc': 0.94644785, 'binary_precision': 0.25, 'binary_recall': 0.0038314175, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0075471695}
confusion matrix:
      0  1
0  5994  3
1   260  1
early stop counter: 12
val acc:0.9688165187835693, best validation acc: 0.9737654328346252, corresponding to test acc:                         0.9616490602493286 / 0.9777884483337402
after epoch: 28,now: 2024-07-30 16:43:00.180221,epoch time: 0:14:21.648764,used: 7:01:18.355706,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99814165, 'precision': 0.99781525, 'recall': 0.9973295, 'specificity': 0.9973295, 'f1': 0.99757206, 'auroc': 0.9998846, 'binary_precision': 0.9971419, 'binary_recall': 0.9956513, 'binary_specificity': 0.99900764, 'binary_f1_score': 0.99639606}
confusion matrix:
       0      1
0  42281     42
1     64  14653
---- Validation: 
scalar performance:
{'acc': 0.9706258, 'precision': 0.79568434, 'recall': 0.68777066, 'specificity': 0.68777066, 'f1': 0.7285839, 'auroc': 0.94867796, 'binary_precision': 0.61290324, 'binary_recall': 0.38413686, 'binary_specificity': 0.9914045, 'binary_f1_score': 0.47227532}
confusion matrix:
       0    1
0  17993  156
1    396  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.47912, 'recall': 0.499333, 'specificity': 0.499333, 'f1': 0.48901772, 'auroc': 0.9371231, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5989  8
1   261  0
early stop counter: 13
val acc:0.9706258177757263, best validation acc: 0.9737654328346252, corresponding to test acc:                         0.9616490602493286 / 0.9777884483337402
after epoch: 29,now: 2024-07-30 16:57:22.711290,epoch time: 0:14:22.531069,used: 7:15:40.886775,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9987553, 'precision': 0.99882805, 'recall': 0.9979203, 'specificity': 0.9979203, 'f1': 0.99837303, 'auroc': 0.99992967, 'binary_precision': 0.9989779, 'binary_recall': 0.9961949, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.99758446}
confusion matrix:
       0      1
0  42308     15
1     56  14661
---- Validation: 
scalar performance:
{'acc': 0.9701469, 'precision': 0.8933048, 'recall': 0.58176494, 'specificity': 0.58176494, 'f1': 0.6295081, 'auroc': 0.96565336, 'binary_precision': 0.8153846, 'binary_recall': 0.16485226, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.27425614}
confusion matrix:
       0    1
0  18125   24
1    537  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8938107, 'recall': 0.6043635, 'specificity': 0.6043635, 'f1': 0.6587397, 'auroc': 0.93600106, 'binary_precision': 0.8208955, 'binary_recall': 0.21072797, 'binary_specificity': 0.997999, 'binary_f1_score': 0.33536586}
confusion matrix:
      0   1
0  5985  12
1   206  55
early stop counter: 14
val acc:0.970146894454956, best validation acc: 0.9737654328346252, corresponding to test acc:                         0.9616490602493286 / 0.9777884483337402
after epoch: 30,now: 2024-07-30 17:12:34.289322,epoch time: 0:15:11.578032,used: 7:30:52.464807,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_09_41_41_seed_0_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:30:52.464807 at 2024-07-30 17:12:34.289322
persisted model performance metric: 

scalar performance:
{'acc': 0.96164906, 'precision': 0.86604327, 'recall': 0.5567209, 'specificity': 0.5567209, 'f1': 0.5901768, 'auroc': 0.9273208, 'binary_precision': 0.7692308, 'binary_recall': 0.11494253, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.19999999}
confusion matrix:
      0   1
0  5988   9
1   231  30
oracle model performance metric: 

scalar performance:
{'acc': 0.97778845, 'precision': 0.8823751, 'recall': 0.8216685, 'specificity': 0.8216685, 'f1': 0.8491322, 'auroc': 0.9481218, 'binary_precision': 0.7798165, 'binary_recall': 0.651341, 'binary_specificity': 0.991996, 'binary_f1_score': 0.70981205}
confusion matrix:
      0    1
0  5949   48
1    91  170
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_irm_config4_2_2024-07-29_15-36-39/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_irm_config4_2_2024-07-29_15-36-39/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_irm_config4_2_2024-07-29_15-36-39/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 504896 KiB |  13265 MiB |   1440 TiB |   1440 TiB |
|       from large pool | 463209 KiB |  13227 MiB |   1424 TiB |   1424 TiB |
|       from small pool |  41687 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 504896 KiB |  13265 MiB |   1440 TiB |   1440 TiB |
|       from large pool | 463209 KiB |  13227 MiB |   1424 TiB |   1424 TiB |
|       from small pool |  41687 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496650 KiB |  13261 MiB |   1439 TiB |   1439 TiB |
|       from large pool | 455971 KiB |  13223 MiB |   1423 TiB |   1423 TiB |
|       from small pool |  40679 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14538 MiB |  14538 MiB |  14538 MiB |      0 B   |
|       from large pool |  14466 MiB |  14466 MiB |  14466 MiB |      0 B   |
|       from small pool |     72 MiB |     72 MiB |     72 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 488383 KiB |   1254 MiB |   1004 TiB |   1004 TiB |
|       from large pool | 478871 KiB |   1250 MiB |    988 TiB |    988 TiB |
|       from small pool |   9512 KiB |     15 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8135    |  249159 K  |  249155 K  |
|       from large pool |     187    |    1413    |  130853 K  |  130853 K  |
|       from small pool |    3301    |    7946    |  118305 K  |  118301 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8135    |  249159 K  |  249155 K  |
|       from large pool |     187    |    1413    |  130853 K  |  130853 K  |
|       from small pool |    3301    |    7946    |  118305 K  |  118301 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     640    |     640    |     640    |       0    |
|       from large pool |     604    |     604    |     604    |       0    |
|       from small pool |      36    |      36    |      36    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    3629    |  144553 K  |  144553 K  |
|       from large pool |      39    |     604    |   81683 K  |   81683 K  |
|       from small pool |      41    |    3589    |   62869 K  |   62869 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13265 MiB |   1440 TiB |   1440 TiB |
|       from large pool |  65536 KiB |  13227 MiB |   1424 TiB |   1424 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13265 MiB |   1440 TiB |   1440 TiB |
|       from large pool |  65536 KiB |  13227 MiB |   1424 TiB |   1424 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   1439 TiB |   1439 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   1423 TiB |   1423 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    970 MiB |  14538 MiB |  14538 MiB |  13568 MiB |
|       from large pool |    920 MiB |  14466 MiB |  14466 MiB |  13546 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1254 MiB |   1004 TiB |   1004 TiB |
|       from large pool |      0 B   |   1250 MiB |    988 TiB |    988 TiB |
|       from small pool |      0 B   |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  249159 K  |  249159 K  |
|       from large pool |       2    |    1413    |  130853 K  |  130853 K  |
|       from small pool |       0    |    7946    |  118305 K  |  118305 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  249159 K  |  249159 K  |
|       from large pool |       2    |    1413    |  130853 K  |  130853 K  |
|       from small pool |       0    |    7946    |  118305 K  |  118305 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     640    |     640    |     574    |
|       from large pool |      41    |     604    |     604    |     563    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3629    |  144554 K  |  144554 K  |
|       from large pool |       0    |     604    |   81683 K  |   81683 K  |
|       from small pool |       0    |    3589    |   62870 K  |   62870 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13265 MiB |   1440 TiB |   1440 TiB |
|       from large pool |  65536 KiB |  13227 MiB |   1424 TiB |   1424 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13265 MiB |   1440 TiB |   1440 TiB |
|       from large pool |  65536 KiB |  13227 MiB |   1424 TiB |   1424 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   1439 TiB |   1439 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   1423 TiB |   1423 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    970 MiB |  14538 MiB |  14538 MiB |  13568 MiB |
|       from large pool |    920 MiB |  14466 MiB |  14466 MiB |  13546 MiB |
|       from small pool |     50 MiB |     72 MiB |     72 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1254 MiB |   1004 TiB |   1004 TiB |
|       from large pool |      0 B   |   1250 MiB |    988 TiB |    988 TiB |
|       from small pool |      0 B   |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  249159 K  |  249159 K  |
|       from large pool |       2    |    1413    |  130853 K  |  130853 K  |
|       from small pool |       0    |    7946    |  118305 K  |  118305 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  249159 K  |  249159 K  |
|       from large pool |       2    |    1413    |  130853 K  |  130853 K  |
|       from small pool |       0    |    7946    |  118305 K  |  118305 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     640    |     640    |     574    |
|       from large pool |      41    |     604    |     604    |     563    |
|       from small pool |      25    |      36    |      36    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3629    |  144554 K  |  144554 K  |
|       from large pool |       0    |     604    |   81683 K  |   81683 K  |
|       from small pool |       0    |    3589    |   62870 K  |   62870 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104

 Experiment start at: 2024-07-30 17:18:22.889792
before training, model accuracy: 0.6475991010665894
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9937183, 'precision': 0.994755, 'recall': 0.98865044, 'specificity': 0.98865044, 'f1': 0.9916547, 'auroc': 0.99882686, 'binary_precision': 0.9968202, 'binary_recall': 0.9783619, 'binary_specificity': 0.998939, 'binary_f1_score': 0.98750484}
confusion matrix:
       0      1
0  42368     45
1    312  14107
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.74169075, 'recall': 0.76750994, 'specificity': 0.76750994, 'f1': 0.753863, 'auroc': 0.93452585, 'binary_precision': 0.5, 'binary_recall': 0.5557206, 'binary_specificity': 0.97929925, 'binary_f1_score': 0.5263899}
confusion matrix:
       0    1
0  17693  374
1    299  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97180146, 'precision': 0.9216485, 'recall': 0.69104636, 'specificity': 0.69104636, 'f1': 0.75939745, 'auroc': 0.91972697, 'binary_precision': 0.8695652, 'binary_recall': 0.3846154, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.53333336}
confusion matrix:
      0    1
0  5931   15
1   160  100
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-30 17:32:44.934757,epoch time: 0:14:22.044965,used: 0:14:22.044965,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9928737, 'precision': 0.99483645, 'recall': 0.98636895, 'specificity': 0.98636895, 'f1': 0.9905106, 'auroc': 0.9991019, 'binary_precision': 0.998719, 'binary_recall': 0.9731623, 'binary_specificity': 0.9995756, 'binary_f1_score': 0.98577505}
confusion matrix:
       0      1
0  42394     18
1    387  14033
---- Validation: 
scalar performance:
{'acc': 0.9698506, 'precision': 0.8185597, 'recall': 0.66106296, 'specificity': 0.66106296, 'f1': 0.7117183, 'auroc': 0.9315578, 'binary_precision': 0.66167665, 'binary_recall': 0.32838038, 'binary_specificity': 0.9937455, 'binary_f1_score': 0.4389275}
confusion matrix:
       0    1
0  17954  113
1    452  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.90232575, 'recall': 0.5896278, 'specificity': 0.5896278, 'f1': 0.6395576, 'auroc': 0.9303093, 'binary_precision': 0.83928573, 'binary_recall': 0.18076923, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.29746836}
confusion matrix:
      0   1
0  5937   9
1   213  47
better model found
persisted
after epoch: 2,now: 2024-07-30 17:46:42.475410,epoch time: 0:13:57.540653,used: 0:28:19.585618,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9945805, 'precision': 0.9947956, 'recall': 0.99087596, 'specificity': 0.99087596, 'f1': 0.992816, 'auroc': 0.99937594, 'binary_precision': 0.99522704, 'binary_recall': 0.9833553, 'binary_specificity': 0.9983967, 'binary_f1_score': 0.98925555}
confusion matrix:
       0      1
0  42345     68
1    240  14179
---- Validation: 
scalar performance:
{'acc': 0.96808964, 'precision': 0.7731172, 'recall': 0.7338222, 'specificity': 0.7338222, 'f1': 0.75178015, 'auroc': 0.9503392, 'binary_precision': 0.565445, 'binary_recall': 0.48142645, 'binary_specificity': 0.986218, 'binary_f1_score': 0.52006423}
confusion matrix:
       0    1
0  17818  249
1    349  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.8473985, 'recall': 0.541635, 'specificity': 0.541635, 'f1': 0.56571525, 'auroc': 0.94774127, 'binary_precision': 0.73333335, 'binary_recall': 0.08461539, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.15172414}
confusion matrix:
      0   1
0  5938   8
1   238  22
early stop counter: 1
val acc:0.9680896401405334, best validation acc: 0.9698505997657776, corresponding to test acc:                         0.9642281532287598 / 0.9718014597892761
after epoch: 3,now: 2024-07-30 18:01:45.537653,epoch time: 0:15:03.062243,used: 0:43:22.647861,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9968328, 'precision': 0.9964979, 'recall': 0.9951312, 'specificity': 0.9951312, 'f1': 0.9958122, 'auroc': 0.9998025, 'binary_precision': 0.9958211, 'binary_recall': 0.99167705, 'binary_specificity': 0.99858534, 'binary_f1_score': 0.9937448}
confusion matrix:
       0      1
0  42354     60
1    120  14298
---- Validation: 
scalar performance:
{'acc': 0.9584312, 'precision': 0.71729076, 'recall': 0.81822145, 'specificity': 0.81822145, 'f1': 0.75686103, 'auroc': 0.950341, 'binary_precision': 0.44721115, 'binary_recall': 0.66716194, 'binary_specificity': 0.969281, 'binary_f1_score': 0.53548}
confusion matrix:
       0    1
0  17512  555
1    224  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.59843326, 'recall': 0.5082699, 'specificity': 0.5082699, 'f1': 0.50662386, 'auroc': 0.89734924, 'binary_precision': 0.23809524, 'binary_recall': 0.01923077, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.03558719}
confusion matrix:
      0   1
0  5930  16
1   255   5
early stop counter: 2
val acc:0.9584311842918396, best validation acc: 0.9698505997657776, corresponding to test acc:                         0.9642281532287598 / 0.9718014597892761
after epoch: 4,now: 2024-07-30 18:15:45.930699,epoch time: 0:14:00.393046,used: 0:57:23.040907,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9925394, 'precision': 0.9948329, 'recall': 0.9855032, 'specificity': 0.9855032, 'f1': 0.9900563, 'auroc': 0.9992912, 'binary_precision': 0.99935776, 'binary_recall': 0.9712185, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.9850872}
confusion matrix:
       0      1
0  42404      9
1    415  14004
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.7746077, 'recall': 0.58457184, 'specificity': 0.58457184, 'f1': 0.62495863, 'auroc': 0.9452436, 'binary_precision': 0.5792079, 'binary_recall': 0.17384844, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.26742858}
confusion matrix:
       0    1
0  17982   85
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542378, 'precision': 0.52919364, 'recall': 0.5034988, 'specificity': 0.5034988, 'f1': 0.49863058, 'auroc': 0.93059105, 'binary_precision': 0.1, 'binary_recall': 0.011538462, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.020689655}
confusion matrix:
      0   1
0  5919  27
1   257   3
early stop counter: 3
val acc:0.96579509973526, best validation acc: 0.9698505997657776, corresponding to test acc:                         0.9642281532287598 / 0.9718014597892761
after epoch: 5,now: 2024-07-30 18:30:10.289489,epoch time: 0:14:24.358790,used: 1:11:47.399697,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.996692, 'precision': 0.99674696, 'recall': 0.99451077, 'specificity': 0.99451077, 'f1': 0.9956224, 'auroc': 0.99966025, 'binary_precision': 0.99685776, 'binary_recall': 0.9900825, 'binary_specificity': 0.998939, 'binary_f1_score': 0.99345857}
confusion matrix:
       0      1
0  42368     45
1    143  14276
---- Validation: 
scalar performance:
{'acc': 0.96205974, 'precision': 0.72607994, 'recall': 0.72640336, 'specificity': 0.72640336, 'f1': 0.72624147, 'auroc': 0.9418713, 'binary_precision': 0.4718101, 'binary_recall': 0.47251114, 'binary_specificity': 0.98029554, 'binary_f1_score': 0.47216034}
confusion matrix:
       0    1
0  17711  356
1    355  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.954399, 'precision': 0.4990487, 'recall': 0.49990493, 'specificity': 0.49990493, 'f1': 0.49184063, 'auroc': 0.90297794, 'binary_precision': 0.04, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.007017544}
confusion matrix:
      0   1
0  5922  24
1   259   1
early stop counter: 4
val acc:0.962059736251831, best validation acc: 0.9698505997657776, corresponding to test acc:                         0.9642281532287598 / 0.9718014597892761
after epoch: 6,now: 2024-07-30 18:45:24.322259,epoch time: 0:15:14.032770,used: 1:27:01.432467,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9964809, 'precision': 0.9967898, 'recall': 0.993912, 'specificity': 0.993912, 'f1': 0.9953402, 'auroc': 0.9997201, 'binary_precision': 0.9974115, 'binary_recall': 0.9886963, 'binary_specificity': 0.9991276, 'binary_f1_score': 0.9930347}
confusion matrix:
       0      1
0  42375     37
1    163  14257
---- Validation: 
scalar performance:
{'acc': 0.9711846, 'precision': 0.78939164, 'recall': 0.8083846, 'specificity': 0.8083846, 'f1': 0.79855275, 'auroc': 0.9574592, 'binary_precision': 0.59248954, 'binary_recall': 0.6329866, 'binary_specificity': 0.9837826, 'binary_f1_score': 0.61206895}
confusion matrix:
       0    1
0  17774  293
1    247  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7650658, 'recall': 0.50744003, 'specificity': 0.50744003, 'f1': 0.5043185, 'auroc': 0.9212122, 'binary_precision': 0.5714286, 'binary_recall': 0.015384615, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.029962547}
confusion matrix:
      0  1
0  5943  3
1   256  4
better model found
persisted
after epoch: 7,now: 2024-07-30 19:00:13.775432,epoch time: 0:14:49.453173,used: 1:41:50.885640,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9966216, 'precision': 0.99535966, 'recall': 0.9957223, 'specificity': 0.9957223, 'f1': 0.99554074, 'auroc': 0.99970853, 'binary_precision': 0.9927948, 'binary_recall': 0.99389654, 'binary_specificity': 0.997548, 'binary_f1_score': 0.9933454}
confusion matrix:
       0      1
0  42310    104
1     88  14330
---- Validation: 
scalar performance:
{'acc': 0.9717716, 'precision': 0.8505293, 'recall': 0.6699272, 'specificity': 0.6699272, 'f1': 0.72638625, 'auroc': 0.9493805, 'binary_precision': 0.725, 'binary_recall': 0.3447251, 'binary_specificity': 0.9951292, 'binary_f1_score': 0.46727088}
confusion matrix:
       0    1
0  17979   88
1    441  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.66115636, 'recall': 0.5071037, 'specificity': 0.5071037, 'f1': 0.5039291, 'auroc': 0.9332266, 'binary_precision': 0.36363637, 'binary_recall': 0.015384615, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.029520296}
confusion matrix:
      0  1
0  5939  7
1   256  4
better model found
persisted
after epoch: 8,now: 2024-07-30 19:15:51.530158,epoch time: 0:15:37.754726,used: 1:57:28.640366,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99614656, 'precision': 0.9971726, 'recall': 0.9926561, 'specificity': 0.9926561, 'f1': 0.9948882, 'auroc': 0.99973756, 'binary_precision': 0.9992264, 'binary_recall': 0.98557156, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.992352}
confusion matrix:
       0      1
0  42405     11
1    208  14208
---- Validation: 
scalar performance:
{'acc': 0.9693703, 'precision': 0.88725257, 'recall': 0.5964398, 'specificity': 0.5964398, 'f1': 0.6488665, 'auroc': 0.96331275, 'binary_precision': 0.80368096, 'binary_recall': 0.19465081, 'binary_specificity': 0.9982288, 'binary_f1_score': 0.31339714}
confusion matrix:
       0    1
0  18035   32
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9555269, 'precision': 0.4789984, 'recall': 0.49865454, 'specificity': 0.49865454, 'f1': 0.48862886, 'auroc': 0.93033665, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5930  16
1   260   0
early stop counter: 1
val acc:0.9693703055381775, best validation acc: 0.9717715978622437, corresponding to test acc:                         0.9576216340065002 / 0.9718014597892761
after epoch: 9,now: 2024-07-30 19:30:46.221208,epoch time: 0:14:54.691050,used: 2:12:23.331416,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9968328, 'precision': 0.9964752, 'recall': 0.9951544, 'specificity': 0.9951544, 'f1': 0.99581254, 'auroc': 0.99983776, 'binary_precision': 0.9957524, 'binary_recall': 0.991747, 'binary_specificity': 0.99856174, 'binary_f1_score': 0.9937456}
confusion matrix:
       0      1
0  42352     61
1    119  14300
---- Validation: 
scalar performance:
{'acc': 0.9689968, 'precision': 0.8123067, 'recall': 0.6448843, 'specificity': 0.6448843, 'f1': 0.69530994, 'auroc': 0.95156145, 'binary_precision': 0.6503268, 'binary_recall': 0.29569092, 'binary_specificity': 0.9940776, 'binary_f1_score': 0.40653726}
confusion matrix:
       0    1
0  17960  107
1    474  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95601034, 'precision': 0.47900856, 'recall': 0.49890682, 'specificity': 0.49890682, 'f1': 0.48875523, 'auroc': 0.9462258, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5933  13
1   260   0
early stop counter: 2
val acc:0.9689968228340149, best validation acc: 0.9717715978622437, corresponding to test acc:                         0.9576216340065002 / 0.9718014597892761
after epoch: 10,now: 2024-07-30 19:45:50.560643,epoch time: 0:15:04.339435,used: 2:27:27.670851,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99678, 'precision': 0.99773467, 'recall': 0.99376863, 'specificity': 0.99376863, 'f1': 0.9957315, 'auroc': 0.9997448, 'binary_precision': 0.99964905, 'binary_recall': 0.98765516, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.9936159}
confusion matrix:
       0      1
0  42408      5
1    178  14241
---- Validation: 
scalar performance:
{'acc': 0.96798295, 'precision': 0.93470407, 'recall': 0.56067216, 'specificity': 0.56067216, 'f1': 0.59915906, 'auroc': 0.9619724, 'binary_precision': 0.9010989, 'binary_recall': 0.121842496, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.2146597}
confusion matrix:
       0   1
0  18058   9
1    591  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.9555758, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
early stop counter: 3
val acc:0.9679829478263855, best validation acc: 0.9717715978622437, corresponding to test acc:                         0.9576216340065002 / 0.9718014597892761
after epoch: 11,now: 2024-07-30 20:00:44.064042,epoch time: 0:14:53.503399,used: 2:42:21.174250,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99656886, 'precision': 0.99643433, 'recall': 0.99449694, 'specificity': 0.99449694, 'f1': 0.99546075, 'auroc': 0.99981844, 'binary_precision': 0.99616295, 'binary_recall': 0.9902906, 'binary_specificity': 0.99870324, 'binary_f1_score': 0.99321806}
confusion matrix:
       0      1
0  42358     55
1    140  14279
---- Validation: 
scalar performance:
{'acc': 0.9677161, 'precision': 0.76546574, 'recall': 0.7915651, 'specificity': 0.7915651, 'f1': 0.77783144, 'auroc': 0.93965477, 'binary_precision': 0.5458221, 'binary_recall': 0.60178304, 'binary_specificity': 0.9813472, 'binary_f1_score': 0.5724381}
confusion matrix:
       0    1
0  17730  337
1    268  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.81345797, 'recall': 0.7646789, 'specificity': 0.7646789, 'f1': 0.78676724, 'auroc': 0.9365771, 'binary_precision': 0.646789, 'binary_recall': 0.5423077, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.58995813}
confusion matrix:
      0    1
0  5869   77
1   119  141
early stop counter: 4
val acc:0.9677160978317261, best validation acc: 0.9717715978622437, corresponding to test acc:                         0.9576216340065002 / 0.9718014597892761
after epoch: 12,now: 2024-07-30 20:15:01.659800,epoch time: 0:14:17.595758,used: 2:56:38.770008,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99785334, 'precision': 0.9984264, 'recall': 0.99590683, 'specificity': 0.99590683, 'f1': 0.9971584, 'auroc': 0.99991405, 'binary_precision': 0.9995807, 'binary_recall': 0.99195504, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.9957533}
confusion matrix:
       0      1
0  42407      6
1    116  14303
---- Validation: 
scalar performance:
{'acc': 0.97545356, 'precision': 0.88467246, 'recall': 0.7133222, 'specificity': 0.7133222, 'f1': 0.7725344, 'auroc': 0.95738006, 'binary_precision': 0.79019076, 'binary_recall': 0.4309064, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.5576923}
confusion matrix:
       0    1
0  17990   77
1    383  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.9080843, 'recall': 0.51145434, 'specificity': 0.51145434, 'f1': 0.5119738, 'auroc': 0.9352359, 'binary_precision': 0.85714287, 'binary_recall': 0.023076924, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.04494382}
confusion matrix:
      0  1
0  5945  1
1   254  6
better model found
persisted
after epoch: 13,now: 2024-07-30 20:32:07.723983,epoch time: 0:17:06.064183,used: 3:13:44.834191,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9979413, 'precision': 0.9984155, 'recall': 0.9961488, 'specificity': 0.9961488, 'f1': 0.9972756, 'auroc': 0.9999044, 'binary_precision': 0.9993715, 'binary_recall': 0.9925099, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.99592894}
confusion matrix:
       0      1
0  42404      9
1    108  14311
---- Validation: 
scalar performance:
{'acc': 0.97155815, 'precision': 0.903229, 'recall': 0.62904626, 'specificity': 0.62904626, 'f1': 0.690906, 'auroc': 0.9520711, 'binary_precision': 0.8333333, 'binary_recall': 0.2600297, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.39637598}
confusion matrix:
       0    1
0  18032   35
1    498  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7795029, 'recall': 0.5112021, 'specificity': 0.5112021, 'f1': 0.511598, 'auroc': 0.9349611, 'binary_precision': 0.6, 'binary_recall': 0.023076924, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.04444444}
confusion matrix:
      0  1
0  5942  4
1   254  6
early stop counter: 1
val acc:0.971558153629303, best validation acc: 0.9754535555839539, corresponding to test acc:                         0.9589107036590576 / 0.9718014597892761
after epoch: 14,now: 2024-07-30 20:46:03.774373,epoch time: 0:13:56.050390,used: 3:27:40.884581,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9961817, 'precision': 0.9967519, 'recall': 0.9931618, 'specificity': 0.9931618, 'f1': 0.9949403, 'auroc': 0.99973464, 'binary_precision': 0.9978965, 'binary_recall': 0.987031, 'binary_specificity': 0.9992927, 'binary_f1_score': 0.992434}
confusion matrix:
       0      1
0  42383     30
1    187  14232
---- Validation: 
scalar performance:
{'acc': 0.96808964, 'precision': 0.81993157, 'recall': 0.60865045, 'specificity': 0.60865045, 'f1': 0.6581217, 'auroc': 0.9488386, 'binary_precision': 0.66816145, 'binary_recall': 0.22139673, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.33258927}
confusion matrix:
       0    1
0  17993   74
1    524  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.47903225, 'recall': 0.49949545, 'specificity': 0.49949545, 'f1': 0.4890499, 'auroc': 0.9408128, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5940  6
1   260  0
early stop counter: 2
val acc:0.9680896401405334, best validation acc: 0.9754535555839539, corresponding to test acc:                         0.9589107036590576 / 0.9718014597892761
after epoch: 15,now: 2024-07-30 21:01:16.488661,epoch time: 0:15:12.714288,used: 3:42:53.598869,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9977477, 'precision': 0.99826306, 'recall': 0.9957906, 'specificity': 0.9957906, 'f1': 0.997019, 'auroc': 0.99986327, 'binary_precision': 0.9993013, 'binary_recall': 0.99181694, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.9955451}
confusion matrix:
       0      1
0  42402     10
1    118  14302
---- Validation: 
scalar performance:
{'acc': 0.9701174, 'precision': 0.96111953, 'recall': 0.588244, 'specificity': 0.588244, 'f1': 0.6414896, 'auroc': 0.9443995, 'binary_precision': 0.952, 'binary_recall': 0.1768202, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.29824564}
confusion matrix:
       0    1
0  18061    6
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.937692, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
early stop counter: 3
val acc:0.9701173901557922, best validation acc: 0.9754535555839539, corresponding to test acc:                         0.9589107036590576 / 0.9718014597892761
after epoch: 16,now: 2024-07-30 21:15:44.144191,epoch time: 0:14:27.655530,used: 3:57:21.254399,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9967624, 'precision': 0.99516606, 'recall': 0.99629736, 'specificity': 0.99629736, 'f1': 0.9957301, 'auroc': 0.9998835, 'binary_precision': 0.99191374, 'binary_recall': 0.99535334, 'binary_specificity': 0.99724144, 'binary_f1_score': 0.9936306}
confusion matrix:
       0      1
0  42296    117
1     67  14352
---- Validation: 
scalar performance:
{'acc': 0.9713447, 'precision': 0.8029464, 'recall': 0.7483852, 'specificity': 0.7483852, 'f1': 0.7726933, 'auroc': 0.95744544, 'binary_precision': 0.6240876, 'binary_recall': 0.50817233, 'binary_specificity': 0.988598, 'binary_f1_score': 0.5601966}
confusion matrix:
       0    1
0  17861  206
1    331  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9513374, 'precision': 0.5349119, 'recall': 0.50750214, 'specificity': 0.50750214, 'f1': 0.5066269, 'auroc': 0.9009851, 'binary_precision': 0.11111111, 'binary_recall': 0.023076924, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.03821656}
confusion matrix:
      0   1
0  5898  48
1   254   6
early stop counter: 4
val acc:0.9713447093963623, best validation acc: 0.9754535555839539, corresponding to test acc:                         0.9589107036590576 / 0.9718014597892761
after epoch: 17,now: 2024-07-30 21:29:19.659107,epoch time: 0:13:35.514916,used: 4:10:56.769315,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99841636, 'precision': 0.99889493, 'recall': 0.9969247, 'specificity': 0.9969247, 'f1': 0.99790484, 'auroc': 0.9999213, 'binary_precision': 0.99986047, 'binary_recall': 0.99389654, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.99686956}
confusion matrix:
       0      1
0  42412      2
1     88  14330
---- Validation: 
scalar performance:
{'acc': 0.96574175, 'precision': 0.782043, 'recall': 0.5702388, 'specificity': 0.5702388, 'f1': 0.6072687, 'auroc': 0.9513055, 'binary_precision': 0.595092, 'binary_recall': 0.14413075, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.2320574}
confusion matrix:
       0   1
0  18001  66
1    576  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.70705926, 'recall': 0.5182217, 'specificity': 0.5182217, 'f1': 0.5246613, 'auroc': 0.92988026, 'binary_precision': 0.45454547, 'binary_recall': 0.03846154, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.07092199}
confusion matrix:
      0   1
0  5934  12
1   250  10
early stop counter: 5
val acc:0.965741753578186, best validation acc: 0.9754535555839539, corresponding to test acc:                         0.9589107036590576 / 0.9718014597892761
after epoch: 18,now: 2024-07-30 21:42:57.841494,epoch time: 0:13:38.182387,used: 4:24:34.951702,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9977477, 'precision': 0.9977784, 'recall': 0.99627113, 'specificity': 0.99627113, 'f1': 0.99702185, 'auroc': 0.9998511, 'binary_precision': 0.99784034, 'binary_recall': 0.99327326, 'binary_specificity': 0.99926907, 'binary_f1_score': 0.9955515}
confusion matrix:
       0      1
0  42381     31
1     97  14323
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.8191121, 'recall': 0.5765698, 'specificity': 0.5765698, 'f1': 0.6180476, 'auroc': 0.949588, 'binary_precision': 0.6687898, 'binary_recall': 0.15601783, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.25301203}
confusion matrix:
       0    1
0  18015   52
1    568  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.76029956, 'recall': 0.56311417, 'specificity': 0.56311417, 'f1': 0.59545666, 'auroc': 0.9126546, 'binary_precision': 0.55737704, 'binary_recall': 0.13076924, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.211838}
confusion matrix:
      0   1
0  5919  27
1   226  34
early stop counter: 6
val acc:0.9669156670570374, best validation acc: 0.9754535555839539, corresponding to test acc:                         0.9589107036590576 / 0.9718014597892761
after epoch: 19,now: 2024-07-30 21:56:34.967024,epoch time: 0:13:37.125530,used: 4:38:12.077232,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9975542, 'precision': 0.9975106, 'recall': 0.99602705, 'specificity': 0.99602705, 'f1': 0.996766, 'auroc': 0.9998559, 'binary_precision': 0.9974225, 'binary_recall': 0.9929265, 'binary_specificity': 0.9991276, 'binary_f1_score': 0.9951694}
confusion matrix:
       0      1
0  42375     37
1    102  14318
---- Validation: 
scalar performance:
{'acc': 0.9755603, 'precision': 0.85791254, 'recall': 0.7469951, 'specificity': 0.7469951, 'f1': 0.79140294, 'auroc': 0.95914984, 'binary_precision': 0.73420477, 'binary_recall': 0.5007429, 'binary_specificity': 0.99324733, 'binary_f1_score': 0.5954063}
confusion matrix:
       0    1
0  17945  122
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.78795123, 'recall': 0.5299283, 'specificity': 0.5299283, 'f1': 0.5454707, 'auroc': 0.9283822, 'binary_precision': 0.61538464, 'binary_recall': 0.06153846, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.11188811}
confusion matrix:
      0   1
0  5936  10
1   244  16
better model found
persisted
after epoch: 20,now: 2024-07-30 22:10:24.363112,epoch time: 0:13:49.396088,used: 4:52:01.473320,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9961993, 'precision': 0.9952068, 'recall': 0.9947531, 'specificity': 0.9947531, 'f1': 0.99497974, 'auroc': 0.9996499, 'binary_precision': 0.99319446, 'binary_recall': 0.99181694, 'binary_specificity': 0.9976893, 'binary_f1_score': 0.99250525}
confusion matrix:
       0      1
0  42314     98
1    118  14302
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.7965368, 'recall': 0.5305117, 'specificity': 0.5305117, 'f1': 0.54782915, 'auroc': 0.9465409, 'binary_precision': 0.6268657, 'binary_recall': 0.062407132, 'binary_specificity': 0.9986163, 'binary_f1_score': 0.113513514}
confusion matrix:
       0   1
0  18042  25
1    631  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.47902888, 'recall': 0.49941137, 'specificity': 0.49941137, 'f1': 0.4890078, 'auroc': 0.9071417, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5939  7
1   260  0
early stop counter: 1
val acc:0.9649946689605713, best validation acc: 0.9755603075027466, corresponding to test acc:                         0.9590718746185303 / 0.9718014597892761
after epoch: 21,now: 2024-07-30 22:24:05.840521,epoch time: 0:13:41.477409,used: 5:05:42.950729,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9960058, 'precision': 0.9935863, 'recall': 0.9959049, 'specificity': 0.9959049, 'f1': 0.9947386, 'auroc': 0.9997984, 'binary_precision': 0.9886379, 'binary_recall': 0.9957001, 'binary_specificity': 0.99610966, 'binary_f1_score': 0.9921565}
confusion matrix:
       0      1
0  42248    165
1     62  14357
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.75586283, 'recall': 0.86377513, 'specificity': 0.86377513, 'f1': 0.799201, 'auroc': 0.9619877, 'binary_precision': 0.5210689, 'binary_recall': 0.7533432, 'binary_specificity': 0.9742071, 'binary_f1_score': 0.61603886}
confusion matrix:
       0    1
0  17601  466
1    166  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.66785073, 'recall': 0.5320927, 'specificity': 0.5320927, 'f1': 0.5472056, 'auroc': 0.93904674, 'binary_precision': 0.375, 'binary_recall': 0.06923077, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.11688313}
confusion matrix:
      0   1
0  5916  30
1   242  18
early stop counter: 2
val acc:0.9662753343582153, best validation acc: 0.9755603075027466, corresponding to test acc:                         0.9590718746185303 / 0.9718014597892761
after epoch: 22,now: 2024-07-30 22:37:43.434086,epoch time: 0:13:37.593565,used: 5:19:20.544294,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9970967, 'precision': 0.9980389, 'recall': 0.9943017, 'specificity': 0.9943017, 'f1': 0.9961524, 'auroc': 0.99992883, 'binary_precision': 0.99992985, 'binary_recall': 0.9886269, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99424624}
confusion matrix:
       0      1
0  42411      1
1    164  14256
---- Validation: 
scalar performance:
{'acc': 0.96905017, 'precision': 0.92385006, 'recall': 0.5798226, 'specificity': 0.5798226, 'f1': 0.62777305, 'auroc': 0.9593183, 'binary_precision': 0.8780488, 'binary_recall': 0.16047548, 'binary_specificity': 0.99916977, 'binary_f1_score': 0.27135676}
confusion matrix:
       0    1
0  18052   15
1    565  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.4790424, 'recall': 0.49974772, 'specificity': 0.49974772, 'f1': 0.48917606, 'auroc': 0.91726506, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5943  3
1   260  0
early stop counter: 3
val acc:0.9690501689910889, best validation acc: 0.9755603075027466, corresponding to test acc:                         0.9590718746185303 / 0.9718014597892761
after epoch: 23,now: 2024-07-30 22:51:20.167268,epoch time: 0:13:36.733182,used: 5:32:57.277476,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99771255, 'precision': 0.99840224, 'recall': 0.995561, 'specificity': 0.995561, 'f1': 0.9969713, 'auroc': 0.9999216, 'binary_precision': 0.99979013, 'binary_recall': 0.99119276, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9954729}
confusion matrix:
       0      1
0  42409      3
1    127  14293
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.8108009, 'recall': 0.5764591, 'specificity': 0.5764591, 'f1': 0.6173854, 'auroc': 0.9401529, 'binary_precision': 0.65217394, 'binary_recall': 0.15601783, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.25179857}
confusion matrix:
       0    1
0  18011   56
1    568  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72920024, 'recall': 0.50367796, 'specificity': 0.50367796, 'f1': 0.49687442, 'auroc': 0.93791574, 'binary_precision': 0.5, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.015151515}
confusion matrix:
      0  1
0  5944  2
1   258  2
early stop counter: 4
val acc:0.9667022228240967, best validation acc: 0.9755603075027466, corresponding to test acc:                         0.9590718746185303 / 0.9718014597892761
after epoch: 24,now: 2024-07-30 23:05:00.311380,epoch time: 0:13:40.144112,used: 5:46:37.421588,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99729025, 'precision': 0.99793446, 'recall': 0.99491155, 'specificity': 0.99491155, 'f1': 0.9964113, 'auroc': 0.99982, 'binary_precision': 0.9992301, 'binary_recall': 0.9900825, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.9946352}
confusion matrix:
       0      1
0  42402     11
1    143  14276
---- Validation: 
scalar performance:
{'acc': 0.96766275, 'precision': 0.82128435, 'recall': 0.59555423, 'specificity': 0.59555423, 'f1': 0.64264566, 'auroc': 0.93300885, 'binary_precision': 0.6717949, 'binary_recall': 0.19465081, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.30184332}
confusion matrix:
       0    1
0  18003   64
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.9511354, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
early stop counter: 5
val acc:0.9676627516746521, best validation acc: 0.9755603075027466, corresponding to test acc:                         0.9590718746185303 / 0.9718014597892761
after epoch: 25,now: 2024-07-30 23:18:34.690318,epoch time: 0:13:34.378938,used: 6:00:11.800526,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9975894, 'precision': 0.9975113, 'recall': 0.99611926, 'specificity': 0.99611926, 'f1': 0.9968128, 'auroc': 0.9998908, 'binary_precision': 0.99735355, 'binary_recall': 0.99313456, 'binary_specificity': 0.999104, 'binary_f1_score': 0.9952396}
confusion matrix:
       0      1
0  42374     38
1     99  14321
---- Validation: 
scalar performance:
{'acc': 0.9653682, 'precision': 0.7523831, 'recall': 0.65301615, 'specificity': 0.65301615, 'f1': 0.689226, 'auroc': 0.94909275, 'binary_precision': 0.5298507, 'binary_recall': 0.3164933, 'binary_specificity': 0.98953897, 'binary_f1_score': 0.3962791}
confusion matrix:
       0    1
0  17878  189
1    460  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9469868, 'precision': 0.49904096, 'recall': 0.49971473, 'specificity': 0.49971473, 'f1': 0.4953343, 'auroc': 0.91677725, 'binary_precision': 0.04, 'binary_recall': 0.011538462, 'binary_specificity': 0.987891, 'binary_f1_score': 0.017910449}
confusion matrix:
      0   1
0  5874  72
1   257   3
early stop counter: 6
val acc:0.9653682112693787, best validation acc: 0.9755603075027466, corresponding to test acc:                         0.9590718746185303 / 0.9718014597892761
after epoch: 26,now: 2024-07-30 23:32:11.345856,epoch time: 0:13:36.655538,used: 6:13:48.456064,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9954955, 'precision': 0.99695265, 'recall': 0.9911692, 'specificity': 0.9911692, 'f1': 0.9940181, 'auroc': 0.99964064, 'binary_precision': 0.99985886, 'binary_recall': 0.9823856, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9910452}
confusion matrix:
       0      1
0  42410      2
1    254  14166
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.9580622, 'recall': 0.5415217, 'specificity': 0.5415217, 'f1': 0.5680669, 'auroc': 0.9307155, 'binary_precision': 0.9491525, 'binary_recall': 0.08320951, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.15300547}
confusion matrix:
       0   1
0  18064   3
1    617  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.9373299, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
early stop counter: 7
val acc:0.9669156670570374, best validation acc: 0.9755603075027466, corresponding to test acc:                         0.9590718746185303 / 0.9718014597892761
after epoch: 27,now: 2024-07-30 23:45:50.706510,epoch time: 0:13:39.360654,used: 6:27:27.816718,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99827564, 'precision': 0.9987083, 'recall': 0.9967388, 'specificity': 0.9967388, 'f1': 0.99771863, 'auroc': 0.99986196, 'binary_precision': 0.99958134, 'binary_recall': 0.9936191, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.9965913}
confusion matrix:
       0      1
0  42408      6
1     92  14326
---- Validation: 
scalar performance:
{'acc': 0.96558166, 'precision': 0.8231323, 'recall': 0.53868407, 'specificity': 0.53868407, 'f1': 0.561792, 'auroc': 0.9557719, 'binary_precision': 0.67948717, 'binary_recall': 0.078751855, 'binary_specificity': 0.9986163, 'binary_f1_score': 0.14114514}
confusion matrix:
       0   1
0  18042  25
1    620  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72927415, 'recall': 0.50551695, 'specificity': 0.50551695, 'f1': 0.50057507, 'auroc': 0.946459, 'binary_precision': 0.5, 'binary_recall': 0.011538462, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.022556392}
confusion matrix:
      0  1
0  5943  3
1   257  3
early stop counter: 8
val acc:0.9655816555023193, best validation acc: 0.9755603075027466, corresponding to test acc:                         0.9590718746185303 / 0.9718014597892761
after epoch: 28,now: 2024-07-30 23:59:42.770513,epoch time: 0:13:52.064003,used: 6:41:19.880721,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99723744, 'precision': 0.9981092, 'recall': 0.9946016, 'specificity': 0.9946016, 'f1': 0.9963396, 'auroc': 0.99987406, 'binary_precision': 0.9998598, 'binary_recall': 0.9892503, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.99452674}
confusion matrix:
       0      1
0  42411      2
1    155  14264
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.9603975, 'recall': 0.5311482, 'specificity': 0.5311482, 'f1': 0.5499682, 'auroc': 0.9608019, 'binary_precision': 0.95454544, 'binary_recall': 0.062407132, 'binary_specificity': 0.9998893, 'binary_f1_score': 0.117154814}
confusion matrix:
       0   1
0  18065   2
1    631  42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.9304439, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
early stop counter: 9
val acc:0.9662219882011414, best validation acc: 0.9755603075027466, corresponding to test acc:                         0.9590718746185303 / 0.9718014597892761
after epoch: 29,now: 2024-07-31 00:13:19.107141,epoch time: 0:13:36.336628,used: 6:54:56.217349,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9971143, 'precision': 0.99677956, 'recall': 0.995595, 'specificity': 0.995595, 'f1': 0.9961854, 'auroc': 0.99987113, 'binary_precision': 0.99610245, 'binary_recall': 0.9925104, 'binary_specificity': 0.99867964, 'binary_f1_score': 0.99430317}
confusion matrix:
       0      1
0  42356     56
1    108  14312
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.80963343, 'recall': 0.67170894, 'specificity': 0.67170894, 'f1': 0.71912944, 'auroc': 0.9567374, 'binary_precision': 0.64305174, 'binary_recall': 0.35066864, 'binary_specificity': 0.9927492, 'binary_f1_score': 0.45384613}
confusion matrix:
       0    1
0  17936  131
1    437  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7556634, 'recall': 0.55191207, 'specificity': 0.55191207, 'f1': 0.57949585, 'auroc': 0.9331585, 'binary_precision': 0.54901963, 'binary_recall': 0.10769231, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.18006432}
confusion matrix:
      0   1
0  5923  23
1   232  28
early stop counter: 10
val acc:0.9696905016899109, best validation acc: 0.9755603075027466, corresponding to test acc:                         0.9590718746185303 / 0.9718014597892761
after epoch: 30,now: 2024-07-31 00:27:24.803230,epoch time: 0:14:05.696089,used: 7:09:01.913438,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_30_17_18_22_seed_1_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:09:01.913438 at 2024-07-31 00:27:24.803230
persisted model performance metric: 

scalar performance:
{'acc': 0.9590719, 'precision': 0.78795123, 'recall': 0.5299283, 'specificity': 0.5299283, 'f1': 0.5454707, 'auroc': 0.9283822, 'binary_precision': 0.61538464, 'binary_recall': 0.06153846, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.11188811}
confusion matrix:
      0   1
0  5936  10
1   244  16
oracle model performance metric: 

scalar performance:
{'acc': 0.97180146, 'precision': 0.9216485, 'recall': 0.69104636, 'specificity': 0.69104636, 'f1': 0.75939745, 'auroc': 0.91972697, 'binary_precision': 0.8695652, 'binary_recall': 0.3846154, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.53333336}
confusion matrix:
      0    1
0  5931   15
1   160  100
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_irm_config4_2_2024-07-29_15-36-39/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_irm_config4_2_2024-07-29_15-36-39/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 503683 KiB |  13265 MiB |   2869 TiB |   2869 TiB |
|       from large pool | 462008 KiB |  13227 MiB |   2836 TiB |   2836 TiB |
|       from small pool |  41675 KiB |     61 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 503683 KiB |  13265 MiB |   2869 TiB |   2869 TiB |
|       from large pool | 462008 KiB |  13227 MiB |   2836 TiB |   2836 TiB |
|       from small pool |  41675 KiB |     61 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496647 KiB |  13261 MiB |   2866 TiB |   2866 TiB |
|       from large pool | 455971 KiB |  13223 MiB |   2834 TiB |   2834 TiB |
|       from small pool |  40676 KiB |     60 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14532 MiB |  14538 MiB |  28100 MiB |  13568 MiB |
|       from large pool |  14466 MiB |  14466 MiB |  28012 MiB |  13546 MiB |
|       from small pool |     66 MiB |     72 MiB |     88 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 485500 KiB |   1260 MiB |   2001 TiB |   2001 TiB |
|       from large pool | 473928 KiB |   1252 MiB |   1968 TiB |   1968 TiB |
|       from small pool |  11572 KiB |     38 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8135    |  496457 K  |  496453 K  |
|       from large pool |     187    |    1413    |  260647 K  |  260647 K  |
|       from small pool |    3277    |    7946    |  235809 K  |  235805 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8135    |  496457 K  |  496453 K  |
|       from large pool |     187    |    1413    |  260647 K  |  260647 K  |
|       from small pool |    3277    |    7946    |  235809 K  |  235805 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     640    |    1212    |     574    |
|       from large pool |     605    |     605    |    1168    |     563    |
|       from small pool |      33    |      36    |      44    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      84    |    3629    |  295584 K  |  295584 K  |
|       from large pool |      39    |     604    |  170003 K  |  170003 K  |
|       from small pool |      45    |    3589    |  125580 K  |  125580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13265 MiB |   2869 TiB |   2869 TiB |
|       from large pool |  65536 KiB |  13227 MiB |   2836 TiB |   2836 TiB |
|       from small pool |      0 KiB |     61 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13265 MiB |   2869 TiB |   2869 TiB |
|       from large pool |  65536 KiB |  13227 MiB |   2836 TiB |   2836 TiB |
|       from small pool |      0 KiB |     61 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   2866 TiB |   2866 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   2834 TiB |   2834 TiB |
|       from small pool |      0 KiB |     60 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    966 MiB |  14538 MiB |  28100 MiB |  27134 MiB |
|       from large pool |    914 MiB |  14466 MiB |  28012 MiB |  27098 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1260 MiB |   2001 TiB |   2001 TiB |
|       from large pool |      0 B   |   1252 MiB |   1968 TiB |   1968 TiB |
|       from small pool |      0 B   |     44 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  496457 K  |  496457 K  |
|       from large pool |       2    |    1413    |  260647 K  |  260647 K  |
|       from small pool |       0    |    7946    |  235809 K  |  235809 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  496457 K  |  496457 K  |
|       from large pool |       2    |    1413    |  260647 K  |  260647 K  |
|       from small pool |       0    |    7946    |  235809 K  |  235809 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     640    |    1212    |    1144    |
|       from large pool |      42    |     605    |    1168    |    1126    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3629    |  295585 K  |  295585 K  |
|       from large pool |       0    |     604    |  170003 K  |  170003 K  |
|       from small pool |       0    |    3589    |  125582 K  |  125582 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13265 MiB |   2869 TiB |   2869 TiB |
|       from large pool |  65536 KiB |  13227 MiB |   2836 TiB |   2836 TiB |
|       from small pool |      0 KiB |     61 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13265 MiB |   2869 TiB |   2869 TiB |
|       from large pool |  65536 KiB |  13227 MiB |   2836 TiB |   2836 TiB |
|       from small pool |      0 KiB |     61 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   2866 TiB |   2866 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   2834 TiB |   2834 TiB |
|       from small pool |      0 KiB |     60 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    966 MiB |  14538 MiB |  28100 MiB |  27134 MiB |
|       from large pool |    914 MiB |  14466 MiB |  28012 MiB |  27098 MiB |
|       from small pool |     52 MiB |     72 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1260 MiB |   2001 TiB |   2001 TiB |
|       from large pool |      0 B   |   1252 MiB |   1968 TiB |   1968 TiB |
|       from small pool |      0 B   |     44 MiB |     32 TiB |     32 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  496457 K  |  496457 K  |
|       from large pool |       2    |    1413    |  260647 K  |  260647 K  |
|       from small pool |       0    |    7946    |  235809 K  |  235809 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  496457 K  |  496457 K  |
|       from large pool |       2    |    1413    |  260647 K  |  260647 K  |
|       from small pool |       0    |    7946    |  235809 K  |  235809 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      68    |     640    |    1212    |    1144    |
|       from large pool |      42    |     605    |    1168    |    1126    |
|       from small pool |      26    |      36    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3629    |  295585 K  |  295585 K  |
|       from large pool |       0    |     604    |  170003 K  |  170003 K  |
|       from small pool |       0    |    3589    |  125582 K  |  125582 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104

 Experiment start at: 2024-07-31 00:32:53.492842
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9873781, 'precision': 0.98550975, 'recall': 0.98187906, 'specificity': 0.98187906, 'f1': 0.9836758, 'auroc': 0.9979663, 'binary_precision': 0.9816115, 'binary_recall': 0.97025776, 'binary_specificity': 0.99350035, 'binary_f1_score': 0.9759016}
confusion matrix:
       0      1
0  42035    275
1    450  14680
---- Validation: 
scalar performance:
{'acc': 0.9634582, 'precision': 0.7213186, 'recall': 0.8261354, 'specificity': 0.8261354, 'f1': 0.7624248, 'auroc': 0.9387977, 'binary_precision': 0.45343682, 'binary_recall': 0.679402, 'binary_specificity': 0.97286886, 'binary_f1_score': 0.54388297}
confusion matrix:
       0    1
0  17678  493
1    193  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97451514, 'precision': 0.8885429, 'recall': 0.72700435, 'specificity': 0.72700435, 'f1': 0.7847667, 'auroc': 0.92296064, 'binary_precision': 0.79856116, 'binary_recall': 0.45867768, 'binary_specificity': 0.995331, 'binary_f1_score': 0.5826771}
confusion matrix:
      0    1
0  5969   28
1   131  111
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 00:47:49.930091,epoch time: 0:14:56.437249,used: 0:14:56.437249,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99503833, 'precision': 0.99355483, 'recall': 0.9936596, 'specificity': 0.9936596, 'f1': 0.99360716, 'auroc': 0.99967706, 'binary_precision': 0.9904189, 'binary_recall': 0.99074626, 'binary_specificity': 0.996573, 'binary_f1_score': 0.9905825}
confusion matrix:
       0      1
0  42166    145
1    140  14989
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.748366, 'recall': 0.795907, 'specificity': 0.795907, 'f1': 0.76982903, 'auroc': 0.94436204, 'binary_precision': 0.5096953, 'binary_recall': 0.6112957, 'binary_specificity': 0.9805184, 'binary_f1_score': 0.5558913}
confusion matrix:
       0    1
0  17817  354
1    234  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.8449062, 'recall': 0.56916404, 'specificity': 0.56916404, 'f1': 0.6085815, 'auroc': 0.9282231, 'binary_precision': 0.7234042, 'binary_recall': 0.14049587, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.23529413}
confusion matrix:
      0   1
0  5984  13
1   208  34
better model found
persisted
after epoch: 2,now: 2024-07-31 01:01:37.607717,epoch time: 0:13:47.677626,used: 0:28:44.114875,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99498606, 'precision': 0.9943956, 'recall': 0.9926691, 'specificity': 0.9926691, 'f1': 0.99352825, 'auroc': 0.99960905, 'binary_precision': 0.99315524, 'binary_recall': 0.98777264, 'binary_specificity': 0.99756557, 'binary_f1_score': 0.9904566}
confusion matrix:
       0      1
0  42207    103
1    185  14945
---- Validation: 
scalar performance:
{'acc': 0.9506206, 'precision': 0.66800547, 'recall': 0.7922003, 'specificity': 0.7922003, 'f1': 0.7106916, 'auroc': 0.9312828, 'binary_precision': 0.3488372, 'binary_recall': 0.6229236, 'binary_specificity': 0.9614771, 'binary_f1_score': 0.44722718}
confusion matrix:
       0    1
0  17471  700
1    227  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9554416, 'precision': 0.66122967, 'recall': 0.5842391, 'specificity': 0.5842391, 'f1': 0.60874236, 'auroc': 0.90807045, 'binary_precision': 0.3548387, 'binary_recall': 0.18181819, 'binary_specificity': 0.98666, 'binary_f1_score': 0.24043716}
confusion matrix:
      0   1
0  5917  80
1   198  44
early stop counter: 1
val acc:0.9506205916404724, best validation acc: 0.9686784148216248, corresponding to test acc:                         0.9645776748657227 / 0.9745151400566101
after epoch: 3,now: 2024-07-31 01:15:27.248295,epoch time: 0:13:49.640578,used: 0:42:33.755453,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9915564, 'precision': 0.9862071, 'recall': 0.99227273, 'specificity': 0.99227273, 'f1': 0.98918724, 'auroc': 0.99952173, 'binary_precision': 0.9746515, 'binary_recall': 0.99378633, 'binary_specificity': 0.99075913, 'binary_f1_score': 0.9841259}
confusion matrix:
       0      1
0  41921    391
1     94  15034
---- Validation: 
scalar performance:
{'acc': 0.9613807, 'precision': 0.71701515, 'recall': 0.870836, 'specificity': 0.870836, 'f1': 0.77113056, 'auroc': 0.9527925, 'binary_precision': 0.44170615, 'binary_recall': 0.77408636, 'binary_specificity': 0.96758574, 'binary_f1_score': 0.5624623}
confusion matrix:
       0    1
0  17582  589
1    136  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.79440594, 'recall': 0.6973101, 'specificity': 0.6973101, 'f1': 0.7352518, 'auroc': 0.9347304, 'binary_precision': 0.6125, 'binary_recall': 0.40495867, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.48756218}
confusion matrix:
      0   1
0  5935  62
1   144  98
early stop counter: 2
val acc:0.9613807201385498, best validation acc: 0.9686784148216248, corresponding to test acc:                         0.9645776748657227 / 0.9745151400566101
after epoch: 4,now: 2024-07-31 01:29:15.598326,epoch time: 0:13:48.350031,used: 0:56:22.105484,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9944812, 'precision': 0.99621516, 'recall': 0.9895878, 'specificity': 0.9895878, 'f1': 0.9928414, 'auroc': 0.9997736, 'binary_precision': 0.9997976, 'binary_recall': 0.97924656, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9894153}
confusion matrix:
       0      1
0  42307      3
1    314  14816
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.98422426, 'recall': 0.50830567, 'specificity': 0.50830567, 'f1': 0.5083256, 'auroc': 0.95588744, 'binary_precision': 1.0, 'binary_recall': 0.016611295, 'binary_specificity': 1.0, 'binary_f1_score': 0.032679737}
confusion matrix:
       0   1
0  18171   0
1    592  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.9322562, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
early stop counter: 3
val acc:0.9684653282165527, best validation acc: 0.9686784148216248, corresponding to test acc:                         0.9645776748657227 / 0.9745151400566101
after epoch: 5,now: 2024-07-31 01:43:14.539830,epoch time: 0:13:58.941504,used: 1:10:21.046988,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9957869, 'precision': 0.9947587, 'recall': 0.99438035, 'specificity': 0.99438035, 'f1': 0.9945693, 'auroc': 0.999764, 'binary_precision': 0.9925887, 'binary_recall': 0.9914078, 'binary_specificity': 0.9973529, 'binary_f1_score': 0.9919979}
confusion matrix:
       0      1
0  42198    112
1    130  15000
---- Validation: 
scalar performance:
{'acc': 0.9753902, 'precision': 0.8220569, 'recall': 0.7343272, 'specificity': 0.7343272, 'f1': 0.7707, 'auroc': 0.95320743, 'binary_precision': 0.66129035, 'binary_recall': 0.47674417, 'binary_specificity': 0.99191016, 'binary_f1_score': 0.554054}
confusion matrix:
       0    1
0  18024  147
1    315  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.7894655, 'recall': 0.5543678, 'specificity': 0.5543678, 'f1': 0.5848912, 'auroc': 0.9344893, 'binary_precision': 0.6136364, 'binary_recall': 0.11157025, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.1888112}
confusion matrix:
      0   1
0  5980  17
1   215  27
better model found
persisted
after epoch: 6,now: 2024-07-31 01:57:12.364810,epoch time: 0:13:57.824980,used: 1:24:18.871968,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99498606, 'precision': 0.9937258, 'recall': 0.9933482, 'specificity': 0.9933482, 'f1': 0.9935368, 'auroc': 0.99948967, 'binary_precision': 0.9910661, 'binary_recall': 0.989887, 'binary_specificity': 0.99680936, 'binary_f1_score': 0.9904762}
confusion matrix:
       0      1
0  42176    135
1    153  14976
---- Validation: 
scalar performance:
{'acc': 0.97347254, 'precision': 0.79491115, 'recall': 0.74056405, 'specificity': 0.74056405, 'f1': 0.7647295, 'auroc': 0.94926834, 'binary_precision': 0.60655737, 'binary_recall': 0.49169436, 'binary_specificity': 0.9894337, 'binary_f1_score': 0.5431193}
confusion matrix:
       0    1
0  17979  192
1    306  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.7922733, 'recall': 0.56849706, 'specificity': 0.56849706, 'f1': 0.6050782, 'auroc': 0.936219, 'binary_precision': 0.6181818, 'binary_recall': 0.14049587, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.22895622}
confusion matrix:
      0   1
0  5976  21
1   208  34
early stop counter: 1
val acc:0.973472535610199, best validation acc: 0.9753901958465576, corresponding to test acc:                         0.9628145694732666 / 0.9745151400566101
after epoch: 7,now: 2024-07-31 02:11:01.838901,epoch time: 0:13:49.474091,used: 1:38:08.346059,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99674445, 'precision': 0.9973875, 'recall': 0.9942236, 'specificity': 0.9942236, 'f1': 0.9957918, 'auroc': 0.9998113, 'binary_precision': 0.99873173, 'binary_recall': 0.98889625, 'binary_specificity': 0.99955094, 'binary_f1_score': 0.9937896}
confusion matrix:
       0      1
0  42291     19
1    168  14962
---- Validation: 
scalar performance:
{'acc': 0.9753369, 'precision': 0.9343896, 'recall': 0.6307064, 'specificity': 0.6307064, 'f1': 0.6965277, 'auroc': 0.9538287, 'binary_precision': 0.8926554, 'binary_recall': 0.26245847, 'binary_specificity': 0.99895436, 'binary_f1_score': 0.4056483}
confusion matrix:
       0    1
0  18152   19
1    444  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.4805934, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48994443, 'auroc': 0.9263313, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   242  0
early stop counter: 2
val acc:0.9753369092941284, best validation acc: 0.9753901958465576, corresponding to test acc:                         0.9628145694732666 / 0.9745151400566101
after epoch: 8,now: 2024-07-31 02:24:52.615028,epoch time: 0:13:50.776127,used: 1:51:59.122186,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9959436, 'precision': 0.99675965, 'recall': 0.9927883, 'specificity': 0.9927883, 'f1': 0.9947524, 'auroc': 0.9996233, 'binary_precision': 0.9984608, 'binary_recall': 0.9861203, 'binary_specificity': 0.9994564, 'binary_f1_score': 0.9922522}
confusion matrix:
       0      1
0  42287     23
1    210  14920
---- Validation: 
scalar performance:
{'acc': 0.97309965, 'precision': 0.81815946, 'recall': 0.66488487, 'specificity': 0.66488487, 'f1': 0.71533024, 'auroc': 0.9416225, 'binary_precision': 0.65798044, 'binary_recall': 0.33554816, 'binary_specificity': 0.99422157, 'binary_f1_score': 0.44444442}
confusion matrix:
       0    1
0  18066  105
1    400  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95512104, 'precision': 0.5044453, 'recall': 0.5007972, 'specificity': 0.5007972, 'f1': 0.4955612, 'auroc': 0.8148592, 'binary_precision': 0.04761905, 'binary_recall': 0.008264462, 'binary_specificity': 0.99333, 'binary_f1_score': 0.014084506}
confusion matrix:
      0   1
0  5957  40
1   240   2
early stop counter: 3
val acc:0.9730996489524841, best validation acc: 0.9753901958465576, corresponding to test acc:                         0.9628145694732666 / 0.9745151400566101
after epoch: 9,now: 2024-07-31 02:38:43.608073,epoch time: 0:13:50.993045,used: 2:05:50.115231,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9957869, 'precision': 0.99678445, 'recall': 0.9923636, 'specificity': 0.9923636, 'f1': 0.99454725, 'auroc': 0.9996737, 'binary_precision': 0.9988607, 'binary_recall': 0.9851289, 'binary_specificity': 0.9995982, 'binary_f1_score': 0.99194723}
confusion matrix:
       0      1
0  42293     17
1    225  14905
---- Validation: 
scalar performance:
{'acc': 0.9736856, 'precision': 0.8347393, 'recall': 0.6595662, 'specificity': 0.6595662, 'f1': 0.713851, 'auroc': 0.9447336, 'binary_precision': 0.69148934, 'binary_recall': 0.32392028, 'binary_specificity': 0.99521214, 'binary_f1_score': 0.44117647}
confusion matrix:
       0    1
0  18084   87
1    407  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.81409025, 'recall': 0.5040488, 'specificity': 0.5040488, 'f1': 0.49831286, 'auroc': 0.9490441, 'binary_precision': 0.6666667, 'binary_recall': 0.008264462, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.01632653}
confusion matrix:
      0  1
0  5996  1
1   240  2
early stop counter: 4
val acc:0.973685622215271, best validation acc: 0.9753901958465576, corresponding to test acc:                         0.9628145694732666 / 0.9745151400566101
after epoch: 10,now: 2024-07-31 02:52:35.805745,epoch time: 0:13:52.197672,used: 2:19:42.312903,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9972841, 'precision': 0.99803317, 'recall': 0.99497205, 'specificity': 0.99497205, 'f1': 0.99648976, 'auroc': 0.9997849, 'binary_precision': 0.99959964, 'binary_recall': 0.9900859, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99482006}
confusion matrix:
       0      1
0  42304      6
1    150  14980
---- Validation: 
scalar performance:
{'acc': 0.97262025, 'precision': 0.8729875, 'recall': 0.6028025, 'specificity': 0.6028025, 'f1': 0.65662545, 'auroc': 0.9536891, 'binary_precision': 0.77160496, 'binary_recall': 0.2076412, 'binary_specificity': 0.9979638, 'binary_f1_score': 0.32722512}
confusion matrix:
       0    1
0  18134   37
1    477  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7307538, 'recall': 0.5039655, 'specificity': 0.5039655, 'f1': 0.49823797, 'auroc': 0.93833154, 'binary_precision': 0.5, 'binary_recall': 0.008264462, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.016260162}
confusion matrix:
      0  1
0  5995  2
1   240  2
early stop counter: 5
val acc:0.9726202487945557, best validation acc: 0.9753901958465576, corresponding to test acc:                         0.9628145694732666 / 0.9745151400566101
after epoch: 11,now: 2024-07-31 03:06:21.255260,epoch time: 0:13:45.449515,used: 2:33:27.762418,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9930884, 'precision': 0.9881005, 'recall': 0.9943107, 'specificity': 0.9943107, 'f1': 0.9911506, 'auroc': 0.9998248, 'binary_precision': 0.97731984, 'binary_recall': 0.9968934, 'binary_specificity': 0.99172795, 'binary_f1_score': 0.9870096}
confusion matrix:
       0      1
0  41961    350
1     47  15082
---- Validation: 
scalar performance:
{'acc': 0.92968625, 'precision': 0.6470682, 'recall': 0.906662, 'specificity': 0.906662, 'f1': 0.70415276, 'auroc': 0.9593421, 'binary_precision': 0.2983146, 'binary_recall': 0.8820598, 'binary_specificity': 0.9312641, 'binary_f1_score': 0.44584385}
confusion matrix:
       0     1
0  16922  1249
1     71   531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9536785, 'precision': 0.7190618, 'recall': 0.8827158, 'specificity': 0.8827158, 'f1': 0.7749402, 'auroc': 0.9436462, 'binary_precision': 0.44622424, 'binary_recall': 0.8057851, 'binary_specificity': 0.95964646, 'binary_f1_score': 0.574374}
confusion matrix:
      0    1
0  5755  242
1    47  195
early stop counter: 6
val acc:0.9296862483024597, best validation acc: 0.9753901958465576, corresponding to test acc:                         0.9628145694732666 / 0.9745151400566101
after epoch: 12,now: 2024-07-31 03:20:32.081380,epoch time: 0:14:10.826120,used: 2:47:38.588538,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99810237, 'precision': 0.99809414, 'recall': 0.99701357, 'specificity': 0.99701357, 'f1': 0.9975523, 'auroc': 0.99991417, 'binary_precision': 0.9980768, 'binary_recall': 0.9947125, 'binary_specificity': 0.9993146, 'binary_f1_score': 0.99639183}
confusion matrix:
       0      1
0  42281     29
1     80  15050
---- Validation: 
scalar performance:
{'acc': 0.9705961, 'precision': 0.7646122, 'recall': 0.7398812, 'specificity': 0.7398812, 'f1': 0.7515799, 'auroc': 0.94629705, 'binary_precision': 0.5459559, 'binary_recall': 0.49335548, 'binary_specificity': 0.9864069, 'binary_f1_score': 0.51832455}
confusion matrix:
       0    1
0  17924  247
1    305  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9322007, 'precision': 0.49850795, 'recall': 0.4987883, 'specificity': 0.4987883, 'f1': 0.49845332, 'auroc': 0.84380686, 'binary_precision': 0.035897437, 'binary_recall': 0.02892562, 'binary_specificity': 0.968651, 'binary_f1_score': 0.032036614}
confusion matrix:
      0    1
0  5809  188
1   235    7
early stop counter: 7
val acc:0.9705960750579834, best validation acc: 0.9753901958465576, corresponding to test acc:                         0.9628145694732666 / 0.9745151400566101
after epoch: 13,now: 2024-07-31 03:34:25.607966,epoch time: 0:13:53.526586,used: 3:01:32.115124,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99648327, 'precision': 0.99703807, 'recall': 0.99389774, 'specificity': 0.99389774, 'f1': 0.99545443, 'auroc': 0.9997034, 'binary_precision': 0.99819785, 'binary_recall': 0.9884336, 'binary_specificity': 0.9993619, 'binary_f1_score': 0.9932918}
confusion matrix:
       0      1
0  42283     27
1    175  14955
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.74513316, 'recall': 0.63435674, 'specificity': 0.63435674, 'f1': 0.6720542, 'auroc': 0.92922544, 'binary_precision': 0.51384616, 'binary_recall': 0.27740863, 'binary_specificity': 0.9913048, 'binary_f1_score': 0.36030206}
confusion matrix:
       0    1
0  18013  158
1    435  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.77810574, 'recall': 0.53214073, 'specificity': 0.53214073, 'f1': 0.5497736, 'auroc': 0.94048697, 'binary_precision': 0.5925926, 'binary_recall': 0.0661157, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.118959114}
confusion matrix:
      0   1
0  5986  11
1   226  16
early stop counter: 8
val acc:0.9684121012687683, best validation acc: 0.9753901958465576, corresponding to test acc:                         0.9628145694732666 / 0.9745151400566101
after epoch: 14,now: 2024-07-31 03:48:12.107736,epoch time: 0:13:46.499770,used: 3:15:18.614894,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99646586, 'precision': 0.99759066, 'recall': 0.9933127, 'specificity': 0.9933127, 'f1': 0.99542665, 'auroc': 0.9998376, 'binary_precision': 0.999933, 'binary_recall': 0.98664904, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9932466}
confusion matrix:
       0      1
0  42309      1
1    202  14928
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.8279959, 'recall': 0.50899863, 'specificity': 0.50899863, 'f1': 0.5097296, 'auroc': 0.9323373, 'binary_precision': 0.6875, 'binary_recall': 0.018272426, 'binary_specificity': 0.99972486, 'binary_f1_score': 0.035598706}
confusion matrix:
       0   1
0  18166   5
1    591  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.92583984, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
early stop counter: 9
val acc:0.9682523012161255, best validation acc: 0.9753901958465576, corresponding to test acc:                         0.9628145694732666 / 0.9745151400566101
after epoch: 15,now: 2024-07-31 04:01:54.239633,epoch time: 0:13:42.131897,used: 3:29:00.746791,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9972145, 'precision': 0.99789965, 'recall': 0.9949248, 'specificity': 0.9949248, 'f1': 0.9964001, 'auroc': 0.99986374, 'binary_precision': 0.9993329, 'binary_recall': 0.9900859, 'binary_specificity': 0.99976367, 'binary_f1_score': 0.9946879}
confusion matrix:
       0      1
0  42300     10
1    150  14980
---- Validation: 
scalar performance:
{'acc': 0.9764023, 'precision': 0.81443846, 'recall': 0.79266953, 'specificity': 0.79266953, 'f1': 0.80312854, 'auroc': 0.9593226, 'binary_precision': 0.64221823, 'binary_recall': 0.59634554, 'binary_specificity': 0.98899347, 'binary_f1_score': 0.6184324}
confusion matrix:
       0    1
0  17971  200
1    243  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.8381281, 'recall': 0.51016384, 'specificity': 0.51016384, 'f1': 0.51030844, 'auroc': 0.94166434, 'binary_precision': 0.71428573, 'binary_recall': 0.020661157, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.04016064}
confusion matrix:
      0  1
0  5995  2
1   237  5
better model found
persisted
after epoch: 16,now: 2024-07-31 04:15:41.996765,epoch time: 0:13:47.757132,used: 3:42:48.503923,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99768454, 'precision': 0.99757576, 'recall': 0.99645376, 'specificity': 0.99645376, 'f1': 0.9970131, 'auroc': 0.99981046, 'binary_precision': 0.99734676, 'binary_recall': 0.99385285, 'binary_specificity': 0.9990546, 'binary_f1_score': 0.99559677}
confusion matrix:
       0      1
0  42271     40
1     93  15036
---- Validation: 
scalar performance:
{'acc': 0.97325945, 'precision': 0.79317784, 'recall': 0.73724174, 'specificity': 0.73724174, 'f1': 0.76199234, 'auroc': 0.95256674, 'binary_precision': 0.60330576, 'binary_recall': 0.48504984, 'binary_specificity': 0.9894337, 'binary_f1_score': 0.5377532}
confusion matrix:
       0    1
0  17979  192
1    310  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.855834, 'recall': 0.50611496, 'specificity': 0.50611496, 'f1': 0.5023848, 'auroc': 0.949605, 'binary_precision': 0.75, 'binary_recall': 0.012396694, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.024390245}
confusion matrix:
      0  1
0  5996  1
1   239  3
early stop counter: 1
val acc:0.973259449005127, best validation acc: 0.9764022827148438, corresponding to test acc:                         0.9616925716400146 / 0.9745151400566101
after epoch: 17,now: 2024-07-31 04:29:34.328849,epoch time: 0:13:52.332084,used: 3:56:40.836007,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.997789, 'precision': 0.997732, 'recall': 0.9965673, 'specificity': 0.9965673, 'f1': 0.9971478, 'auroc': 0.9998672, 'binary_precision': 0.99761194, 'binary_recall': 0.9939855, 'binary_specificity': 0.99914914, 'binary_f1_score': 0.9957954}
confusion matrix:
       0      1
0  42274     36
1     91  15039
---- Validation: 
scalar performance:
{'acc': 0.97773397, 'precision': 0.8560178, 'recall': 0.7403562, 'specificity': 0.7403562, 'f1': 0.78611326, 'auroc': 0.94999063, 'binary_precision': 0.7288557, 'binary_recall': 0.48671097, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.5836654}
confusion matrix:
       0    1
0  18062  109
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.82602024, 'recall': 0.5750289, 'specificity': 0.5750289, 'f1': 0.6158882, 'auroc': 0.92167795, 'binary_precision': 0.6851852, 'binary_recall': 0.15289256, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.24999999}
confusion matrix:
      0   1
0  5980  17
1   205  37
better model found
persisted
after epoch: 18,now: 2024-07-31 04:43:20.832005,epoch time: 0:13:46.503156,used: 4:10:27.339163,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9975801, 'precision': 0.99763227, 'recall': 0.9961281, 'specificity': 0.9961281, 'f1': 0.9968771, 'auroc': 0.99983644, 'binary_precision': 0.99774206, 'binary_recall': 0.9930597, 'binary_specificity': 0.9991964, 'binary_f1_score': 0.99539536}
confusion matrix:
       0      1
0  42277     34
1    105  15024
---- Validation: 
scalar performance:
{'acc': 0.97144836, 'precision': 0.7788757, 'recall': 0.700169, 'specificity': 0.700169, 'f1': 0.7324666, 'auroc': 0.9265181, 'binary_precision': 0.5771028, 'binary_recall': 0.410299, 'binary_specificity': 0.99003905, 'binary_f1_score': 0.47961164}
confusion matrix:
       0    1
0  17990  181
1    355  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.8249525, 'recall': 0.5912243, 'specificity': 0.5912243, 'f1': 0.6371474, 'auroc': 0.94783217, 'binary_precision': 0.6818182, 'binary_recall': 0.18595041, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.29220778}
confusion matrix:
      0   1
0  5976  21
1   197  45
early stop counter: 1
val acc:0.9714483618736267, best validation acc: 0.9777339696884155, corresponding to test acc:                         0.9644173979759216 / 0.9745151400566101
after epoch: 19,now: 2024-07-31 04:57:26.325591,epoch time: 0:14:05.493586,used: 4:24:32.832749,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9944116, 'precision': 0.9962353, 'recall': 0.9893905, 'specificity': 0.9893905, 'f1': 0.9927489, 'auroc': 0.99977446, 'binary_precision': 1.0, 'binary_recall': 0.97878104, 'binary_specificity': 1.0, 'binary_f1_score': 0.98927677}
confusion matrix:
       0      1
0  42312      0
1    321  14807
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.74912345, 'recall': 0.5145099, 'specificity': 0.5145099, 'f1': 0.52017397, 'auroc': 0.92707133, 'binary_precision': 0.5294118, 'binary_recall': 0.029900333, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.05660378}
confusion matrix:
       0   1
0  18155  16
1    584  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95928836, 'precision': 0.4805685, 'recall': 0.4989995, 'specificity': 0.4989995, 'f1': 0.4896106, 'auroc': 0.9115591, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.997999, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5985  12
1   242   0
early stop counter: 2
val acc:0.9680392146110535, best validation acc: 0.9777339696884155, corresponding to test acc:                         0.9644173979759216 / 0.9745151400566101
after epoch: 20,now: 2024-07-31 05:11:17.511779,epoch time: 0:13:51.186188,used: 4:38:24.018937,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9984506, 'precision': 0.99886453, 'recall': 0.99714357, 'specificity': 0.99714357, 'f1': 0.99799997, 'auroc': 0.9999099, 'binary_precision': 0.99973416, 'binary_recall': 0.99438167, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9970507}
confusion matrix:
       0      1
0  42307      4
1     85  15044
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.8798565, 'recall': 0.5370452, 'specificity': 0.5370452, 'f1': 0.5605725, 'auroc': 0.94612014, 'binary_precision': 0.7894737, 'binary_recall': 0.07475083, 'binary_specificity': 0.9993396, 'binary_f1_score': 0.13657056}
confusion matrix:
       0   1
0  18159  12
1    557  45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.4805934, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48994443, 'auroc': 0.9498842, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   242  0
early stop counter: 3
val acc:0.9696905016899109, best validation acc: 0.9777339696884155, corresponding to test acc:                         0.9644173979759216 / 0.9745151400566101
after epoch: 21,now: 2024-07-31 05:25:01.258594,epoch time: 0:13:43.746815,used: 4:52:07.765752,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9987291, 'precision': 0.99871176, 'recall': 0.9980122, 'specificity': 0.9980122, 'f1': 0.99836135, 'auroc': 0.9999341, 'binary_precision': 0.9986752, 'binary_recall': 0.99649704, 'binary_specificity': 0.9995273, 'binary_f1_score': 0.99758494}
confusion matrix:
       0      1
0  42290     20
1     53  15077
---- Validation: 
scalar performance:
{'acc': 0.974964, 'precision': 0.81040066, 'recall': 0.750168, 'specificity': 0.750168, 'f1': 0.7767653, 'auroc': 0.94894195, 'binary_precision': 0.63692945, 'binary_recall': 0.5099668, 'binary_specificity': 0.99036926, 'binary_f1_score': 0.5664207}
confusion matrix:
       0    1
0  17996  175
1    295  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.76691914, 'recall': 0.51602864, 'specificity': 0.51602864, 'f1': 0.5214316, 'auroc': 0.93204284, 'binary_precision': 0.5714286, 'binary_recall': 0.03305785, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.062499993}
confusion matrix:
      0  1
0  5991  6
1   234  8
early stop counter: 4
val acc:0.9749640226364136, best validation acc: 0.9777339696884155, corresponding to test acc:                         0.9644173979759216 / 0.9745151400566101
after epoch: 22,now: 2024-07-31 05:39:09.341689,epoch time: 0:14:08.083095,used: 5:06:15.848847,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99919915, 'precision': 0.999329, 'recall': 0.9986072, 'specificity': 0.9986072, 'f1': 0.9989674, 'auroc': 0.9999565, 'binary_precision': 0.99960256, 'binary_recall': 0.99735624, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9984782}
confusion matrix:
       0      1
0  42304      6
1     40  15090
---- Validation: 
scalar performance:
{'acc': 0.9735258, 'precision': 0.9207376, 'recall': 0.6024672, 'specificity': 0.6024672, 'f1': 0.6596904, 'auroc': 0.9545013, 'binary_precision': 0.86713284, 'binary_recall': 0.20598006, 'binary_specificity': 0.99895436, 'binary_f1_score': 0.3328859}
confusion matrix:
       0    1
0  18152   19
1    478  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.8360653, 'recall': 0.53454036, 'specificity': 0.53454036, 'f1': 0.55441093, 'auroc': 0.9400487, 'binary_precision': 0.7083333, 'binary_recall': 0.07024793, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.12781955}
confusion matrix:
      0   1
0  5990   7
1   225  17
early stop counter: 5
val acc:0.9735258221626282, best validation acc: 0.9777339696884155, corresponding to test acc:                         0.9644173979759216 / 0.9745151400566101
after epoch: 23,now: 2024-07-31 05:52:57.534821,epoch time: 0:13:48.193132,used: 5:20:04.041979,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9972493, 'precision': 0.9974715, 'recall': 0.9954362, 'specificity': 0.9954362, 'f1': 0.99644816, 'auroc': 0.9995868, 'binary_precision': 0.99793774, 'binary_recall': 0.991605, 'binary_specificity': 0.99926734, 'binary_f1_score': 0.9947612}
confusion matrix:
       0      1
0  42281     31
1    127  15001
---- Validation: 
scalar performance:
{'acc': 0.970383, 'precision': 0.7760476, 'recall': 0.64260226, 'specificity': 0.64260226, 'f1': 0.68624485, 'auroc': 0.9288697, 'binary_precision': 0.5751634, 'binary_recall': 0.29235882, 'binary_specificity': 0.9928457, 'binary_f1_score': 0.3876652}
confusion matrix:
       0    1
0  18041  130
1    426  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.81499946, 'recall': 0.528342, 'specificity': 0.528342, 'f1': 0.5436126, 'auroc': 0.94136053, 'binary_precision': 0.6666667, 'binary_recall': 0.05785124, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.10646388}
confusion matrix:
      0   1
0  5990   7
1   228  14
early stop counter: 6
val acc:0.9703829884529114, best validation acc: 0.9777339696884155, corresponding to test acc:                         0.9644173979759216 / 0.9745151400566101
after epoch: 24,now: 2024-07-31 06:06:46.411022,epoch time: 0:13:48.876201,used: 5:33:52.918180,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9972667, 'precision': 0.99600947, 'recall': 0.9969557, 'specificity': 0.9969557, 'f1': 0.9964813, 'auroc': 0.99988544, 'binary_precision': 0.9933439, 'binary_recall': 0.9962985, 'binary_specificity': 0.9976129, 'binary_f1_score': 0.994819}
confusion matrix:
       0      1
0  42210    101
1     56  15073
---- Validation: 
scalar performance:
{'acc': 0.973366, 'precision': 0.78823256, 'recall': 0.7678126, 'specificity': 0.7678126, 'f1': 0.777612, 'auroc': 0.951673, 'binary_precision': 0.5913978, 'binary_recall': 0.5481728, 'binary_specificity': 0.9874525, 'binary_f1_score': 0.5689655}
confusion matrix:
       0    1
0  17943  228
1    272  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.9069103, 'recall': 0.53487384, 'specificity': 0.53487384, 'f1': 0.5555535, 'auroc': 0.95387655, 'binary_precision': 0.85, 'binary_recall': 0.07024793, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.129771}
confusion matrix:
      0   1
0  5994   3
1   225  17
early stop counter: 7
val acc:0.9733660221099854, best validation acc: 0.9777339696884155, corresponding to test acc:                         0.9644173979759216 / 0.9745151400566101
after epoch: 25,now: 2024-07-31 06:20:28.536044,epoch time: 0:13:42.125022,used: 5:47:35.043202,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99770194, 'precision': 0.998445, 'recall': 0.99563754, 'specificity': 0.99563754, 'f1': 0.99703044, 'auroc': 0.9998756, 'binary_precision': 1.0, 'binary_recall': 0.991275, 'binary_specificity': 1.0, 'binary_f1_score': 0.99561834}
confusion matrix:
       0      1
0  42311      0
1    132  14997
---- Validation: 
scalar performance:
{'acc': 0.9710222, 'precision': 0.8175668, 'recall': 0.59715873, 'specificity': 0.59715873, 'f1': 0.6447754, 'auroc': 0.95293343, 'binary_precision': 0.6611111, 'binary_recall': 0.19767442, 'binary_specificity': 0.996643, 'binary_f1_score': 0.30434784}
confusion matrix:
       0    1
0  18110   61
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.7056662, 'recall': 0.5490683, 'specificity': 0.5490683, 'f1': 0.57371205, 'auroc': 0.9205908, 'binary_precision': 0.44642857, 'binary_recall': 0.10330579, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.16778524}
confusion matrix:
      0   1
0  5966  31
1   217  25
early stop counter: 8
val acc:0.9710221886634827, best validation acc: 0.9777339696884155, corresponding to test acc:                         0.9644173979759216 / 0.9745151400566101
after epoch: 26,now: 2024-07-31 06:34:12.198726,epoch time: 0:13:43.662682,used: 6:01:18.705884,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99794567, 'precision': 0.9976902, 'recall': 0.9970132, 'specificity': 0.9970132, 'f1': 0.99735105, 'auroc': 0.9999221, 'binary_precision': 0.99715173, 'binary_recall': 0.9950426, 'binary_specificity': 0.99898374, 'binary_f1_score': 0.996096}
confusion matrix:
       0      1
0  42268     43
1     75  15054
---- Validation: 
scalar performance:
{'acc': 0.9732062, 'precision': 0.7999823, 'recall': 0.70991063, 'specificity': 0.70991063, 'f1': 0.74630404, 'auroc': 0.95272565, 'binary_precision': 0.61870503, 'binary_recall': 0.42857143, 'binary_specificity': 0.9912498, 'binary_f1_score': 0.5063788}
confusion matrix:
       0    1
0  18012  159
1    344  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.94891226, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
early stop counter: 9
val acc:0.9732062220573425, best validation acc: 0.9777339696884155, corresponding to test acc:                         0.9644173979759216 / 0.9745151400566101
after epoch: 27,now: 2024-07-31 06:48:07.255478,epoch time: 0:13:55.056752,used: 6:15:13.762636,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99810237, 'precision': 0.9982433, 'recall': 0.9968648, 'specificity': 0.9968648, 'f1': 0.99755144, 'auroc': 0.99991775, 'binary_precision': 0.99853957, 'binary_recall': 0.99424946, 'binary_specificity': 0.99948007, 'binary_f1_score': 0.9963899}
confusion matrix:
       0      1
0  42289     22
1     87  15042
---- Validation: 
scalar performance:
{'acc': 0.9760827, 'precision': 0.9216752, 'recall': 0.64956176, 'specificity': 0.64956176, 'f1': 0.7170699, 'auroc': 0.94603074, 'binary_precision': 0.8660287, 'binary_recall': 0.30066445, 'binary_specificity': 0.9984591, 'binary_f1_score': 0.4463625}
confusion matrix:
       0    1
0  18143   28
1    421  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597692, 'precision': 0.5261064, 'recall': 0.5012324, 'specificity': 0.5012324, 'f1': 0.49368674, 'auroc': 0.90054137, 'binary_precision': 0.09090909, 'binary_recall': 0.004132231, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.007905138}
confusion matrix:
      0   1
0  5987  10
1   241   1
early stop counter: 10
val acc:0.9760826826095581, best validation acc: 0.9777339696884155, corresponding to test acc:                         0.9644173979759216 / 0.9745151400566101
after epoch: 28,now: 2024-07-31 07:01:55.588035,epoch time: 0:13:48.332557,used: 6:29:02.095193,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99777156, 'precision': 0.99706566, 'recall': 0.99719226, 'specificity': 0.99719226, 'f1': 0.9971289, 'auroc': 0.99982196, 'binary_precision': 0.99557316, 'binary_recall': 0.995968, 'binary_specificity': 0.9984165, 'binary_f1_score': 0.9957705}
confusion matrix:
       0      1
0  42244     67
1     61  15068
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.75337607, 'recall': 0.74808186, 'specificity': 0.74808186, 'f1': 0.7506981, 'auroc': 0.9425939, 'binary_precision': 0.5229202, 'binary_recall': 0.5116279, 'binary_specificity': 0.9845358, 'binary_f1_score': 0.51721245}
confusion matrix:
       0    1
0  17890  281
1    294  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92627025, 'precision': 0.5763874, 'recall': 0.6067369, 'specificity': 0.6067369, 'f1': 0.5881678, 'auroc': 0.8642669, 'binary_precision': 0.18313953, 'binary_recall': 0.2603306, 'binary_specificity': 0.95314324, 'binary_f1_score': 0.21501708}
confusion matrix:
      0    1
0  5716  281
1   179   63
early stop counter: 11
val acc:0.9693709015846252, best validation acc: 0.9777339696884155, corresponding to test acc:                         0.9644173979759216 / 0.9745151400566101
after epoch: 29,now: 2024-07-31 07:15:58.163017,epoch time: 0:14:02.574982,used: 6:43:04.670175,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9987987, 'precision': 0.99907887, 'recall': 0.99782574, 'specificity': 0.99782574, 'f1': 0.99845016, 'auroc': 0.9999457, 'binary_precision': 0.99966824, 'binary_recall': 0.99576974, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.99771523}
confusion matrix:
       0      1
0  42306      5
1     64  15065
---- Validation: 
scalar performance:
{'acc': 0.9703297, 'precision': 0.8494455, 'recall': 0.5590577, 'specificity': 0.5590577, 'f1': 0.5951517, 'auroc': 0.9576127, 'binary_precision': 0.72727275, 'binary_recall': 0.11960133, 'binary_specificity': 0.9985141, 'binary_f1_score': 0.20542084}
confusion matrix:
       0   1
0  18144  27
1    530  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.4805903, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.4899027, 'auroc': 0.93765664, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   242  0
early stop counter: 12
val acc:0.9703297019004822, best validation acc: 0.9777339696884155, corresponding to test acc:                         0.9644173979759216 / 0.9745151400566101
after epoch: 30,now: 2024-07-31 07:29:50.418459,epoch time: 0:13:52.255442,used: 6:56:56.925617,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_31_00_32_53_seed_2_23419104
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 6:56:56.925617 at 2024-07-31 07:29:50.418459
persisted model performance metric: 

scalar performance:
{'acc': 0.9644174, 'precision': 0.82602024, 'recall': 0.5750289, 'specificity': 0.5750289, 'f1': 0.6158882, 'auroc': 0.92167795, 'binary_precision': 0.6851852, 'binary_recall': 0.15289256, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.24999999}
confusion matrix:
      0   1
0  5980  17
1   205  37
oracle model performance metric: 

scalar performance:
{'acc': 0.97451514, 'precision': 0.8885429, 'recall': 0.72700435, 'specificity': 0.72700435, 'f1': 0.7847667, 'auroc': 0.92296064, 'binary_precision': 0.79856116, 'binary_recall': 0.45867768, 'binary_specificity': 0.995331, 'binary_f1_score': 0.5826771}
confusion matrix:
      0    1
0  5969   28
1   131  111
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_irm_config4_2_2024-07-29_15-36-39/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_irm_config4_2_2024-07-29_15-36-39/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 503152 KiB |  13265 MiB |   4307 TiB |   4307 TiB |
|       from large pool | 461471 KiB |  13227 MiB |   4259 TiB |   4259 TiB |
|       from small pool |  41681 KiB |     61 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 503152 KiB |  13265 MiB |   4307 TiB |   4307 TiB |
|       from large pool | 461471 KiB |  13227 MiB |   4259 TiB |   4259 TiB |
|       from small pool |  41681 KiB |     61 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 496649 KiB |  13261 MiB |   4303 TiB |   4303 TiB |
|       from large pool | 455971 KiB |  13223 MiB |   4255 TiB |   4255 TiB |
|       from small pool |  40678 KiB |     60 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14526 MiB |  14538 MiB |  41660 MiB |  27134 MiB |
|       from large pool |  14460 MiB |  14466 MiB |  41558 MiB |  27098 MiB |
|       from small pool |     66 MiB |     72 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 492175 KiB |   1260 MiB |   3003 TiB |   3003 TiB |
|       from large pool | 480609 KiB |   1252 MiB |   2954 TiB |   2954 TiB |
|       from small pool |  11566 KiB |     44 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8185    |  745537 K  |  745533 K  |
|       from large pool |     187    |    1413    |  391353 K  |  391352 K  |
|       from small pool |    3289    |    7996    |  354183 K  |  354180 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8185    |  745537 K  |  745533 K  |
|       from large pool |     187    |    1413    |  391353 K  |  391352 K  |
|       from small pool |    3289    |    7996    |  354183 K  |  354180 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     639    |     640    |    1783    |    1144    |
|       from large pool |     606    |     606    |    1732    |    1126    |
|       from small pool |      33    |      36    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |    3656    |  440762 K  |  440762 K  |
|       from large pool |      41    |     604    |  251928 K  |  251928 K  |
|       from small pool |      42    |    3614    |  188834 K  |  188833 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |  13265 MiB |   4307 TiB |   4307 TiB |
|       from large pool |  65536 KiB |  13227 MiB |   4259 TiB |   4259 TiB |
|       from small pool |      0 KiB |     61 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |  13265 MiB |   4307 TiB |   4307 TiB |
|       from large pool |  65536 KiB |  13227 MiB |   4259 TiB |   4259 TiB |
|       from small pool |      0 KiB |     61 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |  13261 MiB |   4303 TiB |   4303 TiB |
|       from large pool |  65536 KiB |  13223 MiB |   4255 TiB |   4255 TiB |
|       from small pool |      0 KiB |     60 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    972 MiB |  14538 MiB |  41660 MiB |  40688 MiB |
|       from large pool |    920 MiB |  14466 MiB |  41558 MiB |  40638 MiB |
|       from small pool |     52 MiB |     72 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |   1260 MiB |   3003 TiB |   3003 TiB |
|       from large pool |      0 B   |   1252 MiB |   2954 TiB |   2954 TiB |
|       from small pool |      0 B   |     44 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8185    |  745537 K  |  745537 K  |
|       from large pool |       2    |    1413    |  391353 K  |  391353 K  |
|       from small pool |       0    |    7996    |  354183 K  |  354183 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8185    |  745537 K  |  745537 K  |
|       from large pool |       2    |    1413    |  391353 K  |  391353 K  |
|       from small pool |       0    |    7996    |  354183 K  |  354183 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      69    |     640    |    1783    |    1714    |
|       from large pool |      43    |     606    |    1732    |    1689    |
|       from small pool |      26    |      36    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3656    |  440764 K  |  440764 K  |
|       from large pool |       0    |     604    |  251928 K  |  251928 K  |
|       from small pool |       0    |    3614    |  188835 K  |  188835 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 31 07:30:39 2024]
Finished job 0.
1 of 1 steps (100%) done
