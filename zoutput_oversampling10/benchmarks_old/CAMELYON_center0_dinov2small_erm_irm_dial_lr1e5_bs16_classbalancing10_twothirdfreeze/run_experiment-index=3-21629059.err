Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul  1 05:10:22 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059

 Experiment start at: 2024-07-01 05:16:44.859970
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98553646, 'precision': 0.99001896, 'recall': 0.97234976, 'specificity': 0.97234976, 'f1': 0.98077136, 'auroc': 0.9982048, 'binary_precision': 0.99877936, 'binary_recall': 0.94510126, 'binary_specificity': 0.9995983, 'binary_f1_score': 0.9711992}
confusion matrix:
       0      1
0  42305     17
1    808  13910
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9680715, 'precision': 0.7915858, 'recall': 0.58969116, 'specificity': 0.58969116, 'f1': 0.63298464, 'auroc': 0.9277868, 'binary_precision': 0.61139894, 'binary_recall': 0.18351477, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.28229666}
confusion matrix:
       0    1
0  18074   75
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.92377675, 'recall': 0.58570665, 'specificity': 0.58570665, 'f1': 0.6351354, 'auroc': 0.89376867, 'binary_precision': 0.88235295, 'binary_recall': 0.1724138, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.2884615}
confusion matrix:
      0   1
0  5991   6
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-01 05:39:33.026315,epoch time: 0:22:48.166345,used: 0:22:48.166345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99237376, 'precision': 0.9942115, 'recall': 0.985886, 'specificity': 0.985886, 'f1': 0.98995703, 'auroc': 0.999204, 'binary_precision': 0.99790823, 'binary_recall': 0.97248083, 'binary_specificity': 0.9992912, 'binary_f1_score': 0.9850305}
confusion matrix:
       0      1
0  42293     30
1    405  14312
---- Validation: 
scalar performance:
{'acc': 0.97275436, 'precision': 0.87140733, 'recall': 0.6446194, 'specificity': 0.6446194, 'f1': 0.7047355, 'auroc': 0.9323125, 'binary_precision': 0.7673469, 'binary_recall': 0.29237947, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.42342344}
confusion matrix:
       0    1
0  18092   57
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.9006511, 'recall': 0.57787704, 'specificity': 0.57787704, 'f1': 0.6229184, 'auroc': 0.9191924, 'binary_precision': 0.8367347, 'binary_recall': 0.15708812, 'binary_specificity': 0.998666, 'binary_f1_score': 0.26451614}
confusion matrix:
      0   1
0  5989   8
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_2.png
better model found
persisted
after epoch: 2,now: 2024-07-01 06:01:25.746179,epoch time: 0:21:52.719864,used: 0:44:40.886209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9881487, 'precision': 0.97983176, 'recall': 0.98982, 'specificity': 0.98982, 'f1': 0.98468506, 'auroc': 0.99953496, 'binary_precision': 0.96202946, 'binary_recall': 0.99327356, 'binary_specificity': 0.98636645, 'binary_f1_score': 0.9774019}
confusion matrix:
       0      1
0  41745    577
1     99  14619
---- Validation: 
scalar performance:
{'acc': 0.9238506, 'precision': 0.64686716, 'recall': 0.9125728, 'specificity': 0.9125728, 'f1': 0.7031927, 'auroc': 0.9561651, 'binary_precision': 0.2975334, 'binary_recall': 0.90046656, 'binary_specificity': 0.92467904, 'binary_f1_score': 0.44727695}
confusion matrix:
       0     1
0  16782  1367
1     64   579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9263343, 'precision': 0.6668868, 'recall': 0.87910914, 'specificity': 0.87910914, 'f1': 0.72204995, 'auroc': 0.93627656, 'binary_precision': 0.34177214, 'binary_recall': 0.82758623, 'binary_specificity': 0.930632, 'binary_f1_score': 0.4837626}
confusion matrix:
      0    1
0  5581  416
1    45  216
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_3.png
early stop counter: 1
val acc:0.9238505959510803, best validation acc: 0.9727543592453003, corresponding to test acc:                         0.9635666608810425 / 0.9645254015922546
after epoch: 3,now: 2024-07-01 06:23:34.068192,epoch time: 0:22:08.322013,used: 1:06:49.208222,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9901122, 'precision': 0.9840662, 'recall': 0.9903898, 'specificity': 0.9903898, 'f1': 0.98717254, 'auroc': 0.9994877, 'binary_precision': 0.97129726, 'binary_recall': 0.99096346, 'binary_specificity': 0.9898162, 'binary_f1_score': 0.98103184}
confusion matrix:
       0      1
0  41891    431
1    133  14585
---- Validation: 
scalar performance:
{'acc': 0.93316305, 'precision': 0.64473104, 'recall': 0.8281374, 'specificity': 0.8281374, 'f1': 0.6936609, 'auroc': 0.9348861, 'binary_precision': 0.30006522, 'binary_recall': 0.7153966, 'binary_specificity': 0.9408783, 'binary_f1_score': 0.4227941}
confusion matrix:
       0     1
0  17076  1073
1    183   460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9229786, 'precision': 0.63127816, 'recall': 0.7454302, 'specificity': 0.7454302, 'f1': 0.6664953, 'auroc': 0.88813114, 'binary_precision': 0.28290766, 'binary_recall': 0.55172414, 'binary_specificity': 0.9391362, 'binary_f1_score': 0.37402597}
confusion matrix:
      0    1
0  5632  365
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_4.png
early stop counter: 2
val acc:0.933163046836853, best validation acc: 0.9727543592453003, corresponding to test acc:                         0.9635666608810425 / 0.9645254015922546
after epoch: 4,now: 2024-07-01 06:45:54.936607,epoch time: 0:22:20.868415,used: 1:29:10.076637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99482816, 'precision': 0.9926791, 'recall': 0.99383396, 'specificity': 0.99383396, 'f1': 0.9932548, 'auroc': 0.9997028, 'binary_precision': 0.98822093, 'binary_recall': 0.9917793, 'binary_specificity': 0.9958886, 'binary_f1_score': 0.98999697}
confusion matrix:
       0      1
0  42147    174
1    121  14598
---- Validation: 
scalar performance:
{'acc': 0.9739783, 'precision': 0.80962384, 'recall': 0.77651274, 'specificity': 0.77651274, 'f1': 0.79204273, 'auroc': 0.9622884, 'binary_precision': 0.63461536, 'binary_recall': 0.5645412, 'binary_specificity': 0.9884842, 'binary_f1_score': 0.5975309}
confusion matrix:
       0    1
0  17940  209
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.91877955, 'recall': 0.6027813, 'specificity': 0.6027813, 'f1': 0.65836614, 'auroc': 0.9488498, 'binary_precision': 0.87096775, 'binary_recall': 0.20689656, 'binary_specificity': 0.998666, 'binary_f1_score': 0.33436534}
confusion matrix:
      0   1
0  5989   8
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-01 07:08:29.330824,epoch time: 0:22:34.394217,used: 1:51:44.470854,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.995845, 'precision': 0.9963751, 'recall': 0.9927671, 'specificity': 0.9927671, 'f1': 0.9945539, 'auroc': 0.99973065, 'binary_precision': 0.9974574, 'binary_recall': 0.9864084, 'binary_specificity': 0.99912584, 'binary_f1_score': 0.9919022}
confusion matrix:
       0      1
0  42288     37
1    200  14515
---- Validation: 
scalar performance:
{'acc': 0.97376543, 'precision': 0.91611314, 'recall': 0.6391424, 'specificity': 0.6391424, 'f1': 0.704309, 'auroc': 0.95992815, 'binary_precision': 0.85714287, 'binary_recall': 0.2799378, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.42203987}
confusion matrix:
       0    1
0  18119   30
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.95019877, 'recall': 0.5573045, 'specificity': 0.5573045, 'f1': 0.5928579, 'auroc': 0.95345616, 'binary_precision': 0.9375, 'binary_recall': 0.11494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.20477815}
confusion matrix:
      0   1
0  5995   2
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_6.png
early stop counter: 1
val acc:0.9737654328346252, best validation acc: 0.9739782810211182, corresponding to test acc:                         0.9656440019607544 / 0.9656440019607544
after epoch: 6,now: 2024-07-01 07:30:35.144557,epoch time: 0:22:05.813733,used: 2:13:50.284587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99493337, 'precision': 0.9918247, 'recall': 0.9950123, 'specificity': 0.9950123, 'f1': 0.9934047, 'auroc': 0.99978554, 'binary_precision': 0.9853327, 'binary_recall': 0.9951753, 'binary_specificity': 0.99484926, 'binary_f1_score': 0.9902295}
confusion matrix:
       0      1
0  42106    218
1     71  14645
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.7588812, 'recall': 0.882378, 'specificity': 0.882378, 'f1': 0.807272, 'auroc': 0.96555054, 'binary_precision': 0.5253361, 'binary_recall': 0.79004663, 'binary_specificity': 0.97470933, 'binary_f1_score': 0.6310559}
confusion matrix:
       0    1
0  17690  459
1    135  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.79318476, 'recall': 0.77918553, 'specificity': 0.77918553, 'f1': 0.78599226, 'auroc': 0.9486544, 'binary_precision': 0.6048387, 'binary_recall': 0.57471263, 'binary_specificity': 0.9836585, 'binary_f1_score': 0.58939093}
confusion matrix:
      0    1
0  5899   98
1   111  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_7.png
new oracle model saved
early stop counter: 2
val acc:0.9683908224105835, best validation acc: 0.9739782810211182, corresponding to test acc:                         0.9656440019607544 / 0.9666027426719666
after epoch: 7,now: 2024-07-01 07:53:07.278243,epoch time: 0:22:32.133686,used: 2:36:22.418273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99482816, 'precision': 0.99472463, 'recall': 0.991749, 'specificity': 0.991749, 'f1': 0.993225, 'auroc': 0.99973524, 'binary_precision': 0.9945127, 'binary_recall': 0.98538804, 'binary_specificity': 0.99810994, 'binary_f1_score': 0.9899293}
confusion matrix:
       0      1
0  42246     80
1    215  14499
---- Validation: 
scalar performance:
{'acc': 0.9717965, 'precision': 0.80963105, 'recall': 0.6966274, 'specificity': 0.6966274, 'f1': 0.7394012, 'auroc': 0.9604466, 'binary_precision': 0.6401985, 'binary_recall': 0.40124416, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.4933079}
confusion matrix:
       0    1
0  18004  145
1    385  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.90413207, 'recall': 0.6652493, 'specificity': 0.6652493, 'f1': 0.73049676, 'auroc': 0.9520038, 'binary_precision': 0.83653843, 'binary_recall': 0.33333334, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.47671232}
confusion matrix:
      0   1
0  5980  17
1   174  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_8.png
new oracle model saved
early stop counter: 3
val acc:0.9717965126037598, best validation acc: 0.9739782810211182, corresponding to test acc:                         0.9656440019607544 / 0.9694790840148926
after epoch: 8,now: 2024-07-01 08:15:11.306966,epoch time: 0:22:04.028723,used: 2:58:26.446996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9948983, 'precision': 0.99217725, 'recall': 0.9945456, 'specificity': 0.9945456, 'f1': 0.9933538, 'auroc': 0.99976814, 'binary_precision': 0.98651016, 'binary_recall': 0.9938167, 'binary_specificity': 0.9952744, 'binary_f1_score': 0.99014986}
confusion matrix:
       0      1
0  42123    200
1     91  14626
---- Validation: 
scalar performance:
{'acc': 0.920232, 'precision': 0.63683695, 'recall': 0.88369745, 'specificity': 0.88369745, 'f1': 0.6886431, 'auroc': 0.94796, 'binary_precision': 0.27960864, 'binary_recall': 0.844479, 'binary_specificity': 0.9229159, 'binary_f1_score': 0.42011604}
confusion matrix:
       0     1
0  16750  1399
1    100   543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90284437, 'precision': 0.63602424, 'recall': 0.87418234, 'specificity': 0.87418234, 'f1': 0.6834151, 'auroc': 0.93285656, 'binary_precision': 0.27954257, 'binary_recall': 0.8429119, 'binary_specificity': 0.9054527, 'binary_f1_score': 0.41984734}
confusion matrix:
      0    1
0  5430  567
1    41  220
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_9.png
early stop counter: 4
val acc:0.9202319979667664, best validation acc: 0.9739782810211182, corresponding to test acc:                         0.9656440019607544 / 0.9694790840148926
after epoch: 9,now: 2024-07-01 08:36:59.543711,epoch time: 0:21:48.236745,used: 3:20:14.683741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9939341, 'precision': 0.995783, 'recall': 0.98839927, 'specificity': 0.98839927, 'f1': 0.9920192, 'auroc': 0.99972844, 'binary_precision': 0.9995133, 'binary_recall': 0.9769639, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.98811}
confusion matrix:
       0      1
0  42317      7
1    339  14377
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.9180329, 'recall': 0.535577, 'specificity': 0.535577, 'f1': 0.557905, 'auroc': 0.9637557, 'binary_precision': 0.8679245, 'binary_recall': 0.071539655, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.13218391}
confusion matrix:
       0   1
0  18142   7
1    597  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.77936995, 'recall': 0.50558037, 'specificity': 0.50558037, 'f1': 0.50066596, 'auroc': 0.9478844, 'binary_precision': 0.6, 'binary_recall': 0.011494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.02255639}
confusion matrix:
      0  1
0  5995  2
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_10.png
early stop counter: 5
val acc:0.9678586721420288, best validation acc: 0.9739782810211182, corresponding to test acc:                         0.9656440019607544 / 0.9694790840148926
after epoch: 10,now: 2024-07-01 08:58:34.170502,epoch time: 0:21:34.626791,used: 3:41:49.310532,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9967567, 'precision': 0.9970343, 'recall': 0.9944907, 'specificity': 0.9944907, 'f1': 0.9957539, 'auroc': 0.99976325, 'binary_precision': 0.99760324, 'binary_recall': 0.9898084, 'binary_specificity': 0.999173, 'binary_f1_score': 0.99369055}
confusion matrix:
       0      1
0  42287     35
1    150  14568
---- Validation: 
scalar performance:
{'acc': 0.97690505, 'precision': 0.84964764, 'recall': 0.7660271, 'specificity': 0.7660271, 'f1': 0.80167174, 'auroc': 0.9681657, 'binary_precision': 0.71546394, 'binary_recall': 0.53965783, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.61524826}
confusion matrix:
       0    1
0  18011  138
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.745564, 'recall': 0.5717945, 'specificity': 0.5717945, 'f1': 0.6058687, 'auroc': 0.9303825, 'binary_precision': 0.527027, 'binary_recall': 0.14942528, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.23283583}
confusion matrix:
      0   1
0  5962  35
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_11.png
better model found
persisted
after epoch: 11,now: 2024-07-01 09:20:35.028216,epoch time: 0:22:00.857714,used: 4:03:50.168246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9972475, 'precision': 0.9971652, 'recall': 0.9956409, 'specificity': 0.9956409, 'f1': 0.99639994, 'auroc': 0.999805, 'binary_precision': 0.996996, 'binary_recall': 0.9923213, 'binary_specificity': 0.9989604, 'binary_f1_score': 0.99465317}
confusion matrix:
       0      1
0  42280     44
1    113  14603
---- Validation: 
scalar performance:
{'acc': 0.97839504, 'precision': 0.8743465, 'recall': 0.7630482, 'specificity': 0.7630482, 'f1': 0.8081989, 'auroc': 0.9619986, 'binary_precision': 0.76510066, 'binary_recall': 0.5318818, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.6275229}
confusion matrix:
       0    1
0  18044  105
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.83143187, 'recall': 0.603363, 'specificity': 0.603363, 'f1': 0.6523199, 'auroc': 0.9466237, 'binary_precision': 0.6962025, 'binary_recall': 0.21072797, 'binary_specificity': 0.995998, 'binary_f1_score': 0.32352942}
confusion matrix:
      0   1
0  5973  24
1   206  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_12.png
better model found
persisted
after epoch: 12,now: 2024-07-01 09:42:38.984706,epoch time: 0:22:03.956490,used: 4:25:54.124736,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99749297, 'precision': 0.9970885, 'recall': 0.99636066, 'specificity': 0.99636066, 'f1': 0.9967239, 'auroc': 0.99986666, 'binary_precision': 0.9962547, 'binary_recall': 0.99402094, 'binary_specificity': 0.99870044, 'binary_f1_score': 0.99513656}
confusion matrix:
       0      1
0  42267     55
1     88  14630
---- Validation: 
scalar performance:
{'acc': 0.9749361, 'precision': 0.80940896, 'recall': 0.8145114, 'specificity': 0.8145114, 'f1': 0.8119372, 'auroc': 0.9674326, 'binary_precision': 0.63149846, 'binary_recall': 0.64230174, 'binary_specificity': 0.98672104, 'binary_f1_score': 0.6368543}
confusion matrix:
       0    1
0  17908  241
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.84767205, 'recall': 0.6206044, 'specificity': 0.6206044, 'f1': 0.6742991, 'auroc': 0.9467474, 'binary_precision': 0.72727275, 'binary_recall': 0.24521072, 'binary_specificity': 0.995998, 'binary_f1_score': 0.36676216}
confusion matrix:
      0   1
0  5973  24
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_13.png
early stop counter: 1
val acc:0.9749361276626587, best validation acc: 0.9783950448036194, corresponding to test acc:                         0.9632470607757568 / 0.9694790840148926
after epoch: 13,now: 2024-07-01 10:04:41.219448,epoch time: 0:22:02.234742,used: 4:47:56.359478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99570477, 'precision': 0.99707645, 'recall': 0.9917201, 'specificity': 0.9917201, 'f1': 0.99436045, 'auroc': 0.99989426, 'binary_precision': 0.99986184, 'binary_recall': 0.98348737, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.991607}
confusion matrix:
       0      1
0  42322      2
1    243  14473
---- Validation: 
scalar performance:
{'acc': 0.9771711, 'precision': 0.94025123, 'recall': 0.6859089, 'specificity': 0.6859089, 'f1': 0.75817776, 'auroc': 0.9669347, 'binary_precision': 0.90225565, 'binary_recall': 0.3732504, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.52805287}
confusion matrix:
       0    1
0  18123   26
1    403  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.9398973, 'recall': 0.582042, 'specificity': 0.582042, 'f1': 0.630518, 'auroc': 0.9564551, 'binary_precision': 0.9148936, 'binary_recall': 0.16475096, 'binary_specificity': 0.999333, 'binary_f1_score': 0.27922082}
confusion matrix:
      0   1
0  5993   4
1   218  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_14.png
early stop counter: 2
val acc:0.9771711230278015, best validation acc: 0.9783950448036194, corresponding to test acc:                         0.9632470607757568 / 0.9694790840148926
after epoch: 14,now: 2024-07-01 10:27:23.006267,epoch time: 0:22:41.786819,used: 5:10:38.146297,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9966164, 'precision': 0.9955708, 'recall': 0.9955927, 'specificity': 0.9955927, 'f1': 0.99558175, 'auroc': 0.99973786, 'binary_precision': 0.9934099, 'binary_recall': 0.9934774, 'binary_specificity': 0.997708, 'binary_f1_score': 0.99344367}
confusion matrix:
       0      1
0  42225     97
1     96  14622
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7502919, 'recall': 0.70987153, 'specificity': 0.70987153, 'f1': 0.7281122, 'auroc': 0.9450226, 'binary_precision': 0.5205224, 'binary_recall': 0.43390357, 'binary_specificity': 0.9858394, 'binary_f1_score': 0.47328246}
confusion matrix:
       0    1
0  17892  257
1    364  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.67325395, 'recall': 0.5445577, 'specificity': 0.5445577, 'f1': 0.5653663, 'auroc': 0.91395605, 'binary_precision': 0.3846154, 'binary_recall': 0.09578544, 'binary_specificity': 0.99333, 'binary_f1_score': 0.15337424}
confusion matrix:
      0   1
0  5957  40
1   236  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_15.png
early stop counter: 3
val acc:0.9669540524482727, best validation acc: 0.9783950448036194, corresponding to test acc:                         0.9632470607757568 / 0.9694790840148926
after epoch: 15,now: 2024-07-01 10:49:35.408967,epoch time: 0:22:12.402700,used: 5:32:50.548997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99691445, 'precision': 0.99772537, 'recall': 0.99421954, 'specificity': 0.99421954, 'f1': 0.99595624, 'auroc': 0.99986434, 'binary_precision': 0.9993818, 'binary_recall': 0.9886518, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.99398786}
confusion matrix:
       0      1
0  42315      9
1    167  14549
---- Validation: 
scalar performance:
{'acc': 0.9789804, 'precision': 0.87860227, 'recall': 0.7701017, 'specificity': 0.7701017, 'f1': 0.81455064, 'auroc': 0.9563533, 'binary_precision': 0.77312773, 'binary_recall': 0.5458787, 'binary_specificity': 0.99432474, 'binary_f1_score': 0.6399271}
confusion matrix:
       0    1
0  18046  103
1    292  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.8845763, 'recall': 0.6572529, 'specificity': 0.6572529, 'f1': 0.7192086, 'auroc': 0.9475809, 'binary_precision': 0.7980769, 'binary_recall': 0.31800765, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.45479453}
confusion matrix:
      0   1
0  5976  21
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_16.png
better model found
persisted
after epoch: 16,now: 2024-07-01 11:11:40.567739,epoch time: 0:22:05.158772,used: 5:54:55.707769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99635345, 'precision': 0.9940359, 'recall': 0.9964789, 'specificity': 0.9964789, 'f1': 0.9952494, 'auroc': 0.99985707, 'binary_precision': 0.9892089, 'binary_recall': 0.996738, 'binary_specificity': 0.99621975, 'binary_f1_score': 0.9929592}
confusion matrix:
       0      1
0  42165    160
1     48  14667
---- Validation: 
scalar performance:
{'acc': 0.95854616, 'precision': 0.7179811, 'recall': 0.89003223, 'specificity': 0.89003223, 'f1': 0.7761485, 'auroc': 0.9633143, 'binary_precision': 0.4426644, 'binary_recall': 0.8164852, 'binary_specificity': 0.96357924, 'binary_f1_score': 0.57408416}
confusion matrix:
       0    1
0  17488  661
1    118  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94103545, 'precision': 0.65995586, 'recall': 0.7090432, 'specificity': 0.7090432, 'f1': 0.6805536, 'auroc': 0.91580164, 'binary_precision': 0.34393063, 'binary_recall': 0.4559387, 'binary_specificity': 0.9621477, 'binary_f1_score': 0.39209226}
confusion matrix:
      0    1
0  5770  227
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_17.png
early stop counter: 1
val acc:0.9585461616516113, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.96820068359375 / 0.9694790840148926
after epoch: 17,now: 2024-07-01 11:33:41.932655,epoch time: 0:22:01.364916,used: 6:16:57.072685,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9972651, 'precision': 0.997556, 'recall': 0.9952986, 'specificity': 0.9952986, 'f1': 0.9964206, 'auroc': 0.9998504, 'binary_precision': 0.99815273, 'binary_recall': 0.9912352, 'binary_specificity': 0.99936205, 'binary_f1_score': 0.99468195}
confusion matrix:
       0      1
0  42295     27
1    129  14589
---- Validation: 
scalar performance:
{'acc': 0.9786079, 'precision': 0.8533225, 'recall': 0.8021612, 'specificity': 0.8021612, 'f1': 0.8255695, 'auroc': 0.96371853, 'binary_precision': 0.7202925, 'binary_recall': 0.61275274, 'binary_specificity': 0.99156976, 'binary_f1_score': 0.6621849}
confusion matrix:
       0    1
0  17996  153
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.86590385, 'recall': 0.70023036, 'specificity': 0.70023036, 'f1': 0.7565389, 'auroc': 0.96210825, 'binary_precision': 0.75714284, 'binary_recall': 0.40613025, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.5286783}
confusion matrix:
      0    1
0  5963   34
1   155  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_18.png
new oracle model saved
early stop counter: 2
val acc:0.9786078929901123, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.96820068359375 / 0.9697986841201782
after epoch: 18,now: 2024-07-01 11:55:15.332648,epoch time: 0:21:33.399993,used: 6:38:30.472678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99256665, 'precision': 0.9872077, 'recall': 0.9936169, 'specificity': 0.9936169, 'f1': 0.99035585, 'auroc': 0.9998205, 'binary_precision': 0.97589076, 'binary_recall': 0.9957866, 'binary_specificity': 0.99144715, 'binary_f1_score': 0.98573834}
confusion matrix:
       0      1
0  41963    362
1     62  14653
---- Validation: 
scalar performance:
{'acc': 0.9761069, 'precision': 0.82959604, 'recall': 0.78736544, 'specificity': 0.78736544, 'f1': 0.806902, 'auroc': 0.9633051, 'binary_precision': 0.6738351, 'binary_recall': 0.58475894, 'binary_specificity': 0.9899719, 'binary_f1_score': 0.6261449}
confusion matrix:
       0    1
0  17967  182
1    267  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.78139496, 'recall': 0.5558038, 'specificity': 0.5558038, 'f1': 0.5861803, 'auroc': 0.94727683, 'binary_precision': 0.6, 'binary_recall': 0.11494253, 'binary_specificity': 0.996665, 'binary_f1_score': 0.19292603}
confusion matrix:
      0   1
0  5977  20
1   231  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_19.png
early stop counter: 3
val acc:0.9761068820953369, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.96820068359375 / 0.9697986841201782
after epoch: 19,now: 2024-07-01 12:17:23.219642,epoch time: 0:22:07.886994,used: 7:00:38.359672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99815917, 'precision': 0.99776065, 'recall': 0.9974294, 'specificity': 0.9974294, 'f1': 0.99759483, 'auroc': 0.9999274, 'binary_precision': 0.99693835, 'binary_recall': 0.99592197, 'binary_specificity': 0.99893683, 'binary_f1_score': 0.99642986}
confusion matrix:
       0      1
0  42282     45
1     60  14653
---- Validation: 
scalar performance:
{'acc': 0.9779161, 'precision': 0.834846, 'recall': 0.82730496, 'specificity': 0.82730496, 'f1': 0.8310285, 'auroc': 0.9710392, 'binary_precision': 0.6815287, 'binary_recall': 0.66562986, 'binary_specificity': 0.9889801, 'binary_f1_score': 0.67348546}
confusion matrix:
       0    1
0  17949  200
1    215  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9699584, 'precision': 0.8668448, 'recall': 0.7021461, 'specificity': 0.7021461, 'f1': 0.7584095, 'auroc': 0.9611908, 'binary_precision': 0.75886524, 'binary_recall': 0.4099617, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.5323383}
confusion matrix:
      0    1
0  5963   34
1   154  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_20.png
new oracle model saved
early stop counter: 4
val acc:0.9779161214828491, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.96820068359375 / 0.9699584245681763
after epoch: 20,now: 2024-07-01 12:39:51.653375,epoch time: 0:22:28.433733,used: 7:23:06.793405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99815917, 'precision': 0.9984487, 'recall': 0.99674237, 'specificity': 0.99674237, 'f1': 0.99759173, 'auroc': 0.99995923, 'binary_precision': 0.9990435, 'binary_recall': 0.9938154, 'binary_specificity': 0.99966925, 'binary_f1_score': 0.99642265}
confusion matrix:
       0      1
0  42312     14
1     91  14623
---- Validation: 
scalar performance:
{'acc': 0.9781822, 'precision': 0.861417, 'recall': 0.777189, 'specificity': 0.777189, 'f1': 0.81328076, 'auroc': 0.96813786, 'binary_precision': 0.7382413, 'binary_recall': 0.5614308, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.6378092}
confusion matrix:
       0    1
0  18021  128
1    282  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.8717783, 'recall': 0.5927025, 'specificity': 0.5927025, 'f1': 0.64196616, 'auroc': 0.9624035, 'binary_precision': 0.7777778, 'binary_recall': 0.18773946, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.3024691}
confusion matrix:
      0   1
0  5983  14
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_21.png
early stop counter: 5
val acc:0.9781821966171265, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.96820068359375 / 0.9699584245681763
after epoch: 21,now: 2024-07-01 13:01:48.756917,epoch time: 0:21:57.103542,used: 7:45:03.896947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9970372, 'precision': 0.99798876, 'recall': 0.9942801, 'specificity': 0.9942801, 'f1': 0.99611634, 'auroc': 0.9998905, 'binary_precision': 0.9999313, 'binary_recall': 0.98858386, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9942252}
confusion matrix:
       0      1
0  42323      1
1    168  14548
---- Validation: 
scalar performance:
{'acc': 0.9779161, 'precision': 0.91493654, 'recall': 0.71404666, 'specificity': 0.71404666, 'f1': 0.78019464, 'auroc': 0.9666065, 'binary_precision': 0.84969324, 'binary_recall': 0.43079317, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.57172346}
confusion matrix:
       0    1
0  18100   49
1    366  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.9259213, 'recall': 0.6028647, 'specificity': 0.6028647, 'f1': 0.6589271, 'auroc': 0.95892835, 'binary_precision': 0.8852459, 'binary_recall': 0.20689656, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.33540374}
confusion matrix:
      0   1
0  5990   7
1   207  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_22.png
early stop counter: 6
val acc:0.9779161214828491, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.96820068359375 / 0.9699584245681763
after epoch: 22,now: 2024-07-01 13:23:43.030533,epoch time: 0:21:54.273616,used: 8:06:58.170563,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99815917, 'precision': 0.99851584, 'recall': 0.99667627, 'specificity': 0.99667627, 'f1': 0.9975916, 'auroc': 0.9998598, 'binary_precision': 0.99924827, 'binary_recall': 0.9936124, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.9964224}
confusion matrix:
       0      1
0  42313     11
1     94  14622
---- Validation: 
scalar performance:
{'acc': 0.9747233, 'precision': 0.9024365, 'recall': 0.6636401, 'specificity': 0.6636401, 'f1': 0.7293436, 'auroc': 0.96450096, 'binary_precision': 0.828125, 'binary_recall': 0.32970452, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.4716352}
confusion matrix:
       0    1
0  18105   44
1    431  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95573664, 'precision': 0.6739496, 'recall': 0.54813904, 'specificity': 0.54813904, 'f1': 0.57020456, 'auroc': 0.91618705, 'binary_precision': 0.3857143, 'binary_recall': 0.10344828, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.163142}
confusion matrix:
      0   1
0  5954  43
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_23.png
early stop counter: 7
val acc:0.9747232794761658, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.96820068359375 / 0.9699584245681763
after epoch: 23,now: 2024-07-01 13:46:01.989462,epoch time: 0:22:18.958929,used: 8:29:17.129492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9973177, 'precision': 0.99813104, 'recall': 0.9948691, 'specificity': 0.9948691, 'f1': 0.996486, 'auroc': 0.99989986, 'binary_precision': 0.9997941, 'binary_recall': 0.9898091, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9947765}
confusion matrix:
       0      1
0  42318      3
1    150  14569
---- Validation: 
scalar performance:
{'acc': 0.9761069, 'precision': 0.83927214, 'recall': 0.7648637, 'specificity': 0.7648637, 'f1': 0.7970824, 'auroc': 0.9639618, 'binary_precision': 0.6947791, 'binary_recall': 0.5381026, 'binary_specificity': 0.9916249, 'binary_f1_score': 0.6064855}
confusion matrix:
       0    1
0  17997  152
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.81377274, 'recall': 0.77677155, 'specificity': 0.77677155, 'f1': 0.79397494, 'auroc': 0.9395021, 'binary_precision': 0.6462882, 'binary_recall': 0.5670498, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.60408163}
confusion matrix:
      0    1
0  5916   81
1   113  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_24.png
early stop counter: 8
val acc:0.9761068820953369, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.96820068359375 / 0.9699584245681763
after epoch: 24,now: 2024-07-01 14:08:20.429829,epoch time: 0:22:18.440367,used: 8:51:35.569859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9972651, 'precision': 0.9980733, 'recall': 0.9947883, 'specificity': 0.9947883, 'f1': 0.99641657, 'auroc': 0.999843, 'binary_precision': 0.9997254, 'binary_recall': 0.9896711, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99467283}
confusion matrix:
       0      1
0  42320      4
1    152  14564
---- Validation: 
scalar performance:
{'acc': 0.9756279, 'precision': 0.8673991, 'recall': 0.7106118, 'specificity': 0.7106118, 'f1': 0.7661052, 'auroc': 0.9597879, 'binary_precision': 0.75482094, 'binary_recall': 0.42612752, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.54473156}
confusion matrix:
       0    1
0  18060   89
1    369  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.78774464, 'recall': 0.59869784, 'specificity': 0.59869784, 'f1': 0.6423547, 'auroc': 0.9451164, 'binary_precision': 0.6091954, 'binary_recall': 0.20306513, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.3045977}
confusion matrix:
      0   1
0  5963  34
1   208  53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_25.png
early stop counter: 9
val acc:0.9756278991699219, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.96820068359375 / 0.9699584245681763
after epoch: 25,now: 2024-07-01 14:30:04.956096,epoch time: 0:21:44.526267,used: 9:13:20.096126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99775594, 'precision': 0.99742126, 'recall': 0.99671495, 'specificity': 0.99671495, 'f1': 0.99706745, 'auroc': 0.999908, 'binary_precision': 0.99673134, 'binary_recall': 0.9945641, 'binary_specificity': 0.99886584, 'binary_f1_score': 0.99564654}
confusion matrix:
       0      1
0  42275     48
1     80  14637
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7458233, 'recall': 0.8406353, 'specificity': 0.8406353, 'f1': 0.7846053, 'auroc': 0.9572924, 'binary_precision': 0.5022124, 'binary_recall': 0.7060653, 'binary_specificity': 0.97520524, 'binary_f1_score': 0.58694243}
confusion matrix:
       0    1
0  17699  450
1    189  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7578901, 'recall': 0.7654402, 'specificity': 0.7654402, 'f1': 0.761603, 'auroc': 0.95725226, 'binary_precision': 0.535316, 'binary_recall': 0.55172414, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.54339623}
confusion matrix:
      0    1
0  5872  125
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_26.png
early stop counter: 10
val acc:0.9659961462020874, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.96820068359375 / 0.9699584245681763
after epoch: 26,now: 2024-07-01 14:51:50.042934,epoch time: 0:21:45.086838,used: 9:35:05.182964,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99807155, 'precision': 0.99836737, 'recall': 0.9965948, 'specificity': 0.9965948, 'f1': 0.99747694, 'auroc': 0.9999181, 'binary_precision': 0.99897504, 'binary_recall': 0.993544, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.9962521}
confusion matrix:
       0      1
0  42310     15
1     95  14620
---- Validation: 
scalar performance:
{'acc': 0.9749361, 'precision': 0.8393898, 'recall': 0.73275536, 'specificity': 0.73275536, 'f1': 0.7752912, 'auroc': 0.9608264, 'binary_precision': 0.6972477, 'binary_recall': 0.47278383, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.56348467}
confusion matrix:
       0    1
0  18017  132
1    339  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9760307, 'precision': 0.8906965, 'recall': 0.78044003, 'specificity': 0.78044003, 'f1': 0.8256248, 'auroc': 0.9545392, 'binary_precision': 0.8, 'binary_recall': 0.5670498, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.6636771}
confusion matrix:
      0    1
0  5960   37
1   113  148
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_27.png
new oracle model saved
early stop counter: 11
val acc:0.9749361276626587, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.96820068359375 / 0.976030707359314
after epoch: 27,now: 2024-07-01 15:13:47.988875,epoch time: 0:21:57.945941,used: 9:57:03.128905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9981943, 'precision': 0.9986738, 'recall': 0.9966115, 'specificity': 0.9966115, 'f1': 0.99763703, 'auroc': 0.9999019, 'binary_precision': 0.9996581, 'binary_recall': 0.993341, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9964896}
confusion matrix:
       0      1
0  42318      5
1     98  14619
---- Validation: 
scalar performance:
{'acc': 0.97647935, 'precision': 0.91195124, 'recall': 0.6900511, 'specificity': 0.6900511, 'f1': 0.7573533, 'auroc': 0.9697182, 'binary_precision': 0.8453608, 'binary_recall': 0.38258165, 'binary_specificity': 0.9975205, 'binary_f1_score': 0.5267666}
confusion matrix:
       0    1
0  18104   45
1    397  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.88913184, 'recall': 0.6289342, 'specificity': 0.6289342, 'f1': 0.6885154, 'auroc': 0.95393693, 'binary_precision': 0.8095238, 'binary_recall': 0.2605364, 'binary_specificity': 0.997332, 'binary_f1_score': 0.3942029}
confusion matrix:
      0   1
0  5981  16
1   193  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_28.png
early stop counter: 12
val acc:0.9764793515205383, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.96820068359375 / 0.976030707359314
after epoch: 28,now: 2024-07-01 15:35:46.560293,epoch time: 0:21:58.571418,used: 10:19:01.700323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9978086, 'precision': 0.9984826, 'recall': 0.9957973, 'specificity': 0.9957973, 'f1': 0.9971304, 'auroc': 0.9999243, 'binary_precision': 0.99986297, 'binary_recall': 0.99164176, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9957354}
confusion matrix:
       0      1
0  42322      2
1    123  14593
---- Validation: 
scalar performance:
{'acc': 0.9703065, 'precision': 0.9456831, 'recall': 0.5720969, 'specificity': 0.5720969, 'f1': 0.61742675, 'auroc': 0.9672626, 'binary_precision': 0.9207921, 'binary_recall': 0.14463453, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.25000003}
confusion matrix:
       0   1
0  18141   8
1    550  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.9344558, 'recall': 0.5190737, 'specificity': 0.5190737, 'f1': 0.52647394, 'auroc': 0.966799, 'binary_precision': 0.90909094, 'binary_recall': 0.038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.07352941}
confusion matrix:
      0   1
0  5996   1
1   251  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_29.png
early stop counter: 13
val acc:0.9703065156936646, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.96820068359375 / 0.976030707359314
after epoch: 29,now: 2024-07-01 15:57:39.644952,epoch time: 0:21:53.084659,used: 10:40:54.784982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9983696, 'precision': 0.9986797, 'recall': 0.9970622, 'specificity': 0.9970622, 'f1': 0.99786747, 'auroc': 0.9999232, 'binary_precision': 0.99931717, 'binary_recall': 0.9943606, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.9968327}
confusion matrix:
       0      1
0  42312     10
1     83  14635
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.74654675, 'recall': 0.72465223, 'specificity': 0.72465223, 'f1': 0.73503345, 'auroc': 0.9429475, 'binary_precision': 0.5119863, 'binary_recall': 0.46500778, 'binary_specificity': 0.9842967, 'binary_f1_score': 0.48736757}
confusion matrix:
       0    1
0  17864  285
1    344  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.78618217, 'recall': 0.65441823, 'specificity': 0.65441823, 'f1': 0.69840544, 'auroc': 0.9509787, 'binary_precision': 0.60144925, 'binary_recall': 0.31800765, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.4160401}
confusion matrix:
      0   1
0  5942  55
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_30.png
early stop counter: 14
val acc:0.9665282964706421, best validation acc: 0.9789804220199585, corresponding to test acc:                         0.96820068359375 / 0.976030707359314
after epoch: 30,now: 2024-07-01 16:19:38.679256,epoch time: 0:21:59.034304,used: 11:02:53.819286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_16_44_seed_0_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:02:53.819286 at 2024-07-01 16:19:38.679256
persisted model performance metric: 

scalar performance:
{'acc': 0.9682007, 'precision': 0.8845763, 'recall': 0.6572529, 'specificity': 0.6572529, 'f1': 0.7192086, 'auroc': 0.9475809, 'binary_precision': 0.7980769, 'binary_recall': 0.31800765, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.45479453}
confusion matrix:
      0   1
0  5976  21
1   178  83
oracle model performance metric: 

scalar performance:
{'acc': 0.9760307, 'precision': 0.8906965, 'recall': 0.78044003, 'specificity': 0.78044003, 'f1': 0.8256248, 'auroc': 0.9545392, 'binary_precision': 0.8, 'binary_recall': 0.5670498, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.6636771}
confusion matrix:
      0    1
0  5960   37
1   113  148
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 319865 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool | 291597 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |  28268 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 319865 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool | 291597 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |  28268 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 314122 KiB |   6778 MiB |   1105 TiB |   1105 TiB |
|       from large pool | 286862 KiB |   6752 MiB |   1089 TiB |   1089 TiB |
|       from small pool |  27260 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7460 MiB |   7460 MiB |   7460 MiB |      0 B   |
|       from large pool |   7404 MiB |   7404 MiB |   7404 MiB |      0 B   |
|       from small pool |     56 MiB |     56 MiB |     56 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 290438 KiB | 680184 KiB |    811 TiB |    811 TiB |
|       from large pool | 281843 KiB | 675647 KiB |    795 TiB |    795 TiB |
|       from small pool |   8595 KiB |  10808 KiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3230    |    7877    |  206198 K  |  206195 K  |
|       from large pool |     130    |     756    |  103674 K  |  103673 K  |
|       from small pool |    3100    |    7745    |  102524 K  |  102521 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3230    |    7877    |  206198 K  |  206195 K  |
|       from large pool |     130    |     756    |  103674 K  |  103673 K  |
|       from small pool |    3100    |    7745    |  102524 K  |  102521 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     337    |     337    |     337    |       0    |
|       from large pool |     309    |     309    |     309    |       0    |
|       from small pool |      28    |      28    |      28    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    3607    |  118599 K  |  118599 K  |
|       from large pool |      28    |     307    |   70940 K  |   70940 K  |
|       from small pool |      35    |    3580    |   47658 K  |   47658 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |      0 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |      0 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   1089 TiB |   1089 TiB |
|       from small pool |      0 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 610304 KiB |   7460 MiB |   7460 MiB |   6864 MiB |
|       from large pool | 573440 KiB |   7404 MiB |   7404 MiB |   6844 MiB |
|       from small pool |  36864 KiB |     56 MiB |     56 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |    811 TiB |    811 TiB |
|       from large pool |  24320 KiB | 675647 KiB |    795 TiB |    795 TiB |
|       from small pool |      0 KiB |  31464 KiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7877    |  206198 K  |  206198 K  |
|       from large pool |       2    |     756    |  103674 K  |  103674 K  |
|       from small pool |       0    |    7745    |  102524 K  |  102524 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7877    |  206198 K  |  206198 K  |
|       from large pool |       2    |     756    |  103674 K  |  103674 K  |
|       from small pool |       0    |    7745    |  102524 K  |  102524 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     337    |     337    |     294    |
|       from large pool |      25    |     309    |     309    |     284    |
|       from small pool |      18    |      28    |      28    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3607    |  118600 K  |  118600 K  |
|       from large pool |       3    |     307    |   70940 K  |   70940 K  |
|       from small pool |       0    |    3580    |   47660 K  |   47660 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |      0 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |      0 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   1089 TiB |   1089 TiB |
|       from small pool |      0 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 610304 KiB |   7460 MiB |   7460 MiB |   6864 MiB |
|       from large pool | 573440 KiB |   7404 MiB |   7404 MiB |   6844 MiB |
|       from small pool |  36864 KiB |     56 MiB |     56 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |    811 TiB |    811 TiB |
|       from large pool |  24320 KiB | 675647 KiB |    795 TiB |    795 TiB |
|       from small pool |      0 KiB |  31464 KiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7877    |  206198 K  |  206198 K  |
|       from large pool |       2    |     756    |  103674 K  |  103674 K  |
|       from small pool |       0    |    7745    |  102524 K  |  102524 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7877    |  206198 K  |  206198 K  |
|       from large pool |       2    |     756    |  103674 K  |  103674 K  |
|       from small pool |       0    |    7745    |  102524 K  |  102524 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     337    |     337    |     294    |
|       from large pool |      25    |     309    |     309    |     284    |
|       from small pool |      18    |      28    |      28    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3607    |  118600 K  |  118600 K  |
|       from large pool |       3    |     307    |   70940 K  |   70940 K  |
|       from small pool |       0    |    3580    |   47660 K  |   47660 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059

 Experiment start at: 2024-07-01 16:27:18.781653
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98706716, 'precision': 0.98538905, 'recall': 0.98035026, 'specificity': 0.98035026, 'f1': 0.98283607, 'auroc': 0.9980544, 'binary_precision': 0.98203593, 'binary_recall': 0.9667129, 'binary_specificity': 0.99398756, 'binary_f1_score': 0.97431415}
confusion matrix:
       0      1
0  42157    255
1    480  13940
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.7468924, 'recall': 0.7722167, 'specificity': 0.7722167, 'f1': 0.75885993, 'auroc': 0.9384216, 'binary_precision': 0.5100671, 'binary_recall': 0.56463593, 'binary_specificity': 0.9797974, 'binary_f1_score': 0.53596616}
confusion matrix:
       0    1
0  17702  365
1    293  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9777635, 'precision': 0.8914292, 'recall': 0.8100139, 'specificity': 0.8100139, 'f1': 0.8455181, 'auroc': 0.93782294, 'binary_precision': 0.79901963, 'binary_recall': 0.6269231, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.7025863}
confusion matrix:
      0    1
0  5905   41
1    97  163
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-01 16:49:22.877441,epoch time: 0:22:04.095788,used: 0:22:04.095788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9878238, 'precision': 0.99187243, 'recall': 0.97609544, 'specificity': 0.97609544, 'f1': 0.98366416, 'auroc': 0.9993639, 'binary_precision': 0.9997088, 'binary_recall': 0.9522852, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9754209}
confusion matrix:
       0      1
0  42409      4
1    688  13731
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.91107583, 'recall': 0.5132899, 'specificity': 0.5132899, 'f1': 0.5169929, 'auroc': 0.9323554, 'binary_precision': 0.85714287, 'binary_recall': 0.026745914, 'binary_specificity': 0.99983394, 'binary_f1_score': 0.0518732}
confusion matrix:
       0   1
0  18064   3
1    655  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.8793582, 'recall': 0.50760823, 'specificity': 0.50760823, 'f1': 0.50451565, 'auroc': 0.91519034, 'binary_precision': 0.8, 'binary_recall': 0.015384615, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.03018868}
confusion matrix:
      0  1
0  5945  1
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_2.png
early stop counter: 1
val acc:0.9648879170417786, best validation acc: 0.9648879170417786, corresponding to test acc:                         0.9777634739875793 / 0.9777634739875793
after epoch: 2,now: 2024-07-01 17:10:38.026017,epoch time: 0:21:15.148576,used: 0:43:19.244364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99468607, 'precision': 0.9936558, 'recall': 0.9922971, 'specificity': 0.9922971, 'f1': 0.99297404, 'auroc': 0.99952245, 'binary_precision': 0.9915732, 'binary_recall': 0.98744714, 'binary_specificity': 0.9971471, 'binary_f1_score': 0.9895059}
confusion matrix:
       0      1
0  42292    121
1    181  14238
---- Validation: 
scalar performance:
{'acc': 0.9604055, 'precision': 0.7268706, 'recall': 0.8306897, 'specificity': 0.8306897, 'f1': 0.76774925, 'auroc': 0.94298923, 'binary_precision': 0.46546546, 'binary_recall': 0.6909361, 'binary_specificity': 0.97044337, 'binary_f1_score': 0.5562201}
confusion matrix:
       0    1
0  17533  534
1    208  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.76200414, 'recall': 0.8239249, 'specificity': 0.8239249, 'f1': 0.7892104, 'auroc': 0.93543476, 'binary_precision': 0.53846157, 'binary_recall': 0.6730769, 'binary_specificity': 0.97477293, 'binary_f1_score': 0.59829056}
confusion matrix:
      0    1
0  5796  150
1    85  175
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_3.png
early stop counter: 2
val acc:0.9604055285453796, best validation acc: 0.9648879170417786, corresponding to test acc:                         0.9777634739875793 / 0.9777634739875793
after epoch: 3,now: 2024-07-01 17:31:47.050555,epoch time: 0:21:09.024538,used: 1:04:28.268902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99334884, 'precision': 0.9949595, 'recall': 0.9874882, 'specificity': 0.9874882, 'f1': 0.99115205, 'auroc': 0.9993112, 'binary_precision': 0.99815524, 'binary_recall': 0.97558945, 'binary_specificity': 0.99938697, 'binary_f1_score': 0.9867434}
confusion matrix:
       0      1
0  42386     26
1    352  14068
---- Validation: 
scalar performance:
{'acc': 0.9716115, 'precision': 0.86122143, 'recall': 0.65625405, 'specificity': 0.65625405, 'f1': 0.7150549, 'auroc': 0.9505693, 'binary_precision': 0.7473684, 'binary_recall': 0.3164933, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.4446764}
confusion matrix:
       0    1
0  17995   72
1    460  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.9416558, 'recall': 0.60534877, 'specificity': 0.60534877, 'f1': 0.66319156, 'auroc': 0.954916, 'binary_precision': 0.9166667, 'binary_recall': 0.21153846, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.34374997}
confusion matrix:
      0   1
0  5941   5
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_4.png
better model found
persisted
after epoch: 4,now: 2024-07-01 18:49:41.547406,epoch time: 1:17:54.496851,used: 2:22:22.765753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98940736, 'precision': 0.9832512, 'recall': 0.98903537, 'specificity': 0.98903537, 'f1': 0.9860982, 'auroc': 0.99918413, 'binary_precision': 0.97051215, 'binary_recall': 0.9882802, 'binary_specificity': 0.9897906, 'binary_f1_score': 0.9793156}
confusion matrix:
       0      1
0  41979    433
1    169  14251
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.7523521, 'recall': 0.8198395, 'specificity': 0.8198395, 'f1': 0.78160954, 'auroc': 0.9547263, 'binary_precision': 0.5174014, 'binary_recall': 0.6627043, 'binary_specificity': 0.9769746, 'binary_f1_score': 0.5811075}
confusion matrix:
       0    1
0  17651  416
1    227  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685788, 'precision': 0.80082005, 'recall': 0.8217716, 'specificity': 0.8217716, 'f1': 0.8108976, 'auroc': 0.93441355, 'binary_precision': 0.61648744, 'binary_recall': 0.6615385, 'binary_specificity': 0.9820047, 'binary_f1_score': 0.638219}
confusion matrix:
      0    1
0  5839  107
1    88  172
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_5.png
early stop counter: 1
val acc:0.9656883478164673, best validation acc: 0.971611499786377, corresponding to test acc:                         0.9661617875099182 / 0.9777634739875793
after epoch: 5,now: 2024-07-01 20:08:34.086643,epoch time: 1:18:52.539237,used: 3:41:15.304990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9951612, 'precision': 0.99630535, 'recall': 0.99092174, 'specificity': 0.99092174, 'f1': 0.9935763, 'auroc': 0.999576, 'binary_precision': 0.99858993, 'binary_recall': 0.982315, 'binary_specificity': 0.99952847, 'binary_f1_score': 0.9903856}
confusion matrix:
       0      1
0  42393     20
1    255  14164
---- Validation: 
scalar performance:
{'acc': 0.9707577, 'precision': 0.8186147, 'recall': 0.6879983, 'specificity': 0.6879983, 'f1': 0.73495704, 'auroc': 0.95590556, 'binary_precision': 0.65984654, 'binary_recall': 0.3833581, 'binary_specificity': 0.9926385, 'binary_f1_score': 0.4849624}
confusion matrix:
       0    1
0  17934  133
1    415  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.954399, 'precision': 0.68988895, 'recall': 0.5992102, 'specificity': 0.5992102, 'f1': 0.6281761, 'auroc': 0.9223998, 'binary_precision': 0.41353384, 'binary_recall': 0.21153846, 'binary_specificity': 0.9868819, 'binary_f1_score': 0.27989823}
confusion matrix:
      0   1
0  5868  78
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_6.png
early stop counter: 2
val acc:0.9707577228546143, best validation acc: 0.971611499786377, corresponding to test acc:                         0.9661617875099182 / 0.9777634739875793
after epoch: 6,now: 2024-07-01 21:29:19.058275,epoch time: 1:20:44.971632,used: 5:02:00.276622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99503803, 'precision': 0.99645996, 'recall': 0.9904494, 'specificity': 0.9904494, 'f1': 0.99340844, 'auroc': 0.99976027, 'binary_precision': 0.99929357, 'binary_recall': 0.9811347, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.99013096}
confusion matrix:
       0      1
0  42404     10
1    272  14146
---- Validation: 
scalar performance:
{'acc': 0.97155815, 'precision': 0.83946747, 'recall': 0.6776844, 'specificity': 0.6776844, 'f1': 0.7311599, 'auroc': 0.9592308, 'binary_precision': 0.7023121, 'binary_recall': 0.36106983, 'binary_specificity': 0.994299, 'binary_f1_score': 0.47693816}
confusion matrix:
       0    1
0  17964  103
1    430  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.8262807, 'recall': 0.6187152, 'specificity': 0.6187152, 'f1': 0.6696075, 'auroc': 0.94437194, 'binary_precision': 0.6847826, 'binary_recall': 0.2423077, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.35795456}
confusion matrix:
      0   1
0  5917  29
1   197  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_7.png
early stop counter: 3
val acc:0.971558153629303, best validation acc: 0.971611499786377, corresponding to test acc:                         0.9661617875099182 / 0.9777634739875793
after epoch: 7,now: 2024-07-01 21:51:17.480451,epoch time: 0:21:58.422176,used: 5:23:58.698798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99273294, 'precision': 0.98731047, 'recall': 0.993735, 'specificity': 0.993735, 'f1': 0.99046767, 'auroc': 0.99973917, 'binary_precision': 0.9760691, 'binary_recall': 0.9957692, 'binary_specificity': 0.9917008, 'binary_f1_score': 0.9858208}
confusion matrix:
       0      1
0  42062    352
1     61  14357
---- Validation: 
scalar performance:
{'acc': 0.8607257, 'precision': 0.5962567, 'recall': 0.8920055, 'specificity': 0.8920055, 'f1': 0.6227548, 'auroc': 0.95062065, 'binary_precision': 0.1957273, 'binary_recall': 0.9257058, 'binary_specificity': 0.8583052, 'binary_f1_score': 0.32313278}
confusion matrix:
       0     1
0  15507  2560
1     50   623
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.806961, 'precision': 0.5818629, 'recall': 0.8588023, 'specificity': 0.8588023, 'f1': 0.5863912, 'auroc': 0.9251138, 'binary_precision': 0.16831683, 'binary_recall': 0.9153846, 'binary_specificity': 0.80222, 'binary_f1_score': 0.28434885}
confusion matrix:
      0     1
0  4770  1176
1    22   238
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_8.png
early stop counter: 4
val acc:0.8607257008552551, best validation acc: 0.971611499786377, corresponding to test acc:                         0.9661617875099182 / 0.9777634739875793
after epoch: 8,now: 2024-07-01 22:12:37.024224,epoch time: 0:21:19.543773,used: 5:45:18.242571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9936655, 'precision': 0.99097776, 'recall': 0.99232316, 'specificity': 0.99232316, 'f1': 0.9916481, 'auroc': 0.99968445, 'binary_precision': 0.98549724, 'binary_recall': 0.9895978, 'binary_specificity': 0.9950486, 'binary_f1_score': 0.9875433}
confusion matrix:
       0      1
0  42202    210
1    150  14270
---- Validation: 
scalar performance:
{'acc': 0.9716115, 'precision': 0.8133719, 'recall': 0.72635025, 'specificity': 0.72635025, 'f1': 0.76217484, 'auroc': 0.9520241, 'binary_precision': 0.64656967, 'binary_recall': 0.46210995, 'binary_specificity': 0.9905906, 'binary_f1_score': 0.5389948}
confusion matrix:
       0    1
0  17897  170
1    362  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.73998725, 'recall': 0.6105915, 'specificity': 0.6105915, 'f1': 0.648474, 'auroc': 0.91664696, 'binary_precision': 0.51282054, 'binary_recall': 0.23076923, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.3183024}
confusion matrix:
      0   1
0  5889  57
1   200  60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_9.png
early stop counter: 5
val acc:0.971611499786377, best validation acc: 0.971611499786377, corresponding to test acc:                         0.9661617875099182 / 0.9777634739875793
after epoch: 9,now: 2024-07-01 22:33:57.432254,epoch time: 0:21:20.408030,used: 6:06:38.650601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99480927, 'precision': 0.99179757, 'recall': 0.9945541, 'specificity': 0.9945541, 'f1': 0.9931659, 'auroc': 0.9997684, 'binary_precision': 0.98562884, 'binary_recall': 0.9940361, 'binary_specificity': 0.9950721, 'binary_f1_score': 0.98981464}
confusion matrix:
       0      1
0  42203    209
1     86  14334
---- Validation: 
scalar performance:
{'acc': 0.91350055, 'precision': 0.63326305, 'recall': 0.8807514, 'specificity': 0.8807514, 'f1': 0.68289095, 'auroc': 0.93155885, 'binary_precision': 0.27277085, 'binary_recall': 0.84546804, 'binary_specificity': 0.91603476, 'binary_f1_score': 0.41246828}
confusion matrix:
       0     1
0  16550  1517
1    104   569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9311956, 'precision': 0.67069936, 'recall': 0.8519153, 'specificity': 0.8519153, 'f1': 0.7227863, 'auroc': 0.9137869, 'binary_precision': 0.3522124, 'binary_recall': 0.7653846, 'binary_specificity': 0.938446, 'binary_f1_score': 0.48242426}
confusion matrix:
      0    1
0  5580  366
1    61  199
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_10.png
early stop counter: 6
val acc:0.9135005474090576, best validation acc: 0.971611499786377, corresponding to test acc:                         0.9661617875099182 / 0.9777634739875793
after epoch: 10,now: 2024-07-01 22:55:52.510192,epoch time: 0:21:55.077938,used: 6:28:33.728539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99678, 'precision': 0.99671435, 'recall': 0.994776, 'specificity': 0.994776, 'f1': 0.9957403, 'auroc': 0.99983525, 'binary_precision': 0.9965818, 'binary_recall': 0.99070734, 'binary_specificity': 0.9988447, 'binary_f1_score': 0.99363583}
confusion matrix:
       0      1
0  42363     49
1    134  14286
---- Validation: 
scalar performance:
{'acc': 0.9707044, 'precision': 0.7919656, 'recall': 0.7680806, 'specificity': 0.7680806, 'f1': 0.7794595, 'auroc': 0.9600574, 'binary_precision': 0.60064936, 'binary_recall': 0.5497771, 'binary_specificity': 0.98638403, 'binary_f1_score': 0.57408845}
confusion matrix:
       0    1
0  17821  246
1    303  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.7979319, 'recall': 0.60491735, 'specificity': 0.60491735, 'f1': 0.650635, 'auroc': 0.94824415, 'binary_precision': 0.6292135, 'binary_recall': 0.21538462, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.32091692}
confusion matrix:
      0   1
0  5913  33
1   204  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_11.png
early stop counter: 7
val acc:0.9707043766975403, best validation acc: 0.971611499786377, corresponding to test acc:                         0.9661617875099182 / 0.9777634739875793
after epoch: 11,now: 2024-07-01 23:17:14.563366,epoch time: 0:21:22.053174,used: 6:49:55.781713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9967624, 'precision': 0.99779326, 'recall': 0.99366534, 'specificity': 0.99366534, 'f1': 0.9957075, 'auroc': 0.9998721, 'binary_precision': 0.9998595, 'binary_recall': 0.98737776, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9935795}
confusion matrix:
       0      1
0  42411      2
1    182  14237
---- Validation: 
scalar performance:
{'acc': 0.9749733, 'precision': 0.86862105, 'recall': 0.7202258, 'specificity': 0.7202258, 'f1': 0.77419573, 'auroc': 0.9575849, 'binary_precision': 0.75757575, 'binary_recall': 0.44576523, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.5612722}
confusion matrix:
       0    1
0  17971   96
1    373  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.74369776, 'recall': 0.58676875, 'specificity': 0.58676875, 'f1': 0.62367386, 'auroc': 0.94133794, 'binary_precision': 0.5222222, 'binary_recall': 0.18076923, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.2685714}
confusion matrix:
      0   1
0  5903  43
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_12.png
better model found
persisted
after epoch: 12,now: 2024-07-01 23:38:56.709409,epoch time: 0:21:42.146043,used: 7:11:37.927756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99630487, 'precision': 0.9970672, 'recall': 0.9931761, 'specificity': 0.9931761, 'f1': 0.9951022, 'auroc': 0.9997777, 'binary_precision': 0.9985965, 'binary_recall': 0.98682386, 'binary_specificity': 0.9995284, 'binary_f1_score': 0.99267524}
confusion matrix:
       0      1
0  42392     20
1    190  14230
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.756199, 'recall': 0.79227614, 'specificity': 0.79227614, 'f1': 0.7729056, 'auroc': 0.94559276, 'binary_precision': 0.52720207, 'binary_recall': 0.6047548, 'binary_specificity': 0.9797974, 'binary_f1_score': 0.5633218}
confusion matrix:
       0    1
0  17702  365
1    266  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9479536, 'precision': 0.65124667, 'recall': 0.6123975, 'specificity': 0.6123975, 'f1': 0.6284047, 'auroc': 0.90122056, 'binary_precision': 0.33507854, 'binary_recall': 0.24615385, 'binary_specificity': 0.9786411, 'binary_f1_score': 0.28381374}
confusion matrix:
      0    1
0  5819  127
1   196   64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_13.png
early stop counter: 1
val acc:0.9663286805152893, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 13,now: 2024-07-02 00:00:16.486109,epoch time: 0:21:19.776700,used: 7:32:57.704456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9959882, 'precision': 0.99641323, 'recall': 0.9929868, 'specificity': 0.9929868, 'f1': 0.9946849, 'auroc': 0.99969596, 'binary_precision': 0.997267, 'binary_recall': 0.9868932, 'binary_specificity': 0.9990804, 'binary_f1_score': 0.992053}
confusion matrix:
       0      1
0  42373     39
1    189  14231
---- Validation: 
scalar performance:
{'acc': 0.973159, 'precision': 0.91738474, 'recall': 0.64990395, 'specificity': 0.64990395, 'f1': 0.71644527, 'auroc': 0.9618124, 'binary_precision': 0.8601695, 'binary_recall': 0.30163446, 'binary_specificity': 0.9981735, 'binary_f1_score': 0.44664463}
confusion matrix:
       0    1
0  18034   33
1    470  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7488045, 'recall': 0.512957, 'specificity': 0.512957, 'f1': 0.514973, 'auroc': 0.94098604, 'binary_precision': 0.53846157, 'binary_recall': 0.026923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.051282056}
confusion matrix:
      0  1
0  5940  6
1   253  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_14.png
early stop counter: 2
val acc:0.9731590151786804, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 14,now: 2024-07-02 00:21:38.908507,epoch time: 0:21:22.422398,used: 7:54:20.126854,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99553066, 'precision': 0.9969524, 'recall': 0.99126023, 'specificity': 0.99126023, 'f1': 0.9940648, 'auroc': 0.99973917, 'binary_precision': 0.9997883, 'binary_recall': 0.9825912, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9911152}
confusion matrix:
       0      1
0  42411      3
1    251  14167
---- Validation: 
scalar performance:
{'acc': 0.97369266, 'precision': 0.8863372, 'recall': 0.67807615, 'specificity': 0.67807615, 'f1': 0.7409442, 'auroc': 0.958365, 'binary_precision': 0.79605263, 'binary_recall': 0.35958394, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.49539408}
confusion matrix:
       0    1
0  18005   62
1    431  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7897576, 'recall': 0.5542556, 'specificity': 0.5542556, 'f1': 0.5841775, 'auroc': 0.942913, 'binary_precision': 0.61702126, 'binary_recall': 0.11153846, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.18892507}
confusion matrix:
      0   1
0  5928  18
1   231  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_15.png
early stop counter: 3
val acc:0.9736926555633545, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 15,now: 2024-07-02 00:42:50.065176,epoch time: 0:21:11.156669,used: 8:15:31.283523,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99480927, 'precision': 0.9965464, 'recall': 0.9897697, 'specificity': 0.9897697, 'f1': 0.9930992, 'auroc': 0.9997783, 'binary_precision': 1.0, 'binary_recall': 0.97953945, 'binary_specificity': 1.0, 'binary_f1_score': 0.989664}
confusion matrix:
       0      1
0  42414      0
1    295  14123
---- Validation: 
scalar performance:
{'acc': 0.9708111, 'precision': 0.90364635, 'recall': 0.615784, 'specificity': 0.615784, 'f1': 0.6748773, 'auroc': 0.963401, 'binary_precision': 0.8351064, 'binary_recall': 0.2332838, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.3646922}
confusion matrix:
       0    1
0  18036   31
1    516  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.67430633, 'recall': 0.5340158, 'specificity': 0.5340158, 'f1': 0.5502931, 'auroc': 0.9346018, 'binary_precision': 0.3877551, 'binary_recall': 0.073076926, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.12297735}
confusion matrix:
      0   1
0  5916  30
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_16.png
early stop counter: 4
val acc:0.970811128616333, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 16,now: 2024-07-02 01:04:06.229242,epoch time: 0:21:16.164066,used: 8:36:47.447589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99692076, 'precision': 0.9977348, 'recall': 0.99413764, 'specificity': 0.99413764, 'f1': 0.9959196, 'auroc': 0.9998847, 'binary_precision': 0.99936897, 'binary_recall': 0.9884874, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.9938984}
confusion matrix:
       0      1
0  42404      9
1    166  14253
---- Validation: 
scalar performance:
{'acc': 0.97033083, 'precision': 0.78650427, 'recall': 0.7807616, 'specificity': 0.7807616, 'f1': 0.7836007, 'auroc': 0.95539224, 'binary_precision': 0.58877087, 'binary_recall': 0.576523, 'binary_specificity': 0.98500025, 'binary_f1_score': 0.58258253}
confusion matrix:
       0    1
0  17796  271
1    285  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9434418, 'precision': 0.6276612, 'recall': 0.60636497, 'specificity': 0.60636497, 'f1': 0.61582416, 'auroc': 0.9016567, 'binary_precision': 0.2883721, 'binary_recall': 0.23846154, 'binary_specificity': 0.97426844, 'binary_f1_score': 0.26105264}
confusion matrix:
      0    1
0  5793  153
1   198   62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_17.png
early stop counter: 5
val acc:0.9703308343887329, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 17,now: 2024-07-02 01:25:19.889089,epoch time: 0:21:13.659847,used: 8:58:01.107436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.994299, 'precision': 0.989989, 'recall': 0.99510473, 'specificity': 0.99510473, 'f1': 0.9925122, 'auroc': 0.999887, 'binary_precision': 0.98109215, 'binary_recall': 0.99674064, 'binary_specificity': 0.9934688, 'binary_f1_score': 0.98885447}
confusion matrix:
       0      1
0  42135    277
1     47  14373
---- Validation: 
scalar performance:
{'acc': 0.96931696, 'precision': 0.7761785, 'recall': 0.80097854, 'specificity': 0.80097854, 'f1': 0.78798425, 'auroc': 0.95812446, 'binary_precision': 0.56657606, 'binary_recall': 0.61961365, 'binary_specificity': 0.9823435, 'binary_f1_score': 0.59190917}
confusion matrix:
       0    1
0  17748  319
1    256  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9518208, 'precision': 0.66764116, 'recall': 0.59786475, 'specificity': 0.59786475, 'f1': 0.6220191, 'auroc': 0.9106749, 'binary_precision': 0.3691275, 'binary_recall': 0.21153846, 'binary_specificity': 0.98419106, 'binary_f1_score': 0.26894867}
confusion matrix:
      0   1
0  5852  94
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_18.png
early stop counter: 6
val acc:0.9693169593811035, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 18,now: 2024-07-02 01:46:33.971377,epoch time: 0:21:14.082288,used: 9:19:15.189724,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9961993, 'precision': 0.9950264, 'recall': 0.99493575, 'specificity': 0.99493575, 'f1': 0.99498105, 'auroc': 0.9998535, 'binary_precision': 0.99264604, 'binary_recall': 0.99237067, 'binary_specificity': 0.99750084, 'binary_f1_score': 0.9925083}
confusion matrix:
       0      1
0  42308    106
1    110  14308
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.7473298, 'recall': 0.8072371, 'specificity': 0.8072371, 'f1': 0.77363276, 'auroc': 0.95888835, 'binary_precision': 0.50829387, 'binary_recall': 0.63744426, 'binary_specificity': 0.9770299, 'binary_f1_score': 0.56558996}
confusion matrix:
       0    1
0  17652  415
1    244  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.73449755, 'recall': 0.76790345, 'specificity': 0.76790345, 'f1': 0.74991775, 'auroc': 0.9424429, 'binary_precision': 0.4882943, 'binary_recall': 0.56153846, 'binary_specificity': 0.97426844, 'binary_f1_score': 0.52236134}
confusion matrix:
      0    1
0  5793  153
1   114  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_19.png
early stop counter: 7
val acc:0.9648345708847046, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 19,now: 2024-07-02 02:07:43.151204,epoch time: 0:21:09.179827,used: 9:40:24.369551,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9959002, 'precision': 0.99726814, 'recall': 0.99192095, 'specificity': 0.99192095, 'f1': 0.99455786, 'auroc': 0.99982, 'binary_precision': 1.0, 'binary_recall': 0.9838419, 'binary_specificity': 1.0, 'binary_f1_score': 0.99185514}
confusion matrix:
       0      1
0  42412      0
1    233  14187
---- Validation: 
scalar performance:
{'acc': 0.971238, 'precision': 0.93076485, 'recall': 0.6131443, 'specificity': 0.6131443, 'f1': 0.6737087, 'auroc': 0.96174645, 'binary_precision': 0.8895349, 'binary_recall': 0.22734027, 'binary_specificity': 0.99894834, 'binary_f1_score': 0.36213017}
confusion matrix:
       0    1
0  18048   19
1    520  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7869375, 'recall': 0.5355294, 'specificity': 0.5355294, 'f1': 0.55485564, 'auroc': 0.93556124, 'binary_precision': 0.61290324, 'binary_recall': 0.073076926, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.1305842}
confusion matrix:
      0   1
0  5934  12
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_20.png
early stop counter: 8
val acc:0.9712380170822144, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 20,now: 2024-07-02 02:28:55.386229,epoch time: 0:21:12.235025,used: 10:01:36.604576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9968504, 'precision': 0.9977112, 'recall': 0.9939764, 'specificity': 0.9939764, 'f1': 0.995826, 'auroc': 0.999816, 'binary_precision': 0.9994389, 'binary_recall': 0.9881415, 'binary_specificity': 0.99981135, 'binary_f1_score': 0.99375814}
confusion matrix:
       0      1
0  42404      8
1    171  14249
---- Validation: 
scalar performance:
{'acc': 0.9686766, 'precision': 0.79302, 'recall': 0.67332894, 'specificity': 0.67332894, 'f1': 0.7163533, 'auroc': 0.9427726, 'binary_precision': 0.6096939, 'binary_recall': 0.3551263, 'binary_specificity': 0.99153155, 'binary_f1_score': 0.4488263}
confusion matrix:
       0    1
0  17914  153
1    434  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9505317, 'precision': 0.65923274, 'recall': 0.59903103, 'specificity': 0.59903103, 'f1': 0.6208524, 'auroc': 0.93084407, 'binary_precision': 0.35220125, 'binary_recall': 0.21538462, 'binary_specificity': 0.98267746, 'binary_f1_score': 0.2673031}
confusion matrix:
      0    1
0  5843  103
1   204   56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_21.png
early stop counter: 9
val acc:0.9686766266822815, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 21,now: 2024-07-02 02:50:06.450424,epoch time: 0:21:11.064195,used: 10:22:47.668771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9983284, 'precision': 0.9985819, 'recall': 0.99700344, 'specificity': 0.99700344, 'f1': 0.9977895, 'auroc': 0.9999157, 'binary_precision': 0.9990941, 'binary_recall': 0.9943135, 'binary_specificity': 0.99969345, 'binary_f1_score': 0.996698}
confusion matrix:
       0      1
0  42399     13
1     82  14338
---- Validation: 
scalar performance:
{'acc': 0.9747599, 'precision': 0.89995015, 'recall': 0.6879281, 'specificity': 0.6879281, 'f1': 0.7529299, 'auroc': 0.9471004, 'binary_precision': 0.82258064, 'binary_recall': 0.37890044, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.5188199}
confusion matrix:
       0    1
0  18012   55
1    418  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.84915626, 'recall': 0.5681376, 'specificity': 0.5681376, 'f1': 0.60671395, 'auroc': 0.9582218, 'binary_precision': 0.7346939, 'binary_recall': 0.13846155, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.23300973}
confusion matrix:
      0   1
0  5933  13
1   224  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_22.png
early stop counter: 10
val acc:0.9747598767280579, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 22,now: 2024-07-02 03:11:21.758588,epoch time: 0:21:15.308164,used: 10:44:02.976935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99778295, 'precision': 0.99768734, 'recall': 0.99645495, 'specificity': 0.99645495, 'f1': 0.9970692, 'auroc': 0.9998814, 'binary_precision': 0.9974941, 'binary_recall': 0.9937587, 'binary_specificity': 0.9991512, 'binary_f1_score': 0.9956229}
confusion matrix:
       0      1
0  42376     36
1     90  14330
---- Validation: 
scalar performance:
{'acc': 0.96824974, 'precision': 0.7661052, 'recall': 0.86766016, 'specificity': 0.86766016, 'f1': 0.80772185, 'auroc': 0.9511782, 'binary_precision': 0.5413136, 'binary_recall': 0.75928676, 'binary_specificity': 0.9760336, 'binary_f1_score': 0.63203466}
confusion matrix:
       0    1
0  17634  433
1    162  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.7673811, 'recall': 0.86873335, 'specificity': 0.86873335, 'f1': 0.8087708, 'auroc': 0.95531714, 'binary_precision': 0.5452055, 'binary_recall': 0.7653846, 'binary_specificity': 0.9720821, 'binary_f1_score': 0.63680005}
confusion matrix:
      0    1
0  5780  166
1    61  199
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_23.png
early stop counter: 11
val acc:0.9682497382164001, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 23,now: 2024-07-02 03:32:27.093939,epoch time: 0:21:05.335351,used: 11:05:08.312286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9970967, 'precision': 0.9980155, 'recall': 0.99432456, 'specificity': 0.99432456, 'f1': 0.99615264, 'auroc': 0.9998902, 'binary_precision': 0.99985975, 'binary_recall': 0.9886963, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9942467}
confusion matrix:
       0      1
0  42410      2
1    163  14257
---- Validation: 
scalar performance:
{'acc': 0.9704376, 'precision': 0.94639534, 'recall': 0.596278, 'specificity': 0.596278, 'f1': 0.65215045, 'auroc': 0.96737456, 'binary_precision': 0.9219858, 'binary_recall': 0.19316493, 'binary_specificity': 0.99939114, 'binary_f1_score': 0.31941032}
confusion matrix:
       0    1
0  18056   11
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6793415, 'recall': 0.5071878, 'specificity': 0.5071878, 'f1': 0.5040258, 'auroc': 0.95495373, 'binary_precision': 0.4, 'binary_recall': 0.015384615, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.02962963}
confusion matrix:
      0  1
0  5940  6
1   256  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_24.png
early stop counter: 12
val acc:0.9704375863075256, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 24,now: 2024-07-02 03:53:42.315508,epoch time: 0:21:15.221569,used: 11:26:23.533855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99723744, 'precision': 0.9980625, 'recall': 0.9946474, 'specificity': 0.9946474, 'f1': 0.99634, 'auroc': 0.99989426, 'binary_precision': 0.9997197, 'binary_recall': 0.989389, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9945275}
confusion matrix:
       0      1
0  42409      4
1    153  14266
---- Validation: 
scalar performance:
{'acc': 0.9687834, 'precision': 0.93827325, 'recall': 0.5725316, 'specificity': 0.5725316, 'f1': 0.6175099, 'auroc': 0.9650452, 'binary_precision': 0.9074074, 'binary_recall': 0.14561664, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.2509603}
confusion matrix:
       0   1
0  18057  10
1    575  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.8796643, 'recall': 0.51521647, 'specificity': 0.51521647, 'f1': 0.5191701, 'auroc': 0.95633554, 'binary_precision': 0.8, 'binary_recall': 0.03076923, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.05925926}
confusion matrix:
      0  1
0  5944  2
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_25.png
early stop counter: 13
val acc:0.9687833786010742, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 25,now: 2024-07-02 04:14:53.391840,epoch time: 0:21:11.076332,used: 11:47:34.610187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9978885, 'precision': 0.9985428, 'recall': 0.9958846, 'specificity': 0.9958846, 'f1': 0.9972046, 'auroc': 0.9999374, 'binary_precision': 0.99986017, 'binary_recall': 0.99181634, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.99582195}
confusion matrix:
       0      1
0  42411      2
1    118  14301
---- Validation: 
scalar performance:
{'acc': 0.97017074, 'precision': 0.9159303, 'recall': 0.60043126, 'specificity': 0.60043126, 'f1': 0.65603185, 'auroc': 0.9580233, 'binary_precision': 0.8607595, 'binary_recall': 0.20208023, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.32731646}
confusion matrix:
       0    1
0  18045   22
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.6043215, 'recall': 0.50668323, 'specificity': 0.50668323, 'f1': 0.5034512, 'auroc': 0.93271834, 'binary_precision': 0.25, 'binary_recall': 0.015384615, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.028985508}
confusion matrix:
      0   1
0  5934  12
1   256   4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_26.png
early stop counter: 14
val acc:0.9701707363128662, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 26,now: 2024-07-02 04:36:06.241917,epoch time: 0:21:12.850077,used: 12:08:47.460264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99817, 'precision': 0.99781096, 'recall': 0.9973549, 'specificity': 0.9973549, 'f1': 0.9975827, 'auroc': 0.99985987, 'binary_precision': 0.9970831, 'binary_recall': 0.9957001, 'binary_specificity': 0.9990097, 'binary_f1_score': 0.9963911}
confusion matrix:
       0      1
0  42371     42
1     62  14357
---- Validation: 
scalar performance:
{'acc': 0.9704376, 'precision': 0.7816746, 'recall': 0.82730937, 'specificity': 0.82730937, 'f1': 0.8025838, 'auroc': 0.96141267, 'binary_precision': 0.57560354, 'binary_recall': 0.6731055, 'binary_specificity': 0.98151326, 'binary_f1_score': 0.62054795}
confusion matrix:
       0    1
0  17733  334
1    220  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9473091, 'precision': 0.6514957, 'recall': 0.6194171, 'specificity': 0.6194171, 'f1': 0.6331851, 'auroc': 0.92895484, 'binary_precision': 0.33497536, 'binary_recall': 0.26153848, 'binary_specificity': 0.97729564, 'binary_f1_score': 0.2937365}
confusion matrix:
      0    1
0  5811  135
1   192   68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_27.png
early stop counter: 15
val acc:0.9704375863075256, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 27,now: 2024-07-02 04:57:12.304323,epoch time: 0:21:06.062406,used: 12:29:53.522670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9980293, 'precision': 0.99859023, 'recall': 0.99620754, 'specificity': 0.99620754, 'f1': 0.9973916, 'auroc': 0.9998912, 'binary_precision': 0.9997206, 'binary_recall': 0.99250937, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9961019}
confusion matrix:
       0      1
0  42410      4
1    108  14310
---- Validation: 
scalar performance:
{'acc': 0.9725187, 'precision': 0.9148866, 'recall': 0.6402734, 'specificity': 0.6402734, 'f1': 0.70525205, 'auroc': 0.96508205, 'binary_precision': 0.8558559, 'binary_recall': 0.28231797, 'binary_specificity': 0.9982288, 'binary_f1_score': 0.424581}
confusion matrix:
       0    1
0  18035   32
1    483  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.8050356, 'recall': 0.5244114, 'specificity': 0.5244114, 'f1': 0.53596044, 'auroc': 0.9549942, 'binary_precision': 0.65, 'binary_recall': 0.05, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.09285714}
confusion matrix:
      0   1
0  5939   7
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_28.png
early stop counter: 16
val acc:0.9725186824798584, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 28,now: 2024-07-02 05:18:19.608574,epoch time: 0:21:07.304251,used: 12:51:00.826921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99855715, 'precision': 0.99864316, 'recall': 0.9975456, 'specificity': 0.9975456, 'f1': 0.9980928, 'auroc': 0.9999337, 'binary_precision': 0.9988171, 'binary_recall': 0.99549204, 'binary_specificity': 0.99959916, 'binary_f1_score': 0.99715173}
confusion matrix:
       0      1
0  42396     17
1     65  14354
---- Validation: 
scalar performance:
{'acc': 0.9685699, 'precision': 0.8574172, 'recall': 0.59387887, 'specificity': 0.59387887, 'f1': 0.6434405, 'auroc': 0.9600325, 'binary_precision': 0.74418604, 'binary_recall': 0.19019316, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.30295858}
confusion matrix:
       0    1
0  18023   44
1    545  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.6044565, 'recall': 0.51002485, 'specificity': 0.51002485, 'f1': 0.5099131, 'auroc': 0.94049, 'binary_precision': 0.25, 'binary_recall': 0.023076924, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.042253524}
confusion matrix:
      0   1
0  5928  18
1   254   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_29.png
early stop counter: 17
val acc:0.9685698747634888, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 29,now: 2024-07-02 05:39:36.909129,epoch time: 0:21:17.300555,used: 13:12:18.127476,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9983812, 'precision': 0.9984791, 'recall': 0.9972446, 'specificity': 0.9972446, 'f1': 0.99785995, 'auroc': 0.9999664, 'binary_precision': 0.9986773, 'binary_recall': 0.99493724, 'binary_specificity': 0.999552, 'binary_f1_score': 0.99680376}
confusion matrix:
       0      1
0  42394     19
1     73  14346
---- Validation: 
scalar performance:
{'acc': 0.9738527, 'precision': 0.8745357, 'recall': 0.69103396, 'specificity': 0.69103396, 'f1': 0.75070786, 'auroc': 0.95809364, 'binary_precision': 0.77151334, 'binary_recall': 0.38632986, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.51485145}
confusion matrix:
       0    1
0  17990   77
1    413  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.79762185, 'recall': 0.5861911, 'specificity': 0.5861911, 'f1': 0.62816215, 'auroc': 0.9516027, 'binary_precision': 0.63013697, 'binary_recall': 0.17692308, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.27627626}
confusion matrix:
      0   1
0  5919  27
1   214  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_30.png
early stop counter: 18
val acc:0.9738526940345764, best validation acc: 0.9749733209609985, corresponding to test acc:                         0.9587495923042297 / 0.9777634739875793
after epoch: 30,now: 2024-07-02 06:00:56.562998,epoch time: 0:21:19.653869,used: 13:33:37.781345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_27_18_seed_1_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:33:37.781345 at 2024-07-02 06:00:56.562998
persisted model performance metric: 

scalar performance:
{'acc': 0.9587496, 'precision': 0.74369776, 'recall': 0.58676875, 'specificity': 0.58676875, 'f1': 0.62367386, 'auroc': 0.94133794, 'binary_precision': 0.5222222, 'binary_recall': 0.18076923, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.2685714}
confusion matrix:
      0   1
0  5903  43
1   213  47
oracle model performance metric: 

scalar performance:
{'acc': 0.9777635, 'precision': 0.8914292, 'recall': 0.8100139, 'specificity': 0.8100139, 'f1': 0.8455181, 'auroc': 0.93782294, 'binary_precision': 0.79901963, 'binary_recall': 0.6269231, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.7025863}
confusion matrix:
      0    1
0  5905   41
1    97  163
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 319595 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool | 291339 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |  28256 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 319595 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool | 291339 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |  28256 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 314119 KiB |   6778 MiB |   2201 TiB |   2201 TiB |
|       from large pool | 286862 KiB |   6752 MiB |   2170 TiB |   2170 TiB |
|       from small pool |  27257 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7456 MiB |   7460 MiB |  14320 MiB |   6864 MiB |
|       from large pool |   7404 MiB |   7404 MiB |  14248 MiB |   6844 MiB |
|       from small pool |     52 MiB |     56 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 284564 KiB | 680184 KiB |   1606 TiB |   1606 TiB |
|       from large pool | 275957 KiB | 675647 KiB |   1574 TiB |   1574 TiB |
|       from small pool |   8607 KiB |  31464 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3206    |    7877    |  410950 K  |  410947 K  |
|       from large pool |     130    |     756    |  206556 K  |  206555 K  |
|       from small pool |    3076    |    7745    |  204394 K  |  204391 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3206    |    7877    |  410950 K  |  410947 K  |
|       from large pool |     130    |     756    |  206556 K  |  206555 K  |
|       from small pool |    3076    |    7745    |  204394 K  |  204391 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     337    |     629    |     294    |
|       from large pool |     309    |     309    |     593    |     284    |
|       from small pool |      26    |      28    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      61    |    3607    |  252426 K  |  252426 K  |
|       from large pool |      27    |     307    |  157606 K  |  157606 K  |
|       from small pool |      34    |    3580    |   94819 K  |   94819 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |      0 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |      0 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   2201 TiB |   2201 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   2170 TiB |   2170 TiB |
|       from small pool |      0 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7460 MiB |  14320 MiB |  13730 MiB |
|       from large pool | 567296 KiB |   7404 MiB |  14248 MiB |  13694 MiB |
|       from small pool |  36864 KiB |     56 MiB |     72 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |   1606 TiB |   1606 TiB |
|       from large pool |  24320 KiB | 675647 KiB |   1574 TiB |   1574 TiB |
|       from small pool |      0 KiB |  31464 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7877    |  410950 K  |  410950 K  |
|       from large pool |       2    |     756    |  206556 K  |  206556 K  |
|       from small pool |       0    |    7745    |  204394 K  |  204394 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7877    |  410950 K  |  410950 K  |
|       from large pool |       2    |     756    |  206556 K  |  206556 K  |
|       from small pool |       0    |    7745    |  204394 K  |  204394 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     337    |     629    |     586    |
|       from large pool |      25    |     309    |     593    |     568    |
|       from small pool |      18    |      28    |      36    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3607    |  252427 K  |  252427 K  |
|       from large pool |       3    |     307    |  157606 K  |  157606 K  |
|       from small pool |       0    |    3580    |   94820 K  |   94820 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |      0 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |      0 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   2201 TiB |   2201 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   2170 TiB |   2170 TiB |
|       from small pool |      0 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7460 MiB |  14320 MiB |  13730 MiB |
|       from large pool | 567296 KiB |   7404 MiB |  14248 MiB |  13694 MiB |
|       from small pool |  36864 KiB |     56 MiB |     72 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |   1606 TiB |   1606 TiB |
|       from large pool |  24320 KiB | 675647 KiB |   1574 TiB |   1574 TiB |
|       from small pool |      0 KiB |  31464 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7877    |  410950 K  |  410950 K  |
|       from large pool |       2    |     756    |  206556 K  |  206556 K  |
|       from small pool |       0    |    7745    |  204394 K  |  204394 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7877    |  410950 K  |  410950 K  |
|       from large pool |       2    |     756    |  206556 K  |  206556 K  |
|       from small pool |       0    |    7745    |  204394 K  |  204394 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     337    |     629    |     586    |
|       from large pool |      25    |     309    |     593    |     568    |
|       from small pool |      18    |      28    |      36    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3607    |  252427 K  |  252427 K  |
|       from large pool |       3    |     307    |  157606 K  |  157606 K  |
|       from small pool |       0    |    3580    |   94820 K  |   94820 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059

 Experiment start at: 2024-07-02 06:08:15.627309
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9870648, 'precision': 0.9794912, 'recall': 0.987653, 'specificity': 0.987653, 'f1': 0.98347455, 'auroc': 0.99894094, 'binary_precision': 0.9629916, 'binary_recall': 0.98889625, 'binary_specificity': 0.98640984, 'binary_f1_score': 0.975772}
confusion matrix:
       0      1
0  41735    575
1    168  14962
---- Validation: 
scalar performance:
{'acc': 0.8701859, 'precision': 0.59094775, 'recall': 0.88475966, 'specificity': 0.88475966, 'f1': 0.6181216, 'auroc': 0.94147253, 'binary_precision': 0.18568003, 'binary_recall': 0.9003322, 'binary_specificity': 0.8691872, 'binary_f1_score': 0.30786708}
confusion matrix:
       0     1
0  15794  2377
1     60   542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77592564, 'precision': 0.5628544, 'recall': 0.8180113, 'specificity': 0.8180113, 'f1': 0.5495282, 'auroc': 0.9102341, 'binary_precision': 0.13278271, 'binary_recall': 0.8636364, 'binary_specificity': 0.7723862, 'binary_f1_score': 0.23017621}
confusion matrix:
      0     1
0  4632  1365
1    33   209
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-02 06:30:27.611299,epoch time: 0:22:11.983990,used: 0:22:11.983990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9928969, 'precision': 0.9949331, 'recall': 0.9867928, 'specificity': 0.9867928, 'f1': 0.99077225, 'auroc': 0.999388, 'binary_precision': 0.9991185, 'binary_recall': 0.9738929, 'binary_specificity': 0.99969274, 'binary_f1_score': 0.9863444}
confusion matrix:
       0      1
0  42297     13
1    395  14735
---- Validation: 
scalar performance:
{'acc': 0.96548235, 'precision': 0.7281345, 'recall': 0.78622556, 'specificity': 0.78622556, 'f1': 0.75350857, 'auroc': 0.94153136, 'binary_precision': 0.46981627, 'binary_recall': 0.59468436, 'binary_specificity': 0.97776675, 'binary_f1_score': 0.5249267}
confusion matrix:
       0    1
0  17767  404
1    244  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95768553, 'precision': 0.7213139, 'recall': 0.75790477, 'specificity': 0.75790477, 'f1': 0.7380052, 'auroc': 0.9097278, 'binary_precision': 0.46126762, 'binary_recall': 0.5413223, 'binary_specificity': 0.97448725, 'binary_f1_score': 0.49809885}
confusion matrix:
      0    1
0  5844  153
1   111  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-02 06:52:02.258941,epoch time: 0:21:34.647642,used: 0:43:46.631632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9887187, 'precision': 0.9811629, 'recall': 0.990283, 'specificity': 0.990283, 'f1': 0.98560154, 'auroc': 0.9994798, 'binary_precision': 0.96464324, 'binary_recall': 0.9935889, 'binary_specificity': 0.9869771, 'binary_f1_score': 0.97890216}
confusion matrix:
       0      1
0  41759    551
1     97  15033
---- Validation: 
scalar performance:
{'acc': 0.8936238, 'precision': 0.60307723, 'recall': 0.87277544, 'specificity': 0.87277544, 'f1': 0.64055926, 'auroc': 0.9314023, 'binary_precision': 0.2116577, 'binary_recall': 0.8504983, 'binary_specificity': 0.89505255, 'binary_f1_score': 0.33896062}
confusion matrix:
       0     1
0  16264  1907
1     90   512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7672704, 'precision': 0.55791444, 'recall': 0.7976471, 'specificity': 0.7976471, 'f1': 0.5400784, 'auroc': 0.8381305, 'binary_precision': 0.124689825, 'binary_recall': 0.8305785, 'binary_specificity': 0.7647157, 'binary_f1_score': 0.21682848}
confusion matrix:
      0     1
0  4586  1411
1    41   201
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_3.png
early stop counter: 1
val acc:0.8936238288879395, best validation acc: 0.9654823541641235, corresponding to test acc:                         0.9576855301856995 / 0.9576855301856995
after epoch: 3,now: 2024-07-02 07:13:35.586361,epoch time: 0:21:33.327420,used: 1:05:19.959052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9917131, 'precision': 0.9937837, 'recall': 0.9848844, 'specificity': 0.9848844, 'f1': 0.9892255, 'auroc': 0.99921954, 'binary_precision': 0.9980287, 'binary_recall': 0.9704541, 'binary_specificity': 0.9993146, 'binary_f1_score': 0.9840483}
confusion matrix:
       0      1
0  42282     29
1    447  14682
---- Validation: 
scalar performance:
{'acc': 0.9701167, 'precision': 0.75774753, 'recall': 0.8416207, 'specificity': 0.8416207, 'f1': 0.79316056, 'auroc': 0.9553874, 'binary_precision': 0.5254027, 'binary_recall': 0.70431894, 'binary_specificity': 0.9789225, 'binary_f1_score': 0.60184526}
confusion matrix:
       0    1
0  17788  383
1    178  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97996473, 'precision': 0.9022403, 'recall': 0.807166, 'specificity': 0.807166, 'f1': 0.84775573, 'auroc': 0.9467487, 'binary_precision': 0.8196721, 'binary_recall': 0.6198347, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.7058824}
confusion matrix:
      0    1
0  5964   33
1    92  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-02 07:35:00.223848,epoch time: 0:21:24.637487,used: 1:26:44.596539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99343663, 'precision': 0.99536085, 'recall': 0.9877528, 'specificity': 0.9877528, 'f1': 0.99147767, 'auroc': 0.9995649, 'binary_precision': 0.99932307, 'binary_recall': 0.9757419, 'binary_specificity': 0.99976367, 'binary_f1_score': 0.9873917}
confusion matrix:
       0      1
0  42301     10
1    367  14762
---- Validation: 
scalar performance:
{'acc': 0.97555, 'precision': 0.8814973, 'recall': 0.66213536, 'specificity': 0.66213536, 'f1': 0.72469497, 'auroc': 0.95621645, 'binary_precision': 0.78486055, 'binary_recall': 0.32724252, 'binary_specificity': 0.99702823, 'binary_f1_score': 0.46189916}
confusion matrix:
       0    1
0  18117   54
1    405  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.9496863, 'recall': 0.5844606, 'specificity': 0.5844606, 'f1': 0.6349905, 'auroc': 0.94103163, 'binary_precision': 0.9318182, 'binary_recall': 0.1694215, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.28671327}
confusion matrix:
      0   1
0  5994   3
1   201  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_5.png
better model found
persisted
after epoch: 5,now: 2024-07-02 07:56:32.944550,epoch time: 0:21:32.720702,used: 1:48:17.317241,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9947075, 'precision': 0.99285114, 'recall': 0.99352, 'specificity': 0.99352, 'f1': 0.9931849, 'auroc': 0.99958736, 'binary_precision': 0.98891896, 'binary_recall': 0.99101067, 'binary_specificity': 0.9960294, 'binary_f1_score': 0.98996365}
confusion matrix:
       0      1
0  42143    168
1    136  14993
---- Validation: 
scalar performance:
{'acc': 0.96558887, 'precision': 0.7292044, 'recall': 0.79190195, 'specificity': 0.79190195, 'f1': 0.75633156, 'auroc': 0.9465887, 'binary_precision': 0.4715762, 'binary_recall': 0.6063123, 'binary_specificity': 0.9774916, 'binary_f1_score': 0.53052324}
confusion matrix:
       0    1
0  17762  409
1    237  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9578458, 'precision': 0.720825, 'recall': 0.7460917, 'specificity': 0.7460917, 'f1': 0.7326743, 'auroc': 0.91589355, 'binary_precision': 0.46125463, 'binary_recall': 0.5165289, 'binary_specificity': 0.9756545, 'binary_f1_score': 0.48732942}
confusion matrix:
      0    1
0  5851  146
1   117  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_6.png
early stop counter: 1
val acc:0.9655888676643372, best validation acc: 0.9755499958992004, corresponding to test acc:                         0.9673024415969849 / 0.9799647331237793
after epoch: 6,now: 2024-07-02 08:17:58.374153,epoch time: 0:21:25.429603,used: 2:09:42.746844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9961699, 'precision': 0.99539876, 'recall': 0.99472475, 'specificity': 0.99472475, 'f1': 0.99506116, 'auroc': 0.9997385, 'binary_precision': 0.99377316, 'binary_recall': 0.9916711, 'binary_specificity': 0.9977784, 'binary_f1_score': 0.99272096}
confusion matrix:
       0      1
0  42218     94
1    126  15002
---- Validation: 
scalar performance:
{'acc': 0.96494967, 'precision': 0.72903436, 'recall': 0.8325272, 'specificity': 0.8325272, 'f1': 0.77006996, 'auroc': 0.9505466, 'binary_precision': 0.46846846, 'binary_recall': 0.6910299, 'binary_specificity': 0.97402453, 'binary_f1_score': 0.55838925}
confusion matrix:
       0    1
0  17699  472
1    186  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95656353, 'precision': 0.7082486, 'recall': 0.7057699, 'specificity': 0.7057699, 'f1': 0.70700073, 'auroc': 0.91771436, 'binary_precision': 0.43933055, 'binary_recall': 0.4338843, 'binary_specificity': 0.9776555, 'binary_f1_score': 0.43659043}
confusion matrix:
      0    1
0  5863  134
1   137  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_7.png
early stop counter: 2
val acc:0.9649496674537659, best validation acc: 0.9755499958992004, corresponding to test acc:                         0.9673024415969849 / 0.9799647331237793
after epoch: 7,now: 2024-07-02 08:39:27.541856,epoch time: 0:21:29.167703,used: 2:31:11.914547,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9958739, 'precision': 0.993931, 'recall': 0.9954582, 'specificity': 0.9954582, 'f1': 0.9946913, 'auroc': 0.9998507, 'binary_precision': 0.9898033, 'binary_recall': 0.9945796, 'binary_specificity': 0.99633676, 'binary_f1_score': 0.9921857}
confusion matrix:
       0      1
0  42157    155
1     82  15046
---- Validation: 
scalar performance:
{'acc': 0.9676663, 'precision': 0.74430424, 'recall': 0.8596281, 'specificity': 0.8596281, 'f1': 0.7896501, 'auroc': 0.95992637, 'binary_precision': 0.4972253, 'binary_recall': 0.74418604, 'binary_specificity': 0.9750702, 'binary_f1_score': 0.59614104}
confusion matrix:
       0    1
0  17718  453
1    154  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.73206764, 'recall': 0.6583691, 'specificity': 0.6583691, 'f1': 0.68738425, 'auroc': 0.9361404, 'binary_precision': 0.49079755, 'binary_recall': 0.3305785, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.3950617}
confusion matrix:
      0   1
0  5914  83
1   162  80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_8.png
early stop counter: 3
val acc:0.9676663279533386, best validation acc: 0.9755499958992004, corresponding to test acc:                         0.9673024415969849 / 0.9799647331237793
after epoch: 8,now: 2024-07-02 09:00:37.157899,epoch time: 0:21:09.616043,used: 2:52:21.530590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98833567, 'precision': 0.9922057, 'recall': 0.97785854, 'specificity': 0.97785854, 'f1': 0.98475087, 'auroc': 0.99973124, 'binary_precision': 1.0, 'binary_recall': 0.95571715, 'binary_specificity': 1.0, 'binary_f1_score': 0.97735727}
confusion matrix:
       0      1
0  42310      0
1    670  14460
---- Validation: 
scalar performance:
{'acc': 0.9685719, 'precision': 0.9842759, 'recall': 0.5099668, 'specificity': 0.5099668, 'f1': 0.5115563, 'auroc': 0.9599917, 'binary_precision': 1.0, 'binary_recall': 0.019933555, 'binary_specificity': 1.0, 'binary_f1_score': 0.039087947}
confusion matrix:
       0   1
0  18171   0
1    590  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7306798, 'recall': 0.50198275, 'specificity': 0.50198275, 'f1': 0.4942079, 'auroc': 0.9394365, 'binary_precision': 0.5, 'binary_recall': 0.004132231, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.008196721}
confusion matrix:
      0  1
0  5996  1
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_9.png
early stop counter: 4
val acc:0.9685719013214111, best validation acc: 0.9755499958992004, corresponding to test acc:                         0.9673024415969849 / 0.9799647331237793
after epoch: 9,now: 2024-07-02 09:21:46.998316,epoch time: 0:21:09.840417,used: 3:13:31.371007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99695337, 'precision': 0.99776673, 'recall': 0.9943859, 'specificity': 0.9943859, 'f1': 0.99606067, 'auroc': 0.9998569, 'binary_precision': 0.9994656, 'binary_recall': 0.98896086, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.99418545}
confusion matrix:
       0      1
0  42304      8
1    167  14961
---- Validation: 
scalar performance:
{'acc': 0.97698826, 'precision': 0.84060514, 'recall': 0.7455923, 'specificity': 0.7455923, 'f1': 0.7847822, 'auroc': 0.96176964, 'binary_precision': 0.6976744, 'binary_recall': 0.49833888, 'binary_specificity': 0.9928457, 'binary_f1_score': 0.5813954}
confusion matrix:
       0    1
0  18041  130
1    302  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9559224, 'precision': 0.64201796, 'recall': 0.5547481, 'specificity': 0.5547481, 'f1': 0.57576555, 'auroc': 0.92247933, 'binary_precision': 0.31868133, 'binary_recall': 0.11983471, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.17417417}
confusion matrix:
      0   1
0  5935  62
1   213  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_10.png
better model found
persisted
after epoch: 10,now: 2024-07-02 09:43:11.118687,epoch time: 0:21:24.120371,used: 3:34:55.491378,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99364555, 'precision': 0.9893675, 'recall': 0.9944128, 'specificity': 0.9944128, 'f1': 0.9918541, 'auroc': 0.9997758, 'binary_precision': 0.9801613, 'binary_recall': 0.9960341, 'binary_specificity': 0.9927915, 'binary_f1_score': 0.988034}
confusion matrix:
       0      1
0  42006    305
1     60  15069
---- Validation: 
scalar performance:
{'acc': 0.9760827, 'precision': 0.8199549, 'recall': 0.7635946, 'specificity': 0.7635946, 'f1': 0.78881824, 'auroc': 0.96224356, 'binary_precision': 0.6551724, 'binary_recall': 0.53654486, 'binary_specificity': 0.99064445, 'binary_f1_score': 0.5899543}
confusion matrix:
       0    1
0  18001  170
1    279  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.7935391, 'recall': 0.6168332, 'specificity': 0.6168332, 'f1': 0.66355956, 'auroc': 0.9459413, 'binary_precision': 0.61702126, 'binary_recall': 0.23966943, 'binary_specificity': 0.993997, 'binary_f1_score': 0.3452381}
confusion matrix:
      0   1
0  5961  36
1   184  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_11.png
early stop counter: 1
val acc:0.9760826826095581, best validation acc: 0.9769882559776306, corresponding to test acc:                         0.9559224247932434 / 0.9799647331237793
after epoch: 11,now: 2024-07-02 10:04:37.028816,epoch time: 0:21:25.910129,used: 3:56:21.401507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9973189, 'precision': 0.99773324, 'recall': 0.99535656, 'specificity': 0.99535656, 'f1': 0.9965372, 'auroc': 0.9998218, 'binary_precision': 0.9986017, 'binary_recall': 0.9912095, 'binary_specificity': 0.9995037, 'binary_f1_score': 0.9948918}
confusion matrix:
       0      1
0  42289     21
1    133  14997
---- Validation: 
scalar performance:
{'acc': 0.97693497, 'precision': 0.8711573, 'recall': 0.7022002, 'specificity': 0.7022002, 'f1': 0.7600341, 'auroc': 0.9546421, 'binary_precision': 0.7616099, 'binary_recall': 0.40863788, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.53189194}
confusion matrix:
       0    1
0  18094   77
1    356  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.80301285, 'recall': 0.5504857, 'specificity': 0.5504857, 'f1': 0.5794984, 'auroc': 0.9404, 'binary_precision': 0.64102566, 'binary_recall': 0.10330579, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.17793594}
confusion matrix:
      0   1
0  5983  14
1   217  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_12.png
early stop counter: 2
val acc:0.9769349694252014, best validation acc: 0.9769882559776306, corresponding to test acc:                         0.9559224247932434 / 0.9799647331237793
after epoch: 12,now: 2024-07-02 10:26:22.945858,epoch time: 0:21:45.917042,used: 4:18:07.318549,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9940808, 'precision': 0.9959473, 'recall': 0.9888277, 'specificity': 0.9888277, 'f1': 0.9923183, 'auroc': 0.99984074, 'binary_precision': 0.9997972, 'binary_recall': 0.9777264, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9886387}
confusion matrix:
       0      1
0  42307      3
1    337  14793
---- Validation: 
scalar performance:
{'acc': 0.97251374, 'precision': 0.8063762, 'recall': 0.66538525, 'specificity': 0.66538525, 'f1': 0.713129, 'auroc': 0.9571182, 'binary_precision': 0.634375, 'binary_recall': 0.3372093, 'binary_specificity': 0.99356115, 'binary_f1_score': 0.44034708}
confusion matrix:
       0    1
0  18054  117
1    399  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.74564064, 'recall': 0.56171507, 'specificity': 0.56171507, 'f1': 0.5931765, 'auroc': 0.92733526, 'binary_precision': 0.5254237, 'binary_recall': 0.12809917, 'binary_specificity': 0.995331, 'binary_f1_score': 0.20598006}
confusion matrix:
      0   1
0  5969  28
1   211  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_13.png
early stop counter: 3
val acc:0.972513735294342, best validation acc: 0.9769882559776306, corresponding to test acc:                         0.9559224247932434 / 0.9799647331237793
after epoch: 13,now: 2024-07-02 10:49:28.452818,epoch time: 0:23:05.506960,used: 4:41:12.825509,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99637884, 'precision': 0.9969026, 'recall': 0.9937631, 'specificity': 0.9937631, 'f1': 0.99531937, 'auroc': 0.9997988, 'binary_precision': 0.9979976, 'binary_recall': 0.9882353, 'binary_specificity': 0.99929094, 'binary_f1_score': 0.9930924}
confusion matrix:
       0      1
0  42280     30
1    178  14952
---- Validation: 
scalar performance:
{'acc': 0.9740052, 'precision': 0.84759605, 'recall': 0.65410995, 'specificity': 0.65410995, 'f1': 0.71094084, 'auroc': 0.9531404, 'binary_precision': 0.71755725, 'binary_recall': 0.31229237, 'binary_specificity': 0.9959276, 'binary_f1_score': 0.4351852}
confusion matrix:
       0    1
0  18097   74
1    414  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.717209, 'recall': 0.5591487, 'specificity': 0.5591487, 'f1': 0.5879341, 'auroc': 0.9067986, 'binary_precision': 0.46875, 'binary_recall': 0.12396694, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.19607843}
confusion matrix:
      0   1
0  5963  34
1   212  30
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_14.png
early stop counter: 4
val acc:0.9740052223205566, best validation acc: 0.9769882559776306, corresponding to test acc:                         0.9559224247932434 / 0.9799647331237793
after epoch: 14,now: 2024-07-02 11:13:46.743849,epoch time: 0:24:18.291031,used: 5:05:31.116540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9972319, 'precision': 0.997417, 'recall': 0.9954461, 'specificity': 0.9954461, 'f1': 0.9964262, 'auroc': 0.9998516, 'binary_precision': 0.9978054, 'binary_recall': 0.99167216, 'binary_specificity': 0.99922, 'binary_f1_score': 0.99472934}
confusion matrix:
       0      1
0  42277     33
1    126  15004
---- Validation: 
scalar performance:
{'acc': 0.97555, 'precision': 0.884908, 'recall': 0.65972626, 'specificity': 0.65972626, 'f1': 0.7227901, 'auroc': 0.95871043, 'binary_precision': 0.79183674, 'binary_recall': 0.32225913, 'binary_specificity': 0.99719334, 'binary_f1_score': 0.45808733}
confusion matrix:
       0    1
0  18120   51
1    408  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.76596695, 'recall': 0.5420544, 'specificity': 0.5420544, 'f1': 0.5655549, 'auroc': 0.9503407, 'binary_precision': 0.5675676, 'binary_recall': 0.08677686, 'binary_specificity': 0.997332, 'binary_f1_score': 0.15053764}
confusion matrix:
      0   1
0  5981  16
1   221  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_15.png
early stop counter: 5
val acc:0.9755499958992004, best validation acc: 0.9769882559776306, corresponding to test acc:                         0.9559224247932434 / 0.9799647331237793
after epoch: 15,now: 2024-07-02 11:36:17.237893,epoch time: 0:22:30.494044,used: 5:28:01.610584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9963092, 'precision': 0.99489176, 'recall': 0.99560523, 'specificity': 0.99560523, 'f1': 0.99524784, 'auroc': 0.9998342, 'binary_precision': 0.9918887, 'binary_recall': 0.9941176, 'binary_specificity': 0.9970929, 'binary_f1_score': 0.993002}
confusion matrix:
       0      1
0  42187    123
1     89  15041
---- Validation: 
scalar performance:
{'acc': 0.969584, 'precision': 0.7546804, 'recall': 0.8630278, 'specificity': 0.8630278, 'f1': 0.7982634, 'auroc': 0.96223164, 'binary_precision': 0.5177956, 'binary_recall': 0.7491694, 'binary_specificity': 0.9768863, 'binary_f1_score': 0.61235577}
confusion matrix:
       0    1
0  17751  420
1    151  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9580061, 'precision': 0.71174777, 'recall': 0.67281365, 'specificity': 0.67281365, 'f1': 0.69003284, 'auroc': 0.9287276, 'binary_precision': 0.4489796, 'binary_recall': 0.36363637, 'binary_specificity': 0.981991, 'binary_f1_score': 0.40182647}
confusion matrix:
      0    1
0  5889  108
1   154   88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_16.png
early stop counter: 6
val acc:0.9695839881896973, best validation acc: 0.9769882559776306, corresponding to test acc:                         0.9559224247932434 / 0.9799647331237793
after epoch: 16,now: 2024-07-02 11:58:28.364119,epoch time: 0:22:11.126226,used: 5:50:12.736810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99777156, 'precision': 0.99816877, 'recall': 0.99608845, 'specificity': 0.99608845, 'f1': 0.9971227, 'auroc': 0.99980915, 'binary_precision': 0.9990021, 'binary_recall': 0.9925314, 'binary_specificity': 0.9996455, 'binary_f1_score': 0.99575627}
confusion matrix:
       0      1
0  42295     15
1    113  15017
---- Validation: 
scalar performance:
{'acc': 0.97096896, 'precision': 0.76547265, 'recall': 0.77781713, 'specificity': 0.77781713, 'f1': 0.7714901, 'auroc': 0.9510361, 'binary_precision': 0.5451664, 'binary_recall': 0.5714286, 'binary_specificity': 0.9842056, 'binary_f1_score': 0.5579886}
confusion matrix:
       0    1
0  17884  287
1    258  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93524605, 'precision': 0.6033204, 'recall': 0.6292506, 'specificity': 0.6292506, 'f1': 0.61445475, 'auroc': 0.8942848, 'binary_precision': 0.23529412, 'binary_recall': 0.29752067, 'binary_specificity': 0.9609805, 'binary_f1_score': 0.26277372}
confusion matrix:
      0    1
0  5763  234
1   170   72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_17.png
early stop counter: 7
val acc:0.9709689617156982, best validation acc: 0.9769882559776306, corresponding to test acc:                         0.9559224247932434 / 0.9799647331237793
after epoch: 17,now: 2024-07-02 12:20:10.536361,epoch time: 0:21:42.172242,used: 6:11:54.909052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99636143, 'precision': 0.99743307, 'recall': 0.9931989, 'specificity': 0.9931989, 'f1': 0.9952915, 'auroc': 0.99971676, 'binary_precision': 0.9996651, 'binary_recall': 0.98651594, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.993047}
confusion matrix:
       0      1
0  42306      5
1    204  14925
---- Validation: 
scalar performance:
{'acc': 0.97746766, 'precision': 0.845279, 'recall': 0.7506583, 'specificity': 0.7506583, 'f1': 0.7898594, 'auroc': 0.95898795, 'binary_precision': 0.70669746, 'binary_recall': 0.50830567, 'binary_specificity': 0.9930108, 'binary_f1_score': 0.59130436}
confusion matrix:
       0    1
0  18044  127
1    296  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95928836, 'precision': 0.7086227, 'recall': 0.60210204, 'specificity': 0.60210204, 'f1': 0.6347729, 'auroc': 0.91780585, 'binary_precision': 0.44827586, 'binary_recall': 0.21487603, 'binary_specificity': 0.989328, 'binary_f1_score': 0.2905028}
confusion matrix:
      0   1
0  5933  64
1   190  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_18.png
better model found
persisted
after epoch: 18,now: 2024-07-02 12:42:04.391277,epoch time: 0:21:53.854916,used: 6:33:48.763968,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99637884, 'precision': 0.9974884, 'recall': 0.99318993, 'specificity': 0.99318993, 'f1': 0.9953139, 'auroc': 0.9999071, 'binary_precision': 0.999799, 'binary_recall': 0.98645073, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9930801}
confusion matrix:
       0      1
0  42307      3
1    205  14925
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.7343158, 'recall': 0.5112427, 'specificity': 0.5112427, 'f1': 0.5140686, 'auroc': 0.94376546, 'binary_precision': 0.5, 'binary_recall': 0.023255814, 'binary_specificity': 0.99922955, 'binary_f1_score': 0.04444444}
confusion matrix:
       0   1
0  18157  14
1    588  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.530655, 'recall': 0.5013158, 'specificity': 0.5013158, 'f1': 0.49374413, 'auroc': 0.9045837, 'binary_precision': 0.1, 'binary_recall': 0.004132231, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.007936507}
confusion matrix:
      0  1
0  5988  9
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_19.png
early stop counter: 1
val acc:0.9679326415061951, best validation acc: 0.9774676561355591, corresponding to test acc:                         0.9592883586883545 / 0.9799647331237793
after epoch: 19,now: 2024-07-02 13:04:07.865918,epoch time: 0:22:03.474641,used: 6:55:52.238609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9971971, 'precision': 0.9979745, 'recall': 0.9948065, 'specificity': 0.9948065, 'f1': 0.99637675, 'auroc': 0.9997796, 'binary_precision': 0.99959946, 'binary_recall': 0.9897548, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99465275}
confusion matrix:
       0      1
0  42305      6
1    155  14974
---- Validation: 
scalar performance:
{'acc': 0.9748575, 'precision': 0.9225873, 'recall': 0.6264435, 'specificity': 0.6264435, 'f1': 0.6902395, 'auroc': 0.9525507, 'binary_precision': 0.8693182, 'binary_recall': 0.25415283, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.3933162}
confusion matrix:
       0    1
0  18148   23
1    449  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7315709, 'recall': 0.5257756, 'specificity': 0.5257756, 'f1': 0.5385976, 'auroc': 0.9123496, 'binary_precision': 0.5, 'binary_recall': 0.053719006, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.09701493}
confusion matrix:
      0   1
0  5984  13
1   229  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_20.png
early stop counter: 2
val acc:0.9748575091362, best validation acc: 0.9774676561355591, corresponding to test acc:                         0.9592883586883545 / 0.9799647331237793
after epoch: 20,now: 2024-07-02 13:25:44.219805,epoch time: 0:21:36.353887,used: 7:17:28.592496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.997023, 'precision': 0.9967215, 'recall': 0.99560153, 'specificity': 0.99560153, 'f1': 0.9961598, 'auroc': 0.9997891, 'binary_precision': 0.9960868, 'binary_recall': 0.99259746, 'binary_specificity': 0.99860555, 'binary_f1_score': 0.9943391}
confusion matrix:
       0      1
0  42251     59
1    112  15018
---- Validation: 
scalar performance:
{'acc': 0.9728866, 'precision': 0.7747593, 'recall': 0.8607186, 'specificity': 0.8607186, 'f1': 0.8113029, 'auroc': 0.9609653, 'binary_precision': 0.55819774, 'binary_recall': 0.7408638, 'binary_specificity': 0.9805734, 'binary_f1_score': 0.63668805}
confusion matrix:
       0    1
0  17818  353
1    156  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96473795, 'precision': 0.77231216, 'recall': 0.6802809, 'specificity': 0.6802809, 'f1': 0.71589255, 'auroc': 0.9313252, 'binary_precision': 0.56962025, 'binary_recall': 0.37190083, 'binary_specificity': 0.988661, 'binary_f1_score': 0.45000002}
confusion matrix:
      0   1
0  5929  68
1   152  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_21.png
early stop counter: 3
val acc:0.9728866219520569, best validation acc: 0.9774676561355591, corresponding to test acc:                         0.9592883586883545 / 0.9799647331237793
after epoch: 21,now: 2024-07-02 13:47:22.138106,epoch time: 0:21:37.918301,used: 7:39:06.510797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99677926, 'precision': 0.997671, 'recall': 0.9940345, 'specificity': 0.9940345, 'f1': 0.9958347, 'auroc': 0.99985707, 'binary_precision': 0.99953204, 'binary_recall': 0.9882345, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.9938512}
confusion matrix:
       0      1
0  42304      7
1    178  14951
---- Validation: 
scalar performance:
{'acc': 0.97746766, 'precision': 0.85417664, 'recall': 0.7362034, 'specificity': 0.7362034, 'f1': 0.7825012, 'auroc': 0.95900667, 'binary_precision': 0.7254408, 'binary_recall': 0.47840533, 'binary_specificity': 0.99400145, 'binary_f1_score': 0.5765766}
confusion matrix:
       0    1
0  18062  109
1    314  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95656353, 'precision': 0.6670099, 'recall': 0.5768917, 'specificity': 0.5768917, 'f1': 0.60278666, 'auroc': 0.9264341, 'binary_precision': 0.36697248, 'binary_recall': 0.16528925, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.22792023}
confusion matrix:
      0   1
0  5928  69
1   202  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_22.png
early stop counter: 4
val acc:0.9774676561355591, best validation acc: 0.9774676561355591, corresponding to test acc:                         0.9592883586883545 / 0.9799647331237793
after epoch: 22,now: 2024-07-02 14:09:04.085093,epoch time: 0:21:41.946987,used: 8:00:48.457784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99651814, 'precision': 0.99503636, 'recall': 0.9960017, 'specificity': 0.9960017, 'f1': 0.99551773, 'auroc': 0.9998034, 'binary_precision': 0.99189454, 'binary_recall': 0.9949104, 'binary_specificity': 0.99709296, 'binary_f1_score': 0.99340016}
confusion matrix:
       0      1
0  42188    123
1     77  15052
---- Validation: 
scalar performance:
{'acc': 0.97235394, 'precision': 0.7715291, 'recall': 0.85562515, 'specificity': 0.85562515, 'f1': 0.8073313, 'auroc': 0.965288, 'binary_precision': 0.55207026, 'binary_recall': 0.730897, 'binary_specificity': 0.9803533, 'binary_f1_score': 0.6290207}
confusion matrix:
       0    1
0  17814  357
1    162  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.7940261, 'recall': 0.76357424, 'specificity': 0.76357424, 'f1': 0.77787304, 'auroc': 0.9594763, 'binary_precision': 0.6064815, 'binary_recall': 0.5413223, 'binary_specificity': 0.98582625, 'binary_f1_score': 0.57205236}
confusion matrix:
      0    1
0  5912   85
1   111  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_23.png
early stop counter: 5
val acc:0.9723539352416992, best validation acc: 0.9774676561355591, corresponding to test acc:                         0.9592883586883545 / 0.9799647331237793
after epoch: 23,now: 2024-07-02 14:31:29.310590,epoch time: 0:22:25.225497,used: 8:23:13.683281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9967096, 'precision': 0.9974938, 'recall': 0.9940301, 'specificity': 0.9940301, 'f1': 0.99574554, 'auroc': 0.99989665, 'binary_precision': 0.99913144, 'binary_recall': 0.9883675, 'binary_specificity': 0.99969274, 'binary_f1_score': 0.9937203}
confusion matrix:
       0      1
0  42297     13
1    176  14954
---- Validation: 
scalar performance:
{'acc': 0.9766686, 'precision': 0.8096101, 'recall': 0.82251984, 'specificity': 0.82251984, 'f1': 0.8159208, 'auroc': 0.9638278, 'binary_precision': 0.6305733, 'binary_recall': 0.6578073, 'binary_specificity': 0.9872324, 'binary_f1_score': 0.6439024}
confusion matrix:
       0    1
0  17939  232
1    206  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.7537856, 'recall': 0.6136832, 'specificity': 0.6136832, 'f1': 0.65414757, 'auroc': 0.93667376, 'binary_precision': 0.5377358, 'binary_recall': 0.23553719, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.3275862}
confusion matrix:
      0   1
0  5948  49
1   185  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_24.png
early stop counter: 6
val acc:0.9766685962677002, best validation acc: 0.9774676561355591, corresponding to test acc:                         0.9592883586883545 / 0.9799647331237793
after epoch: 24,now: 2024-07-02 14:54:40.439122,epoch time: 0:23:11.128532,used: 8:46:24.811813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9985202, 'precision': 0.99827266, 'recall': 0.9979127, 'specificity': 0.9979127, 'f1': 0.9980925, 'auroc': 0.99997526, 'binary_precision': 0.9977501, 'binary_recall': 0.996629, 'binary_specificity': 0.9991964, 'binary_f1_score': 0.9971892}
confusion matrix:
       0      1
0  42277     34
1     51  15078
---- Validation: 
scalar performance:
{'acc': 0.97800034, 'precision': 0.83424747, 'recall': 0.78947973, 'specificity': 0.78947973, 'f1': 0.8101203, 'auroc': 0.9547249, 'binary_precision': 0.6820809, 'binary_recall': 0.5880399, 'binary_specificity': 0.9909196, 'binary_f1_score': 0.6315789}
confusion matrix:
       0    1
0  18006  165
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.7309452, 'recall': 0.6425072, 'specificity': 0.6425072, 'f1': 0.6749568, 'auroc': 0.9253043, 'binary_precision': 0.48979592, 'binary_recall': 0.29752067, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.37017998}
confusion matrix:
      0   1
0  5922  75
1   170  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_25.png
better model found
persisted
after epoch: 25,now: 2024-07-02 15:16:53.242089,epoch time: 0:22:12.802967,used: 9:08:37.614780,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99792826, 'precision': 0.9981465, 'recall': 0.99651325, 'specificity': 0.99651325, 'f1': 0.99732625, 'auroc': 0.99993074, 'binary_precision': 0.99860495, 'binary_recall': 0.9935228, 'binary_specificity': 0.9995037, 'binary_f1_score': 0.99605745}
confusion matrix:
       0      1
0  42289     21
1     98  15032
---- Validation: 
scalar performance:
{'acc': 0.9776807, 'precision': 0.85901487, 'recall': 0.73470736, 'specificity': 0.73470736, 'f1': 0.78286624, 'auroc': 0.96509326, 'binary_precision': 0.7352185, 'binary_recall': 0.47508305, 'binary_specificity': 0.9943316, 'binary_f1_score': 0.57719475}
confusion matrix:
       0    1
0  18068  103
1    316  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.8258283, 'recall': 0.6378279, 'specificity': 0.6378279, 'f1': 0.69034326, 'auroc': 0.94158113, 'binary_precision': 0.68, 'binary_recall': 0.28099173, 'binary_specificity': 0.994664, 'binary_f1_score': 0.39766082}
confusion matrix:
      0   1
0  5965  32
1   174  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_26.png
early stop counter: 1
val acc:0.9776806831359863, best validation acc: 0.9780003428459167, corresponding to test acc:                         0.9607309103012085 / 0.9799647331237793
after epoch: 26,now: 2024-07-02 15:38:47.795355,epoch time: 0:21:54.553266,used: 9:30:32.168046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9973886, 'precision': 0.997931, 'recall': 0.99533963, 'specificity': 0.99533963, 'f1': 0.99662614, 'auroc': 0.9997623, 'binary_precision': 0.99906707, 'binary_recall': 0.99101007, 'binary_specificity': 0.99966913, 'binary_f1_score': 0.9950223}
confusion matrix:
       0      1
0  42298     14
1    136  14992
---- Validation: 
scalar performance:
{'acc': 0.9749108, 'precision': 0.82252645, 'recall': 0.71721554, 'specificity': 0.71721554, 'f1': 0.75876, 'auroc': 0.9489318, 'binary_precision': 0.66334164, 'binary_recall': 0.44186047, 'binary_specificity': 0.9925706, 'binary_f1_score': 0.5304088}
confusion matrix:
       0    1
0  18036  135
1    336  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.8363245, 'recall': 0.6198164, 'specificity': 0.6198164, 'f1': 0.6724233, 'auroc': 0.9491224, 'binary_precision': 0.70238096, 'binary_recall': 0.24380165, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.36196318}
confusion matrix:
      0   1
0  5972  25
1   183  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_27.png
early stop counter: 2
val acc:0.9749107956886292, best validation acc: 0.9780003428459167, corresponding to test acc:                         0.9607309103012085 / 0.9799647331237793
after epoch: 27,now: 2024-07-02 16:00:33.149290,epoch time: 0:21:45.353935,used: 9:52:17.521981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99787605, 'precision': 0.9984114, 'recall': 0.9961169, 'specificity': 0.9961169, 'f1': 0.99725693, 'auroc': 0.9998497, 'binary_precision': 0.999534, 'binary_recall': 0.9923992, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.9959538}
confusion matrix:
       0      1
0  42303      7
1    115  15015
---- Validation: 
scalar performance:
{'acc': 0.97325945, 'precision': 0.8433614, 'recall': 0.63846684, 'specificity': 0.63846684, 'f1': 0.6943524, 'auroc': 0.9431816, 'binary_precision': 0.710084, 'binary_recall': 0.2807309, 'binary_specificity': 0.99620277, 'binary_f1_score': 0.40238097}
confusion matrix:
       0    1
0  18102   69
1    433  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.8765369, 'recall': 0.5531354, 'specificity': 0.5531354, 'f1': 0.5854084, 'auroc': 0.9357601, 'binary_precision': 0.7878788, 'binary_recall': 0.10743801, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.1890909}
confusion matrix:
      0   1
0  5990   7
1   216  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_28.png
early stop counter: 3
val acc:0.973259449005127, best validation acc: 0.9780003428459167, corresponding to test acc:                         0.9607309103012085 / 0.9799647331237793
after epoch: 28,now: 2024-07-02 16:22:22.746875,epoch time: 0:21:49.597585,used: 10:14:07.119566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.997789, 'precision': 0.9970566, 'recall': 0.9972465, 'specificity': 0.9972465, 'f1': 0.9971516, 'auroc': 0.9999218, 'binary_precision': 0.995508, 'binary_recall': 0.9961002, 'binary_specificity': 0.9983929, 'binary_f1_score': 0.9958041}
confusion matrix:
       0      1
0  42243     68
1     59  15070
---- Validation: 
scalar performance:
{'acc': 0.9728866, 'precision': 0.7754339, 'recall': 0.849476, 'specificity': 0.849476, 'f1': 0.80760384, 'auroc': 0.96366775, 'binary_precision': 0.56031126, 'binary_recall': 0.717608, 'binary_specificity': 0.9813439, 'binary_f1_score': 0.6292789}
confusion matrix:
       0    1
0  17832  339
1    170  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95928836, 'precision': 0.7157941, 'recall': 0.6358086, 'specificity': 0.6358086, 'f1': 0.6655124, 'auroc': 0.9282172, 'binary_precision': 0.46, 'binary_recall': 0.28512397, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.3520408}
confusion matrix:
      0   1
0  5916  81
1   173  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_29.png
early stop counter: 4
val acc:0.9728866219520569, best validation acc: 0.9780003428459167, corresponding to test acc:                         0.9607309103012085 / 0.9799647331237793
after epoch: 29,now: 2024-07-02 16:43:57.078467,epoch time: 0:21:34.331592,used: 10:35:41.451158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.997493, 'precision': 0.9977869, 'recall': 0.9957505, 'specificity': 0.9957505, 'f1': 0.996763, 'auroc': 0.999828, 'binary_precision': 0.9984035, 'binary_recall': 0.99206823, 'binary_specificity': 0.99943274, 'binary_f1_score': 0.9952257}
confusion matrix:
       0      1
0  42287     24
1    120  15009
---- Validation: 
scalar performance:
{'acc': 0.9634582, 'precision': 0.6999898, 'recall': 0.6767684, 'specificity': 0.6767684, 'f1': 0.687577, 'auroc': 0.9312829, 'binary_precision': 0.42075473, 'binary_recall': 0.3704319, 'binary_specificity': 0.98310494, 'binary_f1_score': 0.39399293}
confusion matrix:
       0    1
0  17864  307
1    379  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.72736645, 'recall': 0.68372786, 'specificity': 0.68372786, 'f1': 0.70292246, 'auroc': 0.93510234, 'binary_precision': 0.47938144, 'binary_recall': 0.38429752, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.42660552}
confusion matrix:
      0    1
0  5896  101
1   149   93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629059_30.png
early stop counter: 5
val acc:0.9634581804275513, best validation acc: 0.9780003428459167, corresponding to test acc:                         0.9607309103012085 / 0.9799647331237793
after epoch: 30,now: 2024-07-02 17:06:45.222657,epoch time: 0:22:48.144190,used: 10:58:29.595348,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_06_08_15_seed_2_21629059
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:58:29.595348 at 2024-07-02 17:06:45.222657
persisted model performance metric: 

scalar performance:
{'acc': 0.9607309, 'precision': 0.7309452, 'recall': 0.6425072, 'specificity': 0.6425072, 'f1': 0.6749568, 'auroc': 0.9253043, 'binary_precision': 0.48979592, 'binary_recall': 0.29752067, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.37017998}
confusion matrix:
      0   1
0  5922  75
1   170  72
oracle model performance metric: 

scalar performance:
{'acc': 0.97996473, 'precision': 0.9022403, 'recall': 0.807166, 'specificity': 0.807166, 'f1': 0.84775573, 'auroc': 0.9467487, 'binary_precision': 0.8196721, 'binary_recall': 0.6198347, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.7058824}
confusion matrix:
      0    1
0  5964   33
1    92  150
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 319321 KiB |   6783 MiB |   3310 TiB |   3310 TiB |
|       from large pool | 291059 KiB |   6756 MiB |   3262 TiB |   3262 TiB |
|       from small pool |  28262 KiB |     48 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 319321 KiB |   6783 MiB |   3310 TiB |   3310 TiB |
|       from large pool | 291059 KiB |   6756 MiB |   3262 TiB |   3262 TiB |
|       from small pool |  28262 KiB |     48 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 314121 KiB |   6778 MiB |   3306 TiB |   3306 TiB |
|       from large pool | 286862 KiB |   6752 MiB |   3259 TiB |   3259 TiB |
|       from small pool |  27259 KiB |     47 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7450 MiB |   7460 MiB |  21180 MiB |  13730 MiB |
|       from large pool |   7398 MiB |   7404 MiB |  21092 MiB |  13694 MiB |
|       from small pool |     52 MiB |     56 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 258214 KiB | 680184 KiB |   2416 TiB |   2416 TiB |
|       from large pool | 249613 KiB | 675647 KiB |   2368 TiB |   2368 TiB |
|       from small pool |   8601 KiB |  31464 KiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3218    |    7927    |  617201 K  |  617198 K  |
|       from large pool |     130    |     756    |  310168 K  |  310168 K  |
|       from small pool |    3088    |    7795    |  307033 K  |  307030 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3218    |    7927    |  617201 K  |  617198 K  |
|       from large pool |     130    |     756    |  310168 K  |  310168 K  |
|       from small pool |    3088    |    7795    |  307033 K  |  307030 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     337    |     921    |     586    |
|       from large pool |     309    |     309    |     877    |     568    |
|       from small pool |      26    |      28    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      57    |    3628    |  370358 K  |  370357 K  |
|       from large pool |      25    |     307    |  227903 K  |  227903 K  |
|       from small pool |      32    |    3604    |  142454 K  |  142454 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   3310 TiB |   3310 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   3262 TiB |   3262 TiB |
|       from small pool |      0 KiB |     48 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   3310 TiB |   3310 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   3262 TiB |   3262 TiB |
|       from small pool |      0 KiB |     48 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   3306 TiB |   3306 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   3259 TiB |   3259 TiB |
|       from small pool |      0 KiB |     47 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 577536 KiB |   7460 MiB |  21180 MiB |  20616 MiB |
|       from large pool | 540672 KiB |   7404 MiB |  21092 MiB |  20564 MiB |
|       from small pool |  36864 KiB |     56 MiB |     88 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |   2416 TiB |   2416 TiB |
|       from large pool |  24320 KiB | 675647 KiB |   2368 TiB |   2368 TiB |
|       from small pool |      0 KiB |  31464 KiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7927    |  617201 K  |  617201 K  |
|       from large pool |       2    |     756    |  310168 K  |  310168 K  |
|       from small pool |       0    |    7795    |  307033 K  |  307033 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7927    |  617201 K  |  617201 K  |
|       from large pool |       2    |     756    |  310168 K  |  310168 K  |
|       from small pool |       0    |    7795    |  307033 K  |  307033 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     337    |     921    |     879    |
|       from large pool |      24    |     309    |     877    |     853    |
|       from small pool |      18    |      28    |      44    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3628    |  370359 K  |  370359 K  |
|       from large pool |       3    |     307    |  227903 K  |  227903 K  |
|       from small pool |       0    |    3604    |  142455 K  |  142455 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul  2 17:08:07 2024]
Finished job 0.
1 of 1 steps (100%) done
