Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul  1 03:58:22 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056

 Experiment start at: 2024-07-01 04:04:08.580762
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99112904, 'precision': 0.99322015, 'recall': 0.98363006, 'specificity': 0.98363006, 'f1': 0.9883033, 'auroc': 0.9993044, 'binary_precision': 0.99741006, 'binary_recall': 0.9681343, 'binary_specificity': 0.9991258, 'binary_f1_score': 0.9825542}
confusion matrix:
       0      1
0  42285     37
1    469  14249
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.97190297, 'precision': 0.86846423, 'recall': 0.62842745, 'specificity': 0.62842745, 'f1': 0.6865463, 'auroc': 0.9538584, 'binary_precision': 0.7625571, 'binary_recall': 0.25972006, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.38747102}
confusion matrix:
       0    1
0  18097   52
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.91718, 'recall': 0.5133266, 'specificity': 0.5133266, 'f1': 0.5156116, 'auroc': 0.932816, 'binary_precision': 0.875, 'binary_recall': 0.026819924, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.052044608}
confusion matrix:
      0  1
0  5996  1
1   254  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-01 05:03:03.184291,epoch time: 0:58:54.603529,used: 0:58:54.603529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99321526, 'precision': 0.9953058, 'recall': 0.9870088, 'specificity': 0.9870088, 'f1': 0.99106646, 'auroc': 0.99955976, 'binary_precision': 0.9995121, 'binary_recall': 0.974183, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.98668504}
confusion matrix:
       0      1
0  42314      7
1    380  14339
---- Validation: 
scalar performance:
{'acc': 0.97121114, 'precision': 0.8282429, 'recall': 0.64682066, 'specificity': 0.64682066, 'f1': 0.70018876, 'auroc': 0.9482235, 'binary_precision': 0.68085104, 'binary_recall': 0.29860032, 'binary_specificity': 0.9950411, 'binary_f1_score': 0.41513515}
confusion matrix:
       0    1
0  18059   90
1    451  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97363377, 'precision': 0.9515132, 'recall': 0.6985667, 'specificity': 0.6985667, 'f1': 0.77202636, 'auroc': 0.95053947, 'binary_precision': 0.9285714, 'binary_recall': 0.39846742, 'binary_specificity': 0.998666, 'binary_f1_score': 0.5576408}
confusion matrix:
      0    1
0  5989    8
1   157  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_2.png
new oracle model saved
early stop counter: 1
val acc:0.9712111353874207, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9592521786689758 / 0.9736337661743164
after epoch: 2,now: 2024-07-01 06:01:27.575770,epoch time: 0:58:24.391479,used: 1:57:18.995008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.995284, 'precision': 0.99661255, 'recall': 0.99108255, 'specificity': 0.99108255, 'f1': 0.99380714, 'auroc': 0.99955815, 'binary_precision': 0.9993088, 'binary_recall': 0.9824013, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.9907829}
confusion matrix:
       0      1
0  42313     10
1    259  14458
---- Validation: 
scalar performance:
{'acc': 0.9732865, 'precision': 0.80775565, 'recall': 0.75665313, 'specificity': 0.75665313, 'f1': 0.77967054, 'auroc': 0.96030563, 'binary_precision': 0.63227016, 'binary_recall': 0.5241057, 'binary_specificity': 0.98920053, 'binary_f1_score': 0.57312924}
confusion matrix:
       0    1
0  17953  196
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.8903308, 'recall': 0.6308499, 'specificity': 0.6308499, 'f1': 0.69087636, 'auroc': 0.9466272, 'binary_precision': 0.8117647, 'binary_recall': 0.26436782, 'binary_specificity': 0.997332, 'binary_f1_score': 0.39884394}
confusion matrix:
      0   1
0  5981  16
1   192  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_3.png
better model found
persisted
after epoch: 3,now: 2024-07-01 06:59:53.009311,epoch time: 0:58:25.433541,used: 2:55:44.428549,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9972651, 'precision': 0.9976455, 'recall': 0.9952091, 'specificity': 0.9952091, 'f1': 0.9964194, 'auroc': 0.9997206, 'binary_precision': 0.9984252, 'binary_recall': 0.9909616, 'binary_specificity': 0.9994566, 'binary_f1_score': 0.9946794}
confusion matrix:
       0      1
0  42302     23
1    133  14582
---- Validation: 
scalar performance:
{'acc': 0.96897614, 'precision': 0.762183, 'recall': 0.8564291, 'specificity': 0.8564291, 'f1': 0.8012677, 'auroc': 0.96673834, 'binary_precision': 0.53386, 'binary_recall': 0.7356143, 'binary_specificity': 0.9772439, 'binary_f1_score': 0.61870503}
confusion matrix:
       0    1
0  17736  413
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.8427391, 'recall': 0.7895998, 'specificity': 0.7895998, 'f1': 0.81368816, 'auroc': 0.94498396, 'binary_precision': 0.70319635, 'binary_recall': 0.5900383, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.6416667}
confusion matrix:
      0    1
0  5932   65
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_4.png
early stop counter: 1
val acc:0.9689761400222778, best validation acc: 0.973286509513855, corresponding to test acc:                         0.9667625427246094 / 0.9736337661743164
after epoch: 4,now: 2024-07-01 07:58:16.387395,epoch time: 0:58:23.378084,used: 3:54:07.806633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98513323, 'precision': 0.9736819, 'recall': 0.9887631, 'specificity': 0.9887631, 'f1': 0.98089325, 'auroc': 0.99969685, 'binary_precision': 0.9486864, 'binary_recall': 0.99626255, 'binary_specificity': 0.9812636, 'binary_f1_score': 0.97189265}
confusion matrix:
       0      1
0  41531    793
1     55  14661
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.7589537, 'recall': 0.8471254, 'specificity': 0.8471254, 'f1': 0.7958553, 'auroc': 0.9606718, 'binary_precision': 0.52806413, 'binary_recall': 0.7169518, 'binary_specificity': 0.97729903, 'binary_f1_score': 0.60817945}
confusion matrix:
       0    1
0  17737  412
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.7719372, 'recall': 0.7868465, 'specificity': 0.7868465, 'f1': 0.7791657, 'auroc': 0.9450147, 'binary_precision': 0.5615942, 'binary_recall': 0.59386975, 'binary_specificity': 0.97982323, 'binary_f1_score': 0.5772812}
confusion matrix:
      0    1
0  5876  121
1   106  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_5.png
early stop counter: 2
val acc:0.9683908224105835, best validation acc: 0.973286509513855, corresponding to test acc:                         0.9667625427246094 / 0.9736337661743164
after epoch: 5,now: 2024-07-01 08:56:42.747414,epoch time: 0:58:26.360019,used: 4:52:34.166652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9965638, 'precision': 0.9976725, 'recall': 0.9933623, 'specificity': 0.9933623, 'f1': 0.99549294, 'auroc': 0.9996723, 'binary_precision': 0.99993116, 'binary_recall': 0.9867482, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99329597}
confusion matrix:
       0      1
0  42324      1
1    195  14520
---- Validation: 
scalar performance:
{'acc': 0.9742976, 'precision': 0.92995834, 'recall': 0.64241815, 'specificity': 0.64241815, 'f1': 0.7096417, 'auroc': 0.96609384, 'binary_precision': 0.88461536, 'binary_recall': 0.28615862, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.43243238}
confusion matrix:
       0    1
0  18125   24
1    459  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.6459533, 'recall': 0.50349796, 'specificity': 0.50349796, 'f1': 0.4967551, 'auroc': 0.9399652, 'binary_precision': 0.33333334, 'binary_recall': 0.007662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.014981273}
confusion matrix:
      0  1
0  5993  4
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_6.png
better model found
persisted
after epoch: 6,now: 2024-07-01 09:54:28.593732,epoch time: 0:57:45.846318,used: 5:50:20.012970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9972826, 'precision': 0.99745595, 'recall': 0.99544257, 'specificity': 0.99544257, 'f1': 0.996444, 'auroc': 0.9998628, 'binary_precision': 0.9978118, 'binary_recall': 0.99164116, 'binary_specificity': 0.999244, 'binary_f1_score': 0.99471694}
confusion matrix:
       0      1
0  42293     32
1    123  14592
---- Validation: 
scalar performance:
{'acc': 0.9728076, 'precision': 0.7960249, 'recall': 0.7849073, 'specificity': 0.7849073, 'f1': 0.79034895, 'auroc': 0.9644176, 'binary_precision': 0.60679615, 'binary_recall': 0.58320373, 'binary_specificity': 0.98661083, 'binary_f1_score': 0.5947661}
confusion matrix:
       0    1
0  17906  243
1    268  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.65978503, 'recall': 0.51590735, 'specificity': 0.51590735, 'f1': 0.52051187, 'auroc': 0.9345192, 'binary_precision': 0.36, 'binary_recall': 0.03448276, 'binary_specificity': 0.997332, 'binary_f1_score': 0.062937066}
confusion matrix:
      0   1
0  5981  16
1   252   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_7.png
early stop counter: 1
val acc:0.9728075861930847, best validation acc: 0.9742975831031799, corresponding to test acc:                         0.9579737782478333 / 0.9736337661743164
after epoch: 7,now: 2024-07-01 10:52:36.607600,epoch time: 0:58:08.013868,used: 6:48:28.026838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99701965, 'precision': 0.99790895, 'recall': 0.994313, 'specificity': 0.994313, 'f1': 0.9960939, 'auroc': 0.9998809, 'binary_precision': 0.99972516, 'binary_recall': 0.98872054, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99419236}
confusion matrix:
       0      1
0  42319      4
1    166  14551
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.95727074, 'recall': 0.5535445, 'specificity': 0.5535445, 'f1': 0.58852994, 'auroc': 0.966509, 'binary_precision': 0.94520545, 'binary_recall': 0.10730949, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.19273745}
confusion matrix:
       0   1
0  18145   4
1    574  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.4791367, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.48922622, 'auroc': 0.95426464, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_8.png
early stop counter: 2
val acc:0.9692422151565552, best validation acc: 0.9742975831031799, corresponding to test acc:                         0.9579737782478333 / 0.9736337661743164
after epoch: 8,now: 2024-07-01 11:51:05.640330,epoch time: 0:58:29.032730,used: 7:46:57.059568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99786115, 'precision': 0.99731624, 'recall': 0.9970957, 'specificity': 0.9970957, 'f1': 0.997206, 'auroc': 0.99984837, 'binary_precision': 0.9961915, 'binary_recall': 0.99551445, 'binary_specificity': 0.99867696, 'binary_f1_score': 0.9958529}
confusion matrix:
       0      1
0  42270     56
1     66  14648
---- Validation: 
scalar performance:
{'acc': 0.9779161, 'precision': 0.83040977, 'recall': 0.840806, 'specificity': 0.840806, 'f1': 0.83551955, 'auroc': 0.9733964, 'binary_precision': 0.67168677, 'binary_recall': 0.69362366, 'binary_specificity': 0.9879883, 'binary_f1_score': 0.68247896}
confusion matrix:
       0    1
0  17931  218
1    197  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.82077765, 'recall': 0.59378445, 'specificity': 0.59378445, 'f1': 0.63960755, 'auroc': 0.9603561, 'binary_precision': 0.6756757, 'binary_recall': 0.19157088, 'binary_specificity': 0.995998, 'binary_f1_score': 0.29850745}
confusion matrix:
      0   1
0  5973  24
1   211  50
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_9.png
better model found
persisted
after epoch: 9,now: 2024-07-01 12:50:00.832808,epoch time: 0:58:55.192478,used: 8:45:52.252046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9978261, 'precision': 0.99735874, 'recall': 0.9969617, 'specificity': 0.9969617, 'f1': 0.99716, 'auroc': 0.99992204, 'binary_precision': 0.99639434, 'binary_recall': 0.99517566, 'binary_specificity': 0.9987477, 'binary_f1_score': 0.99578464}
confusion matrix:
       0      1
0  42270     53
1     71  14646
---- Validation: 
scalar performance:
{'acc': 0.9791933, 'precision': 0.86545575, 'recall': 0.7942137, 'specificity': 0.7942137, 'f1': 0.8256616, 'auroc': 0.9707246, 'binary_precision': 0.7451362, 'binary_recall': 0.5956454, 'binary_specificity': 0.992782, 'binary_f1_score': 0.662057}
confusion matrix:
       0    1
0  18018  131
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.90054727, 'recall': 0.65758646, 'specificity': 0.65758646, 'f1': 0.7218955, 'auroc': 0.9668046, 'binary_precision': 0.83, 'binary_recall': 0.31800765, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.4598338}
confusion matrix:
      0   1
0  5980  17
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_10.png
better model found
persisted
after epoch: 10,now: 2024-07-01 13:48:34.618510,epoch time: 0:58:33.785702,used: 9:44:26.037748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9975281, 'precision': 0.9982269, 'recall': 0.99532044, 'specificity': 0.99532044, 'f1': 0.9967625, 'auroc': 0.99991655, 'binary_precision': 0.9996572, 'binary_recall': 0.990759, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9951882}
confusion matrix:
       0      1
0  42318      5
1    136  14581
---- Validation: 
scalar performance:
{'acc': 0.9750958, 'precision': 0.8955747, 'recall': 0.67508376, 'specificity': 0.67508376, 'f1': 0.73982126, 'auroc': 0.97017616, 'binary_precision': 0.8136201, 'binary_recall': 0.35303265, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.49240783}
confusion matrix:
       0    1
0  18097   52
1    416  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.9177147, 'recall': 0.5266532, 'specificity': 0.5266532, 'f1': 0.5403691, 'auroc': 0.9649349, 'binary_precision': 0.875, 'binary_recall': 0.053639848, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.10108303}
confusion matrix:
      0   1
0  5995   2
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_11.png
early stop counter: 1
val acc:0.975095808506012, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9688398838043213 / 0.9736337661743164
after epoch: 11,now: 2024-07-01 14:47:19.263346,epoch time: 0:58:44.644836,used: 10:43:10.682584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9973527, 'precision': 0.99659735, 'recall': 0.99648726, 'specificity': 0.99648726, 'f1': 0.99654233, 'auroc': 0.99989617, 'binary_precision': 0.9950374, 'binary_recall': 0.9946993, 'binary_specificity': 0.9982753, 'binary_f1_score': 0.9948683}
confusion matrix:
       0      1
0  42252     73
1     78  14637
---- Validation: 
scalar performance:
{'acc': 0.97482973, 'precision': 0.8553393, 'recall': 0.7064483, 'specificity': 0.7064483, 'f1': 0.7596067, 'auroc': 0.9682942, 'binary_precision': 0.73097825, 'binary_recall': 0.41835147, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.5321464}
confusion matrix:
       0    1
0  18050   99
1    374  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9204087, 'recall': 0.5932861, 'specificity': 0.5932861, 'f1': 0.64559793, 'auroc': 0.9712428, 'binary_precision': 0.875, 'binary_recall': 0.18773946, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.30914825}
confusion matrix:
      0   1
0  5990   7
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_12.png
early stop counter: 2
val acc:0.9748297333717346, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9688398838043213 / 0.9736337661743164
after epoch: 12,now: 2024-07-01 15:46:26.797025,epoch time: 0:59:07.533679,used: 11:42:18.216263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9971599, 'precision': 0.9980936, 'recall': 0.9944947, 'specificity': 0.9944947, 'f1': 0.9962771, 'auroc': 0.99993396, 'binary_precision': 1.0, 'binary_recall': 0.98898935, 'binary_specificity': 1.0, 'binary_f1_score': 0.9944642}
confusion matrix:
       0      1
0  42327      0
1    162  14551
---- Validation: 
scalar performance:
{'acc': 0.9757876, 'precision': 0.9639889, 'recall': 0.6536903, 'specificity': 0.6536903, 'f1': 0.7264741, 'auroc': 0.9747859, 'binary_precision': 0.9519231, 'binary_recall': 0.30793157, 'binary_specificity': 0.999449, 'binary_f1_score': 0.46533492}
confusion matrix:
       0    1
0  18139   10
1    445  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.87744755, 'recall': 0.54356104, 'specificity': 0.54356104, 'f1': 0.5693316, 'auroc': 0.9752609, 'binary_precision': 0.79310346, 'binary_recall': 0.08812261, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.15862069}
confusion matrix:
      0   1
0  5991   6
1   238  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_13.png
early stop counter: 3
val acc:0.9757875800132751, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9688398838043213 / 0.9736337661743164
after epoch: 13,now: 2024-07-01 16:45:25.785274,epoch time: 0:58:58.988249,used: 12:41:17.204512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9975982, 'precision': 0.9983866, 'recall': 0.9953462, 'specificity': 0.9953462, 'f1': 0.9968542, 'auroc': 0.999945, 'binary_precision': 1.0, 'binary_recall': 0.9906923, 'binary_specificity': 1.0, 'binary_f1_score': 0.9953244}
confusion matrix:
       0      1
0  42321      0
1    137  14582
---- Validation: 
scalar performance:
{'acc': 0.9728076, 'precision': 0.9594834, 'recall': 0.6086443, 'specificity': 0.6086443, 'f1': 0.6700469, 'auroc': 0.97471535, 'binary_precision': 0.9459459, 'binary_recall': 0.21772939, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.3539823}
confusion matrix:
       0    1
0  18141    8
1    503  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8961932, 'recall': 0.50949514, 'specificity': 0.50949514, 'f1': 0.50823593, 'auroc': 0.97182286, 'binary_precision': 0.8333333, 'binary_recall': 0.019157087, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.037453182}
confusion matrix:
      0  1
0  5996  1
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_14.png
early stop counter: 4
val acc:0.9728075861930847, best validation acc: 0.9791932702064514, corresponding to test acc:                         0.9688398838043213 / 0.9736337661743164
after epoch: 14,now: 2024-07-01 18:35:58.904599,epoch time: 1:50:33.119325,used: 14:31:50.323837,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9974229, 'precision': 0.9981338, 'recall': 0.99513876, 'specificity': 0.99513876, 'f1': 0.99662447, 'auroc': 0.9997982, 'binary_precision': 0.99958855, 'binary_recall': 0.99041927, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.9949827}
confusion matrix:
       0      1
0  42317      6
1    141  14576
---- Validation: 
scalar performance:
{'acc': 0.9797254, 'precision': 0.8774264, 'recall': 0.7877387, 'specificity': 0.7877387, 'f1': 0.826041, 'auroc': 0.9719187, 'binary_precision': 0.76954734, 'binary_recall': 0.5816485, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.6625333}
confusion matrix:
       0    1
0  18037  112
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97363377, 'precision': 0.92824525, 'recall': 0.71139306, 'specificity': 0.71139306, 'f1': 0.7800198, 'auroc': 0.95119816, 'binary_precision': 0.88095236, 'binary_recall': 0.42528737, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.5736434}
confusion matrix:
      0    1
0  5982   15
1   150  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_15.png
better model found
persisted
after epoch: 15,now: 2024-07-01 21:17:13.674922,epoch time: 2:41:14.770323,used: 17:13:05.094160,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9977034, 'precision': 0.99841195, 'recall': 0.99559426, 'specificity': 0.99559426, 'f1': 0.99699265, 'auroc': 0.99991286, 'binary_precision': 0.9998629, 'binary_recall': 0.9912358, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99553066}
confusion matrix:
       0      1
0  42319      2
1    129  14590
---- Validation: 
scalar performance:
{'acc': 0.9744572, 'precision': 0.96248436, 'recall': 0.6335001, 'specificity': 0.6335001, 'f1': 0.7022091, 'auroc': 0.9752607, 'binary_precision': 0.95027626, 'binary_recall': 0.2674961, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.41747576}
confusion matrix:
       0    1
0  18140    9
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8127799, 'recall': 0.5074961, 'specificity': 0.5074961, 'f1': 0.504409, 'auroc': 0.9657562, 'binary_precision': 0.6666667, 'binary_recall': 0.01532567, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.029962545}
confusion matrix:
      0  1
0  5995  2
1   257  4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_16.png
early stop counter: 1
val acc:0.9744572043418884, best validation acc: 0.9797254204750061, corresponding to test acc:                         0.9736337661743164 / 0.9736337661743164
after epoch: 16,now: 2024-07-01 22:20:41.039476,epoch time: 1:03:27.364554,used: 18:16:32.458714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99803644, 'precision': 0.998523, 'recall': 0.99635, 'specificity': 0.99635, 'f1': 0.99743026, 'auroc': 0.99987906, 'binary_precision': 0.9995212, 'binary_recall': 0.9928654, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.99618214}
confusion matrix:
       0      1
0  42316      7
1    105  14612
---- Validation: 
scalar performance:
{'acc': 0.9791933, 'precision': 0.91037, 'recall': 0.74095976, 'specificity': 0.74095976, 'f1': 0.8020431, 'auroc': 0.9756939, 'binary_precision': 0.83870965, 'binary_recall': 0.4852255, 'binary_specificity': 0.996694, 'binary_f1_score': 0.61477834}
confusion matrix:
       0    1
0  18089   60
1    331  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.87894416, 'recall': 0.55872, 'specificity': 0.55872, 'f1': 0.59359205, 'auroc': 0.97219026, 'binary_precision': 0.7948718, 'binary_recall': 0.118773945, 'binary_specificity': 0.998666, 'binary_f1_score': 0.20666666}
confusion matrix:
      0   1
0  5989   8
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_17.png
early stop counter: 2
val acc:0.9791932702064514, best validation acc: 0.9797254204750061, corresponding to test acc:                         0.9736337661743164 / 0.9736337661743164
after epoch: 17,now: 2024-07-01 23:20:06.258539,epoch time: 0:59:25.219063,used: 19:15:57.677777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9982994, 'precision': 0.99829835, 'recall': 0.9972588, 'specificity': 0.9972588, 'f1': 0.99777716, 'auroc': 0.999943, 'binary_precision': 0.9982961, 'binary_recall': 0.99510837, 'binary_specificity': 0.99940926, 'binary_f1_score': 0.9966997}
confusion matrix:
       0      1
0  42296     25
1     72  14647
---- Validation: 
scalar performance:
{'acc': 0.98094934, 'precision': 0.87774634, 'recall': 0.81387424, 'specificity': 0.81387424, 'f1': 0.8426136, 'auroc': 0.97548443, 'binary_precision': 0.76836157, 'binary_recall': 0.63452566, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.6950596}
confusion matrix:
       0    1
0  18026  123
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.792598, 'recall': 0.59694886, 'specificity': 0.59694886, 'f1': 0.6408241, 'auroc': 0.9502711, 'binary_precision': 0.61904764, 'binary_recall': 0.19923371, 'binary_specificity': 0.994664, 'binary_f1_score': 0.30144927}
confusion matrix:
      0   1
0  5965  32
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_18.png
better model found
persisted
after epoch: 18,now: 2024-07-02 00:19:28.199901,epoch time: 0:59:21.941362,used: 20:15:19.619139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99863255, 'precision': 0.9990802, 'recall': 0.99735, 'specificity': 0.99735, 'f1': 0.9982112, 'auroc': 0.9999325, 'binary_precision': 1.0, 'binary_recall': 0.9947, 'binary_specificity': 1.0, 'binary_f1_score': 0.997343}
confusion matrix:
       0      1
0  42323      0
1     78  14639
---- Validation: 
scalar performance:
{'acc': 0.97456366, 'precision': 0.9557291, 'recall': 0.6373055, 'specificity': 0.6373055, 'f1': 0.7062373, 'auroc': 0.973672, 'binary_precision': 0.93650794, 'binary_recall': 0.27527216, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.42548078}
confusion matrix:
       0    1
0  18137   12
1    466  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.5417534, 'recall': 0.5026642, 'specificity': 0.5026642, 'f1': 0.49606732, 'auroc': 0.93551993, 'binary_precision': 0.125, 'binary_recall': 0.007662835, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.014440433}
confusion matrix:
      0   1
0  5983  14
1   259   2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_19.png
early stop counter: 1
val acc:0.9745636582374573, best validation acc: 0.980949342250824, corresponding to test acc:                         0.9614893198013306 / 0.9736337661743164
after epoch: 19,now: 2024-07-02 01:18:21.633942,epoch time: 0:58:53.434041,used: 21:14:13.053180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9975456, 'precision': 0.9983516, 'recall': 0.99524295, 'specificity': 0.99524295, 'f1': 0.99678457, 'auroc': 0.99994934, 'binary_precision': 1.0, 'binary_recall': 0.9904859, 'binary_specificity': 1.0, 'binary_f1_score': 0.99522024}
confusion matrix:
       0      1
0  42325      0
1    140  14575
---- Validation: 
scalar performance:
{'acc': 0.9695615, 'precision': 0.97789884, 'recall': 0.55596, 'specificity': 0.55596, 'f1': 0.5928013, 'auroc': 0.9802806, 'binary_precision': 0.98630136, 'binary_recall': 0.11197512, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.20111732}
confusion matrix:
       0   1
0  18148   1
1    571  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.9251859, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_20.png
early stop counter: 2
val acc:0.9695615172386169, best validation acc: 0.980949342250824, corresponding to test acc:                         0.9614893198013306 / 0.9736337661743164
after epoch: 20,now: 2024-07-02 02:17:10.210203,epoch time: 0:58:48.576261,used: 22:13:01.629441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9971424, 'precision': 0.9980819, 'recall': 0.9944607, 'specificity': 0.9944607, 'f1': 0.99625397, 'auroc': 0.9998936, 'binary_precision': 1.0, 'binary_recall': 0.98892134, 'binary_specificity': 1.0, 'binary_f1_score': 0.99442977}
confusion matrix:
       0      1
0  42327      0
1    163  14550
---- Validation: 
scalar performance:
{'acc': 0.97451043, 'precision': 0.96765846, 'recall': 0.6327776, 'specificity': 0.6327776, 'f1': 0.70176786, 'auroc': 0.9715923, 'binary_precision': 0.96067417, 'binary_recall': 0.2659409, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.41656515}
confusion matrix:
       0    1
0  18142    7
1    472  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7293666, 'recall': 0.505497, 'specificity': 0.505497, 'f1': 0.50058204, 'auroc': 0.92286074, 'binary_precision': 0.5, 'binary_recall': 0.011494253, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.022471908}
confusion matrix:
      0  1
0  5994  3
1   258  3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_21.png
early stop counter: 3
val acc:0.9745104312896729, best validation acc: 0.980949342250824, corresponding to test acc:                         0.9614893198013306 / 0.9736337661743164
after epoch: 21,now: 2024-07-02 03:15:52.584422,epoch time: 0:58:42.374219,used: 23:11:44.003660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99749297, 'precision': 0.9982712, 'recall': 0.995185, 'specificity': 0.995185, 'f1': 0.99671555, 'auroc': 0.999954, 'binary_precision': 0.9998628, 'binary_recall': 0.9904173, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9951176}
confusion matrix:
       0      1
0  42324      2
1    141  14573
---- Validation: 
scalar performance:
{'acc': 0.98217326, 'precision': 0.94144106, 'recall': 0.7687545, 'specificity': 0.7687545, 'f1': 0.8326385, 'auroc': 0.9769032, 'binary_precision': 0.89896375, 'binary_recall': 0.53965783, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.6744412}
confusion matrix:
       0    1
0  18110   39
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.8984878, 'recall': 0.5664662, 'specificity': 0.5664662, 'f1': 0.6059725, 'auroc': 0.9508612, 'binary_precision': 0.8333333, 'binary_recall': 0.13409962, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.2310231}
confusion matrix:
      0   1
0  5990   7
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_22.png
better model found
persisted
after epoch: 22,now: 2024-07-02 04:14:54.375814,epoch time: 0:59:01.791392,used: 1 day, 0:10:45.795052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9987903, 'precision': 0.99916375, 'recall': 0.9976781, 'specificity': 0.9976781, 'f1': 0.9984181, 'auroc': 0.9999795, 'binary_precision': 0.99993175, 'binary_recall': 0.9953798, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9976506}
confusion matrix:
       0      1
0  42321      1
1     68  14650
---- Validation: 
scalar performance:
{'acc': 0.9815347, 'precision': 0.9374583, 'recall': 0.7609233, 'specificity': 0.7609233, 'f1': 0.82532334, 'auroc': 0.97035563, 'binary_precision': 0.8915344, 'binary_recall': 0.5241057, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.6601371}
confusion matrix:
       0    1
0  18108   41
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.54180706, 'recall': 0.50399625, 'specificity': 0.50399625, 'f1': 0.4991209, 'auroc': 0.94429225, 'binary_precision': 0.125, 'binary_recall': 0.011494253, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.021052632}
confusion matrix:
      0   1
0  5976  21
1   258   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_23.png
early stop counter: 1
val acc:0.9815347194671631, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.9627676606178284 / 0.9736337661743164
after epoch: 23,now: 2024-07-02 05:13:35.942075,epoch time: 0:58:41.566261,used: 1 day, 1:09:27.361313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9983345, 'precision': 0.9987456, 'recall': 0.99690557, 'specificity': 0.99690557, 'f1': 0.9978212, 'auroc': 0.99994934, 'binary_precision': 0.99959004, 'binary_recall': 0.993953, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9967636}
confusion matrix:
       0      1
0  42316      6
1     89  14629
---- Validation: 
scalar performance:
{'acc': 0.974404, 'precision': 0.9125539, 'recall': 0.65222394, 'specificity': 0.65222394, 'f1': 0.71859133, 'auroc': 0.9732373, 'binary_precision': 0.8491379, 'binary_recall': 0.30637637, 'binary_specificity': 0.9980715, 'binary_f1_score': 0.45028576}
confusion matrix:
       0    1
0  18114   35
1    446  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7103529, 'recall': 0.51091063, 'specificity': 0.51091063, 'f1': 0.511197, 'auroc': 0.9482404, 'binary_precision': 0.46153846, 'binary_recall': 0.022988506, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.04379562}
confusion matrix:
      0  1
0  5990  7
1   255  6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_24.png
early stop counter: 2
val acc:0.974403977394104, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.9627676606178284 / 0.9736337661743164
after epoch: 24,now: 2024-07-02 06:12:15.037097,epoch time: 0:58:39.095022,used: 1 day, 2:08:06.456335,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99831694, 'precision': 0.99886847, 'recall': 0.99673843, 'specificity': 0.99673843, 'f1': 0.9977975, 'auroc': 0.999959, 'binary_precision': 1.0, 'binary_recall': 0.9934769, 'binary_specificity': 1.0, 'binary_f1_score': 0.9967278}
confusion matrix:
       0      1
0  42323      0
1     96  14621
---- Validation: 
scalar performance:
{'acc': 0.9791933, 'precision': 0.9500768, 'recall': 0.7139578, 'specificity': 0.7139578, 'f1': 0.7873474, 'auroc': 0.9728198, 'binary_precision': 0.92, 'binary_recall': 0.42923796, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.5853659}
confusion matrix:
       0    1
0  18125   24
1    367  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.78634953, 'recall': 0.5409784, 'specificity': 0.5409784, 'f1': 0.56372136, 'auroc': 0.90945613, 'binary_precision': 0.6111111, 'binary_recall': 0.08429119, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.14814816}
confusion matrix:
      0   1
0  5983  14
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_25.png
early stop counter: 3
val acc:0.9791932702064514, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.9627676606178284 / 0.9736337661743164
after epoch: 25,now: 2024-07-02 07:10:49.969245,epoch time: 0:58:34.932148,used: 1 day, 3:06:41.388483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99873775, 'precision': 0.99912846, 'recall': 0.9975759, 'specificity': 0.9975759, 'f1': 0.998349, 'auroc': 0.99997234, 'binary_precision': 0.9999317, 'binary_recall': 0.9951753, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99754786}
confusion matrix:
       0      1
0  42323      1
1     71  14645
---- Validation: 
scalar performance:
{'acc': 0.9741911, 'precision': 0.91263294, 'recall': 0.6483635, 'specificity': 0.6483635, 'f1': 0.71433866, 'auroc': 0.97498596, 'binary_precision': 0.8495575, 'binary_recall': 0.29860032, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.44188723}
confusion matrix:
       0    1
0  18115   34
1    451  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.62214047, 'recall': 0.5034146, 'specificity': 0.5034146, 'f1': 0.49668542, 'auroc': 0.92422986, 'binary_precision': 0.2857143, 'binary_recall': 0.007662835, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.014925373}
confusion matrix:
      0  1
0  5992  5
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_26.png
early stop counter: 4
val acc:0.9741911292076111, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.9627676606178284 / 0.9736337661743164
after epoch: 26,now: 2024-07-02 08:08:48.213644,epoch time: 0:57:58.244399,used: 1 day, 4:04:39.632882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9977034, 'precision': 0.9982095, 'recall': 0.99579287, 'specificity': 0.99579287, 'f1': 0.9969934, 'auroc': 0.99995136, 'binary_precision': 0.99924695, 'binary_recall': 0.9918456, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.9955325}
confusion matrix:
       0      1
0  42313     11
1    120  14596
---- Validation: 
scalar performance:
{'acc': 0.9752022, 'precision': 0.9313799, 'recall': 0.6571375, 'specificity': 0.6571375, 'f1': 0.7264515, 'auroc': 0.9744629, 'binary_precision': 0.88646287, 'binary_recall': 0.31570762, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.46559635}
confusion matrix:
       0    1
0  18123   26
1    440  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.92075944, 'recall': 0.5552221, 'specificity': 0.5552221, 'f1': 0.5889847, 'auroc': 0.9479756, 'binary_precision': 0.8787879, 'binary_recall': 0.11111111, 'binary_specificity': 0.999333, 'binary_f1_score': 0.19727892}
confusion matrix:
      0   1
0  5993   4
1   232  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_27.png
early stop counter: 5
val acc:0.975202202796936, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.9627676606178284 / 0.9736337661743164
after epoch: 27,now: 2024-07-02 09:06:55.733416,epoch time: 0:58:07.519772,used: 1 day, 5:02:47.152654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9975982, 'precision': 0.99600637, 'recall': 0.9977387, 'specificity': 0.9977387, 'f1': 0.99686855, 'auroc': 0.9999367, 'binary_precision': 0.99269927, 'binary_recall': 0.9980291, 'binary_specificity': 0.9974484, 'binary_f1_score': 0.99535704}
confusion matrix:
       0      1
0  42218    108
1     29  14685
---- Validation: 
scalar performance:
{'acc': 0.9757876, 'precision': 0.92365736, 'recall': 0.67094153, 'specificity': 0.67094153, 'f1': 0.7401757, 'auroc': 0.97227, 'binary_precision': 0.87007874, 'binary_recall': 0.3437014, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.4927536}
confusion matrix:
       0    1
0  18116   33
1    422  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.5792734, 'recall': 0.5031644, 'specificity': 0.5031644, 'f1': 0.4964777, 'auroc': 0.9412273, 'binary_precision': 0.2, 'binary_recall': 0.007662835, 'binary_specificity': 0.998666, 'binary_f1_score': 0.014760148}
confusion matrix:
      0  1
0  5989  8
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_28.png
early stop counter: 6
val acc:0.9757875800132751, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.9627676606178284 / 0.9736337661743164
after epoch: 28,now: 2024-07-02 10:05:08.109884,epoch time: 0:58:12.376468,used: 1 day, 6:00:59.529122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99870265, 'precision': 0.99892616, 'recall': 0.9976857, 'specificity': 0.9976857, 'f1': 0.9983039, 'auroc': 0.99998415, 'binary_precision': 0.9993862, 'binary_recall': 0.99558395, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.99748147}
confusion matrix:
       0      1
0  42312      9
1     65  14654
---- Validation: 
scalar performance:
{'acc': 0.9765858, 'precision': 0.9136965, 'recall': 0.6908562, 'specificity': 0.6908562, 'f1': 0.7584512, 'auroc': 0.9732065, 'binary_precision': 0.84879726, 'binary_recall': 0.38413686, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.5289079}
confusion matrix:
       0    1
0  18105   44
1    396  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8961932, 'recall': 0.50949514, 'specificity': 0.50949514, 'f1': 0.50823593, 'auroc': 0.94593096, 'binary_precision': 0.8333333, 'binary_recall': 0.019157087, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.037453182}
confusion matrix:
      0  1
0  5996  1
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_29.png
early stop counter: 7
val acc:0.9765858054161072, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.9627676606178284 / 0.9736337661743164
after epoch: 29,now: 2024-07-02 11:07:03.338475,epoch time: 1:01:55.228591,used: 1 day, 7:02:54.757713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9984572, 'precision': 0.9989625, 'recall': 0.99701005, 'specificity': 0.99701005, 'f1': 0.9979813, 'auroc': 0.99997437, 'binary_precision': 1.0, 'binary_recall': 0.9940201, 'binary_specificity': 1.0, 'binary_f1_score': 0.9970011}
confusion matrix:
       0      1
0  42324      0
1     88  14628
---- Validation: 
scalar performance:
{'acc': 0.97275436, 'precision': 0.93284607, 'recall': 0.6153673, 'specificity': 0.6153673, 'f1': 0.67698914, 'auroc': 0.9757878, 'binary_precision': 0.89221555, 'binary_recall': 0.23172629, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.3679012}
confusion matrix:
       0    1
0  18131   18
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.75729454, 'recall': 0.50924504, 'specificity': 0.50924504, 'f1': 0.5079028, 'auroc': 0.9633316, 'binary_precision': 0.5555556, 'binary_recall': 0.019157087, 'binary_specificity': 0.999333, 'binary_f1_score': 0.037037034}
confusion matrix:
      0  1
0  5993  4
1   256  5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_30.png
early stop counter: 8
val acc:0.9727543592453003, best validation acc: 0.9821732640266418, corresponding to test acc:                         0.9627676606178284 / 0.9736337661743164
after epoch: 30,now: 2024-07-02 12:06:17.447894,epoch time: 0:59:14.109419,used: 1 day, 8:02:08.867132,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_04_04_08_seed_0_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 1 day, 8:02:08.867132 at 2024-07-02 12:06:17.447894
persisted model performance metric: 

scalar performance:
{'acc': 0.96276766, 'precision': 0.8984878, 'recall': 0.5664662, 'specificity': 0.5664662, 'f1': 0.6059725, 'auroc': 0.9508612, 'binary_precision': 0.8333333, 'binary_recall': 0.13409962, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.2310231}
confusion matrix:
      0   1
0  5990   7
1   226  35
oracle model performance metric: 

scalar performance:
{'acc': 0.97363377, 'precision': 0.9515132, 'recall': 0.6985667, 'specificity': 0.6985667, 'f1': 0.77202636, 'auroc': 0.95053947, 'binary_precision': 0.9285714, 'binary_recall': 0.39846742, 'binary_specificity': 0.998666, 'binary_f1_score': 0.5576408}
confusion matrix:
      0    1
0  5989    8
1   157  104
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 320668 KiB |   5304 MiB |   6021 TiB |   6021 TiB |
|       from large pool | 292399 KiB |   5277 MiB |   5955 TiB |   5955 TiB |
|       from small pool |  28268 KiB |     48 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 320668 KiB |   5304 MiB |   6021 TiB |   6021 TiB |
|       from large pool | 292399 KiB |   5277 MiB |   5955 TiB |   5955 TiB |
|       from small pool |  28268 KiB |     48 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 314122 KiB |   5301 MiB |   6018 TiB |   6018 TiB |
|       from large pool | 286862 KiB |   5274 MiB |   5952 TiB |   5952 TiB |
|       from small pool |  27260 KiB |     47 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5776 MiB |   5776 MiB |   5776 MiB |      0 B   |
|       from large pool |   5722 MiB |   5722 MiB |   5722 MiB |      0 B   |
|       from small pool |     54 MiB |     54 MiB |     54 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 213860 KiB |    961 MiB |   4541 TiB |   4541 TiB |
|       from large pool | 203216 KiB |    959 MiB |   4474 TiB |   4474 TiB |
|       from small pool |  10643 KiB |     11 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3230    |    7857    |     762 M  |     762 M  |
|       from large pool |     130    |     602    |     529 M  |     529 M  |
|       from small pool |    3100    |    7726    |     233 M  |     233 M  |
|---------------------------------------------------------------------------|
| Active allocs         |    3230    |    7857    |     762 M  |     762 M  |
|       from large pool |     130    |     602    |     529 M  |     529 M  |
|       from small pool |    3100    |    7726    |     233 M  |     233 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     246    |     246    |     246    |       0    |
|       from large pool |     219    |     219    |     219    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      57    |    3603    |  478362 K  |  478362 K  |
|       from large pool |      27    |     222    |  394703 K  |  394703 K  |
|       from small pool |      30    |    3576    |   83658 K  |   83658 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5304 MiB |   6021 TiB |   6021 TiB |
|       from large pool |  16640 KiB |   5277 MiB |   5955 TiB |   5955 TiB |
|       from small pool |      0 KiB |     48 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5304 MiB |   6021 TiB |   6021 TiB |
|       from large pool |  16640 KiB |   5277 MiB |   5955 TiB |   5955 TiB |
|       from small pool |      0 KiB |     48 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5301 MiB |   6018 TiB |   6018 TiB |
|       from large pool |  16640 KiB |   5274 MiB |   5952 TiB |   5952 TiB |
|       from small pool |      0 KiB |     47 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 534528 KiB |   5776 MiB |   5776 MiB |   5254 MiB |
|       from large pool | 495616 KiB |   5722 MiB |   5722 MiB |   5238 MiB |
|       from small pool |  38912 KiB |     54 MiB |     54 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    961 MiB |   4541 TiB |   4541 TiB |
|       from large pool |  24320 KiB |    959 MiB |   4474 TiB |   4474 TiB |
|       from small pool |      0 KiB |     22 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7857    |     762 M  |     762 M  |
|       from large pool |       2    |     602    |     529 M  |     529 M  |
|       from small pool |       0    |    7726    |     233 M  |     233 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7857    |     762 M  |     762 M  |
|       from large pool |       2    |     602    |     529 M  |     529 M  |
|       from small pool |       0    |    7726    |     233 M  |     233 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     246    |     246    |     204    |
|       from large pool |      23    |     219    |     219    |     196    |
|       from small pool |      19    |      27    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3603    |  478363 K  |  478363 K  |
|       from large pool |       3    |     222    |  394703 K  |  394703 K  |
|       from small pool |       0    |    3576    |   83660 K  |   83660 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5304 MiB |   6021 TiB |   6021 TiB |
|       from large pool |  16640 KiB |   5277 MiB |   5955 TiB |   5955 TiB |
|       from small pool |      0 KiB |     48 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5304 MiB |   6021 TiB |   6021 TiB |
|       from large pool |  16640 KiB |   5277 MiB |   5955 TiB |   5955 TiB |
|       from small pool |      0 KiB |     48 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5301 MiB |   6018 TiB |   6018 TiB |
|       from large pool |  16640 KiB |   5274 MiB |   5952 TiB |   5952 TiB |
|       from small pool |      0 KiB |     47 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 534528 KiB |   5776 MiB |   5776 MiB |   5254 MiB |
|       from large pool | 495616 KiB |   5722 MiB |   5722 MiB |   5238 MiB |
|       from small pool |  38912 KiB |     54 MiB |     54 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    961 MiB |   4541 TiB |   4541 TiB |
|       from large pool |  24320 KiB |    959 MiB |   4474 TiB |   4474 TiB |
|       from small pool |      0 KiB |     22 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7857    |     762 M  |     762 M  |
|       from large pool |       2    |     602    |     529 M  |     529 M  |
|       from small pool |       0    |    7726    |     233 M  |     233 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7857    |     762 M  |     762 M  |
|       from large pool |       2    |     602    |     529 M  |     529 M  |
|       from small pool |       0    |    7726    |     233 M  |     233 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     246    |     246    |     204    |
|       from large pool |      23    |     219    |     219    |     196    |
|       from small pool |      19    |      27    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3603    |  478363 K  |  478363 K  |
|       from large pool |       3    |     222    |  394703 K  |  394703 K  |
|       from small pool |       0    |    3576    |   83660 K  |   83660 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056

 Experiment start at: 2024-07-02 12:14:32.844892
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9897241, 'precision': 0.99296105, 'recall': 0.97997916, 'specificity': 0.97997916, 'f1': 0.9862535, 'auroc': 0.99938536, 'binary_precision': 0.9992783, 'binary_recall': 0.9601942, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.97934645}
confusion matrix:
       0      1
0  42402     10
1    574  13846
---- Validation: 
scalar performance:
{'acc': 0.9703842, 'precision': 0.870484, 'recall': 0.6241458, 'specificity': 0.6241458, 'f1': 0.68166506, 'auroc': 0.9503962, 'binary_precision': 0.7681818, 'binary_recall': 0.2511144, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.37849942}
confusion matrix:
       0    1
0  18016   51
1    504  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.9795935, 'recall': 0.51346153, 'specificity': 0.51346153, 'f1': 0.5158014, 'auroc': 0.94249934, 'binary_precision': 1.0, 'binary_recall': 0.026923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.05243446}
confusion matrix:
      0  1
0  5946  0
1   253  7
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-02 13:13:19.194823,epoch time: 0:58:46.349931,used: 0:58:46.349931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9898649, 'precision': 0.98278344, 'recall': 0.9908522, 'specificity': 0.9908522, 'f1': 0.9867296, 'auroc': 0.99953115, 'binary_precision': 0.96801674, 'binary_recall': 0.9928566, 'binary_specificity': 0.98884773, 'binary_f1_score': 0.9802793}
confusion matrix:
       0      1
0  41940    473
1    103  14316
---- Validation: 
scalar performance:
{'acc': 0.96286017, 'precision': 0.7405659, 'recall': 0.8770246, 'specificity': 0.8770246, 'f1': 0.79162955, 'auroc': 0.96127534, 'binary_precision': 0.48934197, 'binary_recall': 0.7845468, 'binary_specificity': 0.9695024, 'binary_f1_score': 0.6027397}
confusion matrix:
       0    1
0  17516  551
1    145  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.7911279, 'recall': 0.86933297, 'specificity': 0.86933297, 'f1': 0.8249563, 'auroc': 0.95311844, 'binary_precision': 0.5928144, 'binary_recall': 0.76153845, 'binary_specificity': 0.9771275, 'binary_f1_score': 0.6666667}
confusion matrix:
      0    1
0  5810  136
1    62  198
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_2.png
new oracle model saved
early stop counter: 1
val acc:0.9628601670265198, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9592329859733582 / 0.9680953621864319
after epoch: 2,now: 2024-07-02 14:11:20.611013,epoch time: 0:58:01.416190,used: 1:56:47.766121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9925922, 'precision': 0.9950857, 'recall': 0.9854012, 'specificity': 0.9854012, 'f1': 0.99012315, 'auroc': 0.9996869, 'binary_precision': 1.0, 'binary_recall': 0.9708024, 'binary_specificity': 1.0, 'binary_f1_score': 0.9851849}
confusion matrix:
       0      1
0  42413      0
1    421  13998
---- Validation: 
scalar performance:
{'acc': 0.9688901, 'precision': 0.8871282, 'recall': 0.5876075, 'specificity': 0.5876075, 'f1': 0.6369935, 'auroc': 0.96137667, 'binary_precision': 0.8040541, 'binary_recall': 0.1768202, 'binary_specificity': 0.99839485, 'binary_f1_score': 0.28989038}
confusion matrix:
       0    1
0  18038   29
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.9123324, 'recall': 0.5362862, 'specificity': 0.5362862, 'f1': 0.5573182, 'auroc': 0.95554173, 'binary_precision': 0.8636364, 'binary_recall': 0.073076926, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.13475178}
confusion matrix:
      0   1
0  5943   3
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_3.png
early stop counter: 2
val acc:0.9688900709152222, best validation acc: 0.9703841805458069, corresponding to test acc:                         0.9592329859733582 / 0.9680953621864319
after epoch: 3,now: 2024-07-02 15:09:36.469145,epoch time: 0:58:15.858132,used: 2:55:03.624253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9932432, 'precision': 0.9954896, 'recall': 0.9867071, 'specificity': 0.9867071, 'f1': 0.99099946, 'auroc': 0.9996865, 'binary_precision': 0.9999288, 'binary_recall': 0.97343785, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9865055}
confusion matrix:
       0      1
0  42412      1
1    383  14036
---- Validation: 
scalar performance:
{'acc': 0.9722519, 'precision': 0.88285404, 'recall': 0.65300983, 'specificity': 0.65300983, 'f1': 0.7151075, 'auroc': 0.9622028, 'binary_precision': 0.79087454, 'binary_recall': 0.30906388, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.44444445}
confusion matrix:
       0    1
0  18012   55
1    465  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.89482707, 'recall': 0.63903916, 'specificity': 0.63903916, 'f1': 0.7007549, 'auroc': 0.96409476, 'binary_precision': 0.8202247, 'binary_recall': 0.28076923, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.41833812}
confusion matrix:
      0   1
0  5930  16
1   187  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_4.png
better model found
persisted
after epoch: 4,now: 2024-07-02 16:07:16.788458,epoch time: 0:57:40.319313,used: 3:52:43.943566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9969735, 'precision': 0.99765325, 'recall': 0.99435645, 'specificity': 0.99435645, 'f1': 0.9959909, 'auroc': 0.99976635, 'binary_precision': 0.9990193, 'binary_recall': 0.989043, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.9940061}
confusion matrix:
       0      1
0  42398     14
1    158  14262
---- Validation: 
scalar performance:
{'acc': 0.9713447, 'precision': 0.820898, 'recall': 0.70117754, 'specificity': 0.70117754, 'f1': 0.7460654, 'auroc': 0.9638207, 'binary_precision': 0.66346157, 'binary_recall': 0.410104, 'binary_specificity': 0.99225104, 'binary_f1_score': 0.5068871}
confusion matrix:
       0    1
0  17927  140
1    397  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.9022937, 'recall': 0.5800965, 'specificity': 0.5800965, 'f1': 0.62614655, 'auroc': 0.9647168, 'binary_precision': 0.84, 'binary_recall': 0.16153847, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.27096778}
confusion matrix:
      0   1
0  5938   8
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_5.png
early stop counter: 1
val acc:0.9713447093963623, best validation acc: 0.9722518920898438, corresponding to test acc:                         0.9672897458076477 / 0.9680953621864319
after epoch: 5,now: 2024-07-02 17:06:41.883004,epoch time: 0:59:25.094546,used: 4:52:09.038112,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99743104, 'precision': 0.9982147, 'recall': 0.99500555, 'specificity': 0.99500555, 'f1': 0.99659693, 'auroc': 0.9998425, 'binary_precision': 0.9997899, 'binary_recall': 0.99008185, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9949122}
confusion matrix:
       0      1
0  42411      3
1    143  14275
---- Validation: 
scalar performance:
{'acc': 0.97187835, 'precision': 0.8983522, 'recall': 0.63708025, 'specificity': 0.63708025, 'f1': 0.6996934, 'auroc': 0.96505547, 'binary_precision': 0.82300884, 'binary_recall': 0.27637443, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.4137931}
confusion matrix:
       0    1
0  18027   40
1    487  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.60411966, 'recall': 0.5016708, 'specificity': 0.5016708, 'f1': 0.4930042, 'auroc': 0.9561381, 'binary_precision': 0.25, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5943  3
1   259  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_6.png
early stop counter: 2
val acc:0.9718783497810364, best validation acc: 0.9722518920898438, corresponding to test acc:                         0.9672897458076477 / 0.9680953621864319
after epoch: 6,now: 2024-07-02 18:05:49.139023,epoch time: 0:59:07.256019,used: 5:51:16.294131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99616414, 'precision': 0.99504757, 'recall': 0.99482083, 'specificity': 0.99482083, 'f1': 0.99493414, 'auroc': 0.9998249, 'binary_precision': 0.9927823, 'binary_recall': 0.99209374, 'binary_specificity': 0.9975479, 'binary_f1_score': 0.9924379}
confusion matrix:
       0      1
0  42309    104
1    114  14305
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.7496318, 'recall': 0.88236785, 'specificity': 0.88236785, 'f1': 0.80018413, 'auroc': 0.9667296, 'binary_precision': 0.5071225, 'binary_recall': 0.7934621, 'binary_specificity': 0.9712736, 'binary_f1_score': 0.61877173}
confusion matrix:
       0    1
0  17548  519
1    139  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9774412, 'precision': 0.85008097, 'recall': 0.8834051, 'specificity': 0.8834051, 'f1': 0.8658956, 'auroc': 0.96506876, 'binary_precision': 0.7097902, 'binary_recall': 0.7807692, 'binary_specificity': 0.986041, 'binary_f1_score': 0.7435897}
confusion matrix:
      0    1
0  5863   83
1    57  203
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_7.png
new oracle model saved
early stop counter: 3
val acc:0.9648879170417786, best validation acc: 0.9722518920898438, corresponding to test acc:                         0.9672897458076477 / 0.9774411916732788
after epoch: 7,now: 2024-07-02 19:04:09.840705,epoch time: 0:58:20.701682,used: 6:49:36.995813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99700874, 'precision': 0.9978868, 'recall': 0.99421984, 'specificity': 0.99421984, 'f1': 0.9960361, 'auroc': 0.9998716, 'binary_precision': 0.99964935, 'binary_recall': 0.9885576, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.99407256}
confusion matrix:
       0      1
0  42407      5
1    165  14255
---- Validation: 
scalar performance:
{'acc': 0.9729456, 'precision': 0.94428533, 'recall': 0.6354879, 'specificity': 0.6354879, 'f1': 0.70269704, 'auroc': 0.96795976, 'binary_precision': 0.915, 'binary_recall': 0.27191678, 'binary_specificity': 0.9990591, 'binary_f1_score': 0.41924396}
confusion matrix:
       0    1
0  18050   17
1    490  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.8796643, 'recall': 0.51521647, 'specificity': 0.51521647, 'f1': 0.5191701, 'auroc': 0.9643651, 'binary_precision': 0.8, 'binary_recall': 0.03076923, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.05925926}
confusion matrix:
      0  1
0  5944  2
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_8.png
better model found
persisted
after epoch: 8,now: 2024-07-02 20:01:10.140205,epoch time: 0:57:00.299500,used: 7:46:37.295313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99799407, 'precision': 0.99847394, 'recall': 0.99623024, 'specificity': 0.99623024, 'f1': 0.9973457, 'auroc': 0.9998896, 'binary_precision': 0.99944144, 'binary_recall': 0.9926491, 'binary_specificity': 0.99981135, 'binary_f1_score': 0.9960337}
confusion matrix:
       0      1
0  42404      8
1    106  14314
---- Validation: 
scalar performance:
{'acc': 0.9677161, 'precision': 0.7711654, 'recall': 0.72075367, 'specificity': 0.72075367, 'f1': 0.7430961, 'auroc': 0.9519824, 'binary_precision': 0.5625, 'binary_recall': 0.45468053, 'binary_specificity': 0.98682684, 'binary_f1_score': 0.5028759}
confusion matrix:
       0    1
0  17829  238
1    367  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9429584, 'precision': 0.637299, 'recall': 0.62818056, 'specificity': 0.62818056, 'f1': 0.6325489, 'auroc': 0.92851365, 'binary_precision': 0.30578512, 'binary_recall': 0.2846154, 'binary_specificity': 0.9717457, 'binary_f1_score': 0.29482073}
confusion matrix:
      0    1
0  5778  168
1   186   74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_9.png
early stop counter: 1
val acc:0.9677160978317261, best validation acc: 0.9729455709457397, corresponding to test acc:                         0.9590718746185303 / 0.9774411916732788
after epoch: 9,now: 2024-07-02 20:57:56.774920,epoch time: 0:56:46.634715,used: 8:43:23.930028,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99776536, 'precision': 0.9980204, 'recall': 0.9960767, 'specificity': 0.9960767, 'f1': 0.9970437, 'auroc': 0.999856, 'binary_precision': 0.998535, 'binary_recall': 0.9926486, 'binary_specificity': 0.99950486, 'binary_f1_score': 0.9955831}
confusion matrix:
       0      1
0  42392     21
1    106  14313
---- Validation: 
scalar performance:
{'acc': 0.974333, 'precision': 0.8043442, 'recall': 0.86437774, 'specificity': 0.86437774, 'f1': 0.8313656, 'auroc': 0.9670088, 'binary_precision': 0.6182266, 'binary_recall': 0.7459138, 'binary_specificity': 0.9828417, 'binary_f1_score': 0.67609423}
confusion matrix:
       0    1
0  17757  310
1    171  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.81623256, 'recall': 0.65792257, 'specificity': 0.65792257, 'f1': 0.7079482, 'auroc': 0.9503275, 'binary_precision': 0.6614173, 'binary_recall': 0.32307693, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.43410853}
confusion matrix:
      0   1
0  5903  43
1   176  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_10.png
better model found
persisted
after epoch: 10,now: 2024-07-02 21:54:38.501350,epoch time: 0:56:41.726430,used: 9:40:05.656458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99681515, 'precision': 0.9973614, 'recall': 0.9942271, 'specificity': 0.9942271, 'f1': 0.99578166, 'auroc': 0.99982727, 'binary_precision': 0.9984596, 'binary_recall': 0.9889729, 'binary_specificity': 0.9994813, 'binary_f1_score': 0.9936936}
confusion matrix:
       0      1
0  42391     22
1    159  14260
---- Validation: 
scalar performance:
{'acc': 0.9716115, 'precision': 0.8868954, 'recall': 0.63837236, 'specificity': 0.63837236, 'f1': 0.6997751, 'auroc': 0.9574478, 'binary_precision': 0.8, 'binary_recall': 0.2793462, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.41409692}
confusion matrix:
       0    1
0  18020   47
1    485  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7717702, 'recall': 0.52608216, 'specificity': 0.52608216, 'f1': 0.5387417, 'auroc': 0.95666283, 'binary_precision': 0.5833333, 'binary_recall': 0.053846154, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.098591544}
confusion matrix:
      0   1
0  5936  10
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_11.png
early stop counter: 1
val acc:0.971611499786377, best validation acc: 0.9743329882621765, corresponding to test acc:                         0.9647115468978882 / 0.9774411916732788
after epoch: 11,now: 2024-07-02 22:52:25.715535,epoch time: 0:57:47.214185,used: 10:37:52.870643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99773014, 'precision': 0.9978585, 'recall': 0.9961449, 'specificity': 0.9961449, 'f1': 0.99699795, 'auroc': 0.9998497, 'binary_precision': 0.9981178, 'binary_recall': 0.9929265, 'binary_specificity': 0.99936336, 'binary_f1_score': 0.99551535}
confusion matrix:
       0      1
0  42385     27
1    102  14318
---- Validation: 
scalar performance:
{'acc': 0.97844183, 'precision': 0.8768478, 'recall': 0.7821071, 'specificity': 0.7821071, 'f1': 0.82208157, 'auroc': 0.96623844, 'binary_precision': 0.76953906, 'binary_recall': 0.57057947, 'binary_specificity': 0.9936348, 'binary_f1_score': 0.65529007}
confusion matrix:
       0    1
0  17952  115
1    289  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7384599, 'recall': 0.57372767, 'specificity': 0.57372767, 'f1': 0.6076591, 'auroc': 0.95978034, 'binary_precision': 0.51282054, 'binary_recall': 0.15384616, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.23668641}
confusion matrix:
      0   1
0  5908  38
1   220  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_12.png
better model found
persisted
after epoch: 12,now: 2024-07-02 23:51:03.548809,epoch time: 0:58:37.833274,used: 11:36:30.703917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9978005, 'precision': 0.9982983, 'recall': 0.9958941, 'specificity': 0.9958941, 'f1': 0.9970888, 'auroc': 0.9999017, 'binary_precision': 0.9993013, 'binary_recall': 0.9920239, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.9956493}
confusion matrix:
       0      1
0  42404     10
1    115  14303
---- Validation: 
scalar performance:
{'acc': 0.9727321, 'precision': 0.88762856, 'recall': 0.658981, 'specificity': 0.658981, 'f1': 0.7220633, 'auroc': 0.9713192, 'binary_precision': 0.8, 'binary_recall': 0.32095096, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.45811242}
confusion matrix:
       0    1
0  18013   54
1    457  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7858188, 'recall': 0.5467315, 'specificity': 0.5467315, 'f1': 0.572694, 'auroc': 0.9601411, 'binary_precision': 0.6097561, 'binary_recall': 0.09615385, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.16611296}
confusion matrix:
      0   1
0  5930  16
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_13.png
early stop counter: 1
val acc:0.9727321267127991, best validation acc: 0.9784418344497681, corresponding to test acc:                         0.9584273099899292 / 0.9774411916732788
after epoch: 13,now: 2024-07-03 00:49:33.708593,epoch time: 0:58:30.159784,used: 12:35:00.863701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9982228, 'precision': 0.99782383, 'recall': 0.9974818, 'specificity': 0.9974818, 'f1': 0.99765265, 'auroc': 0.99990577, 'binary_precision': 0.9970147, 'binary_recall': 0.9959775, 'binary_specificity': 0.9989862, 'binary_f1_score': 0.99649584}
confusion matrix:
       0      1
0  42370     43
1     58  14361
---- Validation: 
scalar performance:
{'acc': 0.9717716, 'precision': 0.7870786, 'recall': 0.8630493, 'specificity': 0.8630493, 'f1': 0.8201044, 'auroc': 0.9693197, 'binary_precision': 0.5837209, 'binary_recall': 0.7459138, 'binary_specificity': 0.98018485, 'binary_f1_score': 0.654925}
confusion matrix:
       0    1
0  17709  358
1    171  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.75905913, 'recall': 0.79784274, 'specificity': 0.79784274, 'f1': 0.776904, 'auroc': 0.94725347, 'binary_precision': 0.53488374, 'binary_recall': 0.61923075, 'binary_specificity': 0.97645473, 'binary_f1_score': 0.573975}
confusion matrix:
      0    1
0  5806  140
1    99  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_14.png
early stop counter: 2
val acc:0.9717715978622437, best validation acc: 0.9784418344497681, corresponding to test acc:                         0.9584273099899292 / 0.9774411916732788
after epoch: 14,now: 2024-07-03 01:48:03.727781,epoch time: 0:58:30.019188,used: 13:33:30.882889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9976246, 'precision': 0.998088, 'recall': 0.99563885, 'specificity': 0.99563885, 'f1': 0.99685574, 'auroc': 0.9998226, 'binary_precision': 0.9990217, 'binary_recall': 0.9916077, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.99530095}
confusion matrix:
       0      1
0  42400     14
1    121  14297
---- Validation: 
scalar performance:
{'acc': 0.976841, 'precision': 0.9350256, 'recall': 0.701167, 'specificity': 0.701167, 'f1': 0.7721737, 'auroc': 0.96557003, 'binary_precision': 0.89180326, 'binary_recall': 0.40416047, 'binary_specificity': 0.9981735, 'binary_f1_score': 0.55623716}
confusion matrix:
       0    1
0  18034   33
1    401  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.924112, 'recall': 0.5153005, 'specificity': 0.5153005, 'f1': 0.5193222, 'auroc': 0.9450785, 'binary_precision': 0.8888889, 'binary_recall': 0.03076923, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.059479553}
confusion matrix:
      0  1
0  5945  1
1   252  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_15.png
early stop counter: 3
val acc:0.9768409729003906, best validation acc: 0.9784418344497681, corresponding to test acc:                         0.9584273099899292 / 0.9774411916732788
after epoch: 15,now: 2024-07-03 02:47:01.117003,epoch time: 0:58:57.389222,used: 14:32:28.272111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9983108, 'precision': 0.9981568, 'recall': 0.99738044, 'specificity': 0.99738044, 'f1': 0.9977678, 'auroc': 0.9999137, 'binary_precision': 0.9978448, 'binary_recall': 0.99549174, 'binary_specificity': 0.9992691, 'binary_f1_score': 0.9966669}
confusion matrix:
       0      1
0  42383     31
1     65  14353
---- Validation: 
scalar performance:
{'acc': 0.97171825, 'precision': 0.9476189, 'recall': 0.6155392, 'specificity': 0.6155392, 'f1': 0.67804027, 'auroc': 0.9733715, 'binary_precision': 0.9230769, 'binary_recall': 0.23179792, 'binary_specificity': 0.99928045, 'binary_f1_score': 0.37054634}
confusion matrix:
       0    1
0  18054   13
1    517  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.4790424, 'recall': 0.49974772, 'specificity': 0.49974772, 'f1': 0.48917606, 'auroc': 0.96185607, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5943  3
1   260  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629056_16.png
early stop counter: 4
val acc:0.9717182517051697, best validation acc: 0.9784418344497681, corresponding to test acc:                         0.9584273099899292 / 0.9774411916732788
after epoch: 16,now: 2024-07-03 03:45:37.975869,epoch time: 0:58:36.858866,used: 15:31:05.130977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_12_14_32_seed_1_21629056
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21629056 ON supergpu03 CANCELLED AT 2024-07-03T03:58:22 DUE TO TIME LIMIT ***
