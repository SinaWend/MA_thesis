Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul  1 03:15:47 2024]
rule parameter_sampling:
    input: /ictstr01/home/aih/sina.wendrich/MA_thesis/conf/CAMELYON_benchmark.yaml
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/hyperparameters.csv
    jobid: 1
    reason: Missing output files: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/hyperparameters.csv
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal




!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
[Mon Jul  1 03:16:49 2024]
Finished job 1.
1 of 2 steps (50%) done
Select jobs to execute...

[Mon Jul  1 03:16:49 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054

 Experiment start at: 2024-07-01 03:23:39.499410
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9883941, 'precision': 0.9912889, 'recall': 0.9784383, 'specificity': 0.9784383, 'f1': 0.98464465, 'auroc': 0.99890846, 'binary_precision': 0.9970293, 'binary_recall': 0.957869, 'binary_specificity': 0.99900764, 'binary_f1_score': 0.9770569}
confusion matrix:
       0      1
0  42282     42
1    620  14096
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96599615, 'precision': 0.74350005, 'recall': 0.7678799, 'specificity': 0.7678799, 'f1': 0.7550397, 'auroc': 0.9434837, 'binary_precision': 0.5028169, 'binary_recall': 0.55520993, 'binary_specificity': 0.9805499, 'binary_f1_score': 0.5277162}
confusion matrix:
       0    1
0  17796  353
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97347397, 'precision': 0.8346977, 'recall': 0.8322437, 'specificity': 0.8322437, 'f1': 0.83346564, 'auroc': 0.9318521, 'binary_precision': 0.6833977, 'binary_recall': 0.6781609, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.6807692}
confusion matrix:
      0    1
0  5915   82
1    84  177
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-01 03:46:12.873401,epoch time: 0:22:33.373991,used: 0:22:33.373991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9936711, 'precision': 0.99362683, 'recall': 0.98981774, 'specificity': 0.98981774, 'f1': 0.9917029, 'auroc': 0.99937403, 'binary_precision': 0.9935364, 'binary_recall': 0.98185647, 'binary_specificity': 0.997779, 'binary_f1_score': 0.98766196}
confusion matrix:
       0      1
0  42230     94
1    267  14449
---- Validation: 
scalar performance:
{'acc': 0.9404534, 'precision': 0.66142154, 'recall': 0.84166247, 'specificity': 0.84166247, 'f1': 0.71330357, 'auroc': 0.93267083, 'binary_precision': 0.3326301, 'binary_recall': 0.7356143, 'binary_specificity': 0.94771063, 'binary_f1_score': 0.45811135}
confusion matrix:
       0    1
0  17200  949
1    170  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91754556, 'precision': 0.64875233, 'recall': 0.8525355, 'specificity': 0.8525355, 'f1': 0.6985225, 'auroc': 0.91213566, 'binary_precision': 0.30769232, 'binary_recall': 0.7816092, 'binary_specificity': 0.92346174, 'binary_f1_score': 0.44155848}
confusion matrix:
      0    1
0  5538  459
1    57  204
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_2.png
early stop counter: 1
val acc:0.9404534101486206, best validation acc: 0.9659961462020874, corresponding to test acc:                         0.9734739661216736 / 0.9734739661216736
after epoch: 2,now: 2024-07-01 04:07:47.447767,epoch time: 0:21:34.574366,used: 0:44:07.948357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99293476, 'precision': 0.99000037, 'recall': 0.9915819, 'specificity': 0.9915819, 'f1': 0.99078774, 'auroc': 0.99952024, 'binary_precision': 0.98390585, 'binary_recall': 0.98878694, 'binary_specificity': 0.99437684, 'binary_f1_score': 0.9863404}
confusion matrix:
       0      1
0  42087    238
1    165  14550
---- Validation: 
scalar performance:
{'acc': 0.97153044, 'precision': 0.7865714, 'recall': 0.7714951, 'specificity': 0.7714951, 'f1': 0.7788086, 'auroc': 0.9548787, 'binary_precision': 0.5888158, 'binary_recall': 0.55676514, 'binary_specificity': 0.9862251, 'binary_f1_score': 0.5723421}
confusion matrix:
       0    1
0  17899  250
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.9133893, 'recall': 0.65783656, 'specificity': 0.65783656, 'f1': 0.7239476, 'auroc': 0.94424593, 'binary_precision': 0.8556701, 'binary_recall': 0.31800765, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.46368715}
confusion matrix:
      0   1
0  5983  14
1   178  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_3.png
better model found
persisted
after epoch: 3,now: 2024-07-01 04:29:28.333683,epoch time: 0:21:40.885916,used: 1:05:48.834273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98902524, 'precision': 0.99244666, 'recall': 0.97897863, 'specificity': 0.97897863, 'f1': 0.985473, 'auroc': 0.99899095, 'binary_precision': 0.99922067, 'binary_recall': 0.95821726, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.9782895}
confusion matrix:
       0      1
0  42310     11
1    615  14104
---- Validation: 
scalar performance:
{'acc': 0.9709983, 'precision': 0.85572314, 'recall': 0.6167083, 'specificity': 0.6167083, 'f1': 0.6716162, 'auroc': 0.94417405, 'binary_precision': 0.7378641, 'binary_recall': 0.23639192, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.35806835}
confusion matrix:
       0    1
0  18095   54
1    491  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.94820714, 'recall': 0.5782939, 'specificity': 0.5782939, 'f1': 0.6252951, 'auroc': 0.93831015, 'binary_precision': 0.9318182, 'binary_recall': 0.15708812, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.26885244}
confusion matrix:
      0   1
0  5994   3
1   220  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_4.png
early stop counter: 1
val acc:0.9709982872009277, best validation acc: 0.9715304374694824, corresponding to test acc:                         0.9693192839622498 / 0.9734739661216736
after epoch: 4,now: 2024-07-01 04:51:07.330173,epoch time: 0:21:38.996490,used: 1:27:27.830763,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9946879, 'precision': 0.9959397, 'recall': 0.99019265, 'specificity': 0.99019265, 'f1': 0.99302256, 'auroc': 0.99941003, 'binary_precision': 0.99847823, 'binary_recall': 0.9809051, 'binary_specificity': 0.9994802, 'binary_f1_score': 0.9896137}
confusion matrix:
       0      1
0  42302     22
1    281  14435
---- Validation: 
scalar performance:
{'acc': 0.9759472, 'precision': 0.8503056, 'recall': 0.74077934, 'specificity': 0.74077934, 'f1': 0.78454965, 'auroc': 0.9568805, 'binary_precision': 0.7185355, 'binary_recall': 0.48833594, 'binary_specificity': 0.9932228, 'binary_f1_score': 0.5814815}
confusion matrix:
       0    1
0  18026  123
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9707574, 'precision': 0.95231843, 'recall': 0.6604193, 'specificity': 0.6604193, 'f1': 0.73179466, 'auroc': 0.9462805, 'binary_precision': 0.93333334, 'binary_recall': 0.3218391, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.47863245}
confusion matrix:
      0   1
0  5991   6
1   177  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_5.png
better model found
persisted
after epoch: 5,now: 2024-07-01 05:12:39.617070,epoch time: 0:21:32.286897,used: 1:49:00.117660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9948633, 'precision': 0.9918602, 'recall': 0.99478805, 'specificity': 0.99478805, 'f1': 0.9933126, 'auroc': 0.9997697, 'binary_precision': 0.9855931, 'binary_recall': 0.9946328, 'binary_specificity': 0.9949434, 'binary_f1_score': 0.99009234}
confusion matrix:
       0      1
0  42107    214
1     79  14640
---- Validation: 
scalar performance:
{'acc': 0.95540655, 'precision': 0.7012078, 'recall': 0.84040326, 'specificity': 0.84040326, 'f1': 0.7502358, 'auroc': 0.94613075, 'binary_precision': 0.41271263, 'binary_recall': 0.7169518, 'binary_specificity': 0.96385473, 'binary_f1_score': 0.5238637}
confusion matrix:
       0    1
0  17493  656
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9487057, 'precision': 0.70859605, 'recall': 0.83397925, 'specificity': 0.83397925, 'f1': 0.75415504, 'auroc': 0.9215259, 'binary_precision': 0.43023255, 'binary_recall': 0.70881224, 'binary_specificity': 0.95914626, 'binary_f1_score': 0.5354559}
confusion matrix:
      0    1
0  5752  245
1    76  185
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_6.png
early stop counter: 1
val acc:0.9554065465927124, best validation acc: 0.9759472012519836, corresponding to test acc:                         0.9707574248313904 / 0.9734739661216736
after epoch: 6,now: 2024-07-01 05:33:55.803633,epoch time: 0:21:16.186563,used: 2:10:16.304223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9953541, 'precision': 0.9958194, 'recall': 0.99203837, 'specificity': 0.99203837, 'f1': 0.99390996, 'auroc': 0.999699, 'binary_precision': 0.9967689, 'binary_recall': 0.9851872, 'binary_specificity': 0.9988895, 'binary_f1_score': 0.9909442}
confusion matrix:
       0      1
0  42276     47
1    218  14499
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.793892, 'recall': 0.6208842, 'specificity': 0.6208842, 'f1': 0.6683146, 'auroc': 0.9509583, 'binary_precision': 0.6138996, 'binary_recall': 0.24727838, 'binary_specificity': 0.99449, 'binary_f1_score': 0.35254985}
confusion matrix:
       0    1
0  18049  100
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9539789, 'precision': 0.64772546, 'recall': 0.5472219, 'specificity': 0.5472219, 'f1': 0.5671189, 'auroc': 0.9071777, 'binary_precision': 0.33333334, 'binary_recall': 0.10344828, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.15789475}
confusion matrix:
      0   1
0  5943  54
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_7.png
early stop counter: 2
val acc:0.9689229726791382, best validation acc: 0.9759472012519836, corresponding to test acc:                         0.9707574248313904 / 0.9734739661216736
after epoch: 7,now: 2024-07-01 05:55:23.342466,epoch time: 0:21:27.538833,used: 2:31:43.843056,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9960905, 'precision': 0.99724233, 'recall': 0.9925562, 'specificity': 0.9925562, 'f1': 0.9948703, 'auroc': 0.99970967, 'binary_precision': 0.99958634, 'binary_recall': 0.98525417, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.9923685}
confusion matrix:
       0      1
0  42318      6
1    217  14499
---- Validation: 
scalar performance:
{'acc': 0.9765858, 'precision': 0.86789596, 'recall': 0.73135924, 'specificity': 0.73135924, 'f1': 0.78284705, 'auroc': 0.96326816, 'binary_precision': 0.75438595, 'binary_recall': 0.4681182, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.5777351}
confusion matrix:
       0    1
0  18051   98
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8992585, 'recall': 0.58545655, 'specificity': 0.58545655, 'f1': 0.6336366, 'auroc': 0.9524037, 'binary_precision': 0.8333333, 'binary_recall': 0.1724138, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2857143}
confusion matrix:
      0   1
0  5988   9
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_8.png
better model found
persisted
after epoch: 8,now: 2024-07-01 06:16:57.046119,epoch time: 0:21:33.703653,used: 2:53:17.546709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9953892, 'precision': 0.99654555, 'recall': 0.9914188, 'specificity': 0.9914188, 'f1': 0.99394745, 'auroc': 0.9997688, 'binary_precision': 0.9988954, 'binary_recall': 0.9832156, 'binary_specificity': 0.999622, 'binary_f1_score': 0.99099344}
confusion matrix:
       0      1
0  42308     16
1    247  14469
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.93975383, 'recall': 0.5697365, 'specificity': 0.5697365, 'f1': 0.6136666, 'auroc': 0.9610245, 'binary_precision': 0.90909094, 'binary_recall': 0.1399689, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.2425876}
confusion matrix:
       0   1
0  18140   9
1    553  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.84338665, 'recall': 0.51507556, 'specificity': 0.51507556, 'f1': 0.5189576, 'auroc': 0.9289608, 'binary_precision': 0.72727275, 'binary_recall': 0.03065134, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.058823526}
confusion matrix:
      0  1
0  5994  3
1   253  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_9.png
early stop counter: 1
val acc:0.9700936675071716, best validation acc: 0.9765858054161072, corresponding to test acc:                         0.9640460014343262 / 0.9734739661216736
after epoch: 9,now: 2024-07-01 06:38:25.023009,epoch time: 0:21:27.976890,used: 3:14:45.523599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9953892, 'precision': 0.9968661, 'recall': 0.99110967, 'specificity': 0.99110967, 'f1': 0.99394417, 'auroc': 0.9997834, 'binary_precision': 0.99986166, 'binary_recall': 0.9822666, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99098605}
confusion matrix:
       0      1
0  42320      2
1    261  14457
---- Validation: 
scalar performance:
{'acc': 0.9765326, 'precision': 0.9014152, 'recall': 0.6983292, 'specificity': 0.6983292, 'f1': 0.76309013, 'auroc': 0.96446824, 'binary_precision': 0.82371795, 'binary_recall': 0.39968896, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.53821987}
confusion matrix:
       0    1
0  18094   55
1    386  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.92687345, 'recall': 0.64476013, 'specificity': 0.64476013, 'f1': 0.711008, 'auroc': 0.9520416, 'binary_precision': 0.88372093, 'binary_recall': 0.29118773, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.43804035}
confusion matrix:
      0   1
0  5987  10
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_10.png
early stop counter: 2
val acc:0.9765325784683228, best validation acc: 0.9765858054161072, corresponding to test acc:                         0.9640460014343262 / 0.9734739661216736
after epoch: 10,now: 2024-07-01 07:00:00.410508,epoch time: 0:21:35.387499,used: 3:36:20.911098,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99426717, 'precision': 0.99565864, 'recall': 0.98937726, 'specificity': 0.98937726, 'f1': 0.99246573, 'auroc': 0.9996247, 'binary_precision': 0.99847573, 'binary_recall': 0.9792743, 'binary_specificity': 0.9994802, 'binary_f1_score': 0.98878175}
confusion matrix:
       0      1
0  42302     22
1    305  14411
---- Validation: 
scalar performance:
{'acc': 0.9741911, 'precision': 0.8836655, 'recall': 0.6656147, 'specificity': 0.6656147, 'f1': 0.72835946, 'auroc': 0.96458435, 'binary_precision': 0.79044116, 'binary_recall': 0.33437014, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.46994537}
confusion matrix:
       0    1
0  18092   57
1    428  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.91373444, 'recall': 0.6483414, 'specificity': 0.6483414, 'f1': 0.71353436, 'auroc': 0.9645155, 'binary_precision': 0.85714287, 'binary_recall': 0.29885057, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.4431818}
confusion matrix:
      0   1
0  5984  13
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_11.png
early stop counter: 3
val acc:0.9741911292076111, best validation acc: 0.9765858054161072, corresponding to test acc:                         0.9640460014343262 / 0.9734739661216736
after epoch: 11,now: 2024-07-01 07:21:19.920279,epoch time: 0:21:19.509771,used: 3:57:40.420869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99568725, 'precision': 0.99685884, 'recall': 0.99188614, 'specificity': 0.99188614, 'f1': 0.9943398, 'auroc': 0.9997425, 'binary_precision': 0.999241, 'binary_recall': 0.9840321, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.9915782}
confusion matrix:
       0      1
0  42312     11
1    235  14482
---- Validation: 
scalar performance:
{'acc': 0.9782354, 'precision': 0.85604006, 'recall': 0.78771734, 'specificity': 0.78771734, 'f1': 0.8179405, 'auroc': 0.96757305, 'binary_precision': 0.7267442, 'binary_recall': 0.58320373, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.64710957}
confusion matrix:
       0    1
0  18008  141
1    268  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.86633766, 'recall': 0.6681636, 'specificity': 0.6681636, 'f1': 0.7272111, 'auroc': 0.95498323, 'binary_precision': 0.7606838, 'binary_recall': 0.34099618, 'binary_specificity': 0.995331, 'binary_f1_score': 0.4708995}
confusion matrix:
      0   1
0  5969  28
1   172  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_12.png
better model found
persisted
after epoch: 12,now: 2024-07-01 07:42:50.586962,epoch time: 0:21:30.666683,used: 4:19:11.087552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98825383, 'precision': 0.9789599, 'recall': 0.9911761, 'specificity': 0.9911761, 'f1': 0.9848562, 'auroc': 0.9997824, 'binary_precision': 0.9589023, 'binary_recall': 0.9972141, 'binary_specificity': 0.9851381, 'binary_f1_score': 0.977683}
confusion matrix:
       0      1
0  41694    629
1     41  14676
---- Validation: 
scalar performance:
{'acc': 0.82428694, 'precision': 0.5771565, 'recall': 0.8820288, 'specificity': 0.8820288, 'f1': 0.5844835, 'auroc': 0.9486189, 'binary_precision': 0.15672605, 'binary_recall': 0.94401246, 'binary_specificity': 0.8200452, 'binary_f1_score': 0.26882195}
confusion matrix:
       0     1
0  14883  3266
1     36   607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87088525, 'precision': 0.6151916, 'recall': 0.8959863, 'specificity': 0.8959863, 'f1': 0.65083385, 'auroc': 0.947997, 'binary_precision': 0.23420797, 'binary_recall': 0.9233717, 'binary_specificity': 0.86860096, 'binary_f1_score': 0.37364343}
confusion matrix:
      0    1
0  5209  788
1    20  241
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_13.png
early stop counter: 1
val acc:0.824286937713623, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 13,now: 2024-07-01 08:04:16.250071,epoch time: 0:21:25.663109,used: 4:40:36.750661,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99710727, 'precision': 0.997517, 'recall': 0.9949267, 'specificity': 0.9949267, 'f1': 0.99621296, 'auroc': 0.9998568, 'binary_precision': 0.9983564, 'binary_recall': 0.9904205, 'binary_specificity': 0.9994329, 'binary_f1_score': 0.9943726}
confusion matrix:
       0      1
0  42297     24
1    141  14578
---- Validation: 
scalar performance:
{'acc': 0.9731269, 'precision': 0.82902837, 'recall': 0.7003163, 'specificity': 0.7003163, 'f1': 0.7477087, 'auroc': 0.95564926, 'binary_precision': 0.6787565, 'binary_recall': 0.407465, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.5092323}
confusion matrix:
       0    1
0  18025  124
1    381  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.79962337, 'recall': 0.5747107, 'specificity': 0.5747107, 'f1': 0.6134502, 'auroc': 0.9469665, 'binary_precision': 0.63492066, 'binary_recall': 0.1532567, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.24691357}
confusion matrix:
      0   1
0  5974  23
1   221  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_14.png
early stop counter: 2
val acc:0.9731268882751465, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 14,now: 2024-07-01 08:25:42.809574,epoch time: 0:21:26.559503,used: 5:02:03.310164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99712485, 'precision': 0.9971265, 'recall': 0.9953581, 'specificity': 0.9953581, 'f1': 0.99623823, 'auroc': 0.9998052, 'binary_precision': 0.99713, 'binary_recall': 0.9917086, 'binary_specificity': 0.9990077, 'binary_f1_score': 0.9944119}
confusion matrix:
       0      1
0  42284     42
1    122  14592
---- Validation: 
scalar performance:
{'acc': 0.972914, 'precision': 0.8136808, 'recall': 0.725708, 'specificity': 0.725708, 'f1': 0.7618706, 'auroc': 0.9581084, 'binary_precision': 0.6462882, 'binary_recall': 0.46034214, 'binary_specificity': 0.9910739, 'binary_f1_score': 0.537693}
confusion matrix:
       0    1
0  17987  162
1    347  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.81642395, 'recall': 0.59744906, 'specificity': 0.59744906, 'f1': 0.643743, 'auroc': 0.9516882, 'binary_precision': 0.6666667, 'binary_recall': 0.19923371, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.30678466}
confusion matrix:
      0   1
0  5971  26
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_15.png
early stop counter: 3
val acc:0.9729139804840088, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 15,now: 2024-07-01 08:47:07.026837,epoch time: 0:21:24.217263,used: 5:23:27.527427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.996967, 'precision': 0.9970422, 'recall': 0.9950304, 'specificity': 0.9950304, 'f1': 0.996031, 'auroc': 0.99973905, 'binary_precision': 0.9971964, 'binary_recall': 0.99102956, 'binary_specificity': 0.9990313, 'binary_f1_score': 0.99410343}
confusion matrix:
       0      1
0  42284     41
1    132  14583
---- Validation: 
scalar performance:
{'acc': 0.9755215, 'precision': 0.8828069, 'recall': 0.6933055, 'specificity': 0.6933055, 'f1': 0.7546344, 'auroc': 0.9563352, 'binary_precision': 0.7868339, 'binary_recall': 0.3903577, 'binary_specificity': 0.99625325, 'binary_f1_score': 0.52182955}
confusion matrix:
       0    1
0  18081   68
1    392  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.89431787, 'recall': 0.62143815, 'specificity': 0.62143815, 'f1': 0.68012667, 'auroc': 0.9580116, 'binary_precision': 0.82051283, 'binary_recall': 0.24521072, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.37758112}
confusion matrix:
      0   1
0  5983  14
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_16.png
early stop counter: 4
val acc:0.9755215048789978, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 16,now: 2024-07-01 09:08:33.971586,epoch time: 0:21:26.944749,used: 5:44:54.472176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9938464, 'precision': 0.9958874, 'recall': 0.988075, 'specificity': 0.988075, 'f1': 0.9919008, 'auroc': 0.9997896, 'binary_precision': 1.0, 'binary_recall': 0.97615004, 'binary_specificity': 1.0, 'binary_f1_score': 0.9879311}
confusion matrix:
       0      1
0  42323      0
1    351  14366
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.96948034, 'recall': 0.52641106, 'specificity': 0.52641106, 'f1': 0.54188323, 'auroc': 0.96434623, 'binary_precision': 0.9714286, 'binary_recall': 0.05287714, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.100294985}
confusion matrix:
       0   1
0  18148   1
1    609  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.959085, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_17.png
early stop counter: 5
val acc:0.967539370059967, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 17,now: 2024-07-01 09:29:57.151156,epoch time: 0:21:23.179570,used: 6:06:17.651746,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9963359, 'precision': 0.9973835, 'recall': 0.993055, 'specificity': 0.993055, 'f1': 0.99519444, 'auroc': 0.99989086, 'binary_precision': 0.999518, 'binary_recall': 0.9862753, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.99285245}
confusion matrix:
       0      1
0  42315      7
1    202  14516
---- Validation: 
scalar performance:
{'acc': 0.9707322, 'precision': 0.810205, 'recall': 0.6585736, 'specificity': 0.6585736, 'f1': 0.70781094, 'auroc': 0.9518258, 'binary_precision': 0.64396286, 'binary_recall': 0.32348368, 'binary_specificity': 0.99366355, 'binary_f1_score': 0.4306418}
confusion matrix:
       0    1
0  18034  115
1    435  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9541387, 'precision': 0.64981186, 'recall': 0.5473053, 'specificity': 0.5473053, 'f1': 0.56739247, 'auroc': 0.9310113, 'binary_precision': 0.3375, 'binary_recall': 0.10344828, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.15835777}
confusion matrix:
      0   1
0  5944  53
1   234  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_18.png
early stop counter: 6
val acc:0.9707322120666504, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 18,now: 2024-07-01 09:51:22.730792,epoch time: 0:21:25.579636,used: 6:27:43.231382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9965989, 'precision': 0.9956889, 'recall': 0.9954251, 'specificity': 0.9954251, 'f1': 0.99555695, 'auroc': 0.9998462, 'binary_precision': 0.9938108, 'binary_recall': 0.9930003, 'binary_specificity': 0.99784994, 'binary_f1_score': 0.99340534}
confusion matrix:
       0      1
0  42234     91
1    103  14612
---- Validation: 
scalar performance:
{'acc': 0.97344613, 'precision': 0.79372096, 'recall': 0.83099127, 'specificity': 0.83099127, 'f1': 0.8111263, 'auroc': 0.96662533, 'binary_precision': 0.5989011, 'binary_recall': 0.67807156, 'binary_specificity': 0.983911, 'binary_f1_score': 0.6360321}
confusion matrix:
       0    1
0  17857  292
1    207  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.775514, 'recall': 0.6243505, 'specificity': 0.6243505, 'f1': 0.66822445, 'auroc': 0.9490614, 'binary_precision': 0.5826087, 'binary_recall': 0.256705, 'binary_specificity': 0.991996, 'binary_f1_score': 0.356383}
confusion matrix:
      0   1
0  5949  48
1   194  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_19.png
early stop counter: 7
val acc:0.9734461307525635, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 19,now: 2024-07-01 10:12:52.224007,epoch time: 0:21:29.493215,used: 6:49:12.724597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9960554, 'precision': 0.9973104, 'recall': 0.99239856, 'specificity': 0.99239856, 'f1': 0.9948227, 'auroc': 0.99984086, 'binary_precision': 0.999862, 'binary_recall': 0.9848444, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9922964}
confusion matrix:
       0      1
0  42324      2
1    223  14491
---- Validation: 
scalar performance:
{'acc': 0.9728076, 'precision': 0.8847999, 'recall': 0.6371464, 'specificity': 0.6371464, 'f1': 0.698347, 'auroc': 0.96400034, 'binary_precision': 0.79464287, 'binary_recall': 0.27682737, 'binary_specificity': 0.99746543, 'binary_f1_score': 0.41061127}
confusion matrix:
       0    1
0  18103   46
1    465  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8500357, 'recall': 0.5735454, 'specificity': 0.5735454, 'f1': 0.6145333, 'auroc': 0.96054935, 'binary_precision': 0.7358491, 'binary_recall': 0.14942528, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.24840763}
confusion matrix:
      0   1
0  5983  14
1   222  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_20.png
early stop counter: 8
val acc:0.9728075861930847, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 20,now: 2024-07-01 10:34:20.146188,epoch time: 0:21:27.922181,used: 7:10:40.646778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99708974, 'precision': 0.99782026, 'recall': 0.9945815, 'specificity': 0.9945815, 'f1': 0.99618703, 'auroc': 0.9998869, 'binary_precision': 0.99931365, 'binary_recall': 0.9893993, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.9943317}
confusion matrix:
       0      1
0  42314     10
1    156  14560
---- Validation: 
scalar performance:
{'acc': 0.97264796, 'precision': 0.9275652, 'recall': 0.61531216, 'specificity': 0.61531216, 'f1': 0.67650855, 'auroc': 0.9597358, 'binary_precision': 0.8816568, 'binary_recall': 0.23172629, 'binary_specificity': 0.998898, 'binary_f1_score': 0.36699513}
confusion matrix:
       0    1
0  18129   20
1    494  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.9454254, 'recall': 0.54964167, 'specificity': 0.54964167, 'f1': 0.58027375, 'auroc': 0.9522563, 'binary_precision': 0.9285714, 'binary_recall': 0.099616855, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.1799308}
confusion matrix:
      0   1
0  5995   2
1   235  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_21.png
early stop counter: 9
val acc:0.9726479649543762, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 21,now: 2024-07-01 10:55:38.079030,epoch time: 0:21:17.932842,used: 7:31:58.579620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.996406, 'precision': 0.9958645, 'recall': 0.9947416, 'specificity': 0.9947416, 'f1': 0.9953014, 'auroc': 0.99986637, 'binary_precision': 0.9947498, 'binary_recall': 0.99130255, 'binary_specificity': 0.9981807, 'binary_f1_score': 0.9930232}
confusion matrix:
       0      1
0  42246     77
1    128  14589
---- Validation: 
scalar performance:
{'acc': 0.9768519, 'precision': 0.84688616, 'recall': 0.76974976, 'specificity': 0.76974976, 'f1': 0.8030751, 'auroc': 0.9684319, 'binary_precision': 0.7096774, 'binary_recall': 0.5474339, 'binary_specificity': 0.99206567, 'binary_f1_score': 0.61808604}
confusion matrix:
       0    1
0  18005  144
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.8973372, 'recall': 0.5379807, 'specificity': 0.5379807, 'f1': 0.5601599, 'auroc': 0.9395234, 'binary_precision': 0.8333333, 'binary_recall': 0.07662835, 'binary_specificity': 0.999333, 'binary_f1_score': 0.14035088}
confusion matrix:
      0   1
0  5993   4
1   241  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_22.png
early stop counter: 10
val acc:0.9768518805503845, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 22,now: 2024-07-01 11:16:58.672178,epoch time: 0:21:20.593148,used: 7:53:19.172768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99617815, 'precision': 0.9974148, 'recall': 0.9926163, 'specificity': 0.9926163, 'f1': 0.9949852, 'auroc': 0.9998685, 'binary_precision': 0.99993104, 'binary_recall': 0.98525614, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99253935}
confusion matrix:
       0      1
0  42321      1
1    217  14501
---- Validation: 
scalar performance:
{'acc': 0.9729672, 'precision': 0.8901954, 'recall': 0.637229, 'specificity': 0.637229, 'f1': 0.6991013, 'auroc': 0.966732, 'binary_precision': 0.8054299, 'binary_recall': 0.27682737, 'binary_specificity': 0.9976307, 'binary_f1_score': 0.41203701}
confusion matrix:
       0    1
0  18106   43
1    465  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8795425, 'recall': 0.56629944, 'specificity': 0.56629944, 'f1': 0.6051316, 'auroc': 0.94780135, 'binary_precision': 0.79545456, 'binary_recall': 0.13409962, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2295082}
confusion matrix:
      0   1
0  5988   9
1   226  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_23.png
early stop counter: 11
val acc:0.9729672074317932, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 23,now: 2024-07-01 11:38:31.612324,epoch time: 0:21:32.940146,used: 8:14:52.112914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9981943, 'precision': 0.99845004, 'recall': 0.99683285, 'specificity': 0.99683285, 'f1': 0.997638, 'auroc': 0.9999293, 'binary_precision': 0.99897563, 'binary_recall': 0.9940201, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.99649173}
confusion matrix:
       0      1
0  42309     15
1     88  14628
---- Validation: 
scalar performance:
{'acc': 0.97754365, 'precision': 0.8456555, 'recall': 0.7903594, 'specificity': 0.7903594, 'f1': 0.81539035, 'auroc': 0.9683261, 'binary_precision': 0.7057728, 'binary_recall': 0.58942455, 'binary_specificity': 0.99129426, 'binary_f1_score': 0.6423729}
confusion matrix:
       0    1
0  17991  158
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.8024105, 'recall': 0.66433024, 'specificity': 0.66433024, 'f1': 0.710756, 'auroc': 0.9471749, 'binary_precision': 0.63309354, 'binary_recall': 0.33716476, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.44}
confusion matrix:
      0   1
0  5946  51
1   173  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_24.png
early stop counter: 12
val acc:0.9775436520576477, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 24,now: 2024-07-01 11:59:45.157852,epoch time: 0:21:13.545528,used: 8:36:05.658442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9981066, 'precision': 0.9981681, 'recall': 0.9968852, 'specificity': 0.9968852, 'f1': 0.9975245, 'auroc': 0.9999071, 'binary_precision': 0.9982948, 'binary_recall': 0.99436104, 'binary_specificity': 0.99940926, 'binary_f1_score': 0.99632406}
confusion matrix:
       0      1
0  42296     25
1     83  14636
---- Validation: 
scalar performance:
{'acc': 0.97376543, 'precision': 0.874258, 'recall': 0.66389424, 'specificity': 0.66389424, 'f1': 0.7250506, 'auroc': 0.96008205, 'binary_precision': 0.7717391, 'binary_recall': 0.33125973, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.46354732}
confusion matrix:
       0    1
0  18086   63
1    430  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.72960305, 'recall': 0.58053935, 'specificity': 0.58053935, 'f1': 0.61494654, 'auroc': 0.9354776, 'binary_precision': 0.49438202, 'binary_recall': 0.16858238, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.25142857}
confusion matrix:
      0   1
0  5952  45
1   217  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_25.png
early stop counter: 13
val acc:0.9737654328346252, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 25,now: 2024-07-01 12:21:15.988640,epoch time: 0:21:30.830788,used: 8:57:36.489230,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99824685, 'precision': 0.99757904, 'recall': 0.9978435, 'specificity': 0.9978435, 'f1': 0.99771124, 'auroc': 0.99993736, 'binary_precision': 0.996198, 'binary_recall': 0.99701023, 'binary_specificity': 0.99867684, 'binary_f1_score': 0.996604}
confusion matrix:
       0      1
0  42267     56
1     44  14673
---- Validation: 
scalar performance:
{'acc': 0.9703065, 'precision': 0.7686409, 'recall': 0.8991209, 'specificity': 0.8991209, 'f1': 0.8195946, 'auroc': 0.96753347, 'binary_precision': 0.54367936, 'binary_recall': 0.82270604, 'binary_specificity': 0.97553587, 'binary_f1_score': 0.65470296}
confusion matrix:
       0    1
0  17705  444
1    114  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.77488923, 'recall': 0.81291604, 'specificity': 0.81291604, 'f1': 0.7925017, 'auroc': 0.9574316, 'binary_precision': 0.5652174, 'binary_recall': 0.6475096, 'binary_specificity': 0.9783225, 'binary_f1_score': 0.6035714}
confusion matrix:
      0    1
0  5867  130
1    92  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_26.png
early stop counter: 14
val acc:0.9703065156936646, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 26,now: 2024-07-01 12:42:46.179037,epoch time: 0:21:30.190397,used: 9:19:06.679627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9983345, 'precision': 0.99836636, 'recall': 0.99728227, 'specificity': 0.99728227, 'f1': 0.99782276, 'auroc': 0.99995136, 'binary_precision': 0.99843204, 'binary_recall': 0.995108, 'binary_specificity': 0.9994565, 'binary_f1_score': 0.9967673}
confusion matrix:
       0      1
0  42299     23
1     72  14646
---- Validation: 
scalar performance:
{'acc': 0.9771179, 'precision': 0.8517641, 'recall': 0.7676374, 'specificity': 0.7676374, 'f1': 0.8034997, 'auroc': 0.96579874, 'binary_precision': 0.7195876, 'binary_recall': 0.5427683, 'binary_specificity': 0.99250644, 'binary_f1_score': 0.6187944}
confusion matrix:
       0    1
0  18013  136
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549377, 'precision': 0.690961, 'recall': 0.5935305, 'specificity': 0.5935305, 'f1': 0.623091, 'auroc': 0.9215056, 'binary_precision': 0.416, 'binary_recall': 0.19923371, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.26943004}
confusion matrix:
      0   1
0  5924  73
1   209  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_27.png
early stop counter: 15
val acc:0.9771178960800171, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 27,now: 2024-07-01 13:04:12.679988,epoch time: 0:21:26.500951,used: 9:40:33.180578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99805397, 'precision': 0.99766743, 'recall': 0.99724793, 'specificity': 0.99724793, 'f1': 0.9974575, 'auroc': 0.99996066, 'binary_precision': 0.9968699, 'binary_recall': 0.99558276, 'binary_specificity': 0.99891317, 'binary_f1_score': 0.99622595}
confusion matrix:
       0      1
0  42279     46
1     65  14650
---- Validation: 
scalar performance:
{'acc': 0.9608344, 'precision': 0.722622, 'recall': 0.84996384, 'specificity': 0.84996384, 'f1': 0.7701812, 'auroc': 0.9590342, 'binary_precision': 0.45498547, 'binary_recall': 0.7309487, 'binary_specificity': 0.968979, 'binary_f1_score': 0.56085914}
confusion matrix:
       0    1
0  17586  563
1    173  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92729306, 'precision': 0.62849367, 'recall': 0.71103466, 'specificity': 0.71103466, 'f1': 0.65712845, 'auroc': 0.9092653, 'binary_precision': 0.280543, 'binary_recall': 0.47509578, 'binary_specificity': 0.9469735, 'binary_f1_score': 0.35277382}
confusion matrix:
      0    1
0  5679  318
1   137  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_28.png
early stop counter: 16
val acc:0.9608343839645386, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 28,now: 2024-07-01 13:25:40.839180,epoch time: 0:21:28.159192,used: 10:02:01.339770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9981767, 'precision': 0.9982821, 'recall': 0.9969535, 'specificity': 0.9969535, 'f1': 0.99761546, 'auroc': 0.9998642, 'binary_precision': 0.9984986, 'binary_recall': 0.99442667, 'binary_specificity': 0.99948025, 'binary_f1_score': 0.9964585}
confusion matrix:
       0      1
0  42305     22
1     82  14631
---- Validation: 
scalar performance:
{'acc': 0.9752022, 'precision': 0.8345047, 'recall': 0.7493943, 'specificity': 0.7493943, 'f1': 0.7852026, 'auroc': 0.9586604, 'binary_precision': 0.6863158, 'binary_recall': 0.5069984, 'binary_specificity': 0.9917902, 'binary_f1_score': 0.58318424}
confusion matrix:
       0    1
0  18000  149
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.8350433, 'recall': 0.69356614, 'specificity': 0.69356614, 'f1': 0.74345016, 'auroc': 0.9549222, 'binary_precision': 0.6959459, 'binary_recall': 0.394636, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.5036675}
confusion matrix:
      0    1
0  5952   45
1   158  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_29.png
early stop counter: 17
val acc:0.975202202796936, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 29,now: 2024-07-01 13:47:15.982115,epoch time: 0:21:35.142935,used: 10:23:36.482705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99807155, 'precision': 0.9983674, 'recall': 0.996595, 'specificity': 0.996595, 'f1': 0.99747705, 'auroc': 0.999925, 'binary_precision': 0.99897516, 'binary_recall': 0.99354446, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.9962524}
confusion matrix:
       0      1
0  42309     15
1     95  14621
---- Validation: 
scalar performance:
{'acc': 0.97376543, 'precision': 0.9008411, 'recall': 0.6466429, 'specificity': 0.6466429, 'f1': 0.7109257, 'auroc': 0.96899563, 'binary_precision': 0.82608694, 'binary_recall': 0.29548988, 'binary_specificity': 0.997796, 'binary_f1_score': 0.43528065}
confusion matrix:
       0    1
0  18109   40
1    453  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.9478528, 'recall': 0.6221885, 'specificity': 0.6221885, 'f1': 0.6856512, 'auroc': 0.9615614, 'binary_precision': 0.92753625, 'binary_recall': 0.24521072, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.38787878}
confusion matrix:
      0   1
0  5992   5
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_30.png
early stop counter: 18
val acc:0.9737654328346252, best validation acc: 0.9782354235649109, corresponding to test acc:                         0.9680408835411072 / 0.9734739661216736
after epoch: 30,now: 2024-07-01 14:08:53.245589,epoch time: 0:21:37.263474,used: 10:45:13.746179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_03_23_39_seed_0_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:45:13.746179 at 2024-07-01 14:08:53.245589
persisted model performance metric: 

scalar performance:
{'acc': 0.9680409, 'precision': 0.86633766, 'recall': 0.6681636, 'specificity': 0.6681636, 'f1': 0.7272111, 'auroc': 0.95498323, 'binary_precision': 0.7606838, 'binary_recall': 0.34099618, 'binary_specificity': 0.995331, 'binary_f1_score': 0.4708995}
confusion matrix:
      0   1
0  5969  28
1   172  89
oracle model performance metric: 

scalar performance:
{'acc': 0.97347397, 'precision': 0.8346977, 'recall': 0.8322437, 'specificity': 0.8322437, 'f1': 0.83346564, 'auroc': 0.9318521, 'binary_precision': 0.6833977, 'binary_recall': 0.6781609, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.6807692}
confusion matrix:
      0    1
0  5915   82
1    84  177
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 319865 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool | 291597 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |  28268 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 319865 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool | 291597 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |  28268 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 314122 KiB |   6778 MiB |   1105 TiB |   1105 TiB |
|       from large pool | 286862 KiB |   6752 MiB |   1089 TiB |   1089 TiB |
|       from small pool |  27260 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7460 MiB |   7460 MiB |   7460 MiB |      0 B   |
|       from large pool |   7404 MiB |   7404 MiB |   7404 MiB |      0 B   |
|       from small pool |     56 MiB |     56 MiB |     56 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 290438 KiB | 680184 KiB |    811 TiB |    811 TiB |
|       from large pool | 281843 KiB | 675647 KiB |    795 TiB |    795 TiB |
|       from small pool |   8595 KiB |  10808 KiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3230    |    7877    |  206196 K  |  206193 K  |
|       from large pool |     130    |     756    |  103673 K  |  103673 K  |
|       from small pool |    3100    |    7745    |  102522 K  |  102519 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3230    |    7877    |  206196 K  |  206193 K  |
|       from large pool |     130    |     756    |  103673 K  |  103673 K  |
|       from small pool |    3100    |    7745    |  102522 K  |  102519 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     337    |     337    |     337    |       0    |
|       from large pool |     309    |     309    |     309    |       0    |
|       from small pool |      28    |      28    |      28    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    3607    |  118664 K  |  118664 K  |
|       from large pool |      28    |     307    |   70940 K  |   70940 K  |
|       from small pool |      35    |    3580    |   47724 K  |   47724 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |      0 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |      0 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   1089 TiB |   1089 TiB |
|       from small pool |      0 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 610304 KiB |   7460 MiB |   7460 MiB |   6864 MiB |
|       from large pool | 573440 KiB |   7404 MiB |   7404 MiB |   6844 MiB |
|       from small pool |  36864 KiB |     56 MiB |     56 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |    811 TiB |    811 TiB |
|       from large pool |  24320 KiB | 675647 KiB |    795 TiB |    795 TiB |
|       from small pool |      0 KiB |  29416 KiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7877    |  206196 K  |  206196 K  |
|       from large pool |       2    |     756    |  103673 K  |  103673 K  |
|       from small pool |       0    |    7745    |  102522 K  |  102522 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7877    |  206196 K  |  206196 K  |
|       from large pool |       2    |     756    |  103673 K  |  103673 K  |
|       from small pool |       0    |    7745    |  102522 K  |  102522 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     337    |     337    |     294    |
|       from large pool |      25    |     309    |     309    |     284    |
|       from small pool |      18    |      28    |      28    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3607    |  118666 K  |  118666 K  |
|       from large pool |       3    |     307    |   70940 K  |   70940 K  |
|       from small pool |       0    |    3580    |   47725 K  |   47725 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |      0 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |      0 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   1089 TiB |   1089 TiB |
|       from small pool |      0 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 610304 KiB |   7460 MiB |   7460 MiB |   6864 MiB |
|       from large pool | 573440 KiB |   7404 MiB |   7404 MiB |   6844 MiB |
|       from small pool |  36864 KiB |     56 MiB |     56 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |    811 TiB |    811 TiB |
|       from large pool |  24320 KiB | 675647 KiB |    795 TiB |    795 TiB |
|       from small pool |      0 KiB |  29416 KiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7877    |  206196 K  |  206196 K  |
|       from large pool |       2    |     756    |  103673 K  |  103673 K  |
|       from small pool |       0    |    7745    |  102522 K  |  102522 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7877    |  206196 K  |  206196 K  |
|       from large pool |       2    |     756    |  103673 K  |  103673 K  |
|       from small pool |       0    |    7745    |  102522 K  |  102522 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     337    |     337    |     294    |
|       from large pool |      25    |     309    |     309    |     284    |
|       from small pool |      18    |      28    |      28    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3607    |  118666 K  |  118666 K  |
|       from large pool |       3    |     307    |   70940 K  |   70940 K  |
|       from small pool |       0    |    3580    |   47725 K  |   47725 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054

 Experiment start at: 2024-07-01 14:16:31.970828
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9848149, 'precision': 0.9752471, 'recall': 0.9853631, 'specificity': 0.9853631, 'f1': 0.98016316, 'auroc': 0.9987997, 'binary_precision': 0.9551437, 'binary_recall': 0.9864762, 'binary_specificity': 0.9842501, 'binary_f1_score': 0.97055715}
confusion matrix:
       0      1
0  41745    668
1    195  14224
---- Validation: 
scalar performance:
{'acc': 0.95597655, 'precision': 0.7136798, 'recall': 0.86701715, 'specificity': 0.86701715, 'f1': 0.7670014, 'auroc': 0.9420948, 'binary_precision': 0.43613446, 'binary_recall': 0.77117383, 'binary_specificity': 0.96286047, 'binary_f1_score': 0.55716586}
confusion matrix:
       0    1
0  17396  671
1    154  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547212, 'precision': 0.73190993, 'recall': 0.8605145, 'specificity': 0.8605145, 'f1': 0.7798812, 'auroc': 0.92695284, 'binary_precision': 0.47469878, 'binary_recall': 0.75769234, 'binary_specificity': 0.9633367, 'binary_f1_score': 0.5837037}
confusion matrix:
      0    1
0  5728  218
1    63  197
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-01 14:38:40.742941,epoch time: 0:22:08.772113,used: 0:22:08.772113,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98757744, 'precision': 0.9909867, 'recall': 0.9762721, 'specificity': 0.9762721, 'f1': 0.98335034, 'auroc': 0.9992721, 'binary_precision': 0.9976049, 'binary_recall': 0.95332223, 'binary_specificity': 0.999222, 'binary_f1_score': 0.97496104}
confusion matrix:
       0      1
0  42381     33
1    673  13745
---- Validation: 
scalar performance:
{'acc': 0.96915686, 'precision': 0.7903229, 'recall': 0.7029039, 'specificity': 0.7029039, 'f1': 0.7380935, 'auroc': 0.95044196, 'binary_precision': 0.60215056, 'binary_recall': 0.41604754, 'binary_specificity': 0.98976034, 'binary_f1_score': 0.4920914}
confusion matrix:
       0    1
0  17882  185
1    393  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.912817, 'recall': 0.64698374, 'specificity': 0.64698374, 'f1': 0.7118753, 'auroc': 0.94099814, 'binary_precision': 0.85555553, 'binary_recall': 0.29615384, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.44000003}
confusion matrix:
      0   1
0  5933  13
1   183  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-01 15:00:33.682794,epoch time: 0:21:52.939853,used: 0:44:01.711966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99201155, 'precision': 0.99347544, 'recall': 0.9854251, 'specificity': 0.9854251, 'f1': 0.98936665, 'auroc': 0.9993639, 'binary_precision': 0.9963747, 'binary_recall': 0.9720527, 'binary_specificity': 0.99879754, 'binary_f1_score': 0.98406345}
confusion matrix:
       0      1
0  42361     51
1    403  14017
---- Validation: 
scalar performance:
{'acc': 0.9701174, 'precision': 0.87663066, 'recall': 0.6154242, 'specificity': 0.6154242, 'f1': 0.67198485, 'auroc': 0.9443873, 'binary_precision': 0.78109455, 'binary_recall': 0.2332838, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.35926774}
confusion matrix:
       0    1
0  18023   44
1    516  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.89861214, 'recall': 0.6029211, 'specificity': 0.6029211, 'f1': 0.6571772, 'auroc': 0.9370276, 'binary_precision': 0.83076924, 'binary_recall': 0.20769231, 'binary_specificity': 0.99815, 'binary_f1_score': 0.3323077}
confusion matrix:
      0   1
0  5935  11
1   206  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_3.png
better model found
persisted
after epoch: 3,now: 2024-07-01 15:22:42.634088,epoch time: 0:22:08.951294,used: 1:06:10.663260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99530196, 'precision': 0.99405426, 'recall': 0.9935337, 'specificity': 0.9935337, 'f1': 0.9937936, 'auroc': 0.99964523, 'binary_precision': 0.9915254, 'binary_recall': 0.9899438, 'binary_specificity': 0.99712354, 'binary_f1_score': 0.99073404}
confusion matrix:
       0      1
0  42291    122
1    145  14274
---- Validation: 
scalar performance:
{'acc': 0.9721985, 'precision': 0.81676674, 'recall': 0.7366684, 'specificity': 0.7366684, 'f1': 0.7703661, 'auroc': 0.94713116, 'binary_precision': 0.6526104, 'binary_recall': 0.48291233, 'binary_specificity': 0.9904245, 'binary_f1_score': 0.5550811}
confusion matrix:
       0    1
0  17894  173
1    348  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9779246, 'precision': 0.9091502, 'recall': 0.79170805, 'specificity': 0.79170805, 'f1': 0.8396493, 'auroc': 0.9507127, 'binary_precision': 0.8360656, 'binary_recall': 0.5884615, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.6907449}
confusion matrix:
      0    1
0  5916   30
1   107  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-01 15:44:23.797513,epoch time: 0:21:41.163425,used: 1:27:51.826685,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9941758, 'precision': 0.9936259, 'recall': 0.9909711, 'specificity': 0.9909711, 'f1': 0.9922893, 'auroc': 0.9994228, 'binary_precision': 0.99251854, 'binary_recall': 0.98446494, 'binary_specificity': 0.9974772, 'binary_f1_score': 0.9884753}
confusion matrix:
       0      1
0  42306    107
1    224  14195
---- Validation: 
scalar performance:
{'acc': 0.8945037, 'precision': 0.58106434, 'recall': 0.7271304, 'specificity': 0.7271304, 'f1': 0.60721105, 'auroc': 0.86679345, 'binary_precision': 0.18039216, 'binary_recall': 0.5468053, 'binary_specificity': 0.90745556, 'binary_f1_score': 0.2712864}
confusion matrix:
       0     1
0  16395  1672
1    305   368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8893007, 'precision': 0.53312963, 'recall': 0.56523776, 'specificity': 0.56523776, 'f1': 0.5394349, 'auroc': 0.7403846, 'binary_precision': 0.10242086, 'binary_recall': 0.21153846, 'binary_specificity': 0.9189371, 'binary_f1_score': 0.13801757}
confusion matrix:
      0    1
0  5464  482
1   205   55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_5.png
early stop counter: 1
val acc:0.8945037126541138, best validation acc: 0.972198486328125, corresponding to test acc:                         0.9779245853424072 / 0.9779245853424072
after epoch: 5,now: 2024-07-01 16:06:32.887108,epoch time: 0:22:09.089595,used: 1:50:00.916280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9947037, 'precision': 0.9964049, 'recall': 0.9896318, 'specificity': 0.9896318, 'f1': 0.9929595, 'auroc': 0.9997637, 'binary_precision': 0.9997876, 'binary_recall': 0.97933424, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9894552}
confusion matrix:
       0      1
0  42409      3
1    298  14122
---- Validation: 
scalar performance:
{'acc': 0.9695304, 'precision': 0.9439503, 'recall': 0.5829328, 'specificity': 0.5829328, 'f1': 0.633098, 'auroc': 0.9619, 'binary_precision': 0.91803277, 'binary_recall': 0.16641901, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.281761}
confusion matrix:
       0    1
0  18057   10
1    561  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.8727505, 'recall': 0.52090156, 'specificity': 0.52090156, 'f1': 0.52976537, 'auroc': 0.9432075, 'binary_precision': 0.78571427, 'binary_recall': 0.042307694, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.08029198}
confusion matrix:
      0   1
0  5943   3
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_6.png
early stop counter: 2
val acc:0.9695304036140442, best validation acc: 0.972198486328125, corresponding to test acc:                         0.9779245853424072 / 0.9779245853424072
after epoch: 6,now: 2024-07-01 16:28:13.523172,epoch time: 0:21:40.636064,used: 2:11:41.552344,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99495006, 'precision': 0.996544, 'recall': 0.9901401, 'specificity': 0.9901401, 'f1': 0.9932895, 'auroc': 0.99978036, 'binary_precision': 0.9997171, 'binary_recall': 0.98037446, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9899513}
confusion matrix:
       0      1
0  42408      4
1    283  14137
---- Validation: 
scalar performance:
{'acc': 0.97187835, 'precision': 0.86437976, 'recall': 0.65925354, 'specificity': 0.65925354, 'f1': 0.71859103, 'auroc': 0.9571981, 'binary_precision': 0.7534722, 'binary_recall': 0.32243684, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.4516129}
confusion matrix:
       0    1
0  17996   71
1    456  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.8785114, 'recall': 0.57984424, 'specificity': 0.57984424, 'f1': 0.6247217, 'auroc': 0.9445804, 'binary_precision': 0.7924528, 'binary_recall': 0.16153847, 'binary_specificity': 0.99815, 'binary_f1_score': 0.2683706}
confusion matrix:
      0   1
0  5935  11
1   218  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_7.png
early stop counter: 3
val acc:0.9718783497810364, best validation acc: 0.972198486328125, corresponding to test acc:                         0.9779245853424072 / 0.9779245853424072
after epoch: 7,now: 2024-07-01 16:49:22.226363,epoch time: 0:21:08.703191,used: 2:32:50.255535,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9957066, 'precision': 0.9933572, 'recall': 0.9953383, 'specificity': 0.9953383, 'f1': 0.9943427, 'auroc': 0.99976104, 'binary_precision': 0.9885572, 'binary_recall': 0.99459046, 'binary_specificity': 0.9960861, 'binary_f1_score': 0.99156475}
confusion matrix:
       0      1
0  42247    166
1     78  14341
---- Validation: 
scalar performance:
{'acc': 0.96510136, 'precision': 0.74904436, 'recall': 0.81738925, 'specificity': 0.81738925, 'f1': 0.77856386, 'auroc': 0.9488945, 'binary_precision': 0.5109573, 'binary_recall': 0.65824664, 'binary_specificity': 0.9765318, 'binary_f1_score': 0.57532465}
confusion matrix:
       0    1
0  17643  424
1    230  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9502095, 'precision': 0.6730435, 'recall': 0.6338036, 'specificity': 0.6338036, 'f1': 0.650473, 'auroc': 0.9232141, 'binary_precision': 0.37688443, 'binary_recall': 0.28846154, 'binary_specificity': 0.97914565, 'binary_f1_score': 0.32679737}
confusion matrix:
      0    1
0  5822  124
1   185   75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_8.png
early stop counter: 4
val acc:0.9651013612747192, best validation acc: 0.972198486328125, corresponding to test acc:                         0.9779245853424072 / 0.9779245853424072
after epoch: 8,now: 2024-07-01 17:10:19.545795,epoch time: 0:20:57.319432,used: 2:53:47.574967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99681515, 'precision': 0.99655473, 'recall': 0.99502814, 'specificity': 0.99502814, 'f1': 0.99578846, 'auroc': 0.9998378, 'binary_precision': 0.9960284, 'binary_recall': 0.99140024, 'binary_specificity': 0.9986561, 'binary_f1_score': 0.99370897}
confusion matrix:
       0      1
0  42356     57
1    124  14295
---- Validation: 
scalar performance:
{'acc': 0.9677695, 'precision': 0.7680125, 'recall': 0.75725996, 'specificity': 0.75725996, 'f1': 0.76251364, 'auroc': 0.9463658, 'binary_precision': 0.5534884, 'binary_recall': 0.5304606, 'binary_specificity': 0.98405933, 'binary_f1_score': 0.54172987}
confusion matrix:
       0    1
0  17779  288
1    316  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94859815, 'precision': 0.64347315, 'recall': 0.592505, 'specificity': 0.592505, 'f1': 0.61139977, 'auroc': 0.9118328, 'binary_precision': 0.3212121, 'binary_recall': 0.20384616, 'binary_specificity': 0.9811638, 'binary_f1_score': 0.24941176}
confusion matrix:
      0    1
0  5834  112
1   207   53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_9.png
early stop counter: 5
val acc:0.9677695035934448, best validation acc: 0.972198486328125, corresponding to test acc:                         0.9779245853424072 / 0.9779245853424072
after epoch: 9,now: 2024-07-01 17:31:30.763269,epoch time: 0:21:11.217474,used: 3:14:58.792441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99653363, 'precision': 0.9970337, 'recall': 0.9938092, 'specificity': 0.9938092, 'f1': 0.9954081, 'auroc': 0.9997666, 'binary_precision': 0.9980388, 'binary_recall': 0.98827857, 'binary_specificity': 0.9993398, 'binary_f1_score': 0.99313474}
confusion matrix:
       0      1
0  42386     28
1    169  14249
---- Validation: 
scalar performance:
{'acc': 0.9674493, 'precision': 0.8841964, 'recall': 0.56182593, 'specificity': 0.56182593, 'f1': 0.59965897, 'auroc': 0.9511742, 'binary_precision': 0.8, 'binary_recall': 0.124814264, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.2159383}
confusion matrix:
       0   1
0  18046  21
1    589  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7459457, 'recall': 0.53143096, 'specificity': 0.53143096, 'f1': 0.5475756, 'auroc': 0.9417647, 'binary_precision': 0.53125, 'binary_recall': 0.06538462, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.11643836}
confusion matrix:
      0   1
0  5931  15
1   243  17
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_10.png
early stop counter: 6
val acc:0.9674493074417114, best validation acc: 0.972198486328125, corresponding to test acc:                         0.9779245853424072 / 0.9779245853424072
after epoch: 10,now: 2024-07-01 18:49:41.517350,epoch time: 1:18:10.754081,used: 4:33:09.546522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99489725, 'precision': 0.99648535, 'recall': 0.9900589, 'specificity': 0.9900589, 'f1': 0.99321914, 'auroc': 0.99977875, 'binary_precision': 0.99964637, 'binary_recall': 0.98023576, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.9898459}
confusion matrix:
       0      1
0  42407      5
1    285  14135
---- Validation: 
scalar performance:
{'acc': 0.97395945, 'precision': 0.8835572, 'recall': 0.68536717, 'specificity': 0.68536717, 'f1': 0.7473451, 'auroc': 0.95681745, 'binary_precision': 0.78996867, 'binary_recall': 0.3744428, 'binary_specificity': 0.9962916, 'binary_f1_score': 0.5080645}
confusion matrix:
       0    1
0  18000   67
1    421  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.79336137, 'recall': 0.586107, 'specificity': 0.586107, 'f1': 0.62770635, 'auroc': 0.9456263, 'binary_precision': 0.6216216, 'binary_recall': 0.17692308, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.2754491}
confusion matrix:
      0   1
0  5918  28
1   214  46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_11.png
better model found
persisted
after epoch: 11,now: 2024-07-01 20:08:34.087108,epoch time: 1:18:52.569758,used: 5:52:02.116280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9967448, 'precision': 0.99743074, 'recall': 0.993974, 'specificity': 0.993974, 'f1': 0.995687, 'auroc': 0.9997631, 'binary_precision': 0.9988085, 'binary_recall': 0.9883487, 'binary_specificity': 0.99959916, 'binary_f1_score': 0.9935511}
confusion matrix:
       0      1
0  42396     17
1    168  14251
---- Validation: 
scalar performance:
{'acc': 0.96974385, 'precision': 0.9052894, 'recall': 0.59663355, 'specificity': 0.59663355, 'f1': 0.6502866, 'auroc': 0.9548222, 'binary_precision': 0.8397436, 'binary_recall': 0.19465081, 'binary_specificity': 0.9986163, 'binary_f1_score': 0.31604344}
confusion matrix:
       0    1
0  18042   25
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8306509, 'recall': 0.5396278, 'specificity': 0.5396278, 'f1': 0.56218445, 'auroc': 0.93216336, 'binary_precision': 0.7, 'binary_recall': 0.08076923, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.14482759}
confusion matrix:
      0   1
0  5937   9
1   239  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_12.png
early stop counter: 1
val acc:0.9697438478469849, best validation acc: 0.9739594459533691, corresponding to test acc:                         0.961005449295044 / 0.9779245853424072
after epoch: 12,now: 2024-07-01 21:29:20.478181,epoch time: 1:20:46.391073,used: 7:12:48.507353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9972023, 'precision': 0.99780595, 'recall': 0.99480724, 'specificity': 0.99480724, 'f1': 0.996295, 'auroc': 0.99987006, 'binary_precision': 0.9990202, 'binary_recall': 0.9899445, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.9944616}
confusion matrix:
       0      1
0  42398     14
1    145  14275
---- Validation: 
scalar performance:
{'acc': 0.97454643, 'precision': 0.8791245, 'recall': 0.70069224, 'specificity': 0.70069224, 'f1': 0.7603202, 'auroc': 0.96252906, 'binary_precision': 0.78, 'binary_recall': 0.40564635, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.5337243}
confusion matrix:
       0    1
0  17990   77
1    400  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.7718554, 'recall': 0.5819245, 'specificity': 0.5819245, 'f1': 0.62068415, 'auroc': 0.94616926, 'binary_precision': 0.57894737, 'binary_recall': 0.16923077, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.26190478}
confusion matrix:
      0   1
0  5914  32
1   216  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_13.png
better model found
persisted
after epoch: 13,now: 2024-07-01 21:51:05.390974,epoch time: 0:21:44.912793,used: 7:34:33.420146,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99679756, 'precision': 0.9976293, 'recall': 0.99391776, 'specificity': 0.99391776, 'f1': 0.9957559, 'auroc': 0.9997951, 'binary_precision': 0.9992986, 'binary_recall': 0.9880713, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.99365324}
confusion matrix:
       0      1
0  42403     10
1    172  14247
---- Validation: 
scalar performance:
{'acc': 0.9729989, 'precision': 0.81999934, 'recall': 0.7535347, 'specificity': 0.7535347, 'f1': 0.78254354, 'auroc': 0.9581467, 'binary_precision': 0.657845, 'binary_recall': 0.51708764, 'binary_specificity': 0.9899817, 'binary_f1_score': 0.5790349}
confusion matrix:
       0    1
0  17886  181
1    325  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.729608, 'recall': 0.61201, 'specificity': 0.61201, 'f1': 0.6479629, 'auroc': 0.9345964, 'binary_precision': 0.4919355, 'binary_recall': 0.23461539, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.31770834}
confusion matrix:
      0   1
0  5883  63
1   199  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_14.png
early stop counter: 1
val acc:0.9729989171028137, best validation acc: 0.9745464324951172, corresponding to test acc:                         0.9600386619567871 / 0.9779245853424072
after epoch: 14,now: 2024-07-01 22:12:08.239518,epoch time: 0:21:02.848544,used: 7:55:36.268690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99723744, 'precision': 0.9961838, 'recall': 0.9965243, 'specificity': 0.9965243, 'f1': 0.99635386, 'auroc': 0.999923, 'binary_precision': 0.9940423, 'binary_recall': 0.9950763, 'binary_specificity': 0.99797225, 'binary_f1_score': 0.994559}
confusion matrix:
       0      1
0  42326     86
1     71  14349
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.7539642, 'recall': 0.76990914, 'specificity': 0.76990914, 'f1': 0.7616646, 'auroc': 0.9431365, 'binary_precision': 0.52440727, 'binary_recall': 0.5586924, 'binary_specificity': 0.98112583, 'binary_f1_score': 0.5410072}
confusion matrix:
       0    1
0  17726  341
1    297  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9474702, 'precision': 0.64768404, 'recall': 0.6103062, 'specificity': 0.6103062, 'f1': 0.62575173, 'auroc': 0.8943978, 'binary_precision': 0.328125, 'binary_recall': 0.2423077, 'binary_specificity': 0.97830474, 'binary_f1_score': 0.27876106}
confusion matrix:
      0    1
0  5817  129
1   197   63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_15.png
early stop counter: 2
val acc:0.9659551978111267, best validation acc: 0.9745464324951172, corresponding to test acc:                         0.9600386619567871 / 0.9779245853424072
after epoch: 15,now: 2024-07-01 22:33:39.028232,epoch time: 0:21:30.788714,used: 8:17:07.057404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9962169, 'precision': 0.99738395, 'recall': 0.9926356, 'specificity': 0.9926356, 'f1': 0.99498093, 'auroc': 0.9998219, 'binary_precision': 0.99971855, 'binary_recall': 0.9853655, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9924901}
confusion matrix:
       0      1
0  42410      4
1    211  14207
---- Validation: 
scalar performance:
{'acc': 0.96835643, 'precision': 0.9069767, 'recall': 0.57231015, 'specificity': 0.57231015, 'f1': 0.61612684, 'auroc': 0.9465984, 'binary_precision': 0.8448276, 'binary_recall': 0.14561664, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.24841571}
confusion matrix:
       0   1
0  18049  18
1    575  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7923061, 'recall': 0.5187262, 'specificity': 0.5187262, 'f1': 0.5256848, 'auroc': 0.9349352, 'binary_precision': 0.625, 'binary_recall': 0.03846154, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.072463766}
confusion matrix:
      0   1
0  5940   6
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_16.png
early stop counter: 3
val acc:0.9683564305305481, best validation acc: 0.9745464324951172, corresponding to test acc:                         0.9600386619567871 / 0.9779245853424072
after epoch: 16,now: 2024-07-01 22:55:51.398286,epoch time: 0:22:12.370054,used: 8:39:19.427458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9961993, 'precision': 0.99744296, 'recall': 0.99253273, 'specificity': 0.99253273, 'f1': 0.994957, 'auroc': 0.9998902, 'binary_precision': 0.9999296, 'binary_recall': 0.9850891, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99245393}
confusion matrix:
       0      1
0  42412      1
1    215  14204
---- Validation: 
scalar performance:
{'acc': 0.97326577, 'precision': 0.8925432, 'recall': 0.6656952, 'specificity': 0.6656952, 'f1': 0.7297355, 'auroc': 0.96109843, 'binary_precision': 0.8093525, 'binary_recall': 0.3343239, 'binary_specificity': 0.9970665, 'binary_f1_score': 0.4731861}
confusion matrix:
       0    1
0  18014   53
1    448  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.8293196, 'recall': 0.5603612, 'specificity': 0.5603612, 'f1': 0.5945801, 'auroc': 0.9541652, 'binary_precision': 0.6956522, 'binary_recall': 0.12307692, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.20915034}
confusion matrix:
      0   1
0  5932  14
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_17.png
early stop counter: 4
val acc:0.9732657670974731, best validation acc: 0.9745464324951172, corresponding to test acc:                         0.9600386619567871 / 0.9779245853424072
after epoch: 17,now: 2024-07-01 23:17:17.648308,epoch time: 0:21:26.250022,used: 9:00:45.677480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9964105, 'precision': 0.9971844, 'recall': 0.993338, 'specificity': 0.993338, 'f1': 0.99524224, 'auroc': 0.9997622, 'binary_precision': 0.9987369, 'binary_recall': 0.98710036, 'binary_specificity': 0.9995756, 'binary_f1_score': 0.9928846}
confusion matrix:
       0      1
0  42395     18
1    186  14233
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.7641735, 'recall': 0.70815134, 'specificity': 0.70815134, 'f1': 0.732476, 'auroc': 0.94014776, 'binary_precision': 0.54942966, 'binary_recall': 0.4294205, 'binary_specificity': 0.98688215, 'binary_f1_score': 0.4820684}
confusion matrix:
       0    1
0  17830  237
1    384  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9468256, 'precision': 0.61351645, 'recall': 0.56583416, 'specificity': 0.56583416, 'f1': 0.58184284, 'auroc': 0.92139447, 'binary_precision': 0.2635135, 'binary_recall': 0.15, 'binary_specificity': 0.98166835, 'binary_f1_score': 0.19117647}
confusion matrix:
      0    1
0  5837  109
1   221   39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_18.png
early stop counter: 5
val acc:0.9668623208999634, best validation acc: 0.9745464324951172, corresponding to test acc:                         0.9600386619567871 / 0.9779245853424072
after epoch: 18,now: 2024-07-01 23:38:41.952295,epoch time: 0:21:24.303987,used: 9:22:09.981467,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99771255, 'precision': 0.9973657, 'recall': 0.9965907, 'specificity': 0.9965907, 'f1': 0.9969774, 'auroc': 0.9997864, 'binary_precision': 0.9966632, 'binary_recall': 0.99431306, 'binary_specificity': 0.9988683, 'binary_f1_score': 0.9954867}
confusion matrix:
       0      1
0  42365     48
1     82  14337
---- Validation: 
scalar performance:
{'acc': 0.97652084, 'precision': 0.902884, 'recall': 0.71745205, 'specificity': 0.71745205, 'f1': 0.78037214, 'auroc': 0.96072644, 'binary_precision': 0.82633054, 'binary_recall': 0.4383358, 'binary_specificity': 0.9965683, 'binary_f1_score': 0.57281554}
confusion matrix:
       0    1
0  18005   62
1    378  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.7171711, 'recall': 0.5950387, 'specificity': 0.5950387, 'f1': 0.6290746, 'auroc': 0.9258454, 'binary_precision': 0.46846846, 'binary_recall': 0.2, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.28032345}
confusion matrix:
      0   1
0  5887  59
1   208  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_19.png
better model found
persisted
after epoch: 19,now: 2024-07-01 23:59:59.251182,epoch time: 0:21:17.298887,used: 9:43:27.280354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9978885, 'precision': 0.9979648, 'recall': 0.996457, 'specificity': 0.996457, 'f1': 0.99720794, 'auroc': 0.9999254, 'binary_precision': 0.998119, 'binary_recall': 0.9935506, 'binary_specificity': 0.99936336, 'binary_f1_score': 0.9958296}
confusion matrix:
       0      1
0  42385     27
1     93  14327
---- Validation: 
scalar performance:
{'acc': 0.9763074, 'precision': 0.8941597, 'recall': 0.7209177, 'specificity': 0.7209177, 'f1': 0.7812635, 'auroc': 0.9603359, 'binary_precision': 0.80862534, 'binary_recall': 0.44576523, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.57471263}
confusion matrix:
       0    1
0  17996   71
1    373  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7858188, 'recall': 0.5467315, 'specificity': 0.5467315, 'f1': 0.572694, 'auroc': 0.93348503, 'binary_precision': 0.6097561, 'binary_recall': 0.09615385, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.16611296}
confusion matrix:
      0   1
0  5930  16
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_20.png
early stop counter: 1
val acc:0.9763073921203613, best validation acc: 0.976520836353302, corresponding to test acc:                         0.956977128982544 / 0.9779245853424072
after epoch: 20,now: 2024-07-02 00:21:16.135493,epoch time: 0:21:16.884311,used: 10:04:44.164665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9975894, 'precision': 0.99787945, 'recall': 0.9957531, 'specificity': 0.9957531, 'f1': 0.99681044, 'auroc': 0.99993557, 'binary_precision': 0.99846447, 'binary_recall': 0.99202496, 'binary_specificity': 0.99948126, 'binary_f1_score': 0.99523425}
confusion matrix:
       0      1
0  42390     22
1    115  14305
---- Validation: 
scalar performance:
{'acc': 0.9685165, 'precision': 0.8389127, 'recall': 0.60386497, 'specificity': 0.60386497, 'f1': 0.6544126, 'auroc': 0.94773144, 'binary_precision': 0.7064677, 'binary_recall': 0.21099554, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.3249428}
confusion matrix:
       0    1
0  18008   59
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.7003857, 'recall': 0.56352365, 'specificity': 0.56352365, 'f1': 0.59175825, 'auroc': 0.9325552, 'binary_precision': 0.4375, 'binary_recall': 0.13461539, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.20588234}
confusion matrix:
      0   1
0  5901  45
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_21.png
early stop counter: 2
val acc:0.9685165286064148, best validation acc: 0.976520836353302, corresponding to test acc:                         0.956977128982544 / 0.9779245853424072
after epoch: 21,now: 2024-07-02 00:42:27.924546,epoch time: 0:21:11.789053,used: 10:25:55.953718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9962697, 'precision': 0.9975132, 'recall': 0.9926491, 'specificity': 0.9926491, 'f1': 0.9950508, 'auroc': 0.99992347, 'binary_precision': 1.0, 'binary_recall': 0.9852982, 'binary_specificity': 1.0, 'binary_f1_score': 0.9925947}
confusion matrix:
       0      1
0  42412      0
1    212  14208
---- Validation: 
scalar performance:
{'acc': 0.97470653, 'precision': 0.9425143, 'recall': 0.6635814, 'specificity': 0.6635814, 'f1': 0.7347846, 'auroc': 0.9564676, 'binary_precision': 0.909465, 'binary_recall': 0.32838038, 'binary_specificity': 0.99878234, 'binary_f1_score': 0.48253274}
confusion matrix:
       0    1
0  18045   22
1    452  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.8323503, 'recall': 0.5358657, 'specificity': 0.5358657, 'f1': 0.555934, 'auroc': 0.94758725, 'binary_precision': 0.7037037, 'binary_recall': 0.073076926, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.1324042}
confusion matrix:
      0   1
0  5938   8
1   241  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_22.png
early stop counter: 3
val acc:0.9747065305709839, best validation acc: 0.976520836353302, corresponding to test acc:                         0.956977128982544 / 0.9779245853424072
after epoch: 22,now: 2024-07-02 01:03:41.733173,epoch time: 0:21:13.808627,used: 10:47:09.762345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99818766, 'precision': 0.9983264, 'recall': 0.9968861, 'specificity': 0.9968861, 'f1': 0.99760354, 'auroc': 0.99988955, 'binary_precision': 0.99860686, 'binary_recall': 0.9942437, 'binary_specificity': 0.99952847, 'binary_f1_score': 0.9964205}
confusion matrix:
       0      1
0  42393     20
1     83  14336
---- Validation: 
scalar performance:
{'acc': 0.9735859, 'precision': 0.8060285, 'recall': 0.8239353, 'specificity': 0.8239353, 'f1': 0.8147, 'auroc': 0.9639138, 'binary_precision': 0.6246499, 'binary_recall': 0.6627043, 'binary_specificity': 0.9851663, 'binary_f1_score': 0.6431146}
confusion matrix:
       0    1
0  17799  268
1    227  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94811475, 'precision': 0.6794524, 'recall': 0.68604106, 'specificity': 0.68604106, 'f1': 0.6826765, 'auroc': 0.9370357, 'binary_precision': 0.38518518, 'binary_recall': 0.4, 'binary_specificity': 0.9720821, 'binary_f1_score': 0.3924528}
confusion matrix:
      0    1
0  5780  166
1   156  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_23.png
early stop counter: 4
val acc:0.9735859036445618, best validation acc: 0.976520836353302, corresponding to test acc:                         0.956977128982544 / 0.9779245853424072
after epoch: 23,now: 2024-07-02 01:24:57.842488,epoch time: 0:21:16.109315,used: 11:08:25.871660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99785334, 'precision': 0.99773467, 'recall': 0.9965935, 'specificity': 0.9965935, 'f1': 0.9971624, 'auroc': 0.99987066, 'binary_precision': 0.9974946, 'binary_recall': 0.99403566, 'binary_specificity': 0.99915123, 'binary_f1_score': 0.99576217}
confusion matrix:
       0      1
0  42377     36
1     86  14333
---- Validation: 
scalar performance:
{'acc': 0.9676094, 'precision': 0.78178513, 'recall': 0.65918535, 'specificity': 0.65918535, 'f1': 0.7017938, 'auroc': 0.9390789, 'binary_precision': 0.5882353, 'binary_recall': 0.3268945, 'binary_specificity': 0.9914762, 'binary_f1_score': 0.42024833}
confusion matrix:
       0    1
0  17913  154
1    453  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94215274, 'precision': 0.49322358, 'recall': 0.49719203, 'specificity': 0.49719203, 'f1': 0.49331918, 'auroc': 0.84296924, 'binary_precision': 0.028571429, 'binary_recall': 0.011538462, 'binary_specificity': 0.9828456, 'binary_f1_score': 0.016438358}
confusion matrix:
      0    1
0  5844  102
1   257    3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_24.png
early stop counter: 5
val acc:0.9676094055175781, best validation acc: 0.976520836353302, corresponding to test acc:                         0.956977128982544 / 0.9779245853424072
after epoch: 24,now: 2024-07-02 01:46:10.897420,epoch time: 0:21:13.054932,used: 11:29:38.926592,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9976774, 'precision': 0.99750185, 'recall': 0.99636126, 'specificity': 0.99636126, 'f1': 0.9969299, 'auroc': 0.9998244, 'binary_precision': 0.99714684, 'binary_recall': 0.9936893, 'binary_specificity': 0.9990333, 'binary_f1_score': 0.9954151}
confusion matrix:
       0      1
0  42371     41
1     91  14329
---- Validation: 
scalar performance:
{'acc': 0.9734792, 'precision': 0.9408285, 'recall': 0.64506316, 'specificity': 0.64506316, 'f1': 0.71368116, 'auroc': 0.95822793, 'binary_precision': 0.9074074, 'binary_recall': 0.29123327, 'binary_specificity': 0.998893, 'binary_f1_score': 0.44094488}
confusion matrix:
       0    1
0  18047   20
1    477  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.6268061, 'recall': 0.5172126, 'specificity': 0.5172126, 'f1': 0.5227081, 'auroc': 0.92365795, 'binary_precision': 0.29411766, 'binary_recall': 0.03846154, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.06802721}
confusion matrix:
      0   1
0  5922  24
1   250  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_25.png
early stop counter: 6
val acc:0.9734792113304138, best validation acc: 0.976520836353302, corresponding to test acc:                         0.956977128982544 / 0.9779245853424072
after epoch: 25,now: 2024-07-02 02:07:27.037507,epoch time: 0:21:16.140087,used: 11:50:55.066679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9984692, 'precision': 0.9987453, 'recall': 0.99721205, 'specificity': 0.99721205, 'f1': 0.99797565, 'auroc': 0.9999429, 'binary_precision': 0.9993032, 'binary_recall': 0.99465984, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.99697614}
confusion matrix:
       0      1
0  42403     10
1     77  14342
---- Validation: 
scalar performance:
{'acc': 0.97326577, 'precision': 0.95186627, 'recall': 0.63779974, 'specificity': 0.63779974, 'f1': 0.70621544, 'auroc': 0.9551614, 'binary_precision': 0.93, 'binary_recall': 0.27637443, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.42611682}
confusion matrix:
       0    1
0  18053   14
1    487  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548824, 'precision': 0.53689945, 'recall': 0.50383514, 'specificity': 0.50383514, 'f1': 0.4989441, 'auroc': 0.9078625, 'binary_precision': 0.115384616, 'binary_recall': 0.011538462, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.02097902}
confusion matrix:
      0   1
0  5923  23
1   257   3
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_26.png
early stop counter: 7
val acc:0.9732657670974731, best validation acc: 0.976520836353302, corresponding to test acc:                         0.956977128982544 / 0.9779245853424072
after epoch: 26,now: 2024-07-02 02:28:40.006242,epoch time: 0:21:12.968735,used: 12:12:08.035414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9979589, 'precision': 0.99821925, 'recall': 0.99638975, 'specificity': 0.99638975, 'f1': 0.9973002, 'auroc': 0.99993, 'binary_precision': 0.9987448, 'binary_recall': 0.9932039, 'binary_specificity': 0.9995756, 'binary_f1_score': 0.9959667}
confusion matrix:
       0      1
0  42394     18
1     98  14322
---- Validation: 
scalar performance:
{'acc': 0.97326577, 'precision': 0.91508996, 'recall': 0.6528204, 'specificity': 0.6528204, 'f1': 0.7193787, 'auroc': 0.9542469, 'binary_precision': 0.8553719, 'binary_recall': 0.307578, 'binary_specificity': 0.9980628, 'binary_f1_score': 0.45245898}
confusion matrix:
       0    1
0  18032   35
1    466  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95278764, 'precision': 0.5797594, 'recall': 0.5174539, 'specificity': 0.5174539, 'f1': 0.5228102, 'auroc': 0.90411687, 'binary_precision': 0.2, 'binary_recall': 0.042307694, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.06984127}
confusion matrix:
      0   1
0  5902  44
1   249  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_27.png
early stop counter: 8
val acc:0.9732657670974731, best validation acc: 0.976520836353302, corresponding to test acc:                         0.956977128982544 / 0.9779245853424072
after epoch: 27,now: 2024-07-02 02:49:49.766204,epoch time: 0:21:09.759962,used: 12:33:17.795376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99792373, 'precision': 0.9973264, 'recall': 0.99718976, 'specificity': 0.99718976, 'f1': 0.99725807, 'auroc': 0.9998971, 'binary_precision': 0.9961144, 'binary_recall': 0.9956998, 'binary_specificity': 0.9986797, 'binary_f1_score': 0.99590707}
confusion matrix:
       0      1
0  42358     56
1     62  14356
---- Validation: 
scalar performance:
{'acc': 0.9758271, 'precision': 0.8304545, 'recall': 0.8100771, 'specificity': 0.8100771, 'f1': 0.81990945, 'auroc': 0.96736753, 'binary_precision': 0.67460316, 'binary_recall': 0.6315007, 'binary_specificity': 0.98865336, 'binary_f1_score': 0.6523407}
confusion matrix:
       0    1
0  17862  205
1    248  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95327103, 'precision': 0.68196344, 'recall': 0.6041385, 'specificity': 0.6041385, 'f1': 0.63077986, 'auroc': 0.9329113, 'binary_precision': 0.39726028, 'binary_recall': 0.22307692, 'binary_specificity': 0.9852001, 'binary_f1_score': 0.2857143}
confusion matrix:
      0   1
0  5858  88
1   202  58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_28.png
early stop counter: 9
val acc:0.9758270978927612, best validation acc: 0.976520836353302, corresponding to test acc:                         0.956977128982544 / 0.9779245853424072
after epoch: 28,now: 2024-07-02 03:11:01.768890,epoch time: 0:21:12.002686,used: 12:54:29.798062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9978181, 'precision': 0.9982637, 'recall': 0.9959748, 'specificity': 0.9959748, 'f1': 0.9971125, 'auroc': 0.99992, 'binary_precision': 0.99916196, 'binary_recall': 0.99223244, 'binary_specificity': 0.99971706, 'binary_f1_score': 0.99568516}
confusion matrix:
       0      1
0  42401     12
1    112  14307
---- Validation: 
scalar performance:
{'acc': 0.97508, 'precision': 0.86744034, 'recall': 0.7238575, 'specificity': 0.7238575, 'f1': 0.7767798, 'auroc': 0.960652, 'binary_precision': 0.7549505, 'binary_recall': 0.45319465, 'binary_specificity': 0.9945204, 'binary_f1_score': 0.56638813}
confusion matrix:
       0    1
0  17968   99
1    368  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95391554, 'precision': 0.6497327, 'recall': 0.5474663, 'specificity': 0.5474663, 'f1': 0.56756616, 'auroc': 0.92166615, 'binary_precision': 0.3375, 'binary_recall': 0.103846155, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.15882353}
confusion matrix:
      0   1
0  5893  53
1   233  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_29.png
early stop counter: 10
val acc:0.9750800132751465, best validation acc: 0.976520836353302, corresponding to test acc:                         0.956977128982544 / 0.9779245853424072
after epoch: 29,now: 2024-07-02 03:32:11.175875,epoch time: 0:21:09.406985,used: 13:15:39.205047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9979765, 'precision': 0.998439, 'recall': 0.99621797, 'specificity': 0.99621797, 'f1': 0.99732214, 'auroc': 0.9998814, 'binary_precision': 0.9993715, 'binary_recall': 0.99264807, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.99599844}
confusion matrix:
       0      1
0  42405      9
1    106  14312
---- Validation: 
scalar performance:
{'acc': 0.9746531, 'precision': 0.90350324, 'recall': 0.6835812, 'specificity': 0.6835812, 'f1': 0.74940395, 'auroc': 0.96118796, 'binary_precision': 0.83, 'binary_recall': 0.36998513, 'binary_specificity': 0.9971772, 'binary_f1_score': 0.5118191}
confusion matrix:
       0    1
0  18016   51
1    424  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95601034, 'precision': 0.6507804, 'recall': 0.52465266, 'specificity': 0.52465266, 'f1': 0.5352409, 'auroc': 0.93673754, 'binary_precision': 0.34146342, 'binary_recall': 0.053846154, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.09302326}
confusion matrix:
      0   1
0  5919  27
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_30.png
early stop counter: 11
val acc:0.9746531248092651, best validation acc: 0.976520836353302, corresponding to test acc:                         0.956977128982544 / 0.9779245853424072
after epoch: 30,now: 2024-07-02 03:53:19.504293,epoch time: 0:21:08.328418,used: 13:36:47.533465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_14_16_31_seed_1_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:36:47.533465 at 2024-07-02 03:53:19.504293
persisted model performance metric: 

scalar performance:
{'acc': 0.9569771, 'precision': 0.7171711, 'recall': 0.5950387, 'specificity': 0.5950387, 'f1': 0.6290746, 'auroc': 0.9258454, 'binary_precision': 0.46846846, 'binary_recall': 0.2, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.28032345}
confusion matrix:
      0   1
0  5887  59
1   208  52
oracle model performance metric: 

scalar performance:
{'acc': 0.9779246, 'precision': 0.9091502, 'recall': 0.79170805, 'specificity': 0.79170805, 'f1': 0.8396493, 'auroc': 0.9507127, 'binary_precision': 0.8360656, 'binary_recall': 0.5884615, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.6907449}
confusion matrix:
      0    1
0  5916   30
1   107  153
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 319595 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool | 291339 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |  28256 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 319595 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool | 291339 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |  28256 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 314119 KiB |   6778 MiB |   2201 TiB |   2201 TiB |
|       from large pool | 286862 KiB |   6752 MiB |   2170 TiB |   2170 TiB |
|       from small pool |  27257 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7456 MiB |   7460 MiB |  14320 MiB |   6864 MiB |
|       from large pool |   7404 MiB |   7404 MiB |  14248 MiB |   6844 MiB |
|       from small pool |     52 MiB |     56 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 284564 KiB | 680184 KiB |   1606 TiB |   1606 TiB |
|       from large pool | 275957 KiB | 675647 KiB |   1574 TiB |   1574 TiB |
|       from small pool |   8607 KiB |  29416 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3206    |    7877    |  410950 K  |  410947 K  |
|       from large pool |     130    |     756    |  206555 K  |  206555 K  |
|       from small pool |    3076    |    7745    |  204394 K  |  204391 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3206    |    7877    |  410950 K  |  410947 K  |
|       from large pool |     130    |     756    |  206555 K  |  206555 K  |
|       from small pool |    3076    |    7745    |  204394 K  |  204391 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     337    |     629    |     294    |
|       from large pool |     309    |     309    |     593    |     284    |
|       from small pool |      26    |      28    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      62    |    3607    |  252451 K  |  252451 K  |
|       from large pool |      27    |     307    |  157606 K  |  157606 K  |
|       from small pool |      35    |    3580    |   94844 K  |   94844 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |      0 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |      0 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   2201 TiB |   2201 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   2170 TiB |   2170 TiB |
|       from small pool |      0 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7460 MiB |  14320 MiB |  13730 MiB |
|       from large pool | 567296 KiB |   7404 MiB |  14248 MiB |  13694 MiB |
|       from small pool |  36864 KiB |     56 MiB |     72 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |   1606 TiB |   1606 TiB |
|       from large pool |  24320 KiB | 675647 KiB |   1574 TiB |   1574 TiB |
|       from small pool |      0 KiB |  31476 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7877    |  410950 K  |  410950 K  |
|       from large pool |       2    |     756    |  206555 K  |  206555 K  |
|       from small pool |       0    |    7745    |  204394 K  |  204394 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7877    |  410950 K  |  410950 K  |
|       from large pool |       2    |     756    |  206555 K  |  206555 K  |
|       from small pool |       0    |    7745    |  204394 K  |  204394 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     337    |     629    |     586    |
|       from large pool |      25    |     309    |     593    |     568    |
|       from small pool |      18    |      28    |      36    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3607    |  252452 K  |  252452 K  |
|       from large pool |       3    |     307    |  157606 K  |  157606 K  |
|       from small pool |       0    |    3580    |   94845 K  |   94845 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |      0 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |      0 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   2201 TiB |   2201 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   2170 TiB |   2170 TiB |
|       from small pool |      0 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7460 MiB |  14320 MiB |  13730 MiB |
|       from large pool | 567296 KiB |   7404 MiB |  14248 MiB |  13694 MiB |
|       from small pool |  36864 KiB |     56 MiB |     72 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |   1606 TiB |   1606 TiB |
|       from large pool |  24320 KiB | 675647 KiB |   1574 TiB |   1574 TiB |
|       from small pool |      0 KiB |  31476 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7877    |  410950 K  |  410950 K  |
|       from large pool |       2    |     756    |  206555 K  |  206555 K  |
|       from small pool |       0    |    7745    |  204394 K  |  204394 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7877    |  410950 K  |  410950 K  |
|       from large pool |       2    |     756    |  206555 K  |  206555 K  |
|       from small pool |       0    |    7745    |  204394 K  |  204394 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     337    |     629    |     586    |
|       from large pool |      25    |     309    |     593    |     568    |
|       from small pool |      18    |      28    |      36    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3607    |  252452 K  |  252452 K  |
|       from large pool |       3    |     307    |  157606 K  |  157606 K  |
|       from small pool |       0    |    3580    |   94845 K  |   94845 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054

 Experiment start at: 2024-07-02 04:01:15.028870
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9904596, 'precision': 0.99141026, 'recall': 0.98397076, 'specificity': 0.98397076, 'f1': 0.987614, 'auroc': 0.9988954, 'binary_precision': 0.9933685, 'binary_recall': 0.97025776, 'binary_specificity': 0.99768376, 'binary_f1_score': 0.9816771}
confusion matrix:
       0      1
0  42212     98
1    450  14680
---- Validation: 
scalar performance:
{'acc': 0.9668673, 'precision': 0.7312403, 'recall': 0.7066362, 'specificity': 0.7066362, 'f1': 0.7181715, 'auroc': 0.92166424, 'binary_precision': 0.48134327, 'binary_recall': 0.42857143, 'binary_specificity': 0.9847009, 'binary_f1_score': 0.45342705}
confusion matrix:
       0    1
0  17893  278
1    344  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9724315, 'precision': 0.827085, 'recall': 0.7774717, 'specificity': 0.7774717, 'f1': 0.8000273, 'auroc': 0.89820415, 'binary_precision': 0.67156863, 'binary_recall': 0.5661157, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.61434984}
confusion matrix:
      0    1
0  5930   67
1   105  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-02 04:23:55.556025,epoch time: 0:22:40.527155,used: 0:22:40.527155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9916783, 'precision': 0.9938052, 'recall': 0.9847758, 'specificity': 0.9847758, 'f1': 0.9891788, 'auroc': 0.9994689, 'binary_precision': 0.9981639, 'binary_recall': 0.9701897, 'binary_specificity': 0.9993619, 'binary_f1_score': 0.98397803}
confusion matrix:
       0      1
0  42284     27
1    451  14678
---- Validation: 
scalar performance:
{'acc': 0.9653758, 'precision': 0.7285832, 'recall': 0.79901934, 'specificity': 0.79901934, 'f1': 0.7585342, 'auroc': 0.94850063, 'binary_precision': 0.46984926, 'binary_recall': 0.62126243, 'binary_specificity': 0.9767762, 'binary_f1_score': 0.53505003}
confusion matrix:
       0    1
0  17749  422
1    228  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.968745, 'precision': 0.79158896, 'recall': 0.78348505, 'specificity': 0.78348505, 'f1': 0.7874732, 'auroc': 0.92787075, 'binary_precision': 0.6, 'binary_recall': 0.58264464, 'binary_specificity': 0.98432547, 'binary_f1_score': 0.591195}
confusion matrix:
      0    1
0  5903   94
1   101  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_2.png
early stop counter: 1
val acc:0.9653757810592651, best validation acc: 0.9668673276901245, corresponding to test acc:                         0.972431480884552 / 0.972431480884552
after epoch: 2,now: 2024-07-02 04:45:59.322532,epoch time: 0:22:03.766507,used: 0:44:44.293662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99402857, 'precision': 0.9951837, 'recall': 0.9894285, 'specificity': 0.9894285, 'f1': 0.9922607, 'auroc': 0.9994948, 'binary_precision': 0.9975771, 'binary_recall': 0.97970784, 'binary_specificity': 0.99914914, 'binary_f1_score': 0.9885617}
confusion matrix:
       0      1
0  42275     36
1    307  14822
---- Validation: 
scalar performance:
{'acc': 0.9718745, 'precision': 0.7737736, 'recall': 0.7702544, 'specificity': 0.7702544, 'f1': 0.7720015, 'auroc': 0.9529543, 'binary_precision': 0.56228954, 'binary_recall': 0.55481726, 'binary_specificity': 0.9856915, 'binary_f1_score': 0.5585284}
confusion matrix:
       0    1
0  17911  260
1    268  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.77111083, 'recall': 0.7321657, 'specificity': 0.7321657, 'f1': 0.749951, 'auroc': 0.9199203, 'binary_precision': 0.5631068, 'binary_recall': 0.47933885, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.51785713}
confusion matrix:
      0    1
0  5907   90
1   126  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_3.png
better model found
persisted
after epoch: 3,now: 2024-07-02 05:08:08.659063,epoch time: 0:22:09.336531,used: 1:06:53.630193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9916086, 'precision': 0.9941641, 'recall': 0.98426247, 'specificity': 0.98426247, 'f1': 0.9890791, 'auroc': 0.99950004, 'binary_precision': 0.9993863, 'binary_recall': 0.9687376, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.9838233}
confusion matrix:
       0      1
0  42301      9
1    473  14657
---- Validation: 
scalar performance:
{'acc': 0.9754435, 'precision': 0.8381136, 'recall': 0.70544493, 'specificity': 0.70544493, 'f1': 0.7543431, 'auroc': 0.9528158, 'binary_precision': 0.69529086, 'binary_recall': 0.41694352, 'binary_specificity': 0.9939464, 'binary_f1_score': 0.5212877}
confusion matrix:
       0    1
0  18061  110
1    351  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97323287, 'precision': 0.93875897, 'recall': 0.67280334, 'specificity': 0.67280334, 'f1': 0.7438699, 'auroc': 0.93899906, 'binary_precision': 0.9032258, 'binary_recall': 0.34710744, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.50149256}
confusion matrix:
      0   1
0  5988   9
1   158  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-02 05:30:15.446961,epoch time: 0:22:06.787898,used: 1:29:00.418091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99496865, 'precision': 0.9963433, 'recall': 0.9907036, 'specificity': 0.9907036, 'f1': 0.99347997, 'auroc': 0.99962854, 'binary_precision': 0.99919266, 'binary_recall': 0.98169076, 'binary_specificity': 0.9997164, 'binary_f1_score': 0.99036443}
confusion matrix:
       0      1
0  42299     12
1    277  14852
---- Validation: 
scalar performance:
{'acc': 0.97224736, 'precision': 0.7866177, 'recall': 0.7118245, 'specificity': 0.7118245, 'f1': 0.74310327, 'auroc': 0.9454982, 'binary_precision': 0.59183675, 'binary_recall': 0.43355483, 'binary_specificity': 0.9900941, 'binary_f1_score': 0.5004794}
confusion matrix:
       0    1
0  17991  180
1    341  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495111, 'precision': 0.6382325, 'recall': 0.6089126, 'specificity': 0.6089126, 'f1': 0.621497, 'auroc': 0.89572537, 'binary_precision': 0.3068783, 'binary_recall': 0.23966943, 'binary_specificity': 0.97815573, 'binary_f1_score': 0.26914153}
confusion matrix:
      0    1
0  5866  131
1   184   58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_5.png
early stop counter: 1
val acc:0.9722473621368408, best validation acc: 0.9754434823989868, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 5,now: 2024-07-02 05:51:47.087837,epoch time: 0:21:31.640876,used: 1:50:32.058967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9946553, 'precision': 0.9961108, 'recall': 0.99013054, 'specificity': 0.99013054, 'f1': 0.9930718, 'auroc': 0.99964225, 'binary_precision': 0.9991245, 'binary_recall': 0.9805684, 'binary_specificity': 0.99969274, 'binary_f1_score': 0.9897595}
confusion matrix:
       0      1
0  42297     13
1    294  14836
---- Validation: 
scalar performance:
{'acc': 0.96793264, 'precision': 0.73828185, 'recall': 0.63651824, 'specificity': 0.63651824, 'f1': 0.67224395, 'auroc': 0.93938774, 'binary_precision': 0.5, 'binary_recall': 0.28239202, 'binary_specificity': 0.99064445, 'binary_f1_score': 0.36093417}
confusion matrix:
       0    1
0  18001  170
1    432  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.7102105, 'recall': 0.61589783, 'specificity': 0.61589783, 'f1': 0.6476441, 'auroc': 0.916815, 'binary_precision': 0.45038167, 'binary_recall': 0.24380165, 'binary_specificity': 0.987994, 'binary_f1_score': 0.3163539}
confusion matrix:
      0   1
0  5925  72
1   183  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_6.png
early stop counter: 2
val acc:0.9679326415061951, best validation acc: 0.9754434823989868, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 6,now: 2024-07-02 06:13:08.590154,epoch time: 0:21:21.502317,used: 2:11:53.561284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99385446, 'precision': 0.9951762, 'recall': 0.98899186, 'specificity': 0.98899186, 'f1': 0.9920316, 'auroc': 0.9993321, 'binary_precision': 0.9979108, 'binary_recall': 0.9787164, 'binary_specificity': 0.99926734, 'binary_f1_score': 0.9882204}
confusion matrix:
       0      1
0  42280     31
1    322  14807
---- Validation: 
scalar performance:
{'acc': 0.96633464, 'precision': 0.7334467, 'recall': 0.7906811, 'specificity': 0.7906811, 'f1': 0.7585727, 'auroc': 0.9533037, 'binary_precision': 0.48015872, 'binary_recall': 0.60299003, 'binary_specificity': 0.97837216, 'binary_f1_score': 0.53460974}
confusion matrix:
       0    1
0  17778  393
1    239  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.73764914, 'recall': 0.6368925, 'specificity': 0.6368925, 'f1': 0.6720985, 'auroc': 0.9206673, 'binary_precision': 0.50364965, 'binary_recall': 0.28512397, 'binary_specificity': 0.988661, 'binary_f1_score': 0.3641161}
confusion matrix:
      0   1
0  5929  68
1   173  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_7.png
early stop counter: 3
val acc:0.9663346409797668, best validation acc: 0.9754434823989868, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 7,now: 2024-07-02 06:34:28.498549,epoch time: 0:21:19.908395,used: 2:33:13.469679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99235725, 'precision': 0.9868873, 'recall': 0.9936869, 'specificity': 0.9936869, 'f1': 0.9902209, 'auroc': 0.9997177, 'binary_precision': 0.97503716, 'binary_recall': 0.99649704, 'binary_specificity': 0.99087685, 'binary_f1_score': 0.98565024}
confusion matrix:
       0      1
0  41924    386
1     53  15077
---- Validation: 
scalar performance:
{'acc': 0.9565866, 'precision': 0.7016616, 'recall': 0.8836175, 'specificity': 0.8836175, 'f1': 0.76031363, 'auroc': 0.95907336, 'binary_precision': 0.40997463, 'binary_recall': 0.80564785, 'binary_specificity': 0.96158713, 'binary_f1_score': 0.5434174}
confusion matrix:
       0    1
0  17473  698
1    117  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548004, 'precision': 0.70568365, 'recall': 0.74450755, 'specificity': 0.74450755, 'f1': 0.72315925, 'auroc': 0.912459, 'binary_precision': 0.43103448, 'binary_recall': 0.5165289, 'binary_specificity': 0.97248626, 'binary_f1_score': 0.46992478}
confusion matrix:
      0    1
0  5832  165
1   117  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_8.png
early stop counter: 4
val acc:0.9565865993499756, best validation acc: 0.9754434823989868, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 8,now: 2024-07-02 06:55:38.170341,epoch time: 0:21:09.671792,used: 2:54:23.141471,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99625695, 'precision': 0.9948553, 'recall': 0.9955059, 'specificity': 0.9955059, 'f1': 0.9951801, 'auroc': 0.99981856, 'binary_precision': 0.99188656, 'binary_recall': 0.99391896, 'binary_specificity': 0.99709296, 'binary_f1_score': 0.99290174}
confusion matrix:
       0      1
0  42188    123
1     92  15037
---- Validation: 
scalar performance:
{'acc': 0.9745379, 'precision': 0.79366493, 'recall': 0.8021461, 'specificity': 0.8021461, 'f1': 0.79783934, 'auroc': 0.952695, 'binary_precision': 0.6, 'binary_recall': 0.6179402, 'binary_specificity': 0.9863519, 'binary_f1_score': 0.608838}
confusion matrix:
       0    1
0  17923  248
1    230  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9469466, 'precision': 0.62844944, 'recall': 0.6115441, 'specificity': 0.6115441, 'f1': 0.619277, 'auroc': 0.89283, 'binary_precision': 0.28708133, 'binary_recall': 0.24793388, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.26607537}
confusion matrix:
      0    1
0  5848  149
1   182   60
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_9.png
early stop counter: 5
val acc:0.9745379090309143, best validation acc: 0.9754434823989868, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 9,now: 2024-07-02 07:16:44.504201,epoch time: 0:21:06.333860,used: 3:15:29.475331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9963266, 'precision': 0.9971702, 'recall': 0.99336636, 'specificity': 0.99336636, 'f1': 0.99524844, 'auroc': 0.99984217, 'binary_precision': 0.99892974, 'binary_recall': 0.98711085, 'binary_specificity': 0.99962187, 'binary_f1_score': 0.9929851}
confusion matrix:
       0      1
0  42295     16
1    195  14934
---- Validation: 
scalar performance:
{'acc': 0.97150165, 'precision': 0.85220397, 'recall': 0.5869667, 'specificity': 0.5869667, 'f1': 0.6346317, 'auroc': 0.94497526, 'binary_precision': 0.73103446, 'binary_recall': 0.17607974, 'binary_specificity': 0.9978537, 'binary_f1_score': 0.28380188}
confusion matrix:
       0    1
0  18132   39
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.6685381, 'recall': 0.51156294, 'specificity': 0.51156294, 'f1': 0.5131903, 'auroc': 0.91856897, 'binary_precision': 0.375, 'binary_recall': 0.024793388, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.046511628}
confusion matrix:
      0   1
0  5987  10
1   236   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_10.png
early stop counter: 6
val acc:0.9715016484260559, best validation acc: 0.9754434823989868, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 10,now: 2024-07-02 07:37:39.909620,epoch time: 0:20:55.405419,used: 3:36:24.880750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9966922, 'precision': 0.99664426, 'recall': 0.994825, 'specificity': 0.994825, 'f1': 0.9957301, 'auroc': 0.99980724, 'binary_precision': 0.99654347, 'binary_recall': 0.99087906, 'binary_specificity': 0.99877095, 'binary_f1_score': 0.99370325}
confusion matrix:
       0      1
0  42258     52
1    138  14992
---- Validation: 
scalar performance:
{'acc': 0.9737389, 'precision': 0.7852349, 'recall': 0.8121729, 'specificity': 0.8121729, 'f1': 0.798036, 'auroc': 0.95754075, 'binary_precision': 0.5824508, 'binary_recall': 0.6395349, 'binary_specificity': 0.98481095, 'binary_f1_score': 0.60965955}
confusion matrix:
       0    1
0  17895  276
1    217  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9469466, 'precision': 0.6227108, 'recall': 0.60163033, 'specificity': 0.60163033, 'f1': 0.6109673, 'auroc': 0.90522015, 'binary_precision': 0.2763819, 'binary_recall': 0.22727273, 'binary_specificity': 0.975988, 'binary_f1_score': 0.2494331}
confusion matrix:
      0    1
0  5853  144
1   187   55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_11.png
early stop counter: 7
val acc:0.9737389087677002, best validation acc: 0.9754434823989868, corresponding to test acc:                         0.9732328653335571 / 0.9732328653335571
after epoch: 11,now: 2024-07-02 07:58:37.988168,epoch time: 0:20:58.078548,used: 3:57:22.959298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99623954, 'precision': 0.9971332, 'recall': 0.9931803, 'specificity': 0.9931803, 'f1': 0.99513537, 'auroc': 0.99966323, 'binary_precision': 0.99899626, 'binary_recall': 0.98671514, 'binary_specificity': 0.9996455, 'binary_f1_score': 0.99281776}
confusion matrix:
       0      1
0  42295     15
1    201  14929
---- Validation: 
scalar performance:
{'acc': 0.97555, 'precision': 0.89098835, 'recall': 0.655711, 'specificity': 0.655711, 'f1': 0.71955454, 'auroc': 0.9523166, 'binary_precision': 0.8042553, 'binary_recall': 0.3139535, 'binary_specificity': 0.9974685, 'binary_f1_score': 0.4516129}
confusion matrix:
       0    1
0  18125   46
1    413  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.8260281, 'recall': 0.5446208, 'specificity': 0.5446208, 'f1': 0.57086885, 'auroc': 0.9355642, 'binary_precision': 0.6875, 'binary_recall': 0.09090909, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.16058393}
confusion matrix:
      0   1
0  5987  10
1   220  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_12.png
better model found
persisted
after epoch: 12,now: 2024-07-02 08:19:32.606991,epoch time: 0:20:54.618823,used: 4:18:17.578121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9972493, 'precision': 0.99772906, 'recall': 0.9951819, 'specificity': 0.9951819, 'f1': 0.9964466, 'auroc': 0.99987185, 'binary_precision': 0.9987342, 'binary_recall': 0.99081296, 'binary_specificity': 0.99955094, 'binary_f1_score': 0.9947578}
confusion matrix:
       0      1
0  42291     19
1    139  14991
---- Validation: 
scalar performance:
{'acc': 0.9717147, 'precision': 0.77611184, 'recall': 0.7364438, 'specificity': 0.7364438, 'f1': 0.75459564, 'auroc': 0.95267344, 'binary_precision': 0.56920075, 'binary_recall': 0.48504984, 'binary_specificity': 0.9878378, 'binary_f1_score': 0.5237668}
confusion matrix:
       0    1
0  17950  221
1    310  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.7235936, 'recall': 0.6066511, 'specificity': 0.6066511, 'f1': 0.6419254, 'auroc': 0.93230915, 'binary_precision': 0.4778761, 'binary_recall': 0.2231405, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.30422533}
confusion matrix:
      0   1
0  5938  59
1   188  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_13.png
early stop counter: 1
val acc:0.9717146754264832, best validation acc: 0.9755499958992004, corresponding to test acc:                         0.9631351232528687 / 0.9732328653335571
after epoch: 13,now: 2024-07-02 08:40:29.197021,epoch time: 0:20:56.590030,used: 4:39:14.168151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9969185, 'precision': 0.9971184, 'recall': 0.99493587, 'specificity': 0.99493587, 'f1': 0.99602056, 'auroc': 0.9998182, 'binary_precision': 0.9975376, 'binary_recall': 0.99074626, 'binary_specificity': 0.99912554, 'binary_f1_score': 0.9941303}
confusion matrix:
       0      1
0  42274     37
1    140  14989
---- Validation: 
scalar performance:
{'acc': 0.9718745, 'precision': 0.89063, 'recall': 0.5799319, 'specificity': 0.5799319, 'f1': 0.6271798, 'auroc': 0.95473266, 'binary_precision': 0.80833334, 'binary_recall': 0.16112956, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.26869807}
confusion matrix:
       0   1
0  18148  23
1    505  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.8145442, 'recall': 0.5161954, 'specificity': 0.5161954, 'f1': 0.5217611, 'auroc': 0.9139139, 'binary_precision': 0.6666667, 'binary_recall': 0.03305785, 'binary_specificity': 0.999333, 'binary_f1_score': 0.062992126}
confusion matrix:
      0  1
0  5993  4
1   234  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_14.png
early stop counter: 2
val acc:0.971874475479126, best validation acc: 0.9755499958992004, corresponding to test acc:                         0.9631351232528687 / 0.9732328653335571
after epoch: 14,now: 2024-07-02 09:01:24.095718,epoch time: 0:20:54.898697,used: 5:00:09.066848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9961351, 'precision': 0.99730265, 'recall': 0.9927485, 'specificity': 0.9927485, 'f1': 0.9949972, 'auroc': 0.9998261, 'binary_precision': 0.99973184, 'binary_recall': 0.98559153, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9926113}
confusion matrix:
       0      1
0  42306      4
1    218  14912
---- Validation: 
scalar performance:
{'acc': 0.97096896, 'precision': 0.85029876, 'recall': 0.5746458, 'specificity': 0.5746458, 'f1': 0.61777085, 'auroc': 0.9393738, 'binary_precision': 0.728, 'binary_recall': 0.15116279, 'binary_specificity': 0.9981289, 'binary_f1_score': 0.25034386}
confusion matrix:
       0   1
0  18137  34
1    511  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.84427506, 'recall': 0.54272145, 'specificity': 0.54272145, 'f1': 0.5681109, 'auroc': 0.9218041, 'binary_precision': 0.7241379, 'binary_recall': 0.08677686, 'binary_specificity': 0.998666, 'binary_f1_score': 0.15498155}
confusion matrix:
      0   1
0  5989   8
1   221  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_15.png
early stop counter: 3
val acc:0.9709689617156982, best validation acc: 0.9755499958992004, corresponding to test acc:                         0.9631351232528687 / 0.9732328653335571
after epoch: 15,now: 2024-07-02 09:22:32.404189,epoch time: 0:21:08.308471,used: 5:21:17.375319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99505574, 'precision': 0.99488807, 'recall': 0.99235547, 'specificity': 0.99235547, 'f1': 0.99361295, 'auroc': 0.99968433, 'binary_precision': 0.994537, 'binary_recall': 0.98664904, 'binary_specificity': 0.9980619, 'binary_f1_score': 0.99057734}
confusion matrix:
       0      1
0  42228     82
1    202  14928
---- Validation: 
scalar performance:
{'acc': 0.9710755, 'precision': 0.8143901, 'recall': 0.6020045, 'specificity': 0.6020045, 'f1': 0.6502421, 'auroc': 0.9492521, 'binary_precision': 0.65445024, 'binary_recall': 0.2076412, 'binary_specificity': 0.9963678, 'binary_f1_score': 0.3152585}
confusion matrix:
       0    1
0  18105   66
1    477  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.8200208, 'recall': 0.5587501, 'specificity': 0.5587501, 'f1': 0.59244573, 'auroc': 0.9371232, 'binary_precision': 0.6744186, 'binary_recall': 0.11983471, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.20350878}
confusion matrix:
      0   1
0  5983  14
1   213  29
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_16.png
early stop counter: 4
val acc:0.9710754752159119, best validation acc: 0.9755499958992004, corresponding to test acc:                         0.9631351232528687 / 0.9732328653335571
after epoch: 16,now: 2024-07-02 09:43:32.418053,epoch time: 0:21:00.013864,used: 5:42:17.389183,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99629176, 'precision': 0.9954828, 'recall': 0.9949564, 'specificity': 0.9949564, 'f1': 0.99521923, 'auroc': 0.9997755, 'binary_precision': 0.9937765, 'binary_recall': 0.99213433, 'binary_specificity': 0.99777836, 'binary_f1_score': 0.9929547}
confusion matrix:
       0      1
0  42217     94
1    119  15010
---- Validation: 
scalar performance:
{'acc': 0.96569544, 'precision': 0.7333867, 'recall': 0.841746, 'specificity': 0.841746, 'f1': 0.7761142, 'auroc': 0.9576974, 'binary_precision': 0.4765625, 'binary_recall': 0.7093023, 'binary_specificity': 0.97418964, 'binary_f1_score': 0.57009345}
confusion matrix:
       0    1
0  17702  469
1    175  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93845165, 'precision': 0.6134662, 'recall': 0.6348835, 'specificity': 0.6348835, 'f1': 0.6230254, 'auroc': 0.89922714, 'binary_precision': 0.2551724, 'binary_recall': 0.30578512, 'binary_specificity': 0.963982, 'binary_f1_score': 0.27819547}
confusion matrix:
      0    1
0  5781  216
1   168   74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_17.png
early stop counter: 5
val acc:0.9656954407691956, best validation acc: 0.9755499958992004, corresponding to test acc:                         0.9631351232528687 / 0.9732328653335571
after epoch: 17,now: 2024-07-02 10:04:40.683858,epoch time: 0:21:08.265805,used: 6:03:25.654988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9974582, 'precision': 0.99797815, 'recall': 0.9954724, 'specificity': 0.9954724, 'f1': 0.9967167, 'auroc': 0.9998557, 'binary_precision': 0.9990674, 'binary_recall': 0.9912756, 'binary_specificity': 0.99966913, 'binary_f1_score': 0.9951563}
confusion matrix:
       0      1
0  42296     14
1    132  14998
---- Validation: 
scalar performance:
{'acc': 0.97299314, 'precision': 0.82757664, 'recall': 0.64796585, 'specificity': 0.64796585, 'f1': 0.7013737, 'auroc': 0.9526228, 'binary_precision': 0.67790264, 'binary_recall': 0.30066445, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.41657075}
confusion matrix:
       0    1
0  18085   86
1    421  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95656353, 'precision': 0.63556886, 'recall': 0.5431852, 'specificity': 0.5431852, 'f1': 0.56141305, 'auroc': 0.90405846, 'binary_precision': 0.30666667, 'binary_recall': 0.09504132, 'binary_specificity': 0.991329, 'binary_f1_score': 0.1451104}
confusion matrix:
      0   1
0  5945  52
1   219  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_18.png
early stop counter: 6
val acc:0.9729931354522705, best validation acc: 0.9755499958992004, corresponding to test acc:                         0.9631351232528687 / 0.9732328653335571
after epoch: 18,now: 2024-07-02 10:25:58.135402,epoch time: 0:21:17.451544,used: 6:24:43.106532,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9973363, 'precision': 0.9981117, 'recall': 0.99502873, 'specificity': 0.99502873, 'f1': 0.99655724, 'auroc': 0.9998724, 'binary_precision': 0.9997331, 'binary_recall': 0.990152, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9949195}
confusion matrix:
       0      1
0  42306      4
1    149  14981
---- Validation: 
scalar performance:
{'acc': 0.9765088, 'precision': 0.81956995, 'recall': 0.77987576, 'specificity': 0.77987576, 'f1': 0.79829323, 'auroc': 0.96058774, 'binary_precision': 0.6533333, 'binary_recall': 0.5697674, 'binary_specificity': 0.98998404, 'binary_f1_score': 0.6086956}
confusion matrix:
       0    1
0  17989  182
1    259  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.725186, 'recall': 0.66191775, 'specificity': 0.66191775, 'f1': 0.68770623, 'auroc': 0.9303093, 'binary_precision': 0.47674417, 'binary_recall': 0.338843, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.39613527}
confusion matrix:
      0   1
0  5907  90
1   160  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_19.png
better model found
persisted
after epoch: 19,now: 2024-07-02 10:48:20.823708,epoch time: 0:22:22.688306,used: 6:47:05.794838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99768454, 'precision': 0.9979383, 'recall': 0.9960928, 'specificity': 0.9960928, 'f1': 0.9970109, 'auroc': 0.9998674, 'binary_precision': 0.99847096, 'binary_recall': 0.9927292, 'binary_specificity': 0.9994564, 'binary_f1_score': 0.9955918}
confusion matrix:
       0      1
0  42288     23
1    110  15019
---- Validation: 
scalar performance:
{'acc': 0.97853297, 'precision': 0.83852154, 'recall': 0.79537624, 'specificity': 0.79537624, 'f1': 0.8153564, 'auroc': 0.9631758, 'binary_precision': 0.69024855, 'binary_recall': 0.5996678, 'binary_specificity': 0.9910847, 'binary_f1_score': 0.6417778}
confusion matrix:
       0    1
0  18009  162
1    241  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.81688154, 'recall': 0.6537732, 'specificity': 0.6537732, 'f1': 0.70442873, 'auroc': 0.94223195, 'binary_precision': 0.66086954, 'binary_recall': 0.3140496, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.4257703}
confusion matrix:
      0   1
0  5958  39
1   166  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_20.png
better model found
persisted
after epoch: 20,now: 2024-07-02 11:12:01.113180,epoch time: 0:23:40.289472,used: 7:10:46.084310,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9972667, 'precision': 0.99627936, 'recall': 0.99667954, 'specificity': 0.99667954, 'f1': 0.9964793, 'auroc': 0.99976, 'binary_precision': 0.9941903, 'binary_recall': 0.99543893, 'binary_specificity': 0.9979202, 'binary_f1_score': 0.9948142}
confusion matrix:
       0      1
0  42224     88
1     69  15059
---- Validation: 
scalar performance:
{'acc': 0.97555, 'precision': 0.7941212, 'recall': 0.8564731, 'specificity': 0.8564731, 'f1': 0.82200885, 'auroc': 0.9605342, 'binary_precision': 0.5972789, 'binary_recall': 0.7292359, 'binary_specificity': 0.9837103, 'binary_f1_score': 0.6566941}
confusion matrix:
       0    1
0  17875  296
1    163  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96906555, 'precision': 0.7945416, 'recall': 0.781669, 'specificity': 0.781669, 'f1': 0.7879448, 'auroc': 0.95089245, 'binary_precision': 0.6060606, 'binary_recall': 0.5785124, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.5919662}
confusion matrix:
      0    1
0  5906   91
1   102  140
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_21.png
early stop counter: 1
val acc:0.9755499958992004, best validation acc: 0.9785329699516296, corresponding to test acc:                         0.9671421647071838 / 0.9732328653335571
after epoch: 21,now: 2024-07-02 11:33:55.192626,epoch time: 0:21:54.079446,used: 7:32:40.163756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9955606, 'precision': 0.9926411, 'recall': 0.9959887, 'specificity': 0.9959887, 'f1': 0.9942992, 'auroc': 0.999845, 'binary_precision': 0.9863972, 'binary_recall': 0.9968936, 'binary_specificity': 0.9950839, 'binary_f1_score': 0.9916176}
confusion matrix:
       0      1
0  42102    208
1     47  15083
---- Validation: 
scalar performance:
{'acc': 0.9776807, 'precision': 0.8236891, 'recall': 0.8085878, 'specificity': 0.8085878, 'f1': 0.81594205, 'auroc': 0.959587, 'binary_precision': 0.65968585, 'binary_recall': 0.627907, 'binary_specificity': 0.9892686, 'binary_f1_score': 0.64340425}
confusion matrix:
       0    1
0  17976  195
1    224  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.7484579, 'recall': 0.7266994, 'specificity': 0.7266994, 'f1': 0.7370162, 'auroc': 0.93156147, 'binary_precision': 0.5181818, 'binary_recall': 0.47107437, 'binary_specificity': 0.9823245, 'binary_f1_score': 0.4935065}
confusion matrix:
      0    1
0  5891  106
1   128  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_22.png
early stop counter: 2
val acc:0.9776806831359863, best validation acc: 0.9785329699516296, corresponding to test acc:                         0.9671421647071838 / 0.9732328653335571
after epoch: 22,now: 2024-07-02 11:55:46.582637,epoch time: 0:21:51.390011,used: 7:54:31.553767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9952472, 'precision': 0.9924799, 'recall': 0.9953302, 'specificity': 0.9953302, 'f1': 0.9938937, 'auroc': 0.9998293, 'binary_precision': 0.9865723, 'binary_recall': 0.99550563, 'binary_specificity': 0.9951548, 'binary_f1_score': 0.99101883}
confusion matrix:
       0      1
0  42105    205
1     68  15062
---- Validation: 
scalar performance:
{'acc': 0.9730464, 'precision': 0.7828002, 'recall': 0.7837085, 'specificity': 0.7837085, 'f1': 0.78325355, 'auroc': 0.96024346, 'binary_precision': 0.5794702, 'binary_recall': 0.5813953, 'binary_specificity': 0.9860217, 'binary_f1_score': 0.58043116}
confusion matrix:
       0    1
0  17917  254
1    252  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9567238, 'precision': 0.68983716, 'recall': 0.62257814, 'specificity': 0.62257814, 'f1': 0.6479173, 'auroc': 0.92698675, 'binary_precision': 0.4090909, 'binary_recall': 0.2603306, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.3181818}
confusion matrix:
      0   1
0  5906  91
1   179  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_23.png
early stop counter: 3
val acc:0.9730464220046997, best validation acc: 0.9785329699516296, corresponding to test acc:                         0.9671421647071838 / 0.9732328653335571
after epoch: 23,now: 2024-07-02 12:17:25.822410,epoch time: 0:21:39.239773,used: 8:16:10.793540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9985376, 'precision': 0.9988377, 'recall': 0.9973937, 'specificity': 0.9973937, 'f1': 0.9981129, 'auroc': 0.99995345, 'binary_precision': 0.9994688, 'binary_recall': 0.9949765, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.9972176}
confusion matrix:
       0      1
0  42303      8
1     76  15053
---- Validation: 
scalar performance:
{'acc': 0.97821337, 'precision': 0.87341845, 'recall': 0.7293612, 'specificity': 0.7293612, 'f1': 0.78293055, 'auroc': 0.96715045, 'binary_precision': 0.76438355, 'binary_recall': 0.46345514, 'binary_specificity': 0.9952672, 'binary_f1_score': 0.5770424}
confusion matrix:
       0    1
0  18085   86
1    323  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.7708138, 'recall': 0.6682177, 'specificity': 0.6682177, 'f1': 0.706202, 'auroc': 0.9415946, 'binary_precision': 0.5675676, 'binary_recall': 0.34710744, 'binary_specificity': 0.989328, 'binary_f1_score': 0.43076923}
confusion matrix:
      0   1
0  5933  64
1   158  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_24.png
early stop counter: 4
val acc:0.978213369846344, best validation acc: 0.9785329699516296, corresponding to test acc:                         0.9671421647071838 / 0.9732328653335571
after epoch: 24,now: 2024-07-02 12:39:16.490661,epoch time: 0:21:50.668251,used: 8:38:01.461791,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.997406, 'precision': 0.9981587, 'recall': 0.9951606, 'specificity': 0.9951606, 'f1': 0.99664736, 'auroc': 0.9998131, 'binary_precision': 0.9997331, 'binary_recall': 0.99041575, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99505264}
confusion matrix:
       0      1
0  42307      4
1    145  14984
---- Validation: 
scalar performance:
{'acc': 0.97235394, 'precision': 0.8520011, 'recall': 0.60828626, 'specificity': 0.60828626, 'f1': 0.66152364, 'auroc': 0.95712435, 'binary_precision': 0.7292818, 'binary_recall': 0.2192691, 'binary_specificity': 0.99730337, 'binary_f1_score': 0.33716476}
confusion matrix:
       0    1
0  18122   49
1    470  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.7463782, 'recall': 0.6134331, 'specificity': 0.6134331, 'f1': 0.65262157, 'auroc': 0.9488734, 'binary_precision': 0.5229358, 'binary_recall': 0.23553719, 'binary_specificity': 0.991329, 'binary_f1_score': 0.32478634}
confusion matrix:
      0   1
0  5945  52
1   185  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_25.png
early stop counter: 5
val acc:0.9723539352416992, best validation acc: 0.9785329699516296, corresponding to test acc:                         0.9671421647071838 / 0.9732328653335571
after epoch: 25,now: 2024-07-02 13:01:23.438566,epoch time: 0:22:06.947905,used: 9:00:08.409696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9956476, 'precision': 0.997063, 'recall': 0.99173826, 'specificity': 0.99173826, 'f1': 0.9943619, 'auroc': 0.99989104, 'binary_precision': 1.0, 'binary_recall': 0.9834765, 'binary_specificity': 1.0, 'binary_f1_score': 0.9916694}
confusion matrix:
       0      1
0  42310      0
1    250  14880
---- Validation: 
scalar performance:
{'acc': 0.9704363, 'precision': 0.83322155, 'recall': 0.5687493, 'specificity': 0.5687493, 'f1': 0.6086465, 'auroc': 0.9447378, 'binary_precision': 0.6942149, 'binary_recall': 0.13953489, 'binary_specificity': 0.9979638, 'binary_f1_score': 0.23236515}
confusion matrix:
       0   1
0  18134  37
1    518  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95832664, 'precision': 0.6619547, 'recall': 0.54410225, 'specificity': 0.54410225, 'f1': 0.56448317, 'auroc': 0.905045, 'binary_precision': 0.359375, 'binary_recall': 0.09504132, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.15032679}
confusion matrix:
      0   1
0  5956  41
1   219  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_26.png
early stop counter: 6
val acc:0.9704362750053406, best validation acc: 0.9785329699516296, corresponding to test acc:                         0.9671421647071838 / 0.9732328653335571
after epoch: 26,now: 2024-07-02 13:23:15.285358,epoch time: 0:21:51.846792,used: 9:22:00.256488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99766713, 'precision': 0.9976915, 'recall': 0.9962933, 'specificity': 0.9962933, 'f1': 0.9969897, 'auroc': 0.9998238, 'binary_precision': 0.99774283, 'binary_recall': 0.9933902, 'binary_specificity': 0.9991964, 'binary_f1_score': 0.9955618}
confusion matrix:
       0      1
0  42277     34
1    100  15029
---- Validation: 
scalar performance:
{'acc': 0.97283334, 'precision': 0.7885996, 'recall': 0.7354155, 'specificity': 0.7354155, 'f1': 0.75906026, 'auroc': 0.9429153, 'binary_precision': 0.5942623, 'binary_recall': 0.48172757, 'binary_specificity': 0.9891035, 'binary_f1_score': 0.5321101}
confusion matrix:
       0    1
0  17973  198
1    312  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.743294, 'recall': 0.6371426, 'specificity': 0.6371426, 'f1': 0.67367756, 'auroc': 0.9275671, 'binary_precision': 0.51492536, 'binary_recall': 0.28512397, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.3670213}
confusion matrix:
      0   1
0  5932  65
1   173  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_27.png
early stop counter: 7
val acc:0.9728333353996277, best validation acc: 0.9785329699516296, corresponding to test acc:                         0.9671421647071838 / 0.9732328653335571
after epoch: 27,now: 2024-07-02 13:44:48.747292,epoch time: 0:21:33.461934,used: 9:43:33.718422,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99787605, 'precision': 0.998433, 'recall': 0.9960954, 'specificity': 0.9960954, 'f1': 0.99725676, 'auroc': 0.9999362, 'binary_precision': 0.9996005, 'binary_recall': 0.9923326, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99595326}
confusion matrix:
       0      1
0  42305      6
1    116  15013
---- Validation: 
scalar performance:
{'acc': 0.96713364, 'precision': 0.7240936, 'recall': 0.60719573, 'specificity': 0.60719573, 'f1': 0.6429975, 'auroc': 0.91445464, 'binary_precision': 0.47349823, 'binary_recall': 0.22259136, 'binary_specificity': 0.9918001, 'binary_f1_score': 0.30282485}
confusion matrix:
       0    1
0  18022  149
1    468  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95928836, 'precision': 0.6312369, 'recall': 0.51684415, 'specificity': 0.51684415, 'f1': 0.5226835, 'auroc': 0.8776539, 'binary_precision': 0.3, 'binary_recall': 0.037190083, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.066176474}
confusion matrix:
      0   1
0  5976  21
1   233   9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_28.png
early stop counter: 8
val acc:0.967133641242981, best validation acc: 0.9785329699516296, corresponding to test acc:                         0.9671421647071838 / 0.9732328653335571
after epoch: 28,now: 2024-07-02 14:06:28.883075,epoch time: 0:21:40.135783,used: 10:05:13.854205,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99820685, 'precision': 0.99869967, 'recall': 0.99668086, 'specificity': 0.99668086, 'f1': 0.9976847, 'auroc': 0.9999616, 'binary_precision': 0.9997339, 'binary_recall': 0.9934563, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9965852}
confusion matrix:
       0      1
0  42307      4
1     99  15030
---- Validation: 
scalar performance:
{'acc': 0.974751, 'precision': 0.93769675, 'recall': 0.61916107, 'specificity': 0.61916107, 'f1': 0.6825334, 'auroc': 0.9631971, 'binary_precision': 0.9, 'binary_recall': 0.23920266, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.37795278}
confusion matrix:
       0    1
0  18155   16
1    458  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.8151515, 'recall': 0.53239083, 'specificity': 0.53239083, 'f1': 0.55056965, 'auroc': 0.9425775, 'binary_precision': 0.6666667, 'binary_recall': 0.0661157, 'binary_specificity': 0.998666, 'binary_f1_score': 0.120300755}
confusion matrix:
      0   1
0  5989   8
1   226  16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_29.png
early stop counter: 9
val acc:0.9747509956359863, best validation acc: 0.9785329699516296, corresponding to test acc:                         0.9671421647071838 / 0.9732328653335571
after epoch: 29,now: 2024-07-02 14:28:00.022349,epoch time: 0:21:31.139274,used: 10:26:44.993479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9981546, 'precision': 0.9985569, 'recall': 0.99668765, 'specificity': 0.99668765, 'f1': 0.9976175, 'auroc': 0.9998599, 'binary_precision': 0.99940157, 'binary_recall': 0.99358803, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.9964863}
confusion matrix:
       0      1
0  42303      9
1     97  15031
---- Validation: 
scalar performance:
{'acc': 0.97911894, 'precision': 0.8490349, 'recall': 0.78925455, 'specificity': 0.78925455, 'f1': 0.8161161, 'auroc': 0.95733476, 'binary_precision': 0.7116935, 'binary_recall': 0.58637875, 'binary_specificity': 0.99213034, 'binary_f1_score': 0.6429872}
confusion matrix:
       0    1
0  18028  143
1    249  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.73764914, 'recall': 0.6368925, 'specificity': 0.6368925, 'f1': 0.6720985, 'auroc': 0.92929536, 'binary_precision': 0.50364965, 'binary_recall': 0.28512397, 'binary_specificity': 0.988661, 'binary_f1_score': 0.3641161}
confusion matrix:
      0   1
0  5929  68
1   173  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629054_30.png
better model found
persisted
after epoch: 30,now: 2024-07-02 14:50:14.219010,epoch time: 0:22:14.196661,used: 10:48:59.190140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_04_01_15_seed_2_21629054
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:48:59.190140 at 2024-07-02 14:50:14.219010
persisted model performance metric: 

scalar performance:
{'acc': 0.961372, 'precision': 0.73764914, 'recall': 0.6368925, 'specificity': 0.6368925, 'f1': 0.6720985, 'auroc': 0.92929536, 'binary_precision': 0.50364965, 'binary_recall': 0.28512397, 'binary_specificity': 0.988661, 'binary_f1_score': 0.3641161}
confusion matrix:
      0   1
0  5929  68
1   173  69
oracle model performance metric: 

scalar performance:
{'acc': 0.97323287, 'precision': 0.93875897, 'recall': 0.67280334, 'specificity': 0.67280334, 'f1': 0.7438699, 'auroc': 0.93899906, 'binary_precision': 0.9032258, 'binary_recall': 0.34710744, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.50149256}
confusion matrix:
      0   1
0  5988   9
1   158  84
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 319321 KiB |   6783 MiB |   3310 TiB |   3310 TiB |
|       from large pool | 291059 KiB |   6756 MiB |   3262 TiB |   3262 TiB |
|       from small pool |  28262 KiB |     48 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 319321 KiB |   6783 MiB |   3310 TiB |   3310 TiB |
|       from large pool | 291059 KiB |   6756 MiB |   3262 TiB |   3262 TiB |
|       from small pool |  28262 KiB |     48 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 314121 KiB |   6778 MiB |   3306 TiB |   3306 TiB |
|       from large pool | 286862 KiB |   6752 MiB |   3259 TiB |   3259 TiB |
|       from small pool |  27259 KiB |     47 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7450 MiB |   7460 MiB |  21180 MiB |  13730 MiB |
|       from large pool |   7398 MiB |   7404 MiB |  21092 MiB |  13694 MiB |
|       from small pool |     52 MiB |     56 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 258214 KiB | 680184 KiB |   2416 TiB |   2416 TiB |
|       from large pool | 249613 KiB | 675647 KiB |   2368 TiB |   2368 TiB |
|       from small pool |   8601 KiB |  31476 KiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3218    |    7927    |  617201 K  |  617198 K  |
|       from large pool |     130    |     756    |  310168 K  |  310168 K  |
|       from small pool |    3088    |    7795    |  307032 K  |  307029 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3218    |    7927    |  617201 K  |  617198 K  |
|       from large pool |     130    |     756    |  310168 K  |  310168 K  |
|       from small pool |    3088    |    7795    |  307032 K  |  307029 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     337    |     921    |     586    |
|       from large pool |     309    |     309    |     877    |     568    |
|       from small pool |      26    |      28    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      58    |    3629    |  370386 K  |  370386 K  |
|       from large pool |      25    |     307    |  227903 K  |  227903 K  |
|       from small pool |      33    |    3605    |  142482 K  |  142482 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   3310 TiB |   3310 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   3262 TiB |   3262 TiB |
|       from small pool |      0 KiB |     48 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   3310 TiB |   3310 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   3262 TiB |   3262 TiB |
|       from small pool |      0 KiB |     48 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   3306 TiB |   3306 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   3259 TiB |   3259 TiB |
|       from small pool |      0 KiB |     47 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 577536 KiB |   7460 MiB |  21180 MiB |  20616 MiB |
|       from large pool | 540672 KiB |   7404 MiB |  21092 MiB |  20564 MiB |
|       from small pool |  36864 KiB |     56 MiB |     88 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |   2416 TiB |   2416 TiB |
|       from large pool |  24320 KiB | 675647 KiB |   2368 TiB |   2368 TiB |
|       from small pool |      0 KiB |  31476 KiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7927    |  617201 K  |  617201 K  |
|       from large pool |       2    |     756    |  310168 K  |  310168 K  |
|       from small pool |       0    |    7795    |  307032 K  |  307032 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7927    |  617201 K  |  617201 K  |
|       from large pool |       2    |     756    |  310168 K  |  310168 K  |
|       from small pool |       0    |    7795    |  307032 K  |  307032 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     337    |     921    |     879    |
|       from large pool |      24    |     309    |     877    |     853    |
|       from small pool |      18    |      28    |      44    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3629    |  370387 K  |  370387 K  |
|       from large pool |       3    |     307    |  227903 K  |  227903 K  |
|       from small pool |       0    |    3605    |  142483 K  |  142483 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul  2 14:51:40 2024]
Finished job 0.
2 of 2 steps (100%) done
