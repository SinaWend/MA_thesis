Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul  1 05:02:06 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058

 Experiment start at: 2024-07-01 05:08:55.760839
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9856592, 'precision': 0.9899272, 'recall': 0.972739, 'specificity': 0.972739, 'f1': 0.980942, 'auroc': 0.9988055, 'binary_precision': 0.9982791, 'binary_recall': 0.9460451, 'binary_specificity': 0.9994329, 'binary_f1_score': 0.97146046}
confusion matrix:
       0      1
0  42300     24
1    794  13922
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96737975, 'precision': 0.759753, 'recall': 0.6388366, 'specificity': 0.6388366, 'f1': 0.6791901, 'auroc': 0.9308628, 'binary_precision': 0.5443787, 'binary_recall': 0.28615862, 'binary_specificity': 0.9915147, 'binary_f1_score': 0.37512743}
confusion matrix:
       0    1
0  17995  154
1    459  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.9521917, 'recall': 0.56113595, 'specificity': 0.56113595, 'f1': 0.59902364, 'auroc': 0.9113059, 'binary_precision': 0.9411765, 'binary_recall': 0.12260536, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.21694915}
confusion matrix:
      0   1
0  5995   2
1   229  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-01 05:31:10.508334,epoch time: 0:22:14.747495,used: 0:22:14.747495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9924264, 'precision': 0.99426985, 'recall': 0.98596394, 'specificity': 0.98596394, 'f1': 0.99002564, 'auroc': 0.99935836, 'binary_precision': 0.99797785, 'binary_recall': 0.972613, 'binary_specificity': 0.99931484, 'binary_f1_score': 0.98513216}
confusion matrix:
       0      1
0  42296     29
1    403  14312
---- Validation: 
scalar performance:
{'acc': 0.97121114, 'precision': 0.7869793, 'recall': 0.75107837, 'specificity': 0.75107837, 'f1': 0.76771027, 'auroc': 0.9556845, 'binary_precision': 0.5910714, 'binary_recall': 0.5147745, 'binary_specificity': 0.98738223, 'binary_f1_score': 0.55029094}
confusion matrix:
       0    1
0  17920  229
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.86633766, 'recall': 0.6681636, 'specificity': 0.6681636, 'f1': 0.7272111, 'auroc': 0.93409127, 'binary_precision': 0.7606838, 'binary_recall': 0.34099618, 'binary_specificity': 0.995331, 'binary_f1_score': 0.4708995}
confusion matrix:
      0   1
0  5969  28
1   172  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-01 05:53:05.021004,epoch time: 0:21:54.512670,used: 0:44:09.260165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9945126, 'precision': 0.99393404, 'recall': 0.9917146, 'specificity': 0.9917146, 'f1': 0.99281776, 'auroc': 0.9995022, 'binary_precision': 0.9927472, 'binary_recall': 0.98593366, 'binary_specificity': 0.99749553, 'binary_f1_score': 0.98932874}
confusion matrix:
       0      1
0  42218    106
1    207  14509
---- Validation: 
scalar performance:
{'acc': 0.9739783, 'precision': 0.8167161, 'recall': 0.75401103, 'specificity': 0.75401103, 'f1': 0.7816, 'auroc': 0.9487408, 'binary_precision': 0.6503906, 'binary_recall': 0.5178849, 'binary_specificity': 0.9901372, 'binary_f1_score': 0.5766233}
confusion matrix:
       0    1
0  17970  179
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.882794, 'recall': 0.6742442, 'specificity': 0.6742442, 'f1': 0.73608226, 'auroc': 0.9311303, 'binary_precision': 0.79310346, 'binary_recall': 0.35249043, 'binary_specificity': 0.995998, 'binary_f1_score': 0.48806366}
confusion matrix:
      0   1
0  5973  24
1   169  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-01 06:14:58.905609,epoch time: 0:21:53.884605,used: 1:06:03.144770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99519634, 'precision': 0.99557793, 'recall': 0.99186456, 'specificity': 0.99186456, 'f1': 0.9937029, 'auroc': 0.99971545, 'binary_precision': 0.99635667, 'binary_recall': 0.9849813, 'binary_specificity': 0.99874777, 'binary_f1_score': 0.9906363}
confusion matrix:
       0      1
0  42272     53
1    221  14494
---- Validation: 
scalar performance:
{'acc': 0.9728076, 'precision': 0.8371339, 'recall': 0.6791495, 'specificity': 0.6791495, 'f1': 0.7320395, 'auroc': 0.9545155, 'binary_precision': 0.6964286, 'binary_recall': 0.36391914, 'binary_specificity': 0.9943799, 'binary_f1_score': 0.4780388}
confusion matrix:
       0    1
0  18047  102
1    409  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.8141813, 'recall': 0.5955334, 'specificity': 0.5955334, 'f1': 0.6411979, 'auroc': 0.92814994, 'binary_precision': 0.66233766, 'binary_recall': 0.1954023, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.30177513}
confusion matrix:
      0   1
0  5971  26
1   210  51
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_4.png
early stop counter: 1
val acc:0.9728075861930847, best validation acc: 0.9739782810211182, corresponding to test acc:                         0.9691594839096069 / 0.9691594839096069
after epoch: 4,now: 2024-07-01 06:36:55.876863,epoch time: 0:21:56.971254,used: 1:28:00.116024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99414444, 'precision': 0.9957149, 'recall': 0.9890064, 'specificity': 0.9890064, 'f1': 0.9923012, 'auroc': 0.99965477, 'binary_precision': 0.99889, 'binary_recall': 0.9783909, 'binary_specificity': 0.999622, 'binary_f1_score': 0.98853415}
confusion matrix:
       0      1
0  42308     16
1    318  14398
---- Validation: 
scalar performance:
{'acc': 0.9724883, 'precision': 0.7848836, 'recall': 0.8454965, 'specificity': 0.8454965, 'f1': 0.8119545, 'auroc': 0.96115804, 'binary_precision': 0.5801527, 'binary_recall': 0.70917577, 'binary_specificity': 0.9818172, 'binary_f1_score': 0.63820857}
confusion matrix:
       0    1
0  17819  330
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97299457, 'precision': 0.86487484, 'recall': 0.76053256, 'specificity': 0.76053256, 'f1': 0.8031121, 'auroc': 0.9277501, 'binary_precision': 0.75, 'binary_recall': 0.52873564, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.6202247}
confusion matrix:
      0    1
0  5951   46
1   123  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_5.png
new oracle model saved
early stop counter: 2
val acc:0.972488284111023, best validation acc: 0.9739782810211182, corresponding to test acc:                         0.9691594839096069 / 0.9729945659637451
after epoch: 5,now: 2024-07-01 06:58:57.635518,epoch time: 0:22:01.758655,used: 1:50:01.874679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9946879, 'precision': 0.9917362, 'recall': 0.99444807, 'specificity': 0.99444807, 'f1': 0.99308217, 'auroc': 0.9997612, 'binary_precision': 0.98558146, 'binary_recall': 0.9939526, 'binary_specificity': 0.9949436, 'binary_f1_score': 0.9897493}
confusion matrix:
       0      1
0  42109    214
1     89  14628
---- Validation: 
scalar performance:
{'acc': 0.9286398, 'precision': 0.65356696, 'recall': 0.91205204, 'specificity': 0.91205204, 'f1': 0.71172464, 'auroc': 0.9589017, 'binary_precision': 0.31114718, 'binary_recall': 0.89424574, 'binary_specificity': 0.9298584, 'binary_f1_score': 0.461662}
confusion matrix:
       0     1
0  16876  1273
1     68   575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7494363, 'recall': 0.8725474, 'specificity': 0.8725474, 'f1': 0.79686385, 'auroc': 0.9500983, 'binary_precision': 0.50877196, 'binary_recall': 0.7777778, 'binary_specificity': 0.967317, 'binary_f1_score': 0.6151515}
confusion matrix:
      0    1
0  5801  196
1    58  203
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_6.png
early stop counter: 3
val acc:0.928639829158783, best validation acc: 0.9739782810211182, corresponding to test acc:                         0.9691594839096069 / 0.9729945659637451
after epoch: 6,now: 2024-07-01 07:20:46.550434,epoch time: 0:21:48.914916,used: 2:11:50.789595,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9961255, 'precision': 0.9946261, 'recall': 0.9952613, 'specificity': 0.9952613, 'f1': 0.99494314, 'auroc': 0.99979186, 'binary_precision': 0.99152195, 'binary_recall': 0.99347603, 'binary_specificity': 0.99704665, 'binary_f1_score': 0.99249804}
confusion matrix:
       0      1
0  42200    125
1     96  14619
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.76219267, 'recall': 0.80984306, 'specificity': 0.80984306, 'f1': 0.7838042, 'auroc': 0.95321393, 'binary_precision': 0.5372549, 'binary_recall': 0.63919127, 'binary_specificity': 0.9804948, 'binary_f1_score': 0.5838069}
confusion matrix:
       0    1
0  17795  354
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.8066075, 'recall': 0.66074896, 'specificity': 0.66074896, 'f1': 0.7085226, 'auroc': 0.9339318, 'binary_precision': 0.64179105, 'binary_recall': 0.32950193, 'binary_specificity': 0.991996, 'binary_f1_score': 0.43544304}
confusion matrix:
      0   1
0  5949  48
1   175  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_7.png
early stop counter: 4
val acc:0.9688165187835693, best validation acc: 0.9739782810211182, corresponding to test acc:                         0.9691594839096069 / 0.9729945659637451
after epoch: 7,now: 2024-07-01 07:42:32.415024,epoch time: 0:21:45.864590,used: 2:33:36.654185,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9954593, 'precision': 0.9958904, 'recall': 0.9922427, 'specificity': 0.9922427, 'f1': 0.99404883, 'auroc': 0.9996544, 'binary_precision': 0.99677044, 'binary_recall': 0.9855959, 'binary_specificity': 0.99888945, 'binary_f1_score': 0.99115163}
confusion matrix:
       0      1
0  42275     47
1    212  14506
---- Validation: 
scalar performance:
{'acc': 0.9732333, 'precision': 0.8515949, 'recall': 0.6726194, 'specificity': 0.6726194, 'f1': 0.72923076, 'auroc': 0.9498482, 'binary_precision': 0.7258065, 'binary_recall': 0.34992224, 'binary_specificity': 0.99531657, 'binary_f1_score': 0.47219312}
confusion matrix:
       0    1
0  18064   85
1    418  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.91650426, 'recall': 0.62177163, 'specificity': 0.62177163, 'f1': 0.6825479, 'auroc': 0.95923376, 'binary_precision': 0.8648649, 'binary_recall': 0.24521072, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.38208956}
confusion matrix:
      0   1
0  5987  10
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_8.png
early stop counter: 5
val acc:0.9732332825660706, best validation acc: 0.9739782810211182, corresponding to test acc:                         0.9691594839096069 / 0.9729945659637451
after epoch: 8,now: 2024-07-01 08:04:10.243390,epoch time: 0:21:37.828366,used: 2:55:14.482551,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9950561, 'precision': 0.9927941, 'recall': 0.9943193, 'specificity': 0.9943193, 'f1': 0.9935535, 'auroc': 0.9996935, 'binary_precision': 0.98809683, 'binary_recall': 0.99279696, 'binary_specificity': 0.9958416, 'binary_f1_score': 0.99044126}
confusion matrix:
       0      1
0  42148    176
1    106  14610
---- Validation: 
scalar performance:
{'acc': 0.97153044, 'precision': 0.7783842, 'recall': 0.84500057, 'specificity': 0.84500057, 'f1': 0.80773234, 'auroc': 0.9644409, 'binary_precision': 0.5671642, 'binary_recall': 0.70917577, 'binary_specificity': 0.98082536, 'binary_f1_score': 0.63026947}
confusion matrix:
       0    1
0  17801  348
1    187  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.85010964, 'recall': 0.7749411, 'specificity': 0.7749411, 'f1': 0.80751944, 'auroc': 0.9656255, 'binary_precision': 0.7192118, 'binary_recall': 0.55938697, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.62931037}
confusion matrix:
      0    1
0  5940   57
1   115  146
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_9.png
early stop counter: 6
val acc:0.9715304374694824, best validation acc: 0.9739782810211182, corresponding to test acc:                         0.9691594839096069 / 0.9729945659637451
after epoch: 9,now: 2024-07-01 08:25:42.629766,epoch time: 0:21:32.386376,used: 3:16:46.868927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9945828, 'precision': 0.99637616, 'recall': 0.9895005, 'specificity': 0.9895005, 'f1': 0.99287605, 'auroc': 0.9997922, 'binary_precision': 1.0, 'binary_recall': 0.97900105, 'binary_specificity': 1.0, 'binary_f1_score': 0.9893891}
confusion matrix:
       0      1
0  42325      0
1    309  14406
---- Validation: 
scalar performance:
{'acc': 0.969189, 'precision': 0.9208642, 'recall': 0.5580173, 'specificity': 0.5580173, 'f1': 0.59502554, 'auroc': 0.95263004, 'binary_precision': 0.872093, 'binary_recall': 0.11664075, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.20576133}
confusion matrix:
       0   1
0  18138  11
1    568  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.94796085, 'recall': 0.5534731, 'specificity': 0.5534731, 'f1': 0.58660847, 'auroc': 0.9601463, 'binary_precision': 0.93333334, 'binary_recall': 0.107279696, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.19243987}
confusion matrix:
      0   1
0  5995   2
1   233  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_10.png
early stop counter: 7
val acc:0.9691889882087708, best validation acc: 0.9739782810211182, corresponding to test acc:                         0.9691594839096069 / 0.9729945659637451
after epoch: 10,now: 2024-07-01 08:47:09.144501,epoch time: 0:21:26.514735,used: 3:38:13.383662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9969495, 'precision': 0.9971419, 'recall': 0.9948856, 'specificity': 0.9948856, 'f1': 0.996007, 'auroc': 0.99985814, 'binary_precision': 0.9975364, 'binary_recall': 0.9906218, 'binary_specificity': 0.99914944, 'binary_f1_score': 0.99406713}
confusion matrix:
       0      1
0  42289     36
1    138  14577
---- Validation: 
scalar performance:
{'acc': 0.9769583, 'precision': 0.84996724, 'recall': 0.7668047, 'specificity': 0.7668047, 'f1': 0.80229855, 'auroc': 0.96554935, 'binary_precision': 0.7160494, 'binary_recall': 0.54121304, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.6164747}
confusion matrix:
       0    1
0  18011  138
1    295  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.87559795, 'recall': 0.68540496, 'specificity': 0.68540496, 'f1': 0.7453563, 'auroc': 0.9634888, 'binary_precision': 0.7777778, 'binary_recall': 0.37547892, 'binary_specificity': 0.995331, 'binary_f1_score': 0.50645995}
confusion matrix:
      0   1
0  5969  28
1   163  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_11.png
better model found
persisted
after epoch: 11,now: 2024-07-01 09:08:32.393666,epoch time: 0:21:23.249165,used: 3:59:36.632827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9965112, 'precision': 0.9954765, 'recall': 0.9954106, 'specificity': 0.9954106, 'f1': 0.9954436, 'auroc': 0.999769, 'binary_precision': 0.99333924, 'binary_recall': 0.9931367, 'binary_specificity': 0.99768454, 'binary_f1_score': 0.993238}
confusion matrix:
       0      1
0  42226     98
1    101  14615
---- Validation: 
scalar performance:
{'acc': 0.9737122, 'precision': 0.8351332, 'recall': 0.70661986, 'specificity': 0.70661986, 'f1': 0.754364, 'auroc': 0.9583212, 'binary_precision': 0.6905371, 'binary_recall': 0.41990668, 'binary_specificity': 0.993333, 'binary_f1_score': 0.5222437}
confusion matrix:
       0    1
0  18028  121
1    373  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.78314424, 'recall': 0.6375937, 'specificity': 0.6375937, 'f1': 0.68243945, 'auroc': 0.94431335, 'binary_precision': 0.5967742, 'binary_recall': 0.2835249, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.3844156}
confusion matrix:
      0   1
0  5947  50
1   187  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_12.png
early stop counter: 1
val acc:0.9737122058868408, best validation acc: 0.9769582748413086, corresponding to test acc:                         0.9694790840148926 / 0.9729945659637451
after epoch: 12,now: 2024-07-01 09:30:02.063410,epoch time: 0:21:29.669744,used: 4:21:06.302571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.994986, 'precision': 0.99278784, 'recall': 0.9941391, 'specificity': 0.9941391, 'f1': 0.99346095, 'auroc': 0.9997114, 'binary_precision': 0.98822576, 'binary_recall': 0.99238926, 'binary_specificity': 0.9958888, 'binary_f1_score': 0.9903031}
confusion matrix:
       0      1
0  42150    174
1    112  14604
---- Validation: 
scalar performance:
{'acc': 0.97126436, 'precision': 0.77554536, 'recall': 0.8621141, 'specificity': 0.8621141, 'f1': 0.81227756, 'auroc': 0.9668675, 'binary_precision': 0.5602339, 'binary_recall': 0.7449456, 'binary_specificity': 0.9792826, 'binary_f1_score': 0.63951933}
confusion matrix:
       0    1
0  17773  376
1    164  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97635025, 'precision': 0.89669776, 'recall': 0.7787745, 'specificity': 0.7787745, 'f1': 0.82645035, 'auroc': 0.9637857, 'binary_precision': 0.8121547, 'binary_recall': 0.5632184, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.6651584}
confusion matrix:
      0    1
0  5963   34
1   114  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_13.png
new oracle model saved
early stop counter: 2
val acc:0.9712643623352051, best validation acc: 0.9769582748413086, corresponding to test acc:                         0.9694790840148926 / 0.9763502478599548
after epoch: 13,now: 2024-07-01 09:51:26.847274,epoch time: 0:21:24.783864,used: 4:42:31.086435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9965814, 'precision': 0.9974116, 'recall': 0.9936631, 'specificity': 0.9936631, 'f1': 0.9955188, 'auroc': 0.9998367, 'binary_precision': 0.9991064, 'binary_recall': 0.98763335, 'binary_specificity': 0.99969286, 'binary_f1_score': 0.99333674}
confusion matrix:
       0      1
0  42310     13
1    182  14535
---- Validation: 
scalar performance:
{'acc': 0.9714772, 'precision': 0.92061996, 'recall': 0.5974548, 'specificity': 0.5974548, 'f1': 0.6526151, 'auroc': 0.9621359, 'binary_precision': 0.8689655, 'binary_recall': 0.19595645, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.31979695}
confusion matrix:
       0    1
0  18130   19
1    517  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.9005033, 'recall': 0.5683819, 'specificity': 0.5683819, 'f1': 0.60892224, 'auroc': 0.9552452, 'binary_precision': 0.8372093, 'binary_recall': 0.13793103, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.23684211}
confusion matrix:
      0   1
0  5990   7
1   225  36
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_14.png
early stop counter: 3
val acc:0.971477210521698, best validation acc: 0.9769582748413086, corresponding to test acc:                         0.9694790840148926 / 0.9763502478599548
after epoch: 14,now: 2024-07-01 10:12:57.524022,epoch time: 0:21:30.676748,used: 5:04:01.763183,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9976157, 'precision': 0.997481, 'recall': 0.99628806, 'specificity': 0.99628806, 'f1': 0.9968827, 'auroc': 0.99987894, 'binary_precision': 0.9972038, 'binary_recall': 0.9935449, 'binary_specificity': 0.99903125, 'binary_f1_score': 0.99537104}
confusion matrix:
       0      1
0  42282     41
1     95  14622
---- Validation: 
scalar performance:
{'acc': 0.97158366, 'precision': 0.7977872, 'recall': 0.7220191, 'specificity': 0.7220191, 'f1': 0.7538588, 'auroc': 0.9508035, 'binary_precision': 0.61473686, 'binary_recall': 0.4541213, 'binary_specificity': 0.9899168, 'binary_f1_score': 0.52236134}
confusion matrix:
       0    1
0  17966  183
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9704378, 'precision': 0.8877473, 'recall': 0.6914022, 'specificity': 0.6914022, 'f1': 0.7533555, 'auroc': 0.9685467, 'binary_precision': 0.8015873, 'binary_recall': 0.38697317, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.5219638}
confusion matrix:
      0    1
0  5972   25
1   160  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_15.png
early stop counter: 4
val acc:0.9715836644172668, best validation acc: 0.9769582748413086, corresponding to test acc:                         0.9694790840148926 / 0.9763502478599548
after epoch: 15,now: 2024-07-01 10:34:31.492805,epoch time: 0:21:33.968783,used: 5:25:35.731966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9959152, 'precision': 0.99673855, 'recall': 0.99259317, 'specificity': 0.99259317, 'f1': 0.99464315, 'auroc': 0.99980843, 'binary_precision': 0.99841696, 'binary_recall': 0.9857298, 'binary_specificity': 0.9994566, 'binary_f1_score': 0.99203277}
confusion matrix:
       0      1
0  42301     23
1    210  14506
---- Validation: 
scalar performance:
{'acc': 0.9755215, 'precision': 0.88825727, 'recall': 0.6888051, 'specificity': 0.6888051, 'f1': 0.75161636, 'auroc': 0.96074337, 'binary_precision': 0.7980456, 'binary_recall': 0.38102645, 'binary_specificity': 0.9965838, 'binary_f1_score': 0.51578945}
confusion matrix:
       0    1
0  18087   62
1    398  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.884372, 'recall': 0.5852898, 'specificity': 0.5852898, 'f1': 0.6326518, 'auroc': 0.9573508, 'binary_precision': 0.8035714, 'binary_recall': 0.1724138, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.28391168}
confusion matrix:
      0   1
0  5986  11
1   216  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_16.png
early stop counter: 5
val acc:0.9755215048789978, best validation acc: 0.9769582748413086, corresponding to test acc:                         0.9694790840148926 / 0.9763502478599548
after epoch: 16,now: 2024-07-01 10:56:03.003211,epoch time: 0:21:31.510406,used: 5:47:07.242372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99512625, 'precision': 0.9966221, 'recall': 0.9906659, 'specificity': 0.9906659, 'f1': 0.99359727, 'auroc': 0.9996456, 'binary_precision': 0.99965394, 'binary_recall': 0.98145, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9904684}
confusion matrix:
       0      1
0  42318      5
1    273  14444
---- Validation: 
scalar performance:
{'acc': 0.9721158, 'precision': 0.89934886, 'recall': 0.61653674, 'specificity': 0.61653674, 'f1': 0.67568105, 'auroc': 0.9509684, 'binary_precision': 0.8251366, 'binary_recall': 0.2348367, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.36561745}
confusion matrix:
       0    1
0  18117   32
1    492  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.92687345, 'recall': 0.64476013, 'specificity': 0.64476013, 'f1': 0.711008, 'auroc': 0.9599648, 'binary_precision': 0.88372093, 'binary_recall': 0.29118773, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.43804035}
confusion matrix:
      0   1
0  5987  10
1   185  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_17.png
early stop counter: 6
val acc:0.9721158146858215, best validation acc: 0.9769582748413086, corresponding to test acc:                         0.9694790840148926 / 0.9763502478599548
after epoch: 17,now: 2024-07-01 11:17:30.980347,epoch time: 0:21:27.977136,used: 6:08:35.219508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99708974, 'precision': 0.99635273, 'recall': 0.99604464, 'specificity': 0.99604464, 'f1': 0.99619853, 'auroc': 0.9998443, 'binary_precision': 0.9948313, 'binary_recall': 0.99388504, 'binary_specificity': 0.99820423, 'binary_f1_score': 0.99435794}
confusion matrix:
       0      1
0  42246     76
1     90  14628
---- Validation: 
scalar performance:
{'acc': 0.977384, 'precision': 0.8484537, 'recall': 0.78052604, 'specificity': 0.78052604, 'f1': 0.81050175, 'auroc': 0.963106, 'binary_precision': 0.71206224, 'binary_recall': 0.56920683, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.6326707}
confusion matrix:
       0    1
0  18001  148
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.8567687, 'recall': 0.7074764, 'specificity': 0.7074764, 'f1': 0.76044536, 'auroc': 0.9516564, 'binary_precision': 0.738255, 'binary_recall': 0.42145595, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.53658533}
confusion matrix:
      0    1
0  5958   39
1   151  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_18.png
better model found
persisted
after epoch: 18,now: 2024-07-01 11:38:58.662724,epoch time: 0:21:27.682377,used: 6:30:02.901885,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9963008, 'precision': 0.9974741, 'recall': 0.99287474, 'specificity': 0.99287474, 'f1': 0.99514663, 'auroc': 0.9998025, 'binary_precision': 0.99986213, 'binary_recall': 0.9857968, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9927797}
confusion matrix:
       0      1
0  42323      2
1    209  14506
---- Validation: 
scalar performance:
{'acc': 0.9763729, 'precision': 0.93539375, 'recall': 0.6749949, 'specificity': 0.6749949, 'f1': 0.74618113, 'auroc': 0.9637593, 'binary_precision': 0.8932806, 'binary_recall': 0.35147744, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.50446427}
confusion matrix:
       0    1
0  18122   27
1    417  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.9120728, 'recall': 0.5589701, 'specificity': 0.5589701, 'f1': 0.59476095, 'auroc': 0.9532389, 'binary_precision': 0.8611111, 'binary_recall': 0.118773945, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.20875421}
confusion matrix:
      0   1
0  5992   5
1   230  31
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_19.png
early stop counter: 1
val acc:0.9763728976249695, best validation acc: 0.9773839712142944, corresponding to test acc:                         0.9696388840675354 / 0.9763502478599548
after epoch: 19,now: 2024-07-01 12:00:21.879714,epoch time: 0:21:23.216990,used: 6:51:26.118875,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.995547, 'precision': 0.99676526, 'recall': 0.99161315, 'specificity': 0.99161315, 'f1': 0.99415416, 'auroc': 0.9997549, 'binary_precision': 0.9992405, 'binary_recall': 0.98348624, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.9913007}
confusion matrix:
       0      1
0  42314     11
1    243  14472
---- Validation: 
scalar performance:
{'acc': 0.97270113, 'precision': 0.9257419, 'recall': 0.61683977, 'specificity': 0.61683977, 'f1': 0.6783001, 'auroc': 0.9625094, 'binary_precision': 0.877907, 'binary_recall': 0.2348367, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.37055215}
confusion matrix:
       0    1
0  18128   21
1    492  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.9536966, 'recall': 0.6432613, 'specificity': 0.6432613, 'f1': 0.71209735, 'auroc': 0.9580517, 'binary_precision': 0.9375, 'binary_recall': 0.28735632, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.43988267}
confusion matrix:
      0   1
0  5992   5
1   186  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_20.png
early stop counter: 2
val acc:0.9727011322975159, best validation acc: 0.9773839712142944, corresponding to test acc:                         0.9696388840675354 / 0.9763502478599548
after epoch: 20,now: 2024-07-01 12:21:59.401649,epoch time: 0:21:37.521935,used: 7:13:03.640810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9980189, 'precision': 0.9983097, 'recall': 0.99651587, 'specificity': 0.99651587, 'f1': 0.99740857, 'auroc': 0.99992067, 'binary_precision': 0.99890697, 'binary_recall': 0.9934099, 'binary_specificity': 0.9996219, 'binary_f1_score': 0.99615085}
confusion matrix:
       0      1
0  42305     16
1     97  14622
---- Validation: 
scalar performance:
{'acc': 0.97333974, 'precision': 0.89892554, 'recall': 0.63967204, 'specificity': 0.63967204, 'f1': 0.70291173, 'auroc': 0.9613261, 'binary_precision': 0.82272726, 'binary_recall': 0.281493, 'binary_specificity': 0.99785113, 'binary_f1_score': 0.41946697}
confusion matrix:
       0    1
0  18110   39
1    462  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.8478465, 'recall': 0.6111926, 'specificity': 0.6111926, 'f1': 0.6633147, 'auroc': 0.94932824, 'binary_precision': 0.72839504, 'binary_recall': 0.22605364, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.34502923}
confusion matrix:
      0   1
0  5975  22
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_21.png
early stop counter: 3
val acc:0.9733397364616394, best validation acc: 0.9773839712142944, corresponding to test acc:                         0.9696388840675354 / 0.9763502478599548
after epoch: 21,now: 2024-07-01 12:43:34.991477,epoch time: 0:21:35.589828,used: 7:34:39.230638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9985975, 'precision': 0.99836695, 'recall': 0.99796915, 'specificity': 0.99796915, 'f1': 0.99816775, 'auroc': 0.99994004, 'binary_precision': 0.9978911, 'binary_recall': 0.9966707, 'binary_specificity': 0.9992675, 'binary_f1_score': 0.99728054}
confusion matrix:
       0      1
0  42291     31
1     49  14669
---- Validation: 
scalar performance:
{'acc': 0.97690505, 'precision': 0.8306602, 'recall': 0.8087802, 'specificity': 0.8087802, 'f1': 0.8193108, 'auroc': 0.9650454, 'binary_precision': 0.67445743, 'binary_recall': 0.62830484, 'binary_specificity': 0.9892556, 'binary_f1_score': 0.6505636}
confusion matrix:
       0    1
0  17954  195
1    239  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.73884076, 'recall': 0.7327064, 'specificity': 0.7327064, 'f1': 0.73572785, 'auroc': 0.94282997, 'binary_precision': 0.5, 'binary_recall': 0.48659003, 'binary_specificity': 0.97882277, 'binary_f1_score': 0.49320388}
confusion matrix:
      0    1
0  5870  127
1   134  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_22.png
early stop counter: 4
val acc:0.9769050478935242, best validation acc: 0.9773839712142944, corresponding to test acc:                         0.9696388840675354 / 0.9763502478599548
after epoch: 22,now: 2024-07-01 13:05:04.131191,epoch time: 0:21:29.139714,used: 7:56:08.370352,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99598527, 'precision': 0.99354684, 'recall': 0.9960091, 'specificity': 0.9960091, 'f1': 0.99476993, 'auroc': 0.99984956, 'binary_precision': 0.98846775, 'binary_recall': 0.99605846, 'binary_specificity': 0.9959598, 'binary_f1_score': 0.99224865}
confusion matrix:
       0      1
0  42154    171
1     58  14657
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.7408999, 'recall': 0.8222207, 'specificity': 0.8222207, 'f1': 0.7749501, 'auroc': 0.9564041, 'binary_precision': 0.49368542, 'binary_recall': 0.6687403, 'binary_specificity': 0.97570115, 'binary_f1_score': 0.56803167}
confusion matrix:
       0    1
0  17708  441
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.74032855, 'recall': 0.7182145, 'specificity': 0.7182145, 'f1': 0.728662, 'auroc': 0.9474731, 'binary_precision': 0.5042373, 'binary_recall': 0.4559387, 'binary_specificity': 0.98049027, 'binary_f1_score': 0.47887325}
confusion matrix:
      0    1
0  5880  117
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_23.png
early stop counter: 5
val acc:0.9651979804039001, best validation acc: 0.9773839712142944, corresponding to test acc:                         0.9696388840675354 / 0.9763502478599548
after epoch: 23,now: 2024-07-01 13:26:37.027868,epoch time: 0:21:32.896677,used: 8:17:41.267029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9980891, 'precision': 0.99837923, 'recall': 0.99662924, 'specificity': 0.99662924, 'f1': 0.9975002, 'auroc': 0.9998376, 'binary_precision': 0.9989753, 'binary_recall': 0.9936128, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.99628687}
confusion matrix:
       0      1
0  42308     15
1     94  14623
---- Validation: 
scalar performance:
{'acc': 0.9786611, 'precision': 0.8644878, 'recall': 0.7834374, 'specificity': 0.7834374, 'f1': 0.8184669, 'auroc': 0.97014666, 'binary_precision': 0.7439516, 'binary_recall': 0.57387245, 'binary_specificity': 0.99300236, 'binary_f1_score': 0.64793676}
confusion matrix:
       0    1
0  18022  127
1    274  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97283477, 'precision': 0.8911442, 'recall': 0.7274672, 'specificity': 0.7274672, 'f1': 0.78566164, 'auroc': 0.9678761, 'binary_precision': 0.80536914, 'binary_recall': 0.4597701, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.58536583}
confusion matrix:
      0    1
0  5968   29
1   141  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_24.png
better model found
persisted
after epoch: 24,now: 2024-07-01 13:48:18.075791,epoch time: 0:21:41.047923,used: 8:39:22.314952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9974579, 'precision': 0.998225, 'recall': 0.9951402, 'specificity': 0.9951402, 'f1': 0.9966701, 'auroc': 0.99991333, 'binary_precision': 0.9997942, 'binary_recall': 0.9903513, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9950504}
confusion matrix:
       0      1
0  42320      3
1    142  14575
---- Validation: 
scalar performance:
{'acc': 0.97616005, 'precision': 0.8852824, 'recall': 0.70413685, 'specificity': 0.70413685, 'f1': 0.7648419, 'auroc': 0.96693206, 'binary_precision': 0.7910448, 'binary_recall': 0.41213062, 'binary_specificity': 0.99614304, 'binary_f1_score': 0.5419223}
confusion matrix:
       0    1
0  18079   70
1    378  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.96505773, 'recall': 0.6395966, 'specificity': 0.6395966, 'f1': 0.7087758, 'auroc': 0.965876, 'binary_precision': 0.9605263, 'binary_recall': 0.27969348, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.4332344}
confusion matrix:
      0   1
0  5994   3
1   188  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_25.png
early stop counter: 1
val acc:0.9761600494384766, best validation acc: 0.9786611199378967, corresponding to test acc:                         0.9728347659111023 / 0.9763502478599548
after epoch: 25,now: 2024-07-01 14:09:47.970154,epoch time: 0:21:29.894363,used: 9:00:52.209315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99712485, 'precision': 0.99533784, 'recall': 0.9971762, 'specificity': 0.9971762, 'f1': 0.99625254, 'auroc': 0.99993753, 'binary_precision': 0.99162275, 'binary_recall': 0.99728227, 'binary_specificity': 0.9970701, 'binary_f1_score': 0.9944445}
confusion matrix:
       0      1
0  42198    124
1     40  14678
---- Validation: 
scalar performance:
{'acc': 0.96110046, 'precision': 0.72421074, 'recall': 0.855352, 'specificity': 0.855352, 'f1': 0.77290475, 'auroc': 0.9593407, 'binary_precision': 0.4577735, 'binary_recall': 0.7418352, 'binary_specificity': 0.9688688, 'binary_f1_score': 0.5661721}
confusion matrix:
       0    1
0  17584  565
1    166  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7490989, 'recall': 0.7372048, 'specificity': 0.7372048, 'f1': 0.74298584, 'auroc': 0.953655, 'binary_precision': 0.5201613, 'binary_recall': 0.49425286, 'binary_specificity': 0.9801567, 'binary_f1_score': 0.50687623}
confusion matrix:
      0    1
0  5878  119
1   132  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_26.png
early stop counter: 2
val acc:0.9611004590988159, best validation acc: 0.9786611199378967, corresponding to test acc:                         0.9728347659111023 / 0.9763502478599548
after epoch: 26,now: 2024-07-01 14:31:07.328163,epoch time: 0:21:19.358009,used: 9:22:11.567324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99768585, 'precision': 0.99693406, 'recall': 0.99702215, 'specificity': 0.99702215, 'f1': 0.99697816, 'auroc': 0.9998804, 'binary_precision': 0.99538046, 'binary_recall': 0.995651, 'binary_specificity': 0.99839336, 'binary_f1_score': 0.99551576}
confusion matrix:
       0      1
0  42256     68
1     64  14652
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.7522804, 'recall': 0.77979195, 'specificity': 0.77979195, 'f1': 0.7652421, 'auroc': 0.9511556, 'binary_precision': 0.51955307, 'binary_recall': 0.5785381, 'binary_specificity': 0.9810458, 'binary_f1_score': 0.5474614}
confusion matrix:
       0    1
0  17805  344
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.7795967, 'recall': 0.68381894, 'specificity': 0.68381894, 'f1': 0.7206347, 'auroc': 0.94510615, 'binary_precision': 0.5857988, 'binary_recall': 0.37931034, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.46046513}
confusion matrix:
      0   1
0  5927  70
1   162  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_27.png
early stop counter: 3
val acc:0.9672732949256897, best validation acc: 0.9786611199378967, corresponding to test acc:                         0.9728347659111023 / 0.9763502478599548
after epoch: 27,now: 2024-07-01 14:52:50.127920,epoch time: 0:21:42.799757,used: 9:43:54.367081,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99730015, 'precision': 0.9981195, 'recall': 0.9948337, 'specificity': 0.9948337, 'f1': 0.99646235, 'auroc': 0.999922, 'binary_precision': 0.99979407, 'binary_recall': 0.98973835, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9947407}
confusion matrix:
       0      1
0  42322      3
1    151  14564
---- Validation: 
scalar performance:
{'acc': 0.97381866, 'precision': 0.9290135, 'recall': 0.6346696, 'specificity': 0.6346696, 'f1': 0.70044786, 'auroc': 0.9642393, 'binary_precision': 0.88324875, 'binary_recall': 0.27060652, 'binary_specificity': 0.9987327, 'binary_f1_score': 0.4142857}
confusion matrix:
       0    1
0  18126   23
1    469  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.9293607, 'recall': 0.62385404, 'specificity': 0.62385404, 'f1': 0.68623775, 'auroc': 0.9613266, 'binary_precision': 0.89041096, 'binary_recall': 0.24904214, 'binary_specificity': 0.998666, 'binary_f1_score': 0.38922155}
confusion matrix:
      0   1
0  5989   8
1   196  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_28.png
early stop counter: 4
val acc:0.9738186597824097, best validation acc: 0.9786611199378967, corresponding to test acc:                         0.9728347659111023 / 0.9763502478599548
after epoch: 28,now: 2024-07-01 15:14:26.784147,epoch time: 0:21:36.656227,used: 10:05:31.023308,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9978086, 'precision': 0.99730265, 'recall': 0.9969717, 'specificity': 0.9969717, 'f1': 0.99713707, 'auroc': 0.9998574, 'binary_precision': 0.9962585, 'binary_recall': 0.99524295, 'binary_specificity': 0.99870056, 'binary_f1_score': 0.9957505}
confusion matrix:
       0      1
0  42270     55
1     70  14645
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.7402607, 'recall': 0.80199677, 'specificity': 0.80199677, 'f1': 0.76717854, 'auroc': 0.94176006, 'binary_precision': 0.49387255, 'binary_recall': 0.62674963, 'binary_specificity': 0.9772439, 'binary_f1_score': 0.5524332}
confusion matrix:
       0    1
0  17736  413
1    240  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8053802, 'recall': 0.6961469, 'specificity': 0.6961469, 'f1': 0.73754585, 'auroc': 0.93543756, 'binary_precision': 0.6363636, 'binary_recall': 0.40229884, 'binary_specificity': 0.989995, 'binary_f1_score': 0.49295777}
confusion matrix:
      0    1
0  5937   60
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_29.png
early stop counter: 5
val acc:0.9652511477470398, best validation acc: 0.9786611199378967, corresponding to test acc:                         0.9728347659111023 / 0.9763502478599548
after epoch: 29,now: 2024-07-01 15:35:49.431486,epoch time: 0:21:22.647339,used: 10:26:53.670647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99701965, 'precision': 0.9956087, 'recall': 0.99661756, 'specificity': 0.99661756, 'f1': 0.9961118, 'auroc': 0.999913, 'binary_precision': 0.99268395, 'binary_recall': 0.9957869, 'binary_specificity': 0.99744827, 'binary_f1_score': 0.994233}
confusion matrix:
       0      1
0  42216    108
1     62  14654
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.75531346, 'recall': 0.8272934, 'specificity': 0.8272934, 'f1': 0.7863239, 'auroc': 0.95803696, 'binary_precision': 0.52220887, 'binary_recall': 0.67651635, 'binary_specificity': 0.97807044, 'binary_f1_score': 0.58943087}
confusion matrix:
       0    1
0  17751  398
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.78281194, 'recall': 0.6579995, 'specificity': 0.6579995, 'f1': 0.70073617, 'auroc': 0.9376123, 'binary_precision': 0.5944056, 'binary_recall': 0.3256705, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.42079207}
confusion matrix:
      0   1
0  5939  58
1   176  85
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_30.png
early stop counter: 6
val acc:0.96775221824646, best validation acc: 0.9786611199378967, corresponding to test acc:                         0.9728347659111023 / 0.9763502478599548
after epoch: 30,now: 2024-07-01 15:57:34.117834,epoch time: 0:21:44.686348,used: 10:48:38.356995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_05_08_55_seed_0_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:48:38.356995 at 2024-07-01 15:57:34.117834
persisted model performance metric: 

scalar performance:
{'acc': 0.97283477, 'precision': 0.8911442, 'recall': 0.7274672, 'specificity': 0.7274672, 'f1': 0.78566164, 'auroc': 0.9678761, 'binary_precision': 0.80536914, 'binary_recall': 0.4597701, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.58536583}
confusion matrix:
      0    1
0  5968   29
1   141  120
oracle model performance metric: 

scalar performance:
{'acc': 0.97635025, 'precision': 0.89669776, 'recall': 0.7787745, 'specificity': 0.7787745, 'f1': 0.82645035, 'auroc': 0.9637857, 'binary_precision': 0.8121547, 'binary_recall': 0.5632184, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.6651584}
confusion matrix:
      0    1
0  5963   34
1   114  147
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 319865 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool | 291597 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |  28268 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 319865 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool | 291597 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |  28268 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 314122 KiB |   6778 MiB |   1105 TiB |   1105 TiB |
|       from large pool | 286862 KiB |   6752 MiB |   1089 TiB |   1089 TiB |
|       from small pool |  27260 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7460 MiB |   7460 MiB |   7460 MiB |      0 B   |
|       from large pool |   7404 MiB |   7404 MiB |   7404 MiB |      0 B   |
|       from small pool |     56 MiB |     56 MiB |     56 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 290438 KiB | 680184 KiB |    811 TiB |    811 TiB |
|       from large pool | 281843 KiB | 675647 KiB |    795 TiB |    795 TiB |
|       from small pool |   8595 KiB |  10808 KiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3230    |    7877    |  206198 K  |  206194 K  |
|       from large pool |     130    |     756    |  103674 K  |  103673 K  |
|       from small pool |    3100    |    7745    |  102524 K  |  102521 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3230    |    7877    |  206198 K  |  206194 K  |
|       from large pool |     130    |     756    |  103674 K  |  103673 K  |
|       from small pool |    3100    |    7745    |  102524 K  |  102521 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     337    |     337    |     337    |       0    |
|       from large pool |     309    |     309    |     309    |       0    |
|       from small pool |      28    |      28    |      28    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    3607    |  118796 K  |  118796 K  |
|       from large pool |      28    |     307    |   70940 K  |   70940 K  |
|       from small pool |      35    |    3580    |   47856 K  |   47856 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |      0 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |      0 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   1089 TiB |   1089 TiB |
|       from small pool |      0 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 610304 KiB |   7460 MiB |   7460 MiB |   6864 MiB |
|       from large pool | 573440 KiB |   7404 MiB |   7404 MiB |   6844 MiB |
|       from small pool |  36864 KiB |     56 MiB |     56 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |    811 TiB |    811 TiB |
|       from large pool |  24320 KiB | 675647 KiB |    795 TiB |    795 TiB |
|       from small pool |      0 KiB |  31464 KiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7877    |  206198 K  |  206198 K  |
|       from large pool |       2    |     756    |  103674 K  |  103674 K  |
|       from small pool |       0    |    7745    |  102524 K  |  102524 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7877    |  206198 K  |  206198 K  |
|       from large pool |       2    |     756    |  103674 K  |  103674 K  |
|       from small pool |       0    |    7745    |  102524 K  |  102524 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     337    |     337    |     294    |
|       from large pool |      25    |     309    |     309    |     284    |
|       from small pool |      18    |      28    |      28    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3607    |  118797 K  |  118797 K  |
|       from large pool |       3    |     307    |   70940 K  |   70940 K  |
|       from small pool |       0    |    3580    |   47857 K  |   47857 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |      0 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   1090 TiB |   1090 TiB |
|       from small pool |      0 KiB |     48 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   1105 TiB |   1105 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   1089 TiB |   1089 TiB |
|       from small pool |      0 KiB |     47 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 610304 KiB |   7460 MiB |   7460 MiB |   6864 MiB |
|       from large pool | 573440 KiB |   7404 MiB |   7404 MiB |   6844 MiB |
|       from small pool |  36864 KiB |     56 MiB |     56 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |    811 TiB |    811 TiB |
|       from large pool |  24320 KiB | 675647 KiB |    795 TiB |    795 TiB |
|       from small pool |      0 KiB |  31464 KiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7877    |  206198 K  |  206198 K  |
|       from large pool |       2    |     756    |  103674 K  |  103674 K  |
|       from small pool |       0    |    7745    |  102524 K  |  102524 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7877    |  206198 K  |  206198 K  |
|       from large pool |       2    |     756    |  103674 K  |  103674 K  |
|       from small pool |       0    |    7745    |  102524 K  |  102524 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     337    |     337    |     294    |
|       from large pool |      25    |     309    |     309    |     284    |
|       from small pool |      18    |      28    |      28    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3607    |  118797 K  |  118797 K  |
|       from large pool |       3    |     307    |   70940 K  |   70940 K  |
|       from small pool |       0    |    3580    |   47857 K  |   47857 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058

 Experiment start at: 2024-07-01 16:05:26.709621
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98743665, 'precision': 0.9831767, 'recall': 0.9836629, 'specificity': 0.9836629, 'f1': 0.98341954, 'auroc': 0.9982516, 'binary_precision': 0.97451526, 'binary_recall': 0.9760022, 'binary_specificity': 0.9913236, 'binary_f1_score': 0.97525823}
confusion matrix:
       0      1
0  42046    368
1    346  14072
---- Validation: 
scalar performance:
{'acc': 0.96835643, 'precision': 0.7926736, 'recall': 0.6610033, 'specificity': 0.6610033, 'f1': 0.70594305, 'auroc': 0.92042303, 'binary_precision': 0.6098901, 'binary_recall': 0.32986626, 'binary_specificity': 0.99214035, 'binary_f1_score': 0.42815813}
confusion matrix:
       0    1
0  17925  142
1    451  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7532704, 'recall': 0.65172195, 'specificity': 0.65172195, 'f1': 0.6881714, 'auroc': 0.91078293, 'binary_precision': 0.53594774, 'binary_recall': 0.31538463, 'binary_specificity': 0.9880592, 'binary_f1_score': 0.39709446}
confusion matrix:
      0   1
0  5875  71
1   178  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-01 16:28:14.699265,epoch time: 0:22:47.989644,used: 0:22:47.989644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99322563, 'precision': 0.994167, 'recall': 0.98793125, 'specificity': 0.98793125, 'f1': 0.99099886, 'auroc': 0.9992476, 'binary_precision': 0.9960413, 'binary_recall': 0.97718287, 'binary_specificity': 0.99867964, 'binary_f1_score': 0.98652196}
confusion matrix:
       0      1
0  42357     56
1    329  14090
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.7643571, 'recall': 0.71175534, 'specificity': 0.71175534, 'f1': 0.734831, 'auroc': 0.93644106, 'binary_precision': 0.5495327, 'binary_recall': 0.43684992, 'binary_specificity': 0.9866608, 'binary_f1_score': 0.48675498}
confusion matrix:
       0    1
0  17826  241
1    379  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.80071414, 'recall': 0.68358433, 'specificity': 0.68358433, 'f1': 0.72640723, 'auroc': 0.9168143, 'binary_precision': 0.6282051, 'binary_recall': 0.37692308, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.4711539}
confusion matrix:
      0   1
0  5888  58
1   162  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_2.png
new oracle model saved
early stop counter: 1
val acc:0.9669156670570374, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9598775506019592 / 0.9645504355430603
after epoch: 2,now: 2024-07-01 16:49:17.220034,epoch time: 0:21:02.520769,used: 0:43:50.510413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9902872, 'precision': 0.9833716, 'recall': 0.991364, 'specificity': 0.991364, 'f1': 0.98728144, 'auroc': 0.99962205, 'binary_precision': 0.96895504, 'binary_recall': 0.9935502, 'binary_specificity': 0.9891778, 'binary_f1_score': 0.9810985}
confusion matrix:
       0      1
0  41954    459
1     93  14326
---- Validation: 
scalar performance:
{'acc': 0.9549627, 'precision': 0.70346594, 'recall': 0.8149921, 'specificity': 0.8149921, 'f1': 0.7453853, 'auroc': 0.9479223, 'binary_precision': 0.4197183, 'binary_recall': 0.6641902, 'binary_specificity': 0.96579397, 'binary_f1_score': 0.5143843}
confusion matrix:
       0    1
0  17449  618
1    226  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9516597, 'precision': 0.6996675, 'recall': 0.7026029, 'specificity': 0.7026029, 'f1': 0.7011227, 'auroc': 0.9167663, 'binary_precision': 0.42424244, 'binary_recall': 0.43076923, 'binary_specificity': 0.9744366, 'binary_f1_score': 0.4274809}
confusion matrix:
      0    1
0  5794  152
1   148  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_3.png
early stop counter: 2
val acc:0.9549626708030701, best validation acc: 0.9683564305305481, corresponding to test acc:                         0.9598775506019592 / 0.9645504355430603
after epoch: 3,now: 2024-07-01 17:10:18.469823,epoch time: 0:21:01.249789,used: 1:04:51.760202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9945805, 'precision': 0.9959669, 'recall': 0.98973095, 'specificity': 0.98973095, 'f1': 0.9927989, 'auroc': 0.99958825, 'binary_precision': 0.99872756, 'binary_recall': 0.97988623, 'binary_specificity': 0.9995756, 'binary_f1_score': 0.98921716}
confusion matrix:
       0      1
0  42396     18
1    290  14128
---- Validation: 
scalar performance:
{'acc': 0.9700107, 'precision': 0.79984546, 'recall': 0.70692307, 'specificity': 0.70692307, 'f1': 0.74403596, 'auroc': 0.9371819, 'binary_precision': 0.62091506, 'binary_recall': 0.42347696, 'binary_specificity': 0.9903692, 'binary_f1_score': 0.50353354}
confusion matrix:
       0    1
0  17893  174
1    388  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.83757764, 'recall': 0.66988146, 'specificity': 0.66988146, 'f1': 0.7233094, 'auroc': 0.92509043, 'binary_precision': 0.703125, 'binary_recall': 0.34615386, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.46391752}
confusion matrix:
      0   1
0  5908  38
1   170  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-01 17:31:32.223505,epoch time: 0:21:13.753682,used: 1:26:05.513884,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9925922, 'precision': 0.9883343, 'recall': 0.9922217, 'specificity': 0.9922217, 'f1': 0.9902579, 'auroc': 0.9995123, 'binary_precision': 0.97958064, 'binary_recall': 0.99146956, 'binary_specificity': 0.99297386, 'binary_f1_score': 0.9854892}
confusion matrix:
       0      1
0  42115    298
1    123  14296
---- Validation: 
scalar performance:
{'acc': 0.92801493, 'precision': 0.64928675, 'recall': 0.8646751, 'specificity': 0.8646751, 'f1': 0.70215714, 'auroc': 0.9363396, 'binary_precision': 0.30663615, 'binary_recall': 0.79643387, 'binary_specificity': 0.93291634, 'binary_f1_score': 0.44279224}
confusion matrix:
       0     1
0  16855  1212
1    137   536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90654206, 'precision': 0.61261666, 'recall': 0.75445616, 'specificity': 0.75445616, 'f1': 0.6475257, 'auroc': 0.9018209, 'binary_precision': 0.24440895, 'binary_recall': 0.5884615, 'binary_specificity': 0.92045075, 'binary_f1_score': 0.34537247}
confusion matrix:
      0    1
0  5473  473
1   107  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_5.png
early stop counter: 1
val acc:0.9280149340629578, best validation acc: 0.9700106978416443, corresponding to test acc:                         0.9664840698242188 / 0.9664840698242188
after epoch: 5,now: 2024-07-01 18:49:41.356167,epoch time: 1:18:09.132662,used: 2:44:14.646546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99538994, 'precision': 0.99527204, 'recall': 0.99253976, 'specificity': 0.99253976, 'f1': 0.99389625, 'auroc': 0.99967015, 'binary_precision': 0.99503464, 'binary_recall': 0.9867536, 'binary_specificity': 0.998326, 'binary_f1_score': 0.9908768}
confusion matrix:
       0      1
0  42342     71
1    191  14228
---- Validation: 
scalar performance:
{'acc': 0.96873, 'precision': 0.7708528, 'recall': 0.81855583, 'specificity': 0.81855583, 'f1': 0.79254365, 'auroc': 0.9577689, 'binary_precision': 0.5545797, 'binary_recall': 0.65676075, 'binary_specificity': 0.9803509, 'binary_f1_score': 0.60136056}
confusion matrix:
       0    1
0  17712  355
1    231  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.789645, 'recall': 0.6812408, 'specificity': 0.6812408, 'f1': 0.7215294, 'auroc': 0.93663967, 'binary_precision': 0.60625, 'binary_recall': 0.37307692, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.46190473}
confusion matrix:
      0   1
0  5883  63
1   163  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_6.png
early stop counter: 2
val acc:0.9687299728393555, best validation acc: 0.9700106978416443, corresponding to test acc:                         0.9664840698242188 / 0.9664840698242188
after epoch: 6,now: 2024-07-01 20:08:34.086554,epoch time: 1:18:52.730387,used: 4:03:07.376933,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99567145, 'precision': 0.99662155, 'recall': 0.9919502, 'specificity': 0.9919502, 'f1': 0.99425787, 'auroc': 0.99974823, 'binary_precision': 0.9985227, 'binary_recall': 0.98439556, 'binary_specificity': 0.99950486, 'binary_f1_score': 0.9914088}
confusion matrix:
       0      1
0  42392     21
1    225  14194
---- Validation: 
scalar performance:
{'acc': 0.96195304, 'precision': 0.7193803, 'recall': 0.6741335, 'specificity': 0.6741335, 'f1': 0.6938304, 'auroc': 0.9288808, 'binary_precision': 0.46226415, 'binary_recall': 0.3640416, 'binary_specificity': 0.9842254, 'binary_f1_score': 0.40731502}
confusion matrix:
       0    1
0  17782  285
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94972605, 'precision': 0.59794617, 'recall': 0.537924, 'specificity': 0.537924, 'f1': 0.55130404, 'auroc': 0.89456975, 'binary_precision': 0.23469388, 'binary_recall': 0.08846154, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.12849161}
confusion matrix:
      0   1
0  5871  75
1   237  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_7.png
early stop counter: 3
val acc:0.9619530439376831, best validation acc: 0.9700106978416443, corresponding to test acc:                         0.9664840698242188 / 0.9664840698242188
after epoch: 7,now: 2024-07-01 21:29:20.779522,epoch time: 1:20:46.692968,used: 5:23:54.069901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99658644, 'precision': 0.99723184, 'recall': 0.99375343, 'specificity': 0.99375343, 'f1': 0.9954771, 'auroc': 0.99985164, 'binary_precision': 0.99852806, 'binary_recall': 0.98800194, 'binary_specificity': 0.99950486, 'binary_f1_score': 0.9932371}
confusion matrix:
       0      1
0  42392     21
1    173  14246
---- Validation: 
scalar performance:
{'acc': 0.9707044, 'precision': 0.8248415, 'recall': 0.6758111, 'specificity': 0.6758111, 'f1': 0.7262225, 'auroc': 0.9529017, 'binary_precision': 0.67318434, 'binary_recall': 0.35809806, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.46750724}
confusion matrix:
       0    1
0  17950  117
1    432  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.73522365, 'recall': 0.5809995, 'specificity': 0.5809995, 'f1': 0.61606765, 'auroc': 0.93737984, 'binary_precision': 0.50574714, 'binary_recall': 0.16923077, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.25360233}
confusion matrix:
      0   1
0  5903  43
1   216  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_8.png
better model found
persisted
after epoch: 8,now: 2024-07-01 21:51:06.258898,epoch time: 0:21:45.479376,used: 5:45:39.549277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99607617, 'precision': 0.99614847, 'recall': 0.9934802, 'specificity': 0.9934802, 'f1': 0.9948052, 'auroc': 0.99977034, 'binary_precision': 0.9962942, 'binary_recall': 0.98821, 'binary_specificity': 0.9987504, 'binary_f1_score': 0.99223566}
confusion matrix:
       0      1
0  42360     53
1    170  14249
---- Validation: 
scalar performance:
{'acc': 0.97310567, 'precision': 0.83414775, 'recall': 0.7256946, 'specificity': 0.7256946, 'f1': 0.7684699, 'auroc': 0.9618849, 'binary_precision': 0.688196, 'binary_recall': 0.45913818, 'binary_specificity': 0.99225104, 'binary_f1_score': 0.5508021}
confusion matrix:
       0    1
0  17927  140
1    364  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.7881334, 'recall': 0.5766598, 'specificity': 0.5766598, 'f1': 0.6152457, 'auroc': 0.951225, 'binary_precision': 0.6119403, 'binary_recall': 0.15769231, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.25076455}
confusion matrix:
      0   1
0  5920  26
1   219  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_9.png
better model found
persisted
after epoch: 9,now: 2024-07-01 22:12:18.528977,epoch time: 0:21:12.270079,used: 6:06:51.819356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9972551, 'precision': 0.99724054, 'recall': 0.9955059, 'specificity': 0.9955059, 'f1': 0.99636936, 'auroc': 0.9997597, 'binary_precision': 0.99721116, 'binary_recall': 0.99195504, 'binary_specificity': 0.9990569, 'binary_f1_score': 0.9945761}
confusion matrix:
       0      1
0  42373     40
1    116  14303
---- Validation: 
scalar performance:
{'acc': 0.9767343, 'precision': 0.8776046, 'recall': 0.74617344, 'specificity': 0.74617344, 'f1': 0.7969, 'auroc': 0.95285404, 'binary_precision': 0.77367204, 'binary_recall': 0.49777117, 'binary_specificity': 0.99457574, 'binary_f1_score': 0.60578656}
confusion matrix:
       0    1
0  17969   98
1    338  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95601034, 'precision': 0.6825155, 'recall': 0.5485595, 'specificity': 0.5485595, 'f1': 0.5712738, 'auroc': 0.93297935, 'binary_precision': 0.40298507, 'binary_recall': 0.103846155, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.16513762}
confusion matrix:
      0   1
0  5906  40
1   233  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_10.png
better model found
persisted
after epoch: 10,now: 2024-07-01 22:33:37.525004,epoch time: 0:21:18.996027,used: 6:28:10.815383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99700874, 'precision': 0.99673116, 'recall': 0.99536407, 'specificity': 0.99536407, 'f1': 0.9960452, 'auroc': 0.9998188, 'binary_precision': 0.9961699, 'binary_recall': 0.99202496, 'binary_specificity': 0.9987032, 'binary_f1_score': 0.99409306}
confusion matrix:
       0      1
0  42357     55
1    115  14305
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.74883837, 'recall': 0.83378506, 'specificity': 0.83378506, 'f1': 0.78431237, 'auroc': 0.95458364, 'binary_precision': 0.5092896, 'binary_recall': 0.692422, 'binary_specificity': 0.9751481, 'binary_f1_score': 0.5869017}
confusion matrix:
       0    1
0  17618  449
1    207  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92652273, 'precision': 0.63342476, 'recall': 0.72994256, 'specificity': 0.72994256, 'f1': 0.66557574, 'auroc': 0.9064257, 'binary_precision': 0.28879312, 'binary_recall': 0.5153846, 'binary_specificity': 0.9445005, 'binary_f1_score': 0.37016577}
confusion matrix:
      0    1
0  5616  330
1   126  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_11.png
early stop counter: 1
val acc:0.9649946689605713, best validation acc: 0.9767342805862427, corresponding to test acc:                         0.9560103416442871 / 0.9664840698242188
after epoch: 11,now: 2024-07-01 22:55:51.412930,epoch time: 0:22:13.887926,used: 6:50:24.703309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9965512, 'precision': 0.997559, 'recall': 0.9933412, 'specificity': 0.9933412, 'f1': 0.9954273, 'auroc': 0.99976254, 'binary_precision': 0.99957854, 'binary_recall': 0.98682386, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.99316025}
confusion matrix:
       0      1
0  42406      6
1    190  14230
---- Validation: 
scalar performance:
{'acc': 0.97470653, 'precision': 0.8841181, 'recall': 0.6993447, 'specificity': 0.6993447, 'f1': 0.7602327, 'auroc': 0.9601931, 'binary_precision': 0.79008746, 'binary_recall': 0.4026746, 'binary_specificity': 0.99601483, 'binary_f1_score': 0.53346455}
confusion matrix:
       0    1
0  17995   72
1    402  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8595747, 'recall': 0.5530894, 'specificity': 0.5530894, 'f1': 0.5843297, 'auroc': 0.9471053, 'binary_precision': 0.7567568, 'binary_recall': 0.10769231, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.1885522}
confusion matrix:
      0   1
0  5937   9
1   232  28
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_12.png
early stop counter: 2
val acc:0.9747065305709839, best validation acc: 0.9767342805862427, corresponding to test acc:                         0.9560103416442871 / 0.9664840698242188
after epoch: 12,now: 2024-07-01 23:17:15.135620,epoch time: 0:21:23.722690,used: 7:11:48.425999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99750143, 'precision': 0.99733764, 'recall': 0.9960604, 'specificity': 0.9960604, 'f1': 0.99669695, 'auroc': 0.99990594, 'binary_precision': 0.9970064, 'binary_recall': 0.99313456, 'binary_specificity': 0.9989861, 'binary_f1_score': 0.99506676}
confusion matrix:
       0      1
0  42369     43
1     99  14321
---- Validation: 
scalar performance:
{'acc': 0.97246534, 'precision': 0.79990387, 'recall': 0.80761826, 'specificity': 0.80761826, 'f1': 0.8037068, 'auroc': 0.96045315, 'binary_precision': 0.6136035, 'binary_recall': 0.63001484, 'binary_specificity': 0.9852217, 'binary_f1_score': 0.62170094}
confusion matrix:
       0    1
0  17800  267
1    249  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9506929, 'precision': 0.67164147, 'recall': 0.62302196, 'specificity': 0.62302196, 'f1': 0.6426213, 'auroc': 0.91707695, 'binary_precision': 0.375, 'binary_recall': 0.2653846, 'binary_specificity': 0.98065925, 'binary_f1_score': 0.3108108}
confusion matrix:
      0    1
0  5831  115
1   191   69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_13.png
early stop counter: 3
val acc:0.9724653363227844, best validation acc: 0.9767342805862427, corresponding to test acc:                         0.9560103416442871 / 0.9664840698242188
after epoch: 13,now: 2024-07-01 23:38:39.662763,epoch time: 0:21:24.527143,used: 7:33:12.953142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99537235, 'precision': 0.9919975, 'recall': 0.9958696, 'specificity': 0.9958696, 'f1': 0.9939139, 'auroc': 0.999923, 'binary_precision': 0.98506033, 'binary_recall': 0.9968791, 'binary_specificity': 0.99486005, 'binary_f1_score': 0.9909345}
confusion matrix:
       0      1
0  42195    218
1     45  14374
---- Validation: 
scalar performance:
{'acc': 0.97486657, 'precision': 0.83013475, 'recall': 0.78311396, 'specificity': 0.78311396, 'f1': 0.80464715, 'auroc': 0.9560571, 'binary_precision': 0.6759582, 'binary_recall': 0.576523, 'binary_specificity': 0.98970497, 'binary_f1_score': 0.6222935}
confusion matrix:
       0    1
0  17881  186
1    285  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.7399453, 'recall': 0.7079737, 'specificity': 0.7079737, 'f1': 0.72265613, 'auroc': 0.945577, 'binary_precision': 0.50446427, 'binary_recall': 0.43461537, 'binary_specificity': 0.981332, 'binary_f1_score': 0.46694213}
confusion matrix:
      0    1
0  5835  111
1   147  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_14.png
early stop counter: 4
val acc:0.9748665690422058, best validation acc: 0.9767342805862427, corresponding to test acc:                         0.9560103416442871 / 0.9664840698242188
after epoch: 14,now: 2024-07-01 23:59:55.512465,epoch time: 0:21:15.849702,used: 7:54:28.802844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99651605, 'precision': 0.9972082, 'recall': 0.99359095, 'specificity': 0.99359095, 'f1': 0.9953828, 'auroc': 0.9997008, 'binary_precision': 0.9985974, 'binary_recall': 0.9876535, 'binary_specificity': 0.99952847, 'binary_f1_score': 0.99309534}
confusion matrix:
       0      1
0  42395     20
1    178  14239
---- Validation: 
scalar performance:
{'acc': 0.9725187, 'precision': 0.8069702, 'recall': 0.77831995, 'specificity': 0.77831995, 'f1': 0.79187167, 'auroc': 0.96206176, 'binary_precision': 0.6299342, 'binary_recall': 0.5690936, 'binary_specificity': 0.9875464, 'binary_f1_score': 0.5979703}
confusion matrix:
       0    1
0  17842  225
1    290  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.81976044, 'recall': 0.6448815, 'specificity': 0.6448815, 'f1': 0.6961533, 'auroc': 0.92747456, 'binary_precision': 0.6695652, 'binary_recall': 0.29615384, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.41066667}
confusion matrix:
      0   1
0  5908  38
1   183  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_15.png
early stop counter: 5
val acc:0.9725186824798584, best validation acc: 0.9767342805862427, corresponding to test acc:                         0.9560103416442871 / 0.9664840698242188
after epoch: 15,now: 2024-07-02 00:21:16.542647,epoch time: 0:21:21.030182,used: 8:15:49.833026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99771255, 'precision': 0.9977547, 'recall': 0.9962016, 'specificity': 0.9962016, 'f1': 0.99697506, 'auroc': 0.9998925, 'binary_precision': 0.99783987, 'binary_recall': 0.9931341, 'binary_specificity': 0.99926907, 'binary_f1_score': 0.99548143}
confusion matrix:
       0      1
0  42382     31
1     99  14320
---- Validation: 
scalar performance:
{'acc': 0.9774813, 'precision': 0.8912289, 'recall': 0.7458456, 'specificity': 0.7458456, 'f1': 0.80062366, 'auroc': 0.9633242, 'binary_precision': 0.8009592, 'binary_recall': 0.4962853, 'binary_specificity': 0.995406, 'binary_f1_score': 0.612844}
confusion matrix:
       0    1
0  17984   83
1    339  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.84699416, 'recall': 0.6059264, 'specificity': 0.6059264, 'f1': 0.65685534, 'auroc': 0.9581896, 'binary_precision': 0.72727275, 'binary_recall': 0.21538462, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.33234423}
confusion matrix:
      0   1
0  5925  21
1   204  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_16.png
better model found
persisted
after epoch: 16,now: 2024-07-02 00:42:26.120704,epoch time: 0:21:09.578057,used: 8:36:59.411083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9922579, 'precision': 0.9857117, 'recall': 0.99421775, 'specificity': 0.99421775, 'f1': 0.98986745, 'auroc': 0.9998687, 'binary_precision': 0.97204214, 'binary_recall': 0.99819696, 'binary_specificity': 0.9902386, 'binary_f1_score': 0.98494595}
confusion matrix:
       0      1
0  41998    414
1     26  14394
---- Validation: 
scalar performance:
{'acc': 0.97214514, 'precision': 0.79154766, 'recall': 0.84536135, 'specificity': 0.84536135, 'f1': 0.81592155, 'auroc': 0.96592724, 'binary_precision': 0.5940224, 'binary_recall': 0.7087667, 'binary_specificity': 0.98195606, 'binary_f1_score': 0.64634144}
confusion matrix:
       0    1
0  17741  326
1    196  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548824, 'precision': 0.71419203, 'recall': 0.68405586, 'specificity': 0.68405586, 'f1': 0.69780844, 'auroc': 0.9332247, 'binary_precision': 0.45495495, 'binary_recall': 0.38846153, 'binary_specificity': 0.9796502, 'binary_f1_score': 0.41908714}
confusion matrix:
      0    1
0  5825  121
1   159  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_17.png
early stop counter: 1
val acc:0.972145140171051, best validation acc: 0.9774813055992126, corresponding to test acc:                         0.9637447595596313 / 0.9664840698242188
after epoch: 17,now: 2024-07-02 01:03:43.622325,epoch time: 0:21:17.501621,used: 8:58:16.912704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9979765, 'precision': 0.99781764, 'recall': 0.9968363, 'specificity': 0.9968363, 'f1': 0.9973257, 'auroc': 0.9998673, 'binary_precision': 0.997496, 'binary_recall': 0.9945215, 'binary_specificity': 0.9991512, 'binary_f1_score': 0.99600655}
confusion matrix:
       0      1
0  42376     36
1     79  14341
---- Validation: 
scalar performance:
{'acc': 0.9755603, 'precision': 0.8233191, 'recall': 0.824244, 'specificity': 0.824244, 'f1': 0.8237808, 'auroc': 0.9617045, 'binary_precision': 0.65925926, 'binary_recall': 0.6612184, 'binary_specificity': 0.9872696, 'binary_f1_score': 0.6602374}
confusion matrix:
       0    1
0  17837  230
1    228  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.77483475, 'recall': 0.77887523, 'specificity': 0.77887523, 'f1': 0.7768383, 'auroc': 0.9416969, 'binary_precision': 0.5681818, 'binary_recall': 0.5769231, 'binary_specificity': 0.98082745, 'binary_f1_score': 0.57251906}
confusion matrix:
      0    1
0  5832  114
1   110  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_18.png
early stop counter: 2
val acc:0.9755603075027466, best validation acc: 0.9774813055992126, corresponding to test acc:                         0.9637447595596313 / 0.9664840698242188
after epoch: 18,now: 2024-07-02 01:24:57.307917,epoch time: 0:21:13.685592,used: 9:19:30.598296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99743104, 'precision': 0.9982147, 'recall': 0.99500585, 'specificity': 0.99500585, 'f1': 0.9965971, 'auroc': 0.9998691, 'binary_precision': 0.9997899, 'binary_recall': 0.9900825, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9949125}
confusion matrix:
       0      1
0  42410      3
1    143  14276
---- Validation: 
scalar performance:
{'acc': 0.97337246, 'precision': 0.9143117, 'recall': 0.65502155, 'specificity': 0.65502155, 'f1': 0.72168505, 'auroc': 0.9574101, 'binary_precision': 0.85365856, 'binary_recall': 0.31203565, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.4570185}
confusion matrix:
       0    1
0  18031   36
1    463  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547212, 'precision': 0.68771976, 'recall': 0.5865055, 'specificity': 0.5865055, 'f1': 0.61564666, 'auroc': 0.9249799, 'binary_precision': 0.41025642, 'binary_recall': 0.18461539, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.2546419}
confusion matrix:
      0   1
0  5877  69
1   212  48
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_19.png
early stop counter: 3
val acc:0.9733724594116211, best validation acc: 0.9774813055992126, corresponding to test acc:                         0.9637447595596313 / 0.9664840698242188
after epoch: 19,now: 2024-07-02 01:46:10.911806,epoch time: 0:21:13.603889,used: 9:40:44.202185,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9943694, 'precision': 0.989934, 'recall': 0.9953579, 'specificity': 0.9953579, 'f1': 0.992607, 'auroc': 0.9998591, 'binary_precision': 0.9807692, 'binary_recall': 0.99736476, 'binary_specificity': 0.9933509, 'binary_f1_score': 0.9889974}
confusion matrix:
       0      1
0  42130    282
1     38  14382
---- Validation: 
scalar performance:
{'acc': 0.96152616, 'precision': 0.73558587, 'recall': 0.88491595, 'specificity': 0.88491595, 'f1': 0.7897295, 'auroc': 0.96195483, 'binary_precision': 0.4787234, 'binary_recall': 0.8023774, 'binary_specificity': 0.9674545, 'binary_f1_score': 0.5996669}
confusion matrix:
       0    1
0  17479  588
1    133  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9518208, 'precision': 0.72615284, 'recall': 0.90129757, 'specificity': 0.90129757, 'f1': 0.78489226, 'auroc': 0.95742226, 'binary_precision': 0.45929018, 'binary_recall': 0.84615386, 'binary_specificity': 0.9564413, 'binary_f1_score': 0.5953992}
confusion matrix:
      0    1
0  5687  259
1    40  220
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_20.png
early stop counter: 4
val acc:0.9615261554718018, best validation acc: 0.9774813055992126, corresponding to test acc:                         0.9637447595596313 / 0.9664840698242188
after epoch: 20,now: 2024-07-02 02:07:27.318246,epoch time: 0:21:16.406440,used: 10:02:00.608625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9970439, 'precision': 0.9963906, 'recall': 0.9957992, 'specificity': 0.9957992, 'f1': 0.99609447, 'auroc': 0.999697, 'binary_precision': 0.9950667, 'binary_recall': 0.9932723, 'binary_specificity': 0.998326, 'binary_f1_score': 0.99416876}
confusion matrix:
       0      1
0  42343     71
1     97  14321
---- Validation: 
scalar performance:
{'acc': 0.9716649, 'precision': 0.7937298, 'recall': 0.80505735, 'specificity': 0.80505735, 'f1': 0.7992747, 'auroc': 0.96036756, 'binary_precision': 0.60142857, 'binary_recall': 0.6255572, 'binary_specificity': 0.9845575, 'binary_f1_score': 0.6132557}
confusion matrix:
       0    1
0  17788  279
1    252  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9510152, 'precision': 0.68108344, 'recall': 0.64341897, 'specificity': 0.64341897, 'f1': 0.65969205, 'auroc': 0.92349285, 'binary_precision': 0.39215687, 'binary_recall': 0.30769232, 'binary_specificity': 0.97914565, 'binary_f1_score': 0.3448276}
confusion matrix:
      0    1
0  5822  124
1   180   80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_21.png
early stop counter: 5
val acc:0.9716649055480957, best validation acc: 0.9774813055992126, corresponding to test acc:                         0.9637447595596313 / 0.9664840698242188
after epoch: 21,now: 2024-07-02 02:28:36.428040,epoch time: 0:21:09.109794,used: 10:23:09.718419,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9978181, 'precision': 0.9984493, 'recall': 0.9957917, 'specificity': 0.9957917, 'f1': 0.99711144, 'auroc': 0.9999479, 'binary_precision': 0.99972034, 'binary_recall': 0.99167764, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9956827}
confusion matrix:
       0      1
0  42409      4
1    120  14299
---- Validation: 
scalar performance:
{'acc': 0.97187835, 'precision': 0.9669937, 'recall': 0.61276114, 'specificity': 0.61276114, 'f1': 0.67572236, 'auroc': 0.96781427, 'binary_precision': 0.96202534, 'binary_recall': 0.22585438, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.36582434}
confusion matrix:
       0    1
0  18061    6
1    521  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.82588905, 'recall': 0.51697135, 'specificity': 0.51697135, 'f1': 0.5224637, 'auroc': 0.9547792, 'binary_precision': 0.6923077, 'binary_recall': 0.034615386, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.06593407}
confusion matrix:
      0  1
0  5942  4
1   251  9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_22.png
early stop counter: 6
val acc:0.9718783497810364, best validation acc: 0.9774813055992126, corresponding to test acc:                         0.9637447595596313 / 0.9664840698242188
after epoch: 22,now: 2024-07-02 02:49:48.957665,epoch time: 0:21:12.529625,used: 10:44:22.248044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9972727, 'precision': 0.9980626, 'recall': 0.99473923, 'specificity': 0.99473923, 'f1': 0.99638677, 'auroc': 0.9998436, 'binary_precision': 0.9996497, 'binary_recall': 0.98959637, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.9945976}
confusion matrix:
       0      1
0  42409      5
1    150  14268
---- Validation: 
scalar performance:
{'acc': 0.97321236, 'precision': 0.8723954, 'recall': 0.6799729, 'specificity': 0.6799729, 'f1': 0.7400968, 'auroc': 0.9618138, 'binary_precision': 0.7680251, 'binary_recall': 0.3640416, 'binary_specificity': 0.99590415, 'binary_f1_score': 0.4939516}
confusion matrix:
       0    1
0  17993   74
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9540767, 'precision': 0.676965, 'recall': 0.5788132, 'specificity': 0.5788132, 'f1': 0.60612595, 'auroc': 0.93508744, 'binary_precision': 0.38938054, 'binary_recall': 0.16923077, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.23592493}
confusion matrix:
      0   1
0  5877  69
1   216  44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_23.png
early stop counter: 7
val acc:0.9732123613357544, best validation acc: 0.9774813055992126, corresponding to test acc:                         0.9637447595596313 / 0.9664840698242188
after epoch: 23,now: 2024-07-02 03:11:00.492230,epoch time: 0:21:11.534565,used: 11:05:33.782609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99806446, 'precision': 0.9984747, 'recall': 0.9964142, 'specificity': 0.9964142, 'f1': 0.997439, 'auroc': 0.99992216, 'binary_precision': 0.9993021, 'binary_recall': 0.9930642, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.9961734}
confusion matrix:
       0      1
0  42404     10
1    100  14318
---- Validation: 
scalar performance:
{'acc': 0.9801494, 'precision': 0.9052448, 'recall': 0.78084695, 'specificity': 0.78084695, 'f1': 0.8308614, 'auroc': 0.9710523, 'binary_precision': 0.82646424, 'binary_recall': 0.5661218, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.67195773}
confusion matrix:
       0    1
0  17987   80
1    292  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.7741674, 'recall': 0.61360776, 'specificity': 0.61360776, 'f1': 0.6570378, 'auroc': 0.94752645, 'binary_precision': 0.5809524, 'binary_recall': 0.23461539, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.33424658}
confusion matrix:
      0   1
0  5902  44
1   199  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_24.png
better model found
persisted
after epoch: 24,now: 2024-07-02 03:32:09.166112,epoch time: 0:21:08.673882,used: 11:26:42.456491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9983988, 'precision': 0.99780643, 'recall': 0.99796593, 'specificity': 0.99796593, 'f1': 0.9978862, 'auroc': 0.9999598, 'binary_precision': 0.99660337, 'binary_recall': 0.9970872, 'binary_specificity': 0.9988447, 'binary_f1_score': 0.99684525}
confusion matrix:
       0      1
0  42364     49
1     42  14377
---- Validation: 
scalar performance:
{'acc': 0.9779616, 'precision': 0.86544627, 'recall': 0.78901076, 'specificity': 0.78901076, 'f1': 0.8223679, 'auroc': 0.96324885, 'binary_precision': 0.7462121, 'binary_recall': 0.5854383, 'binary_specificity': 0.99258316, 'binary_f1_score': 0.6561198}
confusion matrix:
       0    1
0  17933  134
1    279  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.7906222, 'recall': 0.6962049, 'specificity': 0.6962049, 'f1': 0.73318624, 'auroc': 0.95176506, 'binary_precision': 0.6069364, 'binary_recall': 0.40384614, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.48498845}
confusion matrix:
      0    1
0  5878   68
1   155  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_25.png
early stop counter: 1
val acc:0.9779615998268127, best validation acc: 0.9801493883132935, corresponding to test acc:                         0.9608443379402161 / 0.9664840698242188
after epoch: 25,now: 2024-07-02 03:53:17.419260,epoch time: 0:21:08.253148,used: 11:47:50.709639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99834603, 'precision': 0.9980891, 'recall': 0.9975413, 'specificity': 0.9975413, 'f1': 0.9978148, 'auroc': 0.9999455, 'binary_precision': 0.9975684, 'binary_recall': 0.9959079, 'binary_specificity': 0.9991748, 'binary_f1_score': 0.9967374}
confusion matrix:
       0      1
0  42379     35
1     59  14359
---- Validation: 
scalar performance:
{'acc': 0.97817504, 'precision': 0.8692118, 'recall': 0.7876909, 'specificity': 0.7876909, 'f1': 0.82294774, 'auroc': 0.9692525, 'binary_precision': 0.75384617, 'binary_recall': 0.58246654, 'binary_specificity': 0.9929153, 'binary_f1_score': 0.6571668}
confusion matrix:
       0    1
0  17939  128
1    281  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.8486894, 'recall': 0.7155308, 'specificity': 0.7155308, 'f1': 0.7648066, 'auroc': 0.9583359, 'binary_precision': 0.721519, 'binary_recall': 0.43846154, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.54545456}
confusion matrix:
      0    1
0  5902   44
1   146  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_26.png
new oracle model saved
early stop counter: 2
val acc:0.9781750440597534, best validation acc: 0.9801493883132935, corresponding to test acc:                         0.9608443379402161 / 0.969384491443634
after epoch: 26,now: 2024-07-02 04:14:33.481915,epoch time: 0:21:16.062655,used: 12:09:06.772294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.994387, 'precision': 0.9902619, 'recall': 0.99504924, 'specificity': 0.99504924, 'f1': 0.9926253, 'auroc': 0.9998549, 'binary_precision': 0.9817561, 'binary_recall': 0.9963939, 'binary_specificity': 0.9937046, 'binary_f1_score': 0.9890209}
confusion matrix:
       0      1
0  42145    267
1     52  14368
---- Validation: 
scalar performance:
{'acc': 0.956937, 'precision': 0.71875775, 'recall': 0.88396645, 'specificity': 0.88396645, 'f1': 0.77528304, 'auroc': 0.96417606, 'binary_precision': 0.4449918, 'binary_recall': 0.8053492, 'binary_specificity': 0.9625837, 'binary_f1_score': 0.57324165}
confusion matrix:
       0    1
0  17391  676
1    131  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.75215656, 'recall': 0.8779173, 'specificity': 0.8779173, 'f1': 0.8004843, 'auroc': 0.96030295, 'binary_precision': 0.51378447, 'binary_recall': 0.78846157, 'binary_specificity': 0.967373, 'binary_f1_score': 0.6221548}
confusion matrix:
      0    1
0  5752  194
1    55  205
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_27.png
early stop counter: 3
val acc:0.9569370150566101, best validation acc: 0.9801493883132935, corresponding to test acc:                         0.9608443379402161 / 0.969384491443634
after epoch: 27,now: 2024-07-02 04:35:52.239241,epoch time: 0:21:18.757326,used: 12:30:25.529620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99736065, 'precision': 0.9955102, 'recall': 0.99754506, 'specificity': 0.99754506, 'f1': 0.9965223, 'auroc': 0.99995345, 'binary_precision': 0.99172926, 'binary_recall': 0.99791944, 'binary_specificity': 0.9971707, 'binary_f1_score': 0.99481475}
confusion matrix:
       0      1
0  42293    120
1     30  14389
---- Validation: 
scalar performance:
{'acc': 0.97454643, 'precision': 0.8056315, 'recall': 0.865919, 'specificity': 0.865919, 'f1': 0.83276796, 'auroc': 0.97218794, 'binary_precision': 0.62068963, 'binary_recall': 0.7488856, 'binary_specificity': 0.98295236, 'binary_f1_score': 0.6787878}
confusion matrix:
       0    1
0  17759  308
1    169  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.7689762, 'recall': 0.82091963, 'specificity': 0.82091963, 'f1': 0.79233277, 'auroc': 0.9554696, 'binary_precision': 0.55271566, 'binary_recall': 0.6653846, 'binary_specificity': 0.97645473, 'binary_f1_score': 0.6038394}
confusion matrix:
      0    1
0  5806  140
1    87  173
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_28.png
early stop counter: 4
val acc:0.9745464324951172, best validation acc: 0.9801493883132935, corresponding to test acc:                         0.9608443379402161 / 0.969384491443634
after epoch: 28,now: 2024-07-02 04:57:09.903837,epoch time: 0:21:17.664596,used: 12:51:43.194216,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9982932, 'precision': 0.99807644, 'recall': 0.9974146, 'specificity': 0.9974146, 'f1': 0.9977449, 'auroc': 0.99993896, 'binary_precision': 0.9976373, 'binary_recall': 0.99563074, 'binary_specificity': 0.9991984, 'binary_f1_score': 0.996633}
confusion matrix:
       0      1
0  42379     34
1     63  14356
---- Validation: 
scalar performance:
{'acc': 0.97139806, 'precision': 0.8610264, 'recall': 0.6518518, 'specificity': 0.6518518, 'f1': 0.7105583, 'auroc': 0.9547318, 'binary_precision': 0.7472924, 'binary_recall': 0.307578, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.43578947}
confusion matrix:
       0    1
0  17997   70
1    466  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.954399, 'precision': 0.6172712, 'recall': 0.52381176, 'specificity': 0.52381176, 'f1': 0.5333228, 'auroc': 0.91873235, 'binary_precision': 0.27450982, 'binary_recall': 0.053846154, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.09003216}
confusion matrix:
      0   1
0  5909  37
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_29.png
early stop counter: 5
val acc:0.9713980555534363, best validation acc: 0.9801493883132935, corresponding to test acc:                         0.9608443379402161 / 0.969384491443634
after epoch: 29,now: 2024-07-02 05:18:19.043207,epoch time: 0:21:09.139370,used: 13:12:52.333586,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99741346, 'precision': 0.99801666, 'recall': 0.9951546, 'specificity': 0.9951546, 'f1': 0.9965752, 'auroc': 0.9998721, 'binary_precision': 0.9992305, 'binary_recall': 0.99056864, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.99488074}
confusion matrix:
       0      1
0  42401     11
1    136  14284
---- Validation: 
scalar performance:
{'acc': 0.9752935, 'precision': 0.87121725, 'recall': 0.7239682, 'specificity': 0.7239682, 'f1': 0.77789104, 'auroc': 0.95632815, 'binary_precision': 0.7625, 'binary_recall': 0.45319465, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.5684995}
confusion matrix:
       0    1
0  17972   95
1    368  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7710154, 'recall': 0.5614434, 'specificity': 0.5614434, 'f1': 0.5937248, 'auroc': 0.9241996, 'binary_precision': 0.57894737, 'binary_recall': 0.12692308, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.2082019}
confusion matrix:
      0   1
0  5922  24
1   227  33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_30.png
early stop counter: 6
val acc:0.9752935171127319, best validation acc: 0.9801493883132935, corresponding to test acc:                         0.9608443379402161 / 0.969384491443634
after epoch: 30,now: 2024-07-02 05:39:39.346642,epoch time: 0:21:20.303435,used: 13:34:12.637021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_01_16_05_26_seed_1_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:34:12.637021 at 2024-07-02 05:39:39.346642
persisted model performance metric: 

scalar performance:
{'acc': 0.96084434, 'precision': 0.7741674, 'recall': 0.61360776, 'specificity': 0.61360776, 'f1': 0.6570378, 'auroc': 0.94752645, 'binary_precision': 0.5809524, 'binary_recall': 0.23461539, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.33424658}
confusion matrix:
      0   1
0  5902  44
1   199  61
oracle model performance metric: 

scalar performance:
{'acc': 0.9693845, 'precision': 0.8486894, 'recall': 0.7155308, 'specificity': 0.7155308, 'f1': 0.7648066, 'auroc': 0.9583359, 'binary_precision': 0.721519, 'binary_recall': 0.43846154, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.54545456}
confusion matrix:
      0    1
0  5902   44
1   146  114
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 319595 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool | 291339 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |  28256 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 319595 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool | 291339 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |  28256 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 314119 KiB |   6778 MiB |   2201 TiB |   2201 TiB |
|       from large pool | 286862 KiB |   6752 MiB |   2170 TiB |   2170 TiB |
|       from small pool |  27257 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7456 MiB |   7460 MiB |  14320 MiB |   6864 MiB |
|       from large pool |   7404 MiB |   7404 MiB |  14248 MiB |   6844 MiB |
|       from small pool |     52 MiB |     56 MiB |     72 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 284564 KiB | 680184 KiB |   1606 TiB |   1606 TiB |
|       from large pool | 275957 KiB | 675647 KiB |   1574 TiB |   1574 TiB |
|       from small pool |   8607 KiB |  31464 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3206    |    7877    |  410952 K  |  410949 K  |
|       from large pool |     130    |     756    |  206556 K  |  206556 K  |
|       from small pool |    3076    |    7745    |  204396 K  |  204393 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3206    |    7877    |  410952 K  |  410949 K  |
|       from large pool |     130    |     756    |  206556 K  |  206556 K  |
|       from small pool |    3076    |    7745    |  204396 K  |  204393 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     337    |     629    |     294    |
|       from large pool |     309    |     309    |     593    |     284    |
|       from small pool |      26    |      28    |      36    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      60    |    3607    |  252713 K  |  252713 K  |
|       from large pool |      27    |     307    |  157606 K  |  157606 K  |
|       from small pool |      33    |    3580    |   95106 K  |   95106 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |      0 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |      0 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   2201 TiB |   2201 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   2170 TiB |   2170 TiB |
|       from small pool |      0 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7460 MiB |  14320 MiB |  13730 MiB |
|       from large pool | 567296 KiB |   7404 MiB |  14248 MiB |  13694 MiB |
|       from small pool |  36864 KiB |     56 MiB |     72 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |   1606 TiB |   1606 TiB |
|       from large pool |  24320 KiB | 675647 KiB |   1574 TiB |   1574 TiB |
|       from small pool |      0 KiB |  31464 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7877    |  410952 K  |  410952 K  |
|       from large pool |       2    |     756    |  206556 K  |  206556 K  |
|       from small pool |       0    |    7745    |  204396 K  |  204396 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7877    |  410952 K  |  410952 K  |
|       from large pool |       2    |     756    |  206556 K  |  206556 K  |
|       from small pool |       0    |    7745    |  204396 K  |  204396 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     337    |     629    |     586    |
|       from large pool |      25    |     309    |     593    |     568    |
|       from small pool |      18    |      28    |      36    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3607    |  252715 K  |  252715 K  |
|       from large pool |       3    |     307    |  157606 K  |  157606 K  |
|       from small pool |       0    |    3580    |   95108 K  |   95108 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |      0 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   2205 TiB |   2205 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   2173 TiB |   2173 TiB |
|       from small pool |      0 KiB |     48 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   2201 TiB |   2201 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   2170 TiB |   2170 TiB |
|       from small pool |      0 KiB |     47 MiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 604160 KiB |   7460 MiB |  14320 MiB |  13730 MiB |
|       from large pool | 567296 KiB |   7404 MiB |  14248 MiB |  13694 MiB |
|       from small pool |  36864 KiB |     56 MiB |     72 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |   1606 TiB |   1606 TiB |
|       from large pool |  24320 KiB | 675647 KiB |   1574 TiB |   1574 TiB |
|       from small pool |      0 KiB |  31464 KiB |     31 TiB |     31 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7877    |  410952 K  |  410952 K  |
|       from large pool |       2    |     756    |  206556 K  |  206556 K  |
|       from small pool |       0    |    7745    |  204396 K  |  204396 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7877    |  410952 K  |  410952 K  |
|       from large pool |       2    |     756    |  206556 K  |  206556 K  |
|       from small pool |       0    |    7745    |  204396 K  |  204396 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      43    |     337    |     629    |     586    |
|       from large pool |      25    |     309    |     593    |     568    |
|       from small pool |      18    |      28    |      36    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3607    |  252715 K  |  252715 K  |
|       from large pool |       3    |     307    |  157606 K  |  157606 K  |
|       from small pool |       0    |    3580    |   95108 K  |   95108 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058

 Experiment start at: 2024-07-02 05:47:24.069936
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9898155, 'precision': 0.99190724, 'recall': 0.98185635, 'specificity': 0.98185635, 'f1': 0.98674285, 'auroc': 0.99913394, 'binary_precision': 0.9961793, 'binary_recall': 0.96503633, 'binary_specificity': 0.9986764, 'binary_f1_score': 0.9803605}
confusion matrix:
       0      1
0  42254     56
1    529  14601
---- Validation: 
scalar performance:
{'acc': 0.96606827, 'precision': 0.7267386, 'recall': 0.72710264, 'specificity': 0.72710264, 'f1': 0.7269204, 'auroc': 0.9375417, 'binary_precision': 0.47097844, 'binary_recall': 0.4717608, 'binary_specificity': 0.9824445, 'binary_f1_score': 0.4713693}
confusion matrix:
       0    1
0  17852  319
1    318  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9757974, 'precision': 0.8696231, 'recall': 0.77327436, 'specificity': 0.77327436, 'f1': 0.81354815, 'auroc': 0.9242933, 'binary_precision': 0.75706214, 'binary_recall': 0.553719, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.6396181}
confusion matrix:
      0    1
0  5954   43
1   108  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-02 06:09:44.090017,epoch time: 0:22:20.020081,used: 0:22:20.020081,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9914171, 'precision': 0.9908165, 'recall': 0.98701894, 'specificity': 0.98701894, 'f1': 0.9888976, 'auroc': 0.99910146, 'binary_precision': 0.9895638, 'binary_recall': 0.9777249, 'binary_specificity': 0.99631304, 'binary_f1_score': 0.9836087}
confusion matrix:
       0      1
0  42155    156
1    337  14792
---- Validation: 
scalar performance:
{'acc': 0.96612155, 'precision': 0.7305988, 'recall': 0.7688887, 'specificity': 0.7688887, 'f1': 0.7481054, 'auroc': 0.9429894, 'binary_precision': 0.47592068, 'binary_recall': 0.55813956, 'binary_specificity': 0.97963786, 'binary_f1_score': 0.51376146}
confusion matrix:
       0    1
0  17801  370
1    266  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.7903799, 'recall': 0.7533271, 'specificity': 0.7533271, 'f1': 0.7704457, 'auroc': 0.917642, 'binary_precision': 0.6, 'binary_recall': 0.5206612, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.5575221}
confusion matrix:
      0    1
0  5913   84
1   116  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_2.png
better model found
persisted
after epoch: 2,now: 2024-07-02 06:31:08.653939,epoch time: 0:21:24.563922,used: 0:43:44.584003,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9929318, 'precision': 0.9948002, 'recall': 0.9870075, 'specificity': 0.9870075, 'f1': 0.99082077, 'auroc': 0.99951816, 'binary_precision': 0.99864537, 'binary_recall': 0.9744878, 'binary_specificity': 0.9995273, 'binary_f1_score': 0.9864187}
confusion matrix:
       0      1
0  42290     20
1    386  14744
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.90153134, 'recall': 0.52887714, 'specificity': 0.52887714, 'f1': 0.5465705, 'auroc': 0.9434531, 'binary_precision': 0.8333333, 'binary_recall': 0.058139537, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.108695656}
confusion matrix:
       0   1
0  18164   7
1    567  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.8743029, 'recall': 0.52247715, 'specificity': 0.52247715, 'f1': 0.5333958, 'auroc': 0.93139666, 'binary_precision': 0.78571427, 'binary_recall': 0.045454547, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.08593751}
confusion matrix:
      0   1
0  5994   3
1   231  11
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_3.png
better model found
persisted
after epoch: 3,now: 2024-07-02 06:52:29.103292,epoch time: 0:21:20.449353,used: 1:05:05.033356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9914345, 'precision': 0.9871365, 'recall': 0.9909165, 'specificity': 0.9909165, 'f1': 0.98900616, 'auroc': 0.99955285, 'binary_precision': 0.9779287, 'binary_recall': 0.98982155, 'binary_specificity': 0.99201137, 'binary_f1_score': 0.98383915}
confusion matrix:
       0      1
0  41972    338
1    154  14976
---- Validation: 
scalar performance:
{'acc': 0.96079475, 'precision': 0.7094972, 'recall': 0.82556266, 'specificity': 0.82556266, 'f1': 0.7532711, 'auroc': 0.9469268, 'binary_precision': 0.4297694, 'binary_recall': 0.6810631, 'binary_specificity': 0.9700622, 'binary_f1_score': 0.5269923}
confusion matrix:
       0    1
0  17627  544
1    192  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9523962, 'precision': 0.69965756, 'recall': 0.7690326, 'specificity': 0.7690326, 'f1': 0.728364, 'auroc': 0.8946655, 'binary_precision': 0.41691843, 'binary_recall': 0.57024795, 'binary_specificity': 0.96781725, 'binary_f1_score': 0.4816754}
confusion matrix:
      0    1
0  5804  193
1   104  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_4.png
early stop counter: 1
val acc:0.9607947468757629, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9624940156936646 / 0.9757974147796631
after epoch: 4,now: 2024-07-02 07:13:43.326812,epoch time: 0:21:14.223520,used: 1:26:19.256876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9915564, 'precision': 0.99399376, 'recall': 0.9842907, 'specificity': 0.9842907, 'f1': 0.9890133, 'auroc': 0.9994767, 'binary_precision': 0.99897784, 'binary_recall': 0.9689359, 'binary_specificity': 0.9996455, 'binary_f1_score': 0.9837276}
confusion matrix:
       0      1
0  42295     15
1    470  14660
---- Validation: 
scalar performance:
{'acc': 0.9693176, 'precision': 0.93783766, 'recall': 0.5240038, 'specificity': 0.5240038, 'f1': 0.537939, 'auroc': 0.94955254, 'binary_precision': 0.90625, 'binary_recall': 0.048172757, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.09148265}
confusion matrix:
       0   1
0  18168   3
1    573  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.9812229, 'recall': 0.5165289, 'specificity': 0.5165289, 'f1': 0.5224318, 'auroc': 0.925429, 'binary_precision': 1.0, 'binary_recall': 0.03305785, 'binary_specificity': 1.0, 'binary_f1_score': 0.064}
confusion matrix:
      0  1
0  5997  0
1   234  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_5.png
early stop counter: 2
val acc:0.969317615032196, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9624940156936646 / 0.9757974147796631
after epoch: 5,now: 2024-07-02 07:34:55.478585,epoch time: 0:21:12.151773,used: 1:47:31.408649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9956302, 'precision': 0.9945041, 'recall': 0.994231, 'specificity': 0.994231, 'f1': 0.9943674, 'auroc': 0.99971986, 'binary_precision': 0.992127, 'binary_recall': 0.9912745, 'binary_specificity': 0.99718755, 'binary_f1_score': 0.99170053}
confusion matrix:
       0      1
0  42193    119
1    132  14996
---- Validation: 
scalar performance:
{'acc': 0.95935655, 'precision': 0.70998937, 'recall': 0.87541175, 'specificity': 0.87541175, 'f1': 0.7661246, 'auroc': 0.9575655, 'binary_precision': 0.42728093, 'binary_recall': 0.78571427, 'binary_specificity': 0.9651092, 'binary_f1_score': 0.55354005}
confusion matrix:
       0    1
0  17537  634
1    129  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663408, 'precision': 0.7721468, 'recall': 0.8000791, 'specificity': 0.8000791, 'f1': 0.78534424, 'auroc': 0.9416306, 'binary_precision': 0.5597015, 'binary_recall': 0.6198347, 'binary_specificity': 0.9803235, 'binary_f1_score': 0.5882353}
confusion matrix:
      0    1
0  5879  118
1    92  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_6.png
early stop counter: 3
val acc:0.9593565464019775, best validation acc: 0.9694241881370544, corresponding to test acc:                         0.9624940156936646 / 0.9757974147796631
after epoch: 6,now: 2024-07-02 07:56:14.909308,epoch time: 0:21:19.430723,used: 2:08:50.839372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9943593, 'precision': 0.99591225, 'recall': 0.9895681, 'specificity': 0.9895681, 'f1': 0.99268514, 'auroc': 0.9996602, 'binary_precision': 0.99912345, 'binary_recall': 0.97944343, 'binary_specificity': 0.99969274, 'binary_f1_score': 0.9891856}
confusion matrix:
       0      1
0  42298     13
1    311  14818
---- Validation: 
scalar performance:
{'acc': 0.97272676, 'precision': 0.8813662, 'recall': 0.6012514, 'specificity': 0.6012514, 'f1': 0.65531033, 'auroc': 0.96091425, 'binary_precision': 0.78846157, 'binary_recall': 0.20431894, 'binary_specificity': 0.9981839, 'binary_f1_score': 0.32453826}
confusion matrix:
       0    1
0  18138   33
1    479  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.8388894, 'recall': 0.5304915, 'specificity': 0.5304915, 'f1': 0.54749674, 'auroc': 0.9396022, 'binary_precision': 0.71428573, 'binary_recall': 0.06198347, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.11406844}
confusion matrix:
      0   1
0  5991   6
1   227  15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_7.png
better model found
persisted
after epoch: 7,now: 2024-07-02 08:17:32.435481,epoch time: 0:21:17.526173,used: 2:30:08.365545,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9961525, 'precision': 0.9967061, 'recall': 0.99337554, 'specificity': 0.99337554, 'f1': 0.99502563, 'auroc': 0.9998071, 'binary_precision': 0.9978627, 'binary_recall': 0.98750746, 'binary_specificity': 0.9992437, 'binary_f1_score': 0.9926581}
confusion matrix:
       0      1
0  42279     32
1    189  14940
---- Validation: 
scalar performance:
{'acc': 0.963831, 'precision': 0.725129, 'recall': 0.8488134, 'specificity': 0.8488134, 'f1': 0.7719585, 'auroc': 0.95084566, 'binary_precision': 0.4595163, 'binary_recall': 0.72591364, 'binary_specificity': 0.9717132, 'binary_f1_score': 0.5627817}
confusion matrix:
       0    1
0  17657  514
1    165  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.7307971, 'recall': 0.78244805, 'specificity': 0.78244805, 'f1': 0.7536442, 'auroc': 0.920653, 'binary_precision': 0.47826087, 'binary_recall': 0.59090906, 'binary_specificity': 0.973987, 'binary_f1_score': 0.52865064}
confusion matrix:
      0    1
0  5841  156
1    99  143
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_8.png
early stop counter: 1
val acc:0.9638310074806213, best validation acc: 0.9727267622947693, corresponding to test acc:                         0.9626542925834656 / 0.9757974147796631
after epoch: 8,now: 2024-07-02 08:38:50.525185,epoch time: 0:21:18.089704,used: 2:51:26.455249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99500346, 'precision': 0.99318063, 'recall': 0.9939545, 'specificity': 0.9939545, 'f1': 0.99356675, 'auroc': 0.999612, 'binary_precision': 0.9893182, 'binary_recall': 0.9917377, 'binary_specificity': 0.99617124, 'binary_f1_score': 0.9905265}
confusion matrix:
       0      1
0  42149    162
1    125  15004
---- Validation: 
scalar performance:
{'acc': 0.96585524, 'precision': 0.72825813, 'recall': 0.7607206, 'specificity': 0.7607206, 'f1': 0.7432862, 'auroc': 0.9433697, 'binary_precision': 0.47178003, 'binary_recall': 0.5415282, 'binary_specificity': 0.97991306, 'binary_f1_score': 0.5042536}
confusion matrix:
       0    1
0  17806  365
1    276  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495111, 'precision': 0.6203577, 'recall': 0.5811542, 'specificity': 0.5811542, 'f1': 0.5961377, 'auroc': 0.9048154, 'binary_precision': 0.27329192, 'binary_recall': 0.18181819, 'binary_specificity': 0.98049027, 'binary_f1_score': 0.21836229}
confusion matrix:
      0    1
0  5880  117
1   198   44
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_9.png
early stop counter: 2
val acc:0.9658552408218384, best validation acc: 0.9727267622947693, corresponding to test acc:                         0.9626542925834656 / 0.9757974147796631
after epoch: 9,now: 2024-07-02 09:00:04.216963,epoch time: 0:21:13.691778,used: 3:12:40.147027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9912953, 'precision': 0.9940921, 'recall': 0.9835391, 'specificity': 0.9835391, 'f1': 0.98866343, 'auroc': 0.9995681, 'binary_precision': 0.999795, 'binary_recall': 0.9671492, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9832012}
confusion matrix:
       0      1
0  42308      3
1    497  14632
---- Validation: 
scalar performance:
{'acc': 0.9682523, 'precision': 0.85919595, 'recall': 0.5073925, 'specificity': 0.5073925, 'f1': 0.5065891, 'auroc': 0.9550169, 'binary_precision': 0.75, 'binary_recall': 0.014950166, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.029315962}
confusion matrix:
       0  1
0  18168  3
1    593  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.9806829, 'recall': 0.50206614, 'specificity': 0.50206614, 'f1': 0.49426642, 'auroc': 0.9408561, 'binary_precision': 1.0, 'binary_recall': 0.004132231, 'binary_specificity': 1.0, 'binary_f1_score': 0.008230452}
confusion matrix:
      0  1
0  5997  0
1   241  1
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_10.png
early stop counter: 3
val acc:0.9682523012161255, best validation acc: 0.9727267622947693, corresponding to test acc:                         0.9626542925834656 / 0.9757974147796631
after epoch: 10,now: 2024-07-02 09:21:18.303394,epoch time: 0:21:14.086431,used: 3:33:54.233458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9957347, 'precision': 0.9970994, 'recall': 0.99192476, 'specificity': 0.99192476, 'f1': 0.9944755, 'auroc': 0.9998657, 'binary_precision': 0.9999328, 'binary_recall': 0.9838731, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.991838}
confusion matrix:
       0      1
0  42309      1
1    244  14886
---- Validation: 
scalar performance:
{'acc': 0.9776807, 'precision': 0.89526224, 'recall': 0.696964, 'specificity': 0.696964, 'f1': 0.7607273, 'auroc': 0.95986795, 'binary_precision': 0.8101695, 'binary_recall': 0.39700997, 'binary_specificity': 0.99691814, 'binary_f1_score': 0.5328874}
confusion matrix:
       0    1
0  18115   56
1    363  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.71700406, 'recall': 0.5453529, 'specificity': 0.5453529, 'f1': 0.56898606, 'auroc': 0.9286394, 'binary_precision': 0.46938777, 'binary_recall': 0.09504132, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.1580756}
confusion matrix:
      0   1
0  5971  26
1   219  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_11.png
better model found
persisted
after epoch: 11,now: 2024-07-02 09:42:50.831910,epoch time: 0:21:32.528516,used: 3:55:26.761974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9963266, 'precision': 0.99732244, 'recall': 0.9932177, 'specificity': 0.9932177, 'f1': 0.995247, 'auroc': 0.999823, 'binary_precision': 0.99939746, 'binary_recall': 0.98664814, 'binary_specificity': 0.9997873, 'binary_f1_score': 0.99298185}
confusion matrix:
       0      1
0  42302      9
1    202  14927
---- Validation: 
scalar performance:
{'acc': 0.97831994, 'precision': 0.861025, 'recall': 0.7478863, 'specificity': 0.7478863, 'f1': 0.7931441, 'auroc': 0.9530585, 'binary_precision': 0.73838633, 'binary_recall': 0.5016611, 'binary_specificity': 0.9941115, 'binary_f1_score': 0.59742826}
confusion matrix:
       0    1
0  18064  107
1    300  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.84495723, 'recall': 0.65452355, 'specificity': 0.65452355, 'f1': 0.71031165, 'auroc': 0.92639655, 'binary_precision': 0.7169811, 'binary_recall': 0.3140496, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.43678164}
confusion matrix:
      0   1
0  5967  30
1   166  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_12.png
better model found
persisted
after epoch: 12,now: 2024-07-02 10:04:22.409800,epoch time: 0:21:31.577890,used: 4:16:58.339864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9972145, 'precision': 0.9972557, 'recall': 0.99556166, 'specificity': 0.99556166, 'f1': 0.99640477, 'auroc': 0.999737, 'binary_precision': 0.99734217, 'binary_recall': 0.9920687, 'binary_specificity': 0.9990546, 'binary_f1_score': 0.99469846}
confusion matrix:
       0      1
0  42270     40
1    120  15010
---- Validation: 
scalar performance:
{'acc': 0.9701699, 'precision': 0.75805056, 'recall': 0.8456634, 'specificity': 0.8456634, 'f1': 0.7947886, 'auroc': 0.95827734, 'binary_precision': 0.5257353, 'binary_recall': 0.7126246, 'binary_specificity': 0.9787023, 'binary_f1_score': 0.6050776}
confusion matrix:
       0    1
0  17784  387
1    173  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549607, 'precision': 0.7118952, 'recall': 0.78226304, 'specificity': 0.78226304, 'f1': 0.7412778, 'auroc': 0.91131395, 'binary_precision': 0.44036698, 'binary_recall': 0.59504133, 'binary_specificity': 0.96948475, 'binary_f1_score': 0.5061512}
confusion matrix:
      0    1
0  5814  183
1    98  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_13.png
early stop counter: 1
val acc:0.9701699018478394, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9685847163200378 / 0.9757974147796631
after epoch: 13,now: 2024-07-02 10:25:57.646842,epoch time: 0:21:35.237042,used: 4:38:33.576906,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9968663, 'precision': 0.9956081, 'recall': 0.9963229, 'specificity': 0.9963229, 'f1': 0.99596477, 'auroc': 0.99990046, 'binary_precision': 0.99294287, 'binary_recall': 0.9951745, 'binary_specificity': 0.99747115, 'binary_f1_score': 0.9940574}
confusion matrix:
       0      1
0  42205    107
1     73  15055
---- Validation: 
scalar performance:
{'acc': 0.9631385, 'precision': 0.7223296, 'recall': 0.8516679, 'specificity': 0.8516679, 'f1': 0.7705593, 'auroc': 0.95621383, 'binary_precision': 0.4537037, 'binary_recall': 0.73255813, 'binary_specificity': 0.97077763, 'binary_f1_score': 0.5603558}
confusion matrix:
       0    1
0  17640  531
1    161  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501523, 'precision': 0.68344355, 'recall': 0.73019326, 'specificity': 0.73019326, 'f1': 0.70372224, 'auroc': 0.92307913, 'binary_precision': 0.38762215, 'binary_recall': 0.49173555, 'binary_specificity': 0.968651, 'binary_f1_score': 0.4335155}
confusion matrix:
      0    1
0  5809  188
1   123  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_14.png
early stop counter: 2
val acc:0.9631385207176208, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9685847163200378 / 0.9757974147796631
after epoch: 14,now: 2024-07-02 10:48:23.459188,epoch time: 0:22:25.812346,used: 5:00:59.389252,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9959088, 'precision': 0.9952614, 'recall': 0.99418676, 'specificity': 0.99418676, 'f1': 0.9947225, 'auroc': 0.9998263, 'binary_precision': 0.9938984, 'binary_recall': 0.99054796, 'binary_specificity': 0.9978256, 'binary_f1_score': 0.9922204}
confusion matrix:
       0      1
0  42219     92
1    143  14986
---- Validation: 
scalar performance:
{'acc': 0.97176796, 'precision': 0.7998873, 'recall': 0.648939, 'specificity': 0.648939, 'f1': 0.6970105, 'auroc': 0.9393909, 'binary_precision': 0.622449, 'binary_recall': 0.3039867, 'binary_specificity': 0.99389136, 'binary_f1_score': 0.40848213}
confusion matrix:
       0    1
0  18060  111
1    419  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.78668755, 'recall': 0.5744453, 'specificity': 0.5744453, 'f1': 0.6127077, 'auroc': 0.9337415, 'binary_precision': 0.60655737, 'binary_recall': 0.15289256, 'binary_specificity': 0.995998, 'binary_f1_score': 0.2442244}
confusion matrix:
      0   1
0  5973  24
1   205  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_15.png
early stop counter: 3
val acc:0.9717679619789124, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9685847163200378 / 0.9757974147796631
after epoch: 15,now: 2024-07-02 11:11:58.405696,epoch time: 0:23:34.946508,used: 5:24:34.335760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.997406, 'precision': 0.9980075, 'recall': 0.99530953, 'specificity': 0.99530953, 'f1': 0.99664855, 'auroc': 0.9998373, 'binary_precision': 0.9992668, 'binary_recall': 0.99087906, 'binary_specificity': 0.99974, 'binary_f1_score': 0.9950552}
confusion matrix:
       0      1
0  42299     11
1    138  14992
---- Validation: 
scalar performance:
{'acc': 0.97810686, 'precision': 0.8884832, 'recall': 0.71163905, 'specificity': 0.71163905, 'f1': 0.77222633, 'auroc': 0.95187676, 'binary_precision': 0.7956656, 'binary_recall': 0.4269103, 'binary_specificity': 0.9963678, 'binary_f1_score': 0.55567575}
confusion matrix:
       0    1
0  18105   66
1    345  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.8800609, 'recall': 0.5858597, 'specificity': 0.5858597, 'f1': 0.63371325, 'auroc': 0.9386896, 'binary_precision': 0.7924528, 'binary_recall': 0.17355372, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.28474575}
confusion matrix:
      0   1
0  5986  11
1   200  42
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_16.png
early stop counter: 4
val acc:0.9781068563461304, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9685847163200378 / 0.9757974147796631
after epoch: 16,now: 2024-07-02 11:33:55.698358,epoch time: 0:21:57.292662,used: 5:46:31.628422,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9972841, 'precision': 0.9975594, 'recall': 0.9954391, 'specificity': 0.9954391, 'f1': 0.9964931, 'auroc': 0.9998485, 'binary_precision': 0.99813706, 'binary_recall': 0.99154, 'binary_specificity': 0.9993382, 'binary_f1_score': 0.99482757}
confusion matrix:
       0      1
0  42282     28
1    128  15002
---- Validation: 
scalar performance:
{'acc': 0.9749108, 'precision': 0.7934946, 'recall': 0.824021, 'specificity': 0.824021, 'f1': 0.8079291, 'auroc': 0.95919156, 'binary_precision': 0.5982009, 'binary_recall': 0.6627907, 'binary_specificity': 0.98525125, 'binary_f1_score': 0.62884164}
confusion matrix:
       0    1
0  17903  268
1    203  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.79809946, 'recall': 0.7216032, 'specificity': 0.7216032, 'f1': 0.75361145, 'auroc': 0.95113516, 'binary_precision': 0.6179775, 'binary_recall': 0.45454547, 'binary_specificity': 0.988661, 'binary_f1_score': 0.5238095}
confusion matrix:
      0    1
0  5929   68
1   132  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_17.png
early stop counter: 5
val acc:0.9749107956886292, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9685847163200378 / 0.9757974147796631
after epoch: 17,now: 2024-07-02 11:55:46.730934,epoch time: 0:21:51.032576,used: 6:08:22.660998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99785864, 'precision': 0.99812055, 'recall': 0.9963596, 'specificity': 0.9963596, 'f1': 0.9972359, 'auroc': 0.99987173, 'binary_precision': 0.99867076, 'binary_recall': 0.9931919, 'binary_specificity': 0.99952734, 'binary_f1_score': 0.9959238}
confusion matrix:
       0      1
0  42291     20
1    103  15026
---- Validation: 
scalar performance:
{'acc': 0.9766686, 'precision': 0.89482164, 'recall': 0.676365, 'specificity': 0.676365, 'f1': 0.74114263, 'auroc': 0.9551659, 'binary_precision': 0.81060606, 'binary_recall': 0.3554817, 'binary_specificity': 0.99724835, 'binary_f1_score': 0.49422634}
confusion matrix:
       0    1
0  18121   50
1    388  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957365, 'precision': 0.6439394, 'recall': 0.5416193, 'specificity': 0.5416193, 'f1': 0.56003743, 'auroc': 0.9274944, 'binary_precision': 0.32352942, 'binary_recall': 0.09090909, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.14193548}
confusion matrix:
      0   1
0  5951  46
1   220  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_18.png
early stop counter: 6
val acc:0.9766685962677002, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9685847163200378 / 0.9757974147796631
after epoch: 18,now: 2024-07-02 12:17:23.887681,epoch time: 0:21:37.156747,used: 6:29:59.817745,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9969882, 'precision': 0.99750924, 'recall': 0.9947287, 'specificity': 0.9947287, 'f1': 0.9961084, 'auroc': 0.9997556, 'binary_precision': 0.9985999, 'binary_recall': 0.98995376, 'binary_specificity': 0.9995037, 'binary_f1_score': 0.99425805}
confusion matrix:
       0      1
0  42289     21
1    152  14978
---- Validation: 
scalar performance:
{'acc': 0.9743781, 'precision': 0.84534955, 'recall': 0.66634834, 'specificity': 0.66634834, 'f1': 0.7223009, 'auroc': 0.9537345, 'binary_precision': 0.7122807, 'binary_recall': 0.3372093, 'binary_specificity': 0.99548733, 'binary_f1_score': 0.4577227}
confusion matrix:
       0    1
0  18089   82
1    399  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9556019, 'precision': 0.62138337, 'recall': 0.54070216, 'specificity': 0.54070216, 'f1': 0.5571432, 'auroc': 0.9178291, 'binary_precision': 0.278481, 'binary_recall': 0.09090909, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.13707165}
confusion matrix:
      0   1
0  5940  57
1   220  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_19.png
early stop counter: 7
val acc:0.9743781089782715, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9685847163200378 / 0.9757974147796631
after epoch: 19,now: 2024-07-02 12:39:21.097349,epoch time: 0:21:57.209668,used: 6:51:57.027413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99674445, 'precision': 0.99663734, 'recall': 0.9949666, 'specificity': 0.9949666, 'f1': 0.9957981, 'auroc': 0.99983937, 'binary_precision': 0.9964122, 'binary_recall': 0.9912095, 'binary_specificity': 0.9987237, 'binary_f1_score': 0.99380404}
confusion matrix:
       0      1
0  42256     54
1    133  14997
---- Validation: 
scalar performance:
{'acc': 0.9458797, 'precision': 0.6501504, 'recall': 0.7704782, 'specificity': 0.7704782, 'f1': 0.6901285, 'auroc': 0.9230414, 'binary_precision': 0.31451613, 'binary_recall': 0.58305645, 'binary_specificity': 0.9578999, 'binary_f1_score': 0.40861467}
confusion matrix:
       0    1
0  17406  765
1    251  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92082065, 'precision': 0.60244924, 'recall': 0.68916, 'specificity': 0.68916, 'f1': 0.6291596, 'auroc': 0.8750038, 'binary_precision': 0.22844827, 'binary_recall': 0.43801653, 'binary_specificity': 0.9403035, 'binary_f1_score': 0.30028328}
confusion matrix:
      0    1
0  5639  358
1   136  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_20.png
early stop counter: 8
val acc:0.9458796977996826, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9685847163200378 / 0.9757974147796631
after epoch: 20,now: 2024-07-02 13:01:27.610827,epoch time: 0:22:06.513478,used: 7:14:03.540891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9971971, 'precision': 0.99777997, 'recall': 0.99499786, 'specificity': 0.99499786, 'f1': 0.9963783, 'auroc': 0.9998797, 'binary_precision': 0.99899995, 'binary_recall': 0.9903503, 'binary_specificity': 0.9996455, 'binary_f1_score': 0.9946563}
confusion matrix:
       0      1
0  42295     15
1    146  14984
---- Validation: 
scalar performance:
{'acc': 0.97379214, 'precision': 0.8872181, 'recall': 0.6210749, 'specificity': 0.6210749, 'f1': 0.6803309, 'auroc': 0.9514727, 'binary_precision': 0.79891306, 'binary_recall': 0.24418604, 'binary_specificity': 0.9979638, 'binary_f1_score': 0.3740458}
confusion matrix:
       0    1
0  18134   37
1    455  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.82058823, 'recall': 0.5466035, 'specificity': 0.5466035, 'f1': 0.5739086, 'auroc': 0.9213165, 'binary_precision': 0.6764706, 'binary_recall': 0.09504132, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.16666666}
confusion matrix:
      0   1
0  5986  11
1   219  23
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_21.png
early stop counter: 9
val acc:0.9737921357154846, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9685847163200378 / 0.9757974147796631
after epoch: 21,now: 2024-07-02 13:23:14.614327,epoch time: 0:21:47.003500,used: 7:35:50.544391,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9976497, 'precision': 0.997446, 'recall': 0.996494, 'specificity': 0.996494, 'f1': 0.99696875, 'auroc': 0.99982965, 'binary_precision': 0.9970169, 'binary_recall': 0.9940516, 'binary_specificity': 0.9989364, 'binary_f1_score': 0.99553204}
confusion matrix:
       0      1
0  42265     45
1     90  15040
---- Validation: 
scalar performance:
{'acc': 0.9740585, 'precision': 0.8783417, 'recall': 0.6316521, 'specificity': 0.6316521, 'f1': 0.6916374, 'auroc': 0.94794637, 'binary_precision': 0.7804878, 'binary_recall': 0.26578072, 'binary_specificity': 0.99752355, 'binary_f1_score': 0.39653036}
confusion matrix:
       0    1
0  18126   45
1    442  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.7651696, 'recall': 0.5520515, 'specificity': 0.5520515, 'f1': 0.5805977, 'auroc': 0.93995774, 'binary_precision': 0.5652174, 'binary_recall': 0.10743801, 'binary_specificity': 0.996665, 'binary_f1_score': 0.18055554}
confusion matrix:
      0   1
0  5977  20
1   216  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_22.png
early stop counter: 10
val acc:0.9740585088729858, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9685847163200378 / 0.9757974147796631
after epoch: 22,now: 2024-07-02 13:44:47.095353,epoch time: 0:21:32.481026,used: 7:57:23.025417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99805015, 'precision': 0.99859375, 'recall': 0.99638367, 'specificity': 0.99638367, 'f1': 0.99748206, 'auroc': 0.99994147, 'binary_precision': 0.9997338, 'binary_recall': 0.99286187, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.996286}
confusion matrix:
       0      1
0  42306      4
1    108  15022
---- Validation: 
scalar performance:
{'acc': 0.9738987, 'precision': 0.91467154, 'recall': 0.61149335, 'specificity': 0.61149335, 'f1': 0.67097145, 'auroc': 0.95794594, 'binary_precision': 0.8544304, 'binary_recall': 0.22425249, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.35526314}
confusion matrix:
       0    1
0  18148   23
1    467  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.6426047, 'recall': 0.5189103, 'specificity': 0.5189103, 'f1': 0.52626544, 'auroc': 0.92413217, 'binary_precision': 0.32258064, 'binary_recall': 0.041322313, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.07326007}
confusion matrix:
      0   1
0  5976  21
1   232  10
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_23.png
early stop counter: 11
val acc:0.973898708820343, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9685847163200378 / 0.9757974147796631
after epoch: 23,now: 2024-07-02 14:06:25.848296,epoch time: 0:21:38.752943,used: 8:19:01.778360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99780643, 'precision': 0.99827826, 'recall': 0.9960693, 'specificity': 0.9960693, 'f1': 0.9971671, 'auroc': 0.9999049, 'binary_precision': 0.9992679, 'binary_recall': 0.9923987, 'binary_specificity': 0.99974, 'binary_f1_score': 0.9958214}
confusion matrix:
       0      1
0  42300     11
1    115  15014
---- Validation: 
scalar performance:
{'acc': 0.97267354, 'precision': 0.8863617, 'recall': 0.59801173, 'specificity': 0.59801173, 'f1': 0.6514843, 'auroc': 0.9571464, 'binary_precision': 0.7986577, 'binary_recall': 0.19767442, 'binary_specificity': 0.998349, 'binary_f1_score': 0.31691077}
confusion matrix:
       0    1
0  18141   30
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.69040406, 'recall': 0.5389878, 'specificity': 0.5389878, 'f1': 0.55870956, 'auroc': 0.93914366, 'binary_precision': 0.41666666, 'binary_recall': 0.08264463, 'binary_specificity': 0.995331, 'binary_f1_score': 0.13793103}
confusion matrix:
      0   1
0  5969  28
1   222  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_24.png
early stop counter: 12
val acc:0.9726735353469849, best validation acc: 0.9783199429512024, corresponding to test acc:                         0.9685847163200378 / 0.9757974147796631
after epoch: 24,now: 2024-07-02 14:28:01.482622,epoch time: 0:21:35.634326,used: 8:40:37.412686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9968837, 'precision': 0.99780655, 'recall': 0.99416953, 'specificity': 0.99416953, 'f1': 0.99596995, 'auroc': 0.9998275, 'binary_precision': 0.9997326, 'binary_recall': 0.9884336, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.994051}
confusion matrix:
       0      1
0  42306      4
1    175  14955
---- Validation: 
scalar performance:
{'acc': 0.97842646, 'precision': 0.9095589, 'recall': 0.7013645, 'specificity': 0.7013645, 'f1': 0.7677115, 'auroc': 0.96777916, 'binary_precision': 0.838488, 'binary_recall': 0.4053156, 'binary_specificity': 0.99741346, 'binary_f1_score': 0.54647255}
confusion matrix:
       0    1
0  18124   47
1    358  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.937764, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_25.png
better model found
persisted
after epoch: 25,now: 2024-07-02 14:50:13.616704,epoch time: 0:22:12.134082,used: 9:02:49.546768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99792826, 'precision': 0.99823207, 'recall': 0.9964283, 'specificity': 0.9964283, 'f1': 0.9973258, 'auroc': 0.9998539, 'binary_precision': 0.9988701, 'binary_recall': 0.9932584, 'binary_specificity': 0.9995982, 'binary_f1_score': 0.9960564}
confusion matrix:
       0      1
0  42293     17
1    102  15028
---- Validation: 
scalar performance:
{'acc': 0.97709477, 'precision': 0.844508, 'recall': 0.7416321, 'specificity': 0.7416321, 'f1': 0.7833295, 'auroc': 0.94662213, 'binary_precision': 0.70574164, 'binary_recall': 0.4900332, 'binary_specificity': 0.993231, 'binary_f1_score': 0.5784314}
confusion matrix:
       0    1
0  18048  123
1    307  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.73051214, 'recall': 0.57922626, 'specificity': 0.57922626, 'f1': 0.61384314, 'auroc': 0.9239155, 'binary_precision': 0.49382716, 'binary_recall': 0.16528925, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.24767803}
confusion matrix:
      0   1
0  5956  41
1   202  40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_26.png
early stop counter: 1
val acc:0.9770947694778442, best validation acc: 0.978426456451416, corresponding to test acc:                         0.9607309103012085 / 0.9757974147796631
after epoch: 26,now: 2024-07-02 15:12:11.580807,epoch time: 0:21:57.964103,used: 9:24:47.510871,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99773675, 'precision': 0.99836046, 'recall': 0.9958098, 'specificity': 0.9958098, 'f1': 0.9970763, 'auroc': 0.99984574, 'binary_precision': 0.99966687, 'binary_recall': 0.9917377, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.99568653}
confusion matrix:
       0      1
0  42306      5
1    125  15004
---- Validation: 
scalar performance:
{'acc': 0.9753369, 'precision': 0.9164977, 'recall': 0.63793385, 'specificity': 0.63793385, 'f1': 0.7032362, 'auroc': 0.9581318, 'binary_precision': 0.85641026, 'binary_recall': 0.27740863, 'binary_specificity': 0.9984591, 'binary_f1_score': 0.4190715}
confusion matrix:
       0    1
0  18143   28
1    435  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.7598832, 'recall': 0.5399883, 'specificity': 0.5399883, 'f1': 0.5621884, 'auroc': 0.9360579, 'binary_precision': 0.5555556, 'binary_recall': 0.08264463, 'binary_specificity': 0.997332, 'binary_f1_score': 0.1438849}
confusion matrix:
      0   1
0  5981  16
1   222  20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_27.png
early stop counter: 2
val acc:0.9753369092941284, best validation acc: 0.978426456451416, corresponding to test acc:                         0.9607309103012085 / 0.9757974147796631
after epoch: 27,now: 2024-07-02 15:33:47.705774,epoch time: 0:21:36.124967,used: 9:46:23.635838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9984332, 'precision': 0.99853194, 'recall': 0.99742913, 'specificity': 0.99742913, 'f1': 0.99797887, 'auroc': 0.9999014, 'binary_precision': 0.9987399, 'binary_recall': 0.9953073, 'binary_specificity': 0.99955094, 'binary_f1_score': 0.99702066}
confusion matrix:
       0      1
0  42291     19
1     71  15059
---- Validation: 
scalar performance:
{'acc': 0.97741437, 'precision': 0.83671176, 'recall': 0.76588863, 'specificity': 0.76588863, 'f1': 0.79679435, 'auroc': 0.959507, 'binary_precision': 0.6885593, 'binary_recall': 0.5398671, 'binary_specificity': 0.99191016, 'binary_f1_score': 0.6052141}
confusion matrix:
       0    1
0  18024  147
1    277  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.72706914, 'recall': 0.63639224, 'specificity': 0.63639224, 'f1': 0.66900826, 'auroc': 0.9279514, 'binary_precision': 0.48251748, 'binary_recall': 0.28512397, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.35844156}
confusion matrix:
      0   1
0  5923  74
1   173  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_28.png
early stop counter: 3
val acc:0.9774143695831299, best validation acc: 0.978426456451416, corresponding to test acc:                         0.9607309103012085 / 0.9757974147796631
after epoch: 28,now: 2024-07-02 15:55:48.863837,epoch time: 0:22:01.158063,used: 10:08:24.793901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9983287, 'precision': 0.99858916, 'recall': 0.99710345, 'specificity': 0.99710345, 'f1': 0.99784327, 'auroc': 0.9999267, 'binary_precision': 0.9991368, 'binary_recall': 0.9945142, 'binary_specificity': 0.99969274, 'binary_f1_score': 0.99682015}
confusion matrix:
       0      1
0  42297     13
1     83  15047
---- Validation: 
scalar performance:
{'acc': 0.96617484, 'precision': 0.7358552, 'recall': 0.8427967, 'specificity': 0.8427967, 'f1': 0.7782496, 'auroc': 0.9512122, 'binary_precision': 0.48143983, 'binary_recall': 0.7109634, 'binary_specificity': 0.9746299, 'binary_f1_score': 0.5741113}
confusion matrix:
       0    1
0  17710  461
1    174  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.956243, 'precision': 0.70350033, 'recall': 0.68974125, 'specificity': 0.68974125, 'f1': 0.6963442, 'auroc': 0.9311956, 'binary_precision': 0.4311111, 'binary_recall': 0.40082645, 'binary_specificity': 0.978656, 'binary_f1_score': 0.41541755}
confusion matrix:
      0    1
0  5869  128
1   145   97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_29.png
early stop counter: 4
val acc:0.966174840927124, best validation acc: 0.978426456451416, corresponding to test acc:                         0.9607309103012085 / 0.9757974147796631
after epoch: 29,now: 2024-07-02 16:17:19.493154,epoch time: 0:21:30.629317,used: 10:29:55.423218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.997406, 'precision': 0.9981587, 'recall': 0.9951606, 'specificity': 0.9951606, 'f1': 0.99664736, 'auroc': 0.9999131, 'binary_precision': 0.9997331, 'binary_recall': 0.99041575, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99505264}
confusion matrix:
       0      1
0  42307      4
1    145  14984
---- Validation: 
scalar performance:
{'acc': 0.97395194, 'precision': 0.9704698, 'recall': 0.59706604, 'specificity': 0.59706604, 'f1': 0.6551858, 'auroc': 0.95597994, 'binary_precision': 0.96694213, 'binary_recall': 0.19435216, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.32365143}
confusion matrix:
       0    1
0  18167    4
1    485  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.8145442, 'recall': 0.5161954, 'specificity': 0.5161954, 'f1': 0.5217611, 'auroc': 0.9437057, 'binary_precision': 0.6666667, 'binary_recall': 0.03305785, 'binary_specificity': 0.999333, 'binary_f1_score': 0.062992126}
confusion matrix:
      0  1
0  5993  4
1   234  8
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21629058_30.png
early stop counter: 5
val acc:0.9739519357681274, best validation acc: 0.978426456451416, corresponding to test acc:                         0.9607309103012085 / 0.9757974147796631
after epoch: 30,now: 2024-07-02 16:38:59.186553,epoch time: 0:21:39.693399,used: 10:51:35.116617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_02_05_47_24_seed_2_21629058
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:51:35.116617 at 2024-07-02 16:38:59.186553
persisted model performance metric: 

scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.937764, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9757974, 'precision': 0.8696231, 'recall': 0.77327436, 'specificity': 0.77327436, 'f1': 0.81354815, 'auroc': 0.9242933, 'binary_precision': 0.75706214, 'binary_recall': 0.553719, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.6396181}
confusion matrix:
      0    1
0  5954   43
1   108  134
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_firsthalffreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 319321 KiB |   6783 MiB |   3310 TiB |   3310 TiB |
|       from large pool | 291059 KiB |   6756 MiB |   3262 TiB |   3262 TiB |
|       from small pool |  28262 KiB |     48 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 319321 KiB |   6783 MiB |   3310 TiB |   3310 TiB |
|       from large pool | 291059 KiB |   6756 MiB |   3262 TiB |   3262 TiB |
|       from small pool |  28262 KiB |     48 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 314121 KiB |   6778 MiB |   3306 TiB |   3306 TiB |
|       from large pool | 286862 KiB |   6752 MiB |   3259 TiB |   3259 TiB |
|       from small pool |  27259 KiB |     47 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7450 MiB |   7460 MiB |  21180 MiB |  13730 MiB |
|       from large pool |   7398 MiB |   7404 MiB |  21092 MiB |  13694 MiB |
|       from small pool |     52 MiB |     56 MiB |     88 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 258214 KiB | 680184 KiB |   2416 TiB |   2416 TiB |
|       from large pool | 249613 KiB | 675647 KiB |   2368 TiB |   2368 TiB |
|       from small pool |   8601 KiB |  31464 KiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3218    |    7927    |  617203 K  |  617199 K  |
|       from large pool |     130    |     756    |  310168 K  |  310168 K  |
|       from small pool |    3088    |    7795    |  307034 K  |  307031 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3218    |    7927    |  617203 K  |  617199 K  |
|       from large pool |     130    |     756    |  310168 K  |  310168 K  |
|       from small pool |    3088    |    7795    |  307034 K  |  307031 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     337    |     921    |     586    |
|       from large pool |     309    |     309    |     877    |     568    |
|       from small pool |      26    |      28    |      44    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      60    |    3629    |  370723 K  |  370723 K  |
|       from large pool |      25    |     307    |  227904 K  |  227903 K  |
|       from small pool |      35    |    3605    |  142819 K  |  142819 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6783 MiB |   3310 TiB |   3310 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   3262 TiB |   3262 TiB |
|       from small pool |      0 KiB |     48 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6783 MiB |   3310 TiB |   3310 TiB |
|       from large pool |  16640 KiB |   6756 MiB |   3262 TiB |   3262 TiB |
|       from small pool |      0 KiB |     48 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6778 MiB |   3306 TiB |   3306 TiB |
|       from large pool |  16640 KiB |   6752 MiB |   3259 TiB |   3259 TiB |
|       from small pool |      0 KiB |     47 MiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 577536 KiB |   7460 MiB |  21180 MiB |  20616 MiB |
|       from large pool | 540672 KiB |   7404 MiB |  21092 MiB |  20564 MiB |
|       from small pool |  36864 KiB |     56 MiB |     88 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 680184 KiB |   2416 TiB |   2416 TiB |
|       from large pool |  24320 KiB | 675647 KiB |   2368 TiB |   2368 TiB |
|       from small pool |      0 KiB |  31470 KiB |     47 TiB |     47 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7927    |  617203 K  |  617203 K  |
|       from large pool |       2    |     756    |  310168 K  |  310168 K  |
|       from small pool |       0    |    7795    |  307034 K  |  307034 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7927    |  617203 K  |  617203 K  |
|       from large pool |       2    |     756    |  310168 K  |  310168 K  |
|       from small pool |       0    |    7795    |  307034 K  |  307034 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     337    |     921    |     879    |
|       from large pool |      24    |     309    |     877    |     853    |
|       from small pool |      18    |      28    |      44    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3629    |  370725 K  |  370725 K  |
|       from large pool |       3    |     307    |  227904 K  |  227904 K  |
|       from small pool |       0    |    3605    |  142821 K  |  142821 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jul  2 16:40:19 2024]
Finished job 0.
1 of 1 steps (100%) done
