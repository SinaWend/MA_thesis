Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun 23 22:19:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887

 Experiment start at: 2024-06-23 22:25:03.239879
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7552945, 'precision': 0.79979813, 'recall': 0.52956337, 'specificity': 0.52956337, 'f1': 0.487715, 'auroc': 0.80301034, 'binary_precision': 0.84608376, 'binary_recall': 0.06311999, 'binary_specificity': 0.9960068, 'binary_f1_score': 0.11747598}
confusion matrix:
       0    1
0  42153  169
1  13789  929
---- Validation: 
scalar performance:
{'acc': 0.9631226, 'precision': 0.49248627, 'recall': 0.49937257, 'specificity': 0.49937257, 'f1': 0.49204582, 'auroc': 0.4420917, 'binary_precision': 0.01923077, 'binary_recall': 0.00155521, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.0028776978}
confusion matrix:
       0   1
0  18098  51
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.86248434, 'recall': 0.5245707, 'specificity': 0.5245707, 'f1': 0.53646684, 'auroc': 0.6337987, 'binary_precision': 0.7647059, 'binary_recall': 0.049808428, 'binary_specificity': 0.999333, 'binary_f1_score': 0.09352518}
confusion matrix:
      0   1
0  5993   4
1   248  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-23 22:43:40.986547,epoch time: 0:18:37.746668,used: 0:18:37.746668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8360273, 'precision': 0.87885785, 'recall': 0.69132566, 'specificity': 0.69132566, 'f1': 0.72606635, 'auroc': 0.91496515, 'binary_precision': 0.9335489, 'binary_recall': 0.39236206, 'binary_specificity': 0.9902892, 'binary_f1_score': 0.5525094}
confusion matrix:
       0     1
0  41913   411
1   8942  5774
---- Validation: 
scalar performance:
{'acc': 0.9559387, 'precision': 0.50282234, 'recall': 0.5009037, 'specificity': 0.5009037, 'f1': 0.49821028, 'auroc': 0.5811511, 'binary_precision': 0.039800994, 'binary_recall': 0.01244168, 'binary_specificity': 0.9893658, 'binary_f1_score': 0.018957345}
confusion matrix:
       0    1
0  17956  193
1    635    8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7534747, 'recall': 0.64933616, 'specificity': 0.64933616, 'f1': 0.68627477, 'auroc': 0.7633886, 'binary_precision': 0.53642386, 'binary_recall': 0.31034482, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.39320388}
confusion matrix:
      0   1
0  5927  70
1   180  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_2.png
new oracle model saved
early stop counter: 1
val acc:0.9559386968612671, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 2,now: 2024-06-23 23:01:46.309741,epoch time: 0:18:05.323194,used: 0:36:43.069862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8959327, 'precision': 0.91708267, 'recall': 0.8093573, 'specificity': 0.8093573, 'f1': 0.84570646, 'auroc': 0.94884825, 'binary_precision': 0.9492635, 'binary_recall': 0.6304348, 'binary_specificity': 0.98827976, 'binary_f1_score': 0.75767475}
confusion matrix:
       0     1
0  41824   496
1   5440  9280
---- Validation: 
scalar performance:
{'acc': 0.94513625, 'precision': 0.520674, 'recall': 0.5148126, 'specificity': 0.5148126, 'f1': 0.51680815, 'auroc': 0.60920084, 'binary_precision': 0.0745614, 'binary_recall': 0.05287714, 'binary_specificity': 0.97674805, 'binary_f1_score': 0.061874427}
confusion matrix:
       0    1
0  17727  422
1    609   34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501438, 'precision': 0.6848221, 'recall': 0.6753166, 'specificity': 0.6753166, 'f1': 0.67992204, 'auroc': 0.7631897, 'binary_precision': 0.39676112, 'binary_recall': 0.37547892, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.38582674}
confusion matrix:
      0    1
0  5848  149
1   163   98
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_3.png
early stop counter: 2
val acc:0.9451362490653992, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 3,now: 2024-06-23 23:20:05.355446,epoch time: 0:18:19.045705,used: 0:55:02.115567,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9055575, 'precision': 0.90407884, 'recall': 0.84229076, 'specificity': 0.84229076, 'f1': 0.86700356, 'auroc': 0.9507736, 'binary_precision': 0.90158427, 'binary_recall': 0.71158683, 'binary_specificity': 0.9729947, 'binary_f1_score': 0.7953967}
confusion matrix:
       0      1
0  41182   1143
1   4244  10471
---- Validation: 
scalar performance:
{'acc': 0.92480844, 'precision': 0.5341135, 'recall': 0.550042, 'specificity': 0.550042, 'f1': 0.5396285, 'auroc': 0.6622023, 'binary_precision': 0.098958336, 'binary_recall': 0.14774494, 'binary_specificity': 0.952339, 'binary_f1_score': 0.11852776}
confusion matrix:
       0    1
0  17284  865
1    548   95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93863857, 'precision': 0.6600464, 'recall': 0.7334453, 'specificity': 0.7334453, 'f1': 0.6884347, 'auroc': 0.80915046, 'binary_precision': 0.34190232, 'binary_recall': 0.5095785, 'binary_specificity': 0.957312, 'binary_f1_score': 0.40923077}
confusion matrix:
      0    1
0  5741  256
1   128  133
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_4.png
early stop counter: 3
val acc:0.9248084425926208, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 4,now: 2024-06-23 23:37:23.236778,epoch time: 0:17:17.881332,used: 1:12:19.996899,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.911115, 'precision': 0.90412056, 'recall': 0.85727614, 'specificity': 0.85727614, 'f1': 0.87709415, 'auroc': 0.9535241, 'binary_precision': 0.89181286, 'binary_recall': 0.74602526, 'binary_specificity': 0.968527, 'binary_f1_score': 0.8124306}
confusion matrix:
       0      1
0  40990   1332
1   3738  10980
---- Validation: 
scalar performance:
{'acc': 0.9203917, 'precision': 0.5366141, 'recall': 0.5597562, 'specificity': 0.5597562, 'f1': 0.5437546, 'auroc': 0.6724588, 'binary_precision': 0.103255816, 'binary_recall': 0.1726283, 'binary_specificity': 0.94688416, 'binary_f1_score': 0.12922001}
confusion matrix:
       0    1
0  17185  964
1    532  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93096834, 'precision': 0.64326686, 'recall': 0.7367726, 'specificity': 0.7367726, 'f1': 0.67576146, 'auroc': 0.8270086, 'binary_precision': 0.30786517, 'binary_recall': 0.5249042, 'binary_specificity': 0.948641, 'binary_f1_score': 0.388102}
confusion matrix:
      0    1
0  5689  308
1   124  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_5.png
early stop counter: 4
val acc:0.9203916788101196, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 5,now: 2024-06-23 23:54:54.854822,epoch time: 0:17:31.618044,used: 1:29:51.614943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9207924, 'precision': 0.91497326, 'recall': 0.8731484, 'specificity': 0.8731484, 'f1': 0.8912705, 'auroc': 0.96499, 'binary_precision': 0.90454656, 'binary_recall': 0.77471966, 'binary_specificity': 0.9715771, 'binary_f1_score': 0.8346146}
confusion matrix:
       0      1
0  41122   1203
1   3315  11400
---- Validation: 
scalar performance:
{'acc': 0.9334291, 'precision': 0.55252486, 'recall': 0.567256, 'specificity': 0.567256, 'f1': 0.5586096, 'auroc': 0.69797015, 'binary_precision': 0.13461539, 'binary_recall': 0.17418352, 'binary_specificity': 0.9603284, 'binary_f1_score': 0.15186441}
confusion matrix:
       0    1
0  17429  720
1    531  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9399169, 'precision': 0.6617073, 'recall': 0.7267829, 'specificity': 0.7267829, 'f1': 0.68764776, 'auroc': 0.80788034, 'binary_precision': 0.3458445, 'binary_recall': 0.49425286, 'binary_specificity': 0.959313, 'binary_f1_score': 0.40694004}
confusion matrix:
      0    1
0  5753  244
1   132  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_6.png
early stop counter: 5
val acc:0.9334291219711304, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 6,now: 2024-06-24 00:14:01.377003,epoch time: 0:19:06.522181,used: 1:48:58.137124,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.92652524, 'precision': 0.9279794, 'recall': 0.8763979, 'specificity': 0.8763979, 'f1': 0.89815027, 'auroc': 0.9657348, 'binary_precision': 0.93052375, 'binary_recall': 0.7728539, 'binary_specificity': 0.9799419, 'binary_f1_score': 0.84439164}
confusion matrix:
       0      1
0  41478    849
1   3342  11371
---- Validation: 
scalar performance:
{'acc': 0.9402405, 'precision': 0.56384116, 'recall': 0.56928223, 'specificity': 0.56928223, 'f1': 0.5664127, 'auroc': 0.69108653, 'binary_precision': 0.15714286, 'binary_recall': 0.1710731, 'binary_specificity': 0.9674913, 'binary_f1_score': 0.16381235}
confusion matrix:
       0    1
0  17559  590
1    533  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9539789, 'precision': 0.71829075, 'recall': 0.7579403, 'specificity': 0.7579403, 'f1': 0.73619545, 'auroc': 0.8326472, 'binary_precision': 0.45659164, 'binary_recall': 0.5440613, 'binary_specificity': 0.9718192, 'binary_f1_score': 0.49650353}
confusion matrix:
      0    1
0  5828  169
1   119  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_7.png
early stop counter: 6
val acc:0.9402405023574829, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 7,now: 2024-06-24 00:31:07.205072,epoch time: 0:17:05.828069,used: 2:06:03.965193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9171985, 'precision': 0.9002452, 'recall': 0.8792763, 'specificity': 0.8792763, 'f1': 0.8890066, 'auroc': 0.96072644, 'binary_precision': 0.8678842, 'binary_recall': 0.8009379, 'binary_specificity': 0.9576147, 'binary_f1_score': 0.83306825}
confusion matrix:
       0      1
0  40532   1794
1   2929  11785
---- Validation: 
scalar performance:
{'acc': 0.9171456, 'precision': 0.5494281, 'recall': 0.5910781, 'specificity': 0.5910781, 'f1': 0.5612245, 'auroc': 0.6976997, 'binary_precision': 0.12663399, 'binary_recall': 0.24105754, 'binary_specificity': 0.9410987, 'binary_f1_score': 0.16604178}
confusion matrix:
       0     1
0  17080  1069
1    488   155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9327261, 'precision': 0.6566215, 'recall': 0.7743364, 'specificity': 0.7743364, 'f1': 0.69573766, 'auroc': 0.85506415, 'binary_precision': 0.33122364, 'binary_recall': 0.6015326, 'binary_specificity': 0.9471402, 'binary_f1_score': 0.4272109}
confusion matrix:
      0    1
0  5680  317
1   104  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_8.png
early stop counter: 7
val acc:0.9171456098556519, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 8,now: 2024-06-24 00:48:12.034871,epoch time: 0:17:04.829799,used: 2:23:08.794992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9233871, 'precision': 0.90670514, 'recall': 0.8899859, 'specificity': 0.8899859, 'f1': 0.8978733, 'auroc': 0.96420085, 'binary_precision': 0.8743486, 'binary_recall': 0.8209868, 'binary_specificity': 0.95898503, 'binary_f1_score': 0.84682786}
confusion matrix:
       0      1
0  40590   1736
1   2634  12080
---- Validation: 
scalar performance:
{'acc': 0.91123885, 'precision': 0.54960316, 'recall': 0.6015211, 'specificity': 0.6015211, 'f1': 0.56245196, 'auroc': 0.68628144, 'binary_precision': 0.12618527, 'binary_recall': 0.2690513, 'binary_specificity': 0.93399084, 'binary_f1_score': 0.17179742}
confusion matrix:
       0     1
0  16951  1198
1    470   173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92713326, 'precision': 0.6474441, 'recall': 0.7805799, 'specificity': 0.7805799, 'f1': 0.6882649, 'auroc': 0.8475853, 'binary_precision': 0.31213874, 'binary_recall': 0.62068963, 'binary_specificity': 0.9404702, 'binary_f1_score': 0.41538462}
confusion matrix:
      0    1
0  5640  357
1    99  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_9.png
early stop counter: 8
val acc:0.9112388491630554, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 9,now: 2024-06-24 01:05:20.392247,epoch time: 0:17:08.357376,used: 2:40:17.152368,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.93331, 'precision': 0.9175686, 'recall': 0.90629774, 'specificity': 0.90629774, 'f1': 0.9117243, 'auroc': 0.9724761, 'binary_precision': 0.8863942, 'binary_recall': 0.8504927, 'binary_specificity': 0.9621028, 'binary_f1_score': 0.8680724}
confusion matrix:
       0      1
0  40721   1604
1   2200  12515
---- Validation: 
scalar performance:
{'acc': 0.91820985, 'precision': 0.5675217, 'recall': 0.6328821, 'specificity': 0.6328821, 'f1': 0.5857364, 'auroc': 0.726987, 'binary_precision': 0.15981735, 'binary_recall': 0.32659408, 'binary_specificity': 0.9391702, 'binary_f1_score': 0.21461421}
confusion matrix:
       0     1
0  17045  1104
1    433   210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9256951, 'precision': 0.6478565, 'recall': 0.79265594, 'specificity': 0.79265594, 'f1': 0.690611, 'auroc': 0.8507677, 'binary_precision': 0.3118081, 'binary_recall': 0.6475096, 'binary_specificity': 0.93780226, 'binary_f1_score': 0.42092153}
confusion matrix:
      0    1
0  5624  373
1    92  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_10.png
early stop counter: 9
val acc:0.9182098507881165, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 10,now: 2024-06-24 01:22:28.002580,epoch time: 0:17:07.610333,used: 2:57:24.762701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9224229, 'precision': 0.89958715, 'recall': 0.8971837, 'specificity': 0.8971837, 'f1': 0.8983752, 'auroc': 0.9654996, 'binary_precision': 0.8528706, 'binary_recall': 0.8450455, 'binary_specificity': 0.9493219, 'binary_f1_score': 0.84894}
confusion matrix:
       0      1
0  40181   2145
1   2280  12434
---- Validation: 
scalar performance:
{'acc': 0.91916776, 'precision': 0.558367, 'recall': 0.6078762, 'specificity': 0.6078762, 'f1': 0.5728006, 'auroc': 0.7107703, 'binary_precision': 0.14332248, 'binary_recall': 0.27371696, 'binary_specificity': 0.9420354, 'binary_f1_score': 0.1881347}
confusion matrix:
       0     1
0  17097  1052
1    467   176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9260147, 'precision': 0.6497185, 'recall': 0.7983197, 'specificity': 0.7983197, 'f1': 0.69336396, 'auroc': 0.850597, 'binary_precision': 0.31501833, 'binary_recall': 0.65900385, 'binary_specificity': 0.9376355, 'binary_f1_score': 0.42627016}
confusion matrix:
      0    1
0  5623  374
1    89  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_11.png
early stop counter: 10
val acc:0.9191677570343018, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 11,now: 2024-06-24 01:39:33.579954,epoch time: 0:17:05.577374,used: 3:14:30.340075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.930014, 'precision': 0.91079646, 'recall': 0.9052738, 'specificity': 0.9052738, 'f1': 0.9079834, 'auroc': 0.9714322, 'binary_precision': 0.87193894, 'binary_recall': 0.8541624, 'binary_specificity': 0.95638514, 'binary_f1_score': 0.8629591}
confusion matrix:
       0      1
0  40479   1846
1   2146  12569
---- Validation: 
scalar performance:
{'acc': 0.92257345, 'precision': 0.5620284, 'recall': 0.6088893, 'specificity': 0.6088893, 'f1': 0.57661974, 'auroc': 0.7131919, 'binary_precision': 0.15060242, 'binary_recall': 0.27216175, 'binary_specificity': 0.94561684, 'binary_f1_score': 0.19390582}
confusion matrix:
       0    1
0  17162  987
1    468  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9340045, 'precision': 0.6656641, 'recall': 0.80248845, 'specificity': 0.80248845, 'f1': 0.7096517, 'auroc': 0.8652673, 'binary_precision': 0.3467742, 'binary_recall': 0.65900385, 'binary_specificity': 0.945973, 'binary_f1_score': 0.45442536}
confusion matrix:
      0    1
0  5673  324
1    89  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_12.png
early stop counter: 11
val acc:0.922573447227478, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 12,now: 2024-06-24 01:56:38.228672,epoch time: 0:17:04.648718,used: 3:31:34.988793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9308555, 'precision': 0.90818566, 'recall': 0.91216916, 'specificity': 0.91216916, 'f1': 0.9101498, 'auroc': 0.97275233, 'binary_precision': 0.8605756, 'binary_recall': 0.8735562, 'binary_specificity': 0.9507821, 'binary_f1_score': 0.86701727}
confusion matrix:
       0      1
0  40239   2083
1   1861  12857
---- Validation: 
scalar performance:
{'acc': 0.9115581, 'precision': 0.56865525, 'recall': 0.6526902, 'specificity': 0.6526902, 'f1': 0.5889587, 'auroc': 0.7508775, 'binary_precision': 0.16055962, 'binary_recall': 0.3748056, 'binary_specificity': 0.9305747, 'binary_f1_score': 0.22481343}
confusion matrix:
       0     1
0  16889  1260
1    402   241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92138064, 'precision': 0.64759755, 'recall': 0.8215544, 'specificity': 0.8215544, 'f1': 0.6941655, 'auroc': 0.8790966, 'binary_precision': 0.3084577, 'binary_recall': 0.7126437, 'binary_specificity': 0.9304652, 'binary_f1_score': 0.43055558}
confusion matrix:
      0    1
0  5580  417
1    75  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_13.png
early stop counter: 12
val acc:0.9115580916404724, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 13,now: 2024-06-24 02:13:54.469765,epoch time: 0:17:16.241093,used: 3:48:51.229886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93338007, 'precision': 0.9181743, 'recall': 0.9057244, 'specificity': 0.9057244, 'f1': 0.9116955, 'auroc': 0.9708038, 'binary_precision': 0.8881855, 'binary_recall': 0.8485899, 'binary_specificity': 0.96285886, 'binary_f1_score': 0.8679364}
confusion matrix:
       0      1
0  40753   1572
1   2228  12487
---- Validation: 
scalar performance:
{'acc': 0.9168263, 'precision': 0.5636609, 'recall': 0.6261654, 'specificity': 0.6261654, 'f1': 0.5807527, 'auroc': 0.7292665, 'binary_precision': 0.15256798, 'binary_recall': 0.31415242, 'binary_specificity': 0.9381784, 'binary_f1_score': 0.20538892}
confusion matrix:
       0     1
0  17027  1122
1    441   202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9255353, 'precision': 0.65136075, 'recall': 0.80906355, 'specificity': 0.80906355, 'f1': 0.6966202, 'auroc': 0.8726406, 'binary_precision': 0.31729054, 'binary_recall': 0.68199235, 'binary_specificity': 0.93613476, 'binary_f1_score': 0.43309003}
confusion matrix:
      0    1
0  5614  383
1    83  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_14.png
early stop counter: 13
val acc:0.9168263077735901, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 14,now: 2024-06-24 02:31:15.896362,epoch time: 0:17:21.426597,used: 4:06:12.656483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.93906033, 'precision': 0.9278334, 'recall': 0.91073596, 'specificity': 0.91073596, 'f1': 0.9188229, 'auroc': 0.9756254, 'binary_precision': 0.9060175, 'binary_recall': 0.8522117, 'binary_specificity': 0.9692602, 'binary_f1_score': 0.87829125}
confusion matrix:
       0      1
0  41022   1301
1   2175  12542
---- Validation: 
scalar performance:
{'acc': 0.92975736, 'precision': 0.57443076, 'recall': 0.6178589, 'specificity': 0.6178589, 'f1': 0.58969164, 'auroc': 0.7442268, 'binary_precision': 0.1748319, 'binary_recall': 0.2830482, 'binary_specificity': 0.95266956, 'binary_f1_score': 0.21615201}
confusion matrix:
       0    1
0  17290  859
1    461  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9434324, 'precision': 0.6923156, 'recall': 0.8257309, 'specificity': 0.8257309, 'f1': 0.7384794, 'auroc': 0.8826412, 'binary_precision': 0.39824945, 'binary_recall': 0.697318, 'binary_specificity': 0.95414376, 'binary_f1_score': 0.5069638}
confusion matrix:
      0    1
0  5722  275
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_15.png
early stop counter: 14
val acc:0.9297573566436768, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 15,now: 2024-06-24 02:48:23.485978,epoch time: 0:17:07.589616,used: 4:23:20.246099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9419355, 'precision': 0.9261036, 'recall': 0.9214933, 'specificity': 0.9214933, 'f1': 0.92376405, 'auroc': 0.9761754, 'binary_precision': 0.8939551, 'binary_recall': 0.8792553, 'binary_specificity': 0.9637313, 'binary_f1_score': 0.8865442}
confusion matrix:
       0      1
0  40788   1535
1   1777  12940
---- Validation: 
scalar performance:
{'acc': 0.9375798, 'precision': 0.58673584, 'recall': 0.6174084, 'specificity': 0.6174084, 'f1': 0.5991448, 'auroc': 0.7392713, 'binary_precision': 0.19954649, 'binary_recall': 0.27371696, 'binary_specificity': 0.9610998, 'binary_f1_score': 0.23081967}
confusion matrix:
       0    1
0  17443  706
1    467  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9479067, 'precision': 0.7021028, 'recall': 0.80607736, 'specificity': 0.80607736, 'f1': 0.7415, 'auroc': 0.8736961, 'binary_precision': 0.41975307, 'binary_recall': 0.651341, 'binary_specificity': 0.96081376, 'binary_f1_score': 0.5105105}
confusion matrix:
      0    1
0  5762  235
1    91  170
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_16.png
early stop counter: 15
val acc:0.9375798106193542, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 16,now: 2024-06-24 03:05:26.383619,epoch time: 0:17:02.897641,used: 4:40:23.143740,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9357293, 'precision': 0.91174453, 'recall': 0.9231557, 'specificity': 0.9231557, 'f1': 0.9172234, 'auroc': 0.9768491, 'binary_precision': 0.8597851, 'binary_recall': 0.8971797, 'binary_specificity': 0.9491317, 'binary_f1_score': 0.8780844}
confusion matrix:
       0      1
0  40172   2153
1   1513  13202
---- Validation: 
scalar performance:
{'acc': 0.91464454, 'precision': 0.57371324, 'recall': 0.6595384, 'specificity': 0.6595384, 'f1': 0.5954935, 'auroc': 0.76066136, 'binary_precision': 0.17021276, 'binary_recall': 0.38569206, 'binary_specificity': 0.9333848, 'binary_f1_score': 0.23619048}
confusion matrix:
       0     1
0  16940  1209
1    395   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9145094, 'precision': 0.6308228, 'recall': 0.7904843, 'specificity': 0.7904843, 'f1': 0.6719998, 'auroc': 0.85160637, 'binary_precision': 0.2775974, 'binary_recall': 0.6551724, 'binary_specificity': 0.9257962, 'binary_f1_score': 0.3899658}
confusion matrix:
      0    1
0  5552  445
1    90  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_17.png
early stop counter: 16
val acc:0.9146445393562317, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 17,now: 2024-06-24 03:22:27.608793,epoch time: 0:17:01.225174,used: 4:57:24.368914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.95054346, 'precision': 0.93899536, 'recall': 0.9308396, 'specificity': 0.9308396, 'f1': 0.9348147, 'auroc': 0.9799278, 'binary_precision': 0.91582775, 'binary_recall': 0.89012706, 'binary_specificity': 0.97155213, 'binary_f1_score': 0.90279454}
confusion matrix:
       0      1
0  41119   1204
1   1617  13100
---- Validation: 
scalar performance:
{'acc': 0.93433374, 'precision': 0.60618085, 'recall': 0.67873245, 'specificity': 0.67873245, 'f1': 0.6310124, 'auroc': 0.76017475, 'binary_precision': 0.2340234, 'binary_recall': 0.4043546, 'binary_specificity': 0.95311034, 'binary_f1_score': 0.29646522}
confusion matrix:
       0    1
0  17298  851
1    383  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9360818, 'precision': 0.67110705, 'recall': 0.80723697, 'specificity': 0.80723697, 'f1': 0.7156251, 'auroc': 0.85954857, 'binary_precision': 0.35728952, 'binary_recall': 0.6666667, 'binary_specificity': 0.94780725, 'binary_f1_score': 0.46524066}
confusion matrix:
      0    1
0  5684  313
1    87  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_18.png
early stop counter: 17
val acc:0.9343337416648865, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 18,now: 2024-06-24 03:39:34.094217,epoch time: 0:17:06.485424,used: 5:14:30.854338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.94580996, 'precision': 0.93103343, 'recall': 0.926818, 'specificity': 0.926818, 'f1': 0.9288974, 'auroc': 0.9797435, 'binary_precision': 0.90097237, 'binary_recall': 0.88756794, 'binary_specificity': 0.966068, 'binary_f1_score': 0.89421993}
confusion matrix:
       0      1
0  40884   1436
1   1655  13065
---- Validation: 
scalar performance:
{'acc': 0.92901236, 'precision': 0.5927003, 'recall': 0.66547674, 'specificity': 0.66547674, 'f1': 0.6160675, 'auroc': 0.7774441, 'binary_precision': 0.2079459, 'binary_recall': 0.38258165, 'binary_specificity': 0.9483718, 'binary_f1_score': 0.26944143}
confusion matrix:
       0    1
0  17212  937
1    397  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9343241, 'precision': 0.67233944, 'recall': 0.8319725, 'specificity': 0.8319725, 'f1': 0.72136116, 'auroc': 0.8909825, 'binary_precision': 0.35741445, 'binary_recall': 0.7203065, 'binary_specificity': 0.9436385, 'binary_f1_score': 0.47776365}
confusion matrix:
      0    1
0  5659  338
1    73  188
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_19.png
early stop counter: 18
val acc:0.9290123581886292, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 19,now: 2024-06-24 03:56:38.404292,epoch time: 0:17:04.310075,used: 5:31:35.164413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.95185834, 'precision': 0.93343234, 'recall': 0.94238263, 'specificity': 0.94238263, 'f1': 0.937778, 'auroc': 0.98422086, 'binary_precision': 0.89400923, 'binary_recall': 0.92280513, 'binary_specificity': 0.96196014, 'binary_f1_score': 0.9081789}
confusion matrix:
       0      1
0  40714   1610
1   1136  13580
---- Validation: 
scalar performance:
{'acc': 0.9280013, 'precision': 0.6013503, 'recall': 0.69495547, 'specificity': 0.69495547, 'f1': 0.62960005, 'auroc': 0.78212583, 'binary_precision': 0.22308892, 'binary_recall': 0.44479004, 'binary_specificity': 0.94512093, 'binary_f1_score': 0.29714283}
confusion matrix:
       0    1
0  17153  996
1    357  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9349632, 'precision': 0.6726457, 'recall': 0.826809, 'specificity': 0.826809, 'f1': 0.72075987, 'auroc': 0.8769666, 'binary_precision': 0.35852712, 'binary_recall': 0.70881224, 'binary_specificity': 0.94480574, 'binary_f1_score': 0.47619048}
confusion matrix:
      0    1
0  5666  331
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_20.png
early stop counter: 19
val acc:0.9280012845993042, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 20,now: 2024-06-24 04:13:43.637419,epoch time: 0:17:05.233127,used: 5:48:40.397540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9558029, 'precision': 0.95134336, 'recall': 0.9318353, 'specificity': 0.9318353, 'f1': 0.9410306, 'auroc': 0.9843023, 'binary_precision': 0.94271815, 'binary_recall': 0.88231295, 'binary_specificity': 0.98135763, 'binary_f1_score': 0.91151595}
confusion matrix:
       0      1
0  41534    789
1   1732  12985
---- Validation: 
scalar performance:
{'acc': 0.9481694, 'precision': 0.6221404, 'recall': 0.6356417, 'specificity': 0.6356417, 'f1': 0.6284677, 'auroc': 0.7507509, 'binary_precision': 0.26917714, 'binary_recall': 0.30015552, 'binary_specificity': 0.97112787, 'binary_f1_score': 0.28382355}
confusion matrix:
       0    1
0  17625  524
1    450  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95653564, 'precision': 0.7320994, 'recall': 0.7775976, 'specificity': 0.7775976, 'f1': 0.7524986, 'auroc': 0.8478805, 'binary_precision': 0.48253968, 'binary_recall': 0.58237547, 'binary_specificity': 0.97281975, 'binary_f1_score': 0.52777773}
confusion matrix:
      0    1
0  5834  163
1   109  152
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_21.png
early stop counter: 20
val acc:0.9481694102287292, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 21,now: 2024-06-24 04:30:46.668115,epoch time: 0:17:03.030696,used: 6:05:43.428236,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9528401, 'precision': 0.93991303, 'recall': 0.9364588, 'specificity': 0.9364588, 'f1': 0.9381674, 'auroc': 0.9819535, 'binary_precision': 0.91354287, 'binary_recall': 0.9026164, 'binary_specificity': 0.9703012, 'binary_f1_score': 0.9080468}
confusion matrix:
       0      1
0  41068   1257
1   1433  13282
---- Validation: 
scalar performance:
{'acc': 0.9362495, 'precision': 0.6098538, 'recall': 0.6789742, 'specificity': 0.6789742, 'f1': 0.6342323, 'auroc': 0.7692697, 'binary_precision': 0.2413793, 'binary_recall': 0.40279937, 'binary_specificity': 0.95514905, 'binary_f1_score': 0.3018648}
confusion matrix:
       0    1
0  17335  814
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94678813, 'precision': 0.70165724, 'recall': 0.8256494, 'specificity': 0.8256494, 'f1': 0.74634653, 'auroc': 0.8856485, 'binary_precision': 0.4170507, 'binary_recall': 0.6934866, 'binary_specificity': 0.95781225, 'binary_f1_score': 0.5208633}
confusion matrix:
      0    1
0  5744  253
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_22.png
early stop counter: 21
val acc:0.9362494945526123, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 22,now: 2024-06-24 04:47:49.127780,epoch time: 0:17:02.459665,used: 6:22:45.887901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.95241934, 'precision': 0.9462749, 'recall': 0.92789316, 'specificity': 0.92789316, 'f1': 0.93657994, 'auroc': 0.9830091, 'binary_precision': 0.9343562, 'binary_recall': 0.8772168, 'binary_specificity': 0.97856957, 'binary_f1_score': 0.9048854}
confusion matrix:
       0      1
0  41416    907
1   1807  12910
---- Validation: 
scalar performance:
{'acc': 0.94215626, 'precision': 0.6068155, 'recall': 0.6392791, 'specificity': 0.6392791, 'f1': 0.62042123, 'auroc': 0.77393925, 'binary_precision': 0.23820755, 'binary_recall': 0.31415242, 'binary_specificity': 0.9644058, 'binary_f1_score': 0.2709591}
confusion matrix:
       0    1
0  17503  646
1    441  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95557684, 'precision': 0.7305331, 'recall': 0.8119117, 'specificity': 0.8119117, 'f1': 0.7641219, 'auroc': 0.8705828, 'binary_precision': 0.47632313, 'binary_recall': 0.6551724, 'binary_specificity': 0.968651, 'binary_f1_score': 0.5516129}
confusion matrix:
      0    1
0  5809  188
1    90  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_23.png
early stop counter: 22
val acc:0.9421562552452087, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 23,now: 2024-06-24 05:04:58.795608,epoch time: 0:17:09.667828,used: 6:39:55.555729,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.95036817, 'precision': 0.932963, 'recall': 0.9383003, 'specificity': 0.9383003, 'f1': 0.93558586, 'auroc': 0.9837265, 'binary_precision': 0.8962528, 'binary_recall': 0.9133655, 'binary_specificity': 0.96323514, 'binary_f1_score': 0.90472823}
confusion matrix:
       0      1
0  40767   1556
1   1275  13442
---- Validation: 
scalar performance:
{'acc': 0.9384845, 'precision': 0.61559653, 'recall': 0.68238145, 'specificity': 0.68238145, 'f1': 0.6398539, 'auroc': 0.779866, 'binary_precision': 0.25265187, 'binary_recall': 0.407465, 'binary_specificity': 0.9572979, 'binary_f1_score': 0.31190473}
confusion matrix:
       0    1
0  17374  775
1    381  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9490253, 'precision': 0.70787454, 'recall': 0.8213197, 'specificity': 0.8213197, 'f1': 0.75023353, 'auroc': 0.87665546, 'binary_precision': 0.4299517, 'binary_recall': 0.68199235, 'binary_specificity': 0.960647, 'binary_f1_score': 0.5274074}
confusion matrix:
      0    1
0  5761  236
1    83  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_24.png
early stop counter: 23
val acc:0.9384844899177551, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 24,now: 2024-06-24 05:22:00.983687,epoch time: 0:17:02.188079,used: 6:56:57.743808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.95241934, 'precision': 0.9456954, 'recall': 0.9285137, 'specificity': 0.9285137, 'f1': 0.9366627, 'auroc': 0.9825251, 'binary_precision': 0.9326029, 'binary_recall': 0.8791194, 'binary_specificity': 0.977908, 'binary_f1_score': 0.9050717}
confusion matrix:
       0      1
0  41388    935
1   1779  12938
---- Validation: 
scalar performance:
{'acc': 0.9375798, 'precision': 0.5937837, 'recall': 0.63240945, 'specificity': 0.63240945, 'f1': 0.6089566, 'auroc': 0.7623662, 'binary_precision': 0.21258135, 'binary_recall': 0.30482116, 'binary_specificity': 0.9599978, 'binary_f1_score': 0.25047922}
confusion matrix:
       0    1
0  17423  726
1    447  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95557684, 'precision': 0.7322651, 'recall': 0.83389974, 'specificity': 0.83389974, 'f1': 0.7724533, 'auroc': 0.8850247, 'binary_precision': 0.47780678, 'binary_recall': 0.7011494, 'binary_specificity': 0.96665, 'binary_f1_score': 0.56832296}
confusion matrix:
      0    1
0  5797  200
1    78  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_25.png
early stop counter: 24
val acc:0.9375798106193542, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 25,now: 2024-06-24 05:39:06.947197,epoch time: 0:17:05.963510,used: 7:14:03.707318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9302069, 'precision': 0.8999251, 'recall': 0.92644083, 'specificity': 0.92644083, 'f1': 0.9118654, 'auroc': 0.9775163, 'binary_precision': 0.8292339, 'binary_recall': 0.91866, 'binary_specificity': 0.93422174, 'binary_f1_score': 0.8716594}
confusion matrix:
       0      1
0  39540   2784
1   1197  13519
---- Validation: 
scalar performance:
{'acc': 0.9214559, 'precision': 0.5893416, 'recall': 0.68481636, 'specificity': 0.68481636, 'f1': 0.615696, 'auroc': 0.7584107, 'binary_precision': 0.1997116, 'binary_recall': 0.43079317, 'binary_specificity': 0.9388396, 'binary_f1_score': 0.2729064}
confusion matrix:
       0     1
0  17039  1110
1    366   277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.924257, 'precision': 0.6550937, 'recall': 0.8358816, 'specificity': 0.8358816, 'f1': 0.7040857, 'auroc': 0.885826, 'binary_precision': 0.32220367, 'binary_recall': 0.7394636, 'binary_specificity': 0.9322995, 'binary_f1_score': 0.4488372}
confusion matrix:
      0    1
0  5591  406
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_26.png
early stop counter: 25
val acc:0.9214559197425842, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 26,now: 2024-06-24 05:56:12.501583,epoch time: 0:17:05.554386,used: 7:31:09.261704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.93935835, 'precision': 0.9121063, 'recall': 0.93619967, 'specificity': 0.93619967, 'f1': 0.9231163, 'auroc': 0.9816919, 'binary_precision': 0.8494971, 'binary_recall': 0.9296732, 'binary_specificity': 0.9427262, 'binary_f1_score': 0.88777864}
confusion matrix:
       0      1
0  39899   2424
1   1035  13682
---- Validation: 
scalar performance:
{'acc': 0.9178374, 'precision': 0.5935926, 'recall': 0.71219516, 'specificity': 0.71219516, 'f1': 0.6234176, 'auroc': 0.78346115, 'binary_precision': 0.20613177, 'binary_recall': 0.49144635, 'binary_specificity': 0.93294394, 'binary_f1_score': 0.2904412}
confusion matrix:
       0     1
0  16932  1217
1    327   316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9191435, 'precision': 0.64767456, 'recall': 0.8368782, 'specificity': 0.8368782, 'f1': 0.6958611, 'auroc': 0.89679646, 'binary_precision': 0.30708662, 'binary_recall': 0.74712646, 'binary_specificity': 0.92662996, 'binary_f1_score': 0.43526787}
confusion matrix:
      0    1
0  5557  440
1    66  195
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_27.png
early stop counter: 26
val acc:0.917837381362915, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 27,now: 2024-06-24 06:13:17.518210,epoch time: 0:17:05.016627,used: 7:48:14.278331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9531732, 'precision': 0.9361094, 'recall': 0.94262135, 'specificity': 0.94262135, 'f1': 0.9392977, 'auroc': 0.98528636, 'binary_precision': 0.8999668, 'binary_recall': 0.9208237, 'binary_specificity': 0.964419, 'binary_f1_score': 0.91027576}
confusion matrix:
       0      1
0  40820   1506
1   1165  13549
---- Validation: 
scalar performance:
{'acc': 0.9315666, 'precision': 0.6116066, 'recall': 0.7095523, 'specificity': 0.7095523, 'f1': 0.64213276, 'auroc': 0.7847042, 'binary_precision': 0.24259408, 'binary_recall': 0.47122863, 'binary_specificity': 0.9478759, 'binary_f1_score': 0.320296}
confusion matrix:
       0    1
0  17203  946
1    340  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93783957, 'precision': 0.68083394, 'recall': 0.8374714, 'specificity': 0.8374714, 'f1': 0.73051673, 'auroc': 0.8968328, 'binary_precision': 0.37401575, 'binary_recall': 0.72796935, 'binary_specificity': 0.9469735, 'binary_f1_score': 0.49414822}
confusion matrix:
      0    1
0  5679  318
1    71  190
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_28.png
early stop counter: 27
val acc:0.931566596031189, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 28,now: 2024-06-24 06:30:19.026350,epoch time: 0:17:01.508140,used: 8:05:15.786471,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.94307506, 'precision': 0.92496794, 'recall': 0.92663944, 'specificity': 0.92663944, 'f1': 0.92579913, 'auroc': 0.97899544, 'binary_precision': 0.88732016, 'binary_recall': 0.89268726, 'binary_specificity': 0.9605916, 'binary_f1_score': 0.88999563}
confusion matrix:
       0      1
0  40658   1668
1   1579  13135
---- Validation: 
scalar performance:
{'acc': 0.9405598, 'precision': 0.61591244, 'recall': 0.67070496, 'specificity': 0.67070496, 'f1': 0.63693416, 'auroc': 0.77215844, 'binary_precision': 0.25414938, 'binary_recall': 0.38102645, 'binary_specificity': 0.9603835, 'binary_f1_score': 0.304916}
confusion matrix:
       0    1
0  17430  719
1    398  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94503033, 'precision': 0.69849885, 'recall': 0.8375586, 'specificity': 0.8375586, 'f1': 0.74652994, 'auroc': 0.897441, 'binary_precision': 0.40958604, 'binary_recall': 0.7203065, 'binary_specificity': 0.95481074, 'binary_f1_score': 0.5222222}
confusion matrix:
      0    1
0  5726  271
1    73  188
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_29.png
early stop counter: 28
val acc:0.9405598044395447, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 29,now: 2024-06-24 06:47:23.562461,epoch time: 0:17:04.536111,used: 8:22:20.322582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9227209, 'precision': 0.8876761, 'recall': 0.926915, 'specificity': 0.926915, 'f1': 0.9041707, 'auroc': 0.97844565, 'binary_precision': 0.7991642, 'binary_recall': 0.9355803, 'binary_specificity': 0.91824967, 'binary_f1_score': 0.8620085}
confusion matrix:
       0      1
0  38864   3460
1    948  13768
---- Validation: 
scalar performance:
{'acc': 0.89596635, 'precision': 0.5759348, 'recall': 0.7173735, 'specificity': 0.7173735, 'f1': 0.6005022, 'auroc': 0.7594535, 'binary_precision': 0.17002012, 'binary_recall': 0.525661, 'binary_specificity': 0.9090859, 'binary_f1_score': 0.25693652}
confusion matrix:
       0     1
0  16499  1650
1    305   338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88271016, 'precision': 0.6124395, 'recall': 0.84352136, 'specificity': 0.84352136, 'f1': 0.6491287, 'auroc': 0.90379226, 'binary_precision': 0.2345679, 'binary_recall': 0.8007663, 'binary_specificity': 0.8862765, 'binary_f1_score': 0.3628472}
confusion matrix:
      0    1
0  5315  682
1    52  209
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_30.png
early stop counter: 29
val acc:0.8959663510322571, best validation acc: 0.9631226062774658, corresponding to test acc:                         0.9597315192222595 / 0.9600511193275452
after epoch: 30,now: 2024-06-24 07:04:24.268429,epoch time: 0:17:00.705968,used: 8:39:21.028550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:39:21.028550 at 2024-06-24 07:04:24.268429
persisted model performance metric: 

scalar performance:
{'acc': 0.9597315, 'precision': 0.86248434, 'recall': 0.5245707, 'specificity': 0.5245707, 'f1': 0.53646684, 'auroc': 0.6337987, 'binary_precision': 0.7647059, 'binary_recall': 0.049808428, 'binary_specificity': 0.999333, 'binary_f1_score': 0.09352518}
confusion matrix:
      0   1
0  5993   4
1   248  13
oracle model performance metric: 

scalar performance:
{'acc': 0.9600511, 'precision': 0.7534747, 'recall': 0.64933616, 'specificity': 0.64933616, 'f1': 0.68627477, 'auroc': 0.7633886, 'binary_precision': 0.53642386, 'binary_recall': 0.31034482, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.39320388}
confusion matrix:
      0   1
0  5927  70
1   180  81
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 571737 KiB | 583697 GiB | 583697 GiB |
|       from large pool | 167936 KiB | 499008 KiB | 582869 GiB | 582869 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    827 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 571737 KiB | 583697 GiB | 583697 GiB |
|       from large pool | 167936 KiB | 499008 KiB | 582869 GiB | 582869 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    827 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 563304 KiB | 577994 GiB | 577993 GiB |
|       from large pool | 165120 KiB | 491712 KiB | 577189 GiB | 577189 GiB |
|       from small pool |  35968 KiB |  74337 KiB |    804 GiB |    804 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 727040 KiB | 727040 KiB | 727040 KiB |      0 B   |
|       from large pool | 651264 KiB | 651264 KiB | 651264 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  79692 KiB | 209453 KiB | 393240 GiB | 393240 GiB |
|       from large pool |  67584 KiB | 208064 KiB | 392353 GiB | 392353 GiB |
|       from small pool |  12108 KiB |  13958 KiB |    886 GiB |    886 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    7899    |  116256 K  |  116253 K  |
|       from large pool |      36    |      76    |   39550 K  |   39550 K  |
|       from small pool |    3216    |    7861    |   76705 K  |   76702 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    7899    |  116256 K  |  116253 K  |
|       from large pool |      36    |      76    |   39550 K  |   39550 K  |
|       from small pool |    3216    |    7861    |   76705 K  |   76702 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      52    |      52    |      52    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    3580    |   52701 K  |   52701 K  |
|       from large pool |       7    |      10    |   15024 K  |   15024 K  |
|       from small pool |      46    |    3574    |   37677 K  |   37677 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB | 583697 GiB | 583697 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 582869 GiB | 582869 GiB |
|       from small pool |      0 KiB |  75475 KiB |    827 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB | 583697 GiB | 583697 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 582869 GiB | 582869 GiB |
|       from small pool |      0 KiB |  75475 KiB |    827 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 577994 GiB | 577993 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 577189 GiB | 577189 GiB |
|       from small pool |      0 KiB |  74337 KiB |    804 GiB |    804 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 727040 KiB | 727040 KiB | 442368 KiB |
|       from large pool | 235520 KiB | 651264 KiB | 651264 KiB | 415744 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB | 393240 GiB | 393240 GiB |
|       from large pool |  55040 KiB | 208064 KiB | 392353 GiB | 392353 GiB |
|       from small pool |      0 KiB |  19703 KiB |    886 GiB |    886 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7899    |  116256 K  |  116256 K  |
|       from large pool |       2    |      76    |   39550 K  |   39550 K  |
|       from small pool |       0    |    7861    |   76705 K  |   76705 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7899    |  116256 K  |  116256 K  |
|       from large pool |       2    |      76    |   39550 K  |   39550 K  |
|       from small pool |       0    |    7861    |   76705 K  |   76705 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      52    |      52    |      18    |
|       from large pool |      10    |      15    |      15    |       5    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3580    |   52703 K  |   52703 K  |
|       from large pool |       3    |      13    |   15024 K  |   15024 K  |
|       from small pool |       0    |    3574    |   37678 K  |   37678 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB | 583697 GiB | 583697 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 582869 GiB | 582869 GiB |
|       from small pool |      0 KiB |  75475 KiB |    827 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB | 583697 GiB | 583697 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 582869 GiB | 582869 GiB |
|       from small pool |      0 KiB |  75475 KiB |    827 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 577994 GiB | 577993 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 577189 GiB | 577189 GiB |
|       from small pool |      0 KiB |  74337 KiB |    804 GiB |    804 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 727040 KiB | 727040 KiB | 442368 KiB |
|       from large pool | 235520 KiB | 651264 KiB | 651264 KiB | 415744 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB | 393240 GiB | 393240 GiB |
|       from large pool |  55040 KiB | 208064 KiB | 392353 GiB | 392353 GiB |
|       from small pool |      0 KiB |  19703 KiB |    886 GiB |    886 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7899    |  116256 K  |  116256 K  |
|       from large pool |       2    |      76    |   39550 K  |   39550 K  |
|       from small pool |       0    |    7861    |   76705 K  |   76705 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7899    |  116256 K  |  116256 K  |
|       from large pool |       2    |      76    |   39550 K  |   39550 K  |
|       from small pool |       0    |    7861    |   76705 K  |   76705 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      52    |      52    |      18    |
|       from large pool |      10    |      15    |      15    |       5    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3580    |   52703 K  |   52703 K  |
|       from large pool |       3    |      13    |   15024 K  |   15024 K  |
|       from small pool |       0    |    3574    |   37678 K  |   37678 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887

 Experiment start at: 2024-06-24 07:11:08.817050
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.75418776, 'precision': 0.7728038, 'recall': 0.51923174, 'specificity': 0.51923174, 'f1': 0.46916646, 'auroc': 0.7837156, 'binary_precision': 0.7919376, 'binary_recall': 0.042235937, 'binary_specificity': 0.99622756, 'binary_f1_score': 0.08019489}
confusion matrix:
       0    1
0  42253  160
1  13810  609
---- Validation: 
scalar performance:
{'acc': 0.96003205, 'precision': 0.48840576, 'recall': 0.498612, 'specificity': 0.498612, 'f1': 0.49113527, 'auroc': 0.37624717, 'binary_precision': 0.012820513, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.0026631157}
confusion matrix:
       0   1
0  17990  77
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.47901872, 'recall': 0.4991591, 'specificity': 0.4991591, 'f1': 0.4888816, 'auroc': 0.34893334, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5936  10
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-24 07:28:23.218925,epoch time: 0:17:14.401875,used: 0:17:14.401875,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.84271187, 'precision': 0.87328225, 'recall': 0.70323026, 'specificity': 0.70323026, 'f1': 0.73944145, 'auroc': 0.89943254, 'binary_precision': 0.91316146, 'binary_recall': 0.42004162, 'binary_specificity': 0.98641896, 'binary_f1_score': 0.57540494}
confusion matrix:
       0     1
0  41836   576
1   8363  6057
---- Validation: 
scalar performance:
{'acc': 0.94322306, 'precision': 0.48551524, 'recall': 0.49132496, 'specificity': 0.49132496, 'f1': 0.48819235, 'auroc': 0.45741117, 'binary_precision': 0.007556675, 'binary_recall': 0.004457652, 'binary_specificity': 0.97819227, 'binary_f1_score': 0.005607476}
confusion matrix:
       0    1
0  17673  394
1    670    3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9500483, 'precision': 0.513663, 'recall': 0.5031515, 'specificity': 0.5031515, 'f1': 0.49976233, 'auroc': 0.58873904, 'binary_precision': 0.06896552, 'binary_recall': 0.015384615, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.025157234}
confusion matrix:
      0   1
0  5892  54
1   256   4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_2.png
early stop counter: 1
val acc:0.9432230591773987, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 2,now: 2024-06-24 07:45:13.365095,epoch time: 0:16:50.146170,used: 0:34:04.548045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8814048, 'precision': 0.8956574, 'recall': 0.7838354, 'specificity': 0.7838354, 'f1': 0.81996566, 'auroc': 0.9304669, 'binary_precision': 0.91674805, 'binary_recall': 0.58575493, 'binary_specificity': 0.98191595, 'binary_f1_score': 0.71479356}
confusion matrix:
       0     1
0  41646   767
1   5973  8446
---- Validation: 
scalar performance:
{'acc': 0.94295627, 'precision': 0.49624532, 'recall': 0.497624, 'specificity': 0.497624, 'f1': 0.49628967, 'auroc': 0.5566284, 'binary_precision': 0.028571429, 'binary_recall': 0.017830608, 'binary_specificity': 0.9774174, 'binary_f1_score': 0.021957913}
confusion matrix:
       0    1
0  17659  408
1    661   12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.948437, 'precision': 0.61228466, 'recall': 0.5556412, 'specificity': 0.5556412, 'f1': 0.5721877, 'auroc': 0.70311785, 'binary_precision': 0.26190478, 'binary_recall': 0.12692308, 'binary_specificity': 0.9843592, 'binary_f1_score': 0.17098448}
confusion matrix:
      0   1
0  5853  93
1   227  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_3.png
early stop counter: 2
val acc:0.942956268787384, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 3,now: 2024-06-24 08:02:05.545495,epoch time: 0:16:52.180400,used: 0:50:56.728445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.89078337, 'precision': 0.9071504, 'recall': 0.79960406, 'specificity': 0.79960406, 'f1': 0.8357086, 'auroc': 0.9417347, 'binary_precision': 0.93174887, 'binary_recall': 0.61450964, 'binary_specificity': 0.9846985, 'binary_f1_score': 0.740586}
confusion matrix:
       0     1
0  41765   649
1   5558  8860
---- Validation: 
scalar performance:
{'acc': 0.947492, 'precision': 0.49417454, 'recall': 0.49711528, 'specificity': 0.49711528, 'f1': 0.49451312, 'auroc': 0.5994123, 'binary_precision': 0.024464833, 'binary_recall': 0.011887073, 'binary_specificity': 0.9823435, 'binary_f1_score': 0.016}
confusion matrix:
       0    1
0  17748  319
1    665    8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95520467, 'precision': 0.6966922, 'recall': 0.5959527, 'specificity': 0.5959527, 'f1': 0.6264645, 'auroc': 0.74120116, 'binary_precision': 0.42741936, 'binary_recall': 0.20384616, 'binary_specificity': 0.9880592, 'binary_f1_score': 0.2760417}
confusion matrix:
      0   1
0  5875  71
1   207  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_4.png
early stop counter: 3
val acc:0.9474920034408569, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 4,now: 2024-06-24 08:19:00.024242,epoch time: 0:16:54.478747,used: 1:07:51.207192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9016047, 'precision': 0.90905166, 'recall': 0.82508594, 'specificity': 0.82508594, 'f1': 0.8562365, 'auroc': 0.9494273, 'binary_precision': 0.9208544, 'binary_recall': 0.66974133, 'binary_specificity': 0.98043054, 'binary_f1_score': 0.7754758}
confusion matrix:
       0     1
0  41583   830
1   4762  9657
---- Validation: 
scalar performance:
{'acc': 0.9402881, 'precision': 0.52064604, 'recall': 0.5162677, 'specificity': 0.5162677, 'f1': 0.5179398, 'auroc': 0.65061903, 'binary_precision': 0.076045625, 'binary_recall': 0.059435364, 'binary_specificity': 0.9731001, 'binary_f1_score': 0.06672227}
confusion matrix:
       0    1
0  17581  486
1    633   40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94585884, 'precision': 0.6608319, 'recall': 0.65727895, 'specificity': 0.65727895, 'f1': 0.65903175, 'auroc': 0.78505325, 'binary_precision': 0.3503937, 'binary_recall': 0.3423077, 'binary_specificity': 0.9722502, 'binary_f1_score': 0.34630352}
confusion matrix:
      0    1
0  5781  165
1   171   89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_5.png
early stop counter: 4
val acc:0.9402881264686584, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 5,now: 2024-06-24 08:36:03.900539,epoch time: 0:17:03.876297,used: 1:24:55.083489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.911124, 'precision': 0.9030682, 'recall': 0.85539556, 'specificity': 0.85539556, 'f1': 0.87557685, 'auroc': 0.9518194, 'binary_precision': 0.88909197, 'binary_recall': 0.7422666, 'binary_specificity': 0.9685245, 'binary_f1_score': 0.809072}
confusion matrix:
       0      1
0  41079   1335
1   3716  10702
---- Validation: 
scalar performance:
{'acc': 0.9263074, 'precision': 0.5269856, 'recall': 0.5340513, 'specificity': 0.5340513, 'f1': 0.5297798, 'auroc': 0.6711314, 'binary_precision': 0.08741259, 'binary_recall': 0.11144131, 'binary_specificity': 0.95666134, 'binary_f1_score': 0.09797518}
confusion matrix:
       0    1
0  17284  783
1    598   75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93699646, 'precision': 0.64569706, 'recall': 0.6967897, 'specificity': 0.6967897, 'f1': 0.6665695, 'auroc': 0.7991985, 'binary_precision': 0.31652662, 'binary_recall': 0.43461537, 'binary_specificity': 0.958964, 'binary_f1_score': 0.36628848}
confusion matrix:
      0    1
0  5702  244
1   147  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_6.png
early stop counter: 5
val acc:0.9263073801994324, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 6,now: 2024-06-24 08:52:59.250425,epoch time: 0:16:55.349886,used: 1:41:50.433375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.923353, 'precision': 0.9075885, 'recall': 0.8861356, 'specificity': 0.8861356, 'f1': 0.89611185, 'auroc': 0.96656525, 'binary_precision': 0.8779297, 'binary_recall': 0.810584, 'binary_specificity': 0.9616872, 'binary_f1_score': 0.8429138}
confusion matrix:
       0      1
0  40789   1625
1   2731  11687
---- Validation: 
scalar performance:
{'acc': 0.9093383, 'precision': 0.54653525, 'recall': 0.5903401, 'specificity': 0.5903401, 'f1': 0.5577691, 'auroc': 0.72041106, 'binary_precision': 0.122238584, 'binary_recall': 0.24665676, 'binary_specificity': 0.9340234, 'binary_f1_score': 0.16346626}
confusion matrix:
       0     1
0  16875  1192
1    507   166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93055105, 'precision': 0.64528674, 'recall': 0.74491775, 'specificity': 0.74491775, 'f1': 0.6793356, 'auroc': 0.80889416, 'binary_precision': 0.3112583, 'binary_recall': 0.5423077, 'binary_specificity': 0.94752777, 'binary_f1_score': 0.39551196}
confusion matrix:
      0    1
0  5634  312
1   119  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_7.png
early stop counter: 6
val acc:0.9093382954597473, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 7,now: 2024-06-24 09:09:58.782820,epoch time: 0:16:59.532395,used: 1:58:49.965770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9223149, 'precision': 0.9250678, 'recall': 0.8656339, 'specificity': 0.8656339, 'f1': 0.89009595, 'auroc': 0.96297944, 'binary_precision': 0.92973113, 'binary_recall': 0.7505548, 'binary_specificity': 0.980713, 'binary_f1_score': 0.8305898}
confusion matrix:
       0      1
0  41594    818
1   3597  10823
---- Validation: 
scalar performance:
{'acc': 0.9386339, 'precision': 0.5482402, 'recall': 0.5461663, 'specificity': 0.5461663, 'f1': 0.54717016, 'auroc': 0.6778414, 'binary_precision': 0.12908243, 'binary_recall': 0.12332838, 'binary_specificity': 0.9690043, 'binary_f1_score': 0.12613982}
confusion matrix:
       0    1
0  17507  560
1    590   83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9477925, 'precision': 0.68799186, 'recall': 0.7263306, 'specificity': 0.7263306, 'f1': 0.705063, 'auroc': 0.8151802, 'binary_precision': 0.39873418, 'binary_recall': 0.4846154, 'binary_specificity': 0.9680458, 'binary_f1_score': 0.4375}
confusion matrix:
      0    1
0  5756  190
1   134  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_8.png
early stop counter: 7
val acc:0.938633918762207, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 8,now: 2024-06-24 09:27:09.565716,epoch time: 0:17:10.782896,used: 2:16:00.748666,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9175816, 'precision': 0.89859986, 'recall': 0.8797802, 'specificity': 0.8797802, 'f1': 0.88859344, 'auroc': 0.9627638, 'binary_precision': 0.8626239, 'binary_recall': 0.80303764, 'binary_specificity': 0.95652276, 'binary_f1_score': 0.83176494}
confusion matrix:
       0      1
0  40569   1844
1   2840  11579
---- Validation: 
scalar performance:
{'acc': 0.9123266, 'precision': 0.5488973, 'recall': 0.59117454, 'specificity': 0.59117454, 'f1': 0.5604927, 'auroc': 0.71255857, 'binary_precision': 0.12692308, 'binary_recall': 0.24517088, 'binary_specificity': 0.93717825, 'binary_f1_score': 0.16725798}
confusion matrix:
       0     1
0  16932  1135
1    508   165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9250725, 'precision': 0.647148, 'recall': 0.79171133, 'specificity': 0.79171133, 'f1': 0.6897137, 'auroc': 0.85900927, 'binary_precision': 0.31053606, 'binary_recall': 0.64615387, 'binary_specificity': 0.93726873, 'binary_f1_score': 0.41947564}
confusion matrix:
      0    1
0  5573  373
1    92  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_9.png
early stop counter: 8
val acc:0.9123265743255615, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 9,now: 2024-06-24 09:44:56.195118,epoch time: 0:17:46.629402,used: 2:33:47.378068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.92914206, 'precision': 0.9107197, 'recall': 0.9001187, 'specificity': 0.9001187, 'f1': 0.90523523, 'auroc': 0.96515095, 'binary_precision': 0.8747386, 'binary_recall': 0.8411928, 'binary_specificity': 0.95904464, 'binary_f1_score': 0.8576377}
confusion matrix:
       0      1
0  40675   1737
1   2290  12130
---- Validation: 
scalar performance:
{'acc': 0.9167556, 'precision': 0.5568258, 'recall': 0.6013395, 'specificity': 0.6013395, 'f1': 0.57012033, 'auroc': 0.7080937, 'binary_precision': 0.14205004, 'binary_recall': 0.2615156, 'binary_specificity': 0.9411634, 'binary_f1_score': 0.1841004}
confusion matrix:
       0     1
0  17004  1063
1    497   176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9233, 'precision': 0.640895, 'recall': 0.7779134, 'specificity': 0.7779134, 'f1': 0.68126184, 'auroc': 0.8363722, 'binary_precision': 0.2992565, 'binary_recall': 0.61923075, 'binary_specificity': 0.93659604, 'binary_f1_score': 0.40350875}
confusion matrix:
      0    1
0  5569  377
1    99  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_10.png
early stop counter: 9
val acc:0.9167556166648865, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 10,now: 2024-06-24 10:04:12.646388,epoch time: 0:19:16.451270,used: 2:53:03.829338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9284382, 'precision': 0.91247135, 'recall': 0.8955965, 'specificity': 0.8955965, 'f1': 0.90357435, 'auroc': 0.9648974, 'binary_precision': 0.88194495, 'binary_recall': 0.82891816, 'binary_specificity': 0.96227485, 'binary_f1_score': 0.85460985}
confusion matrix:
       0      1
0  40812   1600
1   2467  11953
---- Validation: 
scalar performance:
{'acc': 0.91814303, 'precision': 0.5561091, 'recall': 0.5970522, 'specificity': 0.5970522, 'f1': 0.5687377, 'auroc': 0.70506513, 'binary_precision': 0.1409508, 'binary_recall': 0.2511144, 'binary_specificity': 0.94299, 'binary_f1_score': 0.18055557}
confusion matrix:
       0     1
0  17037  1030
1    504   169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92942315, 'precision': 0.6523249, 'recall': 0.78110886, 'specificity': 0.78110886, 'f1': 0.69304705, 'auroc': 0.8520919, 'binary_precision': 0.322, 'binary_recall': 0.61923075, 'binary_specificity': 0.9429869, 'binary_f1_score': 0.4236842}
confusion matrix:
      0    1
0  5607  339
1    99  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_11.png
early stop counter: 10
val acc:0.9181430339813232, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 11,now: 2024-06-24 10:24:39.483135,epoch time: 0:20:26.836747,used: 3:13:30.666085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9300218, 'precision': 0.9099653, 'recall': 0.9040265, 'specificity': 0.9040265, 'f1': 0.9069376, 'auroc': 0.9711112, 'binary_precision': 0.87013537, 'binary_recall': 0.85124826, 'binary_specificity': 0.9568047, 'binary_f1_score': 0.8605882}
confusion matrix:
       0      1
0  40580   1832
1   2145  12275
---- Validation: 
scalar performance:
{'acc': 0.91302025, 'precision': 0.5623591, 'recall': 0.62229085, 'specificity': 0.62229085, 'f1': 0.57866126, 'auroc': 0.73624873, 'binary_precision': 0.15149309, 'binary_recall': 0.30906388, 'binary_specificity': 0.9355178, 'binary_f1_score': 0.20332356}
confusion matrix:
       0     1
0  16902  1165
1    465   208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92152756, 'precision': 0.641049, 'recall': 0.7898613, 'specificity': 0.7898613, 'f1': 0.68311995, 'auroc': 0.8531896, 'binary_precision': 0.29840142, 'binary_recall': 0.64615387, 'binary_specificity': 0.9335688, 'binary_f1_score': 0.40826246}
confusion matrix:
      0    1
0  5551  395
1    92  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_12.png
early stop counter: 11
val acc:0.9130202531814575, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 12,now: 2024-06-24 10:46:19.692866,epoch time: 0:21:40.209731,used: 3:35:10.875816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92495424, 'precision': 0.89734745, 'recall': 0.9072794, 'specificity': 0.9072794, 'f1': 0.9021392, 'auroc': 0.9681573, 'binary_precision': 0.8389876, 'binary_recall': 0.87140185, 'binary_specificity': 0.9431569, 'binary_f1_score': 0.8548876}
confusion matrix:
       0      1
0  40004   2411
1   1854  12563
---- Validation: 
scalar performance:
{'acc': 0.9087513, 'precision': 0.5672891, 'recall': 0.6451112, 'specificity': 0.6451112, 'f1': 0.5864238, 'auroc': 0.74248743, 'binary_precision': 0.15955351, 'binary_recall': 0.36106983, 'binary_specificity': 0.9291526, 'binary_f1_score': 0.22131148}
confusion matrix:
       0     1
0  16787  1280
1    430   243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91782147, 'precision': 0.6412342, 'recall': 0.813673, 'specificity': 0.813673, 'f1': 0.68613714, 'auroc': 0.87193453, 'binary_precision': 0.29641694, 'binary_recall': 0.7, 'binary_specificity': 0.9273461, 'binary_f1_score': 0.41647598}
confusion matrix:
      0    1
0  5514  432
1    78  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_13.png
early stop counter: 12
val acc:0.9087513089179993, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 13,now: 2024-06-24 11:05:53.126089,epoch time: 0:19:33.433223,used: 3:54:44.309039,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9392068, 'precision': 0.92490315, 'recall': 0.9127206, 'specificity': 0.9127206, 'f1': 0.9185802, 'auroc': 0.97401726, 'binary_precision': 0.8970812, 'binary_recall': 0.8589459, 'binary_specificity': 0.96649534, 'binary_f1_score': 0.8775995}
confusion matrix:
       0      1
0  40991   1421
1   2034  12386
---- Validation: 
scalar performance:
{'acc': 0.93148345, 'precision': 0.58750486, 'recall': 0.63043576, 'specificity': 0.63043576, 'f1': 0.60352135, 'auroc': 0.7650442, 'binary_precision': 0.20136853, 'binary_recall': 0.3060921, 'binary_specificity': 0.95477945, 'binary_f1_score': 0.24292451}
confusion matrix:
       0    1
0  17250  817
1    467  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9397357, 'precision': 0.6760542, 'recall': 0.78649056, 'specificity': 0.78649056, 'f1': 0.71536076, 'auroc': 0.86151385, 'binary_precision': 0.36926606, 'binary_recall': 0.61923075, 'binary_specificity': 0.95375043, 'binary_f1_score': 0.46264368}
confusion matrix:
      0    1
0  5671  275
1    99  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_14.png
early stop counter: 13
val acc:0.9314834475517273, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 14,now: 2024-06-24 11:30:35.504789,epoch time: 0:24:42.378700,used: 4:19:26.687739,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.93570524, 'precision': 0.91567665, 'recall': 0.91426504, 'specificity': 0.91426504, 'f1': 0.9149676, 'auroc': 0.9731566, 'binary_precision': 0.87522656, 'binary_recall': 0.8707351, 'binary_specificity': 0.95779496, 'binary_f1_score': 0.87297505}
confusion matrix:
       0      1
0  40622   1790
1   1864  12556
---- Validation: 
scalar performance:
{'acc': 0.9230523, 'precision': 0.5814845, 'recall': 0.6446601, 'specificity': 0.6446601, 'f1': 0.60145324, 'auroc': 0.7537854, 'binary_precision': 0.18815896, 'binary_recall': 0.3447251, 'binary_specificity': 0.9445951, 'binary_f1_score': 0.24344176}
confusion matrix:
       0     1
0  17066  1001
1    441   232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9329681, 'precision': 0.6658573, 'recall': 0.81054366, 'specificity': 0.81054366, 'f1': 0.7113034, 'auroc': 0.8751999, 'binary_precision': 0.3464567, 'binary_recall': 0.6769231, 'binary_specificity': 0.94416416, 'binary_f1_score': 0.45833334}
confusion matrix:
      0    1
0  5614  332
1    84  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_15.png
early stop counter: 14
val acc:0.9230523109436035, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 15,now: 2024-06-24 11:56:43.521538,epoch time: 0:26:08.016749,used: 4:45:34.704488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9360923, 'precision': 0.913016, 'recall': 0.9197354, 'specificity': 0.9197354, 'f1': 0.9163004, 'auroc': 0.97565997, 'binary_precision': 0.8649344, 'binary_recall': 0.8865307, 'binary_specificity': 0.95294005, 'binary_f1_score': 0.8755994}
confusion matrix:
       0      1
0  40418   1996
1   1636  12782
---- Validation: 
scalar performance:
{'acc': 0.9185165, 'precision': 0.581447, 'recall': 0.6587589, 'specificity': 0.6587589, 'f1': 0.60364246, 'auroc': 0.76165867, 'binary_precision': 0.18695015, 'binary_recall': 0.37890044, 'binary_specificity': 0.93861735, 'binary_f1_score': 0.25036818}
confusion matrix:
       0     1
0  16958  1109
1    418   255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93055105, 'precision': 0.6604704, 'recall': 0.80744326, 'specificity': 0.80744326, 'f1': 0.70554364, 'auroc': 0.8761286, 'binary_precision': 0.33589253, 'binary_recall': 0.6730769, 'binary_specificity': 0.9418096, 'binary_f1_score': 0.44814342}
confusion matrix:
      0    1
0  5600  346
1    85  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_16.png
early stop counter: 15
val acc:0.9185165166854858, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9564937353134155
after epoch: 16,now: 2024-06-24 12:18:44.316664,epoch time: 0:22:00.795126,used: 5:07:35.499614,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.94547087, 'precision': 0.933683, 'recall': 0.9206665, 'specificity': 0.9206665, 'f1': 0.92691755, 'auroc': 0.97876734, 'binary_precision': 0.9107998, 'binary_recall': 0.87031, 'binary_specificity': 0.971023, 'binary_f1_score': 0.8900947}
confusion matrix:
       0      1
0  41184   1229
1   1870  12549
---- Validation: 
scalar performance:
{'acc': 0.93959445, 'precision': 0.600441, 'recall': 0.6246286, 'specificity': 0.6246286, 'f1': 0.61091113, 'auroc': 0.7739227, 'binary_precision': 0.227758, 'binary_recall': 0.28528973, 'binary_specificity': 0.96396744, 'binary_f1_score': 0.25329813}
confusion matrix:
       0    1
0  17416  651
1    481  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.7349, 'recall': 0.7971591, 'specificity': 0.7971591, 'f1': 0.7618072, 'auroc': 0.86718667, 'binary_precision': 0.4864865, 'binary_recall': 0.6230769, 'binary_specificity': 0.9712412, 'binary_f1_score': 0.5463744}
confusion matrix:
      0    1
0  5775  171
1    98  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_17.png
new oracle model saved
early stop counter: 16
val acc:0.9395944476127625, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9566548466682434
after epoch: 17,now: 2024-06-24 12:38:13.878221,epoch time: 0:19:29.561557,used: 5:27:05.061171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.94253236, 'precision': 0.928797, 'recall': 0.9178696, 'specificity': 0.9178696, 'f1': 0.9231489, 'auroc': 0.9759475, 'binary_precision': 0.9019608, 'binary_recall': 0.8678041, 'binary_specificity': 0.96793514, 'binary_f1_score': 0.88455284}
confusion matrix:
       0      1
0  41054   1360
1   1906  12512
---- Validation: 
scalar performance:
{'acc': 0.92604053, 'precision': 0.5798303, 'recall': 0.6311893, 'specificity': 0.6311893, 'f1': 0.59727657, 'auroc': 0.74881077, 'binary_precision': 0.18590309, 'binary_recall': 0.31352153, 'binary_specificity': 0.948857, 'binary_f1_score': 0.23340708}
confusion matrix:
       0    1
0  17143  924
1    462  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9363519, 'precision': 0.6722354, 'recall': 0.8067925, 'specificity': 0.8067925, 'f1': 0.716546, 'auroc': 0.875522, 'binary_precision': 0.35966736, 'binary_recall': 0.6653846, 'binary_specificity': 0.94820046, 'binary_f1_score': 0.46693656}
confusion matrix:
      0    1
0  5638  308
1    87  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_18.png
early stop counter: 17
val acc:0.926040530204773, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9566548466682434
after epoch: 18,now: 2024-06-24 12:56:43.121101,epoch time: 0:18:29.242880,used: 5:45:34.304051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.94680816, 'precision': 0.93225825, 'recall': 0.9264412, 'specificity': 0.9264412, 'f1': 0.92929757, 'auroc': 0.9788232, 'binary_precision': 0.9033194, 'binary_recall': 0.8850902, 'binary_specificity': 0.96779215, 'binary_f1_score': 0.8941119}
confusion matrix:
       0      1
0  41046   1366
1   1657  12763
---- Validation: 
scalar performance:
{'acc': 0.93287086, 'precision': 0.60673326, 'recall': 0.67192554, 'specificity': 0.67192554, 'f1': 0.6298005, 'auroc': 0.77457076, 'binary_precision': 0.23672368, 'binary_recall': 0.3907875, 'binary_specificity': 0.9530636, 'binary_f1_score': 0.29484305}
confusion matrix:
       0    1
0  17219  848
1    410  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9371576, 'precision': 0.6737584, 'recall': 0.805374, 'specificity': 0.805374, 'f1': 0.7176343, 'auroc': 0.87347406, 'binary_precision': 0.3628692, 'binary_recall': 0.6615385, 'binary_specificity': 0.9492096, 'binary_f1_score': 0.46866488}
confusion matrix:
      0    1
0  5644  302
1    88  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_19.png
early stop counter: 18
val acc:0.9328708648681641, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9566548466682434
after epoch: 19,now: 2024-06-24 13:15:19.161365,epoch time: 0:18:36.040264,used: 6:04:10.344315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9467905, 'precision': 0.93374825, 'recall': 0.924507, 'specificity': 0.924507, 'f1': 0.9289974, 'auroc': 0.978164, 'binary_precision': 0.9081077, 'binary_recall': 0.8792649, 'binary_specificity': 0.96974915, 'binary_f1_score': 0.8934536}
confusion matrix:
       0      1
0  41129   1283
1   1741  12679
---- Validation: 
scalar performance:
{'acc': 0.9407684, 'precision': 0.62342834, 'recall': 0.6717298, 'specificity': 0.6717298, 'f1': 0.6427727, 'auroc': 0.7772566, 'binary_precision': 0.27024186, 'binary_recall': 0.3818722, 'binary_specificity': 0.9615874, 'binary_f1_score': 0.31650248}
confusion matrix:
       0    1
0  17373  694
1    416  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9429584, 'precision': 0.69001776, 'recall': 0.8157572, 'specificity': 0.8157572, 'f1': 0.7341714, 'auroc': 0.8894292, 'binary_precision': 0.39461884, 'binary_recall': 0.6769231, 'binary_specificity': 0.95459133, 'binary_f1_score': 0.4985836}
confusion matrix:
      0    1
0  5676  270
1    84  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_20.png
early stop counter: 19
val acc:0.9407684206962585, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9566548466682434
after epoch: 20,now: 2024-06-24 13:34:33.146302,epoch time: 0:19:13.984937,used: 6:23:24.329252,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.94142383, 'precision': 0.91975796, 'recall': 0.9270903, 'specificity': 0.9270903, 'f1': 0.9233364, 'auroc': 0.9783406, 'binary_precision': 0.8745188, 'binary_recall': 0.8979889, 'binary_specificity': 0.95619166, 'binary_f1_score': 0.8860985}
confusion matrix:
       0      1
0  40554   1858
1   1471  12949
---- Validation: 
scalar performance:
{'acc': 0.92849517, 'precision': 0.595619, 'recall': 0.6617883, 'specificity': 0.6617883, 'f1': 0.61785823, 'auroc': 0.76712227, 'binary_precision': 0.21520068, 'binary_recall': 0.3744428, 'binary_specificity': 0.94913375, 'binary_f1_score': 0.27331886}
confusion matrix:
       0    1
0  17148  919
1    421  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93409604, 'precision': 0.6694221, 'recall': 0.8166492, 'specificity': 0.8166492, 'f1': 0.71581566, 'auroc': 0.87237895, 'binary_precision': 0.3530572, 'binary_recall': 0.68846154, 'binary_specificity': 0.94483685, 'binary_f1_score': 0.46675363}
confusion matrix:
      0    1
0  5618  328
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_21.png
early stop counter: 20
val acc:0.9284951686859131, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9566548466682434
after epoch: 21,now: 2024-06-24 13:53:28.310550,epoch time: 0:18:55.164248,used: 6:42:19.493500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.94253236, 'precision': 0.9241471, 'recall': 0.9240694, 'specificity': 0.9240694, 'f1': 0.92410827, 'auroc': 0.97790027, 'binary_precision': 0.88683826, 'binary_recall': 0.8865922, 'binary_specificity': 0.9615466, 'binary_f1_score': 0.88671523}
confusion matrix:
       0      1
0  40784   1631
1   1635  12782
---- Validation: 
scalar performance:
{'acc': 0.92716116, 'precision': 0.59144974, 'recall': 0.65608954, 'specificity': 0.65608954, 'f1': 0.61291754, 'auroc': 0.76857007, 'binary_precision': 0.20727581, 'binary_recall': 0.3640416, 'binary_specificity': 0.94813746, 'binary_f1_score': 0.26415092}
confusion matrix:
       0    1
0  17130  937
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9363519, 'precision': 0.67481416, 'recall': 0.81966543, 'specificity': 0.81966543, 'f1': 0.72146803, 'auroc': 0.892985, 'binary_precision': 0.36363637, 'binary_recall': 0.6923077, 'binary_specificity': 0.9470232, 'binary_f1_score': 0.4768212}
confusion matrix:
      0    1
0  5631  315
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_22.png
early stop counter: 21
val acc:0.9271611571311951, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9566548466682434
after epoch: 22,now: 2024-06-24 14:12:57.450648,epoch time: 0:19:29.140098,used: 7:01:48.633598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9511367, 'precision': 0.94267344, 'recall': 0.9267055, 'specificity': 0.9267055, 'f1': 0.934314, 'auroc': 0.9811145, 'binary_precision': 0.9263844, 'binary_recall': 0.8771066, 'binary_specificity': 0.9763044, 'binary_f1_score': 0.90107226}
confusion matrix:
       0      1
0  41408   1005
1   1772  12647
---- Validation: 
scalar performance:
{'acc': 0.9334045, 'precision': 0.60485584, 'recall': 0.66433436, 'specificity': 0.66433436, 'f1': 0.6263703, 'auroc': 0.7611798, 'binary_precision': 0.23354958, 'binary_recall': 0.3744428, 'binary_specificity': 0.95422596, 'binary_f1_score': 0.28767124}
confusion matrix:
       0    1
0  17240  827
1    421  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9502095, 'precision': 0.71245146, 'recall': 0.82138026, 'specificity': 0.82138026, 'f1': 0.7538183, 'auroc': 0.87182915, 'binary_precision': 0.43920594, 'binary_recall': 0.6807692, 'binary_specificity': 0.96199125, 'binary_f1_score': 0.5339367}
confusion matrix:
      0    1
0  5720  226
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_23.png
early stop counter: 22
val acc:0.9334045052528381, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9566548466682434
after epoch: 23,now: 2024-06-24 14:32:26.165557,epoch time: 0:19:28.714909,used: 7:21:17.348507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.94254994, 'precision': 0.9263708, 'recall': 0.9210708, 'specificity': 0.9210708, 'f1': 0.9236767, 'auroc': 0.9768832, 'binary_precision': 0.89414173, 'binary_recall': 0.87746185, 'binary_specificity': 0.96467984, 'binary_f1_score': 0.8857233}
confusion matrix:
       0      1
0  40914   1498
1   1767  12653
---- Validation: 
scalar performance:
{'acc': 0.9345784, 'precision': 0.60365325, 'recall': 0.6556447, 'specificity': 0.6556447, 'f1': 0.6231238, 'auroc': 0.75582755, 'binary_precision': 0.23181377, 'binary_recall': 0.3551263, 'binary_specificity': 0.95616317, 'binary_f1_score': 0.28051642}
confusion matrix:
       0    1
0  17275  792
1    434  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9442475, 'precision': 0.6942443, 'recall': 0.8201079, 'specificity': 0.8201079, 'f1': 0.73878753, 'auroc': 0.8760588, 'binary_precision': 0.40271494, 'binary_recall': 0.6846154, 'binary_specificity': 0.9556004, 'binary_f1_score': 0.50712246}
confusion matrix:
      0    1
0  5682  264
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_24.png
early stop counter: 23
val acc:0.9345784187316895, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9566548466682434
after epoch: 24,now: 2024-06-24 14:53:58.269465,epoch time: 0:21:32.103908,used: 7:42:49.452415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9493771, 'precision': 0.93572974, 'recall': 0.9297837, 'specificity': 0.9297837, 'f1': 0.9327029, 'auroc': 0.98052585, 'binary_precision': 0.9085953, 'binary_recall': 0.89000624, 'binary_specificity': 0.9695612, 'binary_f1_score': 0.8992047}
confusion matrix:
       0      1
0  41122   1291
1   1586  12833
---- Validation: 
scalar performance:
{'acc': 0.9364995, 'precision': 0.6046402, 'recall': 0.6487731, 'specificity': 0.6487731, 'f1': 0.6219133, 'auroc': 0.7633982, 'binary_precision': 0.23432682, 'binary_recall': 0.33878157, 'binary_specificity': 0.9587646, 'binary_f1_score': 0.27703524}
confusion matrix:
       0    1
0  17322  745
1    445  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94166934, 'precision': 0.6861979, 'recall': 0.81324553, 'specificity': 0.81324553, 'f1': 0.73031646, 'auroc': 0.88176596, 'binary_precision': 0.38716814, 'binary_recall': 0.6730769, 'binary_specificity': 0.9534141, 'binary_f1_score': 0.49157307}
confusion matrix:
      0    1
0  5669  277
1    85  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_25.png
early stop counter: 24
val acc:0.9364994764328003, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9566548466682434
after epoch: 25,now: 2024-06-24 15:16:25.894158,epoch time: 0:22:27.624693,used: 8:05:17.077108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9486909, 'precision': 0.9306882, 'recall': 0.93444794, 'specificity': 0.93444794, 'f1': 0.9325459, 'auroc': 0.98143065, 'binary_precision': 0.8936345, 'binary_recall': 0.90553474, 'binary_specificity': 0.96336114, 'binary_f1_score': 0.89954525}
confusion matrix:
       0      1
0  40860   1554
1   1362  13056
---- Validation: 
scalar performance:
{'acc': 0.9314301, 'precision': 0.6049541, 'recall': 0.6740394, 'specificity': 0.6740394, 'f1': 0.628767, 'auroc': 0.7851093, 'binary_precision': 0.23298429, 'binary_recall': 0.39673105, 'binary_specificity': 0.95134777, 'binary_f1_score': 0.2935679}
confusion matrix:
       0    1
0  17188  879
1    406  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9357074, 'precision': 0.6722491, 'recall': 0.81381214, 'specificity': 0.81381214, 'f1': 0.71794844, 'auroc': 0.8739547, 'binary_precision': 0.35902637, 'binary_recall': 0.6807692, 'binary_specificity': 0.946855, 'binary_f1_score': 0.47011948}
confusion matrix:
      0    1
0  5630  316
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_26.png
early stop counter: 25
val acc:0.9314301013946533, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9566548466682434
after epoch: 26,now: 2024-06-24 15:41:13.064122,epoch time: 0:24:47.169964,used: 8:30:04.247072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9460691, 'precision': 0.9225091, 'recall': 0.93864715, 'specificity': 0.93864715, 'f1': 0.93015033, 'auroc': 0.98163414, 'binary_precision': 0.87153983, 'binary_recall': 0.9235784, 'binary_specificity': 0.9537159, 'binary_f1_score': 0.8968048}
confusion matrix:
       0      1
0  40449   1963
1   1102  13318
---- Validation: 
scalar performance:
{'acc': 0.9173426, 'precision': 0.5999821, 'recall': 0.7203783, 'specificity': 0.7203783, 'f1': 0.6311837, 'auroc': 0.7883128, 'binary_precision': 0.21923077, 'binary_recall': 0.50817233, 'binary_specificity': 0.9325843, 'binary_f1_score': 0.30631438}
confusion matrix:
       0     1
0  16849  1218
1    331   342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9173381, 'precision': 0.6453961, 'recall': 0.8354886, 'specificity': 0.8354886, 'f1': 0.6930333, 'auroc': 0.89731944, 'binary_precision': 0.30265212, 'binary_recall': 0.74615383, 'binary_specificity': 0.9248234, 'binary_f1_score': 0.43063265}
confusion matrix:
      0    1
0  5499  447
1    66  194
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_27.png
early stop counter: 26
val acc:0.9173426032066345, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9566548466682434
after epoch: 27,now: 2024-06-24 16:05:17.561871,epoch time: 0:24:04.497749,used: 8:54:08.744821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9460163, 'precision': 0.92454165, 'recall': 0.93501884, 'specificity': 0.93501884, 'f1': 0.92960286, 'auroc': 0.980362, 'binary_precision': 0.8791583, 'binary_recall': 0.9126907, 'binary_specificity': 0.957347, 'binary_f1_score': 0.89561075}
confusion matrix:
       0      1
0  40603   1809
1   1259  13161
---- Validation: 
scalar performance:
{'acc': 0.92689437, 'precision': 0.6097512, 'recall': 0.7103115, 'specificity': 0.7103115, 'f1': 0.6402296, 'auroc': 0.77948576, 'binary_precision': 0.23973115, 'binary_recall': 0.4769688, 'binary_specificity': 0.9436542, 'binary_f1_score': 0.31908548}
confusion matrix:
       0     1
0  17049  1018
1    352   321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9239446, 'precision': 0.6526653, 'recall': 0.8242244, 'specificity': 0.8242244, 'f1': 0.69997805, 'auroc': 0.887428, 'binary_precision': 0.31849316, 'binary_recall': 0.7153846, 'binary_specificity': 0.9330642, 'binary_f1_score': 0.44075832}
confusion matrix:
      0    1
0  5548  398
1    74  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_28.png
early stop counter: 27
val acc:0.9268943667411804, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9566548466682434
after epoch: 28,now: 2024-06-24 16:27:16.245847,epoch time: 0:21:58.683976,used: 9:16:07.428797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9482686, 'precision': 0.9312829, 'recall': 0.93226814, 'specificity': 0.93226814, 'f1': 0.931774, 'auroc': 0.9811618, 'binary_precision': 0.89667565, 'binary_recall': 0.899785, 'binary_specificity': 0.96475136, 'binary_f1_score': 0.89822763}
confusion matrix:
       0      1
0  40918   1495
1   1445  12974
---- Validation: 
scalar performance:
{'acc': 0.93884736, 'precision': 0.6294707, 'recall': 0.7022053, 'specificity': 0.7022053, 'f1': 0.6561608, 'auroc': 0.77459395, 'binary_precision': 0.28, 'binary_recall': 0.4472511, 'binary_specificity': 0.95715946, 'binary_f1_score': 0.34439358}
confusion matrix:
       0    1
0  17293  774
1    372  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95391554, 'precision': 0.7266277, 'recall': 0.8325093, 'specificity': 0.8325093, 'f1': 0.7678422, 'auroc': 0.88477445, 'binary_precision': 0.46666667, 'binary_recall': 0.7, 'binary_specificity': 0.9650185, 'binary_f1_score': 0.56}
confusion matrix:
      0    1
0  5738  208
1    78  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_29.png
early stop counter: 28
val acc:0.9388473629951477, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9566548466682434
after epoch: 29,now: 2024-06-24 16:51:16.361968,epoch time: 0:24:00.116121,used: 9:40:07.544918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.947336, 'precision': 0.92388266, 'recall': 0.94072974, 'specificity': 0.94072974, 'f1': 0.93184155, 'auroc': 0.9831309, 'binary_precision': 0.8730086, 'binary_recall': 0.9273181, 'binary_specificity': 0.95414144, 'binary_f1_score': 0.89934415}
confusion matrix:
       0      1
0  40468   1945
1   1048  13371
---- Validation: 
scalar performance:
{'acc': 0.92785484, 'precision': 0.61698, 'recall': 0.7294066, 'specificity': 0.7294066, 'f1': 0.65052146, 'auroc': 0.79308903, 'binary_precision': 0.25273123, 'binary_recall': 0.51560175, 'binary_specificity': 0.9432114, 'binary_f1_score': 0.33919844}
confusion matrix:
       0     1
0  17041  1026
1    326   347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.935224, 'precision': 0.6747868, 'recall': 0.8319497, 'specificity': 0.8319497, 'f1': 0.7237054, 'auroc': 0.88919765, 'binary_precision': 0.3624031, 'binary_recall': 0.7192308, 'binary_specificity': 0.9446687, 'binary_f1_score': 0.4819588}
confusion matrix:
      0    1
0  5617  329
1    73  187
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_30.png
early stop counter: 29
val acc:0.9278548359870911, best validation acc: 0.960032045841217, corresponding to test acc:                         0.9564937353134155 / 0.9566548466682434
after epoch: 30,now: 2024-06-24 17:15:05.362750,epoch time: 0:23:49.000782,used: 10:03:56.545700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_11_08_seed_1_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:03:56.545700 at 2024-06-24 17:15:05.362750
persisted model performance metric: 

scalar performance:
{'acc': 0.95649374, 'precision': 0.47901872, 'recall': 0.4991591, 'specificity': 0.4991591, 'f1': 0.4888816, 'auroc': 0.34893334, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5936  10
1   260   0
oracle model performance metric: 

scalar performance:
{'acc': 0.95665485, 'precision': 0.7349, 'recall': 0.7971591, 'specificity': 0.7971591, 'f1': 0.7618072, 'auroc': 0.86718667, 'binary_precision': 0.4864865, 'binary_recall': 0.6230769, 'binary_specificity': 0.9712412, 'binary_f1_score': 0.5463744}
confusion matrix:
      0    1
0  5775  171
1    98  162
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204071 KiB | 571737 KiB |   1139 TiB |   1139 TiB |
|       from large pool | 167040 KiB | 499008 KiB |   1137 TiB |   1137 TiB |
|       from small pool |  37031 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204071 KiB | 571737 KiB |   1139 TiB |   1139 TiB |
|       from large pool | 167040 KiB | 499008 KiB |   1137 TiB |   1137 TiB |
|       from small pool |  37031 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 563304 KiB |   1125 TiB |   1125 TiB |
|       from large pool | 165120 KiB | 491712 KiB |   1123 TiB |   1123 TiB |
|       from small pool |  35966 KiB |  74337 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 778240 KiB | 778240 KiB |   1192 MiB | 442368 KiB |
|       from large pool | 702464 KiB | 702464 KiB |   1092 MiB | 415744 KiB |
|       from small pool |  75776 KiB |  75776 KiB |    100 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80600 KiB | 209453 KiB |    768 TiB |    768 TiB |
|       from large pool |  68480 KiB | 208064 KiB |    767 TiB |    767 TiB |
|       from small pool |  12120 KiB |  19703 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    7899    |  231784 K  |  231781 K  |
|       from large pool |      36    |      76    |   78830 K  |   78830 K  |
|       from small pool |    3192    |    7861    |  152954 K  |  152951 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    7899    |  231784 K  |  231781 K  |
|       from large pool |      36    |      76    |   78830 K  |   78830 K  |
|       from small pool |    3192    |    7861    |  152954 K  |  152951 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      53    |      71    |      18    |
|       from large pool |      16    |      16    |      21    |       5    |
|       from small pool |      37    |      37    |      50    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    3580    |  107061 K  |  107061 K  |
|       from large pool |       5    |      13    |   31920 K  |   31920 K  |
|       from small pool |      48    |    3574    |   75140 K  |   75140 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB |   1139 TiB |   1139 TiB |
|       from large pool |  16640 KiB | 499008 KiB |   1137 TiB |   1137 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB |   1139 TiB |   1139 TiB |
|       from large pool |  16640 KiB | 499008 KiB |   1137 TiB |   1137 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB |   1125 TiB |   1125 TiB |
|       from large pool |  16640 KiB | 491712 KiB |   1123 TiB |   1123 TiB |
|       from small pool |      0 KiB |  74337 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 778240 KiB |   1192 MiB |    914 MiB |
|       from large pool | 235520 KiB | 702464 KiB |   1092 MiB |    862 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB |    768 TiB |    768 TiB |
|       from large pool |  55040 KiB | 208064 KiB |    767 TiB |    767 TiB |
|       from small pool |      0 KiB |  19715 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7899    |  231784 K  |  231784 K  |
|       from large pool |       2    |      76    |   78830 K  |   78830 K  |
|       from small pool |       0    |    7861    |  152954 K  |  152954 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7899    |  231784 K  |  231784 K  |
|       from large pool |       2    |      76    |   78830 K  |   78830 K  |
|       from small pool |       0    |    7861    |  152954 K  |  152954 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      53    |      71    |      37    |
|       from large pool |      10    |      16    |      21    |      11    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3580    |  107062 K  |  107062 K  |
|       from large pool |       3    |      13    |   31920 K  |   31920 K  |
|       from small pool |       0    |    3574    |   75142 K  |   75142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB |   1139 TiB |   1139 TiB |
|       from large pool |  16640 KiB | 499008 KiB |   1137 TiB |   1137 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB |   1139 TiB |   1139 TiB |
|       from large pool |  16640 KiB | 499008 KiB |   1137 TiB |   1137 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB |   1125 TiB |   1125 TiB |
|       from large pool |  16640 KiB | 491712 KiB |   1123 TiB |   1123 TiB |
|       from small pool |      0 KiB |  74337 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 778240 KiB |   1192 MiB |    914 MiB |
|       from large pool | 235520 KiB | 702464 KiB |   1092 MiB |    862 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB |    768 TiB |    768 TiB |
|       from large pool |  55040 KiB | 208064 KiB |    767 TiB |    767 TiB |
|       from small pool |      0 KiB |  19715 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7899    |  231784 K  |  231784 K  |
|       from large pool |       2    |      76    |   78830 K  |   78830 K  |
|       from small pool |       0    |    7861    |  152954 K  |  152954 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7899    |  231784 K  |  231784 K  |
|       from large pool |       2    |      76    |   78830 K  |   78830 K  |
|       from small pool |       0    |    7861    |  152954 K  |  152954 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      53    |      71    |      37    |
|       from large pool |      10    |      16    |      21    |      11    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3580    |  107062 K  |  107062 K  |
|       from large pool |       3    |      13    |   31920 K  |   31920 K  |
|       from small pool |       0    |    3574    |   75142 K  |   75142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887

 Experiment start at: 2024-06-24 17:22:53.742619
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7499652, 'precision': 0.85307944, 'recall': 0.52607054, 'specificity': 0.52607054, 'f1': 0.47757843, 'auroc': 0.79591227, 'binary_precision': 0.95928144, 'binary_recall': 0.052944675, 'binary_specificity': 0.9991964, 'binary_f1_score': 0.10035079}
confusion matrix:
       0    1
0  42277   34
1  14328  801
---- Validation: 
scalar performance:
{'acc': 0.9672402, 'precision': 0.56297743, 'recall': 0.5020514, 'specificity': 0.5020514, 'f1': 0.49650323, 'auroc': 0.51355565, 'binary_precision': 0.15789473, 'binary_recall': 0.004983389, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.009661836}
confusion matrix:
       0   1
0  18155  16
1    599   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.8812169, 'recall': 0.5163622, 'specificity': 0.5163622, 'f1': 0.5220945, 'auroc': 0.70738435, 'binary_precision': 0.8, 'binary_recall': 0.03305785, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.06349206}
confusion matrix:
      0  1
0  5995  2
1   234  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-24 17:43:25.194502,epoch time: 0:20:31.451883,used: 0:20:31.451883,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8318071, 'precision': 0.88410217, 'recall': 0.68710333, 'specificity': 0.68710333, 'f1': 0.72057223, 'auroc': 0.8932544, 'binary_precision': 0.95041186, 'binary_recall': 0.38132066, 'binary_specificity': 0.992886, 'binary_f1_score': 0.544271}
confusion matrix:
       0     1
0  42010   301
1   9360  5769
---- Validation: 
scalar performance:
{'acc': 0.9612209, 'precision': 0.5023658, 'recall': 0.5005482, 'specificity': 0.5005482, 'f1': 0.4968859, 'auroc': 0.5142583, 'binary_precision': 0.036764707, 'binary_recall': 0.008305647, 'binary_specificity': 0.9927907, 'binary_f1_score': 0.013550134}
confusion matrix:
       0    1
0  18040  131
1    597    5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.72678953, 'recall': 0.5731947, 'specificity': 0.5731947, 'f1': 0.6063193, 'auroc': 0.7082584, 'binary_precision': 0.4868421, 'binary_recall': 0.15289256, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.2327044}
confusion matrix:
      0   1
0  5958  39
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_2.png
early stop counter: 1
val acc:0.961220920085907, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 2,now: 2024-06-24 18:38:02.770463,epoch time: 0:54:37.575961,used: 1:15:09.027844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8922354, 'precision': 0.91369915, 'recall': 0.80677605, 'specificity': 0.80677605, 'f1': 0.84239185, 'auroc': 0.94369805, 'binary_precision': 0.9466427, 'binary_recall': 0.62617314, 'binary_specificity': 0.9873789, 'binary_f1_score': 0.7537592}
confusion matrix:
       0     1
0  41776   534
1   5656  9474
---- Validation: 
scalar performance:
{'acc': 0.9490758, 'precision': 0.5382157, 'recall': 0.52880555, 'specificity': 0.52880555, 'f1': 0.5325293, 'auroc': 0.6181418, 'binary_precision': 0.10666667, 'binary_recall': 0.07973422, 'binary_specificity': 0.97787684, 'binary_f1_score': 0.091254756}
confusion matrix:
       0    1
0  17769  402
1    554   48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95464015, 'precision': 0.6951963, 'recall': 0.69287294, 'specificity': 0.69287294, 'f1': 0.6940266, 'auroc': 0.7795254, 'binary_precision': 0.41422594, 'binary_recall': 0.4090909, 'binary_specificity': 0.976655, 'binary_f1_score': 0.41164243}
confusion matrix:
      0    1
0  5857  140
1   143   99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_3.png
early stop counter: 2
val acc:0.9490758180618286, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 3,now: 2024-06-24 19:17:52.341790,epoch time: 0:39:49.571327,used: 1:54:58.599171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8863858, 'precision': 0.88448757, 'recall': 0.81271875, 'specificity': 0.81271875, 'f1': 0.8395487, 'auroc': 0.9257234, 'binary_precision': 0.88136196, 'binary_recall': 0.6570597, 'binary_specificity': 0.96837777, 'binary_f1_score': 0.75285923}
confusion matrix:
       0     1
0  40974  1338
1   5188  9940
---- Validation: 
scalar performance:
{'acc': 0.91759443, 'precision': 0.519761, 'recall': 0.5350287, 'specificity': 0.5350287, 'f1': 0.5231544, 'auroc': 0.60276306, 'binary_precision': 0.06927986, 'binary_recall': 0.12624584, 'binary_specificity': 0.9438116, 'binary_f1_score': 0.08946438}
confusion matrix:
       0     1
0  17150  1021
1    526    76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92931557, 'precision': 0.628516, 'recall': 0.7292682, 'specificity': 0.7292682, 'f1': 0.6612671, 'auroc': 0.7996099, 'binary_precision': 0.27740493, 'binary_recall': 0.5123967, 'binary_specificity': 0.94613975, 'binary_f1_score': 0.35994196}
confusion matrix:
      0    1
0  5674  323
1   118  124
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_4.png
early stop counter: 3
val acc:0.9175944328308105, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 4,now: 2024-06-24 19:38:25.531794,epoch time: 0:20:33.190004,used: 2:15:31.789175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8978412, 'precision': 0.8932904, 'recall': 0.8352923, 'specificity': 0.8352923, 'f1': 0.85846865, 'auroc': 0.9459543, 'binary_precision': 0.88546693, 'binary_recall': 0.7031064, 'binary_specificity': 0.96747816, 'binary_f1_score': 0.7838196}
confusion matrix:
       0      1
0  40934   1376
1   4492  10638
---- Validation: 
scalar performance:
{'acc': 0.9275023, 'precision': 0.5317266, 'recall': 0.54817724, 'specificity': 0.54817724, 'f1': 0.5372032, 'auroc': 0.6632173, 'binary_precision': 0.09237379, 'binary_recall': 0.14285715, 'binary_specificity': 0.95349735, 'binary_f1_score': 0.1121983}
confusion matrix:
       0    1
0  17326  845
1    516   86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9373297, 'precision': 0.64323753, 'recall': 0.72352326, 'specificity': 0.72352326, 'f1': 0.6726899, 'auroc': 0.8030558, 'binary_precision': 0.30749354, 'binary_recall': 0.49173555, 'binary_specificity': 0.955311, 'binary_f1_score': 0.3783784}
confusion matrix:
      0    1
0  5729  268
1   123  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_5.png
early stop counter: 4
val acc:0.9275022745132446, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 5,now: 2024-06-24 20:12:36.403468,epoch time: 0:34:10.871674,used: 2:49:42.660849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9034819, 'precision': 0.8893858, 'recall': 0.85505676, 'specificity': 0.85505676, 'f1': 0.87009466, 'auroc': 0.9473418, 'binary_precision': 0.8633159, 'binary_recall': 0.75272655, 'binary_specificity': 0.957387, 'binary_f1_score': 0.8042373}
confusion matrix:
       0      1
0  40508   1803
1   3741  11388
---- Validation: 
scalar performance:
{'acc': 0.9076866, 'precision': 0.5210805, 'recall': 0.5443655, 'specificity': 0.5443655, 'f1': 0.52461004, 'auroc': 0.6481794, 'binary_precision': 0.07126611, 'binary_recall': 0.15614618, 'binary_specificity': 0.9325849, 'binary_f1_score': 0.0978657}
confusion matrix:
       0     1
0  16946  1225
1    508    94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9195384, 'precision': 0.6163304, 'recall': 0.74004424, 'specificity': 0.74004424, 'f1': 0.65089273, 'auroc': 0.816623, 'binary_precision': 0.2519084, 'binary_recall': 0.54545456, 'binary_specificity': 0.934634, 'binary_f1_score': 0.34464753}
confusion matrix:
      0    1
0  5605  392
1   110  132
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_6.png
early stop counter: 5
val acc:0.9076865911483765, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 6,now: 2024-06-24 21:17:32.345081,epoch time: 1:04:55.941613,used: 3:54:38.602462,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9188719, 'precision': 0.91091263, 'recall': 0.87512803, 'specificity': 0.87512803, 'f1': 0.89087045, 'auroc': 0.9598279, 'binary_precision': 0.89617074, 'binary_recall': 0.78268343, 'binary_specificity': 0.9675727, 'binary_f1_score': 0.8355913}
confusion matrix:
       0      1
0  40938   1372
1   3288  11842
---- Validation: 
scalar performance:
{'acc': 0.92190915, 'precision': 0.5448255, 'recall': 0.5814252, 'specificity': 0.5814252, 'f1': 0.5553456, 'auroc': 0.7039256, 'binary_precision': 0.11634103, 'binary_recall': 0.21760798, 'binary_specificity': 0.9452424, 'binary_f1_score': 0.15162037}
confusion matrix:
       0    1
0  17176  995
1    471  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93668854, 'precision': 0.63988745, 'recall': 0.7172415, 'specificity': 0.7172415, 'f1': 0.6683427, 'auroc': 0.79746556, 'binary_precision': 0.3012987, 'binary_recall': 0.47933885, 'binary_specificity': 0.9551442, 'binary_f1_score': 0.37001595}
confusion matrix:
      0    1
0  5728  269
1   126  116
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_7.png
early stop counter: 6
val acc:0.9219091534614563, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 7,now: 2024-06-24 21:37:10.443598,epoch time: 0:19:38.098517,used: 4:14:16.700979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90962744, 'precision': 0.8881248, 'recall': 0.87585866, 'specificity': 0.87585866, 'f1': 0.88170934, 'auroc': 0.95538676, 'binary_precision': 0.84498435, 'binary_recall': 0.8044944, 'binary_specificity': 0.9472229, 'binary_f1_score': 0.8242425}
confusion matrix:
       0      1
0  40077   2233
1   2958  12172
---- Validation: 
scalar performance:
{'acc': 0.9069408, 'precision': 0.54416925, 'recall': 0.6034059, 'specificity': 0.6034059, 'f1': 0.5560216, 'auroc': 0.7056775, 'binary_precision': 0.11343687, 'binary_recall': 0.27906978, 'binary_specificity': 0.927742, 'binary_f1_score': 0.1613058}
confusion matrix:
       0     1
0  16858  1313
1    434   168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91376823, 'precision': 0.6130516, 'recall': 0.75488746, 'specificity': 0.75488746, 'f1': 0.6488769, 'auroc': 0.8370129, 'binary_precision': 0.24394463, 'binary_recall': 0.58264464, 'binary_specificity': 0.9271302, 'binary_f1_score': 0.3439024}
confusion matrix:
      0    1
0  5560  437
1   101  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_8.png
early stop counter: 7
val acc:0.9069408178329468, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 8,now: 2024-06-24 21:55:41.437507,epoch time: 0:18:30.993909,used: 4:32:47.694888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9319812, 'precision': 0.9259049, 'recall': 0.8954905, 'specificity': 0.8954905, 'f1': 0.90920496, 'auroc': 0.9700401, 'binary_precision': 0.9144081, 'binary_recall': 0.8183741, 'binary_specificity': 0.97260696, 'binary_f1_score': 0.86372995}
confusion matrix:
       0      1
0  41151   1159
1   2748  12382
---- Validation: 
scalar performance:
{'acc': 0.92899376, 'precision': 0.558137, 'recall': 0.59632754, 'specificity': 0.59632754, 'f1': 0.57078713, 'auroc': 0.7170081, 'binary_precision': 0.14201763, 'binary_recall': 0.24086379, 'binary_specificity': 0.9517913, 'binary_f1_score': 0.17868146}
confusion matrix:
       0    1
0  17295  876
1    457  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93155956, 'precision': 0.64272046, 'recall': 0.7661248, 'specificity': 0.7661248, 'f1': 0.68157476, 'auroc': 0.8384323, 'binary_precision': 0.30277187, 'binary_recall': 0.58677685, 'binary_specificity': 0.9454727, 'binary_f1_score': 0.39943743}
confusion matrix:
      0    1
0  5670  327
1   100  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_9.png
early stop counter: 8
val acc:0.9289937615394592, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 9,now: 2024-06-24 22:16:36.880185,epoch time: 0:20:55.442678,used: 4:53:43.137566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.92580086, 'precision': 0.915747, 'recall': 0.8892515, 'specificity': 0.8892515, 'f1': 0.9013238, 'auroc': 0.9655119, 'binary_precision': 0.896519, 'binary_recall': 0.81201667, 'binary_specificity': 0.9664863, 'binary_f1_score': 0.8521781}
confusion matrix:
       0      1
0  40893   1418
1   2844  12285
---- Validation: 
scalar performance:
{'acc': 0.9253183, 'precision': 0.5599417, 'recall': 0.6088838, 'specificity': 0.6088838, 'f1': 0.5747575, 'auroc': 0.7125479, 'binary_precision': 0.1447602, 'binary_recall': 0.2707641, 'binary_specificity': 0.9470035, 'binary_f1_score': 0.1886574}
confusion matrix:
       0    1
0  17208  963
1    439  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9307581, 'precision': 0.6390612, 'recall': 0.757777, 'specificity': 0.757777, 'f1': 0.6765635, 'auroc': 0.8291342, 'binary_precision': 0.29613733, 'binary_recall': 0.57024795, 'binary_specificity': 0.945306, 'binary_f1_score': 0.3898305}
confusion matrix:
      0    1
0  5669  328
1   104  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_10.png
early stop counter: 9
val acc:0.9253183007240295, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 10,now: 2024-06-24 22:37:45.798249,epoch time: 0:21:08.918064,used: 5:14:52.055630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.92853415, 'precision': 0.91591346, 'recall': 0.8968979, 'specificity': 0.8968979, 'f1': 0.9057939, 'auroc': 0.96929485, 'binary_precision': 0.89113617, 'binary_recall': 0.83005023, 'binary_specificity': 0.96374553, 'binary_f1_score': 0.8595092}
confusion matrix:
       0      1
0  40778   1534
1   2571  12557
---- Validation: 
scalar performance:
{'acc': 0.92286795, 'precision': 0.5597149, 'recall': 0.6140424, 'specificity': 0.6140424, 'f1': 0.5752824, 'auroc': 0.7270647, 'binary_precision': 0.14393939, 'binary_recall': 0.28405315, 'binary_specificity': 0.9440317, 'binary_f1_score': 0.19106145}
confusion matrix:
       0     1
0  17154  1017
1    431   171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9322007, 'precision': 0.6425061, 'recall': 0.7605101, 'specificity': 0.7605101, 'f1': 0.68032944, 'auroc': 0.82821226, 'binary_precision': 0.30283225, 'binary_recall': 0.57438016, 'binary_specificity': 0.94664, 'binary_f1_score': 0.39657632}
confusion matrix:
      0    1
0  5677  320
1   103  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_11.png
early stop counter: 10
val acc:0.9228679537773132, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 11,now: 2024-06-24 22:57:51.507881,epoch time: 0:20:05.709632,used: 5:34:57.765262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92419916, 'precision': 0.89902276, 'recall': 0.9081859, 'specificity': 0.9081859, 'f1': 0.903446, 'auroc': 0.97016215, 'binary_precision': 0.8435686, 'binary_recall': 0.87434727, 'binary_specificity': 0.9420245, 'binary_f1_score': 0.8586822}
confusion matrix:
       0      1
0  39858   2453
1   1901  13228
---- Validation: 
scalar performance:
{'acc': 0.87775, 'precision': 0.55278474, 'recall': 0.6798744, 'specificity': 0.6798744, 'f1': 0.5655544, 'auroc': 0.7586585, 'binary_precision': 0.12494462, 'binary_recall': 0.46843854, 'binary_specificity': 0.89131033, 'binary_f1_score': 0.19727178}
confusion matrix:
       0     1
0  16196  1975
1    320   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89325213, 'precision': 0.60691917, 'recall': 0.8116286, 'specificity': 0.8116286, 'f1': 0.6431916, 'auroc': 0.86982405, 'binary_precision': 0.2260982, 'binary_recall': 0.7231405, 'binary_specificity': 0.90011674, 'binary_f1_score': 0.3444882}
confusion matrix:
      0    1
0  5398  599
1    67  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_12.png
early stop counter: 11
val acc:0.8777499794960022, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 12,now: 2024-06-24 23:16:56.535344,epoch time: 0:19:05.027463,used: 5:54:02.792725,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.93570685, 'precision': 0.9230829, 'recall': 0.9091437, 'specificity': 0.9091437, 'f1': 0.91578925, 'auroc': 0.97408235, 'binary_precision': 0.8978087, 'binary_recall': 0.85300726, 'binary_specificity': 0.96528006, 'binary_f1_score': 0.8748348}
confusion matrix:
       0      1
0  40841   1469
1   2224  12906
---- Validation: 
scalar performance:
{'acc': 0.93085814, 'precision': 0.57599235, 'recall': 0.6318217, 'specificity': 0.6318217, 'f1': 0.5942137, 'auroc': 0.76052296, 'binary_precision': 0.17537314, 'binary_recall': 0.31229237, 'binary_specificity': 0.95135105, 'binary_f1_score': 0.2246117}
confusion matrix:
       0    1
0  17287  884
1    414  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9381311, 'precision': 0.6577578, 'recall': 0.77152586, 'specificity': 0.77152586, 'f1': 0.69645, 'auroc': 0.854056, 'binary_precision': 0.33255813, 'binary_recall': 0.59090906, 'binary_specificity': 0.9521427, 'binary_f1_score': 0.42559522}
confusion matrix:
      0    1
0  5710  287
1    99  143
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_13.png
early stop counter: 12
val acc:0.9308581352233887, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 13,now: 2024-06-24 23:35:12.754484,epoch time: 0:18:16.219140,used: 6:12:19.011865,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93687326, 'precision': 0.9247999, 'recall': 0.91044056, 'specificity': 0.91044056, 'f1': 0.9172785, 'auroc': 0.97351575, 'binary_precision': 0.90066177, 'binary_recall': 0.8545839, 'binary_specificity': 0.9662972, 'binary_f1_score': 0.87701803}
confusion matrix:
       0      1
0  40885   1426
1   2200  12929
---- Validation: 
scalar performance:
{'acc': 0.9337346, 'precision': 0.58463323, 'recall': 0.6429442, 'specificity': 0.6429442, 'f1': 0.6043296, 'auroc': 0.7580135, 'binary_precision': 0.19193858, 'binary_recall': 0.33222592, 'binary_specificity': 0.95366246, 'binary_f1_score': 0.243309}
confusion matrix:
       0    1
0  17329  842
1    402  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93893254, 'precision': 0.66246605, 'recall': 0.7838392, 'specificity': 0.7838392, 'f1': 0.70329493, 'auroc': 0.85551596, 'binary_precision': 0.3409611, 'binary_recall': 0.61570245, 'binary_specificity': 0.951976, 'binary_f1_score': 0.4388807}
confusion matrix:
      0    1
0  5709  288
1    93  149
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_14.png
early stop counter: 13
val acc:0.9337345957756042, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 14,now: 2024-06-24 23:53:47.572207,epoch time: 0:18:34.817723,used: 6:30:53.829588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.92411214, 'precision': 0.8961969, 'recall': 0.9137533, 'specificity': 0.9137533, 'f1': 0.9043765, 'auroc': 0.97137195, 'binary_precision': 0.8320794, 'binary_recall': 0.8918633, 'binary_specificity': 0.9356432, 'binary_f1_score': 0.8609347}
confusion matrix:
       0      1
0  39588   2723
1   1636  13493
---- Validation: 
scalar performance:
{'acc': 0.89990944, 'precision': 0.5649509, 'recall': 0.6832907, 'specificity': 0.6832907, 'f1': 0.58550864, 'auroc': 0.7643808, 'binary_precision': 0.14936848, 'binary_recall': 0.45182723, 'binary_specificity': 0.9147543, 'binary_f1_score': 0.22451507}
confusion matrix:
       0     1
0  16622  1549
1    330   272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.907357, 'precision': 0.622404, 'recall': 0.82293105, 'specificity': 0.82293105, 'f1': 0.66488385, 'auroc': 0.8822972, 'binary_precision': 0.25652173, 'binary_recall': 0.73140496, 'binary_specificity': 0.9144572, 'binary_f1_score': 0.3798283}
confusion matrix:
      0    1
0  5484  513
1    65  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_15.png
early stop counter: 14
val acc:0.8999094367027283, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 15,now: 2024-06-25 00:12:14.597661,epoch time: 0:18:27.025454,used: 6:49:20.855042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9407904, 'precision': 0.9272045, 'recall': 0.9189632, 'specificity': 0.9189632, 'f1': 0.922971, 'auroc': 0.9781492, 'binary_precision': 0.8994075, 'binary_recall': 0.8728354, 'binary_specificity': 0.965091, 'binary_f1_score': 0.88592225}
confusion matrix:
       0      1
0  40833   1477
1   1924  13206
---- Validation: 
scalar performance:
{'acc': 0.9268098, 'precision': 0.58386034, 'recall': 0.6666707, 'specificity': 0.6666707, 'f1': 0.6077943, 'auroc': 0.7700815, 'binary_precision': 0.18870968, 'binary_recall': 0.38870433, 'binary_specificity': 0.94463706, 'binary_f1_score': 0.25407165}
confusion matrix:
       0     1
0  17165  1006
1    368   234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93700916, 'precision': 0.6605843, 'recall': 0.7947352, 'specificity': 0.7947352, 'f1': 0.70379573, 'auroc': 0.8619789, 'binary_precision': 0.3362256, 'binary_recall': 0.6404959, 'binary_specificity': 0.9489745, 'binary_f1_score': 0.4409673}
confusion matrix:
      0    1
0  5691  306
1    87  155
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_16.png
early stop counter: 15
val acc:0.9268097877502441, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 16,now: 2024-06-25 00:30:52.156123,epoch time: 0:18:37.558462,used: 7:07:58.413504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.94641364, 'precision': 0.9369145, 'recall': 0.9234384, 'specificity': 0.9234384, 'f1': 0.929886, 'auroc': 0.97995234, 'binary_precision': 0.91783386, 'binary_recall': 0.8748843, 'binary_specificity': 0.97199243, 'binary_f1_score': 0.8958446}
confusion matrix:
       0      1
0  41125   1185
1   1893  13237
---- Validation: 
scalar performance:
{'acc': 0.9317104, 'precision': 0.5815501, 'recall': 0.6427016, 'specificity': 0.6427016, 'f1': 0.60148466, 'auroc': 0.7626717, 'binary_precision': 0.1857671, 'binary_recall': 0.33388704, 'binary_specificity': 0.95151615, 'binary_f1_score': 0.23871733}
confusion matrix:
       0    1
0  17290  881
1    401  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9400545, 'precision': 0.6656896, 'recall': 0.78640556, 'specificity': 0.78640556, 'f1': 0.7067098, 'auroc': 0.86038685, 'binary_precision': 0.3472222, 'binary_recall': 0.6198347, 'binary_specificity': 0.95297647, 'binary_f1_score': 0.44510385}
confusion matrix:
      0    1
0  5715  282
1    92  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_17.png
early stop counter: 16
val acc:0.931710422039032, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 17,now: 2024-06-25 00:49:31.257650,epoch time: 0:18:39.101527,used: 7:26:37.515031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.940007, 'precision': 0.92150784, 'recall': 0.92446053, 'specificity': 0.92446053, 'f1': 0.9229692, 'auroc': 0.97754216, 'binary_precision': 0.88192993, 'binary_recall': 0.8916061, 'binary_specificity': 0.957315, 'binary_f1_score': 0.88674164}
confusion matrix:
       0      1
0  40504   1806
1   1640  13490
---- Validation: 
scalar performance:
{'acc': 0.92302775, 'precision': 0.5816629, 'recall': 0.67355055, 'specificity': 0.67355055, 'f1': 0.6063263, 'auroc': 0.7597713, 'binary_precision': 0.18379594, 'binary_recall': 0.40697673, 'binary_specificity': 0.9401244, 'binary_f1_score': 0.25322995}
confusion matrix:
       0     1
0  17083  1088
1    357   245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9318801, 'precision': 0.65322435, 'recall': 0.8079291, 'specificity': 0.8079291, 'f1': 0.69892335, 'auroc': 0.8610593, 'binary_precision': 0.32023576, 'binary_recall': 0.6735537, 'binary_specificity': 0.9423045, 'binary_f1_score': 0.43408787}
confusion matrix:
      0    1
0  5651  346
1    79  163
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_18.png
early stop counter: 17
val acc:0.923027753829956, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 18,now: 2024-06-25 01:07:56.150457,epoch time: 0:18:24.892807,used: 7:45:02.407838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.944812, 'precision': 0.9316224, 'recall': 0.9252384, 'specificity': 0.9252384, 'f1': 0.9283633, 'auroc': 0.9771738, 'binary_precision': 0.90443665, 'binary_recall': 0.8838731, 'binary_specificity': 0.96660364, 'binary_f1_score': 0.89403665}
confusion matrix:
       0      1
0  40897   1413
1   1757  13373
---- Validation: 
scalar performance:
{'acc': 0.93634474, 'precision': 0.5960236, 'recall': 0.6611565, 'specificity': 0.6611565, 'f1': 0.61836374, 'auroc': 0.7530918, 'binary_precision': 0.21352658, 'binary_recall': 0.36710963, 'binary_specificity': 0.95520335, 'binary_f1_score': 0.27000612}
confusion matrix:
       0    1
0  17357  814
1    381  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94566435, 'precision': 0.6806507, 'recall': 0.787341, 'specificity': 0.787341, 'f1': 0.7195943, 'auroc': 0.8511783, 'binary_precision': 0.37721518, 'binary_recall': 0.61570245, 'binary_specificity': 0.9589795, 'binary_f1_score': 0.46781787}
confusion matrix:
      0    1
0  5751  246
1    93  149
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_19.png
early stop counter: 18
val acc:0.9363447427749634, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 19,now: 2024-06-25 01:27:01.657444,epoch time: 0:19:05.506987,used: 8:04:07.914825,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.92933494, 'precision': 0.90444654, 'recall': 0.9167918, 'specificity': 0.9167918, 'f1': 0.9103352, 'auroc': 0.97299445, 'binary_precision': 0.84882474, 'binary_recall': 0.8902842, 'binary_specificity': 0.9432995, 'binary_f1_score': 0.8690603}
confusion matrix:
       0      1
0  39911   2399
1   1660  13470
---- Validation: 
scalar performance:
{'acc': 0.9147712, 'precision': 0.57572883, 'recall': 0.6813312, 'specificity': 0.6813312, 'f1': 0.60005915, 'auroc': 0.7612029, 'binary_precision': 0.171278, 'binary_recall': 0.43189368, 'binary_specificity': 0.9307688, 'binary_f1_score': 0.24528301}
confusion matrix:
       0     1
0  16913  1258
1    342   260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92162204, 'precision': 0.6406286, 'recall': 0.826386, 'specificity': 0.826386, 'f1': 0.6875747, 'auroc': 0.8771714, 'binary_precision': 0.29313233, 'binary_recall': 0.7231405, 'binary_specificity': 0.9296315, 'binary_f1_score': 0.4171633}
confusion matrix:
      0    1
0  5575  422
1    67  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_20.png
early stop counter: 19
val acc:0.9147711992263794, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 20,now: 2024-06-25 01:45:09.894999,epoch time: 0:18:08.237555,used: 8:22:16.152380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9302054, 'precision': 0.9144052, 'recall': 0.9038171, 'specificity': 0.9038171, 'f1': 0.9089179, 'auroc': 0.96873295, 'binary_precision': 0.88240147, 'binary_recall': 0.84805024, 'binary_specificity': 0.959584, 'binary_f1_score': 0.86488485}
confusion matrix:
       0      1
0  40600   1710
1   2299  12831
---- Validation: 
scalar performance:
{'acc': 0.9386353, 'precision': 0.5838001, 'recall': 0.62218726, 'specificity': 0.62218726, 'f1': 0.5984809, 'auroc': 0.7339674, 'binary_precision': 0.19170403, 'binary_recall': 0.28405315, 'binary_specificity': 0.96032137, 'binary_f1_score': 0.22891565}
confusion matrix:
       0    1
0  17450  721
1    431  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9381311, 'precision': 0.66447145, 'recall': 0.801267, 'specificity': 0.801267, 'f1': 0.708682, 'auroc': 0.85881376, 'binary_precision': 0.34347826, 'binary_recall': 0.6528926, 'binary_specificity': 0.94964147, 'binary_f1_score': 0.45014247}
confusion matrix:
      0    1
0  5695  302
1    84  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_21.png
early stop counter: 20
val acc:0.9386352896690369, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 21,now: 2024-06-25 02:05:00.312388,epoch time: 0:19:50.417389,used: 8:42:06.569769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9516713, 'precision': 0.94127584, 'recall': 0.93324554, 'specificity': 0.93324554, 'f1': 0.937158, 'auroc': 0.98354745, 'binary_precision': 0.9199701, 'binary_recall': 0.8943089, 'binary_specificity': 0.97218215, 'binary_f1_score': 0.906958}
confusion matrix:
       0      1
0  41134   1177
1   1599  13530
---- Validation: 
scalar performance:
{'acc': 0.9433761, 'precision': 0.61563027, 'recall': 0.6752283, 'specificity': 0.6752283, 'f1': 0.6380836, 'auroc': 0.77798855, 'binary_precision': 0.25188375, 'binary_recall': 0.38870433, 'binary_specificity': 0.96175224, 'binary_f1_score': 0.30568257}
confusion matrix:
       0    1
0  17476  695
1    368  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95768553, 'precision': 0.72606957, 'recall': 0.8054906, 'specificity': 0.8054906, 'f1': 0.7589462, 'auroc': 0.87062335, 'binary_precision': 0.46686748, 'binary_recall': 0.6404959, 'binary_specificity': 0.97048527, 'binary_f1_score': 0.5400697}
confusion matrix:
      0    1
0  5820  177
1    87  155
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_22.png
early stop counter: 21
val acc:0.9433761239051819, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 22,now: 2024-06-25 02:24:11.313055,epoch time: 0:19:11.000667,used: 9:01:17.570436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9462047, 'precision': 0.92907333, 'recall': 0.9329772, 'specificity': 0.9329772, 'f1': 0.9309996, 'auroc': 0.98173815, 'binary_precision': 0.89228463, 'binary_recall': 0.90502316, 'binary_specificity': 0.96093124, 'binary_f1_score': 0.8986088}
confusion matrix:
       0      1
0  40657   1653
1   1437  13693
---- Validation: 
scalar performance:
{'acc': 0.93021894, 'precision': 0.5984458, 'recall': 0.69653845, 'specificity': 0.69653845, 'f1': 0.62721443, 'auroc': 0.7894883, 'binary_precision': 0.21589085, 'binary_recall': 0.44684386, 'binary_specificity': 0.94623303, 'binary_f1_score': 0.29112554}
confusion matrix:
       0    1
0  17194  977
1    333  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9362077, 'precision': 0.66222596, 'recall': 0.8101802, 'specificity': 0.8101802, 'f1': 0.7082077, 'auroc': 0.86671364, 'binary_precision': 0.33817428, 'binary_recall': 0.6735537, 'binary_specificity': 0.9468067, 'binary_f1_score': 0.45027623}
confusion matrix:
      0    1
0  5678  319
1    79  163
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_23.png
early stop counter: 22
val acc:0.9302189350128174, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 23,now: 2024-06-25 02:42:46.554481,epoch time: 0:18:35.241426,used: 9:19:52.811862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9463614, 'precision': 0.9277817, 'recall': 0.93541634, 'specificity': 0.93541634, 'f1': 0.9314995, 'auroc': 0.9819418, 'binary_precision': 0.8872461, 'binary_recall': 0.91228765, 'binary_specificity': 0.9585451, 'binary_f1_score': 0.89959264}
confusion matrix:
       0      1
0  40557   1754
1   1327  13802
---- Validation: 
scalar performance:
{'acc': 0.9247323, 'precision': 0.5973787, 'recall': 0.71779567, 'specificity': 0.71779567, 'f1': 0.62880045, 'auroc': 0.7907196, 'binary_precision': 0.21220724, 'binary_recall': 0.49667773, 'binary_specificity': 0.93891364, 'binary_f1_score': 0.2973645}
confusion matrix:
       0     1
0  17061  1110
1    303   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93524605, 'precision': 0.66222984, 'recall': 0.81959367, 'specificity': 0.81959367, 'f1': 0.709818, 'auroc': 0.877077, 'binary_precision': 0.33734939, 'binary_recall': 0.6942149, 'binary_specificity': 0.9449725, 'binary_f1_score': 0.45405406}
confusion matrix:
      0    1
0  5667  330
1    74  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_24.png
early stop counter: 23
val acc:0.9247323274612427, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 24,now: 2024-06-25 03:01:39.823051,epoch time: 0:18:53.268570,used: 9:38:46.080432,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.94549096, 'precision': 0.9305272, 'recall': 0.9287107, 'specificity': 0.9287107, 'f1': 0.9296135, 'auroc': 0.97970796, 'binary_precision': 0.89913505, 'binary_recall': 0.89325136, 'binary_specificity': 0.9641701, 'binary_f1_score': 0.89618355}
confusion matrix:
       0      1
0  40795   1516
1   1615  13514
---- Validation: 
scalar performance:
{'acc': 0.9278219, 'precision': 0.58890986, 'recall': 0.67763317, 'specificity': 0.67763317, 'f1': 0.61460656, 'auroc': 0.7645264, 'binary_precision': 0.19807538, 'binary_recall': 0.410299, 'binary_specificity': 0.94496727, 'binary_f1_score': 0.26717147}
confusion matrix:
       0     1
0  17171  1000
1    355   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9322007, 'precision': 0.656432, 'recall': 0.8199923, 'specificity': 0.8199923, 'f1': 0.7040255, 'auroc': 0.8758732, 'binary_precision': 0.3256262, 'binary_recall': 0.6983471, 'binary_specificity': 0.94163746, 'binary_f1_score': 0.44415244}
confusion matrix:
      0    1
0  5647  350
1    73  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_25.png
early stop counter: 24
val acc:0.9278218746185303, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 25,now: 2024-06-25 03:20:48.334513,epoch time: 0:19:08.511462,used: 9:57:54.591894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9448294, 'precision': 0.92475533, 'recall': 0.9351833, 'specificity': 0.9351833, 'f1': 0.9297807, 'auroc': 0.9815762, 'binary_precision': 0.8804071, 'binary_recall': 0.9147994, 'binary_specificity': 0.9555671, 'binary_f1_score': 0.8972738}
confusion matrix:
       0      1
0  40431   1880
1   1289  13840
---- Validation: 
scalar performance:
{'acc': 0.9278219, 'precision': 0.60196286, 'recall': 0.71939164, 'specificity': 0.71939164, 'f1': 0.6340631, 'auroc': 0.7879998, 'binary_precision': 0.22131754, 'binary_recall': 0.49667773, 'binary_specificity': 0.94210553, 'binary_f1_score': 0.3061956}
confusion matrix:
       0     1
0  17119  1052
1    303   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9355666, 'precision': 0.6653272, 'recall': 0.8316569, 'specificity': 0.8316569, 'f1': 0.7148615, 'auroc': 0.8897631, 'binary_precision': 0.34251967, 'binary_recall': 0.71900827, 'binary_specificity': 0.9443055, 'binary_f1_score': 0.46399996}
confusion matrix:
      0    1
0  5663  334
1    68  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_26.png
early stop counter: 25
val acc:0.9278218746185303, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 26,now: 2024-06-25 03:38:44.770004,epoch time: 0:17:56.435491,used: 10:15:51.027385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.95269847, 'precision': 0.93992233, 'recall': 0.9379158, 'specificity': 0.9379158, 'f1': 0.9389126, 'auroc': 0.9832084, 'binary_precision': 0.9131332, 'binary_recall': 0.90667546, 'binary_specificity': 0.9691562, 'binary_f1_score': 0.90989286}
confusion matrix:
       0      1
0  41005   1305
1   1412  13718
---- Validation: 
scalar performance:
{'acc': 0.9362382, 'precision': 0.61030227, 'recall': 0.70286, 'specificity': 0.70286, 'f1': 0.63991004, 'auroc': 0.80083174, 'binary_precision': 0.2392638, 'binary_recall': 0.45348838, 'binary_specificity': 0.9522316, 'binary_f1_score': 0.31325302}
confusion matrix:
       0    1
0  17303  868
1    329  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535182, 'precision': 0.71143323, 'recall': 0.82116747, 'specificity': 0.82116747, 'f1': 0.7531462, 'auroc': 0.88195544, 'binary_precision': 0.43617022, 'binary_recall': 0.677686, 'binary_specificity': 0.96464896, 'binary_f1_score': 0.5307443}
confusion matrix:
      0    1
0  5785  212
1    78  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_27.png
early stop counter: 26
val acc:0.9362382292747498, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 27,now: 2024-06-25 03:58:54.127400,epoch time: 0:20:09.357396,used: 10:36:00.384781,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9343663, 'precision': 0.91000485, 'recall': 0.9246653, 'specificity': 0.9246653, 'f1': 0.91694, 'auroc': 0.9754684, 'binary_precision': 0.855, 'binary_recall': 0.9041639, 'binary_specificity': 0.94516665, 'binary_f1_score': 0.878895}
confusion matrix:
       0      1
0  39990   2320
1   1450  13680
---- Validation: 
scalar performance:
{'acc': 0.9207905, 'precision': 0.57618076, 'recall': 0.6643644, 'specificity': 0.6643644, 'f1': 0.5991905, 'auroc': 0.75809884, 'binary_precision': 0.17343174, 'binary_recall': 0.39036545, 'binary_specificity': 0.9383633, 'binary_f1_score': 0.24016352}
confusion matrix:
       0     1
0  17051  1120
1    367   235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.918737, 'precision': 0.6358816, 'recall': 0.8229025, 'specificity': 0.8229025, 'f1': 0.68169856, 'auroc': 0.8871454, 'binary_precision': 0.28384992, 'binary_recall': 0.71900827, 'binary_specificity': 0.92679673, 'binary_f1_score': 0.40701756}
confusion matrix:
      0    1
0  5558  439
1    68  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_28.png
early stop counter: 27
val acc:0.9207904934883118, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 28,now: 2024-06-25 04:18:13.204011,epoch time: 0:19:19.076611,used: 10:55:19.461392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.95047003, 'precision': 0.939728, 'recall': 0.93166906, 'specificity': 0.93166906, 'f1': 0.9355947, 'auroc': 0.9827323, 'binary_precision': 0.9177151, 'binary_recall': 0.89193654, 'binary_specificity': 0.9714016, 'binary_f1_score': 0.9046422}
confusion matrix:
       0      1
0  41100   1210
1   1635  13495
---- Validation: 
scalar performance:
{'acc': 0.94097906, 'precision': 0.614625, 'recall': 0.68764186, 'specificity': 0.68764186, 'f1': 0.64048433, 'auroc': 0.8014363, 'binary_precision': 0.24900794, 'binary_recall': 0.41694352, 'binary_specificity': 0.9583402, 'binary_f1_score': 0.31180122}
confusion matrix:
       0    1
0  17414  757
1    351  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.7359945, 'recall': 0.8243357, 'specificity': 0.8243357, 'f1': 0.7721686, 'auroc': 0.8867814, 'binary_precision': 0.4852071, 'binary_recall': 0.677686, 'binary_specificity': 0.9709855, 'binary_f1_score': 0.56551725}
confusion matrix:
      0    1
0  5823  174
1    78  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_29.png
early stop counter: 28
val acc:0.9409790635108948, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 29,now: 2024-06-25 04:36:24.638626,epoch time: 0:18:11.434615,used: 11:13:30.896007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9479805, 'precision': 0.9362421, 'recall': 0.9287233, 'specificity': 0.9287233, 'f1': 0.9323913, 'auroc': 0.9815512, 'binary_precision': 0.9121461, 'binary_recall': 0.88802963, 'binary_specificity': 0.9694169, 'binary_f1_score': 0.89992636}
confusion matrix:
       0      1
0  41017   1294
1   1694  13435
---- Validation: 
scalar performance:
{'acc': 0.9446546, 'precision': 0.6072455, 'recall': 0.64617586, 'specificity': 0.64617586, 'f1': 0.6230884, 'auroc': 0.7725922, 'binary_precision': 0.23706378, 'binary_recall': 0.32724252, 'binary_specificity': 0.9651092, 'binary_f1_score': 0.27494767}
confusion matrix:
       0    1
0  17537  634
1    405  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94774806, 'precision': 0.692004, 'recall': 0.8161832, 'specificity': 0.8161832, 'f1': 0.7362168, 'auroc': 0.8749093, 'binary_precision': 0.39756098, 'binary_recall': 0.6735537, 'binary_specificity': 0.9588127, 'binary_f1_score': 0.5}
confusion matrix:
      0    1
0  5750  247
1    79  163
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552887_30.png
early stop counter: 29
val acc:0.9446545839309692, best validation acc: 0.9672402143478394, corresponding to test acc:                         0.9621734023094177 / 0.9621734023094177
after epoch: 30,now: 2024-06-25 04:55:15.706836,epoch time: 0:18:51.068210,used: 11:32:21.964217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552887
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:32:21.964217 at 2024-06-25 04:55:15.706836
persisted model performance metric: 

scalar performance:
{'acc': 0.9621734, 'precision': 0.8812169, 'recall': 0.5163622, 'specificity': 0.5163622, 'f1': 0.5220945, 'auroc': 0.70738435, 'binary_precision': 0.8, 'binary_recall': 0.03305785, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.06349206}
confusion matrix:
      0  1
0  5995  2
1   234  8
oracle model performance metric: 

scalar performance:
{'acc': 0.9621734, 'precision': 0.8812169, 'recall': 0.5163622, 'specificity': 0.5163622, 'f1': 0.5220945, 'auroc': 0.70738435, 'binary_precision': 0.8, 'binary_recall': 0.03305785, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.06349206}
confusion matrix:
      0  1
0  5995  2
1   234  8
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204077 KiB | 632448 KiB |   1712 TiB |   1712 TiB |
|       from large pool | 167040 KiB | 559724 KiB |   1710 TiB |   1710 TiB |
|       from small pool |  37037 KiB |  75475 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204077 KiB | 632448 KiB |   1712 TiB |   1712 TiB |
|       from large pool | 167040 KiB | 559724 KiB |   1710 TiB |   1710 TiB |
|       from small pool |  37037 KiB |  75475 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 625043 KiB |   1689 TiB |   1689 TiB |
|       from large pool | 165120 KiB | 553452 KiB |   1687 TiB |   1687 TiB |
|       from small pool |  35967 KiB |  74337 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 778240 KiB | 778240 KiB |   1674 MiB |    914 MiB |
|       from large pool | 702464 KiB | 702464 KiB |   1548 MiB |    862 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    126 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  78546 KiB | 209453 KiB |   1156 TiB |   1156 TiB |
|       from large pool |  68480 KiB | 208064 KiB |   1153 TiB |   1153 TiB |
|       from small pool |  10066 KiB |  19715 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    7949    |  348180 K  |  348177 K  |
|       from large pool |      36    |      76    |  118398 K  |  118397 K  |
|       from small pool |    3204    |    7911    |  229782 K  |  229779 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    7949    |  348180 K  |  348177 K  |
|       from large pool |      36    |      76    |  118398 K  |  118397 K  |
|       from small pool |    3204    |    7911    |  229782 K  |  229779 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      53    |      90    |      37    |
|       from large pool |      16    |      16    |      27    |      11    |
|       from small pool |      37    |      37    |      63    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    3604    |  162115 K  |  162115 K  |
|       from large pool |       5    |      13    |   48940 K  |   48940 K  |
|       from small pool |      47    |    3599    |  113174 K  |  113174 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 632448 KiB |   1712 TiB |   1712 TiB |
|       from large pool |  16640 KiB | 559724 KiB |   1710 TiB |   1710 TiB |
|       from small pool |      0 KiB |  75475 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 632448 KiB |   1712 TiB |   1712 TiB |
|       from large pool |  16640 KiB | 559724 KiB |   1710 TiB |   1710 TiB |
|       from small pool |      0 KiB |  75475 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 625043 KiB |   1689 TiB |   1689 TiB |
|       from large pool |  16640 KiB | 553452 KiB |   1687 TiB |   1687 TiB |
|       from small pool |      0 KiB |  74337 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 282624 KiB | 778240 KiB |   1674 MiB |   1398 MiB |
|       from large pool | 235520 KiB | 702464 KiB |   1548 MiB |   1318 MiB |
|       from small pool |  47104 KiB |  75776 KiB |    126 MiB |     80 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB |   1156 TiB |   1156 TiB |
|       from large pool |  55040 KiB | 208064 KiB |   1153 TiB |   1153 TiB |
|       from small pool |      0 KiB |  19715 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7949    |  348180 K  |  348180 K  |
|       from large pool |       2    |      76    |  118398 K  |  118398 K  |
|       from small pool |       0    |    7911    |  229782 K  |  229782 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7949    |  348180 K  |  348180 K  |
|       from large pool |       2    |      76    |  118398 K  |  118398 K  |
|       from small pool |       0    |    7911    |  229782 K  |  229782 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      53    |      90    |      57    |
|       from large pool |      10    |      16    |      27    |      17    |
|       from small pool |      23    |      37    |      63    |      40    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3604    |  162116 K  |  162116 K  |
|       from large pool |       3    |      13    |   48940 K  |   48940 K  |
|       from small pool |       0    |    3599    |  113176 K  |  113176 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jun 25 04:56:29 2024]
Finished job 0.
1 of 1 steps (100%) done
