Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun 23 22:19:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886

 Experiment start at: 2024-06-23 22:25:03.240164
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.75752103, 'precision': 0.7973459, 'recall': 0.5347235, 'specificity': 0.5347235, 'f1': 0.4978239, 'auroc': 0.82555294, 'binary_precision': 0.83908045, 'binary_recall': 0.07440881, 'binary_specificity': 0.9950383, 'binary_f1_score': 0.13669558}
confusion matrix:
       0     1
0  42114   210
1  13621  1095
---- Validation: 
scalar performance:
{'acc': 0.9626437, 'precision': 0.49876052, 'recall': 0.49987468, 'specificity': 0.49987468, 'f1': 0.49331498, 'auroc': 0.4536572, 'binary_precision': 0.031746034, 'binary_recall': 0.00311042, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.005665723}
confusion matrix:
       0   1
0  18088  61
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.78954333, 'recall': 0.539146, 'specificity': 0.539146, 'f1': 0.56083536, 'auroc': 0.66897213, 'binary_precision': 0.61764705, 'binary_recall': 0.08045977, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.14237289}
confusion matrix:
      0   1
0  5984  13
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-23 22:43:39.058456,epoch time: 0:18:35.818292,used: 0:18:35.818292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.84002453, 'precision': 0.89245164, 'recall': 0.6955023, 'specificity': 0.6955023, 'f1': 0.7318073, 'auroc': 0.9217174, 'binary_precision': 0.9591133, 'binary_recall': 0.39688796, 'binary_specificity': 0.99411666, 'binary_f1_score': 0.5614457}
confusion matrix:
       0     1
0  42074   249
1   8876  5841
---- Validation: 
scalar performance:
{'acc': 0.95945084, 'precision': 0.51585394, 'recall': 0.5034721, 'specificity': 0.5034721, 'f1': 0.5011863, 'auroc': 0.54006696, 'binary_precision': 0.06569343, 'binary_recall': 0.01399689, 'binary_specificity': 0.9929473, 'binary_f1_score': 0.023076922}
confusion matrix:
       0    1
0  18021  128
1    634    9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7312218, 'recall': 0.6043596, 'specificity': 0.6043596, 'f1': 0.64080495, 'auroc': 0.71752083, 'binary_precision': 0.49565217, 'binary_recall': 0.21839081, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.3031915}
confusion matrix:
      0   1
0  5939  58
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_2.png
early stop counter: 1
val acc:0.9594508409500122, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 2,now: 2024-06-23 23:01:43.383884,epoch time: 0:18:04.325428,used: 0:36:40.143720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.88339764, 'precision': 0.90250766, 'recall': 0.78831136, 'specificity': 0.78831136, 'f1': 0.8248893, 'auroc': 0.9418825, 'binary_precision': 0.930946, 'binary_recall': 0.59188527, 'binary_specificity': 0.9847375, 'binary_f1_score': 0.72366947}
confusion matrix:
       0     1
0  41680   646
1   6005  8709
---- Validation: 
scalar performance:
{'acc': 0.94710517, 'precision': 0.5121148, 'recall': 0.50758135, 'specificity': 0.50758135, 'f1': 0.50851536, 'auroc': 0.6193904, 'binary_precision': 0.057934508, 'binary_recall': 0.035769828, 'binary_specificity': 0.9793928, 'binary_f1_score': 0.044230767}
confusion matrix:
       0    1
0  17775  374
1    620   23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95605624, 'precision': 0.71785915, 'recall': 0.6637428, 'specificity': 0.6637428, 'f1': 0.68640184, 'auroc': 0.76208955, 'binary_precision': 0.46391752, 'binary_recall': 0.3448276, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.3956044}
confusion matrix:
      0    1
0  5893  104
1   171   90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_3.png
early stop counter: 2
val acc:0.9471051692962646, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 3,now: 2024-06-23 23:20:03.404476,epoch time: 0:18:20.020592,used: 0:55:00.164312,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.90170056, 'precision': 0.9106159, 'recall': 0.8273343, 'specificity': 0.8273343, 'f1': 0.85815173, 'auroc': 0.95120525, 'binary_precision': 0.9248997, 'binary_recall': 0.67368853, 'binary_specificity': 0.98098004, 'binary_f1_score': 0.77955574}
confusion matrix:
       0     1
0  41519   805
1   4802  9914
---- Validation: 
scalar performance:
{'acc': 0.94077265, 'precision': 0.52683663, 'recall': 0.5238043, 'specificity': 0.5238043, 'f1': 0.52516264, 'auroc': 0.6740768, 'binary_precision': 0.086267605, 'binary_recall': 0.07620529, 'binary_specificity': 0.97140336, 'binary_f1_score': 0.08092485}
confusion matrix:
       0    1
0  17630  519
1    594   49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95206136, 'precision': 0.6986398, 'recall': 0.6928081, 'specificity': 0.6928081, 'f1': 0.69567335, 'auroc': 0.80713856, 'binary_precision': 0.4229249, 'binary_recall': 0.4099617, 'binary_specificity': 0.9756545, 'binary_f1_score': 0.41634244}
confusion matrix:
      0    1
0  5851  146
1   154  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_4.png
early stop counter: 3
val acc:0.9407726526260376, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 4,now: 2024-06-23 23:37:06.390105,epoch time: 0:17:02.985629,used: 1:12:03.149941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9085028, 'precision': 0.9106276, 'recall': 0.84449387, 'specificity': 0.84449387, 'f1': 0.8706479, 'auroc': 0.9546269, 'binary_precision': 0.91418105, 'binary_recall': 0.71223754, 'binary_specificity': 0.97675025, 'binary_f1_score': 0.8006722}
confusion matrix:
       0      1
0  41339    984
1   4235  10482
---- Validation: 
scalar performance:
{'acc': 0.93694127, 'precision': 0.53850013, 'recall': 0.54132223, 'specificity': 0.54132223, 'f1': 0.5398345, 'auroc': 0.65810716, 'binary_precision': 0.1083815, 'binary_recall': 0.11664075, 'binary_specificity': 0.96600366, 'binary_f1_score': 0.112359546}
confusion matrix:
       0    1
0  17532  617
1    568   75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9498242, 'precision': 0.6917745, 'recall': 0.70996416, 'specificity': 0.70996416, 'f1': 0.70038533, 'auroc': 0.77604, 'binary_precision': 0.4076655, 'binary_recall': 0.44827586, 'binary_specificity': 0.9716525, 'binary_f1_score': 0.4270073}
confusion matrix:
      0    1
0  5827  170
1   144  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_5.png
early stop counter: 4
val acc:0.9369412660598755, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 5,now: 2024-06-23 23:54:34.341206,epoch time: 0:17:27.951101,used: 1:29:31.101042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.92081, 'precision': 0.92080104, 'recall': 0.86780405, 'specificity': 0.86780405, 'f1': 0.88995063, 'auroc': 0.9642051, 'binary_precision': 0.92078555, 'binary_recall': 0.7582903, 'binary_specificity': 0.9773178, 'binary_f1_score': 0.83167505}
confusion matrix:
       0      1
0  41364    960
1   3557  11159
---- Validation: 
scalar performance:
{'acc': 0.93912303, 'precision': 0.54194856, 'recall': 0.54245174, 'specificity': 0.54245174, 'f1': 0.54219794, 'auroc': 0.6730263, 'binary_precision': 0.115207374, 'binary_recall': 0.11664075, 'binary_specificity': 0.96826273, 'binary_f1_score': 0.11591963}
confusion matrix:
       0    1
0  17573  576
1    568   75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9509428, 'precision': 0.69869936, 'recall': 0.71970946, 'specificity': 0.71970946, 'f1': 0.7085865, 'auroc': 0.8028671, 'binary_precision': 0.42068964, 'binary_recall': 0.46743295, 'binary_specificity': 0.971986, 'binary_f1_score': 0.44283122}
confusion matrix:
      0    1
0  5829  168
1   139  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_6.png
early stop counter: 5
val acc:0.9391230344772339, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 6,now: 2024-06-24 00:14:01.202971,epoch time: 0:19:26.861765,used: 1:48:57.962807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9203191, 'precision': 0.9034688, 'recall': 0.88476634, 'specificity': 0.88476634, 'f1': 0.8935219, 'auroc': 0.96336234, 'binary_precision': 0.8710242, 'binary_recall': 0.81130666, 'binary_specificity': 0.958226, 'binary_f1_score': 0.84010553}
confusion matrix:
       0      1
0  40555   1768
1   2777  11940
---- Validation: 
scalar performance:
{'acc': 0.9206045, 'precision': 0.55234253, 'recall': 0.59136873, 'specificity': 0.59136873, 'f1': 0.5642484, 'auroc': 0.72096753, 'binary_precision': 0.13246754, 'binary_recall': 0.23794712, 'binary_specificity': 0.94479036, 'binary_f1_score': 0.1701891}
confusion matrix:
       0     1
0  17147  1002
1    490   153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93767977, 'precision': 0.66486925, 'recall': 0.76226234, 'specificity': 0.76226234, 'f1': 0.70008343, 'auroc': 0.8412616, 'binary_precision': 0.34894612, 'binary_recall': 0.57088125, 'binary_specificity': 0.9536435, 'binary_f1_score': 0.43313953}
confusion matrix:
      0    1
0  5719  278
1   112  149
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_7.png
early stop counter: 6
val acc:0.9206045269966125, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 7,now: 2024-06-24 00:30:55.971191,epoch time: 0:16:54.768220,used: 2:05:52.731027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9271739, 'precision': 0.9266845, 'recall': 0.87925106, 'specificity': 0.87925106, 'f1': 0.8995248, 'auroc': 0.96923125, 'binary_precision': 0.92581844, 'binary_recall': 0.7802392, 'binary_specificity': 0.9782629, 'binary_f1_score': 0.8468176}
confusion matrix:
       0      1
0  41404    920
1   3234  11482
---- Validation: 
scalar performance:
{'acc': 0.9412516, 'precision': 0.55955523, 'recall': 0.560805, 'specificity': 0.560805, 'f1': 0.5601713, 'auroc': 0.71970916, 'binary_precision': 0.14916286, 'binary_recall': 0.15241058, 'binary_specificity': 0.9691994, 'binary_f1_score': 0.15076922}
confusion matrix:
       0    1
0  17590  559
1    545   98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95573664, 'precision': 0.72282946, 'recall': 0.7203784, 'specificity': 0.7203784, 'f1': 0.7215961, 'auroc': 0.8090974, 'binary_precision': 0.46899223, 'binary_recall': 0.46360153, 'binary_specificity': 0.97715527, 'binary_f1_score': 0.4662813}
confusion matrix:
      0    1
0  5860  137
1   140  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_8.png
early stop counter: 7
val acc:0.9412515759468079, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 8,now: 2024-06-24 00:47:48.869459,epoch time: 0:16:52.898268,used: 2:22:45.629295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92843616, 'precision': 0.9186348, 'recall': 0.8906332, 'specificity': 0.8906332, 'f1': 0.903378, 'auroc': 0.96430075, 'binary_precision': 0.9002937, 'binary_recall': 0.81254673, 'binary_specificity': 0.9687197, 'binary_f1_score': 0.85417265}
confusion matrix:
       0      1
0  41003   1324
1   2758  11955
---- Validation: 
scalar performance:
{'acc': 0.9298106, 'precision': 0.5554909, 'recall': 0.57963365, 'specificity': 0.57963365, 'f1': 0.56454104, 'auroc': 0.6839281, 'binary_precision': 0.13965885, 'binary_recall': 0.2037325, 'binary_specificity': 0.95553476, 'binary_f1_score': 0.1657179}
confusion matrix:
       0    1
0  17342  807
1    512  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93831897, 'precision': 0.66521573, 'recall': 0.75709885, 'specificity': 0.75709885, 'f1': 0.6990358, 'auroc': 0.8295975, 'binary_precision': 0.35011992, 'binary_recall': 0.55938697, 'binary_specificity': 0.95481074, 'binary_f1_score': 0.43067846}
confusion matrix:
      0    1
0  5726  271
1   115  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_9.png
early stop counter: 8
val acc:0.9298105835914612, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 9,now: 2024-06-24 01:04:53.571914,epoch time: 0:17:04.702455,used: 2:39:50.331750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.90958977, 'precision': 0.87552536, 'recall': 0.8969079, 'specificity': 0.8969079, 'f1': 0.88529015, 'auroc': 0.9624976, 'binary_precision': 0.7974983, 'binary_recall': 0.87070256, 'binary_specificity': 0.9231133, 'binary_f1_score': 0.83249426}
confusion matrix:
       0      1
0  39068   3254
1   1903  12815
---- Validation: 
scalar performance:
{'acc': 0.8839932, 'precision': 0.5502763, 'recall': 0.64742005, 'specificity': 0.64742005, 'f1': 0.5629582, 'auroc': 0.71869797, 'binary_precision': 0.12383749, 'binary_recall': 0.3934681, 'binary_specificity': 0.90137196, 'binary_f1_score': 0.1883842}
confusion matrix:
       0     1
0  16359  1790
1    390   253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89229786, 'precision': 0.61371905, 'recall': 0.81554186, 'specificity': 0.81554186, 'f1': 0.6514646, 'auroc': 0.8712632, 'binary_precision': 0.24025157, 'binary_recall': 0.7318008, 'binary_specificity': 0.899283, 'binary_f1_score': 0.36174244}
confusion matrix:
      0    1
0  5393  604
1    70  191
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_10.png
early stop counter: 9
val acc:0.8839932084083557, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 10,now: 2024-06-24 01:22:06.151377,epoch time: 0:17:12.579463,used: 2:57:02.911213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9327665, 'precision': 0.9246315, 'recall': 0.8963839, 'specificity': 0.8963839, 'f1': 0.909253, 'auroc': 0.9728635, 'binary_precision': 0.90939873, 'binary_recall': 0.82121503, 'binary_specificity': 0.9715528, 'binary_f1_score': 0.86306024}
confusion matrix:
       0      1
0  41120   1204
1   2631  12085
---- Validation: 
scalar performance:
{'acc': 0.93662196, 'precision': 0.5696851, 'recall': 0.5884104, 'specificity': 0.5884104, 'f1': 0.5775814, 'auroc': 0.72214586, 'binary_precision': 0.16747573, 'binary_recall': 0.21461898, 'binary_specificity': 0.9622018, 'binary_f1_score': 0.18813907}
confusion matrix:
       0    1
0  17463  686
1    505  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94167465, 'precision': 0.6728534, 'recall': 0.7515204, 'specificity': 0.7515204, 'f1': 0.7034194, 'auroc': 0.83934623, 'binary_precision': 0.36597937, 'binary_recall': 0.5440613, 'binary_specificity': 0.9589795, 'binary_f1_score': 0.4375963}
confusion matrix:
      0    1
0  5751  246
1   119  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_11.png
early stop counter: 10
val acc:0.9366219639778137, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 11,now: 2024-06-24 01:39:12.564801,epoch time: 0:17:06.413424,used: 3:14:09.324637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92107296, 'precision': 0.8989549, 'recall': 0.89362884, 'specificity': 0.89362884, 'f1': 0.8962418, 'auroc': 0.96408284, 'binary_precision': 0.85422015, 'binary_recall': 0.8369233, 'binary_specificity': 0.9503343, 'binary_f1_score': 0.84548324}
confusion matrix:
       0      1
0  40221   2102
1   2400  12317
---- Validation: 
scalar performance:
{'acc': 0.91597486, 'precision': 0.5583321, 'recall': 0.61447376, 'specificity': 0.61447376, 'f1': 0.5735925, 'auroc': 0.7243926, 'binary_precision': 0.14274809, 'binary_recall': 0.29082426, 'binary_specificity': 0.9381233, 'binary_f1_score': 0.19150026}
confusion matrix:
       0     1
0  17026  1123
1    456   187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9244167, 'precision': 0.6502199, 'recall': 0.8121446, 'specificity': 0.8121446, 'f1': 0.69584334, 'auroc': 0.8603561, 'binary_precision': 0.3146853, 'binary_recall': 0.6896552, 'binary_specificity': 0.934634, 'binary_f1_score': 0.43217286}
confusion matrix:
      0    1
0  5605  392
1    81  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_12.png
early stop counter: 11
val acc:0.9159748554229736, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 12,now: 2024-06-24 01:56:18.717407,epoch time: 0:17:06.152606,used: 3:31:15.477243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9366059, 'precision': 0.9211909, 'recall': 0.9116483, 'specificity': 0.9116483, 'f1': 0.9162712, 'auroc': 0.973235, 'binary_precision': 0.89046013, 'binary_recall': 0.86008424, 'binary_specificity': 0.9632124, 'binary_f1_score': 0.8750087}
confusion matrix:
       0      1
0  40767   1557
1   2059  12657
---- Validation: 
scalar performance:
{'acc': 0.92491484, 'precision': 0.56927687, 'recall': 0.6198522, 'specificity': 0.6198522, 'f1': 0.58549595, 'auroc': 0.72814703, 'binary_precision': 0.16433567, 'binary_recall': 0.29237947, 'binary_specificity': 0.94732493, 'binary_f1_score': 0.21040851}
confusion matrix:
       0    1
0  17193  956
1    455  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9341643, 'precision': 0.66522634, 'recall': 0.79890716, 'specificity': 0.79890716, 'f1': 0.7085528, 'auroc': 0.8647249, 'binary_precision': 0.34623218, 'binary_recall': 0.651341, 'binary_specificity': 0.94647324, 'binary_f1_score': 0.45212767}
confusion matrix:
      0    1
0  5676  321
1    91  170
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_13.png
early stop counter: 12
val acc:0.9249148368835449, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 13,now: 2024-06-24 02:13:29.931434,epoch time: 0:17:11.214027,used: 3:48:26.691270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92028403, 'precision': 0.8866968, 'recall': 0.9167158, 'specificity': 0.9167158, 'f1': 0.8999177, 'auroc': 0.9729768, 'binary_precision': 0.8063758, 'binary_recall': 0.9093442, 'binary_specificity': 0.9240874, 'binary_f1_score': 0.8547702}
confusion matrix:
       0      1
0  39112   3213
1   1334  13381
---- Validation: 
scalar performance:
{'acc': 0.9062367, 'precision': 0.57277703, 'recall': 0.6791873, 'specificity': 0.6791873, 'f1': 0.59560126, 'auroc': 0.7613187, 'binary_precision': 0.16676593, 'binary_recall': 0.43545878, 'binary_specificity': 0.9229159, 'binary_f1_score': 0.24117139}
confusion matrix:
       0     1
0  16750  1399
1    363   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9036433, 'precision': 0.62843984, 'recall': 0.8342878, 'specificity': 0.8342878, 'f1': 0.6720195, 'auroc': 0.8850057, 'binary_precision': 0.2682927, 'binary_recall': 0.7586207, 'binary_specificity': 0.90995497, 'binary_f1_score': 0.3963964}
confusion matrix:
      0    1
0  5457  540
1    63  198
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_14.png
early stop counter: 13
val acc:0.9062367081642151, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 14,now: 2024-06-24 02:30:50.046467,epoch time: 0:17:20.115033,used: 4:05:46.806303,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9443373, 'precision': 0.93211615, 'recall': 0.9210366, 'specificity': 0.9210366, 'f1': 0.9263834, 'auroc': 0.9783373, 'binary_precision': 0.90785754, 'binary_recall': 0.8728854, 'binary_specificity': 0.96918786, 'binary_f1_score': 0.8900281}
confusion matrix:
       0      1
0  41017   1304
1   1871  12848
---- Validation: 
scalar performance:
{'acc': 0.9320456, 'precision': 0.58957416, 'recall': 0.64529544, 'specificity': 0.64529544, 'f1': 0.6090275, 'auroc': 0.7680615, 'binary_precision': 0.20318352, 'binary_recall': 0.33748055, 'binary_specificity': 0.95311034, 'binary_f1_score': 0.25365284}
confusion matrix:
       0    1
0  17298  851
1    426  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94135505, 'precision': 0.6864676, 'recall': 0.82281464, 'specificity': 0.82281464, 'f1': 0.7327173, 'auroc': 0.87902856, 'binary_precision': 0.38675213, 'binary_recall': 0.6934866, 'binary_specificity': 0.9521427, 'binary_f1_score': 0.49657062}
confusion matrix:
      0    1
0  5710  287
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_15.png
early stop counter: 14
val acc:0.932045578956604, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 15,now: 2024-06-24 02:48:01.653275,epoch time: 0:17:11.606808,used: 4:22:58.413111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9500526, 'precision': 0.9439135, 'recall': 0.923887, 'specificity': 0.923887, 'f1': 0.9332989, 'auroc': 0.98241717, 'binary_precision': 0.9320713, 'binary_recall': 0.8698193, 'binary_specificity': 0.97795475, 'binary_f1_score': 0.89987}
confusion matrix:
       0      1
0  41389    933
1   1916  12802
---- Validation: 
scalar performance:
{'acc': 0.9420498, 'precision': 0.6094929, 'recall': 0.64597446, 'specificity': 0.64597446, 'f1': 0.6245482, 'auroc': 0.78919816, 'binary_precision': 0.24308756, 'binary_recall': 0.3281493, 'binary_specificity': 0.96379966, 'binary_f1_score': 0.27928522}
confusion matrix:
       0    1
0  17492  657
1    432  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7407656, 'recall': 0.7766824, 'specificity': 0.7766824, 'f1': 0.7572882, 'auroc': 0.86136615, 'binary_precision': 0.5, 'binary_recall': 0.5785441, 'binary_specificity': 0.97482073, 'binary_f1_score': 0.53641206}
confusion matrix:
      0    1
0  5846  151
1   110  151
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_16.png
early stop counter: 15
val acc:0.9420498013496399, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 16,now: 2024-06-24 03:04:59.885493,epoch time: 0:16:58.232218,used: 4:39:56.645329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.93946356, 'precision': 0.91827214, 'recall': 0.9250574, 'specificity': 0.9250574, 'f1': 0.921587, 'auroc': 0.9767262, 'binary_precision': 0.87327677, 'binary_recall': 0.89529115, 'binary_specificity': 0.9548236, 'binary_f1_score': 0.884147}
confusion matrix:
       0      1
0  40411   1912
1   1541  13176
---- Validation: 
scalar performance:
{'acc': 0.92826736, 'precision': 0.5861332, 'recall': 0.65084, 'specificity': 0.65084, 'f1': 0.6071348, 'auroc': 0.7574748, 'binary_precision': 0.1958585, 'binary_recall': 0.35303265, 'binary_specificity': 0.9486473, 'binary_f1_score': 0.25194228}
confusion matrix:
       0    1
0  17217  932
1    416  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9343241, 'precision': 0.66942465, 'recall': 0.81731385, 'specificity': 0.81731385, 'f1': 0.7159662, 'auroc': 0.8715054, 'binary_precision': 0.3529412, 'binary_recall': 0.6896552, 'binary_specificity': 0.9449725, 'binary_f1_score': 0.46692607}
confusion matrix:
      0    1
0  5667  330
1    81  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_17.png
early stop counter: 16
val acc:0.9282673597335815, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 17,now: 2024-06-24 03:22:02.225940,epoch time: 0:17:02.340447,used: 4:56:58.985776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9224053, 'precision': 0.89086664, 'recall': 0.91491425, 'specificity': 0.91491425, 'f1': 0.9017769, 'auroc': 0.9712855, 'binary_precision': 0.8179571, 'binary_recall': 0.899436, 'binary_specificity': 0.93039244, 'binary_f1_score': 0.8567637}
confusion matrix:
       0      1
0  39377   2946
1   1480  13237
---- Validation: 
scalar performance:
{'acc': 0.90751386, 'precision': 0.57955223, 'recall': 0.6985999, 'specificity': 0.6985999, 'f1': 0.6052355, 'auroc': 0.76047826, 'binary_precision': 0.17888562, 'binary_recall': 0.47433904, 'binary_specificity': 0.92286074, 'binary_f1_score': 0.25979558}
confusion matrix:
       0     1
0  16749  1400
1    338   305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9046021, 'precision': 0.6299467, 'recall': 0.83662045, 'specificity': 0.83662045, 'f1': 0.6740908, 'auroc': 0.89636326, 'binary_precision': 0.27111718, 'binary_recall': 0.7624521, 'binary_specificity': 0.9107887, 'binary_f1_score': 0.4}
confusion matrix:
      0    1
0  5462  535
1    62  199
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_18.png
early stop counter: 17
val acc:0.9075138568878174, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 18,now: 2024-06-24 03:39:02.128256,epoch time: 0:16:59.902316,used: 5:13:58.888092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.94179523, 'precision': 0.9201397, 'recall': 0.9299279, 'specificity': 0.9299279, 'f1': 0.92487204, 'auroc': 0.9795655, 'binary_precision': 0.87359035, 'binary_recall': 0.9054091, 'binary_specificity': 0.9544467, 'binary_f1_score': 0.88921523}
confusion matrix:
       0      1
0  40396   1928
1   1392  13324
---- Validation: 
scalar performance:
{'acc': 0.9289059, 'precision': 0.5983559, 'recall': 0.68192285, 'specificity': 0.68192285, 'f1': 0.6244572, 'auroc': 0.7922002, 'binary_precision': 0.21806346, 'binary_recall': 0.41679627, 'binary_specificity': 0.94704944, 'binary_f1_score': 0.28632477}
confusion matrix:
       0    1
0  17188  961
1    375  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9346437, 'precision': 0.67302376, 'recall': 0.83213925, 'specificity': 0.83213925, 'f1': 0.722058, 'auroc': 0.885329, 'binary_precision': 0.35877863, 'binary_recall': 0.7203065, 'binary_specificity': 0.943972, 'binary_f1_score': 0.4789809}
confusion matrix:
      0    1
0  5661  336
1    73  188
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_19.png
early stop counter: 18
val acc:0.9289059042930603, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 19,now: 2024-06-24 03:56:08.463458,epoch time: 0:17:06.335202,used: 5:31:05.223294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.94857997, 'precision': 0.93349254, 'recall': 0.93197006, 'specificity': 0.93197006, 'f1': 0.93272763, 'auroc': 0.98108983, 'binary_precision': 0.9025007, 'binary_recall': 0.8976554, 'binary_specificity': 0.9662847, 'binary_f1_score': 0.90007156}
confusion matrix:
       0      1
0  40898   1427
1   1506  13209
---- Validation: 
scalar performance:
{'acc': 0.9331098, 'precision': 0.5997096, 'recall': 0.666848, 'specificity': 0.666848, 'f1': 0.6227027, 'auroc': 0.77864397, 'binary_precision': 0.2219203, 'binary_recall': 0.38102645, 'binary_specificity': 0.95266956, 'binary_f1_score': 0.28048083}
confusion matrix:
       0    1
0  17290  859
1    398  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9434324, 'precision': 0.69012225, 'recall': 0.81290454, 'specificity': 0.81290454, 'f1': 0.7335948, 'auroc': 0.8698839, 'binary_precision': 0.39503387, 'binary_recall': 0.6704981, 'binary_specificity': 0.955311, 'binary_f1_score': 0.4971591}
confusion matrix:
      0    1
0  5729  268
1    86  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_20.png
early stop counter: 19
val acc:0.9331098198890686, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 20,now: 2024-06-24 04:13:14.260804,epoch time: 0:17:05.797346,used: 5:48:11.020640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.93907785, 'precision': 0.91774774, 'recall': 0.9245637, 'specificity': 0.9245637, 'f1': 0.92107713, 'auroc': 0.976843, 'binary_precision': 0.87246454, 'binary_recall': 0.89458305, 'binary_specificity': 0.95454437, 'binary_f1_score': 0.88338536}
confusion matrix:
       0      1
0  40403   1924
1   1551  13162
---- Validation: 
scalar performance:
{'acc': 0.9322052, 'precision': 0.59403336, 'recall': 0.6558789, 'specificity': 0.6558789, 'f1': 0.61529505, 'auroc': 0.7455069, 'binary_precision': 0.21134493, 'binary_recall': 0.3592535, 'binary_specificity': 0.9525043, 'binary_f1_score': 0.26612902}
confusion matrix:
       0    1
0  17287  862
1    412  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9352828, 'precision': 0.6747583, 'recall': 0.83430505, 'specificity': 0.83430505, 'f1': 0.72412026, 'auroc': 0.884301, 'binary_precision': 0.36206895, 'binary_recall': 0.7241379, 'binary_specificity': 0.94447225, 'binary_f1_score': 0.48275855}
confusion matrix:
      0    1
0  5664  333
1    72  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_21.png
early stop counter: 20
val acc:0.9322052001953125, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 21,now: 2024-06-24 04:30:24.931565,epoch time: 0:17:10.670761,used: 6:05:21.691401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9472651, 'precision': 0.9326841, 'recall': 0.92905474, 'specificity': 0.92905474, 'f1': 0.9308485, 'auroc': 0.9799205, 'binary_precision': 0.9029594, 'binary_recall': 0.8914255, 'binary_specificity': 0.966684, 'binary_f1_score': 0.89715534}
confusion matrix:
       0      1
0  40912   1410
1   1598  13120
---- Validation: 
scalar performance:
{'acc': 0.9335356, 'precision': 0.5994003, 'recall': 0.66406816, 'specificity': 0.66406816, 'f1': 0.6218075, 'auroc': 0.7695261, 'binary_precision': 0.22150736, 'binary_recall': 0.3748056, 'binary_specificity': 0.95333076, 'binary_f1_score': 0.27845177}
confusion matrix:
       0    1
0  17302  847
1    402  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9400767, 'precision': 0.68320805, 'recall': 0.82214767, 'specificity': 0.82214767, 'f1': 0.7296721, 'auroc': 0.86733794, 'binary_precision': 0.3802521, 'binary_recall': 0.6934866, 'binary_specificity': 0.95080876, 'binary_f1_score': 0.49118042}
confusion matrix:
      0    1
0  5702  295
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_22.png
early stop counter: 21
val acc:0.9335355758666992, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 22,now: 2024-06-24 04:47:22.803879,epoch time: 0:16:57.872314,used: 6:22:19.563715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.94465286, 'precision': 0.9249264, 'recall': 0.9318562, 'specificity': 0.9318562, 'f1': 0.9283118, 'auroc': 0.9794854, 'binary_precision': 0.8830351, 'binary_recall': 0.90541553, 'binary_specificity': 0.9582969, 'binary_f1_score': 0.8940852}
confusion matrix:
       0      1
0  40558   1765
1   1392  13325
---- Validation: 
scalar performance:
{'acc': 0.9350255, 'precision': 0.6075742, 'recall': 0.6790906, 'specificity': 0.6790906, 'f1': 0.6323068, 'auroc': 0.77429056, 'binary_precision': 0.23679417, 'binary_recall': 0.4043546, 'binary_specificity': 0.95382667, 'binary_f1_score': 0.2986789}
confusion matrix:
       0    1
0  17311  838
1    383  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94566953, 'precision': 0.6997507, 'recall': 0.83422744, 'specificity': 0.83422744, 'f1': 0.74683404, 'auroc': 0.87988055, 'binary_precision': 0.41241685, 'binary_recall': 0.7126437, 'binary_specificity': 0.95581126, 'binary_f1_score': 0.5224719}
confusion matrix:
      0    1
0  5732  265
1    75  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_23.png
early stop counter: 22
val acc:0.9350255131721497, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 23,now: 2024-06-24 05:04:24.614484,epoch time: 0:17:01.810605,used: 6:39:21.374320,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9517356, 'precision': 0.93823117, 'recall': 0.93532157, 'specificity': 0.93532157, 'f1': 0.93676317, 'auroc': 0.9833606, 'binary_precision': 0.91062605, 'binary_recall': 0.9014065, 'binary_specificity': 0.9692366, 'binary_f1_score': 0.90599287}
confusion matrix:
       0      1
0  41021   1302
1   1451  13266
---- Validation: 
scalar performance:
{'acc': 0.9339613, 'precision': 0.6005087, 'recall': 0.66503865, 'specificity': 0.66503865, 'f1': 0.62298596, 'auroc': 0.76850426, 'binary_precision': 0.22365989, 'binary_recall': 0.3763608, 'binary_specificity': 0.95371646, 'binary_f1_score': 0.28057972}
confusion matrix:
       0    1
0  17309  840
1    401  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949984, 'precision': 0.7124529, 'recall': 0.8328139, 'specificity': 0.8328139, 'f1': 0.7569674, 'auroc': 0.8889483, 'binary_precision': 0.43809524, 'binary_recall': 0.70498085, 'binary_specificity': 0.960647, 'binary_f1_score': 0.54038185}
confusion matrix:
      0    1
0  5761  236
1    77  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_24.png
early stop counter: 23
val acc:0.9339612722396851, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 24,now: 2024-06-24 05:21:39.396144,epoch time: 0:17:14.781660,used: 6:56:36.155980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9510694, 'precision': 0.9461766, 'recall': 0.92430633, 'specificity': 0.92430633, 'f1': 0.9345306, 'auroc': 0.9800269, 'binary_precision': 0.93679047, 'binary_recall': 0.86900395, 'binary_specificity': 0.9796087, 'binary_f1_score': 0.9016249}
confusion matrix:
       0      1
0  41459    863
1   1928  12790
---- Validation: 
scalar performance:
{'acc': 0.94646657, 'precision': 0.61775404, 'recall': 0.63776034, 'specificity': 0.63776034, 'f1': 0.6268131, 'auroc': 0.7644125, 'binary_precision': 0.26023778, 'binary_recall': 0.30637637, 'binary_specificity': 0.9691443, 'binary_f1_score': 0.28142858}
confusion matrix:
       0    1
0  17589  560
1    446  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.742267, 'recall': 0.82607204, 'specificity': 0.82607204, 'f1': 0.7770156, 'auroc': 0.8772119, 'binary_precision': 0.49859944, 'binary_recall': 0.68199235, 'binary_specificity': 0.9701517, 'binary_f1_score': 0.5760518}
confusion matrix:
      0    1
0  5818  179
1    83  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_25.png
early stop counter: 24
val acc:0.9464665651321411, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 25,now: 2024-06-24 05:38:40.180983,epoch time: 0:17:00.784839,used: 7:13:36.940819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.93518585, 'precision': 0.905347, 'recall': 0.9346763, 'specificity': 0.9346763, 'f1': 0.9184189, 'auroc': 0.9813229, 'binary_precision': 0.834771, 'binary_recall': 0.9336232, 'binary_specificity': 0.9357293, 'binary_f1_score': 0.88143414}
confusion matrix:
       0      1
0  39601   2720
1    977  13742
---- Validation: 
scalar performance:
{'acc': 0.91373986, 'precision': 0.5896984, 'recall': 0.7138241, 'specificity': 0.7138241, 'f1': 0.6189004, 'auroc': 0.7820239, 'binary_precision': 0.19814815, 'binary_recall': 0.4992224, 'binary_specificity': 0.9284258, 'binary_f1_score': 0.28369424}
confusion matrix:
       0     1
0  16850  1299
1    322   321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92217964, 'precision': 0.6528137, 'recall': 0.84029466, 'specificity': 0.84029466, 'f1': 0.70205605, 'auroc': 0.8911333, 'binary_precision': 0.3171521, 'binary_recall': 0.75095785, 'binary_specificity': 0.9296315, 'binary_f1_score': 0.44596133}
confusion matrix:
      0    1
0  5575  422
1    65  196
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_26.png
early stop counter: 25
val acc:0.9137398600578308, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 26,now: 2024-06-24 05:55:40.676010,epoch time: 0:17:00.495027,used: 7:30:37.435846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9436536, 'precision': 0.9269006, 'recall': 0.9257246, 'specificity': 0.9257246, 'f1': 0.9263104, 'auroc': 0.9777745, 'binary_precision': 0.8924452, 'binary_recall': 0.888685, 'binary_specificity': 0.9627643, 'binary_f1_score': 0.89056116}
confusion matrix:
       0      1
0  40749   1576
1   1638  13077
---- Validation: 
scalar performance:
{'acc': 0.9390166, 'precision': 0.61047316, 'recall': 0.6654057, 'specificity': 0.6654057, 'f1': 0.63123316, 'auroc': 0.7693626, 'binary_precision': 0.24362895, 'binary_recall': 0.3716952, 'binary_specificity': 0.9591162, 'binary_f1_score': 0.29433498}
confusion matrix:
       0    1
0  17407  742
1    404  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9534995, 'precision': 0.72476315, 'recall': 0.8364805, 'specificity': 0.8364805, 'f1': 0.76760566, 'auroc': 0.8833734, 'binary_precision': 0.4625, 'binary_recall': 0.70881224, 'binary_specificity': 0.96414876, 'binary_f1_score': 0.55975795}
confusion matrix:
      0    1
0  5782  215
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_27.png
early stop counter: 26
val acc:0.939016580581665, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 27,now: 2024-06-24 06:12:40.327270,epoch time: 0:16:59.651260,used: 7:47:37.087106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.953892, 'precision': 0.9462495, 'recall': 0.93201375, 'specificity': 0.93201375, 'f1': 0.9388276, 'auroc': 0.9844532, 'binary_precision': 0.9312215, 'binary_recall': 0.8868053, 'binary_specificity': 0.97722226, 'binary_f1_score': 0.90847087}
confusion matrix:
       0      1
0  41358    964
1   1666  13052
---- Validation: 
scalar performance:
{'acc': 0.94242233, 'precision': 0.6187272, 'recall': 0.6664188, 'specificity': 0.6664188, 'f1': 0.637743, 'auroc': 0.7676902, 'binary_precision': 0.26010928, 'binary_recall': 0.37013996, 'binary_specificity': 0.9626977, 'binary_f1_score': 0.30551988}
confusion matrix:
       0    1
0  17472  677
1    405  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95317996, 'precision': 0.7232442, 'recall': 0.8326491, 'specificity': 0.8326491, 'f1': 0.76533794, 'auroc': 0.88200104, 'binary_precision': 0.459799, 'binary_recall': 0.7011494, 'binary_specificity': 0.96414876, 'binary_f1_score': 0.55538696}
confusion matrix:
      0    1
0  5782  215
1    78  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_28.png
early stop counter: 27
val acc:0.9424223303794861, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 28,now: 2024-06-24 06:29:54.571312,epoch time: 0:17:14.244042,used: 8:04:51.331148,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9527875, 'precision': 0.9400804, 'recall': 0.9360909, 'specificity': 0.9360909, 'f1': 0.938061, 'auroc': 0.98296666, 'binary_precision': 0.91420895, 'binary_recall': 0.901597, 'binary_specificity': 0.97058475, 'binary_f1_score': 0.9078592}
confusion matrix:
       0      1
0  41080   1245
1   1448  13267
---- Validation: 
scalar performance:
{'acc': 0.9411452, 'precision': 0.6212283, 'recall': 0.6815088, 'specificity': 0.6815088, 'f1': 0.6441046, 'auroc': 0.78450316, 'binary_precision': 0.2640163, 'binary_recall': 0.40279937, 'binary_specificity': 0.9602182, 'binary_f1_score': 0.31896552}
confusion matrix:
       0    1
0  17427  722
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.950783, 'precision': 0.7155347, 'recall': 0.83689547, 'specificity': 0.83689547, 'f1': 0.7605183, 'auroc': 0.88904417, 'binary_precision': 0.4439141, 'binary_recall': 0.7126437, 'binary_specificity': 0.96114725, 'binary_f1_score': 0.5470588}
confusion matrix:
      0    1
0  5764  233
1    75  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_29.png
early stop counter: 28
val acc:0.9411451816558838, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 29,now: 2024-06-24 06:46:50.982354,epoch time: 0:16:56.411042,used: 8:21:47.742190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9578366, 'precision': 0.9473423, 'recall': 0.9419563, 'specificity': 0.9419563, 'f1': 0.94460535, 'auroc': 0.9849852, 'binary_precision': 0.9260746, 'binary_recall': 0.9091465, 'binary_specificity': 0.9747661, 'binary_f1_score': 0.9175325}
confusion matrix:
       0      1
0  41256   1068
1   1337  13379
---- Validation: 
scalar performance:
{'acc': 0.93992126, 'precision': 0.620043, 'recall': 0.6861255, 'specificity': 0.6861255, 'f1': 0.6444303, 'auroc': 0.7899193, 'binary_precision': 0.26129666, 'binary_recall': 0.41368586, 'binary_specificity': 0.95856524, 'binary_f1_score': 0.32028896}
confusion matrix:
       0    1
0  17397  752
1    377  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7436739, 'recall': 0.8262388, 'specificity': 0.8262388, 'f1': 0.7780366, 'auroc': 0.87250525, 'binary_precision': 0.50140846, 'binary_recall': 0.68199235, 'binary_specificity': 0.97048527, 'binary_f1_score': 0.57792205}
confusion matrix:
      0    1
0  5820  177
1    83  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_30.png
early stop counter: 29
val acc:0.9399212598800659, best validation acc: 0.9626436829566956, corresponding to test acc:                         0.9595717191696167 / 0.9595717191696167
after epoch: 30,now: 2024-06-24 07:03:47.902491,epoch time: 0:16:56.920137,used: 8:38:44.662327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_22_25_03_seed_0_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 8:38:44.662327 at 2024-06-24 07:03:47.902491
persisted model performance metric: 

scalar performance:
{'acc': 0.9595717, 'precision': 0.78954333, 'recall': 0.539146, 'specificity': 0.539146, 'f1': 0.56083536, 'auroc': 0.66897213, 'binary_precision': 0.61764705, 'binary_recall': 0.08045977, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.14237289}
confusion matrix:
      0   1
0  5984  13
1   240  21
oracle model performance metric: 

scalar performance:
{'acc': 0.9595717, 'precision': 0.78954333, 'recall': 0.539146, 'specificity': 0.539146, 'f1': 0.56083536, 'auroc': 0.66897213, 'binary_precision': 0.61764705, 'binary_recall': 0.08045977, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.14237289}
confusion matrix:
      0   1
0  5984  13
1   240  21
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 571737 KiB | 583697 GiB | 583697 GiB |
|       from large pool | 167936 KiB | 499008 KiB | 582869 GiB | 582869 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    827 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 571737 KiB | 583697 GiB | 583697 GiB |
|       from large pool | 167936 KiB | 499008 KiB | 582869 GiB | 582869 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    827 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 563304 KiB | 577993 GiB | 577993 GiB |
|       from large pool | 165120 KiB | 491712 KiB | 577189 GiB | 577189 GiB |
|       from small pool |  35968 KiB |  74337 KiB |    804 GiB |    804 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 727040 KiB | 727040 KiB | 727040 KiB |      0 B   |
|       from large pool | 651264 KiB | 651264 KiB | 651264 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  79692 KiB | 209453 KiB | 393240 GiB | 393240 GiB |
|       from large pool |  67584 KiB | 208064 KiB | 392353 GiB | 392353 GiB |
|       from small pool |  12108 KiB |  13958 KiB |    886 GiB |    886 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    7899    |  116255 K  |  116252 K  |
|       from large pool |      36    |      76    |   39550 K  |   39550 K  |
|       from small pool |    3216    |    7861    |   76705 K  |   76702 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    7899    |  116255 K  |  116252 K  |
|       from large pool |      36    |      76    |   39550 K  |   39550 K  |
|       from small pool |    3216    |    7861    |   76705 K  |   76702 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      52    |      52    |      52    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    3580    |   52701 K  |   52701 K  |
|       from large pool |       7    |      10    |   15024 K  |   15024 K  |
|       from small pool |      46    |    3574    |   37677 K  |   37677 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB | 583697 GiB | 583697 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 582869 GiB | 582869 GiB |
|       from small pool |      0 KiB |  75475 KiB |    827 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB | 583697 GiB | 583697 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 582869 GiB | 582869 GiB |
|       from small pool |      0 KiB |  75475 KiB |    827 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 577993 GiB | 577993 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 577189 GiB | 577189 GiB |
|       from small pool |      0 KiB |  74337 KiB |    804 GiB |    804 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 727040 KiB | 727040 KiB | 442368 KiB |
|       from large pool | 235520 KiB | 651264 KiB | 651264 KiB | 415744 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB | 393240 GiB | 393240 GiB |
|       from large pool |  55040 KiB | 208064 KiB | 392353 GiB | 392353 GiB |
|       from small pool |      0 KiB |  19703 KiB |    886 GiB |    886 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7899    |  116255 K  |  116255 K  |
|       from large pool |       2    |      76    |   39550 K  |   39550 K  |
|       from small pool |       0    |    7861    |   76705 K  |   76705 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7899    |  116255 K  |  116255 K  |
|       from large pool |       2    |      76    |   39550 K  |   39550 K  |
|       from small pool |       0    |    7861    |   76705 K  |   76705 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      52    |      52    |      18    |
|       from large pool |      10    |      15    |      15    |       5    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3580    |   52703 K  |   52703 K  |
|       from large pool |       3    |      13    |   15024 K  |   15024 K  |
|       from small pool |       0    |    3574    |   37678 K  |   37678 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB | 583697 GiB | 583697 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 582869 GiB | 582869 GiB |
|       from small pool |      0 KiB |  75475 KiB |    827 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB | 583697 GiB | 583697 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 582869 GiB | 582869 GiB |
|       from small pool |      0 KiB |  75475 KiB |    827 GiB |    827 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 577993 GiB | 577993 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 577189 GiB | 577189 GiB |
|       from small pool |      0 KiB |  74337 KiB |    804 GiB |    804 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 727040 KiB | 727040 KiB | 442368 KiB |
|       from large pool | 235520 KiB | 651264 KiB | 651264 KiB | 415744 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB | 393240 GiB | 393240 GiB |
|       from large pool |  55040 KiB | 208064 KiB | 392353 GiB | 392353 GiB |
|       from small pool |      0 KiB |  19703 KiB |    886 GiB |    886 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7899    |  116255 K  |  116255 K  |
|       from large pool |       2    |      76    |   39550 K  |   39550 K  |
|       from small pool |       0    |    7861    |   76705 K  |   76705 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7899    |  116255 K  |  116255 K  |
|       from large pool |       2    |      76    |   39550 K  |   39550 K  |
|       from small pool |       0    |    7861    |   76705 K  |   76705 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      52    |      52    |      18    |
|       from large pool |      10    |      15    |      15    |       5    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3580    |   52703 K  |   52703 K  |
|       from large pool |       3    |      13    |   15024 K  |   15024 K  |
|       from small pool |       0    |    3574    |   37678 K  |   37678 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886

 Experiment start at: 2024-06-24 07:10:57.006334
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.75265694, 'precision': 0.7883142, 'recall': 0.5148294, 'specificity': 0.5148294, 'f1': 0.45955485, 'auroc': 0.7665762, 'binary_precision': 0.82468694, 'binary_recall': 0.031969488, 'binary_specificity': 0.9976893, 'binary_f1_score': 0.06155284}
confusion matrix:
       0    1
0  42314   98
1  13959  461
---- Validation: 
scalar performance:
{'acc': 0.96120596, 'precision': 0.48199186, 'recall': 0.49850556, 'specificity': 0.49850556, 'f1': 0.49010965, 'auroc': 0.36127013, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9970111, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18013  54
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.47902888, 'recall': 0.49941137, 'specificity': 0.49941137, 'f1': 0.4890078, 'auroc': 0.32724082, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5939  7
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-24 07:28:01.306100,epoch time: 0:17:04.299766,used: 0:17:04.299766,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8298142, 'precision': 0.8814695, 'recall': 0.6713153, 'specificity': 0.6713153, 'f1': 0.703669, 'auroc': 0.8868292, 'binary_precision': 0.94505906, 'binary_recall': 0.3495388, 'binary_specificity': 0.99309176, 'binary_f1_score': 0.51032805}
confusion matrix:
       0     1
0  42120   293
1   9379  5040
---- Validation: 
scalar performance:
{'acc': 0.9590182, 'precision': 0.48713177, 'recall': 0.49808615, 'specificity': 0.49808615, 'f1': 0.49083832, 'auroc': 0.47667807, 'binary_precision': 0.010309278, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.0025974025}
confusion matrix:
       0   1
0  17971  96
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.60418683, 'recall': 0.5033416, 'specificity': 0.5033416, 'f1': 0.49659312, 'auroc': 0.5870593, 'binary_precision': 0.25, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.014925373}
confusion matrix:
      0  1
0  5940  6
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_2.png
new oracle model saved
early stop counter: 1
val acc:0.9590181708335876, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 2,now: 2024-06-24 07:44:46.566769,epoch time: 0:16:45.260669,used: 0:33:49.560435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8832876, 'precision': 0.8779074, 'recall': 0.80150723, 'specificity': 0.80150723, 'f1': 0.8297341, 'auroc': 0.924855, 'binary_precision': 0.86935484, 'binary_recall': 0.63548094, 'binary_specificity': 0.9675335, 'binary_f1_score': 0.7342441}
confusion matrix:
       0     1
0  41036  1377
1   5256  9163
---- Validation: 
scalar performance:
{'acc': 0.91664886, 'precision': 0.5003077, 'recall': 0.5004315, 'specificity': 0.5004315, 'f1': 0.49965963, 'auroc': 0.60090834, 'binary_precision': 0.03649635, 'binary_recall': 0.052005943, 'binary_specificity': 0.948857, 'binary_f1_score': 0.042892158}
confusion matrix:
       0    1
0  17143  924
1    638   35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9326458, 'precision': 0.63263375, 'recall': 0.6890023, 'specificity': 0.6890023, 'f1': 0.6546628, 'auroc': 0.78597486, 'binary_precision': 0.29100528, 'binary_recall': 0.42307693, 'binary_specificity': 0.9549277, 'binary_f1_score': 0.34482756}
confusion matrix:
      0    1
0  5678  268
1   150  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_3.png
early stop counter: 2
val acc:0.9166488647460938, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 3,now: 2024-06-24 08:01:32.645390,epoch time: 0:16:46.078621,used: 0:50:35.639056,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9026077, 'precision': 0.8933838, 'recall': 0.8409916, 'specificity': 0.8409916, 'f1': 0.86265147, 'auroc': 0.9439137, 'binary_precision': 0.87764645, 'binary_recall': 0.7159107, 'binary_specificity': 0.9660725, 'binary_f1_score': 0.788571}
confusion matrix:
       0      1
0  40975   1439
1   4096  10322
---- Validation: 
scalar performance:
{'acc': 0.916222, 'precision': 0.5167202, 'recall': 0.5252444, 'specificity': 0.5252444, 'f1': 0.5189899, 'auroc': 0.6238104, 'binary_precision': 0.06750241, 'binary_recall': 0.104011886, 'binary_specificity': 0.946477, 'binary_f1_score': 0.08187134}
confusion matrix:
       0    1
0  17100  967
1    603   70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93361264, 'precision': 0.63685936, 'recall': 0.6950238, 'specificity': 0.6950238, 'f1': 0.6596198, 'auroc': 0.7957612, 'binary_precision': 0.2989418, 'binary_recall': 0.43461537, 'binary_specificity': 0.95543224, 'binary_f1_score': 0.35423198}
confusion matrix:
      0    1
0  5681  265
1   147  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_4.png
early stop counter: 3
val acc:0.9162219762802124, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 4,now: 2024-06-24 08:18:32.145235,epoch time: 0:16:59.499845,used: 1:07:35.138901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9107369, 'precision': 0.89814866, 'recall': 0.85944766, 'specificity': 0.85944766, 'f1': 0.87632895, 'auroc': 0.9529445, 'binary_precision': 0.8757639, 'binary_recall': 0.7553228, 'binary_specificity': 0.9635725, 'binary_f1_score': 0.81109655}
confusion matrix:
       0      1
0  40868   1545
1   3528  10891
---- Validation: 
scalar performance:
{'acc': 0.91125935, 'precision': 0.52148193, 'recall': 0.5362608, 'specificity': 0.5362608, 'f1': 0.5250121, 'auroc': 0.641394, 'binary_precision': 0.07619863, 'binary_recall': 0.13224368, 'binary_specificity': 0.9402779, 'binary_f1_score': 0.09668659}
confusion matrix:
       0     1
0  16988  1079
1    584    89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9315179, 'precision': 0.6383828, 'recall': 0.7141595, 'specificity': 0.7141595, 'f1': 0.6661476, 'auroc': 0.7980711, 'binary_precision': 0.30024213, 'binary_recall': 0.47692308, 'binary_specificity': 0.95139587, 'binary_f1_score': 0.36849925}
confusion matrix:
      0    1
0  5657  289
1   136  124
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_5.png
early stop counter: 4
val acc:0.9112593531608582, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 5,now: 2024-06-24 08:35:28.492351,epoch time: 0:16:56.347116,used: 1:24:31.486017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9130771, 'precision': 0.91627175, 'recall': 0.84889466, 'specificity': 0.84889466, 'f1': 0.8756881, 'auroc': 0.95977354, 'binary_precision': 0.92155814, 'binary_recall': 0.7185853, 'binary_specificity': 0.979204, 'binary_f1_score': 0.8075125}
confusion matrix:
       0      1
0  41530    882
1   4058  10362
---- Validation: 
scalar performance:
{'acc': 0.9420491, 'precision': 0.53001016, 'recall': 0.52290314, 'specificity': 0.52290314, 'f1': 0.52564967, 'auroc': 0.67765355, 'binary_precision': 0.09430256, 'binary_recall': 0.07132243, 'binary_specificity': 0.97448385, 'binary_f1_score': 0.08121827}
confusion matrix:
       0    1
0  17606  461
1    625   48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547212, 'precision': 0.71857446, 'recall': 0.7225905, 'specificity': 0.7225905, 'f1': 0.7205613, 'auroc': 0.81184244, 'binary_precision': 0.46037737, 'binary_recall': 0.46923077, 'binary_specificity': 0.97595024, 'binary_f1_score': 0.4647619}
confusion matrix:
      0    1
0  5803  143
1   138  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_6.png
early stop counter: 5
val acc:0.9420490860939026, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 6,now: 2024-06-24 08:52:44.654215,epoch time: 0:17:16.161864,used: 1:41:47.647881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.92212135, 'precision': 0.9156829, 'recall': 0.8736055, 'specificity': 0.8736055, 'f1': 0.8918929, 'auroc': 0.96064085, 'binary_precision': 0.90428805, 'binary_recall': 0.77510405, 'binary_specificity': 0.97210693, 'binary_f1_score': 0.8347274}
confusion matrix:
       0      1
0  41229   1183
1   3243  11177
---- Validation: 
scalar performance:
{'acc': 0.9294557, 'precision': 0.5394921, 'recall': 0.54855895, 'specificity': 0.54855895, 'f1': 0.5432957, 'auroc': 0.6676907, 'binary_precision': 0.11137725, 'binary_recall': 0.13818721, 'binary_specificity': 0.9589307, 'binary_f1_score': 0.123342164}
confusion matrix:
       0    1
0  17325  742
1    580   93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94489205, 'precision': 0.6744387, 'recall': 0.713783, 'specificity': 0.713783, 'f1': 0.69173074, 'auroc': 0.79938096, 'binary_precision': 0.3726708, 'binary_recall': 0.46153846, 'binary_specificity': 0.96602756, 'binary_f1_score': 0.41237113}
confusion matrix:
      0    1
0  5744  202
1   140  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_7.png
early stop counter: 6
val acc:0.9294556975364685, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 7,now: 2024-06-24 09:09:41.972516,epoch time: 0:16:57.318301,used: 1:58:44.966182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9243912, 'precision': 0.90509975, 'recall': 0.8926681, 'specificity': 0.8926681, 'f1': 0.89862704, 'auroc': 0.96429646, 'binary_precision': 0.8676887, 'binary_recall': 0.8282702, 'binary_specificity': 0.95706606, 'binary_f1_score': 0.84752136}
confusion matrix:
       0      1
0  40593   1821
1   2476  11942
---- Validation: 
scalar performance:
{'acc': 0.91889006, 'precision': 0.54443103, 'recall': 0.57169, 'specificity': 0.57169, 'f1': 0.553176, 'auroc': 0.6884687, 'binary_precision': 0.11949685, 'binary_recall': 0.19762258, 'binary_specificity': 0.94575745, 'binary_f1_score': 0.14893617}
confusion matrix:
       0    1
0  17087  980
1    540  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93361264, 'precision': 0.6581675, 'recall': 0.7704222, 'specificity': 0.7704222, 'f1': 0.69627, 'auroc': 0.83742726, 'binary_precision': 0.3347826, 'binary_recall': 0.5923077, 'binary_specificity': 0.9485368, 'binary_f1_score': 0.42777777}
confusion matrix:
      0    1
0  5640  306
1   106  154
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_8.png
early stop counter: 7
val acc:0.9188900589942932, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 8,now: 2024-06-24 09:26:51.250148,epoch time: 0:17:09.277632,used: 2:15:54.243814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9252534, 'precision': 0.903697, 'recall': 0.89752626, 'specificity': 0.89752626, 'f1': 0.9005475, 'auroc': 0.9672836, 'binary_precision': 0.86094546, 'binary_recall': 0.8412401, 'binary_specificity': 0.9538124, 'binary_f1_score': 0.85097873}
confusion matrix:
       0      1
0  40455   1959
1   2289  12129
---- Validation: 
scalar performance:
{'acc': 0.9023479, 'precision': 0.55257225, 'recall': 0.6167559, 'specificity': 0.6167559, 'f1': 0.56663984, 'auroc': 0.7279662, 'binary_precision': 0.1322314, 'binary_recall': 0.30906388, 'binary_specificity': 0.9244479, 'binary_f1_score': 0.18521817}
confusion matrix:
       0     1
0  16702  1365
1    465   208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92346114, 'precision': 0.6481739, 'recall': 0.80742127, 'specificity': 0.80742127, 'f1': 0.69300604, 'auroc': 0.8684442, 'binary_precision': 0.31107205, 'binary_recall': 0.6807692, 'binary_specificity': 0.9340733, 'binary_f1_score': 0.4270205}
confusion matrix:
      0    1
0  5554  392
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_9.png
early stop counter: 8
val acc:0.9023479223251343, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 9,now: 2024-06-24 09:44:56.418108,epoch time: 0:18:05.167960,used: 2:33:59.411774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9319398, 'precision': 0.9167666, 'recall': 0.9008666, 'specificity': 0.9008666, 'f1': 0.9084136, 'auroc': 0.96967244, 'binary_precision': 0.88764787, 'binary_recall': 0.83778346, 'binary_specificity': 0.96394974, 'binary_f1_score': 0.8619951}
confusion matrix:
       0      1
0  40884   1529
1   2339  12080
---- Validation: 
scalar performance:
{'acc': 0.92113125, 'precision': 0.56355053, 'recall': 0.6071852, 'specificity': 0.6071852, 'f1': 0.57763445, 'auroc': 0.72366107, 'binary_precision': 0.15509854, 'binary_recall': 0.268945, 'binary_specificity': 0.94542533, 'binary_f1_score': 0.19673912}
confusion matrix:
       0    1
0  17081  986
1    492  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93731874, 'precision': 0.67263263, 'recall': 0.79810214, 'specificity': 0.79810214, 'f1': 0.71508175, 'auroc': 0.8550383, 'binary_precision': 0.36129034, 'binary_recall': 0.64615387, 'binary_specificity': 0.9500505, 'binary_f1_score': 0.46344832}
confusion matrix:
      0    1
0  5649  297
1    92  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_10.png
early stop counter: 9
val acc:0.9211312532424927, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 10,now: 2024-06-24 10:04:11.670020,epoch time: 0:19:15.251912,used: 2:53:14.663686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9381334, 'precision': 0.918589, 'recall': 0.9178982, 'specificity': 0.9178982, 'f1': 0.91824293, 'auroc': 0.97611487, 'binary_precision': 0.87901545, 'binary_recall': 0.8768206, 'binary_specificity': 0.9589758, 'binary_f1_score': 0.87791675}
confusion matrix:
       0      1
0  40674   1740
1   1776  12642
---- Validation: 
scalar performance:
{'acc': 0.9180363, 'precision': 0.57502425, 'recall': 0.6427739, 'specificity': 0.6427739, 'f1': 0.5947364, 'auroc': 0.7568562, 'binary_precision': 0.17531979, 'binary_recall': 0.346211, 'binary_specificity': 0.9393369, 'binary_f1_score': 0.23276724}
confusion matrix:
       0     1
0  16971  1096
1    440   233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93055105, 'precision': 0.6571901, 'recall': 0.7927314, 'specificity': 0.7927314, 'f1': 0.699798, 'auroc': 0.8607629, 'binary_precision': 0.33069307, 'binary_recall': 0.6423077, 'binary_specificity': 0.94315505, 'binary_f1_score': 0.43660128}
confusion matrix:
      0    1
0  5608  338
1    93  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_11.png
early stop counter: 10
val acc:0.9180362820625305, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 11,now: 2024-06-24 10:24:39.483132,epoch time: 0:20:27.813112,used: 3:13:42.476798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9297403, 'precision': 0.91152275, 'recall': 0.9008986, 'specificity': 0.9008986, 'f1': 0.9060265, 'auroc': 0.9694327, 'binary_precision': 0.87594664, 'binary_recall': 0.8423498, 'binary_specificity': 0.9594473, 'binary_f1_score': 0.8588198}
confusion matrix:
       0      1
0  40694   1720
1   2273  12145
---- Validation: 
scalar performance:
{'acc': 0.9171825, 'precision': 0.571231, 'recall': 0.6351785, 'specificity': 0.6351785, 'f1': 0.58974135, 'auroc': 0.751127, 'binary_precision': 0.16830188, 'binary_recall': 0.33135214, 'binary_specificity': 0.93900484, 'binary_f1_score': 0.22322322}
confusion matrix:
       0     1
0  16965  1102
1    450   223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93280697, 'precision': 0.6662874, 'recall': 0.81413746, 'specificity': 0.81413746, 'f1': 0.71235776, 'auroc': 0.8774781, 'binary_precision': 0.34697855, 'binary_recall': 0.6846154, 'binary_specificity': 0.9436596, 'binary_f1_score': 0.46054333}
confusion matrix:
      0    1
0  5611  335
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_12.png
early stop counter: 11
val acc:0.9171825051307678, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 12,now: 2024-06-24 10:46:19.692876,epoch time: 0:21:40.209744,used: 3:35:22.686542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9246199, 'precision': 0.8950045, 'recall': 0.9107903, 'specificity': 0.9107903, 'f1': 0.9024484, 'auroc': 0.97105944, 'binary_precision': 0.83074415, 'binary_recall': 0.88271606, 'binary_specificity': 0.9388645, 'binary_f1_score': 0.8559419}
confusion matrix:
       0      1
0  39821   2593
1   1691  12727
---- Validation: 
scalar performance:
{'acc': 0.8948239, 'precision': 0.56478643, 'recall': 0.66792935, 'specificity': 0.66792935, 'f1': 0.5839543, 'auroc': 0.7474306, 'binary_precision': 0.15256959, 'binary_recall': 0.42347696, 'binary_specificity': 0.9123817, 'binary_f1_score': 0.22432111}
confusion matrix:
       0     1
0  16484  1583
1    388   285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9054141, 'precision': 0.62590456, 'recall': 0.81271505, 'specificity': 0.81271505, 'f1': 0.66769046, 'auroc': 0.873011, 'binary_precision': 0.26542324, 'binary_recall': 0.71153843, 'binary_specificity': 0.9138917, 'binary_f1_score': 0.38662487}
confusion matrix:
      0    1
0  5434  512
1    75  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_13.png
early stop counter: 12
val acc:0.8948239088058472, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 13,now: 2024-06-24 11:05:53.858416,epoch time: 0:19:34.165540,used: 3:54:56.852082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9330835, 'precision': 0.9180173, 'recall': 0.90277725, 'specificity': 0.90277725, 'f1': 0.9100282, 'auroc': 0.9683242, 'binary_precision': 0.88903546, 'binary_recall': 0.84125113, 'binary_specificity': 0.9643034, 'binary_f1_score': 0.8644835}
confusion matrix:
       0      1
0  40899   1514
1   2289  12130
---- Validation: 
scalar performance:
{'acc': 0.9228922, 'precision': 0.5555238, 'recall': 0.5866404, 'specificity': 0.5866404, 'f1': 0.56621444, 'auroc': 0.707634, 'binary_precision': 0.1405959, 'binary_recall': 0.2243685, 'binary_specificity': 0.9489124, 'binary_f1_score': 0.17286776}
confusion matrix:
       0    1
0  17144  923
1    522  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93731874, 'precision': 0.6674341, 'recall': 0.7741953, 'specificity': 0.7741953, 'f1': 0.7051399, 'auroc': 0.8409102, 'binary_precision': 0.35307518, 'binary_recall': 0.59615386, 'binary_specificity': 0.9522368, 'binary_f1_score': 0.4434907}
confusion matrix:
      0    1
0  5662  284
1   105  155
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_14.png
early stop counter: 13
val acc:0.9228922128677368, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 14,now: 2024-06-24 11:30:38.399068,epoch time: 0:24:44.540652,used: 4:19:41.392734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9420749, 'precision': 0.92219436, 'recall': 0.9254603, 'specificity': 0.9254603, 'f1': 0.9238101, 'auroc': 0.9786549, 'binary_precision': 0.8813408, 'binary_recall': 0.8917326, 'binary_specificity': 0.959188, 'binary_f1_score': 0.8865062}
confusion matrix:
       0      1
0  40683   1731
1   1561  12857
---- Validation: 
scalar performance:
{'acc': 0.9203308, 'precision': 0.57826114, 'recall': 0.64467925, 'specificity': 0.64467925, 'f1': 0.59830993, 'auroc': 0.7606828, 'binary_precision': 0.18167701, 'binary_recall': 0.34769687, 'binary_specificity': 0.9416616, 'binary_f1_score': 0.23865373}
confusion matrix:
       0     1
0  17013  1054
1    439   234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9358685, 'precision': 0.6707363, 'recall': 0.8047013, 'specificity': 0.8047013, 'f1': 0.7147536, 'auroc': 0.859792, 'binary_precision': 0.35684648, 'binary_recall': 0.6615385, 'binary_specificity': 0.9478641, 'binary_f1_score': 0.4636119}
confusion matrix:
      0    1
0  5636  310
1    88  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_15.png
early stop counter: 14
val acc:0.920330822467804, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 15,now: 2024-06-24 11:56:44.313392,epoch time: 0:26:05.914324,used: 4:45:47.307058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9338225, 'precision': 0.9117401, 'recall': 0.9140105, 'specificity': 0.9140105, 'f1': 0.9128667, 'auroc': 0.97029305, 'binary_precision': 0.8665154, 'binary_recall': 0.8737864, 'binary_specificity': 0.95423466, 'binary_f1_score': 0.87013566}
confusion matrix:
       0      1
0  40471   1941
1   1820  12600
---- Validation: 
scalar performance:
{'acc': 0.9329242, 'precision': 0.6002484, 'recall': 0.6547868, 'specificity': 0.6547868, 'f1': 0.6201693, 'auroc': 0.7456093, 'binary_precision': 0.22504708, 'binary_recall': 0.3551263, 'binary_specificity': 0.9544473, 'binary_f1_score': 0.27550432}
confusion matrix:
       0    1
0  17244  823
1    434  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9398969, 'precision': 0.68123543, 'recall': 0.81048155, 'specificity': 0.81048155, 'f1': 0.725379, 'auroc': 0.87308466, 'binary_precision': 0.37744033, 'binary_recall': 0.66923076, 'binary_specificity': 0.9517323, 'binary_f1_score': 0.48266292}
confusion matrix:
      0    1
0  5659  287
1    86  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_16.png
early stop counter: 15
val acc:0.932924211025238, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 16,now: 2024-06-24 12:18:44.316668,epoch time: 0:22:00.003276,used: 5:07:47.310334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9359692, 'precision': 0.9131805, 'recall': 0.91903484, 'specificity': 0.91903484, 'f1': 0.91605055, 'auroc': 0.972558, 'binary_precision': 0.8658611, 'binary_recall': 0.88465804, 'binary_specificity': 0.95341164, 'binary_f1_score': 0.8751586}
confusion matrix:
       0      1
0  40438   1976
1   1663  12755
---- Validation: 
scalar performance:
{'acc': 0.92006403, 'precision': 0.5806085, 'recall': 0.6516935, 'specificity': 0.6516935, 'f1': 0.6017578, 'auroc': 0.74238706, 'binary_precision': 0.18583396, 'binary_recall': 0.3625557, 'binary_specificity': 0.94083136, 'binary_f1_score': 0.24572001}
confusion matrix:
       0     1
0  16998  1069
1    429   244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92281663, 'precision': 0.64915335, 'recall': 0.8162799, 'specificity': 0.8162799, 'f1': 0.69519377, 'auroc': 0.8884777, 'binary_precision': 0.31217837, 'binary_recall': 0.7, 'binary_specificity': 0.9325597, 'binary_f1_score': 0.4317912}
confusion matrix:
      0    1
0  5545  401
1    78  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_17.png
early stop counter: 16
val acc:0.9200640320777893, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 17,now: 2024-06-24 12:38:13.802001,epoch time: 0:19:29.485333,used: 5:27:16.795667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9467905, 'precision': 0.93100005, 'recall': 0.9280245, 'specificity': 0.9280245, 'f1': 0.9294985, 'auroc': 0.97865283, 'binary_precision': 0.89928514, 'binary_recall': 0.88992923, 'binary_specificity': 0.9661197, 'binary_f1_score': 0.8945827}
confusion matrix:
       0      1
0  40977   1437
1   1587  12831
---- Validation: 
scalar performance:
{'acc': 0.921238, 'precision': 0.5909181, 'recall': 0.67662144, 'specificity': 0.67662144, 'f1': 0.61599183, 'auroc': 0.7710391, 'binary_precision': 0.20456217, 'binary_recall': 0.41307577, 'binary_specificity': 0.9401671, 'binary_f1_score': 0.27362207}
confusion matrix:
       0     1
0  16986  1081
1    395   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9239446, 'precision': 0.6502429, 'recall': 0.8131905, 'specificity': 0.8131905, 'f1': 0.6959662, 'auroc': 0.8828709, 'binary_precision': 0.3146853, 'binary_recall': 0.6923077, 'binary_specificity': 0.9340733, 'binary_f1_score': 0.43269232}
confusion matrix:
      0    1
0  5554  392
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_18.png
early stop counter: 17
val acc:0.9212380051612854, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 18,now: 2024-06-24 12:56:57.004268,epoch time: 0:18:43.202267,used: 5:45:59.997934,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9362507, 'precision': 0.908125, 'recall': 0.9295286, 'specificity': 0.9295286, 'f1': 0.91802937, 'auroc': 0.9777242, 'binary_precision': 0.845681, 'binary_recall': 0.91588074, 'binary_specificity': 0.94317645, 'binary_f1_score': 0.8793821}
confusion matrix:
       0      1
0  40002   2410
1   1213  13207
---- Validation: 
scalar performance:
{'acc': 0.9070971, 'precision': 0.58352494, 'recall': 0.70004416, 'specificity': 0.70004416, 'f1': 0.6099015, 'auroc': 0.76488286, 'binary_precision': 0.1877193, 'binary_recall': 0.4769688, 'binary_specificity': 0.9231195, 'binary_f1_score': 0.26940832}
confusion matrix:
       0     1
0  16678  1389
1    352   321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91057044, 'precision': 0.6348237, 'recall': 0.82643986, 'specificity': 0.82643986, 'f1': 0.679659, 'auroc': 0.88320136, 'binary_precision': 0.28212702, 'binary_recall': 0.7346154, 'binary_specificity': 0.9182644, 'binary_f1_score': 0.4076841}
confusion matrix:
      0    1
0  5460  486
1    69  191
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_19.png
early stop counter: 18
val acc:0.9070971012115479, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 19,now: 2024-06-24 13:15:24.517827,epoch time: 0:18:27.513559,used: 6:04:27.511493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.94631547, 'precision': 0.93267345, 'recall': 0.9244138, 'specificity': 0.9244138, 'f1': 0.9284391, 'auroc': 0.9781693, 'binary_precision': 0.90576816, 'binary_recall': 0.87995005, 'binary_specificity': 0.9688775, 'binary_f1_score': 0.8926725}
confusion matrix:
       0      1
0  41093   1320
1   1731  12688
---- Validation: 
scalar performance:
{'acc': 0.9350587, 'precision': 0.6055374, 'recall': 0.6580396, 'specificity': 0.6580396, 'f1': 0.625262, 'auroc': 0.7617347, 'binary_precision': 0.23540856, 'binary_recall': 0.35958394, 'binary_specificity': 0.9564953, 'binary_f1_score': 0.2845385}
confusion matrix:
       0    1
0  17281  786
1    431  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9431196, 'precision': 0.69078046, 'recall': 0.81768024, 'specificity': 0.81768024, 'f1': 0.73527455, 'auroc': 0.8811243, 'binary_precision': 0.39597315, 'binary_recall': 0.6807692, 'binary_specificity': 0.95459133, 'binary_f1_score': 0.50070715}
confusion matrix:
      0    1
0  5676  270
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_20.png
early stop counter: 19
val acc:0.9350587129592896, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 20,now: 2024-06-24 13:34:34.990264,epoch time: 0:19:10.472437,used: 6:23:37.983930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.95205164, 'precision': 0.9456631, 'recall': 0.926041, 'specificity': 0.926041, 'f1': 0.93529236, 'auroc': 0.9796096, 'binary_precision': 0.93350136, 'binary_recall': 0.87323165, 'binary_specificity': 0.9788503, 'binary_f1_score': 0.9023613}
confusion matrix:
       0      1
0  41515    897
1   1828  12592
---- Validation: 
scalar performance:
{'acc': 0.94199574, 'precision': 0.6188829, 'recall': 0.65233886, 'specificity': 0.65233886, 'f1': 0.6330955, 'auroc': 0.76039433, 'binary_precision': 0.26261467, 'binary_recall': 0.34026745, 'binary_specificity': 0.96441025, 'binary_f1_score': 0.2964401}
confusion matrix:
       0    1
0  17424  643
1    444  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9498872, 'precision': 0.70889485, 'recall': 0.80282223, 'specificity': 0.80282223, 'f1': 0.7456998, 'auroc': 0.8591639, 'binary_precision': 0.43376625, 'binary_recall': 0.6423077, 'binary_specificity': 0.9633367, 'binary_f1_score': 0.5178295}
confusion matrix:
      0    1
0  5728  218
1    93  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_21.png
early stop counter: 20
val acc:0.9419957399368286, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 21,now: 2024-06-24 13:53:28.310556,epoch time: 0:18:53.320292,used: 6:42:31.304222,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9493243, 'precision': 0.93277615, 'recall': 0.9335278, 'specificity': 0.9335278, 'f1': 0.93315107, 'auroc': 0.9823189, 'binary_precision': 0.899087, 'binary_recall': 0.9014563, 'binary_specificity': 0.96559936, 'binary_f1_score': 0.90027004}
confusion matrix:
       0      1
0  40953   1459
1   1421  12999
---- Validation: 
scalar performance:
{'acc': 0.93164355, 'precision': 0.6086804, 'recall': 0.68344855, 'specificity': 0.68344855, 'f1': 0.63411933, 'auroc': 0.7857716, 'binary_precision': 0.23972602, 'binary_recall': 0.41604754, 'binary_specificity': 0.9508496, 'binary_f1_score': 0.3041825}
confusion matrix:
       0    1
0  17179  888
1    393  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9371576, 'precision': 0.67667556, 'recall': 0.8200859, 'specificity': 0.8200859, 'f1': 0.723279, 'auroc': 0.8849511, 'binary_precision': 0.36734694, 'binary_recall': 0.6923077, 'binary_specificity': 0.9478641, 'binary_f1_score': 0.48000002}
confusion matrix:
      0    1
0  5636  310
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_22.png
early stop counter: 21
val acc:0.931643545627594, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 22,now: 2024-06-24 14:12:56.933585,epoch time: 0:19:28.623029,used: 7:01:59.927251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.94518936, 'precision': 0.92855966, 'recall': 0.92633367, 'specificity': 0.92633367, 'f1': 0.9274389, 'auroc': 0.97726727, 'binary_precision': 0.8950716, 'binary_recall': 0.8880566, 'binary_specificity': 0.96461076, 'binary_f1_score': 0.8915503}
confusion matrix:
       0      1
0  40913   1501
1   1614  12804
---- Validation: 
scalar performance:
{'acc': 0.9359125, 'precision': 0.61129725, 'recall': 0.66849613, 'specificity': 0.66849613, 'f1': 0.6326562, 'auroc': 0.7687344, 'binary_precision': 0.24615385, 'binary_recall': 0.38038632, 'binary_specificity': 0.956606, 'binary_f1_score': 0.29889083}
confusion matrix:
       0    1
0  17283  784
1    417  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9419916, 'precision': 0.68605745, 'recall': 0.80789673, 'specificity': 0.80789673, 'f1': 0.72894406, 'auroc': 0.86555797, 'binary_precision': 0.3873874, 'binary_recall': 0.6615385, 'binary_specificity': 0.954255, 'binary_f1_score': 0.48863634}
confusion matrix:
      0    1
0  5674  272
1    88  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_23.png
early stop counter: 22
val acc:0.9359124898910522, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 23,now: 2024-06-24 14:32:26.160143,epoch time: 0:19:29.226558,used: 7:21:29.153809,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9410895, 'precision': 0.9138152, 'recall': 0.9366802, 'specificity': 0.9366802, 'f1': 0.9243529, 'auroc': 0.9820963, 'binary_precision': 0.8529524, 'binary_recall': 0.92772925, 'binary_specificity': 0.94563115, 'binary_f1_score': 0.88877076}
confusion matrix:
       0      1
0  40108   2306
1   1042  13376
---- Validation: 
scalar performance:
{'acc': 0.9204909, 'precision': 0.5936947, 'recall': 0.6876783, 'specificity': 0.6876783, 'f1': 0.62043816, 'auroc': 0.78197145, 'binary_precision': 0.20925267, 'binary_recall': 0.43684992, 'binary_specificity': 0.93850666, 'binary_f1_score': 0.28296438}
confusion matrix:
       0     1
0  16956  1111
1    379   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9279729, 'precision': 0.6582577, 'recall': 0.81897074, 'specificity': 0.81897074, 'f1': 0.70514876, 'auroc': 0.8900728, 'binary_precision': 0.33030853, 'binary_recall': 0.7, 'binary_specificity': 0.9379415, 'binary_f1_score': 0.4488286}
confusion matrix:
      0    1
0  5577  369
1    78  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_24.png
early stop counter: 23
val acc:0.9204909205436707, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 24,now: 2024-06-24 14:53:58.269383,epoch time: 0:21:32.109240,used: 7:43:01.263049,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9593011, 'precision': 0.9501947, 'recall': 0.9415167, 'specificity': 0.9415167, 'f1': 0.94574624, 'auroc': 0.98572576, 'binary_precision': 0.93223846, 'binary_recall': 0.90540916, 'binary_specificity': 0.97762424, 'binary_f1_score': 0.918628}
confusion matrix:
       0      1
0  41463    949
1   1364  13056
---- Validation: 
scalar performance:
{'acc': 0.94397014, 'precision': 0.6383755, 'recall': 0.68984145, 'specificity': 0.68984145, 'f1': 0.65927684, 'auroc': 0.79323834, 'binary_precision': 0.29882604, 'binary_recall': 0.41604754, 'binary_specificity': 0.9636354, 'binary_f1_score': 0.3478261}
confusion matrix:
       0    1
0  17410  657
1    393  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.7390092, 'recall': 0.8177242, 'specificity': 0.8177242, 'f1': 0.77191454, 'auroc': 0.87668693, 'binary_precision': 0.49287748, 'binary_recall': 0.6653846, 'binary_specificity': 0.9700639, 'binary_f1_score': 0.5662848}
confusion matrix:
      0    1
0  5768  178
1    87  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_25.png
early stop counter: 24
val acc:0.9439701437950134, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 25,now: 2024-06-24 15:16:21.035207,epoch time: 0:22:22.765824,used: 8:05:24.028873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.95133024, 'precision': 0.9386666, 'recall': 0.931962, 'specificity': 0.931962, 'f1': 0.9352465, 'auroc': 0.98143685, 'binary_precision': 0.9135496, 'binary_recall': 0.89264166, 'binary_specificity': 0.97128236, 'binary_f1_score': 0.90297467}
confusion matrix:
       0      1
0  41195   1218
1   1548  12871
---- Validation: 
scalar performance:
{'acc': 0.9377268, 'precision': 0.6101509, 'recall': 0.655847, 'specificity': 0.655847, 'f1': 0.62814295, 'auroc': 0.76760185, 'binary_precision': 0.2448347, 'binary_recall': 0.35215452, 'binary_specificity': 0.9595395, 'binary_f1_score': 0.28884825}
confusion matrix:
       0    1
0  17336  731
1    436  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94086367, 'precision': 0.68673056, 'recall': 0.82753694, 'specificity': 0.82753694, 'f1': 0.733947, 'auroc': 0.883975, 'binary_precision': 0.38689217, 'binary_recall': 0.70384616, 'binary_specificity': 0.9512277, 'binary_f1_score': 0.4993179}
confusion matrix:
      0    1
0  5656  290
1    77  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_26.png
early stop counter: 25
val acc:0.9377267956733704, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9574605226516724
after epoch: 26,now: 2024-06-24 15:41:12.637001,epoch time: 0:24:51.601794,used: 8:30:15.630667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.95775265, 'precision': 0.95965457, 'recall': 0.92767763, 'specificity': 0.92767763, 'f1': 0.94225657, 'auroc': 0.98366606, 'binary_precision': 0.96315426, 'binary_recall': 0.8666251, 'binary_specificity': 0.98873013, 'binary_f1_score': 0.91234344}
confusion matrix:
       0      1
0  41936    478
1   1923  12495
---- Validation: 
scalar performance:
{'acc': 0.9527748, 'precision': 0.65450794, 'recall': 0.64720017, 'specificity': 0.64720017, 'f1': 0.65075064, 'auroc': 0.7788709, 'binary_precision': 0.334375, 'binary_recall': 0.3179792, 'binary_specificity': 0.9764211, 'binary_f1_score': 0.32597104}
confusion matrix:
       0    1
0  17641  426
1    459  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97147924, 'precision': 0.82788503, 'recall': 0.80489534, 'specificity': 0.80489534, 'f1': 0.8159232, 'auroc': 0.86290705, 'binary_precision': 0.6721992, 'binary_recall': 0.6230769, 'binary_specificity': 0.98671377, 'binary_f1_score': 0.6467066}
confusion matrix:
      0    1
0  5867   79
1    98  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_27.png
new oracle model saved
early stop counter: 26
val acc:0.9527748227119446, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9714792370796204
after epoch: 27,now: 2024-06-24 16:05:17.647055,epoch time: 0:24:05.010054,used: 8:54:20.640721,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.93357617, 'precision': 0.9024677, 'recall': 0.93144405, 'specificity': 0.93144405, 'f1': 0.91544145, 'auroc': 0.97808945, 'binary_precision': 0.83073384, 'binary_recall': 0.92711514, 'binary_specificity': 0.9357729, 'binary_f1_score': 0.8762823}
confusion matrix:
       0      1
0  39688   2724
1   1051  13369
---- Validation: 
scalar performance:
{'acc': 0.90613663, 'precision': 0.58084273, 'recall': 0.6938239, 'specificity': 0.6938239, 'f1': 0.6061763, 'auroc': 0.75929576, 'binary_precision': 0.1828271, 'binary_recall': 0.46508172, 'binary_specificity': 0.922566, 'binary_f1_score': 0.2624738}
confusion matrix:
       0     1
0  16668  1399
1    360   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89252335, 'precision': 0.61591387, 'recall': 0.82253873, 'specificity': 0.82253873, 'f1': 0.6545211, 'auroc': 0.8866297, 'binary_precision': 0.24402516, 'binary_recall': 0.74615383, 'binary_specificity': 0.89892364, 'binary_f1_score': 0.3677725}
confusion matrix:
      0    1
0  5345  601
1    66  194
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_28.png
early stop counter: 27
val acc:0.9061366319656372, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9714792370796204
after epoch: 28,now: 2024-06-24 16:27:16.245852,epoch time: 0:21:58.598797,used: 9:16:19.239518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.95759434, 'precision': 0.94747317, 'recall': 0.9397522, 'specificity': 0.9397522, 'f1': 0.94352525, 'auroc': 0.9854709, 'binary_precision': 0.9274578, 'binary_recall': 0.90353006, 'binary_specificity': 0.9759743, 'binary_f1_score': 0.91533756}
confusion matrix:
       0      1
0  41394   1019
1   1391  13028
---- Validation: 
scalar performance:
{'acc': 0.9491462, 'precision': 0.6570231, 'recall': 0.6968175, 'specificity': 0.6968175, 'f1': 0.67428833, 'auroc': 0.795562, 'binary_precision': 0.33568075, 'binary_recall': 0.42496285, 'binary_specificity': 0.96867216, 'binary_f1_score': 0.375082}
confusion matrix:
       0    1
0  17501  566
1    387  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.7891885, 'recall': 0.82828665, 'specificity': 0.82828665, 'f1': 0.8073323, 'auroc': 0.8835275, 'binary_precision': 0.5925926, 'binary_recall': 0.6769231, 'binary_specificity': 0.9796502, 'binary_f1_score': 0.6319569}
confusion matrix:
      0    1
0  5825  121
1    84  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_29.png
early stop counter: 28
val acc:0.9491462111473083, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9714792370796204
after epoch: 29,now: 2024-06-24 16:51:16.361925,epoch time: 0:24:00.116073,used: 9:40:19.355591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.939242, 'precision': 0.91439575, 'recall': 0.9285806, 'specificity': 0.9285806, 'f1': 0.92114985, 'auroc': 0.9784937, 'binary_precision': 0.8610178, 'binary_recall': 0.9069348, 'binary_specificity': 0.95022637, 'binary_f1_score': 0.88338}
confusion matrix:
       0      1
0  40301   2111
1   1342  13078
---- Validation: 
scalar performance:
{'acc': 0.9359125, 'precision': 0.6177943, 'recall': 0.6863778, 'specificity': 0.6863778, 'f1': 0.64257467, 'auroc': 0.7828043, 'binary_precision': 0.25779817, 'binary_recall': 0.41753343, 'binary_specificity': 0.95522225, 'binary_f1_score': 0.31877482}
confusion matrix:
       0    1
0  17258  809
1    392  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9386078, 'precision': 0.68249774, 'recall': 0.8337156, 'specificity': 0.8337156, 'f1': 0.73134005, 'auroc': 0.9000168, 'binary_precision': 0.37777779, 'binary_recall': 0.7192308, 'binary_specificity': 0.94820046, 'binary_f1_score': 0.49536425}
confusion matrix:
      0    1
0  5638  308
1    73  187
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_30.png
early stop counter: 29
val acc:0.9359124898910522, best validation acc: 0.9612059593200684, corresponding to test acc:                         0.956977128982544 / 0.9714792370796204
after epoch: 30,now: 2024-06-24 17:15:05.823013,epoch time: 0:23:49.461088,used: 10:04:08.816679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_07_10_56_seed_1_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:04:08.816679 at 2024-06-24 17:15:05.823013
persisted model performance metric: 

scalar performance:
{'acc': 0.9569771, 'precision': 0.47902888, 'recall': 0.49941137, 'specificity': 0.49941137, 'f1': 0.4890078, 'auroc': 0.32724082, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5939  7
1   260  0
oracle model performance metric: 

scalar performance:
{'acc': 0.97147924, 'precision': 0.82788503, 'recall': 0.80489534, 'specificity': 0.80489534, 'f1': 0.8159232, 'auroc': 0.86290705, 'binary_precision': 0.6721992, 'binary_recall': 0.6230769, 'binary_specificity': 0.98671377, 'binary_f1_score': 0.6467066}
confusion matrix:
      0    1
0  5867   79
1    98  162
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204071 KiB | 571737 KiB |   1139 TiB |   1139 TiB |
|       from large pool | 167040 KiB | 499008 KiB |   1137 TiB |   1137 TiB |
|       from small pool |  37031 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204071 KiB | 571737 KiB |   1139 TiB |   1139 TiB |
|       from large pool | 167040 KiB | 499008 KiB |   1137 TiB |   1137 TiB |
|       from small pool |  37031 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 563304 KiB |   1125 TiB |   1125 TiB |
|       from large pool | 165120 KiB | 491712 KiB |   1123 TiB |   1123 TiB |
|       from small pool |  35966 KiB |  74337 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 778240 KiB | 778240 KiB |   1192 MiB | 442368 KiB |
|       from large pool | 702464 KiB | 702464 KiB |   1092 MiB | 415744 KiB |
|       from small pool |  75776 KiB |  75776 KiB |    100 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80600 KiB | 209453 KiB |    768 TiB |    768 TiB |
|       from large pool |  68480 KiB | 208064 KiB |    767 TiB |    767 TiB |
|       from small pool |  12120 KiB |  19703 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    7899    |  231784 K  |  231781 K  |
|       from large pool |      36    |      76    |   78830 K  |   78830 K  |
|       from small pool |    3192    |    7861    |  152954 K  |  152951 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    7899    |  231784 K  |  231781 K  |
|       from large pool |      36    |      76    |   78830 K  |   78830 K  |
|       from small pool |    3192    |    7861    |  152954 K  |  152951 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      53    |      71    |      18    |
|       from large pool |      16    |      16    |      21    |       5    |
|       from small pool |      37    |      37    |      50    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      53    |    3580    |  107061 K  |  107061 K  |
|       from large pool |       5    |      13    |   31920 K  |   31920 K  |
|       from small pool |      48    |    3574    |   75140 K  |   75140 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB |   1139 TiB |   1139 TiB |
|       from large pool |  16640 KiB | 499008 KiB |   1137 TiB |   1137 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB |   1139 TiB |   1139 TiB |
|       from large pool |  16640 KiB | 499008 KiB |   1137 TiB |   1137 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB |   1125 TiB |   1125 TiB |
|       from large pool |  16640 KiB | 491712 KiB |   1123 TiB |   1123 TiB |
|       from small pool |      0 KiB |  74337 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 778240 KiB |   1192 MiB |    914 MiB |
|       from large pool | 235520 KiB | 702464 KiB |   1092 MiB |    862 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB |    768 TiB |    768 TiB |
|       from large pool |  55040 KiB | 208064 KiB |    767 TiB |    767 TiB |
|       from small pool |      0 KiB |  19715 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7899    |  231784 K  |  231784 K  |
|       from large pool |       2    |      76    |   78830 K  |   78830 K  |
|       from small pool |       0    |    7861    |  152954 K  |  152954 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7899    |  231784 K  |  231784 K  |
|       from large pool |       2    |      76    |   78830 K  |   78830 K  |
|       from small pool |       0    |    7861    |  152954 K  |  152954 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      53    |      71    |      37    |
|       from large pool |      10    |      16    |      21    |      11    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3580    |  107062 K  |  107062 K  |
|       from large pool |       3    |      13    |   31920 K  |   31920 K  |
|       from small pool |       0    |    3574    |   75142 K  |   75142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB |   1139 TiB |   1139 TiB |
|       from large pool |  16640 KiB | 499008 KiB |   1137 TiB |   1137 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB |   1139 TiB |   1139 TiB |
|       from large pool |  16640 KiB | 499008 KiB |   1137 TiB |   1137 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB |   1125 TiB |   1125 TiB |
|       from large pool |  16640 KiB | 491712 KiB |   1123 TiB |   1123 TiB |
|       from small pool |      0 KiB |  74337 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 778240 KiB |   1192 MiB |    914 MiB |
|       from large pool | 235520 KiB | 702464 KiB |   1092 MiB |    862 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB |    768 TiB |    768 TiB |
|       from large pool |  55040 KiB | 208064 KiB |    767 TiB |    767 TiB |
|       from small pool |      0 KiB |  19715 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7899    |  231784 K  |  231784 K  |
|       from large pool |       2    |      76    |   78830 K  |   78830 K  |
|       from small pool |       0    |    7861    |  152954 K  |  152954 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7899    |  231784 K  |  231784 K  |
|       from large pool |       2    |      76    |   78830 K  |   78830 K  |
|       from small pool |       0    |    7861    |  152954 K  |  152954 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      53    |      71    |      37    |
|       from large pool |      10    |      16    |      21    |      11    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3580    |  107062 K  |  107062 K  |
|       from large pool |       3    |      13    |   31920 K  |   31920 K  |
|       from small pool |       0    |    3574    |   75142 K  |   75142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886

 Experiment start at: 2024-06-24 17:22:53.743019
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.74803275, 'precision': 0.84436417, 'recall': 0.5225719, 'specificity': 0.5225719, 'f1': 0.47089732, 'auroc': 0.78466666, 'binary_precision': 0.94324327, 'binary_recall': 0.046136558, 'binary_specificity': 0.99900734, 'binary_f1_score': 0.08797026}
confusion matrix:
       0    1
0  42269   42
1  14431  698
---- Validation: 
scalar performance:
{'acc': 0.96708035, 'precision': 0.48395267, 'recall': 0.49955973, 'specificity': 0.49955973, 'f1': 0.49163237, 'auroc': 0.4649309, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18155  16
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.662799, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-24 17:43:30.243312,epoch time: 0:20:36.500293,used: 0:20:36.500293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8338092, 'precision': 0.89027166, 'recall': 0.6894178, 'specificity': 0.6894178, 'f1': 0.72364616, 'auroc': 0.900017, 'binary_precision': 0.9617866, 'binary_recall': 0.38429508, 'binary_specificity': 0.99454045, 'binary_f1_score': 0.54916406}
confusion matrix:
       0     1
0  42080   231
1   9315  5814
---- Validation: 
scalar performance:
{'acc': 0.9617003, 'precision': 0.5296467, 'recall': 0.5072202, 'specificity': 0.5072202, 'f1': 0.5076809, 'auroc': 0.6342177, 'binary_precision': 0.09090909, 'binary_recall': 0.021594685, 'binary_specificity': 0.9928457, 'binary_f1_score': 0.034899328}
confusion matrix:
       0    1
0  18041  130
1    589   13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.8244052, 'recall': 0.6074197, 'specificity': 0.6074197, 'f1': 0.65682423, 'auroc': 0.77560407, 'binary_precision': 0.67948717, 'binary_recall': 0.21900827, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.33125}
confusion matrix:
      0   1
0  5972  25
1   189  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_2.png
new oracle model saved
early stop counter: 1
val acc:0.9617003202438354, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 2,now: 2024-06-24 18:38:02.808597,epoch time: 0:54:32.565285,used: 1:15:09.065578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.88544565, 'precision': 0.8864703, 'recall': 0.8086945, 'specificity': 0.8086945, 'f1': 0.83707345, 'auroc': 0.92970294, 'binary_precision': 0.8881322, 'binary_recall': 0.6465067, 'binary_specificity': 0.9708823, 'binary_f1_score': 0.7482978}
confusion matrix:
       0     1
0  41079  1232
1   5348  9781
---- Validation: 
scalar performance:
{'acc': 0.920897, 'precision': 0.53318226, 'recall': 0.558417, 'specificity': 0.558417, 'f1': 0.54020226, 'auroc': 0.6819002, 'binary_precision': 0.094582185, 'binary_recall': 0.17109634, 'binary_specificity': 0.9457377, 'binary_f1_score': 0.121821396}
confusion matrix:
       0    1
0  17185  986
1    499  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9302773, 'precision': 0.63599044, 'recall': 0.7495959, 'specificity': 0.7495959, 'f1': 0.6721403, 'auroc': 0.81492877, 'binary_precision': 0.29067245, 'binary_recall': 0.553719, 'binary_specificity': 0.9454727, 'binary_f1_score': 0.38122332}
confusion matrix:
      0    1
0  5670  327
1   108  134
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_3.png
early stop counter: 2
val acc:0.9208970069885254, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 3,now: 2024-06-24 19:17:54.910232,epoch time: 0:39:52.101635,used: 1:55:01.167213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.88831824, 'precision': 0.9081274, 'recall': 0.80098385, 'specificity': 0.80098385, 'f1': 0.8363298, 'auroc': 0.9435357, 'binary_precision': 0.9384182, 'binary_recall': 0.616432, 'binary_specificity': 0.9855357, 'binary_f1_score': 0.74408585}
confusion matrix:
       0     1
0  41699   612
1   5803  9326
---- Validation: 
scalar performance:
{'acc': 0.9432696, 'precision': 0.52302855, 'recall': 0.5209879, 'specificity': 0.5209879, 'f1': 0.5219232, 'auroc': 0.6600865, 'binary_precision': 0.07678245, 'binary_recall': 0.069767445, 'binary_specificity': 0.97220844, 'binary_f1_score': 0.07310705}
confusion matrix:
       0    1
0  17666  505
1    560   42
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9559224, 'precision': 0.70389783, 'recall': 0.7014709, 'specificity': 0.7014709, 'f1': 0.70267606, 'auroc': 0.78858507, 'binary_precision': 0.43096235, 'binary_recall': 0.42561984, 'binary_specificity': 0.977322, 'binary_f1_score': 0.42827445}
confusion matrix:
      0    1
0  5861  136
1   139  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_4.png
early stop counter: 3
val acc:0.9432696104049683, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 4,now: 2024-06-24 19:38:25.525783,epoch time: 0:20:30.615551,used: 2:15:31.782764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.89383703, 'precision': 0.87027323, 'recall': 0.8503008, 'specificity': 0.8503008, 'f1': 0.85950005, 'auroc': 0.9390162, 'binary_precision': 0.8245652, 'binary_recall': 0.75829476, 'binary_specificity': 0.94230676, 'binary_f1_score': 0.79004264}
confusion matrix:
       0      1
0  39869   2441
1   3657  11473
---- Validation: 
scalar performance:
{'acc': 0.88685876, 'precision': 0.5220502, 'recall': 0.5609103, 'specificity': 0.5609103, 'f1': 0.5235819, 'auroc': 0.6357293, 'binary_precision': 0.071991004, 'binary_recall': 0.21262458, 'binary_specificity': 0.90919596, 'binary_f1_score': 0.107563026}
confusion matrix:
       0     1
0  16521  1650
1    474   128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89982367, 'precision': 0.6000271, 'recall': 0.75953025, 'specificity': 0.75953025, 'f1': 0.6329213, 'auroc': 0.8186979, 'binary_precision': 0.21713442, 'binary_recall': 0.607438, 'binary_specificity': 0.91162246, 'binary_f1_score': 0.31991297}
confusion matrix:
      0    1
0  5467  530
1    95  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_5.png
early stop counter: 4
val acc:0.8868587613105774, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 5,now: 2024-06-24 20:12:36.403536,epoch time: 0:34:10.877753,used: 2:49:42.660517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9103935, 'precision': 0.90734726, 'recall': 0.8557354, 'specificity': 0.8557354, 'f1': 0.8771041, 'auroc': 0.9550202, 'binary_precision': 0.9019813, 'binary_recall': 0.740234, 'binary_specificity': 0.97123677, 'binary_f1_score': 0.8131422}
confusion matrix:
       0      1
0  41094   1217
1   3930  11199
---- Validation: 
scalar performance:
{'acc': 0.9267032, 'precision': 0.53938437, 'recall': 0.56302243, 'specificity': 0.56302243, 'f1': 0.54707193, 'auroc': 0.6806754, 'binary_precision': 0.10670732, 'binary_recall': 0.1744186, 'binary_specificity': 0.95162624, 'binary_f1_score': 0.13240857}
confusion matrix:
       0    1
0  17292  879
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.941497, 'precision': 0.6586261, 'recall': 0.74155295, 'specificity': 0.74155295, 'f1': 0.6897805, 'auroc': 0.822456, 'binary_precision': 0.33687, 'binary_recall': 0.5247934, 'binary_specificity': 0.9583125, 'binary_f1_score': 0.41033924}
confusion matrix:
      0    1
0  5747  250
1   115  127
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_6.png
early stop counter: 5
val acc:0.9267032146453857, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 6,now: 2024-06-24 21:17:32.806911,epoch time: 1:04:56.403375,used: 3:54:39.063892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9147806, 'precision': 0.9137727, 'recall': 0.861431, 'specificity': 0.861431, 'f1': 0.8831327, 'auroc': 0.95966446, 'binary_precision': 0.9119968, 'binary_recall': 0.74869454, 'binary_specificity': 0.97416747, 'binary_f1_score': 0.82231665}
confusion matrix:
       0      1
0  41218   1093
1   3802  11327
---- Validation: 
scalar performance:
{'acc': 0.9284611, 'precision': 0.5421305, 'recall': 0.56553656, 'specificity': 0.56553656, 'f1': 0.55006343, 'auroc': 0.69423807, 'binary_precision': 0.11204188, 'binary_recall': 0.17774086, 'binary_specificity': 0.95333225, 'binary_f1_score': 0.1374438}
confusion matrix:
       0    1
0  17323  848
1    495  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9410162, 'precision': 0.6524338, 'recall': 0.7234582, 'specificity': 0.7234582, 'f1': 0.6798682, 'auroc': 0.8020464, 'binary_precision': 0.32596686, 'binary_recall': 0.4876033, 'binary_specificity': 0.959313, 'binary_f1_score': 0.3907285}
confusion matrix:
      0    1
0  5753  244
1   124  118
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_7.png
early stop counter: 6
val acc:0.9284610748291016, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 7,now: 2024-06-24 21:37:11.636087,epoch time: 0:19:38.829176,used: 4:14:17.893068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9080954, 'precision': 0.88504577, 'recall': 0.87551355, 'specificity': 0.87551355, 'f1': 0.88010645, 'auroc': 0.95324826, 'binary_precision': 0.83830196, 'binary_recall': 0.8066627, 'binary_specificity': 0.94436437, 'binary_f1_score': 0.822178}
confusion matrix:
       0      1
0  39957   2354
1   2925  12204
---- Validation: 
scalar performance:
{'acc': 0.91093594, 'precision': 0.54144555, 'recall': 0.5902117, 'specificity': 0.5902117, 'f1': 0.5521355, 'auroc': 0.7006245, 'binary_precision': 0.10891813, 'binary_recall': 0.2475083, 'binary_specificity': 0.9329151, 'binary_f1_score': 0.15126905}
confusion matrix:
       0     1
0  16952  1219
1    453   149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9121654, 'precision': 0.61559623, 'recall': 0.7718984, 'specificity': 0.7718984, 'f1': 0.653327, 'auroc': 0.8472452, 'binary_precision': 0.24752475, 'binary_recall': 0.6198347, 'binary_specificity': 0.923962, 'binary_f1_score': 0.3537736}
confusion matrix:
      0    1
0  5541  456
1    92  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_8.png
early stop counter: 7
val acc:0.9109359383583069, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 8,now: 2024-06-24 21:55:49.163426,epoch time: 0:18:37.527339,used: 4:32:55.420407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.92689764, 'precision': 0.9039663, 'recall': 0.90887105, 'specificity': 0.90887105, 'f1': 0.90637445, 'auroc': 0.97067094, 'binary_precision': 0.8544558, 'binary_recall': 0.87077796, 'binary_specificity': 0.94696414, 'binary_f1_score': 0.8625397}
confusion matrix:
       0      1
0  40067   2244
1   1955  13174
---- Validation: 
scalar performance:
{'acc': 0.89255846, 'precision': 0.5554963, 'recall': 0.6642356, 'specificity': 0.6642356, 'f1': 0.57148206, 'auroc': 0.75223327, 'binary_precision': 0.13170224, 'binary_recall': 0.4202658, 'binary_specificity': 0.9082054, 'binary_f1_score': 0.2005549}
confusion matrix:
       0     1
0  16503  1668
1    349   253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91537106, 'precision': 0.62800366, 'recall': 0.80727243, 'specificity': 0.80727243, 'f1': 0.6710082, 'auroc': 0.8648429, 'binary_precision': 0.26935485, 'binary_recall': 0.69008267, 'binary_specificity': 0.92446226, 'binary_f1_score': 0.38747102}
confusion matrix:
      0    1
0  5544  453
1    75  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_9.png
early stop counter: 8
val acc:0.8925584554672241, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 9,now: 2024-06-24 22:16:37.452215,epoch time: 0:20:48.288789,used: 4:53:43.709196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9331128, 'precision': 0.9222387, 'recall': 0.9026487, 'specificity': 0.9026487, 'f1': 0.91180766, 'auroc': 0.9677032, 'binary_precision': 0.90090925, 'binary_recall': 0.83826834, 'binary_specificity': 0.9670291, 'binary_f1_score': 0.8684607}
confusion matrix:
       0      1
0  40915   1395
1   2447  12683
---- Validation: 
scalar performance:
{'acc': 0.9268631, 'precision': 0.5639382, 'recall': 0.61450005, 'specificity': 0.61450005, 'f1': 0.5796154, 'auroc': 0.7056473, 'binary_precision': 0.15238954, 'binary_recall': 0.2807309, 'binary_specificity': 0.94826925, 'binary_f1_score': 0.1975453}
confusion matrix:
       0    1
0  17231  940
1    433  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93652827, 'precision': 0.6529949, 'recall': 0.76672673, 'specificity': 0.76672673, 'f1': 0.69118494, 'auroc': 0.84522426, 'binary_precision': 0.3233945, 'binary_recall': 0.58264464, 'binary_specificity': 0.95080876, 'binary_f1_score': 0.41592923}
confusion matrix:
      0    1
0  5702  295
1   101  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_10.png
early stop counter: 9
val acc:0.9268630743026733, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 10,now: 2024-06-24 22:37:45.798199,epoch time: 0:21:08.345984,used: 5:14:52.055180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.93121517, 'precision': 0.9248806, 'recall': 0.8944553, 'specificity': 0.8944553, 'f1': 0.90816957, 'auroc': 0.96924853, 'binary_precision': 0.91289896, 'binary_recall': 0.81677574, 'binary_specificity': 0.9721349, 'binary_f1_score': 0.8621664}
confusion matrix:
       0      1
0  41132   1179
1   2772  12357
---- Validation: 
scalar performance:
{'acc': 0.9382624, 'precision': 0.5761094, 'recall': 0.6075398, 'specificity': 0.6075398, 'f1': 0.58837575, 'auroc': 0.7099782, 'binary_precision': 0.17728853, 'binary_recall': 0.25415283, 'binary_specificity': 0.9609268, 'binary_f1_score': 0.20887373}
confusion matrix:
       0    1
0  17461  710
1    449  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9451835, 'precision': 0.6728675, 'recall': 0.7573497, 'specificity': 0.7573497, 'f1': 0.7052636, 'auroc': 0.8283005, 'binary_precision': 0.36413044, 'binary_recall': 0.553719, 'binary_specificity': 0.9609805, 'binary_f1_score': 0.4393443}
confusion matrix:
      0    1
0  5763  234
1   108  134
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_11.png
early stop counter: 10
val acc:0.938262403011322, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 11,now: 2024-06-24 22:57:52.078971,epoch time: 0:20:06.280772,used: 5:34:58.335952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9320334, 'precision': 0.91715443, 'recall': 0.9057373, 'specificity': 0.9057373, 'f1': 0.91122353, 'auroc': 0.9714261, 'binary_precision': 0.88710344, 'binary_recall': 0.85016525, 'binary_specificity': 0.9613094, 'binary_f1_score': 0.86824167}
confusion matrix:
       0      1
0  40673   1637
1   2267  12863
---- Validation: 
scalar performance:
{'acc': 0.9289405, 'precision': 0.5688005, 'recall': 0.6203915, 'specificity': 0.6203915, 'f1': 0.5853202, 'auroc': 0.7348995, 'binary_precision': 0.16173752, 'binary_recall': 0.29069766, 'binary_specificity': 0.9500853, 'binary_f1_score': 0.20783846}
confusion matrix:
       0    1
0  17264  907
1    427  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93893254, 'precision': 0.65227175, 'recall': 0.7422017, 'specificity': 0.7422017, 'f1': 0.68485373, 'auroc': 0.8268887, 'binary_precision': 0.32405064, 'binary_recall': 0.5289256, 'binary_specificity': 0.9554777, 'binary_f1_score': 0.4018838}
confusion matrix:
      0    1
0  5730  267
1   114  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_12.png
early stop counter: 11
val acc:0.92894047498703, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 12,now: 2024-06-24 23:16:56.535348,epoch time: 0:19:04.456377,used: 5:54:02.792329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.93516713, 'precision': 0.9199678, 'recall': 0.91151595, 'specificity': 0.91151595, 'f1': 0.91562045, 'auroc': 0.97361636, 'binary_precision': 0.8889116, 'binary_recall': 0.8615334, 'binary_specificity': 0.96149844, 'binary_f1_score': 0.8750084}
confusion matrix:
       0      1
0  40681   1629
1   2095  13035
---- Validation: 
scalar performance:
{'acc': 0.92995256, 'precision': 0.57751656, 'recall': 0.63858134, 'specificity': 0.63858134, 'f1': 0.59692514, 'auroc': 0.76100385, 'binary_precision': 0.17795844, 'binary_recall': 0.32724252, 'binary_specificity': 0.9499202, 'binary_f1_score': 0.23054416}
confusion matrix:
       0    1
0  17261  910
1    405  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9392531, 'precision': 0.6628056, 'recall': 0.78202325, 'specificity': 0.78202325, 'f1': 0.70320404, 'auroc': 0.85626006, 'binary_precision': 0.34180138, 'binary_recall': 0.61157024, 'binary_specificity': 0.95247626, 'binary_f1_score': 0.4385185}
confusion matrix:
      0    1
0  5712  285
1    94  148
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_13.png
early stop counter: 12
val acc:0.9299525618553162, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 13,now: 2024-06-24 23:35:12.719947,epoch time: 0:18:16.184599,used: 6:12:18.976928,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93720406, 'precision': 0.92460704, 'recall': 0.9116417, 'specificity': 0.9116417, 'f1': 0.917845, 'auroc': 0.9738379, 'binary_precision': 0.89929307, 'binary_recall': 0.8576244, 'binary_specificity': 0.965659, 'binary_f1_score': 0.8779646}
confusion matrix:
       0      1
0  40858   1453
1   2154  12975
---- Validation: 
scalar performance:
{'acc': 0.92265487, 'precision': 0.5771352, 'recall': 0.6613122, 'specificity': 0.6613122, 'f1': 0.59991914, 'auroc': 0.75821626, 'binary_precision': 0.17557251, 'binary_recall': 0.3820598, 'binary_specificity': 0.94056463, 'binary_f1_score': 0.24058577}
confusion matrix:
       0     1
0  17091  1080
1    372   230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92979646, 'precision': 0.64463377, 'recall': 0.7870178, 'specificity': 0.7870178, 'f1': 0.68698144, 'auroc': 0.8473472, 'binary_precision': 0.30478087, 'binary_recall': 0.6322314, 'binary_specificity': 0.94180423, 'binary_f1_score': 0.41129032}
confusion matrix:
      0    1
0  5648  349
1    89  153
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_14.png
early stop counter: 13
val acc:0.9226548671722412, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 14,now: 2024-06-24 23:53:47.190249,epoch time: 0:18:34.470302,used: 6:30:53.447230,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.94256616, 'precision': 0.92849493, 'recall': 0.92258525, 'specificity': 0.92258525, 'f1': 0.92548203, 'auroc': 0.97749543, 'binary_precision': 0.89944625, 'binary_recall': 0.8803622, 'binary_specificity': 0.9648082, 'binary_f1_score': 0.88980186}
confusion matrix:
       0      1
0  40822   1489
1   1810  13319
---- Validation: 
scalar performance:
{'acc': 0.9281415, 'precision': 0.5891219, 'recall': 0.67699516, 'specificity': 0.67699516, 'f1': 0.6147321, 'auroc': 0.7814187, 'binary_precision': 0.19854721, 'binary_recall': 0.40863788, 'binary_specificity': 0.9453525, 'binary_f1_score': 0.26724604}
confusion matrix:
       0    1
0  17178  993
1    356  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9418176, 'precision': 0.6727324, 'recall': 0.79921913, 'specificity': 0.79921913, 'f1': 0.71573365, 'auroc': 0.86867404, 'binary_precision': 0.36027715, 'binary_recall': 0.6446281, 'binary_specificity': 0.9538102, 'binary_f1_score': 0.46222225}
confusion matrix:
      0    1
0  5720  277
1    86  156
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_15.png
early stop counter: 14
val acc:0.9281414747238159, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 15,now: 2024-06-25 00:12:14.295995,epoch time: 0:18:27.105746,used: 6:49:20.552976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9430362, 'precision': 0.9300265, 'recall': 0.92201257, 'specificity': 0.92201257, 'f1': 0.9259137, 'auroc': 0.9766545, 'binary_precision': 0.90338165, 'binary_recall': 0.87758607, 'binary_specificity': 0.966439, 'binary_f1_score': 0.890297}
confusion matrix:
       0      1
0  40891   1420
1   1852  13277
---- Validation: 
scalar performance:
{'acc': 0.93037874, 'precision': 0.5872843, 'recall': 0.66289294, 'specificity': 0.66289294, 'f1': 0.6106422, 'auroc': 0.7521528, 'binary_precision': 0.1958585, 'binary_recall': 0.37707642, 'binary_specificity': 0.9487095, 'binary_f1_score': 0.25780806}
confusion matrix:
       0    1
0  17239  932
1    375  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93941337, 'precision': 0.66710293, 'recall': 0.7999513, 'specificity': 0.7999513, 'f1': 0.7108426, 'auroc': 0.86757016, 'binary_precision': 0.34888887, 'binary_recall': 0.6487603, 'binary_specificity': 0.95114225, 'binary_f1_score': 0.4537572}
confusion matrix:
      0    1
0  5704  293
1    85  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_16.png
early stop counter: 15
val acc:0.9303787350654602, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 16,now: 2024-06-25 00:30:52.553349,epoch time: 0:18:38.257354,used: 7:07:58.810330,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9294394, 'precision': 0.9033698, 'recall': 0.9193439, 'specificity': 0.9193439, 'f1': 0.91087556, 'auroc': 0.9741569, 'binary_precision': 0.84406066, 'binary_recall': 0.89801043, 'binary_specificity': 0.94067734, 'binary_f1_score': 0.87020016}
confusion matrix:
       0      1
0  39801   2510
1   1543  13586
---- Validation: 
scalar performance:
{'acc': 0.8952751, 'precision': 0.5636344, 'recall': 0.6889273, 'specificity': 0.6889273, 'f1': 0.5833895, 'auroc': 0.7640412, 'binary_precision': 0.14626557, 'binary_recall': 0.46843854, 'binary_specificity': 0.9094161, 'binary_f1_score': 0.22292489}
confusion matrix:
       0     1
0  16525  1646
1    320   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9105626, 'precision': 0.62357837, 'recall': 0.8127022, 'specificity': 0.8127022, 'f1': 0.6659026, 'auroc': 0.8766036, 'binary_precision': 0.25987843, 'binary_recall': 0.7066116, 'binary_specificity': 0.9187927, 'binary_f1_score': 0.38}
confusion matrix:
      0    1
0  5510  487
1    71  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_17.png
early stop counter: 16
val acc:0.8952751159667969, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 17,now: 2024-06-25 00:49:31.257654,epoch time: 0:18:38.704305,used: 7:26:37.514635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.939032, 'precision': 0.91744184, 'recall': 0.92774224, 'specificity': 0.92774224, 'f1': 0.9224037, 'auroc': 0.9790212, 'binary_precision': 0.8697367, 'binary_recall': 0.90388685, 'binary_specificity': 0.95159763, 'binary_f1_score': 0.886483}
confusion matrix:
       0      1
0  40264   2048
1   1454  13674
---- Validation: 
scalar performance:
{'acc': 0.912747, 'precision': 0.58131236, 'recall': 0.7067862, 'specificity': 0.7067862, 'f1': 0.60855794, 'auroc': 0.7898625, 'binary_precision': 0.18064119, 'binary_recall': 0.48671097, 'binary_specificity': 0.92686146, 'binary_f1_score': 0.26348922}
confusion matrix:
       0     1
0  16842  1329
1    309   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9158519, 'precision': 0.6313701, 'recall': 0.819419, 'specificity': 0.819419, 'f1': 0.6760066, 'auroc': 0.8854861, 'binary_precision': 0.27503973, 'binary_recall': 0.71487606, 'binary_specificity': 0.923962, 'binary_f1_score': 0.39724454}
confusion matrix:
      0    1
0  5541  456
1    69  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_18.png
early stop counter: 17
val acc:0.9127470254898071, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 18,now: 2024-06-25 01:07:55.629763,epoch time: 0:18:24.372109,used: 7:45:01.886744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9448468, 'precision': 0.9368861, 'recall': 0.91908425, 'specificity': 0.91908425, 'f1': 0.92748165, 'auroc': 0.9800515, 'binary_precision': 0.92113787, 'binary_recall': 0.86463976, 'binary_specificity': 0.97352874, 'binary_f1_score': 0.8919951}
confusion matrix:
       0      1
0  41190   1120
1   2048  13082
---- Validation: 
scalar performance:
{'acc': 0.93432057, 'precision': 0.602709, 'recall': 0.6898237, 'specificity': 0.6898237, 'f1': 0.63029075, 'auroc': 0.7955173, 'binary_precision': 0.22493461, 'binary_recall': 0.42857143, 'binary_specificity': 0.9510759, 'binary_f1_score': 0.2950257}
confusion matrix:
       0    1
0  17282  889
1    344  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9519154, 'precision': 0.7060488, 'recall': 0.82231647, 'specificity': 0.82231647, 'f1': 0.7492444, 'auroc': 0.883481, 'binary_precision': 0.42525774, 'binary_recall': 0.6818182, 'binary_specificity': 0.96281475, 'binary_f1_score': 0.52380955}
confusion matrix:
      0    1
0  5774  223
1    77  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_19.png
early stop counter: 18
val acc:0.9343205690383911, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 19,now: 2024-06-25 01:27:00.202110,epoch time: 0:19:04.572347,used: 8:04:06.459091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9483461, 'precision': 0.9352424, 'recall': 0.93104905, 'specificity': 0.93104905, 'f1': 0.93311703, 'auroc': 0.97975266, 'binary_precision': 0.9080051, 'binary_recall': 0.89450026, 'binary_specificity': 0.96759784, 'binary_f1_score': 0.9012021}
confusion matrix:
       0      1
0  40941   1371
1   1596  13532
---- Validation: 
scalar performance:
{'acc': 0.93511957, 'precision': 0.5969513, 'recall': 0.6693572, 'specificity': 0.6693572, 'f1': 0.6209502, 'auroc': 0.78341746, 'binary_precision': 0.21481481, 'binary_recall': 0.38538206, 'binary_specificity': 0.95333225, 'binary_f1_score': 0.27586207}
confusion matrix:
       0    1
0  17323  848
1    370  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9458246, 'precision': 0.6852667, 'recall': 0.8092345, 'specificity': 0.8092345, 'f1': 0.7288633, 'auroc': 0.87000656, 'binary_precision': 0.3846154, 'binary_recall': 0.661157, 'binary_specificity': 0.957312, 'binary_f1_score': 0.4863222}
confusion matrix:
      0    1
0  5741  256
1    82  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_20.png
early stop counter: 19
val acc:0.9351195693016052, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 20,now: 2024-06-25 01:45:10.934854,epoch time: 0:18:10.732744,used: 8:22:17.191835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.94690114, 'precision': 0.9358871, 'recall': 0.9260408, 'specificity': 0.9260408, 'f1': 0.9308076, 'auroc': 0.9793395, 'binary_precision': 0.91347206, 'binary_recall': 0.8819564, 'binary_specificity': 0.97012526, 'binary_f1_score': 0.89743763}
confusion matrix:
       0      1
0  41046   1264
1   1786  13344
---- Validation: 
scalar performance:
{'acc': 0.94151175, 'precision': 0.61249274, 'recall': 0.6782805, 'specificity': 0.6782805, 'f1': 0.636387, 'auroc': 0.78841746, 'binary_precision': 0.24537988, 'binary_recall': 0.39700997, 'binary_specificity': 0.9595509, 'binary_f1_score': 0.3032995}
confusion matrix:
       0    1
0  17436  735
1    363  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95031255, 'precision': 0.7000949, 'recall': 0.8175172, 'specificity': 0.8175172, 'f1': 0.7432003, 'auroc': 0.8760599, 'binary_precision': 0.4137056, 'binary_recall': 0.6735537, 'binary_specificity': 0.96148074, 'binary_f1_score': 0.5125786}
confusion matrix:
      0    1
0  5766  231
1    79  163
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_21.png
early stop counter: 20
val acc:0.9415117502212524, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 21,now: 2024-06-25 02:05:00.312331,epoch time: 0:19:49.377477,used: 8:42:06.569312,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.93793523, 'precision': 0.91677374, 'recall': 0.9251348, 'specificity': 0.9251348, 'f1': 0.92083037, 'auroc': 0.9764377, 'binary_precision': 0.8704119, 'binary_recall': 0.89808327, 'binary_specificity': 0.9521862, 'binary_f1_score': 0.8840311}
confusion matrix:
       0      1
0  40287   2023
1   1542  13588
---- Validation: 
scalar performance:
{'acc': 0.9270229, 'precision': 0.57753676, 'recall': 0.64831066, 'specificity': 0.64831066, 'f1': 0.59858686, 'auroc': 0.7457951, 'binary_precision': 0.17731093, 'binary_recall': 0.35049835, 'binary_specificity': 0.94612294, 'binary_f1_score': 0.23549108}
confusion matrix:
       0    1
0  17192  979
1    391  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9275525, 'precision': 0.64821744, 'recall': 0.8195572, 'specificity': 0.8195572, 'f1': 0.6953071, 'auroc': 0.88588643, 'binary_precision': 0.3090909, 'binary_recall': 0.70247936, 'binary_specificity': 0.93663496, 'binary_f1_score': 0.42929298}
confusion matrix:
      0    1
0  5617  380
1    72  170
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_22.png
early stop counter: 21
val acc:0.9270228743553162, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 22,now: 2024-06-25 02:24:10.123607,epoch time: 0:19:09.811276,used: 9:01:16.380588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9463092, 'precision': 0.9290589, 'recall': 0.9333215, 'specificity': 0.9333215, 'f1': 0.9311595, 'auroc': 0.9802815, 'binary_precision': 0.89196223, 'binary_recall': 0.90587616, 'binary_specificity': 0.96076673, 'binary_f1_score': 0.8988653}
confusion matrix:
       0      1
0  40651   1660
1   1424  13705
---- Validation: 
scalar performance:
{'acc': 0.92297447, 'precision': 0.58238417, 'recall': 0.67593217, 'specificity': 0.67593217, 'f1': 0.6073967, 'auroc': 0.7661021, 'binary_precision': 0.18507463, 'binary_recall': 0.41196012, 'binary_specificity': 0.9399043, 'binary_f1_score': 0.2554068}
confusion matrix:
       0     1
0  17079  1092
1    354   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9339638, 'precision': 0.6599697, 'recall': 0.8209094, 'specificity': 0.8209094, 'f1': 0.70776856, 'auroc': 0.8720614, 'binary_precision': 0.33267716, 'binary_recall': 0.6983471, 'binary_specificity': 0.9434717, 'binary_f1_score': 0.45066667}
confusion matrix:
      0    1
0  5658  339
1    73  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_23.png
early stop counter: 22
val acc:0.9229744672775269, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 23,now: 2024-06-25 02:42:52.034607,epoch time: 0:18:41.911000,used: 9:19:58.291588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9263231, 'precision': 0.89646685, 'recall': 0.92264473, 'specificity': 0.92264473, 'f1': 0.9081959, 'auroc': 0.97610533, 'binary_precision': 0.8246158, 'binary_recall': 0.9148711, 'binary_specificity': 0.9304183, 'binary_f1_score': 0.8674019}
confusion matrix:
       0      1
0  39366   2944
1   1288  13842
---- Validation: 
scalar performance:
{'acc': 0.9075268, 'precision': 0.5758943, 'recall': 0.7032866, 'specificity': 0.7032866, 'f1': 0.6012212, 'auroc': 0.78491294, 'binary_precision': 0.16996507, 'binary_recall': 0.48504984, 'binary_specificity': 0.92152333, 'binary_f1_score': 0.25172412}
confusion matrix:
       0     1
0  16745  1426
1    310   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9123257, 'precision': 0.6280303, 'recall': 0.823533, 'specificity': 0.823533, 'f1': 0.67215276, 'auroc': 0.8916166, 'binary_precision': 0.2678843, 'binary_recall': 0.72727275, 'binary_specificity': 0.91979325, 'binary_f1_score': 0.39154616}
confusion matrix:
      0    1
0  5516  481
1    66  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_24.png
early stop counter: 23
val acc:0.9075267910957336, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 24,now: 2024-06-25 03:01:39.823042,epoch time: 0:18:47.788435,used: 9:38:46.080023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9459436, 'precision': 0.92743105, 'recall': 0.93460196, 'specificity': 0.93460196, 'f1': 0.9309287, 'auroc': 0.98151183, 'binary_precision': 0.8871217, 'binary_recall': 0.91063523, 'binary_specificity': 0.9585687, 'binary_f1_score': 0.89872473}
confusion matrix:
       0      1
0  40558   1753
1   1352  13777
---- Validation: 
scalar performance:
{'acc': 0.91780746, 'precision': 0.580336, 'recall': 0.6869149, 'specificity': 0.6869149, 'f1': 0.6060851, 'auroc': 0.76392317, 'binary_precision': 0.18014956, 'binary_recall': 0.44019935, 'binary_specificity': 0.9336305, 'binary_f1_score': 0.2556681}
confusion matrix:
       0     1
0  16965  1206
1    337   265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.918737, 'precision': 0.6358816, 'recall': 0.8229025, 'specificity': 0.8229025, 'f1': 0.68169856, 'auroc': 0.8812188, 'binary_precision': 0.28384992, 'binary_recall': 0.71900827, 'binary_specificity': 0.92679673, 'binary_f1_score': 0.40701756}
confusion matrix:
      0    1
0  5558  439
1    68  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_25.png
early stop counter: 24
val acc:0.9178074598312378, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 25,now: 2024-06-25 03:20:48.334515,epoch time: 0:19:08.511473,used: 9:57:54.591496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9416086, 'precision': 0.9241717, 'recall': 0.9256084, 'specificity': 0.9256084, 'f1': 0.9248865, 'auroc': 0.9772156, 'binary_precision': 0.8871063, 'binary_recall': 0.8917972, 'binary_specificity': 0.95941955, 'binary_f1_score': 0.8894456}
confusion matrix:
       0      1
0  40594   1717
1   1637  13492
---- Validation: 
scalar performance:
{'acc': 0.9366111, 'precision': 0.605487, 'recall': 0.6861886, 'specificity': 0.6861886, 'f1': 0.63216436, 'auroc': 0.7777326, 'binary_precision': 0.23076923, 'binary_recall': 0.41860464, 'binary_specificity': 0.9537725, 'binary_f1_score': 0.29752064}
confusion matrix:
       0    1
0  17331  840
1    350  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94245875, 'precision': 0.6790357, 'recall': 0.82334554, 'specificity': 0.82334554, 'f1': 0.72649276, 'auroc': 0.88115406, 'binary_precision': 0.37086093, 'binary_recall': 0.6942149, 'binary_specificity': 0.95247626, 'binary_f1_score': 0.48345318}
confusion matrix:
      0    1
0  5712  285
1    74  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_26.png
early stop counter: 25
val acc:0.9366111159324646, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 26,now: 2024-06-25 03:38:44.983848,epoch time: 0:17:56.649333,used: 10:15:51.240829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.94643104, 'precision': 0.92268956, 'recall': 0.94453096, 'specificity': 0.94453096, 'f1': 0.9327562, 'auroc': 0.9851539, 'binary_precision': 0.8673127, 'binary_recall': 0.9405155, 'binary_specificity': 0.94854647, 'binary_f1_score': 0.9024321}
confusion matrix:
       0      1
0  40133   2177
1    900  14230
---- Validation: 
scalar performance:
{'acc': 0.9198317, 'precision': 0.5944161, 'recall': 0.72811294, 'specificity': 0.72811294, 'f1': 0.62629056, 'auroc': 0.8025992, 'binary_precision': 0.20547946, 'binary_recall': 0.5232558, 'binary_specificity': 0.9329701, 'binary_f1_score': 0.29508197}
confusion matrix:
       0     1
0  16953  1218
1    287   315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92883474, 'precision': 0.6513613, 'recall': 0.82418966, 'specificity': 0.82418966, 'f1': 0.69928354, 'auroc': 0.88815296, 'binary_precision': 0.31501833, 'binary_recall': 0.7107438, 'binary_specificity': 0.9376355, 'binary_f1_score': 0.43654826}
confusion matrix:
      0    1
0  5623  374
1    70  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_27.png
early stop counter: 26
val acc:0.9198316931724548, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 27,now: 2024-06-25 03:58:53.927732,epoch time: 0:20:08.943884,used: 10:36:00.184713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.94533426, 'precision': 0.9263016, 'recall': 0.93438184, 'specificity': 0.93438184, 'f1': 0.93022966, 'auroc': 0.98166037, 'binary_precision': 0.88468945, 'binary_recall': 0.9112359, 'binary_specificity': 0.95752776, 'binary_f1_score': 0.8977665}
confusion matrix:
       0      1
0  40513   1797
1   1343  13787
---- Validation: 
scalar performance:
{'acc': 0.9319235, 'precision': 0.60105133, 'recall': 0.6966159, 'specificity': 0.6966159, 'f1': 0.62985665, 'auroc': 0.7921984, 'binary_precision': 0.22112212, 'binary_recall': 0.4451827, 'binary_specificity': 0.94804907, 'binary_f1_score': 0.29547963}
confusion matrix:
       0    1
0  17227  944
1    334  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93588716, 'precision': 0.6631903, 'recall': 0.81794447, 'specificity': 0.81794447, 'f1': 0.71049047, 'auroc': 0.8775772, 'binary_precision': 0.3394309, 'binary_recall': 0.69008267, 'binary_specificity': 0.94580626, 'binary_f1_score': 0.45504087}
confusion matrix:
      0    1
0  5672  325
1    75  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_28.png
early stop counter: 27
val acc:0.931923508644104, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 28,now: 2024-06-25 04:18:13.204069,epoch time: 0:19:19.276337,used: 10:55:19.461050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9498085, 'precision': 0.936195, 'recall': 0.934168, 'specificity': 0.934168, 'f1': 0.9351748, 'auroc': 0.98213506, 'binary_precision': 0.90765643, 'binary_recall': 0.9011171, 'binary_specificity': 0.96721894, 'binary_f1_score': 0.90437496}
confusion matrix:
       0      1
0  40924   1387
1   1496  13633
---- Validation: 
scalar performance:
{'acc': 0.94097906, 'precision': 0.6178683, 'recall': 0.69727844, 'specificity': 0.69727844, 'f1': 0.6455281, 'auroc': 0.78074175, 'binary_precision': 0.25484496, 'binary_recall': 0.43687707, 'binary_specificity': 0.9576798, 'binary_f1_score': 0.32190943}
confusion matrix:
       0    1
0  17402  769
1    339  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95640326, 'precision': 0.7218136, 'recall': 0.81672, 'specificity': 0.81672, 'f1': 0.7595998, 'auroc': 0.8775462, 'binary_precision': 0.45738637, 'binary_recall': 0.6652893, 'binary_specificity': 0.96815073, 'binary_f1_score': 0.54208755}
confusion matrix:
      0    1
0  5806  191
1    81  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_29.png
early stop counter: 28
val acc:0.9409790635108948, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 29,now: 2024-06-25 04:36:25.671695,epoch time: 0:18:12.467626,used: 11:13:31.928676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.944516, 'precision': 0.92411697, 'recall': 0.9351828, 'specificity': 0.9351828, 'f1': 0.9294369, 'auroc': 0.9812701, 'binary_precision': 0.87891865, 'binary_recall': 0.91546035, 'binary_specificity': 0.95490533, 'binary_f1_score': 0.89681745}
confusion matrix:
       0      1
0  40403   1908
1   1279  13850
---- Validation: 
scalar performance:
{'acc': 0.93101794, 'precision': 0.60328376, 'recall': 0.70819384, 'specificity': 0.70819384, 'f1': 0.6339239, 'auroc': 0.79039353, 'binary_precision': 0.22478157, 'binary_recall': 0.47009966, 'binary_specificity': 0.94628805, 'binary_f1_score': 0.30413756}
confusion matrix:
       0    1
0  17195  976
1    319  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9379708, 'precision': 0.6709355, 'recall': 0.83489025, 'specificity': 0.83489025, 'f1': 0.7209684, 'auroc': 0.8911791, 'binary_precision': 0.35353535, 'binary_recall': 0.7231405, 'binary_specificity': 0.94664, 'binary_f1_score': 0.47489822}
confusion matrix:
      0    1
0  5677  320
1    67  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21552886_30.png
early stop counter: 29
val acc:0.9310179352760315, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9610514640808105 / 0.9656996130943298
after epoch: 30,now: 2024-06-25 04:55:14.915321,epoch time: 0:18:49.243626,used: 11:32:21.172302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_17_22_53_seed_2_21552886
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:32:21.172302 at 2024-06-25 04:55:14.915321
persisted model performance metric: 

scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.662799, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9656996, 'precision': 0.8244052, 'recall': 0.6074197, 'specificity': 0.6074197, 'f1': 0.65682423, 'auroc': 0.77560407, 'binary_precision': 0.67948717, 'binary_recall': 0.21900827, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.33125}
confusion matrix:
      0   1
0  5972  25
1   189  53
results aggregation path: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_irm_lr1e5_bs16_classbalancing10/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204077 KiB | 632448 KiB |   1712 TiB |   1712 TiB |
|       from large pool | 167040 KiB | 559724 KiB |   1710 TiB |   1710 TiB |
|       from small pool |  37037 KiB |  75475 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204077 KiB | 632448 KiB |   1712 TiB |   1712 TiB |
|       from large pool | 167040 KiB | 559724 KiB |   1710 TiB |   1710 TiB |
|       from small pool |  37037 KiB |  75475 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 625043 KiB |   1689 TiB |   1689 TiB |
|       from large pool | 165120 KiB | 553452 KiB |   1687 TiB |   1687 TiB |
|       from small pool |  35967 KiB |  74337 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 778240 KiB | 778240 KiB |   1674 MiB |    914 MiB |
|       from large pool | 702464 KiB | 702464 KiB |   1548 MiB |    862 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    126 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  78546 KiB | 209453 KiB |   1156 TiB |   1156 TiB |
|       from large pool |  68480 KiB | 208064 KiB |   1153 TiB |   1153 TiB |
|       from small pool |  10066 KiB |  19715 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    7949    |  348181 K  |  348178 K  |
|       from large pool |      36    |      76    |  118398 K  |  118397 K  |
|       from small pool |    3204    |    7911    |  229783 K  |  229780 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    7949    |  348181 K  |  348178 K  |
|       from large pool |      36    |      76    |  118398 K  |  118397 K  |
|       from small pool |    3204    |    7911    |  229783 K  |  229780 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      53    |      90    |      37    |
|       from large pool |      16    |      16    |      27    |      11    |
|       from small pool |      37    |      37    |      63    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      52    |    3604    |  162115 K  |  162115 K  |
|       from large pool |       5    |      13    |   48940 K  |   48940 K  |
|       from small pool |      47    |    3599    |  113174 K  |  113174 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 632448 KiB |   1712 TiB |   1712 TiB |
|       from large pool |  16640 KiB | 559724 KiB |   1710 TiB |   1710 TiB |
|       from small pool |      0 KiB |  75475 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 632448 KiB |   1712 TiB |   1712 TiB |
|       from large pool |  16640 KiB | 559724 KiB |   1710 TiB |   1710 TiB |
|       from small pool |      0 KiB |  75475 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 625043 KiB |   1689 TiB |   1689 TiB |
|       from large pool |  16640 KiB | 553452 KiB |   1687 TiB |   1687 TiB |
|       from small pool |      0 KiB |  74337 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 282624 KiB | 778240 KiB |   1674 MiB |   1398 MiB |
|       from large pool | 235520 KiB | 702464 KiB |   1548 MiB |   1318 MiB |
|       from small pool |  47104 KiB |  75776 KiB |    126 MiB |     80 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB |   1156 TiB |   1156 TiB |
|       from large pool |  55040 KiB | 208064 KiB |   1153 TiB |   1153 TiB |
|       from small pool |      0 KiB |  19715 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7949    |  348181 K  |  348181 K  |
|       from large pool |       2    |      76    |  118398 K  |  118398 K  |
|       from small pool |       0    |    7911    |  229783 K  |  229783 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7949    |  348181 K  |  348181 K  |
|       from large pool |       2    |      76    |  118398 K  |  118398 K  |
|       from small pool |       0    |    7911    |  229783 K  |  229783 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      53    |      90    |      57    |
|       from large pool |      10    |      16    |      27    |      17    |
|       from small pool |      23    |      37    |      63    |      40    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3604    |  162116 K  |  162116 K  |
|       from large pool |       3    |      13    |   48940 K  |   48940 K  |
|       from small pool |       0    |    3599    |  113176 K  |  113176 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jun 25 04:56:28 2024]
Finished job 0.
1 of 1 steps (100%) done
