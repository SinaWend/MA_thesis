Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul  6 06:41:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433

 Experiment start at: 2024-07-06 06:49:48.883741
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9625351, 'precision': 0.9714038, 'recall': 0.93094254, 'specificity': 0.93094254, 'f1': 0.9489522, 'auroc': 0.9849715, 'binary_precision': 0.98759687, 'binary_recall': 0.86566556, 'binary_specificity': 0.9962196, 'binary_f1_score': 0.9226201}
confusion matrix:
       0      1
0  42163    160
1   1977  12740
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9646126, 'precision': 0.71996266, 'recall': 0.6141524, 'specificity': 0.6141524, 'f1': 0.648488, 'auroc': 0.88924086, 'binary_precision': 0.46646342, 'binary_recall': 0.23794712, 'binary_specificity': 0.9903576, 'binary_f1_score': 0.31513903}
confusion matrix:
       0    1
0  17974  175
1    490  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7353723, 'recall': 0.5898677, 'specificity': 0.5898677, 'f1': 0.6261789, 'auroc': 0.89258933, 'binary_precision': 0.5051546, 'binary_recall': 0.18773946, 'binary_specificity': 0.991996, 'binary_f1_score': 0.273743}
confusion matrix:
      0   1
0  5949  48
1   212  49
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-06 07:49:47.329819,epoch time: 0:59:58.446078,used: 0:59:58.446078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97224754, 'precision': 0.97557425, 'recall': 0.9516641, 'specificity': 0.9516641, 'f1': 0.962839, 'auroc': 0.9902353, 'binary_precision': 0.9819436, 'binary_recall': 0.90914035, 'binary_specificity': 0.99418783, 'binary_f1_score': 0.9441406}
confusion matrix:
       0      1
0  42079    246
1   1337  13378
---- Validation: 
scalar performance:
{'acc': 0.95317155, 'precision': 0.67888427, 'recall': 0.75749016, 'specificity': 0.75749016, 'f1': 0.71, 'auroc': 0.9126708, 'binary_precision': 0.37407014, 'binary_recall': 0.5474339, 'binary_specificity': 0.9675464, 'binary_f1_score': 0.44444448}
confusion matrix:
       0    1
0  17560  589
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.7348888, 'recall': 0.7960877, 'specificity': 0.7960877, 'f1': 0.7614037, 'auroc': 0.91716933, 'binary_precision': 0.4864865, 'binary_recall': 0.62068963, 'binary_specificity': 0.97148573, 'binary_f1_score': 0.54545456}
confusion matrix:
      0    1
0  5826  171
1    99  162
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_2.png
early stop counter: 1
val acc:0.9531715512275696, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 2,now: 2024-07-06 08:49:21.217000,epoch time: 0:59:33.887181,used: 1:59:32.333259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9740007, 'precision': 0.9796989, 'recall': 0.95243716, 'specificity': 0.95243716, 'f1': 0.96506906, 'auroc': 0.9927236, 'binary_precision': 0.99050796, 'binary_recall': 0.9078983, 'binary_specificity': 0.996976, 'binary_f1_score': 0.94740576}
confusion matrix:
       0      1
0  42200    128
1   1355  13357
---- Validation: 
scalar performance:
{'acc': 0.948808, 'precision': 0.66614115, 'recall': 0.7649818, 'specificity': 0.7649818, 'f1': 0.70231974, 'auroc': 0.9142117, 'binary_precision': 0.34795043, 'binary_recall': 0.5676516, 'binary_specificity': 0.962312, 'binary_f1_score': 0.43144205}
confusion matrix:
       0    1
0  17465  684
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95158195, 'precision': 0.7152196, 'recall': 0.8116597, 'specificity': 0.8116597, 'f1': 0.753078, 'auroc': 0.91729647, 'binary_precision': 0.44559586, 'binary_recall': 0.65900385, 'binary_specificity': 0.9643155, 'binary_f1_score': 0.5316847}
confusion matrix:
      0    1
0  5783  214
1    89  172
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_3.png
early stop counter: 2
val acc:0.9488080143928528, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 3,now: 2024-07-06 09:48:31.864722,epoch time: 0:59:10.647722,used: 2:58:42.980981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9785589, 'precision': 0.98205924, 'recall': 0.9618621, 'specificity': 0.9618621, 'f1': 0.9714111, 'auroc': 0.99474347, 'binary_precision': 0.9888422, 'binary_recall': 0.9273629, 'binary_specificity': 0.9963613, 'binary_f1_score': 0.95711625}
confusion matrix:
       0      1
0  42169    154
1   1069  13648
---- Validation: 
scalar performance:
{'acc': 0.94790334, 'precision': 0.66675675, 'recall': 0.77951455, 'specificity': 0.77951455, 'f1': 0.70646596, 'auroc': 0.9171848, 'binary_precision': 0.34810126, 'binary_recall': 0.59875584, 'binary_specificity': 0.96027327, 'binary_f1_score': 0.44025156}
confusion matrix:
       0    1
0  17428  721
1    258  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480665, 'precision': 0.70505995, 'recall': 0.82265174, 'specificity': 0.82265174, 'f1': 0.74834627, 'auroc': 0.91708183, 'binary_precision': 0.4241706, 'binary_recall': 0.68582374, 'binary_specificity': 0.95947975, 'binary_f1_score': 0.5241581}
confusion matrix:
      0    1
0  5754  243
1    82  179
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_4.png
early stop counter: 3
val acc:0.9479033350944519, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 4,now: 2024-07-06 10:47:30.804764,epoch time: 0:58:58.940042,used: 3:57:41.921023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9815568, 'precision': 0.98278964, 'recall': 0.96886086, 'specificity': 0.96886086, 'f1': 0.9755626, 'auroc': 0.9952551, 'binary_precision': 0.9852241, 'binary_recall': 0.9426358, 'binary_specificity': 0.9950859, 'binary_f1_score': 0.9634595}
confusion matrix:
       0      1
0  42119    208
1    844  13869
---- Validation: 
scalar performance:
{'acc': 0.94747764, 'precision': 0.66935325, 'recall': 0.79729545, 'specificity': 0.79729545, 'f1': 0.7127998, 'auroc': 0.91917753, 'binary_precision': 0.35197935, 'binary_recall': 0.63608086, 'binary_specificity': 0.9585101, 'binary_f1_score': 0.4531856}
confusion matrix:
       0    1
0  17396  753
1    234  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9487057, 'precision': 0.70859605, 'recall': 0.83397925, 'specificity': 0.83397925, 'f1': 0.75415504, 'auroc': 0.91748416, 'binary_precision': 0.43023255, 'binary_recall': 0.70881224, 'binary_specificity': 0.95914626, 'binary_f1_score': 0.5354559}
confusion matrix:
      0    1
0  5752  245
1    76  185
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_5.png
early stop counter: 4
val acc:0.9474776387214661, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 5,now: 2024-07-06 11:46:18.263516,epoch time: 0:58:47.458752,used: 4:56:29.379775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.981662, 'precision': 0.98314214, 'recall': 0.9688044, 'specificity': 0.9688044, 'f1': 0.97569525, 'auroc': 0.9957781, 'binary_precision': 0.98606175, 'binary_recall': 0.94223976, 'binary_specificity': 0.9953691, 'binary_f1_score': 0.9636528}
confusion matrix:
       0      1
0  42128    196
1    850  13866
---- Validation: 
scalar performance:
{'acc': 0.95125586, 'precision': 0.68111646, 'recall': 0.8007516, 'specificity': 0.8007516, 'f1': 0.72370183, 'auroc': 0.9211395, 'binary_precision': 0.37534246, 'binary_recall': 0.63919127, 'binary_specificity': 0.962312, 'binary_f1_score': 0.4729574}
confusion matrix:
       0    1
0  17465  684
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9541387, 'precision': 0.72693706, 'recall': 0.8349817, 'specificity': 0.8349817, 'f1': 0.76881754, 'auroc': 0.9184623, 'binary_precision': 0.46700507, 'binary_recall': 0.70498085, 'binary_specificity': 0.9649825, 'binary_f1_score': 0.5618321}
confusion matrix:
      0    1
0  5787  210
1    77  184
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_6.png
early stop counter: 5
val acc:0.9512558579444885, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 6,now: 2024-07-06 12:45:20.893775,epoch time: 0:59:02.630259,used: 5:55:32.010034,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9840463, 'precision': 0.9854588, 'recall': 0.97276366, 'specificity': 0.97276366, 'f1': 0.9788941, 'auroc': 0.996627, 'binary_precision': 0.98826027, 'binary_recall': 0.94944966, 'binary_specificity': 0.9960777, 'binary_f1_score': 0.9684663}
confusion matrix:
       0      1
0  42156    166
1    744  13974
---- Validation: 
scalar performance:
{'acc': 0.95120263, 'precision': 0.68094486, 'recall': 0.800724, 'specificity': 0.800724, 'f1': 0.7235516, 'auroc': 0.921474, 'binary_precision': 0.375, 'binary_recall': 0.63919127, 'binary_specificity': 0.96225685, 'binary_f1_score': 0.47268546}
confusion matrix:
       0    1
0  17464  685
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.73690945, 'recall': 0.82723737, 'specificity': 0.82723737, 'f1': 0.77367586, 'auroc': 0.91563404, 'binary_precision': 0.48773843, 'binary_recall': 0.68582374, 'binary_specificity': 0.968651, 'binary_f1_score': 0.5700637}
confusion matrix:
      0    1
0  5809  188
1    82  179
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_7.png
early stop counter: 6
val acc:0.9512026309967041, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 7,now: 2024-07-06 13:44:15.774915,epoch time: 0:58:54.881140,used: 6:54:26.891174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98546636, 'precision': 0.9866983, 'recall': 0.9752464, 'specificity': 0.9752464, 'f1': 0.9807961, 'auroc': 0.9967853, 'binary_precision': 0.9891511, 'binary_recall': 0.95413154, 'binary_specificity': 0.9963614, 'binary_f1_score': 0.9713258}
confusion matrix:
       0      1
0  42170    154
1    675  14041
---- Validation: 
scalar performance:
{'acc': 0.94944656, 'precision': 0.6773412, 'recall': 0.80956566, 'specificity': 0.80956566, 'f1': 0.7225442, 'auroc': 0.9215432, 'binary_precision': 0.36709955, 'binary_recall': 0.65940905, 'binary_specificity': 0.9597223, 'binary_f1_score': 0.47163516}
confusion matrix:
       0    1
0  17418  731
1    219  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.7307266, 'recall': 0.8300683, 'specificity': 0.8300683, 'f1': 0.770141, 'auroc': 0.9145328, 'binary_precision': 0.47506562, 'binary_recall': 0.6934866, 'binary_specificity': 0.96665, 'binary_f1_score': 0.5638629}
confusion matrix:
      0    1
0  5797  200
1    80  181
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_8.png
early stop counter: 7
val acc:0.9494465589523315, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 8,now: 2024-07-06 14:42:40.229181,epoch time: 0:58:24.454266,used: 7:52:51.345440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9859747, 'precision': 0.9865378, 'recall': 0.9767194, 'specificity': 0.9767194, 'f1': 0.9814987, 'auroc': 0.9972439, 'binary_precision': 0.9876647, 'binary_recall': 0.9575972, 'binary_specificity': 0.9958416, 'binary_f1_score': 0.9723985}
confusion matrix:
       0      1
0  42148    176
1    624  14092
---- Validation: 
scalar performance:
{'acc': 0.93837804, 'precision': 0.6531431, 'recall': 0.82183665, 'specificity': 0.82183665, 'f1': 0.7018149, 'auroc': 0.9212271, 'binary_precision': 0.31750533, 'binary_recall': 0.6967341, 'binary_specificity': 0.94693923, 'binary_f1_score': 0.43622202}
confusion matrix:
       0    1
0  17186  963
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93720037, 'precision': 0.6793687, 'recall': 0.83713794, 'specificity': 0.83713794, 'f1': 0.7290622, 'auroc': 0.91585815, 'binary_precision': 0.37109375, 'binary_recall': 0.72796935, 'binary_specificity': 0.94630647, 'binary_f1_score': 0.4915912}
confusion matrix:
      0    1
0  5675  322
1    71  190
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_9.png
early stop counter: 8
val acc:0.9383780360221863, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 9,now: 2024-07-06 15:41:36.048748,epoch time: 0:58:55.819567,used: 8:51:47.165007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.984432, 'precision': 0.988047, 'recall': 0.9713396, 'specificity': 0.9713396, 'f1': 0.9793217, 'auroc': 0.9973093, 'binary_precision': 0.995131, 'binary_recall': 0.9442859, 'binary_specificity': 0.9983933, 'binary_f1_score': 0.969042}
confusion matrix:
       0      1
0  42254     68
1    820  13898
---- Validation: 
scalar performance:
{'acc': 0.95769477, 'precision': 0.6982709, 'recall': 0.7643322, 'specificity': 0.7643322, 'f1': 0.7259098, 'auroc': 0.91819525, 'binary_precision': 0.4124424, 'binary_recall': 0.55676514, 'binary_specificity': 0.9718993, 'binary_f1_score': 0.47385836}
confusion matrix:
       0    1
0  17639  510
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.74599004, 'recall': 0.81008124, 'specificity': 0.81008124, 'f1': 0.77377534, 'auroc': 0.9057677, 'binary_precision': 0.5075075, 'binary_recall': 0.6475096, 'binary_specificity': 0.972653, 'binary_f1_score': 0.56902355}
confusion matrix:
      0    1
0  5833  164
1    92  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_10.png
new oracle model saved
early stop counter: 9
val acc:0.9576947689056396, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.959092378616333
after epoch: 10,now: 2024-07-06 16:40:29.058441,epoch time: 0:58:53.009693,used: 9:50:40.174700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9869214, 'precision': 0.98879623, 'recall': 0.9770013, 'specificity': 0.9770013, 'f1': 0.98271286, 'auroc': 0.9975163, 'binary_precision': 0.9925252, 'binary_recall': 0.95650697, 'binary_specificity': 0.9974956, 'binary_f1_score': 0.97418326}
confusion matrix:
       0      1
0  42219    106
1    640  14075
---- Validation: 
scalar performance:
{'acc': 0.9619519, 'precision': 0.71646094, 'recall': 0.74328446, 'specificity': 0.74328446, 'f1': 0.7289889, 'auroc': 0.912972, 'binary_precision': 0.45041323, 'binary_recall': 0.5085537, 'binary_specificity': 0.9780153, 'binary_f1_score': 0.47772098}
confusion matrix:
       0    1
0  17750  399
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.7797149, 'recall': 0.7930105, 'specificity': 0.7930105, 'f1': 0.7861876, 'auroc': 0.8986262, 'binary_precision': 0.57664233, 'binary_recall': 0.60536397, 'binary_specificity': 0.980657, 'binary_f1_score': 0.59065413}
confusion matrix:
      0    1
0  5881  116
1   103  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_11.png
new oracle model saved
early stop counter: 10
val acc:0.9619519114494324, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9650048017501831
after epoch: 11,now: 2024-07-06 17:38:54.777711,epoch time: 0:58:25.719270,used: 10:49:05.893970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98799086, 'precision': 0.98972386, 'recall': 0.9788772, 'specificity': 0.9788772, 'f1': 0.9841435, 'auroc': 0.99769783, 'binary_precision': 0.9931815, 'binary_recall': 0.96004623, 'binary_specificity': 0.9977081, 'binary_f1_score': 0.97633284}
confusion matrix:
       0      1
0  42226     97
1    588  14129
---- Validation: 
scalar performance:
{'acc': 0.9571094, 'precision': 0.6994611, 'recall': 0.78653085, 'specificity': 0.78653085, 'f1': 0.73406535, 'auroc': 0.92080414, 'binary_precision': 0.41320553, 'binary_recall': 0.60342145, 'binary_specificity': 0.9696402, 'binary_f1_score': 0.49051833}
confusion matrix:
       0    1
0  17598  551
1    255  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.74272174, 'recall': 0.82065845, 'specificity': 0.82065845, 'f1': 0.7754539, 'auroc': 0.90624577, 'binary_precision': 0.5, 'binary_recall': 0.6704981, 'binary_specificity': 0.97081876, 'binary_f1_score': 0.5728314}
confusion matrix:
      0    1
0  5822  175
1    86  175
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_12.png
early stop counter: 11
val acc:0.9571093916893005, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9650048017501831
after epoch: 12,now: 2024-07-06 18:37:05.552520,epoch time: 0:58:10.774809,used: 11:47:16.668779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98734224, 'precision': 0.98957103, 'recall': 0.97735274, 'specificity': 0.97735274, 'f1': 0.9832629, 'auroc': 0.9979253, 'binary_precision': 0.9939989, 'binary_recall': 0.9567138, 'binary_specificity': 0.9979917, 'binary_f1_score': 0.975}
confusion matrix:
       0      1
0  42239     85
1    637  14079
---- Validation: 
scalar performance:
{'acc': 0.95875907, 'precision': 0.705768, 'recall': 0.78213453, 'specificity': 0.78213453, 'f1': 0.73713565, 'auroc': 0.91949904, 'binary_precision': 0.4261745, 'binary_recall': 0.592535, 'binary_specificity': 0.971734, 'binary_f1_score': 0.49577096}
confusion matrix:
       0    1
0  17636  513
1    262  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.77044475, 'recall': 0.8088345, 'specificity': 0.8088345, 'f1': 0.7881887, 'auroc': 0.9016731, 'binary_precision': 0.5566667, 'binary_recall': 0.63984674, 'binary_specificity': 0.97782224, 'binary_f1_score': 0.5953654}
confusion matrix:
      0    1
0  5864  133
1    94  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_13.png
early stop counter: 12
val acc:0.958759069442749, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9650048017501831
after epoch: 13,now: 2024-07-06 19:35:42.157100,epoch time: 0:58:36.604580,used: 12:45:53.273359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9890954, 'precision': 0.9888743, 'recall': 0.98256975, 'specificity': 0.98256975, 'f1': 0.98566854, 'auroc': 0.99823606, 'binary_precision': 0.98842686, 'binary_recall': 0.96908545, 'binary_specificity': 0.99605405, 'binary_f1_score': 0.9786606}
confusion matrix:
       0      1
0  42155    167
1    455  14263
---- Validation: 
scalar performance:
{'acc': 0.9427416, 'precision': 0.66205454, 'recall': 0.81959534, 'specificity': 0.81959534, 'f1': 0.710408, 'auroc': 0.9207844, 'binary_precision': 0.33561122, 'binary_recall': 0.6874028, 'binary_specificity': 0.95178795, 'binary_f1_score': 0.45102036}
confusion matrix:
       0    1
0  17274  875
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94167465, 'precision': 0.6872999, 'recall': 0.8229814, 'specificity': 0.8229814, 'f1': 0.73348784, 'auroc': 0.89998114, 'binary_precision': 0.38841203, 'binary_recall': 0.6934866, 'binary_specificity': 0.95247626, 'binary_f1_score': 0.49793673}
confusion matrix:
      0    1
0  5712  285
1    80  181
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_14.png
early stop counter: 13
val acc:0.9427415728569031, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9650048017501831
after epoch: 14,now: 2024-07-06 20:34:02.574527,epoch time: 0:58:20.417427,used: 13:44:13.690786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98886746, 'precision': 0.99056756, 'recall': 0.9803309, 'specificity': 0.9803309, 'f1': 0.9853096, 'auroc': 0.9979081, 'binary_precision': 0.99396616, 'binary_recall': 0.9626937, 'binary_specificity': 0.9979681, 'binary_f1_score': 0.9780801}
confusion matrix:
       0      1
0  42238     86
1    549  14167
---- Validation: 
scalar performance:
{'acc': 0.959983, 'precision': 0.70925176, 'recall': 0.767017, 'specificity': 0.767017, 'f1': 0.73415315, 'auroc': 0.9160955, 'binary_precision': 0.43425813, 'binary_recall': 0.5598756, 'binary_specificity': 0.97415835, 'binary_f1_score': 0.48913044}
confusion matrix:
       0    1
0  17680  469
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.779325, 'recall': 0.79667515, 'specificity': 0.79667515, 'f1': 0.7877035, 'auroc': 0.8992982, 'binary_precision': 0.5755396, 'binary_recall': 0.6130268, 'binary_specificity': 0.9803235, 'binary_f1_score': 0.593692}
confusion matrix:
      0    1
0  5879  118
1   101  160
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_15.png
early stop counter: 14
val acc:0.9599829912185669, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9650048017501831
after epoch: 15,now: 2024-07-06 21:32:18.543316,epoch time: 0:58:15.968789,used: 14:42:29.659575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9891655, 'precision': 0.9901446, 'recall': 0.981508, 'specificity': 0.981508, 'f1': 0.9857266, 'auroc': 0.9981264, 'binary_precision': 0.9921117, 'binary_recall': 0.96568596, 'binary_specificity': 0.99733007, 'binary_f1_score': 0.9787205}
confusion matrix:
       0      1
0  42210    113
1    505  14212
---- Validation: 
scalar performance:
{'acc': 0.9564176, 'precision': 0.6963852, 'recall': 0.7846726, 'specificity': 0.7846726, 'f1': 0.7312375, 'auroc': 0.9192513, 'binary_precision': 0.407173, 'binary_recall': 0.60031104, 'binary_specificity': 0.96903414, 'binary_f1_score': 0.4852294}
confusion matrix:
       0    1
0  17587  562
1    257  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.76435244, 'recall': 0.80092156, 'specificity': 0.80092156, 'f1': 0.7812856, 'auroc': 0.8962291, 'binary_precision': 0.5451505, 'binary_recall': 0.6245211, 'binary_specificity': 0.977322, 'binary_f1_score': 0.5821429}
confusion matrix:
      0    1
0  5861  136
1    98  163
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_16.png
early stop counter: 15
val acc:0.9564176201820374, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9650048017501831
after epoch: 16,now: 2024-07-06 22:30:41.278661,epoch time: 0:58:22.735345,used: 15:40:52.394920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98941094, 'precision': 0.99137414, 'recall': 0.9809594, 'specificity': 0.9809594, 'f1': 0.9860226, 'auroc': 0.9980395, 'binary_precision': 0.99529594, 'binary_recall': 0.9635017, 'binary_specificity': 0.9984171, 'binary_f1_score': 0.9791407}
confusion matrix:
       0      1
0  42260     67
1    537  14176
---- Validation: 
scalar performance:
{'acc': 0.9631226, 'precision': 0.7250704, 'recall': 0.75964177, 'specificity': 0.75964177, 'f1': 0.7409668, 'auroc': 0.9189045, 'binary_precision': 0.46648794, 'binary_recall': 0.54121304, 'binary_specificity': 0.97807044, 'binary_f1_score': 0.5010799}
confusion matrix:
       0    1
0  17751  398
1    295  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.81030333, 'recall': 0.76910865, 'specificity': 0.76910865, 'f1': 0.78806686, 'auroc': 0.8905176, 'binary_precision': 0.64, 'binary_recall': 0.55172414, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.5925926}
confusion matrix:
      0    1
0  5916   81
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_17.png
new oracle model saved
early stop counter: 16
val acc:0.9631226062774658, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9683604836463928
after epoch: 17,now: 2024-07-06 23:29:06.878320,epoch time: 0:58:25.599659,used: 16:39:17.994579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9903401, 'precision': 0.9897945, 'recall': 0.9849144, 'specificity': 0.9849144, 'f1': 0.98732245, 'auroc': 0.9985143, 'binary_precision': 0.98868495, 'binary_recall': 0.97370386, 'binary_specificity': 0.99612504, 'binary_f1_score': 0.9811373}
confusion matrix:
       0      1
0  42159    164
1    387  14330
---- Validation: 
scalar performance:
{'acc': 0.95769477, 'precision': 0.70097876, 'recall': 0.7808334, 'specificity': 0.7808334, 'f1': 0.7333402, 'auroc': 0.9176725, 'binary_precision': 0.41666666, 'binary_recall': 0.59097975, 'binary_specificity': 0.9706871, 'binary_f1_score': 0.48874593}
confusion matrix:
       0    1
0  17617  532
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.7696673, 'recall': 0.7903444, 'specificity': 0.7903444, 'f1': 0.7795713, 'auroc': 0.88675374, 'binary_precision': 0.5567376, 'binary_recall': 0.6015326, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.57826895}
confusion matrix:
      0    1
0  5872  125
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_18.png
early stop counter: 17
val acc:0.9576947689056396, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9683604836463928
after epoch: 18,now: 2024-07-07 00:26:46.072122,epoch time: 0:57:39.193802,used: 17:36:57.188381,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9909888, 'precision': 0.9923603, 'recall': 0.98408747, 'specificity': 0.98408747, 'f1': 0.98813295, 'auroc': 0.9981952, 'binary_precision': 0.9951192, 'binary_recall': 0.9698288, 'binary_specificity': 0.9983461, 'binary_f1_score': 0.9823113}
confusion matrix:
       0      1
0  42254     70
1    444  14272
---- Validation: 
scalar performance:
{'acc': 0.9596637, 'precision': 0.70855224, 'recall': 0.77285206, 'specificity': 0.77285206, 'f1': 0.7358171, 'auroc': 0.91545945, 'binary_precision': 0.43243244, 'binary_recall': 0.57231724, 'binary_specificity': 0.97338694, 'binary_f1_score': 0.49263722}
confusion matrix:
       0    1
0  17666  483
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.7794212, 'recall': 0.7671077, 'specificity': 0.7671077, 'f1': 0.7731076, 'auroc': 0.8808384, 'binary_precision': 0.57831323, 'binary_recall': 0.55172414, 'binary_specificity': 0.98249125, 'binary_f1_score': 0.5647059}
confusion matrix:
      0    1
0  5892  105
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_19.png
early stop counter: 18
val acc:0.9596636891365051, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9683604836463928
after epoch: 19,now: 2024-07-07 01:24:48.012352,epoch time: 0:58:01.940230,used: 18:34:59.128611,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9903927, 'precision': 0.9924263, 'recall': 0.982489, 'specificity': 0.982489, 'f1': 0.9873266, 'auroc': 0.99856365, 'binary_precision': 0.99649566, 'binary_recall': 0.9661593, 'binary_specificity': 0.99881864, 'binary_f1_score': 0.98109305}
confusion matrix:
       0      1
0  42274     50
1    498  14218
---- Validation: 
scalar performance:
{'acc': 0.95838654, 'precision': 0.701897, 'recall': 0.7676906, 'specificity': 0.7676906, 'f1': 0.7295342, 'auroc': 0.9134439, 'binary_precision': 0.41946697, 'binary_recall': 0.562986, 'binary_specificity': 0.9723952, 'binary_f1_score': 0.48074368}
confusion matrix:
       0    1
0  17648  501
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.7963033, 'recall': 0.74595344, 'specificity': 0.74595344, 'f1': 0.76850694, 'auroc': 0.8812441, 'binary_precision': 0.6139535, 'binary_recall': 0.50574714, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.5546218}
confusion matrix:
      0    1
0  5914   83
1   129  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_20.png
early stop counter: 19
val acc:0.9583865404129028, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9683604836463928
after epoch: 20,now: 2024-07-07 02:22:57.412928,epoch time: 0:58:09.400576,used: 19:33:08.529187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99091864, 'precision': 0.9907464, 'recall': 0.9854791, 'specificity': 0.9854791, 'f1': 0.9880756, 'auroc': 0.9984907, 'binary_precision': 0.99039656, 'binary_recall': 0.9742422, 'binary_specificity': 0.99671596, 'binary_f1_score': 0.982253}
confusion matrix:
       0      1
0  42187    139
1    379  14335
---- Validation: 
scalar performance:
{'acc': 0.95157516, 'precision': 0.682848, 'recall': 0.80466723, 'specificity': 0.80466723, 'f1': 0.7261114, 'auroc': 0.92320794, 'binary_precision': 0.37852594, 'binary_recall': 0.64696735, 'binary_specificity': 0.96236706, 'binary_f1_score': 0.47761196}
confusion matrix:
       0    1
0  17466  683
1    227  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.75832343, 'recall': 0.7875116, 'specificity': 0.7875116, 'f1': 0.77202487, 'auroc': 0.8879063, 'binary_precision': 0.53424656, 'binary_recall': 0.59770113, 'binary_specificity': 0.977322, 'binary_f1_score': 0.5641953}
confusion matrix:
      0    1
0  5861  136
1   105  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_21.png
early stop counter: 20
val acc:0.9515751600265503, best validation acc: 0.964612603187561, corresponding to test acc:                         0.9584531784057617 / 0.9683604836463928
after epoch: 21,now: 2024-07-07 03:20:54.231798,epoch time: 0:57:56.818870,used: 20:31:05.348057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_06_49_48_seed_0_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 20:31:05.348057 at 2024-07-07 03:20:54.231798
persisted model performance metric: 

scalar performance:
{'acc': 0.9584532, 'precision': 0.7353723, 'recall': 0.5898677, 'specificity': 0.5898677, 'f1': 0.6261789, 'auroc': 0.89258933, 'binary_precision': 0.5051546, 'binary_recall': 0.18773946, 'binary_specificity': 0.991996, 'binary_f1_score': 0.273743}
confusion matrix:
      0   1
0  5949  48
1   212  49
oracle model performance metric: 

scalar performance:
{'acc': 0.9683605, 'precision': 0.81030333, 'recall': 0.76910865, 'specificity': 0.76910865, 'f1': 0.78806686, 'auroc': 0.8905176, 'binary_precision': 0.64, 'binary_recall': 0.55172414, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.5925926}
confusion matrix:
      0    1
0  5916   81
1   117  144
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   5005 MiB |   4301 TiB |   4301 TiB |
|       from large pool | 180662 KiB |   4984 MiB |   4255 TiB |   4255 TiB |
|       from small pool |  17491 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   5005 MiB |   4301 TiB |   4301 TiB |
|       from large pool | 180662 KiB |   4984 MiB |   4255 TiB |   4255 TiB |
|       from small pool |  17491 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   5003 MiB |   4301 TiB |   4301 TiB |
|       from large pool | 178979 KiB |   4982 MiB |   4255 TiB |   4255 TiB |
|       from small pool |  16482 KiB |     36 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5462 MiB |   5462 MiB |   5462 MiB |      0 B   |
|       from large pool |   5420 MiB |   5420 MiB |   5420 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  57847 KiB |    919 MiB |   2438 TiB |   2438 TiB |
|       from large pool |  50762 KiB |    918 MiB |   2392 TiB |   2392 TiB |
|       from small pool |   7085 KiB |      9 MiB |     46 TiB |     46 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7605    |  516826 K  |  516823 K  |
|       from large pool |      79    |     510    |  377140 K  |  377140 K  |
|       from small pool |    2899    |    7525    |  139685 K  |  139683 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7605    |  516826 K  |  516823 K  |
|       from large pool |      79    |     510    |  377140 K  |  377140 K  |
|       from small pool |    2899    |    7525    |  139685 K  |  139683 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     224    |     224    |     224    |       0    |
|       from large pool |     203    |     203    |     203    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3585    |  353669 K  |  353669 K  |
|       from large pool |      10    |     207    |  278418 K  |  278418 K  |
|       from small pool |      21    |    3575    |   75250 K  |   75250 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5005 MiB |   4301 TiB |   4301 TiB |
|       from large pool |  16640 KiB |   4984 MiB |   4255 TiB |   4255 TiB |
|       from small pool |      0 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5005 MiB |   4301 TiB |   4301 TiB |
|       from large pool |  16640 KiB |   4984 MiB |   4255 TiB |   4255 TiB |
|       from small pool |      0 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5003 MiB |   4301 TiB |   4301 TiB |
|       from large pool |  16640 KiB |   4982 MiB |   4255 TiB |   4255 TiB |
|       from small pool |      0 KiB |     36 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   5462 MiB |   5462 MiB |   5212 MiB |
|       from large pool | 231424 KiB |   5420 MiB |   5420 MiB |   5194 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    919 MiB |   2438 TiB |   2438 TiB |
|       from large pool |  30464 KiB |    918 MiB |   2392 TiB |   2392 TiB |
|       from small pool |      0 KiB |     17 MiB |     46 TiB |     46 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |  516826 K  |  516826 K  |
|       from large pool |       2    |     510    |  377140 K  |  377140 K  |
|       from small pool |       0    |    7525    |  139685 K  |  139685 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |  516826 K  |  516826 K  |
|       from large pool |       2    |     510    |  377140 K  |  377140 K  |
|       from small pool |       0    |    7525    |  139685 K  |  139685 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     224    |     224    |     201    |
|       from large pool |      11    |     203    |     203    |     192    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3585    |  353670 K  |  353670 K  |
|       from large pool |       3    |     207    |  278418 K  |  278418 K  |
|       from small pool |       0    |    3575    |   75252 K  |   75252 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   5005 MiB |   4301 TiB |   4301 TiB |
|       from large pool |  16640 KiB |   4984 MiB |   4255 TiB |   4255 TiB |
|       from small pool |      0 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   5005 MiB |   4301 TiB |   4301 TiB |
|       from large pool |  16640 KiB |   4984 MiB |   4255 TiB |   4255 TiB |
|       from small pool |      0 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   5003 MiB |   4301 TiB |   4301 TiB |
|       from large pool |  16640 KiB |   4982 MiB |   4255 TiB |   4255 TiB |
|       from small pool |      0 KiB |     36 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   5462 MiB |   5462 MiB |   5212 MiB |
|       from large pool | 231424 KiB |   5420 MiB |   5420 MiB |   5194 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB |    919 MiB |   2438 TiB |   2438 TiB |
|       from large pool |  30464 KiB |    918 MiB |   2392 TiB |   2392 TiB |
|       from small pool |      0 KiB |     17 MiB |     46 TiB |     46 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |  516826 K  |  516826 K  |
|       from large pool |       2    |     510    |  377140 K  |  377140 K  |
|       from small pool |       0    |    7525    |  139685 K  |  139685 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |  516826 K  |  516826 K  |
|       from large pool |       2    |     510    |  377140 K  |  377140 K  |
|       from small pool |       0    |    7525    |  139685 K  |  139685 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     224    |     224    |     201    |
|       from large pool |      11    |     203    |     203    |     192    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3585    |  353670 K  |  353670 K  |
|       from large pool |       3    |     207    |  278418 K  |  278418 K  |
|       from small pool |       0    |    3575    |   75252 K  |   75252 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433

 Experiment start at: 2024-07-07 03:28:27.168995
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9609903, 'precision': 0.9700852, 'recall': 0.92703605, 'specificity': 0.92703605, 'f1': 0.9461028, 'auroc': 0.983641, 'binary_precision': 0.986368, 'binary_recall': 0.8581039, 'binary_specificity': 0.9959682, 'binary_f1_score': 0.9177762}
confusion matrix:
       0      1
0  42242    171
1   2046  12373
---- Validation: 
scalar performance:
{'acc': 0.95325506, 'precision': 0.6598972, 'recall': 0.6553171, 'specificity': 0.6553171, 'f1': 0.6575684, 'auroc': 0.8738767, 'binary_precision': 0.34456354, 'binary_recall': 0.3343239, 'binary_specificity': 0.9763104, 'binary_f1_score': 0.3393665}
confusion matrix:
       0    1
0  17639  428
1    448  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9494038, 'precision': 0.62953496, 'recall': 0.5671796, 'specificity': 0.5671796, 'f1': 0.5864282, 'auroc': 0.88099146, 'binary_precision': 0.29545453, 'binary_recall': 0.15, 'binary_specificity': 0.9843592, 'binary_f1_score': 0.19897959}
confusion matrix:
      0   1
0  5853  93
1   221  39
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-07 04:27:18.870288,epoch time: 0:58:51.701293,used: 0:58:51.701293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.972146, 'precision': 0.97606814, 'recall': 0.9501456, 'specificity': 0.9501456, 'f1': 0.9622159, 'auroc': 0.99072456, 'binary_precision': 0.98342997, 'binary_recall': 0.9054785, 'binary_specificity': 0.9948128, 'binary_f1_score': 0.9428458}
confusion matrix:
       0      1
0  42192    220
1   1363  13057
---- Validation: 
scalar performance:
{'acc': 0.958111, 'precision': 0.7028279, 'recall': 0.7250707, 'specificity': 0.7250707, 'f1': 0.7132888, 'auroc': 0.9031875, 'binary_precision': 0.42533332, 'binary_recall': 0.47399703, 'binary_specificity': 0.9761444, 'binary_f1_score': 0.44834855}
confusion matrix:
       0    1
0  17636  431
1    354  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.75506717, 'recall': 0.69243187, 'specificity': 0.69243187, 'f1': 0.71878886, 'auroc': 0.91295767, 'binary_precision': 0.53608245, 'binary_recall': 0.4, 'binary_specificity': 0.98486376, 'binary_f1_score': 0.45814976}
confusion matrix:
      0    1
0  5856   90
1   156  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-07 05:25:35.372011,epoch time: 0:58:16.501723,used: 1:57:08.203016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.976844, 'precision': 0.97956604, 'recall': 0.959078, 'specificity': 0.959078, 'f1': 0.9687677, 'auroc': 0.99363065, 'binary_precision': 0.9847565, 'binary_recall': 0.9230129, 'binary_specificity': 0.9951431, 'binary_f1_score': 0.95288557}
confusion matrix:
       0      1
0  42208    206
1   1110  13308
---- Validation: 
scalar performance:
{'acc': 0.95997864, 'precision': 0.7165049, 'recall': 0.75035834, 'specificity': 0.75035834, 'f1': 0.73203534, 'auroc': 0.91174746, 'binary_precision': 0.45083013, 'binary_recall': 0.52451706, 'binary_specificity': 0.9761997, 'binary_f1_score': 0.4848901}
confusion matrix:
       0    1
0  17637  430
1    320  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.770596, 'recall': 0.7526249, 'specificity': 0.7526249, 'f1': 0.7612606, 'auroc': 0.915503, 'binary_precision': 0.56198347, 'binary_recall': 0.52307695, 'binary_specificity': 0.9821729, 'binary_f1_score': 0.54183275}
confusion matrix:
      0    1
0  5840  106
1   124  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-07 06:23:58.784852,epoch time: 0:58:23.412841,used: 2:55:31.615857,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97863877, 'precision': 0.9816656, 'recall': 0.96179366, 'specificity': 0.96179366, 'f1': 0.97121066, 'auroc': 0.9947456, 'binary_precision': 0.9874492, 'binary_recall': 0.92759556, 'binary_specificity': 0.99599177, 'binary_f1_score': 0.956587}
confusion matrix:
       0      1
0  42243    170
1   1044  13375
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.7410436, 'recall': 0.71680903, 'specificity': 0.71680903, 'f1': 0.7282077, 'auroc': 0.9140442, 'binary_precision': 0.50248754, 'binary_recall': 0.45022288, 'binary_specificity': 0.98339516, 'binary_f1_score': 0.4749216}
confusion matrix:
       0    1
0  17767  300
1    370  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.7797216, 'recall': 0.7068184, 'specificity': 0.7068184, 'f1': 0.7371365, 'auroc': 0.9152293, 'binary_precision': 0.5842105, 'binary_recall': 0.42692307, 'binary_specificity': 0.98671377, 'binary_f1_score': 0.49333334}
confusion matrix:
      0    1
0  5867   79
1   149  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-07 07:21:59.843467,epoch time: 0:58:01.058615,used: 3:53:32.674472,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9821755, 'precision': 0.9842528, 'recall': 0.9685556, 'specificity': 0.9685556, 'f1': 0.97608125, 'auroc': 0.99578977, 'binary_precision': 0.9882713, 'binary_recall': 0.9409072, 'binary_specificity': 0.9962041, 'binary_f1_score': 0.9640078}
confusion matrix:
       0      1
0  42253    161
1    852  13566
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.73845863, 'recall': 0.74016374, 'specificity': 0.74016374, 'f1': 0.73930776, 'auroc': 0.91310716, 'binary_precision': 0.49557522, 'binary_recall': 0.49925706, 'binary_specificity': 0.98107046, 'binary_f1_score': 0.49740934}
confusion matrix:
       0    1
0  17725  342
1    337  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.76570976, 'recall': 0.7411705, 'specificity': 0.7411705, 'f1': 0.7527664, 'auroc': 0.9099755, 'binary_precision': 0.5531915, 'binary_recall': 0.5, 'binary_specificity': 0.98234105, 'binary_f1_score': 0.5252526}
confusion matrix:
      0    1
0  5841  105
1   130  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_5.png
early stop counter: 1
val acc:0.9637673497200012, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 5,now: 2024-07-07 08:20:35.680727,epoch time: 0:58:35.837260,used: 4:52:08.511732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98243946, 'precision': 0.9822116, 'recall': 0.9712063, 'specificity': 0.9712063, 'f1': 0.97654855, 'auroc': 0.99607086, 'binary_precision': 0.9817647, 'binary_recall': 0.9484014, 'binary_specificity': 0.9940113, 'binary_f1_score': 0.9647947}
confusion matrix:
       0      1
0  42159    254
1    744  13675
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.74021935, 'recall': 0.7474271, 'specificity': 0.7474271, 'f1': 0.7437633, 'auroc': 0.9149228, 'binary_precision': 0.4985591, 'binary_recall': 0.51411587, 'binary_specificity': 0.98073834, 'binary_f1_score': 0.506218}
confusion matrix:
       0    1
0  17719  348
1    327  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.737845, 'recall': 0.7334672, 'specificity': 0.7334672, 'f1': 0.7356328, 'auroc': 0.9065422, 'binary_precision': 0.49803922, 'binary_recall': 0.48846152, 'binary_specificity': 0.97847295, 'binary_f1_score': 0.49320388}
confusion matrix:
      0    1
0  5818  128
1   133  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_6.png
early stop counter: 2
val acc:0.9639807939529419, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 6,now: 2024-07-07 09:18:46.583753,epoch time: 0:58:10.903026,used: 5:50:19.414758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9844278, 'precision': 0.9846746, 'recall': 0.9740491, 'specificity': 0.9740491, 'f1': 0.9792131, 'auroc': 0.9968712, 'binary_precision': 0.98515916, 'binary_recall': 0.95297873, 'binary_specificity': 0.9951194, 'binary_f1_score': 0.9688018}
confusion matrix:
       0      1
0  42206    207
1    678  13741
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.74089426, 'recall': 0.73606586, 'specificity': 0.73606586, 'f1': 0.7384527, 'auroc': 0.91536736, 'binary_precision': 0.5007587, 'binary_recall': 0.49034175, 'binary_specificity': 0.98179, 'binary_f1_score': 0.4954955}
confusion matrix:
       0    1
0  17738  329
1    343  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.7332353, 'recall': 0.7056302, 'specificity': 0.7056302, 'f1': 0.7184381, 'auroc': 0.9050148, 'binary_precision': 0.49122807, 'binary_recall': 0.43076923, 'binary_specificity': 0.9804911, 'binary_f1_score': 0.45901638}
confusion matrix:
      0    1
0  5830  116
1   148  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_7.png
early stop counter: 3
val acc:0.9641408920288086, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 7,now: 2024-07-07 10:17:06.430733,epoch time: 0:58:19.846980,used: 6:48:39.261738,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9856595, 'precision': 0.9861249, 'recall': 0.97588134, 'specificity': 0.97588134, 'f1': 0.98086536, 'auroc': 0.99728453, 'binary_precision': 0.98704, 'binary_recall': 0.95603025, 'binary_specificity': 0.9957324, 'binary_f1_score': 0.97128767}
confusion matrix:
       0      1
0  42232    181
1    634  13785
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.7376313, 'recall': 0.7522126, 'specificity': 0.7522126, 'f1': 0.7446775, 'auroc': 0.91901463, 'binary_precision': 0.49301675, 'binary_recall': 0.52451706, 'binary_specificity': 0.9799081, 'binary_f1_score': 0.5082793}
confusion matrix:
       0    1
0  17704  363
1    320  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9555269, 'precision': 0.7211471, 'recall': 0.70646006, 'specificity': 0.70646006, 'f1': 0.71351266, 'auroc': 0.90418124, 'binary_precision': 0.46694216, 'binary_recall': 0.43461537, 'binary_specificity': 0.97830474, 'binary_f1_score': 0.4501992}
confusion matrix:
      0    1
0  5817  129
1   147  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_8.png
early stop counter: 4
val acc:0.9635539054870605, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 8,now: 2024-07-07 11:16:32.714409,epoch time: 0:59:26.283676,used: 7:48:05.545414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.985941, 'precision': 0.9876255, 'recall': 0.97517574, 'specificity': 0.97517574, 'f1': 0.98119855, 'auroc': 0.9975159, 'binary_precision': 0.9909163, 'binary_recall': 0.95332223, 'binary_specificity': 0.9970293, 'binary_f1_score': 0.9717558}
confusion matrix:
       0      1
0  42288    126
1    673  13745
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.7376959, 'recall': 0.76005286, 'specificity': 0.76005286, 'f1': 0.7483083, 'auroc': 0.917822, 'binary_precision': 0.4925575, 'binary_recall': 0.5408618, 'binary_specificity': 0.97924393, 'binary_f1_score': 0.5155807}
confusion matrix:
       0    1
0  17692  375
1    309  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.73570675, 'recall': 0.68933153, 'specificity': 0.68933153, 'f1': 0.7096317, 'auroc': 0.9008571, 'binary_precision': 0.49758455, 'binary_recall': 0.39615384, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.44111347}
confusion matrix:
      0    1
0  5842  104
1   157  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_9.png
early stop counter: 5
val acc:0.9635005593299866, best validation acc: 0.9642475843429565, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 9,now: 2024-07-07 12:17:17.731954,epoch time: 1:00:45.017545,used: 8:48:50.562959,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98618734, 'precision': 0.98779047, 'recall': 0.9756613, 'specificity': 0.9756613, 'f1': 0.9815341, 'auroc': 0.9970211, 'binary_precision': 0.99092543, 'binary_recall': 0.95429325, 'binary_specificity': 0.9970293, 'binary_f1_score': 0.9722644}
confusion matrix:
       0      1
0  42288    126
1    659  13759
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.7497808, 'recall': 0.7087793, 'specificity': 0.7087793, 'f1': 0.72723526, 'auroc': 0.91522, 'binary_precision': 0.5205724, 'binary_recall': 0.43239227, 'binary_specificity': 0.9851663, 'binary_f1_score': 0.4724026}
confusion matrix:
       0    1
0  17799  268
1    382  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.75092745, 'recall': 0.66083276, 'specificity': 0.66083276, 'f1': 0.69476163, 'auroc': 0.8984624, 'binary_precision': 0.5304878, 'binary_recall': 0.33461538, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.41037735}
confusion matrix:
      0   1
0  5869  77
1   173  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_10.png
better model found
persisted
after epoch: 10,now: 2024-07-07 13:18:30.653756,epoch time: 1:01:12.921802,used: 9:50:03.484761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9850788, 'precision': 0.9876592, 'recall': 0.9729042, 'specificity': 0.9729042, 'f1': 0.97999865, 'auroc': 0.9974481, 'binary_precision': 0.9926663, 'binary_recall': 0.94818974, 'binary_specificity': 0.99761873, 'binary_f1_score': 0.96991843}
confusion matrix:
       0      1
0  42313    101
1    747  13671
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.7454423, 'recall': 0.7521062, 'specificity': 0.7521062, 'f1': 0.74872416, 'auroc': 0.9239768, 'binary_precision': 0.5086705, 'binary_recall': 0.5230312, 'binary_specificity': 0.98118114, 'binary_f1_score': 0.51575094}
confusion matrix:
       0    1
0  17727  340
1    321  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.76932937, 'recall': 0.7173478, 'specificity': 0.7173478, 'f1': 0.74020433, 'auroc': 0.9051516, 'binary_precision': 0.5625, 'binary_recall': 0.45, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.49999994}
confusion matrix:
      0    1
0  5855   91
1   143  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_11.png
early stop counter: 1
val acc:0.9647278785705566, best validation acc: 0.9653148055076599, corresponding to test acc:                         0.9597163796424866 / 0.9632613658905029
after epoch: 11,now: 2024-07-07 14:20:00.676650,epoch time: 1:01:30.022894,used: 10:51:33.507655,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98757744, 'precision': 0.9905162, 'recall': 0.97671014, 'specificity': 0.97671014, 'f1': 0.98336685, 'auroc': 0.99797857, 'binary_precision': 0.9962368, 'binary_recall': 0.95464635, 'binary_specificity': 0.99877393, 'binary_f1_score': 0.97499824}
confusion matrix:
       0      1
0  42360     52
1    654  13766
---- Validation: 
scalar performance:
{'acc': 0.9664888, 'precision': 0.76025474, 'recall': 0.7122492, 'specificity': 0.7122492, 'f1': 0.73354113, 'auroc': 0.92060935, 'binary_precision': 0.5412844, 'binary_recall': 0.4383358, 'binary_specificity': 0.9861626, 'binary_f1_score': 0.48440063}
confusion matrix:
       0    1
0  17817  250
1    378  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.76886207, 'recall': 0.6394376, 'specificity': 0.6394376, 'f1': 0.68126, 'auroc': 0.8969884, 'binary_precision': 0.5681818, 'binary_recall': 0.28846154, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.3826531}
confusion matrix:
      0   1
0  5889  57
1   185  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_12.png
better model found
persisted
after epoch: 12,now: 2024-07-07 15:21:34.374640,epoch time: 1:01:33.697990,used: 11:53:07.205645,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98851, 'precision': 0.9897784, 'recall': 0.97982687, 'specificity': 0.97982687, 'f1': 0.98467386, 'auroc': 0.99785364, 'binary_precision': 0.99227524, 'binary_recall': 0.96220005, 'binary_specificity': 0.9974537, 'binary_f1_score': 0.97700626}
confusion matrix:
       0      1
0  42306    108
1    545  13873
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.74112785, 'recall': 0.7524893, 'specificity': 0.7524893, 'f1': 0.74666154, 'auroc': 0.92528284, 'binary_precision': 0.5, 'binary_recall': 0.52451706, 'binary_specificity': 0.9804616, 'binary_f1_score': 0.51196516}
confusion matrix:
       0    1
0  17714  353
1    320  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.779362, 'recall': 0.7086574, 'specificity': 0.7086574, 'f1': 0.73825586, 'auroc': 0.90343285, 'binary_precision': 0.5833333, 'binary_recall': 0.43076923, 'binary_specificity': 0.98654556, 'binary_f1_score': 0.4955752}
confusion matrix:
      0    1
0  5866   80
1   148  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_13.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9632613658905029
after epoch: 13,now: 2024-07-07 16:23:13.619902,epoch time: 1:01:39.245262,used: 12:54:46.450907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98865074, 'precision': 0.98930484, 'recall': 0.980656, 'specificity': 0.980656, 'f1': 0.98488295, 'auroc': 0.99801856, 'binary_precision': 0.9905976, 'binary_recall': 0.96442443, 'binary_specificity': 0.9968877, 'binary_f1_score': 0.9773358}
confusion matrix:
       0      1
0  42280    132
1    513  13907
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.73927045, 'recall': 0.76517045, 'specificity': 0.76517045, 'f1': 0.7514709, 'auroc': 0.92321193, 'binary_precision': 0.49532712, 'binary_recall': 0.551263, 'binary_specificity': 0.9790779, 'binary_f1_score': 0.5218003}
confusion matrix:
       0    1
0  17689  378
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.7700874, 'recall': 0.7007128, 'specificity': 0.7007128, 'f1': 0.72964424, 'auroc': 0.8995574, 'binary_precision': 0.565445, 'binary_recall': 0.41538462, 'binary_specificity': 0.986041, 'binary_f1_score': 0.4789357}
confusion matrix:
      0    1
0  5863   83
1   152  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_14.png
early stop counter: 2
val acc:0.9637140035629272, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9632613658905029
after epoch: 14,now: 2024-07-07 17:22:28.133433,epoch time: 0:59:14.513531,used: 13:54:00.964438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98821086, 'precision': 0.9900339, 'recall': 0.9788024, 'specificity': 0.9788024, 'f1': 0.98425454, 'auroc': 0.99803364, 'binary_precision': 0.9936091, 'binary_recall': 0.95970315, 'binary_specificity': 0.9979016, 'binary_f1_score': 0.9763619}
confusion matrix:
       0      1
0  42325     89
1    581  13837
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.7350786, 'recall': 0.7548523, 'specificity': 0.7548523, 'f1': 0.7445152, 'auroc': 0.92442846, 'binary_precision': 0.48770493, 'binary_recall': 0.5304606, 'binary_specificity': 0.97924393, 'binary_f1_score': 0.50818497}
confusion matrix:
       0    1
0  17692  375
1    316  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.7565828, 'recall': 0.690677, 'specificity': 0.690677, 'f1': 0.7181397, 'auroc': 0.89739645, 'binary_precision': 0.539267, 'binary_recall': 0.39615384, 'binary_specificity': 0.9852001, 'binary_f1_score': 0.4567627}
confusion matrix:
      0    1
0  5858   88
1   157  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_15.png
early stop counter: 3
val acc:0.9631270170211792, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9632613658905029
after epoch: 15,now: 2024-07-07 18:22:08.620552,epoch time: 0:59:40.487119,used: 14:53:41.451557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9880173, 'precision': 0.9900985, 'recall': 0.9782378, 'specificity': 0.9782378, 'f1': 0.98398584, 'auroc': 0.99811685, 'binary_precision': 0.9941722, 'binary_recall': 0.95838535, 'binary_specificity': 0.99809027, 'binary_f1_score': 0.97595084}
confusion matrix:
       0      1
0  42333     81
1    600  13818
---- Validation: 
scalar performance:
{'acc': 0.9624333, 'precision': 0.72997916, 'recall': 0.74376345, 'specificity': 0.74376345, 'f1': 0.73664486, 'auroc': 0.92439353, 'binary_precision': 0.47832167, 'binary_recall': 0.50817233, 'binary_specificity': 0.9793546, 'binary_f1_score': 0.49279538}
confusion matrix:
       0    1
0  17694  373
1    331  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.75285363, 'recall': 0.6812298, 'specificity': 0.6812298, 'f1': 0.7103598, 'auroc': 0.9028822, 'binary_precision': 0.5326087, 'binary_recall': 0.37692308, 'binary_specificity': 0.9855365, 'binary_f1_score': 0.44144145}
confusion matrix:
      0   1
0  5860  86
1   162  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_16.png
early stop counter: 4
val acc:0.9624332785606384, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9632613658905029
after epoch: 16,now: 2024-07-07 19:21:47.154234,epoch time: 0:59:38.533682,used: 15:53:19.985239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9893546, 'precision': 0.99013263, 'recall': 0.98169863, 'specificity': 0.98169863, 'f1': 0.98582304, 'auroc': 0.9982687, 'binary_precision': 0.9916714, 'binary_recall': 0.96615577, 'binary_specificity': 0.99724144, 'binary_f1_score': 0.9787473}
confusion matrix:
       0      1
0  42296    117
1    488  13931
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.73540276, 'recall': 0.7655536, 'specificity': 0.7655536, 'f1': 0.74945354, 'auroc': 0.923925, 'binary_precision': 0.48754916, 'binary_recall': 0.55274886, 'binary_specificity': 0.9783583, 'binary_f1_score': 0.51810586}
confusion matrix:
       0    1
0  17676  391
1    301  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.7343867, 'recall': 0.72402, 'specificity': 0.72402, 'f1': 0.72906876, 'auroc': 0.898548, 'binary_precision': 0.4919355, 'binary_recall': 0.46923077, 'binary_specificity': 0.9788093, 'binary_f1_score': 0.48031497}
confusion matrix:
      0    1
0  5820  126
1   138  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_17.png
early stop counter: 5
val acc:0.9630736112594604, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9632613658905029
after epoch: 17,now: 2024-07-07 20:20:15.340154,epoch time: 0:58:28.185920,used: 16:51:48.171159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98842204, 'precision': 0.9912199, 'recall': 0.97823715, 'specificity': 0.97823715, 'f1': 0.9845109, 'auroc': 0.9983248, 'binary_precision': 0.99667966, 'binary_recall': 0.95755893, 'binary_specificity': 0.9989154, 'binary_f1_score': 0.97672766}
confusion matrix:
       0      1
0  42366     46
1    612  13808
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7426988, 'recall': 0.74547505, 'specificity': 0.74547505, 'f1': 0.74407804, 'auroc': 0.9232167, 'binary_precision': 0.50367105, 'binary_recall': 0.5096582, 'binary_specificity': 0.98129183, 'binary_f1_score': 0.506647}
confusion matrix:
       0    1
0  17729  338
1    330  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7402017, 'recall': 0.6694391, 'specificity': 0.6694391, 'f1': 0.69788253, 'auroc': 0.89215016, 'binary_precision': 0.5082873, 'binary_recall': 0.35384616, 'binary_specificity': 0.98503196, 'binary_f1_score': 0.41723356}
confusion matrix:
      0   1
0  5857  89
1   168  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_18.png
early stop counter: 6
val acc:0.9643543362617493, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9632613658905029
after epoch: 18,now: 2024-07-07 21:18:10.815352,epoch time: 0:57:55.475198,used: 17:49:43.646357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99046314, 'precision': 0.99179995, 'recall': 0.98298836, 'specificity': 0.98298836, 'f1': 0.9872936, 'auroc': 0.9983358, 'binary_precision': 0.99444085, 'binary_recall': 0.96781576, 'binary_specificity': 0.998161, 'binary_f1_score': 0.9809477}
confusion matrix:
       0      1
0  42337     78
1    464  13953
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.73927796, 'recall': 0.7722954, 'specificity': 0.7722954, 'f1': 0.75458467, 'auroc': 0.9260813, 'binary_precision': 0.4948052, 'binary_recall': 0.5661218, 'binary_specificity': 0.978469, 'binary_f1_score': 0.5280665}
confusion matrix:
       0    1
0  17678  389
1    292  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7480248, 'recall': 0.72143525, 'specificity': 0.72143525, 'f1': 0.7338716, 'auroc': 0.8935689, 'binary_precision': 0.5194805, 'binary_recall': 0.46153846, 'binary_specificity': 0.981332, 'binary_f1_score': 0.48879838}
confusion matrix:
      0    1
0  5835  111
1   140  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_19.png
early stop counter: 7
val acc:0.9636605978012085, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9632613658905029
after epoch: 19,now: 2024-07-07 22:17:03.472481,epoch time: 0:58:52.657129,used: 18:48:36.303486,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9897241, 'precision': 0.99212754, 'recall': 0.98075473, 'specificity': 0.98075473, 'f1': 0.98627424, 'auroc': 0.9984566, 'binary_precision': 0.9968395, 'binary_recall': 0.9625468, 'binary_specificity': 0.9989626, 'binary_f1_score': 0.97939306}
confusion matrix:
       0      1
0  42370     44
1    540  13878
---- Validation: 
scalar performance:
{'acc': 0.96558166, 'precision': 0.75169086, 'recall': 0.7303757, 'specificity': 0.7303757, 'f1': 0.74050665, 'auroc': 0.9227894, 'binary_precision': 0.5228013, 'binary_recall': 0.4769688, 'binary_specificity': 0.9837826, 'binary_f1_score': 0.4988345}
confusion matrix:
       0    1
0  17774  293
1    352  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.7889092, 'recall': 0.67747873, 'specificity': 0.67747873, 'f1': 0.7183555, 'auroc': 0.89270747, 'binary_precision': 0.60509557, 'binary_recall': 0.3653846, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.4556355}
confusion matrix:
      0   1
0  5884  62
1   165  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_20.png
new oracle model saved
early stop counter: 8
val acc:0.9655816555023193, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9634224772453308
after epoch: 20,now: 2024-07-07 23:14:32.591155,epoch time: 0:57:29.118674,used: 19:46:05.422160,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9902872, 'precision': 0.99069107, 'recall': 0.9836041, 'specificity': 0.9836041, 'f1': 0.98708224, 'auroc': 0.99855113, 'binary_precision': 0.991493, 'binary_recall': 0.97003746, 'binary_specificity': 0.99717075, 'binary_f1_score': 0.98064786}
confusion matrix:
       0      1
0  42294    120
1    432  13986
---- Validation: 
scalar performance:
{'acc': 0.96163285, 'precision': 0.7275007, 'recall': 0.76981324, 'specificity': 0.76981324, 'f1': 0.74661595, 'auroc': 0.9275471, 'binary_precision': 0.47139305, 'binary_recall': 0.56315005, 'binary_specificity': 0.97647643, 'binary_f1_score': 0.5132025}
confusion matrix:
       0    1
0  17642  425
1    294  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.752707, 'recall': 0.71809363, 'specificity': 0.71809363, 'f1': 0.7339535, 'auroc': 0.8929157, 'binary_precision': 0.529148, 'binary_recall': 0.45384616, 'binary_specificity': 0.98234105, 'binary_f1_score': 0.48861283}
confusion matrix:
      0    1
0  5841  105
1   142  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_21.png
early stop counter: 9
val acc:0.9616328477859497, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9634224772453308
after epoch: 21,now: 2024-07-08 00:12:15.268970,epoch time: 0:57:42.677815,used: 20:43:48.099975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9908678, 'precision': 0.9920469, 'recall': 0.983811, 'specificity': 0.983811, 'f1': 0.9878411, 'auroc': 0.9986775, 'binary_precision': 0.9943804, 'binary_recall': 0.9694847, 'binary_specificity': 0.99813735, 'binary_f1_score': 0.9817748}
confusion matrix:
       0      1
0  42334     79
1    440  13979
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.7386327, 'recall': 0.7587054, 'specificity': 0.7587054, 'f1': 0.7482126, 'auroc': 0.9240849, 'binary_precision': 0.4945355, 'binary_recall': 0.53789, 'binary_specificity': 0.9795207, 'binary_f1_score': 0.5153025}
confusion matrix:
       0    1
0  17697  370
1    311  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.75913095, 'recall': 0.7129971, 'specificity': 0.7129971, 'f1': 0.73351, 'auroc': 0.88495946, 'binary_precision': 0.5424528, 'binary_recall': 0.44230768, 'binary_specificity': 0.9836865, 'binary_f1_score': 0.48728812}
confusion matrix:
      0    1
0  5849   97
1   145  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_22.png
early stop counter: 10
val acc:0.9636605978012085, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9634224772453308
after epoch: 22,now: 2024-07-08 01:11:21.325146,epoch time: 0:59:06.056176,used: 21:42:54.156151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9905511, 'precision': 0.9926741, 'recall': 0.98238695, 'specificity': 0.98238695, 'f1': 0.9873941, 'auroc': 0.9985658, 'binary_precision': 0.9968506, 'binary_recall': 0.9658114, 'binary_specificity': 0.9989626, 'binary_f1_score': 0.98108554}
confusion matrix:
       0      1
0  42368     44
1    493  13927
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.7424669, 'recall': 0.7233294, 'specificity': 0.7233294, 'f1': 0.73245764, 'auroc': 0.922429, 'binary_precision': 0.5048544, 'binary_recall': 0.46359584, 'binary_specificity': 0.98306304, 'binary_f1_score': 0.48334628}
confusion matrix:
       0    1
0  17761  306
1    361  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7455484, 'recall': 0.6292336, 'specificity': 0.6292336, 'f1': 0.6670975, 'auroc': 0.88428533, 'binary_precision': 0.52238804, 'binary_recall': 0.26923078, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.35532996}
confusion matrix:
      0   1
0  5882  64
1   190  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_23.png
early stop counter: 11
val acc:0.9644076824188232, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9634224772453308
after epoch: 23,now: 2024-07-08 02:08:38.884670,epoch time: 0:57:17.559524,used: 22:40:11.715675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99039274, 'precision': 0.9922317, 'recall': 0.9823941, 'specificity': 0.9823941, 'f1': 0.9871879, 'auroc': 0.9987309, 'binary_precision': 0.9958539, 'binary_recall': 0.96615577, 'binary_specificity': 0.9986325, 'binary_f1_score': 0.98078007}
confusion matrix:
       0      1
0  42355     58
1    488  13931
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.74274147, 'recall': 0.74690557, 'specificity': 0.74690557, 'f1': 0.74480367, 'auroc': 0.9257031, 'binary_precision': 0.50364965, 'binary_recall': 0.51263, 'binary_specificity': 0.98118114, 'binary_f1_score': 0.50810015}
confusion matrix:
       0    1
0  17727  340
1    328  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7487124, 'recall': 0.6404357, 'specificity': 0.6404357, 'f1': 0.6776258, 'auroc': 0.88556695, 'binary_precision': 0.5277778, 'binary_recall': 0.2923077, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.3762376}
confusion matrix:
      0   1
0  5878  68
1   184  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_24.png
early stop counter: 12
val acc:0.9643543362617493, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9634224772453308
after epoch: 24,now: 2024-07-08 03:06:11.061811,epoch time: 0:57:32.177141,used: 23:37:43.892816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99079746, 'precision': 0.9924767, 'recall': 0.9832146, 'specificity': 0.9832146, 'f1': 0.9877348, 'auroc': 0.9985862, 'binary_precision': 0.99578995, 'binary_recall': 0.9678202, 'binary_specificity': 0.99860895, 'binary_f1_score': 0.9816059}
confusion matrix:
       0      1
0  42354     59
1    464  13955
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.7587943, 'recall': 0.7200618, 'specificity': 0.7200618, 'f1': 0.7376843, 'auroc': 0.92252594, 'binary_precision': 0.5377856, 'binary_recall': 0.45468053, 'binary_specificity': 0.98544306, 'binary_f1_score': 0.49275362}
confusion matrix:
       0    1
0  17804  263
1    367  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.7263441, 'recall': 0.599053, 'specificity': 0.599053, 'f1': 0.6346316, 'auroc': 0.87791455, 'binary_precision': 0.4864865, 'binary_recall': 0.20769231, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.29110512}
confusion matrix:
      0   1
0  5889  57
1   206  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_25.png
early stop counter: 13
val acc:0.9663820862770081, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9634224772453308
after epoch: 25,now: 2024-07-08 04:03:45.463511,epoch time: 0:57:34.401700,used: 1 day, 0:35:18.294516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.991079, 'precision': 0.99249697, 'recall': 0.98393065, 'specificity': 0.98393065, 'f1': 0.9881189, 'auroc': 0.9988451, 'binary_precision': 0.9953008, 'binary_recall': 0.96941745, 'binary_specificity': 0.99844384, 'binary_f1_score': 0.9821886}
confusion matrix:
       0      1
0  42346     66
1    441  13979
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.7396424, 'recall': 0.7331218, 'specificity': 0.7331218, 'f1': 0.73633164, 'auroc': 0.92369217, 'binary_precision': 0.49847096, 'binary_recall': 0.48439822, 'binary_specificity': 0.9818454, 'binary_f1_score': 0.49133387}
confusion matrix:
       0    1
0  17739  328
1    347  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7539515, 'recall': 0.64436597, 'specificity': 0.64436597, 'f1': 0.6822237, 'auroc': 0.88272595, 'binary_precision': 0.537931, 'binary_recall': 0.3, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.38518518}
confusion matrix:
      0   1
0  5879  67
1   182  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_26.png
early stop counter: 14
val acc:0.9639807939529419, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9634224772453308
after epoch: 26,now: 2024-07-08 05:01:48.426811,epoch time: 0:58:02.963300,used: 1 day, 1:33:21.257816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99250424, 'precision': 0.9923771, 'recall': 0.98779196, 'specificity': 0.98779196, 'f1': 0.99005723, 'auroc': 0.9989507, 'binary_precision': 0.99212265, 'binary_recall': 0.9782247, 'binary_specificity': 0.9973592, 'binary_f1_score': 0.98512465}
confusion matrix:
       0      1
0  42300    112
1    314  14106
---- Validation: 
scalar performance:
{'acc': 0.9627001, 'precision': 0.73323214, 'recall': 0.76607513, 'specificity': 0.76607513, 'f1': 0.7484326, 'auroc': 0.9280975, 'binary_precision': 0.48316061, 'binary_recall': 0.55423474, 'binary_specificity': 0.9779155, 'binary_f1_score': 0.51626295}
confusion matrix:
       0    1
0  17668  399
1    300  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7457042, 'recall': 0.70471615, 'specificity': 0.70471615, 'f1': 0.7230869, 'auroc': 0.89247656, 'binary_precision': 0.51627904, 'binary_recall': 0.42692307, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.4673684}
confusion matrix:
      0    1
0  5842  104
1   149  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716433_27.png
early stop counter: 15
val acc:0.9627001285552979, best validation acc: 0.966488778591156, corresponding to test acc:                         0.961005449295044 / 0.9634224772453308
after epoch: 27,now: 2024-07-08 05:59:42.663765,epoch time: 0:57:54.236954,used: 1 day, 2:31:15.494770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_28_27_seed_1_21716433
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21716433 ON supergpu03 CANCELLED AT 2024-07-08T06:40:42 DUE TO TIME LIMIT ***
