Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul  6 01:11:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432

 Experiment start at: 2024-07-06 01:17:33.938612
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96353436, 'precision': 0.9685805, 'recall': 0.9357821, 'specificity': 0.9357821, 'f1': 0.9506992, 'auroc': 0.986622, 'binary_precision': 0.9779862, 'binary_recall': 0.8784399, 'binary_specificity': 0.9931243, 'binary_f1_score': 0.9255441}
confusion matrix:
       0      1
0  42032    291
1   1789  12928
---- Validation: 
scalar performance:
{'acc': 0.9579076, 'precision': 0.6840447, 'recall': 0.690937, 'specificity': 0.690937, 'f1': 0.68741846, 'auroc': 0.8923408, 'binary_precision': 0.38922155, 'binary_recall': 0.4043546, 'binary_specificity': 0.9775194, 'binary_f1_score': 0.39664382}
confusion matrix:
       0    1
0  17741  408
1    383  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.74086607, 'recall': 0.6981422, 'specificity': 0.6981422, 'f1': 0.7171356, 'auroc': 0.8993566, 'binary_precision': 0.5070422, 'binary_recall': 0.41379312, 'binary_specificity': 0.98249125, 'binary_f1_score': 0.4556962}
confusion matrix:
      0    1
0  5892  105
1   153  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-06 01:49:33.217778,epoch time: 0:31:59.279166,used: 0:31:59.279166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.971371, 'precision': 0.9756059, 'recall': 0.9494174, 'specificity': 0.9494174, 'f1': 0.961578, 'auroc': 0.9911064, 'binary_precision': 0.9836611, 'binary_recall': 0.90405655, 'binary_specificity': 0.9947783, 'binary_f1_score': 0.94218034}
confusion matrix:
       0      1
0  42102    221
1   1412  13305
---- Validation: 
scalar performance:
{'acc': 0.95854616, 'precision': 0.6981852, 'recall': 0.74152136, 'specificity': 0.74152136, 'f1': 0.7174184, 'auroc': 0.9132602, 'binary_precision': 0.41392404, 'binary_recall': 0.5085537, 'binary_specificity': 0.974489, 'binary_f1_score': 0.45638523}
confusion matrix:
       0    1
0  17686  463
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.74454385, 'recall': 0.78984225, 'specificity': 0.78984225, 'f1': 0.7649823, 'auroc': 0.9125022, 'binary_precision': 0.50641024, 'binary_recall': 0.60536397, 'binary_specificity': 0.9743205, 'binary_f1_score': 0.5514834}
confusion matrix:
      0    1
0  5843  154
1   103  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-06 02:20:44.678080,epoch time: 0:31:11.460302,used: 1:03:10.739468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9753156, 'precision': 0.9797806, 'recall': 0.9556792, 'specificity': 0.9556792, 'f1': 0.96694636, 'auroc': 0.9938562, 'binary_precision': 0.9883294, 'binary_recall': 0.9151149, 'binary_specificity': 0.9962434, 'binary_f1_score': 0.9503141}
confusion matrix:
       0      1
0  42167    159
1   1249  13465
---- Validation: 
scalar performance:
{'acc': 0.9582269, 'precision': 0.703063, 'recall': 0.77960885, 'specificity': 0.77960885, 'f1': 0.7344055, 'auroc': 0.92134404, 'binary_precision': 0.42093542, 'binary_recall': 0.58786935, 'binary_specificity': 0.9713483, 'binary_f1_score': 0.4905905}
confusion matrix:
       0    1
0  17629  520
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7494633, 'recall': 0.8269058, 'specificity': 0.8269058, 'f1': 0.7821821, 'auroc': 0.9140371, 'binary_precision': 0.5129683, 'binary_recall': 0.68199235, 'binary_specificity': 0.9718192, 'binary_f1_score': 0.58552635}
confusion matrix:
      0    1
0  5828  169
1    83  178
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_3.png
new oracle model saved
early stop counter: 1
val acc:0.9582269191741943, best validation acc: 0.9585461616516113, corresponding to test acc:                         0.9589325785636902 / 0.9597315192222595
after epoch: 3,now: 2024-07-06 02:51:50.608291,epoch time: 0:31:05.930211,used: 1:34:16.669679,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9796283, 'precision': 0.98226666, 'recall': 0.96440214, 'specificity': 0.96440214, 'f1': 0.9729035, 'auroc': 0.99541354, 'binary_precision': 0.9874155, 'binary_recall': 0.93293923, 'binary_specificity': 0.99586505, 'binary_f1_score': 0.9594047}
confusion matrix:
       0      1
0  42147    175
1    987  13731
---- Validation: 
scalar performance:
{'acc': 0.9537037, 'precision': 0.6917769, 'recall': 0.81627, 'specificity': 0.81627, 'f1': 0.7364224, 'auroc': 0.92404234, 'binary_precision': 0.39558417, 'binary_recall': 0.6687403, 'binary_specificity': 0.96379966, 'binary_f1_score': 0.49710983}
confusion matrix:
       0    1
0  17492  657
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9504634, 'precision': 0.71469915, 'recall': 0.83856106, 'specificity': 0.83856106, 'f1': 0.7602917, 'auroc': 0.91463375, 'binary_precision': 0.44208038, 'binary_recall': 0.71647507, 'binary_specificity': 0.960647, 'binary_f1_score': 0.54678357}
confusion matrix:
      0    1
0  5761  236
1    74  187
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_4.png
early stop counter: 2
val acc:0.9537037014961243, best validation acc: 0.9585461616516113, corresponding to test acc:                         0.9589325785636902 / 0.9597315192222595
after epoch: 4,now: 2024-07-06 03:22:53.559038,epoch time: 0:31:02.950747,used: 2:05:19.620426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98069775, 'precision': 0.98433566, 'recall': 0.9652269, 'specificity': 0.9652269, 'f1': 0.9742919, 'auroc': 0.9957339, 'binary_precision': 0.9914092, 'binary_recall': 0.9332654, 'binary_specificity': 0.99718845, 'binary_f1_score': 0.96145904}
confusion matrix:
       0      1
0  42206    119
1    982  13733
---- Validation: 
scalar performance:
{'acc': 0.9560983, 'precision': 0.6967221, 'recall': 0.794258, 'specificity': 0.794258, 'f1': 0.7343703, 'auroc': 0.92387885, 'binary_precision': 0.40714285, 'binary_recall': 0.62052876, 'binary_specificity': 0.96798724, 'binary_f1_score': 0.49168208}
confusion matrix:
       0    1
0  17568  581
1    244  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.7312075, 'recall': 0.8283193, 'specificity': 0.8283193, 'f1': 0.7699448, 'auroc': 0.9120722, 'binary_precision': 0.47619048, 'binary_recall': 0.6896552, 'binary_specificity': 0.9669835, 'binary_f1_score': 0.5633803}
confusion matrix:
      0    1
0  5799  198
1    81  180
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_5.png
early stop counter: 3
val acc:0.9560983180999756, best validation acc: 0.9585461616516113, corresponding to test acc:                         0.9589325785636902 / 0.9597315192222595
after epoch: 5,now: 2024-07-06 03:53:46.307427,epoch time: 0:30:52.748389,used: 2:36:12.368815,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98385346, 'precision': 0.98521113, 'recall': 0.9724957, 'specificity': 0.9724957, 'f1': 0.97863555, 'auroc': 0.9964841, 'binary_precision': 0.98790324, 'binary_recall': 0.9490316, 'binary_specificity': 0.9959598, 'binary_f1_score': 0.96807736}
confusion matrix:
       0      1
0  42154    171
1    750  13965
---- Validation: 
scalar performance:
{'acc': 0.94715834, 'precision': 0.6760166, 'recall': 0.83613306, 'specificity': 0.83613306, 'f1': 0.7268114, 'auroc': 0.9237497, 'binary_precision': 0.3624214, 'binary_recall': 0.7169518, 'binary_specificity': 0.95531434, 'binary_f1_score': 0.48146218}
confusion matrix:
       0    1
0  17338  811
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94151485, 'precision': 0.69033873, 'recall': 0.8430537, 'specificity': 0.8430537, 'f1': 0.7404467, 'auroc': 0.907938, 'binary_precision': 0.39263803, 'binary_recall': 0.7356322, 'binary_specificity': 0.9504752, 'binary_f1_score': 0.512}
confusion matrix:
      0    1
0  5700  297
1    69  192
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_6.png
early stop counter: 4
val acc:0.9471583366394043, best validation acc: 0.9585461616516113, corresponding to test acc:                         0.9589325785636902 / 0.9597315192222595
after epoch: 6,now: 2024-07-06 04:24:55.128113,epoch time: 0:31:08.820686,used: 3:07:21.189501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98543125, 'precision': 0.9865591, 'recall': 0.97529083, 'specificity': 0.97529083, 'f1': 0.98075414, 'auroc': 0.9971217, 'binary_precision': 0.98880595, 'binary_recall': 0.9543385, 'binary_specificity': 0.9962432, 'binary_f1_score': 0.9712665}
confusion matrix:
       0      1
0  42164    159
1    672  14045
---- Validation: 
scalar performance:
{'acc': 0.951788, 'precision': 0.68799126, 'recall': 0.8302793, 'specificity': 0.8302793, 'f1': 0.736508, 'auroc': 0.92610013, 'binary_precision': 0.38693035, 'binary_recall': 0.6998445, 'binary_specificity': 0.9607141, 'binary_f1_score': 0.49833885}
confusion matrix:
       0    1
0  17436  713
1    193  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9472675, 'precision': 0.70417583, 'recall': 0.8332288, 'specificity': 0.8332288, 'f1': 0.75032157, 'auroc': 0.9117713, 'binary_precision': 0.4214123, 'binary_recall': 0.70881224, 'binary_specificity': 0.9576455, 'binary_f1_score': 0.5285714}
confusion matrix:
      0    1
0  5743  254
1    76  185
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_7.png
early stop counter: 5
val acc:0.9517880082130432, best validation acc: 0.9585461616516113, corresponding to test acc:                         0.9589325785636902 / 0.9597315192222595
after epoch: 7,now: 2024-07-06 04:55:50.522446,epoch time: 0:30:55.394333,used: 3:38:16.583834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98280156, 'precision': 0.98717153, 'recall': 0.9679924, 'specificity': 0.9679924, 'f1': 0.9770928, 'auroc': 0.9970302, 'binary_precision': 0.9956685, 'binary_recall': 0.9374023, 'binary_specificity': 0.9985825, 'binary_f1_score': 0.9656573}
confusion matrix:
       0      1
0  42267     60
1    921  13792
---- Validation: 
scalar performance:
{'acc': 0.9541294, 'precision': 0.6908715, 'recall': 0.8022393, 'specificity': 0.8022393, 'f1': 0.7320562, 'auroc': 0.9208061, 'binary_precision': 0.39481267, 'binary_recall': 0.63919127, 'binary_specificity': 0.9652873, 'binary_f1_score': 0.4881235}
confusion matrix:
       0    1
0  17519  630
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549377, 'precision': 0.7288608, 'recall': 0.82257223, 'specificity': 0.82257223, 'f1': 0.7664332, 'auroc': 0.9023359, 'binary_precision': 0.472, 'binary_recall': 0.6781609, 'binary_specificity': 0.9669835, 'binary_f1_score': 0.5566038}
confusion matrix:
      0    1
0  5799  198
1    84  177
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_8.png
early stop counter: 6
val acc:0.9541293978691101, best validation acc: 0.9585461616516113, corresponding to test acc:                         0.9589325785636902 / 0.9597315192222595
after epoch: 8,now: 2024-07-06 05:26:46.448851,epoch time: 0:30:55.926405,used: 4:09:12.510239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98620266, 'precision': 0.98800945, 'recall': 0.9758948, 'specificity': 0.9758948, 'f1': 0.9817557, 'auroc': 0.99724686, 'binary_precision': 0.991599, 'binary_recall': 0.95460105, 'binary_specificity': 0.9971885, 'binary_f1_score': 0.97274834}
confusion matrix:
       0      1
0  42207    119
1    668  14046
---- Validation: 
scalar performance:
{'acc': 0.95333123, 'precision': 0.6892377, 'recall': 0.8085766, 'specificity': 0.8085766, 'f1': 0.73238695, 'auroc': 0.92015594, 'binary_precision': 0.39106146, 'binary_recall': 0.65318817, 'binary_specificity': 0.96396494, 'binary_f1_score': 0.4892254}
confusion matrix:
       0    1
0  17495  654
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.74752593, 'recall': 0.810248, 'specificity': 0.810248, 'f1': 0.7748222, 'auroc': 0.90230906, 'binary_precision': 0.51057404, 'binary_recall': 0.6475096, 'binary_specificity': 0.9729865, 'binary_f1_score': 0.5709459}
confusion matrix:
      0    1
0  5835  162
1    92  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_9.png
early stop counter: 7
val acc:0.9533312320709229, best validation acc: 0.9585461616516113, corresponding to test acc:                         0.9589325785636902 / 0.9597315192222595
after epoch: 9,now: 2024-07-06 05:57:46.452207,epoch time: 0:31:00.003356,used: 4:40:12.513595,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9862728, 'precision': 0.9872217, 'recall': 0.97683156, 'specificity': 0.97683156, 'f1': 0.9818815, 'auroc': 0.9975959, 'binary_precision': 0.98911744, 'binary_recall': 0.95732534, 'binary_specificity': 0.9963378, 'binary_f1_score': 0.9729617}
confusion matrix:
       0      1
0  42169    155
1    628  14088
---- Validation: 
scalar performance:
{'acc': 0.95125586, 'precision': 0.683998, 'recall': 0.8165028, 'specificity': 0.8165028, 'f1': 0.7299048, 'auroc': 0.920386, 'binary_precision': 0.37994722, 'binary_recall': 0.6718507, 'binary_specificity': 0.9611549, 'binary_f1_score': 0.48539326}
confusion matrix:
       0    1
0  17444  705
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95605624, 'precision': 0.732544, 'recall': 0.8121618, 'specificity': 0.8121618, 'f1': 0.76559186, 'auroc': 0.9002669, 'binary_precision': 0.48033708, 'binary_recall': 0.6551724, 'binary_specificity': 0.96915126, 'binary_f1_score': 0.554295}
confusion matrix:
      0    1
0  5812  185
1    90  171
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_10.png
early stop counter: 8
val acc:0.9512558579444885, best validation acc: 0.9585461616516113, corresponding to test acc:                         0.9589325785636902 / 0.9597315192222595
after epoch: 10,now: 2024-07-06 06:28:58.191111,epoch time: 0:31:11.738904,used: 5:11:24.252499,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.98830694, 'recall': 0.9789674, 'specificity': 0.9789674, 'f1': 0.9835201, 'auroc': 0.9972999, 'binary_precision': 0.98992443, 'binary_recall': 0.9613372, 'binary_specificity': 0.9965976, 'binary_f1_score': 0.9754214}
confusion matrix:
       0      1
0  42179    144
1    569  14148
---- Validation: 
scalar performance:
{'acc': 0.9559387, 'precision': 0.7001869, 'recall': 0.8204273, 'specificity': 0.8204273, 'f1': 0.7443603, 'auroc': 0.92329717, 'binary_precision': 0.41215575, 'binary_recall': 0.6749611, 'binary_specificity': 0.96589345, 'binary_f1_score': 0.5117924}
confusion matrix:
       0    1
0  17530  619
1    209  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.7588674, 'recall': 0.8077506, 'specificity': 0.8077506, 'f1': 0.78089213, 'auroc': 0.9007436, 'binary_precision': 0.5335463, 'binary_recall': 0.63984674, 'binary_specificity': 0.9756545, 'binary_f1_score': 0.5818815}
confusion matrix:
      0    1
0  5851  146
1    94  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_11.png
new oracle model saved
early stop counter: 9
val acc:0.9559386968612671, best validation acc: 0.9585461616516113, corresponding to test acc:                         0.9589325785636902 / 0.9616490602493286
after epoch: 11,now: 2024-07-06 06:59:53.555880,epoch time: 0:30:55.364769,used: 5:42:19.617268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.988622, 'precision': 0.98785865, 'recall': 0.9823375, 'specificity': 0.9823375, 'f1': 0.9850569, 'auroc': 0.9977777, 'binary_precision': 0.9863099, 'binary_recall': 0.9693531, 'binary_specificity': 0.9953218, 'binary_f1_score': 0.977758}
confusion matrix:
       0      1
0  42126    198
1    451  14265
---- Validation: 
scalar performance:
{'acc': 0.9520541, 'precision': 0.6885796, 'recall': 0.8289169, 'specificity': 0.8289169, 'f1': 0.73671603, 'auroc': 0.9206138, 'binary_precision': 0.38821492, 'binary_recall': 0.6967341, 'binary_specificity': 0.9610998, 'binary_f1_score': 0.4986088}
confusion matrix:
       0    1
0  17443  706
1    195  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.7331145, 'recall': 0.8013346, 'specificity': 0.8013346, 'f1': 0.7621738, 'auroc': 0.9002076, 'binary_precision': 0.48245615, 'binary_recall': 0.6321839, 'binary_specificity': 0.97048527, 'binary_f1_score': 0.54726374}
confusion matrix:
      0    1
0  5820  177
1    96  165
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_12.png
early stop counter: 10
val acc:0.9520540833473206, best validation acc: 0.9585461616516113, corresponding to test acc:                         0.9589325785636902 / 0.9616490602493286
after epoch: 12,now: 2024-07-06 07:30:48.817142,epoch time: 0:30:55.261262,used: 6:13:14.878530,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9878682, 'precision': 0.99022824, 'recall': 0.9780839, 'specificity': 0.9780839, 'f1': 0.9839598, 'auroc': 0.9978408, 'binary_precision': 0.9949181, 'binary_recall': 0.957869, 'binary_specificity': 0.9982988, 'binary_f1_score': 0.97604203}
confusion matrix:
       0      1
0  42252     72
1    620  14096
---- Validation: 
scalar performance:
{'acc': 0.95961046, 'precision': 0.70975983, 'recall': 0.7833253, 'specificity': 0.7833253, 'f1': 0.74029696, 'auroc': 0.9179505, 'binary_precision': 0.4340909, 'binary_recall': 0.5940902, 'binary_specificity': 0.97256047, 'binary_f1_score': 0.5016416}
confusion matrix:
       0    1
0  17651  498
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.7913195, 'recall': 0.7827668, 'specificity': 0.7827668, 'f1': 0.78697133, 'auroc': 0.8947575, 'binary_precision': 0.6007905, 'binary_recall': 0.58237547, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.59143966}
confusion matrix:
      0    1
0  5896  101
1   109  152
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_13.png
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-06 08:01:46.088934,epoch time: 0:30:57.271792,used: 6:44:12.150322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98907787, 'precision': 0.98994803, 'recall': 0.98147225, 'specificity': 0.98147225, 'f1': 0.98561406, 'auroc': 0.99804485, 'binary_precision': 0.9916975, 'binary_recall': 0.96575624, 'binary_specificity': 0.9971882, 'binary_f1_score': 0.97855496}
confusion matrix:
       0      1
0  42203    119
1    504  14214
---- Validation: 
scalar performance:
{'acc': 0.9557791, 'precision': 0.69777, 'recall': 0.80834377, 'specificity': 0.80834377, 'f1': 0.7391815, 'auroc': 0.91928875, 'binary_precision': 0.40820312, 'binary_recall': 0.65007776, 'binary_specificity': 0.9666097, 'binary_f1_score': 0.5014997}
confusion matrix:
       0    1
0  17543  606
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.78250825, 'recall': 0.78768027, 'specificity': 0.78768027, 'f1': 0.7850677, 'auroc': 0.8970928, 'binary_precision': 0.58270675, 'binary_recall': 0.59386975, 'binary_specificity': 0.98149073, 'binary_f1_score': 0.58823526}
confusion matrix:
      0    1
0  5886  111
1   106  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_14.png
early stop counter: 1
val acc:0.9557790756225586, best validation acc: 0.9596104621887207, corresponding to test acc:                         0.9664429426193237 / 0.9664429426193237
after epoch: 14,now: 2024-07-06 08:32:45.718228,epoch time: 0:30:59.629294,used: 7:15:11.779616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9896564, 'precision': 0.9895258, 'recall': 0.9833871, 'specificity': 0.9833871, 'f1': 0.98640585, 'auroc': 0.99829704, 'binary_precision': 0.98926145, 'binary_recall': 0.97043633, 'binary_specificity': 0.99633795, 'binary_f1_score': 0.9797585}
confusion matrix:
       0      1
0  42171    155
1    435  14279
---- Validation: 
scalar performance:
{'acc': 0.9566837, 'precision': 0.7014444, 'recall': 0.81031215, 'specificity': 0.81031215, 'f1': 0.7426023, 'auroc': 0.91840935, 'binary_precision': 0.41543028, 'binary_recall': 0.65318817, 'binary_specificity': 0.9674362, 'binary_f1_score': 0.50785977}
confusion matrix:
       0    1
0  17558  591
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.784099, 'recall': 0.784099, 'specificity': 0.784099, 'f1': 0.784099, 'auroc': 0.8960662, 'binary_precision': 0.5862069, 'binary_recall': 0.5862069, 'binary_specificity': 0.981991, 'binary_f1_score': 0.5862069}
confusion matrix:
      0    1
0  5889  108
1   108  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_15.png
early stop counter: 2
val acc:0.9566836953163147, best validation acc: 0.9596104621887207, corresponding to test acc:                         0.9664429426193237 / 0.9664429426193237
after epoch: 15,now: 2024-07-06 09:03:39.380243,epoch time: 0:30:53.662015,used: 7:46:05.441631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98907787, 'precision': 0.98913074, 'recall': 0.9822668, 'specificity': 0.9822668, 'f1': 0.9856355, 'auroc': 0.99794877, 'binary_precision': 0.9892376, 'binary_recall': 0.96819574, 'binary_specificity': 0.9963379, 'binary_f1_score': 0.9786036}
confusion matrix:
       0      1
0  42170    155
1    468  14247
---- Validation: 
scalar performance:
{'acc': 0.95929116, 'precision': 0.713142, 'recall': 0.8206628, 'specificity': 0.8206628, 'f1': 0.7545551, 'auroc': 0.92526054, 'binary_precision': 0.43813387, 'binary_recall': 0.6718507, 'binary_specificity': 0.9694749, 'binary_f1_score': 0.53038675}
confusion matrix:
       0    1
0  17595  554
1    211  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.81630397, 'recall': 0.7825186, 'specificity': 0.7825186, 'f1': 0.79834497, 'auroc': 0.9019706, 'binary_precision': 0.6508621, 'binary_recall': 0.5785441, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.6125761}
confusion matrix:
      0    1
0  5916   81
1   110  151
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_16.png
new oracle model saved
early stop counter: 3
val acc:0.9592911601066589, best validation acc: 0.9596104621887207, corresponding to test acc:                         0.9664429426193237 / 0.9694790840148926
after epoch: 16,now: 2024-07-06 09:34:37.451585,epoch time: 0:30:58.071342,used: 8:17:03.512973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98958623, 'precision': 0.9906119, 'recall': 0.982145, 'specificity': 0.982145, 'f1': 0.98628277, 'auroc': 0.99820817, 'binary_precision': 0.99267375, 'binary_recall': 0.9667709, 'binary_specificity': 0.99751914, 'binary_f1_score': 0.9795511}
confusion matrix:
       0      1
0  42219    105
1    489  14227
---- Validation: 
scalar performance:
{'acc': 0.9604619, 'precision': 0.7149835, 'recall': 0.7935169, 'specificity': 0.7935169, 'f1': 0.7473599, 'auroc': 0.9193028, 'binary_precision': 0.44382024, 'binary_recall': 0.61430794, 'binary_specificity': 0.97272575, 'binary_f1_score': 0.5153294}
confusion matrix:
       0    1
0  17654  495
1    248  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.81733954, 'recall': 0.7657775, 'specificity': 0.7657775, 'f1': 0.78901327, 'auroc': 0.8875483, 'binary_precision': 0.6543779, 'binary_recall': 0.5440613, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.59414226}
confusion matrix:
      0    1
0  5922   75
1   119  142
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_17.png
better model found
persisted
after epoch: 17,now: 2024-07-06 10:05:49.722137,epoch time: 0:31:12.270552,used: 8:48:15.783525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9903226, 'precision': 0.9918908, 'recall': 0.98282063, 'specificity': 0.98282063, 'f1': 0.9872463, 'auroc': 0.99828243, 'binary_precision': 0.99503773, 'binary_recall': 0.96731895, 'binary_specificity': 0.99832237, 'binary_f1_score': 0.9809826}
confusion matrix:
       0      1
0  42251     71
1    481  14237
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.73504406, 'recall': 0.7522727, 'specificity': 0.7522727, 'f1': 0.74331695, 'auroc': 0.9169258, 'binary_precision': 0.4869942, 'binary_recall': 0.5241057, 'binary_specificity': 0.9804397, 'binary_f1_score': 0.50486887}
confusion matrix:
       0    1
0  17794  355
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97347397, 'precision': 0.89400846, 'recall': 0.73513, 'specificity': 0.73513, 'f1': 0.79265857, 'auroc': 0.88876736, 'binary_precision': 0.8104575, 'binary_recall': 0.47509578, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.59903383}
confusion matrix:
      0    1
0  5968   29
1   137  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_18.png
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-06 10:37:02.025299,epoch time: 0:31:12.303162,used: 9:19:28.086687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9911115, 'precision': 0.9920069, 'recall': 0.98474634, 'specificity': 0.98474634, 'f1': 0.9883064, 'auroc': 0.9983685, 'binary_precision': 0.9938139, 'binary_recall': 0.9715955, 'binary_specificity': 0.99789715, 'binary_f1_score': 0.9825791}
confusion matrix:
       0      1
0  42235     89
1    418  14298
---- Validation: 
scalar performance:
{'acc': 0.9623776, 'precision': 0.7234118, 'recall': 0.784758, 'specificity': 0.784758, 'f1': 0.74989855, 'auroc': 0.9213915, 'binary_precision': 0.46135265, 'binary_recall': 0.5940902, 'binary_specificity': 0.97542566, 'binary_f1_score': 0.5193746}
confusion matrix:
       0    1
0  17703  446
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.8588538, 'recall': 0.76028246, 'specificity': 0.76028246, 'f1': 0.8009094, 'auroc': 0.89250576, 'binary_precision': 0.7379679, 'binary_recall': 0.52873564, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.6160714}
confusion matrix:
      0    1
0  5948   49
1   123  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_19.png
early stop counter: 1
val acc:0.9623776078224182, best validation acc: 0.964825451374054, corresponding to test acc:                         0.9734739661216736 / 0.9734739661216736
after epoch: 19,now: 2024-07-06 11:08:05.168414,epoch time: 0:31:03.143115,used: 9:50:31.229802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9911641, 'precision': 0.9924089, 'recall': 0.9844937, 'specificity': 0.9844937, 'f1': 0.9883679, 'auroc': 0.9980477, 'binary_precision': 0.9949157, 'binary_recall': 0.9707121, 'binary_specificity': 0.9982752, 'binary_f1_score': 0.9826649}
confusion matrix:
       0      1
0  42251     73
1    431  14285
---- Validation: 
scalar performance:
{'acc': 0.96439976, 'precision': 0.73329467, 'recall': 0.7670534, 'specificity': 0.7670534, 'f1': 0.74889445, 'auroc': 0.92088675, 'binary_precision': 0.48243243, 'binary_recall': 0.55520993, 'binary_specificity': 0.9788969, 'binary_f1_score': 0.51626897}
confusion matrix:
       0    1
0  17766  383
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97331417, 'precision': 0.8876686, 'recall': 0.7387113, 'specificity': 0.7387113, 'f1': 0.79381347, 'auroc': 0.88800323, 'binary_precision': 0.79746836, 'binary_recall': 0.4827586, 'binary_specificity': 0.994664, 'binary_f1_score': 0.601432}
confusion matrix:
      0    1
0  5965   32
1   135  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_20.png
early stop counter: 2
val acc:0.9643997550010681, best validation acc: 0.964825451374054, corresponding to test acc:                         0.9734739661216736 / 0.9734739661216736
after epoch: 20,now: 2024-07-06 11:39:02.136455,epoch time: 0:30:56.968041,used: 10:21:28.197843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99095374, 'precision': 0.9920378, 'recall': 0.98430663, 'specificity': 0.98430663, 'f1': 0.9880926, 'auroc': 0.99845564, 'binary_precision': 0.99422204, 'binary_recall': 0.97057426, 'binary_specificity': 0.998039, 'binary_f1_score': 0.9822558}
confusion matrix:
       0      1
0  42242     83
1    433  14282
---- Validation: 
scalar performance:
{'acc': 0.9620583, 'precision': 0.72425437, 'recall': 0.8100945, 'specificity': 0.8100945, 'f1': 0.75936365, 'auroc': 0.92879486, 'binary_precision': 0.46119735, 'binary_recall': 0.64696735, 'binary_specificity': 0.97322166, 'binary_f1_score': 0.53851134}
confusion matrix:
       0    1
0  17663  486
1    227  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97363377, 'precision': 0.85956484, 'recall': 0.7810217, 'specificity': 0.7810217, 'f1': 0.8149695, 'auroc': 0.89649427, 'binary_precision': 0.73762375, 'binary_recall': 0.57088125, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.64362854}
confusion matrix:
      0    1
0  5944   53
1   112  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_21.png
new oracle model saved
early stop counter: 3
val acc:0.9620583057403564, best validation acc: 0.964825451374054, corresponding to test acc:                         0.9734739661216736 / 0.9736337661743164
after epoch: 21,now: 2024-07-06 12:10:03.072667,epoch time: 0:31:00.936212,used: 10:52:29.134055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99076086, 'precision': 0.9922538, 'recall': 0.9836024, 'specificity': 0.9836024, 'f1': 0.9878286, 'auroc': 0.9986381, 'binary_precision': 0.9952534, 'binary_recall': 0.9688116, 'binary_specificity': 0.9983933, 'binary_f1_score': 0.9818545}
confusion matrix:
       0      1
0  42255     68
1    459  14258
---- Validation: 
scalar performance:
{'acc': 0.96141976, 'precision': 0.7204485, 'recall': 0.8022634, 'specificity': 0.8022634, 'f1': 0.75409466, 'auroc': 0.92630374, 'binary_precision': 0.4541387, 'binary_recall': 0.63141525, 'binary_specificity': 0.97311145, 'binary_f1_score': 0.52830195}
confusion matrix:
       0    1
0  17661  488
1    237  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.83840954, 'recall': 0.75561726, 'specificity': 0.75561726, 'f1': 0.7906171, 'auroc': 0.8855729, 'binary_precision': 0.6974359, 'binary_recall': 0.5210728, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.5964912}
confusion matrix:
      0    1
0  5938   59
1   125  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_22.png
early stop counter: 4
val acc:0.9614197611808777, best validation acc: 0.964825451374054, corresponding to test acc:                         0.9734739661216736 / 0.9736337661743164
after epoch: 22,now: 2024-07-06 12:41:03.897836,epoch time: 0:31:00.825169,used: 11:23:29.959224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99095374, 'precision': 0.99099445, 'recall': 0.98532623, 'specificity': 0.98532623, 'f1': 0.98811734, 'auroc': 0.9984007, 'binary_precision': 0.991077, 'binary_recall': 0.9737003, 'binary_specificity': 0.9969522, 'binary_f1_score': 0.98231184}
confusion matrix:
       0      1
0  42196    129
1    387  14328
---- Validation: 
scalar performance:
{'acc': 0.96067476, 'precision': 0.71736634, 'recall': 0.80562794, 'specificity': 0.80562794, 'f1': 0.7530354, 'auroc': 0.92580646, 'binary_precision': 0.44771242, 'binary_recall': 0.63919127, 'binary_specificity': 0.97206455, 'binary_f1_score': 0.5265855}
confusion matrix:
       0    1
0  17642  507
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.8287982, 'recall': 0.7532847, 'specificity': 0.7532847, 'f1': 0.78559834, 'auroc': 0.88716805, 'binary_precision': 0.67839193, 'binary_recall': 0.51724136, 'binary_specificity': 0.989328, 'binary_f1_score': 0.5869565}
confusion matrix:
      0    1
0  5933   64
1   126  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_23.png
early stop counter: 5
val acc:0.9606747627258301, best validation acc: 0.964825451374054, corresponding to test acc:                         0.9734739661216736 / 0.9736337661743164
after epoch: 23,now: 2024-07-06 13:12:07.528330,epoch time: 0:31:03.630494,used: 11:54:33.589718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9898843, 'precision': 0.99260694, 'recall': 0.98101604, 'specificity': 0.98101604, 'f1': 0.9866337, 'auroc': 0.9988095, 'binary_precision': 0.9980275, 'binary_recall': 0.9626937, 'binary_specificity': 0.99933845, 'binary_f1_score': 0.9800422}
confusion matrix:
       0      1
0  42296     28
1    549  14167
---- Validation: 
scalar performance:
{'acc': 0.96631545, 'precision': 0.7451904, 'recall': 0.74629366, 'specificity': 0.74629366, 'f1': 0.74574065, 'auroc': 0.9185499, 'binary_precision': 0.50773996, 'binary_recall': 0.5101089, 'binary_specificity': 0.9824784, 'binary_f1_score': 0.5089216}
confusion matrix:
       0    1
0  17831  318
1    315  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.9065573, 'recall': 0.6975662, 'specificity': 0.6975662, 'f1': 0.7628345, 'auroc': 0.88163114, 'binary_precision': 0.83870965, 'binary_recall': 0.39846742, 'binary_specificity': 0.996665, 'binary_f1_score': 0.5402597}
confusion matrix:
      0    1
0  5977   20
1   157  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_24.png
better model found
persisted
after epoch: 24,now: 2024-07-06 13:43:06.787040,epoch time: 0:30:59.258710,used: 12:25:32.848428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9922335, 'precision': 0.9927194, 'recall': 0.9869652, 'specificity': 0.9869652, 'f1': 0.9897982, 'auroc': 0.9987194, 'binary_precision': 0.9937046, 'binary_recall': 0.9760805, 'binary_specificity': 0.99784994, 'binary_f1_score': 0.9848137}
confusion matrix:
       0      1
0  42233     91
1    352  14364
---- Validation: 
scalar performance:
{'acc': 0.9633887, 'precision': 0.72991645, 'recall': 0.79878235, 'specificity': 0.79878235, 'f1': 0.7592871, 'auroc': 0.92282426, 'binary_precision': 0.4733728, 'binary_recall': 0.62208396, 'binary_specificity': 0.97548074, 'binary_f1_score': 0.53763443}
confusion matrix:
       0    1
0  17704  445
1    243  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.8651817, 'recall': 0.7511208, 'specificity': 0.7511208, 'f1': 0.7965326, 'auroc': 0.88464344, 'binary_precision': 0.75141245, 'binary_recall': 0.5095785, 'binary_specificity': 0.992663, 'binary_f1_score': 0.6073059}
confusion matrix:
      0    1
0  5953   44
1   128  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_25.png
early stop counter: 1
val acc:0.9633886814117432, best validation acc: 0.9663154482841492, corresponding to test acc:                         0.9717162251472473 / 0.9736337661743164
after epoch: 25,now: 2024-07-06 14:14:04.420349,epoch time: 0:30:57.633309,used: 12:56:30.481737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99135697, 'precision': 0.99316216, 'recall': 0.984267, 'specificity': 0.984267, 'f1': 0.9886097, 'auroc': 0.9986616, 'binary_precision': 0.9967861, 'binary_recall': 0.96962076, 'binary_specificity': 0.99891317, 'binary_f1_score': 0.98301584}
confusion matrix:
       0      1
0  42280     46
1    447  14267
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.7465353, 'recall': 0.7231521, 'specificity': 0.7231521, 'f1': 0.73419607, 'auroc': 0.91363764, 'binary_precision': 0.512069, 'binary_recall': 0.46189734, 'binary_specificity': 0.9844068, 'binary_f1_score': 0.4856909}
confusion matrix:
       0    1
0  17866  283
1    346  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.8824389, 'recall': 0.6534215, 'specificity': 0.6534215, 'f1': 0.7148709, 'auroc': 0.8733952, 'binary_precision': 0.7941176, 'binary_recall': 0.31034482, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.44628102}
confusion matrix:
      0   1
0  5976  21
1   180  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_26.png
better model found
persisted
after epoch: 26,now: 2024-07-06 14:45:00.789971,epoch time: 0:30:56.369622,used: 13:27:26.851359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.991953, 'precision': 0.99319124, 'recall': 0.9857806, 'specificity': 0.9857806, 'f1': 0.989413, 'auroc': 0.99897766, 'binary_precision': 0.99568933, 'binary_recall': 0.9730262, 'binary_specificity': 0.99853504, 'binary_f1_score': 0.98422736}
confusion matrix:
       0      1
0  42260     62
1    397  14321
---- Validation: 
scalar performance:
{'acc': 0.9641337, 'precision': 0.73289716, 'recall': 0.78416693, 'specificity': 0.78416693, 'f1': 0.7556708, 'auroc': 0.92490494, 'binary_precision': 0.48040456, 'binary_recall': 0.59097975, 'binary_specificity': 0.9773541, 'binary_f1_score': 0.5299861}
confusion matrix:
       0    1
0  17738  411
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97347397, 'precision': 0.9022603, 'recall': 0.72780067, 'specificity': 0.72780067, 'f1': 0.7887126, 'auroc': 0.8844446, 'binary_precision': 0.82758623, 'binary_recall': 0.4597701, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.591133}
confusion matrix:
      0    1
0  5972   25
1   141  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_27.png
early stop counter: 1
val acc:0.9641336798667908, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.9678810834884644 / 0.9736337661743164
after epoch: 27,now: 2024-07-06 15:15:56.306895,epoch time: 0:30:55.516924,used: 13:58:22.368283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9930049, 'precision': 0.9938069, 'recall': 0.9879068, 'specificity': 0.9879068, 'f1': 0.99081063, 'auroc': 0.99890137, 'binary_precision': 0.99543256, 'binary_recall': 0.9773731, 'binary_specificity': 0.99844056, 'binary_f1_score': 0.98632014}
confusion matrix:
       0      1
0  42257     66
1    333  14384
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7404439, 'recall': 0.76988214, 'specificity': 0.76988214, 'f1': 0.75421154, 'auroc': 0.91893065, 'binary_precision': 0.49655172, 'binary_recall': 0.5598756, 'binary_specificity': 0.9798887, 'binary_f1_score': 0.5263158}
confusion matrix:
       0    1
0  17784  365
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.89897317, 'recall': 0.70306325, 'specificity': 0.70306325, 'f1': 0.76635826, 'auroc': 0.87842435, 'binary_precision': 0.8230769, 'binary_recall': 0.4099617, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.5473145}
confusion matrix:
      0    1
0  5974   23
1   154  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_28.png
early stop counter: 2
val acc:0.9655172228813171, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.9678810834884644 / 0.9736337661743164
after epoch: 28,now: 2024-07-06 15:47:09.109817,epoch time: 0:31:12.802922,used: 14:29:35.171205,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9921634, 'precision': 0.9931492, 'recall': 0.98636305, 'specificity': 0.98636305, 'f1': 0.9896949, 'auroc': 0.99880457, 'binary_precision': 0.99514157, 'binary_recall': 0.9743799, 'binary_specificity': 0.99834615, 'binary_f1_score': 0.98465127}
confusion matrix:
       0      1
0  42255     70
1    377  14338
---- Validation: 
scalar performance:
{'acc': 0.9649851, 'precision': 0.7372239, 'recall': 0.77260685, 'specificity': 0.77260685, 'f1': 0.7535374, 'auroc': 0.91780096, 'binary_precision': 0.48990577, 'binary_recall': 0.5660964, 'binary_specificity': 0.97911733, 'binary_f1_score': 0.5252526}
confusion matrix:
       0    1
0  17770  379
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.8820022, 'recall': 0.6988149, 'specificity': 0.6988149, 'f1': 0.7589079, 'auroc': 0.8767663, 'binary_precision': 0.7894737, 'binary_recall': 0.40229884, 'binary_specificity': 0.995331, 'binary_f1_score': 0.5329949}
confusion matrix:
      0    1
0  5969   28
1   156  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_29.png
early stop counter: 3
val acc:0.9649850726127625, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.9678810834884644 / 0.9736337661743164
after epoch: 29,now: 2024-07-06 16:18:26.509502,epoch time: 0:31:17.399685,used: 15:00:52.570890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99247897, 'precision': 0.9937046, 'recall': 0.9866421, 'specificity': 0.9866421, 'f1': 0.99010724, 'auroc': 0.99884, 'binary_precision': 0.9961795, 'binary_recall': 0.97458375, 'binary_specificity': 0.99870056, 'binary_f1_score': 0.98526335}
confusion matrix:
       0      1
0  42270     55
1    374  14341
---- Validation: 
scalar performance:
{'acc': 0.96722007, 'precision': 0.75211823, 'recall': 0.7415116, 'specificity': 0.7415116, 'f1': 0.7466881, 'auroc': 0.92193496, 'binary_precision': 0.5219512, 'binary_recall': 0.4992224, 'binary_specificity': 0.98380077, 'binary_f1_score': 0.51033384}
confusion matrix:
       0    1
0  17855  294
1    322  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.8989394, 'recall': 0.67082965, 'specificity': 0.67082965, 'f1': 0.7354218, 'auroc': 0.87443644, 'binary_precision': 0.82568806, 'binary_recall': 0.3448276, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.4864865}
confusion matrix:
      0   1
0  5978  19
1   171  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_30.png
better model found
persisted
after epoch: 30,now: 2024-07-06 16:49:25.986812,epoch time: 0:30:59.477310,used: 15:31:52.048200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_33_seed_0_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:31:52.048200 at 2024-07-06 16:49:25.986812
persisted model performance metric: 

scalar performance:
{'acc': 0.9696389, 'precision': 0.8989394, 'recall': 0.67082965, 'specificity': 0.67082965, 'f1': 0.7354218, 'auroc': 0.87443644, 'binary_precision': 0.82568806, 'binary_recall': 0.3448276, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.4864865}
confusion matrix:
      0   1
0  5978  19
1   171  90
oracle model performance metric: 

scalar performance:
{'acc': 0.97363377, 'precision': 0.85956484, 'recall': 0.7810217, 'specificity': 0.7810217, 'f1': 0.8149695, 'auroc': 0.89649427, 'binary_precision': 0.73762375, 'binary_recall': 0.57088125, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.64362854}
confusion matrix:
      0    1
0  5944   53
1   112  149
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   4047 MiB |   2982 TiB |   2982 TiB |
|       from large pool | 180662 KiB |   4027 MiB |   2948 TiB |   2948 TiB |
|       from small pool |  17491 KiB |     37 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   4047 MiB |   2982 TiB |   2982 TiB |
|       from large pool | 180662 KiB |   4027 MiB |   2948 TiB |   2948 TiB |
|       from small pool |  17491 KiB |     37 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   4045 MiB |   2982 TiB |   2982 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   2948 TiB |   2948 TiB |
|       from small pool |  16482 KiB |     36 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4438 MiB |   4438 MiB |   4438 MiB |      0 B   |
|       from large pool |   4396 MiB |   4396 MiB |   4396 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  57847 KiB | 392988 KiB |   1552 TiB |   1552 TiB |
|       from large pool |  50762 KiB | 392048 KiB |   1518 TiB |   1518 TiB |
|       from small pool |   7085 KiB |   9383 KiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7605    |  403729 K  |  403726 K  |
|       from large pool |      79    |     423    |  276413 K  |  276413 K  |
|       from small pool |    2899    |    7525    |  127315 K  |  127312 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7605    |  403729 K  |  403726 K  |
|       from large pool |      79    |     423    |  276413 K  |  276413 K  |
|       from small pool |    2899    |    7525    |  127315 K  |  127312 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     203    |     203    |     203    |       0    |
|       from large pool |     182    |     182    |     182    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3586    |  282885 K  |  282885 K  |
|       from large pool |      10    |     183    |  216171 K  |  216171 K  |
|       from small pool |      20    |    3576    |   66713 K  |   66713 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   2982 TiB |   2982 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   2948 TiB |   2948 TiB |
|       from small pool |      0 KiB |     37 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   2982 TiB |   2982 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   2948 TiB |   2948 TiB |
|       from small pool |      0 KiB |     37 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   2982 TiB |   2982 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   2948 TiB |   2948 TiB |
|       from small pool |      0 KiB |     36 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   4438 MiB |   4438 MiB |   4188 MiB |
|       from large pool | 231424 KiB |   4396 MiB |   4396 MiB |   4170 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392988 KiB |   1552 TiB |   1552 TiB |
|       from large pool |  30464 KiB | 392048 KiB |   1518 TiB |   1518 TiB |
|       from small pool |      0 KiB |  18291 KiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |  403729 K  |  403729 K  |
|       from large pool |       2    |     423    |  276413 K  |  276413 K  |
|       from small pool |       0    |    7525    |  127315 K  |  127315 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |  403729 K  |  403729 K  |
|       from large pool |       2    |     423    |  276413 K  |  276413 K  |
|       from small pool |       0    |    7525    |  127315 K  |  127315 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     203    |     203    |     180    |
|       from large pool |      11    |     182    |     182    |     171    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3586    |  282886 K  |  282886 K  |
|       from large pool |       3    |     183    |  216171 K  |  216171 K  |
|       from small pool |       0    |    3576    |   66715 K  |   66715 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   2982 TiB |   2982 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   2948 TiB |   2948 TiB |
|       from small pool |      0 KiB |     37 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   2982 TiB |   2982 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   2948 TiB |   2948 TiB |
|       from small pool |      0 KiB |     37 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   2982 TiB |   2982 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   2948 TiB |   2948 TiB |
|       from small pool |      0 KiB |     36 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   4438 MiB |   4438 MiB |   4188 MiB |
|       from large pool | 231424 KiB |   4396 MiB |   4396 MiB |   4170 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392988 KiB |   1552 TiB |   1552 TiB |
|       from large pool |  30464 KiB | 392048 KiB |   1518 TiB |   1518 TiB |
|       from small pool |      0 KiB |  18291 KiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |  403729 K  |  403729 K  |
|       from large pool |       2    |     423    |  276413 K  |  276413 K  |
|       from small pool |       0    |    7525    |  127315 K  |  127315 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |  403729 K  |  403729 K  |
|       from large pool |       2    |     423    |  276413 K  |  276413 K  |
|       from small pool |       0    |    7525    |  127315 K  |  127315 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     203    |     203    |     180    |
|       from large pool |      11    |     182    |     182    |     171    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3586    |  282886 K  |  282886 K  |
|       from large pool |       3    |     183    |  216171 K  |  216171 K  |
|       from small pool |       0    |    3576    |   66715 K  |   66715 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432

 Experiment start at: 2024-07-06 16:55:03.712013
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9610783, 'precision': 0.9704275, 'recall': 0.92697567, 'specificity': 0.92697567, 'f1': 0.94620097, 'auroc': 0.98463947, 'binary_precision': 0.98714876, 'binary_recall': 0.85774726, 'binary_specificity': 0.9962041, 'binary_f1_score': 0.91790986}
confusion matrix:
       0      1
0  42253    161
1   2051  12367
---- Validation: 
scalar performance:
{'acc': 0.95592314, 'precision': 0.6675509, 'recall': 0.63810396, 'specificity': 0.63810396, 'f1': 0.65119046, 'auroc': 0.8692697, 'binary_precision': 0.36116153, 'binary_recall': 0.29569092, 'binary_specificity': 0.98051697, 'binary_f1_score': 0.3251634}
confusion matrix:
       0    1
0  17715  352
1    474  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9513374, 'precision': 0.63778925, 'recall': 0.56083274, 'specificity': 0.56083274, 'f1': 0.5815445, 'auroc': 0.8853146, 'binary_precision': 0.3125, 'binary_recall': 0.13461539, 'binary_specificity': 0.9870501, 'binary_f1_score': 0.18817206}
confusion matrix:
      0   1
0  5869  77
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-06 17:26:13.283187,epoch time: 0:31:09.571174,used: 0:31:09.571174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9702984, 'precision': 0.977255, 'recall': 0.94441116, 'specificity': 0.94441116, 'f1': 0.9594172, 'auroc': 0.9920916, 'binary_precision': 0.990067, 'binary_recall': 0.89186376, 'binary_specificity': 0.9969586, 'binary_f1_score': 0.9384031}
confusion matrix:
       0      1
0  42286    129
1   1559  12858
---- Validation: 
scalar performance:
{'acc': 0.96168625, 'precision': 0.7175287, 'recall': 0.6761409, 'specificity': 0.6761409, 'f1': 0.6943843, 'auroc': 0.8996749, 'binary_precision': 0.45841035, 'binary_recall': 0.36849925, 'binary_specificity': 0.9837826, 'binary_f1_score': 0.4085667}
confusion matrix:
       0    1
0  17774  293
1    425  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.79985154, 'recall': 0.67045915, 'specificity': 0.67045915, 'f1': 0.7154051, 'auroc': 0.91547513, 'binary_precision': 0.6275862, 'binary_recall': 0.35, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.44938272}
confusion matrix:
      0   1
0  5892  54
1   169  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-06 17:57:00.745983,epoch time: 0:30:47.462796,used: 1:01:57.033970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9757179, 'precision': 0.9786359, 'recall': 0.9570243, 'specificity': 0.9570243, 'f1': 0.9672123, 'auroc': 0.9937408, 'binary_precision': 0.98418236, 'binary_recall': 0.9190707, 'binary_specificity': 0.99497783, 'binary_f1_score': 0.9505128}
confusion matrix:
       0      1
0  42199    213
1   1167  13253
---- Validation: 
scalar performance:
{'acc': 0.9605123, 'precision': 0.716238, 'recall': 0.7248855, 'specificity': 0.7248855, 'f1': 0.72046566, 'auroc': 0.90825695, 'binary_precision': 0.45221114, 'binary_recall': 0.47102526, 'binary_specificity': 0.97874576, 'binary_f1_score': 0.46142653}
confusion matrix:
       0    1
0  17683  384
1    356  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.7922443, 'recall': 0.75221545, 'specificity': 0.75221545, 'f1': 0.7705753, 'auroc': 0.9229313, 'binary_precision': 0.6053812, 'binary_recall': 0.5192308, 'binary_specificity': 0.9852001, 'binary_f1_score': 0.5590062}
confusion matrix:
      0    1
0  5858   88
1   125  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_3.png
new oracle model saved
early stop counter: 1
val acc:0.9605122804641724, best validation acc: 0.9616862535476685, corresponding to test acc:                         0.9640670418739319 / 0.9656783938407898
after epoch: 3,now: 2024-07-06 18:27:51.965661,epoch time: 0:30:51.219678,used: 1:32:48.253648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9778294, 'precision': 0.9815048, 'recall': 0.9598552, 'specificity': 0.9598552, 'f1': 0.97006494, 'auroc': 0.9955213, 'binary_precision': 0.9884921, 'binary_recall': 0.923365, 'binary_specificity': 0.99634546, 'binary_f1_score': 0.95481926}
confusion matrix:
       0      1
0  42258    155
1   1105  13314
---- Validation: 
scalar performance:
{'acc': 0.96163285, 'precision': 0.7233084, 'recall': 0.726182, 'specificity': 0.726182, 'f1': 0.7247348, 'auroc': 0.91283345, 'binary_precision': 0.46627566, 'binary_recall': 0.47251114, 'binary_specificity': 0.9798528, 'binary_f1_score': 0.4693727}
confusion matrix:
       0    1
0  17703  364
1    355  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.8131697, 'recall': 0.7515537, 'specificity': 0.7515537, 'f1': 0.778608, 'auroc': 0.9225284, 'binary_precision': 0.647343, 'binary_recall': 0.5153846, 'binary_specificity': 0.9877228, 'binary_f1_score': 0.5738758}
confusion matrix:
      0    1
0  5873   73
1   126  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_4.png
new oracle model saved
early stop counter: 2
val acc:0.9616328477859497, best validation acc: 0.9616862535476685, corresponding to test acc:                         0.9640670418739319 / 0.967934250831604
after epoch: 4,now: 2024-07-06 18:58:35.293240,epoch time: 0:30:43.327579,used: 2:03:31.581227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98168284, 'precision': 0.983654, 'recall': 0.96784055, 'specificity': 0.96784055, 'f1': 0.975419, 'auroc': 0.99637914, 'binary_precision': 0.9874663, 'binary_recall': 0.9397365, 'binary_specificity': 0.99594456, 'binary_f1_score': 0.9630104}
confusion matrix:
       0      1
0  42240    172
1    869  13551
---- Validation: 
scalar performance:
{'acc': 0.9614194, 'precision': 0.7233352, 'recall': 0.7389461, 'specificity': 0.7389461, 'f1': 0.7308422, 'auroc': 0.9157373, 'binary_precision': 0.46537396, 'binary_recall': 0.49925706, 'binary_specificity': 0.9786351, 'binary_f1_score': 0.48172042}
confusion matrix:
       0    1
0  17681  386
1    337  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.7668936, 'recall': 0.7412546, 'specificity': 0.7412546, 'f1': 0.75334084, 'auroc': 0.92364216, 'binary_precision': 0.5555556, 'binary_recall': 0.5, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.5263158}
confusion matrix:
      0    1
0  5842  104
1   130  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_5.png
early stop counter: 3
val acc:0.961419403553009, best validation acc: 0.9616862535476685, corresponding to test acc:                         0.9640670418739319 / 0.967934250831604
after epoch: 5,now: 2024-07-06 19:29:23.572400,epoch time: 0:30:48.279160,used: 2:34:19.860387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9805567, 'precision': 0.98437005, 'recall': 0.9642664, 'specificity': 0.9642664, 'f1': 0.9737911, 'auroc': 0.99627495, 'binary_precision': 0.99165374, 'binary_recall': 0.9311971, 'binary_specificity': 0.9973358, 'binary_f1_score': 0.96047497}
confusion matrix:
       0      1
0  42301    113
1    992  13426
---- Validation: 
scalar performance:
{'acc': 0.96254003, 'precision': 0.7302605, 'recall': 0.73881197, 'specificity': 0.73881197, 'f1': 0.73444825, 'auroc': 0.918977, 'binary_precision': 0.4792561, 'binary_recall': 0.49777117, 'binary_specificity': 0.9798528, 'binary_f1_score': 0.4883382}
confusion matrix:
       0    1
0  17703  364
1    338  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.7769969, 'recall': 0.74008834, 'specificity': 0.74008834, 'f1': 0.7570554, 'auroc': 0.92272246, 'binary_precision': 0.57589287, 'binary_recall': 0.49615383, 'binary_specificity': 0.98402286, 'binary_f1_score': 0.53305787}
confusion matrix:
      0    1
0  5851   95
1   131  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_6.png
better model found
persisted
after epoch: 6,now: 2024-07-06 20:00:26.630327,epoch time: 0:31:03.057927,used: 3:05:22.918314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9835832, 'precision': 0.9850774, 'recall': 0.97144437, 'specificity': 0.97144437, 'f1': 0.9780173, 'auroc': 0.9970167, 'binary_precision': 0.9879858, 'binary_recall': 0.9468026, 'binary_specificity': 0.9960862, 'binary_f1_score': 0.9669559}
confusion matrix:
       0      1
0  42248    166
1    767  13651
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.7386868, 'recall': 0.71950406, 'specificity': 0.71950406, 'f1': 0.7286449, 'auroc': 0.91618395, 'binary_precision': 0.49756888, 'binary_recall': 0.45616642, 'binary_specificity': 0.9828417, 'binary_f1_score': 0.475969}
confusion matrix:
       0    1
0  17757  310
1    366  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.7680876, 'recall': 0.74133873, 'specificity': 0.74133873, 'f1': 0.75391734, 'auroc': 0.91882837, 'binary_precision': 0.5579399, 'binary_recall': 0.5, 'binary_specificity': 0.98267746, 'binary_f1_score': 0.5273833}
confusion matrix:
      0    1
0  5843  103
1   130  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_7.png
better model found
persisted
after epoch: 7,now: 2024-07-06 20:31:13.405925,epoch time: 0:30:46.775598,used: 3:36:09.693912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9847445, 'precision': 0.9859087, 'recall': 0.9736891, 'specificity': 0.9736891, 'f1': 0.9796033, 'auroc': 0.9970622, 'binary_precision': 0.98818445, 'binary_recall': 0.9512449, 'binary_specificity': 0.99613327, 'binary_f1_score': 0.9693629}
confusion matrix:
       0      1
0  42249    164
1    703  13716
---- Validation: 
scalar performance:
{'acc': 0.9590182, 'precision': 0.7152028, 'recall': 0.77847093, 'specificity': 0.77847093, 'f1': 0.7422071, 'auroc': 0.91957647, 'binary_precision': 0.446084, 'binary_recall': 0.5839524, 'binary_specificity': 0.97298944, 'binary_f1_score': 0.5057915}
confusion matrix:
       0    1
0  17579  488
1    280  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9518208, 'precision': 0.71309936, 'recall': 0.78176343, 'specificity': 0.78176343, 'f1': 0.7418493, 'auroc': 0.92273986, 'binary_precision': 0.44412607, 'binary_recall': 0.59615386, 'binary_specificity': 0.967373, 'binary_f1_score': 0.50903124}
confusion matrix:
      0    1
0  5752  194
1   105  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_8.png
early stop counter: 1
val acc:0.9590181708335876, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.962455689907074 / 0.967934250831604
after epoch: 8,now: 2024-07-06 21:02:04.401404,epoch time: 0:30:50.995479,used: 4:07:00.689391,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9852724, 'precision': 0.98798424, 'recall': 0.97310257, 'specificity': 0.97310257, 'f1': 0.9802557, 'auroc': 0.99740857, 'binary_precision': 0.9932447, 'binary_recall': 0.9483978, 'binary_specificity': 0.9978073, 'binary_f1_score': 0.9703033}
confusion matrix:
       0      1
0  42321     93
1    744  13674
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.7504842, 'recall': 0.72385526, 'specificity': 0.72385526, 'f1': 0.73633474, 'auroc': 0.91883904, 'binary_precision': 0.5208681, 'binary_recall': 0.46359584, 'binary_specificity': 0.9841147, 'binary_f1_score': 0.49056605}
confusion matrix:
       0    1
0  17780  287
1    361  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.77045834, 'recall': 0.7303889, 'specificity': 0.7303889, 'f1': 0.74861157, 'auroc': 0.9225937, 'binary_precision': 0.56363636, 'binary_recall': 0.47692308, 'binary_specificity': 0.9838547, 'binary_f1_score': 0.5166667}
confusion matrix:
      0    1
0  5850   96
1   136  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_9.png
better model found
persisted
after epoch: 9,now: 2024-07-06 21:32:58.645491,epoch time: 0:30:54.244087,used: 4:37:54.933478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98537797, 'precision': 0.98720026, 'recall': 0.9741118, 'specificity': 0.9741118, 'f1': 0.9804326, 'auroc': 0.99740374, 'binary_precision': 0.9907535, 'binary_recall': 0.9512415, 'binary_specificity': 0.99698216, 'binary_f1_score': 0.97059554}
confusion matrix:
       0      1
0  42286    128
1    703  13715
---- Validation: 
scalar performance:
{'acc': 0.9624867, 'precision': 0.73182905, 'recall': 0.7638186, 'specificity': 0.7638186, 'f1': 0.7466564, 'auroc': 0.9194641, 'binary_precision': 0.48051947, 'binary_recall': 0.5497771, 'binary_specificity': 0.9778602, 'binary_f1_score': 0.5128205}
confusion matrix:
       0    1
0  17667  400
1    303  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.75762117, 'recall': 0.77744573, 'specificity': 0.77744573, 'f1': 0.7671135, 'auroc': 0.91980195, 'binary_precision': 0.5338078, 'binary_recall': 0.5769231, 'binary_specificity': 0.9779684, 'binary_f1_score': 0.55452865}
confusion matrix:
      0    1
0  5815  131
1   110  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_10.png
early stop counter: 1
val acc:0.9624866843223572, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 10,now: 2024-07-06 22:04:22.563089,epoch time: 0:31:23.917598,used: 5:09:18.851076,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98694396, 'precision': 0.9873966, 'recall': 0.9780223, 'specificity': 0.9780223, 'f1': 0.9825945, 'auroc': 0.9972792, 'binary_precision': 0.98828906, 'binary_recall': 0.9599112, 'binary_specificity': 0.9961333, 'binary_f1_score': 0.9738935}
confusion matrix:
       0      1
0  42250    164
1    578  13840
---- Validation: 
scalar performance:
{'acc': 0.96318036, 'precision': 0.73506844, 'recall': 0.7491578, 'specificity': 0.7491578, 'f1': 0.7418821, 'auroc': 0.92330587, 'binary_precision': 0.48811188, 'binary_recall': 0.5185735, 'binary_specificity': 0.97974205, 'binary_f1_score': 0.5028819}
confusion matrix:
       0    1
0  17701  366
1    324  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.74597293, 'recall': 0.7378179, 'specificity': 0.7378179, 'f1': 0.7418168, 'auroc': 0.9184803, 'binary_precision': 0.5139442, 'binary_recall': 0.49615383, 'binary_specificity': 0.979482, 'binary_f1_score': 0.50489235}
confusion matrix:
      0    1
0  5824  122
1   131  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_11.png
early stop counter: 2
val acc:0.9631803631782532, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 11,now: 2024-07-06 22:38:32.487236,epoch time: 0:34:09.924147,used: 5:43:28.775223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98706716, 'precision': 0.9895411, 'recall': 0.97629803, 'specificity': 0.97629803, 'f1': 0.98269224, 'auroc': 0.9980882, 'binary_precision': 0.99436414, 'binary_recall': 0.9544351, 'binary_specificity': 0.99816096, 'binary_f1_score': 0.97399056}
confusion matrix:
       0      1
0  42335     78
1    657  13762
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.74838257, 'recall': 0.7466054, 'specificity': 0.7466054, 'f1': 0.7474904, 'auroc': 0.9205538, 'binary_precision': 0.51497006, 'binary_recall': 0.5111441, 'binary_specificity': 0.98206675, 'binary_f1_score': 0.51304996}
confusion matrix:
       0    1
0  17743  324
1    329  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7396728, 'recall': 0.72995746, 'specificity': 0.72995746, 'f1': 0.73469996, 'auroc': 0.9117396, 'binary_precision': 0.502008, 'binary_recall': 0.48076922, 'binary_specificity': 0.97914565, 'binary_f1_score': 0.49115914}
confusion matrix:
      0    1
0  5822  124
1   135  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_12.png
early stop counter: 3
val acc:0.965154767036438, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 12,now: 2024-07-06 23:09:55.691868,epoch time: 0:31:23.204632,used: 6:14:51.979855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98814046, 'precision': 0.988396, 'recall': 0.9801973, 'specificity': 0.9801973, 'f1': 0.98420876, 'auroc': 0.99797463, 'binary_precision': 0.98890156, 'binary_recall': 0.9640727, 'binary_specificity': 0.996322, 'binary_f1_score': 0.97632927}
confusion matrix:
       0      1
0  42258    156
1    518  13900
---- Validation: 
scalar performance:
{'acc': 0.9599253, 'precision': 0.7192796, 'recall': 0.77608037, 'specificity': 0.77608037, 'f1': 0.74396986, 'auroc': 0.92549264, 'binary_precision': 0.45443925, 'binary_recall': 0.5780089, 'binary_specificity': 0.9741518, 'binary_f1_score': 0.50882924}
confusion matrix:
       0    1
0  17600  467
1    284  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95294875, 'precision': 0.715383, 'recall': 0.76396215, 'specificity': 0.76396215, 'f1': 0.73679936, 'auroc': 0.9101801, 'binary_precision': 0.45031056, 'binary_recall': 0.5576923, 'binary_specificity': 0.97023207, 'binary_f1_score': 0.49828175}
confusion matrix:
      0    1
0  5769  177
1   115  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_13.png
early stop counter: 4
val acc:0.9599252939224243, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 13,now: 2024-07-06 23:41:10.178851,epoch time: 0:31:14.486983,used: 6:46:06.466838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98868597, 'precision': 0.9891406, 'recall': 0.98090845, 'specificity': 0.98090845, 'f1': 0.9849361, 'auroc': 0.99824774, 'binary_precision': 0.99004054, 'binary_recall': 0.9651179, 'binary_specificity': 0.99669904, 'binary_f1_score': 0.97742033}
confusion matrix:
       0      1
0  42272    140
1    503  13917
---- Validation: 
scalar performance:
{'acc': 0.9605656, 'precision': 0.72177076, 'recall': 0.76925975, 'specificity': 0.76925975, 'f1': 0.74290425, 'auroc': 0.9234208, 'binary_precision': 0.45995146, 'binary_recall': 0.56315005, 'binary_specificity': 0.97536945, 'binary_f1_score': 0.506346}
confusion matrix:
       0    1
0  17622  445
1    294  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.954399, 'precision': 0.7210645, 'recall': 0.7573631, 'specificity': 0.7573631, 'f1': 0.73761356, 'auroc': 0.9143917, 'binary_precision': 0.4622951, 'binary_recall': 0.5423077, 'binary_specificity': 0.9724184, 'binary_f1_score': 0.49911502}
confusion matrix:
      0    1
0  5782  164
1   119  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_14.png
early stop counter: 5
val acc:0.9605656266212463, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 14,now: 2024-07-07 00:11:54.574298,epoch time: 0:30:44.395447,used: 7:16:50.862285,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98914343, 'precision': 0.9901798, 'recall': 0.98109937, 'specificity': 0.98109937, 'f1': 0.9855324, 'auroc': 0.99857825, 'binary_precision': 0.9922254, 'binary_recall': 0.9647687, 'binary_specificity': 0.99743, 'binary_f1_score': 0.97830445}
confusion matrix:
       0      1
0  42304    109
1    508  13911
---- Validation: 
scalar performance:
{'acc': 0.95987195, 'precision': 0.71925545, 'recall': 0.7781985, 'specificity': 0.7781985, 'f1': 0.74474764, 'auroc': 0.9259759, 'binary_precision': 0.45422944, 'binary_recall': 0.58246654, 'binary_specificity': 0.97393036, 'binary_f1_score': 0.5104167}
confusion matrix:
       0    1
0  17596  471
1    281  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.7364515, 'recall': 0.78637743, 'specificity': 0.78637743, 'f1': 0.7586574, 'auroc': 0.9144829, 'binary_precision': 0.49056605, 'binary_recall': 0.6, 'binary_specificity': 0.9727548, 'binary_f1_score': 0.5397924}
confusion matrix:
      0    1
0  5784  162
1   104  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_15.png
early stop counter: 6
val acc:0.9598719477653503, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 15,now: 2024-07-07 00:42:43.315207,epoch time: 0:30:48.740909,used: 7:47:39.603194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98910826, 'precision': 0.99025106, 'recall': 0.98093843, 'specificity': 0.98093843, 'f1': 0.9854821, 'auroc': 0.99811727, 'binary_precision': 0.9925054, 'binary_recall': 0.9643526, 'binary_specificity': 0.9975243, 'binary_f1_score': 0.9782265}
confusion matrix:
       0      1
0  42308    105
1    514  13905
---- Validation: 
scalar performance:
{'acc': 0.9620064, 'precision': 0.729108, 'recall': 0.76428485, 'specificity': 0.76428485, 'f1': 0.74527645, 'auroc': 0.92481536, 'binary_precision': 0.475032, 'binary_recall': 0.551263, 'binary_specificity': 0.97730666, 'binary_f1_score': 0.5103164}
confusion matrix:
       0    1
0  17657  410
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.74283594, 'recall': 0.7650664, 'specificity': 0.7650664, 'f1': 0.75339186, 'auroc': 0.9127455, 'binary_precision': 0.50526315, 'binary_recall': 0.5538462, 'binary_specificity': 0.9762866, 'binary_f1_score': 0.52844036}
confusion matrix:
      0    1
0  5805  141
1   116  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_16.png
early stop counter: 7
val acc:0.9620063900947571, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 16,now: 2024-07-07 01:13:34.952006,epoch time: 0:30:51.636799,used: 8:18:31.239993,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9890203, 'precision': 0.9917611, 'recall': 0.9792774, 'specificity': 0.9792774, 'f1': 0.98531824, 'auroc': 0.99856544, 'binary_precision': 0.9971171, 'binary_recall': 0.95949787, 'binary_specificity': 0.9990569, 'binary_f1_score': 0.97794586}
confusion matrix:
       0      1
0  42373     40
1    584  13835
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7474998, 'recall': 0.7308142, 'specificity': 0.7308142, 'f1': 0.7388313, 'auroc': 0.9241427, 'binary_precision': 0.514377, 'binary_recall': 0.47845468, 'binary_specificity': 0.9831737, 'binary_f1_score': 0.49576598}
confusion matrix:
       0    1
0  17763  304
1    351  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7481322, 'recall': 0.70488435, 'specificity': 0.70488435, 'f1': 0.72416055, 'auroc': 0.9064256, 'binary_precision': 0.52112675, 'binary_recall': 0.42692307, 'binary_specificity': 0.9828456, 'binary_f1_score': 0.46934462}
confusion matrix:
      0    1
0  5844  102
1   149  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_17.png
early stop counter: 8
val acc:0.9650480151176453, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 17,now: 2024-07-07 01:44:33.483711,epoch time: 0:30:58.531705,used: 8:49:29.771698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98961854, 'precision': 0.99140453, 'recall': 0.9811659, 'specificity': 0.9811659, 'f1': 0.9861496, 'auroc': 0.99836445, 'binary_precision': 0.99491805, 'binary_recall': 0.9640058, 'binary_specificity': 0.998326, 'binary_f1_score': 0.97921807}
confusion matrix:
       0      1
0  42342     71
1    519  13900
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.7348342, 'recall': 0.75625515, 'specificity': 0.75625515, 'f1': 0.74501747, 'auroc': 0.9273122, 'binary_precision': 0.4871099, 'binary_recall': 0.53343236, 'binary_specificity': 0.9790779, 'binary_f1_score': 0.5092198}
confusion matrix:
       0    1
0  17689  378
1    314  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.7578486, 'recall': 0.7369039, 'specificity': 0.7369039, 'f1': 0.74687195, 'auroc': 0.91332537, 'binary_precision': 0.53781515, 'binary_recall': 0.4923077, 'binary_specificity': 0.98150015, 'binary_f1_score': 0.5140562}
confusion matrix:
      0    1
0  5836  110
1   132  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_18.png
early stop counter: 9
val acc:0.9630736112594604, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 18,now: 2024-07-07 02:15:29.376659,epoch time: 0:30:55.892948,used: 9:20:25.664646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98870355, 'precision': 0.9910393, 'recall': 0.97913384, 'specificity': 0.97913384, 'f1': 0.98490334, 'auroc': 0.9985249, 'binary_precision': 0.9956112, 'binary_recall': 0.95970595, 'binary_specificity': 0.99856174, 'binary_f1_score': 0.9773289}
confusion matrix:
       0      1
0  42352     61
1    581  13838
---- Validation: 
scalar performance:
{'acc': 0.9624867, 'precision': 0.73182905, 'recall': 0.7638186, 'specificity': 0.7638186, 'f1': 0.7466564, 'auroc': 0.925909, 'binary_precision': 0.48051947, 'binary_recall': 0.5497771, 'binary_specificity': 0.9778602, 'binary_f1_score': 0.5128205}
confusion matrix:
       0    1
0  17667  400
1    303  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.7579287, 'recall': 0.7350649, 'specificity': 0.7350649, 'f1': 0.74589396, 'auroc': 0.9141506, 'binary_precision': 0.5381356, 'binary_recall': 0.48846152, 'binary_specificity': 0.98166835, 'binary_f1_score': 0.51209676}
confusion matrix:
      0    1
0  5837  109
1   133  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_19.png
early stop counter: 10
val acc:0.9624866843223572, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 19,now: 2024-07-07 02:46:35.643307,epoch time: 0:31:06.266648,used: 9:51:31.931294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.989988, 'precision': 0.99155474, 'recall': 0.9819869, 'specificity': 0.9819869, 'f1': 0.98665226, 'auroc': 0.9984309, 'binary_precision': 0.9946432, 'binary_recall': 0.96574205, 'binary_specificity': 0.99823165, 'binary_f1_score': 0.9799796}
confusion matrix:
       0      1
0  42337     75
1    494  13926
---- Validation: 
scalar performance:
{'acc': 0.9618463, 'precision': 0.7265487, 'recall': 0.7456049, 'specificity': 0.7456049, 'f1': 0.7356417, 'auroc': 0.9244073, 'binary_precision': 0.47131148, 'binary_recall': 0.51263, 'binary_specificity': 0.97857976, 'binary_f1_score': 0.4911032}
confusion matrix:
       0    1
0  17680  387
1    328  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.75913095, 'recall': 0.7129971, 'specificity': 0.7129971, 'f1': 0.73351, 'auroc': 0.90785336, 'binary_precision': 0.5424528, 'binary_recall': 0.44230768, 'binary_specificity': 0.9836865, 'binary_f1_score': 0.48728812}
confusion matrix:
      0    1
0  5849   97
1   145  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_20.png
early stop counter: 11
val acc:0.9618462920188904, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 20,now: 2024-07-07 03:17:32.712401,epoch time: 0:30:57.069094,used: 10:22:29.000388,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99123734, 'precision': 0.9918938, 'recall': 0.9849293, 'specificity': 0.9849293, 'f1': 0.9883486, 'auroc': 0.998615, 'binary_precision': 0.9931982, 'binary_recall': 0.9721221, 'binary_specificity': 0.9977365, 'binary_f1_score': 0.9825471}
confusion matrix:
       0      1
0  42316     96
1    402  14018
---- Validation: 
scalar performance:
{'acc': 0.9626467, 'precision': 0.72994256, 'recall': 0.7259925, 'specificity': 0.7259925, 'f1': 0.72794825, 'auroc': 0.9235192, 'binary_precision': 0.4795764, 'binary_recall': 0.47102526, 'binary_specificity': 0.9809598, 'binary_f1_score': 0.47526237}
confusion matrix:
       0    1
0  17723  344
1    356  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.750563, 'recall': 0.70689154, 'specificity': 0.70689154, 'f1': 0.7263585, 'auroc': 0.9051508, 'binary_precision': 0.52582157, 'binary_recall': 0.43076923, 'binary_specificity': 0.9830138, 'binary_f1_score': 0.47357294}
confusion matrix:
      0    1
0  5845  101
1   148  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_21.png
early stop counter: 12
val acc:0.9626467227935791, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 21,now: 2024-07-07 03:48:31.496820,epoch time: 0:30:58.784419,used: 10:53:27.784807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9911318, 'precision': 0.9910307, 'recall': 0.9854984, 'specificity': 0.9854984, 'f1': 0.98822474, 'auroc': 0.9987746, 'binary_precision': 0.99082893, 'binary_recall': 0.974062, 'binary_specificity': 0.9969349, 'binary_f1_score': 0.98237395}
confusion matrix:
       0      1
0  42283    130
1    374  14045
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.73670214, 'recall': 0.7343309, 'specificity': 0.7343309, 'f1': 0.7355098, 'auroc': 0.9246948, 'binary_precision': 0.4924925, 'binary_recall': 0.48736998, 'binary_specificity': 0.98129183, 'binary_f1_score': 0.48991784}
confusion matrix:
       0    1
0  17729  338
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.76938426, 'recall': 0.69511175, 'specificity': 0.69511175, 'f1': 0.7255647, 'auroc': 0.9126039, 'binary_precision': 0.5645161, 'binary_recall': 0.40384614, 'binary_specificity': 0.9863774, 'binary_f1_score': 0.47085202}
confusion matrix:
      0    1
0  5865   81
1   155  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_22.png
early stop counter: 13
val acc:0.9635539054870605, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 22,now: 2024-07-07 04:19:18.507318,epoch time: 0:30:47.010498,used: 11:24:14.795305,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9910438, 'precision': 0.99209356, 'recall': 0.98422647, 'specificity': 0.98422647, 'f1': 0.98807985, 'auroc': 0.9986351, 'binary_precision': 0.99417365, 'binary_recall': 0.97038627, 'binary_specificity': 0.9980666, 'binary_f1_score': 0.98213595}
confusion matrix:
       0      1
0  42331     82
1    427  13992
---- Validation: 
scalar performance:
{'acc': 0.96109927, 'precision': 0.7214938, 'recall': 0.7394953, 'specificity': 0.7394953, 'f1': 0.73009616, 'auroc': 0.92552507, 'binary_precision': 0.46164384, 'binary_recall': 0.5007429, 'binary_specificity': 0.97824764, 'binary_f1_score': 0.48039916}
confusion matrix:
       0    1
0  17674  393
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.77399635, 'recall': 0.7139221, 'specificity': 0.7139221, 'f1': 0.73979324, 'auroc': 0.9129343, 'binary_precision': 0.5721393, 'binary_recall': 0.44230768, 'binary_specificity': 0.9855365, 'binary_f1_score': 0.49891543}
confusion matrix:
      0    1
0  5860   86
1   145  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_23.png
early stop counter: 14
val acc:0.9610992670059204, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 23,now: 2024-07-07 04:50:19.136286,epoch time: 0:31:00.628968,used: 11:55:15.424273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99158925, 'precision': 0.9925771, 'recall': 0.985187, 'specificity': 0.985187, 'f1': 0.9888114, 'auroc': 0.9986247, 'binary_precision': 0.99453706, 'binary_recall': 0.9721895, 'binary_specificity': 0.9981845, 'binary_f1_score': 0.9832363}
confusion matrix:
       0      1
0  42336     77
1    401  14018
---- Validation: 
scalar performance:
{'acc': 0.9629136, 'precision': 0.7314043, 'recall': 0.721124, 'specificity': 0.721124, 'f1': 0.72613275, 'auroc': 0.92391586, 'binary_precision': 0.48286605, 'binary_recall': 0.46062407, 'binary_specificity': 0.98162395, 'binary_f1_score': 0.47148287}
confusion matrix:
       0    1
0  17735  332
1    363  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.74310136, 'recall': 0.68431914, 'specificity': 0.68431914, 'f1': 0.70911705, 'auroc': 0.9016551, 'binary_precision': 0.51282054, 'binary_recall': 0.3846154, 'binary_specificity': 0.98402286, 'binary_f1_score': 0.43956047}
confusion matrix:
      0    1
0  5851   95
1   160  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_24.png
early stop counter: 15
val acc:0.9629135727882385, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 24,now: 2024-07-07 05:21:08.166312,epoch time: 0:30:49.030026,used: 12:26:04.454299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9905687, 'precision': 0.99261343, 'recall': 0.98248684, 'specificity': 0.98248684, 'f1': 0.9874178, 'auroc': 0.9987867, 'binary_precision': 0.99663687, 'binary_recall': 0.96608174, 'binary_specificity': 0.9988919, 'binary_f1_score': 0.9811215}
confusion matrix:
       0      1
0  42368     47
1    489  13928
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.7363635, 'recall': 0.7207685, 'specificity': 0.7207685, 'f1': 0.7282672, 'auroc': 0.9243748, 'binary_precision': 0.49282297, 'binary_recall': 0.45913818, 'binary_specificity': 0.98239887, 'binary_f1_score': 0.47538462}
confusion matrix:
       0    1
0  17749  318
1    364  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.78170305, 'recall': 0.69018346, 'specificity': 0.69018346, 'f1': 0.72600746, 'auroc': 0.9110244, 'binary_precision': 0.5895954, 'binary_recall': 0.3923077, 'binary_specificity': 0.9880592, 'binary_f1_score': 0.47113165}
confusion matrix:
      0    1
0  5875   71
1   158  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_25.png
early stop counter: 16
val acc:0.9636072516441345, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 25,now: 2024-07-07 05:51:56.907468,epoch time: 0:30:48.741156,used: 12:56:53.195455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99151886, 'precision': 0.9917096, 'recall': 0.9858476, 'specificity': 0.9858476, 'f1': 0.988734, 'auroc': 0.99889636, 'binary_precision': 0.9920898, 'binary_recall': 0.97433585, 'binary_specificity': 0.9973594, 'binary_f1_score': 0.98313266}
confusion matrix:
       0      1
0  42303    112
1    370  14047
---- Validation: 
scalar performance:
{'acc': 0.9607791, 'precision': 0.72318506, 'recall': 0.7722315, 'specificity': 0.7722315, 'f1': 0.7449489, 'auroc': 0.92565554, 'binary_precision': 0.4625604, 'binary_recall': 0.5690936, 'binary_specificity': 0.97536945, 'binary_f1_score': 0.51032645}
confusion matrix:
       0    1
0  17622  445
1    290  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.77780175, 'recall': 0.7345714, 'specificity': 0.7345714, 'f1': 0.7541295, 'auroc': 0.908822, 'binary_precision': 0.57798165, 'binary_recall': 0.4846154, 'binary_specificity': 0.9845274, 'binary_f1_score': 0.52719665}
confusion matrix:
      0    1
0  5854   92
1   134  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_26.png
early stop counter: 17
val acc:0.960779070854187, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 26,now: 2024-07-07 06:22:51.071980,epoch time: 0:30:54.164512,used: 13:27:47.359967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99201155, 'precision': 0.99264884, 'recall': 0.9862261, 'specificity': 0.9862261, 'f1': 0.989384, 'auroc': 0.99891293, 'binary_precision': 0.9939171, 'binary_recall': 0.9744799, 'binary_specificity': 0.99797225, 'binary_f1_score': 0.9841025}
confusion matrix:
       0      1
0  42326     86
1    368  14052
---- Validation: 
scalar performance:
{'acc': 0.9618997, 'precision': 0.72819656, 'recall': 0.76065314, 'specificity': 0.76065314, 'f1': 0.7432047, 'auroc': 0.9248698, 'binary_precision': 0.47347996, 'binary_recall': 0.54383355, 'binary_specificity': 0.9774727, 'binary_f1_score': 0.5062241}
confusion matrix:
       0    1
0  17660  407
1    307  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.77981293, 'recall': 0.71425843, 'specificity': 0.71425843, 'f1': 0.7421472, 'auroc': 0.9045889, 'binary_precision': 0.5837563, 'binary_recall': 0.44230768, 'binary_specificity': 0.9862092, 'binary_f1_score': 0.50328225}
confusion matrix:
      0    1
0  5864   82
1   145  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_27.png
early stop counter: 18
val acc:0.9618996977806091, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 27,now: 2024-07-07 06:53:48.669322,epoch time: 0:30:57.597342,used: 13:58:44.957309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99208194, 'precision': 0.9938327, 'recall': 0.9852643, 'specificity': 0.9852643, 'f1': 0.9894539, 'auroc': 0.9987992, 'binary_precision': 0.99729425, 'binary_recall': 0.9714246, 'binary_specificity': 0.9991041, 'binary_f1_score': 0.98418945}
confusion matrix:
       0      1
0  42376     38
1    412  14006
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.7435961, 'recall': 0.68839204, 'specificity': 0.68839204, 'f1': 0.7120598, 'auroc': 0.9245106, 'binary_precision': 0.5096899, 'binary_recall': 0.3907875, 'binary_specificity': 0.98599654, 'binary_f1_score': 0.44238856}
confusion matrix:
       0    1
0  17814  253
1    410  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.8031448, 'recall': 0.644377, 'specificity': 0.644377, 'f1': 0.6926658, 'auroc': 0.90786535, 'binary_precision': 0.6363636, 'binary_recall': 0.29615384, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.40419945}
confusion matrix:
      0   1
0  5902  44
1   183  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_28.png
early stop counter: 19
val acc:0.9646211266517639, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 28,now: 2024-07-07 07:24:42.260239,epoch time: 0:30:53.590917,used: 14:29:38.548226,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99309564, 'recall': 0.9862524, 'specificity': 0.9862524, 'f1': 0.98961353, 'auroc': 0.99889135, 'binary_precision': 0.9949008, 'binary_recall': 0.9742025, 'binary_specificity': 0.99830234, 'binary_f1_score': 0.9844429}
confusion matrix:
       0      1
0  42340     72
1    372  14048
---- Validation: 
scalar performance:
{'acc': 0.9629136, 'precision': 0.73030585, 'recall': 0.70681864, 'specificity': 0.70681864, 'f1': 0.71785283, 'auroc': 0.9244415, 'binary_precision': 0.48172757, 'binary_recall': 0.4309064, 'binary_specificity': 0.9827309, 'binary_f1_score': 0.45490193}
confusion matrix:
       0    1
0  17755  312
1    383  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.79769254, 'recall': 0.64980984, 'specificity': 0.64980984, 'f1': 0.6967045, 'auroc': 0.9088942, 'binary_precision': 0.625, 'binary_recall': 0.30769232, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.41237116}
confusion matrix:
      0   1
0  5898  48
1   180  80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_29.png
early stop counter: 20
val acc:0.9629135727882385, best validation acc: 0.9654215574264526, corresponding to test acc:                         0.9626168012619019 / 0.967934250831604
after epoch: 29,now: 2024-07-07 07:55:44.887191,epoch time: 0:31:02.626952,used: 15:00:41.175178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_55_03_seed_1_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 29 with time: 15:00:41.175178 at 2024-07-07 07:55:44.887191
persisted model performance metric: 

scalar performance:
{'acc': 0.9626168, 'precision': 0.77045834, 'recall': 0.7303889, 'specificity': 0.7303889, 'f1': 0.74861157, 'auroc': 0.9225937, 'binary_precision': 0.56363636, 'binary_recall': 0.47692308, 'binary_specificity': 0.9838547, 'binary_f1_score': 0.5166667}
confusion matrix:
      0    1
0  5850   96
1   136  124
oracle model performance metric: 

scalar performance:
{'acc': 0.96793425, 'precision': 0.8131697, 'recall': 0.7515537, 'specificity': 0.7515537, 'f1': 0.778608, 'auroc': 0.9225284, 'binary_precision': 0.647343, 'binary_recall': 0.5153846, 'binary_specificity': 0.9877228, 'binary_f1_score': 0.5738758}
confusion matrix:
      0    1
0  5873   73
1   126  134
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   4047 MiB |   5855 TiB |   5855 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   5788 TiB |   5788 TiB |
|       from small pool |  17479 KiB |     37 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   4047 MiB |   5855 TiB |   5855 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   5788 TiB |   5788 TiB |
|       from small pool |  17479 KiB |     37 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   4045 MiB |   5855 TiB |   5855 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   5788 TiB |   5788 TiB |
|       from small pool |  16480 KiB |     36 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4420 MiB |   4438 MiB |   8608 MiB |   4188 MiB |
|       from large pool |   4382 MiB |   4396 MiB |   8552 MiB |   4170 MiB |
|       from small pool |     38 MiB |     42 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40878 KiB | 398560 KiB |   3091 TiB |   3091 TiB |
|       from large pool |  31733 KiB | 397444 KiB |   3024 TiB |   3024 TiB |
|       from small pool |   9145 KiB |  18291 KiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7605    |     792 M  |     792 M  |
|       from large pool |      79    |     423    |     542 M  |     542 M  |
|       from small pool |    2875    |    7525    |     249 M  |     249 M  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7605    |     792 M  |     792 M  |
|       from large pool |      79    |     423    |     542 M  |     542 M  |
|       from small pool |    2875    |    7525    |     249 M  |     249 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     200    |     203    |     380    |     180    |
|       from large pool |     181    |     182    |     352    |     171    |
|       from small pool |      19    |      21    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3586    |  550721 K  |  550721 K  |
|       from large pool |      11    |     186    |  419372 K  |  419372 K  |
|       from small pool |      23    |    3576    |  131348 K  |  131348 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   5855 TiB |   5855 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   5788 TiB |   5788 TiB |
|       from small pool |      0 KiB |     37 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   5855 TiB |   5855 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   5788 TiB |   5788 TiB |
|       from small pool |      0 KiB |     37 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   5855 TiB |   5855 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   5788 TiB |   5788 TiB |
|       from small pool |      0 KiB |     36 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   4438 MiB |   8608 MiB |   8376 MiB |
|       from large pool | 210944 KiB |   4396 MiB |   8552 MiB |   8346 MiB |
|       from small pool |  26624 KiB |     42 MiB |     56 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398560 KiB |   3091 TiB |   3091 TiB |
|       from large pool |  30464 KiB | 397444 KiB |   3024 TiB |   3024 TiB |
|       from small pool |      0 KiB |  20351 KiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |     792 M  |     792 M  |
|       from large pool |       2    |     423    |     542 M  |     542 M  |
|       from small pool |       0    |    7525    |     249 M  |     249 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |     792 M  |     792 M  |
|       from large pool |       2    |     423    |     542 M  |     542 M  |
|       from small pool |       0    |    7525    |     249 M  |     249 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     203    |     380    |     357    |
|       from large pool |      10    |     182    |     352    |     342    |
|       from small pool |      13    |      21    |      28    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3586    |  550723 K  |  550723 K  |
|       from large pool |       3    |     186    |  419372 K  |  419372 K  |
|       from small pool |       0    |    3576    |  131350 K  |  131350 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   5855 TiB |   5855 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   5788 TiB |   5788 TiB |
|       from small pool |      0 KiB |     37 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   5855 TiB |   5855 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   5788 TiB |   5788 TiB |
|       from small pool |      0 KiB |     37 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   5855 TiB |   5855 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   5788 TiB |   5788 TiB |
|       from small pool |      0 KiB |     36 MiB |     66 TiB |     66 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   4438 MiB |   8608 MiB |   8376 MiB |
|       from large pool | 210944 KiB |   4396 MiB |   8552 MiB |   8346 MiB |
|       from small pool |  26624 KiB |     42 MiB |     56 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398560 KiB |   3091 TiB |   3091 TiB |
|       from large pool |  30464 KiB | 397444 KiB |   3024 TiB |   3024 TiB |
|       from small pool |      0 KiB |  20351 KiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |     792 M  |     792 M  |
|       from large pool |       2    |     423    |     542 M  |     542 M  |
|       from small pool |       0    |    7525    |     249 M  |     249 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |     792 M  |     792 M  |
|       from large pool |       2    |     423    |     542 M  |     542 M  |
|       from small pool |       0    |    7525    |     249 M  |     249 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     203    |     380    |     357    |
|       from large pool |      10    |     182    |     352    |     342    |
|       from small pool |      13    |      21    |      28    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3586    |  550723 K  |  550723 K  |
|       from large pool |       3    |     186    |  419372 K  |  419372 K  |
|       from small pool |       0    |    3576    |  131350 K  |  131350 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432

 Experiment start at: 2024-07-07 08:01:35.729337
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96333563, 'precision': 0.9684547, 'recall': 0.9367044, 'specificity': 0.9367044, 'f1': 0.95114374, 'auroc': 0.9869283, 'binary_precision': 0.97818905, 'binary_recall': 0.8804283, 'binary_specificity': 0.99298054, 'binary_f1_score': 0.9267377}
confusion matrix:
       0      1
0  42014    297
1   1809  13320
---- Validation: 
scalar performance:
{'acc': 0.9632984, 'precision': 0.67252326, 'recall': 0.5979871, 'specificity': 0.5979871, 'f1': 0.62370956, 'auroc': 0.84950125, 'binary_precision': 0.37091988, 'binary_recall': 0.2076412, 'binary_specificity': 0.98833305, 'binary_f1_score': 0.2662407}
confusion matrix:
       0    1
0  17959  212
1    477  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.956243, 'precision': 0.677029, 'recall': 0.60051787, 'specificity': 0.60051787, 'f1': 0.626651, 'auroc': 0.8524112, 'binary_precision': 0.38518518, 'binary_recall': 0.21487603, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.27586207}
confusion matrix:
      0   1
0  5914  83
1   190  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-07 08:33:20.066539,epoch time: 0:31:44.337202,used: 0:31:44.337202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9729631, 'precision': 0.97744834, 'recall': 0.9527725, 'specificity': 0.9527725, 'f1': 0.96425664, 'auroc': 0.9922873, 'binary_precision': 0.9861768, 'binary_recall': 0.9101064, 'binary_specificity': 0.9954385, 'binary_f1_score': 0.9466159}
confusion matrix:
       0      1
0  42118    193
1   1360  13769
---- Validation: 
scalar performance:
{'acc': 0.9640441, 'precision': 0.68204004, 'recall': 0.60158455, 'specificity': 0.60158455, 'f1': 0.6290456, 'auroc': 0.8763498, 'binary_precision': 0.3897281, 'binary_recall': 0.21428572, 'binary_specificity': 0.9888834, 'binary_f1_score': 0.27652735}
confusion matrix:
       0    1
0  17969  202
1    473  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9580061, 'precision': 0.6968928, 'recall': 0.60936594, 'specificity': 0.60936594, 'f1': 0.6389098, 'auroc': 0.882998, 'binary_precision': 0.42424244, 'binary_recall': 0.23140496, 'binary_specificity': 0.987327, 'binary_f1_score': 0.29946527}
confusion matrix:
      0   1
0  5921  76
1   186  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-07 09:04:35.993429,epoch time: 0:31:15.926890,used: 1:03:00.264092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.978743, 'precision': 0.9799975, 'recall': 0.9649995, 'specificity': 0.9649995, 'f1': 0.9721812, 'auroc': 0.9946935, 'binary_precision': 0.9825158, 'binary_recall': 0.93595505, 'binary_specificity': 0.99404395, 'binary_f1_score': 0.95867044}
confusion matrix:
       0      1
0  42058    252
1    969  14161
---- Validation: 
scalar performance:
{'acc': 0.96052843, 'precision': 0.68326205, 'recall': 0.6864977, 'specificity': 0.6864977, 'f1': 0.68486387, 'auroc': 0.89400315, 'binary_precision': 0.38662317, 'binary_recall': 0.3936877, 'binary_specificity': 0.9793077, 'binary_f1_score': 0.39012346}
confusion matrix:
       0    1
0  17795  376
1    365  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.7316825, 'recall': 0.7076875, 'specificity': 0.7076875, 'f1': 0.7189415, 'auroc': 0.90016353, 'binary_precision': 0.4861111, 'binary_recall': 0.4338843, 'binary_specificity': 0.98149073, 'binary_f1_score': 0.45851526}
confusion matrix:
      0    1
0  5886  111
1   137  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_3.png
new oracle model saved
early stop counter: 1
val acc:0.9605284333229065, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9602500200271606
after epoch: 3,now: 2024-07-07 09:35:57.975059,epoch time: 0:31:21.981630,used: 1:34:22.245722,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97912604, 'precision': 0.9813211, 'recall': 0.9647287, 'specificity': 0.9647287, 'f1': 0.9726388, 'auroc': 0.99505633, 'binary_precision': 0.9857053, 'binary_recall': 0.9343027, 'binary_specificity': 0.9951548, 'binary_f1_score': 0.95931596}
confusion matrix:
       0      1
0  42105    205
1    994  14136
---- Validation: 
scalar performance:
{'acc': 0.96068823, 'precision': 0.68001056, 'recall': 0.67132235, 'specificity': 0.67132235, 'f1': 0.6755448, 'auroc': 0.894147, 'binary_precision': 0.3811189, 'binary_recall': 0.36212623, 'binary_specificity': 0.9805184, 'binary_f1_score': 0.3713799}
confusion matrix:
       0    1
0  17817  354
1    384  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95928836, 'precision': 0.7236386, 'recall': 0.6933081, 'specificity': 0.6933081, 'f1': 0.70721906, 'auroc': 0.90184903, 'binary_precision': 0.47115386, 'binary_recall': 0.40495867, 'binary_specificity': 0.9816575, 'binary_f1_score': 0.43555555}
confusion matrix:
      0    1
0  5887  110
1   144   98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_4.png
early stop counter: 2
val acc:0.9606882333755493, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9602500200271606
after epoch: 4,now: 2024-07-07 10:07:12.120760,epoch time: 0:31:14.145701,used: 2:05:36.391423,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98229456, 'precision': 0.9803624, 'recall': 0.9738215, 'specificity': 0.9738215, 'f1': 0.977031, 'auroc': 0.99595404, 'binary_precision': 0.9763721, 'binary_recall': 0.9559154, 'binary_specificity': 0.9917277, 'binary_f1_score': 0.96603554}
confusion matrix:
       0      1
0  41960    350
1    667  14463
---- Validation: 
scalar performance:
{'acc': 0.957865, 'precision': 0.67778766, 'recall': 0.7188499, 'specificity': 0.7188499, 'f1': 0.6958935, 'auroc': 0.8998044, 'binary_precision': 0.37349397, 'binary_recall': 0.46345514, 'binary_specificity': 0.97424465, 'binary_f1_score': 0.41363972}
confusion matrix:
       0    1
0  17703  468
1    323  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9556019, 'precision': 0.70826393, 'recall': 0.7369935, 'specificity': 0.7369935, 'f1': 0.7215594, 'auroc': 0.9015666, 'binary_precision': 0.4368231, 'binary_recall': 0.5, 'binary_specificity': 0.973987, 'binary_f1_score': 0.4662813}
confusion matrix:
      0    1
0  5841  156
1   121  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_5.png
early stop counter: 3
val acc:0.9578649997711182, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9602500200271606
after epoch: 5,now: 2024-07-07 10:38:16.622163,epoch time: 0:31:04.501403,used: 2:36:40.892826,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.982782, 'precision': 0.98509574, 'recall': 0.9704567, 'specificity': 0.9704567, 'f1': 0.97747797, 'auroc': 0.9963932, 'binary_precision': 0.9897479, 'binary_recall': 0.9444114, 'binary_specificity': 0.9965021, 'binary_f1_score': 0.96654826}
confusion matrix:
       0      1
0  42163    148
1    841  14288
---- Validation: 
scalar performance:
{'acc': 0.95951635, 'precision': 0.6832701, 'recall': 0.7084603, 'specificity': 0.7084603, 'f1': 0.69494534, 'auroc': 0.9002669, 'binary_precision': 0.38517442, 'binary_recall': 0.44019935, 'binary_specificity': 0.97672117, 'binary_f1_score': 0.41085273}
confusion matrix:
       0    1
0  17748  423
1    337  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9580061, 'precision': 0.71659124, 'recall': 0.7045375, 'specificity': 0.7045375, 'f1': 0.7103672, 'auroc': 0.9037694, 'binary_precision': 0.45614034, 'binary_recall': 0.42975205, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.4425532}
confusion matrix:
      0    1
0  5873  124
1   138  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_6.png
early stop counter: 4
val acc:0.9595163464546204, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9602500200271606
after epoch: 6,now: 2024-07-07 11:09:24.868144,epoch time: 0:31:08.245981,used: 3:07:49.138807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98353064, 'precision': 0.98633087, 'recall': 0.9712002, 'specificity': 0.9712002, 'f1': 0.97844815, 'auroc': 0.99682426, 'binary_precision': 0.9919534, 'binary_recall': 0.9451421, 'binary_specificity': 0.9972583, 'binary_f1_score': 0.9679822}
confusion matrix:
       0      1
0  42194    116
1    830  14300
---- Validation: 
scalar performance:
{'acc': 0.95994246, 'precision': 0.68340385, 'recall': 0.69984686, 'specificity': 0.69984686, 'f1': 0.6912252, 'auroc': 0.90034795, 'binary_precision': 0.38601825, 'binary_recall': 0.42192692, 'binary_specificity': 0.97776675, 'binary_f1_score': 0.40317464}
confusion matrix:
       0    1
0  17767  404
1    348  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.7290457, 'recall': 0.67398095, 'specificity': 0.67398095, 'f1': 0.69726014, 'auroc': 0.90039575, 'binary_precision': 0.48351648, 'binary_recall': 0.36363637, 'binary_specificity': 0.98432547, 'binary_f1_score': 0.41509435}
confusion matrix:
      0   1
0  5903  94
1   154  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_7.png
early stop counter: 5
val acc:0.9599424600601196, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9602500200271606
after epoch: 7,now: 2024-07-07 11:40:41.553998,epoch time: 0:31:16.685854,used: 3:39:05.824661,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98501045, 'precision': 0.9861372, 'recall': 0.9751344, 'specificity': 0.9751344, 'f1': 0.9804669, 'auroc': 0.9972453, 'binary_precision': 0.9884302, 'binary_recall': 0.95426303, 'binary_specificity': 0.99600565, 'binary_f1_score': 0.97104615}
confusion matrix:
       0      1
0  42141    169
1    692  14438
---- Validation: 
scalar performance:
{'acc': 0.9529111, 'precision': 0.6640699, 'recall': 0.7427915, 'specificity': 0.7427915, 'f1': 0.69463176, 'auroc': 0.9061669, 'binary_precision': 0.34437087, 'binary_recall': 0.5182724, 'binary_specificity': 0.96731055, 'binary_f1_score': 0.41379312}
confusion matrix:
       0    1
0  17577  594
1    290  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9541593, 'precision': 0.69883317, 'recall': 0.72236395, 'specificity': 0.72236395, 'f1': 0.7098374, 'auroc': 0.9026427, 'binary_precision': 0.41911766, 'binary_recall': 0.47107437, 'binary_specificity': 0.9736535, 'binary_f1_score': 0.44357976}
confusion matrix:
      0    1
0  5839  158
1   128  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_8.png
early stop counter: 6
val acc:0.9529110789299011, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9602500200271606
after epoch: 8,now: 2024-07-07 12:12:05.405747,epoch time: 0:31:23.851749,used: 4:10:29.676410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9861769, 'precision': 0.9874416, 'recall': 0.9768603, 'specificity': 0.9768603, 'f1': 0.9819952, 'auroc': 0.9976164, 'binary_precision': 0.99001914, 'binary_recall': 0.9571712, 'binary_specificity': 0.9965493, 'binary_f1_score': 0.97331816}
confusion matrix:
       0      1
0  42164    146
1    648  14482
---- Validation: 
scalar performance:
{'acc': 0.9500346, 'precision': 0.65519166, 'recall': 0.7445178, 'specificity': 0.7445178, 'f1': 0.6882374, 'auroc': 0.9039812, 'binary_precision': 0.3264463, 'binary_recall': 0.52491695, 'binary_specificity': 0.96411866, 'binary_f1_score': 0.4025478}
confusion matrix:
       0    1
0  17519  652
1    286  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9544799, 'precision': 0.7021795, 'recall': 0.7324444, 'specificity': 0.7324444, 'f1': 0.71609247, 'auroc': 0.8971636, 'binary_precision': 0.425, 'binary_recall': 0.49173555, 'binary_specificity': 0.97315323, 'binary_f1_score': 0.45593873}
confusion matrix:
      0    1
0  5836  161
1   123  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_9.png
early stop counter: 7
val acc:0.9500346183776855, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9602500200271606
after epoch: 9,now: 2024-07-07 12:43:20.060675,epoch time: 0:31:14.654928,used: 4:41:44.331338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.986734, 'precision': 0.98857725, 'recall': 0.97719455, 'specificity': 0.97719455, 'f1': 0.9827064, 'auroc': 0.9976491, 'binary_precision': 0.99232405, 'binary_recall': 0.95703614, 'binary_specificity': 0.99735296, 'binary_f1_score': 0.9743607}
confusion matrix:
       0      1
0  42199    112
1    650  14479
---- Validation: 
scalar performance:
{'acc': 0.95466894, 'precision': 0.6676513, 'recall': 0.7316538, 'specificity': 0.7316538, 'f1': 0.69374996, 'auroc': 0.90692246, 'binary_precision': 0.35231316, 'binary_recall': 0.49335548, 'binary_specificity': 0.9699521, 'binary_f1_score': 0.41107264}
confusion matrix:
       0    1
0  17625  546
1    305  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95512104, 'precision': 0.6978351, 'recall': 0.6931231, 'specificity': 0.6931231, 'f1': 0.6954463, 'auroc': 0.8985669, 'binary_precision': 0.41949153, 'binary_recall': 0.4090909, 'binary_specificity': 0.97715527, 'binary_f1_score': 0.41422597}
confusion matrix:
      0    1
0  5860  137
1   143   99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_10.png
early stop counter: 8
val acc:0.9546689391136169, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9602500200271606
after epoch: 10,now: 2024-07-07 13:14:35.729036,epoch time: 0:31:15.668361,used: 5:12:59.999699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98776114, 'precision': 0.98960656, 'recall': 0.97882724, 'specificity': 0.97882724, 'f1': 0.98405623, 'auroc': 0.9978831, 'binary_precision': 0.9933657, 'binary_recall': 0.9599471, 'binary_specificity': 0.9977074, 'binary_f1_score': 0.9763705}
confusion matrix:
       0      1
0  42213     97
1    606  14524
---- Validation: 
scalar performance:
{'acc': 0.95498854, 'precision': 0.66624045, 'recall': 0.7213793, 'specificity': 0.7213793, 'f1': 0.68929785, 'auroc': 0.9045869, 'binary_precision': 0.35018495, 'binary_recall': 0.4717608, 'binary_specificity': 0.97099775, 'binary_f1_score': 0.4019816}
confusion matrix:
       0    1
0  17644  527
1    318  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9567238, 'precision': 0.70208395, 'recall': 0.6681812, 'specificity': 0.6681812, 'f1': 0.6833538, 'auroc': 0.8922614, 'binary_precision': 0.43, 'binary_recall': 0.3553719, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.38914028}
confusion matrix:
      0    1
0  5883  114
1   156   86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_11.png
early stop counter: 9
val acc:0.9549885392189026, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9602500200271606
after epoch: 11,now: 2024-07-07 13:45:42.787008,epoch time: 0:31:07.057972,used: 5:44:07.057671,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98809195, 'precision': 0.98909795, 'recall': 0.9801545, 'specificity': 0.9801545, 'f1': 0.9845152, 'auroc': 0.9980614, 'binary_precision': 0.9911595, 'binary_recall': 0.9633816, 'binary_specificity': 0.9969275, 'binary_f1_score': 0.97707313}
confusion matrix:
       0      1
0  42181    130
1    554  14575
---- Validation: 
scalar performance:
{'acc': 0.9575454, 'precision': 0.68009853, 'recall': 0.7347458, 'specificity': 0.7347458, 'f1': 0.7033137, 'auroc': 0.90884614, 'binary_precision': 0.37704918, 'binary_recall': 0.49667773, 'binary_specificity': 0.97281384, 'binary_f1_score': 0.4286738}
confusion matrix:
       0    1
0  17677  494
1    303  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.7446083, 'recall': 0.6848118, 'specificity': 0.6848118, 'f1': 0.71002823, 'auroc': 0.8995793, 'binary_precision': 0.5138122, 'binary_recall': 0.38429752, 'binary_specificity': 0.985326, 'binary_f1_score': 0.43971634}
confusion matrix:
      0   1
0  5909  88
1   149  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_12.png
new oracle model saved
early stop counter: 10
val acc:0.9575453996658325, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9620131254196167
after epoch: 12,now: 2024-07-07 14:17:01.684171,epoch time: 0:31:18.897163,used: 6:15:25.954834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9873085, 'precision': 0.98909956, 'recall': 0.97815776, 'specificity': 0.97815776, 'f1': 0.9834629, 'auroc': 0.9980893, 'binary_precision': 0.9927457, 'binary_recall': 0.9588208, 'binary_specificity': 0.99749476, 'binary_f1_score': 0.9754884}
confusion matrix:
       0      1
0  42205    106
1    623  14506
---- Validation: 
scalar performance:
{'acc': 0.9552016, 'precision': 0.66957116, 'recall': 0.73112595, 'specificity': 0.73112595, 'f1': 0.6949157, 'auroc': 0.90434474, 'binary_precision': 0.35619736, 'binary_recall': 0.49169436, 'binary_specificity': 0.9705575, 'binary_f1_score': 0.41311935}
confusion matrix:
       0    1
0  17636  535
1    306  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95832664, 'precision': 0.71588945, 'recall': 0.6848769, 'specificity': 0.6848769, 'f1': 0.69901514, 'auroc': 0.8927797, 'binary_precision': 0.4563107, 'binary_recall': 0.38842976, 'binary_specificity': 0.981324, 'binary_f1_score': 0.41964287}
confusion matrix:
      0    1
0  5885  112
1   148   94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_13.png
early stop counter: 11
val acc:0.9552016258239746, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9620131254196167
after epoch: 13,now: 2024-07-07 14:48:22.859633,epoch time: 0:31:21.175462,used: 6:46:47.130296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98795265, 'precision': 0.989624, 'recall': 0.9792969, 'specificity': 0.9792969, 'f1': 0.9843129, 'auroc': 0.99816287, 'binary_precision': 0.99303377, 'binary_recall': 0.9610046, 'binary_specificity': 0.99758923, 'binary_f1_score': 0.9767567}
confusion matrix:
       0      1
0  42208    102
1    590  14540
---- Validation: 
scalar performance:
{'acc': 0.9586108, 'precision': 0.68618053, 'recall': 0.74091744, 'specificity': 0.74091744, 'f1': 0.7095576, 'auroc': 0.9110542, 'binary_precision': 0.3888183, 'binary_recall': 0.50830567, 'binary_specificity': 0.9735293, 'binary_f1_score': 0.44060478}
confusion matrix:
       0    1
0  17690  481
1    296  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.7759677, 'recall': 0.68044764, 'specificity': 0.68044764, 'f1': 0.7171075, 'auroc': 0.90301585, 'binary_precision': 0.5769231, 'binary_recall': 0.37190083, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.4522613}
confusion matrix:
      0   1
0  5931  66
1   152  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_14.png
new oracle model saved
early stop counter: 12
val acc:0.9586107730865479, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9650585055351257
after epoch: 14,now: 2024-07-07 15:19:36.058321,epoch time: 0:31:13.198688,used: 7:18:00.328984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98908424, 'precision': 0.9896869, 'recall': 0.98212326, 'specificity': 0.98212326, 'f1': 0.98582566, 'auroc': 0.9981061, 'binary_precision': 0.9909276, 'binary_recall': 0.9674136, 'binary_specificity': 0.99683297, 'binary_f1_score': 0.9790295}
confusion matrix:
       0      1
0  42177    134
1    493  14636
---- Validation: 
scalar performance:
{'acc': 0.957865, 'precision': 0.67778766, 'recall': 0.7188499, 'specificity': 0.7188499, 'f1': 0.6958935, 'auroc': 0.9052273, 'binary_precision': 0.37349397, 'binary_recall': 0.46345514, 'binary_specificity': 0.97424465, 'binary_f1_score': 0.41363972}
confusion matrix:
       0    1
0  17703  468
1    323  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95832664, 'precision': 0.70905983, 'recall': 0.64522207, 'specificity': 0.64522207, 'f1': 0.6706021, 'auroc': 0.8878718, 'binary_precision': 0.44578314, 'binary_recall': 0.30578512, 'binary_specificity': 0.984659, 'binary_f1_score': 0.3627451}
confusion matrix:
      0   1
0  5905  92
1   168  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_15.png
early stop counter: 13
val acc:0.9578649997711182, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9650585055351257
after epoch: 15,now: 2024-07-07 15:50:58.410879,epoch time: 0:31:22.352558,used: 7:49:22.681542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98979807, 'precision': 0.9913373, 'recall': 0.982353, 'specificity': 0.982353, 'f1': 0.9867338, 'auroc': 0.99827135, 'binary_precision': 0.9944917, 'binary_recall': 0.9666204, 'binary_specificity': 0.9980856, 'binary_f1_score': 0.980358}
confusion matrix:
       0      1
0  42230     81
1    505  14624
---- Validation: 
scalar performance:
{'acc': 0.9595696, 'precision': 0.68579924, 'recall': 0.71812433, 'specificity': 0.71812433, 'f1': 0.70049334, 'auroc': 0.9073502, 'binary_precision': 0.3895921, 'binary_recall': 0.4601329, 'binary_specificity': 0.97611576, 'binary_f1_score': 0.4219345}
confusion matrix:
       0    1
0  17737  434
1    325  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.7433692, 'recall': 0.6331771, 'specificity': 0.6331771, 'f1': 0.6702777, 'auroc': 0.8937649, 'binary_precision': 0.5153846, 'binary_recall': 0.2768595, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.36021507}
confusion matrix:
      0   1
0  5934  63
1   175  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_16.png
early stop counter: 14
val acc:0.9595695734024048, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9650585055351257
after epoch: 16,now: 2024-07-07 16:22:08.798281,epoch time: 0:31:10.387402,used: 8:20:33.068944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9895369, 'precision': 0.99074024, 'recall': 0.9822607, 'specificity': 0.9822607, 'f1': 0.986401, 'auroc': 0.9985875, 'binary_precision': 0.9932102, 'binary_recall': 0.9668848, 'binary_specificity': 0.99763656, 'binary_f1_score': 0.97987074}
confusion matrix:
       0      1
0  42211    100
1    501  14628
---- Validation: 
scalar performance:
{'acc': 0.9574389, 'precision': 0.6819351, 'recall': 0.74513036, 'specificity': 0.74513036, 'f1': 0.7081957, 'auroc': 0.91177833, 'binary_precision': 0.38002437, 'binary_recall': 0.5182724, 'binary_specificity': 0.9719883, 'binary_f1_score': 0.43851018}
confusion matrix:
       0    1
0  17662  509
1    290  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.72645533, 'recall': 0.6462226, 'specificity': 0.6462226, 'f1': 0.67660546, 'auroc': 0.8961459, 'binary_precision': 0.48051947, 'binary_recall': 0.30578512, 'binary_specificity': 0.98666, 'binary_f1_score': 0.37373737}
confusion matrix:
      0   1
0  5917  80
1   168  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_17.png
early stop counter: 15
val acc:0.9574388861656189, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9650585055351257
after epoch: 17,now: 2024-07-07 16:53:23.459616,epoch time: 0:31:14.661335,used: 8:51:47.730279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9902159, 'precision': 0.9910914, 'recall': 0.9836567, 'specificity': 0.9836567, 'f1': 0.9872976, 'auroc': 0.9983096, 'binary_precision': 0.9928948, 'binary_recall': 0.9697951, 'binary_specificity': 0.9975183, 'binary_f1_score': 0.9812091}
confusion matrix:
       0      1
0  42205    105
1    457  14673
---- Validation: 
scalar performance:
{'acc': 0.9555212, 'precision': 0.6757574, 'recall': 0.7521703, 'specificity': 0.7521703, 'f1': 0.70613897, 'auroc': 0.9132117, 'binary_precision': 0.36716077, 'binary_recall': 0.53488374, 'binary_specificity': 0.96945685, 'binary_f1_score': 0.43542933}
confusion matrix:
       0    1
0  17616  555
1    280  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.72160053, 'recall': 0.6656331, 'specificity': 0.6656331, 'f1': 0.6890331, 'auroc': 0.8983333, 'binary_precision': 0.46927375, 'binary_recall': 0.34710744, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.39904988}
confusion matrix:
      0   1
0  5902  95
1   158  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_18.png
early stop counter: 16
val acc:0.9555212259292603, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9650585055351257
after epoch: 18,now: 2024-07-07 17:24:33.209886,epoch time: 0:31:09.750270,used: 9:22:57.480549,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9902507, 'precision': 0.9911369, 'recall': 0.9837016, 'specificity': 0.9837016, 'f1': 0.9873427, 'auroc': 0.9985829, 'binary_precision': 0.99296254, 'binary_recall': 0.9698612, 'binary_specificity': 0.99754196, 'binary_f1_score': 0.9812759}
confusion matrix:
       0      1
0  42206    104
1    456  14674
---- Validation: 
scalar performance:
{'acc': 0.9557343, 'precision': 0.67985094, 'recall': 0.76753825, 'specificity': 0.76753825, 'f1': 0.71384895, 'auroc': 0.916607, 'binary_precision': 0.37431395, 'binary_recall': 0.5664452, 'binary_specificity': 0.9686313, 'binary_f1_score': 0.45076007}
confusion matrix:
       0    1
0  17601  570
1    261  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.7600133, 'recall': 0.6996081, 'specificity': 0.6996081, 'f1': 0.72536576, 'auroc': 0.9035511, 'binary_precision': 0.54347825, 'binary_recall': 0.41322315, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.46948358}
confusion matrix:
      0    1
0  5913   84
1   142  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_19.png
early stop counter: 17
val acc:0.9557343125343323, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9650585055351257
after epoch: 19,now: 2024-07-07 17:56:30.326496,epoch time: 0:31:57.116610,used: 9:54:54.597159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99079037, 'precision': 0.9917662, 'recall': 0.98447126, 'specificity': 0.98447126, 'f1': 0.9880452, 'auroc': 0.9986957, 'binary_precision': 0.99377745, 'binary_recall': 0.97111696, 'binary_specificity': 0.99782556, 'binary_f1_score': 0.9823165}
confusion matrix:
       0      1
0  42218     92
1    437  14693
---- Validation: 
scalar performance:
{'acc': 0.9624993, 'precision': 0.70385027, 'recall': 0.72927433, 'specificity': 0.72927433, 'f1': 0.71572244, 'auroc': 0.91294545, 'binary_precision': 0.425, 'binary_recall': 0.48006645, 'binary_specificity': 0.9784822, 'binary_f1_score': 0.45085803}
confusion matrix:
       0    1
0  17780  391
1    313  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.76267856, 'recall': 0.64590734, 'specificity': 0.64590734, 'f1': 0.6857688, 'auroc': 0.8928238, 'binary_precision': 0.5530303, 'binary_recall': 0.30165288, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.39037433}
confusion matrix:
      0   1
0  5938  59
1   169  73
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_20.png
early stop counter: 18
val acc:0.9624993205070496, best validation acc: 0.9640440940856934, corresponding to test acc:                         0.9580060839653015 / 0.9650585055351257
after epoch: 20,now: 2024-07-07 18:27:46.172554,epoch time: 0:31:15.846058,used: 10:26:10.443217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9906163, 'precision': 0.9931189, 'recall': 0.98273855, 'specificity': 0.98273855, 'f1': 0.98778105, 'auroc': 0.9987347, 'binary_precision': 0.99822426, 'binary_recall': 0.96609163, 'binary_specificity': 0.9993855, 'binary_f1_score': 0.9818951}
confusion matrix:
       0      1
0  42285     26
1    513  14616
---- Validation: 
scalar performance:
{'acc': 0.96500295, 'precision': 0.7088074, 'recall': 0.65909624, 'specificity': 0.65909624, 'f1': 0.6802121, 'auroc': 0.91005313, 'binary_precision': 0.43956044, 'binary_recall': 0.33222592, 'binary_specificity': 0.9859666, 'binary_f1_score': 0.37842956}
confusion matrix:
       0    1
0  17916  255
1    402  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.7840201, 'recall': 0.59047395, 'specificity': 0.59047395, 'f1': 0.6326227, 'auroc': 0.8882189, 'binary_precision': 0.6, 'binary_recall': 0.18595041, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.28391168}
confusion matrix:
      0   1
0  5967  30
1   197  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_21.png
better model found
persisted
after epoch: 21,now: 2024-07-07 18:59:13.544971,epoch time: 0:31:27.372417,used: 10:57:37.815634,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99037254, 'precision': 0.9916812, 'recall': 0.9834871, 'specificity': 0.9834871, 'f1': 0.9874915, 'auroc': 0.9985182, 'binary_precision': 0.9943702, 'binary_recall': 0.9689359, 'binary_specificity': 0.9980383, 'binary_f1_score': 0.9814883}
confusion matrix:
       0      1
0  42227     83
1    470  14660
---- Validation: 
scalar performance:
{'acc': 0.96196663, 'precision': 0.70062107, 'recall': 0.72819614, 'specificity': 0.72819614, 'f1': 0.7134092, 'auroc': 0.9122838, 'binary_precision': 0.41860464, 'binary_recall': 0.47840533, 'binary_specificity': 0.97798693, 'binary_f1_score': 0.44651163}
confusion matrix:
       0    1
0  17771  400
1    314  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.76459265, 'recall': 0.6240138, 'specificity': 0.6240138, 'f1': 0.6661941, 'auroc': 0.8932099, 'binary_precision': 0.5585586, 'binary_recall': 0.25619835, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.3512748}
confusion matrix:
      0   1
0  5948  49
1   180  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_22.png
early stop counter: 1
val acc:0.9619666337966919, best validation acc: 0.9650029540061951, corresponding to test acc:                         0.9636159539222717 / 0.9650585055351257
after epoch: 22,now: 2024-07-07 19:31:07.331087,epoch time: 0:31:53.786116,used: 11:29:31.601750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99068594, 'precision': 0.99167347, 'recall': 0.98429424, 'specificity': 0.98429424, 'f1': 0.9879086, 'auroc': 0.99882746, 'binary_precision': 0.99370813, 'binary_recall': 0.9707865, 'binary_specificity': 0.99780196, 'binary_f1_score': 0.9821136}
confusion matrix:
       0      1
0  42217     93
1    442  14688
---- Validation: 
scalar performance:
{'acc': 0.95951635, 'precision': 0.6881692, 'recall': 0.7301426, 'specificity': 0.7301426, 'f1': 0.7067653, 'auroc': 0.91604835, 'binary_precision': 0.393531, 'binary_recall': 0.48504984, 'binary_specificity': 0.9752353, 'binary_f1_score': 0.43452382}
confusion matrix:
       0    1
0  17721  450
1    310  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.77176094, 'recall': 0.6262467, 'specificity': 0.6262467, 'f1': 0.6696584, 'auroc': 0.8956813, 'binary_precision': 0.57272726, 'binary_recall': 0.2603306, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.35795453}
confusion matrix:
      0   1
0  5950  47
1   179  63
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_23.png
early stop counter: 2
val acc:0.9595163464546204, best validation acc: 0.9650029540061951, corresponding to test acc:                         0.9636159539222717 / 0.9650585055351257
after epoch: 23,now: 2024-07-07 20:02:36.136278,epoch time: 0:31:28.805191,used: 12:01:00.406941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99087745, 'precision': 0.9928658, 'recall': 0.98363876, 'specificity': 0.98363876, 'f1': 0.98813534, 'auroc': 0.99887455, 'binary_precision': 0.99693793, 'binary_recall': 0.96834105, 'binary_specificity': 0.9989364, 'binary_f1_score': 0.9824314}
confusion matrix:
       0      1
0  42265     45
1    479  14651
---- Validation: 
scalar performance:
{'acc': 0.96212643, 'precision': 0.6941462, 'recall': 0.6913384, 'specificity': 0.6913384, 'f1': 0.69273084, 'auroc': 0.91008246, 'binary_precision': 0.40809444, 'binary_recall': 0.40199336, 'binary_specificity': 0.9806835, 'binary_f1_score': 0.40502092}
confusion matrix:
       0    1
0  17820  351
1    360  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.7550837, 'recall': 0.589807, 'specificity': 0.589807, 'f1': 0.6287931, 'auroc': 0.8843136, 'binary_precision': 0.5421687, 'binary_recall': 0.18595041, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.2769231}
confusion matrix:
      0   1
0  5959  38
1   197  45
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_24.png
early stop counter: 3
val acc:0.9621264338493347, best validation acc: 0.9650029540061951, corresponding to test acc:                         0.9636159539222717 / 0.9650585055351257
after epoch: 24,now: 2024-07-07 20:34:00.649977,epoch time: 0:31:24.513699,used: 12:32:24.920640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9912779, 'precision': 0.99273455, 'recall': 0.98478097, 'specificity': 0.98478097, 'f1': 0.98867065, 'auroc': 0.99876785, 'binary_precision': 0.9957303, 'binary_recall': 0.9710509, 'binary_specificity': 0.998511, 'binary_f1_score': 0.9832358}
confusion matrix:
       0      1
0  42247     63
1    438  14692
---- Validation: 
scalar performance:
{'acc': 0.96020883, 'precision': 0.6918471, 'recall': 0.73130333, 'specificity': 0.73130333, 'f1': 0.70949095, 'auroc': 0.9148042, 'binary_precision': 0.4008208, 'binary_recall': 0.48671097, 'binary_specificity': 0.97589564, 'binary_f1_score': 0.4396099}
confusion matrix:
       0    1
0  17733  438
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.78808624, 'recall': 0.6086521, 'specificity': 0.6086521, 'f1': 0.6539628, 'auroc': 0.8948823, 'binary_precision': 0.60674155, 'binary_recall': 0.2231405, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.326284}
confusion matrix:
      0   1
0  5962  35
1   188  54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_25.png
early stop counter: 4
val acc:0.9602088332176208, best validation acc: 0.9650029540061951, corresponding to test acc:                         0.9636159539222717 / 0.9650585055351257
after epoch: 25,now: 2024-07-07 21:05:15.289307,epoch time: 0:31:14.639330,used: 13:03:39.559970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.991922, 'precision': 0.99238336, 'recall': 0.9867679, 'specificity': 0.9867679, 'f1': 0.98953205, 'auroc': 0.99896944, 'binary_precision': 0.9933396, 'binary_recall': 0.97587574, 'binary_specificity': 0.9976601, 'binary_f1_score': 0.9845302}
confusion matrix:
       0      1
0  42211     99
1    365  14765
---- Validation: 
scalar performance:
{'acc': 0.96127415, 'precision': 0.70198214, 'recall': 0.7575512, 'specificity': 0.7575512, 'f1': 0.72597027, 'auroc': 0.9190421, 'binary_precision': 0.41935483, 'binary_recall': 0.5398671, 'binary_specificity': 0.9752353, 'binary_f1_score': 0.47204065}
confusion matrix:
       0    1
0  17721  450
1    277  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.7845514, 'recall': 0.62864625, 'specificity': 0.62864625, 'f1': 0.6742707, 'auroc': 0.89706266, 'binary_precision': 0.5981308, 'binary_recall': 0.2644628, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.36676216}
confusion matrix:
      0   1
0  5954  43
1   178  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_26.png
early stop counter: 5
val acc:0.9612741470336914, best validation acc: 0.9650029540061951, corresponding to test acc:                         0.9636159539222717 / 0.9650585055351257
after epoch: 26,now: 2024-07-07 21:37:10.265045,epoch time: 0:31:54.975738,used: 13:35:34.535708,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99082524, 'precision': 0.9931904, 'recall': 0.98319995, 'specificity': 0.98319995, 'f1': 0.9880583, 'auroc': 0.99885213, 'binary_precision': 0.99802196, 'binary_recall': 0.96708524, 'binary_specificity': 0.9993146, 'binary_f1_score': 0.98231006}
confusion matrix:
       0      1
0  42281     29
1    498  14632
---- Validation: 
scalar performance:
{'acc': 0.96676075, 'precision': 0.7244296, 'recall': 0.64635247, 'specificity': 0.64635247, 'f1': 0.67631364, 'auroc': 0.90601134, 'binary_precision': 0.4716495, 'binary_recall': 0.3039867, 'binary_specificity': 0.9887183, 'binary_f1_score': 0.36969697}
confusion matrix:
       0    1
0  17966  205
1    419  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7326192, 'recall': 0.55353403, 'specificity': 0.55353403, 'f1': 0.5812835, 'auroc': 0.8775859, 'binary_precision': 0.5, 'binary_recall': 0.11157025, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.18243243}
confusion matrix:
      0   1
0  5970  27
1   215  27
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_27.png
better model found
persisted
after epoch: 27,now: 2024-07-07 22:08:33.277406,epoch time: 0:31:23.012361,used: 14:06:57.548069,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9911908, 'precision': 0.9929645, 'recall': 0.98433775, 'specificity': 0.98433775, 'f1': 0.9885489, 'auroc': 0.99890786, 'binary_precision': 0.9966037, 'binary_recall': 0.9698572, 'binary_specificity': 0.9988183, 'binary_f1_score': 0.9830486}
confusion matrix:
       0      1
0  42262     50
1    456  14672
---- Validation: 
scalar performance:
{'acc': 0.96665424, 'precision': 0.72480166, 'recall': 0.65914625, 'specificity': 0.65914625, 'f1': 0.6857658, 'auroc': 0.9095826, 'binary_precision': 0.471564, 'binary_recall': 0.3305648, 'binary_specificity': 0.9877277, 'binary_f1_score': 0.3886719}
confusion matrix:
       0    1
0  17948  223
1    403  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.71139896, 'recall': 0.5432868, 'specificity': 0.5432868, 'f1': 0.56577015, 'auroc': 0.8796003, 'binary_precision': 0.45833334, 'binary_recall': 0.09090909, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.15172414}
confusion matrix:
      0   1
0  5971  26
1   220  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_28.png
early stop counter: 1
val acc:0.9666542410850525, best validation acc: 0.9667607545852661, corresponding to test acc:                         0.9612117409706116 / 0.9650585055351257
after epoch: 28,now: 2024-07-07 22:39:40.293977,epoch time: 0:31:07.016571,used: 14:38:04.564640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9916609, 'precision': 0.99283874, 'recall': 0.9856557, 'specificity': 0.9856557, 'f1': 0.98917615, 'auroc': 0.9990137, 'binary_precision': 0.9952671, 'binary_recall': 0.97296584, 'binary_specificity': 0.9983456, 'binary_f1_score': 0.9839902}
confusion matrix:
       0      1
0  42241     70
1    409  14720
---- Validation: 
scalar performance:
{'acc': 0.95935655, 'precision': 0.6903488, 'recall': 0.7445148, 'specificity': 0.7445148, 'f1': 0.71360093, 'auroc': 0.91765976, 'binary_precision': 0.39692703, 'binary_recall': 0.51495016, 'binary_specificity': 0.97407955, 'binary_f1_score': 0.4483008}
confusion matrix:
       0    1
0  17700  471
1    292  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.7234719, 'recall': 0.6204469, 'specificity': 0.6204469, 'f1': 0.6546237, 'auroc': 0.88840723, 'binary_precision': 0.4765625, 'binary_recall': 0.2520661, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.3297297}
confusion matrix:
      0   1
0  5930  67
1   181  61
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_29.png
early stop counter: 2
val acc:0.9593565464019775, best validation acc: 0.9667607545852661, corresponding to test acc:                         0.9612117409706116 / 0.9650585055351257
after epoch: 29,now: 2024-07-07 23:11:20.653041,epoch time: 0:31:40.359064,used: 15:09:44.923704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99239206, 'precision': 0.99372864, 'recall': 0.9866624, 'specificity': 0.9866624, 'f1': 0.99012685, 'auroc': 0.9991436, 'binary_precision': 0.99648577, 'binary_recall': 0.9745539, 'binary_specificity': 0.99877095, 'binary_f1_score': 0.9853978}
confusion matrix:
       0      1
0  42258     52
1    385  14745
---- Validation: 
scalar performance:
{'acc': 0.9637245, 'precision': 0.7050354, 'recall': 0.69216394, 'specificity': 0.69216394, 'f1': 0.69836605, 'auroc': 0.9152375, 'binary_precision': 0.42984015, 'binary_recall': 0.40199336, 'binary_specificity': 0.9823345, 'binary_f1_score': 0.41545066}
confusion matrix:
       0    1
0  17850  321
1    360  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.7510687, 'recall': 0.575761, 'specificity': 0.575761, 'f1': 0.61166465, 'auroc': 0.8851905, 'binary_precision': 0.53521127, 'binary_recall': 0.1570248, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.2428115}
confusion matrix:
      0   1
0  5964  33
1   204  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716432_30.png
early stop counter: 3
val acc:0.9637244939804077, best validation acc: 0.9667607545852661, corresponding to test acc:                         0.9612117409706116 / 0.9650585055351257
after epoch: 30,now: 2024-07-07 23:42:39.790426,epoch time: 0:31:19.137385,used: 15:41:04.061089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_08_01_35_seed_2_21716432
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:41:04.061089 at 2024-07-07 23:42:39.790426
persisted model performance metric: 

scalar performance:
{'acc': 0.96121174, 'precision': 0.7326192, 'recall': 0.55353403, 'specificity': 0.55353403, 'f1': 0.5812835, 'auroc': 0.8775859, 'binary_precision': 0.5, 'binary_recall': 0.11157025, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.18243243}
confusion matrix:
      0   1
0  5970  27
1   215  27
oracle model performance metric: 

scalar performance:
{'acc': 0.9650585, 'precision': 0.7759677, 'recall': 0.68044764, 'specificity': 0.68044764, 'f1': 0.7171075, 'auroc': 0.90301585, 'binary_precision': 0.5769231, 'binary_recall': 0.37190083, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.4522613}
confusion matrix:
      0   1
0  5931  66
1   152  90
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   4047 MiB |   8857 TiB |   8857 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   8756 TiB |   8756 TiB |
|       from small pool |  17485 KiB |     37 MiB |    101 TiB |    101 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   4047 MiB |   8857 TiB |   8857 TiB |
|       from large pool | 179211 KiB |   4027 MiB |   8756 TiB |   8756 TiB |
|       from small pool |  17485 KiB |     37 MiB |    101 TiB |    101 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   4045 MiB |   8857 TiB |   8857 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   8756 TiB |   8756 TiB |
|       from small pool |  16481 KiB |     36 MiB |    101 TiB |    101 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4420 MiB |   4438 MiB |  12796 MiB |   8376 MiB |
|       from large pool |   4382 MiB |   4396 MiB |  12728 MiB |   8346 MiB |
|       from small pool |     38 MiB |     42 MiB |     68 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40872 KiB | 398560 KiB |   4699 TiB |   4699 TiB |
|       from large pool |  31733 KiB | 397444 KiB |   4598 TiB |   4598 TiB |
|       from small pool |   9139 KiB |  20351 KiB |    101 TiB |    101 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7655    |    1198 M  |    1198 M  |
|       from large pool |      79    |     423    |     820 M  |     820 M  |
|       from small pool |    2887    |    7575    |     377 M  |     377 M  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7655    |    1198 M  |    1198 M  |
|       from large pool |      79    |     423    |     820 M  |     820 M  |
|       from small pool |    2887    |    7575    |     377 M  |     377 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     200    |     203    |     557    |     357    |
|       from large pool |     181    |     182    |     523    |     342    |
|       from small pool |      19    |      21    |      34    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3611    |     826 M  |     826 M  |
|       from large pool |      11    |     186    |     631 M  |     631 M  |
|       from small pool |      22    |    3600    |     194 M  |     194 M  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   8857 TiB |   8857 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   8756 TiB |   8756 TiB |
|       from small pool |      0 KiB |     37 MiB |    101 TiB |    101 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   8857 TiB |   8857 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   8756 TiB |   8756 TiB |
|       from small pool |      0 KiB |     37 MiB |    101 TiB |    101 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   8857 TiB |   8857 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   8756 TiB |   8756 TiB |
|       from small pool |      0 KiB |     36 MiB |    101 TiB |    101 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   4438 MiB |  12796 MiB |  12564 MiB |
|       from large pool | 210944 KiB |   4396 MiB |  12728 MiB |  12522 MiB |
|       from small pool |  26624 KiB |     42 MiB |     68 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398560 KiB |   4699 TiB |   4699 TiB |
|       from large pool |  30464 KiB | 397444 KiB |   4598 TiB |   4598 TiB |
|       from small pool |      0 KiB |  20351 KiB |    101 TiB |    101 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7655    |    1198 M  |    1198 M  |
|       from large pool |       2    |     423    |     820 M  |     820 M  |
|       from small pool |       0    |    7575    |     377 M  |     377 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7655    |    1198 M  |    1198 M  |
|       from large pool |       2    |     423    |     820 M  |     820 M  |
|       from small pool |       0    |    7575    |     377 M  |     377 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     203    |     557    |     534    |
|       from large pool |      10    |     182    |     523    |     513    |
|       from small pool |      13    |      21    |      34    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3611    |     826 M  |     826 M  |
|       from large pool |       3    |     186    |     631 M  |     631 M  |
|       from small pool |       0    |    3600    |     194 M  |     194 M  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul  7 23:43:39 2024]
Finished job 0.
1 of 1 steps (100%) done
