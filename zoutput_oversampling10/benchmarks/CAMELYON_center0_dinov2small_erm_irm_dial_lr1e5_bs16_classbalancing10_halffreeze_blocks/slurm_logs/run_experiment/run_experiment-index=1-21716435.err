Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul  6 08:15:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435

 Experiment start at: 2024-07-06 08:23:37.205634
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9414095, 'precision': 0.95820165, 'recall': 0.8899076, 'specificity': 0.8899076, 'f1': 0.917651, 'auroc': 0.9651096, 'binary_precision': 0.9866507, 'binary_recall': 0.78350097, 'binary_specificity': 0.99631417, 'binary_f1_score': 0.87341875}
confusion matrix:
       0      1
0  42168    156
1   3186  11530
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9484355, 'precision': 0.53781533, 'recall': 0.5247713, 'specificity': 0.5247713, 'f1': 0.52922803, 'auroc': 0.79247236, 'binary_precision': 0.10817308, 'binary_recall': 0.06998445, 'binary_specificity': 0.9795581, 'binary_f1_score': 0.08498583}
confusion matrix:
       0    1
0  17778  371
1    598   45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9472675, 'precision': 0.5750729, 'recall': 0.53272617, 'specificity': 0.53272617, 'f1': 0.5428647, 'auroc': 0.8255398, 'binary_precision': 0.1891892, 'binary_recall': 0.08045977, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.11290323}
confusion matrix:
      0   1
0  5907  90
1   240  21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-06 08:46:52.248898,epoch time: 0:23:15.043264,used: 0:23:15.043264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9542952, 'precision': 0.96538246, 'recall': 0.91553974, 'specificity': 0.91553974, 'f1': 0.93706584, 'auroc': 0.98024976, 'binary_precision': 0.98509616, 'binary_recall': 0.835474, 'binary_specificity': 0.9956054, 'binary_f1_score': 0.9041368}
confusion matrix:
       0      1
0  42139    186
1   2421  12294
---- Validation: 
scalar performance:
{'acc': 0.9555662, 'precision': 0.6308025, 'recall': 0.59371775, 'specificity': 0.59371775, 'f1': 0.6086661, 'auroc': 0.8568555, 'binary_precision': 0.28947368, 'binary_recall': 0.20528771, 'binary_specificity': 0.98214775, 'binary_f1_score': 0.24021836}
confusion matrix:
       0    1
0  17825  324
1    511  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.7015686, 'recall': 0.6156852, 'specificity': 0.6156852, 'f1': 0.64530015, 'auroc': 0.8820665, 'binary_precision': 0.43537414, 'binary_recall': 0.24521072, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.3137255}
confusion matrix:
      0   1
0  5914  83
1   197  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-06 09:09:29.275626,epoch time: 0:22:37.026728,used: 0:45:52.069992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96185136, 'precision': 0.9685538, 'recall': 0.9315767, 'specificity': 0.9315767, 'f1': 0.94819, 'auroc': 0.98534036, 'binary_precision': 0.98089904, 'binary_recall': 0.8690363, 'binary_specificity': 0.9941171, 'binary_f1_score': 0.9215856}
confusion matrix:
       0      1
0  42077    249
1   1927  12787
---- Validation: 
scalar performance:
{'acc': 0.9556726, 'precision': 0.66322285, 'recall': 0.66052777, 'specificity': 0.66052777, 'f1': 0.6618624, 'auroc': 0.878343, 'binary_precision': 0.34968355, 'binary_recall': 0.3437014, 'binary_specificity': 0.9773541, 'binary_f1_score': 0.34666666}
confusion matrix:
       0    1
0  17738  411
1    422  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.74927354, 'recall': 0.71155214, 'specificity': 0.71155214, 'f1': 0.7286573, 'auroc': 0.89868706, 'binary_precision': 0.52272725, 'binary_recall': 0.44061303, 'binary_specificity': 0.98249125, 'binary_f1_score': 0.47817048}
confusion matrix:
      0    1
0  5892  105
1   146  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-06 09:32:18.652089,epoch time: 0:22:49.376463,used: 1:08:41.446455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9668128, 'precision': 0.96824515, 'recall': 0.94444, 'specificity': 0.94444, 'f1': 0.9555533, 'auroc': 0.9884602, 'binary_precision': 0.9709858, 'binary_recall': 0.89821297, 'binary_specificity': 0.990667, 'binary_f1_score': 0.9331827}
confusion matrix:
       0      1
0  41928    395
1   1498  13219
---- Validation: 
scalar performance:
{'acc': 0.9542891, 'precision': 0.6671407, 'recall': 0.6928139, 'specificity': 0.6928139, 'f1': 0.6789185, 'auroc': 0.8856372, 'binary_precision': 0.3552279, 'binary_recall': 0.41213062, 'binary_specificity': 0.97349715, 'binary_f1_score': 0.38156945}
confusion matrix:
       0    1
0  17668  481
1    378  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.76555413, 'recall': 0.7752689, 'specificity': 0.7752689, 'f1': 0.7703122, 'auroc': 0.9041078, 'binary_precision': 0.5498155, 'binary_recall': 0.57088125, 'binary_specificity': 0.9796565, 'binary_f1_score': 0.5601503}
confusion matrix:
      0    1
0  5875  122
1   112  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_4.png
new oracle model saved
early stop counter: 1
val acc:0.9542890787124634, best validation acc: 0.9556726217269897, corresponding to test acc:                         0.9598913192749023 / 0.9626078605651855
after epoch: 4,now: 2024-07-06 09:55:09.965443,epoch time: 0:22:51.313354,used: 1:31:32.759809,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96884644, 'precision': 0.9718706, 'recall': 0.9463389, 'specificity': 0.9463389, 'f1': 0.9582077, 'auroc': 0.9887215, 'binary_precision': 0.97763014, 'binary_recall': 0.8998369, 'binary_specificity': 0.99284095, 'binary_f1_score': 0.93712187}
confusion matrix:
       0      1
0  42021    303
1   1474  13242
---- Validation: 
scalar performance:
{'acc': 0.95679015, 'precision': 0.6802896, 'recall': 0.69860905, 'specificity': 0.69860905, 'f1': 0.68894154, 'auroc': 0.8927351, 'binary_precision': 0.38115332, 'binary_recall': 0.4214619, 'binary_specificity': 0.9757562, 'binary_f1_score': 0.40029544}
confusion matrix:
       0    1
0  17709  440
1    372  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.78557944, 'recall': 0.7897627, 'specificity': 0.7897627, 'f1': 0.7876539, 'auroc': 0.9096432, 'binary_precision': 0.58867925, 'binary_recall': 0.59770113, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.5931559}
confusion matrix:
      0    1
0  5888  109
1   105  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-06 10:18:33.302483,epoch time: 0:23:23.337040,used: 1:54:56.096849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9726858, 'precision': 0.97241515, 'recall': 0.9557549, 'specificity': 0.9557549, 'f1': 0.9636996, 'auroc': 0.9906776, 'binary_precision': 0.97188556, 'binary_recall': 0.9207719, 'binary_specificity': 0.9907379, 'binary_f1_score': 0.9456385}
confusion matrix:
       0      1
0  41931    392
1   1166  13551
---- Validation: 
scalar performance:
{'acc': 0.9520541, 'precision': 0.67205155, 'recall': 0.7449107, 'specificity': 0.7449107, 'f1': 0.7010945, 'auroc': 0.8988235, 'binary_precision': 0.36129034, 'binary_recall': 0.5225505, 'binary_specificity': 0.9672709, 'binary_f1_score': 0.42720914}
confusion matrix:
       0    1
0  17555  594
1    307  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.73939824, 'recall': 0.8239062, 'specificity': 0.8239062, 'f1': 0.7743036, 'auroc': 0.91345084, 'binary_precision': 0.4930362, 'binary_recall': 0.6781609, 'binary_specificity': 0.9696515, 'binary_f1_score': 0.57096773}
confusion matrix:
      0    1
0  5815  182
1    84  177
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_6.png
early stop counter: 1
val acc:0.9520540833473206, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 6,now: 2024-07-06 10:41:40.287917,epoch time: 0:23:06.985434,used: 2:18:03.082283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9723001, 'precision': 0.9758321, 'recall': 0.95157564, 'specificity': 0.95157564, 'f1': 0.9629016, 'auroc': 0.9919934, 'binary_precision': 0.9825889, 'binary_recall': 0.9087512, 'binary_specificity': 0.9944001, 'binary_f1_score': 0.94422877}
confusion matrix:
       0      1
0  42085    237
1   1343  13375
---- Validation: 
scalar performance:
{'acc': 0.9565241, 'precision': 0.6886684, 'recall': 0.74047446, 'specificity': 0.74047446, 'f1': 0.710986, 'auroc': 0.90122724, 'binary_precision': 0.39492753, 'binary_recall': 0.5085537, 'binary_specificity': 0.9723952, 'binary_f1_score': 0.4445955}
confusion matrix:
       0    1
0  17648  501
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.75226724, 'recall': 0.81258065, 'specificity': 0.81258065, 'f1': 0.77871996, 'auroc': 0.9163667, 'binary_precision': 0.5198777, 'binary_recall': 0.651341, 'binary_specificity': 0.97382027, 'binary_f1_score': 0.57823133}
confusion matrix:
      0    1
0  5840  157
1    91  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_7.png
early stop counter: 2
val acc:0.9565240740776062, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 7,now: 2024-07-06 11:04:47.444504,epoch time: 0:23:07.156587,used: 2:41:10.238870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9748422, 'precision': 0.9775945, 'recall': 0.95644915, 'specificity': 0.95644915, 'f1': 0.966413, 'auroc': 0.9923461, 'binary_precision': 0.9829091, 'binary_recall': 0.91845053, 'binary_specificity': 0.9944477, 'binary_f1_score': 0.9495872}
confusion matrix:
       0      1
0  42090    235
1   1200  13515
---- Validation: 
scalar performance:
{'acc': 0.95508724, 'precision': 0.6848158, 'recall': 0.7509814, 'specificity': 0.7509814, 'f1': 0.71211797, 'auroc': 0.9056498, 'binary_precision': 0.38644066, 'binary_recall': 0.5318818, 'binary_specificity': 0.970081, 'binary_f1_score': 0.447644}
confusion matrix:
       0    1
0  17606  543
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7486762, 'recall': 0.82499003, 'specificity': 0.82499003, 'f1': 0.7809758, 'auroc': 0.91954243, 'binary_precision': 0.5115607, 'binary_recall': 0.6781609, 'binary_specificity': 0.9718192, 'binary_f1_score': 0.58319604}
confusion matrix:
      0    1
0  5828  169
1    84  177
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_8.png
early stop counter: 3
val acc:0.9550872445106506, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 8,now: 2024-07-06 11:28:04.313863,epoch time: 0:23:16.869359,used: 3:04:27.108229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9761045, 'precision': 0.97787774, 'recall': 0.95943505, 'specificity': 0.95943505, 'f1': 0.9681921, 'auroc': 0.9931619, 'binary_precision': 0.98133063, 'binary_recall': 0.9249898, 'binary_specificity': 0.9938803, 'binary_f1_score': 0.95232767}
confusion matrix:
       0      1
0  42063    259
1   1104  13614
---- Validation: 
scalar performance:
{'acc': 0.95301193, 'precision': 0.6790903, 'recall': 0.76115775, 'specificity': 0.76115775, 'f1': 0.7112758, 'auroc': 0.9062039, 'binary_precision': 0.37421384, 'binary_recall': 0.55520993, 'binary_specificity': 0.9671056, 'binary_f1_score': 0.44708827}
confusion matrix:
       0    1
0  17552  597
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95317996, 'precision': 0.7241528, 'recall': 0.84181076, 'specificity': 0.84181076, 'f1': 0.7686504, 'auroc': 0.9213336, 'binary_precision': 0.46078432, 'binary_recall': 0.7203065, 'binary_specificity': 0.963315, 'binary_f1_score': 0.5620329}
confusion matrix:
      0    1
0  5777  220
1    73  188
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_9.png
early stop counter: 4
val acc:0.9530119299888611, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 9,now: 2024-07-06 11:51:12.169438,epoch time: 0:23:07.855575,used: 3:27:34.963804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9782784, 'precision': 0.9769081, 'recall': 0.9660387, 'specificity': 0.9660387, 'f1': 0.9713102, 'auroc': 0.99406344, 'binary_precision': 0.97417676, 'binary_recall': 0.9407488, 'binary_specificity': 0.9913286, 'binary_f1_score': 0.957171}
confusion matrix:
       0      1
0  41956    367
1    872  13845
---- Validation: 
scalar performance:
{'acc': 0.95306516, 'precision': 0.6788085, 'recall': 0.7589352, 'specificity': 0.7589352, 'f1': 0.7103895, 'auroc': 0.90628386, 'binary_precision': 0.37381205, 'binary_recall': 0.5505443, 'binary_specificity': 0.96732605, 'binary_f1_score': 0.44528306}
confusion matrix:
       0    1
0  17556  593
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9509428, 'precision': 0.71649456, 'recall': 0.8406435, 'specificity': 0.8406435, 'f1': 0.76228404, 'auroc': 0.9201702, 'binary_precision': 0.44549763, 'binary_recall': 0.7203065, 'binary_specificity': 0.9609805, 'binary_f1_score': 0.55051243}
confusion matrix:
      0    1
0  5763  234
1    73  188
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_10.png
early stop counter: 5
val acc:0.9530651569366455, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 10,now: 2024-07-06 12:14:37.492179,epoch time: 0:23:25.322741,used: 3:51:00.286545,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9792777, 'precision': 0.97801065, 'recall': 0.9675782, 'specificity': 0.9675782, 'f1': 0.97264445, 'auroc': 0.99425745, 'binary_precision': 0.9754813, 'binary_recall': 0.94340265, 'binary_specificity': 0.9917537, 'binary_f1_score': 0.95917386}
confusion matrix:
       0      1
0  41973    349
1    833  13885
---- Validation: 
scalar performance:
{'acc': 0.9438591, 'precision': 0.65776855, 'recall': 0.7871715, 'specificity': 0.7871715, 'f1': 0.70025665, 'auroc': 0.9078553, 'binary_precision': 0.3294702, 'binary_recall': 0.61897355, 'binary_specificity': 0.9553694, 'binary_f1_score': 0.4300378}
confusion matrix:
       0    1
0  17339  810
1    245  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.930489, 'precision': 0.66849905, 'recall': 0.8501272, 'specificity': 0.8501272, 'f1': 0.7202788, 'auroc': 0.9204602, 'binary_precision': 0.3479021, 'binary_recall': 0.7624521, 'binary_specificity': 0.93780226, 'binary_f1_score': 0.47779116}
confusion matrix:
      0    1
0  5624  373
1    62  199
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_11.png
early stop counter: 6
val acc:0.9438591003417969, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 11,now: 2024-07-06 12:37:18.607262,epoch time: 0:22:41.115083,used: 4:13:41.401628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9805575, 'precision': 0.9815275, 'recall': 0.967482, 'specificity': 0.967482, 'f1': 0.9742367, 'auroc': 0.99537164, 'binary_precision': 0.9834423, 'binary_recall': 0.9404689, 'binary_specificity': 0.994495, 'binary_f1_score': 0.9614757}
confusion matrix:
       0      1
0  42092    233
1    876  13839
---- Validation: 
scalar performance:
{'acc': 0.9516283, 'precision': 0.6737821, 'recall': 0.7589414, 'specificity': 0.7589414, 'f1': 0.70663387, 'auroc': 0.9059169, 'binary_precision': 0.3637295, 'binary_recall': 0.5520995, 'binary_specificity': 0.96578324, 'binary_f1_score': 0.4385423}
confusion matrix:
       0    1
0  17528  621
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9431128, 'precision': 0.6920605, 'recall': 0.82922876, 'specificity': 0.82922876, 'f1': 0.7390487, 'auroc': 0.9167943, 'binary_precision': 0.39740822, 'binary_recall': 0.70498085, 'binary_specificity': 0.9534767, 'binary_f1_score': 0.5082873}
confusion matrix:
      0    1
0  5718  279
1    77  184
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_12.png
early stop counter: 7
val acc:0.9516283273696899, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 12,now: 2024-07-06 13:00:21.159586,epoch time: 0:23:02.552324,used: 4:36:43.953952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.980277, 'precision': 0.9789775, 'recall': 0.969247, 'specificity': 0.969247, 'f1': 0.973982, 'auroc': 0.9949118, 'binary_precision': 0.9763774, 'binary_recall': 0.9464565, 'binary_specificity': 0.9920374, 'binary_f1_score': 0.96118414}
confusion matrix:
       0      1
0  41986    337
1    788  13929
---- Validation: 
scalar performance:
{'acc': 0.951788, 'precision': 0.6759771, 'recall': 0.76652455, 'specificity': 0.76652455, 'f1': 0.7105036, 'auroc': 0.906323, 'binary_precision': 0.36757302, 'binary_recall': 0.5676516, 'binary_specificity': 0.96539754, 'binary_f1_score': 0.44621027}
confusion matrix:
       0    1
0  17521  628
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94119525, 'precision': 0.68638027, 'recall': 0.8245636, 'specificity': 0.8245636, 'f1': 0.7330195, 'auroc': 0.9152955, 'binary_precision': 0.38641188, 'binary_recall': 0.697318, 'binary_specificity': 0.9518092, 'binary_f1_score': 0.49726778}
confusion matrix:
      0    1
0  5708  289
1    79  182
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_13.png
early stop counter: 8
val acc:0.9517880082130432, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 13,now: 2024-07-06 13:23:24.433979,epoch time: 0:23:03.274393,used: 4:59:47.228345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.981399, 'precision': 0.98007387, 'recall': 0.97111106, 'specificity': 0.97111106, 'f1': 0.9754821, 'auroc': 0.9949988, 'binary_precision': 0.97741574, 'binary_recall': 0.9498539, 'binary_specificity': 0.9923682, 'binary_f1_score': 0.9634377}
confusion matrix:
       0      1
0  42000    323
1    738  13979
---- Validation: 
scalar performance:
{'acc': 0.95045763, 'precision': 0.67276525, 'recall': 0.7718363, 'specificity': 0.7718363, 'f1': 0.7094569, 'auroc': 0.9090571, 'binary_precision': 0.360735, 'binary_recall': 0.5800933, 'binary_specificity': 0.96357924, 'binary_f1_score': 0.44484198}
confusion matrix:
       0    1
0  17488  661
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94119525, 'precision': 0.6882966, 'recall': 0.83555764, 'specificity': 0.83555764, 'f1': 0.73705786, 'auroc': 0.917469, 'binary_precision': 0.38923395, 'binary_recall': 0.7203065, 'binary_specificity': 0.95080876, 'binary_f1_score': 0.50537634}
confusion matrix:
      0    1
0  5702  295
1    73  188
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_14.png
early stop counter: 9
val acc:0.9504576325416565, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 14,now: 2024-07-06 13:46:44.756700,epoch time: 0:23:20.322721,used: 5:23:07.551066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9816269, 'precision': 0.98189455, 'recall': 0.96991646, 'specificity': 0.96991646, 'f1': 0.9757102, 'auroc': 0.99564666, 'binary_precision': 0.9824264, 'binary_recall': 0.94571644, 'binary_specificity': 0.9941164, 'binary_f1_score': 0.963722}
confusion matrix:
       0      1
0  42072    249
1    799  13920
---- Validation: 
scalar performance:
{'acc': 0.9480098, 'precision': 0.66590947, 'recall': 0.7743193, 'specificity': 0.7743193, 'f1': 0.70449305, 'auroc': 0.9098791, 'binary_precision': 0.346789, 'binary_recall': 0.58786935, 'binary_specificity': 0.9607692, 'binary_f1_score': 0.43623775}
confusion matrix:
       0    1
0  17437  712
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.935123, 'precision': 0.673352, 'recall': 0.82872474, 'specificity': 0.82872474, 'f1': 0.7217803, 'auroc': 0.91765165, 'binary_precision': 0.35976788, 'binary_recall': 0.7126437, 'binary_specificity': 0.94480574, 'binary_f1_score': 0.47814912}
confusion matrix:
      0    1
0  5666  331
1    75  186
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_15.png
early stop counter: 10
val acc:0.9480097889900208, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 15,now: 2024-07-06 14:10:44.413480,epoch time: 0:23:59.656780,used: 5:47:07.207846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98192495, 'precision': 0.9809958, 'recall': 0.9715763, 'specificity': 0.9715763, 'f1': 0.9761646, 'auroc': 0.99587506, 'binary_precision': 0.97913456, 'binary_recall': 0.95019364, 'binary_specificity': 0.9929589, 'binary_f1_score': 0.964447}
confusion matrix:
       0      1
0  42025    298
1    733  13984
---- Validation: 
scalar performance:
{'acc': 0.9397084, 'precision': 0.6473931, 'recall': 0.7835225, 'specificity': 0.7835225, 'f1': 0.6898277, 'auroc': 0.9059118, 'binary_precision': 0.30889237, 'binary_recall': 0.61586314, 'binary_specificity': 0.9511819, 'binary_f1_score': 0.41142857}
confusion matrix:
       0    1
0  17263  886
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9137105, 'precision': 0.6402336, 'recall': 0.83587575, 'specificity': 0.83587575, 'f1': 0.6869924, 'auroc': 0.913826, 'binary_precision': 0.29210135, 'binary_recall': 0.75095785, 'binary_specificity': 0.9207937, 'binary_f1_score': 0.42060086}
confusion matrix:
      0    1
0  5522  475
1    65  196
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_16.png
early stop counter: 11
val acc:0.939708411693573, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 16,now: 2024-07-06 14:35:02.362481,epoch time: 0:24:17.949001,used: 6:11:25.156847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9823282, 'precision': 0.9835248, 'recall': 0.970162, 'specificity': 0.970162, 'f1': 0.9766019, 'auroc': 0.995913, 'binary_precision': 0.98589253, 'binary_recall': 0.9450258, 'binary_specificity': 0.99529815, 'binary_f1_score': 0.96502674}
confusion matrix:
       0      1
0  42125    199
1    809  13907
---- Validation: 
scalar performance:
{'acc': 0.95125586, 'precision': 0.673319, 'recall': 0.76249886, 'specificity': 0.76249886, 'f1': 0.7073083, 'auroc': 0.9071391, 'binary_precision': 0.36253777, 'binary_recall': 0.5598756, 'binary_specificity': 0.96512204, 'binary_f1_score': 0.4400978}
confusion matrix:
       0    1
0  17516  633
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9346437, 'precision': 0.6712259, 'recall': 0.82297754, 'specificity': 0.82297754, 'f1': 0.71871144, 'auroc': 0.9145904, 'binary_precision': 0.35603112, 'binary_recall': 0.7011494, 'binary_specificity': 0.94480574, 'binary_f1_score': 0.47225803}
confusion matrix:
      0    1
0  5666  331
1    78  183
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_17.png
early stop counter: 12
val acc:0.9512558579444885, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 17,now: 2024-07-06 14:59:52.005378,epoch time: 0:24:49.642897,used: 6:36:14.799744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98390603, 'precision': 0.98396075, 'recall': 0.9738374, 'specificity': 0.9738374, 'f1': 0.9787601, 'auroc': 0.99626625, 'binary_precision': 0.9840702, 'binary_recall': 0.9530379, 'binary_specificity': 0.9946369, 'binary_f1_score': 0.9683055}
confusion matrix:
       0      1
0  42099    227
1    691  14023
---- Validation: 
scalar performance:
{'acc': 0.94737124, 'precision': 0.661409, 'recall': 0.7627379, 'specificity': 0.7627379, 'f1': 0.6978755, 'auroc': 0.9047054, 'binary_precision': 0.3386194, 'binary_recall': 0.5645412, 'binary_specificity': 0.96093446, 'binary_f1_score': 0.42332363}
confusion matrix:
       0    1
0  17440  709
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92841166, 'precision': 0.65978837, 'recall': 0.82522297, 'specificity': 0.82522297, 'f1': 0.70767736, 'auroc': 0.91164213, 'binary_precision': 0.33273703, 'binary_recall': 0.7126437, 'binary_specificity': 0.93780226, 'binary_f1_score': 0.45365852}
confusion matrix:
      0    1
0  5624  373
1    75  186
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_18.png
early stop counter: 13
val acc:0.947371244430542, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 18,now: 2024-07-06 15:22:34.258840,epoch time: 0:22:42.253462,used: 6:58:57.053206,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98401123, 'precision': 0.98506415, 'recall': 0.9730519, 'specificity': 0.9730519, 'f1': 0.9788633, 'auroc': 0.9966169, 'binary_precision': 0.98715687, 'binary_recall': 0.9504042, 'binary_specificity': 0.9956995, 'binary_f1_score': 0.968432}
confusion matrix:
       0      1
0  42139    182
1    730  13989
---- Validation: 
scalar performance:
{'acc': 0.9534376, 'precision': 0.67553836, 'recall': 0.73812646, 'specificity': 0.73812646, 'f1': 0.70135695, 'auroc': 0.90061563, 'binary_precision': 0.3687783, 'binary_recall': 0.5069984, 'binary_specificity': 0.9692545, 'binary_f1_score': 0.426981}
confusion matrix:
       0    1
0  17591  558
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9402365, 'precision': 0.68086565, 'recall': 0.80757236, 'specificity': 0.80757236, 'f1': 0.72442496, 'auroc': 0.9093633, 'binary_precision': 0.3769063, 'binary_recall': 0.66283524, 'binary_specificity': 0.9523095, 'binary_f1_score': 0.48055556}
confusion matrix:
      0    1
0  5711  286
1    88  173
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_19.png
early stop counter: 14
val acc:0.9534376263618469, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 19,now: 2024-07-06 15:45:33.074823,epoch time: 0:22:58.815983,used: 7:21:55.869189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9846248, 'precision': 0.98509204, 'recall': 0.9746175, 'specificity': 0.9746175, 'f1': 0.9797064, 'auroc': 0.9966849, 'binary_precision': 0.9860253, 'binary_recall': 0.9539371, 'binary_specificity': 0.99529785, 'binary_f1_score': 0.96971583}
confusion matrix:
       0      1
0  42122    199
1    678  14041
---- Validation: 
scalar performance:
{'acc': 0.94971263, 'precision': 0.66533947, 'recall': 0.749699, 'specificity': 0.749699, 'f1': 0.6975124, 'auroc': 0.90216833, 'binary_precision': 0.34747475, 'binary_recall': 0.5349922, 'binary_specificity': 0.9644058, 'binary_f1_score': 0.42131048}
confusion matrix:
       0    1
0  17503  646
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9341643, 'precision': 0.6687033, 'recall': 0.8153981, 'specificity': 0.8153981, 'f1': 0.7149297, 'auroc': 0.90836716, 'binary_precision': 0.35166994, 'binary_recall': 0.68582374, 'binary_specificity': 0.9449725, 'binary_f1_score': 0.46493506}
confusion matrix:
      0    1
0  5667  330
1    82  179
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_20.png
early stop counter: 15
val acc:0.9497126340866089, best validation acc: 0.9567901492118835, corresponding to test acc:                         0.9658037424087524 / 0.9658037424087524
after epoch: 20,now: 2024-07-06 16:08:40.078802,epoch time: 0:23:07.003979,used: 7:45:02.873168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9848177, 'precision': 0.98646975, 'recall': 0.97379315, 'specificity': 0.97379315, 'f1': 0.97991556, 'auroc': 0.99673367, 'binary_precision': 0.98974687, 'binary_recall': 0.9510124, 'binary_specificity': 0.99657387, 'binary_f1_score': 0.9699931}
confusion matrix:
       0      1
0  42177    145
1    721  13997
---- Validation: 
scalar performance:
{'acc': 0.9574287, 'precision': 0.68696785, 'recall': 0.7131907, 'specificity': 0.7131907, 'f1': 0.6990964, 'auroc': 0.8982285, 'binary_precision': 0.3934871, 'binary_recall': 0.45101088, 'binary_specificity': 0.9753705, 'binary_f1_score': 0.42028984}
confusion matrix:
       0    1
0  17702  447
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9504634, 'precision': 0.7071637, 'recall': 0.78175867, 'specificity': 0.78175867, 'f1': 0.7377721, 'auroc': 0.90370727, 'binary_precision': 0.43213296, 'binary_recall': 0.59770113, 'binary_specificity': 0.96581626, 'binary_f1_score': 0.5016077}
confusion matrix:
      0    1
0  5792  205
1   105  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_21.png
better model found
persisted
after epoch: 21,now: 2024-07-06 16:31:37.228050,epoch time: 0:22:57.149248,used: 8:08:00.022416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98506314, 'precision': 0.9864483, 'recall': 0.97443974, 'specificity': 0.97443974, 'f1': 0.98025024, 'auroc': 0.99674284, 'binary_precision': 0.989201, 'binary_recall': 0.9524942, 'binary_specificity': 0.9963852, 'binary_f1_score': 0.97050065}
confusion matrix:
       0      1
0  42173    153
1    699  14015
---- Validation: 
scalar performance:
{'acc': 0.95705616, 'precision': 0.68511295, 'recall': 0.71299785, 'specificity': 0.71299785, 'f1': 0.697937, 'auroc': 0.89848524, 'binary_precision': 0.38978493, 'binary_recall': 0.45101088, 'binary_specificity': 0.9749848, 'binary_f1_score': 0.4181687}
confusion matrix:
       0    1
0  17695  454
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95126235, 'precision': 0.7096914, 'recall': 0.7785109, 'specificity': 0.7785109, 'f1': 0.73841155, 'auroc': 0.90199184, 'binary_precision': 0.4375, 'binary_recall': 0.5900383, 'binary_specificity': 0.9669835, 'binary_f1_score': 0.50244695}
confusion matrix:
      0    1
0  5799  198
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_22.png
early stop counter: 1
val acc:0.9570561647415161, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9504634141921997 / 0.9658037424087524
after epoch: 22,now: 2024-07-06 16:54:32.470010,epoch time: 0:22:55.241960,used: 8:30:55.264376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98585206, 'precision': 0.98672944, 'recall': 0.97621703, 'specificity': 0.97621703, 'f1': 0.98132443, 'auroc': 0.99687326, 'binary_precision': 0.9884815, 'binary_recall': 0.956309, 'binary_specificity': 0.99612504, 'binary_f1_score': 0.9721291}
confusion matrix:
       0      1
0  42159    164
1    643  14074
---- Validation: 
scalar performance:
{'acc': 0.9541826, 'precision': 0.68132687, 'recall': 0.75126314, 'specificity': 0.75126314, 'f1': 0.7097734, 'auroc': 0.90549433, 'binary_precision': 0.37942478, 'binary_recall': 0.533437, 'binary_specificity': 0.9690892, 'binary_f1_score': 0.44343892}
confusion matrix:
       0    1
0  17588  561
1    300  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94646853, 'precision': 0.6931318, 'recall': 0.7796743, 'specificity': 0.7796743, 'f1': 0.7270005, 'auroc': 0.9035642, 'binary_precision': 0.4041451, 'binary_recall': 0.59770113, 'binary_specificity': 0.9616475, 'binary_f1_score': 0.4822257}
confusion matrix:
      0    1
0  5767  230
1   105  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_23.png
early stop counter: 2
val acc:0.9541826248168945, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9504634141921997 / 0.9658037424087524
after epoch: 23,now: 2024-07-06 17:17:32.926794,epoch time: 0:23:00.456784,used: 8:53:55.721160,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9866059, 'precision': 0.9869679, 'recall': 0.97793996, 'specificity': 0.97793996, 'f1': 0.98234415, 'auroc': 0.9975749, 'binary_precision': 0.987694, 'binary_recall': 0.96003807, 'binary_specificity': 0.9958418, 'binary_f1_score': 0.9736697}
confusion matrix:
       0      1
0  42150    176
1    588  14126
---- Validation: 
scalar performance:
{'acc': 0.94939333, 'precision': 0.6624346, 'recall': 0.7420331, 'specificity': 0.7420331, 'f1': 0.693079, 'auroc': 0.9012506, 'binary_precision': 0.34221312, 'binary_recall': 0.5194401, 'binary_specificity': 0.96462613, 'binary_f1_score': 0.4126004}
confusion matrix:
       0    1
0  17507  642
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9435922, 'precision': 0.68446386, 'recall': 0.78000593, 'specificity': 0.78000593, 'f1': 0.7204865, 'auroc': 0.9007507, 'binary_precision': 0.3866995, 'binary_recall': 0.6015326, 'binary_specificity': 0.9584792, 'binary_f1_score': 0.4707646}
confusion matrix:
      0    1
0  5748  249
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_24.png
early stop counter: 3
val acc:0.9493933320045471, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9504634141921997 / 0.9658037424087524
after epoch: 24,now: 2024-07-06 17:40:19.140165,epoch time: 0:22:46.213371,used: 9:16:41.934531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9859923, 'precision': 0.9868932, 'recall': 0.97641945, 'specificity': 0.97641945, 'f1': 0.98150873, 'auroc': 0.99732375, 'binary_precision': 0.9886922, 'binary_recall': 0.95664287, 'binary_specificity': 0.9961961, 'binary_f1_score': 0.97240347}
confusion matrix:
       0      1
0  42164    161
1    638  14077
---- Validation: 
scalar performance:
{'acc': 0.9545019, 'precision': 0.67684716, 'recall': 0.7259265, 'specificity': 0.7259265, 'f1': 0.6979375, 'auroc': 0.9034867, 'binary_precision': 0.37228915, 'binary_recall': 0.4805599, 'binary_specificity': 0.9712932, 'binary_f1_score': 0.41955194}
confusion matrix:
       0    1
0  17628  521
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9511026, 'precision': 0.7090702, 'recall': 0.7784275, 'specificity': 0.7784275, 'f1': 0.7379593, 'auroc': 0.9009018, 'binary_precision': 0.4362606, 'binary_recall': 0.5900383, 'binary_specificity': 0.9668167, 'binary_f1_score': 0.50162864}
confusion matrix:
      0    1
0  5798  199
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_25.png
early stop counter: 4
val acc:0.9545019268989563, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9504634141921997 / 0.9658037424087524
after epoch: 25,now: 2024-07-06 18:03:20.515321,epoch time: 0:23:01.375156,used: 9:39:43.309687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9869214, 'precision': 0.98745716, 'recall': 0.9782908, 'specificity': 0.9782908, 'f1': 0.9827609, 'auroc': 0.9972569, 'binary_precision': 0.9885315, 'binary_recall': 0.9604566, 'binary_specificity': 0.9961249, 'binary_f1_score': 0.97429186}
confusion matrix:
       0      1
0  42158    164
1    582  14136
---- Validation: 
scalar performance:
{'acc': 0.95109624, 'precision': 0.66733265, 'recall': 0.7391645, 'specificity': 0.7391645, 'f1': 0.6958626, 'auroc': 0.9032202, 'binary_precision': 0.3522484, 'binary_recall': 0.5116641, 'binary_specificity': 0.96666485, 'binary_f1_score': 0.41724795}
confusion matrix:
       0    1
0  17544  605
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94646853, 'precision': 0.6931318, 'recall': 0.7796743, 'specificity': 0.7796743, 'f1': 0.7270005, 'auroc': 0.90101725, 'binary_precision': 0.4041451, 'binary_recall': 0.59770113, 'binary_specificity': 0.9616475, 'binary_f1_score': 0.4822257}
confusion matrix:
      0    1
0  5767  230
1   105  156
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_26.png
early stop counter: 5
val acc:0.95109623670578, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9504634141921997 / 0.9658037424087524
after epoch: 26,now: 2024-07-06 18:26:10.254070,epoch time: 0:22:49.738749,used: 10:02:33.048436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9868338, 'precision': 0.9872823, 'recall': 0.97822523, 'specificity': 0.97822523, 'f1': 0.98264337, 'auroc': 0.9973008, 'binary_precision': 0.9881818, 'binary_recall': 0.96044314, 'binary_specificity': 0.99600726, 'binary_f1_score': 0.974115}
confusion matrix:
       0      1
0  42158    169
1    582  14131
---- Validation: 
scalar performance:
{'acc': 0.9600894, 'precision': 0.6966314, 'recall': 0.6913165, 'specificity': 0.6913165, 'f1': 0.69393265, 'auroc': 0.90280557, 'binary_precision': 0.4144, 'binary_recall': 0.40279937, 'binary_specificity': 0.9798336, 'binary_f1_score': 0.40851736}
confusion matrix:
       0    1
0  17783  366
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7542112, 'recall': 0.7486157, 'specificity': 0.7486157, 'f1': 0.7513778, 'auroc': 0.89919865, 'binary_precision': 0.5294118, 'binary_recall': 0.51724136, 'binary_specificity': 0.97999, 'binary_f1_score': 0.52325577}
confusion matrix:
      0    1
0  5877  120
1   126  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_27.png
better model found
persisted
after epoch: 27,now: 2024-07-06 18:49:01.033644,epoch time: 0:22:50.779574,used: 10:25:23.828010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98667604, 'precision': 0.9855174, 'recall': 0.97956, 'specificity': 0.97956, 'f1': 0.98249054, 'auroc': 0.9973649, 'binary_precision': 0.98317057, 'binary_recall': 0.96486104, 'binary_specificity': 0.994259, 'binary_f1_score': 0.97392976}
confusion matrix:
       0      1
0  42084    243
1    517  14196
---- Validation: 
scalar performance:
{'acc': 0.95434225, 'precision': 0.6727791, 'recall': 0.71234286, 'specificity': 0.71234286, 'f1': 0.69021416, 'auroc': 0.9003438, 'binary_precision': 0.3651192, 'binary_recall': 0.4525661, 'binary_specificity': 0.9721197, 'binary_f1_score': 0.40416667}
confusion matrix:
       0    1
0  17643  506
1    352  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.7240102, 'recall': 0.74769664, 'specificity': 0.74769664, 'f1': 0.735165, 'auroc': 0.89940894, 'binary_precision': 0.46896553, 'binary_recall': 0.5210728, 'binary_specificity': 0.9743205, 'binary_f1_score': 0.49364793}
confusion matrix:
      0    1
0  5843  154
1   125  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_28.png
early stop counter: 1
val acc:0.954342246055603, best validation acc: 0.960089385509491, corresponding to test acc:                         0.9606903195381165 / 0.9658037424087524
after epoch: 28,now: 2024-07-06 19:11:55.878775,epoch time: 0:22:54.845131,used: 10:48:18.673141,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9873948, 'precision': 0.98750746, 'recall': 0.9794715, 'specificity': 0.9794715, 'f1': 0.9834025, 'auroc': 0.99760187, 'binary_precision': 0.9877343, 'binary_recall': 0.9631014, 'binary_specificity': 0.9958416, 'binary_f1_score': 0.97526234}
confusion matrix:
       0      1
0  42148    176
1    543  14173
---- Validation: 
scalar performance:
{'acc': 0.9574287, 'precision': 0.68539536, 'recall': 0.7064402, 'specificity': 0.7064402, 'f1': 0.69527125, 'auroc': 0.90481734, 'binary_precision': 0.3908206, 'binary_recall': 0.43701398, 'binary_specificity': 0.97586644, 'binary_f1_score': 0.41262847}
confusion matrix:
       0    1
0  17711  438
1    362  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.7266443, 'recall': 0.7316225, 'specificity': 0.7316225, 'f1': 0.7291022, 'auroc': 0.8972602, 'binary_precision': 0.47565544, 'binary_recall': 0.48659003, 'binary_specificity': 0.976655, 'binary_f1_score': 0.4810606}
confusion matrix:
      0    1
0  5857  140
1   134  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_29.png
early stop counter: 2
val acc:0.9574286937713623, best validation acc: 0.960089385509491, corresponding to test acc:                         0.9606903195381165 / 0.9658037424087524
after epoch: 29,now: 2024-07-06 19:35:03.098156,epoch time: 0:23:07.219381,used: 11:11:25.892522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9873948, 'precision': 0.987756, 'recall': 0.9792252, 'specificity': 0.9792252, 'f1': 0.9833927, 'auroc': 0.99774766, 'binary_precision': 0.9884817, 'binary_recall': 0.96234876, 'binary_specificity': 0.9961017, 'binary_f1_score': 0.9752402}
confusion matrix:
       0      1
0  42161    165
1    554  14160
---- Validation: 
scalar performance:
{'acc': 0.95508724, 'precision': 0.67164433, 'recall': 0.6962274, 'specificity': 0.6962274, 'f1': 0.68298864, 'auroc': 0.8998954, 'binary_precision': 0.36400542, 'binary_recall': 0.41835147, 'binary_specificity': 0.9741033, 'binary_f1_score': 0.38929093}
confusion matrix:
       0    1
0  17679  470
1    374  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95557684, 'precision': 0.7237057, 'recall': 0.736786, 'specificity': 0.736786, 'f1': 0.730031, 'auroc': 0.89562535, 'binary_precision': 0.46931407, 'binary_recall': 0.49808428, 'binary_specificity': 0.97548777, 'binary_f1_score': 0.48327136}
confusion matrix:
      0    1
0  5850  147
1   131  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_30.png
early stop counter: 3
val acc:0.9550872445106506, best validation acc: 0.960089385509491, corresponding to test acc:                         0.9606903195381165 / 0.9658037424087524
after epoch: 30,now: 2024-07-06 19:58:04.521088,epoch time: 0:23:01.422932,used: 11:34:27.315454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_08_23_37_seed_0_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:34:27.315454 at 2024-07-06 19:58:04.521088
persisted model performance metric: 

scalar performance:
{'acc': 0.9606903, 'precision': 0.7542112, 'recall': 0.7486157, 'specificity': 0.7486157, 'f1': 0.7513778, 'auroc': 0.89919865, 'binary_precision': 0.5294118, 'binary_recall': 0.51724136, 'binary_specificity': 0.97999, 'binary_f1_score': 0.52325577}
confusion matrix:
      0    1
0  5877  120
1   126  135
oracle model performance metric: 

scalar performance:
{'acc': 0.96580374, 'precision': 0.78557944, 'recall': 0.7897627, 'specificity': 0.7897627, 'f1': 0.7876539, 'auroc': 0.9096432, 'binary_precision': 0.58867925, 'binary_recall': 0.59770113, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.5931559}
confusion matrix:
      0    1
0  5888  109
1   105  156
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB |   1195 TiB |   1195 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1179 TiB |   1179 TiB |
|       from small pool |  16482 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  57847 KiB | 732464 KiB | 687393 GiB | 687393 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 671688 GiB | 671688 GiB |
|       from small pool |   7085 KiB |  11093 KiB |  15704 GiB |  15704 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7625    |  197305 K  |  197302 K  |
|       from large pool |      79    |     762    |  112031 K  |  112031 K  |
|       from small pool |    2899    |    7544    |   85273 K  |   85270 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7625    |  197305 K  |  197302 K  |
|       from large pool |      79    |     762    |  112031 K  |  112031 K  |
|       from small pool |    2899    |    7544    |   85273 K  |   85270 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3588    |  121534 K  |  121534 K  |
|       from large pool |      10    |     350    |   86069 K  |   86069 K  |
|       from small pool |      23    |    3578    |   35464 K  |   35464 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8530 MiB |   8530 MiB |   8280 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     44 MiB |     44 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 687393 GiB | 687393 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 671688 GiB | 671688 GiB |
|       from small pool |      0 KiB |  21224 KiB |  15704 GiB |  15704 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  197305 K  |  197305 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85273 K  |   85273 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  197305 K  |  197305 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85273 K  |   85273 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     371    |     348    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      22    |      22    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3588    |  121535 K  |  121535 K  |
|       from large pool |       3    |     350    |   86069 K  |   86069 K  |
|       from small pool |       0    |    3578    |   35465 K  |   35465 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8530 MiB |   8530 MiB |   8280 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     44 MiB |     44 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 687393 GiB | 687393 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 671688 GiB | 671688 GiB |
|       from small pool |      0 KiB |  21224 KiB |  15704 GiB |  15704 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  197305 K  |  197305 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85273 K  |   85273 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  197305 K  |  197305 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85273 K  |   85273 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     371    |     348    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      22    |      22    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3588    |  121535 K  |  121535 K  |
|       from large pool |       3    |     350    |   86069 K  |   86069 K  |
|       from small pool |       0    |    3578    |   35465 K  |   35465 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435

 Experiment start at: 2024-07-06 20:05:47.047754
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92761123, 'precision': 0.93335336, 'recall': 0.8724926, 'specificity': 0.8724926, 'f1': 0.89755297, 'auroc': 0.94245505, 'binary_precision': 0.94307333, 'binary_recall': 0.76059365, 'binary_specificity': 0.98439157, 'binary_f1_score': 0.8420608}
confusion matrix:
       0      1
0  41751    662
1   3452  10967
---- Validation: 
scalar performance:
{'acc': 0.93948776, 'precision': 0.5102664, 'recall': 0.5079847, 'specificity': 0.5079847, 'f1': 0.5087038, 'auroc': 0.7481905, 'binary_precision': 0.055876687, 'binary_recall': 0.043090638, 'binary_specificity': 0.97287875, 'binary_f1_score': 0.048657715}
confusion matrix:
       0    1
0  17577  490
1    644   29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9324847, 'precision': 0.49078047, 'recall': 0.49398562, 'specificity': 0.49398562, 'f1': 0.4918875, 'auroc': 0.70924664, 'binary_precision': 0.023952097, 'binary_recall': 0.015384615, 'binary_specificity': 0.97258663, 'binary_f1_score': 0.018735362}
confusion matrix:
      0    1
0  5783  163
1   256    4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-06 20:28:52.345527,epoch time: 0:23:05.297773,used: 0:23:05.297773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95173496, 'precision': 0.95905733, 'recall': 0.9127959, 'specificity': 0.9127959, 'f1': 0.9330096, 'auroc': 0.9697745, 'binary_precision': 0.9720223, 'binary_recall': 0.8337495, 'binary_specificity': 0.9918423, 'binary_f1_score': 0.8975919}
confusion matrix:
       0      1
0  42068    346
1   2397  12021
---- Validation: 
scalar performance:
{'acc': 0.94605124, 'precision': 0.5520065, 'recall': 0.536423, 'specificity': 0.536423, 'f1': 0.5422797, 'auroc': 0.8172283, 'binary_precision': 0.13733906, 'binary_recall': 0.09509658, 'binary_specificity': 0.97774947, 'binary_f1_score': 0.112379275}
confusion matrix:
       0    1
0  17665  402
1    609   64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9329681, 'precision': 0.5050564, 'recall': 0.5034328, 'specificity': 0.5034328, 'f1': 0.50337213, 'auroc': 0.79121256, 'binary_precision': 0.05172414, 'binary_recall': 0.034615386, 'binary_specificity': 0.9722502, 'binary_f1_score': 0.04147466}
confusion matrix:
      0    1
0  5781  165
1   251    9
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-06 20:51:09.552681,epoch time: 0:22:17.207154,used: 0:45:22.504927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9599521, 'precision': 0.96808195, 'recall': 0.926061, 'specificity': 0.926061, 'f1': 0.944715, 'auroc': 0.9793377, 'binary_precision': 0.98266816, 'binary_recall': 0.8572618, 'binary_specificity': 0.9948602, 'binary_f1_score': 0.9156912}
confusion matrix:
       0      1
0  42196    218
1   2058  12360
---- Validation: 
scalar performance:
{'acc': 0.9529349, 'precision': 0.6039692, 'recall': 0.56288165, 'specificity': 0.56288165, 'f1': 0.57727206, 'auroc': 0.84553605, 'binary_precision': 0.23940149, 'binary_recall': 0.14264487, 'binary_specificity': 0.9831184, 'binary_f1_score': 0.17877094}
confusion matrix:
       0    1
0  17762  305
1    577   96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9431196, 'precision': 0.5408375, 'recall': 0.5197644, 'specificity': 0.5197644, 'f1': 0.5244916, 'auroc': 0.8423122, 'binary_precision': 0.12195122, 'binary_recall': 0.057692308, 'binary_specificity': 0.98183656, 'binary_f1_score': 0.07832898}
confusion matrix:
      0    1
0  5838  108
1   245   15
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-06 21:13:47.686138,epoch time: 0:22:38.133457,used: 1:08:00.638384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96605784, 'precision': 0.9676167, 'recall': 0.9420617, 'specificity': 0.9420617, 'f1': 0.9539528, 'auroc': 0.98432875, 'binary_precision': 0.9705417, 'binary_recall': 0.89334255, 'binary_specificity': 0.9907809, 'binary_f1_score': 0.93034345}
confusion matrix:
       0      1
0  42021    391
1   1538  12882
---- Validation: 
scalar performance:
{'acc': 0.9551761, 'precision': 0.65420866, 'recall': 0.617689, 'specificity': 0.617689, 'f1': 0.6330992, 'auroc': 0.8685219, 'binary_precision': 0.33595285, 'binary_recall': 0.25408617, 'binary_specificity': 0.98129183, 'binary_f1_score': 0.2893401}
confusion matrix:
       0    1
0  17729  338
1    502  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9465034, 'precision': 0.6150237, 'recall': 0.569344, 'specificity': 0.569344, 'f1': 0.5851982, 'auroc': 0.87305164, 'binary_precision': 0.26623377, 'binary_recall': 0.15769231, 'binary_specificity': 0.98099566, 'binary_f1_score': 0.19806764}
confusion matrix:
      0    1
0  5833  113
1   219   41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-06 21:36:15.518824,epoch time: 0:22:27.832686,used: 1:30:28.471070,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96941864, 'precision': 0.9728565, 'recall': 0.94600695, 'specificity': 0.94600695, 'f1': 0.95846844, 'auroc': 0.9884827, 'binary_precision': 0.9792895, 'binary_recall': 0.89847434, 'binary_specificity': 0.9935396, 'binary_f1_score': 0.9371429}
confusion matrix:
       0      1
0  42138    274
1   1464  12956
---- Validation: 
scalar performance:
{'acc': 0.9576841, 'precision': 0.66126287, 'recall': 0.598247, 'specificity': 0.598247, 'f1': 0.6209558, 'auroc': 0.8700309, 'binary_precision': 0.35148516, 'binary_recall': 0.21099554, 'binary_specificity': 0.9854984, 'binary_f1_score': 0.26369548}
confusion matrix:
       0    1
0  17805  262
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94956493, 'precision': 0.62732744, 'recall': 0.56358576, 'specificity': 0.56358576, 'f1': 0.58259267, 'auroc': 0.8773615, 'binary_precision': 0.2913386, 'binary_recall': 0.1423077, 'binary_specificity': 0.98486376, 'binary_f1_score': 0.19121447}
confusion matrix:
      0   1
0  5856  90
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-06 21:58:59.279822,epoch time: 0:22:43.760998,used: 1:53:12.232068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9729554, 'precision': 0.9745083, 'recall': 0.95366013, 'specificity': 0.95366013, 'f1': 0.9635025, 'auroc': 0.9895605, 'binary_precision': 0.9774648, 'binary_recall': 0.91448784, 'binary_specificity': 0.99283236, 'binary_f1_score': 0.94492817}
confusion matrix:
       0      1
0  42109    304
1   1233  13186
---- Validation: 
scalar performance:
{'acc': 0.9603522, 'precision': 0.6945164, 'recall': 0.62251925, 'specificity': 0.62251925, 'f1': 0.64927757, 'auroc': 0.8783237, 'binary_precision': 0.41626793, 'binary_recall': 0.25854382, 'binary_specificity': 0.9864947, 'binary_f1_score': 0.31897342}
confusion matrix:
       0    1
0  17823  244
1    499  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.70706075, 'recall': 0.59461826, 'specificity': 0.59461826, 'f1': 0.6269984, 'auroc': 0.88836837, 'binary_precision': 0.44827586, 'binary_recall': 0.2, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.27659577}
confusion matrix:
      0   1
0  5882  64
1   208  52
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-06 22:23:00.349350,epoch time: 0:24:01.069528,used: 2:17:13.301596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97390556, 'precision': 0.9752567, 'recall': 0.9554411, 'specificity': 0.9554411, 'f1': 0.96482384, 'auroc': 0.9908016, 'binary_precision': 0.9778369, 'binary_recall': 0.91795546, 'binary_specificity': 0.9929267, 'binary_f1_score': 0.94695044}
confusion matrix:
       0      1
0  42113    300
1   1183  13236
---- Validation: 
scalar performance:
{'acc': 0.95987195, 'precision': 0.69659835, 'recall': 0.6437282, 'specificity': 0.6437282, 'f1': 0.66550964, 'auroc': 0.88261104, 'binary_precision': 0.41889116, 'binary_recall': 0.30312034, 'binary_specificity': 0.9843361, 'binary_f1_score': 0.35172412}
confusion matrix:
       0    1
0  17784  283
1    469  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.73441625, 'recall': 0.6305681, 'specificity': 0.6305681, 'f1': 0.6657926, 'auroc': 0.8956735, 'binary_precision': 0.5, 'binary_recall': 0.27307692, 'binary_specificity': 0.9880592, 'binary_f1_score': 0.35323384}
confusion matrix:
      0   1
0  5875  71
1   189  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_7.png
new oracle model saved
early stop counter: 1
val acc:0.9598719477653503, best validation acc: 0.9603521823883057, corresponding to test acc:                         0.956171452999115 / 0.9581050872802734
after epoch: 7,now: 2024-07-06 22:45:49.244917,epoch time: 0:22:48.895567,used: 2:40:02.197163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9749613, 'precision': 0.9736415, 'recall': 0.9597899, 'specificity': 0.9597899, 'f1': 0.9664563, 'auroc': 0.9928622, 'binary_precision': 0.9710765, 'binary_recall': 0.9289875, 'binary_specificity': 0.9905923, 'binary_f1_score': 0.9495658}
confusion matrix:
       0      1
0  42013    399
1   1024  13396
---- Validation: 
scalar performance:
{'acc': 0.9601921, 'precision': 0.70011795, 'recall': 0.6474706, 'specificity': 0.6474706, 'f1': 0.6692823, 'auroc': 0.88257146, 'binary_precision': 0.42566192, 'binary_recall': 0.31054977, 'binary_specificity': 0.98439145, 'binary_f1_score': 0.35910654}
confusion matrix:
       0    1
0  17785  282
1    464  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7341845, 'recall': 0.6250511, 'specificity': 0.6250511, 'f1': 0.6608982, 'auroc': 0.89597404, 'binary_precision': 0.5, 'binary_recall': 0.26153848, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.34343433}
confusion matrix:
      0   1
0  5878  68
1   192  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_8.png
early stop counter: 2
val acc:0.960192084312439, best validation acc: 0.9603521823883057, corresponding to test acc:                         0.956171452999115 / 0.9581050872802734
after epoch: 8,now: 2024-07-06 23:08:49.033498,epoch time: 0:22:59.788581,used: 3:03:01.985744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9767736, 'precision': 0.9778505, 'recall': 0.9604983, 'specificity': 0.9604983, 'f1': 0.96877354, 'auroc': 0.9931253, 'binary_precision': 0.97992235, 'binary_recall': 0.92745686, 'binary_specificity': 0.9935397, 'binary_f1_score': 0.95296806}
confusion matrix:
       0      1
0  42139    274
1   1046  13373
---- Validation: 
scalar performance:
{'acc': 0.9625934, 'precision': 0.7201028, 'recall': 0.63798696, 'specificity': 0.63798696, 'f1': 0.66851354, 'auroc': 0.88544226, 'binary_precision': 0.46634614, 'binary_recall': 0.2882615, 'binary_specificity': 0.9877124, 'binary_f1_score': 0.35629013}
confusion matrix:
       0    1
0  17845  222
1    479  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.7710314, 'recall': 0.6228027, 'specificity': 0.6228027, 'f1': 0.66590613, 'auroc': 0.90340626, 'binary_precision': 0.57391304, 'binary_recall': 0.25384617, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.35200003}
confusion matrix:
      0   1
0  5897  49
1   194  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-06 23:31:34.662547,epoch time: 0:22:45.629049,used: 3:25:47.614793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97793496, 'precision': 0.9765822, 'recall': 0.964801, 'specificity': 0.964801, 'f1': 0.970505, 'auroc': 0.9944887, 'binary_precision': 0.9739362, 'binary_recall': 0.9381372, 'binary_specificity': 0.99146485, 'binary_f1_score': 0.95570153}
confusion matrix:
       0      1
0  42051    362
1    892  13527
---- Validation: 
scalar performance:
{'acc': 0.96254003, 'precision': 0.72119653, 'recall': 0.6494036, 'specificity': 0.6494036, 'f1': 0.6775118, 'auroc': 0.8893739, 'binary_precision': 0.46770602, 'binary_recall': 0.31203565, 'binary_specificity': 0.98677146, 'binary_f1_score': 0.37433156}
confusion matrix:
       0    1
0  17828  239
1    463  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.79828334, 'recall': 0.63860774, 'specificity': 0.63860774, 'f1': 0.68621093, 'auroc': 0.906147, 'binary_precision': 0.62711865, 'binary_recall': 0.2846154, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.39153442}
confusion matrix:
      0   1
0  5902  44
1   186  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_10.png
new oracle model saved
early stop counter: 1
val acc:0.9625400304794312, best validation acc: 0.9625933766365051, corresponding to test acc:                         0.9608443379402161 / 0.9629390835762024
after epoch: 10,now: 2024-07-06 23:54:01.307418,epoch time: 0:22:26.644871,used: 3:48:14.259664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97760063, 'precision': 0.9804727, 'recall': 0.96020806, 'specificity': 0.96020806, 'f1': 0.96979916, 'auroc': 0.9945667, 'binary_precision': 0.98595405, 'binary_recall': 0.924896, 'binary_specificity': 0.9955201, 'binary_f1_score': 0.9544495}
confusion matrix:
       0      1
0  42222    190
1   1083  13337
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.7338073, 'recall': 0.63933873, 'specificity': 0.63933873, 'f1': 0.67327416, 'auroc': 0.8926614, 'binary_precision': 0.49367088, 'binary_recall': 0.2897474, 'binary_specificity': 0.9889301, 'binary_f1_score': 0.3651685}
confusion matrix:
       0    1
0  17867  200
1    478  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.83754146, 'recall': 0.6359388, 'specificity': 0.6359388, 'f1': 0.6898494, 'auroc': 0.91237545, 'binary_precision': 0.7058824, 'binary_recall': 0.2769231, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.39779007}
confusion matrix:
      0   1
0  5916  30
1   188  72
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-07 00:16:17.116601,epoch time: 0:22:15.809183,used: 4:10:30.068847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9797825, 'precision': 0.9814235, 'recall': 0.96498823, 'specificity': 0.96498823, 'f1': 0.97284937, 'auroc': 0.9953402, 'binary_precision': 0.98459065, 'binary_recall': 0.9349515, 'binary_specificity': 0.995025, 'binary_f1_score': 0.9591293}
confusion matrix:
       0      1
0  42201    211
1    938  13482
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.7339229, 'recall': 0.6514706, 'specificity': 0.6514706, 'f1': 0.68287027, 'auroc': 0.8911735, 'binary_precision': 0.49302325, 'binary_recall': 0.31500742, 'binary_specificity': 0.9879338, 'binary_f1_score': 0.38440615}
confusion matrix:
       0    1
0  17849  218
1    461  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8475092, 'recall': 0.63995314, 'specificity': 0.63995314, 'f1': 0.6955402, 'auroc': 0.908618, 'binary_precision': 0.7254902, 'binary_recall': 0.2846154, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.4088398}
confusion matrix:
      0   1
0  5918  28
1   186  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_12.png
new oracle model saved
early stop counter: 1
val acc:0.9637673497200012, best validation acc: 0.9638206958770752, corresponding to test acc:                         0.9648727178573608 / 0.9655172228813171
after epoch: 12,now: 2024-07-07 00:38:38.051293,epoch time: 0:22:20.934692,used: 4:32:51.003539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98133093, 'precision': 0.981004, 'recall': 0.96945477, 'specificity': 0.96945477, 'f1': 0.97505224, 'auroc': 0.9958606, 'binary_precision': 0.98036397, 'binary_recall': 0.9453461, 'binary_specificity': 0.9935635, 'binary_f1_score': 0.96253663}
confusion matrix:
       0      1
0  42141    273
1    788  13630
---- Validation: 
scalar performance:
{'acc': 0.96254003, 'precision': 0.723465, 'recall': 0.66728526, 'specificity': 0.66728526, 'f1': 0.69084466, 'auroc': 0.8937768, 'binary_precision': 0.47094187, 'binary_recall': 0.34918275, 'binary_specificity': 0.98538774, 'binary_f1_score': 0.40102386}
confusion matrix:
       0    1
0  17803  264
1    438  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8312918, 'recall': 0.65650403, 'specificity': 0.65650403, 'f1': 0.7095281, 'auroc': 0.9084976, 'binary_precision': 0.69166666, 'binary_recall': 0.31923077, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.4368421}
confusion matrix:
      0   1
0  5909  37
1   177  83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_13.png
early stop counter: 2
val acc:0.9625400304794312, best validation acc: 0.9638206958770752, corresponding to test acc:                         0.9648727178573608 / 0.9655172228813171
after epoch: 13,now: 2024-07-07 01:00:56.069997,epoch time: 0:22:18.018704,used: 4:55:09.022243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98152447, 'precision': 0.9829887, 'recall': 0.96805274, 'specificity': 0.96805274, 'f1': 0.9752271, 'auroc': 0.995883, 'binary_precision': 0.98582745, 'binary_recall': 0.9407032, 'binary_specificity': 0.99540234, 'binary_f1_score': 0.9627369}
confusion matrix:
       0      1
0  42218    195
1    855  13564
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.73982847, 'recall': 0.6531779, 'specificity': 0.6531779, 'f1': 0.68588364, 'auroc': 0.8955486, 'binary_precision': 0.504717, 'binary_recall': 0.3179792, 'binary_specificity': 0.9883766, 'binary_f1_score': 0.39015496}
confusion matrix:
       0    1
0  17857  210
1    459  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.86008686, 'recall': 0.6478137, 'specificity': 0.6478137, 'f1': 0.70565355, 'auroc': 0.91442335, 'binary_precision': 0.75, 'binary_recall': 0.3, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.42857146}
confusion matrix:
      0   1
0  5920  26
1   182  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_14.png
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-07 01:23:26.903420,epoch time: 0:22:30.833423,used: 5:17:39.855666,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9823867, 'precision': 0.982152, 'recall': 0.9711252, 'specificity': 0.9711252, 'f1': 0.97647744, 'auroc': 0.9961279, 'binary_precision': 0.98169154, 'binary_recall': 0.9482627, 'binary_specificity': 0.9939877, 'binary_f1_score': 0.9646876}
confusion matrix:
       0      1
0  42158    255
1    746  13673
---- Validation: 
scalar performance:
{'acc': 0.9627001, 'precision': 0.7263205, 'recall': 0.68095833, 'specificity': 0.68095833, 'f1': 0.7008038, 'auroc': 0.89765596, 'binary_precision': 0.47565544, 'binary_recall': 0.37741455, 'binary_specificity': 0.98450214, 'binary_f1_score': 0.42087817}
confusion matrix:
       0    1
0  17787  280
1    419  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.8599591, 'recall': 0.68944865, 'specificity': 0.68944865, 'f1': 0.7457359, 'auroc': 0.91238713, 'binary_precision': 0.74626863, 'binary_recall': 0.3846154, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.5076142}
confusion matrix:
      0    1
0  5912   34
1   160  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_15.png
new oracle model saved
early stop counter: 1
val acc:0.9627001285552979, best validation acc: 0.9643009901046753, corresponding to test acc:                         0.9664840698242188 / 0.968739926815033
after epoch: 15,now: 2024-07-07 01:45:47.397591,epoch time: 0:22:20.494171,used: 5:40:00.349837,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98321366, 'precision': 0.9836818, 'recall': 0.9718183, 'specificity': 0.9718183, 'f1': 0.97756445, 'auroc': 0.9961855, 'binary_precision': 0.9845977, 'binary_recall': 0.94868237, 'binary_specificity': 0.9949543, 'binary_f1_score': 0.96630645}
confusion matrix:
       0      1
0  42198    214
1    740  13680
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.7280881, 'recall': 0.6654162, 'specificity': 0.6654162, 'f1': 0.69116664, 'auroc': 0.8966603, 'binary_precision': 0.48033127, 'binary_recall': 0.3447251, 'binary_specificity': 0.9861073, 'binary_f1_score': 0.40138406}
confusion matrix:
       0    1
0  17816  251
1    441  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.82699686, 'recall': 0.658259, 'specificity': 0.658259, 'f1': 0.7103845, 'auroc': 0.91006553, 'binary_precision': 0.68292683, 'binary_recall': 0.32307693, 'binary_specificity': 0.993441, 'binary_f1_score': 0.43864232}
confusion matrix:
      0   1
0  5907  39
1   176  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_16.png
early stop counter: 2
val acc:0.9630736112594604, best validation acc: 0.9643009901046753, corresponding to test acc:                         0.9664840698242188 / 0.968739926815033
after epoch: 16,now: 2024-07-07 02:08:10.240438,epoch time: 0:22:22.842847,used: 6:02:23.192684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9820524, 'precision': 0.9835627, 'recall': 0.9688871, 'specificity': 0.9688871, 'f1': 0.9759418, 'auroc': 0.99604654, 'binary_precision': 0.98649335, 'binary_recall': 0.94215965, 'binary_specificity': 0.9956145, 'binary_f1_score': 0.96381694}
confusion matrix:
       0      1
0  42227    186
1    834  13585
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.7354742, 'recall': 0.67936605, 'specificity': 0.67936605, 'f1': 0.7031789, 'auroc': 0.9031525, 'binary_precision': 0.4940945, 'binary_recall': 0.3729569, 'binary_specificity': 0.9857752, 'binary_f1_score': 0.42506352}
confusion matrix:
       0    1
0  17810  257
1    422  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692233, 'precision': 0.85956216, 'recall': 0.6988958, 'specificity': 0.6988958, 'f1': 0.7538944, 'auroc': 0.91842914, 'binary_precision': 0.7446808, 'binary_recall': 0.40384614, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.5236908}
confusion matrix:
      0    1
0  5910   36
1   155  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_17.png
new oracle model saved
early stop counter: 3
val acc:0.9637673497200012, best validation acc: 0.9643009901046753, corresponding to test acc:                         0.9664840698242188 / 0.9692233204841614
after epoch: 17,now: 2024-07-07 02:30:19.086844,epoch time: 0:22:08.846406,used: 6:24:32.039090,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98349524, 'precision': 0.98394424, 'recall': 0.9723028, 'specificity': 0.9723028, 'f1': 0.97794485, 'auroc': 0.99624676, 'binary_precision': 0.9848234, 'binary_recall': 0.94958043, 'binary_specificity': 0.9950251, 'binary_f1_score': 0.96688086}
confusion matrix:
       0      1
0  42202    211
1    727  13692
---- Validation: 
scalar performance:
{'acc': 0.96221983, 'precision': 0.7232078, 'recall': 0.6878619, 'specificity': 0.6878619, 'f1': 0.7038251, 'auroc': 0.9006443, 'binary_precision': 0.4689165, 'binary_recall': 0.3922734, 'binary_specificity': 0.9834505, 'binary_f1_score': 0.42718443}
confusion matrix:
       0    1
0  17768  299
1    409  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.84539765, 'recall': 0.7003144, 'specificity': 0.7003144, 'f1': 0.75164, 'auroc': 0.91146344, 'binary_precision': 0.7162162, 'binary_recall': 0.4076923, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.51960784}
confusion matrix:
      0    1
0  5904   42
1   154  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_18.png
early stop counter: 4
val acc:0.9622198343276978, best validation acc: 0.9643009901046753, corresponding to test acc:                         0.9664840698242188 / 0.9692233204841614
after epoch: 18,now: 2024-07-07 02:52:34.254786,epoch time: 0:22:15.167942,used: 6:46:47.207032,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9838647, 'precision': 0.9844086, 'recall': 0.97282493, 'specificity': 0.97282493, 'f1': 0.97844017, 'auroc': 0.9970636, 'binary_precision': 0.9854739, 'binary_recall': 0.95041263, 'binary_specificity': 0.9952373, 'binary_f1_score': 0.96762574}
confusion matrix:
       0      1
0  42211    202
1    715  13704
---- Validation: 
scalar performance:
{'acc': 0.96013874, 'precision': 0.7094889, 'recall': 0.69536585, 'specificity': 0.69536585, 'f1': 0.702148, 'auroc': 0.9006392, 'binary_precision': 0.44089457, 'binary_recall': 0.410104, 'binary_specificity': 0.98062766, 'binary_f1_score': 0.42494226}
confusion matrix:
       0    1
0  17717  350
1    397  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.81175745, 'recall': 0.71401715, 'specificity': 0.71401715, 'f1': 0.7527839, 'auroc': 0.9101558, 'binary_precision': 0.64772725, 'binary_recall': 0.43846154, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.5229358}
confusion matrix:
      0    1
0  5884   62
1   146  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_19.png
early stop counter: 5
val acc:0.960138738155365, best validation acc: 0.9643009901046753, corresponding to test acc:                         0.9664840698242188 / 0.9692233204841614
after epoch: 19,now: 2024-07-07 03:14:42.198090,epoch time: 0:22:07.943304,used: 7:08:55.150336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9840231, 'precision': 0.9847061, 'recall': 0.9729556, 'specificity': 0.9729556, 'f1': 0.97864926, 'auroc': 0.9970267, 'binary_precision': 0.98604316, 'binary_recall': 0.9504854, 'binary_specificity': 0.9954258, 'binary_f1_score': 0.9679378}
confusion matrix:
       0      1
0  42218    194
1    714  13706
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.73960197, 'recall': 0.66745555, 'specificity': 0.66745555, 'f1': 0.6964059, 'auroc': 0.8979621, 'binary_precision': 0.5032258, 'binary_recall': 0.34769687, 'binary_specificity': 0.98721427, 'binary_f1_score': 0.41124776}
confusion matrix:
       0    1
0  17836  231
1    439  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.83581084, 'recall': 0.65474916, 'specificity': 0.65474916, 'f1': 0.70865744, 'auroc': 0.91016185, 'binary_precision': 0.7008547, 'binary_recall': 0.31538463, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.43501326}
confusion matrix:
      0   1
0  5911  35
1   178  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_20.png
early stop counter: 6
val acc:0.9642475843429565, best validation acc: 0.9643009901046753, corresponding to test acc:                         0.9664840698242188 / 0.9692233204841614
after epoch: 20,now: 2024-07-07 03:37:09.889069,epoch time: 0:22:27.690979,used: 7:31:22.841315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98370636, 'precision': 0.98350215, 'recall': 0.97329104, 'specificity': 0.97329104, 'f1': 0.97825885, 'auroc': 0.99661344, 'binary_precision': 0.9831006, 'binary_recall': 0.9521465, 'binary_specificity': 0.99443567, 'binary_f1_score': 0.967376}
confusion matrix:
       0      1
0  42177    236
1    690  13729
---- Validation: 
scalar performance:
{'acc': 0.9628068, 'precision': 0.7265136, 'recall': 0.673861, 'specificity': 0.673861, 'f1': 0.6963053, 'auroc': 0.8970101, 'binary_precision': 0.4765625, 'binary_recall': 0.3625557, 'binary_specificity': 0.9851663, 'binary_f1_score': 0.41181433}
confusion matrix:
       0    1
0  17799  268
1    429  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.81708986, 'recall': 0.67297083, 'specificity': 0.67297083, 'f1': 0.7216278, 'auroc': 0.90694976, 'binary_precision': 0.6618705, 'binary_recall': 0.35384616, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.46115288}
confusion matrix:
      0   1
0  5899  47
1   168  92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_21.png
early stop counter: 7
val acc:0.9628068208694458, best validation acc: 0.9643009901046753, corresponding to test acc:                         0.9664840698242188 / 0.9692233204841614
after epoch: 21,now: 2024-07-07 03:59:38.173525,epoch time: 0:22:28.284456,used: 7:53:51.125771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9843926, 'precision': 0.9848153, 'recall': 0.9738195, 'specificity': 0.9738195, 'f1': 0.9791583, 'auroc': 0.9969198, 'binary_precision': 0.9856446, 'binary_recall': 0.95235455, 'binary_specificity': 0.99528444, 'binary_f1_score': 0.96871364}
confusion matrix:
       0      1
0  42213    200
1    687  13732
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.7313578, 'recall': 0.6549086, 'specificity': 0.6549086, 'f1': 0.6846912, 'auroc': 0.894542, 'binary_precision': 0.48764044, 'binary_recall': 0.32243684, 'binary_specificity': 0.9873803, 'binary_f1_score': 0.38819316}
confusion matrix:
       0    1
0  17839  228
1    456  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.80647075, 'recall': 0.63886, 'specificity': 0.63886, 'f1': 0.6879041, 'auroc': 0.9049568, 'binary_precision': 0.6434783, 'binary_recall': 0.2846154, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.39466667}
confusion matrix:
      0   1
0  5905  41
1   186  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_22.png
early stop counter: 8
val acc:0.9635005593299866, best validation acc: 0.9643009901046753, corresponding to test acc:                         0.9664840698242188 / 0.9692233204841614
after epoch: 22,now: 2024-07-07 04:21:55.274822,epoch time: 0:22:17.101297,used: 8:16:08.227068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9843046, 'precision': 0.9856839, 'recall': 0.9727535, 'specificity': 0.9727535, 'f1': 0.97899973, 'auroc': 0.99687165, 'binary_precision': 0.9883746, 'binary_recall': 0.94930303, 'binary_specificity': 0.996204, 'binary_f1_score': 0.9684449}
confusion matrix:
       0      1
0  42252    161
1    731  13688
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.7422229, 'recall': 0.63755274, 'specificity': 0.63755274, 'f1': 0.6739046, 'auroc': 0.8973094, 'binary_precision': 0.5106383, 'binary_recall': 0.28528973, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.3660629}
confusion matrix:
       0    1
0  17883  184
1    481  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.8225842, 'recall': 0.6223932, 'specificity': 0.6223932, 'f1': 0.67321134, 'auroc': 0.90732974, 'binary_precision': 0.6770833, 'binary_recall': 0.25, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.36516854}
confusion matrix:
      0   1
0  5915  31
1   195  65
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_23.png
better model found
persisted
after epoch: 23,now: 2024-07-07 04:44:05.461494,epoch time: 0:22:10.186672,used: 8:38:18.413740,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9842342, 'precision': 0.9867298, 'recall': 0.97158486, 'specificity': 0.97158486, 'f1': 0.9788585, 'auroc': 0.99679756, 'binary_precision': 0.9915667, 'binary_recall': 0.94590473, 'binary_specificity': 0.997265, 'binary_f1_score': 0.9681977}
confusion matrix:
       0      1
0  42297    116
1    780  13639
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.74284333, 'recall': 0.65331626, 'specificity': 0.65331626, 'f1': 0.6868468, 'auroc': 0.9025636, 'binary_precision': 0.51073986, 'binary_recall': 0.3179792, 'binary_specificity': 0.98865336, 'binary_f1_score': 0.3919414}
confusion matrix:
       0    1
0  17862  205
1    459  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.8501042, 'recall': 0.67214096, 'specificity': 0.67214096, 'f1': 0.7279243, 'auroc': 0.9125067, 'binary_precision': 0.728, 'binary_recall': 0.35, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.47272727}
confusion matrix:
      0   1
0  5912  34
1   169  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_24.png
better model found
persisted
after epoch: 24,now: 2024-07-07 05:06:18.669010,epoch time: 0:22:13.207516,used: 9:00:31.621256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98580027, 'precision': 0.98615026, 'recall': 0.97622883, 'specificity': 0.97622883, 'f1': 0.98106027, 'auroc': 0.9974926, 'binary_precision': 0.9868393, 'binary_recall': 0.9567961, 'binary_specificity': 0.9956616, 'binary_f1_score': 0.97158545}
confusion matrix:
       0      1
0  42228    184
1    623  13797
---- Validation: 
scalar performance:
{'acc': 0.96221983, 'precision': 0.7254236, 'recall': 0.7086047, 'specificity': 0.7086047, 'f1': 0.7166469, 'auroc': 0.906756, 'binary_precision': 0.47181964, 'binary_recall': 0.43536404, 'binary_specificity': 0.9818454, 'binary_f1_score': 0.45285934}
confusion matrix:
       0    1
0  17739  328
1    380  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.8263767, 'recall': 0.724053, 'specificity': 0.724053, 'f1': 0.7646693, 'auroc': 0.91759974, 'binary_precision': 0.6761364, 'binary_recall': 0.4576923, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.54587156}
confusion matrix:
      0    1
0  5889   57
1   141  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_25.png
early stop counter: 1
val acc:0.9622198343276978, best validation acc: 0.9645677804946899, corresponding to test acc:                         0.9672897458076477 / 0.9692233204841614
after epoch: 25,now: 2024-07-07 05:28:34.094021,epoch time: 0:22:15.425011,used: 9:22:47.046267,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98518443, 'precision': 0.98565996, 'recall': 0.97507936, 'specificity': 0.97507936, 'f1': 0.9802226, 'auroc': 0.9972783, 'binary_precision': 0.986594, 'binary_recall': 0.95456755, 'binary_specificity': 0.99559116, 'binary_f1_score': 0.9703165}
confusion matrix:
       0      1
0  42228    187
1    655  13762
---- Validation: 
scalar performance:
{'acc': 0.9632337, 'precision': 0.7297722, 'recall': 0.66764504, 'specificity': 0.66764504, 'f1': 0.69327617, 'auroc': 0.90089893, 'binary_precision': 0.4835391, 'binary_recall': 0.34918275, 'binary_specificity': 0.9861073, 'binary_f1_score': 0.40552202}
confusion matrix:
       0    1
0  17816  251
1    438  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.83358914, 'recall': 0.66787434, 'specificity': 0.66787434, 'f1': 0.7206489, 'auroc': 0.91170526, 'binary_precision': 0.6953125, 'binary_recall': 0.3423077, 'binary_specificity': 0.993441, 'binary_f1_score': 0.45876288}
confusion matrix:
      0   1
0  5907  39
1   171  89
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_26.png
early stop counter: 2
val acc:0.9632337093353271, best validation acc: 0.9645677804946899, corresponding to test acc:                         0.9672897458076477 / 0.9692233204841614
after epoch: 26,now: 2024-07-07 05:50:48.404973,epoch time: 0:22:14.310952,used: 9:45:01.357219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9856947, 'precision': 0.98378116, 'recall': 0.9783081, 'specificity': 0.9783081, 'f1': 0.98100483, 'auroc': 0.99695647, 'binary_precision': 0.9799633, 'binary_recall': 0.96331227, 'binary_specificity': 0.99330395, 'binary_f1_score': 0.97156644}
confusion matrix:
       0      1
0  42129    284
1    529  13890
---- Validation: 
scalar performance:
{'acc': 0.9607257, 'precision': 0.71660435, 'recall': 0.71784353, 'specificity': 0.71784353, 'f1': 0.717222, 'auroc': 0.9036565, 'binary_precision': 0.45347118, 'binary_recall': 0.45616642, 'binary_specificity': 0.9795207, 'binary_f1_score': 0.45481482}
confusion matrix:
       0    1
0  17697  370
1    366  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.8179562, 'recall': 0.73868084, 'specificity': 0.73868084, 'f1': 0.7720331, 'auroc': 0.9154583, 'binary_precision': 0.6580311, 'binary_recall': 0.48846152, 'binary_specificity': 0.9889001, 'binary_f1_score': 0.56070644}
confusion matrix:
      0    1
0  5880   66
1   133  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_27.png
early stop counter: 3
val acc:0.960725724697113, best validation acc: 0.9645677804946899, corresponding to test acc:                         0.9672897458076477 / 0.9692233204841614
after epoch: 27,now: 2024-07-07 06:13:00.451003,epoch time: 0:22:12.046030,used: 10:07:13.403249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98609936, 'precision': 0.9876356, 'recall': 0.97558254, 'specificity': 0.97558254, 'f1': 0.98141956, 'auroc': 0.9978804, 'binary_precision': 0.99064076, 'binary_recall': 0.95423025, 'binary_specificity': 0.99693483, 'binary_f1_score': 0.9720947}
confusion matrix:
       0      1
0  42282    130
1    660  13760
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.74120235, 'recall': 0.6653928, 'specificity': 0.6653928, 'f1': 0.6954314, 'auroc': 0.9019814, 'binary_precision': 0.5065789, 'binary_recall': 0.34323922, 'binary_specificity': 0.9875464, 'binary_f1_score': 0.40921167}
confusion matrix:
       0    1
0  17842  225
1    442  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.8624608, 'recall': 0.64597464, 'specificity': 0.64597464, 'f1': 0.70407647, 'auroc': 0.91286254, 'binary_precision': 0.75490195, 'binary_recall': 0.29615384, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.42541435}
confusion matrix:
      0   1
0  5921  25
1   183  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_28.png
early stop counter: 4
val acc:0.9644076824188232, best validation acc: 0.9645677804946899, corresponding to test acc:                         0.9672897458076477 / 0.9692233204841614
after epoch: 28,now: 2024-07-07 06:35:14.386939,epoch time: 0:22:13.935936,used: 10:29:27.339185,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9871727, 'precision': 0.98755205, 'recall': 0.97847444, 'specificity': 0.97847444, 'f1': 0.9829054, 'auroc': 0.99773204, 'binary_precision': 0.98830074, 'binary_recall': 0.9608156, 'binary_specificity': 0.99613327, 'binary_f1_score': 0.9743644}
confusion matrix:
       0      1
0  42249    164
1    565  13854
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.7343783, 'recall': 0.65933853, 'specificity': 0.65933853, 'f1': 0.6888838, 'auroc': 0.9025475, 'binary_precision': 0.49336284, 'binary_recall': 0.33135214, 'binary_specificity': 0.98732495, 'binary_f1_score': 0.39644444}
confusion matrix:
       0    1
0  17838  229
1    450  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.8124795, 'recall': 0.64279026, 'specificity': 0.64279026, 'f1': 0.6928222, 'auroc': 0.910411, 'binary_precision': 0.6551724, 'binary_recall': 0.2923077, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.40425533}
confusion matrix:
      0   1
0  5906  40
1   184  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_29.png
early stop counter: 5
val acc:0.9637673497200012, best validation acc: 0.9645677804946899, corresponding to test acc:                         0.9672897458076477 / 0.9692233204841614
after epoch: 29,now: 2024-07-07 06:57:31.039537,epoch time: 0:22:16.652598,used: 10:51:43.991783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98738384, 'precision': 0.9878361, 'recall': 0.9787532, 'specificity': 0.9787532, 'f1': 0.9831868, 'auroc': 0.997743, 'binary_precision': 0.98872876, 'binary_recall': 0.9612317, 'binary_specificity': 0.9962747, 'binary_f1_score': 0.97478634}
confusion matrix:
       0      1
0  42255    158
1    559  13860
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.7327504, 'recall': 0.6670958, 'specificity': 0.6670958, 'f1': 0.6939013, 'auroc': 0.9030984, 'binary_precision': 0.48953974, 'binary_recall': 0.34769687, 'binary_specificity': 0.9864947, 'binary_f1_score': 0.40660292}
confusion matrix:
       0    1
0  17823  244
1    439  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.82266146, 'recall': 0.6412035, 'specificity': 0.6412035, 'f1': 0.69297934, 'auroc': 0.9078891, 'binary_precision': 0.6756757, 'binary_recall': 0.28846154, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.40431267}
confusion matrix:
      0   1
0  5910  36
1   185  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_30.png
early stop counter: 6
val acc:0.9635539054870605, best validation acc: 0.9645677804946899, corresponding to test acc:                         0.9672897458076477 / 0.9692233204841614
after epoch: 30,now: 2024-07-07 07:19:43.839810,epoch time: 0:22:12.800273,used: 11:13:56.792056,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_20_05_47_seed_1_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:13:56.792056 at 2024-07-07 07:19:43.839810
persisted model performance metric: 

scalar performance:
{'acc': 0.96728975, 'precision': 0.8501042, 'recall': 0.67214096, 'specificity': 0.67214096, 'f1': 0.7279243, 'auroc': 0.9125067, 'binary_precision': 0.728, 'binary_recall': 0.35, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.47272727}
confusion matrix:
      0   1
0  5912  34
1   169  91
oracle model performance metric: 

scalar performance:
{'acc': 0.9692233, 'precision': 0.85956216, 'recall': 0.6988958, 'specificity': 0.6988958, 'f1': 0.7538944, 'auroc': 0.91842914, 'binary_precision': 0.7446808, 'binary_recall': 0.40384614, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.5236908}
confusion matrix:
      0    1
0  5910   36
1   155  105
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |  17479 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |  17479 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   7827 MiB |   2381 TiB |   2381 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   2350 TiB |   2350 TiB |
|       from small pool |  16480 KiB |     36 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  16792 MiB |   8280 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  16734 MiB |   8260 MiB |
|       from small pool |     38 MiB |     44 MiB |     58 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40878 KiB | 732464 KiB |   1320 TiB |   1320 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1289 TiB |   1289 TiB |
|       from small pool |   9145 KiB |  21224 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7625    |  393257 K  |  393255 K  |
|       from large pool |      79    |     762    |  223190 K  |  223190 K  |
|       from small pool |    2875    |    7544    |  170067 K  |  170064 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7625    |  393257 K  |  393255 K  |
|       from large pool |      79    |     762    |  223190 K  |  223190 K  |
|       from small pool |    2875    |    7544    |  170067 K  |  170064 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |     716    |     348    |
|       from large pool |     349    |     349    |     687    |     338    |
|       from small pool |      19    |      22    |      29    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3588    |  232288 K  |  232288 K  |
|       from large pool |      11    |     352    |  160864 K  |  160864 K  |
|       from small pool |      26    |    3578    |   71424 K  |   71424 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     36 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  16792 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  26624 KiB |     44 MiB |     58 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1320 TiB |   1320 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1289 TiB |   1289 TiB |
|       from small pool |      0 KiB |  23284 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  393257 K  |  393257 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170067 K  |  170067 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  393257 K  |  393257 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170067 K  |  170067 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     716    |     693    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      13    |      22    |      29    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3588    |  232290 K  |  232290 K  |
|       from large pool |       3    |     352    |  160864 K  |  160864 K  |
|       from small pool |       0    |    3578    |   71425 K  |   71425 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     36 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  16792 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  26624 KiB |     44 MiB |     58 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1320 TiB |   1320 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1289 TiB |   1289 TiB |
|       from small pool |      0 KiB |  23284 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  393257 K  |  393257 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170067 K  |  170067 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  393257 K  |  393257 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170067 K  |  170067 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     716    |     693    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      13    |      22    |      29    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3588    |  232290 K  |  232290 K  |
|       from large pool |       3    |     352    |  160864 K  |  160864 K  |
|       from small pool |       0    |    3578    |   71425 K  |   71425 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435

 Experiment start at: 2024-07-07 07:27:44.316653
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9450731, 'precision': 0.9500865, 'recall': 0.9070042, 'specificity': 0.9070042, 'f1': 0.925799, 'auroc': 0.96963674, 'binary_precision': 0.95926666, 'binary_recall': 0.8265583, 'binary_specificity': 0.98745006, 'binary_f1_score': 0.88798153}
confusion matrix:
       0      1
0  41780    531
1   2624  12505
---- Validation: 
scalar performance:
{'acc': 0.9559474, 'precision': 0.6153202, 'recall': 0.58937156, 'specificity': 0.58937156, 'f1': 0.6004024, 'auroc': 0.7890636, 'binary_precision': 0.25701943, 'binary_recall': 0.19767442, 'binary_specificity': 0.98106873, 'binary_f1_score': 0.22347417}
confusion matrix:
       0    1
0  17827  344
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.930117, 'precision': 0.52425045, 'recall': 0.52348006, 'specificity': 0.52348006, 'f1': 0.5238532, 'auroc': 0.65497077, 'binary_precision': 0.08547009, 'binary_recall': 0.08264463, 'binary_specificity': 0.9643155, 'binary_f1_score': 0.08403361}
confusion matrix:
      0    1
0  5783  214
1   222   20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-07 07:50:47.574517,epoch time: 0:23:03.257864,used: 0:23:03.257864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9585655, 'precision': 0.963444, 'recall': 0.92918193, 'specificity': 0.92918193, 'f1': 0.94462264, 'auroc': 0.9815321, 'binary_precision': 0.97264236, 'binary_recall': 0.8670853, 'binary_specificity': 0.99127865, 'binary_f1_score': 0.9168356}
confusion matrix:
       0      1
0  41941    369
1   2011  13119
---- Validation: 
scalar performance:
{'acc': 0.9632984, 'precision': 0.6658313, 'recall': 0.58594143, 'specificity': 0.58594143, 'f1': 0.61160904, 'auroc': 0.8229668, 'binary_precision': 0.3583062, 'binary_recall': 0.18272425, 'binary_specificity': 0.9891586, 'binary_f1_score': 0.2420242}
confusion matrix:
       0    1
0  17974  197
1    492  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94245875, 'precision': 0.5502249, 'recall': 0.5338654, 'specificity': 0.5338654, 'f1': 0.5397251, 'auroc': 0.7528137, 'binary_precision': 0.13664596, 'binary_recall': 0.09090909, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.10918114}
confusion matrix:
      0    1
0  5858  139
1   220   22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-07 08:13:25.792278,epoch time: 0:22:38.217761,used: 0:45:41.475625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9656337, 'precision': 0.9689997, 'recall': 0.94195867, 'specificity': 0.94195867, 'f1': 0.9544332, 'auroc': 0.98647463, 'binary_precision': 0.9754934, 'binary_recall': 0.8919294, 'binary_specificity': 0.9919879, 'binary_f1_score': 0.93184173}
confusion matrix:
       0      1
0  41972    339
1   1635  13494
---- Validation: 
scalar performance:
{'acc': 0.96558887, 'precision': 0.69637036, 'recall': 0.5903368, 'specificity': 0.5903368, 'f1': 0.621627, 'auroc': 0.843684, 'binary_precision': 0.41911766, 'binary_recall': 0.18936877, 'binary_specificity': 0.9913048, 'binary_f1_score': 0.26086956}
confusion matrix:
       0    1
0  18013  158
1    488  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9464658, 'precision': 0.5872457, 'recall': 0.55775994, 'specificity': 0.55775994, 'f1': 0.5686732, 'auroc': 0.8047174, 'binary_precision': 0.20886075, 'binary_recall': 0.13636364, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.165}
confusion matrix:
      0    1
0  5872  125
1   209   33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-07 08:35:58.473024,epoch time: 0:22:32.680746,used: 1:08:14.156371,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9686804, 'precision': 0.97165287, 'recall': 0.9472358, 'specificity': 0.9472358, 'f1': 0.95859474, 'auroc': 0.9887533, 'binary_precision': 0.97743714, 'binary_recall': 0.90191674, 'binary_specificity': 0.99255496, 'binary_f1_score': 0.9381596}
confusion matrix:
       0      1
0  41995    315
1   1484  13646
---- Validation: 
scalar performance:
{'acc': 0.96532255, 'precision': 0.69425315, 'recall': 0.59421444, 'specificity': 0.59421444, 'f1': 0.62497866, 'auroc': 0.85454404, 'binary_precision': 0.41463414, 'binary_recall': 0.19767442, 'binary_specificity': 0.9907545, 'binary_f1_score': 0.26771653}
confusion matrix:
       0    1
0  18003  168
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94887, 'precision': 0.6292044, 'recall': 0.59866536, 'specificity': 0.59866536, 'f1': 0.61147267, 'auroc': 0.8368813, 'binary_precision': 0.28961748, 'binary_recall': 0.21900827, 'binary_specificity': 0.9783225, 'binary_f1_score': 0.24941178}
confusion matrix:
      0    1
0  5867  130
1   189   53
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_4.png
new oracle model saved
early stop counter: 1
val acc:0.9653225541114807, best validation acc: 0.9655888676643372, corresponding to test acc:                         0.946465790271759 / 0.9488700032234192
after epoch: 4,now: 2024-07-07 08:58:47.199299,epoch time: 0:22:48.726275,used: 1:31:02.882646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9725801, 'precision': 0.9758358, 'recall': 0.95325565, 'specificity': 0.95325565, 'f1': 0.96382576, 'auroc': 0.99199957, 'binary_precision': 0.9822115, 'binary_recall': 0.91241986, 'binary_specificity': 0.9940914, 'binary_f1_score': 0.9460302}
confusion matrix:
       0      1
0  42061    250
1   1325  13804
---- Validation: 
scalar performance:
{'acc': 0.96601504, 'precision': 0.6986699, 'recall': 0.5801173, 'specificity': 0.5801173, 'f1': 0.61154747, 'auroc': 0.8571892, 'binary_precision': 0.42436975, 'binary_recall': 0.16777408, 'binary_specificity': 0.9924605, 'binary_f1_score': 0.24047619}
confusion matrix:
       0    1
0  18034  137
1    501  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9498317, 'precision': 0.63987863, 'recall': 0.6090793, 'specificity': 0.6090793, 'f1': 0.6222095, 'auroc': 0.84972477, 'binary_precision': 0.31016043, 'binary_recall': 0.23966943, 'binary_specificity': 0.9784892, 'binary_f1_score': 0.27039626}
confusion matrix:
      0    1
0  5868  129
1   184   58
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-07 09:21:35.523072,epoch time: 0:22:48.323773,used: 1:53:51.206419,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9757834, 'precision': 0.97463, 'recall': 0.9625872, 'specificity': 0.9625872, 'f1': 0.9684001, 'auroc': 0.9925362, 'binary_precision': 0.9722929, 'binary_recall': 0.9346993, 'binary_specificity': 0.99047506, 'binary_f1_score': 0.95312554}
confusion matrix:
       0      1
0  41907    403
1    988  14142
---- Validation: 
scalar performance:
{'acc': 0.9637245, 'precision': 0.693037, 'recall': 0.6407688, 'specificity': 0.6407688, 'f1': 0.6623225, 'auroc': 0.8655641, 'binary_precision': 0.4091954, 'binary_recall': 0.29568106, 'binary_specificity': 0.9858566, 'binary_f1_score': 0.343298}
confusion matrix:
       0    1
0  17914  257
1    424  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9373297, 'precision': 0.6325833, 'recall': 0.68981665, 'specificity': 0.68981665, 'f1': 0.6549765, 'auroc': 0.8610834, 'binary_precision': 0.28895184, 'binary_recall': 0.4214876, 'binary_specificity': 0.95814574, 'binary_f1_score': 0.34285715}
confusion matrix:
      0    1
0  5746  251
1   140  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_6.png
early stop counter: 1
val acc:0.9637244939804077, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 6,now: 2024-07-07 09:44:15.312317,epoch time: 0:22:39.789245,used: 2:16:30.995664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9769499, 'precision': 0.9782932, 'recall': 0.9620415, 'specificity': 0.9620415, 'f1': 0.9697937, 'auroc': 0.99292296, 'binary_precision': 0.98097825, 'binary_recall': 0.9305354, 'binary_specificity': 0.9935476, 'binary_f1_score': 0.95509124}
confusion matrix:
       0      1
0  42037    273
1   1051  14079
---- Validation: 
scalar performance:
{'acc': 0.96532255, 'precision': 0.702405, 'recall': 0.6183059, 'specificity': 0.6183059, 'f1': 0.64811313, 'auroc': 0.86795104, 'binary_precision': 0.4293948, 'binary_recall': 0.2475083, 'binary_specificity': 0.9891035, 'binary_f1_score': 0.31401473}
confusion matrix:
       0    1
0  17973  198
1    453  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480686, 'precision': 0.6616767, 'recall': 0.6795409, 'specificity': 0.6795409, 'f1': 0.6700554, 'auroc': 0.86872584, 'binary_precision': 0.34814814, 'binary_recall': 0.38842976, 'binary_specificity': 0.970652, 'binary_f1_score': 0.3671875}
confusion matrix:
      0    1
0  5821  176
1   148   94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_7.png
early stop counter: 2
val acc:0.9653225541114807, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 7,now: 2024-07-07 10:06:47.001112,epoch time: 0:22:31.688795,used: 2:39:02.684459,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97675836, 'precision': 0.9765457, 'recall': 0.96322775, 'specificity': 0.96322775, 'f1': 0.9696336, 'auroc': 0.9935415, 'binary_precision': 0.97611654, 'binary_recall': 0.9346332, 'binary_specificity': 0.99182224, 'binary_f1_score': 0.9549246}
confusion matrix:
       0      1
0  41964    346
1    989  14141
---- Validation: 
scalar performance:
{'acc': 0.9650562, 'precision': 0.7086544, 'recall': 0.6559116, 'specificity': 0.6559116, 'f1': 0.67803615, 'auroc': 0.8742273, 'binary_precision': 0.4394619, 'binary_recall': 0.3255814, 'binary_specificity': 0.9862418, 'binary_f1_score': 0.37404585}
confusion matrix:
       0    1
0  17921  250
1    406  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9381311, 'precision': 0.6417128, 'recall': 0.7120437, 'specificity': 0.7120437, 'f1': 0.66837555, 'auroc': 0.87182367, 'binary_precision': 0.3054054, 'binary_recall': 0.46694216, 'binary_specificity': 0.9571452, 'binary_f1_score': 0.36928105}
confusion matrix:
      0    1
0  5740  257
1   129  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_8.png
early stop counter: 3
val acc:0.9650561809539795, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 8,now: 2024-07-07 10:29:11.197514,epoch time: 0:22:24.196402,used: 3:01:26.880861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97898674, 'precision': 0.9792359, 'recall': 0.9663538, 'specificity': 0.9663538, 'f1': 0.9725596, 'auroc': 0.9944335, 'binary_precision': 0.9797395, 'binary_recall': 0.9396563, 'binary_specificity': 0.9930513, 'binary_f1_score': 0.95927936}
confusion matrix:
       0      1
0  42016    294
1    913  14217
---- Validation: 
scalar performance:
{'acc': 0.9646833, 'precision': 0.7057731, 'recall': 0.65812814, 'specificity': 0.65812814, 'f1': 0.67847294, 'auroc': 0.87354493, 'binary_precision': 0.4335512, 'binary_recall': 0.3305648, 'binary_specificity': 0.9856915, 'binary_f1_score': 0.3751178}
confusion matrix:
       0    1
0  17911  260
1    403  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9354063, 'precision': 0.63917714, 'recall': 0.7245055, 'specificity': 0.7245055, 'f1': 0.6695994, 'auroc': 0.870664, 'binary_precision': 0.29925188, 'binary_recall': 0.49586776, 'binary_specificity': 0.95314324, 'binary_f1_score': 0.37325037}
confusion matrix:
      0    1
0  5716  281
1   122  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_9.png
early stop counter: 4
val acc:0.9646832942962646, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 9,now: 2024-07-07 10:51:46.201379,epoch time: 0:22:35.003865,used: 3:24:01.884726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9788301, 'precision': 0.9799007, 'recall': 0.9653113, 'specificity': 0.9653113, 'f1': 0.97230554, 'auroc': 0.99446714, 'binary_precision': 0.9820525, 'binary_recall': 0.936744, 'binary_specificity': 0.99387866, 'binary_f1_score': 0.95886326}
confusion matrix:
       0      1
0  42052    259
1    957  14172
---- Validation: 
scalar performance:
{'acc': 0.9645235, 'precision': 0.69907725, 'recall': 0.63636327, 'specificity': 0.63636327, 'f1': 0.66118276, 'auroc': 0.8737841, 'binary_precision': 0.42156863, 'binary_recall': 0.2857143, 'binary_specificity': 0.98701227, 'binary_f1_score': 0.34059408}
confusion matrix:
       0    1
0  17935  236
1    430  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93893254, 'precision': 0.64072585, 'recall': 0.70254683, 'specificity': 0.70254683, 'f1': 0.6648705, 'auroc': 0.86948085, 'binary_precision': 0.30422536, 'binary_recall': 0.446281, 'binary_specificity': 0.9588127, 'binary_f1_score': 0.36180905}
confusion matrix:
      0    1
0  5750  247
1   134  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_10.png
early stop counter: 5
val acc:0.9645234942436218, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 10,now: 2024-07-07 11:14:06.331762,epoch time: 0:22:20.130383,used: 3:46:22.015109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9799965, 'precision': 0.9805289, 'recall': 0.9676973, 'specificity': 0.9676973, 'f1': 0.9738805, 'auroc': 0.9950019, 'binary_precision': 0.98160523, 'binary_recall': 0.9417052, 'binary_specificity': 0.9936894, 'binary_f1_score': 0.96124136}
confusion matrix:
       0      1
0  42043    267
1    882  14248
---- Validation: 
scalar performance:
{'acc': 0.9642039, 'precision': 0.70648175, 'recall': 0.6811689, 'specificity': 0.6811689, 'f1': 0.69290143, 'auroc': 0.8797753, 'binary_precision': 0.4334601, 'binary_recall': 0.37873754, 'binary_specificity': 0.98360026, 'binary_f1_score': 0.40425533}
confusion matrix:
       0    1
0  17873  298
1    374  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9346049, 'precision': 0.64294857, 'recall': 0.74391603, 'specificity': 0.74391603, 'f1': 0.6773373, 'auroc': 0.8737812, 'binary_precision': 0.3051643, 'binary_recall': 0.5371901, 'binary_specificity': 0.950642, 'binary_f1_score': 0.38922152}
confusion matrix:
      0    1
0  5701  296
1   112  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_11.png
early stop counter: 6
val acc:0.9642038941383362, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 11,now: 2024-07-07 11:36:41.927390,epoch time: 0:22:35.595628,used: 4:08:57.610737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9813371, 'precision': 0.98080814, 'recall': 0.9708772, 'specificity': 0.9708772, 'f1': 0.9757029, 'auroc': 0.9957089, 'binary_precision': 0.97972834, 'binary_recall': 0.94877386, 'binary_specificity': 0.99298054, 'binary_f1_score': 0.96400267}
confusion matrix:
       0      1
0  42014    297
1    775  14354
---- Validation: 
scalar performance:
{'acc': 0.96532255, 'precision': 0.71384865, 'recall': 0.6713071, 'specificity': 0.6713071, 'f1': 0.6899636, 'auroc': 0.88396955, 'binary_precision': 0.44885176, 'binary_recall': 0.35714287, 'binary_specificity': 0.98547137, 'binary_f1_score': 0.39777982}
confusion matrix:
       0    1
0  17907  264
1    387  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93877226, 'precision': 0.6491607, 'recall': 0.7322046, 'specificity': 0.7322046, 'f1': 0.67974174, 'auroc': 0.8724369, 'binary_precision': 0.31865284, 'binary_recall': 0.5082645, 'binary_specificity': 0.95614475, 'binary_f1_score': 0.39171976}
confusion matrix:
      0    1
0  5734  263
1   119  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_12.png
early stop counter: 7
val acc:0.9653225541114807, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 12,now: 2024-07-07 11:59:14.431899,epoch time: 0:22:32.504509,used: 4:31:30.115246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98260796, 'precision': 0.98316634, 'recall': 0.97184443, 'specificity': 0.97184443, 'f1': 0.9773252, 'auroc': 0.9957144, 'binary_precision': 0.9843011, 'binary_recall': 0.94910103, 'binary_specificity': 0.99458784, 'binary_f1_score': 0.96638066}
confusion matrix:
       0      1
0  42083    229
1    770  14358
---- Validation: 
scalar performance:
{'acc': 0.9643637, 'precision': 0.70521975, 'recall': 0.6684027, 'specificity': 0.6684027, 'f1': 0.68478537, 'auroc': 0.88314575, 'binary_precision': 0.4317719, 'binary_recall': 0.35215947, 'binary_specificity': 0.98464584, 'binary_f1_score': 0.38792315}
confusion matrix:
       0    1
0  17892  279
1    390  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93524605, 'precision': 0.6376266, 'recall': 0.72045666, 'specificity': 0.72045666, 'f1': 0.6673113, 'auroc': 0.87172097, 'binary_precision': 0.2964824, 'binary_recall': 0.4876033, 'binary_specificity': 0.95331, 'binary_f1_score': 0.36874998}
confusion matrix:
      0    1
0  5717  280
1   124  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_13.png
early stop counter: 8
val acc:0.964363694190979, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 13,now: 2024-07-07 12:21:55.518484,epoch time: 0:22:41.086585,used: 4:54:11.201831,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9828691, 'precision': 0.98352253, 'recall': 0.9721736, 'specificity': 0.9721736, 'f1': 0.97766715, 'auroc': 0.996258, 'binary_precision': 0.9848506, 'binary_recall': 0.9495704, 'binary_specificity': 0.99477667, 'binary_f1_score': 0.9668887}
confusion matrix:
       0      1
0  42089    221
1    763  14367
---- Validation: 
scalar performance:
{'acc': 0.9638843, 'precision': 0.7013285, 'recall': 0.668155, 'specificity': 0.668155, 'f1': 0.68307555, 'auroc': 0.8826771, 'binary_precision': 0.424, 'binary_recall': 0.35215947, 'binary_specificity': 0.9841506, 'binary_f1_score': 0.384755}
confusion matrix:
       0    1
0  17883  288
1    390  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9362077, 'precision': 0.6422243, 'recall': 0.72888786, 'specificity': 0.72888786, 'f1': 0.6732181, 'auroc': 0.8700368, 'binary_precision': 0.305, 'binary_recall': 0.5041322, 'binary_specificity': 0.9536435, 'binary_f1_score': 0.3800623}
confusion matrix:
      0    1
0  5719  278
1   120  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_14.png
early stop counter: 9
val acc:0.9638842940330505, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 14,now: 2024-07-07 12:44:27.859643,epoch time: 0:22:32.341159,used: 5:16:43.542990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9829387, 'precision': 0.9845245, 'recall': 0.97139114, 'specificity': 0.97139114, 'f1': 0.9777168, 'auroc': 0.9963945, 'binary_precision': 0.98772836, 'binary_recall': 0.94698924, 'binary_specificity': 0.99579304, 'binary_f1_score': 0.96692985}
confusion matrix:
       0      1
0  42133    178
1    802  14327
---- Validation: 
scalar performance:
{'acc': 0.9631385, 'precision': 0.69905853, 'recall': 0.68302774, 'specificity': 0.68302774, 'f1': 0.6906657, 'auroc': 0.8867568, 'binary_precision': 0.41847825, 'binary_recall': 0.38372093, 'binary_specificity': 0.9823345, 'binary_f1_score': 0.4003466}
confusion matrix:
       0    1
0  17850  321
1    371  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92803335, 'precision': 0.6283605, 'recall': 0.7365322, 'specificity': 0.7365322, 'f1': 0.6624912, 'auroc': 0.8706895, 'binary_precision': 0.27645788, 'binary_recall': 0.5289256, 'binary_specificity': 0.94413877, 'binary_f1_score': 0.36312056}
confusion matrix:
      0    1
0  5662  335
1   114  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_15.png
early stop counter: 10
val acc:0.9631385207176208, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 15,now: 2024-07-07 13:07:49.792929,epoch time: 0:23:21.933286,used: 5:40:05.476276,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9832173, 'precision': 0.9838277, 'recall': 0.9727692, 'specificity': 0.9727692, 'f1': 0.9781268, 'auroc': 0.99654067, 'binary_precision': 0.9850695, 'binary_recall': 0.95069075, 'binary_specificity': 0.99484766, 'binary_f1_score': 0.9675749}
confusion matrix:
       0      1
0  42093    218
1    746  14383
---- Validation: 
scalar performance:
{'acc': 0.9631918, 'precision': 0.7034582, 'recall': 0.70313144, 'specificity': 0.70313144, 'f1': 0.7032947, 'auroc': 0.8904437, 'binary_precision': 0.42595673, 'binary_recall': 0.42524916, 'binary_specificity': 0.9810137, 'binary_f1_score': 0.42560264}
confusion matrix:
       0    1
0  17826  345
1    346  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9325212, 'precision': 0.6394949, 'recall': 0.7467977, 'specificity': 0.7467977, 'f1': 0.6748511, 'auroc': 0.87301576, 'binary_precision': 0.2979684, 'binary_recall': 0.54545456, 'binary_specificity': 0.94814074, 'binary_f1_score': 0.38540146}
confusion matrix:
      0    1
0  5686  311
1   110  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_16.png
early stop counter: 11
val acc:0.96319180727005, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 16,now: 2024-07-07 13:30:22.457341,epoch time: 0:22:32.664412,used: 6:02:38.140688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98555017, 'precision': 0.9842671, 'recall': 0.9783667, 'specificity': 0.9783667, 'f1': 0.98126775, 'auroc': 0.99664235, 'binary_precision': 0.9816112, 'binary_recall': 0.9631857, 'binary_specificity': 0.9935476, 'binary_f1_score': 0.9723112}
confusion matrix:
       0      1
0  42037    273
1    557  14573
---- Validation: 
scalar performance:
{'acc': 0.9607415, 'precision': 0.69319236, 'recall': 0.72435105, 'specificity': 0.72435105, 'f1': 0.70745647, 'auroc': 0.8921555, 'binary_precision': 0.40398294, 'binary_recall': 0.4717608, 'binary_specificity': 0.9769413, 'binary_f1_score': 0.43524906}
confusion matrix:
       0    1
0  17752  419
1    318  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9221029, 'precision': 0.6230627, 'recall': 0.751292, 'specificity': 0.751292, 'f1': 0.6595259, 'auroc': 0.8693341, 'binary_precision': 0.26447877, 'binary_recall': 0.5661157, 'binary_specificity': 0.93646824, 'binary_f1_score': 0.36052635}
confusion matrix:
      0    1
0  5616  381
1   105  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_17.png
early stop counter: 12
val acc:0.9607415199279785, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 17,now: 2024-07-07 13:53:06.081617,epoch time: 0:22:43.624276,used: 6:25:21.764964,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9842096, 'precision': 0.9840996, 'recall': 0.97505784, 'specificity': 0.97505784, 'f1': 0.9794637, 'auroc': 0.99677473, 'binary_precision': 0.98387426, 'binary_recall': 0.95571715, 'binary_specificity': 0.9943985, 'binary_f1_score': 0.9695914}
confusion matrix:
       0      1
0  42073    237
1    670  14460
---- Validation: 
scalar performance:
{'acc': 0.9627124, 'precision': 0.7004689, 'recall': 0.70368683, 'specificity': 0.70368683, 'f1': 0.7020635, 'auroc': 0.8926501, 'binary_precision': 0.41993463, 'binary_recall': 0.4269103, 'binary_specificity': 0.9804634, 'binary_f1_score': 0.42339376}
confusion matrix:
       0    1
0  17816  355
1    345  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9322007, 'precision': 0.63550687, 'recall': 0.7347344, 'specificity': 0.7347344, 'f1': 0.6687475, 'auroc': 0.8684969, 'binary_precision': 0.29099306, 'binary_recall': 0.5206612, 'binary_specificity': 0.9488077, 'binary_f1_score': 0.37333336}
confusion matrix:
      0    1
0  5690  307
1   116  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_18.png
early stop counter: 13
val acc:0.9627124071121216, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 18,now: 2024-07-07 14:15:53.016331,epoch time: 0:22:46.934714,used: 6:48:08.699678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98511493, 'precision': 0.98609805, 'recall': 0.97543883, 'specificity': 0.97543883, 'f1': 0.9806098, 'auroc': 0.9969995, 'binary_precision': 0.98810095, 'binary_recall': 0.9549901, 'binary_specificity': 0.9958875, 'binary_f1_score': 0.9712634}
confusion matrix:
       0      1
0  42136    174
1    681  14449
---- Validation: 
scalar performance:
{'acc': 0.9638843, 'precision': 0.7077613, 'recall': 0.70108, 'specificity': 0.70108, 'f1': 0.70435953, 'auroc': 0.8937878, 'binary_precision': 0.4347079, 'binary_recall': 0.4202658, 'binary_specificity': 0.98189425, 'binary_f1_score': 0.42736492}
confusion matrix:
       0    1
0  17842  329
1    349  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9368489, 'precision': 0.64654624, 'recall': 0.739135, 'specificity': 0.739135, 'f1': 0.67933506, 'auroc': 0.87024987, 'binary_precision': 0.3128079, 'binary_recall': 0.5247934, 'binary_specificity': 0.9534767, 'binary_f1_score': 0.39197528}
confusion matrix:
      0    1
0  5718  279
1   115  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_19.png
early stop counter: 14
val acc:0.9638842940330505, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 19,now: 2024-07-07 14:38:52.308249,epoch time: 0:22:59.291918,used: 7:11:07.991596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98525417, 'precision': 0.9857322, 'recall': 0.9761476, 'specificity': 0.9761476, 'f1': 0.98081136, 'auroc': 0.99689007, 'binary_precision': 0.98670936, 'binary_recall': 0.95690393, 'binary_specificity': 0.99539125, 'binary_f1_score': 0.9715781}
confusion matrix:
       0      1
0  42116    195
1    652  14477
---- Validation: 
scalar performance:
{'acc': 0.9639376, 'precision': 0.7050675, 'recall': 0.6842435, 'specificity': 0.6842435, 'f1': 0.69403225, 'auroc': 0.89326084, 'binary_precision': 0.43042672, 'binary_recall': 0.38538206, 'binary_specificity': 0.98310494, 'binary_f1_score': 0.4066608}
confusion matrix:
       0    1
0  17864  307
1    370  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9382914, 'precision': 0.6445105, 'recall': 0.720058, 'specificity': 0.720058, 'f1': 0.6727821, 'auroc': 0.86500347, 'binary_precision': 0.31034482, 'binary_recall': 0.48347107, 'binary_specificity': 0.956645, 'binary_f1_score': 0.37802908}
confusion matrix:
      0    1
0  5737  260
1   125  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_20.png
early stop counter: 15
val acc:0.9639375805854797, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 20,now: 2024-07-07 15:01:38.635634,epoch time: 0:22:46.327385,used: 7:33:54.318981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9846971, 'precision': 0.98341656, 'recall': 0.97700214, 'specificity': 0.97700214, 'f1': 0.9801512, 'auroc': 0.99706507, 'binary_precision': 0.9807705, 'binary_recall': 0.96074027, 'binary_specificity': 0.993264, 'binary_f1_score': 0.9706521}
confusion matrix:
       0      1
0  42025    285
1    594  14536
---- Validation: 
scalar performance:
{'acc': 0.9615938, 'precision': 0.69296294, 'recall': 0.70069987, 'specificity': 0.70069987, 'f1': 0.69674563, 'auroc': 0.8929502, 'binary_precision': 0.40510365, 'binary_recall': 0.42192692, 'binary_specificity': 0.9794728, 'binary_f1_score': 0.4133442}
confusion matrix:
       0    1
0  17798  373
1    348  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9259497, 'precision': 0.62399226, 'recall': 0.73346555, 'specificity': 0.73346555, 'f1': 0.6577348, 'auroc': 0.8632257, 'binary_precision': 0.26793247, 'binary_recall': 0.5247934, 'binary_specificity': 0.9421377, 'binary_f1_score': 0.35474858}
confusion matrix:
      0    1
0  5650  347
1   115  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_21.png
early stop counter: 16
val acc:0.9615938067436218, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 21,now: 2024-07-07 15:24:27.064095,epoch time: 0:22:48.428461,used: 7:56:42.747442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9857068, 'precision': 0.9846928, 'recall': 0.97834563, 'specificity': 0.97834563, 'f1': 0.9814625, 'auroc': 0.9974861, 'binary_precision': 0.982597, 'binary_recall': 0.9627892, 'binary_specificity': 0.99390215, 'binary_f1_score': 0.9725923}
confusion matrix:
       0      1
0  42052    258
1    563  14567
---- Validation: 
scalar performance:
{'acc': 0.96164703, 'precision': 0.69925314, 'recall': 0.73044014, 'specificity': 0.73044014, 'f1': 0.71356964, 'auroc': 0.89865756, 'binary_precision': 0.4157143, 'binary_recall': 0.4833887, 'binary_specificity': 0.9774916, 'binary_f1_score': 0.44700462}
confusion matrix:
       0    1
0  17762  409
1    311  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.930117, 'precision': 0.6362101, 'recall': 0.75149524, 'specificity': 0.75149524, 'f1': 0.67269963, 'auroc': 0.8710151, 'binary_precision': 0.29094827, 'binary_recall': 0.55785125, 'binary_specificity': 0.9451392, 'binary_f1_score': 0.38243628}
confusion matrix:
      0    1
0  5668  329
1   107  135
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_22.png
early stop counter: 17
val acc:0.9616470336914062, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 22,now: 2024-07-07 15:47:01.475235,epoch time: 0:22:34.411140,used: 8:19:17.158582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98610723, 'precision': 0.9864714, 'recall': 0.97761965, 'specificity': 0.97761965, 'f1': 0.981936, 'auroc': 0.9972695, 'binary_precision': 0.98721784, 'binary_recall': 0.95968276, 'binary_specificity': 0.9955566, 'binary_f1_score': 0.9732556}
confusion matrix:
       0      1
0  42122    188
1    610  14520
---- Validation: 
scalar performance:
{'acc': 0.96415067, 'precision': 0.71334034, 'recall': 0.725309, 'specificity': 0.725309, 'f1': 0.71914184, 'auroc': 0.9013449, 'binary_precision': 0.44427, 'binary_recall': 0.47009966, 'binary_specificity': 0.9805184, 'binary_f1_score': 0.45682}
confusion matrix:
       0    1
0  17817  354
1    319  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9381311, 'precision': 0.6486209, 'recall': 0.73583657, 'specificity': 0.73583657, 'f1': 0.68024296, 'auroc': 0.87140006, 'binary_precision': 0.3172589, 'binary_recall': 0.5165289, 'binary_specificity': 0.9551442, 'binary_f1_score': 0.39308175}
confusion matrix:
      0    1
0  5728  269
1   117  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_23.png
early stop counter: 18
val acc:0.9641506671905518, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 23,now: 2024-07-07 16:09:34.046143,epoch time: 0:22:32.570908,used: 8:41:49.729490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98643804, 'precision': 0.9857746, 'recall': 0.97915936, 'specificity': 0.97915936, 'f1': 0.9824054, 'auroc': 0.997416, 'binary_precision': 0.98440456, 'binary_recall': 0.9637782, 'binary_specificity': 0.99454045, 'binary_f1_score': 0.97398216}
confusion matrix:
       0      1
0  42080    231
1    548  14581
---- Validation: 
scalar performance:
{'acc': 0.95999575, 'precision': 0.69345117, 'recall': 0.74484503, 'specificity': 0.74484503, 'f1': 0.7157322, 'auroc': 0.8999926, 'binary_precision': 0.40312093, 'binary_recall': 0.51495016, 'binary_specificity': 0.97473997, 'binary_f1_score': 0.45222464}
confusion matrix:
       0    1
0  17712  459
1    292  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9221029, 'precision': 0.6230627, 'recall': 0.751292, 'specificity': 0.751292, 'f1': 0.6595259, 'auroc': 0.867854, 'binary_precision': 0.26447877, 'binary_recall': 0.5661157, 'binary_specificity': 0.93646824, 'binary_f1_score': 0.36052635}
confusion matrix:
      0    1
0  5616  381
1   105  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_24.png
early stop counter: 19
val acc:0.9599957466125488, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 24,now: 2024-07-07 16:32:04.662115,epoch time: 0:22:30.615972,used: 9:04:20.345462,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9867514, 'precision': 0.98639786, 'recall': 0.9793519, 'specificity': 0.9793519, 'f1': 0.98280525, 'auroc': 0.9977155, 'binary_precision': 0.9856689, 'binary_recall': 0.9637145, 'binary_specificity': 0.99498934, 'binary_f1_score': 0.97456807}
confusion matrix:
       0      1
0  42098    212
1    549  14581
---- Validation: 
scalar performance:
{'acc': 0.96180683, 'precision': 0.6962957, 'recall': 0.7104465, 'specificity': 0.7104465, 'f1': 0.7030935, 'auroc': 0.896559, 'binary_precision': 0.41112828, 'binary_recall': 0.44186047, 'binary_specificity': 0.9790325, 'binary_f1_score': 0.42594078}
confusion matrix:
       0    1
0  17790  381
1    336  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9275525, 'precision': 0.6227961, 'recall': 0.7204201, 'specificity': 0.7204201, 'f1': 0.6542351, 'auroc': 0.86354697, 'binary_precision': 0.26666668, 'binary_recall': 0.49586776, 'binary_specificity': 0.9449725, 'binary_f1_score': 0.34682083}
confusion matrix:
      0    1
0  5667  330
1   122  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_25.png
early stop counter: 20
val acc:0.9618068337440491, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 25,now: 2024-07-07 16:54:35.977359,epoch time: 0:22:31.315244,used: 9:26:51.660706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9860724, 'precision': 0.9859277, 'recall': 0.97806185, 'specificity': 0.97806185, 'f1': 0.981908, 'auroc': 0.9978074, 'binary_precision': 0.98563004, 'binary_recall': 0.96113425, 'binary_specificity': 0.99498945, 'binary_f1_score': 0.97322804}
confusion matrix:
       0      1
0  42099    212
1    588  14541
---- Validation: 
scalar performance:
{'acc': 0.9627124, 'precision': 0.7062899, 'recall': 0.73661184, 'specificity': 0.73661184, 'f1': 0.72028315, 'auroc': 0.9027569, 'binary_precision': 0.4293948, 'binary_recall': 0.4950166, 'binary_specificity': 0.97820705, 'binary_f1_score': 0.45987654}
confusion matrix:
       0    1
0  17775  396
1    304  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9373297, 'precision': 0.64662445, 'recall': 0.7354197, 'specificity': 0.7354197, 'f1': 0.6784918, 'auroc': 0.8732656, 'binary_precision': 0.3132832, 'binary_recall': 0.5165289, 'binary_specificity': 0.9543105, 'binary_f1_score': 0.3900156}
confusion matrix:
      0    1
0  5723  274
1   117  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_26.png
early stop counter: 21
val acc:0.9627124071121216, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 26,now: 2024-07-07 17:17:08.146559,epoch time: 0:22:32.169200,used: 9:49:23.829906,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9862465, 'precision': 0.9839277, 'recall': 0.9805378, 'specificity': 0.9805378, 'f1': 0.9822165, 'auroc': 0.9974942, 'binary_precision': 0.9790859, 'binary_recall': 0.96847326, 'binary_specificity': 0.9926022, 'binary_f1_score': 0.9737507}
confusion matrix:
       0      1
0  41997    313
1    477  14653
---- Validation: 
scalar performance:
{'acc': 0.9585575, 'precision': 0.6897863, 'recall': 0.76016307, 'specificity': 0.76016307, 'f1': 0.71871215, 'auroc': 0.9018844, 'binary_precision': 0.39473686, 'binary_recall': 0.5481728, 'binary_specificity': 0.9721534, 'binary_f1_score': 0.45897081}
confusion matrix:
       0    1
0  17665  506
1    272  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92274404, 'precision': 0.6246348, 'recall': 0.7536082, 'specificity': 0.7536082, 'f1': 0.6614949, 'auroc': 0.8715168, 'binary_precision': 0.26744187, 'binary_recall': 0.57024795, 'binary_specificity': 0.9369685, 'binary_f1_score': 0.36411613}
confusion matrix:
      0    1
0  5619  378
1   104  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_27.png
early stop counter: 22
val acc:0.9585574865341187, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 27,now: 2024-07-07 17:40:38.839570,epoch time: 0:23:30.693011,used: 10:12:54.522917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98784816, 'precision': 0.9882318, 'recall': 0.9803713, 'specificity': 0.9803713, 'f1': 0.9842154, 'auroc': 0.9978579, 'binary_precision': 0.98902065, 'binary_recall': 0.96457136, 'binary_specificity': 0.99617124, 'binary_f1_score': 0.97664297}
confusion matrix:
       0      1
0  42149    162
1    536  14593
---- Validation: 
scalar performance:
{'acc': 0.9583977, 'precision': 0.6858697, 'recall': 0.74401957, 'specificity': 0.74401957, 'f1': 0.71046686, 'auroc': 0.9002774, 'binary_precision': 0.387985, 'binary_recall': 0.51495016, 'binary_specificity': 0.973089, 'binary_f1_score': 0.44254106}
confusion matrix:
       0    1
0  17682  489
1    292  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9182561, 'precision': 0.6138634, 'recall': 0.7373945, 'specificity': 0.7373945, 'f1': 0.6479054, 'auroc': 0.86402357, 'binary_precision': 0.24716981, 'binary_recall': 0.5413223, 'binary_specificity': 0.93346673, 'binary_f1_score': 0.33937824}
confusion matrix:
      0    1
0  5598  399
1   111  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_28.png
early stop counter: 23
val acc:0.9583976864814758, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 28,now: 2024-07-07 18:03:36.495445,epoch time: 0:22:57.655875,used: 10:35:52.178792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98668176, 'precision': 0.98440015, 'recall': 0.981194, 'specificity': 0.981194, 'f1': 0.98278254, 'auroc': 0.9978052, 'binary_precision': 0.97963274, 'binary_recall': 0.9695968, 'binary_specificity': 0.9927913, 'binary_f1_score': 0.974589}
confusion matrix:
       0      1
0  42005    305
1    460  14670
---- Validation: 
scalar performance:
{'acc': 0.9623395, 'precision': 0.70493346, 'recall': 0.7412375, 'specificity': 0.7412375, 'f1': 0.72142184, 'auroc': 0.9031663, 'binary_precision': 0.42636746, 'binary_recall': 0.50498337, 'binary_specificity': 0.9774916, 'binary_f1_score': 0.4623574}
confusion matrix:
       0    1
0  17762  409
1    298  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9346049, 'precision': 0.6373255, 'recall': 0.7240886, 'specificity': 0.7240886, 'f1': 0.66794086, 'auroc': 0.87112564, 'binary_precision': 0.2955665, 'binary_recall': 0.49586776, 'binary_specificity': 0.9523095, 'binary_f1_score': 0.37037033}
confusion matrix:
      0    1
0  5711  286
1   122  120
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_29.png
early stop counter: 24
val acc:0.9623395204544067, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 29,now: 2024-07-07 18:26:26.124947,epoch time: 0:22:49.629502,used: 10:58:41.808294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98777854, 'precision': 0.98725903, 'recall': 0.9811531, 'specificity': 0.9811531, 'f1': 0.98415375, 'auroc': 0.99782205, 'binary_precision': 0.9861841, 'binary_recall': 0.96715134, 'binary_specificity': 0.9951548, 'binary_f1_score': 0.97657496}
confusion matrix:
       0      1
0  42105    205
1    497  14633
---- Validation: 
scalar performance:
{'acc': 0.9580248, 'precision': 0.68729186, 'recall': 0.7590849, 'specificity': 0.7590849, 'f1': 0.7166101, 'auroc': 0.9046265, 'binary_precision': 0.3898104, 'binary_recall': 0.54651165, 'binary_specificity': 0.9716581, 'binary_f1_score': 0.45504838}
confusion matrix:
       0    1
0  17656  515
1    273  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9211412, 'precision': 0.62207663, 'recall': 0.7527745, 'specificity': 0.7527745, 'f1': 0.65867984, 'auroc': 0.87151086, 'binary_precision': 0.2623574, 'binary_recall': 0.57024795, 'binary_specificity': 0.935301, 'binary_f1_score': 0.359375}
confusion matrix:
      0    1
0  5609  388
1   104  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716435_30.png
early stop counter: 25
val acc:0.958024799823761, best validation acc: 0.9660150408744812, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 30,now: 2024-07-07 18:49:19.628798,epoch time: 0:22:53.503851,used: 11:21:35.312145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_07_27_44_seed_2_21716435
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:21:35.312145 at 2024-07-07 18:49:19.628798
persisted model performance metric: 

scalar performance:
{'acc': 0.9498317, 'precision': 0.63987863, 'recall': 0.6090793, 'specificity': 0.6090793, 'f1': 0.6222095, 'auroc': 0.84972477, 'binary_precision': 0.31016043, 'binary_recall': 0.23966943, 'binary_specificity': 0.9784892, 'binary_f1_score': 0.27039626}
confusion matrix:
      0    1
0  5868  129
1   184   58
oracle model performance metric: 

scalar performance:
{'acc': 0.9498317, 'precision': 0.63987863, 'recall': 0.6090793, 'specificity': 0.6090793, 'f1': 0.6222095, 'auroc': 0.84972477, 'binary_precision': 0.31016043, 'binary_recall': 0.23966943, 'binary_specificity': 0.9784892, 'binary_f1_score': 0.27039626}
confusion matrix:
      0    1
0  5868  129
1   184   58
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |  17485 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |  17485 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   7827 MiB |   3575 TiB |   3575 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   3529 TiB |   3529 TiB |
|       from small pool |  16481 KiB |     36 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8530 MiB |  25070 MiB |  16560 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  25000 MiB |  16528 MiB |
|       from small pool |     38 MiB |     44 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40872 KiB | 732464 KiB |   1938 TiB |   1938 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1892 TiB |   1892 TiB |
|       from small pool |   9139 KiB |  23284 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7675    |  590644 K  |  590641 K  |
|       from large pool |      79    |     762    |  335133 K  |  335133 K  |
|       from small pool |    2887    |    7594    |  255510 K  |  255507 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7675    |  590644 K  |  590641 K  |
|       from large pool |      79    |     762    |  335133 K  |  335133 K  |
|       from small pool |    2887    |    7594    |  255510 K  |  255507 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     371    |    1060    |     693    |
|       from large pool |     348    |     349    |    1025    |     677    |
|       from small pool |      19    |      22    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3612    |  346208 K  |  346208 K  |
|       from large pool |      11    |     352    |  238274 K  |  238274 K  |
|       from small pool |      24    |    3602    |  107933 K  |  107933 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |      0 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |      0 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   3575 TiB |   3575 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   3529 TiB |   3529 TiB |
|       from small pool |      0 KiB |     36 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  25070 MiB |  24838 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25000 MiB |  24794 MiB |
|       from small pool |  26624 KiB |     44 MiB |     70 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1938 TiB |   1938 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1892 TiB |   1892 TiB |
|       from small pool |      0 KiB |  23284 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7675    |  590644 K  |  590644 K  |
|       from large pool |       2    |     762    |  335133 K  |  335133 K  |
|       from small pool |       0    |    7594    |  255510 K  |  255510 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7675    |  590644 K  |  590644 K  |
|       from large pool |       2    |     762    |  335133 K  |  335133 K  |
|       from small pool |       0    |    7594    |  255510 K  |  255510 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1060    |    1037    |
|       from large pool |      10    |     349    |    1025    |    1015    |
|       from small pool |      13    |      22    |      35    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |  346209 K  |  346209 K  |
|       from large pool |       3    |     352    |  238274 K  |  238274 K  |
|       from small pool |       0    |    3602    |  107935 K  |  107935 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul  7 18:50:40 2024]
Finished job 0.
1 of 1 steps (100%) done
