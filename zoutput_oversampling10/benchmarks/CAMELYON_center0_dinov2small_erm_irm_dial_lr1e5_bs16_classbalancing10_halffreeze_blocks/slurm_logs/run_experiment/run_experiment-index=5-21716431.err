Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul  6 01:11:54 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431

 Experiment start at: 2024-07-06 01:17:52.416828
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94076085, 'precision': 0.96000147, 'recall': 0.8871655, 'specificity': 0.8871655, 'f1': 0.9163596, 'auroc': 0.9671912, 'binary_precision': 0.99227095, 'binary_recall': 0.7764338, 'binary_specificity': 0.99789715, 'binary_f1_score': 0.8711829}
confusion matrix:
       0      1
0  42235     89
1   3290  11426
---- Validation: 
scalar performance:
{'acc': 0.9499255, 'precision': 0.54072297, 'recall': 0.5247926, 'specificity': 0.5247926, 'f1': 0.529889, 'auroc': 0.7921083, 'binary_precision': 0.11398964, 'binary_recall': 0.06842924, 'binary_specificity': 0.981156, 'binary_f1_score': 0.085519925}
confusion matrix:
       0    1
0  17807  342
1    599   44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9490253, 'precision': 0.5884312, 'recall': 0.5354756, 'specificity': 0.5354756, 'f1': 0.5474817, 'auroc': 0.82647204, 'binary_precision': 0.21568628, 'binary_recall': 0.08429119, 'binary_specificity': 0.98666, 'binary_f1_score': 0.12121212}
confusion matrix:
      0   1
0  5917  80
1   239  22
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-06 01:44:32.633663,epoch time: 0:26:40.216835,used: 0:26:40.216835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95631135, 'precision': 0.9684042, 'recall': 0.91812277, 'specificity': 0.91812277, 'f1': 0.93983734, 'auroc': 0.98234427, 'binary_precision': 0.9899006, 'binary_recall': 0.8392226, 'binary_specificity': 0.997023, 'binary_f1_score': 0.90835536}
confusion matrix:
       0      1
0  42198    126
1   2366  12350
---- Validation: 
scalar performance:
{'acc': 0.9546083, 'precision': 0.63093996, 'recall': 0.6022225, 'specificity': 0.6022225, 'f1': 0.6145019, 'auroc': 0.8566183, 'binary_precision': 0.28915662, 'binary_recall': 0.22395024, 'binary_specificity': 0.9804948, 'binary_f1_score': 0.25241017}
confusion matrix:
       0    1
0  17795  354
1    499  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.7213464, 'recall': 0.6421717, 'specificity': 0.6421717, 'f1': 0.67193234, 'auroc': 0.88349044, 'binary_precision': 0.47272727, 'binary_recall': 0.29885057, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.36619717}
confusion matrix:
      0   1
0  5910  87
1   183  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-06 02:10:16.855088,epoch time: 0:25:44.221425,used: 0:52:24.438260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96257013, 'precision': 0.9671109, 'recall': 0.9346144, 'specificity': 0.9346144, 'f1': 0.9494018, 'auroc': 0.9863229, 'binary_precision': 0.9755784, 'binary_recall': 0.8768603, 'binary_specificity': 0.9923686, 'binary_f1_score': 0.92358905}
confusion matrix:
       0      1
0  42002    323
1   1812  12903
---- Validation: 
scalar performance:
{'acc': 0.95391655, 'precision': 0.6536832, 'recall': 0.6573685, 'specificity': 0.6573685, 'f1': 0.6555004, 'auroc': 0.87644124, 'binary_precision': 0.33080426, 'binary_recall': 0.33903578, 'binary_specificity': 0.97570115, 'binary_f1_score': 0.33486944}
confusion matrix:
       0    1
0  17708  441
1    425  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.76244056, 'recall': 0.71979856, 'specificity': 0.71979856, 'f1': 0.73898554, 'auroc': 0.89918077, 'binary_precision': 0.5483871, 'binary_recall': 0.4559387, 'binary_specificity': 0.9836585, 'binary_f1_score': 0.49790794}
confusion matrix:
      0    1
0  5899   98
1   142  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_3.png
new oracle model saved
early stop counter: 1
val acc:0.9539165496826172, best validation acc: 0.9546083211898804, corresponding to test acc:                         0.9568552374839783 / 0.9616490602493286
after epoch: 3,now: 2024-07-06 02:36:31.370086,epoch time: 0:26:14.514998,used: 1:18:38.953258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96712834, 'precision': 0.96993935, 'recall': 0.94370663, 'specificity': 0.94370663, 'f1': 0.9558715, 'auroc': 0.98795784, 'binary_precision': 0.97528124, 'binary_recall': 0.8953054, 'binary_specificity': 0.9921079, 'binary_f1_score': 0.9335837}
confusion matrix:
       0      1
0  41987    334
1   1541  13178
---- Validation: 
scalar performance:
{'acc': 0.95391655, 'precision': 0.66153383, 'recall': 0.6798701, 'specificity': 0.6798701, 'f1': 0.6701311, 'auroc': 0.8851079, 'binary_precision': 0.3449235, 'binary_recall': 0.38569206, 'binary_specificity': 0.97404814, 'binary_f1_score': 0.36417034}
confusion matrix:
       0    1
0  17678  471
1    395  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.7775033, 'recall': 0.78359866, 'specificity': 0.78359866, 'f1': 0.78051347, 'auroc': 0.9070449, 'binary_precision': 0.5730337, 'binary_recall': 0.5862069, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.57954544}
confusion matrix:
      0    1
0  5883  114
1   108  153
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_4.png
new oracle model saved
early stop counter: 2
val acc:0.9539165496826172, best validation acc: 0.9546083211898804, corresponding to test acc:                         0.9568552374839783 / 0.9645254015922546
after epoch: 4,now: 2024-07-06 03:02:38.463854,epoch time: 0:26:07.093768,used: 1:44:46.047026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9695477, 'precision': 0.9721532, 'recall': 0.94787526, 'specificity': 0.94787526, 'f1': 0.95920265, 'auroc': 0.9896565, 'binary_precision': 0.97713405, 'binary_recall': 0.90309864, 'binary_specificity': 0.99265194, 'binary_f1_score': 0.9386588}
confusion matrix:
       0      1
0  42013    311
1   1426  13290
---- Validation: 
scalar performance:
{'acc': 0.95540655, 'precision': 0.6778637, 'recall': 0.714394, 'specificity': 0.714394, 'f1': 0.6941711, 'auroc': 0.8948041, 'binary_precision': 0.37516004, 'binary_recall': 0.45567653, 'binary_specificity': 0.97311145, 'binary_f1_score': 0.41151685}
confusion matrix:
       0    1
0  17661  488
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.76232606, 'recall': 0.80808413, 'specificity': 0.80808413, 'f1': 0.78310466, 'auroc': 0.9117055, 'binary_precision': 0.5404531, 'binary_recall': 0.63984674, 'binary_specificity': 0.9763215, 'binary_f1_score': 0.5859649}
confusion matrix:
      0    1
0  5855  142
1    94  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_5.png
better model found
persisted
after epoch: 5,now: 2024-07-06 03:28:33.767404,epoch time: 0:25:55.303550,used: 2:10:41.350576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97170407, 'precision': 0.9724479, 'recall': 0.95317096, 'specificity': 0.95317096, 'f1': 0.96229494, 'auroc': 0.99124074, 'binary_precision': 0.9738917, 'binary_recall': 0.91487193, 'binary_specificity': 0.99147, 'binary_f1_score': 0.94345963}
confusion matrix:
       0      1
0  41960    361
1   1253  13466
---- Validation: 
scalar performance:
{'acc': 0.9564176, 'precision': 0.6839521, 'recall': 0.7209179, 'specificity': 0.7209179, 'f1': 0.70049894, 'auroc': 0.89712214, 'binary_precision': 0.38688946, 'binary_recall': 0.4681182, 'binary_specificity': 0.9737176, 'binary_f1_score': 0.42364532}
confusion matrix:
       0    1
0  17672  477
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.7554915, 'recall': 0.81291413, 'specificity': 0.81291413, 'f1': 0.7808713, 'auroc': 0.91234124, 'binary_precision': 0.5263158, 'binary_recall': 0.651341, 'binary_specificity': 0.97448725, 'binary_f1_score': 0.58219177}
confusion matrix:
      0    1
0  5844  153
1    91  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_6.png
better model found
persisted
after epoch: 6,now: 2024-07-06 03:54:27.093659,epoch time: 0:25:53.326255,used: 2:36:34.676831,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9720196, 'precision': 0.97618943, 'recall': 0.9505415, 'specificity': 0.9505415, 'f1': 0.96247077, 'auroc': 0.9914471, 'binary_precision': 0.984134, 'binary_recall': 0.9061629, 'binary_specificity': 0.99492, 'binary_f1_score': 0.9435404}
confusion matrix:
       0      1
0  42108    215
1   1381  13336
---- Validation: 
scalar performance:
{'acc': 0.95753515, 'precision': 0.6912231, 'recall': 0.7304971, 'specificity': 0.7304971, 'f1': 0.7087691, 'auroc': 0.90332043, 'binary_precision': 0.40076825, 'binary_recall': 0.4867807, 'binary_specificity': 0.9742135, 'binary_f1_score': 0.43960676}
confusion matrix:
       0    1
0  17681  468
1    330  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.7699379, 'recall': 0.81799614, 'specificity': 0.81799614, 'f1': 0.791724, 'auroc': 0.9141135, 'binary_precision': 0.5548387, 'binary_recall': 0.65900385, 'binary_specificity': 0.9769885, 'binary_f1_score': 0.6024518}
confusion matrix:
      0    1
0  5859  138
1    89  172
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_7.png
better model found
persisted
after epoch: 7,now: 2024-07-06 04:20:45.825747,epoch time: 0:26:18.732088,used: 3:02:53.408919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9757889, 'precision': 0.97695374, 'recall': 0.9594834, 'specificity': 0.9594834, 'f1': 0.9678005, 'auroc': 0.9934702, 'binary_precision': 0.9792281, 'binary_recall': 0.9257951, 'binary_specificity': 0.99317175, 'binary_f1_score': 0.95176226}
confusion matrix:
       0      1
0  42035    289
1   1092  13624
---- Validation: 
scalar performance:
{'acc': 0.95530015, 'precision': 0.6823313, 'recall': 0.7353405, 'specificity': 0.7353405, 'f1': 0.7049655, 'auroc': 0.90298414, 'binary_precision': 0.38259834, 'binary_recall': 0.4992224, 'binary_specificity': 0.9714585, 'binary_f1_score': 0.43319836}
confusion matrix:
       0    1
0  17631  518
1    322  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7523816, 'recall': 0.8217423, 'specificity': 0.8217423, 'f1': 0.78223765, 'auroc': 0.91458184, 'binary_precision': 0.5192878, 'binary_recall': 0.6704981, 'binary_specificity': 0.9729865, 'binary_f1_score': 0.58528423}
confusion matrix:
      0    1
0  5835  162
1    86  175
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_8.png
early stop counter: 1
val acc:0.9553001523017883, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 8,now: 2024-07-06 04:46:41.168087,epoch time: 0:25:55.342340,used: 3:28:48.751259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9755961, 'precision': 0.97668064, 'recall': 0.9592426, 'specificity': 0.9592426, 'f1': 0.9675447, 'auroc': 0.9932033, 'binary_precision': 0.97879833, 'binary_recall': 0.9254553, 'binary_specificity': 0.99302995, 'binary_f1_score': 0.95137966}
confusion matrix:
       0      1
0  42029    295
1   1097  13619
---- Validation: 
scalar performance:
{'acc': 0.9551405, 'precision': 0.6850349, 'recall': 0.751009, 'specificity': 0.751009, 'f1': 0.7122787, 'auroc': 0.9084891, 'binary_precision': 0.38687783, 'binary_recall': 0.5318818, 'binary_specificity': 0.9701361, 'binary_f1_score': 0.44793713}
confusion matrix:
       0    1
0  17607  542
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.75183463, 'recall': 0.8344853, 'specificity': 0.8344853, 'f1': 0.78644097, 'auroc': 0.916506, 'binary_precision': 0.51704544, 'binary_recall': 0.697318, 'binary_specificity': 0.9716525, 'binary_f1_score': 0.59380096}
confusion matrix:
      0    1
0  5827  170
1    79  182
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_9.png
early stop counter: 2
val acc:0.9551404714584351, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 9,now: 2024-07-06 05:12:23.309804,epoch time: 0:25:42.141717,used: 3:54:30.892976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9782959, 'precision': 0.97840655, 'recall': 0.9646121, 'specificity': 0.9646121, 'f1': 0.9712485, 'auroc': 0.99423456, 'binary_precision': 0.9786252, 'binary_recall': 0.93633646, 'binary_specificity': 0.99288785, 'binary_f1_score': 0.9570139}
confusion matrix:
       0      1
0  42021    301
1    937  13781
---- Validation: 
scalar performance:
{'acc': 0.9531183, 'precision': 0.6775428, 'recall': 0.7522122, 'specificity': 0.7522122, 'f1': 0.7073736, 'auroc': 0.9057222, 'binary_precision': 0.37176725, 'binary_recall': 0.5365474, 'binary_specificity': 0.96787703, 'binary_f1_score': 0.43921068}
confusion matrix:
       0    1
0  17566  583
1    298  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9544583, 'precision': 0.72813064, 'recall': 0.83514845, 'specificity': 0.83514845, 'f1': 0.7697643, 'auroc': 0.9155102, 'binary_precision': 0.46938777, 'binary_recall': 0.70498085, 'binary_specificity': 0.965316, 'binary_f1_score': 0.56355286}
confusion matrix:
      0    1
0  5789  208
1    77  184
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_10.png
early stop counter: 3
val acc:0.9531183242797852, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 10,now: 2024-07-06 05:38:09.367619,epoch time: 0:25:46.057815,used: 4:20:16.950791,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9781206, 'precision': 0.9811338, 'recall': 0.9615865, 'specificity': 0.9615865, 'f1': 0.9708438, 'auroc': 0.99468064, 'binary_precision': 0.98698294, 'binary_recall': 0.9274259, 'binary_specificity': 0.9957471, 'binary_f1_score': 0.95627797}
confusion matrix:
       0      1
0  42144    180
1   1068  13648
---- Validation: 
scalar performance:
{'acc': 0.9568433, 'precision': 0.68965644, 'recall': 0.73838955, 'specificity': 0.73838955, 'f1': 0.710845, 'auroc': 0.9049208, 'binary_precision': 0.3970588, 'binary_recall': 0.503888, 'binary_specificity': 0.9728911, 'binary_f1_score': 0.4441398}
confusion matrix:
       0    1
0  17657  492
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95605624, 'precision': 0.733224, 'recall': 0.8213235, 'specificity': 0.8213235, 'f1': 0.7691364, 'auroc': 0.9164704, 'binary_precision': 0.48087433, 'binary_recall': 0.6743295, 'binary_specificity': 0.9683175, 'binary_f1_score': 0.5614035}
confusion matrix:
      0    1
0  5807  190
1    85  176
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_11.png
early stop counter: 4
val acc:0.9568433165550232, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 11,now: 2024-07-06 06:04:26.133413,epoch time: 0:26:16.765794,used: 4:46:33.716585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98117113, 'precision': 0.98062754, 'recall': 0.9699603, 'specificity': 0.9699603, 'f1': 0.97513825, 'auroc': 0.9953121, 'binary_precision': 0.97954303, 'binary_recall': 0.94679624, 'binary_specificity': 0.9931243, 'binary_f1_score': 0.9628913}
confusion matrix:
       0      1
0  42032    291
1    783  13934
---- Validation: 
scalar performance:
{'acc': 0.9462537, 'precision': 0.6609729, 'recall': 0.77416015, 'specificity': 0.77416015, 'f1': 0.7002667, 'auroc': 0.9059215, 'binary_precision': 0.33688888, 'binary_recall': 0.58942455, 'binary_specificity': 0.9588958, 'binary_f1_score': 0.42873305}
confusion matrix:
       0    1
0  17403  746
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9340045, 'precision': 0.6730751, 'recall': 0.83913505, 'specificity': 0.83913505, 'f1': 0.72328246, 'auroc': 0.9150431, 'binary_precision': 0.35820895, 'binary_recall': 0.7356322, 'binary_specificity': 0.942638, 'binary_f1_score': 0.4818068}
confusion matrix:
      0    1
0  5653  344
1    69  192
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_12.png
early stop counter: 5
val acc:0.9462537169456482, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 12,now: 2024-07-06 06:30:12.363576,epoch time: 0:25:46.230163,used: 5:12:19.946748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98050493, 'precision': 0.9810765, 'recall': 0.96778286, 'specificity': 0.96778286, 'f1': 0.974189, 'auroc': 0.9950079, 'binary_precision': 0.9822074, 'binary_recall': 0.94149625, 'binary_specificity': 0.9940694, 'binary_f1_score': 0.9614211}
confusion matrix:
       0      1
0  42072    251
1    861  13856
---- Validation: 
scalar performance:
{'acc': 0.94524264, 'precision': 0.6592079, 'recall': 0.7781371, 'specificity': 0.7781371, 'f1': 0.69963026, 'auroc': 0.90824544, 'binary_precision': 0.33304498, 'binary_recall': 0.59875584, 'binary_specificity': 0.95751834, 'binary_f1_score': 0.42801556}
confusion matrix:
       0    1
0  17378  771
1    258  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93208694, 'precision': 0.66949797, 'recall': 0.8399669, 'specificity': 0.8399669, 'f1': 0.7198231, 'auroc': 0.91490954, 'binary_precision': 0.35090908, 'binary_recall': 0.7394636, 'binary_specificity': 0.9404702, 'binary_f1_score': 0.4759556}
confusion matrix:
      0    1
0  5640  357
1    68  193
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_13.png
early stop counter: 6
val acc:0.9452426433563232, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 13,now: 2024-07-06 06:56:23.850181,epoch time: 0:26:11.486605,used: 5:38:31.433353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9814341, 'precision': 0.9814203, 'recall': 0.9698751, 'specificity': 0.9698751, 'f1': 0.9754659, 'auroc': 0.9954297, 'binary_precision': 0.98139274, 'binary_recall': 0.9459882, 'binary_specificity': 0.99376196, 'binary_f1_score': 0.96336526}
confusion matrix:
       0      1
0  42057    264
1    795  13924
---- Validation: 
scalar performance:
{'acc': 0.94705194, 'precision': 0.6622246, 'recall': 0.7700731, 'specificity': 0.7700731, 'f1': 0.7003647, 'auroc': 0.9066234, 'binary_precision': 0.33970857, 'binary_recall': 0.5800933, 'binary_specificity': 0.9600529, 'binary_f1_score': 0.4284894}
confusion matrix:
       0    1
0  17424  725
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9333653, 'precision': 0.6699556, 'recall': 0.8296399, 'specificity': 0.8296399, 'f1': 0.7186271, 'auroc': 0.91251546, 'binary_precision': 0.3528302, 'binary_recall': 0.71647507, 'binary_specificity': 0.94280475, 'binary_f1_score': 0.47281924}
confusion matrix:
      0    1
0  5654  343
1    74  187
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_14.png
early stop counter: 7
val acc:0.9470519423484802, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 14,now: 2024-07-06 07:22:16.325432,epoch time: 0:25:52.475251,used: 6:04:23.908604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9824509, 'precision': 0.9835845, 'recall': 0.97041845, 'specificity': 0.97041845, 'f1': 0.97676706, 'auroc': 0.99568844, 'binary_precision': 0.9858287, 'binary_recall': 0.94556206, 'binary_specificity': 0.9952748, 'binary_f1_score': 0.96527565}
confusion matrix:
       0      1
0  42126    200
1    801  13913
---- Validation: 
scalar performance:
{'acc': 0.94566834, 'precision': 0.6559374, 'recall': 0.7596061, 'specificity': 0.7596061, 'f1': 0.69253504, 'auroc': 0.9031095, 'binary_precision': 0.32786885, 'binary_recall': 0.5598756, 'binary_specificity': 0.9593366, 'binary_f1_score': 0.41355544}
confusion matrix:
       0    1
0  17411  738
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93064874, 'precision': 0.66407824, 'recall': 0.8263902, 'specificity': 0.8263902, 'f1': 0.7122381, 'auroc': 0.9099577, 'binary_precision': 0.3412844, 'binary_recall': 0.7126437, 'binary_specificity': 0.94013673, 'binary_f1_score': 0.46153843}
confusion matrix:
      0    1
0  5638  359
1    75  186
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_15.png
early stop counter: 8
val acc:0.9456683397293091, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 15,now: 2024-07-06 07:47:56.146034,epoch time: 0:25:39.820602,used: 6:30:03.729206,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98164445, 'precision': 0.9785987, 'recall': 0.97326815, 'specificity': 0.97326815, 'f1': 0.9758941, 'auroc': 0.9956237, 'binary_precision': 0.97241807, 'binary_recall': 0.9559633, 'binary_specificity': 0.9905729, 'binary_f1_score': 0.96412045}
confusion matrix:
       0      1
0  41926    399
1    648  14067
---- Validation: 
scalar performance:
{'acc': 0.94183695, 'precision': 0.64936405, 'recall': 0.7718736, 'specificity': 0.7718736, 'f1': 0.6894602, 'auroc': 0.9048486, 'binary_precision': 0.3137417, 'binary_recall': 0.58942455, 'binary_specificity': 0.9543226, 'binary_f1_score': 0.40950832}
confusion matrix:
       0    1
0  17320  829
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9223394, 'precision': 0.6491546, 'recall': 0.82205474, 'specificity': 0.82205474, 'f1': 0.6959392, 'auroc': 0.90990484, 'binary_precision': 0.3115578, 'binary_recall': 0.7126437, 'binary_specificity': 0.93146574, 'binary_f1_score': 0.43356645}
confusion matrix:
      0    1
0  5586  411
1    75  186
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_16.png
early stop counter: 9
val acc:0.941836953163147, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 16,now: 2024-07-06 08:13:11.987359,epoch time: 0:25:15.841325,used: 6:55:19.570531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.982223, 'precision': 0.98196465, 'recall': 0.9714004, 'specificity': 0.9714004, 'f1': 0.97653043, 'auroc': 0.99567455, 'binary_precision': 0.98144895, 'binary_recall': 0.9490385, 'binary_specificity': 0.99376225, 'binary_f1_score': 0.9649717}
confusion matrix:
       0      1
0  42059    264
1    750  13967
---- Validation: 
scalar performance:
{'acc': 0.94785017, 'precision': 0.66123575, 'recall': 0.7562353, 'specificity': 0.7562353, 'f1': 0.69606507, 'auroc': 0.90470153, 'binary_precision': 0.338756, 'binary_recall': 0.5505443, 'binary_specificity': 0.9619263, 'binary_f1_score': 0.41943127}
confusion matrix:
       0    1
0  17458  691
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93224674, 'precision': 0.6634735, 'recall': 0.8089006, 'specificity': 0.8089006, 'f1': 0.7087462, 'auroc': 0.90809345, 'binary_precision': 0.34174758, 'binary_recall': 0.6743295, 'binary_specificity': 0.9434717, 'binary_f1_score': 0.45360827}
confusion matrix:
      0    1
0  5658  339
1    85  176
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_17.png
early stop counter: 10
val acc:0.9478501677513123, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 17,now: 2024-07-06 08:38:31.603506,epoch time: 0:25:19.616147,used: 7:20:39.186678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98373073, 'precision': 0.9849892, 'recall': 0.9723959, 'specificity': 0.9723959, 'f1': 0.97847867, 'auroc': 0.9961412, 'binary_precision': 0.9874859, 'binary_recall': 0.9489741, 'binary_specificity': 0.9958178, 'binary_f1_score': 0.967847}
confusion matrix:
       0      1
0  42145    177
1    751  13967
---- Validation: 
scalar performance:
{'acc': 0.9472648, 'precision': 0.65854245, 'recall': 0.752182, 'specificity': 0.752182, 'f1': 0.692827, 'auroc': 0.90428084, 'binary_precision': 0.33365202, 'binary_recall': 0.5427683, 'binary_specificity': 0.96159565, 'binary_f1_score': 0.41326228}
confusion matrix:
       0    1
0  17452  697
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93208694, 'precision': 0.661953, 'recall': 0.8033202, 'specificity': 0.8033202, 'f1': 0.70629114, 'auroc': 0.9061823, 'binary_precision': 0.3392157, 'binary_recall': 0.66283524, 'binary_specificity': 0.9438052, 'binary_f1_score': 0.44876787}
confusion matrix:
      0    1
0  5660  337
1    88  173
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_18.png
early stop counter: 11
val acc:0.9472647905349731, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 18,now: 2024-07-06 09:04:39.286968,epoch time: 0:26:07.683462,used: 7:46:46.870140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98316973, 'precision': 0.9830467, 'recall': 0.97281075, 'specificity': 0.97281075, 'f1': 0.97778636, 'auroc': 0.99648774, 'binary_precision': 0.98280096, 'binary_recall': 0.9514101, 'binary_specificity': 0.99421144, 'binary_f1_score': 0.9668509}
confusion matrix:
       0      1
0  42080    245
1    715  14000
---- Validation: 
scalar performance:
{'acc': 0.94928694, 'precision': 0.66035426, 'recall': 0.7352275, 'specificity': 0.7352275, 'f1': 0.68950176, 'auroc': 0.90075755, 'binary_precision': 0.33854166, 'binary_recall': 0.5054432, 'binary_specificity': 0.96501184, 'binary_f1_score': 0.4054897}
confusion matrix:
       0    1
0  17514  635
1    318  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93688077, 'precision': 0.6710752, 'recall': 0.7984922, 'specificity': 0.7984922, 'f1': 0.7137979, 'auroc': 0.90521044, 'binary_precision': 0.35805085, 'binary_recall': 0.6475096, 'binary_specificity': 0.94947475, 'binary_f1_score': 0.4611187}
confusion matrix:
      0    1
0  5694  303
1    92  169
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_19.png
early stop counter: 12
val acc:0.949286937713623, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 19,now: 2024-07-06 09:30:03.941808,epoch time: 0:25:24.654840,used: 8:12:11.524980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98485273, 'precision': 0.98356676, 'recall': 0.97671425, 'specificity': 0.97671425, 'f1': 0.9800765, 'auroc': 0.9966457, 'binary_precision': 0.9809696, 'binary_recall': 0.9599021, 'binary_specificity': 0.99352646, 'binary_f1_score': 0.9703215}
confusion matrix:
       0      1
0  42052    274
1    590  14124
---- Validation: 
scalar performance:
{'acc': 0.94332695, 'precision': 0.6509121, 'recall': 0.7636443, 'specificity': 0.7636443, 'f1': 0.68912166, 'auroc': 0.9023917, 'binary_precision': 0.31747404, 'binary_recall': 0.57076204, 'binary_specificity': 0.9565265, 'binary_f1_score': 0.40800443}
confusion matrix:
       0    1
0  17360  789
1    276  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9228188, 'precision': 0.64625406, 'recall': 0.8058138, 'specificity': 0.8058138, 'f1': 0.69079137, 'auroc': 0.9039678, 'binary_precision': 0.30729166, 'binary_recall': 0.6781609, 'binary_specificity': 0.93346673, 'binary_f1_score': 0.42293906}
confusion matrix:
      0    1
0  5598  399
1    84  177
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_20.png
early stop counter: 13
val acc:0.9433269500732422, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 20,now: 2024-07-06 09:55:23.165773,epoch time: 0:25:19.223965,used: 8:37:30.748945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98546636, 'precision': 0.98655957, 'recall': 0.97537947, 'specificity': 0.97537947, 'f1': 0.9808014, 'auroc': 0.9971312, 'binary_precision': 0.98873794, 'binary_recall': 0.9545393, 'binary_specificity': 0.99621964, 'binary_f1_score': 0.97133774}
confusion matrix:
       0      1
0  42164    160
1    669  14047
---- Validation: 
scalar performance:
{'acc': 0.9522137, 'precision': 0.6686176, 'recall': 0.7284922, 'specificity': 0.7284922, 'f1': 0.69331455, 'auroc': 0.90368825, 'binary_precision': 0.3556059, 'binary_recall': 0.48833594, 'binary_specificity': 0.96864843, 'binary_f1_score': 0.41153345}
confusion matrix:
       0    1
0  17580  569
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94566953, 'precision': 0.6908794, 'recall': 0.7810898, 'specificity': 0.7810898, 'f1': 0.72572964, 'auroc': 0.90261924, 'binary_precision': 0.3994911, 'binary_recall': 0.6015326, 'binary_specificity': 0.960647, 'binary_f1_score': 0.48012236}
confusion matrix:
      0    1
0  5761  236
1   104  157
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_21.png
early stop counter: 14
val acc:0.952213704586029, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 21,now: 2024-07-06 10:20:47.424233,epoch time: 0:25:24.258460,used: 9:02:55.007405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9845021, 'precision': 0.9848707, 'recall': 0.9745096, 'specificity': 0.9745096, 'f1': 0.9795449, 'auroc': 0.99677634, 'binary_precision': 0.98560697, 'binary_recall': 0.9538629, 'binary_specificity': 0.9951563, 'binary_f1_score': 0.9694752}
confusion matrix:
       0      1
0  42118    205
1    679  14038
---- Validation: 
scalar performance:
{'acc': 0.9499255, 'precision': 0.6591211, 'recall': 0.72280717, 'specificity': 0.72280717, 'f1': 0.68475664, 'auroc': 0.8988371, 'binary_precision': 0.3369803, 'binary_recall': 0.47900465, 'binary_specificity': 0.9666097, 'binary_f1_score': 0.39563265}
confusion matrix:
       0    1
0  17543  606
1    335  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9447108, 'precision': 0.68680686, 'recall': 0.7750925, 'specificity': 0.7750925, 'f1': 0.7208896, 'auroc': 0.89558655, 'binary_precision': 0.3918575, 'binary_recall': 0.5900383, 'binary_specificity': 0.9601467, 'binary_f1_score': 0.470948}
confusion matrix:
      0    1
0  5758  239
1   107  154
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_22.png
early stop counter: 15
val acc:0.9499254822731018, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 22,now: 2024-07-06 10:46:08.197392,epoch time: 0:25:20.773159,used: 9:28:15.780564,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98664093, 'precision': 0.98642856, 'recall': 0.97856706, 'specificity': 0.97856706, 'f1': 0.98241425, 'auroc': 0.9970755, 'binary_precision': 0.98600084, 'binary_recall': 0.9618834, 'binary_specificity': 0.9952507, 'binary_f1_score': 0.9737928}
confusion matrix:
       0      1
0  42121    201
1    561  14157
---- Validation: 
scalar performance:
{'acc': 0.94721156, 'precision': 0.6596731, 'recall': 0.7574048, 'specificity': 0.7574048, 'f1': 0.6950964, 'auroc': 0.9057807, 'binary_precision': 0.33553252, 'binary_recall': 0.55365473, 'binary_specificity': 0.9611549, 'binary_f1_score': 0.4178404}
confusion matrix:
       0    1
0  17444  705
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9389581, 'precision': 0.6719308, 'recall': 0.7794204, 'specificity': 0.7794204, 'f1': 0.71019924, 'auroc': 0.89999115, 'binary_precision': 0.36155605, 'binary_recall': 0.60536397, 'binary_specificity': 0.9534767, 'binary_f1_score': 0.45272204}
confusion matrix:
      0    1
0  5718  279
1   103  158
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_23.png
early stop counter: 16
val acc:0.9472115635871887, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 23,now: 2024-07-06 11:11:21.456509,epoch time: 0:25:13.259117,used: 9:53:29.039681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9860624, 'precision': 0.9845214, 'recall': 0.97895044, 'specificity': 0.97895044, 'f1': 0.9816936, 'auroc': 0.9968972, 'binary_precision': 0.98139566, 'binary_recall': 0.9642566, 'binary_specificity': 0.9936443, 'binary_f1_score': 0.97275066}
confusion matrix:
       0      1
0  42055    269
1    526  14190
---- Validation: 
scalar performance:
{'acc': 0.944338, 'precision': 0.65076095, 'recall': 0.75291693, 'specificity': 0.75291693, 'f1': 0.68654776, 'auroc': 0.9034249, 'binary_precision': 0.3179765, 'binary_recall': 0.5474339, 'binary_specificity': 0.9583999, 'binary_f1_score': 0.4022857}
confusion matrix:
       0    1
0  17394  755
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92825186, 'precision': 0.6491445, 'recall': 0.7793312, 'specificity': 0.7793312, 'f1': 0.6897052, 'auroc': 0.8968486, 'binary_precision': 0.3156863, 'binary_recall': 0.61685824, 'binary_specificity': 0.94180423, 'binary_f1_score': 0.41763946}
confusion matrix:
      0    1
0  5648  349
1   100  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_24.png
early stop counter: 17
val acc:0.9443380236625671, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 24,now: 2024-07-06 11:36:43.781322,epoch time: 0:25:22.324813,used: 10:18:51.364494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98609746, 'precision': 0.9872418, 'recall': 0.9763632, 'specificity': 0.9763632, 'f1': 0.98164344, 'auroc': 0.99713695, 'binary_precision': 0.9895247, 'binary_recall': 0.95624703, 'binary_specificity': 0.9964793, 'binary_f1_score': 0.9726013}
confusion matrix:
       0      1
0  42172    149
1    644  14075
---- Validation: 
scalar performance:
{'acc': 0.953278, 'precision': 0.66664916, 'recall': 0.7057915, 'specificity': 0.7057915, 'f1': 0.6838362, 'auroc': 0.9001939, 'binary_precision': 0.35330835, 'binary_recall': 0.44012442, 'binary_specificity': 0.9714585, 'binary_f1_score': 0.39196676}
confusion matrix:
       0    1
0  17631  518
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9496644, 'precision': 0.7015622, 'recall': 0.76485085, 'specificity': 0.76485085, 'f1': 0.7281518, 'auroc': 0.8948806, 'binary_precision': 0.4224138, 'binary_recall': 0.5632184, 'binary_specificity': 0.96648324, 'binary_f1_score': 0.48275864}
confusion matrix:
      0    1
0  5796  201
1   114  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_25.png
early stop counter: 18
val acc:0.9532780051231384, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 25,now: 2024-07-06 12:01:39.358213,epoch time: 0:24:55.576891,used: 10:43:46.941385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98602736, 'precision': 0.98655117, 'recall': 0.9768449, 'specificity': 0.9768449, 'f1': 0.98157096, 'auroc': 0.99723566, 'binary_precision': 0.98759985, 'binary_recall': 0.95787185, 'binary_specificity': 0.9958179, 'binary_f1_score': 0.97250867}
confusion matrix:
       0      1
0  42146    177
1    620  14097
---- Validation: 
scalar performance:
{'acc': 0.9476373, 'precision': 0.65740323, 'recall': 0.7433741, 'specificity': 0.7433741, 'f1': 0.6895621, 'auroc': 0.9031167, 'binary_precision': 0.33201972, 'binary_recall': 0.5241057, 'binary_specificity': 0.96264255, 'binary_f1_score': 0.40651387}
confusion matrix:
       0    1
0  17471  678
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9447108, 'precision': 0.6871628, 'recall': 0.77692485, 'specificity': 0.77692485, 'f1': 0.7216937, 'auroc': 0.8961524, 'binary_precision': 0.39240506, 'binary_recall': 0.59386975, 'binary_specificity': 0.95998, 'binary_f1_score': 0.47256097}
confusion matrix:
      0    1
0  5757  240
1   106  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_26.png
early stop counter: 19
val acc:0.9476373195648193, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 26,now: 2024-07-06 12:26:33.359842,epoch time: 0:24:54.001629,used: 11:08:40.943014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98779804, 'precision': 0.9876043, 'recall': 0.9804325, 'specificity': 0.9804325, 'f1': 0.98394907, 'auroc': 0.997702, 'binary_precision': 0.9872133, 'binary_recall': 0.96521264, 'binary_specificity': 0.9956524, 'binary_f1_score': 0.97608906}
confusion matrix:
       0      1
0  42138    184
1    512  14206
---- Validation: 
scalar performance:
{'acc': 0.950298, 'precision': 0.6591884, 'recall': 0.7184997, 'specificity': 0.7184997, 'f1': 0.68340325, 'auroc': 0.897799, 'binary_precision': 0.33743018, 'binary_recall': 0.4696734, 'binary_specificity': 0.96732605, 'binary_f1_score': 0.3927178}
confusion matrix:
       0    1
0  17556  593
1    341  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94519013, 'precision': 0.68578815, 'recall': 0.7625163, 'specificity': 0.7625163, 'f1': 0.71633196, 'auroc': 0.8937528, 'binary_precision': 0.39095744, 'binary_recall': 0.5632184, 'binary_specificity': 0.9618142, 'binary_f1_score': 0.46153846}
confusion matrix:
      0    1
0  5768  229
1   114  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_27.png
early stop counter: 20
val acc:0.950298011302948, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 27,now: 2024-07-06 12:51:28.585810,epoch time: 0:24:55.225968,used: 11:33:36.168982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98695654, 'precision': 0.986555, 'recall': 0.9792636, 'specificity': 0.9792636, 'f1': 0.98283744, 'auroc': 0.9977009, 'binary_precision': 0.9857451, 'binary_recall': 0.9633707, 'binary_specificity': 0.9951565, 'binary_f1_score': 0.9744294}
confusion matrix:
       0      1
0  42120    205
1    539  14176
---- Validation: 
scalar performance:
{'acc': 0.95232016, 'precision': 0.66649, 'recall': 0.71879655, 'specificity': 0.71879655, 'f1': 0.68851984, 'auroc': 0.900694, 'binary_precision': 0.3520468, 'binary_recall': 0.4681182, 'binary_specificity': 0.9694749, 'binary_f1_score': 0.40186918}
confusion matrix:
       0    1
0  17595  554
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949984, 'precision': 0.69999486, 'recall': 0.7485266, 'specificity': 0.7485266, 'f1': 0.7211739, 'auroc': 0.89192426, 'binary_precision': 0.4207317, 'binary_recall': 0.52873564, 'binary_specificity': 0.9683175, 'binary_f1_score': 0.46859086}
confusion matrix:
      0    1
0  5807  190
1   123  138
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_28.png
early stop counter: 21
val acc:0.9523201584815979, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 28,now: 2024-07-06 13:16:24.262493,epoch time: 0:24:55.676683,used: 11:58:31.845665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98797333, 'precision': 0.9871664, 'recall': 0.981321, 'specificity': 0.981321, 'f1': 0.9841975, 'auroc': 0.9978415, 'binary_precision': 0.98553133, 'binary_recall': 0.96757966, 'binary_specificity': 0.99506223, 'binary_f1_score': 0.97647303}
confusion matrix:
       0      1
0  42118    209
1    477  14236
---- Validation: 
scalar performance:
{'acc': 0.9521605, 'precision': 0.6687959, 'recall': 0.72996473, 'specificity': 0.72996473, 'f1': 0.69393325, 'auroc': 0.90554655, 'binary_precision': 0.35585585, 'binary_recall': 0.49144635, 'binary_specificity': 0.9684831, 'binary_f1_score': 0.41280207}
confusion matrix:
       0    1
0  17577  572
1    327  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.7301813, 'recall': 0.7628555, 'specificity': 0.7628555, 'f1': 0.7452667, 'auroc': 0.8982949, 'binary_precision': 0.48, 'binary_recall': 0.55172414, 'binary_specificity': 0.973987, 'binary_f1_score': 0.51336896}
confusion matrix:
      0    1
0  5841  156
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_29.png
early stop counter: 22
val acc:0.9521604776382446, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 29,now: 2024-07-06 13:41:59.782951,epoch time: 0:25:35.520458,used: 12:24:07.366123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98762274, 'precision': 0.9883443, 'recall': 0.9792483, 'specificity': 0.9792483, 'f1': 0.98368526, 'auroc': 0.9974724, 'binary_precision': 0.98979163, 'binary_recall': 0.9619462, 'binary_specificity': 0.99655044, 'binary_f1_score': 0.9756702}
confusion matrix:
       0      1
0  42178    146
1    560  14156
---- Validation: 
scalar performance:
{'acc': 0.95333123, 'precision': 0.6701107, 'recall': 0.7178199, 'specificity': 0.7178199, 'f1': 0.6905681, 'auroc': 0.9036776, 'binary_precision': 0.359375, 'binary_recall': 0.46500778, 'binary_specificity': 0.970632, 'binary_f1_score': 0.40542373}
confusion matrix:
       0    1
0  17616  533
1    344  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.7273177, 'recall': 0.7389518, 'specificity': 0.7389518, 'f1': 0.7329672, 'auroc': 0.8939375, 'binary_precision': 0.47636363, 'binary_recall': 0.5019157, 'binary_specificity': 0.975988, 'binary_f1_score': 0.48880592}
confusion matrix:
      0    1
0  5853  144
1   130  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_30.png
early stop counter: 23
val acc:0.9533312320709229, best validation acc: 0.9575351476669312, corresponding to test acc:                         0.9637264013290405 / 0.9645254015922546
after epoch: 30,now: 2024-07-06 14:06:47.891238,epoch time: 0:24:48.108287,used: 12:48:55.474410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_17_52_seed_0_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:48:55.474410 at 2024-07-06 14:06:47.891238
persisted model performance metric: 

scalar performance:
{'acc': 0.9637264, 'precision': 0.7699379, 'recall': 0.81799614, 'specificity': 0.81799614, 'f1': 0.791724, 'auroc': 0.9141135, 'binary_precision': 0.5548387, 'binary_recall': 0.65900385, 'binary_specificity': 0.9769885, 'binary_f1_score': 0.6024518}
confusion matrix:
      0    1
0  5859  138
1    89  172
oracle model performance metric: 

scalar performance:
{'acc': 0.9645254, 'precision': 0.7775033, 'recall': 0.78359866, 'specificity': 0.78359866, 'f1': 0.78051347, 'auroc': 0.9070449, 'binary_precision': 0.5730337, 'binary_recall': 0.5862069, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.57954544}
confusion matrix:
      0    1
0  5883  114
1   108  153
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB |   1195 TiB |   1195 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1179 TiB |   1179 TiB |
|       from small pool |  16482 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59895 KiB | 732464 KiB | 687393 GiB | 687393 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 671688 GiB | 671688 GiB |
|       from small pool |   9133 KiB |  11093 KiB |  15704 GiB |  15704 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7625    |  197304 K  |  197301 K  |
|       from large pool |      79    |     762    |  112031 K  |  112031 K  |
|       from small pool |    2899    |    7544    |   85272 K  |   85269 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7625    |  197304 K  |  197301 K  |
|       from large pool |      79    |     762    |  112031 K  |  112031 K  |
|       from small pool |    2899    |    7544    |   85272 K  |   85269 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3589    |  121783 K  |  121783 K  |
|       from large pool |      10    |     350    |   86069 K  |   86069 K  |
|       from small pool |      27    |    3579    |   35713 K  |   35713 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 687393 GiB | 687393 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 671689 GiB | 671689 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15704 GiB |  15704 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  197304 K  |  197304 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85272 K  |   85272 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  197304 K  |  197304 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85272 K  |   85272 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  121784 K  |  121784 K  |
|       from large pool |       3    |     350    |   86069 K  |   86069 K  |
|       from small pool |       0    |    3579    |   35714 K  |   35714 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 687393 GiB | 687393 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 671689 GiB | 671689 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15704 GiB |  15704 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  197304 K  |  197304 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85272 K  |   85272 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  197304 K  |  197304 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85272 K  |   85272 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  121784 K  |  121784 K  |
|       from large pool |       3    |     350    |   86069 K  |   86069 K  |
|       from small pool |       0    |    3579    |   35714 K  |   35714 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431

 Experiment start at: 2024-07-06 14:13:00.339357
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9256581, 'precision': 0.9305377, 'recall': 0.86976504, 'specificity': 0.86976504, 'f1': 0.8947519, 'auroc': 0.9431095, 'binary_precision': 0.93879133, 'binary_recall': 0.7562938, 'binary_specificity': 0.98323625, 'binary_f1_score': 0.8377185}
confusion matrix:
       0      1
0  41702    711
1   3514  10905
---- Validation: 
scalar performance:
{'acc': 0.9434365, 'precision': 0.51296103, 'recall': 0.5086021, 'specificity': 0.5086021, 'f1': 0.5096629, 'auroc': 0.74670434, 'binary_precision': 0.06122449, 'binary_recall': 0.04011887, 'binary_specificity': 0.9770853, 'binary_f1_score': 0.048473965}
confusion matrix:
       0    1
0  17653  414
1    646   27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93844664, 'precision': 0.4979483, 'recall': 0.49893594, 'specificity': 0.49893594, 'f1': 0.4968649, 'auroc': 0.7019986, 'binary_precision': 0.03787879, 'binary_recall': 0.01923077, 'binary_specificity': 0.9786411, 'binary_f1_score': 0.025510205}
confusion matrix:
      0    1
0  5819  127
1   255    5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-06 14:39:05.945412,epoch time: 0:26:05.606055,used: 0:26:05.606055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9506616, 'precision': 0.96074015, 'recall': 0.9087806, 'specificity': 0.9087806, 'f1': 0.93111455, 'auroc': 0.97078836, 'binary_precision': 0.9783361, 'binary_recall': 0.82376194, 'binary_specificity': 0.9937992, 'binary_f1_score': 0.8944197}
confusion matrix:
       0      1
0  42151    263
1   2541  11877
---- Validation: 
scalar performance:
{'acc': 0.9518143, 'precision': 0.56306285, 'recall': 0.5322592, 'specificity': 0.5322592, 'f1': 0.5410321, 'auroc': 0.80770326, 'binary_precision': 0.1597633, 'binary_recall': 0.08023774, 'binary_specificity': 0.9842807, 'binary_f1_score': 0.10682492}
confusion matrix:
       0    1
0  17783  284
1    619   54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9431196, 'precision': 0.50775516, 'recall': 0.5032135, 'specificity': 0.5032135, 'f1': 0.5017874, 'auroc': 0.78224015, 'binary_precision': 0.057142857, 'binary_recall': 0.023076924, 'binary_specificity': 0.98335016, 'binary_f1_score': 0.032876715}
confusion matrix:
      0   1
0  5847  99
1   254   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-06 15:04:47.005574,epoch time: 0:25:41.060162,used: 0:51:46.666217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9609375, 'precision': 0.96759105, 'recall': 0.9289508, 'specificity': 0.9289508, 'f1': 0.94626945, 'auroc': 0.9809015, 'binary_precision': 0.9796352, 'binary_recall': 0.8640083, 'binary_specificity': 0.99389327, 'binary_f1_score': 0.91819596}
confusion matrix:
       0      1
0  42153    259
1   1961  12459
---- Validation: 
scalar performance:
{'acc': 0.9532017, 'precision': 0.61006147, 'recall': 0.56802684, 'specificity': 0.56802684, 'f1': 0.5830585, 'auroc': 0.8396798, 'binary_precision': 0.2512195, 'binary_recall': 0.15304606, 'binary_specificity': 0.98300767, 'binary_f1_score': 0.19021235}
confusion matrix:
       0    1
0  17760  307
1    570  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94602, 'precision': 0.54780716, 'recall': 0.51943904, 'specificity': 0.51943904, 'f1': 0.52466595, 'auroc': 0.835369, 'binary_precision': 0.13592233, 'binary_recall': 0.053846154, 'binary_specificity': 0.98503196, 'binary_f1_score': 0.07713499}
confusion matrix:
      0   1
0  5857  89
1   246  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-06 15:30:23.052709,epoch time: 0:25:36.047135,used: 1:17:22.713352,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9674831, 'precision': 0.96936965, 'recall': 0.9441575, 'specificity': 0.9441575, 'f1': 0.9559047, 'auroc': 0.98521256, 'binary_precision': 0.972914, 'binary_recall': 0.89680284, 'binary_specificity': 0.99151206, 'binary_f1_score': 0.93330926}
confusion matrix:
       0      1
0  42053    360
1   1488  12931
---- Validation: 
scalar performance:
{'acc': 0.95597655, 'precision': 0.6543365, 'recall': 0.6080904, 'specificity': 0.6080904, 'f1': 0.6264894, 'auroc': 0.85904694, 'binary_precision': 0.33690986, 'binary_recall': 0.2332838, 'binary_specificity': 0.982897, 'binary_f1_score': 0.27568042}
confusion matrix:
       0    1
0  17758  309
1    516  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9474702, 'precision': 0.5884647, 'recall': 0.5404247, 'specificity': 0.5404247, 'f1': 0.5529466, 'auroc': 0.8594341, 'binary_precision': 0.21551724, 'binary_recall': 0.09615385, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.13297872}
confusion matrix:
      0   1
0  5855  91
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-06 15:56:16.540794,epoch time: 0:25:53.488085,used: 1:43:16.201437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9706503, 'precision': 0.9707118, 'recall': 0.95120025, 'specificity': 0.95120025, 'f1': 0.9604405, 'auroc': 0.98808825, 'binary_precision': 0.9708293, 'binary_recall': 0.9117137, 'binary_specificity': 0.99068683, 'binary_f1_score': 0.9403433}
confusion matrix:
       0      1
0  42018    395
1   1273  13146
---- Validation: 
scalar performance:
{'acc': 0.95880467, 'precision': 0.6818027, 'recall': 0.6238625, 'specificity': 0.6238625, 'f1': 0.6465758, 'auroc': 0.86880547, 'binary_precision': 0.39072847, 'binary_recall': 0.26300147, 'binary_specificity': 0.9847235, 'binary_f1_score': 0.3143872}
confusion matrix:
       0    1
0  17791  276
1    496  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95278764, 'precision': 0.6546155, 'recall': 0.56526756, 'specificity': 0.56526756, 'f1': 0.58865476, 'auroc': 0.880299, 'binary_precision': 0.34579438, 'binary_recall': 0.1423077, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.20163488}
confusion matrix:
      0   1
0  5876  70
1   223  37
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-06 16:22:02.717288,epoch time: 0:25:46.176494,used: 2:09:02.377931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97197, 'precision': 0.97460616, 'recall': 0.9510118, 'specificity': 0.9510118, 'f1': 0.9620662, 'auroc': 0.99084437, 'binary_precision': 0.9795857, 'binary_recall': 0.9084605, 'binary_specificity': 0.9935631, 'binary_f1_score': 0.9426834}
confusion matrix:
       0      1
0  42139    273
1   1320  13100
---- Validation: 
scalar performance:
{'acc': 0.96003205, 'precision': 0.68985605, 'recall': 0.61734635, 'specificity': 0.61734635, 'f1': 0.643912, 'auroc': 0.87502885, 'binary_precision': 0.40731707, 'binary_recall': 0.24814264, 'binary_specificity': 0.9865501, 'binary_f1_score': 0.3084026}
confusion matrix:
       0    1
0  17824  243
1    506  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.71343374, 'recall': 0.5784878, 'specificity': 0.5784878, 'f1': 0.61074245, 'auroc': 0.8917912, 'binary_precision': 0.4623656, 'binary_recall': 0.16538462, 'binary_specificity': 0.991591, 'binary_f1_score': 0.24362607}
confusion matrix:
      0   1
0  5896  50
1   217  43
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-06 16:47:42.341362,epoch time: 0:25:39.624074,used: 2:34:42.002005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9741519, 'precision': 0.9735621, 'recall': 0.9577143, 'specificity': 0.9577143, 'f1': 0.96529937, 'auroc': 0.9918554, 'binary_precision': 0.97242284, 'binary_recall': 0.9243412, 'binary_specificity': 0.99108744, 'binary_f1_score': 0.9477726}
confusion matrix:
       0      1
0  42034    378
1   1091  13329
---- Validation: 
scalar performance:
{'acc': 0.96093917, 'precision': 0.7063743, 'recall': 0.647858, 'specificity': 0.647858, 'f1': 0.67166483, 'auroc': 0.880138, 'binary_precision': 0.43815514, 'binary_recall': 0.31054977, 'binary_specificity': 0.9851663, 'binary_f1_score': 0.36347827}
confusion matrix:
       0    1
0  17799  268
1    464  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.78596914, 'recall': 0.6251462, 'specificity': 0.6251462, 'f1': 0.6707516, 'auroc': 0.90265596, 'binary_precision': 0.6036036, 'binary_recall': 0.2576923, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.36118597}
confusion matrix:
      0   1
0  5902  44
1   193  67
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-06 17:13:15.779726,epoch time: 0:25:33.438364,used: 3:00:15.440369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9758763, 'precision': 0.97824395, 'recall': 0.9577914, 'specificity': 0.9577914, 'f1': 0.9674632, 'auroc': 0.99291587, 'binary_precision': 0.98275864, 'binary_recall': 0.92107636, 'binary_specificity': 0.9945064, 'binary_f1_score': 0.95091826}
confusion matrix:
       0      1
0  42180    233
1   1138  13281
---- Validation: 
scalar performance:
{'acc': 0.96195304, 'precision': 0.714478, 'recall': 0.64266175, 'specificity': 0.64266175, 'f1': 0.6704657, 'auroc': 0.8844135, 'binary_precision': 0.45475113, 'binary_recall': 0.2986627, 'binary_specificity': 0.9866608, 'binary_f1_score': 0.36053813}
confusion matrix:
       0    1
0  17826  241
1    472  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.83255756, 'recall': 0.63393164, 'specificity': 0.63393164, 'f1': 0.68700397, 'auroc': 0.9105009, 'binary_precision': 0.6960784, 'binary_recall': 0.27307692, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.3922652}
confusion matrix:
      0   1
0  5915  31
1   189  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-06 17:38:41.739803,epoch time: 0:25:25.960077,used: 3:25:41.400446,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97744226, 'precision': 0.979499, 'recall': 0.96069443, 'specificity': 0.96069443, 'f1': 0.9696288, 'auroc': 0.99355257, 'binary_precision': 0.98344004, 'binary_recall': 0.9266939, 'binary_specificity': 0.994695, 'binary_f1_score': 0.9542241}
confusion matrix:
       0      1
0  42188    225
1   1057  13362
---- Validation: 
scalar performance:
{'acc': 0.96179295, 'precision': 0.7143665, 'recall': 0.65044665, 'specificity': 0.65044665, 'f1': 0.6761135, 'auroc': 0.8844726, 'binary_precision': 0.45396146, 'binary_recall': 0.31500742, 'binary_specificity': 0.98588586, 'binary_f1_score': 0.37192982}
confusion matrix:
       0    1
0  17812  255
1    461  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.82110775, 'recall': 0.63928044, 'specificity': 0.63928044, 'f1': 0.69078225, 'auroc': 0.90858626, 'binary_precision': 0.6727273, 'binary_recall': 0.2846154, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.4}
confusion matrix:
      0   1
0  5910  36
1   186  74
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_9.png
early stop counter: 1
val acc:0.9617929458618164, best validation acc: 0.9619530439376831, corresponding to test acc:                         0.9645504355430603 / 0.9645504355430603
after epoch: 9,now: 2024-07-06 18:04:08.682251,epoch time: 0:25:26.942448,used: 3:51:08.342894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97842765, 'precision': 0.98026276, 'recall': 0.9625425, 'specificity': 0.9625425, 'f1': 0.97098756, 'auroc': 0.9941665, 'binary_precision': 0.9837905, 'binary_recall': 0.93029547, 'binary_specificity': 0.9947895, 'binary_f1_score': 0.95629543}
confusion matrix:
       0      1
0  42193    221
1   1005  13413
---- Validation: 
scalar performance:
{'acc': 0.9626467, 'precision': 0.72087234, 'recall': 0.6394452, 'specificity': 0.6394452, 'f1': 0.6698686, 'auroc': 0.88612413, 'binary_precision': 0.46778044, 'binary_recall': 0.29123327, 'binary_specificity': 0.98765707, 'binary_f1_score': 0.35897434}
confusion matrix:
       0    1
0  17844  223
1    477  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.8386097, 'recall': 0.641624, 'specificity': 0.641624, 'f1': 0.6959524, 'auroc': 0.9127908, 'binary_precision': 0.7075472, 'binary_recall': 0.28846154, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.40983605}
confusion matrix:
      0   1
0  5915  31
1   185  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_10.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-06 18:29:37.349121,epoch time: 0:25:28.666870,used: 4:16:37.009764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97884995, 'precision': 0.98008835, 'recall': 0.96381414, 'specificity': 0.96381414, 'f1': 0.9716003, 'auroc': 0.99501204, 'binary_precision': 0.9824792, 'binary_recall': 0.9332871, 'binary_specificity': 0.9943412, 'binary_f1_score': 0.9572516}
confusion matrix:
       0      1
0  42172    240
1    962  13458
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.7245812, 'recall': 0.6325139, 'specificity': 0.6325139, 'f1': 0.66531074, 'auroc': 0.88390505, 'binary_precision': 0.47570333, 'binary_recall': 0.27637443, 'binary_specificity': 0.98865336, 'binary_f1_score': 0.34962404}
confusion matrix:
       0    1
0  17862  205
1    487  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.8508066, 'recall': 0.62490493, 'specificity': 0.62490493, 'f1': 0.6795348, 'auroc': 0.91052353, 'binary_precision': 0.73333335, 'binary_recall': 0.25384617, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.37714288}
confusion matrix:
      0   1
0  5922  24
1   194  66
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_11.png
better model found
persisted
after epoch: 11,now: 2024-07-06 18:55:03.640741,epoch time: 0:25:26.291620,used: 4:42:03.301384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9797121, 'precision': 0.97798944, 'recall': 0.9681431, 'specificity': 0.9681431, 'f1': 0.97293615, 'auroc': 0.9949026, 'binary_precision': 0.9745993, 'binary_recall': 0.9446564, 'binary_specificity': 0.9916299, 'binary_f1_score': 0.9593942}
confusion matrix:
       0      1
0  42058    355
1    798  13621
---- Validation: 
scalar performance:
{'acc': 0.96254003, 'precision': 0.723465, 'recall': 0.66728526, 'specificity': 0.66728526, 'f1': 0.69084466, 'auroc': 0.8877355, 'binary_precision': 0.47094187, 'binary_recall': 0.34918275, 'binary_specificity': 0.98538774, 'binary_f1_score': 0.40102386}
confusion matrix:
       0    1
0  17803  264
1    438  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.8428728, 'recall': 0.6473932, 'specificity': 0.6473932, 'f1': 0.7025388, 'auroc': 0.9109519, 'binary_precision': 0.7155963, 'binary_recall': 0.3, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.4227642}
confusion matrix:
      0   1
0  5915  31
1   182  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_12.png
new oracle model saved
early stop counter: 1
val acc:0.9625400304794312, best validation acc: 0.9630736112594604, corresponding to test acc:                         0.9648727178573608 / 0.9656783938407898
after epoch: 12,now: 2024-07-06 19:20:49.290623,epoch time: 0:25:45.649882,used: 5:07:48.951266,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98082066, 'precision': 0.98215055, 'recall': 0.9670111, 'specificity': 0.9670111, 'f1': 0.97427845, 'auroc': 0.9953317, 'binary_precision': 0.98472726, 'binary_recall': 0.93897367, 'binary_specificity': 0.9950486, 'binary_f1_score': 0.96130633}
confusion matrix:
       0      1
0  42202    210
1    880  13540
---- Validation: 
scalar performance:
{'acc': 0.9632337, 'precision': 0.72864527, 'recall': 0.6547702, 'specificity': 0.6547702, 'f1': 0.68375695, 'auroc': 0.8915447, 'binary_precision': 0.48222223, 'binary_recall': 0.32243684, 'binary_specificity': 0.9871036, 'binary_f1_score': 0.38646483}
confusion matrix:
       0    1
0  17834  233
1    456  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.8568803, 'recall': 0.6534147, 'specificity': 0.6534147, 'f1': 0.71091795, 'auroc': 0.91582656, 'binary_precision': 0.74311924, 'binary_recall': 0.31153846, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.4390244}
confusion matrix:
      0   1
0  5918  28
1   179  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_13.png
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-06 19:46:10.299309,epoch time: 0:25:21.008686,used: 5:33:09.959952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98136616, 'precision': 0.9810288, 'recall': 0.96952593, 'specificity': 0.96952593, 'f1': 0.9751016, 'auroc': 0.99577117, 'binary_precision': 0.9803682, 'binary_recall': 0.9454886, 'binary_specificity': 0.9935633, 'binary_f1_score': 0.9626125}
confusion matrix:
       0      1
0  42140    273
1    786  13633
---- Validation: 
scalar performance:
{'acc': 0.9639808, 'precision': 0.7366144, 'recall': 0.66016454, 'specificity': 0.66016454, 'f1': 0.6901828, 'auroc': 0.88855314, 'binary_precision': 0.4977778, 'binary_recall': 0.33283803, 'binary_specificity': 0.987491, 'binary_f1_score': 0.39893144}
confusion matrix:
       0    1
0  17841  226
1    449  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.8508998, 'recall': 0.64948446, 'specificity': 0.64948446, 'f1': 0.70595586, 'auroc': 0.9089452, 'binary_precision': 0.7314815, 'binary_recall': 0.30384615, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.4293478}
confusion matrix:
      0   1
0  5917  29
1   181  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_14.png
better model found
persisted
after epoch: 14,now: 2024-07-06 20:11:23.755950,epoch time: 0:25:13.456641,used: 5:58:23.416593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9809966, 'precision': 0.98129165, 'recall': 0.9682962, 'specificity': 0.9682962, 'f1': 0.97457004, 'auroc': 0.9958947, 'binary_precision': 0.9818668, 'binary_recall': 0.9425104, 'binary_specificity': 0.99408185, 'binary_f1_score': 0.96178615}
confusion matrix:
       0      1
0  42161    251
1    829  13591
---- Validation: 
scalar performance:
{'acc': 0.9629669, 'precision': 0.7281186, 'recall': 0.6760898, 'specificity': 0.6760898, 'f1': 0.69835114, 'auroc': 0.88991416, 'binary_precision': 0.47961167, 'binary_recall': 0.36701337, 'binary_specificity': 0.9851663, 'binary_f1_score': 0.4158249}
confusion matrix:
       0    1
0  17799  268
1    426  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.8470518, 'recall': 0.66260964, 'specificity': 0.66260964, 'f1': 0.7183116, 'auroc': 0.91241944, 'binary_precision': 0.7226891, 'binary_recall': 0.33076924, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.45382586}
confusion matrix:
      0   1
0  5913  33
1   174  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_15.png
early stop counter: 1
val acc:0.9629669189453125, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.9666451811790466
after epoch: 15,now: 2024-07-06 20:36:26.009584,epoch time: 0:25:02.253634,used: 6:23:25.670227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98294973, 'precision': 0.9848939, 'recall': 0.96996707, 'specificity': 0.96996707, 'f1': 0.9771387, 'auroc': 0.9966966, 'binary_precision': 0.9886636, 'binary_recall': 0.94361216, 'binary_specificity': 0.996322, 'binary_f1_score': 0.9656127}
confusion matrix:
       0      1
0  42258    156
1    813  13605
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.73565686, 'recall': 0.65155363, 'specificity': 0.65155363, 'f1': 0.68343645, 'auroc': 0.8883978, 'binary_precision': 0.4964871, 'binary_recall': 0.31500742, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.38545454}
confusion matrix:
       0    1
0  17852  215
1    461  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.87088776, 'recall': 0.6594362, 'specificity': 0.6594362, 'f1': 0.7192972, 'auroc': 0.909883, 'binary_precision': 0.7706422, 'binary_recall': 0.32307693, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.45528457}
confusion matrix:
      0   1
0  5921  25
1   176  84
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_16.png
new oracle model saved
early stop counter: 2
val acc:0.9639274477958679, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.9676119685173035
after epoch: 16,now: 2024-07-06 21:01:43.056877,epoch time: 0:25:17.047293,used: 6:48:42.717520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98279136, 'precision': 0.98266375, 'recall': 0.9716939, 'specificity': 0.9716939, 'f1': 0.97701955, 'auroc': 0.9963022, 'binary_precision': 0.98241335, 'binary_recall': 0.9491643, 'binary_specificity': 0.9942235, 'binary_f1_score': 0.9655026}
confusion matrix:
       0      1
0  42168    245
1    733  13686
---- Validation: 
scalar performance:
{'acc': 0.96227324, 'precision': 0.72440827, 'recall': 0.6950423, 'specificity': 0.6950423, 'f1': 0.7085682, 'auroc': 0.89491856, 'binary_precision': 0.4707904, 'binary_recall': 0.40713224, 'binary_specificity': 0.98295236, 'binary_f1_score': 0.43665338}
confusion matrix:
       0    1
0  17759  308
1    399  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.8372028, 'recall': 0.698139, 'specificity': 0.698139, 'f1': 0.7477656, 'auroc': 0.91309285, 'binary_precision': 0.7, 'binary_recall': 0.40384614, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.5121951}
confusion matrix:
      0    1
0  5901   45
1   155  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_17.png
new oracle model saved
early stop counter: 3
val acc:0.9622732400894165, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.9677731394767761
after epoch: 17,now: 2024-07-06 21:27:18.439236,epoch time: 0:25:35.382359,used: 7:14:18.099879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98426944, 'precision': 0.9822688, 'recall': 0.97602576, 'specificity': 0.97602576, 'f1': 0.9790954, 'auroc': 0.9963881, 'binary_precision': 0.978287, 'binary_recall': 0.95928985, 'binary_specificity': 0.9927617, 'binary_f1_score': 0.9686953}
confusion matrix:
       0      1
0  42106    307
1    587  13832
---- Validation: 
scalar performance:
{'acc': 0.9629669, 'precision': 0.72919536, 'recall': 0.6882494, 'specificity': 0.6882494, 'f1': 0.70646894, 'auroc': 0.8942634, 'binary_precision': 0.48087433, 'binary_recall': 0.3922734, 'binary_specificity': 0.9842254, 'binary_f1_score': 0.43207854}
confusion matrix:
       0    1
0  17782  285
1    409  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.8422208, 'recall': 0.69454515, 'specificity': 0.69454515, 'f1': 0.74603415, 'auroc': 0.9149978, 'binary_precision': 0.71034485, 'binary_recall': 0.39615384, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.50864196}
confusion matrix:
      0    1
0  5904   42
1   157  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_18.png
new oracle model saved
early stop counter: 4
val acc:0.9629669189453125, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.967934250831604
after epoch: 18,now: 2024-07-06 21:53:32.231738,epoch time: 0:26:13.792502,used: 7:40:31.892381,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9830905, 'precision': 0.9810835, 'recall': 0.97406864, 'specificity': 0.97406864, 'f1': 0.9775104, 'auroc': 0.99656785, 'binary_precision': 0.9770987, 'binary_recall': 0.95575285, 'binary_specificity': 0.99238443, 'binary_f1_score': 0.96630794}
confusion matrix:
       0      1
0  42090    323
1    638  13781
---- Validation: 
scalar performance:
{'acc': 0.96254003, 'precision': 0.7263108, 'recall': 0.69375014, 'specificity': 0.69375014, 'f1': 0.70861155, 'auroc': 0.8922167, 'binary_precision': 0.47469458, 'binary_recall': 0.40416047, 'binary_specificity': 0.9833398, 'binary_f1_score': 0.43659708}
confusion matrix:
       0    1
0  17766  301
1    401  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.8443177, 'recall': 0.68518203, 'specificity': 0.68518203, 'f1': 0.7384868, 'auroc': 0.9120941, 'binary_precision': 0.71532845, 'binary_recall': 0.37692308, 'binary_specificity': 0.993441, 'binary_f1_score': 0.4937028}
confusion matrix:
      0   1
0  5907  39
1   162  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_19.png
early stop counter: 5
val acc:0.9625400304794312, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.967934250831604
after epoch: 19,now: 2024-07-06 22:22:35.885761,epoch time: 0:29:03.654023,used: 8:09:35.546404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9842342, 'precision': 0.9849918, 'recall': 0.9732344, 'specificity': 0.9732344, 'f1': 0.9789314, 'auroc': 0.99691415, 'binary_precision': 0.9864748, 'binary_recall': 0.9509015, 'binary_specificity': 0.9955673, 'binary_f1_score': 0.9683616}
confusion matrix:
       0      1
0  42224    188
1    708  13712
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.73321825, 'recall': 0.6664082, 'specificity': 0.6664082, 'f1': 0.69357604, 'auroc': 0.891075, 'binary_precision': 0.49052632, 'binary_recall': 0.346211, 'binary_specificity': 0.9866054, 'binary_f1_score': 0.40592334}
confusion matrix:
       0    1
0  17825  242
1    440  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.8707591, 'recall': 0.6651213, 'specificity': 0.6651213, 'f1': 0.72497916, 'auroc': 0.9112896, 'binary_precision': 0.7699115, 'binary_recall': 0.33461538, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.46648794}
confusion matrix:
      0   1
0  5920  26
1   173  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_20.png
early stop counter: 6
val acc:0.9636072516441345, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.967934250831604
after epoch: 20,now: 2024-07-06 22:48:58.375870,epoch time: 0:26:22.490109,used: 8:35:58.036513,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9843926, 'precision': 0.9839741, 'recall': 0.97464496, 'specificity': 0.97464496, 'f1': 0.97919446, 'auroc': 0.9970424, 'binary_precision': 0.9831489, 'binary_recall': 0.95485437, 'binary_specificity': 0.99443555, 'binary_f1_score': 0.968795}
confusion matrix:
       0      1
0  42176    236
1    651  13769
---- Validation: 
scalar performance:
{'acc': 0.96221983, 'precision': 0.7241589, 'recall': 0.69644517, 'specificity': 0.69644517, 'f1': 0.709274, 'auroc': 0.8935549, 'binary_precision': 0.4701874, 'binary_recall': 0.410104, 'binary_specificity': 0.9827863, 'binary_f1_score': 0.43809524}
confusion matrix:
       0    1
0  17756  311
1    397  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671286, 'precision': 0.8259588, 'recall': 0.7014806, 'specificity': 0.7014806, 'f1': 0.7474766, 'auroc': 0.91434896, 'binary_precision': 0.6772152, 'binary_recall': 0.41153845, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.51196176}
confusion matrix:
      0    1
0  5895   51
1   153  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_21.png
early stop counter: 7
val acc:0.9622198343276978, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.967934250831604
after epoch: 21,now: 2024-07-06 23:14:35.445254,epoch time: 0:25:37.069384,used: 9:01:35.105897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9847973, 'precision': 0.9848102, 'recall': 0.9748932, 'specificity': 0.9748932, 'f1': 0.97972214, 'auroc': 0.9973593, 'binary_precision': 0.9848355, 'binary_recall': 0.95478505, 'binary_specificity': 0.99500144, 'binary_f1_score': 0.9695775}
confusion matrix:
       0      1
0  42200    212
1    652  13768
---- Validation: 
scalar performance:
{'acc': 0.96221983, 'precision': 0.72368985, 'recall': 0.6921536, 'specificity': 0.6921536, 'f1': 0.7065758, 'auroc': 0.89656633, 'binary_precision': 0.4695652, 'binary_recall': 0.4011887, 'binary_specificity': 0.9831184, 'binary_f1_score': 0.43269232}
confusion matrix:
       0    1
0  17762  305
1    403  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671286, 'precision': 0.81760514, 'recall': 0.7180315, 'specificity': 0.7180315, 'f1': 0.7575381, 'auroc': 0.91844547, 'binary_precision': 0.65909094, 'binary_recall': 0.44615385, 'binary_specificity': 0.9899092, 'binary_f1_score': 0.53211015}
confusion matrix:
      0    1
0  5886   60
1   144  116
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_22.png
early stop counter: 8
val acc:0.9622198343276978, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.967934250831604
after epoch: 22,now: 2024-07-06 23:40:02.858089,epoch time: 0:25:27.412835,used: 9:27:02.518732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98532516, 'precision': 0.9864916, 'recall': 0.97465026, 'specificity': 0.97465026, 'f1': 0.98038745, 'auroc': 0.9964647, 'binary_precision': 0.98877454, 'binary_recall': 0.95297873, 'binary_specificity': 0.99632186, 'binary_f1_score': 0.9705467}
confusion matrix:
       0      1
0  42257    156
1    678  13741
---- Validation: 
scalar performance:
{'acc': 0.96318036, 'precision': 0.7298804, 'recall': 0.67477, 'specificity': 0.67477, 'f1': 0.698123, 'auroc': 0.89343166, 'binary_precision': 0.4832347, 'binary_recall': 0.3640416, 'binary_specificity': 0.9854984, 'binary_f1_score': 0.41525424}
confusion matrix:
       0    1
0  17805  262
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.8321644, 'recall': 0.6697133, 'specificity': 0.6697133, 'f1': 0.7220352, 'auroc': 0.91305095, 'binary_precision': 0.6923077, 'binary_recall': 0.34615386, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.4615385}
confusion matrix:
      0   1
0  5906  40
1   170  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_23.png
early stop counter: 9
val acc:0.9631803631782532, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.967934250831604
after epoch: 23,now: 2024-07-07 00:05:11.159202,epoch time: 0:25:08.301113,used: 9:52:10.819845,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98511404, 'precision': 0.9851198, 'recall': 0.97542435, 'specificity': 0.97542435, 'f1': 0.9801483, 'auroc': 0.9969253, 'binary_precision': 0.9851312, 'binary_recall': 0.95575285, 'binary_specificity': 0.99509585, 'binary_f1_score': 0.9702197}
confusion matrix:
       0      1
0  42205    208
1    638  13781
---- Validation: 
scalar performance:
{'acc': 0.96205974, 'precision': 0.7214421, 'recall': 0.6834873, 'specificity': 0.6834873, 'f1': 0.7004628, 'auroc': 0.89413095, 'binary_precision': 0.46570396, 'binary_recall': 0.3833581, 'binary_specificity': 0.98361653, 'binary_f1_score': 0.42053786}
confusion matrix:
       0    1
0  17771  296
1    415  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.82444894, 'recall': 0.67698514, 'specificity': 0.67698514, 'f1': 0.7268068, 'auroc': 0.9121653, 'binary_precision': 0.676259, 'binary_recall': 0.36153847, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.47117794}
confusion matrix:
      0   1
0  5901  45
1   166  94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_24.png
early stop counter: 10
val acc:0.962059736251831, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.967934250831604
after epoch: 24,now: 2024-07-07 00:30:18.100206,epoch time: 0:25:06.941004,used: 10:17:17.760849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9863985, 'precision': 0.98524237, 'recall': 0.9787122, 'specificity': 0.9787122, 'f1': 0.98192096, 'auroc': 0.9973657, 'binary_precision': 0.9829429, 'binary_recall': 0.9631068, 'binary_specificity': 0.99431765, 'binary_f1_score': 0.97292376}
confusion matrix:
       0      1
0  42171    241
1    532  13888
---- Validation: 
scalar performance:
{'acc': 0.96302027, 'precision': 0.727728, 'recall': 0.66681904, 'specificity': 0.66681904, 'f1': 0.6920099, 'auroc': 0.8937164, 'binary_precision': 0.4795082, 'binary_recall': 0.34769687, 'binary_specificity': 0.98594123, 'binary_f1_score': 0.4031008}
confusion matrix:
       0    1
0  17813  254
1    439  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.8406986, 'recall': 0.66620356, 'specificity': 0.66620356, 'f1': 0.72052014, 'auroc': 0.91424036, 'binary_precision': 0.7096774, 'binary_recall': 0.33846155, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.4583333}
confusion matrix:
      0   1
0  5910  36
1   172  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_25.png
early stop counter: 11
val acc:0.9630202651023865, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.967934250831604
after epoch: 25,now: 2024-07-07 00:55:40.879853,epoch time: 0:25:22.779647,used: 10:42:40.540496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9862753, 'precision': 0.98577595, 'recall': 0.9778503, 'specificity': 0.9778503, 'f1': 0.9817304, 'auroc': 0.9973608, 'binary_precision': 0.9847871, 'binary_recall': 0.9607462, 'binary_specificity': 0.99495435, 'binary_f1_score': 0.97261816}
confusion matrix:
       0      1
0  42199    214
1    566  13853
---- Validation: 
scalar performance:
{'acc': 0.9624333, 'precision': 0.7233788, 'recall': 0.67438257, 'specificity': 0.67438257, 'f1': 0.6954919, 'auroc': 0.89439857, 'binary_precision': 0.47024953, 'binary_recall': 0.3640416, 'binary_specificity': 0.9847235, 'binary_f1_score': 0.41038528}
confusion matrix:
       0    1
0  17791  276
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.82291013, 'recall': 0.66001385, 'specificity': 0.66001385, 'f1': 0.7112267, 'auroc': 0.9095403, 'binary_precision': 0.67460316, 'binary_recall': 0.32692307, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.4404145}
confusion matrix:
      0   1
0  5905  41
1   175  85
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_26.png
early stop counter: 12
val acc:0.9624332785606384, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.967934250831604
after epoch: 26,now: 2024-07-07 01:20:53.452014,epoch time: 0:25:12.572161,used: 11:07:53.112657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98629296, 'precision': 0.98632205, 'recall': 0.97735995, 'specificity': 0.97735995, 'f1': 0.98173547, 'auroc': 0.99761975, 'binary_precision': 0.9863795, 'binary_recall': 0.95922333, 'binary_specificity': 0.9954966, 'binary_f1_score': 0.97261184}
confusion matrix:
       0      1
0  42221    191
1    588  13832
---- Validation: 
scalar performance:
{'acc': 0.96318036, 'precision': 0.7303461, 'recall': 0.68049216, 'specificity': 0.68049216, 'f1': 0.7020302, 'auroc': 0.9010602, 'binary_precision': 0.4837476, 'binary_recall': 0.37592867, 'binary_specificity': 0.9850556, 'binary_f1_score': 0.42307693}
confusion matrix:
       0    1
0  17797  270
1    420  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685788, 'precision': 0.84783584, 'recall': 0.70039845, 'specificity': 0.70039845, 'f1': 0.75232065, 'auroc': 0.91772246, 'binary_precision': 0.7210884, 'binary_recall': 0.4076923, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.5208845}
confusion matrix:
      0    1
0  5905   41
1   154  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_27.png
new oracle model saved
early stop counter: 13
val acc:0.9631803631782532, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.9685788154602051
after epoch: 27,now: 2024-07-07 01:46:10.111384,epoch time: 0:25:16.659370,used: 11:33:09.772027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9866976, 'precision': 0.9849962, 'recall': 0.97975713, 'specificity': 0.97975713, 'f1': 0.98234034, 'auroc': 0.9973362, 'binary_precision': 0.981599, 'binary_recall': 0.9656679, 'binary_specificity': 0.99384636, 'binary_f1_score': 0.9735683}
confusion matrix:
       0      1
0  42153    261
1    495  13923
---- Validation: 
scalar performance:
{'acc': 0.96168625, 'precision': 0.7211749, 'recall': 0.70403636, 'specificity': 0.70403636, 'f1': 0.7122158, 'auroc': 0.90368485, 'binary_precision': 0.46365106, 'binary_recall': 0.42644873, 'binary_specificity': 0.98162395, 'binary_f1_score': 0.44427246}
confusion matrix:
       0    1
0  17735  332
1    386  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685788, 'precision': 0.8332645, 'recall': 0.7224663, 'specificity': 0.7224663, 'f1': 0.7656441, 'auroc': 0.91611874, 'binary_precision': 0.69005847, 'binary_recall': 0.45384616, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.5475638}
confusion matrix:
      0    1
0  5893   53
1   142  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_28.png
early stop counter: 14
val acc:0.9616862535476685, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.9685788154602051
after epoch: 28,now: 2024-07-07 02:11:20.510335,epoch time: 0:25:10.398951,used: 11:58:20.170978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9873311, 'precision': 0.9889412, 'recall': 0.9775506, 'specificity': 0.9775506, 'f1': 0.98307705, 'auroc': 0.9974209, 'binary_precision': 0.99209714, 'binary_recall': 0.9576947, 'binary_specificity': 0.9974065, 'binary_f1_score': 0.9745924}
confusion matrix:
       0      1
0  42303    110
1    610  13809
---- Validation: 
scalar performance:
{'acc': 0.9629669, 'precision': 0.7259923, 'recall': 0.65463185, 'specificity': 0.65463185, 'f1': 0.6828304, 'auroc': 0.89715654, 'binary_precision': 0.47692308, 'binary_recall': 0.32243684, 'binary_specificity': 0.98682684, 'binary_f1_score': 0.38475177}
confusion matrix:
       0    1
0  17829  238
1    456  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.81725645, 'recall': 0.6523216, 'specificity': 0.6523216, 'f1': 0.7028981, 'auroc': 0.9099659, 'binary_precision': 0.6639344, 'binary_recall': 0.31153846, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.42408374}
confusion matrix:
      0   1
0  5905  41
1   179  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_29.png
early stop counter: 15
val acc:0.9629669189453125, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.9685788154602051
after epoch: 29,now: 2024-07-07 02:36:35.805089,epoch time: 0:25:15.294754,used: 12:23:35.465732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9869264, 'precision': 0.98572016, 'recall': 0.9796357, 'specificity': 0.9796357, 'f1': 0.98262906, 'auroc': 0.9973626, 'binary_precision': 0.98331803, 'binary_recall': 0.96483564, 'binary_specificity': 0.9944358, 'binary_f1_score': 0.9739891}
confusion matrix:
       0      1
0  42178    236
1    507  13911
---- Validation: 
scalar performance:
{'acc': 0.9618997, 'precision': 0.71884525, 'recall': 0.67339057, 'specificity': 0.67339057, 'f1': 0.69315434, 'auroc': 0.8989866, 'binary_precision': 0.46124762, 'binary_recall': 0.3625557, 'binary_specificity': 0.9842254, 'binary_f1_score': 0.40599}
confusion matrix:
       0    1
0  17782  285
1    429  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.8149817, 'recall': 0.67664886, 'specificity': 0.67664886, 'f1': 0.72429895, 'auroc': 0.91117036, 'binary_precision': 0.6573427, 'binary_recall': 0.36153847, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.4665013}
confusion matrix:
      0   1
0  5897  49
1   166  94
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_30.png
early stop counter: 16
val acc:0.9618996977806091, best validation acc: 0.9639807939529419, corresponding to test acc:                         0.9661617875099182 / 0.9685788154602051
after epoch: 30,now: 2024-07-07 03:01:20.785940,epoch time: 0:24:44.980851,used: 12:48:20.446583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_14_13_00_seed_1_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:48:20.446583 at 2024-07-07 03:01:20.785940
persisted model performance metric: 

scalar performance:
{'acc': 0.9661618, 'precision': 0.8508998, 'recall': 0.64948446, 'specificity': 0.64948446, 'f1': 0.70595586, 'auroc': 0.9089452, 'binary_precision': 0.7314815, 'binary_recall': 0.30384615, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.4293478}
confusion matrix:
      0   1
0  5917  29
1   181  79
oracle model performance metric: 

scalar performance:
{'acc': 0.9685788, 'precision': 0.84783584, 'recall': 0.70039845, 'specificity': 0.70039845, 'f1': 0.75232065, 'auroc': 0.91772246, 'binary_precision': 0.7210884, 'binary_recall': 0.4076923, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.5208845}
confusion matrix:
      0    1
0  5905   41
1   154  106
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |  17479 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |  17479 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   7827 MiB |   2381 TiB |   2381 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   2350 TiB |   2350 TiB |
|       from small pool |  16480 KiB |     36 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8530 MiB |  16792 MiB |   8278 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  16734 MiB |   8260 MiB |
|       from small pool |     40 MiB |     44 MiB |     58 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40878 KiB | 732464 KiB |   1320 TiB |   1320 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1289 TiB |   1289 TiB |
|       from small pool |   9145 KiB |  23272 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7625    |  393257 K  |  393255 K  |
|       from large pool |      79    |     762    |  223190 K  |  223190 K  |
|       from small pool |    2875    |    7544    |  170067 K  |  170064 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7625    |  393257 K  |  393255 K  |
|       from large pool |      79    |     762    |  223190 K  |  223190 K  |
|       from small pool |    2875    |    7544    |  170067 K  |  170064 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     371    |     716    |     347    |
|       from large pool |     349    |     349    |     687    |     338    |
|       from small pool |      20    |      22    |      29    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3589    |  232668 K  |  232668 K  |
|       from large pool |      11    |     352    |  160864 K  |  160864 K  |
|       from small pool |      26    |    3579    |   71803 K  |   71803 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     36 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  16792 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  26624 KiB |     44 MiB |     58 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1320 TiB |   1320 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1289 TiB |   1289 TiB |
|       from small pool |      0 KiB |  23284 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  393257 K  |  393257 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170067 K  |  170067 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  393257 K  |  393257 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170067 K  |  170067 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     716    |     693    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      13    |      22    |      29    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  232669 K  |  232669 K  |
|       from large pool |       3    |     352    |  160864 K  |  160864 K  |
|       from small pool |       0    |    3579    |   71805 K  |   71805 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     36 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  16792 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  26624 KiB |     44 MiB |     58 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1320 TiB |   1320 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1289 TiB |   1289 TiB |
|       from small pool |      0 KiB |  23284 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  393257 K  |  393257 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170067 K  |  170067 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  393257 K  |  393257 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170067 K  |  170067 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     716    |     693    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      13    |      22    |      29    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  232669 K  |  232669 K  |
|       from large pool |       3    |     352    |  160864 K  |  160864 K  |
|       from small pool |       0    |    3579    |   71805 K  |   71805 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431

 Experiment start at: 2024-07-07 03:07:41.691042
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9428273, 'precision': 0.95265204, 'recall': 0.89945614, 'specificity': 0.89945614, 'f1': 0.92194116, 'auroc': 0.96966326, 'binary_precision': 0.970154, 'binary_recall': 0.8077991, 'binary_specificity': 0.9911132, 'binary_f1_score': 0.8815637}
confusion matrix:
       0      1
0  41934    376
1   2908  12222
---- Validation: 
scalar performance:
{'acc': 0.9575454, 'precision': 0.61421335, 'recall': 0.57654524, 'specificity': 0.57654524, 'f1': 0.5909937, 'auroc': 0.786605, 'binary_precision': 0.2556391, 'binary_recall': 0.16943522, 'binary_specificity': 0.9836553, 'binary_f1_score': 0.2037962}
confusion matrix:
       0    1
0  17874  297
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9313993, 'precision': 0.5137891, 'recall': 0.5122506, 'specificity': 0.5122506, 'f1': 0.51290107, 'auroc': 0.6433649, 'binary_precision': 0.06542056, 'binary_recall': 0.05785124, 'binary_specificity': 0.96665, 'binary_f1_score': 0.06140351}
confusion matrix:
      0    1
0  5797  200
1   228   14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-07 03:33:24.291032,epoch time: 0:25:42.599990,used: 0:25:42.599990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9579213, 'precision': 0.9627568, 'recall': 0.92816716, 'specificity': 0.92816716, 'f1': 0.94373673, 'auroc': 0.97961354, 'binary_precision': 0.9718634, 'binary_recall': 0.86529183, 'binary_specificity': 0.9910425, 'binary_f1_score': 0.9154866}
confusion matrix:
       0      1
0  41932    379
1   2038  13091
---- Validation: 
scalar performance:
{'acc': 0.9626059, 'precision': 0.66055197, 'recall': 0.5887959, 'specificity': 0.5887959, 'f1': 0.6129947, 'auroc': 0.81858206, 'binary_precision': 0.34756097, 'binary_recall': 0.18936877, 'binary_specificity': 0.988223, 'binary_f1_score': 0.2451613}
confusion matrix:
       0    1
0  17957  214
1    488  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94069564, 'precision': 0.5435574, 'recall': 0.53096557, 'specificity': 0.53096557, 'f1': 0.5356385, 'auroc': 0.7430072, 'binary_precision': 0.12352941, 'binary_recall': 0.08677686, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.10194175}
confusion matrix:
      0    1
0  5848  149
1   221   21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-07 03:58:14.060370,epoch time: 0:24:49.769338,used: 0:50:32.369328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.964415, 'precision': 0.9694775, 'recall': 0.9384987, 'specificity': 0.9384987, 'f1': 0.9526237, 'auroc': 0.9863633, 'binary_precision': 0.97912854, 'binary_recall': 0.8837332, 'binary_specificity': 0.99326414, 'binary_f1_score': 0.92898834}
confusion matrix:
       0      1
0  42026    285
1   1759  13370
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.7068079, 'recall': 0.5851282, 'specificity': 0.5851282, 'f1': 0.6180307, 'auroc': 0.8358396, 'binary_precision': 0.44032922, 'binary_recall': 0.17774086, 'binary_specificity': 0.99251556, 'binary_f1_score': 0.25325444}
confusion matrix:
       0    1
0  18035  136
1    495  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495111, 'precision': 0.58633566, 'recall': 0.5454649, 'specificity': 0.5454649, 'f1': 0.55784, 'auroc': 0.79326713, 'binary_precision': 0.208, 'binary_recall': 0.10743801, 'binary_specificity': 0.9834917, 'binary_f1_score': 0.14168936}
confusion matrix:
      0   1
0  5898  99
1   216  26
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-07 04:22:58.210206,epoch time: 0:24:44.149836,used: 1:15:16.519164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96956825, 'precision': 0.97228444, 'recall': 0.9489, 'specificity': 0.9489, 'f1': 0.95981324, 'auroc': 0.98869985, 'binary_precision': 0.97758746, 'binary_recall': 0.9052214, 'binary_specificity': 0.99257857, 'binary_f1_score': 0.9400137}
confusion matrix:
       0      1
0  41996    314
1   1434  13696
---- Validation: 
scalar performance:
{'acc': 0.96622807, 'precision': 0.7124071, 'recall': 0.6139554, 'specificity': 0.6139554, 'f1': 0.6467798, 'auroc': 0.8516197, 'binary_precision': 0.44968554, 'binary_recall': 0.23754153, 'binary_specificity': 0.99036926, 'binary_f1_score': 0.31086957}
confusion matrix:
       0    1
0  17996  175
1    459  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495111, 'precision': 0.6336546, 'recall': 0.60098165, 'specificity': 0.60098165, 'f1': 0.61459446, 'auroc': 0.82841814, 'binary_precision': 0.29834256, 'binary_recall': 0.2231405, 'binary_specificity': 0.97882277, 'binary_f1_score': 0.25531915}
confusion matrix:
      0    1
0  5870  127
1   188   54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_4.png
early stop counter: 1
val acc:0.9662280678749084, best validation acc: 0.9663878679275513, corresponding to test acc:                         0.9495111107826233 / 0.9495111107826233
after epoch: 4,now: 2024-07-07 04:47:49.146621,epoch time: 0:24:50.936415,used: 1:40:07.455579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97049093, 'precision': 0.9742792, 'recall': 0.9494171, 'specificity': 0.9494171, 'f1': 0.9609742, 'auroc': 0.99027467, 'binary_precision': 0.9816435, 'binary_recall': 0.90488464, 'binary_specificity': 0.9939496, 'binary_f1_score': 0.9417025}
confusion matrix:
       0      1
0  42055    256
1   1439  13690
---- Validation: 
scalar performance:
{'acc': 0.9667075, 'precision': 0.71674806, 'recall': 0.60296035, 'specificity': 0.60296035, 'f1': 0.6375693, 'auroc': 0.8587806, 'binary_precision': 0.45907474, 'binary_recall': 0.21428572, 'binary_specificity': 0.991635, 'binary_f1_score': 0.29218572}
confusion matrix:
       0    1
0  18019  152
1    473  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95223594, 'precision': 0.6491609, 'recall': 0.602399, 'specificity': 0.602399, 'f1': 0.62066233, 'auroc': 0.8502314, 'binary_precision': 0.3292683, 'binary_recall': 0.2231405, 'binary_specificity': 0.9816575, 'binary_f1_score': 0.26600987}
confusion matrix:
      0    1
0  5887  110
1   188   54
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-07 05:12:43.162843,epoch time: 0:24:54.016222,used: 2:05:01.471801,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9720404, 'precision': 0.975282, 'recall': 0.9524038, 'specificity': 0.9524038, 'f1': 0.96310294, 'auroc': 0.99138796, 'binary_precision': 0.98162395, 'binary_recall': 0.9109055, 'binary_specificity': 0.99390215, 'binary_f1_score': 0.9449434}
confusion matrix:
       0      1
0  42052    258
1   1348  13782
---- Validation: 
scalar performance:
{'acc': 0.96612155, 'precision': 0.71282077, 'recall': 0.62193084, 'specificity': 0.62193084, 'f1': 0.65373284, 'auroc': 0.8643392, 'binary_precision': 0.45, 'binary_recall': 0.25415283, 'binary_specificity': 0.9897089, 'binary_f1_score': 0.32484078}
confusion matrix:
       0    1
0  17984  187
1    449  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94678634, 'precision': 0.6464752, 'recall': 0.65111554, 'specificity': 0.65111554, 'f1': 0.6487521, 'auroc': 0.8591913, 'binary_precision': 0.32, 'binary_recall': 0.3305785, 'binary_specificity': 0.9716525, 'binary_f1_score': 0.32520324}
confusion matrix:
      0    1
0  5827  170
1   162   80
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_6.png
early stop counter: 1
val acc:0.9661215543746948, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9522359371185303 / 0.9522359371185303
after epoch: 6,now: 2024-07-07 05:37:30.539852,epoch time: 0:24:47.377009,used: 2:29:48.848810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9747737, 'precision': 0.9771192, 'recall': 0.95761085, 'specificity': 0.95761085, 'f1': 0.9668274, 'auroc': 0.99263847, 'binary_precision': 0.981758, 'binary_recall': 0.9213431, 'binary_specificity': 0.99387866, 'binary_f1_score': 0.9505916}
confusion matrix:
       0      1
0  42052    259
1   1190  13939
---- Validation: 
scalar performance:
{'acc': 0.96628135, 'precision': 0.7157713, 'recall': 0.6268317, 'specificity': 0.6268317, 'f1': 0.6585437, 'auroc': 0.8697388, 'binary_precision': 0.4555874, 'binary_recall': 0.2641196, 'binary_specificity': 0.9895438, 'binary_f1_score': 0.33438486}
confusion matrix:
       0    1
0  17981  190
1    443  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9471069, 'precision': 0.6501026, 'recall': 0.6572305, 'specificity': 0.6572305, 'f1': 0.653568, 'auroc': 0.8687519, 'binary_precision': 0.32677165, 'binary_recall': 0.3429752, 'binary_specificity': 0.97148573, 'binary_f1_score': 0.3346774}
confusion matrix:
      0    1
0  5826  171
1   159   83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_7.png
early stop counter: 2
val acc:0.9662813544273376, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9522359371185303 / 0.9522359371185303
after epoch: 7,now: 2024-07-07 06:02:20.588518,epoch time: 0:24:50.048666,used: 2:54:38.897476,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9759053, 'precision': 0.9781904, 'recall': 0.9594855, 'specificity': 0.9594855, 'f1': 0.96834457, 'auroc': 0.99376595, 'binary_precision': 0.9827223, 'binary_recall': 0.9247852, 'binary_specificity': 0.99418575, 'binary_f1_score': 0.95287395}
confusion matrix:
       0      1
0  42064    246
1   1138  13992
---- Validation: 
scalar performance:
{'acc': 0.96708035, 'precision': 0.72571486, 'recall': 0.62483525, 'specificity': 0.62483525, 'f1': 0.65930295, 'auroc': 0.87539613, 'binary_precision': 0.47560975, 'binary_recall': 0.2591362, 'binary_specificity': 0.99053437, 'binary_f1_score': 0.33548385}
confusion matrix:
       0    1
0  17999  172
1    446  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95111394, 'precision': 0.66661453, 'recall': 0.6553494, 'specificity': 0.6553494, 'f1': 0.66075087, 'auroc': 0.8730247, 'binary_precision': 0.36, 'binary_recall': 0.33471075, 'binary_specificity': 0.975988, 'binary_f1_score': 0.3468951}
confusion matrix:
      0    1
0  5853  144
1   161   81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_8.png
better model found
persisted
after epoch: 8,now: 2024-07-07 06:27:05.579451,epoch time: 0:24:44.990933,used: 3:19:23.888409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97806406, 'precision': 0.9803705, 'recall': 0.96292293, 'specificity': 0.96292293, 'f1': 0.9712192, 'auroc': 0.9942192, 'binary_precision': 0.984964, 'binary_recall': 0.93092734, 'binary_specificity': 0.9949186, 'binary_f1_score': 0.9571836}
confusion matrix:
       0      1
0  42096    215
1   1045  14084
---- Validation: 
scalar performance:
{'acc': 0.96676075, 'precision': 0.7231839, 'recall': 0.6367159, 'specificity': 0.6367159, 'f1': 0.6684894, 'auroc': 0.8769127, 'binary_precision': 0.4697802, 'binary_recall': 0.28405315, 'binary_specificity': 0.9893787, 'binary_f1_score': 0.35403726}
confusion matrix:
       0    1
0  17978  193
1    431  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94854945, 'precision': 0.6623547, 'recall': 0.6758255, 'specificity': 0.6758255, 'f1': 0.66877306, 'auroc': 0.87496233, 'binary_precision': 0.34980989, 'binary_recall': 0.38016528, 'binary_specificity': 0.97148573, 'binary_f1_score': 0.36435643}
confusion matrix:
      0    1
0  5826  171
1   150   92
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_9.png
early stop counter: 1
val acc:0.9667607545852661, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 9,now: 2024-07-07 06:51:57.743169,epoch time: 0:24:52.163718,used: 3:44:16.052127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9792131, 'precision': 0.9792836, 'recall': 0.9668877, 'specificity': 0.9668877, 'f1': 0.97286767, 'auroc': 0.99489236, 'binary_precision': 0.97942615, 'binary_recall': 0.9408421, 'binary_specificity': 0.9929333, 'binary_f1_score': 0.9597465}
confusion matrix:
       0      1
0  42012    299
1    895  14234
---- Validation: 
scalar performance:
{'acc': 0.96558887, 'precision': 0.7128298, 'recall': 0.6513685, 'specificity': 0.6513685, 'f1': 0.6763407, 'auroc': 0.8772199, 'binary_precision': 0.4481132, 'binary_recall': 0.3156146, 'binary_specificity': 0.98712236, 'binary_f1_score': 0.3703704}
confusion matrix:
       0    1
0  17937  234
1    412  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9427793, 'precision': 0.6505775, 'recall': 0.7005824, 'specificity': 0.7005824, 'f1': 0.6713031, 'auroc': 0.8741912, 'binary_precision': 0.32415903, 'binary_recall': 0.43801653, 'binary_specificity': 0.96314824, 'binary_f1_score': 0.37258348}
confusion matrix:
      0    1
0  5776  221
1   136  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_10.png
early stop counter: 2
val acc:0.9655888676643372, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 10,now: 2024-07-07 07:16:48.532001,epoch time: 0:24:50.788832,used: 4:09:06.840959,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9800488, 'precision': 0.9804771, 'recall': 0.9678814, 'specificity': 0.9678814, 'f1': 0.9739549, 'auroc': 0.9955021, 'binary_precision': 0.9813438, 'binary_recall': 0.9421679, 'binary_specificity': 0.9935949, 'binary_f1_score': 0.9613568}
confusion matrix:
       0      1
0  42039    271
1    875  14255
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.72255665, 'recall': 0.6630239, 'specificity': 0.6630239, 'f1': 0.68770045, 'auroc': 0.88304645, 'binary_precision': 0.46681923, 'binary_recall': 0.33887044, 'binary_specificity': 0.9871774, 'binary_f1_score': 0.39268526}
confusion matrix:
       0    1
0  17938  233
1    398  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.941497, 'precision': 0.6466913, 'recall': 0.6999154, 'specificity': 0.6999154, 'f1': 0.66837394, 'auroc': 0.87502086, 'binary_precision': 0.3164179, 'binary_recall': 0.43801653, 'binary_specificity': 0.9618142, 'binary_f1_score': 0.36741763}
confusion matrix:
      0    1
0  5768  229
1   136  106
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_11.png
early stop counter: 3
val acc:0.9663878679275513, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 11,now: 2024-07-07 07:41:39.663968,epoch time: 0:24:51.131967,used: 4:33:57.972926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98077995, 'precision': 0.9802903, 'recall': 0.96994865, 'specificity': 0.96994865, 'f1': 0.9749677, 'auroc': 0.99552226, 'binary_precision': 0.979292, 'binary_recall': 0.9470588, 'binary_specificity': 0.99283856, 'binary_f1_score': 0.9629057}
confusion matrix:
       0      1
0  42007    303
1    801  14329
---- Validation: 
scalar performance:
{'acc': 0.9650562, 'precision': 0.7141813, 'recall': 0.68723047, 'specificity': 0.68723047, 'f1': 0.6996973, 'auroc': 0.885075, 'binary_precision': 0.44847327, 'binary_recall': 0.39036545, 'binary_specificity': 0.9840955, 'binary_f1_score': 0.41740674}
confusion matrix:
       0    1
0  17882  289
1    367  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93588716, 'precision': 0.63424176, 'recall': 0.7049282, 'specificity': 0.7049282, 'f1': 0.6605531, 'auroc': 0.8742636, 'binary_precision': 0.29100528, 'binary_recall': 0.45454547, 'binary_specificity': 0.955311, 'binary_f1_score': 0.3548387}
confusion matrix:
      0    1
0  5729  268
1   132  110
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_12.png
early stop counter: 4
val acc:0.9650561809539795, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 12,now: 2024-07-07 08:06:27.538814,epoch time: 0:24:47.874846,used: 4:58:45.847772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9812326, 'precision': 0.98097265, 'recall': 0.970447, 'specificity': 0.970447, 'f1': 0.975553, 'auroc': 0.99561757, 'binary_precision': 0.9804431, 'binary_recall': 0.94765365, 'binary_specificity': 0.99324036, 'binary_f1_score': 0.96376956}
confusion matrix:
       0      1
0  42024    286
1    792  14338
---- Validation: 
scalar performance:
{'acc': 0.9655356, 'precision': 0.7163601, 'recall': 0.6754324, 'specificity': 0.6754324, 'f1': 0.69351894, 'auroc': 0.88411725, 'binary_precision': 0.45360824, 'binary_recall': 0.3654485, 'binary_specificity': 0.9854163, 'binary_f1_score': 0.40478382}
confusion matrix:
       0    1
0  17906  265
1    382  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9392531, 'precision': 0.64159155, 'recall': 0.7027136, 'specificity': 0.7027136, 'f1': 0.6655655, 'auroc': 0.877124, 'binary_precision': 0.305949, 'binary_recall': 0.446281, 'binary_specificity': 0.95914626, 'binary_f1_score': 0.3630252}
confusion matrix:
      0    1
0  5752  245
1   134  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_13.png
early stop counter: 5
val acc:0.965535581111908, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 13,now: 2024-07-07 08:31:22.383622,epoch time: 0:24:54.844808,used: 5:23:40.692580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9827995, 'precision': 0.98286235, 'recall': 0.9726342, 'specificity': 0.9726342, 'f1': 0.9776008, 'auroc': 0.99609923, 'binary_precision': 0.9829906, 'binary_recall': 0.9511534, 'binary_specificity': 0.994115, 'binary_f1_score': 0.9668099}
confusion matrix:
       0      1
0  42062    249
1    739  14390
---- Validation: 
scalar performance:
{'acc': 0.96622807, 'precision': 0.7223175, 'recall': 0.673381, 'specificity': 0.673381, 'f1': 0.69449335, 'auroc': 0.88752615, 'binary_precision': 0.46566522, 'binary_recall': 0.3604651, 'binary_specificity': 0.98629683, 'binary_f1_score': 0.40636703}
confusion matrix:
       0    1
0  17922  249
1    385  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9427793, 'precision': 0.65119267, 'recall': 0.70256513, 'specificity': 0.70256513, 'f1': 0.67239934, 'auroc': 0.878289, 'binary_precision': 0.32522798, 'binary_recall': 0.44214877, 'binary_specificity': 0.96298146, 'binary_f1_score': 0.3747811}
confusion matrix:
      0    1
0  5775  222
1   135  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_14.png
early stop counter: 6
val acc:0.9662280678749084, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 14,now: 2024-07-07 08:56:23.322105,epoch time: 0:25:00.938483,used: 5:48:41.631063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9832173, 'precision': 0.9846697, 'recall': 0.971964, 'specificity': 0.971964, 'f1': 0.97809124, 'auroc': 0.9962548, 'binary_precision': 0.98760843, 'binary_recall': 0.9481824, 'binary_specificity': 0.99574566, 'binary_f1_score': 0.96749395}
confusion matrix:
       0      1
0  42130    180
1    784  14346
---- Validation: 
scalar performance:
{'acc': 0.96601504, 'precision': 0.7228309, 'recall': 0.69334716, 'specificity': 0.69334716, 'f1': 0.70692825, 'auroc': 0.8896469, 'binary_precision': 0.4653846, 'binary_recall': 0.40199336, 'binary_specificity': 0.9847009, 'binary_f1_score': 0.43137252}
confusion matrix:
       0    1
0  17893  278
1    360  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93893254, 'precision': 0.6413554, 'recall': 0.70452964, 'specificity': 0.70452964, 'f1': 0.66593325, 'auroc': 0.8765112, 'binary_precision': 0.30532214, 'binary_recall': 0.45041323, 'binary_specificity': 0.958646, 'binary_f1_score': 0.3639399}
confusion matrix:
      0    1
0  5749  248
1   133  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_15.png
early stop counter: 7
val acc:0.9660150408744812, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 15,now: 2024-07-07 09:21:07.679446,epoch time: 0:24:44.357341,used: 6:13:25.988404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98238164, 'precision': 0.98164594, 'recall': 0.9727555, 'specificity': 0.9727555, 'f1': 0.9770888, 'auroc': 0.99618775, 'binary_precision': 0.9801388, 'binary_recall': 0.9524124, 'binary_specificity': 0.99309856, 'binary_f1_score': 0.96607673}
confusion matrix:
       0      1
0  42018    292
1    720  14410
---- Validation: 
scalar performance:
{'acc': 0.96558887, 'precision': 0.7194059, 'recall': 0.69393003, 'specificity': 0.69393003, 'f1': 0.7057941, 'auroc': 0.89066017, 'binary_precision': 0.45849058, 'binary_recall': 0.4036545, 'binary_specificity': 0.9842056, 'binary_f1_score': 0.42932862}
confusion matrix:
       0    1
0  17884  287
1    359  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93765026, 'precision': 0.64047897, 'recall': 0.7117936, 'specificity': 0.7117936, 'f1': 0.66734433, 'auroc': 0.87693024, 'binary_precision': 0.30294907, 'binary_recall': 0.46694216, 'binary_specificity': 0.956645, 'binary_f1_score': 0.36747965}
confusion matrix:
      0    1
0  5737  260
1   129  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_16.png
early stop counter: 8
val acc:0.9655888676643372, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 16,now: 2024-07-07 09:46:02.346282,epoch time: 0:24:54.666836,used: 6:38:20.655240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9838092, 'precision': 0.9846083, 'recall': 0.97353196, 'specificity': 0.97353196, 'f1': 0.9788983, 'auroc': 0.99657774, 'binary_precision': 0.98623383, 'binary_recall': 0.9518144, 'binary_specificity': 0.99524945, 'binary_f1_score': 0.96871847}
confusion matrix:
       0      1
0  42110    201
1    729  14400
---- Validation: 
scalar performance:
{'acc': 0.9648964, 'precision': 0.7164587, 'recall': 0.7112394, 'specificity': 0.7112394, 'f1': 0.7138135, 'auroc': 0.8929249, 'binary_precision': 0.45144805, 'binary_recall': 0.44019935, 'binary_specificity': 0.9822795, 'binary_f1_score': 0.44575274}
confusion matrix:
       0    1
0  17849  322
1    337  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93668854, 'precision': 0.64394695, 'recall': 0.7311207, 'specificity': 0.7311207, 'f1': 0.6752027, 'auroc': 0.8781581, 'binary_precision': 0.30827066, 'binary_recall': 0.5082645, 'binary_specificity': 0.953977, 'binary_f1_score': 0.38377535}
confusion matrix:
      0    1
0  5721  276
1   119  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_17.png
early stop counter: 9
val acc:0.9648963809013367, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 17,now: 2024-07-07 10:10:53.204280,epoch time: 0:24:50.857998,used: 7:03:11.513238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98354805, 'precision': 0.9845178, 'recall': 0.97295284, 'specificity': 0.97295284, 'f1': 0.97854805, 'auroc': 0.996415, 'binary_precision': 0.9864874, 'binary_recall': 0.9505618, 'binary_specificity': 0.99534386, 'binary_f1_score': 0.9681915}
confusion matrix:
       0      1
0  42113    197
1    748  14382
---- Validation: 
scalar performance:
{'acc': 0.96606827, 'precision': 0.7241688, 'recall': 0.7014051, 'specificity': 0.7014051, 'f1': 0.7121101, 'auroc': 0.8933315, 'binary_precision': 0.46753246, 'binary_recall': 0.41860464, 'binary_specificity': 0.9842056, 'binary_f1_score': 0.44171777}
confusion matrix:
       0    1
0  17884  287
1    350  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9408559, 'precision': 0.651983, 'recall': 0.7233748, 'specificity': 0.7233748, 'f1': 0.6795019, 'auroc': 0.87897325, 'binary_precision': 0.32506886, 'binary_recall': 0.4876033, 'binary_specificity': 0.95914626, 'binary_f1_score': 0.39008266}
confusion matrix:
      0    1
0  5752  245
1   124  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_18.png
early stop counter: 10
val acc:0.9660682678222656, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 18,now: 2024-07-07 10:35:38.166316,epoch time: 0:24:44.962036,used: 7:27:56.475274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9845404, 'precision': 0.9852203, 'recall': 0.97481525, 'specificity': 0.97481525, 'f1': 0.9798662, 'auroc': 0.9971689, 'binary_precision': 0.98660654, 'binary_recall': 0.95426303, 'binary_specificity': 0.9953675, 'binary_f1_score': 0.97016525}
confusion matrix:
       0      1
0  42114    196
1    692  14438
---- Validation: 
scalar performance:
{'acc': 0.9638843, 'precision': 0.7077613, 'recall': 0.70108, 'specificity': 0.70108, 'f1': 0.70435953, 'auroc': 0.89179206, 'binary_precision': 0.4347079, 'binary_recall': 0.4202658, 'binary_specificity': 0.98189425, 'binary_f1_score': 0.42736492}
confusion matrix:
       0    1
0  17842  329
1    349  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93348294, 'precision': 0.63539505, 'recall': 0.7254877, 'specificity': 0.7254877, 'f1': 0.666617, 'auroc': 0.8716562, 'binary_precision': 0.29156625, 'binary_recall': 0.5, 'binary_specificity': 0.9509755, 'binary_f1_score': 0.36834094}
confusion matrix:
      0    1
0  5703  294
1   121  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_19.png
early stop counter: 11
val acc:0.9638842940330505, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 19,now: 2024-07-07 11:01:50.313728,epoch time: 0:26:12.147412,used: 7:54:08.622686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9846971, 'precision': 0.98702335, 'recall': 0.9734976, 'specificity': 0.9734976, 'f1': 0.9800068, 'auroc': 0.99703455, 'binary_precision': 0.9917184, 'binary_recall': 0.9498314, 'binary_specificity': 0.99716383, 'binary_f1_score': 0.97032315}
confusion matrix:
       0      1
0  42191    120
1    759  14370
---- Validation: 
scalar performance:
{'acc': 0.96692055, 'precision': 0.72688377, 'recall': 0.6520564, 'specificity': 0.6520564, 'f1': 0.6813138, 'auroc': 0.89114857, 'binary_precision': 0.47619048, 'binary_recall': 0.3156146, 'binary_specificity': 0.98849815, 'binary_f1_score': 0.3796204}
confusion matrix:
       0    1
0  17962  209
1    412  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9490303, 'precision': 0.6668787, 'recall': 0.68400663, 'specificity': 0.68400663, 'f1': 0.6749499, 'auroc': 0.8731177, 'binary_precision': 0.35820895, 'binary_recall': 0.3966942, 'binary_specificity': 0.971319, 'binary_f1_score': 0.3764706}
confusion matrix:
      0    1
0  5825  172
1   146   96
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_20.png
early stop counter: 12
val acc:0.9669205546379089, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 20,now: 2024-07-07 11:28:44.083358,epoch time: 0:26:53.769630,used: 8:21:02.392316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9858461, 'precision': 0.9865977, 'recall': 0.97682405, 'specificity': 0.97682405, 'f1': 0.98157763, 'auroc': 0.9972783, 'binary_precision': 0.9881334, 'binary_recall': 0.95776045, 'binary_specificity': 0.9958877, 'binary_f1_score': 0.9727099}
confusion matrix:
       0      1
0  42138    174
1    639  14489
---- Validation: 
scalar performance:
{'acc': 0.96548235, 'precision': 0.72233844, 'recall': 0.7251939, 'specificity': 0.7251939, 'f1': 0.723756, 'auroc': 0.9018999, 'binary_precision': 0.4622951, 'binary_recall': 0.46843854, 'binary_specificity': 0.98194927, 'binary_f1_score': 0.46534654}
confusion matrix:
       0    1
0  17843  328
1    320  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9429396, 'precision': 0.657494, 'recall': 0.7224759, 'specificity': 0.7224759, 'f1': 0.683332, 'auroc': 0.88167846, 'binary_precision': 0.33620688, 'binary_recall': 0.48347107, 'binary_specificity': 0.96148074, 'binary_f1_score': 0.39661017}
confusion matrix:
      0    1
0  5766  231
1   125  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_21.png
early stop counter: 13
val acc:0.9654823541641235, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 21,now: 2024-07-07 11:55:30.749950,epoch time: 0:26:46.666592,used: 8:47:49.058908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98615944, 'precision': 0.98723054, 'recall': 0.97701824, 'specificity': 0.97701824, 'f1': 0.98197913, 'auroc': 0.99740684, 'binary_precision': 0.9894162, 'binary_recall': 0.95769995, 'binary_specificity': 0.9963366, 'binary_f1_score': 0.97329974}
confusion matrix:
       0      1
0  42155    155
1    640  14490
---- Validation: 
scalar performance:
{'acc': 0.96431047, 'precision': 0.71337026, 'recall': 0.71816415, 'specificity': 0.71816415, 'f1': 0.7157374, 'auroc': 0.9006661, 'binary_precision': 0.4448052, 'binary_recall': 0.4551495, 'binary_specificity': 0.9811788, 'binary_f1_score': 0.4499179}
confusion matrix:
       0    1
0  17829  342
1    328  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93716943, 'precision': 0.6478635, 'recall': 0.74128455, 'specificity': 0.74128455, 'f1': 0.6809628, 'auroc': 0.876472, 'binary_precision': 0.31527093, 'binary_recall': 0.5289256, 'binary_specificity': 0.9536435, 'binary_f1_score': 0.39506173}
confusion matrix:
      0    1
0  5719  278
1   114  128
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_22.png
early stop counter: 14
val acc:0.9643104672431946, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 22,now: 2024-07-07 12:22:18.031434,epoch time: 0:26:47.281484,used: 9:14:36.340392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9854631, 'precision': 0.9866674, 'recall': 0.9757813, 'specificity': 0.9757813, 'f1': 0.9810592, 'auroc': 0.99717236, 'binary_precision': 0.9891193, 'binary_recall': 0.95532054, 'binary_specificity': 0.99624205, 'binary_f1_score': 0.97192615}
confusion matrix:
       0      1
0  42151    159
1    676  14454
---- Validation: 
scalar performance:
{'acc': 0.9646833, 'precision': 0.71897453, 'recall': 0.7424482, 'specificity': 0.7424482, 'f1': 0.73004323, 'auroc': 0.9039514, 'binary_precision': 0.45440957, 'binary_recall': 0.50498337, 'binary_specificity': 0.97991306, 'binary_f1_score': 0.47836348}
confusion matrix:
       0    1
0  17806  365
1    298  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9410162, 'precision': 0.65677077, 'recall': 0.73932004, 'specificity': 0.73932004, 'f1': 0.68770885, 'auroc': 0.88084054, 'binary_precision': 0.33333334, 'binary_recall': 0.5206612, 'binary_specificity': 0.95797896, 'binary_f1_score': 0.40645164}
confusion matrix:
      0    1
0  5745  252
1   116  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_23.png
early stop counter: 15
val acc:0.9646832942962646, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 23,now: 2024-07-07 12:48:55.249567,epoch time: 0:26:37.218133,used: 9:41:13.558525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9871344, 'precision': 0.98642874, 'recall': 0.9803114, 'specificity': 0.9803114, 'f1': 0.9833175, 'auroc': 0.99732006, 'binary_precision': 0.984969, 'binary_recall': 0.9658933, 'binary_specificity': 0.9947295, 'binary_f1_score': 0.97533786}
confusion matrix:
       0      1
0  42088    223
1    516  14613
---- Validation: 
scalar performance:
{'acc': 0.96164703, 'precision': 0.7001238, 'recall': 0.73525846, 'specificity': 0.73525846, 'f1': 0.71609145, 'auroc': 0.9010693, 'binary_precision': 0.41713482, 'binary_recall': 0.49335548, 'binary_specificity': 0.9771614, 'binary_f1_score': 0.4520548}
confusion matrix:
       0    1
0  17756  415
1    305  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92979646, 'precision': 0.6387237, 'recall': 0.76322496, 'specificity': 0.76322496, 'f1': 0.6772077, 'auroc': 0.87575746, 'binary_precision': 0.29497907, 'binary_recall': 0.58264464, 'binary_specificity': 0.9438052, 'binary_f1_score': 0.39166665}
confusion matrix:
      0    1
0  5660  337
1   101  141
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_24.png
early stop counter: 16
val acc:0.9616470336914062, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 24,now: 2024-07-07 13:15:33.678541,epoch time: 0:26:38.428974,used: 10:07:51.987499,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.986734, 'precision': 0.9862145, 'recall': 0.97948754, 'specificity': 0.97948754, 'f1': 0.9827875, 'auroc': 0.99750125, 'binary_precision': 0.9851422, 'binary_recall': 0.96417475, 'binary_specificity': 0.9948004, 'binary_f1_score': 0.97454566}
confusion matrix:
       0      1
0  42091    220
1    542  14587
---- Validation: 
scalar performance:
{'acc': 0.9624993, 'precision': 0.70385027, 'recall': 0.72927433, 'specificity': 0.72927433, 'f1': 0.71572244, 'auroc': 0.9010631, 'binary_precision': 0.425, 'binary_recall': 0.48006645, 'binary_specificity': 0.9784822, 'binary_f1_score': 0.45085803}
confusion matrix:
       0    1
0  17780  391
1    313  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93476516, 'precision': 0.6449087, 'recall': 0.74994767, 'specificity': 0.74994767, 'f1': 0.68038416, 'auroc': 0.87673247, 'binary_precision': 0.3085847, 'binary_recall': 0.5495868, 'binary_specificity': 0.9503085, 'binary_f1_score': 0.39524516}
confusion matrix:
      0    1
0  5699  298
1   109  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_25.png
early stop counter: 17
val acc:0.9624993205070496, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 25,now: 2024-07-07 13:42:11.505095,epoch time: 0:26:37.826554,used: 10:34:29.814053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9871518, 'precision': 0.98797375, 'recall': 0.9788382, 'specificity': 0.9788382, 'f1': 0.98328984, 'auroc': 0.9977653, 'binary_precision': 0.98965704, 'binary_recall': 0.961269, 'binary_specificity': 0.99640745, 'binary_f1_score': 0.9752565}
confusion matrix:
       0      1
0  42158    152
1    586  14544
---- Validation: 
scalar performance:
{'acc': 0.9632984, 'precision': 0.7058872, 'recall': 0.71282303, 'specificity': 0.71282303, 'f1': 0.7092906, 'auroc': 0.8991739, 'binary_precision': 0.43017656, 'binary_recall': 0.4451827, 'binary_specificity': 0.9804634, 'binary_f1_score': 0.437551}
confusion matrix:
       0    1
0  17816  355
1    334  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93845165, 'precision': 0.6499755, 'recall': 0.7379861, 'specificity': 0.7379861, 'f1': 0.6818997, 'auroc': 0.87429404, 'binary_precision': 0.31979695, 'binary_recall': 0.5206612, 'binary_specificity': 0.955311, 'binary_f1_score': 0.3962264}
confusion matrix:
      0    1
0  5729  268
1   116  126
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_26.png
early stop counter: 18
val acc:0.9632983803749084, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 26,now: 2024-07-07 14:08:42.585370,epoch time: 0:26:31.080275,used: 11:01:00.894328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.9877108, 'recall': 0.9799863, 'specificity': 0.9799863, 'f1': 0.98376524, 'auroc': 0.9975852, 'binary_precision': 0.98814446, 'binary_recall': 0.96410865, 'binary_specificity': 0.995864, 'binary_f1_score': 0.9759786}
confusion matrix:
       0      1
0  42136    175
1    543  14586
---- Validation: 
scalar performance:
{'acc': 0.9639376, 'precision': 0.7133276, 'recall': 0.7348355, 'specificity': 0.7348355, 'f1': 0.723503, 'auroc': 0.9039397, 'binary_precision': 0.44360903, 'binary_recall': 0.4900332, 'binary_specificity': 0.97963786, 'binary_f1_score': 0.46566692}
confusion matrix:
       0    1
0  17801  370
1    307  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93749, 'precision': 0.6497099, 'recall': 0.74541676, 'specificity': 0.74541676, 'f1': 0.68351364, 'auroc': 0.877766, 'binary_precision': 0.31862745, 'binary_recall': 0.5371901, 'binary_specificity': 0.9536435, 'binary_f1_score': 0.39999998}
confusion matrix:
      0    1
0  5719  278
1   112  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_27.png
early stop counter: 19
val acc:0.9639375805854797, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 27,now: 2024-07-07 14:35:06.587900,epoch time: 0:26:24.002530,used: 11:27:24.896858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9870996, 'precision': 0.98824626, 'recall': 0.97844064, 'specificity': 0.97844064, 'f1': 0.98320985, 'auroc': 0.9977164, 'binary_precision': 0.9905892, 'binary_recall': 0.9601428, 'binary_specificity': 0.99673843, 'binary_f1_score': 0.9751284}
confusion matrix:
       0      1
0  42173    138
1    603  14526
---- Validation: 
scalar performance:
{'acc': 0.9628189, 'precision': 0.70839494, 'recall': 0.74630344, 'specificity': 0.74630344, 'f1': 0.72557145, 'auroc': 0.9049742, 'binary_precision': 0.4329609, 'binary_recall': 0.51495016, 'binary_specificity': 0.9776567, 'binary_f1_score': 0.47040972}
confusion matrix:
       0    1
0  17765  406
1    292  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9326815, 'precision': 0.64037013, 'recall': 0.74886376, 'specificity': 0.74886376, 'f1': 0.6760689, 'auroc': 0.8747426, 'binary_precision': 0.29954955, 'binary_recall': 0.5495868, 'binary_specificity': 0.94814074, 'binary_f1_score': 0.3877551}
confusion matrix:
      0    1
0  5686  311
1   109  133
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_28.png
early stop counter: 20
val acc:0.9628189206123352, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 28,now: 2024-07-07 15:01:21.357543,epoch time: 0:26:14.769643,used: 11:53:39.666501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98800486, 'precision': 0.98928154, 'recall': 0.97975576, 'specificity': 0.97975576, 'f1': 0.9843929, 'auroc': 0.99787724, 'binary_precision': 0.99189264, 'binary_recall': 0.962324, 'binary_specificity': 0.9971875, 'binary_f1_score': 0.9768846}
confusion matrix:
       0      1
0  42192    119
1    570  14559
---- Validation: 
scalar performance:
{'acc': 0.965216, 'precision': 0.7196907, 'recall': 0.7186319, 'specificity': 0.7186319, 'f1': 0.71915984, 'auroc': 0.90249455, 'binary_precision': 0.45742905, 'binary_recall': 0.4551495, 'binary_specificity': 0.9821144, 'binary_f1_score': 0.45628643}
confusion matrix:
       0    1
0  17846  325
1    328  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9398942, 'precision': 0.6487568, 'recall': 0.7208918, 'specificity': 0.7208918, 'f1': 0.6763208, 'auroc': 0.8726216, 'binary_precision': 0.31880108, 'binary_recall': 0.48347107, 'binary_specificity': 0.9583125, 'binary_f1_score': 0.38423645}
confusion matrix:
      0    1
0  5747  250
1   125  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_29.png
early stop counter: 21
val acc:0.9652159810066223, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 29,now: 2024-07-07 15:27:26.979423,epoch time: 0:26:05.621880,used: 12:19:45.288381,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98763925, 'precision': 0.98808837, 'recall': 0.97997355, 'specificity': 0.97997355, 'f1': 0.9839392, 'auroc': 0.9978912, 'binary_precision': 0.989011, 'binary_recall': 0.96377575, 'binary_specificity': 0.9961713, 'binary_f1_score': 0.9762303}
confusion matrix:
       0      1
0  42150    162
1    548  14580
---- Validation: 
scalar performance:
{'acc': 0.9639376, 'precision': 0.7126495, 'recall': 0.73001724, 'specificity': 0.73001724, 'f1': 0.72095144, 'auroc': 0.9043957, 'binary_precision': 0.44257274, 'binary_recall': 0.48006645, 'binary_specificity': 0.9799681, 'binary_f1_score': 0.46055776}
confusion matrix:
       0    1
0  17807  364
1    313  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93877226, 'precision': 0.6502547, 'recall': 0.73617005, 'specificity': 0.73617005, 'f1': 0.68166125, 'auroc': 0.87450254, 'binary_precision': 0.32051283, 'binary_recall': 0.5165289, 'binary_specificity': 0.95581126, 'binary_f1_score': 0.39556962}
confusion matrix:
      0    1
0  5732  265
1   117  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716431_30.png
early stop counter: 22
val acc:0.9639375805854797, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9511139392852783 / 0.9522359371185303
after epoch: 30,now: 2024-07-07 15:53:28.271980,epoch time: 0:26:01.292557,used: 12:45:46.580938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_07_41_seed_2_21716431
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:45:46.580938 at 2024-07-07 15:53:28.271980
persisted model performance metric: 

scalar performance:
{'acc': 0.95111394, 'precision': 0.66661453, 'recall': 0.6553494, 'specificity': 0.6553494, 'f1': 0.66075087, 'auroc': 0.8730247, 'binary_precision': 0.36, 'binary_recall': 0.33471075, 'binary_specificity': 0.975988, 'binary_f1_score': 0.3468951}
confusion matrix:
      0    1
0  5853  144
1   161   81
oracle model performance metric: 

scalar performance:
{'acc': 0.95223594, 'precision': 0.6491609, 'recall': 0.602399, 'specificity': 0.602399, 'f1': 0.62066233, 'auroc': 0.8502314, 'binary_precision': 0.3292683, 'binary_recall': 0.2231405, 'binary_specificity': 0.9816575, 'binary_f1_score': 0.26600987}
confusion matrix:
      0    1
0  5887  110
1   188   54
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |  17485 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |  17485 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   7827 MiB |   3575 TiB |   3575 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   3529 TiB |   3529 TiB |
|       from small pool |  16481 KiB |     36 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  25072 MiB |  16560 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25002 MiB |  16528 MiB |
|       from small pool |     38 MiB |     44 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38824 KiB | 732464 KiB |   1973 TiB |   1973 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1927 TiB |   1927 TiB |
|       from small pool |   7091 KiB |  23284 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7675    |  590644 K  |  590641 K  |
|       from large pool |      79    |     762    |  335134 K  |  335133 K  |
|       from small pool |    2887    |    7594    |  255510 K  |  255507 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7675    |  590644 K  |  590641 K  |
|       from large pool |      79    |     762    |  335134 K  |  335133 K  |
|       from small pool |    2887    |    7594    |  255510 K  |  255507 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |    1061    |     693    |
|       from large pool |     349    |     349    |    1026    |     677    |
|       from small pool |      19    |      22    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3611    |  344443 K  |  344443 K  |
|       from large pool |      11    |     352    |  236178 K  |  236178 K  |
|       from small pool |      23    |    3601    |  108265 K  |  108265 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |      0 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |      0 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   3575 TiB |   3575 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   3529 TiB |   3529 TiB |
|       from small pool |      0 KiB |     36 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  25072 MiB |  24842 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25002 MiB |  24796 MiB |
|       from small pool |  24576 KiB |     44 MiB |     70 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1973 TiB |   1973 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1927 TiB |   1927 TiB |
|       from small pool |      0 KiB |  23284 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7675    |  590644 K  |  590644 K  |
|       from large pool |       2    |     762    |  335134 K  |  335134 K  |
|       from small pool |       0    |    7594    |  255510 K  |  255510 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7675    |  590644 K  |  590644 K  |
|       from large pool |       2    |     762    |  335134 K  |  335134 K  |
|       from small pool |       0    |    7594    |  255510 K  |  255510 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |    1061    |    1039    |
|       from large pool |      10    |     349    |    1026    |    1016    |
|       from small pool |      12    |      22    |      35    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3611    |  344444 K  |  344444 K  |
|       from large pool |       3    |     352    |  236178 K  |  236178 K  |
|       from small pool |       0    |    3601    |  108266 K  |  108266 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul  7 15:54:51 2024]
Finished job 0.
1 of 1 steps (100%) done
