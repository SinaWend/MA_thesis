Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul  6 01:11:51 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430

 Experiment start at: 2024-07-06 01:18:46.256137
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9399369, 'precision': 0.9599453, 'recall': 0.88527274, 'specificity': 0.88527274, 'f1': 0.9150256, 'auroc': 0.96859443, 'binary_precision': 0.99335724, 'binary_recall': 0.77234113, 'binary_specificity': 0.99820435, 'binary_f1_score': 0.86901665}
confusion matrix:
       0      1
0  42249     76
1   3350  11365
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9537569, 'precision': 0.54655373, 'recall': 0.52227587, 'specificity': 0.52227587, 'f1': 0.5283527, 'auroc': 0.79717207, 'binary_precision': 0.12582782, 'binary_recall': 0.05909798, 'binary_specificity': 0.9854537, 'binary_f1_score': 0.08042328}
confusion matrix:
       0    1
0  17885  264
1    605   38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9503036, 'precision': 0.5883435, 'recall': 0.53064555, 'specificity': 0.53064555, 'f1': 0.5416608, 'auroc': 0.8275913, 'binary_precision': 0.2159091, 'binary_recall': 0.07279693, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.10888252}
confusion matrix:
      0   1
0  5928  69
1   242  19
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-06 01:41:55.673710,epoch time: 0:23:09.417573,used: 0:23:09.417573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95376927, 'precision': 0.967078, 'recall': 0.9129967, 'specificity': 0.9129967, 'f1': 0.9360727, 'auroc': 0.9813144, 'binary_precision': 0.9904978, 'binary_recall': 0.8287578, 'binary_specificity': 0.9972356, 'binary_f1_score': 0.9024381}
confusion matrix:
       0      1
0  42207    117
1   2520  12196
---- Validation: 
scalar performance:
{'acc': 0.9567369, 'precision': 0.6321156, 'recall': 0.5853232, 'specificity': 0.5853232, 'f1': 0.60283256, 'auroc': 0.8569772, 'binary_precision': 0.29268292, 'binary_recall': 0.1866252, 'binary_specificity': 0.9840212, 'binary_f1_score': 0.22792022}
confusion matrix:
       0    1
0  17859  290
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.7004139, 'recall': 0.60660696, 'specificity': 0.60660696, 'f1': 0.63710374, 'auroc': 0.8809705, 'binary_precision': 0.43382353, 'binary_recall': 0.22605364, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.2972292}
confusion matrix:
      0   1
0  5920  77
1   202  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-06 02:04:39.387538,epoch time: 0:22:43.713828,used: 0:45:53.131401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96143055, 'precision': 0.97003126, 'recall': 0.92933404, 'specificity': 0.92933404, 'f1': 0.9474278, 'auroc': 0.9853723, 'binary_precision': 0.9857198, 'binary_recall': 0.86301553, 'binary_specificity': 0.9956525, 'binary_f1_score': 0.9202956}
confusion matrix:
       0      1
0  42139    184
1   2016  12701
---- Validation: 
scalar performance:
{'acc': 0.9559387, 'precision': 0.652112, 'recall': 0.6291632, 'specificity': 0.6291632, 'f1': 0.63955325, 'auroc': 0.87649524, 'binary_precision': 0.3296501, 'binary_recall': 0.27838257, 'binary_specificity': 0.9799438, 'binary_f1_score': 0.30185497}
confusion matrix:
       0    1
0  17785  364
1    464  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7636633, 'recall': 0.6922302, 'specificity': 0.6922302, 'f1': 0.7216399, 'auroc': 0.8982531, 'binary_precision': 0.5531915, 'binary_recall': 0.39846742, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.46325165}
confusion matrix:
      0    1
0  5913   84
1   157  104
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_3.png
new oracle model saved
early stop counter: 1
val acc:0.9559386968612671, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9614893198013306
after epoch: 3,now: 2024-07-06 02:27:19.882620,epoch time: 0:22:40.495082,used: 1:08:33.626483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9673387, 'precision': 0.9705987, 'recall': 0.943642, 'specificity': 0.943642, 'f1': 0.95611846, 'auroc': 0.98826146, 'binary_precision': 0.9767804, 'binary_recall': 0.8946796, 'binary_specificity': 0.9926045, 'binary_f1_score': 0.9339292}
confusion matrix:
       0      1
0  42010    313
1   1550  13167
---- Validation: 
scalar performance:
{'acc': 0.95455515, 'precision': 0.6647052, 'recall': 0.68095076, 'specificity': 0.68095076, 'f1': 0.67238647, 'auroc': 0.8872263, 'binary_precision': 0.35119888, 'binary_recall': 0.38724726, 'binary_specificity': 0.97465426, 'binary_f1_score': 0.36834323}
confusion matrix:
       0    1
0  17689  460
1    394  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.7562053, 'recall': 0.7524471, 'specificity': 0.7524471, 'f1': 0.75431037, 'auroc': 0.9050783, 'binary_precision': 0.5330739, 'binary_recall': 0.5249042, 'binary_specificity': 0.97999, 'binary_f1_score': 0.5289575}
confusion matrix:
      0    1
0  5877  120
1   124  137
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_4.png
early stop counter: 2
val acc:0.9545551538467407, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9614893198013306
after epoch: 4,now: 2024-07-06 02:50:09.593296,epoch time: 0:22:49.710676,used: 1:31:23.337159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96953017, 'precision': 0.97046757, 'recall': 0.9494018, 'specificity': 0.9494018, 'f1': 0.9593183, 'auroc': 0.98964965, 'binary_precision': 0.9722768, 'binary_recall': 0.9078062, 'binary_specificity': 0.9909974, 'binary_f1_score': 0.9389361}
confusion matrix:
       0      1
0  41940    381
1   1357  13362
---- Validation: 
scalar performance:
{'acc': 0.9537569, 'precision': 0.6712763, 'recall': 0.7157901, 'specificity': 0.7157901, 'f1': 0.6905726, 'auroc': 0.89403915, 'binary_precision': 0.3618582, 'binary_recall': 0.46034214, 'binary_specificity': 0.9712381, 'binary_f1_score': 0.40520194}
confusion matrix:
       0    1
0  17627  522
1    347  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7642168, 'recall': 0.8045862, 'specificity': 0.8045862, 'f1': 0.782764, 'auroc': 0.9090166, 'binary_precision': 0.5445545, 'binary_recall': 0.6321839, 'binary_specificity': 0.9769885, 'binary_f1_score': 0.5851064}
confusion matrix:
      0    1
0  5859  138
1    96  165
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_5.png
new oracle model saved
early stop counter: 3
val acc:0.9537569284439087, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 5,now: 2024-07-06 03:12:56.356739,epoch time: 0:22:46.763443,used: 1:54:10.100602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9714411, 'precision': 0.9729469, 'recall': 0.9520073, 'specificity': 0.9520073, 'f1': 0.96187234, 'auroc': 0.9909247, 'binary_precision': 0.9758545, 'binary_recall': 0.9118586, 'binary_specificity': 0.9921559, 'binary_f1_score': 0.9427718}
confusion matrix:
       0      1
0  41993    332
1   1297  13418
---- Validation: 
scalar performance:
{'acc': 0.9526926, 'precision': 0.6695044, 'recall': 0.72498983, 'specificity': 0.72498983, 'f1': 0.69272226, 'auroc': 0.89739835, 'binary_precision': 0.3576389, 'binary_recall': 0.4805599, 'binary_specificity': 0.9694198, 'binary_f1_score': 0.41008627}
confusion matrix:
       0    1
0  17594  555
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7570913, 'recall': 0.82407486, 'specificity': 0.82407486, 'f1': 0.786147, 'auroc': 0.91151214, 'binary_precision': 0.5285285, 'binary_recall': 0.6743295, 'binary_specificity': 0.97382027, 'binary_f1_score': 0.5925926}
confusion matrix:
      0    1
0  5840  157
1    85  176
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_6.png
early stop counter: 4
val acc:0.9526926279067993, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 6,now: 2024-07-06 03:35:20.705674,epoch time: 0:22:24.348935,used: 2:16:34.449537,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97342217, 'precision': 0.97403586, 'recall': 0.9561181, 'specificity': 0.9561181, 'f1': 0.9646338, 'auroc': 0.9910749, 'binary_precision': 0.9752322, 'binary_recall': 0.9203642, 'binary_specificity': 0.991872, 'binary_f1_score': 0.9470041}
confusion matrix:
       0      1
0  41979    344
1   1172  13545
---- Validation: 
scalar performance:
{'acc': 0.9521605, 'precision': 0.67065275, 'recall': 0.73746526, 'specificity': 0.73746526, 'f1': 0.6977123, 'auroc': 0.8982002, 'binary_precision': 0.35903084, 'binary_recall': 0.5069984, 'binary_specificity': 0.9679321, 'binary_f1_score': 0.42037395}
confusion matrix:
       0    1
0  17567  582
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.73824805, 'recall': 0.82740414, 'specificity': 0.82740414, 'f1': 0.7746725, 'auroc': 0.9119675, 'binary_precision': 0.49041095, 'binary_recall': 0.68582374, 'binary_specificity': 0.9689845, 'binary_f1_score': 0.571885}
confusion matrix:
      0    1
0  5811  186
1    82  179
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_7.png
early stop counter: 5
val acc:0.9521604776382446, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 7,now: 2024-07-06 03:57:49.947324,epoch time: 0:22:29.241650,used: 2:39:03.691187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9755961, 'precision': 0.9764471, 'recall': 0.95946425, 'specificity': 0.95946425, 'f1': 0.9675598, 'auroc': 0.99210846, 'binary_precision': 0.9781111, 'binary_recall': 0.9261348, 'binary_specificity': 0.9927937, 'binary_f1_score': 0.95141363}
confusion matrix:
       0      1
0  42019    305
1   1087  13629
---- Validation: 
scalar performance:
{'acc': 0.95285225, 'precision': 0.6745009, 'recall': 0.7430738, 'specificity': 0.7430738, 'f1': 0.7022672, 'auroc': 0.9015683, 'binary_precision': 0.36633664, 'binary_recall': 0.5178849, 'binary_specificity': 0.96826273, 'binary_f1_score': 0.4291237}
confusion matrix:
       0    1
0  17573  576
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.74269855, 'recall': 0.8352337, 'specificity': 0.8352337, 'f1': 0.7803818, 'auroc': 0.9131881, 'binary_precision': 0.49863762, 'binary_recall': 0.7011494, 'binary_specificity': 0.969318, 'binary_f1_score': 0.5828026}
confusion matrix:
      0    1
0  5813  184
1    78  183
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_8.png
early stop counter: 6
val acc:0.9528522491455078, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 8,now: 2024-07-06 04:20:28.464926,epoch time: 0:22:38.517602,used: 3:01:42.208789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.977209, 'precision': 0.9769888, 'recall': 0.96314204, 'specificity': 0.96314204, 'f1': 0.96980166, 'auroc': 0.9938553, 'binary_precision': 0.97655416, 'binary_recall': 0.9340809, 'binary_specificity': 0.9922032, 'binary_f1_score': 0.9548455}
confusion matrix:
       0      1
0  41995    330
1    970  13745
---- Validation: 
scalar performance:
{'acc': 0.9511494, 'precision': 0.674103, 'recall': 0.7676941, 'specificity': 0.7676941, 'f1': 0.7093808, 'auroc': 0.90627843, 'binary_precision': 0.36372647, 'binary_recall': 0.57076204, 'binary_specificity': 0.96462613, 'binary_f1_score': 0.44430992}
confusion matrix:
       0    1
0  17507  642
1    276  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95238096, 'precision': 0.72038615, 'recall': 0.83223224, 'specificity': 0.83223224, 'f1': 0.7630307, 'auroc': 0.91524464, 'binary_precision': 0.4540943, 'binary_recall': 0.7011494, 'binary_specificity': 0.963315, 'binary_f1_score': 0.55120486}
confusion matrix:
      0    1
0  5777  220
1    78  183
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_9.png
early stop counter: 7
val acc:0.9511494040489197, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 9,now: 2024-07-06 04:43:03.060264,epoch time: 0:22:34.595338,used: 3:24:16.804127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9765778, 'precision': 0.979058, 'recall': 0.95955205, 'specificity': 0.95955205, 'f1': 0.9687879, 'auroc': 0.9929492, 'binary_precision': 0.9838721, 'binary_recall': 0.92437315, 'binary_specificity': 0.994731, 'binary_f1_score': 0.953195}
confusion matrix:
       0      1
0  42100    223
1   1113  13604
---- Validation: 
scalar performance:
{'acc': 0.9533844, 'precision': 0.6780581, 'recall': 0.7500998, 'specificity': 0.7500998, 'f1': 0.7070722, 'auroc': 0.9053122, 'binary_precision': 0.3729553, 'binary_recall': 0.5318818, 'binary_specificity': 0.9683178, 'binary_f1_score': 0.4384615}
confusion matrix:
       0    1
0  17574  575
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9539789, 'precision': 0.72583234, 'recall': 0.82940125, 'specificity': 0.82940125, 'f1': 0.766326, 'auroc': 0.91258466, 'binary_precision': 0.46529564, 'binary_recall': 0.6934866, 'binary_specificity': 0.965316, 'binary_f1_score': 0.55692303}
confusion matrix:
      0    1
0  5789  208
1    80  181
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_10.png
early stop counter: 8
val acc:0.9533843994140625, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 10,now: 2024-07-06 05:05:38.769779,epoch time: 0:22:35.709515,used: 3:46:52.513642,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97887444, 'precision': 0.9785337, 'recall': 0.9659932, 'specificity': 0.9659932, 'f1': 0.9720477, 'auroc': 0.9941292, 'binary_precision': 0.97785795, 'binary_recall': 0.9393816, 'binary_specificity': 0.99260485, 'binary_f1_score': 0.9582337}
confusion matrix:
       0      1
0  42012    313
1    892  13823
---- Validation: 
scalar performance:
{'acc': 0.9498723, 'precision': 0.670367, 'recall': 0.76928306, 'specificity': 0.76928306, 'f1': 0.70685714, 'auroc': 0.90701795, 'binary_precision': 0.35611165, 'binary_recall': 0.5754277, 'binary_specificity': 0.96313846, 'binary_f1_score': 0.43995243}
confusion matrix:
       0    1
0  17480  669
1    273  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9435922, 'precision': 0.6951357, 'recall': 0.84047294, 'specificity': 0.84047294, 'f1': 0.74422956, 'auroc': 0.9148936, 'binary_precision': 0.40254238, 'binary_recall': 0.72796935, 'binary_specificity': 0.95297647, 'binary_f1_score': 0.5184175}
confusion matrix:
      0    1
0  5715  282
1    71  190
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_11.png
early stop counter: 9
val acc:0.9498723149299622, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 11,now: 2024-07-06 05:28:12.431394,epoch time: 0:22:33.661615,used: 4:09:26.175257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9807153, 'precision': 0.981336, 'recall': 0.9680797, 'specificity': 0.9680797, 'f1': 0.9744687, 'auroc': 0.99500155, 'binary_precision': 0.98256433, 'binary_recall': 0.9419719, 'binary_specificity': 0.99418753, 'binary_f1_score': 0.96184}
confusion matrix:
       0      1
0  42077    246
1    854  13863
---- Validation: 
scalar performance:
{'acc': 0.94785017, 'precision': 0.6637218, 'recall': 0.76673603, 'specificity': 0.76673603, 'f1': 0.70079106, 'auroc': 0.9052565, 'binary_precision': 0.34296367, 'binary_recall': 0.57231724, 'binary_specificity': 0.9611549, 'binary_f1_score': 0.42890444}
confusion matrix:
       0    1
0  17444  705
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9394375, 'precision': 0.6845999, 'recall': 0.8383052, 'specificity': 0.8383052, 'f1': 0.7342113, 'auroc': 0.9124631, 'binary_precision': 0.3815261, 'binary_recall': 0.72796935, 'binary_specificity': 0.948641, 'binary_f1_score': 0.5006588}
confusion matrix:
      0    1
0  5689  308
1    71  190
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_12.png
early stop counter: 10
val acc:0.9478501677513123, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 12,now: 2024-07-06 05:50:47.658863,epoch time: 0:22:35.227469,used: 4:32:01.402726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9803647, 'precision': 0.9796406, 'recall': 0.9688203, 'specificity': 0.9688203, 'f1': 0.9740699, 'auroc': 0.99538136, 'binary_precision': 0.9781967, 'binary_recall': 0.94496536, 'binary_specificity': 0.9926752, 'binary_f1_score': 0.96129394}
confusion matrix:
       0      1
0  42012    310
1    810  13908
---- Validation: 
scalar performance:
{'acc': 0.9451894, 'precision': 0.6542288, 'recall': 0.75785804, 'specificity': 0.75785804, 'f1': 0.69066983, 'auroc': 0.90221465, 'binary_precision': 0.32456934, 'binary_recall': 0.55676514, 'binary_specificity': 0.9589509, 'binary_f1_score': 0.41008016}
confusion matrix:
       0    1
0  17404  745
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9348034, 'precision': 0.67336786, 'recall': 0.83222264, 'specificity': 0.83222264, 'f1': 0.7224076, 'auroc': 0.908159, 'binary_precision': 0.35946462, 'binary_recall': 0.7203065, 'binary_specificity': 0.94413877, 'binary_f1_score': 0.4795918}
confusion matrix:
      0    1
0  5662  335
1    73  188
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_13.png
early stop counter: 11
val acc:0.9451894164085388, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 13,now: 2024-07-06 06:13:28.089154,epoch time: 0:22:40.430291,used: 4:54:41.833017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9812062, 'precision': 0.98224974, 'recall': 0.968477, 'specificity': 0.968477, 'f1': 0.975106, 'auroc': 0.99524224, 'binary_precision': 0.98431176, 'binary_recall': 0.9421757, 'binary_specificity': 0.9947783, 'binary_f1_score': 0.9627829}
confusion matrix:
       0      1
0  42102    221
1    851  13866
---- Validation: 
scalar performance:
{'acc': 0.94971263, 'precision': 0.66405565, 'recall': 0.7444486, 'specificity': 0.7444486, 'f1': 0.69501543, 'auroc': 0.90107524, 'binary_precision': 0.34528688, 'binary_recall': 0.5241057, 'binary_specificity': 0.9647915, 'binary_f1_score': 0.41630632}
confusion matrix:
       0    1
0  17510  639
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9392777, 'precision': 0.68019223, 'recall': 0.81623375, 'specificity': 0.81623375, 'f1': 0.7257188, 'auroc': 0.9070877, 'binary_precision': 0.37473685, 'binary_recall': 0.68199235, 'binary_specificity': 0.9504752, 'binary_f1_score': 0.4836957}
confusion matrix:
      0    1
0  5700  297
1    83  178
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_14.png
early stop counter: 12
val acc:0.9497126340866089, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 14,now: 2024-07-06 06:35:58.244832,epoch time: 0:22:30.155678,used: 5:17:11.988695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9822931, 'precision': 0.98359483, 'recall': 0.9700109, 'specificity': 0.9700109, 'f1': 0.9765533, 'auroc': 0.99550486, 'binary_precision': 0.9861692, 'binary_recall': 0.9446294, 'binary_specificity': 0.9953924, 'binary_f1_score': 0.96495247}
confusion matrix:
       0      1
0  42126    195
1    815  13904
---- Validation: 
scalar performance:
{'acc': 0.94721156, 'precision': 0.65782064, 'recall': 0.7499043, 'specificity': 0.7499043, 'f1': 0.691647, 'auroc': 0.90416276, 'binary_precision': 0.33237273, 'binary_recall': 0.5381026, 'binary_specificity': 0.96170586, 'binary_f1_score': 0.41092637}
confusion matrix:
       0    1
0  17454  695
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93704057, 'precision': 0.67659473, 'recall': 0.82422817, 'specificity': 0.82422817, 'f1': 0.72403204, 'auroc': 0.90760326, 'binary_precision': 0.36673346, 'binary_recall': 0.7011494, 'binary_specificity': 0.947307, 'binary_f1_score': 0.48157892}
confusion matrix:
      0    1
0  5681  316
1    78  183
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_15.png
early stop counter: 13
val acc:0.9472115635871887, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 15,now: 2024-07-06 06:58:29.003944,epoch time: 0:22:30.759112,used: 5:39:42.747807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98346776, 'precision': 0.9846014, 'recall': 0.9720824, 'specificity': 0.9720824, 'f1': 0.9781303, 'auroc': 0.9962462, 'binary_precision': 0.9868505, 'binary_recall': 0.9485594, 'binary_specificity': 0.99560535, 'binary_f1_score': 0.96732616}
confusion matrix:
       0      1
0  42138    186
1    757  13959
---- Validation: 
scalar performance:
{'acc': 0.95013833, 'precision': 0.66361386, 'recall': 0.73716843, 'specificity': 0.73716843, 'f1': 0.69251466, 'auroc': 0.9018781, 'binary_precision': 0.3449367, 'binary_recall': 0.5085537, 'binary_specificity': 0.96578324, 'binary_f1_score': 0.41106224}
confusion matrix:
       0    1
0  17528  621
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94135505, 'precision': 0.68413514, 'recall': 0.8099884, 'specificity': 0.8099884, 'f1': 0.7278071, 'auroc': 0.90345097, 'binary_precision': 0.38325992, 'binary_recall': 0.6666667, 'binary_specificity': 0.95331, 'binary_f1_score': 0.48671332}
confusion matrix:
      0    1
0  5717  280
1    87  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_16.png
early stop counter: 14
val acc:0.9501383304595947, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 16,now: 2024-07-06 07:21:08.394811,epoch time: 0:22:39.390867,used: 6:02:22.138674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98362553, 'precision': 0.98470867, 'recall': 0.97238815, 'specificity': 0.97238815, 'f1': 0.9783435, 'auroc': 0.99655443, 'binary_precision': 0.98685884, 'binary_recall': 0.94917095, 'binary_specificity': 0.99560535, 'binary_f1_score': 0.967648}
confusion matrix:
       0      1
0  42138    186
1    748  13968
---- Validation: 
scalar performance:
{'acc': 0.9547148, 'precision': 0.6781077, 'recall': 0.7275368, 'specificity': 0.7275368, 'f1': 0.6993506, 'auroc': 0.8992239, 'binary_precision': 0.3746988, 'binary_recall': 0.4836703, 'binary_specificity': 0.97140336, 'binary_f1_score': 0.42226747}
confusion matrix:
       0    1
0  17630  519
1    332  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9488655, 'precision': 0.70579916, 'recall': 0.8102423, 'specificity': 0.8102423, 'f1': 0.7455363, 'auroc': 0.9021936, 'binary_precision': 0.426799, 'binary_recall': 0.65900385, 'binary_specificity': 0.96148074, 'binary_f1_score': 0.5180723}
confusion matrix:
      0    1
0  5766  231
1    89  172
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_17.png
early stop counter: 15
val acc:0.9547147750854492, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 17,now: 2024-07-06 07:43:41.346902,epoch time: 0:22:32.952091,used: 6:24:55.090765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98441446, 'precision': 0.9856379, 'recall': 0.9735387, 'specificity': 0.9735387, 'f1': 0.97939116, 'auroc': 0.9971024, 'binary_precision': 0.98806834, 'binary_recall': 0.9510703, 'binary_specificity': 0.9960071, 'binary_f1_score': 0.9692164}
confusion matrix:
       0      1
0  42156    169
1    720  13995
---- Validation: 
scalar performance:
{'acc': 0.9529587, 'precision': 0.67204535, 'recall': 0.73112804, 'specificity': 0.73112804, 'f1': 0.69657207, 'auroc': 0.89904225, 'binary_precision': 0.3622857, 'binary_recall': 0.49300155, 'binary_specificity': 0.9692545, 'binary_f1_score': 0.4176548}
confusion matrix:
       0    1
0  17591  558
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480665, 'precision': 0.70317745, 'recall': 0.8098254, 'specificity': 0.8098254, 'f1': 0.7433836, 'auroc': 0.90284735, 'binary_precision': 0.42156863, 'binary_recall': 0.65900385, 'binary_specificity': 0.960647, 'binary_f1_score': 0.51420027}
confusion matrix:
      0    1
0  5761  236
1    89  172
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_18.png
early stop counter: 16
val acc:0.9529587030410767, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 18,now: 2024-07-06 08:06:12.450820,epoch time: 0:22:31.103918,used: 6:47:26.194683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9845021, 'precision': 0.98410183, 'recall': 0.97526157, 'specificity': 0.97526157, 'f1': 0.9795755, 'auroc': 0.9966496, 'binary_precision': 0.9832984, 'binary_recall': 0.95617014, 'binary_specificity': 0.99435306, 'binary_f1_score': 0.9695445}
confusion matrix:
       0      1
0  42085    239
1    645  14071
---- Validation: 
scalar performance:
{'acc': 0.94715834, 'precision': 0.6596968, 'recall': 0.75812733, 'specificity': 0.75812733, 'f1': 0.6952999, 'auroc': 0.90248346, 'binary_precision': 0.33552632, 'binary_recall': 0.55520993, 'binary_specificity': 0.96104467, 'binary_f1_score': 0.4182777}
confusion matrix:
       0    1
0  17442  707
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9392777, 'precision': 0.68156594, 'recall': 0.8235631, 'specificity': 0.8235631, 'f1': 0.7284837, 'auroc': 0.9044716, 'binary_precision': 0.3768116, 'binary_recall': 0.697318, 'binary_specificity': 0.94980824, 'binary_f1_score': 0.48924732}
confusion matrix:
      0    1
0  5696  301
1    79  182
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_19.png
early stop counter: 17
val acc:0.9471583366394043, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 19,now: 2024-07-06 08:28:32.464812,epoch time: 0:22:20.013992,used: 7:09:46.208675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9853962, 'precision': 0.9847649, 'recall': 0.9769514, 'specificity': 0.9769514, 'f1': 0.98077524, 'auroc': 0.9969647, 'binary_precision': 0.9834935, 'binary_recall': 0.95950264, 'binary_specificity': 0.9944002, 'binary_f1_score': 0.97134995}
confusion matrix:
       0      1
0  42086    237
1    596  14121
---- Validation: 
scalar performance:
{'acc': 0.95109624, 'precision': 0.6689728, 'recall': 0.74591494, 'specificity': 0.74591494, 'f1': 0.6991445, 'auroc': 0.9003049, 'binary_precision': 0.355042, 'binary_recall': 0.525661, 'binary_specificity': 0.96616894, 'binary_f1_score': 0.4238245}
confusion matrix:
       0    1
0  17535  614
1    305  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9434324, 'precision': 0.68980086, 'recall': 0.81107223, 'specificity': 0.81107223, 'f1': 0.73288107, 'auroc': 0.90168697, 'binary_precision': 0.39455783, 'binary_recall': 0.6666667, 'binary_specificity': 0.9554777, 'binary_f1_score': 0.49572656}
confusion matrix:
      0    1
0  5730  267
1    87  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_20.png
early stop counter: 18
val acc:0.95109623670578, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 20,now: 2024-07-06 08:50:43.293288,epoch time: 0:22:10.828476,used: 7:31:57.037151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98541373, 'precision': 0.9859505, 'recall': 0.9758359, 'specificity': 0.9758359, 'f1': 0.98075515, 'auroc': 0.9972148, 'binary_precision': 0.9870239, 'binary_recall': 0.9560432, 'binary_specificity': 0.99562865, 'binary_f1_score': 0.9712866}
confusion matrix:
       0      1
0  42136    185
1    647  14072
---- Validation: 
scalar performance:
{'acc': 0.95615155, 'precision': 0.6807501, 'recall': 0.71252954, 'specificity': 0.71252954, 'f1': 0.6951652, 'auroc': 0.8970644, 'binary_precision': 0.38107753, 'binary_recall': 0.45101088, 'binary_specificity': 0.97404814, 'binary_f1_score': 0.4131054}
confusion matrix:
       0    1
0  17678  471
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549377, 'precision': 0.7260694, 'recall': 0.7914225, 'specificity': 0.7914225, 'f1': 0.7539459, 'auroc': 0.9024246, 'binary_precision': 0.4692082, 'binary_recall': 0.6130268, 'binary_specificity': 0.96981823, 'binary_f1_score': 0.53156143}
confusion matrix:
      0    1
0  5816  181
1   101  160
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_21.png
early stop counter: 19
val acc:0.95615154504776, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 21,now: 2024-07-06 09:13:08.053827,epoch time: 0:22:24.760539,used: 7:54:21.797690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9859923, 'precision': 0.9865955, 'recall': 0.976709, 'specificity': 0.976709, 'f1': 0.98152053, 'auroc': 0.9973177, 'binary_precision': 0.9878023, 'binary_recall': 0.95752925, 'binary_specificity': 0.9958888, 'binary_f1_score': 0.9724302}
confusion matrix:
       0      1
0  42150    174
1    625  14091
---- Validation: 
scalar performance:
{'acc': 0.9559919, 'precision': 0.67868996, 'recall': 0.7071965, 'specificity': 0.7071965, 'f1': 0.6917331, 'auroc': 0.89790416, 'binary_precision': 0.37733334, 'binary_recall': 0.44012442, 'binary_specificity': 0.97426856, 'binary_f1_score': 0.4063173}
confusion matrix:
       0    1
0  17682  467
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7415225, 'recall': 0.77493346, 'specificity': 0.77493346, 'f1': 0.75698394, 'auroc': 0.90118974, 'binary_precision': 0.50167227, 'binary_recall': 0.57471263, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.53571427}
confusion matrix:
      0    1
0  5848  149
1   111  150
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_22.png
early stop counter: 20
val acc:0.9559919238090515, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 22,now: 2024-07-06 09:35:26.307073,epoch time: 0:22:18.253246,used: 8:16:40.050936,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9866585, 'precision': 0.98664296, 'recall': 0.9784016, 'specificity': 0.9784016, 'f1': 0.9824306, 'auroc': 0.99706554, 'binary_precision': 0.9866118, 'binary_recall': 0.96133983, 'binary_specificity': 0.9954634, 'binary_f1_score': 0.9738119}
confusion matrix:
       0      1
0  42130    192
1    569  14149
---- Validation: 
scalar performance:
{'acc': 0.95051086, 'precision': 0.6649003, 'recall': 0.7373613, 'specificity': 0.7373613, 'f1': 0.69352275, 'auroc': 0.8989572, 'binary_precision': 0.34750265, 'binary_recall': 0.5085537, 'binary_specificity': 0.96616894, 'binary_f1_score': 0.41287878}
confusion matrix:
       0    1
0  17535  614
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95158195, 'precision': 0.71408397, 'recall': 0.802498, 'specificity': 0.802498, 'f1': 0.74941283, 'auroc': 0.9025932, 'binary_precision': 0.44414893, 'binary_recall': 0.63984674, 'binary_specificity': 0.9651492, 'binary_f1_score': 0.5243328}
confusion matrix:
      0    1
0  5788  209
1    94  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_23.png
early stop counter: 21
val acc:0.9505108594894409, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 23,now: 2024-07-06 09:57:43.266026,epoch time: 0:22:16.958953,used: 8:38:57.009889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98714936, 'precision': 0.9862447, 'recall': 0.98008406, 'specificity': 0.98008406, 'f1': 0.98311293, 'auroc': 0.99724615, 'binary_precision': 0.9844129, 'binary_recall': 0.96548444, 'binary_specificity': 0.9946836, 'binary_f1_score': 0.97485685}
confusion matrix:
       0      1
0  42097    225
1    508  14210
---- Validation: 
scalar performance:
{'acc': 0.947318, 'precision': 0.65405387, 'recall': 0.7342082, 'specificity': 0.7342082, 'f1': 0.6843993, 'auroc': 0.89694786, 'binary_precision': 0.32597792, 'binary_recall': 0.5054432, 'binary_specificity': 0.9629732, 'binary_f1_score': 0.39634144}
confusion matrix:
       0    1
0  17477  672
1    318  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9482263, 'precision': 0.7005774, 'recall': 0.7897531, 'specificity': 0.7897531, 'f1': 0.7355782, 'auroc': 0.89951026, 'binary_precision': 0.4181818, 'binary_recall': 0.61685824, 'binary_specificity': 0.962648, 'binary_f1_score': 0.498452}
confusion matrix:
      0    1
0  5773  224
1   100  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_24.png
early stop counter: 22
val acc:0.9473180174827576, best validation acc: 0.9567369222640991, corresponding to test acc:                         0.9554170370101929 / 0.9626078605651855
after epoch: 24,now: 2024-07-06 10:20:08.855667,epoch time: 0:22:25.589641,used: 9:01:22.599530,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9868864, 'precision': 0.9878216, 'recall': 0.9778421, 'specificity': 0.9778421, 'f1': 0.9826982, 'auroc': 0.9975598, 'binary_precision': 0.98969215, 'binary_recall': 0.95915735, 'binary_specificity': 0.9965269, 'binary_f1_score': 0.9741855}
confusion matrix:
       0      1
0  42178    147
1    601  14114
---- Validation: 
scalar performance:
{'acc': 0.95870584, 'precision': 0.6879724, 'recall': 0.6891001, 'specificity': 0.6891001, 'f1': 0.68853426, 'auroc': 0.8975771, 'binary_precision': 0.39721793, 'binary_recall': 0.39968896, 'binary_specificity': 0.9785112, 'binary_f1_score': 0.3984496}
confusion matrix:
       0    1
0  17759  390
1    386  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.74817896, 'recall': 0.75544477, 'specificity': 0.75544477, 'f1': 0.7517519, 'auroc': 0.9005314, 'binary_precision': 0.51672864, 'binary_recall': 0.532567, 'binary_specificity': 0.9783225, 'binary_f1_score': 0.5245283}
confusion matrix:
      0    1
0  5867  130
1   122  139
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_25.png
better model found
persisted
after epoch: 25,now: 2024-07-06 10:42:34.929159,epoch time: 0:22:26.073492,used: 9:23:48.673022,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98613256, 'precision': 0.9880799, 'recall': 0.9756541, 'specificity': 0.9756541, 'f1': 0.9816604, 'auroc': 0.99689126, 'binary_precision': 0.9919463, 'binary_recall': 0.9540019, 'binary_specificity': 0.99730635, 'binary_f1_score': 0.97260416}
confusion matrix:
       0      1
0  42208    114
1    677  14041
---- Validation: 
scalar performance:
{'acc': 0.9623776, 'precision': 0.7065364, 'recall': 0.6624989, 'specificity': 0.6624989, 'f1': 0.6815652, 'auroc': 0.8930224, 'binary_precision': 0.43625498, 'binary_recall': 0.34059098, 'binary_specificity': 0.9844068, 'binary_f1_score': 0.38253278}
confusion matrix:
       0    1
0  17866  283
1    424  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.790504, 'recall': 0.7270465, 'specificity': 0.7270465, 'f1': 0.754414, 'auroc': 0.8996333, 'binary_precision': 0.6039604, 'binary_recall': 0.46743295, 'binary_specificity': 0.98666, 'binary_f1_score': 0.5269978}
confusion matrix:
      0    1
0  5917   80
1   139  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_26.png
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-06 11:04:50.288367,epoch time: 0:22:15.359208,used: 9:46:04.032230,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98742986, 'precision': 0.9873066, 'recall': 0.97976226, 'specificity': 0.97976226, 'f1': 0.9834577, 'auroc': 0.9972698, 'binary_precision': 0.98705816, 'binary_recall': 0.9639193, 'binary_specificity': 0.99560523, 'binary_f1_score': 0.9753515}
confusion matrix:
       0      1
0  42137    186
1    531  14186
---- Validation: 
scalar performance:
{'acc': 0.9535441, 'precision': 0.67595744, 'recall': 0.7381816, 'specificity': 0.7381816, 'f1': 0.70166534, 'auroc': 0.90171945, 'binary_precision': 0.3696145, 'binary_recall': 0.5069984, 'binary_specificity': 0.9693647, 'binary_f1_score': 0.427541}
confusion matrix:
       0    1
0  17593  556
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7389342, 'recall': 0.772851, 'specificity': 0.772851, 'f1': 0.75459754, 'auroc': 0.90224373, 'binary_precision': 0.49666667, 'binary_recall': 0.57088125, 'binary_specificity': 0.97482073, 'binary_f1_score': 0.5311943}
confusion matrix:
      0    1
0  5846  151
1   112  149
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_27.png
early stop counter: 1
val acc:0.9535440802574158, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9650048017501831 / 0.9650048017501831
after epoch: 27,now: 2024-07-06 11:27:03.860636,epoch time: 0:22:13.572269,used: 10:08:17.604499,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9871143, 'precision': 0.98866946, 'recall': 0.97762305, 'specificity': 0.97762305, 'f1': 0.98298293, 'auroc': 0.9973651, 'binary_precision': 0.9917704, 'binary_recall': 0.9580106, 'binary_specificity': 0.9972355, 'binary_f1_score': 0.9745982}
confusion matrix:
       0      1
0  42205    117
1    618  14100
---- Validation: 
scalar performance:
{'acc': 0.95961046, 'precision': 0.69211113, 'recall': 0.68431807, 'specificity': 0.68431807, 'f1': 0.6881229, 'auroc': 0.8957955, 'binary_precision': 0.40584415, 'binary_recall': 0.3888025, 'binary_specificity': 0.9798336, 'binary_f1_score': 0.39714062}
confusion matrix:
       0    1
0  17783  366
1    393  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.76420134, 'recall': 0.729127, 'specificity': 0.729127, 'f1': 0.74525213, 'auroc': 0.8986224, 'binary_precision': 0.5511111, 'binary_recall': 0.47509578, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.5102881}
confusion matrix:
      0    1
0  5896  101
1   137  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_28.png
early stop counter: 2
val acc:0.9596104621887207, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9650048017501831 / 0.9650048017501831
after epoch: 28,now: 2024-07-06 11:49:10.339144,epoch time: 0:22:06.478508,used: 10:30:24.083007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98813117, 'precision': 0.9878768, 'recall': 0.9810304, 'specificity': 0.9810304, 'f1': 0.98439044, 'auroc': 0.9977858, 'binary_precision': 0.98736286, 'binary_recall': 0.96636087, 'binary_specificity': 0.99569994, 'binary_f1_score': 0.976749}
confusion matrix:
       0      1
0  42143    182
1    495  14220
---- Validation: 
scalar performance:
{'acc': 0.95508724, 'precision': 0.679353, 'recall': 0.72622955, 'specificity': 0.72622955, 'f1': 0.6996717, 'auroc': 0.90054065, 'binary_precision': 0.37728938, 'binary_recall': 0.4805599, 'binary_specificity': 0.9718993, 'binary_f1_score': 0.42270866}
confusion matrix:
       0    1
0  17639  510
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.7334311, 'recall': 0.7631891, 'specificity': 0.7631891, 'f1': 0.7472811, 'auroc': 0.89936525, 'binary_precision': 0.4864865, 'binary_recall': 0.55172414, 'binary_specificity': 0.974654, 'binary_f1_score': 0.51705563}
confusion matrix:
      0    1
0  5845  152
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_29.png
early stop counter: 3
val acc:0.9550872445106506, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9650048017501831 / 0.9650048017501831
after epoch: 29,now: 2024-07-06 12:11:33.986188,epoch time: 0:22:23.647044,used: 10:52:47.730051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9883415, 'precision': 0.9887868, 'recall': 0.9806834, 'specificity': 0.9806834, 'f1': 0.9846469, 'auroc': 0.9979261, 'binary_precision': 0.9896828, 'binary_recall': 0.9648634, 'binary_specificity': 0.99650335, 'binary_f1_score': 0.9771155}
confusion matrix:
       0      1
0  42178    148
1    517  14197
---- Validation: 
scalar performance:
{'acc': 0.95333123, 'precision': 0.6701107, 'recall': 0.7178199, 'specificity': 0.7178199, 'f1': 0.6905681, 'auroc': 0.90074205, 'binary_precision': 0.359375, 'binary_recall': 0.46500778, 'binary_specificity': 0.970632, 'binary_f1_score': 0.40542373}
confusion matrix:
       0    1
0  17616  533
1    344  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.75883245, 'recall': 0.7673559, 'specificity': 0.7673559, 'f1': 0.7630154, 'auroc': 0.90295166, 'binary_precision': 0.537037, 'binary_recall': 0.5555556, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.54613936}
confusion matrix:
      0    1
0  5872  125
1   116  145
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_30.png
early stop counter: 4
val acc:0.9533312320709229, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9650048017501831 / 0.9650048017501831
after epoch: 30,now: 2024-07-06 12:34:01.372844,epoch time: 0:22:27.386656,used: 11:15:15.116707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_01_18_46_seed_0_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:15:15.116707 at 2024-07-06 12:34:01.372844
persisted model performance metric: 

scalar performance:
{'acc': 0.9650048, 'precision': 0.790504, 'recall': 0.7270465, 'specificity': 0.7270465, 'f1': 0.754414, 'auroc': 0.8996333, 'binary_precision': 0.6039604, 'binary_recall': 0.46743295, 'binary_specificity': 0.98666, 'binary_f1_score': 0.5269978}
confusion matrix:
      0    1
0  5917   80
1   139  122
oracle model performance metric: 

scalar performance:
{'acc': 0.9650048, 'precision': 0.790504, 'recall': 0.7270465, 'specificity': 0.7270465, 'f1': 0.754414, 'auroc': 0.8996333, 'binary_precision': 0.6039604, 'binary_recall': 0.46743295, 'binary_specificity': 0.98666, 'binary_f1_score': 0.5269978}
confusion matrix:
      0    1
0  5917   80
1   139  122
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB |   1195 TiB |   1195 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1179 TiB |   1179 TiB |
|       from small pool |  16482 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59895 KiB | 732464 KiB | 687392 GiB | 687392 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 671688 GiB | 671688 GiB |
|       from small pool |   9133 KiB |  11093 KiB |  15704 GiB |  15704 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7625    |  197304 K  |  197301 K  |
|       from large pool |      79    |     762    |  112031 K  |  112031 K  |
|       from small pool |    2899    |    7544    |   85272 K  |   85269 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7625    |  197304 K  |  197301 K  |
|       from large pool |      79    |     762    |  112031 K  |  112031 K  |
|       from small pool |    2899    |    7544    |   85272 K  |   85269 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3589    |  121764 K  |  121764 K  |
|       from large pool |      10    |     350    |   86069 K  |   86069 K  |
|       from small pool |      26    |    3579    |   35694 K  |   35694 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 687393 GiB | 687393 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 671688 GiB | 671688 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15704 GiB |  15704 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  197304 K  |  197304 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85272 K  |   85272 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  197304 K  |  197304 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85272 K  |   85272 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  121765 K  |  121765 K  |
|       from large pool |       3    |     350    |   86069 K  |   86069 K  |
|       from small pool |       0    |    3579    |   35695 K  |   35695 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 687393 GiB | 687393 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 671688 GiB | 671688 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15704 GiB |  15704 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  197304 K  |  197304 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85272 K  |   85272 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  197304 K  |  197304 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85272 K  |   85272 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  121765 K  |  121765 K  |
|       from large pool |       3    |     350    |   86069 K  |   86069 K  |
|       from small pool |       0    |    3579    |   35695 K  |   35695 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430

 Experiment start at: 2024-07-06 12:41:17.128722
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92740005, 'precision': 0.93319976, 'recall': 0.87206835, 'specificity': 0.87206835, 'f1': 0.8972153, 'auroc': 0.9456377, 'binary_precision': 0.9430096, 'binary_recall': 0.75974476, 'binary_specificity': 0.9843919, 'binary_f1_score': 0.84151495}
confusion matrix:
       0      1
0  41752    662
1   3464  10954
---- Validation: 
scalar performance:
{'acc': 0.94727856, 'precision': 0.5051947, 'recall': 0.50272673, 'specificity': 0.50272673, 'f1': 0.5021372, 'auroc': 0.74347204, 'binary_precision': 0.04610951, 'binary_recall': 0.023774145, 'binary_specificity': 0.9816793, 'binary_f1_score': 0.03137255}
confusion matrix:
       0    1
0  17736  331
1    657   16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94070256, 'precision': 0.48776022, 'recall': 0.49459624, 'specificity': 0.49459624, 'f1': 0.49009395, 'auroc': 0.7168308, 'binary_precision': 0.017857144, 'binary_recall': 0.0076923077, 'binary_specificity': 0.98150015, 'binary_f1_score': 0.010752688}
confusion matrix:
      0    1
0  5836  110
1   258    2
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-06 13:04:10.213432,epoch time: 0:22:53.084710,used: 0:22:53.084710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9531074, 'precision': 0.96135783, 'recall': 0.91439044, 'specificity': 0.91439044, 'f1': 0.93488765, 'auroc': 0.97285736, 'binary_precision': 0.97594947, 'binary_recall': 0.83578366, 'binary_specificity': 0.9929973, 'binary_f1_score': 0.9004445}
confusion matrix:
       0      1
0  42115    297
1   2368  12052
---- Validation: 
scalar performance:
{'acc': 0.95117396, 'precision': 0.5461126, 'recall': 0.52262866, 'specificity': 0.52262866, 'f1': 0.5285833, 'auroc': 0.80083793, 'binary_precision': 0.12654321, 'binary_recall': 0.060921248, 'binary_specificity': 0.9843361, 'binary_f1_score': 0.082246736}
confusion matrix:
       0    1
0  17784  283
1    632   41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94166934, 'precision': 0.5013992, 'recall': 0.50061774, 'specificity': 0.50061774, 'f1': 0.4984076, 'auroc': 0.783675, 'binary_precision': 0.04464286, 'binary_recall': 0.01923077, 'binary_specificity': 0.9820047, 'binary_f1_score': 0.026881723}
confusion matrix:
      0    1
0  5839  107
1   255    5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-06 13:26:15.759819,epoch time: 0:22:05.546387,used: 0:44:58.631097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96194047, 'precision': 0.9696572, 'recall': 0.92974615, 'specificity': 0.92974615, 'f1': 0.9475813, 'auroc': 0.98203456, 'binary_precision': 0.9835833, 'binary_recall': 0.8643962, 'binary_specificity': 0.9950961, 'binary_f1_score': 0.92014617}
confusion matrix:
       0      1
0  42207    208
1   1955  12462
---- Validation: 
scalar performance:
{'acc': 0.95538956, 'precision': 0.5954101, 'recall': 0.54269665, 'specificity': 0.54269665, 'f1': 0.55673355, 'auroc': 0.83085084, 'binary_precision': 0.22372882, 'binary_recall': 0.09806835, 'binary_specificity': 0.98732495, 'binary_f1_score': 0.13636364}
confusion matrix:
       0    1
0  17838  229
1    607   66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94811475, 'precision': 0.5198295, 'recall': 0.50582033, 'specificity': 0.50582033, 'f1': 0.5046341, 'auroc': 0.8366709, 'binary_precision': 0.08108108, 'binary_recall': 0.023076924, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.035928145}
confusion matrix:
      0   1
0  5878  68
1   254   6
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-06 13:48:12.633281,epoch time: 0:21:56.873462,used: 1:06:55.504559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96716636, 'precision': 0.9706695, 'recall': 0.94216, 'specificity': 0.94216, 'f1': 0.95532405, 'auroc': 0.98679096, 'binary_precision': 0.9771915, 'binary_recall': 0.8913933, 'binary_specificity': 0.9929267, 'binary_f1_score': 0.9323226}
confusion matrix:
       0      1
0  42113    300
1   1566  12853
---- Validation: 
scalar performance:
{'acc': 0.9566702, 'precision': 0.6355803, 'recall': 0.57197154, 'specificity': 0.57197154, 'f1': 0.59237885, 'auroc': 0.8487309, 'binary_precision': 0.3019943, 'binary_recall': 0.15750371, 'binary_specificity': 0.98643935, 'binary_f1_score': 0.20703125}
confusion matrix:
       0    1
0  17822  245
1    567  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9518208, 'precision': 0.6002642, 'recall': 0.52982223, 'specificity': 0.52982223, 'f1': 0.5413524, 'auroc': 0.86271375, 'binary_precision': 0.24, 'binary_recall': 0.06923077, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.10746269}
confusion matrix:
      0   1
0  5889  57
1   242  18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-06 14:10:17.626346,epoch time: 0:22:04.993065,used: 1:29:00.497624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9706503, 'precision': 0.9749418, 'recall': 0.9473128, 'specificity': 0.9473128, 'f1': 0.96011376, 'auroc': 0.98982334, 'binary_precision': 0.9829571, 'binary_recall': 0.89993066, 'binary_specificity': 0.9946949, 'binary_f1_score': 0.93961334}
confusion matrix:
       0      1
0  42187    225
1   1443  12977
---- Validation: 
scalar performance:
{'acc': 0.96003205, 'precision': 0.66768354, 'recall': 0.5722845, 'specificity': 0.5722845, 'f1': 0.5984191, 'auroc': 0.86360985, 'binary_precision': 0.36619717, 'binary_recall': 0.15453194, 'binary_specificity': 0.9900371, 'binary_f1_score': 0.21734586}
confusion matrix:
       0    1
0  17887  180
1    569  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.7001895, 'recall': 0.545386, 'specificity': 0.545386, 'f1': 0.56782675, 'auroc': 0.8867508, 'binary_precision': 0.4385965, 'binary_recall': 0.09615385, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.15772872}
confusion matrix:
      0   1
0  5914  32
1   235  25
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-06 14:32:25.314178,epoch time: 0:22:07.687832,used: 1:51:08.185456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97439826, 'precision': 0.974584, 'recall': 0.9573733, 'specificity': 0.9573733, 'f1': 0.9655808, 'auroc': 0.99137855, 'binary_precision': 0.9749414, 'binary_recall': 0.9228102, 'binary_specificity': 0.99193645, 'binary_f1_score': 0.9481598}
confusion matrix:
       0      1
0  42071    342
1   1113  13306
---- Validation: 
scalar performance:
{'acc': 0.95928496, 'precision': 0.6802362, 'recall': 0.60980624, 'specificity': 0.60980624, 'f1': 0.6352954, 'auroc': 0.86926174, 'binary_precision': 0.38861385, 'binary_recall': 0.2332838, 'binary_specificity': 0.98632866, 'binary_f1_score': 0.2915506}
confusion matrix:
       0    1
0  17820  247
1    516  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.7291046, 'recall': 0.5753144, 'specificity': 0.5753144, 'f1': 0.6087207, 'auroc': 0.8935503, 'binary_precision': 0.4939759, 'binary_recall': 0.15769231, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.23906706}
confusion matrix:
      0   1
0  5904  42
1   219  41
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_6.png
new oracle model saved
early stop counter: 1
val acc:0.9592849612236023, best validation acc: 0.960032045841217, corresponding to test acc:                         0.956977128982544 / 0.9579439163208008
after epoch: 6,now: 2024-07-06 14:54:26.653154,epoch time: 0:22:01.338976,used: 2:13:09.524432,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97475016, 'precision': 0.9774596, 'recall': 0.95559496, 'specificity': 0.95559496, 'f1': 0.9658932, 'auroc': 0.99207735, 'binary_precision': 0.9826048, 'binary_recall': 0.9167071, 'binary_specificity': 0.9944828, 'binary_f1_score': 0.94851273}
confusion matrix:
       0      1
0  42179    234
1   1201  13218
---- Validation: 
scalar performance:
{'acc': 0.9618463, 'precision': 0.7031486, 'recall': 0.5996903, 'specificity': 0.5996903, 'f1': 0.6316252, 'auroc': 0.8711829, 'binary_precision': 0.4351852, 'binary_recall': 0.20950966, 'binary_specificity': 0.989871, 'binary_f1_score': 0.28284854}
confusion matrix:
       0    1
0  17884  183
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7698006, 'recall': 0.5707224, 'specificity': 0.5707224, 'f1': 0.6062219, 'auroc': 0.8982314, 'binary_precision': 0.57575756, 'binary_recall': 0.14615385, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.23312885}
confusion matrix:
      0   1
0  5918  28
1   222  38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-06 15:16:11.351973,epoch time: 0:21:44.698819,used: 2:34:54.223251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97723114, 'precision': 0.9783559, 'recall': 0.9612143, 'specificity': 0.9612143, 'f1': 0.96939445, 'auroc': 0.9932064, 'binary_precision': 0.9805214, 'binary_recall': 0.9287002, 'binary_specificity': 0.99372846, 'binary_f1_score': 0.9539075}
confusion matrix:
       0      1
0  42148    266
1   1028  13390
---- Validation: 
scalar performance:
{'acc': 0.96211314, 'precision': 0.7119234, 'recall': 0.62128675, 'specificity': 0.62128675, 'f1': 0.6528023, 'auroc': 0.87927306, 'binary_precision': 0.45118734, 'binary_recall': 0.25408617, 'binary_specificity': 0.9884873, 'binary_f1_score': 0.32509503}
confusion matrix:
       0    1
0  17859  208
1    502  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.81274784, 'recall': 0.6052537, 'specificity': 0.6052537, 'f1': 0.6526644, 'auroc': 0.908185, 'binary_precision': 0.65882355, 'binary_recall': 0.21538462, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.3246377}
confusion matrix:
      0   1
0  5917  29
1   204  56
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-06 15:37:56.842277,epoch time: 0:21:45.490304,used: 2:56:39.713555,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9780933, 'precision': 0.9773624, 'recall': 0.96444726, 'specificity': 0.96444726, 'f1': 0.9706814, 'auroc': 0.99413073, 'binary_precision': 0.97593755, 'binary_recall': 0.93674576, 'binary_specificity': 0.9921488, 'binary_f1_score': 0.9559402}
confusion matrix:
       0      1
0  42081    333
1    912  13506
---- Validation: 
scalar performance:
{'acc': 0.9628068, 'precision': 0.72177756, 'recall': 0.63380605, 'specificity': 0.63380605, 'f1': 0.6656374, 'auroc': 0.88334304, 'binary_precision': 0.47, 'binary_recall': 0.2793462, 'binary_specificity': 0.9882659, 'binary_f1_score': 0.35041937}
confusion matrix:
       0    1
0  17855  212
1    485  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.81776214, 'recall': 0.63167226, 'specificity': 0.63167226, 'f1': 0.6824424, 'auroc': 0.9112086, 'binary_precision': 0.6666667, 'binary_recall': 0.26923078, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.38356167}
confusion matrix:
      0   1
0  5911  35
1   190  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-06 15:59:56.450644,epoch time: 0:21:59.608367,used: 3:18:39.321922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9786212, 'precision': 0.97978777, 'recall': 0.96350074, 'specificity': 0.96350074, 'f1': 0.9712925, 'auroc': 0.99429595, 'binary_precision': 0.98203987, 'binary_recall': 0.93280166, 'binary_specificity': 0.99419975, 'binary_f1_score': 0.9567877}
confusion matrix:
       0      1
0  42166    246
1    969  13451
---- Validation: 
scalar performance:
{'acc': 0.9628068, 'precision': 0.72293687, 'recall': 0.64238924, 'specificity': 0.64238924, 'f1': 0.67273676, 'auroc': 0.8817004, 'binary_precision': 0.4716981, 'binary_recall': 0.2971768, 'binary_specificity': 0.9876017, 'binary_f1_score': 0.36463082}
confusion matrix:
       0    1
0  17843  224
1    473  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.8277147, 'recall': 0.62816244, 'specificity': 0.62816244, 'f1': 0.6801642, 'auroc': 0.91149104, 'binary_precision': 0.68686867, 'binary_recall': 0.26153848, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.3788301}
confusion matrix:
      0   1
0  5915  31
1   192  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_10.png
new oracle model saved
early stop counter: 1
val acc:0.9628068208694458, best validation acc: 0.9628068208694458, corresponding to test acc:                         0.9637447595596313 / 0.9640670418739319
after epoch: 10,now: 2024-07-06 16:21:44.394902,epoch time: 0:21:47.944258,used: 3:40:27.266180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9792898, 'precision': 0.9789634, 'recall': 0.96605206, 'specificity': 0.96605206, 'f1': 0.9722854, 'auroc': 0.9948364, 'binary_precision': 0.97832686, 'binary_recall': 0.93917745, 'binary_specificity': 0.9929267, 'binary_f1_score': 0.9583525}
confusion matrix:
       0      1
0  42113    300
1    877  13542
---- Validation: 
scalar performance:
{'acc': 0.96205974, 'precision': 0.71659493, 'recall': 0.6491545, 'specificity': 0.6491545, 'f1': 0.67589617, 'auroc': 0.8841915, 'binary_precision': 0.4585153, 'binary_recall': 0.31203565, 'binary_specificity': 0.9862733, 'binary_f1_score': 0.37135276}
confusion matrix:
       0    1
0  17819  248
1    463  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.83600605, 'recall': 0.63401574, 'specificity': 0.63401574, 'f1': 0.6875895, 'auroc': 0.9097532, 'binary_precision': 0.7029703, 'binary_recall': 0.27307692, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.3933518}
confusion matrix:
      0   1
0  5916  30
1   189  71
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_11.png
new oracle model saved
early stop counter: 2
val acc:0.962059736251831, best validation acc: 0.9628068208694458, corresponding to test acc:                         0.9637447595596313 / 0.9647115468978882
after epoch: 11,now: 2024-07-06 16:43:25.720967,epoch time: 0:21:41.326065,used: 4:02:08.592245,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9793415, 'recall': 0.9688103, 'specificity': 0.9688103, 'f1': 0.9739277, 'auroc': 0.99523056, 'binary_precision': 0.9771277, 'binary_recall': 0.94514185, 'binary_specificity': 0.9924787, 'binary_f1_score': 0.9608686}
confusion matrix:
       0      1
0  42094    319
1    791  13628
---- Validation: 
scalar performance:
{'acc': 0.9627001, 'precision': 0.7235707, 'recall': 0.65592396, 'specificity': 0.65592396, 'f1': 0.68299544, 'auroc': 0.88338745, 'binary_precision': 0.47198275, 'binary_recall': 0.3254086, 'binary_specificity': 0.98643935, 'binary_f1_score': 0.38522428}
confusion matrix:
       0    1
0  17822  245
1    454  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.85780543, 'recall': 0.64965266, 'specificity': 0.64965266, 'f1': 0.7072134, 'auroc': 0.9085293, 'binary_precision': 0.745283, 'binary_recall': 0.30384615, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.43169397}
confusion matrix:
      0   1
0  5919  27
1   181  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_12.png
new oracle model saved
early stop counter: 3
val acc:0.9627001285552979, best validation acc: 0.9628068208694458, corresponding to test acc:                         0.9637447595596313 / 0.9664840698242188
after epoch: 12,now: 2024-07-06 17:05:06.988160,epoch time: 0:21:41.267193,used: 4:23:49.859438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9812078, 'precision': 0.9824605, 'recall': 0.96772414, 'specificity': 0.96772414, 'f1': 0.97480595, 'auroc': 0.99511635, 'binary_precision': 0.9848903, 'binary_recall': 0.9403523, 'binary_specificity': 0.99509597, 'binary_f1_score': 0.9621061}
confusion matrix:
       0      1
0  42206    208
1    860  13558
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.72543067, 'recall': 0.63966656, 'specificity': 0.63966656, 'f1': 0.6713053, 'auroc': 0.88734835, 'binary_precision': 0.47688565, 'binary_recall': 0.29123327, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.3616236}
confusion matrix:
       0    1
0  17852  215
1    477  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.8686664, 'recall': 0.6499049, 'specificity': 0.6499049, 'f1': 0.7091239, 'auroc': 0.91283345, 'binary_precision': 0.7669903, 'binary_recall': 0.30384615, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.43526173}
confusion matrix:
      0   1
0  5922  24
1   181  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_13.png
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-06 17:26:43.355972,epoch time: 0:21:36.367812,used: 4:45:26.227250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9816477, 'precision': 0.9824959, 'recall': 0.96884483, 'specificity': 0.96884483, 'f1': 0.9754243, 'auroc': 0.9959953, 'binary_precision': 0.98414654, 'binary_recall': 0.94285315, 'binary_specificity': 0.9948365, 'binary_f1_score': 0.9630574}
confusion matrix:
       0      1
0  42194    219
1    824  13595
---- Validation: 
scalar performance:
{'acc': 0.9629136, 'precision': 0.7222755, 'recall': 0.6288545, 'specificity': 0.6288545, 'f1': 0.6616987, 'auroc': 0.88588965, 'binary_precision': 0.47135416, 'binary_recall': 0.268945, 'binary_specificity': 0.98876405, 'binary_f1_score': 0.3424787}
confusion matrix:
       0    1
0  17864  203
1    492  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.849035, 'recall': 0.632429, 'specificity': 0.632429, 'f1': 0.687671, 'auroc': 0.91059065, 'binary_precision': 0.7291667, 'binary_recall': 0.26923078, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.39325842}
confusion matrix:
      0   1
0  5920  26
1   190  70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_14.png
early stop counter: 1
val acc:0.9629135727882385, best validation acc: 0.9630736112594604, corresponding to test acc:                         0.9669674634933472 / 0.9669674634933472
after epoch: 14,now: 2024-07-06 17:48:22.751383,epoch time: 0:21:39.395411,used: 5:07:05.622661,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98203474, 'precision': 0.9834781, 'recall': 0.96891916, 'specificity': 0.96891916, 'f1': 0.97591984, 'auroc': 0.99591315, 'binary_precision': 0.9862795, 'binary_recall': 0.94229436, 'binary_specificity': 0.9955439, 'binary_f1_score': 0.9637853}
confusion matrix:
       0      1
0  42225    189
1    832  13586
---- Validation: 
scalar performance:
{'acc': 0.96334046, 'precision': 0.7285065, 'recall': 0.6412355, 'specificity': 0.6412355, 'f1': 0.6733879, 'auroc': 0.8928206, 'binary_precision': 0.48292682, 'binary_recall': 0.29420504, 'binary_specificity': 0.9882659, 'binary_f1_score': 0.36565095}
confusion matrix:
       0    1
0  17855  212
1    475  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.8256359, 'recall': 0.6713841, 'specificity': 0.6713841, 'f1': 0.72214437, 'auroc': 0.91662526, 'binary_precision': 0.6791045, 'binary_recall': 0.35, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.46192896}
confusion matrix:
      0   1
0  5903  43
1   169  91
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_15.png
better model found
persisted
after epoch: 15,now: 2024-07-06 18:09:53.255870,epoch time: 0:21:30.504487,used: 5:28:36.127148,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9830201, 'precision': 0.9823108, 'recall': 0.9726498, 'specificity': 0.9726498, 'f1': 0.97735643, 'auroc': 0.99636483, 'binary_precision': 0.9809136, 'binary_recall': 0.951595, 'binary_specificity': 0.9937046, 'binary_f1_score': 0.9660319}
confusion matrix:
       0      1
0  42145    267
1    698  13722
---- Validation: 
scalar performance:
{'acc': 0.9632871, 'precision': 0.7274888, 'recall': 0.6369162, 'specificity': 0.6369162, 'f1': 0.66965604, 'auroc': 0.8910076, 'binary_precision': 0.48120302, 'binary_recall': 0.28528973, 'binary_specificity': 0.9885427, 'binary_f1_score': 0.35820895}
confusion matrix:
       0    1
0  17860  207
1    481  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.83283865, 'recall': 0.6546651, 'specificity': 0.6546651, 'f1': 0.70803976, 'auroc': 0.91184056, 'binary_precision': 0.69491524, 'binary_recall': 0.31538463, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.43386242}
confusion matrix:
      0   1
0  5910  36
1   178  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_16.png
early stop counter: 1
val acc:0.9632871150970459, best validation acc: 0.9633404612541199, corresponding to test acc:                         0.9658395051956177 / 0.9669674634933472
after epoch: 16,now: 2024-07-06 18:31:19.372556,epoch time: 0:21:26.116686,used: 5:50:02.243834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9832489, 'precision': 0.9824689, 'recall': 0.97310054, 'specificity': 0.97310054, 'f1': 0.9776683, 'auroc': 0.99665415, 'binary_precision': 0.9809313, 'binary_recall': 0.9524965, 'binary_specificity': 0.9937046, 'binary_f1_score': 0.9665048}
confusion matrix:
       0      1
0  42145    267
1    685  13735
---- Validation: 
scalar performance:
{'acc': 0.9623266, 'precision': 0.71912885, 'recall': 0.6492929, 'specificity': 0.6492929, 'f1': 0.67679083, 'auroc': 0.88991416, 'binary_precision': 0.46357617, 'binary_recall': 0.31203565, 'binary_specificity': 0.9865501, 'binary_f1_score': 0.37300178}
confusion matrix:
       0    1
0  17824  243
1    463  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.8288653, 'recall': 0.6413717, 'specificity': 0.6413717, 'f1': 0.6941596, 'auroc': 0.9102292, 'binary_precision': 0.6880734, 'binary_recall': 0.28846154, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.40650403}
confusion matrix:
      0   1
0  5912  34
1   185  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_17.png
early stop counter: 2
val acc:0.9623265862464905, best validation acc: 0.9633404612541199, corresponding to test acc:                         0.9658395051956177 / 0.9669674634933472
after epoch: 17,now: 2024-07-06 18:52:44.793488,epoch time: 0:21:25.420932,used: 6:11:27.664766,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98356557, 'precision': 0.98382723, 'recall': 0.97260165, 'specificity': 0.97260165, 'f1': 0.9780482, 'auroc': 0.99682236, 'binary_precision': 0.9843402, 'binary_recall': 0.9503433, 'binary_specificity': 0.99486005, 'binary_f1_score': 0.967043}
confusion matrix:
       0      1
0  42195    218
1    716  13703
---- Validation: 
scalar performance:
{'acc': 0.9627001, 'precision': 0.72182816, 'recall': 0.6423339, 'specificity': 0.6423339, 'f1': 0.672377, 'auroc': 0.8889206, 'binary_precision': 0.46948355, 'binary_recall': 0.2971768, 'binary_specificity': 0.987491, 'binary_f1_score': 0.36396724}
confusion matrix:
       0    1
0  17841  226
1    473  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.8160802, 'recall': 0.6297492, 'specificity': 0.6297492, 'f1': 0.68018126, 'auroc': 0.9075028, 'binary_precision': 0.66346157, 'binary_recall': 0.2653846, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.3791209}
confusion matrix:
      0   1
0  5911  35
1   191  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_18.png
early stop counter: 3
val acc:0.9627001285552979, best validation acc: 0.9633404612541199, corresponding to test acc:                         0.9658395051956177 / 0.9669674634933472
after epoch: 18,now: 2024-07-06 19:14:17.692458,epoch time: 0:21:32.898970,used: 6:33:00.563736,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9837416, 'precision': 0.9851364, 'recall': 0.9718058, 'specificity': 0.9718058, 'f1': 0.9782381, 'auroc': 0.9968171, 'binary_precision': 0.98785424, 'binary_recall': 0.9475728, 'binary_specificity': 0.99603885, 'binary_f1_score': 0.96729434}
confusion matrix:
       0      1
0  42244    168
1    756  13664
---- Validation: 
scalar performance:
{'acc': 0.96237993, 'precision': 0.7175256, 'recall': 0.63573045, 'specificity': 0.63573045, 'f1': 0.666027, 'auroc': 0.89194304, 'binary_precision': 0.46135265, 'binary_recall': 0.28380385, 'binary_specificity': 0.98765707, 'binary_f1_score': 0.35142592}
confusion matrix:
       0    1
0  17844  223
1    482  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.82266146, 'recall': 0.6412035, 'specificity': 0.6412035, 'f1': 0.69297934, 'auroc': 0.91038513, 'binary_precision': 0.6756757, 'binary_recall': 0.28846154, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.40431267}
confusion matrix:
      0   1
0  5910  36
1   185  75
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_19.png
early stop counter: 4
val acc:0.9623799324035645, best validation acc: 0.9633404612541199, corresponding to test acc:                         0.9658395051956177 / 0.9669674634933472
after epoch: 19,now: 2024-07-06 19:35:44.543010,epoch time: 0:21:26.850552,used: 6:54:27.414288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9841639, 'precision': 0.9856609, 'recall': 0.97240394, 'specificity': 0.97240394, 'f1': 0.9788023, 'auroc': 0.99689543, 'binary_precision': 0.988578, 'binary_recall': 0.948533, 'binary_specificity': 0.9962749, 'binary_f1_score': 0.9681416}
confusion matrix:
       0      1
0  42257    158
1    742  13675
---- Validation: 
scalar performance:
{'acc': 0.96254003, 'precision': 0.71556604, 'recall': 0.6150707, 'specificity': 0.6150707, 'f1': 0.6482662, 'auroc': 0.8870951, 'binary_precision': 0.45892352, 'binary_recall': 0.24071322, 'binary_specificity': 0.9894282, 'binary_f1_score': 0.31578946}
confusion matrix:
       0    1
0  17876  191
1    511  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.80301905, 'recall': 0.6031624, 'specificity': 0.6031624, 'f1': 0.64918, 'auroc': 0.9051211, 'binary_precision': 0.6395349, 'binary_recall': 0.21153846, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.31791908}
confusion matrix:
      0   1
0  5915  31
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_20.png
early stop counter: 5
val acc:0.9625400304794312, best validation acc: 0.9633404612541199, corresponding to test acc:                         0.9658395051956177 / 0.9669674634933472
after epoch: 20,now: 2024-07-06 19:57:25.030902,epoch time: 0:21:40.487892,used: 7:16:07.902180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9848853, 'precision': 0.98435885, 'recall': 0.97556865, 'specificity': 0.97556865, 'f1': 0.97986174, 'auroc': 0.99705297, 'binary_precision': 0.9833191, 'binary_recall': 0.9566544, 'binary_specificity': 0.9944828, 'binary_f1_score': 0.9698035}
confusion matrix:
       0      1
0  42179    234
1    625  13794
---- Validation: 
scalar performance:
{'acc': 0.96237993, 'precision': 0.72122854, 'recall': 0.6607648, 'specificity': 0.6607648, 'f1': 0.6856282, 'auroc': 0.89557934, 'binary_precision': 0.46694216, 'binary_recall': 0.3358098, 'binary_specificity': 0.9857198, 'binary_f1_score': 0.39066553}
confusion matrix:
       0    1
0  17809  258
1    447  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.8281093, 'recall': 0.6827544, 'specificity': 0.6827544, 'f1': 0.73263407, 'auroc': 0.91130364, 'binary_precision': 0.6830986, 'binary_recall': 0.37307692, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.4825871}
confusion matrix:
      0   1
0  5901  45
1   163  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_21.png
early stop counter: 6
val acc:0.9623799324035645, best validation acc: 0.9633404612541199, corresponding to test acc:                         0.9658395051956177 / 0.9669674634933472
after epoch: 21,now: 2024-07-06 20:19:06.040991,epoch time: 0:21:41.010089,used: 7:37:48.912269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9859058, 'precision': 0.98629224, 'recall': 0.97636676, 'specificity': 0.97636676, 'f1': 0.9812002, 'auroc': 0.996925, 'binary_precision': 0.9870529, 'binary_recall': 0.95700115, 'binary_specificity': 0.9957324, 'binary_f1_score': 0.9717947}
confusion matrix:
       0      1
0  42232    181
1    620  13799
---- Validation: 
scalar performance:
{'acc': 0.96286017, 'precision': 0.7213489, 'recall': 0.626681, 'specificity': 0.626681, 'f1': 0.6596484, 'auroc': 0.89959824, 'binary_precision': 0.469657, 'binary_recall': 0.26448736, 'binary_specificity': 0.98887473, 'binary_f1_score': 0.33840305}
confusion matrix:
       0    1
0  17866  201
1    495  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.8332816, 'recall': 0.647141, 'specificity': 0.647141, 'f1': 0.7007073, 'auroc': 0.91545, 'binary_precision': 0.6964286, 'binary_recall': 0.3, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.41935486}
confusion matrix:
      0   1
0  5912  34
1   182  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_22.png
early stop counter: 7
val acc:0.9628601670265198, best validation acc: 0.9633404612541199, corresponding to test acc:                         0.9658395051956177 / 0.9669674634933472
after epoch: 22,now: 2024-07-06 20:40:41.458930,epoch time: 0:21:35.417939,used: 7:59:24.330208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9865745, 'precision': 0.9886293, 'recall': 0.9758764, 'specificity': 0.9758764, 'f1': 0.9820415, 'auroc': 0.99755865, 'binary_precision': 0.9926407, 'binary_recall': 0.9541577, 'binary_specificity': 0.9975951, 'binary_f1_score': 0.9730189}
confusion matrix:
       0      1
0  42311    102
1    661  13758
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.7264994, 'recall': 0.59628433, 'specificity': 0.59628433, 'f1': 0.63230866, 'auroc': 0.89845955, 'binary_precision': 0.48214287, 'binary_recall': 0.20059435, 'binary_specificity': 0.9919743, 'binary_f1_score': 0.28331584}
confusion matrix:
       0    1
0  17922  145
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.81729406, 'recall': 0.62038606, 'specificity': 0.62038606, 'f1': 0.6703194, 'auroc': 0.91286856, 'binary_precision': 0.6666667, 'binary_recall': 0.24615385, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.35955057}
confusion matrix:
      0   1
0  5914  32
1   196  64
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_23.png
better model found
persisted
after epoch: 23,now: 2024-07-06 21:02:25.202122,epoch time: 0:21:43.743192,used: 8:21:08.073400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98370636, 'precision': 0.9872237, 'recall': 0.9697664, 'specificity': 0.9697664, 'f1': 0.97809935, 'auroc': 0.99704593, 'binary_precision': 0.9939957, 'binary_recall': 0.9414661, 'binary_specificity': 0.9980666, 'binary_f1_score': 0.96701807}
confusion matrix:
       0      1
0  42331     82
1    844  13575
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.7344152, 'recall': 0.5943876, 'specificity': 0.5943876, 'f1': 0.6315027, 'auroc': 0.8946698, 'binary_precision': 0.49811321, 'binary_recall': 0.1961367, 'binary_specificity': 0.9926385, 'binary_f1_score': 0.28144988}
confusion matrix:
       0    1
0  17934  133
1    541  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8282373, 'recall': 0.5886187, 'specificity': 0.5886187, 'f1': 0.6336104, 'auroc': 0.90638566, 'binary_precision': 0.6911765, 'binary_recall': 0.18076923, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.28658536}
confusion matrix:
      0   1
0  5925  21
1   213  47
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_24.png
better model found
persisted
after epoch: 24,now: 2024-07-06 21:24:31.436387,epoch time: 0:22:06.234265,used: 8:43:14.307665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9861522, 'precision': 0.98631954, 'recall': 0.976991, 'specificity': 0.976991, 'f1': 0.9815409, 'auroc': 0.99756205, 'binary_precision': 0.9866495, 'binary_recall': 0.95839113, 'binary_specificity': 0.99559087, 'binary_f1_score': 0.972315}
confusion matrix:
       0      1
0  42225    187
1    600  13820
---- Validation: 
scalar performance:
{'acc': 0.96125937, 'precision': 0.7100241, 'recall': 0.6523157, 'specificity': 0.6523157, 'f1': 0.6759927, 'auroc': 0.89696777, 'binary_precision': 0.44513458, 'binary_recall': 0.31946507, 'binary_specificity': 0.9851663, 'binary_f1_score': 0.37197232}
confusion matrix:
       0    1
0  17799  268
1    458  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.79209375, 'recall': 0.6682838, 'specificity': 0.6682838, 'f1': 0.7116758, 'auroc': 0.90762055, 'binary_precision': 0.6122449, 'binary_recall': 0.34615386, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.44226044}
confusion matrix:
      0   1
0  5889  57
1   170  90
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_25.png
early stop counter: 1
val acc:0.9612593650817871, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9622945785522461 / 0.9669674634933472
after epoch: 25,now: 2024-07-06 21:46:05.558480,epoch time: 0:21:34.122093,used: 9:04:48.429758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.985941, 'precision': 0.98617566, 'recall': 0.9765749, 'specificity': 0.9765749, 'f1': 0.9812542, 'auroc': 0.99724334, 'binary_precision': 0.98663807, 'binary_recall': 0.95755893, 'binary_specificity': 0.99559087, 'binary_f1_score': 0.97188103}
confusion matrix:
       0      1
0  42225    187
1    612  13808
---- Validation: 
scalar performance:
{'acc': 0.96237993, 'precision': 0.72160155, 'recall': 0.6636259, 'specificity': 0.6636259, 'f1': 0.68771815, 'auroc': 0.9037262, 'binary_precision': 0.46747968, 'binary_recall': 0.34175333, 'binary_specificity': 0.9854984, 'binary_f1_score': 0.39484978}
confusion matrix:
       0    1
0  17805  262
1    443  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.8354875, 'recall': 0.68300664, 'specificity': 0.68300664, 'f1': 0.7345754, 'auroc': 0.913461, 'binary_precision': 0.6978417, 'binary_recall': 0.37307692, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.48621553}
confusion matrix:
      0   1
0  5904  42
1   163  97
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_26.png
early stop counter: 2
val acc:0.9623799324035645, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9622945785522461 / 0.9669674634933472
after epoch: 26,now: 2024-07-06 22:08:09.909406,epoch time: 0:22:04.350926,used: 9:26:52.780684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98668003, 'precision': 0.98771477, 'recall': 0.9770214, 'specificity': 0.9770214, 'f1': 0.9822188, 'auroc': 0.9978241, 'binary_precision': 0.9897469, 'binary_recall': 0.9574143, 'binary_specificity': 0.99662846, 'binary_f1_score': 0.97331226}
confusion matrix:
       0      1
0  42271    143
1    614  13804
---- Validation: 
scalar performance:
{'acc': 0.96221983, 'precision': 0.71560895, 'recall': 0.6342169, 'specificity': 0.6342169, 'f1': 0.6643062, 'auroc': 0.90387195, 'binary_precision': 0.45762712, 'binary_recall': 0.28083208, 'binary_specificity': 0.9876017, 'binary_f1_score': 0.34806627}
confusion matrix:
       0    1
0  17843  224
1    484  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.82421684, 'recall': 0.6544128, 'specificity': 0.6544128, 'f1': 0.7062048, 'auroc': 0.9141705, 'binary_precision': 0.677686, 'binary_recall': 0.31538463, 'binary_specificity': 0.993441, 'binary_f1_score': 0.4304462}
confusion matrix:
      0   1
0  5907  39
1   178  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_27.png
early stop counter: 3
val acc:0.9622198343276978, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9622945785522461 / 0.9669674634933472
after epoch: 27,now: 2024-07-06 22:30:31.584019,epoch time: 0:22:21.674613,used: 9:49:14.455297,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98660964, 'precision': 0.98702896, 'recall': 0.9775021, 'specificity': 0.9775021, 'f1': 0.9821466, 'auroc': 0.99755555, 'binary_precision': 0.98785543, 'binary_recall': 0.9590124, 'binary_specificity': 0.99599177, 'binary_f1_score': 0.9732202}
confusion matrix:
       0      1
0  42243    170
1    591  13828
---- Validation: 
scalar performance:
{'acc': 0.9621665, 'precision': 0.71879613, 'recall': 0.6570778, 'specificity': 0.6570778, 'f1': 0.68224895, 'auroc': 0.9028598, 'binary_precision': 0.4623431, 'binary_recall': 0.32838038, 'binary_specificity': 0.9857752, 'binary_f1_score': 0.38401392}
confusion matrix:
       0    1
0  17810  257
1    452  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.8198805, 'recall': 0.64864355, 'specificity': 0.64864355, 'f1': 0.699854, 'auroc': 0.9110637, 'binary_precision': 0.6694915, 'binary_recall': 0.30384615, 'binary_specificity': 0.993441, 'binary_f1_score': 0.41798943}
confusion matrix:
      0   1
0  5907  39
1   181  79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_28.png
early stop counter: 4
val acc:0.9621664881706238, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9622945785522461 / 0.9669674634933472
after epoch: 28,now: 2024-07-06 22:52:06.774839,epoch time: 0:21:35.190820,used: 10:10:49.646117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98791176, 'precision': 0.98812383, 'recall': 0.97986096, 'specificity': 0.97986096, 'f1': 0.98390305, 'auroc': 0.998062, 'binary_precision': 0.9885434, 'binary_recall': 0.96351784, 'binary_specificity': 0.9962041, 'binary_f1_score': 0.9758702}
confusion matrix:
       0      1
0  42253    161
1    526  13892
---- Validation: 
scalar performance:
{'acc': 0.96195304, 'precision': 0.7173179, 'recall': 0.6598281, 'specificity': 0.6598281, 'f1': 0.6836488, 'auroc': 0.90485287, 'binary_precision': 0.45918366, 'binary_recall': 0.3343239, 'binary_specificity': 0.98533237, 'binary_f1_score': 0.38693035}
confusion matrix:
       0    1
0  17802  265
1    448  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.82327676, 'recall': 0.6788242, 'specificity': 0.6788242, 'f1': 0.72812414, 'auroc': 0.90954345, 'binary_precision': 0.67375886, 'binary_recall': 0.3653846, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.47381547}
confusion matrix:
      0   1
0  5900  46
1   165  95
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_29.png
early stop counter: 5
val acc:0.9619530439376831, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9622945785522461 / 0.9669674634933472
after epoch: 29,now: 2024-07-06 23:13:40.983775,epoch time: 0:21:34.208936,used: 10:32:23.855053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9873311, 'precision': 0.9892062, 'recall': 0.97729886, 'specificity': 0.97729886, 'f1': 0.9830683, 'auroc': 0.997558, 'binary_precision': 0.9928762, 'binary_recall': 0.9569318, 'binary_specificity': 0.9976658, 'binary_f1_score': 0.97457266}
confusion matrix:
       0      1
0  42314     99
1    621  13798
---- Validation: 
scalar performance:
{'acc': 0.9627535, 'precision': 0.72000235, 'recall': 0.62591046, 'specificity': 0.62591046, 'f1': 0.6586704, 'auroc': 0.90666735, 'binary_precision': 0.46701846, 'binary_recall': 0.26300147, 'binary_specificity': 0.9888194, 'binary_f1_score': 0.33650187}
confusion matrix:
       0    1
0  17865  202
1    496  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.8256327, 'recall': 0.6525738, 'specificity': 0.6525738, 'f1': 0.70470345, 'auroc': 0.9124428, 'binary_precision': 0.6806723, 'binary_recall': 0.31153846, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.42744064}
confusion matrix:
      0   1
0  5908  38
1   179  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_30.png
early stop counter: 6
val acc:0.9627534747123718, best validation acc: 0.9640341401100159, corresponding to test acc:                         0.9622945785522461 / 0.9669674634933472
after epoch: 30,now: 2024-07-06 23:35:10.976283,epoch time: 0:21:29.992508,used: 10:53:53.847561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_12_41_17_seed_1_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:53:53.847561 at 2024-07-06 23:35:10.976283
persisted model performance metric: 

scalar performance:
{'acc': 0.9622946, 'precision': 0.8282373, 'recall': 0.5886187, 'specificity': 0.5886187, 'f1': 0.6336104, 'auroc': 0.90638566, 'binary_precision': 0.6911765, 'binary_recall': 0.18076923, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.28658536}
confusion matrix:
      0   1
0  5925  21
1   213  47
oracle model performance metric: 

scalar performance:
{'acc': 0.96696746, 'precision': 0.8686664, 'recall': 0.6499049, 'specificity': 0.6499049, 'f1': 0.7091239, 'auroc': 0.91283345, 'binary_precision': 0.7669903, 'binary_recall': 0.30384615, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.43526173}
confusion matrix:
      0   1
0  5922  24
1   181  79
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |  17479 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |  17479 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   7827 MiB |   2381 TiB |   2381 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   2350 TiB |   2350 TiB |
|       from small pool |  16480 KiB |     36 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  16790 MiB |   8278 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  16734 MiB |   8260 MiB |
|       from small pool |     38 MiB |     44 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38830 KiB | 732464 KiB |   1320 TiB |   1320 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1289 TiB |   1289 TiB |
|       from small pool |   7097 KiB |  23272 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7625    |  393257 K  |  393254 K  |
|       from large pool |      79    |     762    |  223190 K  |  223190 K  |
|       from small pool |    2875    |    7544    |  170066 K  |  170063 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7625    |  393257 K  |  393254 K  |
|       from large pool |      79    |     762    |  223190 K  |  223190 K  |
|       from small pool |    2875    |    7544    |  170066 K  |  170063 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |     715    |     347    |
|       from large pool |     349    |     349    |     687    |     338    |
|       from small pool |      19    |      22    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3589    |  232609 K  |  232609 K  |
|       from large pool |      11    |     352    |  160864 K  |  160864 K  |
|       from small pool |      25    |    3579    |   71745 K  |   71745 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     36 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16790 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     44 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1320 TiB |   1320 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1289 TiB |   1289 TiB |
|       from small pool |      0 KiB |  23272 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  393257 K  |  393257 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170066 K  |  170066 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  393257 K  |  393257 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170066 K  |  170066 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     715    |     693    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      22    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  232611 K  |  232611 K  |
|       from large pool |       3    |     352    |  160864 K  |  160864 K  |
|       from small pool |       0    |    3579    |   71746 K  |   71746 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     36 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16790 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     44 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1320 TiB |   1320 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1289 TiB |   1289 TiB |
|       from small pool |      0 KiB |  23272 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  393257 K  |  393257 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170066 K  |  170066 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  393257 K  |  393257 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170066 K  |  170066 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     715    |     693    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      22    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  232611 K  |  232611 K  |
|       from large pool |       3    |     352    |  160864 K  |  160864 K  |
|       from small pool |       0    |    3579    |   71746 K  |   71746 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430

 Experiment start at: 2024-07-06 23:42:29.147827
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9426532, 'precision': 0.9489169, 'recall': 0.9019916, 'specificity': 0.9019916, 'f1': 0.9221988, 'auroc': 0.96928537, 'binary_precision': 0.9602582, 'binary_recall': 0.8160608, 'binary_specificity': 0.9879225, 'binary_f1_score': 0.8823067}
confusion matrix:
       0      1
0  41799    511
1   2783  12347
---- Validation: 
scalar performance:
{'acc': 0.95397645, 'precision': 0.61259645, 'recall': 0.5987931, 'specificity': 0.5987931, 'f1': 0.605159, 'auroc': 0.78725016, 'binary_precision': 0.25095057, 'binary_recall': 0.2192691, 'binary_specificity': 0.9783171, 'binary_f1_score': 0.23404254}
confusion matrix:
       0    1
0  17777  394
1    470  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9229043, 'precision': 0.51058596, 'recall': 0.51179725, 'specificity': 0.51179725, 'f1': 0.5110888, 'auroc': 0.639917, 'binary_precision': 0.05904059, 'binary_recall': 0.0661157, 'binary_specificity': 0.95747876, 'binary_f1_score': 0.06237817}
confusion matrix:
      0    1
0  5742  255
1   226   16
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-07 00:04:52.539600,epoch time: 0:22:23.391773,used: 0:22:23.391773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95837396, 'precision': 0.96448886, 'recall': 0.9278207, 'specificity': 0.9278207, 'f1': 0.94422966, 'auroc': 0.9805161, 'binary_precision': 0.97593963, 'binary_recall': 0.8632518, 'binary_specificity': 0.9923895, 'binary_f1_score': 0.91614354}
confusion matrix:
       0      1
0  41988    322
1   2069  13061
---- Validation: 
scalar performance:
{'acc': 0.9627657, 'precision': 0.65117365, 'recall': 0.57281744, 'specificity': 0.57281744, 'f1': 0.5964414, 'auroc': 0.8156842, 'binary_precision': 0.32982457, 'binary_recall': 0.15614618, 'binary_specificity': 0.9894887, 'binary_f1_score': 0.2119504}
confusion matrix:
       0    1
0  17980  191
1    508   94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9418176, 'precision': 0.53890985, 'recall': 0.52560097, 'specificity': 0.52560097, 'f1': 0.5300867, 'auroc': 0.7308068, 'binary_precision': 0.11464968, 'binary_recall': 0.07438017, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.09022557}
confusion matrix:
      0    1
0  5858  139
1   224   18
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-07 00:26:32.287798,epoch time: 0:21:39.748198,used: 0:44:03.139971,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96495473, 'precision': 0.96865505, 'recall': 0.94056714, 'specificity': 0.94056714, 'f1': 0.9534828, 'auroc': 0.9859431, 'binary_precision': 0.9757708, 'binary_recall': 0.88902843, 'binary_specificity': 0.9921059, 'binary_f1_score': 0.93038213}
confusion matrix:
       0      1
0  41976    334
1   1679  13451
---- Validation: 
scalar performance:
{'acc': 0.9635114, 'precision': 0.67593384, 'recall': 0.6005063, 'specificity': 0.6005063, 'f1': 0.6266689, 'auroc': 0.83869326, 'binary_precision': 0.37758112, 'binary_recall': 0.21262458, 'binary_specificity': 0.98838806, 'binary_f1_score': 0.272051}
confusion matrix:
       0    1
0  17960  211
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9429396, 'precision': 0.5831377, 'recall': 0.5658394, 'specificity': 0.5658394, 'f1': 0.5731863, 'auroc': 0.7923321, 'binary_precision': 0.2, 'binary_recall': 0.1570248, 'binary_specificity': 0.974654, 'binary_f1_score': 0.17592594}
confusion matrix:
      0    1
0  5845  152
1   204   38
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-07 00:48:19.902480,epoch time: 0:21:47.614682,used: 1:05:50.754653,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96666086, 'precision': 0.9719938, 'recall': 0.94189155, 'specificity': 0.94189155, 'f1': 0.9556618, 'auroc': 0.98894787, 'binary_precision': 0.9821924, 'binary_recall': 0.88954985, 'binary_specificity': 0.9942332, 'binary_f1_score': 0.93357843}
confusion matrix:
       0      1
0  42067    244
1   1671  13458
---- Validation: 
scalar performance:
{'acc': 0.96676075, 'precision': 0.71399766, 'recall': 0.58773, 'specificity': 0.58773, 'f1': 0.6218308, 'auroc': 0.85315275, 'binary_precision': 0.45454547, 'binary_recall': 0.18272425, 'binary_specificity': 0.9927357, 'binary_f1_score': 0.2606635}
confusion matrix:
       0    1
0  18039  132
1    492  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501523, 'precision': 0.6176436, 'recall': 0.5735567, 'specificity': 0.5735567, 'f1': 0.5894367, 'auroc': 0.83195245, 'binary_precision': 0.26845637, 'binary_recall': 0.16528925, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.20460358}
confusion matrix:
      0    1
0  5888  109
1   202   40
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-07 01:10:10.122578,epoch time: 0:21:50.220098,used: 1:27:40.974751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97104806, 'precision': 0.9688711, 'recall': 0.9559761, 'specificity': 0.9559761, 'f1': 0.9621811, 'auroc': 0.99086845, 'binary_precision': 0.9644754, 'binary_recall': 0.92412424, 'binary_specificity': 0.98782796, 'binary_f1_score': 0.94386876}
confusion matrix:
       0      1
0  41795    515
1   1148  13982
---- Validation: 
scalar performance:
{'acc': 0.96606827, 'precision': 0.7143141, 'recall': 0.63234293, 'specificity': 0.63234293, 'f1': 0.66260296, 'auroc': 0.8608434, 'binary_precision': 0.45231608, 'binary_recall': 0.2757475, 'binary_specificity': 0.9889384, 'binary_f1_score': 0.34262127}
confusion matrix:
       0    1
0  17970  201
1    436  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9410162, 'precision': 0.61620486, 'recall': 0.62630385, 'specificity': 0.62630385, 'f1': 0.62099445, 'auroc': 0.84699786, 'binary_precision': 0.26136363, 'binary_recall': 0.28512397, 'binary_specificity': 0.96748376, 'binary_f1_score': 0.27272728}
confusion matrix:
      0    1
0  5802  195
1   173   69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_5.png
early stop counter: 1
val acc:0.9660682678222656, best validation acc: 0.9667607545852661, corresponding to test acc:                         0.9501522779464722 / 0.9501522779464722
after epoch: 5,now: 2024-07-07 01:31:54.227349,epoch time: 0:21:44.104771,used: 1:49:25.079522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97378135, 'precision': 0.9734308, 'recall': 0.9585745, 'specificity': 0.9585745, 'f1': 0.9656856, 'auroc': 0.99128413, 'binary_precision': 0.9727273, 'binary_recall': 0.92643756, 'binary_specificity': 0.9907114, 'binary_f1_score': 0.94901824}
confusion matrix:
       0      1
0  41917    393
1   1113  14017
---- Validation: 
scalar performance:
{'acc': 0.96606827, 'precision': 0.7146229, 'recall': 0.63394904, 'specificity': 0.63394904, 'f1': 0.66395324, 'auroc': 0.8666295, 'binary_precision': 0.4528302, 'binary_recall': 0.27906978, 'binary_specificity': 0.98882836, 'binary_f1_score': 0.34532374}
confusion matrix:
       0    1
0  17968  203
1    434  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94309986, 'precision': 0.6321003, 'recall': 0.6472151, 'specificity': 0.6472151, 'f1': 0.63916117, 'auroc': 0.8590025, 'binary_precision': 0.2915129, 'binary_recall': 0.3264463, 'binary_specificity': 0.967984, 'binary_f1_score': 0.3079922}
confusion matrix:
      0    1
0  5805  192
1   163   79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_6.png
early stop counter: 2
val acc:0.9660682678222656, best validation acc: 0.9667607545852661, corresponding to test acc:                         0.9501522779464722 / 0.9501522779464722
after epoch: 6,now: 2024-07-07 01:53:38.161227,epoch time: 0:21:43.933878,used: 2:11:09.013400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97493035, 'precision': 0.9779669, 'recall': 0.9572289, 'specificity': 0.9572289, 'f1': 0.9669927, 'auroc': 0.99269366, 'binary_precision': 0.98394966, 'binary_recall': 0.9198229, 'binary_specificity': 0.994635, 'binary_f1_score': 0.9508062}
confusion matrix:
       0      1
0  42084    227
1   1213  13916
---- Validation: 
scalar performance:
{'acc': 0.96681404, 'precision': 0.7218977, 'recall': 0.6230916, 'specificity': 0.6230916, 'f1': 0.6569061, 'auroc': 0.8694488, 'binary_precision': 0.4680851, 'binary_recall': 0.25581396, 'binary_specificity': 0.99036926, 'binary_f1_score': 0.3308271}
confusion matrix:
       0    1
0  17996  175
1    448  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480686, 'precision': 0.6433648, 'recall': 0.6319551, 'specificity': 0.6319551, 'f1': 0.63737786, 'auroc': 0.8661666, 'binary_precision': 0.3153153, 'binary_recall': 0.2892562, 'binary_specificity': 0.974654, 'binary_f1_score': 0.30172414}
confusion matrix:
      0    1
0  5845  152
1   172   70
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_7.png
better model found
persisted
after epoch: 7,now: 2024-07-07 02:15:23.623990,epoch time: 0:21:45.462763,used: 2:32:54.476163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97820336, 'precision': 0.9799651, 'recall': 0.9636566, 'specificity': 0.9636566, 'f1': 0.97143626, 'auroc': 0.9942076, 'binary_precision': 0.9834866, 'binary_recall': 0.93291473, 'binary_specificity': 0.9943985, 'binary_f1_score': 0.95753336}
confusion matrix:
       0      1
0  42073    237
1   1015  14115
---- Validation: 
scalar performance:
{'acc': 0.96676075, 'precision': 0.7240274, 'recall': 0.6431403, 'specificity': 0.6431403, 'f1': 0.6737481, 'auroc': 0.87472564, 'binary_precision': 0.47105262, 'binary_recall': 0.29734218, 'binary_specificity': 0.9889384, 'binary_f1_score': 0.36456206}
confusion matrix:
       0    1
0  17970  201
1    423  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94486296, 'precision': 0.6446119, 'recall': 0.6639942, 'specificity': 0.6639942, 'f1': 0.6535724, 'auroc': 0.87286556, 'binary_precision': 0.3152174, 'binary_recall': 0.35950413, 'binary_specificity': 0.9684842, 'binary_f1_score': 0.33590734}
confusion matrix:
      0    1
0  5808  189
1   155   87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_8.png
early stop counter: 1
val acc:0.9667607545852661, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9480686187744141 / 0.9501522779464722
after epoch: 8,now: 2024-07-07 02:37:06.437597,epoch time: 0:21:42.813607,used: 2:54:37.289770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97768104, 'precision': 0.97908825, 'recall': 0.9631535, 'specificity': 0.9631535, 'f1': 0.97076225, 'auroc': 0.9940487, 'binary_precision': 0.9819042, 'binary_recall': 0.9324521, 'binary_specificity': 0.9938549, 'binary_f1_score': 0.95653945}
confusion matrix:
       0      1
0  42050    260
1   1022  14108
---- Validation: 
scalar performance:
{'acc': 0.96548235, 'precision': 0.7146156, 'recall': 0.6673744, 'specificity': 0.6673744, 'f1': 0.6877471, 'auroc': 0.87907076, 'binary_precision': 0.45064378, 'binary_recall': 0.3488372, 'binary_specificity': 0.9859116, 'binary_f1_score': 0.3932584}
confusion matrix:
       0    1
0  17915  256
1    392  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93652827, 'precision': 0.6364346, 'recall': 0.70724446, 'specificity': 0.70724446, 'f1': 0.6629169, 'auroc': 0.8763211, 'binary_precision': 0.29521278, 'binary_recall': 0.45867768, 'binary_specificity': 0.95581126, 'binary_f1_score': 0.3592233}
confusion matrix:
      0    1
0  5732  265
1   131  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_9.png
early stop counter: 2
val acc:0.9654823541641235, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9480686187744141 / 0.9501522779464722
after epoch: 9,now: 2024-07-07 02:59:10.481619,epoch time: 0:22:04.044022,used: 3:16:41.333792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9792305, 'precision': 0.98182666, 'recall': 0.9645215, 'specificity': 0.9645215, 'f1': 0.97275513, 'auroc': 0.99486816, 'binary_precision': 0.9870003, 'binary_recall': 0.9334391, 'binary_specificity': 0.995604, 'binary_f1_score': 0.9594728}
confusion matrix:
       0      1
0  42125    186
1   1007  14122
---- Validation: 
scalar performance:
{'acc': 0.96644115, 'precision': 0.72279036, 'recall': 0.66064227, 'specificity': 0.66064227, 'f1': 0.6861406, 'auroc': 0.88163185, 'binary_precision': 0.46744186, 'binary_recall': 0.33388704, 'binary_specificity': 0.9873975, 'binary_f1_score': 0.3895349}
confusion matrix:
       0    1
0  17942  229
1    401  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9410162, 'precision': 0.6426991, 'recall': 0.6917343, 'specificity': 0.6917343, 'f1': 0.66286725, 'auroc': 0.87776804, 'binary_precision': 0.3090909, 'binary_recall': 0.4214876, 'binary_specificity': 0.961981, 'binary_f1_score': 0.35664335}
confusion matrix:
      0    1
0  5769  228
1   140  102
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_10.png
early stop counter: 3
val acc:0.9664411544799805, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9480686187744141 / 0.9501522779464722
after epoch: 10,now: 2024-07-07 03:21:07.911881,epoch time: 0:21:57.430262,used: 3:38:38.764054,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98083216, 'precision': 0.9810419, 'recall': 0.96934724, 'specificity': 0.96934724, 'f1': 0.9750013, 'auroc': 0.9948741, 'binary_precision': 0.9814675, 'binary_recall': 0.945076, 'binary_specificity': 0.99361855, 'binary_f1_score': 0.962928}
confusion matrix:
       0      1
0  42040    270
1    831  14299
---- Validation: 
scalar performance:
{'acc': 0.96628135, 'precision': 0.7226219, 'recall': 0.6718024, 'specificity': 0.6718024, 'f1': 0.69358253, 'auroc': 0.8824666, 'binary_precision': 0.46637744, 'binary_recall': 0.35714287, 'binary_specificity': 0.98646194, 'binary_f1_score': 0.40451553}
confusion matrix:
       0    1
0  17925  246
1    387  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93765026, 'precision': 0.637994, 'recall': 0.7038626, 'specificity': 0.7038626, 'f1': 0.6631872, 'auroc': 0.8796587, 'binary_precision': 0.29863015, 'binary_recall': 0.45041323, 'binary_specificity': 0.957312, 'binary_f1_score': 0.35914335}
confusion matrix:
      0    1
0  5741  256
1   133  109
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_11.png
early stop counter: 4
val acc:0.9662813544273376, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9480686187744141 / 0.9501522779464722
after epoch: 11,now: 2024-07-07 03:43:17.674281,epoch time: 0:22:09.762400,used: 4:00:48.526454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9803795, 'precision': 0.9832701, 'recall': 0.9660891, 'specificity': 0.9660891, 'f1': 0.9742681, 'auroc': 0.9954084, 'binary_precision': 0.989034, 'binary_recall': 0.93588895, 'binary_specificity': 0.9962893, 'binary_f1_score': 0.9617278}
confusion matrix:
       0      1
0  42153    157
1    970  14160
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.7301195, 'recall': 0.6546031, 'specificity': 0.6546031, 'f1': 0.6841866, 'auroc': 0.8835677, 'binary_precision': 0.4825, 'binary_recall': 0.320598, 'binary_specificity': 0.98860824, 'binary_f1_score': 0.38522956}
confusion matrix:
       0    1
0  17964  207
1    409  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9434204, 'precision': 0.64813685, 'recall': 0.6870367, 'specificity': 0.6870367, 'f1': 0.664875, 'auroc': 0.87919545, 'binary_precision': 0.32038835, 'binary_recall': 0.4090909, 'binary_specificity': 0.9649825, 'binary_f1_score': 0.35934666}
confusion matrix:
      0    1
0  5787  210
1   143   99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_12.png
better model found
persisted
after epoch: 12,now: 2024-07-07 04:05:22.956491,epoch time: 0:22:05.282210,used: 4:22:53.808664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9814241, 'precision': 0.98315644, 'recall': 0.9688362, 'specificity': 0.9688362, 'f1': 0.9757092, 'auroc': 0.9958303, 'binary_precision': 0.98664266, 'binary_recall': 0.942234, 'binary_specificity': 0.99543846, 'binary_f1_score': 0.9639271}
confusion matrix:
       0      1
0  42117    193
1    874  14256
---- Validation: 
scalar performance:
{'acc': 0.96569544, 'precision': 0.71912146, 'recall': 0.6851516, 'specificity': 0.6851516, 'f1': 0.70054936, 'auroc': 0.8859334, 'binary_precision': 0.45849803, 'binary_recall': 0.38538206, 'binary_specificity': 0.98492104, 'binary_f1_score': 0.41877258}
confusion matrix:
       0    1
0  17897  274
1    370  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9338035, 'precision': 0.63726217, 'recall': 0.72962, 'specificity': 0.72962, 'f1': 0.66917455, 'auroc': 0.8792957, 'binary_precision': 0.29496402, 'binary_recall': 0.5082645, 'binary_specificity': 0.9509755, 'binary_f1_score': 0.37329286}
confusion matrix:
      0    1
0  5703  294
1   119  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_13.png
early stop counter: 1
val acc:0.9656954407691956, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 13,now: 2024-07-07 04:27:17.409756,epoch time: 0:21:54.453265,used: 4:44:48.261929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98111075, 'precision': 0.9822259, 'recall': 0.9689207, 'specificity': 0.9689207, 'f1': 0.9753245, 'auroc': 0.9954834, 'binary_precision': 0.9844774, 'binary_recall': 0.9431593, 'binary_specificity': 0.99468213, 'binary_f1_score': 0.96337557}
confusion matrix:
       0      1
0  42085    225
1    860  14270
---- Validation: 
scalar performance:
{'acc': 0.9647366, 'precision': 0.71542174, 'recall': 0.7119599, 'specificity': 0.7119599, 'f1': 0.71367514, 'auroc': 0.8911032, 'binary_precision': 0.4493243, 'binary_recall': 0.44186047, 'binary_specificity': 0.9820593, 'binary_f1_score': 0.4455611}
confusion matrix:
       0    1
0  17845  326
1    336  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9294759, 'precision': 0.6305507, 'recall': 0.7352998, 'specificity': 0.7352998, 'f1': 0.66432774, 'auroc': 0.87771297, 'binary_precision': 0.28097346, 'binary_recall': 0.5247934, 'binary_specificity': 0.94580626, 'binary_f1_score': 0.36599424}
confusion matrix:
      0    1
0  5672  325
1   115  127
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_14.png
early stop counter: 2
val acc:0.9647365808486938, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 14,now: 2024-07-07 04:49:25.476024,epoch time: 0:22:08.066268,used: 5:06:56.328197,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9827124, 'precision': 0.98361325, 'recall': 0.97168505, 'specificity': 0.97168505, 'f1': 0.97744954, 'auroc': 0.99613464, 'binary_precision': 0.98544055, 'binary_recall': 0.9483807, 'binary_specificity': 0.99498934, 'binary_f1_score': 0.96655554}
confusion matrix:
       0      1
0  42098    212
1    781  14349
---- Validation: 
scalar performance:
{'acc': 0.96633464, 'precision': 0.7257977, 'recall': 0.69592136, 'specificity': 0.69592136, 'f1': 0.7096845, 'auroc': 0.8900529, 'binary_precision': 0.47115386, 'binary_recall': 0.40697673, 'binary_specificity': 0.984866, 'binary_f1_score': 0.43672013}
confusion matrix:
       0    1
0  17896  275
1    357  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93588716, 'precision': 0.63549906, 'recall': 0.7088937, 'specificity': 0.7088937, 'f1': 0.6626153, 'auroc': 0.8781588, 'binary_precision': 0.29319373, 'binary_recall': 0.46280992, 'binary_specificity': 0.9549775, 'binary_f1_score': 0.3589744}
confusion matrix:
      0    1
0  5727  270
1   130  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_15.png
early stop counter: 3
val acc:0.9663346409797668, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 15,now: 2024-07-07 05:11:37.606335,epoch time: 0:22:12.130311,used: 5:29:08.458508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9830258, 'precision': 0.9852605, 'recall': 0.97092116, 'specificity': 0.97092116, 'f1': 0.97780466, 'auroc': 0.99667025, 'binary_precision': 0.9897585, 'binary_recall': 0.9453404, 'binary_specificity': 0.996502, 'binary_f1_score': 0.96703964}
confusion matrix:
       0      1
0  42162    148
1    827  14303
---- Validation: 
scalar performance:
{'acc': 0.9655356, 'precision': 0.71907943, 'recall': 0.69470555, 'specificity': 0.69470555, 'f1': 0.7060933, 'auroc': 0.8911498, 'binary_precision': 0.4577861, 'binary_recall': 0.4053156, 'binary_specificity': 0.9840955, 'binary_f1_score': 0.42995596}
confusion matrix:
       0    1
0  17882  289
1    358  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93171984, 'precision': 0.62352544, 'recall': 0.69879496, 'specificity': 0.69879496, 'f1': 0.6502284, 'auroc': 0.8745178, 'binary_precision': 0.27, 'binary_recall': 0.446281, 'binary_specificity': 0.95130897, 'binary_f1_score': 0.3364486}
confusion matrix:
      0    1
0  5705  292
1   134  108
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_16.png
early stop counter: 4
val acc:0.965535581111908, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 16,now: 2024-07-07 05:33:38.082295,epoch time: 0:22:00.475960,used: 5:51:08.934468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98335654, 'precision': 0.98451924, 'recall': 0.9724587, 'specificity': 0.9724587, 'f1': 0.97828555, 'auroc': 0.9965892, 'binary_precision': 0.9868765, 'binary_recall': 0.94943154, 'binary_specificity': 0.9954859, 'binary_f1_score': 0.967792}
confusion matrix:
       0      1
0  42121    191
1    765  14363
---- Validation: 
scalar performance:
{'acc': 0.9615938, 'precision': 0.6985097, 'recall': 0.7280035, 'specificity': 0.7280035, 'f1': 0.7121058, 'auroc': 0.89274454, 'binary_precision': 0.41438848, 'binary_recall': 0.47840533, 'binary_specificity': 0.97760165, 'binary_f1_score': 0.4441018}
confusion matrix:
       0    1
0  17764  407
1    314  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9219426, 'precision': 0.6200674, 'recall': 0.74129486, 'specificity': 0.74129486, 'f1': 0.6550016, 'auroc': 0.8708762, 'binary_precision': 0.25933203, 'binary_recall': 0.54545456, 'binary_specificity': 0.9371352, 'binary_f1_score': 0.3515313}
confusion matrix:
      0    1
0  5620  377
1   110  132
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_17.png
early stop counter: 5
val acc:0.9615938067436218, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 17,now: 2024-07-07 05:56:00.258011,epoch time: 0:22:22.175716,used: 6:13:31.110184,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9842967, 'precision': 0.9860081, 'recall': 0.9734398, 'specificity': 0.9734398, 'f1': 0.979504, 'auroc': 0.99702406, 'binary_precision': 0.989473, 'binary_recall': 0.9504957, 'binary_specificity': 0.99638385, 'binary_f1_score': 0.9695928}
confusion matrix:
       0      1
0  42157    153
1    749  14381
---- Validation: 
scalar performance:
{'acc': 0.96532255, 'precision': 0.7181365, 'recall': 0.7002168, 'specificity': 0.7002168, 'f1': 0.70874894, 'auroc': 0.8938872, 'binary_precision': 0.45553538, 'binary_recall': 0.41694352, 'binary_specificity': 0.98349017, 'binary_f1_score': 0.43538594}
confusion matrix:
       0    1
0  17871  300
1    351  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9331624, 'precision': 0.62984943, 'recall': 0.70945907, 'specificity': 0.70945907, 'f1': 0.65812147, 'auroc': 0.87271667, 'binary_precision': 0.2817955, 'binary_recall': 0.46694216, 'binary_specificity': 0.951976, 'binary_f1_score': 0.35147744}
confusion matrix:
      0    1
0  5709  288
1   129  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_18.png
early stop counter: 6
val acc:0.9653225541114807, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 18,now: 2024-07-07 06:18:15.038384,epoch time: 0:22:14.780373,used: 6:35:45.890557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9843663, 'precision': 0.9814272, 'recall': 0.97817874, 'specificity': 0.97817874, 'f1': 0.9797878, 'auroc': 0.996698, 'binary_precision': 0.9752872, 'binary_recall': 0.96510243, 'binary_specificity': 0.99125504, 'binary_f1_score': 0.9701681}
confusion matrix:
       0      1
0  41940    370
1    528  14602
---- Validation: 
scalar performance:
{'acc': 0.9617003, 'precision': 0.6992568, 'recall': 0.7288616, 'specificity': 0.7288616, 'f1': 0.7129044, 'auroc': 0.8957728, 'binary_precision': 0.41582733, 'binary_recall': 0.48006645, 'binary_specificity': 0.9776567, 'binary_f1_score': 0.44564378}
confusion matrix:
       0    1
0  17765  406
1    313  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9224235, 'precision': 0.62303805, 'recall': 0.74947596, 'specificity': 0.74947596, 'f1': 0.65924925, 'auroc': 0.8726547, 'binary_precision': 0.26459143, 'binary_recall': 0.56198347, 'binary_specificity': 0.9369685, 'binary_f1_score': 0.35978833}
confusion matrix:
      0    1
0  5619  378
1   106  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_19.png
early stop counter: 7
val acc:0.9617003202438354, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 19,now: 2024-07-07 06:40:24.849617,epoch time: 0:22:09.811233,used: 6:57:55.701790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98539346, 'precision': 0.98567545, 'recall': 0.97656065, 'specificity': 0.97656065, 'f1': 0.98100173, 'auroc': 0.99683917, 'binary_precision': 0.9862529, 'binary_recall': 0.95789546, 'binary_specificity': 0.99522585, 'binary_f1_score': 0.9718674}
confusion matrix:
       0      1
0  42109    202
1    637  14492
---- Validation: 
scalar performance:
{'acc': 0.96127415, 'precision': 0.69719183, 'recall': 0.73024756, 'specificity': 0.73024756, 'f1': 0.7122759, 'auroc': 0.8947661, 'binary_precision': 0.4115983, 'binary_recall': 0.4833887, 'binary_specificity': 0.9771064, 'binary_f1_score': 0.4446142}
confusion matrix:
       0    1
0  17755  416
1    311  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.917615, 'precision': 0.61459875, 'recall': 0.7430092, 'specificity': 0.7430092, 'f1': 0.6493822, 'auroc': 0.86951613, 'binary_precision': 0.24814814, 'binary_recall': 0.553719, 'binary_specificity': 0.9322995, 'binary_f1_score': 0.342711}
confusion matrix:
      0    1
0  5591  406
1   108  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_20.png
early stop counter: 8
val acc:0.9612741470336914, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 20,now: 2024-07-07 07:02:20.044262,epoch time: 0:21:55.194645,used: 7:19:50.896435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9843315, 'precision': 0.98523104, 'recall': 0.9742701, 'specificity': 0.9742701, 'f1': 0.97958255, 'auroc': 0.99683464, 'binary_precision': 0.98706186, 'binary_recall': 0.9530073, 'binary_specificity': 0.995533, 'binary_f1_score': 0.9697357}
confusion matrix:
       0      1
0  42121    189
1    711  14419
---- Validation: 
scalar performance:
{'acc': 0.9642039, 'precision': 0.7088109, 'recall': 0.69401765, 'specificity': 0.69401765, 'f1': 0.7011105, 'auroc': 0.8942301, 'binary_precision': 0.43727598, 'binary_recall': 0.4053156, 'binary_specificity': 0.9827197, 'binary_f1_score': 0.42068967}
confusion matrix:
       0    1
0  17857  314
1    358  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9296362, 'precision': 0.6218444, 'recall': 0.7056421, 'specificity': 0.7056421, 'f1': 0.650351, 'auroc': 0.86737674, 'binary_precision': 0.26603326, 'binary_recall': 0.46280992, 'binary_specificity': 0.9484742, 'binary_f1_score': 0.33785823}
confusion matrix:
      0    1
0  5688  309
1   130  112
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_21.png
early stop counter: 9
val acc:0.9642038941383362, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 21,now: 2024-07-07 07:24:05.093624,epoch time: 0:21:45.049362,used: 7:41:35.945797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9865773, 'precision': 0.98627734, 'recall': 0.97902143, 'specificity': 0.97902143, 'f1': 0.98257554, 'auroc': 0.99728405, 'binary_precision': 0.9856592, 'binary_recall': 0.9630535, 'binary_specificity': 0.99498934, 'binary_f1_score': 0.9742252}
confusion matrix:
       0      1
0  42098    212
1    559  14571
---- Validation: 
scalar performance:
{'acc': 0.9647366, 'precision': 0.7140337, 'recall': 0.7023233, 'specificity': 0.7023233, 'f1': 0.70799464, 'auroc': 0.89646214, 'binary_precision': 0.4471831, 'binary_recall': 0.42192692, 'binary_specificity': 0.9827197, 'binary_f1_score': 0.43418807}
confusion matrix:
       0    1
0  17857  314
1    348  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93348294, 'precision': 0.6292982, 'recall': 0.70566034, 'specificity': 0.70566034, 'f1': 0.6567305, 'auroc': 0.8691571, 'binary_precision': 0.28101265, 'binary_recall': 0.45867768, 'binary_specificity': 0.952643, 'binary_f1_score': 0.34850863}
confusion matrix:
      0    1
0  5713  284
1   131  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_22.png
early stop counter: 10
val acc:0.9647365808486938, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 22,now: 2024-07-07 07:46:01.104178,epoch time: 0:21:56.010554,used: 8:03:31.956351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9867514, 'precision': 0.98629063, 'recall': 0.9794569, 'specificity': 0.9794569, 'f1': 0.9828083, 'auroc': 0.99739814, 'binary_precision': 0.9853398, 'binary_recall': 0.96404254, 'binary_specificity': 0.9948713, 'binary_f1_score': 0.97457486}
confusion matrix:
       0      1
0  42094    217
1    544  14585
---- Validation: 
scalar performance:
{'acc': 0.95919675, 'precision': 0.6892661, 'recall': 0.7428262, 'specificity': 0.7428262, 'f1': 0.7122748, 'auroc': 0.8988893, 'binary_precision': 0.3948718, 'binary_recall': 0.5116279, 'binary_specificity': 0.97402453, 'binary_f1_score': 0.44573084}
confusion matrix:
       0    1
0  17699  472
1    294  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9163327, 'precision': 0.6138689, 'recall': 0.74630773, 'specificity': 0.74630773, 'f1': 0.64894634, 'auroc': 0.8682909, 'binary_precision': 0.24637681, 'binary_recall': 0.56198347, 'binary_specificity': 0.930632, 'binary_f1_score': 0.34256926}
confusion matrix:
      0    1
0  5581  416
1   106  136
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_23.png
early stop counter: 11
val acc:0.9591967463493347, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 23,now: 2024-07-07 08:08:07.086449,epoch time: 0:22:05.982271,used: 8:25:37.938622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.985672, 'precision': 0.98331535, 'recall': 0.9796595, 'specificity': 0.9796595, 'f1': 0.98146844, 'auroc': 0.9975046, 'binary_precision': 0.978399, 'binary_recall': 0.9669531, 'binary_specificity': 0.9923659, 'binary_f1_score': 0.97264236}
confusion matrix:
       0      1
0  41987    323
1    500  14630
---- Validation: 
scalar performance:
{'acc': 0.9626059, 'precision': 0.7059307, 'recall': 0.7381629, 'specificity': 0.7381629, 'f1': 0.72073036, 'auroc': 0.9009893, 'binary_precision': 0.42857143, 'binary_recall': 0.49833888, 'binary_specificity': 0.97798693, 'binary_f1_score': 0.46082953}
confusion matrix:
       0    1
0  17771  400
1    302  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92691135, 'precision': 0.62339973, 'recall': 0.7260349, 'specificity': 0.7260349, 'f1': 0.65585226, 'auroc': 0.8713765, 'binary_precision': 0.2673913, 'binary_recall': 0.5082645, 'binary_specificity': 0.9438052, 'binary_f1_score': 0.3504274}
confusion matrix:
      0    1
0  5660  337
1   119  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_24.png
early stop counter: 12
val acc:0.962605893611908, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 24,now: 2024-07-07 08:30:09.272187,epoch time: 0:22:02.185738,used: 8:47:40.124360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9861769, 'precision': 0.9864324, 'recall': 0.9778368, 'specificity': 0.9778368, 'f1': 0.9820312, 'auroc': 0.9973289, 'binary_precision': 0.98695654, 'binary_recall': 0.9602115, 'binary_specificity': 0.99546206, 'binary_f1_score': 0.9734003}
confusion matrix:
       0      1
0  42118    192
1    602  14528
---- Validation: 
scalar performance:
{'acc': 0.9613807, 'precision': 0.69895846, 'recall': 0.73672694, 'specificity': 0.73672694, 'f1': 0.71599406, 'auroc': 0.9015996, 'binary_precision': 0.4147018, 'binary_recall': 0.49667773, 'binary_specificity': 0.9767762, 'binary_f1_score': 0.45200303}
confusion matrix:
       0    1
0  17749  422
1    303  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92514825, 'precision': 0.6190687, 'recall': 0.72115225, 'specificity': 0.72115225, 'f1': 0.65082264, 'auroc': 0.86823165, 'binary_precision': 0.25910065, 'binary_recall': 0.5, 'binary_specificity': 0.9423045, 'binary_f1_score': 0.3413258}
confusion matrix:
      0    1
0  5651  346
1   121  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_25.png
early stop counter: 13
val acc:0.9613807201385498, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 25,now: 2024-07-07 08:52:25.149518,epoch time: 0:22:15.877331,used: 9:09:56.001691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98633355, 'precision': 0.98808265, 'recall': 0.97664815, 'specificity': 0.97664815, 'f1': 0.98218405, 'auroc': 0.99741, 'binary_precision': 0.9916375, 'binary_recall': 0.9561798, 'binary_specificity': 0.9971165, 'binary_f1_score': 0.97358596}
confusion matrix:
       0      1
0  42188    122
1    663  14467
---- Validation: 
scalar performance:
{'acc': 0.9665477, 'precision': 0.7283595, 'recall': 0.7040619, 'specificity': 0.7040619, 'f1': 0.71545285, 'auroc': 0.89960825, 'binary_precision': 0.47574627, 'binary_recall': 0.42358804, 'binary_specificity': 0.9845358, 'binary_f1_score': 0.44815466}
confusion matrix:
       0    1
0  17890  281
1    347  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9422985, 'precision': 0.6472008, 'recall': 0.69438404, 'specificity': 0.69438404, 'f1': 0.666868, 'auroc': 0.8677238, 'binary_precision': 0.31790122, 'binary_recall': 0.42561984, 'binary_specificity': 0.96314824, 'binary_f1_score': 0.36395755}
confusion matrix:
      0    1
0  5776  221
1   139  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_26.png
early stop counter: 14
val acc:0.9665477275848389, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 26,now: 2024-07-07 09:14:34.720964,epoch time: 0:22:09.571446,used: 9:32:05.573137,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9862465, 'precision': 0.9851333, 'recall': 0.97930646, 'specificity': 0.97930646, 'f1': 0.982172, 'auroc': 0.99758023, 'binary_precision': 0.98282826, 'binary_recall': 0.9646398, 'binary_specificity': 0.9939731, 'binary_f1_score': 0.9736491}
confusion matrix:
       0      1
0  42055    255
1    535  14595
---- Validation: 
scalar performance:
{'acc': 0.96042186, 'precision': 0.69787335, 'recall': 0.75791395, 'specificity': 0.75791395, 'f1': 0.72341543, 'auroc': 0.9030711, 'binary_precision': 0.4110971, 'binary_recall': 0.5415282, 'binary_specificity': 0.9742997, 'binary_f1_score': 0.4673835}
confusion matrix:
       0    1
0  17704  467
1    276  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92322487, 'precision': 0.6232557, 'recall': 0.74592733, 'specificity': 0.74592733, 'f1': 0.6589682, 'auroc': 0.87203604, 'binary_precision': 0.26534653, 'binary_recall': 0.553719, 'binary_specificity': 0.93813574, 'binary_f1_score': 0.3587684}
confusion matrix:
      0    1
0  5626  371
1   108  134
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_27.png
early stop counter: 15
val acc:0.9604218602180481, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 27,now: 2024-07-07 09:36:47.314998,epoch time: 0:22:12.594034,used: 9:54:18.167171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9872214, 'precision': 0.98778045, 'recall': 0.97920275, 'specificity': 0.97920275, 'f1': 0.9833891, 'auroc': 0.99779594, 'binary_precision': 0.98892736, 'binary_recall': 0.9622579, 'binary_specificity': 0.9961476, 'binary_f1_score': 0.9754104}
confusion matrix:
       0      1
0  42148    163
1    571  14558
---- Validation: 
scalar performance:
{'acc': 0.96399087, 'precision': 0.71366215, 'recall': 0.73486304, 'specificity': 0.73486304, 'f1': 0.72370094, 'auroc': 0.9027776, 'binary_precision': 0.4442771, 'binary_recall': 0.4900332, 'binary_specificity': 0.97969294, 'binary_f1_score': 0.46603474}
confusion matrix:
       0    1
0  17802  369
1    307  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9350858, 'precision': 0.63665676, 'recall': 0.7183905, 'specificity': 0.7183905, 'f1': 0.6659941, 'auroc': 0.8695477, 'binary_precision': 0.29471034, 'binary_recall': 0.48347107, 'binary_specificity': 0.95331, 'binary_f1_score': 0.36619717}
confusion matrix:
      0    1
0  5717  280
1   125  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_28.png
early stop counter: 16
val acc:0.9639908671379089, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 28,now: 2024-07-07 09:59:00.960461,epoch time: 0:22:13.645463,used: 10:16:31.812634,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98791784, 'precision': 0.98789066, 'recall': 0.9808867, 'specificity': 0.9808867, 'f1': 0.98432016, 'auroc': 0.99797297, 'binary_precision': 0.9878346, 'binary_recall': 0.96602774, 'binary_specificity': 0.99574566, 'binary_f1_score': 0.9768095}
confusion matrix:
       0      1
0  42130    180
1    514  14616
---- Validation: 
scalar performance:
{'acc': 0.9635114, 'precision': 0.71115625, 'recall': 0.7378276, 'specificity': 0.7378276, 'f1': 0.72360265, 'auroc': 0.9030485, 'binary_precision': 0.4390602, 'binary_recall': 0.49667773, 'binary_specificity': 0.9789775, 'binary_f1_score': 0.4660951}
confusion matrix:
       0    1
0  17789  382
1    303  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93412405, 'precision': 0.63682103, 'recall': 0.72582126, 'specificity': 0.72582126, 'f1': 0.6679202, 'auroc': 0.8686706, 'binary_precision': 0.29440388, 'binary_recall': 0.5, 'binary_specificity': 0.9516425, 'binary_f1_score': 0.3705972}
confusion matrix:
      0    1
0  5707  290
1   121  121
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_29.png
early stop counter: 17
val acc:0.9635114073753357, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 29,now: 2024-07-07 10:20:56.521641,epoch time: 0:21:55.561180,used: 10:38:27.373814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9884053, 'precision': 0.9878632, 'recall': 0.98217195, 'specificity': 0.98217195, 'f1': 0.98497224, 'auroc': 0.99794817, 'binary_precision': 0.98674023, 'binary_recall': 0.9689999, 'binary_specificity': 0.995344, 'binary_f1_score': 0.9777896}
confusion matrix:
       0      1
0  42114    197
1    469  14660
---- Validation: 
scalar performance:
{'acc': 0.9619134, 'precision': 0.70336664, 'recall': 0.74583566, 'specificity': 0.74583566, 'f1': 0.72233707, 'auroc': 0.90144664, 'binary_precision': 0.4229195, 'binary_recall': 0.51495016, 'binary_specificity': 0.97672117, 'binary_f1_score': 0.46441948}
confusion matrix:
       0    1
0  17748  423
1    292  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92691135, 'precision': 0.62685543, 'recall': 0.7379313, 'specificity': 0.7379313, 'f1': 0.6612911, 'auroc': 0.8674673, 'binary_precision': 0.2733051, 'binary_recall': 0.53305787, 'binary_specificity': 0.94280475, 'binary_f1_score': 0.36134455}
confusion matrix:
      0    1
0  5654  343
1   113  129
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716430_30.png
early stop counter: 18
val acc:0.9619134068489075, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.94342041015625 / 0.9501522779464722
after epoch: 30,now: 2024-07-07 10:43:20.172356,epoch time: 0:22:23.650715,used: 11:00:51.024529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_23_42_29_seed_2_21716430
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:00:51.024529 at 2024-07-07 10:43:20.172356
persisted model performance metric: 

scalar performance:
{'acc': 0.9434204, 'precision': 0.64813685, 'recall': 0.6870367, 'specificity': 0.6870367, 'f1': 0.664875, 'auroc': 0.87919545, 'binary_precision': 0.32038835, 'binary_recall': 0.4090909, 'binary_specificity': 0.9649825, 'binary_f1_score': 0.35934666}
confusion matrix:
      0    1
0  5787  210
1   143   99
oracle model performance metric: 

scalar performance:
{'acc': 0.9501523, 'precision': 0.6176436, 'recall': 0.5735567, 'specificity': 0.5735567, 'f1': 0.5894367, 'auroc': 0.83195245, 'binary_precision': 0.26845637, 'binary_recall': 0.16528925, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.20460358}
confusion matrix:
      0    1
0  5888  109
1   202   40
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |  17485 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |  17485 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   7827 MiB |   3575 TiB |   3575 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   3529 TiB |   3529 TiB |
|       from small pool |  16481 KiB |     36 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8530 MiB |  25070 MiB |  16560 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  25000 MiB |  16528 MiB |
|       from small pool |     38 MiB |     44 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40872 KiB | 732464 KiB |   1938 TiB |   1938 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1892 TiB |   1892 TiB |
|       from small pool |   9139 KiB |  23272 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7675    |  590644 K  |  590641 K  |
|       from large pool |      79    |     762    |  335133 K  |  335133 K  |
|       from small pool |    2887    |    7594    |  255510 K  |  255507 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7675    |  590644 K  |  590641 K  |
|       from large pool |      79    |     762    |  335133 K  |  335133 K  |
|       from small pool |    2887    |    7594    |  255510 K  |  255507 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     371    |    1060    |     693    |
|       from large pool |     348    |     349    |    1025    |     677    |
|       from small pool |      19    |      22    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3612    |  346529 K  |  346529 K  |
|       from large pool |      11    |     352    |  238274 K  |  238274 K  |
|       from small pool |      24    |    3602    |  108255 K  |  108255 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |      0 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |      0 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   3575 TiB |   3575 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   3529 TiB |   3529 TiB |
|       from small pool |      0 KiB |     36 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  25070 MiB |  24838 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25000 MiB |  24794 MiB |
|       from small pool |  26624 KiB |     44 MiB |     70 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1938 TiB |   1938 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1892 TiB |   1892 TiB |
|       from small pool |      0 KiB |  23272 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7675    |  590644 K  |  590644 K  |
|       from large pool |       2    |     762    |  335133 K  |  335133 K  |
|       from small pool |       0    |    7594    |  255510 K  |  255510 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7675    |  590644 K  |  590644 K  |
|       from large pool |       2    |     762    |  335133 K  |  335133 K  |
|       from small pool |       0    |    7594    |  255510 K  |  255510 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1060    |    1037    |
|       from large pool |      10    |     349    |    1025    |    1015    |
|       from small pool |      13    |      22    |      35    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |  346530 K  |  346530 K  |
|       from large pool |       3    |     352    |  238274 K  |  238274 K  |
|       from small pool |       0    |    3602    |  108256 K  |  108256 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sun Jul  7 10:44:39 2024]
Finished job 0.
1 of 1 steps (100%) done
