Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul  6 16:03:15 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437

 Experiment start at: 2024-07-06 16:09:40.979402
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93886745, 'precision': 0.9591037, 'recall': 0.8833487, 'specificity': 0.8833487, 'f1': 0.91340786, 'auroc': 0.9639944, 'binary_precision': 0.9928032, 'binary_recall': 0.7686349, 'binary_specificity': 0.9980625, 'binary_f1_score': 0.8664547}
confusion matrix:
       0      1
0  42241     82
1   3405  11312
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.95333123, 'precision': 0.5287843, 'recall': 0.5130548, 'specificity': 0.5130548, 'f1': 0.5160242, 'auroc': 0.7850245, 'binary_precision': 0.09090909, 'binary_recall': 0.04043546, 'binary_specificity': 0.98567414, 'binary_f1_score': 0.055974163}
confusion matrix:
       0    1
0  17889  260
1    617   26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95190156, 'precision': 0.58298963, 'recall': 0.5223177, 'specificity': 0.5223177, 'f1': 0.530204, 'auroc': 0.82448316, 'binary_precision': 0.20588236, 'binary_recall': 0.053639848, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.08510639}
confusion matrix:
      0   1
0  5943  54
1   247  14
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-06 16:33:30.848417,epoch time: 0:23:49.869015,used: 0:23:49.869015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95368165, 'precision': 0.96610165, 'recall': 0.91352534, 'specificity': 0.91352534, 'f1': 0.936051, 'auroc': 0.98227143, 'binary_precision': 0.9880375, 'binary_recall': 0.83054763, 'binary_specificity': 0.996503, 'binary_f1_score': 0.9024733}
confusion matrix:
       0      1
0  42174    148
1   2494  12224
---- Validation: 
scalar performance:
{'acc': 0.95391655, 'precision': 0.6119646, 'recall': 0.5793627, 'specificity': 0.5793627, 'f1': 0.59233844, 'auroc': 0.84714353, 'binary_precision': 0.25277162, 'binary_recall': 0.17729394, 'binary_specificity': 0.9814315, 'binary_f1_score': 0.2084095}
confusion matrix:
       0    1
0  17812  337
1    529  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.70051175, 'recall': 0.61202055, 'specificity': 0.61202055, 'f1': 0.64190656, 'auroc': 0.8795496, 'binary_precision': 0.43356642, 'binary_recall': 0.23754789, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.3069307}
confusion matrix:
      0   1
0  5916  81
1   199  62
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-06 16:56:40.516318,epoch time: 0:23:09.667901,used: 0:46:59.536916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9603261, 'precision': 0.96887577, 'recall': 0.9275435, 'specificity': 0.9275435, 'f1': 0.94587827, 'auroc': 0.9859923, 'binary_precision': 0.98443943, 'binary_recall': 0.85981244, 'binary_specificity': 0.99527454, 'binary_f1_score': 0.91791505}
confusion matrix:
       0      1
0  42124    200
1   2063  12653
---- Validation: 
scalar performance:
{'acc': 0.95530015, 'precision': 0.65652597, 'recall': 0.64758396, 'specificity': 0.64758396, 'f1': 0.65190274, 'auroc': 0.87273085, 'binary_precision': 0.3371901, 'binary_recall': 0.31726283, 'binary_specificity': 0.9779051, 'binary_f1_score': 0.32692307}
confusion matrix:
       0    1
0  17748  401
1    439  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.751724, 'recall': 0.70988655, 'specificity': 0.70988655, 'f1': 0.72865236, 'auroc': 0.8976027, 'binary_precision': 0.5277778, 'binary_recall': 0.43678162, 'binary_specificity': 0.9829915, 'binary_f1_score': 0.4779874}
confusion matrix:
      0    1
0  5895  102
1   147  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-06 17:19:55.144163,epoch time: 0:23:14.627845,used: 1:10:14.164761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9651648, 'precision': 0.96869636, 'recall': 0.9398022, 'specificity': 0.9398022, 'f1': 0.9530947, 'auroc': 0.9871139, 'binary_precision': 0.9753529, 'binary_recall': 0.88740146, 'binary_specificity': 0.992203, 'binary_f1_score': 0.92930084}
confusion matrix:
       0      1
0  41994    330
1   1657  13059
---- Validation: 
scalar performance:
{'acc': 0.95285225, 'precision': 0.662949, 'recall': 0.69882053, 'specificity': 0.69882053, 'f1': 0.6788194, 'auroc': 0.8841703, 'binary_precision': 0.34639695, 'binary_recall': 0.42612752, 'binary_specificity': 0.97151357, 'binary_f1_score': 0.38214785}
confusion matrix:
       0    1
0  17632  517
1    369  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.7592869, 'recall': 0.7857626, 'specificity': 0.7857626, 'f1': 0.7717898, 'auroc': 0.9049186, 'binary_precision': 0.5363322, 'binary_recall': 0.59386975, 'binary_specificity': 0.9776555, 'binary_f1_score': 0.56363636}
confusion matrix:
      0    1
0  5863  134
1   106  155
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_4.png
new oracle model saved
early stop counter: 1
val acc:0.9528522491455078, best validation acc: 0.9553001523017883, corresponding to test acc:                         0.960210919380188 / 0.9616490602493286
after epoch: 4,now: 2024-07-06 17:42:59.645453,epoch time: 0:23:04.501290,used: 1:33:18.666051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96921456, 'precision': 0.971804, 'recall': 0.94734055, 'specificity': 0.94734055, 'f1': 0.9587476, 'auroc': 0.9905158, 'binary_precision': 0.976751, 'binary_recall': 0.9021473, 'binary_specificity': 0.9925338, 'binary_f1_score': 0.937968}
confusion matrix:
       0      1
0  42008    316
1   1440  13276
---- Validation: 
scalar performance:
{'acc': 0.95455515, 'precision': 0.6717144, 'recall': 0.70495254, 'specificity': 0.70495254, 'f1': 0.68664026, 'auroc': 0.89030087, 'binary_precision': 0.36351874, 'binary_recall': 0.43701398, 'binary_specificity': 0.9728911, 'binary_f1_score': 0.39689264}
confusion matrix:
       0    1
0  17657  492
1    362  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.76428354, 'recall': 0.80275387, 'specificity': 0.80275387, 'f1': 0.78202736, 'auroc': 0.90736115, 'binary_precision': 0.54485047, 'binary_recall': 0.62835246, 'binary_specificity': 0.97715527, 'binary_f1_score': 0.58362985}
confusion matrix:
      0    1
0  5860  137
1    97  164
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_5.png
new oracle model saved
early stop counter: 2
val acc:0.9545551538467407, best validation acc: 0.9553001523017883, corresponding to test acc:                         0.960210919380188 / 0.9626078605651855
after epoch: 5,now: 2024-07-06 18:06:15.417255,epoch time: 0:23:15.771802,used: 1:56:34.437853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9699334, 'precision': 0.9724405, 'recall': 0.94859743, 'specificity': 0.94859743, 'f1': 0.95973647, 'auroc': 0.9905395, 'binary_precision': 0.9772394, 'binary_recall': 0.9045192, 'binary_specificity': 0.9926757, 'binary_f1_score': 0.93947417}
confusion matrix:
       0      1
0  42015    310
1   1405  13310
---- Validation: 
scalar performance:
{'acc': 0.95423585, 'precision': 0.67609334, 'recall': 0.7272889, 'specificity': 0.7272889, 'f1': 0.6979408, 'auroc': 0.894755, 'binary_precision': 0.37067938, 'binary_recall': 0.4836703, 'binary_specificity': 0.9709075, 'binary_f1_score': 0.4197031}
confusion matrix:
       0    1
0  17621  528
1    332  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7515546, 'recall': 0.81799424, 'specificity': 0.81799424, 'f1': 0.78031254, 'auroc': 0.91181225, 'binary_precision': 0.51796407, 'binary_recall': 0.66283524, 'binary_specificity': 0.97315323, 'binary_f1_score': 0.58151263}
confusion matrix:
      0    1
0  5836  161
1    88  173
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_6.png
early stop counter: 3
val acc:0.954235851764679, best validation acc: 0.9553001523017883, corresponding to test acc:                         0.960210919380188 / 0.9626078605651855
after epoch: 6,now: 2024-07-06 18:29:28.102961,epoch time: 0:23:12.685706,used: 2:19:47.123559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9737377, 'precision': 0.9764366, 'recall': 0.95469654, 'specificity': 0.95469654, 'f1': 0.96492124, 'auroc': 0.9921913, 'binary_precision': 0.9816393, 'binary_recall': 0.9153475, 'binary_specificity': 0.9940455, 'binary_f1_score': 0.94733506}
confusion matrix:
       0      1
0  42069    252
1   1246  13473
---- Validation: 
scalar performance:
{'acc': 0.9550341, 'precision': 0.6808569, 'recall': 0.7337026, 'specificity': 0.7337026, 'f1': 0.7034012, 'auroc': 0.89894617, 'binary_precision': 0.3797619, 'binary_recall': 0.496112, 'binary_specificity': 0.9712932, 'binary_f1_score': 0.43020904}
confusion matrix:
       0    1
0  17628  521
1    324  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.74629015, 'recall': 0.81924295, 'specificity': 0.81924295, 'f1': 0.777334, 'auroc': 0.91333836, 'binary_precision': 0.50728863, 'binary_recall': 0.6666667, 'binary_specificity': 0.9718192, 'binary_f1_score': 0.57615894}
confusion matrix:
      0    1
0  5828  169
1    87  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_7.png
early stop counter: 4
val acc:0.955034077167511, best validation acc: 0.9553001523017883, corresponding to test acc:                         0.960210919380188 / 0.9626078605651855
after epoch: 7,now: 2024-07-06 18:52:34.910510,epoch time: 0:23:06.807549,used: 2:42:53.931108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9759818, 'precision': 0.9735455, 'recall': 0.96334076, 'specificity': 0.96334076, 'f1': 0.9682978, 'auroc': 0.99311686, 'binary_precision': 0.9686798, 'binary_recall': 0.93721974, 'binary_specificity': 0.9894617, 'binary_f1_score': 0.9526901}
confusion matrix:
       0      1
0  41876    446
1    924  13794
---- Validation: 
scalar performance:
{'acc': 0.949553, 'precision': 0.66781765, 'recall': 0.76236725, 'specificity': 0.76236725, 'f1': 0.70296943, 'auroc': 0.90346503, 'binary_precision': 0.35150924, 'binary_recall': 0.5614308, 'binary_specificity': 0.96330374, 'binary_f1_score': 0.43233535}
confusion matrix:
       0    1
0  17483  666
1    282  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495046, 'precision': 0.71160114, 'recall': 0.83806074, 'specificity': 0.83806074, 'f1': 0.7576541, 'auroc': 0.915822, 'binary_precision': 0.43589744, 'binary_recall': 0.71647507, 'binary_specificity': 0.95964646, 'binary_f1_score': 0.542029}
confusion matrix:
      0    1
0  5755  242
1    74  187
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_8.png
early stop counter: 5
val acc:0.9495530128479004, best validation acc: 0.9553001523017883, corresponding to test acc:                         0.960210919380188 / 0.9626078605651855
after epoch: 8,now: 2024-07-06 19:15:43.084357,epoch time: 0:23:08.173847,used: 3:06:02.104955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9768759, 'precision': 0.9745502, 'recall': 0.9646889, 'specificity': 0.9646889, 'f1': 0.96948415, 'auroc': 0.9933276, 'binary_precision': 0.9699011, 'binary_recall': 0.9395134, 'binary_specificity': 0.9898644, 'binary_f1_score': 0.9544654}
confusion matrix:
       0      1
0  41897    429
1    890  13824
---- Validation: 
scalar performance:
{'acc': 0.94524264, 'precision': 0.65868986, 'recall': 0.7758869, 'specificity': 0.7758869, 'f1': 0.69867563, 'auroc': 0.9058123, 'binary_precision': 0.3321739, 'binary_recall': 0.5940902, 'binary_specificity': 0.9576836, 'binary_f1_score': 0.4261015}
confusion matrix:
       0    1
0  17381  768
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9403963, 'precision': 0.68879616, 'recall': 0.8497994, 'specificity': 0.8497994, 'f1': 0.74033815, 'auroc': 0.917377, 'binary_precision': 0.3888889, 'binary_recall': 0.75095785, 'binary_specificity': 0.948641, 'binary_f1_score': 0.51241827}
confusion matrix:
      0    1
0  5689  308
1    65  196
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_9.png
early stop counter: 6
val acc:0.9452426433563232, best validation acc: 0.9553001523017883, corresponding to test acc:                         0.960210919380188 / 0.9626078605651855
after epoch: 9,now: 2024-07-06 19:38:35.453405,epoch time: 0:22:52.369048,used: 3:28:54.474003,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9752454, 'precision': 0.9785964, 'recall': 0.9565657, 'specificity': 0.9565657, 'f1': 0.9669227, 'auroc': 0.99360013, 'binary_precision': 0.9850507, 'binary_recall': 0.9179748, 'binary_specificity': 0.9951565, 'binary_f1_score': 0.9503307}
confusion matrix:
       0      1
0  42120    205
1   1207  13508
---- Validation: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.6928921, 'recall': 0.7196595, 'specificity': 0.7196595, 'f1': 0.7052852, 'auroc': 0.89883804, 'binary_precision': 0.4048913, 'binary_recall': 0.46345258, 'binary_specificity': 0.97586644, 'binary_f1_score': 0.43219724}
confusion matrix:
       0    1
0  17711  438
1    345  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.74529296, 'recall': 0.8118303, 'specificity': 0.8118303, 'f1': 0.773976, 'auroc': 0.9139838, 'binary_precision': 0.50595236, 'binary_recall': 0.651341, 'binary_specificity': 0.9723195, 'binary_f1_score': 0.5695143}
confusion matrix:
      0    1
0  5831  166
1    91  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_10.png
better model found
persisted
after epoch: 10,now: 2024-07-06 20:01:32.765314,epoch time: 0:22:57.311909,used: 3:51:51.785912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97992635, 'precision': 0.9794471, 'recall': 0.9678583, 'specificity': 0.9678583, 'f1': 0.97346866, 'auroc': 0.99495625, 'binary_precision': 0.97849387, 'binary_recall': 0.9429231, 'binary_specificity': 0.9927935, 'binary_f1_score': 0.96037924}
confusion matrix:
       0      1
0  42018    305
1    840  13877
---- Validation: 
scalar performance:
{'acc': 0.9484887, 'precision': 0.66532207, 'recall': 0.7655666, 'specificity': 0.7655666, 'f1': 0.7018062, 'auroc': 0.9062637, 'binary_precision': 0.34626302, 'binary_recall': 0.56920683, 'binary_specificity': 0.9619263, 'binary_f1_score': 0.43058822}
confusion matrix:
       0    1
0  17458  691
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94215405, 'precision': 0.69105655, 'recall': 0.8378902, 'specificity': 0.8378902, 'f1': 0.7400352, 'auroc': 0.91763777, 'binary_precision': 0.39457202, 'binary_recall': 0.7241379, 'binary_specificity': 0.9516425, 'binary_f1_score': 0.5108108}
confusion matrix:
      0    1
0  5707  290
1    72  189
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_11.png
early stop counter: 1
val acc:0.948488712310791, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 11,now: 2024-07-06 20:24:31.588077,epoch time: 0:22:58.822763,used: 4:14:50.608675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9791199, 'precision': 0.9811605, 'recall': 0.9641282, 'specificity': 0.9641282, 'f1': 0.9722511, 'auroc': 0.9949348, 'binary_precision': 0.9851528, 'binary_recall': 0.9331476, 'binary_specificity': 0.9951088, 'binary_f1_score': 0.9584453}
confusion matrix:
       0      1
0  42114    207
1    984  13735
---- Validation: 
scalar performance:
{'acc': 0.9527991, 'precision': 0.67667854, 'recall': 0.753547, 'specificity': 0.753547, 'f1': 0.707163, 'auroc': 0.9045253, 'binary_precision': 0.36993605, 'binary_recall': 0.53965783, 'binary_specificity': 0.9674362, 'binary_f1_score': 0.4389627}
confusion matrix:
       0    1
0  17558  591
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9487057, 'precision': 0.7081015, 'recall': 0.8303146, 'specificity': 0.8303146, 'f1': 0.75280714, 'auroc': 0.9154769, 'binary_precision': 0.42957747, 'binary_recall': 0.7011494, 'binary_specificity': 0.95947975, 'binary_f1_score': 0.5327511}
confusion matrix:
      0    1
0  5754  243
1    78  183
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_12.png
early stop counter: 2
val acc:0.9527990818023682, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 12,now: 2024-07-06 20:47:30.772032,epoch time: 0:22:59.183955,used: 4:37:49.792630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9804523, 'precision': 0.98042333, 'recall': 0.9682811, 'specificity': 0.9682811, 'f1': 0.9741508, 'auroc': 0.9951358, 'binary_precision': 0.9803659, 'binary_recall': 0.94313085, 'binary_specificity': 0.9934313, 'binary_f1_score': 0.96138793}
confusion matrix:
       0      1
0  42044    278
1    837  13881
---- Validation: 
scalar performance:
{'acc': 0.9477437, 'precision': 0.66340184, 'recall': 0.76668096, 'specificity': 0.76668096, 'f1': 0.7005127, 'auroc': 0.909155, 'binary_precision': 0.34232557, 'binary_recall': 0.57231724, 'binary_specificity': 0.96104467, 'binary_f1_score': 0.4284051}
confusion matrix:
       0    1
0  17442  707
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94183445, 'precision': 0.691448, 'recall': 0.84505284, 'specificity': 0.84505284, 'f1': 0.74186504, 'auroc': 0.9177611, 'binary_precision': 0.39468303, 'binary_recall': 0.7394636, 'binary_specificity': 0.950642, 'binary_f1_score': 0.5146667}
confusion matrix:
      0    1
0  5701  296
1    68  193
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_13.png
early stop counter: 3
val acc:0.9477437138557434, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 13,now: 2024-07-06 21:10:50.161089,epoch time: 0:23:19.389057,used: 5:01:09.181687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98080295, 'precision': 0.9782783, 'recall': 0.97135055, 'specificity': 0.97135055, 'f1': 0.974748, 'auroc': 0.99522793, 'binary_precision': 0.9731814, 'binary_recall': 0.95182115, 'binary_specificity': 0.9908799, 'binary_f1_score': 0.9623828}
confusion matrix:
       0      1
0  41938    386
1    709  14007
---- Validation: 
scalar performance:
{'acc': 0.9419434, 'precision': 0.653331, 'recall': 0.7876798, 'specificity': 0.7876798, 'f1': 0.6962452, 'auroc': 0.9108592, 'binary_precision': 0.32051283, 'binary_recall': 0.62208396, 'binary_specificity': 0.9532757, 'binary_f1_score': 0.4230566}
confusion matrix:
       0    1
0  17301  848
1    243  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9298498, 'precision': 0.66938144, 'recall': 0.8607877, 'specificity': 0.8607877, 'f1': 0.72264683, 'auroc': 0.9182075, 'binary_precision': 0.34863946, 'binary_recall': 0.7854406, 'binary_specificity': 0.93613476, 'binary_f1_score': 0.48292112}
confusion matrix:
      0    1
0  5614  383
1    56  205
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_14.png
early stop counter: 4
val acc:0.9419434070587158, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 14,now: 2024-07-06 21:33:47.871253,epoch time: 0:22:57.710164,used: 5:24:06.891851,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98239833, 'precision': 0.98343337, 'recall': 0.97043085, 'specificity': 0.97043085, 'f1': 0.9767033, 'auroc': 0.99577415, 'binary_precision': 0.98548365, 'binary_recall': 0.94570535, 'binary_specificity': 0.9951564, 'binary_f1_score': 0.9651848}
confusion matrix:
       0      1
0  42119    205
1    799  13917
---- Validation: 
scalar performance:
{'acc': 0.9543955, 'precision': 0.68169194, 'recall': 0.74912316, 'specificity': 0.74912316, 'f1': 0.7093229, 'auroc': 0.9068351, 'binary_precision': 0.3803132, 'binary_recall': 0.5287714, 'binary_specificity': 0.9694749, 'binary_f1_score': 0.44242033}
confusion matrix:
       0    1
0  17595  554
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9485459, 'precision': 0.70907533, 'recall': 0.8412252, 'specificity': 0.8412252, 'f1': 0.75637436, 'auroc': 0.9169904, 'binary_precision': 0.43052393, 'binary_recall': 0.7241379, 'binary_specificity': 0.9583125, 'binary_f1_score': 0.53999996}
confusion matrix:
      0    1
0  5747  250
1    72  189
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_15.png
early stop counter: 5
val acc:0.9543954730033875, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 15,now: 2024-07-06 21:57:09.113073,epoch time: 0:23:21.241820,used: 5:47:28.133671,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9815217, 'precision': 0.9815022, 'recall': 0.97001755, 'specificity': 0.97001755, 'f1': 0.97558004, 'auroc': 0.9957628, 'binary_precision': 0.9814632, 'binary_recall': 0.946249, 'binary_specificity': 0.99378604, 'binary_f1_score': 0.9635345}
confusion matrix:
       0      1
0  42061    263
1    791  13925
---- Validation: 
scalar performance:
{'acc': 0.9459344, 'precision': 0.6593796, 'recall': 0.77099466, 'specificity': 0.77099466, 'f1': 0.6981615, 'auroc': 0.90659356, 'binary_precision': 0.33392698, 'binary_recall': 0.58320373, 'binary_specificity': 0.9587856, 'binary_f1_score': 0.42468858}
confusion matrix:
       0    1
0  17401  748
1    268  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93144774, 'precision': 0.67034876, 'recall': 0.8506274, 'specificity': 0.8506274, 'f1': 0.7222782, 'auroc': 0.9149832, 'binary_precision': 0.3515901, 'binary_recall': 0.7624521, 'binary_specificity': 0.9388027, 'binary_f1_score': 0.4812575}
confusion matrix:
      0    1
0  5630  367
1    62  199
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_16.png
early stop counter: 6
val acc:0.9459344148635864, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 16,now: 2024-07-06 22:22:42.710932,epoch time: 0:25:33.597859,used: 6:13:01.731530,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98331, 'precision': 0.98247147, 'recall': 0.97374904, 'specificity': 0.97374904, 'f1': 0.9780064, 'auroc': 0.9964879, 'binary_precision': 0.98078805, 'binary_recall': 0.95399565, 'binary_specificity': 0.9935025, 'binary_f1_score': 0.9672063}
confusion matrix:
       0      1
0  42049    275
1    677  14039
---- Validation: 
scalar performance:
{'acc': 0.9469987, 'precision': 0.66344124, 'recall': 0.77604604, 'specificity': 0.77604604, 'f1': 0.70282304, 'auroc': 0.90851676, 'binary_precision': 0.34170404, 'binary_recall': 0.592535, 'binary_specificity': 0.959557, 'binary_f1_score': 0.43344712}
confusion matrix:
       0    1
0  17415  734
1    262  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.935123, 'precision': 0.67880356, 'recall': 0.858042, 'specificity': 0.858042, 'f1': 0.7320412, 'auroc': 0.91666585, 'binary_precision': 0.3679417, 'binary_recall': 0.77394634, 'binary_specificity': 0.9421377, 'binary_f1_score': 0.49876547}
confusion matrix:
      0    1
0  5650  347
1    59  202
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_17.png
early stop counter: 7
val acc:0.9469987154006958, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 17,now: 2024-07-06 22:46:29.398531,epoch time: 0:23:46.687599,used: 6:36:48.419129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9838008, 'precision': 0.98478186, 'recall': 0.9727739, 'specificity': 0.9727739, 'f1': 0.97858316, 'auroc': 0.99653137, 'binary_precision': 0.9867316, 'binary_recall': 0.9499898, 'binary_specificity': 0.99555796, 'binary_f1_score': 0.9680122}
confusion matrix:
       0      1
0  42135    188
1    736  13981
---- Validation: 
scalar performance:
{'acc': 0.95152193, 'precision': 0.67290497, 'recall': 0.75663614, 'specificity': 0.75663614, 'f1': 0.70529294, 'auroc': 0.9044475, 'binary_precision': 0.3621399, 'binary_recall': 0.5474339, 'binary_specificity': 0.9658383, 'binary_f1_score': 0.43591332}
confusion matrix:
       0    1
0  17529  620
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94231385, 'precision': 0.69086045, 'recall': 0.83430886, 'specificity': 0.83430886, 'f1': 0.73910046, 'auroc': 0.9099927, 'binary_precision': 0.39451477, 'binary_recall': 0.71647507, 'binary_specificity': 0.9521427, 'binary_f1_score': 0.50884354}
confusion matrix:
      0    1
0  5710  287
1    74  187
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_18.png
early stop counter: 8
val acc:0.9515219330787659, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 18,now: 2024-07-06 23:10:08.215242,epoch time: 0:23:38.816711,used: 7:00:27.235840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9831346, 'precision': 0.9845134, 'recall': 0.97129506, 'specificity': 0.97129506, 'f1': 0.97766864, 'auroc': 0.996547, 'binary_precision': 0.98724216, 'binary_recall': 0.9468425, 'binary_specificity': 0.9957476, 'binary_f1_score': 0.9666204}
confusion matrix:
       0      1
0  42149    180
1    782  13929
---- Validation: 
scalar performance:
{'acc': 0.94976586, 'precision': 0.6667677, 'recall': 0.7549769, 'specificity': 0.7549769, 'f1': 0.7001105, 'auroc': 0.9058496, 'binary_precision': 0.34995013, 'binary_recall': 0.5458787, 'binary_specificity': 0.96407515, 'binary_f1_score': 0.42648843}
confusion matrix:
       0    1
0  17497  652
1    292  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9391179, 'precision': 0.68218744, 'recall': 0.82897675, 'specificity': 0.82897675, 'f1': 0.7301461, 'auroc': 0.90794253, 'binary_precision': 0.37755102, 'binary_recall': 0.70881224, 'binary_specificity': 0.94914126, 'binary_f1_score': 0.4926764}
confusion matrix:
      0    1
0  5692  305
1    76  185
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_19.png
early stop counter: 9
val acc:0.9497658610343933, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 19,now: 2024-07-06 23:32:58.676566,epoch time: 0:22:50.461324,used: 7:23:17.697164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9846423, 'precision': 0.9849433, 'recall': 0.9748006, 'specificity': 0.9748006, 'f1': 0.97973275, 'auroc': 0.99709153, 'binary_precision': 0.98554486, 'binary_recall': 0.95446825, 'binary_specificity': 0.9951329, 'binary_f1_score': 0.9697576}
confusion matrix:
       0      1
0  42119    206
1    670  14045
---- Validation: 
scalar performance:
{'acc': 0.95045763, 'precision': 0.6673005, 'recall': 0.74783456, 'specificity': 0.74783456, 'f1': 0.6984663, 'auroc': 0.9025253, 'binary_precision': 0.35154638, 'binary_recall': 0.5303266, 'binary_specificity': 0.96534246, 'binary_f1_score': 0.42281464}
confusion matrix:
       0    1
0  17520  629
1    302  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94135505, 'precision': 0.68581164, 'recall': 0.81915, 'specificity': 0.81915, 'f1': 0.73133385, 'auroc': 0.9083967, 'binary_precision': 0.38577586, 'binary_recall': 0.68582374, 'binary_specificity': 0.95247626, 'binary_f1_score': 0.49379313}
confusion matrix:
      0    1
0  5712  285
1    82  179
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_20.png
early stop counter: 10
val acc:0.9504576325416565, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 20,now: 2024-07-06 23:55:58.966292,epoch time: 0:23:00.289726,used: 7:46:17.986890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98467743, 'precision': 0.98607147, 'recall': 0.9738046, 'specificity': 0.9738046, 'f1': 0.9797356, 'auroc': 0.99672693, 'binary_precision': 0.98883945, 'binary_recall': 0.95134217, 'binary_specificity': 0.99626696, 'binary_f1_score': 0.96972847}
confusion matrix:
       0      1
0  42167    158
1    716  13999
---- Validation: 
scalar performance:
{'acc': 0.9545019, 'precision': 0.68098307, 'recall': 0.74392784, 'specificity': 0.74392784, 'f1': 0.70708066, 'auroc': 0.9101845, 'binary_precision': 0.37927106, 'binary_recall': 0.5178849, 'binary_specificity': 0.9699708, 'binary_f1_score': 0.43786982}
confusion matrix:
       0    1
0  17604  545
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501438, 'precision': 0.71062064, 'recall': 0.814574, 'specificity': 0.814574, 'f1': 0.7504785, 'auroc': 0.9118562, 'binary_precision': 0.43609023, 'binary_recall': 0.6666667, 'binary_specificity': 0.96248126, 'binary_f1_score': 0.5272727}
confusion matrix:
      0    1
0  5772  225
1    87  174
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_21.png
early stop counter: 11
val acc:0.9545019268989563, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 21,now: 2024-07-07 00:18:54.022856,epoch time: 0:22:55.056564,used: 8:09:13.043454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98564166, 'precision': 0.98491204, 'recall': 0.9774479, 'specificity': 0.9774479, 'f1': 0.9811044, 'auroc': 0.99732447, 'binary_precision': 0.9834412, 'binary_recall': 0.96051913, 'binary_specificity': 0.9943767, 'binary_f1_score': 0.971845}
confusion matrix:
       0      1
0  42086    238
1    581  14135
---- Validation: 
scalar performance:
{'acc': 0.9480098, 'precision': 0.666743, 'recall': 0.77806956, 'specificity': 0.77806956, 'f1': 0.7061064, 'auroc': 0.910083, 'binary_precision': 0.3481818, 'binary_recall': 0.5956454, 'binary_specificity': 0.9604937, 'binary_f1_score': 0.43947214}
confusion matrix:
       0    1
0  17432  717
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94183445, 'precision': 0.68867624, 'recall': 0.8285618, 'specificity': 0.8285618, 'f1': 0.7359215, 'auroc': 0.913136, 'binary_precision': 0.39065817, 'binary_recall': 0.70498085, 'binary_specificity': 0.9521427, 'binary_f1_score': 0.5027323}
confusion matrix:
      0    1
0  5710  287
1    77  184
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_22.png
early stop counter: 12
val acc:0.9480097889900208, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 22,now: 2024-07-07 00:41:46.598629,epoch time: 0:22:52.575773,used: 8:32:05.619227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98515075, 'precision': 0.9846622, 'recall': 0.9764093, 'specificity': 0.9764093, 'f1': 0.9804433, 'auroc': 0.9968003, 'binary_precision': 0.9836797, 'binary_recall': 0.9583475, 'binary_specificity': 0.9944711, 'binary_f1_score': 0.9708484}
confusion matrix:
       0      1
0  42089    234
1    613  14104
---- Validation: 
scalar performance:
{'acc': 0.94588125, 'precision': 0.6599283, 'recall': 0.7739673, 'specificity': 0.7739673, 'f1': 0.6993208, 'auroc': 0.9053571, 'binary_precision': 0.33480567, 'binary_recall': 0.58942455, 'binary_specificity': 0.9585101, 'binary_f1_score': 0.42704225}
confusion matrix:
       0    1
0  17396  753
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93160754, 'precision': 0.6652354, 'recall': 0.8232258, 'specificity': 0.8232258, 'f1': 0.7128964, 'auroc': 0.90669024, 'binary_precision': 0.34392524, 'binary_recall': 0.70498085, 'binary_specificity': 0.94147074, 'binary_f1_score': 0.46231157}
confusion matrix:
      0    1
0  5646  351
1    77  184
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_23.png
early stop counter: 13
val acc:0.9458812475204468, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 23,now: 2024-07-07 01:04:43.501590,epoch time: 0:22:56.902961,used: 8:55:02.522188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9866234, 'precision': 0.9854597, 'recall': 0.9794825, 'specificity': 0.9794825, 'f1': 0.98242253, 'auroc': 0.9972484, 'binary_precision': 0.9831025, 'binary_recall': 0.96472985, 'binary_specificity': 0.9942351, 'binary_f1_score': 0.9738295}
confusion matrix:
       0      1
0  42081    244
1    519  14196
---- Validation: 
scalar performance:
{'acc': 0.9461473, 'precision': 0.6620388, 'recall': 0.78010553, 'specificity': 0.78010553, 'f1': 0.7025504, 'auroc': 0.90696985, 'binary_precision': 0.33858266, 'binary_recall': 0.60186625, 'binary_specificity': 0.9583448, 'binary_f1_score': 0.43337065}
confusion matrix:
       0    1
0  17393  756
1    256  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93783957, 'precision': 0.6759778, 'recall': 0.8118187, 'specificity': 0.8118187, 'f1': 0.7209988, 'auroc': 0.9070278, 'binary_precision': 0.36666667, 'binary_recall': 0.6743295, 'binary_specificity': 0.949308, 'binary_f1_score': 0.47503376}
confusion matrix:
      0    1
0  5693  304
1    85  176
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_24.png
early stop counter: 14
val acc:0.9461473226547241, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 24,now: 2024-07-07 01:27:26.596606,epoch time: 0:22:43.095016,used: 9:17:45.617204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98669356, 'precision': 0.98615056, 'recall': 0.9789756, 'specificity': 0.9789756, 'f1': 0.9824934, 'auroc': 0.99722564, 'binary_precision': 0.9850549, 'binary_recall': 0.96303093, 'binary_specificity': 0.99492025, 'binary_f1_score': 0.9739185}
confusion matrix:
       0      1
0  42110    215
1    544  14171
---- Validation: 
scalar performance:
{'acc': 0.9521605, 'precision': 0.67416734, 'recall': 0.7524664, 'specificity': 0.7524664, 'f1': 0.7049847, 'auroc': 0.90723884, 'binary_precision': 0.3649789, 'binary_recall': 0.5381026, 'binary_specificity': 0.96683013, 'binary_f1_score': 0.43494657}
confusion matrix:
       0    1
0  17547  602
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9490253, 'precision': 0.70580333, 'recall': 0.806661, 'specificity': 0.806661, 'f1': 0.7445147, 'auroc': 0.9074069, 'binary_precision': 0.42713568, 'binary_recall': 0.651341, 'binary_specificity': 0.961981, 'binary_f1_score': 0.5159333}
confusion matrix:
      0    1
0  5769  228
1    91  170
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_25.png
early stop counter: 15
val acc:0.9521604776382446, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 25,now: 2024-07-07 01:50:29.058285,epoch time: 0:23:02.461679,used: 9:40:48.078883,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98657084, 'precision': 0.9860659, 'recall': 0.9787377, 'specificity': 0.9787377, 'f1': 0.98232913, 'auroc': 0.99730045, 'binary_precision': 0.98504764, 'binary_recall': 0.9625552, 'binary_specificity': 0.99492025, 'binary_f1_score': 0.97367156}
confusion matrix:
       0      1
0  42110    215
1    551  14164
---- Validation: 
scalar performance:
{'acc': 0.9544487, 'precision': 0.6766226, 'recall': 0.725899, 'specificity': 0.725899, 'f1': 0.69778097, 'auroc': 0.90156865, 'binary_precision': 0.37184116, 'binary_recall': 0.4805599, 'binary_specificity': 0.9712381, 'binary_f1_score': 0.41926733}
confusion matrix:
       0    1
0  17627  522
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95302016, 'precision': 0.7182903, 'recall': 0.7922543, 'specificity': 0.7922543, 'f1': 0.7490107, 'auroc': 0.90476334, 'binary_precision': 0.45352113, 'binary_recall': 0.61685824, 'binary_specificity': 0.9676505, 'binary_f1_score': 0.52272725}
confusion matrix:
      0    1
0  5803  194
1   100  161
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_26.png
early stop counter: 16
val acc:0.9544486999511719, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 26,now: 2024-07-07 02:13:28.744340,epoch time: 0:22:59.686055,used: 10:03:47.764938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9867812, 'precision': 0.98849154, 'recall': 0.976926, 'specificity': 0.976926, 'f1': 0.98252994, 'auroc': 0.9974996, 'binary_precision': 0.99189514, 'binary_recall': 0.956569, 'binary_specificity': 0.99728304, 'binary_f1_score': 0.9739119}
confusion matrix:
       0      1
0  42212    115
1    639  14074
---- Validation: 
scalar performance:
{'acc': 0.955513, 'precision': 0.6744615, 'recall': 0.699448, 'specificity': 0.699448, 'f1': 0.6859935, 'auroc': 0.89854586, 'binary_precision': 0.36941814, 'binary_recall': 0.42457232, 'binary_specificity': 0.97432363, 'binary_f1_score': 0.39507958}
confusion matrix:
       0    1
0  17683  466
1    370  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.74302477, 'recall': 0.7696032, 'specificity': 0.7696032, 'f1': 0.755522, 'auroc': 0.90190613, 'binary_precision': 0.5051546, 'binary_recall': 0.5632184, 'binary_specificity': 0.975988, 'binary_f1_score': 0.5326087}
confusion matrix:
      0    1
0  5853  144
1   114  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_27.png
early stop counter: 17
val acc:0.9555130004882812, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 27,now: 2024-07-07 02:36:23.209358,epoch time: 0:22:54.465018,used: 10:26:42.229956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98685133, 'precision': 0.9863712, 'recall': 0.97917175, 'specificity': 0.97917175, 'f1': 0.98270136, 'auroc': 0.9973091, 'binary_precision': 0.98540246, 'binary_recall': 0.96330523, 'binary_specificity': 0.9950383, 'binary_f1_score': 0.97422856}
confusion matrix:
       0      1
0  42114    210
1    540  14176
---- Validation: 
scalar performance:
{'acc': 0.9472648, 'precision': 0.6576035, 'recall': 0.7484317, 'specificity': 0.7484317, 'f1': 0.69108355, 'auroc': 0.898978, 'binary_precision': 0.33204633, 'binary_recall': 0.5349922, 'binary_specificity': 0.9618712, 'binary_f1_score': 0.4097677}
confusion matrix:
       0    1
0  17457  692
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9440716, 'precision': 0.68934464, 'recall': 0.79857934, 'specificity': 0.79857934, 'f1': 0.72936165, 'auroc': 0.90223837, 'binary_precision': 0.39479905, 'binary_recall': 0.63984674, 'binary_specificity': 0.957312, 'binary_f1_score': 0.4883041}
confusion matrix:
      0    1
0  5741  256
1    94  167
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_28.png
early stop counter: 18
val acc:0.9472647905349731, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 28,now: 2024-07-07 02:59:32.404762,epoch time: 0:23:09.195404,used: 10:49:51.425360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9866059, 'precision': 0.98765516, 'recall': 0.97728044, 'specificity': 0.97728044, 'f1': 0.9823232, 'auroc': 0.9972601, 'binary_precision': 0.9897515, 'binary_recall': 0.9580106, 'binary_specificity': 0.99655026, 'binary_f1_score': 0.97362244}
confusion matrix:
       0      1
0  42176    146
1    618  14100
---- Validation: 
scalar performance:
{'acc': 0.9552469, 'precision': 0.6738293, 'recall': 0.7015604, 'specificity': 0.7015604, 'f1': 0.6865146, 'auroc': 0.8992542, 'binary_precision': 0.368, 'binary_recall': 0.42923796, 'binary_specificity': 0.97388285, 'binary_f1_score': 0.39626703}
confusion matrix:
       0    1
0  17675  474
1    367  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7384736, 'recall': 0.7636893, 'specificity': 0.7636893, 'f1': 0.7503526, 'auroc': 0.90228754, 'binary_precision': 0.49655172, 'binary_recall': 0.55172414, 'binary_specificity': 0.9756545, 'binary_f1_score': 0.52268606}
confusion matrix:
      0    1
0  5851  146
1   117  144
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_29.png
early stop counter: 19
val acc:0.9552469253540039, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 29,now: 2024-07-07 03:22:26.648085,epoch time: 0:22:54.243323,used: 11:12:45.668683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98753506, 'precision': 0.98724425, 'recall': 0.9800991, 'specificity': 0.9800991, 'f1': 0.98360276, 'auroc': 0.9980249, 'binary_precision': 0.9866574, 'binary_recall': 0.9647347, 'binary_specificity': 0.99546343, 'binary_f1_score': 0.9755729}
confusion matrix:
       0      1
0  42131    192
1    519  14198
---- Validation: 
scalar performance:
{'acc': 0.956258, 'precision': 0.68161565, 'recall': 0.71408474, 'specificity': 0.71408474, 'f1': 0.6963209, 'auroc': 0.9019075, 'binary_precision': 0.38269988, 'binary_recall': 0.4541213, 'binary_specificity': 0.97404814, 'binary_f1_score': 0.41536272}
confusion matrix:
       0    1
0  17678  471
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.7346175, 'recall': 0.76876944, 'specificity': 0.76876944, 'f1': 0.7503562, 'auroc': 0.90207523, 'binary_precision': 0.4883721, 'binary_recall': 0.5632184, 'binary_specificity': 0.9743205, 'binary_f1_score': 0.52313167}
confusion matrix:
      0    1
0  5843  154
1   114  147
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_30.png
early stop counter: 20
val acc:0.9562579989433289, best validation acc: 0.9583333134651184, corresponding to test acc:                         0.9589325785636902 / 0.9626078605651855
after epoch: 30,now: 2024-07-07 03:45:42.127077,epoch time: 0:23:15.478992,used: 11:36:01.147675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_06_16_09_40_seed_0_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:36:01.147675 at 2024-07-07 03:45:42.127077
persisted model performance metric: 

scalar performance:
{'acc': 0.9589326, 'precision': 0.74529296, 'recall': 0.8118303, 'specificity': 0.8118303, 'f1': 0.773976, 'auroc': 0.9139838, 'binary_precision': 0.50595236, 'binary_recall': 0.651341, 'binary_specificity': 0.9723195, 'binary_f1_score': 0.5695143}
confusion matrix:
      0    1
0  5831  166
1    91  170
oracle model performance metric: 

scalar performance:
{'acc': 0.96260786, 'precision': 0.76428354, 'recall': 0.80275387, 'specificity': 0.80275387, 'f1': 0.78202736, 'auroc': 0.90736115, 'binary_precision': 0.54485047, 'binary_recall': 0.62835246, 'binary_specificity': 0.97715527, 'binary_f1_score': 0.58362985}
confusion matrix:
      0    1
0  5860  137
1    97  164
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB |   1195 TiB |   1195 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1179 TiB |   1179 TiB |
|       from small pool |  16482 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59895 KiB | 732464 KiB | 687392 GiB | 687392 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 671688 GiB | 671688 GiB |
|       from small pool |   9133 KiB |  11093 KiB |  15704 GiB |  15704 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7625    |  197304 K  |  197301 K  |
|       from large pool |      79    |     762    |  112031 K  |  112031 K  |
|       from small pool |    2899    |    7544    |   85272 K  |   85269 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7625    |  197304 K  |  197301 K  |
|       from large pool |      79    |     762    |  112031 K  |  112031 K  |
|       from small pool |    2899    |    7544    |   85272 K  |   85269 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3589    |  121764 K  |  121764 K  |
|       from large pool |      10    |     350    |   86069 K  |   86069 K  |
|       from small pool |      26    |    3579    |   35694 K  |   35694 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 687393 GiB | 687393 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 671688 GiB | 671688 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15704 GiB |  15704 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  197304 K  |  197304 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85272 K  |   85272 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  197304 K  |  197304 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85272 K  |   85272 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  121765 K  |  121765 K  |
|       from large pool |       3    |     350    |   86069 K  |   86069 K  |
|       from small pool |       0    |    3579    |   35696 K  |   35696 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1195 TiB |   1195 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1179 TiB |   1179 TiB |
|       from small pool |      0 KiB |     36 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 687393 GiB | 687393 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 671688 GiB | 671688 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15704 GiB |  15704 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  197304 K  |  197304 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85272 K  |   85272 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  197304 K  |  197304 K  |
|       from large pool |       2    |     762    |  112031 K  |  112031 K  |
|       from small pool |       0    |    7544    |   85272 K  |   85272 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  121765 K  |  121765 K  |
|       from large pool |       3    |     350    |   86069 K  |   86069 K  |
|       from small pool |       0    |    3579    |   35696 K  |   35696 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437

 Experiment start at: 2024-07-07 03:53:14.664156
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92690736, 'precision': 0.9306389, 'recall': 0.8728988, 'specificity': 0.8728988, 'f1': 0.8968845, 'auroc': 0.94634306, 'binary_precision': 0.93699986, 'binary_recall': 0.76324546, 'binary_specificity': 0.9825521, 'binary_f1_score': 0.84124434}
confusion matrix:
       0      1
0  41672    740
1   3414  11006
---- Validation: 
scalar performance:
{'acc': 0.94546425, 'precision': 0.50673056, 'recall': 0.5039316, 'specificity': 0.5039316, 'f1': 0.50389373, 'auroc': 0.7456157, 'binary_precision': 0.04909561, 'binary_recall': 0.028231798, 'binary_specificity': 0.97963136, 'binary_f1_score': 0.035849053}
confusion matrix:
       0    1
0  17699  368
1    654   19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9363519, 'precision': 0.49287435, 'recall': 0.49600378, 'specificity': 0.49600378, 'f1': 0.49347955, 'auroc': 0.71017754, 'binary_precision': 0.027972028, 'binary_recall': 0.015384615, 'binary_specificity': 0.97662294, 'binary_f1_score': 0.019851118}
confusion matrix:
      0    1
0  5807  139
1   256    4
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-07 04:16:47.275624,epoch time: 0:23:32.611468,used: 0:23:32.611468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95316017, 'precision': 0.96193635, 'recall': 0.91405964, 'specificity': 0.91405964, 'f1': 0.9349021, 'auroc': 0.972316, 'binary_precision': 0.9774241, 'binary_recall': 0.83467406, 'binary_specificity': 0.9934453, 'binary_f1_score': 0.90042645}
confusion matrix:
       0      1
0  42134    278
1   2384  12036
---- Validation: 
scalar performance:
{'acc': 0.9524013, 'precision': 0.5484685, 'recall': 0.5218346, 'specificity': 0.5218346, 'f1': 0.52799034, 'auroc': 0.8028977, 'binary_precision': 0.13131313, 'binary_recall': 0.05794948, 'binary_specificity': 0.9857198, 'binary_f1_score': 0.080412365}
confusion matrix:
       0    1
0  17809  258
1    634   39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9423139, 'precision': 0.50223964, 'recall': 0.5009541, 'specificity': 0.5009541, 'f1': 0.4987248, 'auroc': 0.78611994, 'binary_precision': 0.046296295, 'binary_recall': 0.01923077, 'binary_specificity': 0.98267746, 'binary_f1_score': 0.027173914}
confusion matrix:
      0    1
0  5843  103
1   255    5
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-07 04:39:50.119264,epoch time: 0:23:02.843640,used: 0:46:35.455108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96201086, 'precision': 0.9684098, 'recall': 0.93096983, 'specificity': 0.93096983, 'f1': 0.94781303, 'auroc': 0.9819571, 'binary_precision': 0.9800313, 'binary_recall': 0.867952, 'binary_specificity': 0.9939877, 'binary_f1_score': 0.92059284}
confusion matrix:
       0      1
0  42158    255
1   1904  12515
---- Validation: 
scalar performance:
{'acc': 0.9551761, 'precision': 0.6131116, 'recall': 0.5590371, 'specificity': 0.5590371, 'f1': 0.57590747, 'auroc': 0.83355093, 'binary_precision': 0.25797102, 'binary_recall': 0.13224368, 'binary_specificity': 0.98583055, 'binary_f1_score': 0.17485265}
confusion matrix:
       0    1
0  17811  256
1    584   89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9468256, 'precision': 0.54354185, 'recall': 0.5161815, 'specificity': 0.5161815, 'f1': 0.52021444, 'auroc': 0.834003, 'binary_precision': 0.12765957, 'binary_recall': 0.046153847, 'binary_specificity': 0.9862092, 'binary_f1_score': 0.06779662}
confusion matrix:
      0   1
0  5864  82
1   248  12
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-07 05:02:47.279716,epoch time: 0:22:57.160452,used: 1:09:32.615560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96690243, 'precision': 0.9715023, 'recall': 0.94074345, 'specificity': 0.94074345, 'f1': 0.9548591, 'auroc': 0.98680997, 'binary_precision': 0.9800138, 'binary_recall': 0.8876405, 'binary_specificity': 0.99384636, 'binary_f1_score': 0.93154275}
confusion matrix:
       0      1
0  42153    261
1   1620  12798
---- Validation: 
scalar performance:
{'acc': 0.95821774, 'precision': 0.6358594, 'recall': 0.5577535, 'specificity': 0.5577535, 'f1': 0.5784739, 'auroc': 0.84881246, 'binary_precision': 0.30357143, 'binary_recall': 0.12630014, 'binary_specificity': 0.98920685, 'binary_f1_score': 0.17838405}
confusion matrix:
       0    1
0  17872  195
1    588   85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9531099, 'precision': 0.5939505, 'recall': 0.5213, 'specificity': 0.5213, 'f1': 0.5289797, 'auroc': 0.86601514, 'binary_precision': 0.22807017, 'binary_recall': 0.05, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.08201893}
confusion matrix:
      0   1
0  5902  44
1   247  13
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-07 05:25:35.519966,epoch time: 0:22:48.240250,used: 1:32:20.855810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9712662, 'precision': 0.97207844, 'recall': 0.95152134, 'specificity': 0.95152134, 'f1': 0.9612304, 'auroc': 0.99022007, 'binary_precision': 0.9736257, 'binary_recall': 0.9114363, 'binary_specificity': 0.99160635, 'binary_f1_score': 0.9415052}
confusion matrix:
       0      1
0  42057    356
1   1277  13142
---- Validation: 
scalar performance:
{'acc': 0.9596585, 'precision': 0.6827885, 'recall': 0.6078541, 'specificity': 0.6078541, 'f1': 0.6343568, 'auroc': 0.86282456, 'binary_precision': 0.3938619, 'binary_recall': 0.22882615, 'binary_specificity': 0.98688215, 'binary_f1_score': 0.28947368}
confusion matrix:
       0    1
0  17830  237
1    519  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.69473934, 'recall': 0.5579226, 'specificity': 0.5579226, 'f1': 0.5843027, 'auroc': 0.88660836, 'binary_precision': 0.42666668, 'binary_recall': 0.12307692, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.19104478}
confusion matrix:
      0   1
0  5903  43
1   228  32
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-07 05:48:44.914634,epoch time: 0:23:09.394668,used: 1:55:30.250478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9718996, 'precision': 0.9756726, 'recall': 0.94986296, 'specificity': 0.94986296, 'f1': 0.96188354, 'auroc': 0.9905002, 'binary_precision': 0.982756, 'binary_recall': 0.9051252, 'binary_specificity': 0.9946007, 'binary_f1_score': 0.9423445}
confusion matrix:
       0      1
0  42184    229
1   1368  13051
---- Validation: 
scalar performance:
{'acc': 0.9605656, 'precision': 0.6869054, 'recall': 0.59616506, 'specificity': 0.59616506, 'f1': 0.6251094, 'auroc': 0.8672856, 'binary_precision': 0.40294117, 'binary_recall': 0.20356612, 'binary_specificity': 0.98876405, 'binary_f1_score': 0.2704837}
confusion matrix:
       0    1
0  17864  203
1    536  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.74286854, 'recall': 0.5646168, 'specificity': 0.5646168, 'f1': 0.5964007, 'auroc': 0.89667845, 'binary_precision': 0.52238804, 'binary_recall': 0.13461539, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.2140673}
confusion matrix:
      0   1
0  5914  32
1   225  35
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-07 06:11:54.568488,epoch time: 0:23:09.653854,used: 2:18:39.904332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9744686, 'precision': 0.97583663, 'recall': 0.9563649, 'specificity': 0.9563649, 'f1': 0.96559453, 'auroc': 0.99240756, 'binary_precision': 0.9784518, 'binary_recall': 0.9196144, 'binary_specificity': 0.9931155, 'binary_f1_score': 0.94812113}
confusion matrix:
       0      1
0  42122    292
1   1159  13259
---- Validation: 
scalar performance:
{'acc': 0.9613127, 'precision': 0.7044535, 'recall': 0.6251632, 'specificity': 0.6251632, 'f1': 0.65408224, 'auroc': 0.87495875, 'binary_precision': 0.4359606, 'binary_recall': 0.26300147, 'binary_specificity': 0.98732495, 'binary_f1_score': 0.32808152}
confusion matrix:
       0    1
0  17838  229
1    496  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.81503105, 'recall': 0.61093885, 'specificity': 0.61093885, 'f1': 0.65947974, 'auroc': 0.9060739, 'binary_precision': 0.66292137, 'binary_recall': 0.22692308, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.3381089}
confusion matrix:
      0   1
0  5916  30
1   201  59
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-07 06:35:01.847070,epoch time: 0:23:07.278582,used: 2:41:47.182914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9770552, 'precision': 0.9794843, 'recall': 0.95970017, 'specificity': 0.95970017, 'f1': 0.96907485, 'auroc': 0.99363613, 'binary_precision': 0.9841258, 'binary_recall': 0.9244694, 'binary_specificity': 0.9949309, 'binary_f1_score': 0.95336527}
confusion matrix:
       0      1
0  42199    215
1   1089  13329
---- Validation: 
scalar performance:
{'acc': 0.9624867, 'precision': 0.71603894, 'recall': 0.6207652, 'specificity': 0.6207652, 'f1': 0.6533446, 'auroc': 0.87451047, 'binary_precision': 0.45945945, 'binary_recall': 0.25260028, 'binary_specificity': 0.9889301, 'binary_f1_score': 0.32598272}
confusion matrix:
       0    1
0  17867  200
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.845121, 'recall': 0.6040033, 'specificity': 0.6040033, 'f1': 0.6543331, 'auroc': 0.9064586, 'binary_precision': 0.7236842, 'binary_recall': 0.21153846, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.32738096}
confusion matrix:
      0   1
0  5925  21
1   205  55
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-07 06:57:55.423950,epoch time: 0:22:53.576880,used: 3:04:40.759794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97672087, 'precision': 0.975317, 'recall': 0.9628225, 'specificity': 0.9628225, 'f1': 0.9688593, 'auroc': 0.9933648, 'binary_precision': 0.97257704, 'binary_recall': 0.9346047, 'binary_specificity': 0.9910403, 'binary_f1_score': 0.95321286}
confusion matrix:
       0      1
0  42032    380
1    943  13477
---- Validation: 
scalar performance:
{'acc': 0.9624867, 'precision': 0.7195343, 'recall': 0.6415079, 'specificity': 0.6415079, 'f1': 0.67108256, 'auroc': 0.87714195, 'binary_precision': 0.46495327, 'binary_recall': 0.29569092, 'binary_specificity': 0.98732495, 'binary_f1_score': 0.36148956}
confusion matrix:
       0    1
0  17838  229
1    474  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.8312217, 'recall': 0.62824655, 'specificity': 0.62824655, 'f1': 0.6807356, 'auroc': 0.9094524, 'binary_precision': 0.6938776, 'binary_recall': 0.26153848, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.37988827}
confusion matrix:
      0   1
0  5916  30
1   192  68
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_9.png
new oracle model saved
early stop counter: 1
val acc:0.9624866843223572, best validation acc: 0.9624866843223572, corresponding to test acc:                         0.9635836482048035 / 0.9642281532287598
after epoch: 9,now: 2024-07-07 07:20:35.614725,epoch time: 0:22:40.190775,used: 3:27:20.950569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9790787, 'precision': 0.97902715, 'recall': 0.9654237, 'specificity': 0.9654237, 'f1': 0.9719789, 'auroc': 0.99466527, 'binary_precision': 0.9789268, 'binary_recall': 0.9377081, 'binary_specificity': 0.9931394, 'binary_f1_score': 0.95787424}
confusion matrix:
       0      1
0  42125    291
1    898  13518
---- Validation: 
scalar performance:
{'acc': 0.9623266, 'precision': 0.71934015, 'recall': 0.6507234, 'specificity': 0.6507234, 'f1': 0.6778995, 'auroc': 0.87682384, 'binary_precision': 0.46389496, 'binary_recall': 0.31500742, 'binary_specificity': 0.98643935, 'binary_f1_score': 0.37522122}
confusion matrix:
       0    1
0  17822  245
1    461  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.84753036, 'recall': 0.6305059, 'specificity': 0.6305059, 'f1': 0.6853672, 'auroc': 0.91031903, 'binary_precision': 0.7263158, 'binary_recall': 0.2653846, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.38873237}
confusion matrix:
      0   1
0  5920  26
1   191  69
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_10.png
new oracle model saved
early stop counter: 2
val acc:0.9623265862464905, best validation acc: 0.9624866843223572, corresponding to test acc:                         0.9635836482048035 / 0.9650338292121887
after epoch: 10,now: 2024-07-07 07:43:24.038657,epoch time: 0:22:48.423932,used: 3:50:09.374501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9798705, 'precision': 0.9804007, 'recall': 0.9661873, 'specificity': 0.9661873, 'f1': 0.973026, 'auroc': 0.9941188, 'binary_precision': 0.9814304, 'binary_recall': 0.93841034, 'binary_specificity': 0.99396425, 'binary_f1_score': 0.9594383}
confusion matrix:
       0      1
0  42158    256
1    888  13530
---- Validation: 
scalar performance:
{'acc': 0.96254003, 'precision': 0.72139096, 'recall': 0.6508341, 'specificity': 0.6508341, 'f1': 0.67862207, 'auroc': 0.87936985, 'binary_precision': 0.46799117, 'binary_recall': 0.31500742, 'binary_specificity': 0.9866608, 'binary_f1_score': 0.3765542}
confusion matrix:
       0    1
0  17826  241
1    461  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.83676493, 'recall': 0.64346296, 'specificity': 0.64346296, 'f1': 0.6975546, 'auroc': 0.9125306, 'binary_precision': 0.7037037, 'binary_recall': 0.2923077, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.4130435}
confusion matrix:
      0   1
0  5914  32
1   184  76
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-07 08:06:21.663177,epoch time: 0:22:57.624520,used: 4:13:06.999021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98048633, 'precision': 0.98253196, 'recall': 0.965778, 'specificity': 0.965778, 'f1': 0.97378576, 'auroc': 0.9951807, 'binary_precision': 0.9864766, 'binary_recall': 0.9359179, 'binary_specificity': 0.99563813, 'binary_f1_score': 0.9605324}
confusion matrix:
       0      1
0  42228    185
1    924  13495
---- Validation: 
scalar performance:
{'acc': 0.9624333, 'precision': 0.71687174, 'recall': 0.6286054, 'specificity': 0.6286054, 'f1': 0.660127, 'auroc': 0.8708695, 'binary_precision': 0.4605598, 'binary_recall': 0.268945, 'binary_specificity': 0.9882659, 'binary_f1_score': 0.3395872}
confusion matrix:
       0    1
0  17855  212
1    492  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.8352804, 'recall': 0.60759723, 'specificity': 0.60759723, 'f1': 0.65775275, 'auroc': 0.90373945, 'binary_precision': 0.7037037, 'binary_recall': 0.21923077, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.33431086}
confusion matrix:
      0   1
0  5922  24
1   203  57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_12.png
early stop counter: 1
val acc:0.9624332785606384, best validation acc: 0.9625400304794312, corresponding to test acc:                         0.9651950001716614 / 0.9651950001716614
after epoch: 12,now: 2024-07-07 08:29:19.359037,epoch time: 0:22:57.695860,used: 4:36:04.694881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9807679, 'precision': 0.9810867, 'recall': 0.9678873, 'specificity': 0.9678873, 'f1': 0.97425604, 'auroc': 0.99546635, 'binary_precision': 0.98170775, 'binary_recall': 0.9417395, 'binary_specificity': 0.994035, 'binary_f1_score': 0.96130836}
confusion matrix:
       0      1
0  42161    253
1    840  13578
---- Validation: 
scalar performance:
{'acc': 0.96286017, 'precision': 0.72402555, 'recall': 0.64670855, 'specificity': 0.64670855, 'f1': 0.67635274, 'auroc': 0.87893564, 'binary_precision': 0.47356322, 'binary_recall': 0.3060921, 'binary_specificity': 0.98732495, 'binary_f1_score': 0.37184113}
confusion matrix:
       0    1
0  17838  229
1    467  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.83581084, 'recall': 0.65474916, 'specificity': 0.65474916, 'f1': 0.70865744, 'auroc': 0.91109776, 'binary_precision': 0.7008547, 'binary_recall': 0.31538463, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.43501326}
confusion matrix:
      0   1
0  5911  35
1   178  82
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_13.png
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-07 08:52:20.784486,epoch time: 0:23:01.425449,used: 4:59:06.120330,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9810494, 'precision': 0.9801606, 'recall': 0.9695444, 'specificity': 0.9695444, 'f1': 0.97470224, 'auroc': 0.9957104, 'binary_precision': 0.9784152, 'binary_recall': 0.9461858, 'binary_specificity': 0.99290293, 'binary_f1_score': 0.96203065}
confusion matrix:
       0      1
0  42111    301
1    776  13644
---- Validation: 
scalar performance:
{'acc': 0.9627001, 'precision': 0.7249699, 'recall': 0.66808355, 'specificity': 0.66808355, 'f1': 0.6919114, 'auroc': 0.8827121, 'binary_precision': 0.47389558, 'binary_recall': 0.35066864, 'binary_specificity': 0.9854984, 'binary_f1_score': 0.40307426}
confusion matrix:
       0    1
0  17805  262
1    437  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.8358747, 'recall': 0.6754825, 'specificity': 0.6754825, 'f1': 0.72802985, 'auroc': 0.9146595, 'binary_precision': 0.69924814, 'binary_recall': 0.3576923, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.47328243}
confusion matrix:
      0   1
0  5906  40
1   167  93
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_14.png
new oracle model saved
early stop counter: 1
val acc:0.9627001285552979, best validation acc: 0.9628601670265198, corresponding to test acc:                         0.9656783938407898 / 0.9666451811790466
after epoch: 14,now: 2024-07-07 09:15:15.689312,epoch time: 0:22:54.904826,used: 5:22:01.025156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9823867, 'precision': 0.9849833, 'recall': 0.96842647, 'specificity': 0.96842647, 'f1': 0.9763465, 'auroc': 0.9959334, 'binary_precision': 0.9899949, 'binary_recall': 0.9400832, 'binary_specificity': 0.9967698, 'binary_f1_score': 0.96439373}
confusion matrix:
       0      1
0  42275    137
1    864  13556
---- Validation: 
scalar performance:
{'acc': 0.96376735, 'precision': 0.7327707, 'recall': 0.63287365, 'specificity': 0.63287365, 'f1': 0.6676548, 'auroc': 0.884639, 'binary_precision': 0.4920635, 'binary_recall': 0.27637443, 'binary_specificity': 0.9893729, 'binary_f1_score': 0.3539486}
confusion matrix:
       0    1
0  17875  192
1    487  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.85323334, 'recall': 0.6627778, 'specificity': 0.6627778, 'f1': 0.7195999, 'auroc': 0.91425073, 'binary_precision': 0.73504275, 'binary_recall': 0.33076924, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.45623344}
confusion matrix:
      0   1
0  5915  31
1   174  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_15.png
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-07 09:38:15.388469,epoch time: 0:22:59.699157,used: 5:45:00.724313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9825978, 'precision': 0.983883, 'recall': 0.97000784, 'specificity': 0.97000784, 'f1': 0.9766923, 'auroc': 0.9957925, 'binary_precision': 0.9863827, 'binary_recall': 0.9444483, 'binary_specificity': 0.9955674, 'binary_f1_score': 0.96496016}
confusion matrix:
       0      1
0  42225    188
1    801  13618
---- Validation: 
scalar performance:
{'acc': 0.96254003, 'precision': 0.72186655, 'recall': 0.6544104, 'specificity': 0.6544104, 'f1': 0.6813634, 'auroc': 0.8892442, 'binary_precision': 0.4686825, 'binary_recall': 0.32243684, 'binary_specificity': 0.98638403, 'binary_f1_score': 0.38204223}
confusion matrix:
       0    1
0  17821  246
1    456  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.8469498, 'recall': 0.68526614, 'specificity': 0.68526614, 'f1': 0.7391525, 'auroc': 0.91698205, 'binary_precision': 0.7205882, 'binary_recall': 0.37692308, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.4949495}
confusion matrix:
      0   1
0  5908  38
1   162  98
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_16.png
new oracle model saved
early stop counter: 1
val acc:0.9625400304794312, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.9677731394767761
after epoch: 16,now: 2024-07-07 10:01:14.160101,epoch time: 0:22:58.771632,used: 6:07:59.495945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98342484, 'precision': 0.9832389, 'recall': 0.9728049, 'specificity': 0.9728049, 'f1': 0.977878, 'auroc': 0.996212, 'binary_precision': 0.9828735, 'binary_recall': 0.9512449, 'binary_specificity': 0.9943649, 'binary_f1_score': 0.9668006}
confusion matrix:
       0      1
0  42174    239
1    703  13716
---- Validation: 
scalar performance:
{'acc': 0.9625934, 'precision': 0.72246575, 'recall': 0.6551534, 'specificity': 0.6551534, 'f1': 0.68208843, 'auroc': 0.88516057, 'binary_precision': 0.4698276, 'binary_recall': 0.32392272, 'binary_specificity': 0.98638403, 'binary_f1_score': 0.3834653}
confusion matrix:
       0    1
0  17821  246
1    455  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.8397894, 'recall': 0.6605184, 'specificity': 0.6605184, 'f1': 0.7149575, 'auroc': 0.9114983, 'binary_precision': 0.7083333, 'binary_recall': 0.32692307, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.4473684}
confusion matrix:
      0   1
0  5911  35
1   175  85
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_17.png
early stop counter: 2
val acc:0.9625933766365051, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.9677731394767761
after epoch: 17,now: 2024-07-07 10:24:02.964299,epoch time: 0:22:48.804198,used: 6:30:48.300143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9839351, 'precision': 0.9839158, 'recall': 0.9734901, 'specificity': 0.9734901, 'f1': 0.9785595, 'auroc': 0.9964255, 'binary_precision': 0.9838779, 'binary_recall': 0.9522852, 'binary_specificity': 0.994695, 'binary_f1_score': 0.9678238}
confusion matrix:
       0      1
0  42188    225
1    688  13731
---- Validation: 
scalar performance:
{'acc': 0.9621665, 'precision': 0.7189006, 'recall': 0.65779305, 'specificity': 0.65779305, 'f1': 0.6827826, 'auroc': 0.8915129, 'binary_precision': 0.4625, 'binary_recall': 0.32986626, 'binary_specificity': 0.9857198, 'binary_f1_score': 0.3850824}
confusion matrix:
       0    1
0  17809  258
1    451  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.8280951, 'recall': 0.6940406, 'specificity': 0.6940406, 'f1': 0.7420673, 'auroc': 0.9156822, 'binary_precision': 0.6821192, 'binary_recall': 0.39615384, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.5012165}
confusion matrix:
      0    1
0  5898   48
1   157  103
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_18.png
early stop counter: 3
val acc:0.9621664881706238, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.9677731394767761
after epoch: 18,now: 2024-07-07 10:47:15.603567,epoch time: 0:23:12.639268,used: 6:54:00.939411,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9848853, 'precision': 0.9836936, 'recall': 0.9762337, 'specificity': 0.9762337, 'f1': 0.97988987, 'auroc': 0.99671304, 'binary_precision': 0.9813303, 'binary_recall': 0.95866853, 'binary_specificity': 0.9937989, 'binary_f1_score': 0.969867}
confusion matrix:
       0      1
0  42149    263
1    596  13824
---- Validation: 
scalar performance:
{'acc': 0.9624333, 'precision': 0.72269845, 'recall': 0.6686604, 'specificity': 0.6686604, 'f1': 0.69149196, 'auroc': 0.89058304, 'binary_precision': 0.46930692, 'binary_recall': 0.35215452, 'binary_specificity': 0.9851663, 'binary_f1_score': 0.4023769}
confusion matrix:
       0    1
0  17799  268
1    436  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.83287656, 'recall': 0.68668467, 'specificity': 0.68668467, 'f1': 0.7371223, 'auroc': 0.91396254, 'binary_precision': 0.6923077, 'binary_recall': 0.38076922, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.49131513}
confusion matrix:
      0   1
0  5902  44
1   161  99
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_19.png
early stop counter: 4
val acc:0.9624332785606384, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.9677731394767761
after epoch: 19,now: 2024-07-07 11:10:59.254803,epoch time: 0:23:43.651236,used: 7:17:44.590647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98425186, 'precision': 0.9833001, 'recall': 0.9749383, 'specificity': 0.9749383, 'f1': 0.97902656, 'auroc': 0.99667704, 'binary_precision': 0.9814182, 'binary_recall': 0.95603025, 'binary_specificity': 0.99384624, 'binary_f1_score': 0.9685579}
confusion matrix:
       0      1
0  42152    261
1    634  13785
---- Validation: 
scalar performance:
{'acc': 0.96254003, 'precision': 0.7240443, 'recall': 0.6722921, 'specificity': 0.6722921, 'f1': 0.69437623, 'auroc': 0.89046323, 'binary_precision': 0.47173488, 'binary_recall': 0.35958394, 'binary_specificity': 0.98500025, 'binary_f1_score': 0.4080944}
confusion matrix:
       0    1
0  17796  271
1    431  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.84504807, 'recall': 0.6908672, 'specificity': 0.6908672, 'f1': 0.7435863, 'auroc': 0.9150338, 'binary_precision': 0.71631205, 'binary_recall': 0.38846153, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.50374067}
confusion matrix:
      0    1
0  5906   40
1   159  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_20.png
new oracle model saved
early stop counter: 5
val acc:0.9625400304794312, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.967934250831604
after epoch: 20,now: 2024-07-07 11:34:47.801925,epoch time: 0:23:48.547122,used: 7:41:33.137769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98495567, 'precision': 0.9853636, 'recall': 0.9747689, 'specificity': 0.9747689, 'f1': 0.9799187, 'auroc': 0.9968388, 'binary_precision': 0.98616487, 'binary_recall': 0.95408833, 'binary_specificity': 0.9954495, 'binary_f1_score': 0.96986145}
confusion matrix:
       0      1
0  42220    193
1    662  13757
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.7264036, 'recall': 0.64327055, 'specificity': 0.64327055, 'f1': 0.6744024, 'auroc': 0.89205015, 'binary_precision': 0.47857141, 'binary_recall': 0.2986627, 'binary_specificity': 0.98787844, 'binary_f1_score': 0.36779508}
confusion matrix:
       0    1
0  17848  219
1    472  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671286, 'precision': 0.8544358, 'recall': 0.66470087, 'specificity': 0.66470087, 'f1': 0.7216827, 'auroc': 0.9133443, 'binary_precision': 0.7372881, 'binary_recall': 0.33461538, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.46031746}
confusion matrix:
      0   1
0  5915  31
1   173  87
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_21.png
early stop counter: 6
val acc:0.9631270170211792, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.967934250831604
after epoch: 21,now: 2024-07-07 11:58:39.328747,epoch time: 0:23:51.526822,used: 8:05:24.664591,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98511404, 'precision': 0.9847939, 'recall': 0.9757447, 'specificity': 0.9757447, 'f1': 0.9801613, 'auroc': 0.9972142, 'binary_precision': 0.9841621, 'binary_recall': 0.95672375, 'binary_specificity': 0.99476576, 'binary_f1_score': 0.970249}
confusion matrix:
       0      1
0  42191    222
1    624  13795
---- Validation: 
scalar performance:
{'acc': 0.9629136, 'precision': 0.7257033, 'recall': 0.65674996, 'specificity': 0.65674996, 'f1': 0.68427145, 'auroc': 0.8981709, 'binary_precision': 0.47619048, 'binary_recall': 0.3268945, 'binary_specificity': 0.9866054, 'binary_f1_score': 0.38766518}
confusion matrix:
       0    1
0  17825  242
1    453  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.86276674, 'recall': 0.6895327, 'specificity': 0.6895327, 'f1': 0.74642396, 'auroc': 0.916503, 'binary_precision': 0.7518797, 'binary_recall': 0.3846154, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.5089059}
confusion matrix:
      0    1
0  5913   33
1   160  100
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_22.png
new oracle model saved
early stop counter: 7
val acc:0.9629135727882385, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.9689010381698608
after epoch: 22,now: 2024-07-07 12:22:15.423884,epoch time: 0:23:36.095137,used: 8:29:00.759728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9853604, 'precision': 0.9837061, 'recall': 0.9774903, 'specificity': 0.9774903, 'f1': 0.98054695, 'auroc': 0.99705875, 'binary_precision': 0.98041296, 'binary_recall': 0.9615118, 'binary_specificity': 0.9934688, 'binary_f1_score': 0.9708704}
confusion matrix:
       0      1
0  42135    277
1    555  13865
---- Validation: 
scalar performance:
{'acc': 0.9628068, 'precision': 0.7254703, 'recall': 0.66384727, 'specificity': 0.66384727, 'f1': 0.6891955, 'auroc': 0.9004057, 'binary_precision': 0.4752066, 'binary_recall': 0.34175333, 'binary_specificity': 0.98594123, 'binary_f1_score': 0.39757994}
confusion matrix:
       0    1
0  17813  254
1    443  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.84760845, 'recall': 0.6909512, 'specificity': 0.6909512, 'f1': 0.7442582, 'auroc': 0.91729975, 'binary_precision': 0.7214286, 'binary_recall': 0.38846153, 'binary_specificity': 0.993441, 'binary_f1_score': 0.505}
confusion matrix:
      0    1
0  5907   39
1   159  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_23.png
early stop counter: 8
val acc:0.9628068208694458, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.9689010381698608
after epoch: 23,now: 2024-07-07 12:46:02.586553,epoch time: 0:23:47.162669,used: 8:52:47.922397,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98580027, 'precision': 0.9830756, 'recall': 0.97931504, 'specificity': 0.97931504, 'f1': 0.9811765, 'auroc': 0.9975905, 'binary_precision': 0.9776109, 'binary_recall': 0.96615106, 'binary_specificity': 0.9924791, 'binary_f1_score': 0.97184724}
confusion matrix:
       0      1
0  42096    319
1    488  13929
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.7255938, 'recall': 0.64109707, 'specificity': 0.64109707, 'f1': 0.67247766, 'auroc': 0.89301956, 'binary_precision': 0.47710842, 'binary_recall': 0.29420504, 'binary_specificity': 0.9879891, 'binary_f1_score': 0.36397058}
confusion matrix:
       0    1
0  17850  217
1    475  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.8501807, 'recall': 0.6532465, 'specificity': 0.6532465, 'f1': 0.70965016, 'auroc': 0.9098573, 'binary_precision': 0.7297297, 'binary_recall': 0.31153846, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.4366577}
confusion matrix:
      0   1
0  5916  30
1   179  81
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_24.png
early stop counter: 9
val acc:0.9630736112594604, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.9689010381698608
after epoch: 24,now: 2024-07-07 13:10:08.116646,epoch time: 0:24:05.530093,used: 9:16:53.452490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98631054, 'precision': 0.9851588, 'recall': 0.97856176, 'specificity': 0.97856176, 'f1': 0.98180276, 'auroc': 0.9976684, 'binary_precision': 0.9828685, 'binary_recall': 0.9628294, 'binary_specificity': 0.99429405, 'binary_f1_score': 0.9727458}
confusion matrix:
       0      1
0  42170    242
1    536  13884
---- Validation: 
scalar performance:
{'acc': 0.96205974, 'precision': 0.7209051, 'recall': 0.6791957, 'specificity': 0.6791957, 'f1': 0.69760454, 'auroc': 0.89883935, 'binary_precision': 0.46494466, 'binary_recall': 0.3744428, 'binary_specificity': 0.98394865, 'binary_f1_score': 0.41481483}
confusion matrix:
       0    1
0  17777  290
1    421  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.82172203, 'recall': 0.7013124, 'specificity': 0.7013124, 'f1': 0.7461728, 'auroc': 0.914354, 'binary_precision': 0.66875, 'binary_recall': 0.41153845, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.5095238}
confusion matrix:
      0    1
0  5893   53
1   153  107
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_25.png
early stop counter: 10
val acc:0.962059736251831, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.9689010381698608
after epoch: 25,now: 2024-07-07 13:33:48.026615,epoch time: 0:23:39.909969,used: 9:40:33.362459,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9857827, 'precision': 0.9857168, 'recall': 0.9766047, 'specificity': 0.9766047, 'f1': 0.98105156, 'auroc': 0.99720216, 'binary_precision': 0.9855869, 'binary_recall': 0.9579721, 'binary_specificity': 0.9952373, 'binary_f1_score': 0.97158337}
confusion matrix:
       0      1
0  42211    202
1    606  13813
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.7305222, 'recall': 0.6441796, 'specificity': 0.6441796, 'f1': 0.6762641, 'auroc': 0.89722395, 'binary_precision': 0.486747, 'binary_recall': 0.30014858, 'binary_specificity': 0.98821056, 'binary_f1_score': 0.37132353}
confusion matrix:
       0    1
0  17854  213
1    471  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.8501164, 'recall': 0.66269374, 'specificity': 0.66269374, 'f1': 0.71895415, 'auroc': 0.909023, 'binary_precision': 0.7288136, 'binary_recall': 0.33076924, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.45502648}
confusion matrix:
      0   1
0  5914  32
1   174  86
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_26.png
early stop counter: 11
val acc:0.9635005593299866, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.9689010381698608
after epoch: 26,now: 2024-07-07 13:57:36.077699,epoch time: 0:23:48.051084,used: 10:04:21.413543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9864689, 'precision': 0.98700404, 'recall': 0.97715604, 'specificity': 0.97715604, 'f1': 0.981953, 'auroc': 0.99739695, 'binary_precision': 0.9880578, 'binary_recall': 0.9582495, 'binary_specificity': 0.9960625, 'binary_f1_score': 0.97292536}
confusion matrix:
       0      1
0  42246    167
1    602  13817
---- Validation: 
scalar performance:
{'acc': 0.9633938, 'precision': 0.72655505, 'recall': 0.61622876, 'specificity': 0.61622876, 'f1': 0.6516617, 'auroc': 0.8977895, 'binary_precision': 0.48082596, 'binary_recall': 0.24219911, 'binary_specificity': 0.99025846, 'binary_f1_score': 0.32213438}
confusion matrix:
       0    1
0  17891  176
1    510  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.8530065, 'recall': 0.6476455, 'specificity': 0.6476455, 'f1': 0.70439816, 'auroc': 0.9090864, 'binary_precision': 0.7358491, 'binary_recall': 0.3, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.4262295}
confusion matrix:
      0   1
0  5918  28
1   182  78
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_27.png
early stop counter: 12
val acc:0.9633938074111938, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.9689010381698608
after epoch: 27,now: 2024-07-07 14:21:09.384295,epoch time: 0:23:33.306596,used: 10:27:54.720139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.986117, 'precision': 0.984661, 'recall': 0.9785453, 'specificity': 0.9785453, 'f1': 0.9815536, 'auroc': 0.9975347, 'binary_precision': 0.98176163, 'binary_recall': 0.96317357, 'binary_specificity': 0.993917, 'binary_f1_score': 0.97237873}
confusion matrix:
       0      1
0  42155    258
1    531  13888
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.72569114, 'recall': 0.6368332, 'specificity': 0.6368332, 'f1': 0.6691142, 'auroc': 0.89979047, 'binary_precision': 0.47761193, 'binary_recall': 0.28528973, 'binary_specificity': 0.9883766, 'binary_f1_score': 0.3572093}
confusion matrix:
       0    1
0  17857  210
1    481  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.82693356, 'recall': 0.6657831, 'specificity': 0.6657831, 'f1': 0.71736306, 'auroc': 0.91460127, 'binary_precision': 0.68217057, 'binary_recall': 0.33846155, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.45244214}
confusion matrix:
      0   1
0  5905  41
1   172  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_28.png
early stop counter: 13
val acc:0.9631270170211792, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.9689010381698608
after epoch: 28,now: 2024-07-07 14:45:33.594006,epoch time: 0:24:24.209711,used: 10:52:18.929850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98715514, 'precision': 0.98805904, 'recall': 0.9779362, 'specificity': 0.9779362, 'f1': 0.98286384, 'auroc': 0.9974492, 'binary_precision': 0.9898375, 'binary_recall': 0.95922047, 'binary_specificity': 0.99665195, 'binary_f1_score': 0.9742885}
confusion matrix:
       0      1
0  42271    142
1    588  13831
---- Validation: 
scalar performance:
{'acc': 0.96302027, 'precision': 0.7238825, 'recall': 0.63177097, 'specificity': 0.63177097, 'f1': 0.664521, 'auroc': 0.8959857, 'binary_precision': 0.47435898, 'binary_recall': 0.27488855, 'binary_specificity': 0.98865336, 'binary_f1_score': 0.34807146}
confusion matrix:
       0    1
0  17862  205
1    488  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.8217215, 'recall': 0.6656149, 'specificity': 0.6656149, 'f1': 0.71612126, 'auroc': 0.91126597, 'binary_precision': 0.67175573, 'binary_recall': 0.33846155, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.45012787}
confusion matrix:
      0   1
0  5903  43
1   172  88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_29.png
early stop counter: 14
val acc:0.9630202651023865, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.9689010381698608
after epoch: 29,now: 2024-07-07 15:09:37.052324,epoch time: 0:24:03.458318,used: 11:16:22.388168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9880525, 'precision': 0.9869751, 'recall': 0.9813745, 'specificity': 0.9813745, 'f1': 0.9841334, 'auroc': 0.9976492, 'binary_precision': 0.984826, 'binary_recall': 0.967818, 'binary_specificity': 0.9949309, 'binary_f1_score': 0.9762479}
confusion matrix:
       0      1
0  42199    215
1    464  13954
---- Validation: 
scalar performance:
{'acc': 0.9628068, 'precision': 0.71994597, 'recall': 0.6216465, 'specificity': 0.6216465, 'f1': 0.6550179, 'auroc': 0.89429665, 'binary_precision': 0.46721312, 'binary_recall': 0.25408617, 'binary_specificity': 0.98920685, 'binary_f1_score': 0.32916263}
confusion matrix:
       0    1
0  17872  195
1    502  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.81403273, 'recall': 0.6447133, 'specificity': 0.6447133, 'f1': 0.69497937, 'auroc': 0.907863, 'binary_precision': 0.6581197, 'binary_recall': 0.29615384, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.40848807}
confusion matrix:
      0   1
0  5906  40
1   183  77
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_30.png
early stop counter: 15
val acc:0.9628068208694458, best validation acc: 0.9637673497200012, corresponding to test acc:                         0.9669674634933472 / 0.9689010381698608
after epoch: 30,now: 2024-07-07 15:33:50.010809,epoch time: 0:24:12.958485,used: 11:40:35.346653,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_03_53_14_seed_1_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:40:35.346653 at 2024-07-07 15:33:50.010809
persisted model performance metric: 

scalar performance:
{'acc': 0.96696746, 'precision': 0.85323334, 'recall': 0.6627778, 'specificity': 0.6627778, 'f1': 0.7195999, 'auroc': 0.91425073, 'binary_precision': 0.73504275, 'binary_recall': 0.33076924, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.45623344}
confusion matrix:
      0   1
0  5915  31
1   174  86
oracle model performance metric: 

scalar performance:
{'acc': 0.96890104, 'precision': 0.86276674, 'recall': 0.6895327, 'specificity': 0.6895327, 'f1': 0.74642396, 'auroc': 0.916503, 'binary_precision': 0.7518797, 'binary_recall': 0.3846154, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.5089059}
confusion matrix:
      0    1
0  5913   33
1   160  100
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |  17479 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |  17479 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   7827 MiB |   2381 TiB |   2381 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   2350 TiB |   2350 TiB |
|       from small pool |  16480 KiB |     36 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  16790 MiB |   8278 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  16734 MiB |   8260 MiB |
|       from small pool |     38 MiB |     44 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40878 KiB | 732464 KiB |   1319 TiB |   1319 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1289 TiB |   1289 TiB |
|       from small pool |   9145 KiB |  23272 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7625    |  393258 K  |  393255 K  |
|       from large pool |      79    |     762    |  223190 K  |  223190 K  |
|       from small pool |    2875    |    7544    |  170067 K  |  170064 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7625    |  393258 K  |  393255 K  |
|       from large pool |      79    |     762    |  223190 K  |  223190 K  |
|       from small pool |    2875    |    7544    |  170067 K  |  170064 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |     715    |     347    |
|       from large pool |     349    |     349    |     687    |     338    |
|       from small pool |      19    |      22    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      38    |    3589    |  232520 K  |  232520 K  |
|       from large pool |      11    |     352    |  160864 K  |  160864 K  |
|       from small pool |      27    |    3579    |   71655 K  |   71655 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     36 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  16790 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  26624 KiB |     44 MiB |     56 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1319 TiB |   1319 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1289 TiB |   1289 TiB |
|       from small pool |      0 KiB |  23284 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  393258 K  |  393258 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170067 K  |  170067 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  393258 K  |  393258 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170067 K  |  170067 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     715    |     692    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      13    |      22    |      28    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  232521 K  |  232521 K  |
|       from large pool |       3    |     352    |  160864 K  |  160864 K  |
|       from small pool |       0    |    3579    |   71656 K  |   71656 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     37 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2381 TiB |   2381 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2350 TiB |   2350 TiB |
|       from small pool |      0 KiB |     36 MiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  16790 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  26624 KiB |     44 MiB |     56 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1319 TiB |   1319 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1289 TiB |   1289 TiB |
|       from small pool |      0 KiB |  23284 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  393258 K  |  393258 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170067 K  |  170067 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  393258 K  |  393258 K  |
|       from large pool |       2    |     762    |  223190 K  |  223190 K  |
|       from small pool |       0    |    7544    |  170067 K  |  170067 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     715    |     692    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      13    |      22    |      28    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  232521 K  |  232521 K  |
|       from large pool |       3    |     352    |  160864 K  |  160864 K  |
|       from small pool |       0    |    3579    |   71656 K  |   71656 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437

 Experiment start at: 2024-07-07 15:42:03.685466
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9431581, 'precision': 0.9508151, 'recall': 0.90169746, 'specificity': 0.90169746, 'f1': 0.92271686, 'auroc': 0.96970725, 'binary_precision': 0.96460176, 'binary_recall': 0.814078, 'binary_specificity': 0.98931694, 'binary_f1_score': 0.8829707}
confusion matrix:
       0      1
0  41858    452
1   2813  12317
---- Validation: 
scalar performance:
{'acc': 0.9563735, 'precision': 0.62027895, 'recall': 0.59360695, 'specificity': 0.59360695, 'f1': 0.60498804, 'auroc': 0.78949594, 'binary_precision': 0.26666668, 'binary_recall': 0.20598006, 'binary_specificity': 0.98123384, 'binary_f1_score': 0.23242737}
confusion matrix:
       0    1
0  17830  341
1    478  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9302773, 'precision': 0.52443695, 'recall': 0.52356344, 'specificity': 0.52356344, 'f1': 0.5239848, 'auroc': 0.65171707, 'binary_precision': 0.08583691, 'binary_recall': 0.08264463, 'binary_specificity': 0.96448225, 'binary_f1_score': 0.08421053}
confusion matrix:
      0    1
0  5784  213
1   222   20
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-07 16:06:54.552972,epoch time: 0:24:50.867506,used: 0:24:50.867506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9590355, 'precision': 0.96388733, 'recall': 0.9299638, 'specificity': 0.9299638, 'f1': 0.94527, 'auroc': 0.9810549, 'binary_precision': 0.97304505, 'binary_recall': 0.86853063, 'binary_specificity': 0.991397, 'binary_f1_score': 0.9178221}
confusion matrix:
       0      1
0  41947    364
1   1989  13140
---- Validation: 
scalar performance:
{'acc': 0.9635114, 'precision': 0.6714032, 'recall': 0.59167284, 'specificity': 0.59167284, 'f1': 0.6179613, 'auroc': 0.8184411, 'binary_precision': 0.36908516, 'binary_recall': 0.19435216, 'binary_specificity': 0.98899347, 'binary_f1_score': 0.25462458}
confusion matrix:
       0    1
0  17971  200
1    485  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94245875, 'precision': 0.54786336, 'recall': 0.5318827, 'specificity': 0.5318827, 'f1': 0.5375061, 'auroc': 0.7337291, 'binary_precision': 0.13207547, 'binary_recall': 0.08677686, 'binary_specificity': 0.9769885, 'binary_f1_score': 0.10473815}
confusion matrix:
      0    1
0  5859  138
1   221   21
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-07 16:30:59.580499,epoch time: 0:24:05.027527,used: 0:48:55.895033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96532035, 'precision': 0.96828777, 'recall': 0.9418131, 'specificity': 0.9418131, 'f1': 0.95404494, 'auroc': 0.9869219, 'binary_precision': 0.9740222, 'binary_recall': 0.89213485, 'binary_specificity': 0.9914914, 'binary_f1_score': 0.93128186}
confusion matrix:
       0      1
0  41950    360
1   1632  13498
---- Validation: 
scalar performance:
{'acc': 0.96516275, 'precision': 0.6964129, 'recall': 0.6053746, 'specificity': 0.6053746, 'f1': 0.63563716, 'auroc': 0.8428187, 'binary_precision': 0.418239, 'binary_recall': 0.22093023, 'binary_specificity': 0.98981893, 'binary_f1_score': 0.28913045}
confusion matrix:
       0    1
0  17986  185
1    469  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94438213, 'precision': 0.57926977, 'recall': 0.5566761, 'specificity': 0.5566761, 'f1': 0.5655227, 'auroc': 0.79290605, 'binary_precision': 0.19298245, 'binary_recall': 0.13636364, 'binary_specificity': 0.9769885, 'binary_f1_score': 0.1598063}
confusion matrix:
      0    1
0  5859  138
1   209   33
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-07 16:55:06.522246,epoch time: 0:24:06.941747,used: 1:13:02.836780,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96902853, 'precision': 0.9719143, 'recall': 0.9478724, 'specificity': 0.9478724, 'f1': 0.95906997, 'auroc': 0.9892167, 'binary_precision': 0.97753614, 'binary_recall': 0.9031661, 'binary_specificity': 0.99257874, 'binary_f1_score': 0.9388807}
confusion matrix:
       0      1
0  41997    314
1   1465  13664
---- Validation: 
scalar performance:
{'acc': 0.9653758, 'precision': 0.6998733, 'recall': 0.60789376, 'specificity': 0.60789376, 'f1': 0.63863146, 'auroc': 0.8510786, 'binary_precision': 0.425, 'binary_recall': 0.22591361, 'binary_specificity': 0.98987395, 'binary_f1_score': 0.29501083}
confusion matrix:
       0    1
0  17987  184
1    466  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9471069, 'precision': 0.6116035, 'recall': 0.58386904, 'specificity': 0.58386904, 'f1': 0.5953186, 'auroc': 0.82948226, 'binary_precision': 0.25555557, 'binary_recall': 0.19008264, 'binary_specificity': 0.9776555, 'binary_f1_score': 0.21800949}
confusion matrix:
      0    1
0  5863  134
1   196   46
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-07 17:19:11.546473,epoch time: 0:24:05.024227,used: 1:37:07.861007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97235376, 'precision': 0.97580045, 'recall': 0.95272267, 'specificity': 0.95272267, 'f1': 0.96350986, 'auroc': 0.9916105, 'binary_precision': 0.9825399, 'binary_recall': 0.9112359, 'binary_specificity': 0.9942094, 'binary_f1_score': 0.94554555}
confusion matrix:
       0      1
0  42065    245
1   1343  13787
---- Validation: 
scalar performance:
{'acc': 0.96574867, 'precision': 0.70266074, 'recall': 0.60166204, 'specificity': 0.60166204, 'f1': 0.6336075, 'auroc': 0.85706985, 'binary_precision': 0.43097642, 'binary_recall': 0.21262458, 'binary_specificity': 0.99069947, 'binary_f1_score': 0.28476083}
confusion matrix:
       0    1
0  18002  169
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9498317, 'precision': 0.63877493, 'recall': 0.6070966, 'specificity': 0.6070966, 'f1': 0.620503, 'auroc': 0.8476876, 'binary_precision': 0.30810812, 'binary_recall': 0.23553719, 'binary_specificity': 0.978656, 'binary_f1_score': 0.26697892}
confusion matrix:
      0    1
0  5869  128
1   185   57
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-07 17:43:32.528638,epoch time: 0:24:20.982165,used: 2:01:28.843172,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9750174, 'precision': 0.97653365, 'recall': 0.9587742, 'specificity': 0.9587742, 'f1': 0.9672066, 'auroc': 0.99238646, 'binary_precision': 0.97954893, 'binary_recall': 0.92444974, 'binary_specificity': 0.99309874, 'binary_f1_score': 0.9512021}
confusion matrix:
       0      1
0  42019    292
1   1143  13986
---- Validation: 
scalar performance:
{'acc': 0.96558887, 'precision': 0.7119181, 'recall': 0.6465502, 'specificity': 0.6465502, 'f1': 0.67261803, 'auroc': 0.8654984, 'binary_precision': 0.44660193, 'binary_recall': 0.30564785, 'binary_specificity': 0.9874525, 'binary_f1_score': 0.36291915}
confusion matrix:
       0    1
0  17943  228
1    418  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9411765, 'precision': 0.6292459, 'recall': 0.6541456, 'specificity': 0.6541456, 'f1': 0.64036024, 'auroc': 0.8587972, 'binary_precision': 0.28522336, 'binary_recall': 0.3429752, 'binary_specificity': 0.965316, 'binary_f1_score': 0.31144467}
confusion matrix:
      0    1
0  5789  208
1   159   83
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_6.png
early stop counter: 1
val acc:0.9655888676643372, best validation acc: 0.96574866771698, corresponding to test acc:                         0.9498317241668701 / 0.9498317241668701
after epoch: 6,now: 2024-07-07 18:08:02.648615,epoch time: 0:24:30.119977,used: 2:25:58.963149,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97529596, 'precision': 0.9779367, 'recall': 0.9581802, 'specificity': 0.9581802, 'f1': 0.9675083, 'auroc': 0.9931816, 'binary_precision': 0.98315597, 'binary_recall': 0.9220092, 'binary_specificity': 0.9943512, 'binary_f1_score': 0.9516013}
confusion matrix:
       0      1
0  42071    239
1   1180  13950
---- Validation: 
scalar performance:
{'acc': 0.96660095, 'precision': 0.7217288, 'recall': 0.63984555, 'specificity': 0.63984555, 'f1': 0.6705469, 'auroc': 0.8687725, 'binary_precision': 0.46666667, 'binary_recall': 0.29069766, 'binary_specificity': 0.98899347, 'binary_f1_score': 0.35823947}
confusion matrix:
       0    1
0  17971  200
1    427  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94662607, 'precision': 0.64502853, 'recall': 0.6490494, 'specificity': 0.6490494, 'f1': 0.6470061, 'auroc': 0.866959, 'binary_precision': 0.3172691, 'binary_recall': 0.3264463, 'binary_specificity': 0.9716525, 'binary_f1_score': 0.32179227}
confusion matrix:
      0    1
0  5827  170
1   163   79
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_7.png
better model found
persisted
after epoch: 7,now: 2024-07-07 18:32:02.275554,epoch time: 0:23:59.626939,used: 2:49:58.590088,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9774373, 'precision': 0.9801755, 'recall': 0.9615232, 'specificity': 0.9615232, 'f1': 0.97036123, 'auroc': 0.99292696, 'binary_precision': 0.985608, 'binary_recall': 0.9278916, 'binary_specificity': 0.9951548, 'binary_f1_score': 0.95587933}
confusion matrix:
       0      1
0  42105    205
1   1091  14039
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.7290207, 'recall': 0.6425574, 'specificity': 0.6425574, 'f1': 0.6747063, 'auroc': 0.8725182, 'binary_precision': 0.48108107, 'binary_recall': 0.29568106, 'binary_specificity': 0.9894337, 'binary_f1_score': 0.36625513}
confusion matrix:
       0    1
0  17979  192
1    424  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9471069, 'precision': 0.6537796, 'recall': 0.6671442, 'specificity': 0.6671442, 'f1': 0.66013086, 'auroc': 0.87225705, 'binary_precision': 0.33333334, 'binary_recall': 0.36363637, 'binary_specificity': 0.970652, 'binary_f1_score': 0.34782606}
confusion matrix:
      0    1
0  5821  176
1   154   88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_8.png
better model found
persisted
after epoch: 8,now: 2024-07-07 18:56:19.515675,epoch time: 0:24:17.240121,used: 3:14:15.830209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97820336, 'precision': 0.9779913, 'recall': 0.9655441, 'specificity': 0.9655441, 'f1': 0.97154725, 'auroc': 0.9945148, 'binary_precision': 0.9775621, 'binary_recall': 0.93879306, 'binary_specificity': 0.99229515, 'binary_f1_score': 0.9577855}
confusion matrix:
       0      1
0  41985    326
1    926  14203
---- Validation: 
scalar performance:
{'acc': 0.96526927, 'precision': 0.7116962, 'recall': 0.661643, 'specificity': 0.661643, 'f1': 0.682937, 'auroc': 0.875272, 'binary_precision': 0.44517544, 'binary_recall': 0.3372093, 'binary_specificity': 0.9860767, 'binary_f1_score': 0.38374293}
confusion matrix:
       0    1
0  17918  253
1    399  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93893254, 'precision': 0.63614064, 'recall': 0.68866765, 'specificity': 0.68866765, 'f1': 0.65722674, 'auroc': 0.8722832, 'binary_precision': 0.29618767, 'binary_recall': 0.41735536, 'binary_specificity': 0.95998, 'binary_f1_score': 0.34648368}
confusion matrix:
      0    1
0  5757  240
1   141  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_9.png
early stop counter: 1
val acc:0.9652692675590515, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 9,now: 2024-07-07 19:20:35.498090,epoch time: 0:24:15.982415,used: 3:38:31.812624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9786734, 'precision': 0.9812428, 'recall': 0.96365505, 'specificity': 0.96365505, 'f1': 0.9720156, 'auroc': 0.9945998, 'binary_precision': 0.9863579, 'binary_recall': 0.93191886, 'binary_specificity': 0.99539125, 'binary_f1_score': 0.9583659}
confusion matrix:
       0      1
0  42116    195
1   1030  14099
---- Validation: 
scalar performance:
{'acc': 0.96617484, 'precision': 0.7157036, 'recall': 0.63320106, 'specificity': 0.63320106, 'f1': 0.66366225, 'auroc': 0.8738216, 'binary_precision': 0.45504087, 'binary_recall': 0.27740863, 'binary_specificity': 0.98899347, 'binary_f1_score': 0.34468523}
confusion matrix:
       0    1
0  17971  200
1    435  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9445424, 'precision': 0.64422125, 'recall': 0.6658102, 'specificity': 0.6658102, 'f1': 0.65411264, 'auroc': 0.871978, 'binary_precision': 0.31428573, 'binary_recall': 0.36363637, 'binary_specificity': 0.967984, 'binary_f1_score': 0.33716476}
confusion matrix:
      0    1
0  5805  192
1   154   88
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_10.png
early stop counter: 2
val acc:0.966174840927124, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 10,now: 2024-07-07 19:45:03.010371,epoch time: 0:24:27.512281,used: 4:02:59.324905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9799965, 'precision': 0.98161936, 'recall': 0.96665514, 'specificity': 0.96665514, 'f1': 0.9738228, 'auroc': 0.99511635, 'binary_precision': 0.9848779, 'binary_recall': 0.93846256, 'binary_specificity': 0.99484766, 'binary_f1_score': 0.9611101}
confusion matrix:
       0      1
0  42093    218
1    931  14198
---- Validation: 
scalar performance:
{'acc': 0.96612155, 'precision': 0.7196855, 'recall': 0.6612802, 'specificity': 0.6612802, 'f1': 0.6855199, 'auroc': 0.88003755, 'binary_precision': 0.4611872, 'binary_recall': 0.33554816, 'binary_specificity': 0.98701227, 'binary_f1_score': 0.38846153}
confusion matrix:
       0    1
0  17935  236
1    400  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9418176, 'precision': 0.6444299, 'recall': 0.6901684, 'specificity': 0.6901684, 'f1': 0.6635256, 'auroc': 0.8735825, 'binary_precision': 0.3126935, 'binary_recall': 0.41735536, 'binary_specificity': 0.96298146, 'binary_f1_score': 0.3575221}
confusion matrix:
      0    1
0  5775  222
1   141  101
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_11.png
early stop counter: 3
val acc:0.9661215543746948, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 11,now: 2024-07-07 20:09:04.596278,epoch time: 0:24:01.585907,used: 4:27:00.910812,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9816504, 'precision': 0.98094153, 'recall': 0.971557, 'specificity': 0.971557, 'f1': 0.9761244, 'auroc': 0.99577606, 'binary_precision': 0.9794917, 'binary_recall': 0.95022804, 'binary_specificity': 0.992886, 'binary_f1_score': 0.964638}
confusion matrix:
       0      1
0  42010    301
1    753  14376
---- Validation: 
scalar performance:
{'acc': 0.9639376, 'precision': 0.7058327, 'recall': 0.68825877, 'specificity': 0.68825877, 'f1': 0.69660723, 'auroc': 0.8840831, 'binary_precision': 0.431694, 'binary_recall': 0.3936877, 'binary_specificity': 0.9828298, 'binary_f1_score': 0.41181582}
confusion matrix:
       0    1
0  17859  312
1    365  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9309184, 'precision': 0.62632084, 'recall': 0.71225727, 'specificity': 0.71225727, 'f1': 0.65574235, 'auroc': 0.87203175, 'binary_precision': 0.274463, 'binary_recall': 0.4752066, 'binary_specificity': 0.949308, 'binary_f1_score': 0.34795764}
confusion matrix:
      0    1
0  5693  304
1   127  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_12.png
early stop counter: 4
val acc:0.9639375805854797, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 12,now: 2024-07-07 20:33:02.228905,epoch time: 0:23:57.632627,used: 4:50:58.543439,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98086697, 'precision': 0.98359835, 'recall': 0.96701443, 'specificity': 0.96701443, 'f1': 0.974923, 'auroc': 0.9956573, 'binary_precision': 0.9890554, 'binary_recall': 0.9377396, 'binary_specificity': 0.9962893, 'binary_f1_score': 0.96271414}
confusion matrix:
       0      1
0  42153    157
1    942  14188
---- Validation: 
scalar performance:
{'acc': 0.96665424, 'precision': 0.7261367, 'recall': 0.67119193, 'specificity': 0.67119193, 'f1': 0.69445884, 'auroc': 0.88275975, 'binary_precision': 0.47345132, 'binary_recall': 0.3554817, 'binary_specificity': 0.9869022, 'binary_f1_score': 0.4060721}
confusion matrix:
       0    1
0  17933  238
1    388  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93749, 'precision': 0.63500035, 'recall': 0.6958483, 'specificity': 0.6958483, 'f1': 0.6585831, 'auroc': 0.8705372, 'binary_precision': 0.2932961, 'binary_recall': 0.4338843, 'binary_specificity': 0.95781225, 'binary_f1_score': 0.35000002}
confusion matrix:
      0    1
0  5744  253
1   137  105
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_13.png
early stop counter: 5
val acc:0.9666542410850525, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 13,now: 2024-07-07 20:56:55.459091,epoch time: 0:23:53.230186,used: 5:14:51.773625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.982695, 'precision': 0.9835789, 'recall': 0.9716716, 'specificity': 0.9716716, 'f1': 0.9774263, 'auroc': 0.99542534, 'binary_precision': 0.9853719, 'binary_recall': 0.9483773, 'binary_specificity': 0.99496585, 'binary_f1_score': 0.9665207}
confusion matrix:
       0      1
0  42098    213
1    781  14348
---- Validation: 
scalar performance:
{'acc': 0.9645235, 'precision': 0.71320146, 'recall': 0.70703155, 'specificity': 0.70703155, 'f1': 0.71006584, 'auroc': 0.88909173, 'binary_precision': 0.44520548, 'binary_recall': 0.43189368, 'binary_specificity': 0.9821694, 'binary_f1_score': 0.43844855}
confusion matrix:
       0    1
0  17847  324
1    342  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92867446, 'precision': 0.6237067, 'recall': 0.7170383, 'specificity': 0.7170383, 'f1': 0.6544139, 'auroc': 0.8733251, 'binary_precision': 0.26879272, 'binary_recall': 0.4876033, 'binary_specificity': 0.94647324, 'binary_f1_score': 0.34654918}
confusion matrix:
      0    1
0  5676  321
1   124  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_14.png
early stop counter: 6
val acc:0.9645234942436218, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 14,now: 2024-07-07 21:20:18.571367,epoch time: 0:23:23.112276,used: 5:38:14.885901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9834262, 'precision': 0.983884, 'recall': 0.97325075, 'specificity': 0.97325075, 'f1': 0.9784086, 'auroc': 0.99656, 'binary_precision': 0.9848164, 'binary_recall': 0.9517483, 'binary_specificity': 0.9947531, 'binary_f1_score': 0.96800005}
confusion matrix:
       0      1
0  42089    222
1    730  14399
---- Validation: 
scalar performance:
{'acc': 0.9635647, 'precision': 0.70554024, 'recall': 0.7009149, 'specificity': 0.7009149, 'f1': 0.7031981, 'auroc': 0.8887058, 'binary_precision': 0.4302721, 'binary_recall': 0.4202658, 'binary_specificity': 0.98156404, 'binary_f1_score': 0.4252101}
confusion matrix:
       0    1
0  17836  335
1    349  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.928995, 'precision': 0.6273111, 'recall': 0.72711873, 'specificity': 0.72711873, 'f1': 0.6597309, 'auroc': 0.87323, 'binary_precision': 0.2751678, 'binary_recall': 0.5082645, 'binary_specificity': 0.945973, 'binary_f1_score': 0.35703924}
confusion matrix:
      0    1
0  5673  324
1   119  123
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_15.png
early stop counter: 7
val acc:0.9635646939277649, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 15,now: 2024-07-07 21:44:44.579679,epoch time: 0:24:26.008312,used: 6:02:40.894213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98339134, 'precision': 0.98578006, 'recall': 0.97136045, 'specificity': 0.97136045, 'f1': 0.9782812, 'auroc': 0.99621844, 'binary_precision': 0.99058694, 'binary_recall': 0.94593525, 'binary_specificity': 0.99678564, 'binary_f1_score': 0.96774626}
confusion matrix:
       0      1
0  42174    136
1    818  14312
---- Validation: 
scalar performance:
{'acc': 0.9635114, 'precision': 0.70367205, 'recall': 0.6928569, 'specificity': 0.6928569, 'f1': 0.69809914, 'auroc': 0.8887206, 'binary_precision': 0.427065, 'binary_recall': 0.4036545, 'binary_specificity': 0.9820593, 'binary_f1_score': 0.41502988}
confusion matrix:
       0    1
0  17845  326
1    359  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.924988, 'precision': 0.6169734, 'recall': 0.7151207, 'specificity': 0.7151207, 'f1': 0.64773935, 'auroc': 0.86750054, 'binary_precision': 0.25541127, 'binary_recall': 0.4876033, 'binary_specificity': 0.942638, 'binary_f1_score': 0.33522728}
confusion matrix:
      0    1
0  5653  344
1   124  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_16.png
early stop counter: 8
val acc:0.9635114073753357, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 16,now: 2024-07-07 22:08:42.645350,epoch time: 0:23:58.065671,used: 6:26:38.959884,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9847667, 'precision': 0.9856832, 'recall': 0.97494626, 'specificity': 0.97494626, 'f1': 0.98015356, 'auroc': 0.99708986, 'binary_precision': 0.9875496, 'binary_recall': 0.95419395, 'binary_specificity': 0.9956985, 'binary_f1_score': 0.9705852}
confusion matrix:
       0      1
0  42129    182
1    693  14436
---- Validation: 
scalar performance:
{'acc': 0.9637245, 'precision': 0.70488393, 'recall': 0.69136083, 'specificity': 0.69136083, 'f1': 0.697864, 'auroc': 0.8891414, 'binary_precision': 0.42959002, 'binary_recall': 0.4003322, 'binary_specificity': 0.9823895, 'binary_f1_score': 0.41444543}
confusion matrix:
       0    1
0  17851  320
1    361  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9272319, 'precision': 0.6165968, 'recall': 0.70240873, 'specificity': 0.70240873, 'f1': 0.6449672, 'auroc': 0.86409664, 'binary_precision': 0.25576037, 'binary_recall': 0.45867768, 'binary_specificity': 0.94613975, 'binary_f1_score': 0.32840237}
confusion matrix:
      0    1
0  5674  323
1   131  111
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_17.png
early stop counter: 9
val acc:0.9637244939804077, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 17,now: 2024-07-07 22:32:10.631455,epoch time: 0:23:27.986105,used: 6:50:06.945989,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98318243, 'precision': 0.9818889, 'recall': 0.97459275, 'specificity': 0.97459275, 'f1': 0.97816527, 'auroc': 0.9965367, 'binary_precision': 0.97922444, 'binary_recall': 0.9564413, 'binary_specificity': 0.9927442, 'binary_f1_score': 0.9676988}
confusion matrix:
       0      1
0  42004    307
1    659  14470
---- Validation: 
scalar performance:
{'acc': 0.96399087, 'precision': 0.71122193, 'recall': 0.71799904, 'specificity': 0.71799904, 'f1': 0.71455055, 'auroc': 0.89582276, 'binary_precision': 0.44051448, 'binary_recall': 0.4551495, 'binary_specificity': 0.9808486, 'binary_f1_score': 0.4477124}
confusion matrix:
       0    1
0  17823  348
1    328  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9256291, 'precision': 0.6222713, 'recall': 0.7293333, 'specificity': 0.7293333, 'f1': 0.65534884, 'auroc': 0.8698351, 'binary_precision': 0.2648305, 'binary_recall': 0.5165289, 'binary_specificity': 0.9421377, 'binary_f1_score': 0.35014004}
confusion matrix:
      0    1
0  5650  347
1   117  125
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_18.png
early stop counter: 10
val acc:0.9639908671379089, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 18,now: 2024-07-07 22:55:38.047388,epoch time: 0:23:27.415933,used: 7:13:34.361922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98525417, 'precision': 0.98648053, 'recall': 0.9754257, 'specificity': 0.9754257, 'f1': 0.9807828, 'auroc': 0.99691355, 'binary_precision': 0.98897564, 'binary_recall': 0.9546566, 'binary_specificity': 0.99619484, 'binary_f1_score': 0.97151315}
confusion matrix:
       0      1
0  42150    161
1    686  14443
---- Validation: 
scalar performance:
{'acc': 0.9628189, 'precision': 0.702966, 'recall': 0.7133784, 'specificity': 0.7133784, 'f1': 0.7080259, 'auroc': 0.89308226, 'binary_precision': 0.4242902, 'binary_recall': 0.44684386, 'binary_specificity': 0.97991306, 'binary_f1_score': 0.4352751}
confusion matrix:
       0    1
0  17806  365
1    333  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91985893, 'precision': 0.6162571, 'recall': 0.73822826, 'specificity': 0.73822826, 'f1': 0.65057766, 'auroc': 0.86715114, 'binary_precision': 0.25192308, 'binary_recall': 0.5413223, 'binary_specificity': 0.93513423, 'binary_f1_score': 0.34383202}
confusion matrix:
      0    1
0  5608  389
1   111  131
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_19.png
early stop counter: 11
val acc:0.9628189206123352, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 19,now: 2024-07-07 23:20:48.608445,epoch time: 0:25:10.561057,used: 7:38:44.922979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9839659, 'precision': 0.98669165, 'recall': 0.9719627, 'specificity': 0.9719627, 'f1': 0.97902656, 'auroc': 0.99675816, 'binary_precision': 0.9921718, 'binary_recall': 0.94659615, 'binary_specificity': 0.99732924, 'binary_f1_score': 0.96884835}
confusion matrix:
       0      1
0  42197    113
1    808  14322
---- Validation: 
scalar performance:
{'acc': 0.96526927, 'precision': 0.7149351, 'recall': 0.6809162, 'specificity': 0.6809162, 'f1': 0.6962979, 'auroc': 0.89219874, 'binary_precision': 0.45039684, 'binary_recall': 0.37707642, 'binary_specificity': 0.98475593, 'binary_f1_score': 0.41048822}
confusion matrix:
       0    1
0  17894  277
1    375  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93604743, 'precision': 0.6377278, 'recall': 0.7149253, 'specificity': 0.7149253, 'f1': 0.66599303, 'auroc': 0.8688545, 'binary_precision': 0.29715762, 'binary_recall': 0.4752066, 'binary_specificity': 0.95464396, 'binary_f1_score': 0.36565977}
confusion matrix:
      0    1
0  5725  272
1   127  115
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_20.png
early stop counter: 12
val acc:0.9652692675590515, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 20,now: 2024-07-07 23:48:18.788521,epoch time: 0:27:30.180076,used: 8:06:15.103055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9859505, 'precision': 0.9872433, 'recall': 0.9764731, 'specificity': 0.9764731, 'f1': 0.9816968, 'auroc': 0.99764466, 'binary_precision': 0.9898762, 'binary_recall': 0.95644414, 'binary_specificity': 0.996502, 'binary_f1_score': 0.9728731}
confusion matrix:
       0      1
0  42162    148
1    659  14471
---- Validation: 
scalar performance:
{'acc': 0.96542907, 'precision': 0.7203758, 'recall': 0.7115146, 'specificity': 0.7115146, 'f1': 0.71584386, 'auroc': 0.8961259, 'binary_precision': 0.4592721, 'binary_recall': 0.44019935, 'binary_specificity': 0.9828298, 'binary_f1_score': 0.4495335}
confusion matrix:
       0    1
0  17859  312
1    337  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9338035, 'precision': 0.63373137, 'recall': 0.71772355, 'specificity': 0.71772355, 'f1': 0.6633805, 'auroc': 0.86955595, 'binary_precision': 0.2888889, 'binary_recall': 0.48347107, 'binary_specificity': 0.951976, 'binary_f1_score': 0.36166924}
confusion matrix:
      0    1
0  5709  288
1   125  117
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_21.png
early stop counter: 13
val acc:0.9654290676116943, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 21,now: 2024-07-08 00:15:31.270337,epoch time: 0:27:12.481816,used: 8:33:27.584871,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98537606, 'precision': 0.9854252, 'recall': 0.9767624, 'specificity': 0.9767624, 'f1': 0.98098856, 'auroc': 0.99737024, 'binary_precision': 0.98552597, 'binary_recall': 0.95855916, 'binary_specificity': 0.99496573, 'binary_f1_score': 0.9718555}
confusion matrix:
       0      1
0  42097    213
1    627  14503
---- Validation: 
scalar performance:
{'acc': 0.9640974, 'precision': 0.7128764, 'recall': 0.7244785, 'specificity': 0.7244785, 'f1': 0.7185051, 'auroc': 0.90052104, 'binary_precision': 0.44339624, 'binary_recall': 0.46843854, 'binary_specificity': 0.9805184, 'binary_f1_score': 0.45557353}
confusion matrix:
       0    1
0  17817  354
1    320  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9267511, 'precision': 0.622517, 'recall': 0.72396874, 'specificity': 0.72396874, 'f1': 0.6546349, 'auroc': 0.86914253, 'binary_precision': 0.2657952, 'binary_recall': 0.5041322, 'binary_specificity': 0.9438052, 'binary_f1_score': 0.34807417}
confusion matrix:
      0    1
0  5660  337
1   120  122
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_22.png
early stop counter: 14
val acc:0.9640973806381226, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 22,now: 2024-07-08 00:43:36.663656,epoch time: 0:28:05.393319,used: 9:01:32.978190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9868907, 'precision': 0.9878393, 'recall': 0.9782988, 'specificity': 0.9782988, 'f1': 0.9829424, 'auroc': 0.9974952, 'binary_precision': 0.98977923, 'binary_recall': 0.9601428, 'binary_specificity': 0.99645483, 'binary_f1_score': 0.9747358}
confusion matrix:
       0      1
0  42161    150
1    603  14526
---- Validation: 
scalar performance:
{'acc': 0.96463007, 'precision': 0.71775615, 'recall': 0.73519325, 'specificity': 0.73519325, 'f1': 0.7260992, 'auroc': 0.9019277, 'binary_precision': 0.452454, 'binary_recall': 0.4900332, 'binary_specificity': 0.9803533, 'binary_f1_score': 0.47049442}
confusion matrix:
       0    1
0  17814  357
1    307  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92707163, 'precision': 0.6242791, 'recall': 0.72810096, 'specificity': 0.72810096, 'f1': 0.6570663, 'auroc': 0.87020993, 'binary_precision': 0.26898047, 'binary_recall': 0.5123967, 'binary_specificity': 0.9438052, 'binary_f1_score': 0.3527738}
confusion matrix:
      0    1
0  5660  337
1   118  124
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_23.png
early stop counter: 15
val acc:0.9646300673484802, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 23,now: 2024-07-08 01:09:20.915951,epoch time: 0:25:44.252295,used: 9:27:17.230485,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9858809, 'precision': 0.98633766, 'recall': 0.97716886, 'specificity': 0.97716886, 'f1': 0.9816357, 'auroc': 0.9970781, 'binary_precision': 0.98727286, 'binary_recall': 0.95875746, 'binary_specificity': 0.99558026, 'binary_f1_score': 0.9728062}
confusion matrix:
       0      1
0  42123    187
1    624  14506
---- Validation: 
scalar performance:
{'acc': 0.9631918, 'precision': 0.7076154, 'recall': 0.7272229, 'specificity': 0.7272229, 'f1': 0.71692264, 'auroc': 0.89967406, 'binary_precision': 0.43267778, 'binary_recall': 0.47508305, 'binary_specificity': 0.9793627, 'binary_f1_score': 0.45288995}
confusion matrix:
       0    1
0  17796  375
1    316  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92450714, 'precision': 0.6167541, 'recall': 0.71685326, 'specificity': 0.71685326, 'f1': 0.6478318, 'auroc': 0.86350477, 'binary_precision': 0.254818, 'binary_recall': 0.49173555, 'binary_specificity': 0.941971, 'binary_f1_score': 0.33568406}
confusion matrix:
      0    1
0  5649  348
1   123  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_24.png
early stop counter: 16
val acc:0.96319180727005, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 24,now: 2024-07-08 01:32:45.763272,epoch time: 0:23:24.847321,used: 9:50:42.077806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98659474, 'precision': 0.98777, 'recall': 0.9776096, 'specificity': 0.9776096, 'f1': 0.9825462, 'auroc': 0.9976795, 'binary_precision': 0.99016863, 'binary_recall': 0.9586225, 'binary_specificity': 0.99659663, 'binary_f1_score': 0.9741402}
confusion matrix:
       0      1
0  42167    144
1    626  14503
---- Validation: 
scalar performance:
{'acc': 0.9645235, 'precision': 0.71756524, 'recall': 0.7391535, 'specificity': 0.7391535, 'f1': 0.7277882, 'auroc': 0.90275955, 'binary_precision': 0.45180723, 'binary_recall': 0.49833888, 'binary_specificity': 0.9799681, 'binary_f1_score': 0.47393367}
confusion matrix:
       0    1
0  17807  364
1    302  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9294759, 'precision': 0.6252643, 'recall': 0.71745515, 'specificity': 0.71745515, 'f1': 0.6559153, 'auroc': 0.8705889, 'binary_precision': 0.2718894, 'binary_recall': 0.4876033, 'binary_specificity': 0.947307, 'binary_f1_score': 0.34911242}
confusion matrix:
      0    1
0  5681  316
1   124  118
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_25.png
early stop counter: 17
val acc:0.9645234942436218, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 25,now: 2024-07-08 01:56:09.631105,epoch time: 0:23:23.867833,used: 10:14:05.945639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.985968, 'precision': 0.9875666, 'recall': 0.9762075, 'specificity': 0.9762075, 'f1': 0.9817078, 'auroc': 0.9975383, 'binary_precision': 0.99081624, 'binary_recall': 0.955582, 'binary_specificity': 0.99683297, 'binary_f1_score': 0.97288024}
confusion matrix:
       0      1
0  42177    134
1    672  14457
---- Validation: 
scalar performance:
{'acc': 0.9638843, 'precision': 0.7102654, 'recall': 0.7163379, 'specificity': 0.7163379, 'f1': 0.71325326, 'auroc': 0.89802265, 'binary_precision': 0.43870968, 'binary_recall': 0.45182723, 'binary_specificity': 0.9808486, 'binary_f1_score': 0.44517186}
confusion matrix:
       0    1
0  17823  348
1    330  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92979646, 'precision': 0.6227981, 'recall': 0.7077082, 'specificity': 0.7077082, 'f1': 0.6516434, 'auroc': 0.86357623, 'binary_precision': 0.26777253, 'binary_recall': 0.46694216, 'binary_specificity': 0.9484742, 'binary_f1_score': 0.34036148}
confusion matrix:
      0    1
0  5688  309
1   129  113
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_26.png
early stop counter: 18
val acc:0.9638842940330505, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 26,now: 2024-07-08 02:19:27.401599,epoch time: 0:23:17.770494,used: 10:37:23.716133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9885446, 'precision': 0.988559, 'recall': 0.9818429, 'specificity': 0.9818429, 'f1': 0.98513806, 'auroc': 0.9978697, 'binary_precision': 0.9885888, 'binary_recall': 0.9676801, 'binary_specificity': 0.99600565, 'binary_f1_score': 0.97802275}
confusion matrix:
       0      1
0  42141    169
1    489  14641
---- Validation: 
scalar performance:
{'acc': 0.95983595, 'precision': 0.69462013, 'recall': 0.7552022, 'specificity': 0.7552022, 'f1': 0.72028434, 'auroc': 0.904078, 'binary_precision': 0.4047619, 'binary_recall': 0.53654486, 'binary_specificity': 0.9738594, 'binary_f1_score': 0.46142858}
confusion matrix:
       0    1
0  17696  475
1    279  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9168136, 'precision': 0.61122173, 'recall': 0.7346614, 'specificity': 0.7346614, 'f1': 0.6446992, 'auroc': 0.86638916, 'binary_precision': 0.24208567, 'binary_recall': 0.5371901, 'binary_specificity': 0.9321327, 'binary_f1_score': 0.33376125}
confusion matrix:
      0    1
0  5590  407
1   112  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_27.png
early stop counter: 19
val acc:0.959835946559906, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 27,now: 2024-07-08 02:43:04.749423,epoch time: 0:23:37.347824,used: 11:01:01.063957,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9873607, 'precision': 0.98807263, 'recall': 0.97927725, 'specificity': 0.97927725, 'f1': 0.98356724, 'auroc': 0.9977305, 'binary_precision': 0.98953235, 'binary_recall': 0.9621943, 'binary_specificity': 0.9963602, 'binary_f1_score': 0.9756718}
confusion matrix:
       0      1
0  42156    154
1    572  14558
---- Validation: 
scalar performance:
{'acc': 0.9635114, 'precision': 0.71138763, 'recall': 0.7394337, 'specificity': 0.7394337, 'f1': 0.7244313, 'auroc': 0.90581876, 'binary_precision': 0.43941605, 'binary_recall': 0.5, 'binary_specificity': 0.9788674, 'binary_f1_score': 0.46775445}
confusion matrix:
       0    1
0  17787  384
1    301  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9313993, 'precision': 0.62975407, 'recall': 0.7204384, 'specificity': 0.7204384, 'f1': 0.66056156, 'auroc': 0.8709766, 'binary_precision': 0.2806604, 'binary_recall': 0.49173555, 'binary_specificity': 0.94914126, 'binary_f1_score': 0.35735738}
confusion matrix:
      0    1
0  5692  305
1   123  119
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_28.png
early stop counter: 20
val acc:0.9635114073753357, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 28,now: 2024-07-08 03:06:25.453657,epoch time: 0:23:20.704234,used: 11:24:21.768191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98800486, 'precision': 0.98812306, 'recall': 0.98088217, 'specificity': 0.98088217, 'f1': 0.9844295, 'auroc': 0.99802744, 'binary_precision': 0.9883666, 'binary_recall': 0.9658295, 'binary_specificity': 0.9959348, 'binary_f1_score': 0.97696805}
confusion matrix:
       0      1
0  42138    172
1    517  14613
---- Validation: 
scalar performance:
{'acc': 0.9590369, 'precision': 0.69267637, 'recall': 0.764426, 'specificity': 0.764426, 'f1': 0.72215164, 'auroc': 0.90635526, 'binary_precision': 0.40023896, 'binary_recall': 0.5564784, 'binary_specificity': 0.97237355, 'binary_f1_score': 0.46560112}
confusion matrix:
       0    1
0  17669  502
1    267  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9182561, 'precision': 0.61330044, 'recall': 0.73541176, 'specificity': 0.73541176, 'f1': 0.6470512, 'auroc': 0.87110305, 'binary_precision': 0.24621212, 'binary_recall': 0.5371901, 'binary_specificity': 0.9336335, 'binary_f1_score': 0.33766234}
confusion matrix:
      0    1
0  5599  398
1   112  130
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_29.png
early stop counter: 21
val acc:0.9590368866920471, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 29,now: 2024-07-08 03:29:48.260508,epoch time: 0:23:22.806851,used: 11:47:44.575042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9885968, 'precision': 0.9898821, 'recall': 0.98068833, 'specificity': 0.98068833, 'f1': 0.98516816, 'auroc': 0.9980211, 'binary_precision': 0.99251395, 'binary_recall': 0.96397644, 'binary_specificity': 0.9974002, 'binary_f1_score': 0.97803706}
confusion matrix:
       0      1
0  42201    110
1    545  14584
---- Validation: 
scalar performance:
{'acc': 0.963618, 'precision': 0.7095294, 'recall': 0.7226247, 'specificity': 0.7226247, 'f1': 0.7158545, 'auroc': 0.906194, 'binary_precision': 0.43681747, 'binary_recall': 0.4651163, 'binary_specificity': 0.9801332, 'binary_f1_score': 0.45052293}
confusion matrix:
       0    1
0  17810  361
1    322  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9307581, 'precision': 0.62536895, 'recall': 0.7101912, 'specificity': 0.7101912, 'f1': 0.65445006, 'auroc': 0.8616829, 'binary_precision': 0.27272728, 'binary_recall': 0.47107437, 'binary_specificity': 0.949308, 'binary_f1_score': 0.34545454}
confusion matrix:
      0    1
0  5693  304
1   128  114
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center0_21716437_30.png
early stop counter: 22
val acc:0.9636179804801941, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.9471068978309631 / 0.9498317241668701
after epoch: 30,now: 2024-07-08 03:53:23.306586,epoch time: 0:23:35.046078,used: 12:11:19.621120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_07_15_42_03_seed_2_21716437
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:11:19.621120 at 2024-07-08 03:53:23.306586
persisted model performance metric: 

scalar performance:
{'acc': 0.9471069, 'precision': 0.6537796, 'recall': 0.6671442, 'specificity': 0.6671442, 'f1': 0.66013086, 'auroc': 0.87225705, 'binary_precision': 0.33333334, 'binary_recall': 0.36363637, 'binary_specificity': 0.970652, 'binary_f1_score': 0.34782606}
confusion matrix:
      0    1
0  5821  176
1   154   88
oracle model performance metric: 

scalar performance:
{'acc': 0.9498317, 'precision': 0.63877493, 'recall': 0.6070966, 'specificity': 0.6070966, 'f1': 0.620503, 'auroc': 0.8476876, 'binary_precision': 0.30810812, 'binary_recall': 0.23553719, 'binary_specificity': 0.978656, 'binary_f1_score': 0.26697892}
confusion matrix:
      0    1
0  5869  128
1   185   57
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |  17485 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |  17485 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   7827 MiB |   3575 TiB |   3575 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   3529 TiB |   3529 TiB |
|       from small pool |  16481 KiB |     36 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  25070 MiB |  16558 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25002 MiB |  16528 MiB |
|       from small pool |     38 MiB |     44 MiB |     68 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38824 KiB | 732464 KiB |   1973 TiB |   1973 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1927 TiB |   1927 TiB |
|       from small pool |   7091 KiB |  23284 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7675    |  590646 K  |  590643 K  |
|       from large pool |      79    |     762    |  335134 K  |  335133 K  |
|       from small pool |    2887    |    7594    |  255512 K  |  255509 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7675    |  590646 K  |  590643 K  |
|       from large pool |      79    |     762    |  335134 K  |  335133 K  |
|       from small pool |    2887    |    7594    |  255512 K  |  255509 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |    1060    |     692    |
|       from large pool |     349    |     349    |    1026    |     677    |
|       from small pool |      19    |      22    |      34    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3612    |  344435 K  |  344435 K  |
|       from large pool |      11    |     352    |  236178 K  |  236178 K  |
|       from small pool |      22    |    3602    |  108257 K  |  108257 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |      0 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   3575 TiB |   3575 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3529 TiB |   3529 TiB |
|       from small pool |      0 KiB |     37 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   3575 TiB |   3575 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   3529 TiB |   3529 TiB |
|       from small pool |      0 KiB |     36 MiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  25070 MiB |  24840 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25002 MiB |  24796 MiB |
|       from small pool |  24576 KiB |     44 MiB |     68 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1973 TiB |   1973 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1927 TiB |   1927 TiB |
|       from small pool |      0 KiB |  23284 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7675    |  590646 K  |  590646 K  |
|       from large pool |       2    |     762    |  335134 K  |  335134 K  |
|       from small pool |       0    |    7594    |  255512 K  |  255512 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7675    |  590646 K  |  590646 K  |
|       from large pool |       2    |     762    |  335134 K  |  335134 K  |
|       from small pool |       0    |    7594    |  255512 K  |  255512 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |    1060    |    1038    |
|       from large pool |      10    |     349    |    1026    |    1016    |
|       from small pool |      12    |      22    |      34    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |  344436 K  |  344436 K  |
|       from large pool |       3    |     352    |  236178 K  |  236178 K  |
|       from small pool |       0    |    3602    |  108258 K  |  108258 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul  8 03:54:45 2024]
Finished job 0.
1 of 1 steps (100%) done
