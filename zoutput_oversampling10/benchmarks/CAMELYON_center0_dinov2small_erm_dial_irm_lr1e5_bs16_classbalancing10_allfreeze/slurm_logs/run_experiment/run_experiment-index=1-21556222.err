Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jun 25 04:58:02 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222

 Experiment start at: 2024-06-25 05:09:19.158540
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.86074686, 'precision': 0.8631346, 'recall': 0.75747395, 'specificity': 0.75747395, 'f1': 0.7901691, 'auroc': 0.91705984, 'binary_precision': 0.8666667, 'binary_recall': 0.5440587, 'binary_specificity': 0.97088915, 'binary_f1_score': 0.66847533}
confusion matrix:
       0     1
0  41089  1232
1   6711  8008
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.94093233, 'precision': 0.61159664, 'recall': 0.6573968, 'specificity': 0.6573968, 'f1': 0.6297326, 'auroc': 0.8245094, 'binary_precision': 0.24647123, 'binary_recall': 0.35303265, 'binary_specificity': 0.961761, 'binary_f1_score': 0.29028133}
confusion matrix:
       0    1
0  17455  694
1    416  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9356024, 'precision': 0.5999359, 'recall': 0.60176545, 'specificity': 0.60176545, 'f1': 0.60084, 'auroc': 0.8283535, 'binary_precision': 0.23308271, 'binary_recall': 0.23754789, 'binary_specificity': 0.965983, 'binary_f1_score': 0.23529413}
confusion matrix:
      0    1
0  5793  204
1   199   62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-25 05:34:30.615177,epoch time: 0:25:11.456637,used: 0:25:11.456637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9095547, 'precision': 0.9070699, 'recall': 0.8502774, 'specificity': 0.8502774, 'f1': 0.8734766, 'auroc': 0.95248926, 'binary_precision': 0.9028152, 'binary_recall': 0.7277978, 'binary_specificity': 0.9727571, 'binary_f1_score': 0.805914}
confusion matrix:
       0      1
0  41170   1153
1   4006  10711
---- Validation: 
scalar performance:
{'acc': 0.95258623, 'precision': 0.6572054, 'recall': 0.68368167, 'specificity': 0.68368167, 'f1': 0.66924655, 'auroc': 0.8471719, 'binary_precision': 0.33597884, 'binary_recall': 0.39502332, 'binary_specificity': 0.97234005, 'binary_f1_score': 0.3631165}
confusion matrix:
       0    1
0  17647  502
1    389  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495046, 'precision': 0.6730404, 'recall': 0.6474981, 'specificity': 0.6474981, 'f1': 0.6590697, 'auroc': 0.8731499, 'binary_precision': 0.37556562, 'binary_recall': 0.31800765, 'binary_specificity': 0.9769885, 'binary_f1_score': 0.34439835}
confusion matrix:
      0    1
0  5859  138
1   178   83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-25 05:59:12.215684,epoch time: 0:24:41.600507,used: 0:49:53.057144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9215638, 'precision': 0.9191289, 'recall': 0.8712591, 'specificity': 0.8712591, 'f1': 0.8916086, 'auroc': 0.96137583, 'binary_precision': 0.9148367, 'binary_recall': 0.7673486, 'binary_specificity': 0.97516954, 'binary_f1_score': 0.83462703}
confusion matrix:
       0      1
0  41276   1051
1   3423  11290
---- Validation: 
scalar performance:
{'acc': 0.9549276, 'precision': 0.67195356, 'recall': 0.69989496, 'specificity': 0.69989496, 'f1': 0.6847133, 'auroc': 0.8577777, 'binary_precision': 0.3643617, 'binary_recall': 0.42612752, 'binary_specificity': 0.97366244, 'binary_f1_score': 0.39283156}
confusion matrix:
       0    1
0  17671  478
1    369  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95605624, 'precision': 0.7244783, 'recall': 0.7187128, 'specificity': 0.7187128, 'f1': 0.7215523, 'auroc': 0.8906765, 'binary_precision': 0.47244096, 'binary_recall': 0.4597701, 'binary_specificity': 0.9776555, 'binary_f1_score': 0.46601942}
confusion matrix:
      0    1
0  5863  134
1   141  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-25 06:23:40.555350,epoch time: 0:24:28.339666,used: 1:14:21.396810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93043476, 'precision': 0.9284066, 'recall': 0.8862866, 'specificity': 0.8862866, 'f1': 0.904631, 'auroc': 0.9673196, 'binary_precision': 0.92476094, 'binary_recall': 0.79506695, 'binary_specificity': 0.97750634, 'binary_f1_score': 0.85502374}
confusion matrix:
       0      1
0  41371    952
1   3016  11701
---- Validation: 
scalar performance:
{'acc': 0.95705616, 'precision': 0.6812582, 'recall': 0.6972467, 'specificity': 0.6972467, 'f1': 0.6888656, 'auroc': 0.8641764, 'binary_precision': 0.38319087, 'binary_recall': 0.41835147, 'binary_specificity': 0.9761419, 'binary_f1_score': 0.4}
confusion matrix:
       0    1
0  17716  433
1    374  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7449634, 'recall': 0.7368713, 'specificity': 0.7368713, 'f1': 0.74083966, 'auroc': 0.89946955, 'binary_precision': 0.5119048, 'binary_recall': 0.49425286, 'binary_specificity': 0.97948974, 'binary_f1_score': 0.50292397}
confusion matrix:
      0    1
0  5874  123
1   132  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-25 06:48:01.291376,epoch time: 0:24:20.736026,used: 1:38:42.132836,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9373773, 'precision': 0.93346936, 'recall': 0.90000063, 'specificity': 0.90000063, 'f1': 0.9150305, 'auroc': 0.97048926, 'binary_precision': 0.9262546, 'binary_recall': 0.8227779, 'binary_specificity': 0.97722334, 'binary_f1_score': 0.8714553}
confusion matrix:
       0      1
0  41360    964
1   2608  12108
---- Validation: 
scalar performance:
{'acc': 0.9546083, 'precision': 0.6752727, 'recall': 0.717731, 'specificity': 0.717731, 'f1': 0.6938561, 'auroc': 0.8700788, 'binary_precision': 0.36972705, 'binary_recall': 0.46345258, 'binary_specificity': 0.9720095, 'binary_f1_score': 0.41131818}
confusion matrix:
       0    1
0  17641  508
1    345  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.7296803, 'recall': 0.78459346, 'specificity': 0.78459346, 'f1': 0.75373673, 'auroc': 0.9054514, 'binary_precision': 0.47706422, 'binary_recall': 0.59770113, 'binary_specificity': 0.97148573, 'binary_f1_score': 0.53061223}
confusion matrix:
      0    1
0  5826  171
1   105  156
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_5.png
early stop counter: 1
val acc:0.9546083211898804, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9592521786689758
after epoch: 5,now: 2024-06-25 07:12:37.729877,epoch time: 0:24:36.438501,used: 2:03:18.571337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9399719, 'precision': 0.93705535, 'recall': 0.90349454, 'specificity': 0.90349454, 'f1': 0.91857886, 'auroc': 0.97376895, 'binary_precision': 0.93166703, 'binary_recall': 0.8281133, 'binary_specificity': 0.97887576, 'binary_f1_score': 0.87684333}
confusion matrix:
       0      1
0  41427    894
1   2530  12189
---- Validation: 
scalar performance:
{'acc': 0.955513, 'precision': 0.67778563, 'recall': 0.7121989, 'specificity': 0.7121989, 'f1': 0.69324505, 'auroc': 0.8731891, 'binary_precision': 0.3751617, 'binary_recall': 0.45101088, 'binary_specificity': 0.97338694, 'binary_f1_score': 0.40960452}
confusion matrix:
       0    1
0  17666  483
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.743472, 'recall': 0.7824295, 'specificity': 0.7824295, 'f1': 0.7612898, 'auroc': 0.90846467, 'binary_precision': 0.50491804, 'binary_recall': 0.5900383, 'binary_specificity': 0.97482073, 'binary_f1_score': 0.54416955}
confusion matrix:
      0    1
0  5846  151
1   107  154
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_6.png
early stop counter: 2
val acc:0.9555130004882812, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9592521786689758
after epoch: 6,now: 2024-06-25 07:36:03.658311,epoch time: 0:23:25.928434,used: 2:26:44.499771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94228613, 'precision': 0.9394462, 'recall': 0.9073421, 'specificity': 0.9073421, 'f1': 0.9218509, 'auroc': 0.97544354, 'binary_precision': 0.93417454, 'binary_recall': 0.8351454, 'binary_specificity': 0.9795388, 'binary_f1_score': 0.8818886}
confusion matrix:
       0      1
0  41458    866
1   2426  12290
---- Validation: 
scalar performance:
{'acc': 0.9538633, 'precision': 0.6763535, 'recall': 0.7345966, 'specificity': 0.7345966, 'f1': 0.7007071, 'auroc': 0.8758985, 'binary_precision': 0.37066975, 'binary_recall': 0.4992224, 'binary_specificity': 0.9699708, 'binary_f1_score': 0.42544734}
confusion matrix:
       0    1
0  17604  545
1    322  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.7322725, 'recall': 0.79941887, 'specificity': 0.79941887, 'f1': 0.7609262, 'auroc': 0.9116161, 'binary_precision': 0.4809384, 'binary_recall': 0.62835246, 'binary_specificity': 0.97048527, 'binary_f1_score': 0.54485047}
confusion matrix:
      0    1
0  5820  177
1    97  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_7.png
early stop counter: 3
val acc:0.9538633227348328, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9592521786689758
after epoch: 7,now: 2024-06-25 07:59:10.921767,epoch time: 0:23:07.263456,used: 2:49:51.763227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9457398, 'precision': 0.94070494, 'recall': 0.91542387, 'specificity': 0.91542387, 'f1': 0.92710304, 'auroc': 0.9768019, 'binary_precision': 0.9311573, 'binary_recall': 0.85277534, 'binary_specificity': 0.97807235, 'binary_f1_score': 0.8902443}
confusion matrix:
       0      1
0  41393    928
1   2167  12552
---- Validation: 
scalar performance:
{'acc': 0.954023, 'precision': 0.6764704, 'recall': 0.7324291, 'specificity': 0.7324291, 'f1': 0.70002794, 'auroc': 0.8780164, 'binary_precision': 0.37106183, 'binary_recall': 0.49455675, 'binary_specificity': 0.9703014, 'binary_f1_score': 0.424}
confusion matrix:
       0    1
0  17610  539
1    325  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.7365877, 'recall': 0.7999191, 'specificity': 0.7999191, 'f1': 0.76392615, 'auroc': 0.91327786, 'binary_precision': 0.48955223, 'binary_recall': 0.62835246, 'binary_specificity': 0.97148573, 'binary_f1_score': 0.5503356}
confusion matrix:
      0    1
0  5826  171
1    97  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_8.png
early stop counter: 4
val acc:0.954023003578186, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9592521786689758
after epoch: 8,now: 2024-06-25 08:23:04.719050,epoch time: 0:23:53.797283,used: 3:13:45.560510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9466164, 'precision': 0.94386935, 'recall': 0.91459906, 'specificity': 0.91459906, 'f1': 0.927964, 'auroc': 0.9795766, 'binary_precision': 0.9387218, 'binary_recall': 0.84845394, 'binary_specificity': 0.98074424, 'binary_f1_score': 0.89130825}
confusion matrix:
       0      1
0  41510    815
1   2230  12485
---- Validation: 
scalar performance:
{'acc': 0.9545019, 'precision': 0.67702746, 'recall': 0.7266766, 'specificity': 0.7266766, 'f1': 0.69833034, 'auroc': 0.87920713, 'binary_precision': 0.37259614, 'binary_recall': 0.4821151, 'binary_specificity': 0.9712381, 'binary_f1_score': 0.420339}
confusion matrix:
       0    1
0  17627  522
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7473303, 'recall': 0.8029187, 'specificity': 0.8029187, 'f1': 0.77189064, 'auroc': 0.914863, 'binary_precision': 0.5108359, 'binary_recall': 0.6321839, 'binary_specificity': 0.9736535, 'binary_f1_score': 0.5650685}
confusion matrix:
      0    1
0  5839  158
1    96  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_9.png
new oracle model saved
early stop counter: 5
val acc:0.9545019268989563, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 9,now: 2024-06-25 08:46:54.290941,epoch time: 0:23:49.571891,used: 3:37:35.132401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94919354, 'precision': 0.94428885, 'recall': 0.921119, 'specificity': 0.921119, 'f1': 0.9319033, 'auroc': 0.97978103, 'binary_precision': 0.9349234, 'binary_recall': 0.86312354, 'binary_specificity': 0.9791145, 'binary_f1_score': 0.8975899}
confusion matrix:
       0      1
0  41442    884
1   2014  12700
---- Validation: 
scalar performance:
{'acc': 0.95210725, 'precision': 0.6700884, 'recall': 0.7359376, 'specificity': 0.7359376, 'f1': 0.6968148, 'auroc': 0.8811734, 'binary_precision': 0.35801104, 'binary_recall': 0.503888, 'binary_specificity': 0.96798724, 'binary_f1_score': 0.41860464}
confusion matrix:
       0    1
0  17568  581
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.7293658, 'recall': 0.8135773, 'specificity': 0.8135773, 'f1': 0.76386833, 'auroc': 0.91611516, 'binary_precision': 0.4738292, 'binary_recall': 0.65900385, 'binary_specificity': 0.96815073, 'binary_f1_score': 0.55128205}
confusion matrix:
      0    1
0  5806  191
1    89  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_10.png
early stop counter: 6
val acc:0.9521072506904602, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 10,now: 2024-06-25 09:11:47.925134,epoch time: 0:24:53.634193,used: 4:02:28.766594,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9502104, 'precision': 0.9476017, 'recall': 0.9205543, 'specificity': 0.9205543, 'f1': 0.9330021, 'auroc': 0.9818517, 'binary_precision': 0.9426761, 'binary_recall': 0.8592784, 'binary_specificity': 0.98183024, 'binary_f1_score': 0.8990474}
confusion matrix:
       0      1
0  41554    769
1   2071  12646
---- Validation: 
scalar performance:
{'acc': 0.9520541, 'precision': 0.66970587, 'recall': 0.73516, 'specificity': 0.73516, 'f1': 0.69629014, 'auroc': 0.8820331, 'binary_precision': 0.35730088, 'binary_recall': 0.5023328, 'binary_specificity': 0.96798724, 'binary_f1_score': 0.4175824}
confusion matrix:
       0    1
0  17568  581
1    320  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95653564, 'precision': 0.7349657, 'recall': 0.817909, 'specificity': 0.817909, 'f1': 0.7692127, 'auroc': 0.9163432, 'binary_precision': 0.48467967, 'binary_recall': 0.6666667, 'binary_specificity': 0.96915126, 'binary_f1_score': 0.5612903}
confusion matrix:
      0    1
0  5812  185
1    87  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_11.png
early stop counter: 7
val acc:0.9520540833473206, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 11,now: 2024-06-25 09:44:43.477614,epoch time: 0:32:55.552480,used: 4:35:24.319074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95149016, 'precision': 0.94841117, 'recall': 0.9231411, 'specificity': 0.9231411, 'f1': 0.9348378, 'auroc': 0.9823265, 'binary_precision': 0.94256705, 'binary_recall': 0.8645911, 'binary_specificity': 0.98169106, 'binary_f1_score': 0.9018968}
confusion matrix:
       0      1
0  41554    775
1   1992  12719
---- Validation: 
scalar performance:
{'acc': 0.9489144, 'precision': 0.66347075, 'recall': 0.75228596, 'specificity': 0.75228596, 'f1': 0.69678485, 'auroc': 0.8832936, 'binary_precision': 0.34353405, 'binary_recall': 0.54121304, 'binary_specificity': 0.9633589, 'binary_f1_score': 0.42028984}
confusion matrix:
       0    1
0  17484  665
1    295  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9483861, 'precision': 0.7075979, 'recall': 0.8338125, 'specificity': 0.8338125, 'f1': 0.7532954, 'auroc': 0.9171724, 'binary_precision': 0.42824075, 'binary_recall': 0.70881224, 'binary_specificity': 0.9588127, 'binary_f1_score': 0.5339105}
confusion matrix:
      0    1
0  5750  247
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_12.png
early stop counter: 8
val acc:0.9489144086837769, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 12,now: 2024-06-25 10:10:51.529305,epoch time: 0:26:08.051691,used: 5:01:32.370765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95357645, 'precision': 0.9466299, 'recall': 0.9307116, 'specificity': 0.9307116, 'f1': 0.9382919, 'auroc': 0.9821707, 'binary_precision': 0.9330463, 'binary_recall': 0.8834681, 'binary_specificity': 0.9779552, 'binary_f1_score': 0.9075806}
confusion matrix:
       0      1
0  41390    933
1   1715  13002
---- Validation: 
scalar performance:
{'acc': 0.94566834, 'precision': 0.655568, 'recall': 0.758106, 'specificity': 0.758106, 'f1': 0.6918614, 'auroc': 0.8848899, 'binary_precision': 0.32723948, 'binary_recall': 0.55676514, 'binary_specificity': 0.9594468, 'binary_f1_score': 0.41220495}
confusion matrix:
       0    1
0  17413  736
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.942953, 'precision': 0.6928442, 'recall': 0.8364748, 'specificity': 0.8364748, 'f1': 0.7413313, 'auroc': 0.91766894, 'binary_precision': 0.3983051, 'binary_recall': 0.7203065, 'binary_specificity': 0.952643, 'binary_f1_score': 0.51296043}
confusion matrix:
      0    1
0  5713  284
1    73  188
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_13.png
early stop counter: 9
val acc:0.9456683397293091, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 13,now: 2024-06-25 10:36:32.526170,epoch time: 0:25:40.996865,used: 5:27:13.367630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95347124, 'precision': 0.9506333, 'recall': 0.9262752, 'specificity': 0.9262752, 'f1': 0.93758655, 'auroc': 0.9830717, 'binary_precision': 0.94522774, 'binary_recall': 0.8700822, 'binary_specificity': 0.9824682, 'binary_f1_score': 0.9060996}
confusion matrix:
       0      1
0  41581    742
1   1912  12805
---- Validation: 
scalar performance:
{'acc': 0.95125586, 'precision': 0.6695354, 'recall': 0.7459976, 'specificity': 0.7459976, 'f1': 0.6995865, 'auroc': 0.88603127, 'binary_precision': 0.3561644, 'binary_recall': 0.525661, 'binary_specificity': 0.9663342, 'binary_f1_score': 0.42462316}
confusion matrix:
       0    1
0  17538  611
1    305  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9546181, 'precision': 0.7282541, 'recall': 0.8297348, 'specificity': 0.8297348, 'f1': 0.7682228, 'auroc': 0.9180925, 'binary_precision': 0.47012988, 'binary_recall': 0.6934866, 'binary_specificity': 0.965983, 'binary_f1_score': 0.5603715}
confusion matrix:
      0    1
0  5793  204
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_14.png
early stop counter: 10
val acc:0.9512558579444885, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 14,now: 2024-06-25 11:02:01.812194,epoch time: 0:25:29.286024,used: 5:52:42.653654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9554874, 'precision': 0.9516922, 'recall': 0.93062544, 'specificity': 0.93062544, 'f1': 0.9405091, 'auroc': 0.9850699, 'binary_precision': 0.9443877, 'binary_recall': 0.8792553, 'binary_specificity': 0.9819956, 'binary_f1_score': 0.91065836}
confusion matrix:
       0      1
0  41561    762
1   1777  12940
---- Validation: 
scalar performance:
{'acc': 0.95093656, 'precision': 0.6694826, 'recall': 0.7503326, 'specificity': 0.7503326, 'f1': 0.7008498, 'auroc': 0.8863069, 'binary_precision': 0.3557394, 'binary_recall': 0.5349922, 'binary_specificity': 0.965673, 'binary_f1_score': 0.4273292}
confusion matrix:
       0    1
0  17526  623
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95302016, 'precision': 0.72266686, 'recall': 0.83256567, 'specificity': 0.83256567, 'f1': 0.764874, 'auroc': 0.9178363, 'binary_precision': 0.45864663, 'binary_recall': 0.7011494, 'binary_specificity': 0.963982, 'binary_f1_score': 0.55454546}
confusion matrix:
      0    1
0  5781  216
1    78  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_15.png
early stop counter: 11
val acc:0.9509365558624268, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 15,now: 2024-06-25 11:24:16.956540,epoch time: 0:22:15.144346,used: 6:14:57.798000,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9566445, 'precision': 0.95042366, 'recall': 0.93510944, 'specificity': 0.93510944, 'f1': 0.9424194, 'auroc': 0.9854139, 'binary_precision': 0.9382292, 'binary_recall': 0.89061016, 'binary_specificity': 0.9796087, 'binary_f1_score': 0.91379976}
confusion matrix:
       0      1
0  41459    863
1   1610  13108
---- Validation: 
scalar performance:
{'acc': 0.9465198, 'precision': 0.6587315, 'recall': 0.76154697, 'specificity': 0.76154697, 'f1': 0.6953548, 'auroc': 0.88705206, 'binary_precision': 0.33333334, 'binary_recall': 0.562986, 'binary_specificity': 0.960108, 'binary_f1_score': 0.41873914}
confusion matrix:
       0    1
0  17425  724
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94550973, 'precision': 0.7006713, 'recall': 0.84330577, 'specificity': 0.84330577, 'f1': 0.74971926, 'auroc': 0.91773033, 'binary_precision': 0.4134199, 'binary_recall': 0.7318008, 'binary_specificity': 0.95481074, 'binary_f1_score': 0.52835405}
confusion matrix:
      0    1
0  5726  271
1    70  191
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_16.png
early stop counter: 12
val acc:0.9465197920799255, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 16,now: 2024-06-25 11:43:57.355127,epoch time: 0:19:40.398587,used: 6:34:38.196587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9565393, 'precision': 0.9521711, 'recall': 0.932963, 'specificity': 0.932963, 'f1': 0.94202656, 'auroc': 0.9850961, 'binary_precision': 0.9437151, 'binary_recall': 0.8842599, 'binary_specificity': 0.9816661, 'binary_f1_score': 0.91302055}
confusion matrix:
       0      1
0  41550    776
1   1703  13011
---- Validation: 
scalar performance:
{'acc': 0.94939333, 'precision': 0.66625977, 'recall': 0.7577843, 'specificity': 0.7577843, 'f1': 0.70049, 'auroc': 0.8874098, 'binary_precision': 0.348723, 'binary_recall': 0.5520995, 'binary_specificity': 0.9634691, 'binary_f1_score': 0.42745334}
confusion matrix:
       0    1
0  17486  663
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9493448, 'precision': 0.71132755, 'recall': 0.8398098, 'specificity': 0.8398098, 'f1': 0.7578782, 'auroc': 0.9180114, 'binary_precision': 0.4351852, 'binary_recall': 0.7203065, 'binary_specificity': 0.959313, 'binary_f1_score': 0.54256856}
confusion matrix:
      0    1
0  5753  244
1    73  188
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_17.png
early stop counter: 13
val acc:0.9493933320045471, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 17,now: 2024-06-25 12:04:11.502234,epoch time: 0:20:14.147107,used: 6:54:52.343694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9569425, 'precision': 0.95427454, 'recall': 0.9319423, 'specificity': 0.9319423, 'f1': 0.9423847, 'auroc': 0.9859859, 'binary_precision': 0.94915754, 'binary_recall': 0.88028264, 'binary_specificity': 0.9836019, 'binary_f1_score': 0.9134236}
confusion matrix:
       0      1
0  41628    694
1   1762  12956
---- Validation: 
scalar performance:
{'acc': 0.9498191, 'precision': 0.6665885, 'recall': 0.7535044, 'specificity': 0.7535044, 'f1': 0.6995572, 'auroc': 0.8866123, 'binary_precision': 0.3496994, 'binary_recall': 0.5427683, 'binary_specificity': 0.96424043, 'binary_f1_score': 0.42535037}
confusion matrix:
       0    1
0  17500  649
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495046, 'precision': 0.71160114, 'recall': 0.83806074, 'specificity': 0.83806074, 'f1': 0.7576541, 'auroc': 0.9174038, 'binary_precision': 0.43589744, 'binary_recall': 0.71647507, 'binary_specificity': 0.95964646, 'binary_f1_score': 0.542029}
confusion matrix:
      0    1
0  5755  242
1    74  187
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_18.png
early stop counter: 14
val acc:0.9498190879821777, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 18,now: 2024-06-25 12:23:44.913187,epoch time: 0:19:33.410953,used: 7:14:25.754647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95696, 'precision': 0.95342374, 'recall': 0.93283665, 'specificity': 0.93283665, 'f1': 0.94251245, 'auroc': 0.98545504, 'binary_precision': 0.9466055, 'binary_recall': 0.88299245, 'binary_specificity': 0.9826808, 'binary_f1_score': 0.91369313}
confusion matrix:
       0      1
0  41590    733
1   1722  12995
---- Validation: 
scalar performance:
{'acc': 0.948808, 'precision': 0.6650977, 'recall': 0.7604815, 'specificity': 0.7604815, 'f1': 0.7002936, 'auroc': 0.88807154, 'binary_precision': 0.34619093, 'binary_recall': 0.55832034, 'binary_specificity': 0.96264255, 'binary_f1_score': 0.42738092}
confusion matrix:
       0    1
0  17471  678
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480665, 'precision': 0.70810354, 'recall': 0.8446398, 'specificity': 0.8446398, 'f1': 0.75639486, 'auroc': 0.9181353, 'binary_precision': 0.42825112, 'binary_recall': 0.7318008, 'binary_specificity': 0.95747876, 'binary_f1_score': 0.54031116}
confusion matrix:
      0    1
0  5742  255
1    70  191
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_19.png
early stop counter: 15
val acc:0.9488080143928528, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 19,now: 2024-06-25 12:43:24.817473,epoch time: 0:19:39.904286,used: 7:34:05.658933,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9578366, 'precision': 0.9542266, 'recall': 0.9343766, 'specificity': 0.9343766, 'f1': 0.9437282, 'auroc': 0.98587155, 'binary_precision': 0.9472499, 'binary_recall': 0.8859065, 'binary_specificity': 0.9828466, 'binary_f1_score': 0.9155519}
confusion matrix:
       0      1
0  41598    726
1   1679  13037
---- Validation: 
scalar performance:
{'acc': 0.948063, 'precision': 0.6622491, 'recall': 0.75784564, 'specificity': 0.75784564, 'f1': 0.6973057, 'auroc': 0.8873976, 'binary_precision': 0.34066987, 'binary_recall': 0.55365473, 'binary_specificity': 0.9620365, 'binary_f1_score': 0.42180097}
confusion matrix:
       0    1
0  17460  689
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94630873, 'precision': 0.7029381, 'recall': 0.84372264, 'specificity': 0.84372264, 'f1': 0.75177705, 'auroc': 0.917292, 'binary_precision': 0.41794312, 'binary_recall': 0.7318008, 'binary_specificity': 0.9556445, 'binary_f1_score': 0.53203344}
confusion matrix:
      0    1
0  5731  266
1    70  191
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_20.png
early stop counter: 16
val acc:0.9480630159378052, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 20,now: 2024-06-25 13:03:20.692581,epoch time: 0:19:55.875108,used: 7:54:01.534041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9589411, 'precision': 0.9542562, 'recall': 0.93734396, 'specificity': 0.93734396, 'f1': 0.94538224, 'auroc': 0.98667586, 'binary_precision': 0.9451158, 'binary_recall': 0.8927164, 'binary_specificity': 0.98197156, 'binary_f1_score': 0.9181691}
confusion matrix:
       0      1
0  41559    763
1   1579  13139
---- Validation: 
scalar performance:
{'acc': 0.9441252, 'precision': 0.6522662, 'recall': 0.7610573, 'specificity': 0.7610573, 'f1': 0.6897304, 'auroc': 0.88774955, 'binary_precision': 0.32038835, 'binary_recall': 0.5645412, 'binary_specificity': 0.9575734, 'binary_f1_score': 0.4087838}
confusion matrix:
       0    1
0  17379  770
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9397571, 'precision': 0.68600833, 'recall': 0.8421366, 'specificity': 0.8421366, 'f1': 0.7362639, 'auroc': 0.91716164, 'binary_precision': 0.384, 'binary_recall': 0.7356322, 'binary_specificity': 0.948641, 'binary_f1_score': 0.5045992}
confusion matrix:
      0    1
0  5689  308
1    69  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_21.png
early stop counter: 17
val acc:0.9441251754760742, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 21,now: 2024-06-25 13:26:24.497064,epoch time: 0:23:03.804483,used: 8:17:05.338524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9595547, 'precision': 0.954235, 'recall': 0.9390492, 'specificity': 0.9390492, 'f1': 0.9463044, 'auroc': 0.987093, 'binary_precision': 0.94379693, 'binary_recall': 0.8966712, 'binary_specificity': 0.9814272, 'binary_f1_score': 0.9196307}
confusion matrix:
       0      1
0  41534    786
1   1521  13199
---- Validation: 
scalar performance:
{'acc': 0.9469455, 'precision': 0.6590667, 'recall': 0.7580171, 'specificity': 0.7580171, 'f1': 0.6947537, 'auroc': 0.88791174, 'binary_precision': 0.33426967, 'binary_recall': 0.55520993, 'binary_specificity': 0.9608243, 'binary_f1_score': 0.41729984}
confusion matrix:
       0    1
0  17438  711
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9442314, 'precision': 0.69742715, 'recall': 0.8444711, 'specificity': 0.8444711, 'f1': 0.7471278, 'auroc': 0.9175028, 'binary_precision': 0.40677965, 'binary_recall': 0.7356322, 'binary_specificity': 0.95331, 'binary_f1_score': 0.52387446}
confusion matrix:
      0    1
0  5717  280
1    69  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_22.png
early stop counter: 18
val acc:0.9469454884529114, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 22,now: 2024-06-25 13:51:30.631247,epoch time: 0:25:06.134183,used: 8:42:11.472707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.95992285, 'precision': 0.95488226, 'recall': 0.9393473, 'specificity': 0.9393473, 'f1': 0.9467623, 'auroc': 0.9875752, 'binary_precision': 0.94500536, 'binary_recall': 0.89684, 'binary_specificity': 0.9818547, 'binary_f1_score': 0.9202929}
confusion matrix:
       0      1
0  41557    768
1   1518  13197
---- Validation: 
scalar performance:
{'acc': 0.94513625, 'precision': 0.6551904, 'recall': 0.76233083, 'specificity': 0.76233083, 'f1': 0.69254637, 'auroc': 0.8886423, 'binary_precision': 0.32616487, 'binary_recall': 0.5660964, 'binary_specificity': 0.95856524, 'binary_f1_score': 0.41387153}
confusion matrix:
       0    1
0  17397  752
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94215405, 'precision': 0.6925571, 'recall': 0.84705186, 'specificity': 0.84705186, 'f1': 0.7432834, 'auroc': 0.91752565, 'binary_precision': 0.396728, 'binary_recall': 0.743295, 'binary_specificity': 0.95080876, 'binary_f1_score': 0.5173334}
confusion matrix:
      0    1
0  5702  295
1    67  194
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_23.png
early stop counter: 19
val acc:0.9451362490653992, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 23,now: 2024-06-25 14:12:53.351659,epoch time: 0:21:22.720412,used: 9:03:34.193119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9606066, 'precision': 0.95611477, 'recall': 0.9399189, 'specificity': 0.9399189, 'f1': 0.9476355, 'auroc': 0.98728704, 'binary_precision': 0.94733065, 'binary_recall': 0.8971797, 'binary_specificity': 0.982658, 'binary_f1_score': 0.92157346}
confusion matrix:
       0      1
0  41591    734
1   1513  13202
---- Validation: 
scalar performance:
{'acc': 0.946573, 'precision': 0.6585231, 'recall': 0.76007444, 'specificity': 0.76007444, 'f1': 0.69481784, 'auroc': 0.8887937, 'binary_precision': 0.33302498, 'binary_recall': 0.5598756, 'binary_specificity': 0.96027327, 'binary_f1_score': 0.41763344}
confusion matrix:
       0    1
0  17428  721
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9447108, 'precision': 0.699008, 'recall': 0.84655356, 'specificity': 0.84655356, 'f1': 0.7489803, 'auroc': 0.9170524, 'binary_precision': 0.40976647, 'binary_recall': 0.7394636, 'binary_specificity': 0.9536435, 'binary_f1_score': 0.5273224}
confusion matrix:
      0    1
0  5719  278
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_24.png
early stop counter: 20
val acc:0.94657301902771, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 24,now: 2024-06-25 14:32:35.478128,epoch time: 0:19:42.126469,used: 9:23:16.319588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9612202, 'precision': 0.9561295, 'recall': 0.9415736, 'specificity': 0.9415736, 'f1': 0.94854283, 'auroc': 0.98798287, 'binary_precision': 0.94612145, 'binary_recall': 0.90098536, 'binary_specificity': 0.9821618, 'binary_f1_score': 0.92300195}
confusion matrix:
       0      1
0  41570    755
1   1457  13258
---- Validation: 
scalar performance:
{'acc': 0.9459344, 'precision': 0.6566895, 'recall': 0.7597438, 'specificity': 0.7597438, 'f1': 0.6932023, 'auroc': 0.88869774, 'binary_precision': 0.3293687, 'binary_recall': 0.5598756, 'binary_specificity': 0.9596121, 'binary_f1_score': 0.41474655}
confusion matrix:
       0    1
0  17416  733
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94550973, 'precision': 0.70147914, 'recall': 0.84880275, 'specificity': 0.84880275, 'f1': 0.7516529, 'auroc': 0.91684926, 'binary_precision': 0.41452992, 'binary_recall': 0.743295, 'binary_specificity': 0.9543105, 'binary_f1_score': 0.5322359}
confusion matrix:
      0    1
0  5723  274
1    67  194
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_25.png
early stop counter: 21
val acc:0.9459344148635864, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 25,now: 2024-06-25 14:52:13.440614,epoch time: 0:19:37.962486,used: 9:42:54.282074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9610975, 'precision': 0.9568665, 'recall': 0.94047457, 'specificity': 0.94047457, 'f1': 0.94828075, 'auroc': 0.98713064, 'binary_precision': 0.9485965, 'binary_recall': 0.89786625, 'binary_specificity': 0.9830829, 'binary_f1_score': 0.92253447}
confusion matrix:
       0      1
0  41608    716
1   1503  13213
---- Validation: 
scalar performance:
{'acc': 0.94566834, 'precision': 0.6563045, 'recall': 0.76110625, 'specificity': 0.76110625, 'f1': 0.6932056, 'auroc': 0.8893635, 'binary_precision': 0.32849365, 'binary_recall': 0.562986, 'binary_specificity': 0.9592264, 'binary_f1_score': 0.4148997}
confusion matrix:
       0    1
0  17409  740
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9448706, 'precision': 0.69944495, 'recall': 0.8466369, 'specificity': 0.8466369, 'f1': 0.74938464, 'auroc': 0.917032, 'binary_precision': 0.4106383, 'binary_recall': 0.7394636, 'binary_specificity': 0.9538102, 'binary_f1_score': 0.5280438}
confusion matrix:
      0    1
0  5720  277
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_26.png
early stop counter: 22
val acc:0.9456683397293091, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 26,now: 2024-06-25 15:12:19.666997,epoch time: 0:20:06.226383,used: 10:03:00.508457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9616059, 'precision': 0.95760465, 'recall': 0.9410734, 'specificity': 0.9410734, 'f1': 0.9489437, 'auroc': 0.987844, 'binary_precision': 0.9497881, 'binary_recall': 0.8986611, 'binary_specificity': 0.9834857, 'binary_f1_score': 0.9235175}
confusion matrix:
       0      1
0  41628    699
1   1491  13222
---- Validation: 
scalar performance:
{'acc': 0.9441784, 'precision': 0.65296316, 'recall': 0.763335, 'specificity': 0.763335, 'f1': 0.6908529, 'auroc': 0.8896122, 'binary_precision': 0.32161686, 'binary_recall': 0.56920683, 'binary_specificity': 0.9574632, 'binary_f1_score': 0.41100502}
confusion matrix:
       0    1
0  17377  772
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94215405, 'precision': 0.69285214, 'recall': 0.8488842, 'specificity': 0.8488842, 'f1': 0.7439226, 'auroc': 0.9169086, 'binary_precision': 0.39714867, 'binary_recall': 0.74712646, 'binary_specificity': 0.950642, 'binary_f1_score': 0.518617}
confusion matrix:
      0    1
0  5701  296
1    66  195
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_27.png
early stop counter: 23
val acc:0.9441784024238586, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 27,now: 2024-06-25 15:32:30.985357,epoch time: 0:20:11.318360,used: 10:23:11.826817,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96079946, 'precision': 0.9544436, 'recall': 0.942218, 'specificity': 0.942218, 'f1': 0.94811136, 'auroc': 0.9879564, 'binary_precision': 0.94185555, 'binary_recall': 0.9038331, 'binary_specificity': 0.9806029, 'binary_f1_score': 0.9224527}
confusion matrix:
       0      1
0  41505    821
1   1415  13299
---- Validation: 
scalar performance:
{'acc': 0.9420498, 'precision': 0.6482335, 'recall': 0.7652333, 'specificity': 0.7652333, 'f1': 0.6870677, 'auroc': 0.89020956, 'binary_precision': 0.311973, 'binary_recall': 0.5754277, 'binary_specificity': 0.95503885, 'binary_f1_score': 0.40459266}
confusion matrix:
       0    1
0  17333  816
1    273  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9395973, 'precision': 0.68688124, 'recall': 0.8493825, 'specificity': 0.8493825, 'f1': 0.7384548, 'auroc': 0.916379, 'binary_precision': 0.38506877, 'binary_recall': 0.75095785, 'binary_specificity': 0.94780725, 'binary_f1_score': 0.5090909}
confusion matrix:
      0    1
0  5684  313
1    65  196
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_28.png
early stop counter: 24
val acc:0.9420498013496399, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 28,now: 2024-06-25 15:53:56.964358,epoch time: 0:21:25.979001,used: 10:44:37.805818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96078193, 'precision': 0.95726013, 'recall': 0.93922365, 'specificity': 0.93922365, 'f1': 0.9477714, 'auroc': 0.9883875, 'binary_precision': 0.95041144, 'binary_recall': 0.8946796, 'binary_specificity': 0.9837677, 'binary_f1_score': 0.92170376}
confusion matrix:
       0      1
0  41636    687
1   1550  13167
---- Validation: 
scalar performance:
{'acc': 0.9460941, 'precision': 0.65732694, 'recall': 0.76057655, 'specificity': 0.76057655, 'f1': 0.69394046, 'auroc': 0.88970435, 'binary_precision': 0.33058608, 'binary_recall': 0.5614308, 'binary_specificity': 0.9597223, 'binary_f1_score': 0.41613832}
confusion matrix:
       0    1
0  17418  731
1    282  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94566953, 'precision': 0.7016577, 'recall': 0.84705377, 'specificity': 0.84705377, 'f1': 0.7514212, 'auroc': 0.91660964, 'binary_precision': 0.41505376, 'binary_recall': 0.7394636, 'binary_specificity': 0.95464396, 'binary_f1_score': 0.53168046}
confusion matrix:
      0    1
0  5725  272
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_29.png
early stop counter: 25
val acc:0.9460940957069397, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 29,now: 2024-06-25 16:16:06.188580,epoch time: 0:22:09.224222,used: 11:06:47.030040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96181625, 'precision': 0.9569532, 'recall': 0.9423268, 'specificity': 0.9423268, 'f1': 0.94932914, 'auroc': 0.9880593, 'binary_precision': 0.9473947, 'binary_recall': 0.90206605, 'binary_specificity': 0.9825875, 'binary_f1_score': 0.9241749}
confusion matrix:
       0      1
0  41589    737
1   1441  13273
---- Validation: 
scalar performance:
{'acc': 0.9401341, 'precision': 0.6449323, 'recall': 0.76949185, 'specificity': 0.76949185, 'f1': 0.6848845, 'auroc': 0.88986486, 'binary_precision': 0.3050162, 'binary_recall': 0.58631414, 'binary_specificity': 0.95266956, 'binary_f1_score': 0.40127727}
confusion matrix:
       0    1
0  17290  859
1    266  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9365612, 'precision': 0.680589, 'recall': 0.8514631, 'specificity': 0.8514631, 'f1': 0.7327522, 'auroc': 0.91656303, 'binary_precision': 0.37218046, 'binary_recall': 0.7586207, 'binary_specificity': 0.9443055, 'binary_f1_score': 0.49936947}
confusion matrix:
      0    1
0  5663  334
1    63  198
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_30.png
early stop counter: 26
val acc:0.9401341080665588, best validation acc: 0.9570561647415161, corresponding to test acc:                         0.9592521786689758 / 0.9594119787216187
after epoch: 30,now: 2024-06-25 16:37:55.890052,epoch time: 0:21:49.701472,used: 11:28:36.731512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_09_19_seed_0_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:28:36.731512 at 2024-06-25 16:37:55.890052
persisted model performance metric: 

scalar performance:
{'acc': 0.9592522, 'precision': 0.7449634, 'recall': 0.7368713, 'specificity': 0.7368713, 'f1': 0.74083966, 'auroc': 0.89946955, 'binary_precision': 0.5119048, 'binary_recall': 0.49425286, 'binary_specificity': 0.97948974, 'binary_f1_score': 0.50292397}
confusion matrix:
      0    1
0  5874  123
1   132  129
oracle model performance metric: 

scalar performance:
{'acc': 0.959412, 'precision': 0.7473303, 'recall': 0.8029187, 'specificity': 0.8029187, 'f1': 0.77189064, 'auroc': 0.914863, 'binary_precision': 0.5108359, 'binary_recall': 0.6321839, 'binary_specificity': 0.9736535, 'binary_f1_score': 0.5650685}
confusion matrix:
      0    1
0  5839  158
1    96  165
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191877 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |  17477 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191877 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |  17477 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189283 KiB | 457564 KiB | 758210 GiB | 758210 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 742654 GiB | 742654 GiB |
|       from small pool |  16469 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 516096 KiB | 516096 KiB | 516096 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39546 KiB |  75256 KiB | 410711 GiB | 410711 GiB |
|       from large pool |  30400 KiB |  70632 KiB | 395107 GiB | 395107 GiB |
|       from small pool |   9146 KiB |   9397 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7613    |  157526 K  |  157523 K  |
|       from large pool |      76    |     158    |   73194 K  |   73194 K  |
|       from small pool |    2890    |    7535    |   84331 K  |   84328 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7613    |  157526 K  |  157523 K  |
|       from large pool |      76    |     158    |   73194 K  |   73194 K  |
|       from small pool |    2890    |    7535    |   84331 K  |   84328 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3583    |   87087 K  |   87087 K  |
|       from large pool |       9    |      19    |   45496 K  |   45496 K  |
|       from small pool |      24    |    3575    |   41590 K  |   41590 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 758210 GiB | 758210 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 742654 GiB | 742654 GiB |
|       from small pool |      0 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 516096 KiB | 516096 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  43008 KiB |  43008 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82786 KiB | 410711 GiB | 410711 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 395108 GiB | 395108 GiB |
|       from small pool |      0 KiB |  20341 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      42    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3583    |   87088 K  |   87088 K  |
|       from large pool |       3    |      19    |   45496 K  |   45496 K  |
|       from small pool |       0    |    3575    |   41592 K  |   41592 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 758210 GiB | 758210 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 742654 GiB | 742654 GiB |
|       from small pool |      0 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 516096 KiB | 516096 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  43008 KiB |  43008 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82786 KiB | 410711 GiB | 410711 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 395108 GiB | 395108 GiB |
|       from small pool |      0 KiB |  20341 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      42    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3583    |   87088 K  |   87088 K  |
|       from large pool |       3    |      19    |   45496 K  |   45496 K  |
|       from small pool |       0    |    3575    |   41592 K  |   41592 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222

 Experiment start at: 2024-06-25 16:46:58.001599
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7845404, 'precision': 0.72761583, 'recall': 0.6326971, 'specificity': 0.6326971, 'f1': 0.6500607, 'auroc': 0.82009995, 'binary_precision': 0.6514413, 'binary_recall': 0.32441053, 'binary_specificity': 0.9409837, 'binary_f1_score': 0.4331281}
confusion matrix:
       0     1
0  39909  2503
1   9742  4678
---- Validation: 
scalar performance:
{'acc': 0.9345251, 'precision': 0.49388123, 'recall': 0.49468192, 'specificity': 0.49468192, 'f1': 0.49421957, 'auroc': 0.7578372, 'binary_precision': 0.024054984, 'binary_recall': 0.020802377, 'binary_specificity': 0.9685615, 'binary_f1_score': 0.022310758}
confusion matrix:
       0    1
0  17499  568
1    659   14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9334515, 'precision': 0.51333106, 'recall': 0.50920206, 'specificity': 0.50920206, 'f1': 0.5102157, 'auroc': 0.8216241, 'binary_precision': 0.06779661, 'binary_recall': 0.046153847, 'binary_specificity': 0.9722502, 'binary_f1_score': 0.054919906}
confusion matrix:
      0    1
0  5781  165
1   248   12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-25 17:11:14.063607,epoch time: 0:24:16.062008,used: 0:24:16.062008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.88304126, 'precision': 0.8767382, 'recall': 0.80185795, 'specificity': 0.80185795, 'f1': 0.82966864, 'auroc': 0.9293927, 'binary_precision': 0.8666855, 'binary_recall': 0.6370319, 'binary_specificity': 0.966684, 'binary_f1_score': 0.7343219}
confusion matrix:
       0     1
0  40999  1413
1   5234  9186
---- Validation: 
scalar performance:
{'acc': 0.9397012, 'precision': 0.58062226, 'recall': 0.58820534, 'specificity': 0.58820534, 'f1': 0.5841935, 'auroc': 0.8266028, 'binary_precision': 0.19079837, 'binary_recall': 0.20950966, 'binary_specificity': 0.966901, 'binary_f1_score': 0.19971672}
confusion matrix:
       0    1
0  17469  598
1    532  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94263613, 'precision': 0.615192, 'recall': 0.5912326, 'specificity': 0.5912326, 'f1': 0.6014814, 'auroc': 0.8657514, 'binary_precision': 0.2647059, 'binary_recall': 0.20769231, 'binary_specificity': 0.97477293, 'binary_f1_score': 0.23275863}
confusion matrix:
      0    1
0  5796  150
1   206   54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-25 17:51:02.367422,epoch time: 0:39:48.303815,used: 1:04:04.365823,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90971637, 'precision': 0.90279424, 'recall': 0.85172856, 'specificity': 0.85172856, 'f1': 0.8730767, 'auroc': 0.9499469, 'binary_precision': 0.8908999, 'binary_recall': 0.734013, 'binary_specificity': 0.96944404, 'binary_f1_score': 0.8048827}
confusion matrix:
       0      1
0  41118   1296
1   3835  10583
---- Validation: 
scalar performance:
{'acc': 0.94754535, 'precision': 0.6361548, 'recall': 0.6537865, 'specificity': 0.6537865, 'f1': 0.64433146, 'auroc': 0.84587, 'binary_precision': 0.29712042, 'binary_recall': 0.33729568, 'binary_specificity': 0.9702773, 'binary_f1_score': 0.31593597}
confusion matrix:
       0    1
0  17530  537
1    446  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9506929, 'precision': 0.68215156, 'recall': 0.65244573, 'specificity': 0.65244573, 'f1': 0.66575307, 'auroc': 0.8831587, 'binary_precision': 0.3935185, 'binary_recall': 0.32692307, 'binary_specificity': 0.9779684, 'binary_f1_score': 0.35714284}
confusion matrix:
      0    1
0  5815  131
1   175   85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-25 19:05:59.738440,epoch time: 1:14:57.371018,used: 2:19:01.736841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92162865, 'precision': 0.9228026, 'recall': 0.8657379, 'specificity': 0.8657379, 'f1': 0.8893842, 'auroc': 0.960557, 'binary_precision': 0.92480177, 'binary_recall': 0.7522713, 'binary_specificity': 0.9792045, 'binary_f1_score': 0.82966197}
confusion matrix:
       0      1
0  41531    882
1   3572  10847
---- Validation: 
scalar performance:
{'acc': 0.9557097, 'precision': 0.6772932, 'recall': 0.67018026, 'specificity': 0.67018026, 'f1': 0.6736529, 'auroc': 0.8573702, 'binary_precision': 0.3782946, 'binary_recall': 0.3625557, 'binary_specificity': 0.97780484, 'binary_f1_score': 0.37025797}
confusion matrix:
       0    1
0  17666  401
1    429  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.7307227, 'recall': 0.6688504, 'specificity': 0.6688504, 'f1': 0.6943241, 'auroc': 0.896551, 'binary_precision': 0.4893617, 'binary_recall': 0.35384616, 'binary_specificity': 0.9838547, 'binary_f1_score': 0.41071433}
confusion matrix:
      0   1
0  5850  96
1   168  92
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-25 19:33:19.699812,epoch time: 0:27:19.961372,used: 2:46:21.698213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93049693, 'precision': 0.9277905, 'recall': 0.8848468, 'specificity': 0.8848468, 'f1': 0.90355927, 'auroc': 0.9658228, 'binary_precision': 0.9229961, 'binary_recall': 0.79216367, 'binary_specificity': 0.97752994, 'binary_f1_score': 0.8525899}
confusion matrix:
       0      1
0  41459    953
1   2997  11423
---- Validation: 
scalar performance:
{'acc': 0.9557097, 'precision': 0.68435526, 'recall': 0.6959299, 'specificity': 0.6959299, 'f1': 0.68993986, 'auroc': 0.8651099, 'binary_precision': 0.39051604, 'binary_recall': 0.41604754, 'binary_specificity': 0.97581226, 'binary_f1_score': 0.4028777}
confusion matrix:
       0    1
0  17630  437
1    393  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7447144, 'recall': 0.7230219, 'specificity': 0.7230219, 'f1': 0.73329365, 'auroc': 0.9051379, 'binary_precision': 0.5127119, 'binary_recall': 0.4653846, 'binary_specificity': 0.98065925, 'binary_f1_score': 0.4879032}
confusion matrix:
      0    1
0  5831  115
1   139  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_5.png
new oracle model saved
early stop counter: 1
val acc:0.95570969581604, best validation acc: 0.95570969581604, corresponding to test acc:                         0.9574605226516724 / 0.9590718746185303
after epoch: 5,now: 2024-06-25 20:06:05.875690,epoch time: 0:32:46.175878,used: 3:19:07.874091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93533576, 'precision': 0.9321246, 'recall': 0.89381003, 'specificity': 0.89381003, 'f1': 0.9107896, 'auroc': 0.97113085, 'binary_precision': 0.92635506, 'binary_recall': 0.8095007, 'binary_specificity': 0.9781194, 'binary_f1_score': 0.86399466}
confusion matrix:
       0      1
0  41484    928
1   2747  11673
---- Validation: 
scalar performance:
{'acc': 0.95619, 'precision': 0.6927734, 'recall': 0.72264385, 'specificity': 0.72264385, 'f1': 0.70647454, 'auroc': 0.871197, 'binary_precision': 0.40537083, 'binary_recall': 0.47102526, 'binary_specificity': 0.9742625, 'binary_f1_score': 0.43573883}
confusion matrix:
       0    1
0  17602  465
1    356  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.7312515, 'recall': 0.74566746, 'specificity': 0.74566746, 'f1': 0.7382081, 'auroc': 0.91036963, 'binary_precision': 0.48375452, 'binary_recall': 0.5153846, 'binary_specificity': 0.97595024, 'binary_f1_score': 0.4990689}
confusion matrix:
      0    1
0  5803  143
1   126  134
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_6.png
better model found
persisted
after epoch: 6,now: 2024-06-25 20:37:46.885474,epoch time: 0:31:41.009784,used: 3:50:48.883875,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9397523, 'precision': 0.9408525, 'recall': 0.89751166, 'specificity': 0.89751166, 'f1': 0.9164793, 'auroc': 0.9743527, 'binary_precision': 0.9428065, 'binary_recall': 0.81176305, 'binary_specificity': 0.9832603, 'binary_f1_score': 0.8723911}
confusion matrix:
       0      1
0  41704    710
1   2714  11704
---- Validation: 
scalar performance:
{'acc': 0.9593383, 'precision': 0.70614433, 'recall': 0.70496446, 'specificity': 0.70496446, 'f1': 0.70555246, 'auroc': 0.87470937, 'binary_precision': 0.4334828, 'binary_recall': 0.4309064, 'binary_specificity': 0.9790225, 'binary_f1_score': 0.43219078}
confusion matrix:
       0    1
0  17688  379
1    383  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.76825845, 'recall': 0.7394997, 'specificity': 0.7394997, 'f1': 0.75295645, 'auroc': 0.9140903, 'binary_precision': 0.5584416, 'binary_recall': 0.49615383, 'binary_specificity': 0.9828456, 'binary_f1_score': 0.5254582}
confusion matrix:
      0    1
0  5844  102
1   131  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-25 21:10:12.382378,epoch time: 0:32:25.496904,used: 4:23:14.380779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9424268, 'precision': 0.9416626, 'recall': 0.90384746, 'specificity': 0.90384746, 'f1': 0.9206915, 'auroc': 0.9752337, 'binary_precision': 0.9402844, 'binary_recall': 0.8255201, 'binary_specificity': 0.9821749, 'binary_f1_score': 0.8791728}
confusion matrix:
       0      1
0  41656    756
1   2516  11904
---- Validation: 
scalar performance:
{'acc': 0.9585912, 'precision': 0.7045599, 'recall': 0.7203129, 'specificity': 0.7203129, 'f1': 0.71210325, 'auroc': 0.877864, 'binary_precision': 0.42916092, 'binary_recall': 0.46359584, 'binary_specificity': 0.9770299, 'binary_f1_score': 0.4457143}
confusion matrix:
       0    1
0  17652  415
1    361  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.75390816, 'recall': 0.7715924, 'specificity': 0.7715924, 'f1': 0.76240975, 'auroc': 0.9163452, 'binary_precision': 0.5268817, 'binary_recall': 0.5653846, 'binary_specificity': 0.9778002, 'binary_f1_score': 0.54545456}
confusion matrix:
      0    1
0  5814  132
1   113  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_8.png
early stop counter: 1
val acc:0.9585912227630615, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 8,now: 2024-06-25 21:41:54.151932,epoch time: 0:31:41.769554,used: 4:54:56.150333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94585794, 'precision': 0.9408916, 'recall': 0.9138586, 'specificity': 0.9138586, 'f1': 0.9263066, 'auroc': 0.9781668, 'binary_precision': 0.93165386, 'binary_recall': 0.8488904, 'binary_specificity': 0.97882676, 'binary_f1_score': 0.88834864}
confusion matrix:
       0      1
0  41514    898
1   2179  12241
---- Validation: 
scalar performance:
{'acc': 0.9566702, 'precision': 0.69788575, 'recall': 0.73719823, 'specificity': 0.73719823, 'f1': 0.71550363, 'auroc': 0.8786011, 'binary_precision': 0.41451415, 'binary_recall': 0.5007429, 'binary_specificity': 0.9736536, 'binary_f1_score': 0.4535666}
confusion matrix:
       0    1
0  17591  476
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.74394274, 'recall': 0.79632914, 'specificity': 0.79632914, 'f1': 0.7672062, 'auroc': 0.9170884, 'binary_precision': 0.5047022, 'binary_recall': 0.61923075, 'binary_specificity': 0.97342753, 'binary_f1_score': 0.55613124}
confusion matrix:
      0    1
0  5788  158
1    99  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_9.png
early stop counter: 2
val acc:0.9566702246665955, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 9,now: 2024-06-25 22:08:17.228381,epoch time: 0:26:23.076449,used: 5:21:19.226782,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9473712, 'precision': 0.944101, 'recall': 0.91477585, 'specificity': 0.91477585, 'f1': 0.92819595, 'auroc': 0.97899294, 'binary_precision': 0.9380558, 'binary_recall': 0.84860253, 'binary_specificity': 0.9809492, 'binary_f1_score': 0.89108986}
confusion matrix:
       0      1
0  41605    808
1   2183  12236
---- Validation: 
scalar performance:
{'acc': 0.9574173, 'precision': 0.7007674, 'recall': 0.7332941, 'specificity': 0.7332941, 'f1': 0.7156351, 'auroc': 0.8804362, 'binary_precision': 0.4205845, 'binary_recall': 0.49182764, 'binary_specificity': 0.9747606, 'binary_f1_score': 0.45342463}
confusion matrix:
       0    1
0  17611  456
1    342  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7487887, 'recall': 0.79683363, 'specificity': 0.79683363, 'f1': 0.77037674, 'auroc': 0.9184125, 'binary_precision': 0.514377, 'binary_recall': 0.61923075, 'binary_specificity': 0.9744366, 'binary_f1_score': 0.5619546}
confusion matrix:
      0    1
0  5794  152
1    99  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_10.png
early stop counter: 3
val acc:0.9574173092842102, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 10,now: 2024-06-25 22:29:57.801478,epoch time: 0:21:40.573097,used: 5:42:59.799879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.94884926, 'precision': 0.9475501, 'recall': 0.9154228, 'specificity': 0.9154228, 'f1': 0.93001413, 'auroc': 0.98092234, 'binary_precision': 0.9451663, 'binary_recall': 0.84756225, 'binary_specificity': 0.9832834, 'binary_f1_score': 0.8937073}
confusion matrix:
       0      1
0  41704    709
1   2198  12221
---- Validation: 
scalar performance:
{'acc': 0.95757735, 'precision': 0.7000241, 'recall': 0.724794, 'specificity': 0.724794, 'f1': 0.71158266, 'auroc': 0.8822279, 'binary_precision': 0.41973683, 'binary_recall': 0.47399703, 'binary_specificity': 0.9755909, 'binary_f1_score': 0.4452198}
confusion matrix:
       0    1
0  17626  441
1    354  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.7582007, 'recall': 0.79591966, 'specificity': 0.79591966, 'f1': 0.77558947, 'auroc': 0.91894484, 'binary_precision': 0.53333336, 'binary_recall': 0.61538464, 'binary_specificity': 0.97645473, 'binary_f1_score': 0.5714286}
confusion matrix:
      0    1
0  5806  140
1   100  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_11.png
early stop counter: 4
val acc:0.9575773477554321, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 11,now: 2024-06-25 22:51:11.502646,epoch time: 0:21:13.701168,used: 6:04:13.501047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9494123, 'precision': 0.9483253, 'recall': 0.91618407, 'specificity': 0.91618407, 'f1': 0.93078446, 'auroc': 0.9810815, 'binary_precision': 0.94633055, 'binary_recall': 0.84873074, 'binary_specificity': 0.98363745, 'binary_f1_score': 0.89487725}
confusion matrix:
       0      1
0  41720    694
1   2181  12237
---- Validation: 
scalar performance:
{'acc': 0.9570971, 'precision': 0.69770026, 'recall': 0.72526014, 'specificity': 0.72526014, 'f1': 0.7104511, 'auroc': 0.8829386, 'binary_precision': 0.4150454, 'binary_recall': 0.4754829, 'binary_specificity': 0.97503734, 'binary_f1_score': 0.4432133}
confusion matrix:
       0    1
0  17616  451
1    353  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.7546791, 'recall': 0.79926133, 'specificity': 0.79926133, 'f1': 0.7749107, 'auroc': 0.91925335, 'binary_precision': 0.52597404, 'binary_recall': 0.6230769, 'binary_specificity': 0.9754457, 'binary_f1_score': 0.57042253}
confusion matrix:
      0    1
0  5800  146
1    98  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_12.png
early stop counter: 5
val acc:0.9570971131324768, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 12,now: 2024-06-25 23:17:57.103557,epoch time: 0:26:45.600911,used: 6:30:59.101958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9533889, 'precision': 0.9494649, 'recall': 0.9257884, 'specificity': 0.9257884, 'f1': 0.93682444, 'auroc': 0.98352325, 'binary_precision': 0.94208235, 'binary_recall': 0.8697552, 'binary_specificity': 0.9818216, 'binary_f1_score': 0.90447515}
confusion matrix:
       0      1
0  41642    771
1   1878  12541
---- Validation: 
scalar performance:
{'acc': 0.95592314, 'precision': 0.6951927, 'recall': 0.74110246, 'specificity': 0.74110246, 'f1': 0.71536946, 'auroc': 0.88347113, 'binary_precision': 0.40882003, 'binary_recall': 0.5096582, 'binary_specificity': 0.97254664, 'binary_f1_score': 0.4537037}
confusion matrix:
       0    1
0  17571  496
1    330  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.74314576, 'recall': 0.8145509, 'specificity': 0.8145509, 'f1': 0.7735614, 'auroc': 0.9189973, 'binary_precision': 0.5014663, 'binary_recall': 0.6576923, 'binary_specificity': 0.9714094, 'binary_f1_score': 0.56905156}
confusion matrix:
      0    1
0  5776  170
1    89  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_13.png
early stop counter: 6
val acc:0.9559231400489807, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 13,now: 2024-06-25 23:41:30.646853,epoch time: 0:23:33.543296,used: 6:54:32.645254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9543743, 'precision': 0.95038164, 'recall': 0.927543, 'specificity': 0.927543, 'f1': 0.93821716, 'auroc': 0.9831272, 'binary_precision': 0.9428507, 'binary_recall': 0.8730753, 'binary_specificity': 0.98201066, 'binary_f1_score': 0.9066224}
confusion matrix:
       0      1
0  41651    763
1   1830  12588
---- Validation: 
scalar performance:
{'acc': 0.9532017, 'precision': 0.6857268, 'recall': 0.75042003, 'specificity': 0.75042003, 'f1': 0.7125143, 'auroc': 0.884748, 'binary_precision': 0.38913044, 'binary_recall': 0.5319465, 'binary_specificity': 0.9688936, 'binary_f1_score': 0.44946644}
confusion matrix:
       0    1
0  17505  562
1    315  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95278764, 'precision': 0.7211609, 'recall': 0.8190477, 'specificity': 0.8190477, 'f1': 0.75971377, 'auroc': 0.91962194, 'binary_precision': 0.45691907, 'binary_recall': 0.6730769, 'binary_specificity': 0.9650185, 'binary_f1_score': 0.5443235}
confusion matrix:
      0    1
0  5738  208
1    85  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_14.png
early stop counter: 7
val acc:0.9532017111778259, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 14,now: 2024-06-26 00:03:07.583479,epoch time: 0:21:36.936626,used: 7:16:09.581880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9546734, 'precision': 0.9513583, 'recall': 0.9273814, 'specificity': 0.9273814, 'f1': 0.93855184, 'auroc': 0.9843875, 'binary_precision': 0.94512516, 'binary_recall': 0.87197447, 'binary_specificity': 0.9827883, 'binary_f1_score': 0.90707743}
confusion matrix:
       0      1
0  41683    730
1   1846  12573
---- Validation: 
scalar performance:
{'acc': 0.95298827, 'precision': 0.6844336, 'recall': 0.7481635, 'specificity': 0.7481635, 'f1': 0.71085614, 'auroc': 0.8852916, 'binary_precision': 0.38671023, 'binary_recall': 0.5274888, 'binary_specificity': 0.9688382, 'binary_f1_score': 0.44626018}
confusion matrix:
       0    1
0  17504  563
1    318  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95230424, 'precision': 0.7193816, 'recall': 0.81879544, 'specificity': 0.81879544, 'f1': 0.7583192, 'auroc': 0.91984653, 'binary_precision': 0.4533679, 'binary_recall': 0.6730769, 'binary_specificity': 0.96451396, 'binary_f1_score': 0.5417957}
confusion matrix:
      0    1
0  5735  211
1    85  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_15.png
early stop counter: 8
val acc:0.9529882669448853, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 15,now: 2024-06-26 00:27:18.671409,epoch time: 0:24:11.087930,used: 7:40:20.669810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9546734, 'precision': 0.95083016, 'recall': 0.9278995, 'specificity': 0.9278995, 'f1': 0.93861485, 'auroc': 0.98413455, 'binary_precision': 0.94358283, 'binary_recall': 0.8735521, 'binary_specificity': 0.9822469, 'binary_f1_score': 0.90721804}
confusion matrix:
       0      1
0  41662    753
1   1823  12594
---- Validation: 
scalar performance:
{'acc': 0.95325506, 'precision': 0.6851963, 'recall': 0.74687135, 'specificity': 0.74687135, 'f1': 0.71093404, 'auroc': 0.8849541, 'binary_precision': 0.38833883, 'binary_recall': 0.52451706, 'binary_specificity': 0.96922565, 'binary_f1_score': 0.44627056}
confusion matrix:
       0    1
0  17511  556
1    320  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95294875, 'precision': 0.722144, 'recall': 0.82280976, 'specificity': 0.82280976, 'f1': 0.7615851, 'auroc': 0.9184078, 'binary_precision': 0.45854923, 'binary_recall': 0.6807692, 'binary_specificity': 0.9648503, 'binary_f1_score': 0.5479876}
confusion matrix:
      0    1
0  5737  209
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_16.png
early stop counter: 9
val acc:0.9532550573348999, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 16,now: 2024-06-26 00:49:53.443229,epoch time: 0:22:34.771820,used: 8:02:55.441630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.95484936, 'precision': 0.9527912, 'recall': 0.92645085, 'specificity': 0.92645085, 'f1': 0.93864024, 'auroc': 0.9847275, 'binary_precision': 0.94894713, 'binary_recall': 0.86879337, 'binary_specificity': 0.98410827, 'binary_f1_score': 0.9071031}
confusion matrix:
       0      1
0  41738    674
1   1892  12528
---- Validation: 
scalar performance:
{'acc': 0.95442903, 'precision': 0.6893066, 'recall': 0.7439039, 'specificity': 0.7439039, 'f1': 0.71263194, 'auroc': 0.8853489, 'binary_precision': 0.39680728, 'binary_recall': 0.51708764, 'binary_specificity': 0.9707201, 'binary_f1_score': 0.44903228}
confusion matrix:
       0    1
0  17538  529
1    325  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9553658, 'precision': 0.7312869, 'recall': 0.8222321, 'specificity': 0.8222321, 'f1': 0.768055, 'auroc': 0.91856515, 'binary_precision': 0.47696477, 'binary_recall': 0.6769231, 'binary_specificity': 0.9675412, 'binary_f1_score': 0.5596185}
confusion matrix:
      0    1
0  5753  193
1    84  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_17.png
early stop counter: 10
val acc:0.954429030418396, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 17,now: 2024-06-26 01:10:09.332044,epoch time: 0:20:15.888815,used: 8:23:11.330445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9550781, 'precision': 0.9511807, 'recall': 0.92865956, 'specificity': 0.92865956, 'f1': 0.93919694, 'auroc': 0.9836989, 'binary_precision': 0.9438211, 'binary_recall': 0.875026, 'binary_specificity': 0.9822932, 'binary_f1_score': 0.9081225}
confusion matrix:
       0      1
0  41662    751
1   1802  12617
---- Validation: 
scalar performance:
{'acc': 0.9507471, 'precision': 0.67676, 'recall': 0.7505775, 'specificity': 0.7505775, 'f1': 0.7062336, 'auroc': 0.88541234, 'binary_precision': 0.371134, 'binary_recall': 0.53491825, 'binary_specificity': 0.96623677, 'binary_f1_score': 0.43822277}
confusion matrix:
       0    1
0  17457  610
1    313  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9494038, 'precision': 0.71024305, 'recall': 0.8246378, 'specificity': 0.8246378, 'f1': 0.75299597, 'auroc': 0.9185561, 'binary_precision': 0.43446603, 'binary_recall': 0.68846154, 'binary_specificity': 0.960814, 'binary_f1_score': 0.5327381}
confusion matrix:
      0    1
0  5713  233
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_18.png
early stop counter: 11
val acc:0.9507470726966858, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 18,now: 2024-06-26 01:31:04.464999,epoch time: 0:20:55.132955,used: 8:44:06.463400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.9529525, 'recall': 0.93575776, 'specificity': 0.93575776, 'f1': 0.94393325, 'auroc': 0.98671174, 'binary_precision': 0.94262415, 'binary_recall': 0.88992923, 'binary_specificity': 0.9815863, 'binary_f1_score': 0.91551906}
confusion matrix:
       0      1
0  41633    781
1   1587  12831
---- Validation: 
scalar performance:
{'acc': 0.9485059, 'precision': 0.6718459, 'recall': 0.76157475, 'specificity': 0.76157475, 'f1': 0.7058212, 'auroc': 0.8858675, 'binary_precision': 0.36042064, 'binary_recall': 0.5601783, 'binary_specificity': 0.96297115, 'binary_f1_score': 0.4386271}
confusion matrix:
       0    1
0  17398  669
1    296  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9466645, 'precision': 0.702978, 'recall': 0.8324032, 'specificity': 0.8324032, 'f1': 0.7491036, 'auroc': 0.9184247, 'binary_precision': 0.4191344, 'binary_recall': 0.7076923, 'binary_specificity': 0.95711404, 'binary_f1_score': 0.52646637}
confusion matrix:
      0    1
0  5691  255
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_19.png
early stop counter: 12
val acc:0.9485058784484863, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 19,now: 2024-06-26 01:51:28.325382,epoch time: 0:20:23.860383,used: 9:04:30.323783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.95717204, 'precision': 0.9535316, 'recall': 0.931985, 'specificity': 0.931985, 'f1': 0.9421001, 'auroc': 0.9856599, 'binary_precision': 0.9466349, 'binary_recall': 0.8808516, 'binary_specificity': 0.98311836, 'binary_f1_score': 0.9125593}
confusion matrix:
       0      1
0  41697    716
1   1718  12701
---- Validation: 
scalar performance:
{'acc': 0.949413, 'precision': 0.6732343, 'recall': 0.7548925, 'specificity': 0.7548925, 'f1': 0.70495164, 'auroc': 0.8864124, 'binary_precision': 0.36372647, 'binary_recall': 0.54531944, 'binary_specificity': 0.9644656, 'binary_f1_score': 0.4363852}
confusion matrix:
       0    1
0  17425  642
1    306  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9471479, 'precision': 0.7041594, 'recall': 0.83081645, 'specificity': 0.83081645, 'f1': 0.74969316, 'auroc': 0.9188659, 'binary_precision': 0.421659, 'binary_recall': 0.70384616, 'binary_specificity': 0.95778674, 'binary_f1_score': 0.5273775}
confusion matrix:
      0    1
0  5695  251
1    77  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_20.png
early stop counter: 13
val acc:0.949413001537323, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 20,now: 2024-06-26 02:11:42.926725,epoch time: 0:20:14.601343,used: 9:24:44.925126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9589492, 'precision': 0.9552119, 'recall': 0.9351249, 'specificity': 0.9351249, 'f1': 0.9445981, 'auroc': 0.9863124, 'binary_precision': 0.9480982, 'binary_recall': 0.8867545, 'binary_specificity': 0.98349524, 'binary_f1_score': 0.91640097}
confusion matrix:
       0      1
0  41712    700
1   1633  12787
---- Validation: 
scalar performance:
{'acc': 0.95101386, 'precision': 0.67756504, 'recall': 0.7500006, 'specificity': 0.7500006, 'f1': 0.70663214, 'auroc': 0.88576555, 'binary_precision': 0.37279335, 'binary_recall': 0.53343236, 'binary_specificity': 0.9665689, 'binary_f1_score': 0.4388753}
confusion matrix:
       0    1
0  17463  604
1    314  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9502095, 'precision': 0.71268535, 'recall': 0.8232192, 'specificity': 0.8232192, 'f1': 0.75451684, 'auroc': 0.918329, 'binary_precision': 0.43950617, 'binary_recall': 0.6846154, 'binary_specificity': 0.96182305, 'binary_f1_score': 0.53533834}
confusion matrix:
      0    1
0  5719  227
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_21.png
early stop counter: 14
val acc:0.9510138630867004, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 21,now: 2024-06-26 02:30:56.480189,epoch time: 0:19:13.553464,used: 9:43:58.478590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9592483, 'precision': 0.95362186, 'recall': 0.93758744, 'specificity': 0.93758744, 'f1': 0.945238, 'auroc': 0.98697174, 'binary_precision': 0.94278187, 'binary_recall': 0.8936126, 'binary_specificity': 0.98156226, 'binary_f1_score': 0.917539}
confusion matrix:
       0      1
0  41631    782
1   1534  12885
---- Validation: 
scalar performance:
{'acc': 0.9493063, 'precision': 0.6731979, 'recall': 0.75626767, 'specificity': 0.75626767, 'f1': 0.7053308, 'auroc': 0.88572305, 'binary_precision': 0.3635468, 'binary_recall': 0.5482912, 'binary_specificity': 0.9642442, 'binary_f1_score': 0.4372038}
confusion matrix:
       0    1
0  17421  646
1    304  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9473091, 'precision': 0.7035825, 'recall': 0.8235446, 'specificity': 0.8235446, 'f1': 0.7473717, 'auroc': 0.918146, 'binary_precision': 0.42117646, 'binary_recall': 0.68846154, 'binary_specificity': 0.95862764, 'binary_f1_score': 0.5226278}
confusion matrix:
      0    1
0  5700  246
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_22.png
early stop counter: 15
val acc:0.949306309223175, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 22,now: 2024-06-26 02:50:07.596300,epoch time: 0:19:11.116111,used: 10:03:09.594701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9591955, 'precision': 0.9548968, 'recall': 0.93610287, 'specificity': 0.93610287, 'f1': 0.9449996, 'auroc': 0.98669887, 'binary_precision': 0.94668436, 'binary_recall': 0.889228, 'binary_specificity': 0.98297775, 'binary_f1_score': 0.9170571}
confusion matrix:
       0      1
0  41693    722
1   1597  12820
---- Validation: 
scalar performance:
{'acc': 0.9493063, 'precision': 0.6733594, 'recall': 0.756983, 'specificity': 0.756983, 'f1': 0.705663, 'auroc': 0.88677484, 'binary_precision': 0.36381513, 'binary_recall': 0.5497771, 'binary_specificity': 0.9641889, 'binary_f1_score': 0.43786982}
confusion matrix:
       0    1
0  17420  647
1    303  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9473091, 'precision': 0.7035825, 'recall': 0.8235446, 'specificity': 0.8235446, 'f1': 0.7473717, 'auroc': 0.9182185, 'binary_precision': 0.42117646, 'binary_recall': 0.68846154, 'binary_specificity': 0.95862764, 'binary_f1_score': 0.5226278}
confusion matrix:
      0    1
0  5700  246
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_23.png
early stop counter: 16
val acc:0.949306309223175, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 23,now: 2024-06-26 03:09:48.142682,epoch time: 0:19:40.546382,used: 10:22:50.141083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9593363, 'precision': 0.95572245, 'recall': 0.9356551, 'specificity': 0.9356551, 'f1': 0.9451205, 'auroc': 0.9872198, 'binary_precision': 0.9488434, 'binary_recall': 0.8875789, 'binary_specificity': 0.9837314, 'binary_f1_score': 0.91718924}
confusion matrix:
       0      1
0  41723    690
1   1621  12798
---- Validation: 
scalar performance:
{'acc': 0.94962645, 'precision': 0.6739601, 'recall': 0.7550032, 'specificity': 0.7550032, 'f1': 0.7055291, 'auroc': 0.8864187, 'binary_precision': 0.3651741, 'binary_recall': 0.54531944, 'binary_specificity': 0.964687, 'binary_f1_score': 0.4374255}
confusion matrix:
       0    1
0  17429  638
1    306  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.948437, 'precision': 0.70686114, 'recall': 0.82229424, 'specificity': 0.82229424, 'f1': 0.74968034, 'auroc': 0.91780627, 'binary_precision': 0.4278846, 'binary_recall': 0.6846154, 'binary_specificity': 0.9599731, 'binary_f1_score': 0.52662724}
confusion matrix:
      0    1
0  5708  238
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_24.png
early stop counter: 17
val acc:0.9496264457702637, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 24,now: 2024-06-26 03:30:06.035528,epoch time: 0:20:17.892846,used: 10:43:08.033929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96063834, 'precision': 0.9557324, 'recall': 0.9392054, 'specificity': 0.9392054, 'f1': 0.9470819, 'auroc': 0.98769987, 'binary_precision': 0.9462925, 'binary_recall': 0.8956932, 'binary_specificity': 0.9827176, 'binary_f1_score': 0.92029786}
confusion matrix:
       0      1
0  41680    733
1   1504  12915
---- Validation: 
scalar performance:
{'acc': 0.9462647, 'precision': 0.66436166, 'recall': 0.75826657, 'specificity': 0.75826657, 'f1': 0.6990117, 'auroc': 0.8868746, 'binary_precision': 0.3456562, 'binary_recall': 0.5557206, 'binary_specificity': 0.9608125, 'binary_f1_score': 0.42621082}
confusion matrix:
       0    1
0  17359  708
1    299  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9465034, 'precision': 0.7025005, 'recall': 0.8323191, 'specificity': 0.8323191, 'f1': 0.74868363, 'auroc': 0.9176997, 'binary_precision': 0.4181818, 'binary_recall': 0.7076923, 'binary_specificity': 0.95694584, 'binary_f1_score': 0.5257143}
confusion matrix:
      0    1
0  5690  256
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_25.png
early stop counter: 18
val acc:0.9462646842002869, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 25,now: 2024-06-26 03:50:49.014269,epoch time: 0:20:42.978741,used: 11:03:51.012670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.95993453, 'precision': 0.9543985, 'recall': 0.93866515, 'specificity': 0.93866515, 'f1': 0.94617945, 'auroc': 0.98764896, 'binary_precision': 0.94372165, 'binary_recall': 0.8954851, 'binary_specificity': 0.9818452, 'binary_f1_score': 0.9189708}
confusion matrix:
       0      1
0  41643    770
1   1507  12912
---- Validation: 
scalar performance:
{'acc': 0.9463714, 'precision': 0.6648521, 'recall': 0.7590372, 'specificity': 0.7590372, 'f1': 0.69960946, 'auroc': 0.88712597, 'binary_precision': 0.34658042, 'binary_recall': 0.5572065, 'binary_specificity': 0.9608679, 'binary_f1_score': 0.42735043}
confusion matrix:
       0    1
0  17360  707
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94521433, 'precision': 0.6984729, 'recall': 0.8298074, 'specificity': 0.8298074, 'f1': 0.74468434, 'auroc': 0.9175147, 'binary_precision': 0.4103139, 'binary_recall': 0.70384616, 'binary_specificity': 0.9557686, 'binary_f1_score': 0.5184136}
confusion matrix:
      0    1
0  5683  263
1    77  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_26.png
early stop counter: 19
val acc:0.9463713765144348, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 26,now: 2024-06-26 04:11:20.269299,epoch time: 0:20:31.255030,used: 11:24:22.267700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96104306, 'precision': 0.95478606, 'recall': 0.94133365, 'specificity': 0.94133365, 'f1': 0.9478018, 'auroc': 0.98807865, 'binary_precision': 0.94263124, 'binary_recall': 0.9013176, 'binary_specificity': 0.98134965, 'binary_f1_score': 0.92151165}
confusion matrix:
       0      1
0  41621    791
1   1423  12997
---- Validation: 
scalar performance:
{'acc': 0.9435432, 'precision': 0.65778667, 'recall': 0.76186204, 'specificity': 0.76186204, 'f1': 0.6945061, 'auroc': 0.88623023, 'binary_precision': 0.33217087, 'binary_recall': 0.5661218, 'binary_specificity': 0.95760226, 'binary_f1_score': 0.41868132}
confusion matrix:
       0    1
0  17301  766
1    292  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94070256, 'precision': 0.68760675, 'recall': 0.8348088, 'specificity': 0.8348088, 'f1': 0.73625463, 'auroc': 0.9167676, 'binary_precision': 0.3879668, 'binary_recall': 0.7192308, 'binary_specificity': 0.9503868, 'binary_f1_score': 0.50404316}
confusion matrix:
      0    1
0  5651  295
1    73  187
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_27.png
early stop counter: 20
val acc:0.9435431957244873, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 27,now: 2024-06-26 04:31:58.007502,epoch time: 0:20:37.738203,used: 11:45:00.005903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9605328, 'precision': 0.9564296, 'recall': 0.93819976, 'specificity': 0.93819976, 'f1': 0.9468456, 'auroc': 0.9882741, 'binary_precision': 0.94857436, 'binary_recall': 0.89285713, 'binary_specificity': 0.9835424, 'binary_f1_score': 0.9198728}
confusion matrix:
       0      1
0  41714    698
1   1545  12875
---- Validation: 
scalar performance:
{'acc': 0.94631803, 'precision': 0.66452205, 'recall': 0.7582942, 'specificity': 0.7582942, 'f1': 0.6991475, 'auroc': 0.88610137, 'binary_precision': 0.34597594, 'binary_recall': 0.5557206, 'binary_specificity': 0.9608679, 'binary_f1_score': 0.4264538}
confusion matrix:
       0    1
0  17360  707
1    299  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9456977, 'precision': 0.6990161, 'recall': 0.8245427, 'specificity': 0.8245427, 'f1': 0.74386644, 'auroc': 0.916353, 'binary_precision': 0.41189933, 'binary_recall': 0.6923077, 'binary_specificity': 0.9567777, 'binary_f1_score': 0.5164993}
confusion matrix:
      0    1
0  5689  257
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_28.png
early stop counter: 21
val acc:0.9463180303573608, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 28,now: 2024-06-26 04:52:40.569504,epoch time: 0:20:42.562002,used: 12:05:42.567905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96090233, 'precision': 0.9563031, 'recall': 0.9393364, 'specificity': 0.9393364, 'f1': 0.9474127, 'auroc': 0.9880026, 'binary_precision': 0.94746494, 'binary_recall': 0.8955545, 'binary_specificity': 0.98311836, 'binary_f1_score': 0.9207786}
confusion matrix:
       0      1
0  41697    716
1   1506  12913
---- Validation: 
scalar performance:
{'acc': 0.9464248, 'precision': 0.6650129, 'recall': 0.7590649, 'specificity': 0.7590649, 'f1': 0.69974566, 'auroc': 0.88580644, 'binary_precision': 0.34690103, 'binary_recall': 0.5572065, 'binary_specificity': 0.96092325, 'binary_f1_score': 0.42759404}
confusion matrix:
       0    1
0  17361  706
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9456977, 'precision': 0.6990161, 'recall': 0.8245427, 'specificity': 0.8245427, 'f1': 0.74386644, 'auroc': 0.9158956, 'binary_precision': 0.41189933, 'binary_recall': 0.6923077, 'binary_specificity': 0.9567777, 'binary_f1_score': 0.5164993}
confusion matrix:
      0    1
0  5689  257
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_29.png
early stop counter: 22
val acc:0.9464247822761536, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 29,now: 2024-06-26 05:14:26.844607,epoch time: 0:21:46.275103,used: 12:27:28.843008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9622748, 'precision': 0.9564404, 'recall': 0.9429827, 'specificity': 0.9429827, 'f1': 0.94945455, 'auroc': 0.9886334, 'binary_precision': 0.94510514, 'binary_recall': 0.90381414, 'binary_specificity': 0.98215127, 'binary_f1_score': 0.9239986}
confusion matrix:
       0      1
0  41655    757
1   1387  13033
---- Validation: 
scalar performance:
{'acc': 0.941302, 'precision': 0.65296245, 'recall': 0.7649913, 'specificity': 0.7649913, 'f1': 0.69106334, 'auroc': 0.8867662, 'binary_precision': 0.32223147, 'binary_recall': 0.5750371, 'binary_specificity': 0.9549455, 'binary_f1_score': 0.41302028}
confusion matrix:
       0    1
0  17253  814
1    286  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93780214, 'precision': 0.6809397, 'recall': 0.83513415, 'specificity': 0.83513415, 'f1': 0.7301526, 'auroc': 0.91602755, 'binary_precision': 0.374502, 'binary_recall': 0.72307694, 'binary_specificity': 0.9471914, 'binary_f1_score': 0.4934383}
confusion matrix:
      0    1
0  5632  314
1    72  188
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_30.png
early stop counter: 23
val acc:0.9413020014762878, best validation acc: 0.9593383073806763, corresponding to test acc:                         0.962455689907074 / 0.962455689907074
after epoch: 30,now: 2024-06-26 05:38:41.477295,epoch time: 0:24:14.632688,used: 12:51:43.475696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_16_46_57_seed_1_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:51:43.475696 at 2024-06-26 05:38:41.477295
persisted model performance metric: 

scalar performance:
{'acc': 0.9624557, 'precision': 0.76825845, 'recall': 0.7394997, 'specificity': 0.7394997, 'f1': 0.75295645, 'auroc': 0.9140903, 'binary_precision': 0.5584416, 'binary_recall': 0.49615383, 'binary_specificity': 0.9828456, 'binary_f1_score': 0.5254582}
confusion matrix:
      0    1
0  5844  102
1   131  129
oracle model performance metric: 

scalar performance:
{'acc': 0.9624557, 'precision': 0.76825845, 'recall': 0.7394997, 'specificity': 0.7394997, 'f1': 0.75295645, 'auroc': 0.9140903, 'binary_precision': 0.5584416, 'binary_recall': 0.49615383, 'binary_specificity': 0.9828456, 'binary_f1_score': 0.5254582}
confusion matrix:
      0    1
0  5844  102
1   131  129
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190959 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  17465 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190959 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  17465 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189280 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  16466 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    792 MiB | 284672 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     54 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40464 KiB |  87618 KiB |    825 TiB |    825 TiB |
|       from large pool |  31306 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |   9158 KiB |  20341 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2942    |    7613    |  314084 K  |  314081 K  |
|       from large pool |      76    |     158    |  145894 K  |  145894 K  |
|       from small pool |    2866    |    7535    |  168189 K  |  168186 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2942    |    7613    |  314084 K  |  314081 K  |
|       from large pool |      76    |     158    |  145894 K  |  145894 K  |
|       from small pool |    2866    |    7535    |  168189 K  |  168186 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      60    |      19    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3583    |  175710 K  |  175710 K  |
|       from large pool |      10    |      22    |   87846 K  |   87846 K  |
|       from small pool |      22    |    3575    |   87864 K  |   87864 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |    792 MiB | 579584 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  26624 KiB |  43008 KiB |     54 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87618 KiB |    825 TiB |    825 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |      0 KiB |  21236 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  314084 K  |  314084 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168189 K  |  168189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  314084 K  |  314084 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168189 K  |  168189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      60    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      13    |      21    |      27    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3583    |  175712 K  |  175711 K  |
|       from large pool |       3    |      22    |   87846 K  |   87846 K  |
|       from small pool |       0    |    3575    |   87865 K  |   87865 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |    792 MiB | 579584 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  26624 KiB |  43008 KiB |     54 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87618 KiB |    825 TiB |    825 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |      0 KiB |  21236 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  314084 K  |  314084 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168189 K  |  168189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  314084 K  |  314084 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168189 K  |  168189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      60    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      13    |      21    |      27    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3583    |  175712 K  |  175711 K  |
|       from large pool |       3    |      22    |   87846 K  |   87846 K  |
|       from small pool |       0    |    3575    |   87865 K  |   87865 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222

 Experiment start at: 2024-06-26 05:47:59.603782
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8770195, 'precision': 0.87574023, 'recall': 0.7954801, 'specificity': 0.7954801, 'f1': 0.82403135, 'auroc': 0.92506593, 'binary_precision': 0.873691, 'binary_recall': 0.623174, 'binary_specificity': 0.96778613, 'binary_f1_score': 0.72746915}
confusion matrix:
       0     1
0  40948  1363
1   5701  9428
---- Validation: 
scalar performance:
{'acc': 0.91690195, 'precision': 0.58002716, 'recall': 0.6888563, 'specificity': 0.6888563, 'f1': 0.60585976, 'auroc': 0.8039056, 'binary_precision': 0.1793842, 'binary_recall': 0.4451827, 'binary_specificity': 0.93252987, 'binary_f1_score': 0.25572518}
confusion matrix:
       0     1
0  16945  1226
1    334   268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85462415, 'precision': 0.5190093, 'recall': 0.5555891, 'specificity': 0.5555891, 'f1': 0.5153799, 'auroc': 0.6886115, 'binary_precision': 0.072072074, 'binary_recall': 0.23140496, 'binary_specificity': 0.8797732, 'binary_f1_score': 0.10991168}
confusion matrix:
      0    1
0  5276  721
1   186   56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-26 06:10:02.808613,epoch time: 0:22:03.204831,used: 0:22:03.204831,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90973186, 'precision': 0.9062358, 'recall': 0.8550186, 'specificity': 0.8550186, 'f1': 0.8762398, 'auroc': 0.9511812, 'binary_precision': 0.9000724, 'binary_recall': 0.7393919, 'binary_specificity': 0.97064525, 'binary_f1_score': 0.8118581}
confusion matrix:
       0      1
0  41068   1242
1   3943  11187
---- Validation: 
scalar performance:
{'acc': 0.93618494, 'precision': 0.6151596, 'recall': 0.7188934, 'specificity': 0.7188934, 'f1': 0.64748806, 'auroc': 0.8382305, 'binary_precision': 0.24788494, 'binary_recall': 0.48671097, 'binary_specificity': 0.9510759, 'binary_f1_score': 0.32847533}
confusion matrix:
       0    1
0  17282  889
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8922904, 'precision': 0.55275464, 'recall': 0.62078524, 'specificity': 0.62078524, 'f1': 0.56633455, 'auroc': 0.79262364, 'binary_precision': 0.13435374, 'binary_recall': 0.3264463, 'binary_specificity': 0.91512424, 'binary_f1_score': 0.19036144}
confusion matrix:
      0    1
0  5488  509
1   163   79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-26 06:31:44.014243,epoch time: 0:21:41.205630,used: 0:43:44.410461,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9235724, 'precision': 0.92125523, 'recall': 0.877597, 'specificity': 0.877597, 'f1': 0.8963575, 'auroc': 0.95994925, 'binary_precision': 0.917055, 'binary_recall': 0.7804362, 'binary_specificity': 0.97475773, 'binary_f1_score': 0.84324795}
confusion matrix:
       0      1
0  41242   1068
1   3322  11808
---- Validation: 
scalar performance:
{'acc': 0.9451872, 'precision': 0.6373175, 'recall': 0.72836196, 'specificity': 0.72836196, 'f1': 0.6694499, 'auroc': 0.85333586, 'binary_precision': 0.2917073, 'binary_recall': 0.49667773, 'binary_specificity': 0.96004623, 'binary_f1_score': 0.36754763}
confusion matrix:
       0    1
0  17445  726
1    303  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9156916, 'precision': 0.591655, 'recall': 0.6765783, 'specificity': 0.6765783, 'f1': 0.6163533, 'auroc': 0.8355217, 'binary_precision': 0.20781893, 'binary_recall': 0.41735536, 'binary_specificity': 0.9358012, 'binary_f1_score': 0.27747253}
confusion matrix:
      0    1
0  5612  385
1   141  101
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-26 06:51:40.678816,epoch time: 0:19:56.664573,used: 1:03:41.075034,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92935234, 'precision': 0.9264567, 'recall': 0.8879105, 'specificity': 0.8879105, 'f1': 0.9048145, 'auroc': 0.9658028, 'binary_precision': 0.9211167, 'binary_recall': 0.80033046, 'binary_specificity': 0.97549045, 'binary_f1_score': 0.856486}
confusion matrix:
       0      1
0  41273   1037
1   3021  12109
---- Validation: 
scalar performance:
{'acc': 0.94769084, 'precision': 0.6454683, 'recall': 0.7336705, 'specificity': 0.7336705, 'f1': 0.67753935, 'auroc': 0.8628441, 'binary_precision': 0.30769232, 'binary_recall': 0.50498337, 'binary_specificity': 0.9623576, 'binary_f1_score': 0.38238993}
confusion matrix:
       0    1
0  17487  684
1    298  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9256291, 'precision': 0.61870587, 'recall': 0.7174369, 'specificity': 0.7174369, 'f1': 0.6498146, 'auroc': 0.8574033, 'binary_precision': 0.25869566, 'binary_recall': 0.49173555, 'binary_specificity': 0.94313824, 'binary_f1_score': 0.33903137}
confusion matrix:
      0    1
0  5656  341
1   123  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-26 07:11:10.869263,epoch time: 0:19:30.190447,used: 1:23:11.265481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93523675, 'precision': 0.9324822, 'recall': 0.8976522, 'specificity': 0.8976522, 'f1': 0.9131592, 'auroc': 0.96977323, 'binary_precision': 0.9273354, 'binary_recall': 0.8182299, 'binary_specificity': 0.9770745, 'binary_f1_score': 0.8693729}
confusion matrix:
       0      1
0  41341    970
1   2750  12379
---- Validation: 
scalar performance:
{'acc': 0.9509402, 'precision': 0.6547634, 'recall': 0.73213685, 'specificity': 0.73213685, 'f1': 0.6844559, 'auroc': 0.8684099, 'binary_precision': 0.3264418, 'binary_recall': 0.49833888, 'binary_specificity': 0.96593475, 'binary_f1_score': 0.39447734}
confusion matrix:
       0    1
0  17552  619
1    302  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93171984, 'precision': 0.6321981, 'recall': 0.7265533, 'specificity': 0.7265533, 'f1': 0.66405094, 'auroc': 0.86951876, 'binary_precision': 0.28504673, 'binary_recall': 0.5041322, 'binary_specificity': 0.9489745, 'binary_f1_score': 0.3641791}
confusion matrix:
      0    1
0  5691  306
1   120  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-26 07:30:43.814415,epoch time: 0:19:32.945152,used: 1:42:44.210633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93979806, 'precision': 0.9365238, 'recall': 0.9057855, 'specificity': 0.9057855, 'f1': 0.9196785, 'auroc': 0.97263527, 'binary_precision': 0.93032, 'binary_recall': 0.8339062, 'binary_specificity': 0.9776648, 'binary_f1_score': 0.87947863}
confusion matrix:
       0      1
0  41365    945
1   2513  12617
---- Validation: 
scalar performance:
{'acc': 0.94795716, 'precision': 0.6482129, 'recall': 0.7410355, 'specificity': 0.7410355, 'f1': 0.681668, 'auroc': 0.8725749, 'binary_precision': 0.3126873, 'binary_recall': 0.5199336, 'binary_specificity': 0.96213746, 'binary_f1_score': 0.3905178}
confusion matrix:
       0    1
0  17483  688
1    289  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9309184, 'precision': 0.6429368, 'recall': 0.7717395, 'specificity': 0.7717395, 'f1': 0.6827801, 'auroc': 0.8782959, 'binary_precision': 0.302714, 'binary_recall': 0.59917355, 'binary_specificity': 0.9443055, 'binary_f1_score': 0.40221915}
confusion matrix:
      0    1
0  5663  334
1    97  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_6.png
early stop counter: 1
val acc:0.9479571580886841, best validation acc: 0.9509401917457581, corresponding to test acc:                         0.9317198395729065 / 0.9317198395729065
after epoch: 6,now: 2024-06-26 07:50:07.734295,epoch time: 0:19:23.919880,used: 2:02:08.130513,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94145197, 'precision': 0.9383917, 'recall': 0.90833056, 'specificity': 0.90833056, 'f1': 0.9219558, 'auroc': 0.97519195, 'binary_precision': 0.9325785, 'binary_recall': 0.83833444, 'binary_specificity': 0.9783266, 'binary_f1_score': 0.88294876}
confusion matrix:
       0      1
0  41393    917
1   2446  12684
---- Validation: 
scalar performance:
{'acc': 0.95216537, 'precision': 0.6602178, 'recall': 0.737588, 'specificity': 0.737588, 'f1': 0.69018924, 'auroc': 0.8753314, 'binary_precision': 0.3370044, 'binary_recall': 0.50830567, 'binary_specificity': 0.9668703, 'binary_f1_score': 0.405298}
confusion matrix:
       0    1
0  17569  602
1    296  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9416573, 'precision': 0.66446424, 'recall': 0.76344645, 'specificity': 0.76344645, 'f1': 0.7002508, 'auroc': 0.8838111, 'binary_precision': 0.34673366, 'binary_recall': 0.57024795, 'binary_specificity': 0.956645, 'binary_f1_score': 0.43125004}
confusion matrix:
      0    1
0  5737  260
1   104  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-26 08:09:54.232440,epoch time: 0:19:46.498145,used: 2:21:54.628658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94381964, 'precision': 0.94168913, 'recall': 0.9113601, 'specificity': 0.9113601, 'f1': 0.9251085, 'auroc': 0.97739154, 'binary_precision': 0.93764246, 'binary_recall': 0.8427627, 'binary_specificity': 0.97995746, 'binary_f1_score': 0.88767445}
confusion matrix:
       0      1
0  41462    848
1   2379  12751
---- Validation: 
scalar performance:
{'acc': 0.9525915, 'precision': 0.6623303, 'recall': 0.7402172, 'specificity': 0.7402172, 'f1': 0.692559, 'auroc': 0.8787246, 'binary_precision': 0.3410596, 'binary_recall': 0.51328903, 'binary_specificity': 0.96714544, 'binary_f1_score': 0.4098143}
confusion matrix:
       0    1
0  17574  597
1    293  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94326013, 'precision': 0.67289114, 'recall': 0.7821249, 'specificity': 0.7821249, 'f1': 0.71188986, 'auroc': 0.88879687, 'binary_precision': 0.36206895, 'binary_recall': 0.607438, 'binary_specificity': 0.9568117, 'binary_f1_score': 0.4537037}
confusion matrix:
      0    1
0  5738  259
1    95  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-26 08:33:39.589197,epoch time: 0:23:45.356757,used: 2:45:39.985415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94714487, 'precision': 0.9425443, 'recall': 0.919328, 'specificity': 0.919328, 'f1': 0.93010056, 'auroc': 0.97840655, 'binary_precision': 0.933601, 'binary_recall': 0.860542, 'binary_specificity': 0.97811395, 'binary_f1_score': 0.89558405}
confusion matrix:
       0      1
0  41384    926
1   2110  13020
---- Validation: 
scalar performance:
{'acc': 0.9499281, 'precision': 0.6562841, 'recall': 0.7500841, 'specificity': 0.7500841, 'f1': 0.6905869, 'auroc': 0.88150525, 'binary_precision': 0.32825205, 'binary_recall': 0.53654486, 'binary_specificity': 0.96362334, 'binary_f1_score': 0.40731403}
confusion matrix:
       0    1
0  17510  661
1    279  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9381311, 'precision': 0.6653142, 'recall': 0.8052325, 'specificity': 0.8052325, 'f1': 0.71023405, 'auroc': 0.8927218, 'binary_precision': 0.3448276, 'binary_recall': 0.661157, 'binary_specificity': 0.949308, 'binary_f1_score': 0.4532578}
confusion matrix:
      0    1
0  5693  304
1    82  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_9.png
early stop counter: 1
val acc:0.9499281048774719, best validation acc: 0.9525914788246155, corresponding to test acc:                         0.943260133266449 / 0.943260133266449
after epoch: 9,now: 2024-06-26 09:00:58.986038,epoch time: 0:27:19.396841,used: 3:12:59.382256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9472145, 'precision': 0.9449134, 'recall': 0.9171461, 'specificity': 0.9171461, 'f1': 0.92985, 'auroc': 0.97964036, 'binary_precision': 0.94050395, 'binary_recall': 0.8536021, 'binary_specificity': 0.9806901, 'binary_f1_score': 0.8949484}
confusion matrix:
       0      1
0  41493    817
1   2215  12915
---- Validation: 
scalar performance:
{'acc': 0.95413625, 'precision': 0.6679826, 'recall': 0.7410152, 'specificity': 0.7410152, 'f1': 0.6969888, 'auroc': 0.8829075, 'binary_precision': 0.3523375, 'binary_recall': 0.51328903, 'binary_specificity': 0.9687414, 'binary_f1_score': 0.4178499}
confusion matrix:
       0    1
0  17603  568
1    293  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9475877, 'precision': 0.6876804, 'recall': 0.7942897, 'specificity': 0.7942897, 'f1': 0.7270865, 'auroc': 0.8948289, 'binary_precision': 0.3907455, 'binary_recall': 0.6280992, 'binary_specificity': 0.9604802, 'binary_f1_score': 0.48177496}
confusion matrix:
      0    1
0  5760  237
1    90  152
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_10.png
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-06-26 09:30:24.469201,epoch time: 0:29:25.483163,used: 3:42:24.865419,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9487988, 'precision': 0.9459044, 'recall': 0.92034006, 'specificity': 0.92034006, 'f1': 0.9321223, 'auroc': 0.9808953, 'binary_precision': 0.9403179, 'binary_recall': 0.86020225, 'binary_specificity': 0.98047787, 'binary_f1_score': 0.8984777}
confusion matrix:
       0      1
0  41485    826
1   2115  13014
---- Validation: 
scalar performance:
{'acc': 0.9529111, 'precision': 0.66485935, 'recall': 0.7460037, 'specificity': 0.7460037, 'f1': 0.69617575, 'auroc': 0.8842262, 'binary_precision': 0.34573305, 'binary_recall': 0.52491695, 'binary_specificity': 0.9670904, 'binary_f1_score': 0.41688657}
confusion matrix:
       0    1
0  17573  598
1    286  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94774806, 'precision': 0.68996, 'recall': 0.8042868, 'specificity': 0.8042868, 'f1': 0.7315433, 'auroc': 0.8965151, 'binary_precision': 0.39447236, 'binary_recall': 0.6487603, 'binary_specificity': 0.95981324, 'binary_f1_score': 0.49062502}
confusion matrix:
      0    1
0  5756  241
1    85  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_11.png
new oracle model saved
early stop counter: 1
val acc:0.9529110789299011, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.947748064994812
after epoch: 11,now: 2024-06-26 10:02:55.400322,epoch time: 0:32:30.931121,used: 4:14:55.796540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9490773, 'precision': 0.9474844, 'recall': 0.91953576, 'specificity': 0.91953576, 'f1': 0.93232405, 'auroc': 0.9818655, 'binary_precision': 0.9444323, 'binary_recall': 0.8571051, 'binary_specificity': 0.98196644, 'binary_f1_score': 0.8986522}
confusion matrix:
       0      1
0  41547    763
1   2162  12968
---- Validation: 
scalar performance:
{'acc': 0.9527513, 'precision': 0.6644887, 'recall': 0.7467242, 'specificity': 0.7467242, 'f1': 0.69610465, 'auroc': 0.885077, 'binary_precision': 0.34494016, 'binary_recall': 0.52657807, 'binary_specificity': 0.9668703, 'binary_f1_score': 0.41683105}
confusion matrix:
       0    1
0  17569  602
1    285  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9463055, 'precision': 0.6863099, 'recall': 0.8075019, 'specificity': 0.8075019, 'f1': 0.7293266, 'auroc': 0.8983231, 'binary_precision': 0.38686132, 'binary_recall': 0.6570248, 'binary_specificity': 0.95797896, 'binary_f1_score': 0.48698312}
confusion matrix:
      0    1
0  5745  252
1    83  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_12.png
early stop counter: 2
val acc:0.9527512788772583, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.947748064994812
after epoch: 12,now: 2024-06-26 10:39:57.845156,epoch time: 0:37:02.444834,used: 4:51:58.241374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9520195, 'precision': 0.95036167, 'recall': 0.92443717, 'specificity': 0.92443717, 'f1': 0.9363848, 'auroc': 0.9827101, 'binary_precision': 0.947163, 'binary_recall': 0.8661511, 'binary_specificity': 0.9827232, 'binary_f1_score': 0.9048474}
confusion matrix:
       0      1
0  41580    731
1   2025  13104
---- Validation: 
scalar performance:
{'acc': 0.95269805, 'precision': 0.6639072, 'recall': 0.7450906, 'specificity': 0.7450906, 'f1': 0.69518614, 'auroc': 0.8860824, 'binary_precision': 0.34388646, 'binary_recall': 0.5232558, 'binary_specificity': 0.9669253, 'binary_f1_score': 0.41501975}
confusion matrix:
       0    1
0  17570  601
1    287  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480686, 'precision': 0.69198084, 'recall': 0.81040174, 'specificity': 0.81040174, 'f1': 0.73475784, 'auroc': 0.90024555, 'binary_precision': 0.39800996, 'binary_recall': 0.661157, 'binary_specificity': 0.95964646, 'binary_f1_score': 0.49689445}
confusion matrix:
      0    1
0  5755  242
1    82  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_13.png
new oracle model saved
early stop counter: 3
val acc:0.9526980519294739, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9480686187744141
after epoch: 13,now: 2024-06-26 11:15:47.214310,epoch time: 0:35:49.369154,used: 5:27:47.610528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95193243, 'precision': 0.94859815, 'recall': 0.92595327, 'specificity': 0.92595327, 'f1': 0.93649405, 'auroc': 0.98348665, 'binary_precision': 0.94209737, 'binary_recall': 0.8710509, 'binary_specificity': 0.9808556, 'binary_f1_score': 0.9051822}
confusion matrix:
       0      1
0  41500    810
1   1951  13179
---- Validation: 
scalar performance:
{'acc': 0.9509934, 'precision': 0.6604856, 'recall': 0.75384665, 'specificity': 0.75384665, 'f1': 0.6949632, 'auroc': 0.88751936, 'binary_precision': 0.33641976, 'binary_recall': 0.54318935, 'binary_specificity': 0.9645039, 'binary_f1_score': 0.4155019}
confusion matrix:
       0    1
0  17526  645
1    275  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94566435, 'precision': 0.68587977, 'recall': 0.81509936, 'specificity': 0.81509936, 'f1': 0.73076415, 'auroc': 0.9011786, 'binary_precision': 0.38534278, 'binary_recall': 0.6735537, 'binary_specificity': 0.956645, 'binary_f1_score': 0.49022552}
confusion matrix:
      0    1
0  5737  260
1    79  163
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_14.png
early stop counter: 4
val acc:0.9509934186935425, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9480686187744141
after epoch: 14,now: 2024-06-26 11:46:55.530187,epoch time: 0:31:08.315877,used: 5:58:55.926405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.95262885, 'precision': 0.94984114, 'recall': 0.9265533, 'specificity': 0.9265533, 'f1': 0.93737423, 'auroc': 0.9834918, 'binary_precision': 0.9444166, 'binary_recall': 0.87144744, 'binary_specificity': 0.9816592, 'binary_f1_score': 0.9064659}
confusion matrix:
       0      1
0  41534    776
1   1945  13185
---- Validation: 
scalar performance:
{'acc': 0.95397645, 'precision': 0.66873556, 'recall': 0.746554, 'specificity': 0.746554, 'f1': 0.69924664, 'auroc': 0.8878335, 'binary_precision': 0.35346755, 'binary_recall': 0.52491695, 'binary_specificity': 0.9681911, 'binary_f1_score': 0.4224599}
confusion matrix:
       0    1
0  17593  578
1    286  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95095366, 'precision': 0.70102966, 'recall': 0.8099198, 'specificity': 0.8099198, 'f1': 0.7419007, 'auroc': 0.9016409, 'binary_precision': 0.41623038, 'binary_recall': 0.6570248, 'binary_specificity': 0.96281475, 'binary_f1_score': 0.5096154}
confusion matrix:
      0    1
0  5774  223
1    83  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_15.png
new oracle model saved
early stop counter: 5
val acc:0.9539764523506165, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 15,now: 2024-06-26 12:17:54.563547,epoch time: 0:30:59.033360,used: 6:29:54.959765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.95360374, 'precision': 0.9503551, 'recall': 0.92861235, 'specificity': 0.92861235, 'f1': 0.938766, 'auroc': 0.98377764, 'binary_precision': 0.94400114, 'binary_recall': 0.87580144, 'binary_specificity': 0.98142326, 'binary_f1_score': 0.9086234}
confusion matrix:
       0      1
0  41525    786
1   1879  13250
---- Validation: 
scalar performance:
{'acc': 0.9515794, 'precision': 0.6635641, 'recall': 0.7589676, 'specificity': 0.7589676, 'f1': 0.6987934, 'auroc': 0.88815, 'binary_precision': 0.34224048, 'binary_recall': 0.55315614, 'binary_specificity': 0.964779, 'binary_f1_score': 0.42285717}
confusion matrix:
       0    1
0  17531  640
1    269  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9440616, 'precision': 0.68215156, 'recall': 0.8182311, 'specificity': 0.8182311, 'f1': 0.72821504, 'auroc': 0.9016409, 'binary_precision': 0.37757438, 'binary_recall': 0.6818182, 'binary_specificity': 0.95464396, 'binary_f1_score': 0.48600885}
confusion matrix:
      0    1
0  5725  272
1    77  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_16.png
early stop counter: 6
val acc:0.9515793919563293, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 16,now: 2024-06-26 12:50:42.030691,epoch time: 0:32:47.467144,used: 7:02:42.426909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9561455, 'precision': 0.9519703, 'recall': 0.9337383, 'specificity': 0.9337383, 'f1': 0.94234943, 'auroc': 0.98460853, 'binary_precision': 0.94370556, 'binary_recall': 0.88638467, 'binary_specificity': 0.9810919, 'binary_f1_score': 0.91414744}
confusion matrix:
       0      1
0  41510    800
1   1719  13411
---- Validation: 
scalar performance:
{'acc': 0.94827676, 'precision': 0.655827, 'recall': 0.7677012, 'specificity': 0.7677012, 'f1': 0.6945276, 'auroc': 0.88891757, 'binary_precision': 0.32610744, 'binary_recall': 0.57475084, 'binary_specificity': 0.9606516, 'binary_f1_score': 0.41611546}
confusion matrix:
       0    1
0  17456  715
1    256  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93957365, 'precision': 0.6730842, 'recall': 0.827793, 'specificity': 0.827793, 'f1': 0.7218, 'auroc': 0.90242505, 'binary_precision': 0.35849056, 'binary_recall': 0.7066116, 'binary_specificity': 0.9489745, 'binary_f1_score': 0.47566062}
confusion matrix:
      0    1
0  5691  306
1    71  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_17.png
early stop counter: 7
val acc:0.9482767581939697, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 17,now: 2024-06-26 13:15:34.341424,epoch time: 0:24:52.310733,used: 7:27:34.737642,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9558844, 'precision': 0.9521467, 'recall': 0.9328605, 'specificity': 0.9328605, 'f1': 0.94193983, 'auroc': 0.9855112, 'binary_precision': 0.94477403, 'binary_recall': 0.88420355, 'binary_specificity': 0.9815174, 'binary_f1_score': 0.9134858}
confusion matrix:
       0      1
0  41528    782
1   1752  13378
---- Validation: 
scalar performance:
{'acc': 0.94934213, 'precision': 0.6578262, 'recall': 0.7634332, 'specificity': 0.7634332, 'f1': 0.6952215, 'auroc': 0.8897798, 'binary_precision': 0.33041787, 'binary_recall': 0.56478405, 'binary_specificity': 0.96208245, 'binary_f1_score': 0.41692212}
confusion matrix:
       0    1
0  17482  689
1    262  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94245875, 'precision': 0.6790357, 'recall': 0.82334554, 'specificity': 0.82334554, 'f1': 0.72649276, 'auroc': 0.9030018, 'binary_precision': 0.37086093, 'binary_recall': 0.6942149, 'binary_specificity': 0.95247626, 'binary_f1_score': 0.48345318}
confusion matrix:
      0    1
0  5712  285
1    74  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_18.png
early stop counter: 8
val acc:0.9493421316146851, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 18,now: 2024-06-26 13:45:36.843039,epoch time: 0:30:02.501615,used: 7:57:37.239257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95685935, 'precision': 0.95302176, 'recall': 0.9345625, 'specificity': 0.9345625, 'f1': 0.94327635, 'auroc': 0.9859133, 'binary_precision': 0.9454302, 'binary_recall': 0.8874422, 'binary_specificity': 0.98168284, 'binary_f1_score': 0.9155189}
confusion matrix:
       0      1
0  41535    775
1   1703  13427
---- Validation: 
scalar performance:
{'acc': 0.946732, 'precision': 0.65225196, 'recall': 0.7701154, 'specificity': 0.7701154, 'f1': 0.69193375, 'auroc': 0.88978267, 'binary_precision': 0.31876138, 'binary_recall': 0.5813953, 'binary_specificity': 0.9588355, 'binary_f1_score': 0.41176468}
confusion matrix:
       0    1
0  17423  748
1    252  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93716943, 'precision': 0.666809, 'recall': 0.8225769, 'specificity': 0.8225769, 'f1': 0.7148231, 'auroc': 0.90287167, 'binary_precision': 0.34631148, 'binary_recall': 0.6983471, 'binary_specificity': 0.9468067, 'binary_f1_score': 0.4630137}
confusion matrix:
      0    1
0  5678  319
1    73  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_19.png
early stop counter: 9
val acc:0.9467319846153259, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 19,now: 2024-06-26 14:13:35.567118,epoch time: 0:27:58.724079,used: 8:25:35.963336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9557451, 'precision': 0.95350236, 'recall': 0.93113124, 'specificity': 0.93113124, 'f1': 0.94156444, 'auroc': 0.98586434, 'binary_precision': 0.9491223, 'binary_recall': 0.87911433, 'binary_specificity': 0.9831482, 'binary_f1_score': 0.91277796}
confusion matrix:
       0      1
0  41597    713
1   1829  13301
---- Validation: 
scalar performance:
{'acc': 0.9507804, 'precision': 0.6619125, 'recall': 0.7625701, 'specificity': 0.7625701, 'f1': 0.69839734, 'auroc': 0.88927627, 'binary_precision': 0.33867735, 'binary_recall': 0.5614618, 'binary_specificity': 0.96367836, 'binary_f1_score': 0.42249998}
confusion matrix:
       0    1
0  17511  660
1    264  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9435807, 'precision': 0.6812277, 'recall': 0.8199637, 'specificity': 0.8199637, 'f1': 0.7277672, 'auroc': 0.90241337, 'binary_precision': 0.37556562, 'binary_recall': 0.6859504, 'binary_specificity': 0.953977, 'binary_f1_score': 0.48538008}
confusion matrix:
      0    1
0  5721  276
1    76  166
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_20.png
early stop counter: 10
val acc:0.9507803916931152, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 20,now: 2024-06-26 14:37:22.952422,epoch time: 0:23:47.385304,used: 8:49:23.348640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.95813024, 'precision': 0.95568633, 'recall': 0.93522704, 'specificity': 0.93522704, 'f1': 0.94482976, 'auroc': 0.9867221, 'binary_precision': 0.95088243, 'binary_recall': 0.88683236, 'binary_specificity': 0.98362166, 'binary_f1_score': 0.9177412}
confusion matrix:
       0      1
0  41619    693
1   1712  13416
---- Validation: 
scalar performance:
{'acc': 0.950301, 'precision': 0.66096395, 'recall': 0.7647316, 'specificity': 0.7647316, 'f1': 0.69816226, 'auroc': 0.890175, 'binary_precision': 0.33662388, 'binary_recall': 0.5664452, 'binary_specificity': 0.963018, 'binary_f1_score': 0.422291}
confusion matrix:
       0    1
0  17499  672
1    261  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94197786, 'precision': 0.67743844, 'recall': 0.8211127, 'specificity': 0.8211127, 'f1': 0.7245801, 'auroc': 0.90279984, 'binary_precision': 0.36784142, 'binary_recall': 0.69008267, 'binary_specificity': 0.9521427, 'binary_f1_score': 0.4798851}
confusion matrix:
      0    1
0  5710  287
1    75  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_21.png
early stop counter: 11
val acc:0.9503009915351868, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 21,now: 2024-06-26 15:05:45.147036,epoch time: 0:28:22.194614,used: 9:17:45.543254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.95799094, 'precision': 0.95440507, 'recall': 0.93615514, 'specificity': 0.93615514, 'f1': 0.94477785, 'auroc': 0.9865178, 'binary_precision': 0.9473055, 'binary_recall': 0.89001256, 'binary_specificity': 0.9822977, 'binary_f1_score': 0.91776574}
confusion matrix:
       0      1
0  41562    749
1   1664  13465
---- Validation: 
scalar performance:
{'acc': 0.9465722, 'precision': 0.65277356, 'recall': 0.7740481, 'specificity': 0.7740481, 'f1': 0.69324327, 'auroc': 0.89118415, 'binary_precision': 0.31953195, 'binary_recall': 0.589701, 'binary_specificity': 0.95839524, 'binary_f1_score': 0.41447753}
confusion matrix:
       0    1
0  17415  756
1    247  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9382914, 'precision': 0.6708916, 'recall': 0.8310915, 'specificity': 0.8310915, 'f1': 0.7202749, 'auroc': 0.9037473, 'binary_precision': 0.35378322, 'binary_recall': 0.71487606, 'binary_specificity': 0.947307, 'binary_f1_score': 0.47332418}
confusion matrix:
      0    1
0  5681  316
1    69  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_22.png
early stop counter: 12
val acc:0.9465721845626831, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 22,now: 2024-06-26 15:34:41.950826,epoch time: 0:28:56.803790,used: 9:46:42.347044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.95926183, 'precision': 0.9564385, 'recall': 0.9374671, 'specificity': 0.9374671, 'f1': 0.94641364, 'auroc': 0.98734343, 'binary_precision': 0.95086014, 'binary_recall': 0.8914078, 'binary_specificity': 0.98352635, 'binary_f1_score': 0.92017466}
confusion matrix:
       0      1
0  41613    697
1   1643  13487
---- Validation: 
scalar performance:
{'acc': 0.95014113, 'precision': 0.6615892, 'recall': 0.76946735, 'specificity': 0.76946735, 'f1': 0.69985306, 'auroc': 0.89192307, 'binary_precision': 0.33754864, 'binary_recall': 0.57641196, 'binary_specificity': 0.9625227, 'binary_f1_score': 0.4257669}
confusion matrix:
       0    1
0  17490  681
1    255  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9435807, 'precision': 0.681592, 'recall': 0.82194644, 'specificity': 0.82194644, 'f1': 0.72851485, 'auroc': 0.9040415, 'binary_precision': 0.37612614, 'binary_recall': 0.69008267, 'binary_specificity': 0.9538102, 'binary_f1_score': 0.48688048}
confusion matrix:
      0    1
0  5720  277
1    75  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_23.png
early stop counter: 13
val acc:0.9501411318778992, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 23,now: 2024-06-26 16:00:55.843016,epoch time: 0:26:13.892190,used: 10:12:56.239234,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.95966226, 'precision': 0.9575838, 'recall': 0.9373779, 'specificity': 0.9373779, 'f1': 0.9468724, 'auroc': 0.9873371, 'binary_precision': 0.9534933, 'binary_recall': 0.8902842, 'binary_specificity': 0.98447174, 'binary_f1_score': 0.9208053}
confusion matrix:
       0      1
0  41653    657
1   1660  13470
---- Validation: 
scalar performance:
{'acc': 0.9508869, 'precision': 0.6633735, 'recall': 0.7674434, 'specificity': 0.7674434, 'f1': 0.7008363, 'auroc': 0.89242125, 'binary_precision': 0.34126985, 'binary_recall': 0.5714286, 'binary_specificity': 0.96345824, 'binary_f1_score': 0.42732918}
confusion matrix:
       0    1
0  17507  664
1    258  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9445424, 'precision': 0.6841749, 'recall': 0.8224467, 'specificity': 0.8224467, 'f1': 0.7309247, 'auroc': 0.90518725, 'binary_precision': 0.38127854, 'binary_recall': 0.69008267, 'binary_specificity': 0.95481074, 'binary_f1_score': 0.4911765}
confusion matrix:
      0    1
0  5726  271
1    75  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_24.png
early stop counter: 14
val acc:0.9508869051933289, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 24,now: 2024-06-26 16:26:02.643169,epoch time: 0:25:06.800153,used: 10:38:03.039387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.95966226, 'precision': 0.9555713, 'recall': 0.939416, 'specificity': 0.939416, 'f1': 0.94710016, 'auroc': 0.98687816, 'binary_precision': 0.94741255, 'binary_recall': 0.8966292, 'binary_specificity': 0.98220277, 'binary_f1_score': 0.9213216}
confusion matrix:
       0      1
0  41557    753
1   1564  13566
---- Validation: 
scalar performance:
{'acc': 0.94737124, 'precision': 0.65571415, 'recall': 0.77767307, 'specificity': 0.77767307, 'f1': 0.6966503, 'auroc': 0.892712, 'binary_precision': 0.32518116, 'binary_recall': 0.59634554, 'binary_specificity': 0.9590006, 'binary_f1_score': 0.42086753}
confusion matrix:
       0    1
0  17426  745
1    243  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9382914, 'precision': 0.6712743, 'recall': 0.8330742, 'specificity': 0.8330742, 'f1': 0.72099066, 'auroc': 0.90532315, 'binary_precision': 0.35437882, 'binary_recall': 0.71900827, 'binary_specificity': 0.9471402, 'binary_f1_score': 0.47476125}
confusion matrix:
      0    1
0  5680  317
1    68  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_25.png
early stop counter: 15
val acc:0.947371244430542, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 25,now: 2024-06-26 16:48:32.341425,epoch time: 0:22:29.698256,used: 11:00:32.737643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9608461, 'precision': 0.95593035, 'recall': 0.94221216, 'specificity': 0.94221216, 'f1': 0.94878685, 'auroc': 0.9875237, 'binary_precision': 0.94604516, 'binary_recall': 0.9028356, 'binary_specificity': 0.9815887, 'binary_f1_score': 0.9239354}
confusion matrix:
       0      1
0  41532    779
1   1470  13659
---- Validation: 
scalar performance:
{'acc': 0.94683856, 'precision': 0.65425074, 'recall': 0.7773979, 'specificity': 0.7773979, 'f1': 0.69528055, 'auroc': 0.8918581, 'binary_precision': 0.3222621, 'binary_recall': 0.59634554, 'binary_specificity': 0.95845026, 'binary_f1_score': 0.41841492}
confusion matrix:
       0    1
0  17416  755
1    243  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9379708, 'precision': 0.67055345, 'recall': 0.8329075, 'specificity': 0.8329075, 'f1': 0.7202568, 'auroc': 0.9042269, 'binary_precision': 0.3529412, 'binary_recall': 0.71900827, 'binary_specificity': 0.9468067, 'binary_f1_score': 0.4734694}
confusion matrix:
      0    1
0  5678  319
1    68  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_26.png
early stop counter: 16
val acc:0.9468385577201843, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 26,now: 2024-06-26 17:12:04.494806,epoch time: 0:23:32.153381,used: 11:24:04.891024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96095055, 'precision': 0.95545137, 'recall': 0.94300497, 'specificity': 0.94300497, 'f1': 0.94899327, 'auroc': 0.98771894, 'binary_precision': 0.9443448, 'binary_recall': 0.90508294, 'binary_specificity': 0.98092693, 'binary_f1_score': 0.92429715}
confusion matrix:
       0      1
0  41504    807
1   1436  13693
---- Validation: 
scalar performance:
{'acc': 0.9448676, 'precision': 0.6500046, 'recall': 0.78039503, 'specificity': 0.78039503, 'f1': 0.6920041, 'auroc': 0.8919952, 'binary_precision': 0.31352282, 'binary_recall': 0.60465115, 'binary_specificity': 0.9561389, 'binary_f1_score': 0.4129325}
confusion matrix:
       0    1
0  17374  797
1    238  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93524605, 'precision': 0.66544205, 'recall': 0.83545566, 'specificity': 0.83545566, 'f1': 0.7155717, 'auroc': 0.9047616, 'binary_precision': 0.34241244, 'binary_recall': 0.72727275, 'binary_specificity': 0.9436385, 'binary_f1_score': 0.46560845}
confusion matrix:
      0    1
0  5659  338
1    66  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_27.png
early stop counter: 17
val acc:0.9448676109313965, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 27,now: 2024-06-26 17:33:16.779859,epoch time: 0:21:12.285053,used: 11:45:17.176077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96086353, 'precision': 0.95572484, 'recall': 0.94248176, 'specificity': 0.94248176, 'f1': 0.9488379, 'auroc': 0.9881085, 'binary_precision': 0.9453741, 'binary_recall': 0.90363514, 'binary_specificity': 0.9813283, 'binary_f1_score': 0.9240335}
confusion matrix:
       0      1
0  41520    790
1   1458  13672
---- Validation: 
scalar performance:
{'acc': 0.9446546, 'precision': 0.65058684, 'recall': 0.78510326, 'specificity': 0.78510326, 'f1': 0.6934575, 'auroc': 0.8919623, 'binary_precision': 0.31435853, 'binary_recall': 0.61461794, 'binary_specificity': 0.9555886, 'binary_f1_score': 0.415964}
confusion matrix:
       0    1
0  17364  807
1    232  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9331624, 'precision': 0.66120565, 'recall': 0.83437175, 'specificity': 0.83437175, 'f1': 0.71106184, 'auroc': 0.90481126, 'binary_precision': 0.33396584, 'binary_recall': 0.72727275, 'binary_specificity': 0.94147074, 'binary_f1_score': 0.45773733}
confusion matrix:
      0    1
0  5646  351
1    66  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_28.png
early stop counter: 18
val acc:0.9446545839309692, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 28,now: 2024-06-26 17:54:41.250914,epoch time: 0:21:24.471055,used: 12:06:41.647132,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9604631, 'precision': 0.9575356, 'recall': 0.939535, 'specificity': 0.939535, 'f1': 0.94805086, 'auroc': 0.98795974, 'binary_precision': 0.9517319, 'binary_recall': 0.89530736, 'binary_specificity': 0.9837627, 'binary_f1_score': 0.92265785}
confusion matrix:
       0      1
0  41623    687
1   1584  13546
---- Validation: 
scalar performance:
{'acc': 0.94864964, 'precision': 0.6578568, 'recall': 0.77190906, 'specificity': 0.77190906, 'f1': 0.6972506, 'auroc': 0.89173746, 'binary_precision': 0.3298872, 'binary_recall': 0.58305645, 'binary_specificity': 0.96076167, 'binary_f1_score': 0.42136854}
confusion matrix:
       0    1
0  17458  713
1    251  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94309986, 'precision': 0.6821306, 'recall': 0.83161, 'specificity': 0.83161, 'f1': 0.7309966, 'auroc': 0.9046465, 'binary_precision': 0.37636763, 'binary_recall': 0.7107438, 'binary_specificity': 0.95247626, 'binary_f1_score': 0.49213162}
confusion matrix:
      0    1
0  5712  285
1    70  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_29.png
early stop counter: 19
val acc:0.9486496448516846, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 29,now: 2024-06-26 18:18:27.257288,epoch time: 0:23:46.006374,used: 12:30:27.653506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9612291, 'precision': 0.9578302, 'recall': 0.94126505, 'specificity': 0.94126505, 'f1': 0.94913685, 'auroc': 0.98811626, 'binary_precision': 0.9510592, 'binary_recall': 0.8990747, 'binary_specificity': 0.9834554, 'binary_f1_score': 0.9243366}
confusion matrix:
       0      1
0  41610    700
1   1527  13603
---- Validation: 
scalar performance:
{'acc': 0.94769084, 'precision': 0.65623355, 'recall': 0.77623206, 'specificity': 0.77623206, 'f1': 0.69679934, 'auroc': 0.8922229, 'binary_precision': 0.32632542, 'binary_recall': 0.59302324, 'binary_specificity': 0.9594409, 'binary_f1_score': 0.42099056}
confusion matrix:
       0    1
0  17434  737
1    245  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9416573, 'precision': 0.6781201, 'recall': 0.8288769, 'specificity': 0.8288769, 'f1': 0.72674924, 'auroc': 0.9045392, 'binary_precision': 0.36853448, 'binary_recall': 0.7066116, 'binary_specificity': 0.95114225, 'binary_f1_score': 0.48441926}
confusion matrix:
      0    1
0  5704  293
1    71  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556222_30.png
early stop counter: 20
val acc:0.9476908445358276, best validation acc: 0.9541362524032593, corresponding to test acc:                         0.9475877285003662 / 0.9509536623954773
after epoch: 30,now: 2024-06-26 18:41:19.325877,epoch time: 0:22:52.068589,used: 12:53:19.722095,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_05_47_59_seed_2_21556222
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:53:19.722095 at 2024-06-26 18:41:19.325877
persisted model performance metric: 

scalar performance:
{'acc': 0.9475877, 'precision': 0.6876804, 'recall': 0.7942897, 'specificity': 0.7942897, 'f1': 0.7270865, 'auroc': 0.8948289, 'binary_precision': 0.3907455, 'binary_recall': 0.6280992, 'binary_specificity': 0.9604802, 'binary_f1_score': 0.48177496}
confusion matrix:
      0    1
0  5760  237
1    90  152
oracle model performance metric: 

scalar performance:
{'acc': 0.95095366, 'precision': 0.70102966, 'recall': 0.8099198, 'specificity': 0.8099198, 'f1': 0.7419007, 'auroc': 0.9016409, 'binary_precision': 0.41623038, 'binary_recall': 0.6570248, 'binary_specificity': 0.96281475, 'binary_f1_score': 0.5096154}
confusion matrix:
      0    1
0  5774  223
1    83  159
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190965 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190965 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189282 KiB | 457564 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  16468 KiB |  37503 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1080 MiB | 579584 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1014 MiB | 550912 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     66 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38410 KiB |  87618 KiB |   1252 TiB |   1252 TiB |
|       from large pool |  31306 KiB |  79555 KiB |   1205 TiB |   1205 TiB |
|       from small pool |   7104 KiB |  21236 KiB |     46 TiB |     46 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7663    |  471825 K  |  471822 K  |
|       from large pool |      76    |     158    |  219127 K  |  219127 K  |
|       from small pool |    2878    |    7585    |  252698 K  |  252695 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7663    |  471825 K  |  471822 K  |
|       from large pool |      76    |     158    |  219127 K  |  219127 K  |
|       from small pool |    2878    |    7585    |  252698 K  |  252695 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      78    |      37    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      33    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      29    |    3609    |  264645 K  |  264645 K  |
|       from large pool |      10    |      22    |  130502 K  |  130502 K  |
|       from small pool |      19    |    3599    |  134142 K  |  134142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  37503 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB | 526336 KiB |   1080 MiB |    856 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1014 MiB |    814 MiB |
|       from small pool |  24576 KiB |  43008 KiB |     66 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87618 KiB |   1252 TiB |   1252 TiB |
|       from large pool |  23872 KiB |  79555 KiB |   1205 TiB |   1205 TiB |
|       from small pool |      0 KiB |  21236 KiB |     46 TiB |     46 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7663    |  471825 K  |  471825 K  |
|       from large pool |       2    |     158    |  219127 K  |  219127 K  |
|       from small pool |       0    |    7585    |  252698 K  |  252698 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7663    |  471825 K  |  471825 K  |
|       from large pool |       2    |     158    |  219127 K  |  219127 K  |
|       from small pool |       0    |    7585    |  252698 K  |  252698 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      42    |      78    |      56    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      12    |      21    |      33    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3609    |  264646 K  |  264646 K  |
|       from large pool |       3    |      22    |  130502 K  |  130502 K  |
|       from small pool |       0    |    3599    |  134143 K  |  134143 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jun 26 18:42:44 2024]
Finished job 0.
1 of 1 steps (100%) done
