Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun 26 00:09:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225

 Experiment start at: 2024-06-26 00:22:48.057441
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92701614, 'precision': 0.9293394, 'recall': 0.87653697, 'specificity': 0.87653697, 'f1': 0.8987267, 'auroc': 0.96729815, 'binary_precision': 0.93339354, 'binary_recall': 0.77223617, 'binary_specificity': 0.9808378, 'binary_f1_score': 0.8452013}
confusion matrix:
       0      1
0  41512    811
1   3352  11365
---- Validation: 
scalar performance:
{'acc': 0.95780116, 'precision': 0.68902516, 'recall': 0.7141336, 'specificity': 0.7141336, 'f1': 0.70068604, 'auroc': 0.86663914, 'binary_precision': 0.397541, 'binary_recall': 0.4525661, 'binary_specificity': 0.97570115, 'binary_f1_score': 0.42327273}
confusion matrix:
       0    1
0  17708  441
1    352  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7418344, 'recall': 0.7329565, 'specificity': 0.7329565, 'f1': 0.7373004, 'auroc': 0.89304674, 'binary_precision': 0.5059761, 'binary_recall': 0.48659003, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.49609375}
confusion matrix:
      0    1
0  5873  124
1   134  127
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-26 01:01:17.551184,epoch time: 0:38:29.493743,used: 0:38:29.493743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9428296, 'precision': 0.94473815, 'recall': 0.90387416, 'specificity': 0.90387416, 'f1': 0.92186713, 'auroc': 0.977888, 'binary_precision': 0.94819623, 'binary_recall': 0.82338953, 'binary_specificity': 0.9843587, 'binary_f1_score': 0.88139665}
confusion matrix:
       0      1
0  41662    662
1   2599  12117
---- Validation: 
scalar performance:
{'acc': 0.9553533, 'precision': 0.6828916, 'recall': 0.7368681, 'specificity': 0.7368681, 'f1': 0.70588756, 'auroc': 0.8802994, 'binary_precision': 0.38361046, 'binary_recall': 0.5023328, 'binary_specificity': 0.97140336, 'binary_f1_score': 0.4350168}
confusion matrix:
       0    1
0  17630  519
1    320  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.74307066, 'recall': 0.79334015, 'specificity': 0.79334015, 'f1': 0.76548994, 'auroc': 0.90725774, 'binary_precision': 0.5031447, 'binary_recall': 0.6130268, 'binary_specificity': 0.9736535, 'binary_f1_score': 0.55267704}
confusion matrix:
      0    1
0  5839  158
1   101  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_2.png
early stop counter: 1
val acc:0.955353319644928, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.9587727785110474
after epoch: 2,now: 2024-06-26 01:38:18.717148,epoch time: 0:37:01.165964,used: 1:15:30.659707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94936883, 'precision': 0.94857633, 'recall': 0.91740906, 'specificity': 0.91740906, 'f1': 0.9315742, 'auroc': 0.9807427, 'binary_precision': 0.94709796, 'binary_recall': 0.8513587, 'binary_specificity': 0.98345935, 'binary_f1_score': 0.89668}
confusion matrix:
       0      1
0  41620    700
1   2188  12532
---- Validation: 
scalar performance:
{'acc': 0.9566837, 'precision': 0.689993, 'recall': 0.7435573, 'specificity': 0.7435573, 'f1': 0.712983, 'auroc': 0.8865242, 'binary_precision': 0.39735895, 'binary_recall': 0.5147745, 'binary_specificity': 0.97234005, 'binary_f1_score': 0.44850948}
confusion matrix:
       0    1
0  17647  502
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.75799716, 'recall': 0.8094996, 'specificity': 0.8094996, 'f1': 0.7810682, 'auroc': 0.9116659, 'binary_precision': 0.5316456, 'binary_recall': 0.6436782, 'binary_specificity': 0.975321, 'binary_f1_score': 0.5823224}
confusion matrix:
      0    1
0  5849  148
1    93  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_3.png
new oracle model saved
early stop counter: 2
val acc:0.9566836953163147, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.9614893198013306
after epoch: 3,now: 2024-06-26 02:14:44.127210,epoch time: 0:36:25.410062,used: 1:51:56.069769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95185834, 'precision': 0.9510282, 'recall': 0.92162967, 'specificity': 0.92162967, 'f1': 0.9350734, 'auroc': 0.9839901, 'binary_precision': 0.9494707, 'binary_recall': 0.8591616, 'binary_specificity': 0.9840977, 'binary_f1_score': 0.9020614}
confusion matrix:
       0      1
0  41648    673
1   2073  12646
---- Validation: 
scalar performance:
{'acc': 0.95583224, 'precision': 0.68655306, 'recall': 0.7446166, 'specificity': 0.7446166, 'f1': 0.7110939, 'auroc': 0.8906591, 'binary_precision': 0.39038688, 'binary_recall': 0.5178849, 'binary_specificity': 0.9713483, 'binary_f1_score': 0.44518715}
confusion matrix:
       0    1
0  17629  520
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.74993646, 'recall': 0.81416285, 'specificity': 0.81416285, 'f1': 0.7778384, 'auroc': 0.91238153, 'binary_precision': 0.51506025, 'binary_recall': 0.6551724, 'binary_specificity': 0.97315323, 'binary_f1_score': 0.5767285}
confusion matrix:
      0    1
0  5836  161
1    90  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_4.png
early stop counter: 3
val acc:0.9558322429656982, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.9614893198013306
after epoch: 4,now: 2024-06-26 02:51:05.668348,epoch time: 0:36:21.541138,used: 2:28:17.610907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9547511, 'precision': 0.9548893, 'recall': 0.92556864, 'specificity': 0.92556864, 'f1': 0.9389937, 'auroc': 0.9850841, 'binary_precision': 0.9551489, 'binary_recall': 0.86526704, 'binary_specificity': 0.98587024, 'binary_f1_score': 0.90798897}
confusion matrix:
       0      1
0  41724    598
1   1983  12735
---- Validation: 
scalar performance:
{'acc': 0.9539698, 'precision': 0.68032736, 'recall': 0.75040287, 'specificity': 0.75040287, 'f1': 0.7087854, 'auroc': 0.8916615, 'binary_precision': 0.37748346, 'binary_recall': 0.5318818, 'binary_specificity': 0.9689239, 'binary_f1_score': 0.4415752}
confusion matrix:
       0    1
0  17585  564
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7431333, 'recall': 0.8298201, 'specificity': 0.8298201, 'f1': 0.77888405, 'auroc': 0.9145039, 'binary_precision': 0.5, 'binary_recall': 0.6896552, 'binary_specificity': 0.969985, 'binary_f1_score': 0.5797101}
confusion matrix:
      0    1
0  5817  180
1    81  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_5.png
early stop counter: 4
val acc:0.9539697766304016, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.9614893198013306
after epoch: 5,now: 2024-06-26 03:28:31.592560,epoch time: 0:37:25.924212,used: 3:05:43.535119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9571178, 'precision': 0.9565673, 'recall': 0.93016887, 'specificity': 0.93016887, 'f1': 0.94236845, 'auroc': 0.98630285, 'binary_precision': 0.9555242, 'binary_recall': 0.8744904, 'binary_specificity': 0.9858473, 'binary_f1_score': 0.9132132}
confusion matrix:
       0      1
0  41725    599
1   1847  12869
---- Validation: 
scalar performance:
{'acc': 0.9538633, 'precision': 0.68039656, 'recall': 0.7525979, 'specificity': 0.7525979, 'f1': 0.70954734, 'auroc': 0.8928784, 'binary_precision': 0.3774617, 'binary_recall': 0.5365474, 'binary_specificity': 0.96864843, 'binary_f1_score': 0.44315994}
confusion matrix:
       0    1
0  17580  569
1    298  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7424396, 'recall': 0.8297367, 'specificity': 0.8297367, 'f1': 0.77837515, 'auroc': 0.913267, 'binary_precision': 0.49861497, 'binary_recall': 0.6896552, 'binary_specificity': 0.96981823, 'binary_f1_score': 0.57877815}
confusion matrix:
      0    1
0  5816  181
1    81  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_6.png
early stop counter: 5
val acc:0.9538633227348328, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.9614893198013306
after epoch: 6,now: 2024-06-26 04:05:34.650528,epoch time: 0:37:03.057968,used: 3:42:46.593087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9581522, 'precision': 0.95715296, 'recall': 0.9323325, 'specificity': 0.9323325, 'f1': 0.9438588, 'auroc': 0.9879349, 'binary_precision': 0.9552503, 'binary_recall': 0.8789835, 'binary_specificity': 0.98568153, 'binary_f1_score': 0.91553134}
confusion matrix:
       0      1
0  41717    606
1   1781  12936
---- Validation: 
scalar performance:
{'acc': 0.9557791, 'precision': 0.68709564, 'recall': 0.7483393, 'specificity': 0.7483393, 'f1': 0.7127696, 'auroc': 0.8945416, 'binary_precision': 0.3912037, 'binary_recall': 0.525661, 'binary_specificity': 0.97101766, 'binary_f1_score': 0.44857332}
confusion matrix:
       0    1
0  17623  526
1    305  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.7658953, 'recall': 0.83232135, 'specificity': 0.83232135, 'f1': 0.794883, 'auroc': 0.9141755, 'binary_precision': 0.54545456, 'binary_recall': 0.6896552, 'binary_specificity': 0.9749875, 'binary_f1_score': 0.609137}
confusion matrix:
      0    1
0  5847  150
1    81  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_7.png
new oracle model saved
early stop counter: 6
val acc:0.9557790756225586, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.963087260723114
after epoch: 7,now: 2024-06-26 04:42:40.872891,epoch time: 0:37:06.222363,used: 4:19:52.815450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9598001, 'precision': 0.9584826, 'recall': 0.93539315, 'specificity': 0.93539315, 'f1': 0.94617426, 'auroc': 0.98731893, 'binary_precision': 0.9559601, 'binary_recall': 0.884963, 'binary_specificity': 0.98582333, 'binary_f1_score': 0.9190925}
confusion matrix:
       0      1
0  41723    600
1   1693  13024
---- Validation: 
scalar performance:
{'acc': 0.9542891, 'precision': 0.68190795, 'recall': 0.7520683, 'specificity': 0.7520683, 'f1': 0.71044755, 'auroc': 0.89504707, 'binary_precision': 0.38053098, 'binary_recall': 0.5349922, 'binary_specificity': 0.9691443, 'binary_f1_score': 0.44473174}
confusion matrix:
       0    1
0  17589  560
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.752543, 'recall': 0.83273625, 'specificity': 0.83273625, 'f1': 0.7863064, 'auroc': 0.91360176, 'binary_precision': 0.51862466, 'binary_recall': 0.6934866, 'binary_specificity': 0.971986, 'binary_f1_score': 0.5934426}
confusion matrix:
      0    1
0  5829  168
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_8.png
early stop counter: 7
val acc:0.9542890787124634, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.963087260723114
after epoch: 8,now: 2024-06-26 05:19:59.662688,epoch time: 0:37:18.789797,used: 4:57:11.605247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.961378, 'precision': 0.95776296, 'recall': 0.9403057, 'specificity': 0.9403057, 'f1': 0.948594, 'auroc': 0.988603, 'binary_precision': 0.9507205, 'binary_recall': 0.896772, 'binary_specificity': 0.98383933, 'binary_f1_score': 0.9229586}
confusion matrix:
       0      1
0  41641    684
1   1519  13196
---- Validation: 
scalar performance:
{'acc': 0.9494998, 'precision': 0.6691724, 'recall': 0.76909024, 'specificity': 0.76909024, 'f1': 0.7058454, 'auroc': 0.8964498, 'binary_precision': 0.3537285, 'binary_recall': 0.5754277, 'binary_specificity': 0.96275276, 'binary_f1_score': 0.4381291}
confusion matrix:
       0    1
0  17473  676
1    273  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501438, 'precision': 0.7134314, 'recall': 0.8365619, 'specificity': 0.8365619, 'f1': 0.7587452, 'auroc': 0.9136778, 'binary_precision': 0.4397163, 'binary_recall': 0.7126437, 'binary_specificity': 0.9604802, 'binary_f1_score': 0.54385966}
confusion matrix:
      0    1
0  5760  237
1    75  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_9.png
early stop counter: 8
val acc:0.949499785900116, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.963087260723114
after epoch: 9,now: 2024-06-26 05:58:15.108259,epoch time: 0:38:15.445571,used: 5:35:27.050818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96136045, 'precision': 0.9612199, 'recall': 0.9368656, 'specificity': 0.9368656, 'f1': 0.94820094, 'auroc': 0.9884518, 'binary_precision': 0.96095186, 'binary_recall': 0.886254, 'binary_specificity': 0.98747724, 'binary_f1_score': 0.9220926}
confusion matrix:
       0      1
0  41793    530
1   1674  13043
---- Validation: 
scalar performance:
{'acc': 0.95381016, 'precision': 0.6808309, 'recall': 0.75557065, 'specificity': 0.75557065, 'f1': 0.71081126, 'auroc': 0.89504576, 'binary_precision': 0.37811485, 'binary_recall': 0.5427683, 'binary_specificity': 0.96837294, 'binary_f1_score': 0.4457216}
confusion matrix:
       0    1
0  17575  574
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.75037175, 'recall': 0.8343185, 'specificity': 0.8343185, 'f1': 0.78538966, 'auroc': 0.912837, 'binary_precision': 0.5141243, 'binary_recall': 0.697318, 'binary_specificity': 0.971319, 'binary_f1_score': 0.59186995}
confusion matrix:
      0    1
0  5825  172
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_10.png
early stop counter: 9
val acc:0.9538101553916931, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.963087260723114
after epoch: 10,now: 2024-06-26 06:35:40.679259,epoch time: 0:37:25.571000,used: 6:12:52.621818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9626052, 'precision': 0.96162164, 'recall': 0.9397327, 'specificity': 0.9397327, 'f1': 0.9499962, 'auroc': 0.989333, 'binary_precision': 0.95973104, 'binary_recall': 0.89248335, 'binary_specificity': 0.986982, 'binary_f1_score': 0.92488647}
confusion matrix:
       0      1
0  41775    551
1   1582  13132
---- Validation: 
scalar performance:
{'acc': 0.95381016, 'precision': 0.68098974, 'recall': 0.75632066, 'specificity': 0.75632066, 'f1': 0.7111641, 'auroc': 0.8962454, 'binary_precision': 0.3783784, 'binary_recall': 0.5443235, 'binary_specificity': 0.9683178, 'binary_f1_score': 0.4464286}
confusion matrix:
       0    1
0  17574  575
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.75333977, 'recall': 0.8364843, 'specificity': 0.8364843, 'f1': 0.7881563, 'auroc': 0.91314703, 'binary_precision': 0.5198864, 'binary_recall': 0.7011494, 'binary_specificity': 0.9718192, 'binary_f1_score': 0.59706366}
confusion matrix:
      0    1
0  5828  169
1    78  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_11.png
early stop counter: 10
val acc:0.9538101553916931, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.963087260723114
after epoch: 11,now: 2024-06-26 07:12:20.359890,epoch time: 0:36:39.680631,used: 6:49:32.302449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9642531, 'precision': 0.9610525, 'recall': 0.9446813, 'specificity': 0.9446813, 'f1': 0.9524827, 'auroc': 0.98916066, 'binary_precision': 0.95479333, 'binary_recall': 0.90424734, 'binary_specificity': 0.9851152, 'binary_f1_score': 0.9288332}
confusion matrix:
       0      1
0  41695    630
1   1409  13306
---- Validation: 
scalar performance:
{'acc': 0.94971263, 'precision': 0.6713294, 'recall': 0.7759509, 'specificity': 0.7759509, 'f1': 0.7093799, 'auroc': 0.89602923, 'binary_precision': 0.35754716, 'binary_recall': 0.58942455, 'binary_specificity': 0.96247727, 'binary_f1_score': 0.44509688}
confusion matrix:
       0    1
0  17468  681
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949185, 'precision': 0.710824, 'recall': 0.8397264, 'specificity': 0.8397264, 'f1': 0.7574439, 'auroc': 0.9125885, 'binary_precision': 0.43418014, 'binary_recall': 0.7203065, 'binary_specificity': 0.95914626, 'binary_f1_score': 0.54178673}
confusion matrix:
      0    1
0  5752  245
1    73  188
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_12.png
early stop counter: 11
val acc:0.9497126340866089, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.963087260723114
after epoch: 12,now: 2024-06-26 07:48:54.705232,epoch time: 0:36:34.345342,used: 7:26:06.647791,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9623247, 'precision': 0.9626306, 'recall': 0.9380436, 'specificity': 0.9380436, 'f1': 0.9494828, 'auroc': 0.98968756, 'binary_precision': 0.96321416, 'binary_recall': 0.88787717, 'binary_specificity': 0.98821, 'binary_f1_score': 0.92401254}
confusion matrix:
       0      1
0  41825    499
1   1650  13066
---- Validation: 
scalar performance:
{'acc': 0.9544487, 'precision': 0.6819054, 'recall': 0.7491507, 'specificity': 0.7491507, 'f1': 0.7094811, 'auroc': 0.89720833, 'binary_precision': 0.3807391, 'binary_recall': 0.5287714, 'binary_specificity': 0.96953, 'binary_f1_score': 0.44270834}
confusion matrix:
       0    1
0  17596  553
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.7666651, 'recall': 0.83423704, 'specificity': 0.83423704, 'f1': 0.7960988, 'auroc': 0.91444767, 'binary_precision': 0.5468278, 'binary_recall': 0.6934866, 'binary_specificity': 0.9749875, 'binary_f1_score': 0.6114865}
confusion matrix:
      0    1
0  5847  150
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_13.png
new oracle model saved
early stop counter: 12
val acc:0.9544486999511719, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.9632470607757568
after epoch: 13,now: 2024-06-26 08:27:06.176420,epoch time: 0:38:11.471188,used: 8:04:18.118979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9633941, 'precision': 0.96447545, 'recall': 0.93910396, 'specificity': 0.93910396, 'f1': 0.9508854, 'auroc': 0.9898974, 'binary_precision': 0.96653366, 'binary_recall': 0.88891155, 'binary_specificity': 0.9892964, 'binary_f1_score': 0.926099}
confusion matrix:
       0      1
0  41869    453
1   1635  13083
---- Validation: 
scalar performance:
{'acc': 0.9536505, 'precision': 0.6798958, 'recall': 0.7539878, 'specificity': 0.7539878, 'f1': 0.70963436, 'auroc': 0.8973808, 'binary_precision': 0.37635574, 'binary_recall': 0.53965783, 'binary_specificity': 0.9683178, 'binary_f1_score': 0.44345045}
confusion matrix:
       0    1
0  17574  575
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.759405, 'recall': 0.83531904, 'specificity': 0.83531904, 'f1': 0.79179317, 'auroc': 0.91336405, 'binary_precision': 0.53216374, 'binary_recall': 0.697318, 'binary_specificity': 0.97332, 'binary_f1_score': 0.6036485}
confusion matrix:
      0    1
0  5837  160
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_14.png
early stop counter: 13
val acc:0.9536504745483398, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.9632470607757568
after epoch: 14,now: 2024-06-26 09:06:05.698099,epoch time: 0:38:59.521679,used: 8:43:17.640658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9649895, 'precision': 0.96236163, 'recall': 0.9453449, 'specificity': 0.9453449, 'f1': 0.9534399, 'auroc': 0.99037373, 'binary_precision': 0.95723116, 'binary_recall': 0.904749, 'binary_specificity': 0.9859408, 'binary_f1_score': 0.9302504}
confusion matrix:
       0      1
0  41726    595
1   1402  13317
---- Validation: 
scalar performance:
{'acc': 0.953278, 'precision': 0.68132204, 'recall': 0.76729596, 'specificity': 0.76729596, 'f1': 0.7147875, 'auroc': 0.8972555, 'binary_precision': 0.37823835, 'binary_recall': 0.5676516, 'binary_specificity': 0.96694034, 'binary_f1_score': 0.45398012}
confusion matrix:
       0    1
0  17549  600
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7420199, 'recall': 0.83515036, 'specificity': 0.83515036, 'f1': 0.7798755, 'auroc': 0.91230166, 'binary_precision': 0.4972826, 'binary_recall': 0.7011494, 'binary_specificity': 0.96915126, 'binary_f1_score': 0.581876}
confusion matrix:
      0    1
0  5812  185
1    78  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_15.png
early stop counter: 14
val acc:0.9532780051231384, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.9632470607757568
after epoch: 15,now: 2024-06-26 09:51:58.099363,epoch time: 0:45:52.401264,used: 9:29:10.041922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9642356, 'precision': 0.96230006, 'recall': 0.9433871, 'specificity': 0.9433871, 'f1': 0.9523343, 'auroc': 0.9905052, 'binary_precision': 0.9585444, 'binary_recall': 0.9003126, 'binary_specificity': 0.9864616, 'binary_f1_score': 0.92851645}
confusion matrix:
       0      1
0  41751    573
1   1467  13249
---- Validation: 
scalar performance:
{'acc': 0.9543955, 'precision': 0.68509436, 'recall': 0.7656244, 'specificity': 0.7656244, 'f1': 0.71706724, 'auroc': 0.8980249, 'binary_precision': 0.3859275, 'binary_recall': 0.562986, 'binary_specificity': 0.96826273, 'binary_f1_score': 0.45793802}
confusion matrix:
       0    1
0  17573  576
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.75632447, 'recall': 0.8349855, 'specificity': 0.8349855, 'f1': 0.7896329, 'auroc': 0.91286385, 'binary_precision': 0.5260116, 'binary_recall': 0.697318, 'binary_specificity': 0.972653, 'binary_f1_score': 0.5996706}
confusion matrix:
      0    1
0  5833  164
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_16.png
early stop counter: 15
val acc:0.9543954730033875, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.9632470607757568
after epoch: 16,now: 2024-06-26 10:40:12.918482,epoch time: 0:48:14.819119,used: 10:17:24.861041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96553296, 'precision': 0.961178, 'recall': 0.948004, 'specificity': 0.948004, 'f1': 0.9543413, 'auroc': 0.9902973, 'binary_precision': 0.95257366, 'binary_recall': 0.91179067, 'binary_specificity': 0.98421735, 'binary_f1_score': 0.9317361}
confusion matrix:
       0      1
0  41657    668
1   1298  13417
---- Validation: 
scalar performance:
{'acc': 0.9522137, 'precision': 0.67887986, 'recall': 0.7734955, 'specificity': 0.7734955, 'f1': 0.71472377, 'auroc': 0.8986409, 'binary_precision': 0.37288135, 'binary_recall': 0.5816485, 'binary_specificity': 0.96534246, 'binary_f1_score': 0.454435}
confusion matrix:
       0    1
0  17520  629
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.73352146, 'recall': 0.83406645, 'specificity': 0.83406645, 'f1': 0.7734247, 'auroc': 0.91191304, 'binary_precision': 0.48031497, 'binary_recall': 0.7011494, 'binary_specificity': 0.9669835, 'binary_f1_score': 0.57009345}
confusion matrix:
      0    1
0  5799  198
1    78  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_17.png
early stop counter: 16
val acc:0.952213704586029, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.9632470607757568
after epoch: 17,now: 2024-06-26 11:36:35.124104,epoch time: 0:56:22.205622,used: 11:13:47.066663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9638675, 'precision': 0.96294165, 'recall': 0.94179046, 'specificity': 0.94179046, 'f1': 0.9517318, 'auroc': 0.9905256, 'binary_precision': 0.96115726, 'binary_recall': 0.8961745, 'binary_specificity': 0.9874064, 'binary_f1_score': 0.9275291}
confusion matrix:
       0      1
0  41790    533
1   1528  13189
---- Validation: 
scalar performance:
{'acc': 0.9544487, 'precision': 0.6831711, 'recall': 0.75515115, 'specificity': 0.75515115, 'f1': 0.71234846, 'auroc': 0.8982942, 'binary_precision': 0.38283828, 'binary_recall': 0.54121304, 'binary_specificity': 0.9690892, 'binary_f1_score': 0.4484536}
confusion matrix:
       0    1
0  17588  561
1    295  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.76255846, 'recall': 0.8356525, 'specificity': 0.8356525, 'f1': 0.7939799, 'auroc': 0.9126556, 'binary_precision': 0.53846157, 'binary_recall': 0.697318, 'binary_specificity': 0.973987, 'binary_f1_score': 0.60767955}
confusion matrix:
      0    1
0  5841  156
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_18.png
early stop counter: 17
val acc:0.9544486999511719, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.9632470607757568
after epoch: 18,now: 2024-06-26 12:25:16.286968,epoch time: 0:48:41.162864,used: 12:02:28.229527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9663219, 'precision': 0.96483874, 'recall': 0.94642, 'specificity': 0.94642, 'f1': 0.9551493, 'auroc': 0.99133956, 'binary_precision': 0.96195495, 'binary_recall': 0.90529245, 'binary_specificity': 0.9875476, 'binary_f1_score': 0.932764}
confusion matrix:
       0      1
0  41794    527
1   1394  13325
---- Validation: 
scalar performance:
{'acc': 0.9565241, 'precision': 0.69061744, 'recall': 0.7502251, 'specificity': 0.7502251, 'f1': 0.715801, 'auroc': 0.8976941, 'binary_precision': 0.39812645, 'binary_recall': 0.5287714, 'binary_specificity': 0.97167885, 'binary_f1_score': 0.4542418}
confusion matrix:
       0    1
0  17635  514
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.7779943, 'recall': 0.8334886, 'specificity': 0.8334886, 'f1': 0.8028705, 'auroc': 0.91087097, 'binary_precision': 0.56962025, 'binary_recall': 0.6896552, 'binary_specificity': 0.977322, 'binary_f1_score': 0.6239168}
confusion matrix:
      0    1
0  5861  136
1    81  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_19.png
new oracle model saved
early stop counter: 18
val acc:0.9565240740776062, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.9653244018554688
after epoch: 19,now: 2024-06-26 13:06:56.541549,epoch time: 0:41:40.254581,used: 12:44:08.484108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9663394, 'precision': 0.96477973, 'recall': 0.94650817, 'specificity': 0.94650817, 'f1': 0.9551715, 'auroc': 0.99154246, 'binary_precision': 0.96174663, 'binary_recall': 0.90553856, 'binary_specificity': 0.98747784, 'binary_f1_score': 0.9327966}
confusion matrix:
       0      1
0  41795    530
1   1390  13325
---- Validation: 
scalar performance:
{'acc': 0.9556194, 'precision': 0.6882246, 'recall': 0.75725734, 'specificity': 0.75725734, 'f1': 0.71659446, 'auroc': 0.89979935, 'binary_precision': 0.39281705, 'binary_recall': 0.5443235, 'binary_specificity': 0.9701912, 'binary_f1_score': 0.45632333}
confusion matrix:
       0    1
0  17608  541
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.7709527, 'recall': 0.8328216, 'specificity': 0.8328216, 'f1': 0.7982631, 'auroc': 0.91130835, 'binary_precision': 0.5555556, 'binary_recall': 0.6896552, 'binary_specificity': 0.975988, 'binary_f1_score': 0.61538464}
confusion matrix:
      0    1
0  5853  144
1    81  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_20.png
early stop counter: 19
val acc:0.9556193947792053, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.9653244018554688
after epoch: 20,now: 2024-06-26 13:48:21.546645,epoch time: 0:41:25.005096,used: 13:25:33.489204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9661466, 'precision': 0.9662695, 'recall': 0.9445672, 'specificity': 0.9445672, 'f1': 0.9547572, 'auroc': 0.99180174, 'binary_precision': 0.9665061, 'binary_recall': 0.8999796, 'binary_specificity': 0.9891548, 'binary_f1_score': 0.93205726}
confusion matrix:
       0      1
0  41864    459
1   1472  13245
---- Validation: 
scalar performance:
{'acc': 0.95705616, 'precision': 0.6925522, 'recall': 0.7482505, 'specificity': 0.7482505, 'f1': 0.7163726, 'auroc': 0.8995397, 'binary_precision': 0.40214798, 'binary_recall': 0.5241057, 'binary_specificity': 0.9723952, 'binary_f1_score': 0.4550979}
confusion matrix:
       0    1
0  17648  501
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.7846413, 'recall': 0.83223987, 'specificity': 0.83223987, 'f1': 0.80635273, 'auroc': 0.9101847, 'binary_precision': 0.5830619, 'binary_recall': 0.68582374, 'binary_specificity': 0.978656, 'binary_f1_score': 0.6302817}
confusion matrix:
      0    1
0  5869  128
1    82  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_21.png
new oracle model saved
early stop counter: 20
val acc:0.9570561647415161, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9587727785110474 / 0.9664429426193237
after epoch: 21,now: 2024-06-26 14:30:23.840605,epoch time: 0:42:02.293960,used: 14:07:35.783164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_00_22_48_seed_0_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 14:07:35.783164 at 2024-06-26 14:30:23.840605
persisted model performance metric: 

scalar performance:
{'acc': 0.9587728, 'precision': 0.7418344, 'recall': 0.7329565, 'specificity': 0.7329565, 'f1': 0.7373004, 'auroc': 0.89304674, 'binary_precision': 0.5059761, 'binary_recall': 0.48659003, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.49609375}
confusion matrix:
      0    1
0  5873  124
1   134  127
oracle model performance metric: 

scalar performance:
{'acc': 0.96644294, 'precision': 0.7846413, 'recall': 0.83223987, 'specificity': 0.83223987, 'f1': 0.80635273, 'auroc': 0.9101847, 'binary_precision': 0.5830619, 'binary_recall': 0.68582374, 'binary_specificity': 0.978656, 'binary_f1_score': 0.6302817}
confusion matrix:
      0    1
0  5869  128
1    82  179
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191429 KiB |   2166 MiB |   2624 TiB |   2624 TiB |
|       from large pool | 173952 KiB |   2148 MiB |   2589 TiB |   2589 TiB |
|       from small pool |  17477 KiB |     37 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 191429 KiB |   2166 MiB |   2624 TiB |   2624 TiB |
|       from large pool | 173952 KiB |   2148 MiB |   2589 TiB |   2589 TiB |
|       from small pool |  17477 KiB |     37 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189283 KiB |   2164 MiB |   2624 TiB |   2624 TiB |
|       from large pool | 172814 KiB |   2147 MiB |   2589 TiB |   2589 TiB |
|       from small pool |  16469 KiB |     36 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2410 MiB |   2410 MiB |   2410 MiB |      0 B   |
|       from large pool |   2368 MiB |   2368 MiB |   2368 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  64570 KiB | 244602 KiB |   1429 TiB |   1429 TiB |
|       from large pool |  57472 KiB | 244060 KiB |   1394 TiB |   1394 TiB |
|       from small pool |   7098 KiB |   9995 KiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7593    |  359236 K  |  359233 K  |
|       from large pool |      76    |     253    |  245902 K  |  245902 K  |
|       from small pool |    2890    |    7516    |  113334 K  |  113331 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7593    |  359236 K  |  359233 K  |
|       from large pool |      76    |     253    |  245902 K  |  245902 K  |
|       from small pool |    2890    |    7516    |  113334 K  |  113331 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     119    |     119    |     119    |       0    |
|       from large pool |      98    |      98    |      98    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |    3587    |  226630 K  |  226630 K  |
|       from large pool |      10    |     100    |  173218 K  |  173218 K  |
|       from small pool |      20    |    3577    |   53411 K  |   53411 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2166 MiB |   2624 TiB |   2624 TiB |
|       from large pool |  16640 KiB |   2148 MiB |   2589 TiB |   2589 TiB |
|       from small pool |      0 KiB |     37 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2166 MiB |   2624 TiB |   2624 TiB |
|       from large pool |  16640 KiB |   2148 MiB |   2589 TiB |   2589 TiB |
|       from small pool |      0 KiB |     37 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2164 MiB |   2624 TiB |   2624 TiB |
|       from large pool |  16640 KiB |   2147 MiB |   2589 TiB |   2589 TiB |
|       from small pool |      0 KiB |     36 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   2410 MiB |   2410 MiB |   2160 MiB |
|       from large pool | 231424 KiB |   2368 MiB |   2368 MiB |   2142 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 244602 KiB |   1429 TiB |   1429 TiB |
|       from large pool |  30464 KiB | 244060 KiB |   1394 TiB |   1394 TiB |
|       from small pool |      0 KiB |  18293 KiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7593    |  359236 K  |  359236 K  |
|       from large pool |       2    |     253    |  245902 K  |  245902 K  |
|       from small pool |       0    |    7516    |  113334 K  |  113334 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7593    |  359236 K  |  359236 K  |
|       from large pool |       2    |     253    |  245902 K  |  245902 K  |
|       from small pool |       0    |    7516    |  113334 K  |  113334 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     119    |     119    |      96    |
|       from large pool |      11    |      98    |      98    |      87    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3587    |  226631 K  |  226631 K  |
|       from large pool |       3    |     100    |  173218 K  |  173218 K  |
|       from small pool |       0    |    3577    |   53413 K  |   53413 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2166 MiB |   2624 TiB |   2624 TiB |
|       from large pool |  16640 KiB |   2148 MiB |   2589 TiB |   2589 TiB |
|       from small pool |      0 KiB |     37 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2166 MiB |   2624 TiB |   2624 TiB |
|       from large pool |  16640 KiB |   2148 MiB |   2589 TiB |   2589 TiB |
|       from small pool |      0 KiB |     37 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2164 MiB |   2624 TiB |   2624 TiB |
|       from large pool |  16640 KiB |   2147 MiB |   2589 TiB |   2589 TiB |
|       from small pool |      0 KiB |     36 MiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   2410 MiB |   2410 MiB |   2160 MiB |
|       from large pool | 231424 KiB |   2368 MiB |   2368 MiB |   2142 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 244602 KiB |   1429 TiB |   1429 TiB |
|       from large pool |  30464 KiB | 244060 KiB |   1394 TiB |   1394 TiB |
|       from small pool |      0 KiB |  18293 KiB |     34 TiB |     34 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7593    |  359236 K  |  359236 K  |
|       from large pool |       2    |     253    |  245902 K  |  245902 K  |
|       from small pool |       0    |    7516    |  113334 K  |  113334 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7593    |  359236 K  |  359236 K  |
|       from large pool |       2    |     253    |  245902 K  |  245902 K  |
|       from small pool |       0    |    7516    |  113334 K  |  113334 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     119    |     119    |      96    |
|       from large pool |      11    |      98    |      98    |      87    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3587    |  226631 K  |  226631 K  |
|       from large pool |       3    |     100    |  173218 K  |  173218 K  |
|       from small pool |       0    |    3577    |   53413 K  |   53413 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225

 Experiment start at: 2024-06-26 14:39:24.494112
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9244792, 'precision': 0.9304553, 'recall': 0.8668152, 'specificity': 0.8668152, 'f1': 0.89272594, 'auroc': 0.96356356, 'binary_precision': 0.94049066, 'binary_recall': 0.74975723, 'binary_specificity': 0.98387325, 'binary_f1_score': 0.83436245}
confusion matrix:
       0      1
0  41730    684
1   3608  10810
---- Validation: 
scalar performance:
{'acc': 0.9566169, 'precision': 0.68683463, 'recall': 0.6871019, 'specificity': 0.6871019, 'f1': 0.68696815, 'auroc': 0.862326, 'binary_precision': 0.39614242, 'binary_recall': 0.39673105, 'binary_specificity': 0.9774727, 'binary_f1_score': 0.39643648}
confusion matrix:
       0    1
0  17660  407
1    406  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7481759, 'recall': 0.7012063, 'specificity': 0.7012063, 'f1': 0.7219011, 'auroc': 0.89774716, 'binary_precision': 0.5215311, 'binary_recall': 0.41923076, 'binary_specificity': 0.98318195, 'binary_f1_score': 0.46481875}
confusion matrix:
      0    1
0  5846  100
1   151  109
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-26 15:28:43.821899,epoch time: 0:49:19.327787,used: 0:49:19.327787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94168776, 'precision': 0.9446101, 'recall': 0.8992725, 'specificity': 0.8992725, 'f1': 0.91902053, 'auroc': 0.977427, 'binary_precision': 0.94977725, 'binary_recall': 0.81316316, 'binary_specificity': 0.98538184, 'binary_f1_score': 0.8761769}
confusion matrix:
       0      1
0  41793    620
1   2694  11725
---- Validation: 
scalar performance:
{'acc': 0.9592316, 'precision': 0.7104938, 'recall': 0.7356656, 'specificity': 0.7356656, 'f1': 0.7222707, 'auroc': 0.87925386, 'binary_precision': 0.43989432, 'binary_recall': 0.4947994, 'binary_specificity': 0.9765318, 'binary_f1_score': 0.46573427}
confusion matrix:
       0    1
0  17643  424
1    340  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.7705884, 'recall': 0.77853894, 'specificity': 0.77853894, 'f1': 0.7744982, 'auroc': 0.91202426, 'binary_precision': 0.5597015, 'binary_recall': 0.5769231, 'binary_specificity': 0.98015475, 'binary_f1_score': 0.5681818}
confusion matrix:
      0    1
0  5828  118
1   110  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-26 16:10:10.879810,epoch time: 0:41:27.057911,used: 1:30:46.385698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94942987, 'precision': 0.9495932, 'recall': 0.9150618, 'specificity': 0.9150618, 'f1': 0.9306403, 'auroc': 0.9818219, 'binary_precision': 0.9498909, 'binary_recall': 0.84528434, 'binary_specificity': 0.9848392, 'binary_f1_score': 0.89453983}
confusion matrix:
       0      1
0  41769    643
1   2231  12189
---- Validation: 
scalar performance:
{'acc': 0.956777, 'precision': 0.7001837, 'recall': 0.74726737, 'specificity': 0.74726737, 'f1': 0.7208828, 'auroc': 0.8832828, 'binary_precision': 0.4183552, 'binary_recall': 0.5215453, 'binary_specificity': 0.97298944, 'binary_f1_score': 0.46428567}
confusion matrix:
       0    1
0  17579  488
1    322  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.75387573, 'recall': 0.8120501, 'specificity': 0.8120501, 'f1': 0.77952397, 'auroc': 0.9135883, 'binary_precision': 0.5232198, 'binary_recall': 0.65, 'binary_specificity': 0.97410023, 'binary_f1_score': 0.57975984}
confusion matrix:
      0    1
0  5792  154
1    91  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_3.png
early stop counter: 1
val acc:0.9567769765853882, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 3,now: 2024-06-26 16:47:36.966131,epoch time: 0:37:26.086321,used: 2:08:12.472019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95324814, 'precision': 0.9501851, 'recall': 0.924687, 'specificity': 0.924687, 'f1': 0.9365094, 'auroc': 0.98376596, 'binary_precision': 0.9444528, 'binary_recall': 0.8667036, 'binary_specificity': 0.9826704, 'binary_f1_score': 0.9039094}
confusion matrix:
       0      1
0  41678    735
1   1922  12497
---- Validation: 
scalar performance:
{'acc': 0.95117396, 'precision': 0.680164, 'recall': 0.7593821, 'specificity': 0.7593821, 'f1': 0.71145964, 'auroc': 0.8864256, 'binary_precision': 0.37728193, 'binary_recall': 0.55274886, 'binary_specificity': 0.9660154, 'binary_f1_score': 0.44846287}
confusion matrix:
       0    1
0  17453  614
1    301  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535933, 'precision': 0.72490656, 'recall': 0.82682407, 'specificity': 0.82682407, 'f1': 0.7648511, 'auroc': 0.9145012, 'binary_precision': 0.46373057, 'binary_recall': 0.68846154, 'binary_specificity': 0.96518666, 'binary_f1_score': 0.55417955}
confusion matrix:
      0    1
0  5739  207
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_4.png
early stop counter: 2
val acc:0.9511739611625671, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 4,now: 2024-06-26 17:25:56.697274,epoch time: 0:38:19.731143,used: 2:46:32.203162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95377606, 'precision': 0.9550848, 'recall': 0.92144734, 'specificity': 0.92144734, 'f1': 0.9366886, 'auroc': 0.9853729, 'binary_precision': 0.95747983, 'binary_recall': 0.85581523, 'binary_specificity': 0.98707944, 'binary_f1_score': 0.9037975}
confusion matrix:
       0      1
0  41865    548
1   2079  12340
---- Validation: 
scalar performance:
{'acc': 0.955603, 'precision': 0.6950952, 'recall': 0.7480891, 'specificity': 0.7480891, 'f1': 0.7179447, 'auroc': 0.8855092, 'binary_precision': 0.4080925, 'binary_recall': 0.52451706, 'binary_specificity': 0.97166103, 'binary_f1_score': 0.4590377}
confusion matrix:
       0    1
0  17555  512
1    320  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.7547498, 'recall': 0.8250071, 'specificity': 0.8250071, 'f1': 0.7849771, 'auroc': 0.91338325, 'binary_precision': 0.52380955, 'binary_recall': 0.6769231, 'binary_specificity': 0.9730911, 'binary_f1_score': 0.59060407}
confusion matrix:
      0    1
0  5786  160
1    84  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_5.png
early stop counter: 3
val acc:0.9556030035018921, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 5,now: 2024-06-26 18:02:08.535741,epoch time: 0:36:11.838467,used: 3:22:44.041629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9556412, 'precision': 0.9564338, 'recall': 0.92509556, 'specificity': 0.92509556, 'f1': 0.9393978, 'auroc': 0.98612833, 'binary_precision': 0.9578939, 'binary_recall': 0.86308783, 'binary_specificity': 0.98710334, 'binary_f1_score': 0.90802294}
confusion matrix:
       0      1
0  41867    547
1   1974  12444
---- Validation: 
scalar performance:
{'acc': 0.95400214, 'precision': 0.6888164, 'recall': 0.75011986, 'specificity': 0.75011986, 'f1': 0.7145186, 'auroc': 0.8887794, 'binary_precision': 0.39534885, 'binary_recall': 0.5304606, 'binary_specificity': 0.96977913, 'binary_f1_score': 0.4530457}
confusion matrix:
       0    1
0  17521  546
1    316  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.74655867, 'recall': 0.8277601, 'specificity': 0.8277601, 'f1': 0.7805215, 'auroc': 0.91369957, 'binary_precision': 0.5071225, 'binary_recall': 0.6846154, 'binary_specificity': 0.9709048, 'binary_f1_score': 0.58265144}
confusion matrix:
      0    1
0  5773  173
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_6.png
early stop counter: 4
val acc:0.9540021419525146, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 6,now: 2024-06-26 18:40:38.783009,epoch time: 0:38:30.247268,used: 4:01:14.288897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95900196, 'precision': 0.95763177, 'recall': 0.9328717, 'specificity': 0.9328717, 'f1': 0.9443955, 'auroc': 0.98749506, 'binary_precision': 0.9550587, 'binary_recall': 0.8798197, 'binary_specificity': 0.98592377, 'binary_f1_score': 0.9158966}
confusion matrix:
       0      1
0  41815    597
1   1733  12687
---- Validation: 
scalar performance:
{'acc': 0.95202774, 'precision': 0.6835768, 'recall': 0.76125544, 'specificity': 0.76125544, 'f1': 0.71453524, 'auroc': 0.89038646, 'binary_precision': 0.38398358, 'binary_recall': 0.5557206, 'binary_specificity': 0.96679026, 'binary_f1_score': 0.45415908}
confusion matrix:
       0    1
0  17467  600
1    299  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548824, 'precision': 0.72997636, 'recall': 0.8293358, 'specificity': 0.8293358, 'f1': 0.76935744, 'auroc': 0.91344047, 'binary_precision': 0.47368422, 'binary_recall': 0.6923077, 'binary_specificity': 0.96636397, 'binary_f1_score': 0.56250006}
confusion matrix:
      0    1
0  5746  200
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_7.png
early stop counter: 5
val acc:0.9520277380943298, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 7,now: 2024-06-26 19:19:44.775310,epoch time: 0:39:05.992301,used: 4:40:20.281198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9605856, 'precision': 0.95755196, 'recall': 0.9372053, 'specificity': 0.9372053, 'f1': 0.94679755, 'auroc': 0.9880297, 'binary_precision': 0.95178044, 'binary_recall': 0.8897365, 'binary_specificity': 0.98467416, 'binary_f1_score': 0.91971326}
confusion matrix:
       0      1
0  41762    650
1   1590  12830
---- Validation: 
scalar performance:
{'acc': 0.9495731, 'precision': 0.67840207, 'recall': 0.7764336, 'specificity': 0.7764336, 'f1': 0.715072, 'auroc': 0.8933903, 'binary_precision': 0.37242025, 'binary_recall': 0.58989596, 'binary_specificity': 0.96297115, 'binary_f1_score': 0.45658424}
confusion matrix:
       0    1
0  17398  669
1    276  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9500483, 'precision': 0.7128428, 'recall': 0.8286521, 'specificity': 0.8286521, 'f1': 0.7561425, 'auroc': 0.91410196, 'binary_precision': 0.4393204, 'binary_recall': 0.6961538, 'binary_specificity': 0.96115035, 'binary_f1_score': 0.53869045}
confusion matrix:
      0    1
0  5715  231
1    79  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_8.png
early stop counter: 6
val acc:0.9495730996131897, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 8,now: 2024-06-26 19:58:50.638423,epoch time: 0:39:05.863113,used: 5:19:26.144311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.958914, 'precision': 0.9602699, 'recall': 0.93015814, 'specificity': 0.93015814, 'f1': 0.94396377, 'auroc': 0.9883343, 'binary_precision': 0.96277857, 'binary_recall': 0.8717753, 'binary_specificity': 0.988541, 'binary_f1_score': 0.9150198}
confusion matrix:
       0      1
0  41926    486
1   1849  12571
---- Validation: 
scalar performance:
{'acc': 0.9535219, 'precision': 0.6881555, 'recall': 0.7563082, 'specificity': 0.7563082, 'f1': 0.7161832, 'auroc': 0.8922696, 'binary_precision': 0.3935484, 'binary_recall': 0.54383355, 'binary_specificity': 0.96878284, 'binary_f1_score': 0.4566438}
confusion matrix:
       0    1
0  17503  564
1    307  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7451908, 'recall': 0.82943094, 'specificity': 0.82943094, 'f1': 0.78016436, 'auroc': 0.91234004, 'binary_precision': 0.5042254, 'binary_recall': 0.68846154, 'binary_specificity': 0.9704003, 'binary_f1_score': 0.58211386}
confusion matrix:
      0    1
0  5770  176
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_9.png
early stop counter: 7
val acc:0.9535219073295593, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 9,now: 2024-06-26 20:36:01.377642,epoch time: 0:37:10.739219,used: 5:56:36.883530,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96076155, 'precision': 0.9596812, 'recall': 0.93558013, 'specificity': 0.93558013, 'f1': 0.9468236, 'auroc': 0.98861337, 'binary_precision': 0.9576481, 'binary_recall': 0.884458, 'binary_specificity': 0.9867022, 'binary_f1_score': 0.91959906}
confusion matrix:
       0      1
0  41849    564
1   1666  12753
---- Validation: 
scalar performance:
{'acc': 0.95176095, 'precision': 0.6843323, 'recall': 0.7697003, 'specificity': 0.7697003, 'f1': 0.717686, 'auroc': 0.89327216, 'binary_precision': 0.38484547, 'binary_recall': 0.57355124, 'binary_specificity': 0.96584934, 'binary_f1_score': 0.46062052}
confusion matrix:
       0    1
0  17450  617
1    287  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548824, 'precision': 0.73028046, 'recall': 0.8330138, 'specificity': 0.8330138, 'f1': 0.770712, 'auroc': 0.9115547, 'binary_precision': 0.47395834, 'binary_recall': 0.7, 'binary_specificity': 0.96602756, 'binary_f1_score': 0.56521744}
confusion matrix:
      0    1
0  5744  202
1    78  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_10.png
early stop counter: 8
val acc:0.9517609477043152, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 10,now: 2024-06-26 21:13:18.018696,epoch time: 0:37:16.641054,used: 6:33:53.524584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9613598, 'precision': 0.961501, 'recall': 0.93542767, 'specificity': 0.93542767, 'f1': 0.9475266, 'auroc': 0.98915946, 'binary_precision': 0.96176517, 'binary_recall': 0.8827854, 'binary_specificity': 0.98806995, 'binary_f1_score': 0.9205844}
confusion matrix:
       0      1
0  41908    506
1   1690  12728
---- Validation: 
scalar performance:
{'acc': 0.95325506, 'precision': 0.68823105, 'recall': 0.76189196, 'specificity': 0.76189196, 'f1': 0.71808004, 'auroc': 0.89382255, 'binary_precision': 0.39327025, 'binary_recall': 0.5557206, 'binary_specificity': 0.9680633, 'binary_f1_score': 0.4605911}
confusion matrix:
       0    1
0  17490  577
1    299  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.74583715, 'recall': 0.827676, 'specificity': 0.827676, 'f1': 0.78000224, 'auroc': 0.91060454, 'binary_precision': 0.5056818, 'binary_recall': 0.6846154, 'binary_specificity': 0.9707366, 'binary_f1_score': 0.5816994}
confusion matrix:
      0    1
0  5772  174
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_11.png
early stop counter: 9
val acc:0.9532550573348999, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 11,now: 2024-06-26 21:51:59.880819,epoch time: 0:38:41.862123,used: 7:12:35.386707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96359444, 'precision': 0.96160495, 'recall': 0.9412809, 'specificity': 0.9412809, 'f1': 0.9508697, 'auroc': 0.9896189, 'binary_precision': 0.9578175, 'binary_recall': 0.8959778, 'binary_specificity': 0.986584, 'binary_f1_score': 0.9258662}
confusion matrix:
       0      1
0  41843    569
1   1500  12920
---- Validation: 
scalar performance:
{'acc': 0.94978654, 'precision': 0.67881185, 'recall': 0.7751137, 'specificity': 0.7751137, 'f1': 0.71503055, 'auroc': 0.89478517, 'binary_precision': 0.37334594, 'binary_recall': 0.5869242, 'binary_specificity': 0.96330327, 'binary_f1_score': 0.45638356}
confusion matrix:
       0    1
0  17404  663
1    278  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95278764, 'precision': 0.7226934, 'recall': 0.8337596, 'specificity': 0.8337596, 'f1': 0.7652285, 'auroc': 0.91063416, 'binary_precision': 0.45864663, 'binary_recall': 0.70384616, 'binary_specificity': 0.96367306, 'binary_f1_score': 0.55538696}
confusion matrix:
      0    1
0  5730  216
1    77  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_12.png
early stop counter: 10
val acc:0.9497865438461304, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 12,now: 2024-06-26 22:28:20.981361,epoch time: 0:36:21.100542,used: 7:48:56.487249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96350646, 'precision': 0.9628819, 'recall': 0.9397994, 'specificity': 0.9397994, 'f1': 0.9506061, 'auroc': 0.9900657, 'binary_precision': 0.96170247, 'binary_recall': 0.8916707, 'binary_specificity': 0.9879282, 'binary_f1_score': 0.9253634}
confusion matrix:
       0      1
0  41901    512
1   1562  12857
---- Validation: 
scalar performance:
{'acc': 0.9536286, 'precision': 0.689279, 'recall': 0.7599399, 'specificity': 0.7599399, 'f1': 0.7181782, 'auroc': 0.89474654, 'binary_precision': 0.3955224, 'binary_recall': 0.551263, 'binary_specificity': 0.96861684, 'binary_f1_score': 0.46058348}
confusion matrix:
       0    1
0  17500  567
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7451908, 'recall': 0.82943094, 'specificity': 0.82943094, 'f1': 0.78016436, 'auroc': 0.9103599, 'binary_precision': 0.5042254, 'binary_recall': 0.68846154, 'binary_specificity': 0.9704003, 'binary_f1_score': 0.58211386}
confusion matrix:
      0    1
0  5770  176
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_13.png
early stop counter: 11
val acc:0.9536285996437073, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 13,now: 2024-06-26 23:03:54.475529,epoch time: 0:35:33.494168,used: 8:24:29.981417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96405196, 'precision': 0.9610859, 'recall': 0.9430259, 'specificity': 0.9430259, 'f1': 0.9516015, 'auroc': 0.9898273, 'binary_precision': 0.95540184, 'binary_recall': 0.90033984, 'binary_specificity': 0.98571193, 'binary_f1_score': 0.9270539}
confusion matrix:
       0      1
0  41807    606
1   1437  12982
---- Validation: 
scalar performance:
{'acc': 0.948666, 'precision': 0.67621917, 'recall': 0.77953947, 'specificity': 0.77953947, 'f1': 0.714165, 'auroc': 0.89536273, 'binary_precision': 0.36779505, 'binary_recall': 0.5973254, 'binary_specificity': 0.9617535, 'binary_f1_score': 0.45526612}
confusion matrix:
       0    1
0  17376  691
1    271  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9494038, 'precision': 0.71190846, 'recall': 0.8375107, 'specificity': 0.8375107, 'f1': 0.75774795, 'auroc': 0.90902543, 'binary_precision': 0.43661973, 'binary_recall': 0.7153846, 'binary_specificity': 0.95963675, 'binary_f1_score': 0.542274}
confusion matrix:
      0    1
0  5706  240
1    74  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_14.png
early stop counter: 12
val acc:0.948665976524353, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 14,now: 2024-06-26 23:39:21.966211,epoch time: 0:35:27.490682,used: 8:59:57.472099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9646854, 'precision': 0.96318066, 'recall': 0.94264925, 'specificity': 0.94264925, 'f1': 0.95233274, 'auroc': 0.99019486, 'binary_precision': 0.96031743, 'binary_recall': 0.8979125, 'binary_specificity': 0.9873859, 'binary_f1_score': 0.92806715}
confusion matrix:
       0      1
0  41878    535
1   1472  12947
---- Validation: 
scalar performance:
{'acc': 0.94845253, 'precision': 0.67569584, 'recall': 0.780144, 'specificity': 0.780144, 'f1': 0.7139002, 'auroc': 0.89663976, 'binary_precision': 0.36669698, 'binary_recall': 0.59881127, 'binary_specificity': 0.96147674, 'binary_f1_score': 0.45485327}
confusion matrix:
       0    1
0  17371  696
1    270  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94908154, 'precision': 0.7108861, 'recall': 0.8373425, 'specificity': 0.8373425, 'f1': 0.7568722, 'auroc': 0.9095921, 'binary_precision': 0.43457943, 'binary_recall': 0.7153846, 'binary_specificity': 0.9593004, 'binary_f1_score': 0.54069763}
confusion matrix:
      0    1
0  5704  242
1    74  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_15.png
early stop counter: 13
val acc:0.9484525322914124, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 15,now: 2024-06-27 00:14:53.179948,epoch time: 0:35:31.213737,used: 9:35:28.685836,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96519566, 'precision': 0.963292, 'recall': 0.9439099, 'specificity': 0.9439099, 'f1': 0.9530815, 'auroc': 0.9902828, 'binary_precision': 0.95965713, 'binary_recall': 0.9006935, 'binary_specificity': 0.9871263, 'binary_f1_score': 0.9292409}
confusion matrix:
       0      1
0  41866    546
1   1432  12988
---- Validation: 
scalar performance:
{'acc': 0.950587, 'precision': 0.6815032, 'recall': 0.77552885, 'specificity': 0.77552885, 'f1': 0.7172405, 'auroc': 0.8962176, 'binary_precision': 0.37871525, 'binary_recall': 0.5869242, 'binary_specificity': 0.9641335, 'binary_f1_score': 0.46037292}
confusion matrix:
       0    1
0  17419  648
1    278  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95343214, 'precision': 0.7251965, 'recall': 0.835935, 'specificity': 0.835935, 'f1': 0.76776826, 'auroc': 0.9082258, 'binary_precision': 0.46347606, 'binary_recall': 0.7076923, 'binary_specificity': 0.9641776, 'binary_f1_score': 0.56012183}
confusion matrix:
      0    1
0  5733  213
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_16.png
early stop counter: 14
val acc:0.9505869746208191, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 16,now: 2024-06-27 00:50:22.222291,epoch time: 0:35:29.042343,used: 10:10:57.728179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9630666, 'precision': 0.96375644, 'recall': 0.9378149, 'specificity': 0.9378149, 'f1': 0.94986284, 'auroc': 0.9901935, 'binary_precision': 0.9650487, 'binary_recall': 0.8865465, 'binary_specificity': 0.9890833, 'binary_f1_score': 0.9241335}
confusion matrix:
       0      1
0  41949    463
1   1636  12784
---- Validation: 
scalar performance:
{'acc': 0.95581645, 'precision': 0.6963072, 'recall': 0.7496303, 'specificity': 0.7496303, 'f1': 0.7193006, 'auroc': 0.8953914, 'binary_precision': 0.41040462, 'binary_recall': 0.5274888, 'binary_specificity': 0.9717717, 'binary_f1_score': 0.46163845}
confusion matrix:
       0    1
0  17557  510
1    318  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.7627958, 'recall': 0.825848, 'specificity': 0.825848, 'f1': 0.79044783, 'auroc': 0.9074277, 'binary_precision': 0.5398773, 'binary_recall': 0.6769231, 'binary_specificity': 0.97477293, 'binary_f1_score': 0.60068256}
confusion matrix:
      0    1
0  5796  150
1    84  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_17.png
early stop counter: 15
val acc:0.9558164477348328, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 17,now: 2024-06-27 01:25:54.294973,epoch time: 0:35:32.072682,used: 10:46:29.800861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9650725, 'precision': 0.9645668, 'recall': 0.9423364, 'specificity': 0.9423364, 'f1': 0.95277286, 'auroc': 0.9912629, 'binary_precision': 0.9636092, 'binary_recall': 0.89617866, 'binary_specificity': 0.9884941, 'binary_f1_score': 0.92867154}
confusion matrix:
       0      1
0  41925    488
1   1497  12922
---- Validation: 
scalar performance:
{'acc': 0.95357525, 'precision': 0.69083434, 'recall': 0.7692107, 'specificity': 0.7692107, 'f1': 0.72229564, 'auroc': 0.8964982, 'binary_precision': 0.39792746, 'binary_recall': 0.57057947, 'binary_specificity': 0.9678419, 'binary_f1_score': 0.46886447}
confusion matrix:
       0    1
0  17486  581
1    289  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.747402, 'recall': 0.83152217, 'specificity': 0.83152217, 'f1': 0.7823951, 'auroc': 0.9069612, 'binary_precision': 0.5084746, 'binary_recall': 0.6923077, 'binary_specificity': 0.9707366, 'binary_f1_score': 0.58631927}
confusion matrix:
      0    1
0  5772  174
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_18.png
early stop counter: 16
val acc:0.9535752534866333, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 18,now: 2024-06-27 02:01:25.317113,epoch time: 0:35:31.022140,used: 11:22:00.823001,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9669728, 'precision': 0.96377677, 'recall': 0.94821, 'specificity': 0.94821, 'f1': 0.95565736, 'auroc': 0.99128854, 'binary_precision': 0.95760363, 'binary_recall': 0.9101186, 'binary_specificity': 0.98630136, 'binary_f1_score': 0.93325746}
confusion matrix:
       0      1
0  41832    581
1   1296  13123
---- Validation: 
scalar performance:
{'acc': 0.9511206, 'precision': 0.6831993, 'recall': 0.77509034, 'specificity': 0.77509034, 'f1': 0.7184188, 'auroc': 0.89668226, 'binary_precision': 0.38215324, 'binary_recall': 0.5854383, 'binary_specificity': 0.96474236, 'binary_f1_score': 0.46244133}
confusion matrix:
       0    1
0  17430  637
1    279  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.954399, 'precision': 0.7282792, 'recall': 0.8309225, 'specificity': 0.8309225, 'f1': 0.768595, 'auroc': 0.9069583, 'binary_precision': 0.47012988, 'binary_recall': 0.6961538, 'binary_specificity': 0.9656912, 'binary_f1_score': 0.56124026}
confusion matrix:
      0    1
0  5742  204
1    79  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_19.png
early stop counter: 17
val acc:0.9511206150054932, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 19,now: 2024-06-27 02:36:57.412843,epoch time: 0:35:32.095730,used: 11:57:32.918731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96693766, 'precision': 0.9643638, 'recall': 0.9475257, 'specificity': 0.9475257, 'f1': 0.9555528, 'auroc': 0.99151886, 'binary_precision': 0.95941097, 'binary_recall': 0.9081137, 'binary_specificity': 0.98693764, 'binary_f1_score': 0.93305784}
confusion matrix:
       0      1
0  41858    554
1   1325  13095
---- Validation: 
scalar performance:
{'acc': 0.9501601, 'precision': 0.6809235, 'recall': 0.7795991, 'specificity': 0.7795991, 'f1': 0.71792567, 'auroc': 0.89870083, 'binary_precision': 0.37723425, 'binary_recall': 0.5958395, 'binary_specificity': 0.9633586, 'binary_f1_score': 0.4619816}
confusion matrix:
       0    1
0  17405  662
1    272  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535933, 'precision': 0.7259554, 'recall': 0.837858, 'specificity': 0.837858, 'f1': 0.76890385, 'auroc': 0.90652084, 'binary_precision': 0.4648241, 'binary_recall': 0.71153843, 'binary_specificity': 0.9641776, 'binary_f1_score': 0.56231004}
confusion matrix:
      0    1
0  5733  213
1    75  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_20.png
early stop counter: 18
val acc:0.9501600861549377, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 20,now: 2024-06-27 03:12:40.568810,epoch time: 0:35:43.155967,used: 12:33:16.074698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9672016, 'precision': 0.96464443, 'recall': 0.94795126, 'specificity': 0.94795126, 'f1': 0.9559129, 'auroc': 0.9913626, 'binary_precision': 0.9597217, 'binary_recall': 0.9088702, 'binary_specificity': 0.9870323, 'binary_f1_score': 0.93360406}
confusion matrix:
       0      1
0  41863    550
1   1314  13105
---- Validation: 
scalar performance:
{'acc': 0.94925296, 'precision': 0.6785301, 'recall': 0.7819897, 'specificity': 0.7819897, 'f1': 0.7166707, 'auroc': 0.8992672, 'binary_precision': 0.37224266, 'binary_recall': 0.60178304, 'binary_specificity': 0.9621963, 'binary_f1_score': 0.4599659}
confusion matrix:
       0    1
0  17384  683
1    268  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9518208, 'precision': 0.7196925, 'recall': 0.836933, 'specificity': 0.836933, 'f1': 0.7638011, 'auroc': 0.9071044, 'binary_precision': 0.45232275, 'binary_recall': 0.71153843, 'binary_specificity': 0.9623276, 'binary_f1_score': 0.5530643}
confusion matrix:
      0    1
0  5722  224
1    75  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_21.png
early stop counter: 19
val acc:0.9492529630661011, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 21,now: 2024-06-27 03:48:23.728175,epoch time: 0:35:43.159365,used: 13:08:59.234063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96779984, 'precision': 0.96480614, 'recall': 0.9494078, 'specificity': 0.9494078, 'f1': 0.95677906, 'auroc': 0.9912745, 'binary_precision': 0.95901996, 'binary_recall': 0.9120666, 'binary_specificity': 0.98674905, 'binary_f1_score': 0.9349541}
confusion matrix:
       0      1
0  41850    562
1   1268  13152
---- Validation: 
scalar performance:
{'acc': 0.94935966, 'precision': 0.67872906, 'recall': 0.78132975, 'specificity': 0.78132975, 'f1': 0.71665466, 'auroc': 0.89909565, 'binary_precision': 0.37269372, 'binary_recall': 0.60029715, 'binary_specificity': 0.9623623, 'binary_f1_score': 0.45987475}
confusion matrix:
       0    1
0  17387  680
1    269  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95149857, 'precision': 0.7185897, 'recall': 0.8367648, 'specificity': 0.8367648, 'f1': 0.7628896, 'auroc': 0.9061502, 'binary_precision': 0.45012164, 'binary_recall': 0.71153843, 'binary_specificity': 0.96199125, 'binary_f1_score': 0.5514158}
confusion matrix:
      0    1
0  5720  226
1    75  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_22.png
early stop counter: 20
val acc:0.949359655380249, best validation acc: 0.9592316150665283, corresponding to test acc:                         0.9632613658905029 / 0.9632613658905029
after epoch: 22,now: 2024-06-27 04:24:19.562899,epoch time: 0:35:55.834724,used: 13:44:55.068787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_14_39_24_seed_1_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 22 with time: 13:44:55.068787 at 2024-06-27 04:24:19.562899
persisted model performance metric: 

scalar performance:
{'acc': 0.96326137, 'precision': 0.7705884, 'recall': 0.77853894, 'specificity': 0.77853894, 'f1': 0.7744982, 'auroc': 0.91202426, 'binary_precision': 0.5597015, 'binary_recall': 0.5769231, 'binary_specificity': 0.98015475, 'binary_f1_score': 0.5681818}
confusion matrix:
      0    1
0  5828  118
1   110  150
oracle model performance metric: 

scalar performance:
{'acc': 0.96326137, 'precision': 0.7705884, 'recall': 0.77853894, 'specificity': 0.77853894, 'f1': 0.7744982, 'auroc': 0.91202426, 'binary_precision': 0.5597015, 'binary_recall': 0.5769231, 'binary_specificity': 0.98015475, 'binary_f1_score': 0.5681818}
confusion matrix:
      0    1
0  5828  118
1   110  150
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190511 KiB |   2166 MiB |   5362 TiB |   5362 TiB |
|       from large pool | 173046 KiB |   2148 MiB |   5292 TiB |   5292 TiB |
|       from small pool |  17465 KiB |     37 MiB |     70 TiB |     70 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190511 KiB |   2166 MiB |   5362 TiB |   5362 TiB |
|       from large pool | 173046 KiB |   2148 MiB |   5292 TiB |   5292 TiB |
|       from small pool |  17465 KiB |     37 MiB |     70 TiB |     70 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189280 KiB |   2164 MiB |   5362 TiB |   5362 TiB |
|       from large pool | 172814 KiB |   2147 MiB |   5292 TiB |   5292 TiB |
|       from small pool |  16466 KiB |     36 MiB |     70 TiB |     70 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2400 MiB |   2410 MiB |   4560 MiB |   2160 MiB |
|       from large pool |   2362 MiB |   2368 MiB |   4504 MiB |   2142 MiB |
|       from small pool |     38 MiB |     42 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  28624 KiB | 244602 KiB |   2929 TiB |   2929 TiB |
|       from large pool |  17418 KiB | 244060 KiB |   2858 TiB |   2858 TiB |
|       from small pool |  11206 KiB |  18293 KiB |     70 TiB |     70 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2942    |    7593    |  734134 K  |  734131 K  |
|       from large pool |      76    |     253    |  502548 K  |  502548 K  |
|       from small pool |    2866    |    7516    |  231586 K  |  231583 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2942    |    7593    |  734134 K  |  734131 K  |
|       from large pool |      76    |     253    |  502548 K  |  502548 K  |
|       from small pool |    2866    |    7516    |  231586 K  |  231583 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     117    |     119    |     213    |      96    |
|       from large pool |      98    |      98    |     185    |      87    |
|       from small pool |      19    |      21    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3587    |  454227 K  |  454227 K  |
|       from large pool |       9    |     101    |  345932 K  |  345932 K  |
|       from small pool |      24    |    3577    |  108295 K  |  108295 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2166 MiB |   5362 TiB |   5362 TiB |
|       from large pool |  16640 KiB |   2148 MiB |   5292 TiB |   5292 TiB |
|       from small pool |      0 KiB |     37 MiB |     70 TiB |     70 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2166 MiB |   5362 TiB |   5362 TiB |
|       from large pool |  16640 KiB |   2148 MiB |   5292 TiB |   5292 TiB |
|       from small pool |      0 KiB |     37 MiB |     70 TiB |     70 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2164 MiB |   5362 TiB |   5362 TiB |
|       from large pool |  16640 KiB |   2147 MiB |   5292 TiB |   5292 TiB |
|       from small pool |      0 KiB |     36 MiB |     70 TiB |     70 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 219136 KiB |   2410 MiB |   4560 MiB |   4346 MiB |
|       from large pool | 190464 KiB |   2368 MiB |   4504 MiB |   4318 MiB |
|       from small pool |  28672 KiB |     42 MiB |     56 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 244602 KiB |   2929 TiB |   2929 TiB |
|       from large pool |  30464 KiB | 244060 KiB |   2858 TiB |   2858 TiB |
|       from small pool |      0 KiB |  20353 KiB |     70 TiB |     70 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7593    |  734134 K  |  734134 K  |
|       from large pool |       2    |     253    |  502548 K  |  502548 K  |
|       from small pool |       0    |    7516    |  231586 K  |  231586 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7593    |  734134 K  |  734134 K  |
|       from large pool |       2    |     253    |  502548 K  |  502548 K  |
|       from small pool |       0    |    7516    |  231586 K  |  231586 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     119    |     213    |     190    |
|       from large pool |       9    |      98    |     185    |     176    |
|       from small pool |      14    |      21    |      28    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3587    |  454229 K  |  454229 K  |
|       from large pool |       3    |     101    |  345932 K  |  345932 K  |
|       from small pool |       0    |    3577    |  108296 K  |  108296 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2166 MiB |   5362 TiB |   5362 TiB |
|       from large pool |  16640 KiB |   2148 MiB |   5292 TiB |   5292 TiB |
|       from small pool |      0 KiB |     37 MiB |     70 TiB |     70 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2166 MiB |   5362 TiB |   5362 TiB |
|       from large pool |  16640 KiB |   2148 MiB |   5292 TiB |   5292 TiB |
|       from small pool |      0 KiB |     37 MiB |     70 TiB |     70 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2164 MiB |   5362 TiB |   5362 TiB |
|       from large pool |  16640 KiB |   2147 MiB |   5292 TiB |   5292 TiB |
|       from small pool |      0 KiB |     36 MiB |     70 TiB |     70 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 219136 KiB |   2410 MiB |   4560 MiB |   4346 MiB |
|       from large pool | 190464 KiB |   2368 MiB |   4504 MiB |   4318 MiB |
|       from small pool |  28672 KiB |     42 MiB |     56 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 244602 KiB |   2929 TiB |   2929 TiB |
|       from large pool |  30464 KiB | 244060 KiB |   2858 TiB |   2858 TiB |
|       from small pool |      0 KiB |  20353 KiB |     70 TiB |     70 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7593    |  734134 K  |  734134 K  |
|       from large pool |       2    |     253    |  502548 K  |  502548 K  |
|       from small pool |       0    |    7516    |  231586 K  |  231586 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7593    |  734134 K  |  734134 K  |
|       from large pool |       2    |     253    |  502548 K  |  502548 K  |
|       from small pool |       0    |    7516    |  231586 K  |  231586 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     119    |     213    |     190    |
|       from large pool |       9    |      98    |     185    |     176    |
|       from small pool |      14    |      21    |      28    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3587    |  454229 K  |  454229 K  |
|       from large pool |       3    |     101    |  345932 K  |  345932 K  |
|       from small pool |       0    |    3577    |  108296 K  |  108296 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225

 Experiment start at: 2024-06-27 04:31:03.716723
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9289171, 'precision': 0.92935264, 'recall': 0.88410544, 'specificity': 0.88410544, 'f1': 0.9035189, 'auroc': 0.965057, 'binary_precision': 0.9301402, 'binary_recall': 0.78941107, 'binary_specificity': 0.9787998, 'binary_f1_score': 0.8540169}
confusion matrix:
       0      1
0  41414    897
1   3186  11943
---- Validation: 
scalar performance:
{'acc': 0.9472647, 'precision': 0.64511365, 'recall': 0.73666257, 'specificity': 0.73666257, 'f1': 0.67800784, 'auroc': 0.86205316, 'binary_precision': 0.30677292, 'binary_recall': 0.5116279, 'binary_specificity': 0.9616972, 'binary_f1_score': 0.38356164}
confusion matrix:
       0    1
0  17475  696
1    294  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9277128, 'precision': 0.6218835, 'recall': 0.716538, 'specificity': 0.716538, 'f1': 0.65263647, 'auroc': 0.8527764, 'binary_precision': 0.26516855, 'binary_recall': 0.4876033, 'binary_specificity': 0.9454727, 'binary_f1_score': 0.34352258}
confusion matrix:
      0    1
0  5670  327
1   124  118
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-27 05:07:10.576839,epoch time: 0:36:06.860116,used: 0:36:06.860116,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94385445, 'precision': 0.9396076, 'recall': 0.9135066, 'specificity': 0.9135066, 'f1': 0.925496, 'auroc': 0.9765198, 'binary_precision': 0.9314344, 'binary_recall': 0.8493721, 'binary_specificity': 0.9776412, 'binary_f1_score': 0.88851243}
confusion matrix:
       0      1
0  41364    946
1   2279  12851
---- Validation: 
scalar performance:
{'acc': 0.9505673, 'precision': 0.66142416, 'recall': 0.7632631, 'specificity': 0.7632631, 'f1': 0.698173, 'auroc': 0.8794687, 'binary_precision': 0.3376494, 'binary_recall': 0.5631229, 'binary_specificity': 0.9634032, 'binary_f1_score': 0.42216685}
confusion matrix:
       0    1
0  17506  665
1    263  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9410162, 'precision': 0.6685719, 'recall': 0.7888886, 'specificity': 0.7888886, 'f1': 0.70979047, 'auroc': 0.8862427, 'binary_precision': 0.35280374, 'binary_recall': 0.62396693, 'binary_specificity': 0.9538102, 'binary_f1_score': 0.45074627}
confusion matrix:
      0    1
0  5720  277
1    91  151
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-27 05:43:05.645317,epoch time: 0:35:55.068478,used: 1:12:01.928594,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9489206, 'precision': 0.9488019, 'recall': 0.917875, 'specificity': 0.917875, 'f1': 0.93189734, 'auroc': 0.98080826, 'binary_precision': 0.94857645, 'binary_recall': 0.8522705, 'binary_specificity': 0.9834795, 'binary_f1_score': 0.89784837}
confusion matrix:
       0      1
0  41612    699
1   2235  12894
---- Validation: 
scalar performance:
{'acc': 0.95296437, 'precision': 0.66863966, 'recall': 0.7612891, 'specificity': 0.7612891, 'f1': 0.70344526, 'auroc': 0.88434124, 'binary_precision': 0.35226077, 'binary_recall': 0.5564784, 'binary_specificity': 0.96609986, 'binary_f1_score': 0.43142304}
confusion matrix:
       0    1
0  17555  616
1    267  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95031255, 'precision': 0.6985558, 'recall': 0.80760354, 'specificity': 0.80760354, 'f1': 0.73931825, 'auroc': 0.8955759, 'binary_precision': 0.41145834, 'binary_recall': 0.6528926, 'binary_specificity': 0.9623145, 'binary_f1_score': 0.50479233}
confusion matrix:
      0    1
0  5771  226
1    84  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-27 06:19:15.055958,epoch time: 0:36:09.410641,used: 1:48:11.339235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.952594, 'precision': 0.9506984, 'recall': 0.9256127, 'specificity': 0.9256127, 'f1': 0.93720543, 'auroc': 0.98287535, 'binary_precision': 0.94703084, 'binary_recall': 0.86859673, 'binary_specificity': 0.98262864, 'binary_f1_score': 0.90611964}
confusion matrix:
       0      1
0  41576    735
1   1988  13141
---- Validation: 
scalar performance:
{'acc': 0.95232517, 'precision': 0.66861665, 'recall': 0.7705955, 'specificity': 0.7705955, 'f1': 0.70593095, 'auroc': 0.8882403, 'binary_precision': 0.35157043, 'binary_recall': 0.57641196, 'binary_specificity': 0.964779, 'binary_f1_score': 0.43675268}
confusion matrix:
       0    1
0  17531  640
1    255  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95111394, 'precision': 0.7021726, 'recall': 0.81396866, 'specificity': 0.81396866, 'f1': 0.7439102, 'auroc': 0.9000609, 'binary_precision': 0.4181818, 'binary_recall': 0.6652893, 'binary_specificity': 0.962648, 'binary_f1_score': 0.5135566}
confusion matrix:
      0    1
0  5773  224
1    81  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_4.png
new oracle model saved
early stop counter: 1
val acc:0.952325165271759, best validation acc: 0.9529643654823303, corresponding to test acc:                         0.9503125548362732 / 0.9511139392852783
after epoch: 4,now: 2024-06-27 06:54:59.906540,epoch time: 0:35:44.850582,used: 2:23:56.189817,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9542653, 'precision': 0.9548646, 'recall': 0.92598283, 'specificity': 0.92598283, 'f1': 0.93918526, 'auroc': 0.985245, 'binary_precision': 0.9560111, 'binary_recall': 0.8662172, 'binary_specificity': 0.9857484, 'binary_f1_score': 0.90890175}
confusion matrix:
       0      1
0  41708    603
1   2024  13105
---- Validation: 
scalar performance:
{'acc': 0.95450914, 'precision': 0.67454123, 'recall': 0.7636932, 'specificity': 0.7636932, 'f1': 0.7086946, 'auroc': 0.8900621, 'binary_precision': 0.36393088, 'binary_recall': 0.5598007, 'binary_specificity': 0.96758574, 'binary_f1_score': 0.44109946}
confusion matrix:
       0    1
0  17582  589
1    265  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9588075, 'precision': 0.73186153, 'recall': 0.8159879, 'specificity': 0.8159879, 'f1': 0.7664989, 'auroc': 0.9024085, 'binary_precision': 0.47761193, 'binary_recall': 0.661157, 'binary_specificity': 0.97081876, 'binary_f1_score': 0.5545927}
confusion matrix:
      0    1
0  5822  175
1    82  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-27 07:31:09.602000,epoch time: 0:36:09.695460,used: 3:00:05.885277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95638925, 'precision': 0.95630366, 'recall': 0.93010366, 'specificity': 0.93010366, 'f1': 0.94218504, 'auroc': 0.9868895, 'binary_precision': 0.95613843, 'binary_recall': 0.87455386, 'binary_specificity': 0.9856535, 'binary_f1_score': 0.91352826}
confusion matrix:
       0      1
0  41703    607
1   1898  13232
---- Validation: 
scalar performance:
{'acc': 0.9557343, 'precision': 0.67799723, 'recall': 0.7587047, 'specificity': 0.7587047, 'f1': 0.70980394, 'auroc': 0.8929602, 'binary_precision': 0.3712036, 'binary_recall': 0.5481728, 'binary_specificity': 0.9692367, 'binary_f1_score': 0.44265592}
confusion matrix:
       0    1
0  17612  559
1    272  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.7367266, 'recall': 0.81260604, 'specificity': 0.81260604, 'f1': 0.76865834, 'auroc': 0.90407395, 'binary_precision': 0.48765433, 'binary_recall': 0.6528926, 'binary_specificity': 0.9723195, 'binary_f1_score': 0.5583039}
confusion matrix:
      0    1
0  5831  166
1    84  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-27 08:07:35.767416,epoch time: 0:36:26.165416,used: 3:36:32.050693,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9571727, 'precision': 0.9589707, 'recall': 0.9296377, 'specificity': 0.9296377, 'f1': 0.9430421, 'auroc': 0.9868511, 'binary_precision': 0.9624088, 'binary_recall': 0.87144744, 'binary_specificity': 0.98782796, 'binary_f1_score': 0.9146722}
confusion matrix:
       0      1
0  41795    515
1   1945  13185
---- Validation: 
scalar performance:
{'acc': 0.95882386, 'precision': 0.68599355, 'recall': 0.73540616, 'specificity': 0.73540616, 'f1': 0.70740485, 'auroc': 0.8910936, 'binary_precision': 0.38881665, 'binary_recall': 0.49667773, 'binary_specificity': 0.9741346, 'binary_f1_score': 0.436178}
confusion matrix:
       0    1
0  17701  470
1    303  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.7684996, 'recall': 0.8097427, 'specificity': 0.8097427, 'f1': 0.78745866, 'auroc': 0.90389067, 'binary_precision': 0.5516014, 'binary_recall': 0.6404959, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.5927342}
confusion matrix:
      0    1
0  5871  126
1    87  155
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-27 08:43:38.951159,epoch time: 0:36:03.183743,used: 4:12:35.234436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95943594, 'precision': 0.9576754, 'recall': 0.9366901, 'specificity': 0.9366901, 'f1': 0.94652736, 'auroc': 0.9880658, 'binary_precision': 0.9542196, 'binary_recall': 0.8886245, 'binary_specificity': 0.98475575, 'binary_f1_score': 0.92025465}
confusion matrix:
       0      1
0  41666    645
1   1685  13444
---- Validation: 
scalar performance:
{'acc': 0.95482874, 'precision': 0.6774248, 'recall': 0.77188873, 'specificity': 0.77188873, 'f1': 0.71325594, 'auroc': 0.8947798, 'binary_precision': 0.36914894, 'binary_recall': 0.57641196, 'binary_specificity': 0.96736556, 'binary_f1_score': 0.45006484}
confusion matrix:
       0    1
0  17578  593
1    255  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.7338568, 'recall': 0.8240856, 'specificity': 0.8240856, 'f1': 0.7705848, 'auroc': 0.90639806, 'binary_precision': 0.4809384, 'binary_recall': 0.677686, 'binary_specificity': 0.97048527, 'binary_f1_score': 0.56260717}
confusion matrix:
      0    1
0  5820  177
1    78  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_8.png
early stop counter: 1
val acc:0.9548287391662598, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 8,now: 2024-06-27 09:19:56.713695,epoch time: 0:36:17.762536,used: 4:48:52.996972,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95941854, 'precision': 0.96055925, 'recall': 0.9339008, 'specificity': 0.9339008, 'f1': 0.9461887, 'auroc': 0.98875463, 'binary_precision': 0.96275944, 'binary_recall': 0.8799736, 'binary_specificity': 0.98782796, 'binary_f1_score': 0.9195069}
confusion matrix:
       0      1
0  41795    515
1   1816  13314
---- Validation: 
scalar performance:
{'acc': 0.957865, 'precision': 0.6867587, 'recall': 0.7598054, 'specificity': 0.7598054, 'f1': 0.7164722, 'auroc': 0.89554065, 'binary_precision': 0.3886926, 'binary_recall': 0.5481728, 'binary_specificity': 0.971438, 'binary_f1_score': 0.45485875}
confusion matrix:
       0    1
0  17652  519
1    272  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.75039065, 'recall': 0.82195437, 'specificity': 0.82195437, 'f1': 0.7810712, 'auroc': 0.90619206, 'binary_precision': 0.51428574, 'binary_recall': 0.6694215, 'binary_specificity': 0.97448725, 'binary_f1_score': 0.5816876}
confusion matrix:
      0    1
0  5844  153
1    80  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_9.png
early stop counter: 2
val acc:0.9578649997711182, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 9,now: 2024-06-27 09:56:14.696592,epoch time: 0:36:17.982897,used: 5:25:10.979869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96107244, 'precision': 0.960434, 'recall': 0.93826807, 'specificity': 0.93826807, 'f1': 0.94862664, 'auroc': 0.98922575, 'binary_precision': 0.9591851, 'binary_recall': 0.89007866, 'binary_specificity': 0.9864574, 'binary_f1_score': 0.9233407}
confusion matrix:
       0      1
0  41738    573
1   1663  13466
---- Validation: 
scalar performance:
{'acc': 0.95578754, 'precision': 0.6807116, 'recall': 0.77077794, 'specificity': 0.77077794, 'f1': 0.7154542, 'auroc': 0.8952809, 'binary_precision': 0.375817, 'binary_recall': 0.5730897, 'binary_specificity': 0.9684662, 'binary_f1_score': 0.45394737}
confusion matrix:
       0    1
0  17598  573
1    257  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.7372043, 'recall': 0.820537, 'specificity': 0.820537, 'f1': 0.7717293, 'auroc': 0.9057677, 'binary_precision': 0.48795182, 'binary_recall': 0.6694215, 'binary_specificity': 0.9716525, 'binary_f1_score': 0.5644599}
confusion matrix:
      0    1
0  5827  170
1    80  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_10.png
early stop counter: 3
val acc:0.9557875394821167, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 10,now: 2024-06-27 10:32:44.489344,epoch time: 0:36:29.792752,used: 6:01:40.772621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96260446, 'precision': 0.96093225, 'recall': 0.9417741, 'specificity': 0.9417741, 'f1': 0.9508105, 'auroc': 0.99017155, 'binary_precision': 0.9576283, 'binary_recall': 0.8977528, 'binary_specificity': 0.9857953, 'binary_f1_score': 0.92672443}
confusion matrix:
       0      1
0  41709    601
1   1547  13583
---- Validation: 
scalar performance:
{'acc': 0.955681, 'precision': 0.68127036, 'recall': 0.7755412, 'specificity': 0.7755412, 'f1': 0.71726185, 'auroc': 0.8967373, 'binary_precision': 0.37660944, 'binary_recall': 0.58305645, 'binary_specificity': 0.968026, 'binary_f1_score': 0.45762712}
confusion matrix:
       0    1
0  17590  581
1    251  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597692, 'precision': 0.7365932, 'recall': 0.82243633, 'specificity': 0.82243633, 'f1': 0.77195036, 'auroc': 0.9063409, 'binary_precision': 0.48656717, 'binary_recall': 0.6735537, 'binary_specificity': 0.971319, 'binary_f1_score': 0.5649913}
confusion matrix:
      0    1
0  5825  172
1    79  163
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_11.png
early stop counter: 4
val acc:0.9556810259819031, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 11,now: 2024-06-27 11:09:29.816281,epoch time: 0:36:45.326937,used: 6:38:26.099558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96095055, 'precision': 0.9620789, 'recall': 0.93640554, 'specificity': 0.93640554, 'f1': 0.94827926, 'auroc': 0.9895011, 'binary_precision': 0.96426255, 'binary_recall': 0.88453406, 'binary_specificity': 0.988277, 'binary_f1_score': 0.9226791}
confusion matrix:
       0      1
0  41814    496
1   1747  13383
---- Validation: 
scalar performance:
{'acc': 0.9582912, 'precision': 0.6881431, 'recall': 0.7576164, 'specificity': 0.7576164, 'f1': 0.7167153, 'auroc': 0.89671457, 'binary_precision': 0.39161676, 'binary_recall': 0.54318935, 'binary_specificity': 0.9720434, 'binary_f1_score': 0.4551148}
confusion matrix:
       0    1
0  17663  508
1    275  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.75713074, 'recall': 0.81667316, 'specificity': 0.81667316, 'f1': 0.78339165, 'auroc': 0.9057154, 'binary_precision': 0.5282392, 'binary_recall': 0.6570248, 'binary_specificity': 0.9763215, 'binary_f1_score': 0.58563536}
confusion matrix:
      0    1
0  5855  142
1    83  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_12.png
early stop counter: 5
val acc:0.9582911729812622, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 12,now: 2024-06-27 11:45:17.192057,epoch time: 0:35:47.375776,used: 7:14:13.475334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96391016, 'precision': 0.9617522, 'recall': 0.94437695, 'specificity': 0.94437695, 'f1': 0.9526182, 'auroc': 0.98998404, 'binary_precision': 0.9574632, 'binary_recall': 0.9031, 'binary_specificity': 0.9856539, 'binary_f1_score': 0.9294874}
confusion matrix:
       0      1
0  41704    607
1   1466  13663
---- Validation: 
scalar performance:
{'acc': 0.9573856, 'precision': 0.68782854, 'recall': 0.7756187, 'specificity': 0.7756187, 'f1': 0.7222364, 'auroc': 0.8976392, 'binary_precision': 0.389755, 'binary_recall': 0.5813953, 'binary_specificity': 0.9698421, 'binary_f1_score': 0.46666667}
confusion matrix:
       0    1
0  17623  548
1    252  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.748766, 'recall': 0.8217876, 'specificity': 0.8217876, 'f1': 0.779945, 'auroc': 0.90715194, 'binary_precision': 0.511041, 'binary_recall': 0.6694215, 'binary_specificity': 0.97415376, 'binary_f1_score': 0.5796064}
confusion matrix:
      0    1
0  5842  155
1    80  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_13.png
early stop counter: 6
val acc:0.9573855996131897, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 13,now: 2024-06-27 12:22:11.516671,epoch time: 0:36:54.324614,used: 7:51:07.799948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9643802, 'precision': 0.9632316, 'recall': 0.94414395, 'specificity': 0.94414395, 'f1': 0.9531526, 'auroc': 0.99036896, 'binary_precision': 0.96096116, 'binary_recall': 0.90138143, 'binary_specificity': 0.98690647, 'binary_f1_score': 0.9302183}
confusion matrix:
       0      1
0  41757    554
1   1492  13637
---- Validation: 
scalar performance:
{'acc': 0.9574389, 'precision': 0.68683183, 'recall': 0.7692218, 'specificity': 0.7692218, 'f1': 0.71953577, 'auroc': 0.8968798, 'binary_precision': 0.38819525, 'binary_recall': 0.5681063, 'binary_specificity': 0.97033733, 'binary_f1_score': 0.4612272}
confusion matrix:
       0    1
0  17632  539
1    260  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.7537025, 'recall': 0.82228786, 'specificity': 0.82228786, 'f1': 0.7833459, 'auroc': 0.90636504, 'binary_precision': 0.5209003, 'binary_recall': 0.6694215, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.5858951}
confusion matrix:
      0    1
0  5848  149
1    80  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_14.png
early stop counter: 7
val acc:0.9574388861656189, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 14,now: 2024-06-27 12:58:40.816802,epoch time: 0:36:29.300131,used: 8:27:37.100079,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96549445, 'precision': 0.96354306, 'recall': 0.94675034, 'specificity': 0.94675034, 'f1': 0.95473146, 'auroc': 0.99099267, 'binary_precision': 0.959656, 'binary_recall': 0.9071381, 'binary_specificity': 0.9863626, 'binary_f1_score': 0.9326583}
confusion matrix:
       0      1
0  41733    577
1   1405  13725
---- Validation: 
scalar performance:
{'acc': 0.95477545, 'precision': 0.6791876, 'recall': 0.78149784, 'specificity': 0.78149784, 'f1': 0.7173016, 'auroc': 0.8980167, 'binary_precision': 0.37202072, 'binary_recall': 0.59634554, 'binary_specificity': 0.9666501, 'binary_f1_score': 0.4582004}
confusion matrix:
       0    1
0  17565  606
1    243  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9588075, 'precision': 0.7328883, 'recall': 0.8298671, 'specificity': 0.8298671, 'f1': 0.7717618, 'auroc': 0.9051496, 'binary_precision': 0.47851002, 'binary_recall': 0.69008267, 'binary_specificity': 0.9696515, 'binary_f1_score': 0.5651438}
confusion matrix:
      0    1
0  5815  182
1    75  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_15.png
early stop counter: 8
val acc:0.9547754526138306, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 15,now: 2024-06-27 13:35:58.882260,epoch time: 0:37:18.065458,used: 9:04:55.165537,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9644325, 'precision': 0.9635097, 'recall': 0.9440127, 'specificity': 0.9440127, 'f1': 0.9532035, 'auroc': 0.99043703, 'binary_precision': 0.96168774, 'binary_recall': 0.90085924, 'binary_specificity': 0.98716617, 'binary_f1_score': 0.9302802}
confusion matrix:
       0      1
0  41767    543
1   1500  13630
---- Validation: 
scalar performance:
{'acc': 0.9560539, 'precision': 0.6810942, 'recall': 0.76770335, 'specificity': 0.76770335, 'f1': 0.7148315, 'auroc': 0.897659, 'binary_precision': 0.3767956, 'binary_recall': 0.5664452, 'binary_specificity': 0.96896154, 'binary_f1_score': 0.45255473}
confusion matrix:
       0    1
0  17607  564
1    261  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.7480672, 'recall': 0.82566977, 'specificity': 0.82566977, 'f1': 0.78087586, 'auroc': 0.90466034, 'binary_precision': 0.50931674, 'binary_recall': 0.677686, 'binary_specificity': 0.9736535, 'binary_f1_score': 0.5815603}
confusion matrix:
      0    1
0  5839  158
1    78  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_16.png
early stop counter: 9
val acc:0.9560539126396179, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 16,now: 2024-06-27 14:12:21.220372,epoch time: 0:36:22.338112,used: 9:41:17.503649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9642932, 'precision': 0.9637604, 'recall': 0.9434086, 'specificity': 0.9434086, 'f1': 0.95297796, 'auroc': 0.9908056, 'binary_precision': 0.9627114, 'binary_recall': 0.899273, 'binary_specificity': 0.9875443, 'binary_f1_score': 0.9299115}
confusion matrix:
       0      1
0  41783    527
1   1524  13606
---- Validation: 
scalar performance:
{'acc': 0.9562137, 'precision': 0.6836288, 'recall': 0.7774225, 'specificity': 0.7774225, 'f1': 0.71961, 'auroc': 0.8979511, 'binary_precision': 0.3812095, 'binary_recall': 0.58637875, 'binary_specificity': 0.9684662, 'binary_f1_score': 0.46204188}
confusion matrix:
       0    1
0  17598  573
1    249  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.74122894, 'recall': 0.8269021, 'specificity': 0.8269021, 'f1': 0.77666503, 'auroc': 0.9050758, 'binary_precision': 0.4954955, 'binary_recall': 0.6818182, 'binary_specificity': 0.971986, 'binary_f1_score': 0.57391304}
confusion matrix:
      0    1
0  5829  168
1    77  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_17.png
early stop counter: 10
val acc:0.9562137126922607, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 17,now: 2024-06-27 15:22:02.600439,epoch time: 1:09:41.380067,used: 10:50:58.883716,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9644673, 'precision': 0.96379626, 'recall': 0.94382083, 'specificity': 0.94382083, 'f1': 0.95322406, 'auroc': 0.9906796, 'binary_precision': 0.9624735, 'binary_recall': 0.90019166, 'binary_specificity': 0.98745006, 'binary_f1_score': 0.9302913}
confusion matrix:
       0      1
0  41780    531
1   1510  13619
---- Validation: 
scalar performance:
{'acc': 0.9575987, 'precision': 0.687801, 'recall': 0.7709105, 'specificity': 0.7709105, 'f1': 0.7207694, 'auroc': 0.8976625, 'binary_precision': 0.39002267, 'binary_recall': 0.5714286, 'binary_specificity': 0.9703924, 'binary_f1_score': 0.46361187}
confusion matrix:
       0    1
0  17633  538
1    258  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.7529092, 'recall': 0.82616997, 'specificity': 0.82616997, 'f1': 0.7842592, 'auroc': 0.90510404, 'binary_precision': 0.51898736, 'binary_recall': 0.677686, 'binary_specificity': 0.974654, 'binary_f1_score': 0.5878136}
confusion matrix:
      0    1
0  5845  152
1    78  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_18.png
early stop counter: 11
val acc:0.9575986862182617, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 18,now: 2024-06-27 17:07:50.423925,epoch time: 1:45:47.823486,used: 12:36:46.707202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9663649, 'precision': 0.96413124, 'recall': 0.94844234, 'specificity': 0.94844234, 'f1': 0.9559245, 'auroc': 0.99153686, 'binary_precision': 0.9596656, 'binary_recall': 0.91056913, 'binary_specificity': 0.9863156, 'binary_f1_score': 0.934473}
confusion matrix:
       0      1
0  41732    579
1   1353  13776
---- Validation: 
scalar performance:
{'acc': 0.95445585, 'precision': 0.6791531, 'recall': 0.78695405, 'specificity': 0.78695405, 'f1': 0.7187353, 'auroc': 0.8983111, 'binary_precision': 0.3715736, 'binary_recall': 0.6079734, 'binary_specificity': 0.96593475, 'binary_f1_score': 0.46124762}
confusion matrix:
       0    1
0  17552  619
1    236  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9567238, 'precision': 0.72447133, 'recall': 0.83076596, 'specificity': 0.83076596, 'f1': 0.76585644, 'auroc': 0.90482724, 'binary_precision': 0.46153846, 'binary_recall': 0.6942149, 'binary_specificity': 0.967317, 'binary_f1_score': 0.55445546}
confusion matrix:
      0    1
0  5801  196
1    74  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_19.png
early stop counter: 12
val acc:0.9544558525085449, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 19,now: 2024-06-27 18:03:15.743320,epoch time: 0:55:25.319395,used: 13:32:12.026597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96500695, 'precision': 0.96457803, 'recall': 0.94446325, 'specificity': 0.94446325, 'f1': 0.9539294, 'auroc': 0.9917407, 'binary_precision': 0.9637328, 'binary_recall': 0.901051, 'binary_specificity': 0.9878755, 'binary_f1_score': 0.9313384}
confusion matrix:
       0      1
0  41798    513
1   1497  13632
---- Validation: 
scalar performance:
{'acc': 0.9572791, 'precision': 0.6872438, 'recall': 0.7747606, 'specificity': 0.7747606, 'f1': 0.72154194, 'auroc': 0.8993669, 'binary_precision': 0.38864142, 'binary_recall': 0.5797342, 'binary_specificity': 0.969787, 'binary_f1_score': 0.4653333}
confusion matrix:
       0    1
0  17622  549
1    253  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.7529317, 'recall': 0.8281527, 'specificity': 0.8281527, 'f1': 0.7849935, 'auroc': 0.90509236, 'binary_precision': 0.5188679, 'binary_recall': 0.6818182, 'binary_specificity': 0.97448725, 'binary_f1_score': 0.5892857}
confusion matrix:
      0    1
0  5844  153
1    77  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_20.png
early stop counter: 13
val acc:0.9572790861129761, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 20,now: 2024-06-27 18:48:09.533971,epoch time: 0:44:53.790651,used: 14:17:05.817248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9647806, 'precision': 0.96326196, 'recall': 0.94516194, 'specificity': 0.94516194, 'f1': 0.95373005, 'auroc': 0.9908529, 'binary_precision': 0.96025, 'binary_recall': 0.90370125, 'binary_specificity': 0.9866226, 'binary_f1_score': 0.9311179}
confusion matrix:
       0      1
0  41744    566
1   1457  13673
---- Validation: 
scalar performance:
{'acc': 0.9553614, 'precision': 0.6810216, 'recall': 0.7801944, 'specificity': 0.7801944, 'f1': 0.718385, 'auroc': 0.89937854, 'binary_precision': 0.37578946, 'binary_recall': 0.59302324, 'binary_specificity': 0.96736556, 'binary_f1_score': 0.46005154}
confusion matrix:
       0    1
0  17578  593
1    245  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.7356666, 'recall': 0.83020055, 'specificity': 0.83020055, 'f1': 0.77385914, 'auroc': 0.9042338, 'binary_precision': 0.48405796, 'binary_recall': 0.69008267, 'binary_specificity': 0.9703185, 'binary_f1_score': 0.5689949}
confusion matrix:
      0    1
0  5819  178
1    75  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_21.png
early stop counter: 14
val acc:0.9553614258766174, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 21,now: 2024-06-27 19:35:59.867545,epoch time: 0:47:50.333574,used: 15:04:56.150822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9649373, 'precision': 0.9655533, 'recall': 0.94335437, 'specificity': 0.94335437, 'f1': 0.9537377, 'auroc': 0.9917419, 'binary_precision': 0.9667592, 'binary_recall': 0.897746, 'binary_specificity': 0.9889627, 'binary_f1_score': 0.9309754}
confusion matrix:
       0      1
0  41844    467
1   1547  13582
---- Validation: 
scalar performance:
{'acc': 0.95882386, 'precision': 0.6905208, 'recall': 0.75789154, 'specificity': 0.75789154, 'f1': 0.7184513, 'auroc': 0.8979287, 'binary_precision': 0.39636365, 'binary_recall': 0.54318935, 'binary_specificity': 0.97259367, 'binary_f1_score': 0.45830414}
confusion matrix:
       0    1
0  17673  498
1    275  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9652188, 'precision': 0.7643516, 'recall': 0.81734014, 'specificity': 0.81734014, 'f1': 0.78811145, 'auroc': 0.9030223, 'binary_precision': 0.54266214, 'binary_recall': 0.6570248, 'binary_specificity': 0.9776555, 'binary_f1_score': 0.59439254}
confusion matrix:
      0    1
0  5863  134
1    83  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_22.png
early stop counter: 15
val acc:0.9588238596916199, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 22,now: 2024-06-27 20:14:19.779640,epoch time: 0:38:19.912095,used: 15:43:16.062917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96645194, 'precision': 0.96543694, 'recall': 0.94737613, 'specificity': 0.94737613, 'f1': 0.9559297, 'auroc': 0.99179876, 'binary_precision': 0.9634232, 'binary_recall': 0.9070659, 'binary_specificity': 0.9876864, 'binary_f1_score': 0.93439555}
confusion matrix:
       0      1
0  41790    521
1   1406  13723
---- Validation: 
scalar performance:
{'acc': 0.95461565, 'precision': 0.6795646, 'recall': 0.78623354, 'specificity': 0.78623354, 'f1': 0.7188754, 'auroc': 0.9002794, 'binary_precision': 0.37244898, 'binary_recall': 0.6063123, 'binary_specificity': 0.9661549, 'binary_f1_score': 0.46144122}
confusion matrix:
       0    1
0  17556  615
1    237  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9567238, 'precision': 0.72447133, 'recall': 0.83076596, 'specificity': 0.83076596, 'f1': 0.76585644, 'auroc': 0.90501636, 'binary_precision': 0.46153846, 'binary_recall': 0.6942149, 'binary_specificity': 0.967317, 'binary_f1_score': 0.55445546}
confusion matrix:
      0    1
0  5801  196
1    74  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_23.png
early stop counter: 16
val acc:0.9546156525611877, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 23,now: 2024-06-27 20:51:23.323901,epoch time: 0:37:03.544261,used: 16:20:19.607178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96700907, 'precision': 0.9666655, 'recall': 0.94762695, 'specificity': 0.94762695, 'f1': 0.95661885, 'auroc': 0.99181163, 'binary_precision': 0.9659859, 'binary_recall': 0.9066693, 'binary_specificity': 0.9885845, 'binary_f1_score': 0.9353882}
confusion matrix:
       0      1
0  41828    483
1   1412  13717
---- Validation: 
scalar performance:
{'acc': 0.9573323, 'precision': 0.68835616, 'recall': 0.77960646, 'specificity': 0.77960646, 'f1': 0.72382957, 'auroc': 0.8995032, 'binary_precision': 0.39053905, 'binary_recall': 0.589701, 'binary_specificity': 0.96951187, 'binary_f1_score': 0.46988747}
confusion matrix:
       0    1
0  17617  554
1    247  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.7505038, 'recall': 0.82790256, 'specificity': 0.82790256, 'f1': 0.78329515, 'auroc': 0.904009, 'binary_precision': 0.5140187, 'binary_recall': 0.6818182, 'binary_specificity': 0.973987, 'binary_f1_score': 0.58614564}
confusion matrix:
      0    1
0  5841  156
1    77  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_24.png
early stop counter: 17
val acc:0.9573323130607605, best validation acc: 0.9588238596916199, corresponding to test acc:                         0.9658598899841309 / 0.9658598899841309
after epoch: 24,now: 2024-06-27 21:28:03.998198,epoch time: 0:36:40.674297,used: 16:57:00.281475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9647632, 'precision': 0.9660895, 'recall': 0.94241154, 'specificity': 0.94241154, 'f1': 0.9534384, 'auroc': 0.9920533, 'binary_precision': 0.968674, 'binary_recall': 0.89517516, 'binary_specificity': 0.98964787, 'binary_f1_score': 0.9304754}
confusion matrix:
       0      1
0  41872    438
1   1586  13544
---- Validation: 
scalar performance:
{'acc': 0.9590902, 'precision': 0.69335103, 'recall': 0.76686263, 'specificity': 0.76686263, 'f1': 0.7234355, 'auroc': 0.8999232, 'binary_precision': 0.40142518, 'binary_recall': 0.5614618, 'binary_specificity': 0.9722635, 'binary_f1_score': 0.46814406}
confusion matrix:
       0    1
0  17667  504
1    264  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656996, 'precision': 0.7669971, 'recall': 0.82155573, 'specificity': 0.82155573, 'f1': 0.7914132, 'auroc': 0.90366876, 'binary_precision': 0.54761904, 'binary_recall': 0.6652893, 'binary_specificity': 0.97782224, 'binary_f1_score': 0.6007463}
confusion matrix:
      0    1
0  5864  133
1    81  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_25.png
better model found
persisted
after epoch: 25,now: 2024-06-27 22:04:12.352794,epoch time: 0:36:08.354596,used: 17:33:08.636071,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9672876, 'precision': 0.96730494, 'recall': 0.9477311, 'specificity': 0.9477311, 'f1': 0.956962, 'auroc': 0.9919636, 'binary_precision': 0.96733916, 'binary_recall': 0.9064049, 'binary_specificity': 0.98905724, 'binary_f1_score': 0.93588126}
confusion matrix:
       0      1
0  41848    463
1   1416  13713
---- Validation: 
scalar performance:
{'acc': 0.9552016, 'precision': 0.6810601, 'recall': 0.78332406, 'specificity': 0.78332406, 'f1': 0.71928, 'auroc': 0.90019864, 'binary_precision': 0.37565038, 'binary_recall': 0.5996678, 'binary_specificity': 0.96698034, 'binary_f1_score': 0.46193218}
confusion matrix:
       0    1
0  17571  600
1    241  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95816636, 'precision': 0.73001343, 'recall': 0.8275508, 'specificity': 0.8275508, 'f1': 0.7689523, 'auroc': 0.9032719, 'binary_precision': 0.47293448, 'binary_recall': 0.6859504, 'binary_specificity': 0.96915126, 'binary_f1_score': 0.5598651}
confusion matrix:
      0    1
0  5812  185
1    76  166
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_26.png
early stop counter: 1
val acc:0.9552016258239746, best validation acc: 0.9590901732444763, corresponding to test acc:                         0.9656996130943298 / 0.9658598899841309
after epoch: 26,now: 2024-06-27 22:40:28.565187,epoch time: 0:36:16.212393,used: 18:09:24.848464,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9686456, 'precision': 0.96684283, 'recall': 0.95171285, 'specificity': 0.95171285, 'f1': 0.9589431, 'auroc': 0.9924847, 'binary_precision': 0.96323067, 'binary_recall': 0.9159286, 'binary_specificity': 0.98749703, 'binary_f1_score': 0.93898433}
confusion matrix:
       0      1
0  41781    529
1   1272  13858
---- Validation: 
scalar performance:
{'acc': 0.95530814, 'precision': 0.68098164, 'recall': 0.78097, 'specificity': 0.78097, 'f1': 0.7185694, 'auroc': 0.8994845, 'binary_precision': 0.37565583, 'binary_recall': 0.59468436, 'binary_specificity': 0.96725553, 'binary_f1_score': 0.46045014}
confusion matrix:
       0    1
0  17576  595
1    244  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95832664, 'precision': 0.7308459, 'recall': 0.82961696, 'specificity': 0.82961696, 'f1': 0.7702057, 'auroc': 0.9017925, 'binary_precision': 0.4744318, 'binary_recall': 0.69008267, 'binary_specificity': 0.96915126, 'binary_f1_score': 0.56228954}
confusion matrix:
      0    1
0  5812  185
1    75  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_27.png
early stop counter: 2
val acc:0.9553081393241882, best validation acc: 0.9590901732444763, corresponding to test acc:                         0.9656996130943298 / 0.9658598899841309
after epoch: 27,now: 2024-06-27 23:16:23.631632,epoch time: 0:35:55.066445,used: 18:45:19.914909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96815807, 'precision': 0.9669206, 'recall': 0.9503629, 'specificity': 0.9503629, 'f1': 0.95824176, 'auroc': 0.99286723, 'binary_precision': 0.9644528, 'binary_recall': 0.9127561, 'binary_specificity': 0.98796976, 'binary_f1_score': 0.9378926}
confusion matrix:
       0      1
0  41801    509
1   1320  13810
---- Validation: 
scalar performance:
{'acc': 0.9555212, 'precision': 0.6822424, 'recall': 0.78348917, 'specificity': 0.78348917, 'f1': 0.7202554, 'auroc': 0.9006605, 'binary_precision': 0.37801048, 'binary_recall': 0.5996678, 'binary_specificity': 0.96731055, 'binary_f1_score': 0.46371228}
confusion matrix:
       0    1
0  17577  594
1    241  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597692, 'precision': 0.73695886, 'recall': 0.8283846, 'specificity': 0.8283846, 'f1': 0.7741835, 'auroc': 0.90340555, 'binary_precision': 0.48680353, 'binary_recall': 0.6859504, 'binary_specificity': 0.97081876, 'binary_f1_score': 0.56946826}
confusion matrix:
      0    1
0  5822  175
1    76  166
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556225_28.png
early stop counter: 3
val acc:0.9555212259292603, best validation acc: 0.9590901732444763, corresponding to test acc:                         0.9656996130943298 / 0.9658598899841309
after epoch: 28,now: 2024-06-27 23:52:25.359330,epoch time: 0:36:01.727698,used: 19:21:21.642607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_04_31_03_seed_2_21556225
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21556225 ON gpusrv62 CANCELLED AT 2024-06-28T00:08:19 DUE TO TIME LIMIT ***
