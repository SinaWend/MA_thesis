Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun 24 14:30:49 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219

 Experiment start at: 2024-06-24 14:40:06.861151
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9240358, 'precision': 0.92965484, 'recall': 0.8686923, 'specificity': 0.8686923, 'f1': 0.8936058, 'auroc': 0.9654224, 'binary_precision': 0.93925035, 'binary_recall': 0.754349, 'binary_specificity': 0.9830356, 'binary_f1_score': 0.8367062}
confusion matrix:
       0      1
0  41606    718
1   3615  11101
---- Validation: 
scalar performance:
{'acc': 0.9585994, 'precision': 0.6900533, 'recall': 0.7002958, 'specificity': 0.7002958, 'f1': 0.6950214, 'auroc': 0.8654134, 'binary_precision': 0.4005891, 'binary_recall': 0.4230171, 'binary_specificity': 0.9775745, 'binary_f1_score': 0.4114977}
confusion matrix:
       0    1
0  17742  407
1    371  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7548479, 'recall': 0.72479534, 'specificity': 0.72479534, 'f1': 0.7387517, 'auroc': 0.894069, 'binary_precision': 0.5327511, 'binary_recall': 0.46743295, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.49795917}
confusion matrix:
      0    1
0  5890  107
1   139  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-24 15:35:09.500178,epoch time: 0:55:02.639027,used: 0:55:02.639027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94179523, 'precision': 0.9447851, 'recall': 0.90120053, 'specificity': 0.90120053, 'f1': 0.9202253, 'auroc': 0.97732353, 'binary_precision': 0.95016193, 'binary_recall': 0.8173109, 'binary_specificity': 0.98509014, 'binary_f1_score': 0.8787436}
confusion matrix:
       0      1
0  41690    631
1   2689  12030
---- Validation: 
scalar performance:
{'acc': 0.957003, 'precision': 0.68852574, 'recall': 0.72947156, 'specificity': 0.72947156, 'f1': 0.706702, 'auroc': 0.88078654, 'binary_precision': 0.39543727, 'binary_recall': 0.4852255, 'binary_specificity': 0.9737176, 'binary_f1_score': 0.43575418}
confusion matrix:
       0    1
0  17672  477
1    331  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.7659539, 'recall': 0.78634626, 'specificity': 0.78634626, 'f1': 0.77572095, 'auroc': 0.9078089, 'binary_precision': 0.54964536, 'binary_recall': 0.59386975, 'binary_specificity': 0.97882277, 'binary_f1_score': 0.57090235}
confusion matrix:
      0    1
0  5870  127
1   106  155
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_2.png
new oracle model saved
early stop counter: 1
val acc:0.9570029973983765, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9627676606178284
after epoch: 2,now: 2024-06-24 16:25:30.000175,epoch time: 0:50:20.499997,used: 1:45:23.139024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9499299, 'precision': 0.9476413, 'recall': 0.9197623, 'specificity': 0.9197623, 'f1': 0.9325601, 'auroc': 0.9809456, 'binary_precision': 0.94333136, 'binary_recall': 0.8574341, 'binary_specificity': 0.98209053, 'binary_f1_score': 0.898334}
confusion matrix:
       0      1
0  41566    758
1   2098  12618
---- Validation: 
scalar performance:
{'acc': 0.95083016, 'precision': 0.6710226, 'recall': 0.7585281, 'specificity': 0.7585281, 'f1': 0.7044071, 'auroc': 0.88751936, 'binary_precision': 0.358224, 'binary_recall': 0.5520995, 'binary_specificity': 0.96495676, 'binary_f1_score': 0.43451652}
confusion matrix:
       0    1
0  17513  636
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9509428, 'precision': 0.71475416, 'recall': 0.82598484, 'specificity': 0.82598484, 'f1': 0.7569104, 'auroc': 0.9113561, 'binary_precision': 0.44334975, 'binary_recall': 0.6896552, 'binary_specificity': 0.9623145, 'binary_f1_score': 0.53973013}
confusion matrix:
      0    1
0  5771  226
1    81  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_3.png
early stop counter: 2
val acc:0.9508301615715027, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9627676606178284
after epoch: 3,now: 2024-06-24 17:15:14.225765,epoch time: 0:49:44.225590,used: 2:35:07.364614,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.952209, 'precision': 0.9498795, 'recall': 0.9236561, 'specificity': 0.9236561, 'f1': 0.935762, 'auroc': 0.9839891, 'binary_precision': 0.94546807, 'binary_recall': 0.8646555, 'binary_specificity': 0.9826568, 'binary_f1_score': 0.90325785}
confusion matrix:
       0      1
0  41588    734
1   1992  12726
---- Validation: 
scalar performance:
{'acc': 0.95125586, 'precision': 0.67197603, 'recall': 0.75649834, 'specificity': 0.75649834, 'f1': 0.70454895, 'auroc': 0.8907602, 'binary_precision': 0.3602866, 'binary_recall': 0.5474339, 'binary_specificity': 0.9655628, 'binary_f1_score': 0.4345679}
confusion matrix:
       0    1
0  17524  625
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95190156, 'precision': 0.7182938, 'recall': 0.8283174, 'specificity': 0.8283174, 'f1': 0.76030433, 'auroc': 0.91336095, 'binary_precision': 0.45024875, 'binary_recall': 0.6934866, 'binary_specificity': 0.96314824, 'binary_f1_score': 0.54600304}
confusion matrix:
      0    1
0  5776  221
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_4.png
early stop counter: 3
val acc:0.9512558579444885, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9627676606178284
after epoch: 4,now: 2024-06-24 18:24:01.235992,epoch time: 1:08:47.010227,used: 3:43:54.374841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9546634, 'precision': 0.9553013, 'recall': 0.92494667, 'specificity': 0.92494667, 'f1': 0.93880355, 'auroc': 0.9858186, 'binary_precision': 0.9564956, 'binary_recall': 0.8635499, 'binary_specificity': 0.98634344, 'binary_f1_score': 0.9076495}
confusion matrix:
       0      1
0  41746    578
1   2008  12708
---- Validation: 
scalar performance:
{'acc': 0.9560983, 'precision': 0.6866175, 'recall': 0.739504, 'specificity': 0.739504, 'f1': 0.70929337, 'auroc': 0.89256346, 'binary_precision': 0.3908873, 'binary_recall': 0.5069984, 'binary_specificity': 0.9720095, 'binary_f1_score': 0.44143537}
confusion matrix:
       0    1
0  17641  508
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.765661, 'recall': 0.81391466, 'specificity': 0.81391466, 'f1': 0.78749084, 'auroc': 0.91358405, 'binary_precision': 0.54662377, 'binary_recall': 0.651341, 'binary_specificity': 0.97648823, 'binary_f1_score': 0.5944056}
confusion matrix:
      0    1
0  5856  141
1    91  170
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_5.png
new oracle model saved
early stop counter: 4
val acc:0.9560983180999756, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9629274606704712
after epoch: 5,now: 2024-06-24 19:32:32.222439,epoch time: 1:08:30.986447,used: 4:52:25.361288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9573983, 'precision': 0.9564704, 'recall': 0.9310086, 'specificity': 0.9310086, 'f1': 0.9428081, 'auroc': 0.9863049, 'binary_precision': 0.9547069, 'binary_recall': 0.8764778, 'binary_specificity': 0.98553944, 'binary_f1_score': 0.9139214}
confusion matrix:
       0      1
0  41710    612
1   1818  12900
---- Validation: 
scalar performance:
{'acc': 0.9537569, 'precision': 0.6806258, 'recall': 0.75554305, 'specificity': 0.75554305, 'f1': 0.71065485, 'auroc': 0.8937633, 'binary_precision': 0.37770563, 'binary_recall': 0.5427683, 'binary_specificity': 0.9683178, 'binary_f1_score': 0.44543716}
confusion matrix:
       0    1
0  17574  575
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.73923737, 'recall': 0.8329845, 'specificity': 0.8329845, 'f1': 0.77719843, 'auroc': 0.91331184, 'binary_precision': 0.4918919, 'binary_recall': 0.697318, 'binary_specificity': 0.968651, 'binary_f1_score': 0.57686216}
confusion matrix:
      0    1
0  5809  188
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_6.png
early stop counter: 5
val acc:0.9537569284439087, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9629274606704712
after epoch: 6,now: 2024-06-24 21:10:33.842006,epoch time: 1:38:01.619567,used: 6:30:26.980855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9591339, 'precision': 0.9558239, 'recall': 0.93625164, 'specificity': 0.93625164, 'f1': 0.9454826, 'auroc': 0.9880785, 'binary_precision': 0.94941944, 'binary_recall': 0.8889719, 'binary_specificity': 0.9835314, 'binary_f1_score': 0.918202}
confusion matrix:
       0      1
0  41626    697
1   1634  13083
---- Validation: 
scalar performance:
{'acc': 0.95168155, 'precision': 0.67463076, 'recall': 0.76196915, 'specificity': 0.76196915, 'f1': 0.70816135, 'auroc': 0.89394414, 'binary_precision': 0.36520854, 'binary_recall': 0.55832034, 'binary_specificity': 0.96561795, 'binary_f1_score': 0.4415744}
confusion matrix:
       0    1
0  17525  624
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.7313145, 'recall': 0.8373976, 'specificity': 0.8373976, 'f1': 0.7728169, 'auroc': 0.91345096, 'binary_precision': 0.4755784, 'binary_recall': 0.70881224, 'binary_specificity': 0.965983, 'binary_f1_score': 0.56923074}
confusion matrix:
      0    1
0  5793  204
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_7.png
early stop counter: 6
val acc:0.9516815543174744, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9629274606704712
after epoch: 7,now: 2024-06-24 21:55:56.327310,epoch time: 0:45:22.485304,used: 7:15:49.466159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9568373, 'precision': 0.9592995, 'recall': 0.92692125, 'specificity': 0.92692125, 'f1': 0.941628, 'auroc': 0.9877525, 'binary_precision': 0.96388555, 'binary_recall': 0.8651128, 'binary_specificity': 0.9887298, 'binary_f1_score': 0.9118321}
confusion matrix:
       0      1
0  41847    477
1   1985  12731
---- Validation: 
scalar performance:
{'acc': 0.9569498, 'precision': 0.69014525, 'recall': 0.7384446, 'specificity': 0.7384446, 'f1': 0.71117806, 'auroc': 0.8948512, 'binary_precision': 0.3980344, 'binary_recall': 0.503888, 'binary_specificity': 0.97300124, 'binary_f1_score': 0.44474947}
confusion matrix:
       0    1
0  17659  490
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.7869694, 'recall': 0.8287419, 'specificity': 0.8287419, 'f1': 0.80624664, 'auroc': 0.91375065, 'binary_precision': 0.5880399, 'binary_recall': 0.6781609, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.62989324}
confusion matrix:
      0    1
0  5873  124
1    84  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_8.png
new oracle model saved
early stop counter: 7
val acc:0.956949770450592, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9667625427246094
after epoch: 8,now: 2024-06-24 22:40:11.673672,epoch time: 0:44:15.346362,used: 8:00:04.812521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9599404, 'precision': 0.95969224, 'recall': 0.9346012, 'specificity': 0.9346012, 'f1': 0.94625014, 'auroc': 0.9879731, 'binary_precision': 0.9592199, 'binary_recall': 0.882245, 'binary_specificity': 0.98695743, 'binary_f1_score': 0.9191236}
confusion matrix:
       0      1
0  41771    552
1   1733  12984
---- Validation: 
scalar performance:
{'acc': 0.95423585, 'precision': 0.68248755, 'recall': 0.755791, 'specificity': 0.755791, 'f1': 0.71206933, 'auroc': 0.8966713, 'binary_precision': 0.38142076, 'binary_recall': 0.5427683, 'binary_specificity': 0.9688137, 'binary_f1_score': 0.44801027}
confusion matrix:
       0    1
0  17583  566
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.75708795, 'recall': 0.8350689, 'specificity': 0.8350689, 'f1': 0.7901705, 'auroc': 0.91336286, 'binary_precision': 0.5275362, 'binary_recall': 0.697318, 'binary_specificity': 0.97281975, 'binary_f1_score': 0.60066}
confusion matrix:
      0    1
0  5834  163
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_9.png
early stop counter: 8
val acc:0.954235851764679, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9667625427246094
after epoch: 9,now: 2024-06-24 23:23:45.797677,epoch time: 0:43:34.124005,used: 8:43:38.936526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96125525, 'precision': 0.95996654, 'recall': 0.93778837, 'specificity': 0.93778837, 'f1': 0.9481752, 'auroc': 0.988868, 'binary_precision': 0.95749193, 'binary_recall': 0.88930416, 'binary_specificity': 0.9862726, 'binary_f1_score': 0.9221393}
confusion matrix:
       0      1
0  41743    581
1   1629  13087
---- Validation: 
scalar performance:
{'acc': 0.9516283, 'precision': 0.67509854, 'recall': 0.7649418, 'specificity': 0.7649418, 'f1': 0.70937544, 'auroc': 0.8981091, 'binary_precision': 0.36592743, 'binary_recall': 0.5645412, 'binary_specificity': 0.96534246, 'binary_f1_score': 0.4440367}
confusion matrix:
       0    1
0  17520  629
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549377, 'precision': 0.7302474, 'recall': 0.83906317, 'specificity': 0.83906317, 'f1': 0.77251697, 'auroc': 0.91422784, 'binary_precision': 0.47328246, 'binary_recall': 0.7126437, 'binary_specificity': 0.9654827, 'binary_f1_score': 0.56880736}
confusion matrix:
      0    1
0  5790  207
1    75  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_10.png
early stop counter: 9
val acc:0.9516283273696899, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9667625427246094
after epoch: 10,now: 2024-06-25 00:05:09.582443,epoch time: 0:41:23.784766,used: 9:25:02.721292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.961939, 'precision': 0.9614228, 'recall': 0.9381826, 'specificity': 0.9381826, 'f1': 0.94903564, 'auroc': 0.98877263, 'binary_precision': 0.96043456, 'binary_recall': 0.8891003, 'binary_specificity': 0.98726493, 'binary_f1_score': 0.9233918}
confusion matrix:
       0      1
0  41785    539
1   1632  13084
---- Validation: 
scalar performance:
{'acc': 0.9544487, 'precision': 0.6828581, 'recall': 0.753651, 'specificity': 0.753651, 'f1': 0.7116372, 'auroc': 0.8979354, 'binary_precision': 0.38232043, 'binary_recall': 0.5381026, 'binary_specificity': 0.9691994, 'binary_f1_score': 0.44702843}
confusion matrix:
       0    1
0  17590  559
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.76416326, 'recall': 0.83581924, 'specificity': 0.83581924, 'f1': 0.7950833, 'auroc': 0.91370976, 'binary_precision': 0.5416667, 'binary_recall': 0.697318, 'binary_specificity': 0.9743205, 'binary_f1_score': 0.6097153}
confusion matrix:
      0    1
0  5843  154
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_11.png
early stop counter: 10
val acc:0.9544486999511719, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9667625427246094
after epoch: 11,now: 2024-06-25 00:47:09.317296,epoch time: 0:41:59.734853,used: 10:07:02.456145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9638324, 'precision': 0.96018076, 'recall': 0.94444513, 'specificity': 0.94444513, 'f1': 0.95195687, 'auroc': 0.99032223, 'binary_precision': 0.9530254, 'binary_recall': 0.9043898, 'binary_specificity': 0.9845005, 'binary_f1_score': 0.92807084}
confusion matrix:
       0      1
0  41668    656
1   1407  13309
---- Validation: 
scalar performance:
{'acc': 0.9502448, 'precision': 0.67414254, 'recall': 0.7814768, 'specificity': 0.7814768, 'f1': 0.7130971, 'auroc': 0.89875865, 'binary_precision': 0.36278194, 'binary_recall': 0.60031104, 'binary_specificity': 0.96264255, 'binary_f1_score': 0.4522554}
confusion matrix:
       0    1
0  17471  678
1    257  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9506232, 'precision': 0.7156581, 'recall': 0.84230906, 'specificity': 0.84230906, 'f1': 0.76204807, 'auroc': 0.9142132, 'binary_precision': 0.44366196, 'binary_recall': 0.7241379, 'binary_specificity': 0.9604802, 'binary_f1_score': 0.55021834}
confusion matrix:
      0    1
0  5760  237
1    72  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_12.png
early stop counter: 11
val acc:0.9502447843551636, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9667625427246094
after epoch: 12,now: 2024-06-25 01:29:26.286203,epoch time: 0:42:16.968907,used: 10:49:19.425052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96258765, 'precision': 0.9623517, 'recall': 0.93900365, 'specificity': 0.93900365, 'f1': 0.9499055, 'auroc': 0.99001145, 'binary_precision': 0.9618999, 'binary_recall': 0.8902704, 'binary_specificity': 0.9877369, 'binary_f1_score': 0.92470014}
confusion matrix:
       0      1
0  41803    519
1   1615  13103
---- Validation: 
scalar performance:
{'acc': 0.9534376, 'precision': 0.6794046, 'recall': 0.75537777, 'specificity': 0.75537777, 'f1': 0.70971996, 'auroc': 0.8991221, 'binary_precision': 0.37526882, 'binary_recall': 0.5427683, 'binary_specificity': 0.96798724, 'binary_f1_score': 0.44373807}
confusion matrix:
       0    1
0  17568  581
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.75632447, 'recall': 0.8349855, 'specificity': 0.8349855, 'f1': 0.7896329, 'auroc': 0.9130063, 'binary_precision': 0.5260116, 'binary_recall': 0.697318, 'binary_specificity': 0.972653, 'binary_f1_score': 0.5996706}
confusion matrix:
      0    1
0  5833  164
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_13.png
early stop counter: 12
val acc:0.9534376263618469, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9667625427246094
after epoch: 13,now: 2024-06-25 02:13:11.722344,epoch time: 0:43:45.436141,used: 11:33:04.861193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96363956, 'precision': 0.96424305, 'recall': 0.9399491, 'specificity': 0.9399491, 'f1': 0.9512655, 'auroc': 0.98979175, 'binary_precision': 0.9653954, 'binary_recall': 0.891003, 'binary_specificity': 0.9888952, 'binary_f1_score': 0.92670864}
confusion matrix:
       0      1
0  41854    470
1   1604  13112
---- Validation: 
scalar performance:
{'acc': 0.9544487, 'precision': 0.68270075, 'recall': 0.75290096, 'specificity': 0.75290096, 'f1': 0.71128017, 'auroc': 0.8988539, 'binary_precision': 0.3820598, 'binary_recall': 0.5365474, 'binary_specificity': 0.9692545, 'binary_f1_score': 0.44631305}
confusion matrix:
       0    1
0  17591  558
1    298  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7633585, 'recall': 0.8357359, 'specificity': 0.8357359, 'f1': 0.79453075, 'auroc': 0.91251695, 'binary_precision': 0.5400593, 'binary_recall': 0.697318, 'binary_specificity': 0.97415376, 'binary_f1_score': 0.6086956}
confusion matrix:
      0    1
0  5842  155
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_14.png
early stop counter: 13
val acc:0.9544486999511719, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9667625427246094
after epoch: 14,now: 2024-06-25 02:57:11.190447,epoch time: 0:43:59.468103,used: 12:17:04.329296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9651648, 'precision': 0.9627505, 'recall': 0.9454095, 'specificity': 0.9454095, 'f1': 0.9536514, 'auroc': 0.99049056, 'binary_precision': 0.95804244, 'binary_recall': 0.90459365, 'binary_specificity': 0.9862253, 'binary_f1_score': 0.9305512}
confusion matrix:
       0      1
0  41741    583
1   1404  13312
---- Validation: 
scalar performance:
{'acc': 0.9524798, 'precision': 0.679663, 'recall': 0.7728832, 'specificity': 0.7728832, 'f1': 0.715156, 'auroc': 0.8993, 'binary_precision': 0.37449798, 'binary_recall': 0.5800933, 'binary_specificity': 0.965673, 'binary_f1_score': 0.45515558}
confusion matrix:
       0    1
0  17526  623
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.7375996, 'recall': 0.8382313, 'specificity': 0.8382313, 'f1': 0.777695, 'auroc': 0.9131373, 'binary_precision': 0.48812664, 'binary_recall': 0.70881224, 'binary_specificity': 0.9676505, 'binary_f1_score': 0.57812494}
confusion matrix:
      0    1
0  5803  194
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_15.png
early stop counter: 14
val acc:0.9524797797203064, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9667625427246094
after epoch: 15,now: 2024-06-25 03:38:41.638943,epoch time: 0:41:30.448496,used: 12:58:34.777792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9659362, 'precision': 0.96435523, 'recall': 0.9458597, 'specificity': 0.9458597, 'f1': 0.954623, 'auroc': 0.9901513, 'binary_precision': 0.96128285, 'binary_recall': 0.9043833, 'binary_specificity': 0.9873361, 'binary_f1_score': 0.9319654}
confusion matrix:
       0      1
0  41789    536
1   1407  13308
---- Validation: 
scalar performance:
{'acc': 0.95210725, 'precision': 0.67942595, 'recall': 0.7779407, 'specificity': 0.7779407, 'f1': 0.7163892, 'auroc': 0.90065813, 'binary_precision': 0.373648, 'binary_recall': 0.59097975, 'binary_specificity': 0.9649016, 'binary_f1_score': 0.45783132}
confusion matrix:
       0    1
0  17512  637
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549377, 'precision': 0.7303981, 'recall': 0.84089553, 'specificity': 0.84089553, 'f1': 0.77317226, 'auroc': 0.9132925, 'binary_precision': 0.47341773, 'binary_recall': 0.71647507, 'binary_specificity': 0.965316, 'binary_f1_score': 0.57012194}
confusion matrix:
      0    1
0  5789  208
1    74  187
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_16.png
early stop counter: 15
val acc:0.9521072506904602, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9667625427246094
after epoch: 16,now: 2024-06-25 04:21:04.435382,epoch time: 0:42:22.796439,used: 13:40:57.574231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9654453, 'precision': 0.96223223, 'recall': 0.94668746, 'specificity': 0.94668746, 'f1': 0.9541142, 'auroc': 0.9905443, 'binary_precision': 0.95593077, 'binary_recall': 0.9079296, 'binary_specificity': 0.98544526, 'binary_f1_score': 0.9313121}
confusion matrix:
       0      1
0  41707    616
1   1355  13362
---- Validation: 
scalar performance:
{'acc': 0.95184124, 'precision': 0.6774287, 'recall': 0.7725526, 'specificity': 0.7725526, 'f1': 0.7133308, 'auroc': 0.8996789, 'binary_precision': 0.37003967, 'binary_recall': 0.5800933, 'binary_specificity': 0.96501184, 'binary_f1_score': 0.45184737}
confusion matrix:
       0    1
0  17514  635
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95573664, 'precision': 0.7331659, 'recall': 0.83764774, 'specificity': 0.83764774, 'f1': 0.774266, 'auroc': 0.9123436, 'binary_precision': 0.4792746, 'binary_recall': 0.70881224, 'binary_specificity': 0.96648324, 'binary_f1_score': 0.57187015}
confusion matrix:
      0    1
0  5796  201
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_17.png
early stop counter: 16
val acc:0.9518412351608276, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9667625427246094
after epoch: 17,now: 2024-06-25 05:02:27.262171,epoch time: 0:41:22.826789,used: 14:22:20.401020,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9645512, 'precision': 0.96509826, 'recall': 0.94151986, 'specificity': 0.94151986, 'f1': 0.9525278, 'auroc': 0.99104816, 'binary_precision': 0.9661453, 'binary_recall': 0.89393216, 'binary_specificity': 0.98910755, 'binary_f1_score': 0.92863697}
confusion matrix:
       0      1
0  41862    461
1   1561  13156
---- Validation: 
scalar performance:
{'acc': 0.9555662, 'precision': 0.6868051, 'recall': 0.75122935, 'specificity': 0.75122935, 'f1': 0.7135718, 'auroc': 0.8998054, 'binary_precision': 0.39041096, 'binary_recall': 0.5318818, 'binary_specificity': 0.9705769, 'binary_f1_score': 0.45029625}
confusion matrix:
       0    1
0  17615  534
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.77442956, 'recall': 0.8331551, 'specificity': 0.8331551, 'f1': 0.8005522, 'auroc': 0.9120461, 'binary_precision': 0.5625, 'binary_recall': 0.6896552, 'binary_specificity': 0.976655, 'binary_f1_score': 0.61962134}
confusion matrix:
      0    1
0  5857  140
1    81  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_18.png
early stop counter: 17
val acc:0.9555662274360657, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9667625427246094
after epoch: 18,now: 2024-06-25 05:44:49.525384,epoch time: 0:42:22.263213,used: 15:04:42.664233,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9671108, 'precision': 0.965405, 'recall': 0.9479487, 'specificity': 0.9479487, 'f1': 0.9562457, 'auroc': 0.991483, 'binary_precision': 0.96207815, 'binary_recall': 0.90834975, 'binary_specificity': 0.9875476, 'binary_f1_score': 0.9344423}
confusion matrix:
       0      1
0  41794    527
1   1349  13370
---- Validation: 
scalar performance:
{'acc': 0.9531183, 'precision': 0.68149906, 'recall': 0.7709636, 'specificity': 0.7709636, 'f1': 0.71600544, 'auroc': 0.90005594, 'binary_precision': 0.3783231, 'binary_recall': 0.5754277, 'binary_specificity': 0.9664995, 'binary_f1_score': 0.45650834}
confusion matrix:
       0    1
0  17541  608
1    273  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7441458, 'recall': 0.8372328, 'specificity': 0.8372328, 'f1': 0.78205824, 'auroc': 0.9113382, 'binary_precision': 0.5013624, 'binary_recall': 0.70498085, 'binary_specificity': 0.96948475, 'binary_f1_score': 0.58598727}
confusion matrix:
      0    1
0  5814  183
1    77  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_19.png
early stop counter: 18
val acc:0.9531183242797852, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9667625427246094
after epoch: 19,now: 2024-06-25 06:26:15.312143,epoch time: 0:41:25.786759,used: 15:46:08.450992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96691793, 'precision': 0.9646619, 'recall': 0.94816446, 'specificity': 0.94816446, 'f1': 0.95602703, 'auroc': 0.9914807, 'binary_precision': 0.9602497, 'binary_recall': 0.90941834, 'binary_specificity': 0.9869105, 'binary_f1_score': 0.93414307}
confusion matrix:
       0      1
0  41770    554
1   1333  13383
---- Validation: 
scalar performance:
{'acc': 0.9521605, 'precision': 0.6791542, 'recall': 0.7757181, 'specificity': 0.7757181, 'f1': 0.7155601, 'auroc': 0.9012175, 'binary_precision': 0.37326732, 'binary_recall': 0.58631414, 'binary_specificity': 0.96512204, 'binary_f1_score': 0.45614034}
confusion matrix:
       0    1
0  17516  633
1    266  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.73504627, 'recall': 0.8378979, 'specificity': 0.8378979, 'f1': 0.77572733, 'auroc': 0.9121705, 'binary_precision': 0.4830287, 'binary_recall': 0.70881224, 'binary_specificity': 0.9669835, 'binary_f1_score': 0.5745342}
confusion matrix:
      0    1
0  5799  198
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_20.png
early stop counter: 19
val acc:0.9521604776382446, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9667625427246094
after epoch: 20,now: 2024-06-25 07:07:32.034608,epoch time: 0:41:16.722465,used: 16:27:25.173457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9668829, 'precision': 0.9658915, 'recall': 0.94684917, 'specificity': 0.94684917, 'f1': 0.95585936, 'auroc': 0.9916465, 'binary_precision': 0.96396786, 'binary_recall': 0.9054642, 'binary_specificity': 0.98823416, 'binary_f1_score': 0.93380064}
confusion matrix:
       0      1
0  41828    498
1   1391  13323
---- Validation: 
scalar performance:
{'acc': 0.954023, 'precision': 0.68396264, 'recall': 0.76693165, 'specificity': 0.76693165, 'f1': 0.71664053, 'auroc': 0.9006858, 'binary_precision': 0.38356164, 'binary_recall': 0.5660964, 'binary_specificity': 0.9677668, 'binary_f1_score': 0.45728642}
confusion matrix:
       0    1
0  17564  585
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.75559056, 'recall': 0.8385668, 'specificity': 0.8385668, 'f1': 0.7904049, 'auroc': 0.9115912, 'binary_precision': 0.52421653, 'binary_recall': 0.70498085, 'binary_specificity': 0.97215277, 'binary_f1_score': 0.6013072}
confusion matrix:
      0    1
0  5830  167
1    77  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_21.png
early stop counter: 20
val acc:0.954023003578186, best validation acc: 0.9585993885993958, corresponding to test acc:                         0.9606903195381165 / 0.9667625427246094
after epoch: 21,now: 2024-06-25 07:48:43.371300,epoch time: 0:41:11.336692,used: 17:08:36.510149,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 17:08:36.510149 at 2024-06-25 07:48:43.371300
persisted model performance metric: 

scalar performance:
{'acc': 0.9606903, 'precision': 0.7548479, 'recall': 0.72479534, 'specificity': 0.72479534, 'f1': 0.7387517, 'auroc': 0.894069, 'binary_precision': 0.5327511, 'binary_recall': 0.46743295, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.49795917}
confusion matrix:
      0    1
0  5890  107
1   139  122
oracle model performance metric: 

scalar performance:
{'acc': 0.96676254, 'precision': 0.7869694, 'recall': 0.8287419, 'specificity': 0.8287419, 'f1': 0.80624664, 'auroc': 0.91375065, 'binary_precision': 0.5880399, 'binary_recall': 0.6781609, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.62989324}
confusion matrix:
      0    1
0  5873  124
1    84  177
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191429 KiB |   2147 MiB |   1627 TiB |   1627 TiB |
|       from large pool | 173952 KiB |   2130 MiB |   1603 TiB |   1603 TiB |
|       from small pool |  17477 KiB |     37 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 191429 KiB |   2147 MiB |   1627 TiB |   1627 TiB |
|       from large pool | 173952 KiB |   2130 MiB |   1603 TiB |   1603 TiB |
|       from small pool |  17477 KiB |     37 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189283 KiB |   2146 MiB |   1627 TiB |   1627 TiB |
|       from large pool | 172814 KiB |   2128 MiB |   1603 TiB |   1603 TiB |
|       from small pool |  16469 KiB |     36 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2392 MiB |   2392 MiB |   2392 MiB |      0 B   |
|       from large pool |   2350 MiB |   2350 MiB |   2350 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  62522 KiB | 235139 KiB |    899 TiB |    899 TiB |
|       from large pool |  51328 KiB | 232732 KiB |    875 TiB |    875 TiB |
|       from small pool |  11194 KiB |  14091 KiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7593    |  242221 K  |  242218 K  |
|       from large pool |      76    |     251    |  154117 K  |  154117 K  |
|       from small pool |    2890    |    7516    |   88103 K  |   88101 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7593    |  242221 K  |  242218 K  |
|       from large pool |      76    |     251    |  154117 K  |  154117 K  |
|       from small pool |    2890    |    7516    |   88103 K  |   88101 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     119    |     119    |     119    |       0    |
|       from large pool |      98    |      98    |      98    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3586    |  158565 K  |  158565 K  |
|       from large pool |      11    |      99    |  117988 K  |  117988 K  |
|       from small pool |      23    |    3575    |   40577 K  |   40577 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2147 MiB |   1627 TiB |   1627 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   1603 TiB |   1603 TiB |
|       from small pool |      0 KiB |     37 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2147 MiB |   1627 TiB |   1627 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   1603 TiB |   1603 TiB |
|       from small pool |      0 KiB |     37 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2146 MiB |   1627 TiB |   1627 TiB |
|       from large pool |  16640 KiB |   2128 MiB |   1603 TiB |   1603 TiB |
|       from small pool |      0 KiB |     36 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 253952 KiB |   2392 MiB |   2392 MiB |   2144 MiB |
|       from large pool | 225280 KiB |   2350 MiB |   2350 MiB |   2130 MiB |
|       from small pool |  28672 KiB |     42 MiB |     42 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 235139 KiB |    899 TiB |    899 TiB |
|       from large pool |  24320 KiB | 232732 KiB |    875 TiB |    875 TiB |
|       from small pool |      0 KiB |  18293 KiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7593    |  242221 K  |  242221 K  |
|       from large pool |       2    |     251    |  154117 K  |  154117 K  |
|       from small pool |       0    |    7516    |   88103 K  |   88103 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7593    |  242221 K  |  242221 K  |
|       from large pool |       2    |     251    |  154117 K  |  154117 K  |
|       from small pool |       0    |    7516    |   88103 K  |   88103 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     119    |     119    |      94    |
|       from large pool |      11    |      98    |      98    |      87    |
|       from small pool |      14    |      21    |      21    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3586    |  158566 K  |  158566 K  |
|       from large pool |       4    |      99    |  117988 K  |  117988 K  |
|       from small pool |       0    |    3575    |   40578 K  |   40578 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2147 MiB |   1627 TiB |   1627 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   1603 TiB |   1603 TiB |
|       from small pool |      0 KiB |     37 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2147 MiB |   1627 TiB |   1627 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   1603 TiB |   1603 TiB |
|       from small pool |      0 KiB |     37 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2146 MiB |   1627 TiB |   1627 TiB |
|       from large pool |  16640 KiB |   2128 MiB |   1603 TiB |   1603 TiB |
|       from small pool |      0 KiB |     36 MiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 253952 KiB |   2392 MiB |   2392 MiB |   2144 MiB |
|       from large pool | 225280 KiB |   2350 MiB |   2350 MiB |   2130 MiB |
|       from small pool |  28672 KiB |     42 MiB |     42 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 235139 KiB |    899 TiB |    899 TiB |
|       from large pool |  24320 KiB | 232732 KiB |    875 TiB |    875 TiB |
|       from small pool |      0 KiB |  18293 KiB |     23 TiB |     23 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7593    |  242221 K  |  242221 K  |
|       from large pool |       2    |     251    |  154117 K  |  154117 K  |
|       from small pool |       0    |    7516    |   88103 K  |   88103 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7593    |  242221 K  |  242221 K  |
|       from large pool |       2    |     251    |  154117 K  |  154117 K  |
|       from small pool |       0    |    7516    |   88103 K  |   88103 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     119    |     119    |      94    |
|       from large pool |      11    |      98    |      98    |      87    |
|       from small pool |      14    |      21    |      21    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3586    |  158566 K  |  158566 K  |
|       from large pool |       4    |      99    |  117988 K  |  117988 K  |
|       from small pool |       0    |    3575    |   40578 K  |   40578 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219

 Experiment start at: 2024-06-25 07:55:37.267802
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9269602, 'precision': 0.9294683, 'recall': 0.8740098, 'specificity': 0.8740098, 'f1': 0.89720917, 'auroc': 0.9654987, 'binary_precision': 0.933767, 'binary_recall': 0.7665049, 'binary_specificity': 0.9815147, 'binary_f1_score': 0.8419089}
confusion matrix:
       0      1
0  41628    784
1   3367  11053
---- Validation: 
scalar performance:
{'acc': 0.95581645, 'precision': 0.68543327, 'recall': 0.698131, 'specificity': 0.698131, 'f1': 0.69154036, 'auroc': 0.86309874, 'binary_precision': 0.3925104, 'binary_recall': 0.4205052, 'binary_specificity': 0.9757569, 'binary_f1_score': 0.40602583}
confusion matrix:
       0    1
0  17629  438
1    390  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.742512, 'recall': 0.7210148, 'specificity': 0.7210148, 'f1': 0.73119366, 'auroc': 0.8989916, 'binary_precision': 0.5084746, 'binary_recall': 0.46153846, 'binary_specificity': 0.9804911, 'binary_f1_score': 0.48387098}
confusion matrix:
      0    1
0  5830  116
1   140  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-25 08:37:45.158632,epoch time: 0:42:07.890830,used: 0:42:07.890830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9409488, 'precision': 0.9442164, 'recall': 0.89770806, 'specificity': 0.89770806, 'f1': 0.91788805, 'auroc': 0.9765893, 'binary_precision': 0.9499756, 'binary_recall': 0.8099168, 'binary_specificity': 0.9854994, 'binary_f1_score': 0.87437296}
confusion matrix:
       0      1
0  41797    615
1   2741  11679
---- Validation: 
scalar performance:
{'acc': 0.9590182, 'precision': 0.7077694, 'recall': 0.7255412, 'specificity': 0.7255412, 'f1': 0.71624, 'auroc': 0.87746096, 'binary_precision': 0.43519783, 'binary_recall': 0.47399703, 'binary_specificity': 0.9770853, 'binary_f1_score': 0.4537696}
confusion matrix:
       0    1
0  17653  414
1    354  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.7744652, 'recall': 0.77143526, 'specificity': 0.77143526, 'f1': 0.7729407, 'auroc': 0.9114033, 'binary_precision': 0.56809336, 'binary_recall': 0.56153846, 'binary_specificity': 0.981332, 'binary_f1_score': 0.5647969}
confusion matrix:
      0    1
0  5835  111
1   114  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-25 09:22:12.098965,epoch time: 0:44:26.940333,used: 1:26:34.831163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9509255, 'precision': 0.94827473, 'recall': 0.92029285, 'specificity': 0.92029285, 'f1': 0.9331645, 'auroc': 0.98285747, 'binary_precision': 0.9433516, 'binary_recall': 0.8581039, 'binary_specificity': 0.9824818, 'binary_f1_score': 0.89871067}
confusion matrix:
       0      1
0  41670    743
1   2046  12373
---- Validation: 
scalar performance:
{'acc': 0.9543223, 'precision': 0.69070065, 'recall': 0.753147, 'specificity': 0.753147, 'f1': 0.71684927, 'auroc': 0.88453555, 'binary_precision': 0.39889503, 'binary_recall': 0.53640413, 'binary_specificity': 0.9698899, 'binary_f1_score': 0.4575412}
confusion matrix:
       0    1
0  17523  544
1    312  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.742494, 'recall': 0.81630576, 'specificity': 0.81630576, 'f1': 0.77375877, 'auroc': 0.9142921, 'binary_precision': 0.5, 'binary_recall': 0.6615385, 'binary_specificity': 0.971073, 'binary_f1_score': 0.56953645}
confusion matrix:
      0    1
0  5774  172
1    88  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_3.png
early stop counter: 1
val acc:0.9543222784996033, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 3,now: 2024-06-25 10:09:02.944556,epoch time: 0:46:50.845591,used: 2:13:25.676754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95287865, 'precision': 0.9534931, 'recall': 0.92054856, 'specificity': 0.92054856, 'f1': 0.9354999, 'auroc': 0.9844514, 'binary_precision': 0.95461935, 'binary_recall': 0.85491365, 'binary_specificity': 0.98618346, 'binary_f1_score': 0.9020196}
confusion matrix:
       0      1
0  41827    586
1   2092  12327
---- Validation: 
scalar performance:
{'acc': 0.9551227, 'precision': 0.69393617, 'recall': 0.75284684, 'specificity': 0.75284684, 'f1': 0.7189145, 'auroc': 0.88753736, 'binary_precision': 0.4054054, 'binary_recall': 0.53491825, 'binary_specificity': 0.9707754, 'binary_f1_score': 0.46124277}
confusion matrix:
       0    1
0  17539  528
1    313  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.7524549, 'recall': 0.8265938, 'specificity': 0.8265938, 'f1': 0.7840528, 'auroc': 0.91649914, 'binary_precision': 0.51906157, 'binary_recall': 0.6807692, 'binary_specificity': 0.9724184, 'binary_f1_score': 0.5890183}
confusion matrix:
      0    1
0  5782  164
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_4.png
early stop counter: 2
val acc:0.955122709274292, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 4,now: 2024-06-25 10:54:34.938008,epoch time: 0:45:31.993452,used: 2:58:57.670206,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95358247, 'precision': 0.95555747, 'recall': 0.92052156, 'specificity': 0.92052156, 'f1': 0.93633264, 'auroc': 0.9842154, 'binary_precision': 0.95915824, 'binary_recall': 0.8533981, 'binary_specificity': 0.98764503, 'binary_f1_score': 0.9031927}
confusion matrix:
       0      1
0  41888    524
1   2114  12306
---- Validation: 
scalar performance:
{'acc': 0.9542156, 'precision': 0.69039917, 'recall': 0.75380695, 'specificity': 0.75380695, 'f1': 0.71687376, 'auroc': 0.88886434, 'binary_precision': 0.39823982, 'binary_recall': 0.53789, 'binary_specificity': 0.9697238, 'binary_f1_score': 0.45764855}
confusion matrix:
       0    1
0  17520  547
1    311  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7480686, 'recall': 0.8297672, 'specificity': 0.8297672, 'f1': 0.7822429, 'auroc': 0.9156149, 'binary_precision': 0.5099715, 'binary_recall': 0.68846154, 'binary_specificity': 0.971073, 'binary_f1_score': 0.5859247}
confusion matrix:
      0    1
0  5774  172
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_5.png
early stop counter: 3
val acc:0.9542155861854553, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 5,now: 2024-06-25 11:36:47.447677,epoch time: 0:42:12.509669,used: 3:41:10.179875,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9556412, 'precision': 0.95660925, 'recall': 0.92493993, 'specificity': 0.92493993, 'f1': 0.9393797, 'auroc': 0.98655486, 'binary_precision': 0.95839113, 'binary_recall': 0.86261183, 'binary_specificity': 0.98726803, 'binary_f1_score': 0.90798265}
confusion matrix:
       0      1
0  41873    540
1   1981  12438
---- Validation: 
scalar performance:
{'acc': 0.95549625, 'precision': 0.6944892, 'recall': 0.74731845, 'specificity': 0.74731845, 'f1': 0.7172667, 'auroc': 0.8897254, 'binary_precision': 0.4069364, 'binary_recall': 0.5230312, 'binary_specificity': 0.9716057, 'binary_f1_score': 0.4577373}
confusion matrix:
       0    1
0  17554  513
1    321  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.7635832, 'recall': 0.82777107, 'specificity': 0.82777107, 'f1': 0.7916812, 'auroc': 0.9152708, 'binary_precision': 0.5412844, 'binary_recall': 0.6807692, 'binary_specificity': 0.97477293, 'binary_f1_score': 0.60306644}
confusion matrix:
      0    1
0  5796  150
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_6.png
early stop counter: 4
val acc:0.9554962515830994, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 6,now: 2024-06-25 12:18:17.203637,epoch time: 0:41:29.755960,used: 4:22:39.935835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95850927, 'precision': 0.95774883, 'recall': 0.9314267, 'specificity': 0.9314267, 'f1': 0.9436223, 'auroc': 0.98726845, 'binary_precision': 0.95632756, 'binary_recall': 0.87645674, 'binary_specificity': 0.9863967, 'binary_f1_score': 0.91465175}
confusion matrix:
       0      1
0  41839    577
1   1781  12635
---- Validation: 
scalar performance:
{'acc': 0.9517076, 'precision': 0.6842823, 'recall': 0.7703879, 'specificity': 0.7703879, 'f1': 0.71785504, 'auroc': 0.8927673, 'binary_precision': 0.38469183, 'binary_recall': 0.5750371, 'binary_specificity': 0.96573865, 'binary_f1_score': 0.46098867}
confusion matrix:
       0    1
0  17448  619
1    286  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.954399, 'precision': 0.72859997, 'recall': 0.8346005, 'specificity': 0.8346005, 'f1': 0.769943, 'auroc': 0.91593504, 'binary_precision': 0.47043702, 'binary_recall': 0.70384616, 'binary_specificity': 0.96535486, 'binary_f1_score': 0.5639445}
confusion matrix:
      0    1
0  5740  206
1    77  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_7.png
early stop counter: 5
val acc:0.9517076015472412, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 7,now: 2024-06-25 12:59:24.718161,epoch time: 0:41:07.514524,used: 5:03:47.450359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9596002, 'precision': 0.95726883, 'recall': 0.93482876, 'specificity': 0.93482876, 'f1': 0.945343, 'auroc': 0.98775905, 'binary_precision': 0.9528612, 'binary_recall': 0.8845354, 'binary_specificity': 0.98512214, 'binary_f1_score': 0.91742784}
confusion matrix:
       0      1
0  41781    631
1   1665  12755
---- Validation: 
scalar performance:
{'acc': 0.9483991, 'precision': 0.67462707, 'recall': 0.7758247, 'specificity': 0.7758247, 'f1': 0.71190387, 'auroc': 0.8919847, 'binary_precision': 0.3648897, 'binary_recall': 0.58989596, 'binary_specificity': 0.9617535, 'binary_f1_score': 0.45088014}
confusion matrix:
       0    1
0  17376  691
1    276  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9498872, 'precision': 0.713004, 'recall': 0.834085, 'specificity': 0.834085, 'f1': 0.75773346, 'auroc': 0.91386515, 'binary_precision': 0.4391408, 'binary_recall': 0.7076923, 'binary_specificity': 0.96047765, 'binary_f1_score': 0.5419734}
confusion matrix:
      0    1
0  5711  235
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_8.png
early stop counter: 6
val acc:0.9483991265296936, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 8,now: 2024-06-25 13:51:38.805657,epoch time: 0:52:14.087496,used: 5:56:01.537855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9595826, 'precision': 0.96012104, 'recall': 0.93204373, 'specificity': 0.93204373, 'f1': 0.9449928, 'auroc': 0.98898256, 'binary_precision': 0.96112293, 'binary_recall': 0.87613565, 'binary_specificity': 0.9879518, 'binary_f1_score': 0.9166636}
confusion matrix:
       0      1
0  41902    511
1   1786  12633
---- Validation: 
scalar performance:
{'acc': 0.95416224, 'precision': 0.6905958, 'recall': 0.75592506, 'specificity': 0.75592506, 'f1': 0.71773744, 'auroc': 0.89380646, 'binary_precision': 0.39847162, 'binary_recall': 0.54234767, 'binary_specificity': 0.9695024, 'binary_f1_score': 0.45940843}
confusion matrix:
       0    1
0  17516  551
1    308  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.75400645, 'recall': 0.828601, 'specificity': 0.828601, 'f1': 0.78580135, 'auroc': 0.9139706, 'binary_precision': 0.5219941, 'binary_recall': 0.6846154, 'binary_specificity': 0.97258663, 'binary_f1_score': 0.5923461}
confusion matrix:
      0    1
0  5783  163
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_9.png
early stop counter: 7
val acc:0.9541622400283813, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 9,now: 2024-06-25 14:37:50.920291,epoch time: 0:46:12.114634,used: 6:42:13.652489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9616589, 'precision': 0.9596001, 'recall': 0.93805814, 'specificity': 0.93805814, 'f1': 0.94818234, 'auroc': 0.988536, 'binary_precision': 0.9556962, 'binary_recall': 0.89014494, 'binary_specificity': 0.9859713, 'binary_f1_score': 0.9217566}
confusion matrix:
       0      1
0  41818    595
1   1584  12835
---- Validation: 
scalar performance:
{'acc': 0.9526681, 'precision': 0.68724376, 'recall': 0.7680249, 'specificity': 0.7680249, 'f1': 0.719321, 'auroc': 0.8938375, 'binary_precision': 0.39081633, 'binary_recall': 0.5690936, 'binary_specificity': 0.9669563, 'binary_f1_score': 0.4633999}
confusion matrix:
       0    1
0  17470  597
1    290  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.7350791, 'recall': 0.8300085, 'specificity': 0.8300085, 'f1': 0.7732651, 'auroc': 0.9132526, 'binary_precision': 0.48387095, 'binary_recall': 0.6923077, 'binary_specificity': 0.96770936, 'binary_f1_score': 0.5696202}
confusion matrix:
      0    1
0  5754  192
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_10.png
early stop counter: 8
val acc:0.9526680707931519, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 10,now: 2024-06-25 15:24:04.947952,epoch time: 0:46:14.027661,used: 7:28:27.680150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9626267, 'precision': 0.96208525, 'recall': 0.9382147, 'specificity': 0.9382147, 'f1': 0.9493636, 'auroc': 0.98894715, 'binary_precision': 0.9610653, 'binary_recall': 0.8886654, 'binary_specificity': 0.98776406, 'binary_f1_score': 0.92344844}
confusion matrix:
       0      1
0  41897    519
1   1605  12811
---- Validation: 
scalar performance:
{'acc': 0.9535219, 'precision': 0.6888573, 'recall': 0.75988454, 'specificity': 0.75988454, 'f1': 0.71786416, 'auroc': 0.8944136, 'binary_precision': 0.39468086, 'binary_recall': 0.551263, 'binary_specificity': 0.9685061, 'binary_f1_score': 0.4600124}
confusion matrix:
       0    1
0  17498  569
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.7415924, 'recall': 0.82717144, 'specificity': 0.82717144, 'f1': 0.7769186, 'auroc': 0.91239184, 'binary_precision': 0.49720672, 'binary_recall': 0.6846154, 'binary_specificity': 0.9697276, 'binary_f1_score': 0.5760518}
confusion matrix:
      0    1
0  5766  180
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_11.png
early stop counter: 9
val acc:0.9535219073295593, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 11,now: 2024-06-25 16:12:30.175168,epoch time: 0:48:25.227216,used: 8:16:52.907366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9618349, 'precision': 0.96269363, 'recall': 0.9355668, 'specificity': 0.9355668, 'f1': 0.94811946, 'auroc': 0.98969686, 'binary_precision': 0.9642965, 'binary_recall': 0.8822387, 'binary_specificity': 0.98889494, 'binary_f1_score': 0.92144436}
confusion matrix:
       0      1
0  41942    471
1   1698  12721
---- Validation: 
scalar performance:
{'acc': 0.9538954, 'precision': 0.68965113, 'recall': 0.7565019, 'specificity': 0.7565019, 'f1': 0.7172845, 'auroc': 0.8945577, 'binary_precision': 0.39653304, 'binary_recall': 0.54383355, 'binary_specificity': 0.96917033, 'binary_f1_score': 0.4586466}
confusion matrix:
       0    1
0  17510  557
1    307  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.742203, 'recall': 0.82541656, 'specificity': 0.82541656, 'f1': 0.77674276, 'auroc': 0.91200143, 'binary_precision': 0.49859154, 'binary_recall': 0.6807692, 'binary_specificity': 0.9700639, 'binary_f1_score': 0.57560974}
confusion matrix:
      0    1
0  5768  178
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_12.png
early stop counter: 10
val acc:0.9538953900337219, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 12,now: 2024-06-25 17:04:03.688016,epoch time: 0:51:33.512848,used: 9:08:26.420214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9624683, 'precision': 0.9615936, 'recall': 0.93828, 'specificity': 0.93828, 'f1': 0.949185, 'auroc': 0.98992205, 'binary_precision': 0.9599431, 'binary_recall': 0.889174, 'binary_specificity': 0.9873859, 'binary_f1_score': 0.92320436}
confusion matrix:
       0      1
0  41878    535
1   1598  12821
---- Validation: 
scalar performance:
{'acc': 0.95218784, 'precision': 0.68588305, 'recall': 0.76992166, 'specificity': 0.76992166, 'f1': 0.7189051, 'auroc': 0.89660907, 'binary_precision': 0.3879397, 'binary_recall': 0.57355124, 'binary_specificity': 0.96629214, 'binary_f1_score': 0.4628297}
confusion matrix:
       0    1
0  17458  609
1    287  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.73859924, 'recall': 0.8341069, 'specificity': 0.8341069, 'f1': 0.77709925, 'auroc': 0.9118236, 'binary_precision': 0.49056605, 'binary_recall': 0.7, 'binary_specificity': 0.9682139, 'binary_f1_score': 0.5768621}
confusion matrix:
      0    1
0  5757  189
1    78  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_13.png
early stop counter: 11
val acc:0.9521878361701965, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 13,now: 2024-06-25 18:50:14.666826,epoch time: 1:46:10.978810,used: 10:54:37.399024,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9649317, 'precision': 0.9623189, 'recall': 0.94416785, 'specificity': 0.94416785, 'f1': 0.95278597, 'auroc': 0.9901669, 'binary_precision': 0.9573121, 'binary_recall': 0.9020111, 'binary_specificity': 0.9863246, 'binary_f1_score': 0.92883915}
confusion matrix:
       0      1
0  41832    580
1   1413  13007
---- Validation: 
scalar performance:
{'acc': 0.9503202, 'precision': 0.6798678, 'recall': 0.7718141, 'specificity': 0.7718141, 'f1': 0.7149228, 'auroc': 0.8964329, 'binary_precision': 0.37572256, 'binary_recall': 0.5794948, 'binary_specificity': 0.9641335, 'binary_f1_score': 0.45587373}
confusion matrix:
       0    1
0  17419  648
1    283  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542378, 'precision': 0.72799575, 'recall': 0.8345164, 'specificity': 0.8345164, 'f1': 0.7694657, 'auroc': 0.91096115, 'binary_precision': 0.46923077, 'binary_recall': 0.70384616, 'binary_specificity': 0.96518666, 'binary_f1_score': 0.5630769}
confusion matrix:
      0    1
0  5739  207
1    77  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_14.png
early stop counter: 12
val acc:0.9503201842308044, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 14,now: 2024-06-25 19:52:09.774450,epoch time: 1:01:55.107624,used: 11:56:32.506648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9646502, 'precision': 0.96303856, 'recall': 0.9426943, 'specificity': 0.9426943, 'f1': 0.9522944, 'auroc': 0.99012667, 'binary_precision': 0.95997036, 'binary_recall': 0.8981205, 'binary_specificity': 0.98726803, 'binary_f1_score': 0.92801607}
confusion matrix:
       0      1
0  41873    540
1   1469  12950
---- Validation: 
scalar performance:
{'acc': 0.95, 'precision': 0.67937565, 'recall': 0.7745092, 'specificity': 0.7745092, 'f1': 0.7153027, 'auroc': 0.89697886, 'binary_precision': 0.3745247, 'binary_recall': 0.5854383, 'binary_specificity': 0.96358, 'binary_f1_score': 0.45681158}
confusion matrix:
       0    1
0  17409  658
1    279  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95343214, 'precision': 0.7251965, 'recall': 0.835935, 'specificity': 0.835935, 'f1': 0.76776826, 'auroc': 0.9096186, 'binary_precision': 0.46347606, 'binary_recall': 0.7076923, 'binary_specificity': 0.9641776, 'binary_f1_score': 0.56012183}
confusion matrix:
      0    1
0  5733  213
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_15.png
early stop counter: 13
val acc:0.949999988079071, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 15,now: 2024-06-25 20:51:13.976537,epoch time: 0:59:04.202087,used: 12:55:36.708735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9659523, 'precision': 0.9638135, 'recall': 0.9454237, 'specificity': 0.9454237, 'f1': 0.9541512, 'auroc': 0.9904598, 'binary_precision': 0.9597172, 'binary_recall': 0.9037448, 'binary_specificity': 0.9871027, 'binary_f1_score': 0.9308904}
confusion matrix:
       0      1
0  41865    547
1   1388  13032
---- Validation: 
scalar performance:
{'acc': 0.95144075, 'precision': 0.6828971, 'recall': 0.7681037, 'specificity': 0.7681037, 'f1': 0.7161351, 'auroc': 0.89647937, 'binary_precision': 0.38208956, 'binary_recall': 0.57057947, 'binary_specificity': 0.96562797, 'binary_f1_score': 0.4576877}
confusion matrix:
       0    1
0  17446  621
1    289  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.7350791, 'recall': 0.8300085, 'specificity': 0.8300085, 'f1': 0.7732651, 'auroc': 0.90933657, 'binary_precision': 0.48387095, 'binary_recall': 0.6923077, 'binary_specificity': 0.96770936, 'binary_f1_score': 0.5696202}
confusion matrix:
      0    1
0  5754  192
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_16.png
early stop counter: 14
val acc:0.9514407515525818, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 16,now: 2024-06-25 21:48:46.655299,epoch time: 0:57:32.678762,used: 13:53:09.387497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9661986, 'precision': 0.9652232, 'recall': 0.9446897, 'specificity': 0.9446897, 'f1': 0.9543774, 'auroc': 0.9913026, 'binary_precision': 0.9633667, 'binary_recall': 0.9010265, 'binary_specificity': 0.9883529, 'binary_f1_score': 0.9311543}
confusion matrix:
       0      1
0  41920    494
1   1427  12991
---- Validation: 
scalar performance:
{'acc': 0.95085377, 'precision': 0.6827016, 'recall': 0.77709776, 'specificity': 0.77709776, 'f1': 0.7186112, 'auroc': 0.89905846, 'binary_precision': 0.38099808, 'binary_recall': 0.58989596, 'binary_specificity': 0.96429956, 'binary_f1_score': 0.46297374}
confusion matrix:
       0    1
0  17422  645
1    276  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9545601, 'precision': 0.72936374, 'recall': 0.8365236, 'specificity': 0.8365236, 'f1': 0.77108914, 'auroc': 0.9095248, 'binary_precision': 0.47179487, 'binary_recall': 0.7076923, 'binary_specificity': 0.96535486, 'binary_f1_score': 0.5661538}
confusion matrix:
      0    1
0  5740  206
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_17.png
early stop counter: 15
val acc:0.9508537650108337, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 17,now: 2024-06-25 22:34:09.048674,epoch time: 0:45:22.393375,used: 14:38:31.780872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9645974, 'precision': 0.9638238, 'recall': 0.9417857, 'specificity': 0.9417857, 'f1': 0.9521363, 'auroc': 0.99121976, 'binary_precision': 0.96235836, 'binary_recall': 0.8954779, 'binary_specificity': 0.98809355, 'binary_f1_score': 0.9277143}
confusion matrix:
       0      1
0  41909    505
1   1507  12911
---- Validation: 
scalar performance:
{'acc': 0.95176095, 'precision': 0.68419, 'recall': 0.76898503, 'specificity': 0.76898503, 'f1': 0.71736443, 'auroc': 0.8973142, 'binary_precision': 0.3846154, 'binary_recall': 0.57206535, 'binary_specificity': 0.9659047, 'binary_f1_score': 0.45997608}
confusion matrix:
       0    1
0  17451  616
1    288  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.7384903, 'recall': 0.832268, 'specificity': 0.832268, 'f1': 0.7764284, 'auroc': 0.90780616, 'binary_precision': 0.4905149, 'binary_recall': 0.6961538, 'binary_specificity': 0.9683821, 'binary_f1_score': 0.57551664}
confusion matrix:
      0    1
0  5758  188
1    79  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_18.png
early stop counter: 16
val acc:0.9517609477043152, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 18,now: 2024-06-25 23:21:15.728784,epoch time: 0:47:06.680110,used: 15:25:38.460982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.964615, 'precision': 0.9642675, 'recall': 0.9414154, 'specificity': 0.9414154, 'f1': 0.952124, 'auroc': 0.99071074, 'binary_precision': 0.96361053, 'binary_recall': 0.89431345, 'binary_specificity': 0.9885174, 'binary_f1_score': 0.92766964}
confusion matrix:
       0      1
0  41925    487
1   1524  12896
---- Validation: 
scalar performance:
{'acc': 0.95314837, 'precision': 0.6891948, 'recall': 0.7689893, 'specificity': 0.7689893, 'f1': 0.7210419, 'auroc': 0.89736086, 'binary_precision': 0.3946557, 'binary_recall': 0.57057947, 'binary_specificity': 0.9673991, 'binary_f1_score': 0.46658567}
confusion matrix:
       0    1
0  17478  589
1    289  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7459714, 'recall': 0.831354, 'specificity': 0.831354, 'f1': 0.7813567, 'auroc': 0.9069724, 'binary_precision': 0.505618, 'binary_recall': 0.6923077, 'binary_specificity': 0.9704003, 'binary_f1_score': 0.5844156}
confusion matrix:
      0    1
0  5770  176
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_19.png
early stop counter: 17
val acc:0.953148365020752, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 19,now: 2024-06-26 00:03:38.182279,epoch time: 0:42:22.453495,used: 16:08:00.914477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9680638, 'precision': 0.9669493, 'recall': 0.94797957, 'specificity': 0.94797957, 'f1': 0.95697176, 'auroc': 0.9920479, 'binary_precision': 0.9648178, 'binary_recall': 0.90720576, 'binary_specificity': 0.98875344, 'binary_f1_score': 0.9351253}
confusion matrix:
       0      1
0  41936    477
1   1338  13081
---- Validation: 
scalar performance:
{'acc': 0.9539488, 'precision': 0.691765, 'recall': 0.7665434, 'specificity': 0.7665434, 'f1': 0.7221004, 'auroc': 0.898015, 'binary_precision': 0.4, 'binary_recall': 0.56463593, 'binary_specificity': 0.9684508, 'binary_f1_score': 0.46826863}
confusion matrix:
       0    1
0  17497  570
1    293  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.75556827, 'recall': 0.8324472, 'specificity': 0.8324472, 'f1': 0.78821874, 'auroc': 0.906848, 'binary_precision': 0.52478135, 'binary_recall': 0.6923077, 'binary_specificity': 0.97258663, 'binary_f1_score': 0.5970149}
confusion matrix:
      0    1
0  5783  163
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_20.png
early stop counter: 18
val acc:0.9539487957954407, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 20,now: 2024-06-26 00:49:42.054634,epoch time: 0:46:03.872355,used: 16:54:04.786832,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9666385, 'precision': 0.96672726, 'recall': 0.9444189, 'specificity': 0.9444189, 'f1': 0.95489365, 'auroc': 0.9913146, 'binary_precision': 0.96689534, 'binary_recall': 0.89930654, 'binary_specificity': 0.9895313, 'binary_f1_score': 0.931877}
confusion matrix:
       0      1
0  41968    444
1   1452  12968
---- Validation: 
scalar performance:
{'acc': 0.9534685, 'precision': 0.68892515, 'recall': 0.7612874, 'specificity': 0.7612874, 'f1': 0.7183738, 'auroc': 0.8981447, 'binary_precision': 0.394709, 'binary_recall': 0.55423474, 'binary_specificity': 0.96834004, 'binary_f1_score': 0.46106303}
confusion matrix:
       0    1
0  17495  572
1    300  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.7532897, 'recall': 0.8321949, 'specificity': 0.8321949, 'f1': 0.7866112, 'auroc': 0.90714574, 'binary_precision': 0.5202312, 'binary_recall': 0.6923077, 'binary_specificity': 0.9720821, 'binary_f1_score': 0.59405935}
confusion matrix:
      0    1
0  5780  166
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_21.png
early stop counter: 19
val acc:0.9534685015678406, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 21,now: 2024-06-26 01:31:18.253068,epoch time: 0:41:36.198434,used: 17:35:40.985266,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96758866, 'precision': 0.96799636, 'recall': 0.9457191, 'specificity': 0.9457191, 'f1': 0.9561826, 'auroc': 0.99173725, 'binary_precision': 0.96876866, 'binary_recall': 0.9013176, 'binary_specificity': 0.9901207, 'binary_f1_score': 0.93382674}
confusion matrix:
       0      1
0  41993    419
1   1423  12997
---- Validation: 
scalar performance:
{'acc': 0.9555496, 'precision': 0.6964287, 'recall': 0.7566446, 'specificity': 0.7566446, 'f1': 0.7219291, 'auroc': 0.8978236, 'binary_precision': 0.41011235, 'binary_recall': 0.54234767, 'binary_specificity': 0.9709415, 'binary_f1_score': 0.46705052}
confusion matrix:
       0    1
0  17542  525
1    308  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.7603078, 'recall': 0.8274347, 'specificity': 0.8274347, 'f1': 0.7894678, 'auroc': 0.90545017, 'binary_precision': 0.5347432, 'binary_recall': 0.6807692, 'binary_specificity': 0.97410023, 'binary_f1_score': 0.5989848}
confusion matrix:
      0    1
0  5792  154
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_22.png
early stop counter: 20
val acc:0.9555495977401733, best validation acc: 0.9590181708335876, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 22,now: 2024-06-26 02:12:31.128113,epoch time: 0:41:12.875045,used: 18:16:53.860311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_07_55_37_seed_1_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 22 with time: 18:16:53.860311 at 2024-06-26 02:12:31.128113
persisted model performance metric: 

scalar performance:
{'acc': 0.96374476, 'precision': 0.7744652, 'recall': 0.77143526, 'specificity': 0.77143526, 'f1': 0.7729407, 'auroc': 0.9114033, 'binary_precision': 0.56809336, 'binary_recall': 0.56153846, 'binary_specificity': 0.981332, 'binary_f1_score': 0.5647969}
confusion matrix:
      0    1
0  5835  111
1   114  146
oracle model performance metric: 

scalar performance:
{'acc': 0.96374476, 'precision': 0.7744652, 'recall': 0.77143526, 'specificity': 0.77143526, 'f1': 0.7729407, 'auroc': 0.9114033, 'binary_precision': 0.56809336, 'binary_recall': 0.56153846, 'binary_specificity': 0.981332, 'binary_f1_score': 0.5647969}
confusion matrix:
      0    1
0  5835  111
1   114  146
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190919 KiB |   2147 MiB |   3325 TiB |   3325 TiB |
|       from large pool | 173454 KiB |   2130 MiB |   3276 TiB |   3276 TiB |
|       from small pool |  17465 KiB |     37 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190919 KiB |   2147 MiB |   3325 TiB |   3325 TiB |
|       from large pool | 173454 KiB |   2130 MiB |   3276 TiB |   3276 TiB |
|       from small pool |  17465 KiB |     37 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189280 KiB |   2146 MiB |   3325 TiB |   3325 TiB |
|       from large pool | 172814 KiB |   2128 MiB |   3276 TiB |   3276 TiB |
|       from small pool |  16466 KiB |     36 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2368 MiB |   2392 MiB |   4512 MiB |   2144 MiB |
|       from large pool |   2330 MiB |   2350 MiB |   4460 MiB |   2130 MiB |
|       from small pool |     38 MiB |     42 MiB |     52 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40504 KiB | 235139 KiB |   1819 TiB |   1819 TiB |
|       from large pool |  31346 KiB | 232732 KiB |   1770 TiB |   1770 TiB |
|       from small pool |   9158 KiB |  18293 KiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2942    |    7593    |  494980 K  |  494977 K  |
|       from large pool |      76    |     251    |  314958 K  |  314958 K  |
|       from small pool |    2866    |    7516    |  180021 K  |  180018 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2942    |    7593    |  494980 K  |  494977 K  |
|       from large pool |      76    |     251    |  314958 K  |  314958 K  |
|       from small pool |    2866    |    7516    |  180021 K  |  180018 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     119    |     210    |      94    |
|       from large pool |      97    |      98    |     184    |      87    |
|       from small pool |      19    |      21    |      26    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3586    |  325346 K  |  325346 K  |
|       from large pool |      10    |     100    |  233382 K  |  233382 K  |
|       from small pool |      21    |    3575    |   91964 K  |   91964 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2147 MiB |   3325 TiB |   3325 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   3276 TiB |   3276 TiB |
|       from small pool |      0 KiB |     37 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2147 MiB |   3325 TiB |   3325 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   3276 TiB |   3276 TiB |
|       from small pool |      0 KiB |     37 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2146 MiB |   3325 TiB |   3325 TiB |
|       from large pool |  16640 KiB |   2128 MiB |   3276 TiB |   3276 TiB |
|       from small pool |      0 KiB |     36 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB |   2392 MiB |   4512 MiB |   4286 MiB |
|       from large pool | 204800 KiB |   2350 MiB |   4460 MiB |   4260 MiB |
|       from small pool |  26624 KiB |     42 MiB |     52 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 235139 KiB |   1819 TiB |   1819 TiB |
|       from large pool |  24320 KiB | 232732 KiB |   1770 TiB |   1770 TiB |
|       from small pool |      0 KiB |  21236 KiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7593    |  494980 K  |  494980 K  |
|       from large pool |       2    |     251    |  314958 K  |  314958 K  |
|       from small pool |       0    |    7516    |  180021 K  |  180021 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7593    |  494980 K  |  494980 K  |
|       from large pool |       2    |     251    |  314958 K  |  314958 K  |
|       from small pool |       0    |    7516    |  180021 K  |  180021 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     119    |     210    |     187    |
|       from large pool |      10    |      98    |     184    |     174    |
|       from small pool |      13    |      21    |      26    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3586    |  325348 K  |  325348 K  |
|       from large pool |       4    |     100    |  233382 K  |  233382 K  |
|       from small pool |       0    |    3575    |   91965 K  |   91965 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2147 MiB |   3325 TiB |   3325 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   3276 TiB |   3276 TiB |
|       from small pool |      0 KiB |     37 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2147 MiB |   3325 TiB |   3325 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   3276 TiB |   3276 TiB |
|       from small pool |      0 KiB |     37 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2146 MiB |   3325 TiB |   3325 TiB |
|       from large pool |  16640 KiB |   2128 MiB |   3276 TiB |   3276 TiB |
|       from small pool |      0 KiB |     36 MiB |     48 TiB |     48 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB |   2392 MiB |   4512 MiB |   4286 MiB |
|       from large pool | 204800 KiB |   2350 MiB |   4460 MiB |   4260 MiB |
|       from small pool |  26624 KiB |     42 MiB |     52 MiB |     26 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 235139 KiB |   1819 TiB |   1819 TiB |
|       from large pool |  24320 KiB | 232732 KiB |   1770 TiB |   1770 TiB |
|       from small pool |      0 KiB |  21236 KiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7593    |  494980 K  |  494980 K  |
|       from large pool |       2    |     251    |  314958 K  |  314958 K  |
|       from small pool |       0    |    7516    |  180021 K  |  180021 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7593    |  494980 K  |  494980 K  |
|       from large pool |       2    |     251    |  314958 K  |  314958 K  |
|       from small pool |       0    |    7516    |  180021 K  |  180021 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     119    |     210    |     187    |
|       from large pool |      10    |      98    |     184    |     174    |
|       from small pool |      13    |      21    |      26    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3586    |  325348 K  |  325348 K  |
|       from large pool |       4    |     100    |  233382 K  |  233382 K  |
|       from small pool |       0    |    3575    |   91965 K  |   91965 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219

 Experiment start at: 2024-06-26 02:19:37.065854
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9259575, 'precision': 0.92918664, 'recall': 0.8767321, 'specificity': 0.8767321, 'f1': 0.89867663, 'auroc': 0.964002, 'binary_precision': 0.93490607, 'binary_recall': 0.77270323, 'binary_specificity': 0.98076105, 'binary_f1_score': 0.846101}
confusion matrix:
       0      1
0  41496    814
1   3439  11691
---- Validation: 
scalar performance:
{'acc': 0.94902253, 'precision': 0.6505569, 'recall': 0.73837364, 'specificity': 0.73837364, 'f1': 0.6828881, 'auroc': 0.8645681, 'binary_precision': 0.3175745, 'binary_recall': 0.51328903, 'binary_specificity': 0.96345824, 'binary_f1_score': 0.39238095}
confusion matrix:
       0    1
0  17507  664
1    293  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9309184, 'precision': 0.62632084, 'recall': 0.71225727, 'specificity': 0.71225727, 'f1': 0.65574235, 'auroc': 0.8561939, 'binary_precision': 0.274463, 'binary_recall': 0.4752066, 'binary_specificity': 0.949308, 'binary_f1_score': 0.34795764}
confusion matrix:
      0    1
0  5693  304
1   127  115
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-26 03:01:58.045080,epoch time: 0:42:20.979226,used: 0:42:20.979226,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93950206, 'precision': 0.9417597, 'recall': 0.9001711, 'specificity': 0.9001711, 'f1': 0.91833955, 'auroc': 0.97678834, 'binary_precision': 0.9459025, 'binary_recall': 0.8170522, 'binary_specificity': 0.98329, 'binary_f1_score': 0.87676865}
confusion matrix:
       0      1
0  41603    707
1   2768  12362
---- Validation: 
scalar performance:
{'acc': 0.95493525, 'precision': 0.6712458, 'recall': 0.742231, 'specificity': 0.742231, 'f1': 0.69973576, 'auroc': 0.87905645, 'binary_precision': 0.3587963, 'binary_recall': 0.51495016, 'binary_specificity': 0.96951187, 'binary_f1_score': 0.4229195}
confusion matrix:
       0    1
0  17617  554
1    292  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95287704, 'precision': 0.701244, 'recall': 0.76729995, 'specificity': 0.76729995, 'f1': 0.7288546, 'auroc': 0.88762283, 'binary_precision': 0.4202454, 'binary_recall': 0.5661157, 'binary_specificity': 0.9684842, 'binary_f1_score': 0.48239437}
confusion matrix:
      0    1
0  5808  189
1   105  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-26 03:44:05.090744,epoch time: 0:42:07.045664,used: 1:24:28.024890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94825906, 'precision': 0.94784236, 'recall': 0.9170697, 'specificity': 0.9170697, 'f1': 0.93102485, 'auroc': 0.98074603, 'binary_precision': 0.94705105, 'binary_recall': 0.85115665, 'binary_specificity': 0.98298275, 'binary_f1_score': 0.8965469}
confusion matrix:
       0      1
0  41590    720
1   2252  12878
---- Validation: 
scalar performance:
{'acc': 0.95232517, 'precision': 0.66680896, 'recall': 0.762565, 'specificity': 0.762565, 'f1': 0.702348, 'auroc': 0.8858315, 'binary_precision': 0.34850052, 'binary_recall': 0.5598007, 'binary_specificity': 0.96532935, 'binary_f1_score': 0.42957297}
confusion matrix:
       0    1
0  17541  630
1    265  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94967145, 'precision': 0.69642997, 'recall': 0.80727005, 'specificity': 0.80727005, 'f1': 0.7375425, 'auroc': 0.8970498, 'binary_precision': 0.4072165, 'binary_recall': 0.6528926, 'binary_specificity': 0.9616475, 'binary_f1_score': 0.5015873}
confusion matrix:
      0    1
0  5767  230
1    84  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_3.png
early stop counter: 1
val acc:0.952325165271759, best validation acc: 0.9549352526664734, corresponding to test acc:                         0.9528770446777344 / 0.9528770446777344
after epoch: 3,now: 2024-06-26 04:26:26.535902,epoch time: 0:42:21.445158,used: 2:06:49.470048,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95080084, 'precision': 0.95099247, 'recall': 0.92068446, 'specificity': 0.92068446, 'f1': 0.9344619, 'auroc': 0.98286223, 'binary_precision': 0.9513573, 'binary_recall': 0.857039, 'binary_specificity': 0.98432994, 'binary_f1_score': 0.90173846}
confusion matrix:
       0      1
0  41647    663
1   2163  12967
---- Validation: 
scalar performance:
{'acc': 0.9519523, 'precision': 0.6659232, 'recall': 0.7639785, 'specificity': 0.7639785, 'f1': 0.70201737, 'auroc': 0.888705, 'binary_precision': 0.34662578, 'binary_recall': 0.5631229, 'binary_specificity': 0.9648341, 'binary_f1_score': 0.42911392}
confusion matrix:
       0    1
0  17532  639
1    263  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495111, 'precision': 0.69718325, 'recall': 0.8151176, 'specificity': 0.8151176, 'f1': 0.7402177, 'auroc': 0.89997894, 'binary_precision': 0.40806046, 'binary_recall': 0.6694215, 'binary_specificity': 0.96081376, 'binary_f1_score': 0.5070423}
confusion matrix:
      0    1
0  5762  235
1    80  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_4.png
early stop counter: 2
val acc:0.9519522786140442, best validation acc: 0.9549352526664734, corresponding to test acc:                         0.9528770446777344 / 0.9528770446777344
after epoch: 4,now: 2024-06-26 05:09:32.144185,epoch time: 0:43:05.608283,used: 2:49:55.078331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95376045, 'precision': 0.95393085, 'recall': 0.92555517, 'specificity': 0.92555517, 'f1': 0.9385436, 'auroc': 0.98529553, 'binary_precision': 0.9542574, 'binary_recall': 0.8659528, 'binary_specificity': 0.98515755, 'binary_f1_score': 0.9079631}
confusion matrix:
       0      1
0  41683    628
1   2028  13101
---- Validation: 
scalar performance:
{'acc': 0.9522186, 'precision': 0.66808194, 'recall': 0.7697374, 'specificity': 0.7697374, 'f1': 0.70527375, 'auroc': 0.89212894, 'binary_precision': 0.35055724, 'binary_recall': 0.57475084, 'binary_specificity': 0.964724, 'binary_f1_score': 0.435494}
confusion matrix:
       0    1
0  17530  641
1    256  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9512742, 'precision': 0.7038746, 'recall': 0.821983, 'specificity': 0.821983, 'f1': 0.7474189, 'auroc': 0.90307343, 'binary_precision': 0.42091838, 'binary_recall': 0.6818182, 'binary_specificity': 0.9621477, 'binary_f1_score': 0.5205047}
confusion matrix:
      0    1
0  5770  227
1    77  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_5.png
early stop counter: 3
val acc:0.9522185921669006, best validation acc: 0.9549352526664734, corresponding to test acc:                         0.9528770446777344 / 0.9528770446777344
after epoch: 5,now: 2024-06-26 05:54:12.819119,epoch time: 0:44:40.674934,used: 3:34:35.753265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95708567, 'precision': 0.95620567, 'recall': 0.9319987, 'specificity': 0.9319987, 'f1': 0.94323015, 'auroc': 0.9865736, 'binary_precision': 0.9544965, 'binary_recall': 0.8789821, 'binary_specificity': 0.9850154, 'binary_f1_score': 0.9151842}
confusion matrix:
       0      1
0  41676    634
1   1831  13299
---- Validation: 
scalar performance:
{'acc': 0.9550418, 'precision': 0.676703, 'recall': 0.7647714, 'specificity': 0.7647714, 'f1': 0.7106546, 'auroc': 0.89314747, 'binary_precision': 0.36819172, 'binary_recall': 0.5614618, 'binary_specificity': 0.968081, 'binary_f1_score': 0.44473684}
confusion matrix:
       0    1
0  17591  580
1    264  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9578458, 'precision': 0.7276526, 'recall': 0.8154876, 'specificity': 0.8154876, 'f1': 0.76338744, 'auroc': 0.9045735, 'binary_precision': 0.4692082, 'binary_recall': 0.661157, 'binary_specificity': 0.96981823, 'binary_f1_score': 0.54888505}
confusion matrix:
      0    1
0  5816  181
1    82  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-26 06:37:01.788852,epoch time: 0:42:48.969733,used: 4:17:24.722998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9571205, 'precision': 0.95759773, 'recall': 0.93076986, 'specificity': 0.93076986, 'f1': 0.9431206, 'auroc': 0.98635185, 'binary_precision': 0.9585173, 'binary_recall': 0.8750826, 'binary_specificity': 0.9864571, 'binary_f1_score': 0.9149017}
confusion matrix:
       0      1
0  41737    573
1   1890  13240
---- Validation: 
scalar performance:
{'acc': 0.95546794, 'precision': 0.6786604, 'recall': 0.7665976, 'specificity': 0.7665976, 'f1': 0.71267295, 'auroc': 0.8943199, 'binary_precision': 0.37199125, 'binary_recall': 0.56478405, 'binary_specificity': 0.9684112, 'binary_f1_score': 0.4485488}
confusion matrix:
       0    1
0  17597  574
1    262  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9578458, 'precision': 0.72799605, 'recall': 0.8194531, 'specificity': 0.8194531, 'f1': 0.7649208, 'auroc': 0.90617347, 'binary_precision': 0.4695652, 'binary_recall': 0.6694215, 'binary_specificity': 0.96948475, 'binary_f1_score': 0.5519591}
confusion matrix:
      0    1
0  5814  183
1    80  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_7.png
better model found
persisted
after epoch: 7,now: 2024-06-26 07:18:42.950657,epoch time: 0:41:41.161805,used: 4:59:05.884803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9562152, 'precision': 0.95789605, 'recall': 0.9281769, 'specificity': 0.9281769, 'f1': 0.9417378, 'auroc': 0.9866935, 'binary_precision': 0.9611054, 'binary_recall': 0.86892724, 'binary_specificity': 0.98742646, 'binary_f1_score': 0.9126949}
confusion matrix:
       0      1
0  41779    532
1   1983  13146
---- Validation: 
scalar performance:
{'acc': 0.9570127, 'precision': 0.6839696, 'recall': 0.76338035, 'specificity': 0.76338035, 'f1': 0.7156242, 'auroc': 0.89482, 'binary_precision': 0.38285714, 'binary_recall': 0.5564784, 'binary_specificity': 0.9702823, 'binary_f1_score': 0.4536222}
confusion matrix:
       0    1
0  17631  540
1    267  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.7379425, 'recall': 0.82062036, 'specificity': 0.82062036, 'f1': 0.7722647, 'auroc': 0.90589917, 'binary_precision': 0.489426, 'binary_recall': 0.6694215, 'binary_specificity': 0.9718192, 'binary_f1_score': 0.56544507}
confusion matrix:
      0    1
0  5828  169
1    80  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-26 08:00:27.716988,epoch time: 0:41:44.766331,used: 5:40:50.651134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.958757, 'precision': 0.9588822, 'recall': 0.93376637, 'specificity': 0.93376637, 'f1': 0.9453938, 'auroc': 0.98841745, 'binary_precision': 0.9591249, 'binary_recall': 0.8809571, 'binary_specificity': 0.9865756, 'binary_f1_score': 0.91838074}
confusion matrix:
       0      1
0  41743    568
1   1801  13328
---- Validation: 
scalar performance:
{'acc': 0.9575454, 'precision': 0.68523157, 'recall': 0.7588372, 'specificity': 0.7588372, 'f1': 0.7150753, 'auroc': 0.8952532, 'binary_precision': 0.38569754, 'binary_recall': 0.54651165, 'binary_specificity': 0.97116286, 'binary_f1_score': 0.4522337}
confusion matrix:
       0    1
0  17647  524
1    273  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.7503542, 'recall': 0.8199717, 'specificity': 0.8199717, 'f1': 0.7803191, 'auroc': 0.9063747, 'binary_precision': 0.514377, 'binary_recall': 0.6652893, 'binary_specificity': 0.974654, 'binary_f1_score': 0.5801802}
confusion matrix:
      0    1
0  5845  152
1    81  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-26 08:43:00.281341,epoch time: 0:42:32.564353,used: 6:23:23.215487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9620125, 'precision': 0.96161795, 'recall': 0.93956435, 'specificity': 0.93956435, 'f1': 0.9498763, 'auroc': 0.98920447, 'binary_precision': 0.9608457, 'binary_recall': 0.8921277, 'binary_specificity': 0.987001, 'binary_f1_score': 0.92521244}
confusion matrix:
       0      1
0  41761    550
1   1632  13497
---- Validation: 
scalar performance:
{'acc': 0.95429605, 'precision': 0.6759825, 'recall': 0.7740227, 'specificity': 0.7740227, 'f1': 0.71272635, 'auroc': 0.8966272, 'binary_precision': 0.36610878, 'binary_recall': 0.5813953, 'binary_specificity': 0.9666501, 'binary_f1_score': 0.44929397}
confusion matrix:
       0    1
0  17565  606
1    252  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572047, 'precision': 0.7254852, 'recall': 0.8211024, 'specificity': 0.8211024, 'f1': 0.76364094, 'auroc': 0.90648496, 'binary_precision': 0.46438748, 'binary_recall': 0.6735537, 'binary_specificity': 0.968651, 'binary_f1_score': 0.5497471}
confusion matrix:
      0    1
0  5809  188
1    79  163
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_10.png
early stop counter: 1
val acc:0.9542960524559021, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9626542925834656 / 0.9626542925834656
after epoch: 10,now: 2024-06-26 09:30:12.859430,epoch time: 0:47:12.578089,used: 7:10:35.793576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9632834, 'precision': 0.96125436, 'recall': 0.9432328, 'specificity': 0.9432328, 'f1': 0.95176303, 'auroc': 0.9895918, 'binary_precision': 0.95723015, 'binary_recall': 0.90085924, 'binary_specificity': 0.98560625, 'binary_f1_score': 0.9281896}
confusion matrix:
       0      1
0  41701    609
1   1500  13630
---- Validation: 
scalar performance:
{'acc': 0.95466894, 'precision': 0.67799294, 'recall': 0.77742755, 'specificity': 0.77742755, 'f1': 0.7152449, 'auroc': 0.89700294, 'binary_precision': 0.36990595, 'binary_recall': 0.5880399, 'binary_specificity': 0.96681523, 'binary_f1_score': 0.45413727}
confusion matrix:
       0    1
0  17568  603
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584869, 'precision': 0.73121786, 'recall': 0.82573485, 'specificity': 0.82573485, 'f1': 0.76924336, 'auroc': 0.90696454, 'binary_precision': 0.4755043, 'binary_recall': 0.6818182, 'binary_specificity': 0.9696515, 'binary_f1_score': 0.5602716}
confusion matrix:
      0    1
0  5815  182
1    77  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_11.png
early stop counter: 2
val acc:0.9546689391136169, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9626542925834656 / 0.9626542925834656
after epoch: 11,now: 2024-06-26 10:21:18.773646,epoch time: 0:51:05.914216,used: 8:01:41.707792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9645195, 'precision': 0.96262145, 'recall': 0.945109, 'specificity': 0.945109, 'f1': 0.95341295, 'auroc': 0.9904305, 'binary_precision': 0.9588503, 'binary_recall': 0.9040915, 'binary_specificity': 0.98612654, 'binary_f1_score': 0.93066615}
confusion matrix:
       0      1
0  41724    587
1   1451  13678
---- Validation: 
scalar performance:
{'acc': 0.95461565, 'precision': 0.67779946, 'recall': 0.7774, 'specificity': 0.7774, 'f1': 0.71508515, 'auroc': 0.8988864, 'binary_precision': 0.36951983, 'binary_recall': 0.5880399, 'binary_specificity': 0.9667602, 'binary_f1_score': 0.45384616}
confusion matrix:
       0    1
0  17567  604
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.73426944, 'recall': 0.83003384, 'specificity': 0.83003384, 'f1': 0.77280724, 'auroc': 0.9073233, 'binary_precision': 0.48126802, 'binary_recall': 0.69008267, 'binary_specificity': 0.969985, 'binary_f1_score': 0.56706285}
confusion matrix:
      0    1
0  5817  180
1    75  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_12.png
early stop counter: 3
val acc:0.9546156525611877, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9626542925834656 / 0.9626542925834656
after epoch: 12,now: 2024-06-26 11:17:40.570560,epoch time: 0:56:21.796914,used: 8:58:03.504706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9643628, 'precision': 0.9615972, 'recall': 0.94572455, 'specificity': 0.94572455, 'f1': 0.9532874, 'auroc': 0.9900167, 'binary_precision': 0.95607305, 'binary_recall': 0.9063388, 'binary_specificity': 0.9851103, 'binary_f1_score': 0.9305419}
confusion matrix:
       0      1
0  41681    630
1   1417  13712
---- Validation: 
scalar performance:
{'acc': 0.95285785, 'precision': 0.6736507, 'recall': 0.7861286, 'specificity': 0.7861286, 'f1': 0.71402913, 'auroc': 0.89832985, 'binary_precision': 0.36059114, 'binary_recall': 0.6079734, 'binary_specificity': 0.96428376, 'binary_f1_score': 0.45269018}
confusion matrix:
       0    1
0  17522  649
1    236  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549607, 'precision': 0.71813107, 'recall': 0.83381426, 'specificity': 0.83381426, 'f1': 0.7619025, 'auroc': 0.9065793, 'binary_precision': 0.44854882, 'binary_recall': 0.70247936, 'binary_specificity': 0.9651492, 'binary_f1_score': 0.54750407}
confusion matrix:
      0    1
0  5788  209
1    72  170
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_13.png
early stop counter: 4
val acc:0.9528578519821167, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9626542925834656 / 0.9626542925834656
after epoch: 13,now: 2024-06-26 12:11:52.838173,epoch time: 0:54:12.267613,used: 9:52:15.772319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9634749, 'precision': 0.9632186, 'recall': 0.94180965, 'specificity': 0.94180965, 'f1': 0.95184296, 'auroc': 0.99048364, 'binary_precision': 0.96271574, 'binary_recall': 0.8960275, 'binary_specificity': 0.98759186, 'binary_f1_score': 0.9281753}
confusion matrix:
       0      1
0  41786    525
1   1573  13556
---- Validation: 
scalar performance:
{'acc': 0.9561604, 'precision': 0.68311, 'recall': 0.7757889, 'specificity': 0.7757889, 'f1': 0.71874005, 'auroc': 0.8981992, 'binary_precision': 0.3802817, 'binary_recall': 0.58305645, 'binary_specificity': 0.9685213, 'binary_f1_score': 0.46032786}
confusion matrix:
       0    1
0  17599  572
1    251  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.73868525, 'recall': 0.82070374, 'specificity': 0.82070374, 'f1': 0.7728019, 'auroc': 0.9063988, 'binary_precision': 0.4909091, 'binary_recall': 0.6694215, 'binary_specificity': 0.971986, 'binary_f1_score': 0.5664336}
confusion matrix:
      0    1
0  5829  168
1    80  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_14.png
early stop counter: 5
val acc:0.9561604261398315, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9626542925834656 / 0.9626542925834656
after epoch: 14,now: 2024-06-26 13:04:35.288837,epoch time: 0:52:42.450664,used: 10:44:58.222983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96333563, 'precision': 0.96305346, 'recall': 0.9416123, 'specificity': 0.9416123, 'f1': 0.9516593, 'auroc': 0.99110246, 'binary_precision': 0.9625, 'binary_recall': 0.8957039, 'binary_specificity': 0.9875207, 'binary_f1_score': 0.9279014}
confusion matrix:
       0      1
0  41782    528
1   1578  13552
---- Validation: 
scalar performance:
{'acc': 0.955681, 'precision': 0.6794796, 'recall': 0.76670766, 'specificity': 0.76670766, 'f1': 0.71332306, 'auroc': 0.8978745, 'binary_precision': 0.37362638, 'binary_recall': 0.56478405, 'binary_specificity': 0.9686313, 'binary_f1_score': 0.44973546}
confusion matrix:
       0    1
0  17601  570
1    262  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.73868525, 'recall': 0.82070374, 'specificity': 0.82070374, 'f1': 0.7728019, 'auroc': 0.9061781, 'binary_precision': 0.4909091, 'binary_recall': 0.6694215, 'binary_specificity': 0.971986, 'binary_f1_score': 0.5664336}
confusion matrix:
      0    1
0  5829  168
1    80  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556219_15.png
early stop counter: 6
val acc:0.9556810259819031, best validation acc: 0.9575453996658325, corresponding to test acc:                         0.9626542925834656 / 0.9626542925834656
after epoch: 15,now: 2024-06-26 13:51:19.907559,epoch time: 0:46:44.618722,used: 11:31:42.841705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_02_19_37_seed_2_21556219
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
slurmstepd: error: *** JOB 21556219 ON gpusrv45 CANCELLED AT 2024-06-26T14:31:01 DUE TO TIME LIMIT ***
