Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jun 25 04:58:02 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223

 Experiment start at: 2024-06-25 05:08:02.837291
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.86297333, 'precision': 0.86829185, 'recall': 0.75960076, 'specificity': 0.75960076, 'f1': 0.79306066, 'auroc': 0.9181882, 'binary_precision': 0.8761313, 'binary_recall': 0.5460414, 'binary_specificity': 0.9731601, 'binary_f1_score': 0.67277896}
confusion matrix:
       0     1
0  41189  1136
1   6680  8035
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9441784, 'precision': 0.61539143, 'recall': 0.6470765, 'specificity': 0.6470765, 'f1': 0.62891597, 'auroc': 0.82448673, 'binary_precision': 0.25483093, 'binary_recall': 0.3281493, 'binary_specificity': 0.96600366, 'binary_f1_score': 0.2868797}
confusion matrix:
       0    1
0  17532  617
1    432  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9394375, 'precision': 0.60708237, 'recall': 0.5964371, 'specificity': 0.5964371, 'f1': 0.60140765, 'auroc': 0.8307078, 'binary_precision': 0.24786325, 'binary_recall': 0.22222222, 'binary_specificity': 0.970652, 'binary_f1_score': 0.23434344}
confusion matrix:
      0    1
0  5821  176
1   203   58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-25 05:28:22.807545,epoch time: 0:20:19.970254,used: 0:20:19.970254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9086606, 'precision': 0.9021655, 'recall': 0.8523663, 'specificity': 0.8523663, 'f1': 0.8731813, 'auroc': 0.9525198, 'binary_precision': 0.89084476, 'binary_recall': 0.73608375, 'binary_specificity': 0.96864885, 'binary_f1_score': 0.8061034}
confusion matrix:
       0      1
0  41000   1327
1   3883  10830
---- Validation: 
scalar performance:
{'acc': 0.94944656, 'precision': 0.65361476, 'recall': 0.7090583, 'specificity': 0.7090583, 'f1': 0.67636776, 'auroc': 0.84814477, 'binary_precision': 0.32694477, 'binary_recall': 0.45101088, 'binary_specificity': 0.9671056, 'binary_f1_score': 0.37908497}
confusion matrix:
       0    1
0  17552  597
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94614893, 'precision': 0.672631, 'recall': 0.69338787, 'specificity': 0.69338787, 'f1': 0.682309, 'auroc': 0.8739306, 'binary_precision': 0.3707483, 'binary_recall': 0.41762453, 'binary_specificity': 0.96915126, 'binary_f1_score': 0.3927928}
confusion matrix:
      0    1
0  5812  185
1   152  109
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-25 05:48:03.154674,epoch time: 0:19:40.347129,used: 0:40:00.317383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92452663, 'precision': 0.9214852, 'recall': 0.87699455, 'specificity': 0.87699455, 'f1': 0.896154, 'auroc': 0.9608611, 'binary_precision': 0.9160671, 'binary_recall': 0.77879715, 'binary_specificity': 0.97519195, 'binary_f1_score': 0.8418733}
confusion matrix:
       0      1
0  41275   1050
1   3255  11460
---- Validation: 
scalar performance:
{'acc': 0.95508724, 'precision': 0.6754753, 'recall': 0.7104784, 'specificity': 0.7104784, 'f1': 0.69114786, 'auroc': 0.8590865, 'binary_precision': 0.37065637, 'binary_recall': 0.44790047, 'binary_specificity': 0.9730564, 'binary_f1_score': 0.4056338}
confusion matrix:
       0    1
0  17660  489
1    355  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.72165084, 'recall': 0.72570866, 'specificity': 0.72570866, 'f1': 0.72365844, 'auroc': 0.89068544, 'binary_precision': 0.46616542, 'binary_recall': 0.47509578, 'binary_specificity': 0.9763215, 'binary_f1_score': 0.47058827}
confusion matrix:
      0    1
0  5855  142
1   137  124
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-25 06:07:30.380688,epoch time: 0:19:27.226014,used: 0:59:27.543397,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9315568, 'precision': 0.9266006, 'recall': 0.8910316, 'specificity': 0.8910316, 'f1': 0.9068551, 'auroc': 0.96638894, 'binary_precision': 0.9175226, 'binary_recall': 0.8072977, 'binary_specificity': 0.9747655, 'binary_f1_score': 0.85888815}
confusion matrix:
       0      1
0  41255   1068
1   2836  11881
---- Validation: 
scalar performance:
{'acc': 0.9559919, 'precision': 0.6798156, 'recall': 0.7116968, 'specificity': 0.7116968, 'f1': 0.69426465, 'auroc': 0.86552775, 'binary_precision': 0.3792651, 'binary_recall': 0.44945568, 'binary_specificity': 0.9739379, 'binary_f1_score': 0.4113879}
confusion matrix:
       0    1
0  17676  473
1    354  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.727972, 'recall': 0.74628115, 'specificity': 0.74628115, 'f1': 0.73671836, 'auroc': 0.8992108, 'binary_precision': 0.4770318, 'binary_recall': 0.51724136, 'binary_specificity': 0.975321, 'binary_f1_score': 0.49632353}
confusion matrix:
      0    1
0  5849  148
1   126  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-25 06:26:47.170916,epoch time: 0:19:16.790228,used: 1:18:44.333625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9358696, 'precision': 0.9314722, 'recall': 0.8979045, 'specificity': 0.8979045, 'f1': 0.9129635, 'auroc': 0.9699554, 'binary_precision': 0.92335963, 'binary_recall': 0.8194605, 'binary_specificity': 0.9763486, 'binary_f1_score': 0.8683131}
confusion matrix:
       0      1
0  41322   1001
1   2657  12060
---- Validation: 
scalar performance:
{'acc': 0.9552469, 'precision': 0.67862076, 'recall': 0.72031176, 'specificity': 0.72031176, 'f1': 0.6969582, 'auroc': 0.8690562, 'binary_precision': 0.37625, 'binary_recall': 0.4681182, 'binary_specificity': 0.9725054, 'binary_f1_score': 0.4171864}
confusion matrix:
       0    1
0  17650  499
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95573664, 'precision': 0.7281621, 'recall': 0.7753484, 'specificity': 0.7753484, 'f1': 0.74919194, 'auroc': 0.9039264, 'binary_precision': 0.47484276, 'binary_recall': 0.5785441, 'binary_specificity': 0.97215277, 'binary_f1_score': 0.521589}
confusion matrix:
      0    1
0  5830  167
1   110  151
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_5.png
early stop counter: 1
val acc:0.9552469253540039, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.956216037273407
after epoch: 5,now: 2024-06-25 06:46:12.057636,epoch time: 0:19:24.886720,used: 1:38:09.220345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9394986, 'precision': 0.9371482, 'recall': 0.9021057, 'specificity': 0.9021057, 'f1': 0.9177823, 'auroc': 0.9736755, 'binary_precision': 0.93282604, 'binary_recall': 0.8248607, 'binary_specificity': 0.97935075, 'binary_f1_score': 0.8755275}
confusion matrix:
       0      1
0  41452    874
1   2577  12137
---- Validation: 
scalar performance:
{'acc': 0.954768, 'precision': 0.67539966, 'recall': 0.7155635, 'specificity': 0.7155635, 'f1': 0.6931026, 'auroc': 0.87223685, 'binary_precision': 0.37013802, 'binary_recall': 0.45878693, 'binary_specificity': 0.97234005, 'binary_f1_score': 0.4097222}
confusion matrix:
       0    1
0  17647  502
1    348  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.73339164, 'recall': 0.78501034, 'specificity': 0.78501034, 'f1': 0.7562264, 'auroc': 0.9081054, 'binary_precision': 0.48447204, 'binary_recall': 0.59770113, 'binary_specificity': 0.9723195, 'binary_f1_score': 0.535163}
confusion matrix:
      0    1
0  5831  166
1   105  156
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_6.png
new oracle model saved
early stop counter: 2
val acc:0.9547680020332336, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 6,now: 2024-06-25 07:05:54.004033,epoch time: 0:19:41.946397,used: 1:57:51.166742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94419706, 'precision': 0.9386044, 'recall': 0.91335046, 'specificity': 0.91335046, 'f1': 0.92501247, 'auroc': 0.9754287, 'binary_precision': 0.92800415, 'binary_recall': 0.84961945, 'binary_specificity': 0.97708154, 'binary_f1_score': 0.8870836}
confusion matrix:
       0      1
0  41354    970
1   2213  12503
---- Validation: 
scalar performance:
{'acc': 0.95301193, 'precision': 0.67423487, 'recall': 0.7394062, 'specificity': 0.7394062, 'f1': 0.70087683, 'auroc': 0.8763817, 'binary_precision': 0.36607143, 'binary_recall': 0.5101089, 'binary_specificity': 0.9687035, 'binary_f1_score': 0.42625082}
confusion matrix:
       0    1
0  17581  568
1    315  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9533397, 'precision': 0.7201905, 'recall': 0.7979181, 'specificity': 0.7979181, 'f1': 0.7522431, 'auroc': 0.9106584, 'binary_precision': 0.4568245, 'binary_recall': 0.62835246, 'binary_specificity': 0.96748376, 'binary_f1_score': 0.5290323}
confusion matrix:
      0    1
0  5802  195
1    97  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_7.png
early stop counter: 3
val acc:0.9530119299888611, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 7,now: 2024-06-25 07:25:23.595707,epoch time: 0:19:29.591674,used: 2:17:20.758416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9454944, 'precision': 0.9399694, 'recall': 0.9154833, 'specificity': 0.9154833, 'f1': 0.92682207, 'auroc': 0.9776198, 'binary_precision': 0.9294701, 'binary_recall': 0.85348284, 'binary_specificity': 0.97748375, 'binary_f1_score': 0.88985723}
confusion matrix:
       0      1
0  41372    953
1   2156  12559
---- Validation: 
scalar performance:
{'acc': 0.9509898, 'precision': 0.6678754, 'recall': 0.7428596, 'specificity': 0.7428596, 'f1': 0.69740164, 'auroc': 0.87846047, 'binary_precision': 0.35306555, 'binary_recall': 0.5194401, 'binary_specificity': 0.96627915, 'binary_f1_score': 0.4203902}
confusion matrix:
       0    1
0  17537  612
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95126235, 'precision': 0.7142966, 'recall': 0.8133252, 'specificity': 0.8133252, 'f1': 0.752892, 'auroc': 0.9126977, 'binary_precision': 0.44358975, 'binary_recall': 0.66283524, 'binary_specificity': 0.9638152, 'binary_f1_score': 0.53148997}
confusion matrix:
      0    1
0  5780  217
1    88  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_8.png
early stop counter: 4
val acc:0.9509897828102112, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 8,now: 2024-06-25 07:45:00.607436,epoch time: 0:19:37.011729,used: 2:36:57.770145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94751054, 'precision': 0.94322705, 'recall': 0.9176398, 'specificity': 0.9176398, 'f1': 0.9294567, 'auroc': 0.97849447, 'binary_precision': 0.9351103, 'binary_recall': 0.8559293, 'binary_specificity': 0.97935027, 'binary_f1_score': 0.8937695}
confusion matrix:
       0      1
0  41451    874
1   2120  12595
---- Validation: 
scalar performance:
{'acc': 0.95232016, 'precision': 0.67124933, 'recall': 0.7375479, 'specificity': 0.7375479, 'f1': 0.69816226, 'auroc': 0.87916076, 'binary_precision': 0.360221, 'binary_recall': 0.5069984, 'binary_specificity': 0.9680974, 'binary_f1_score': 0.42118862}
confusion matrix:
       0    1
0  17570  579
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9539789, 'precision': 0.72406596, 'recall': 0.81107795, 'specificity': 0.81107795, 'f1': 0.75931346, 'auroc': 0.91372764, 'binary_precision': 0.46341464, 'binary_recall': 0.6551724, 'binary_specificity': 0.9669835, 'binary_f1_score': 0.54285717}
confusion matrix:
      0    1
0  5799  198
1    90  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_9.png
early stop counter: 5
val acc:0.9523201584815979, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 9,now: 2024-06-25 08:04:41.905040,epoch time: 0:19:41.297604,used: 2:56:39.067749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94893056, 'precision': 0.94428515, 'recall': 0.92041427, 'specificity': 0.92041427, 'f1': 0.93150055, 'auroc': 0.9806715, 'binary_precision': 0.93543386, 'binary_recall': 0.8615019, 'binary_specificity': 0.97932667, 'binary_f1_score': 0.89694697}
confusion matrix:
       0      1
0  41450    875
1   2038  12677
---- Validation: 
scalar performance:
{'acc': 0.9519476, 'precision': 0.6702286, 'recall': 0.73885524, 'specificity': 0.73885524, 'f1': 0.69785833, 'auroc': 0.88082176, 'binary_precision': 0.3580786, 'binary_recall': 0.5101089, 'binary_specificity': 0.96760154, 'binary_f1_score': 0.42078257}
confusion matrix:
       0    1
0  17561  588
1    315  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9536593, 'precision': 0.72318745, 'recall': 0.8145759, 'specificity': 0.8145759, 'f1': 0.75980717, 'auroc': 0.9143454, 'binary_precision': 0.46133333, 'binary_recall': 0.66283524, 'binary_specificity': 0.9663165, 'binary_f1_score': 0.5440251}
confusion matrix:
      0    1
0  5795  202
1    88  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_10.png
early stop counter: 6
val acc:0.9519476294517517, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 10,now: 2024-06-25 08:24:17.914263,epoch time: 0:19:36.009223,used: 3:16:15.076972,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95054346, 'precision': 0.9469743, 'recall': 0.92205524, 'specificity': 0.92205524, 'f1': 0.9335977, 'auroc': 0.98085785, 'binary_precision': 0.94019246, 'binary_recall': 0.86320084, 'binary_specificity': 0.98090965, 'binary_f1_score': 0.90005314}
confusion matrix:
       0      1
0  41517    808
1   2013  12702
---- Validation: 
scalar performance:
{'acc': 0.95184124, 'precision': 0.6687307, 'recall': 0.7342998, 'specificity': 0.7342998, 'f1': 0.6953188, 'auroc': 0.88180566, 'binary_precision': 0.3554084, 'binary_recall': 0.5007776, 'binary_specificity': 0.9678219, 'binary_f1_score': 0.4157521}
confusion matrix:
       0    1
0  17565  584
1    321  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.7321508, 'recall': 0.8157431, 'specificity': 0.8157431, 'f1': 0.76653254, 'auroc': 0.91449875, 'binary_precision': 0.47922438, 'binary_recall': 0.66283524, 'binary_specificity': 0.968651, 'binary_f1_score': 0.5562701}
confusion matrix:
      0    1
0  5809  188
1    88  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_11.png
early stop counter: 7
val acc:0.9518412351608276, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 11,now: 2024-06-25 08:44:03.917436,epoch time: 0:19:46.003173,used: 3:36:01.080145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9528577, 'precision': 0.94764125, 'recall': 0.92765665, 'specificity': 0.92765665, 'f1': 0.93705666, 'auroc': 0.98232025, 'binary_precision': 0.9375728, 'binary_recall': 0.87558603, 'binary_specificity': 0.9797273, 'binary_f1_score': 0.9055199}
confusion matrix:
       0      1
0  41465    858
1   1831  12886
---- Validation: 
scalar performance:
{'acc': 0.94747764, 'precision': 0.6604697, 'recall': 0.75754255, 'specificity': 0.75754255, 'f1': 0.6957828, 'auroc': 0.8841425, 'binary_precision': 0.33712122, 'binary_recall': 0.55365473, 'binary_specificity': 0.9614304, 'binary_f1_score': 0.41907007}
confusion matrix:
       0    1
0  17449  700
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94550973, 'precision': 0.6978736, 'recall': 0.8249824, 'specificity': 0.8249824, 'f1': 0.7430348, 'auroc': 0.91612923, 'binary_precision': 0.40950227, 'binary_recall': 0.6934866, 'binary_specificity': 0.95647824, 'binary_f1_score': 0.51493603}
confusion matrix:
      0    1
0  5736  261
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_12.png
early stop counter: 8
val acc:0.9474776387214661, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 12,now: 2024-06-25 09:04:20.986739,epoch time: 0:20:17.069303,used: 3:56:18.149448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95243686, 'precision': 0.9497278, 'recall': 0.92439497, 'specificity': 0.92439497, 'f1': 0.93612164, 'auroc': 0.9816562, 'binary_precision': 0.94458437, 'binary_recall': 0.86646277, 'binary_specificity': 0.9823272, 'binary_f1_score': 0.90383863}
confusion matrix:
       0      1
0  41577    748
1   1965  12750
---- Validation: 
scalar performance:
{'acc': 0.95083016, 'precision': 0.66657835, 'recall': 0.73977673, 'specificity': 0.73977673, 'f1': 0.6955, 'auroc': 0.883981, 'binary_precision': 0.35069075, 'binary_recall': 0.5132193, 'binary_specificity': 0.9663342, 'binary_f1_score': 0.41666666}
confusion matrix:
       0    1
0  17538  611
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9544583, 'precision': 0.72698414, 'recall': 0.8223221, 'specificity': 0.8223221, 'f1': 0.7649973, 'auroc': 0.91615856, 'binary_precision': 0.46825397, 'binary_recall': 0.6781609, 'binary_specificity': 0.96648324, 'binary_f1_score': 0.5539906}
confusion matrix:
      0    1
0  5796  201
1    84  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_13.png
early stop counter: 9
val acc:0.9508301615715027, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 13,now: 2024-06-25 09:24:54.055202,epoch time: 0:20:33.068463,used: 4:16:51.217911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95415497, 'precision': 0.94962955, 'recall': 0.92912924, 'specificity': 0.92912924, 'f1': 0.93876004, 'auroc': 0.9839287, 'binary_precision': 0.94090647, 'binary_recall': 0.87742066, 'binary_specificity': 0.9808378, 'binary_f1_score': 0.90805525}
confusion matrix:
       0      1
0  41512    811
1   1804  12913
---- Validation: 
scalar performance:
{'acc': 0.94886124, 'precision': 0.66348237, 'recall': 0.7530085, 'specificity': 0.7530085, 'f1': 0.69699264, 'auroc': 0.88536227, 'binary_precision': 0.34350392, 'binary_recall': 0.5427683, 'binary_specificity': 0.96324867, 'binary_f1_score': 0.42073542}
confusion matrix:
       0    1
0  17482  667
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949185, 'precision': 0.7093848, 'recall': 0.8287324, 'specificity': 0.8287324, 'f1': 0.7534263, 'auroc': 0.9163132, 'binary_precision': 0.43230402, 'binary_recall': 0.697318, 'binary_specificity': 0.9601467, 'binary_f1_score': 0.53372437}
confusion matrix:
      0    1
0  5758  239
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_14.png
early stop counter: 10
val acc:0.9488612413406372, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 14,now: 2024-06-25 09:45:53.333796,epoch time: 0:20:59.278594,used: 4:37:50.496505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.95415497, 'precision': 0.94908375, 'recall': 0.92966, 'specificity': 0.92966, 'f1': 0.93881464, 'auroc': 0.9835969, 'binary_precision': 0.9392795, 'binary_recall': 0.8790701, 'binary_specificity': 0.98024994, 'binary_f1_score': 0.908178}
confusion matrix:
       0      1
0  41493    836
1   1779  12932
---- Validation: 
scalar performance:
{'acc': 0.94827586, 'precision': 0.6625461, 'recall': 0.75645566, 'specificity': 0.75645566, 'f1': 0.6971781, 'auroc': 0.8863436, 'binary_precision': 0.34136933, 'binary_recall': 0.5505443, 'binary_specificity': 0.96236706, 'binary_f1_score': 0.42142856}
confusion matrix:
       0    1
0  17466  683
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9488655, 'precision': 0.7095834, 'recall': 0.8377273, 'specificity': 0.8377273, 'f1': 0.7559184, 'auroc': 0.9171144, 'binary_precision': 0.43187067, 'binary_recall': 0.71647507, 'binary_specificity': 0.9589795, 'binary_f1_score': 0.5389049}
confusion matrix:
      0    1
0  5751  246
1    74  187
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_15.png
early stop counter: 11
val acc:0.9482758641242981, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 15,now: 2024-06-25 10:06:56.304895,epoch time: 0:21:02.971099,used: 4:58:53.467604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9558205, 'precision': 0.952294, 'recall': 0.9309242, 'specificity': 0.9309242, 'f1': 0.9409418, 'auroc': 0.98521304, 'binary_precision': 0.94551164, 'binary_recall': 0.87947553, 'binary_specificity': 0.9823728, 'binary_f1_score': 0.9112989}
confusion matrix:
       0      1
0  41575    746
1   1774  12945
---- Validation: 
scalar performance:
{'acc': 0.94934016, 'precision': 0.66448027, 'recall': 0.75100625, 'specificity': 0.75100625, 'f1': 0.69721794, 'auroc': 0.8856782, 'binary_precision': 0.34565434, 'binary_recall': 0.5381026, 'binary_specificity': 0.96390986, 'binary_f1_score': 0.42092454}
confusion matrix:
       0    1
0  17494  655
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9506232, 'precision': 0.71500516, 'recall': 0.8368121, 'specificity': 0.8368121, 'f1': 0.7600732, 'auroc': 0.9170556, 'binary_precision': 0.44285715, 'binary_recall': 0.7126437, 'binary_specificity': 0.9609805, 'binary_f1_score': 0.54625547}
confusion matrix:
      0    1
0  5763  234
1    75  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_16.png
early stop counter: 12
val acc:0.9493401646614075, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 16,now: 2024-06-25 10:29:30.042716,epoch time: 0:22:33.737821,used: 5:21:27.205425,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9574509, 'precision': 0.95320463, 'recall': 0.9343899, 'specificity': 0.9343899, 'f1': 0.94327986, 'auroc': 0.985695, 'binary_precision': 0.9449714, 'binary_recall': 0.88673735, 'binary_specificity': 0.98204243, 'binary_f1_score': 0.9149287}
confusion matrix:
       0      1
0  41562    760
1   1667  13051
---- Validation: 
scalar performance:
{'acc': 0.9484355, 'precision': 0.66322213, 'recall': 0.7572884, 'specificity': 0.7572884, 'f1': 0.6979414, 'auroc': 0.886902, 'binary_precision': 0.3426641, 'binary_recall': 0.5520995, 'binary_specificity': 0.96247727, 'binary_f1_score': 0.42287076}
confusion matrix:
       0    1
0  17468  681
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9474273, 'precision': 0.7051767, 'recall': 0.8369769, 'specificity': 0.8369769, 'f1': 0.75207746, 'auroc': 0.9173833, 'binary_precision': 0.42307693, 'binary_recall': 0.71647507, 'binary_specificity': 0.95747876, 'binary_f1_score': 0.53200567}
confusion matrix:
      0    1
0  5742  255
1    74  187
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_17.png
early stop counter: 13
val acc:0.9484354853630066, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 17,now: 2024-06-25 10:52:14.785718,epoch time: 0:22:44.743002,used: 5:44:11.948427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.95718795, 'precision': 0.95287865, 'recall': 0.93401325, 'specificity': 0.93401325, 'f1': 0.9429253, 'auroc': 0.98575366, 'binary_precision': 0.9445249, 'binary_recall': 0.8861258, 'binary_specificity': 0.9819007, 'binary_f1_score': 0.9143939}
confusion matrix:
       0      1
0  41556    766
1   1676  13042
---- Validation: 
scalar performance:
{'acc': 0.9480098, 'precision': 0.6624444, 'recall': 0.7593182, 'specificity': 0.7593182, 'f1': 0.6978483, 'auroc': 0.8874937, 'binary_precision': 0.34095237, 'binary_recall': 0.55676514, 'binary_specificity': 0.9618712, 'binary_f1_score': 0.4229179}
confusion matrix:
       0    1
0  17457  692
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94678813, 'precision': 0.70406264, 'recall': 0.84214044, 'specificity': 0.84214044, 'f1': 0.7523731, 'auroc': 0.91769063, 'binary_precision': 0.42035398, 'binary_recall': 0.72796935, 'binary_specificity': 0.95631146, 'binary_f1_score': 0.53295934}
confusion matrix:
      0    1
0  5735  262
1    71  190
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_18.png
early stop counter: 14
val acc:0.9480097889900208, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 18,now: 2024-06-25 11:12:57.337441,epoch time: 0:20:42.551723,used: 6:04:54.500150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95529455, 'precision': 0.95469254, 'recall': 0.9271757, 'specificity': 0.9271757, 'f1': 0.9398434, 'auroc': 0.9855195, 'binary_precision': 0.953556, 'binary_recall': 0.8690719, 'binary_specificity': 0.9852795, 'binary_f1_score': 0.9093559}
confusion matrix:
       0      1
0  41699    623
1   1927  12791
---- Validation: 
scalar performance:
{'acc': 0.9517348, 'precision': 0.671068, 'recall': 0.74549544, 'specificity': 0.74549544, 'f1': 0.7005601, 'auroc': 0.8879482, 'binary_precision': 0.35927504, 'binary_recall': 0.5241057, 'binary_specificity': 0.9668852, 'binary_f1_score': 0.42631245}
confusion matrix:
       0    1
0  17548  601
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95605624, 'precision': 0.7342856, 'recall': 0.8359822, 'specificity': 0.8359822, 'f1': 0.77457774, 'auroc': 0.9179666, 'binary_precision': 0.4816754, 'binary_recall': 0.70498085, 'binary_specificity': 0.9669835, 'binary_f1_score': 0.57231724}
confusion matrix:
      0    1
0  5799  198
1    77  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_19.png
early stop counter: 15
val acc:0.9517347812652588, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 19,now: 2024-06-25 11:32:41.627136,epoch time: 0:19:44.289695,used: 6:24:38.789845,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.95880085, 'precision': 0.9527434, 'recall': 0.93855023, 'specificity': 0.93855023, 'f1': 0.9453503, 'auroc': 0.98605657, 'binary_precision': 0.9408242, 'binary_recall': 0.89671105, 'binary_specificity': 0.98038936, 'binary_f1_score': 0.91823816}
confusion matrix:
       0      1
0  41494    830
1   1520  13196
---- Validation: 
scalar performance:
{'acc': 0.9433802, 'precision': 0.6506784, 'recall': 0.76217175, 'specificity': 0.76217175, 'f1': 0.6885915, 'auroc': 0.8883556, 'binary_precision': 0.31711555, 'binary_recall': 0.5676516, 'binary_specificity': 0.9566918, 'binary_f1_score': 0.4069119}
confusion matrix:
       0    1
0  17363  786
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93847877, 'precision': 0.6833006, 'recall': 0.8433019, 'specificity': 0.8433019, 'f1': 0.7339343, 'auroc': 0.9181142, 'binary_precision': 0.37843138, 'binary_recall': 0.7394636, 'binary_specificity': 0.9471402, 'binary_f1_score': 0.5006485}
confusion matrix:
      0    1
0  5680  317
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_20.png
early stop counter: 16
val acc:0.9433801770210266, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 20,now: 2024-06-25 11:52:24.316361,epoch time: 0:19:42.689225,used: 6:44:21.479070,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.958608, 'precision': 0.95328724, 'recall': 0.9374519, 'specificity': 0.9374519, 'f1': 0.9450017, 'auroc': 0.98647404, 'binary_precision': 0.94287145, 'binary_recall': 0.8937356, 'binary_specificity': 0.9811682, 'binary_f1_score': 0.9176463}
confusion matrix:
       0      1
0  41525    797
1   1564  13154
---- Validation: 
scalar performance:
{'acc': 0.9445509, 'precision': 0.6537779, 'recall': 0.7627778, 'specificity': 0.7627778, 'f1': 0.6914338, 'auroc': 0.88866687, 'binary_precision': 0.32329494, 'binary_recall': 0.5676516, 'binary_specificity': 0.95790404, 'binary_f1_score': 0.41196388}
confusion matrix:
       0    1
0  17385  764
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9405561, 'precision': 0.68826324, 'recall': 0.8443858, 'specificity': 0.8443858, 'f1': 0.7387984, 'auroc': 0.9176619, 'binary_precision': 0.38832998, 'binary_recall': 0.7394636, 'binary_specificity': 0.949308, 'binary_f1_score': 0.50923485}
confusion matrix:
      0    1
0  5693  304
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_21.png
early stop counter: 17
val acc:0.9445508718490601, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 21,now: 2024-06-25 12:11:42.136865,epoch time: 0:19:17.820504,used: 7:03:39.299574,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9581522, 'precision': 0.95509875, 'recall': 0.9343491, 'specificity': 0.9343491, 'f1': 0.94409955, 'auroc': 0.9857187, 'binary_precision': 0.949213, 'binary_recall': 0.8851668, 'binary_specificity': 0.9835314, 'binary_f1_score': 0.91607183}
confusion matrix:
       0      1
0  41626    697
1   1690  13027
---- Validation: 
scalar performance:
{'acc': 0.94827586, 'precision': 0.6625461, 'recall': 0.75645566, 'specificity': 0.75645566, 'f1': 0.6971781, 'auroc': 0.8889859, 'binary_precision': 0.34136933, 'binary_recall': 0.5505443, 'binary_specificity': 0.96236706, 'binary_f1_score': 0.42142856}
confusion matrix:
       0    1
0  17466  683
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9485459, 'precision': 0.7095567, 'recall': 0.8448899, 'specificity': 0.8448899, 'f1': 0.7576766, 'auroc': 0.91738737, 'binary_precision': 0.43115124, 'binary_recall': 0.7318008, 'binary_specificity': 0.95797896, 'binary_f1_score': 0.5426136}
confusion matrix:
      0    1
0  5745  252
1    70  191
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_22.png
early stop counter: 18
val acc:0.9482758641242981, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 22,now: 2024-06-25 12:30:55.325832,epoch time: 0:19:13.188967,used: 7:22:52.488541,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.95953715, 'precision': 0.9555527, 'recall': 0.9375989, 'specificity': 0.9375989, 'f1': 0.9461075, 'auroc': 0.98647213, 'binary_precision': 0.94780535, 'binary_recall': 0.89227945, 'binary_specificity': 0.9829183, 'binary_f1_score': 0.91920465}
confusion matrix:
       0      1
0  41603    723
1   1585  13129
---- Validation: 
scalar performance:
{'acc': 0.9465198, 'precision': 0.6587315, 'recall': 0.76154697, 'specificity': 0.76154697, 'f1': 0.6953548, 'auroc': 0.88947, 'binary_precision': 0.33333334, 'binary_recall': 0.562986, 'binary_specificity': 0.960108, 'binary_f1_score': 0.41873914}
confusion matrix:
       0    1
0  17425  724
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.943752, 'precision': 0.6964247, 'recall': 0.8460533, 'specificity': 0.8460533, 'f1': 0.7465745, 'auroc': 0.91765153, 'binary_precision': 0.40461215, 'binary_recall': 0.7394636, 'binary_specificity': 0.952643, 'binary_f1_score': 0.5230352}
confusion matrix:
      0    1
0  5713  284
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_23.png
early stop counter: 19
val acc:0.9465197920799255, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 23,now: 2024-06-25 12:50:18.751272,epoch time: 0:19:23.425440,used: 7:42:15.913981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9603787, 'precision': 0.9570934, 'recall': 0.9383093, 'specificity': 0.9383093, 'f1': 0.94719136, 'auroc': 0.9875488, 'binary_precision': 0.95072, 'binary_recall': 0.89270914, 'binary_specificity': 0.9839095, 'binary_f1_score': 0.9208018}
confusion matrix:
       0      1
0  41642    681
1   1579  13138
---- Validation: 
scalar performance:
{'acc': 0.94513625, 'precision': 0.6551904, 'recall': 0.76233083, 'specificity': 0.76233083, 'f1': 0.69254637, 'auroc': 0.8895414, 'binary_precision': 0.32616487, 'binary_recall': 0.5660964, 'binary_specificity': 0.95856524, 'binary_f1_score': 0.41387153}
confusion matrix:
       0    1
0  17397  752
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94247365, 'precision': 0.6930796, 'recall': 0.84538627, 'specificity': 0.84538627, 'f1': 0.74342, 'auroc': 0.917444, 'binary_precision': 0.39793813, 'binary_recall': 0.7394636, 'binary_specificity': 0.95130897, 'binary_f1_score': 0.51742625}
confusion matrix:
      0    1
0  5705  292
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_24.png
early stop counter: 20
val acc:0.9451362490653992, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 24,now: 2024-06-25 13:11:03.224571,epoch time: 0:20:44.473299,used: 8:03:00.387280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9593794, 'precision': 0.95261025, 'recall': 0.9402889, 'specificity': 0.9402889, 'f1': 0.9462255, 'auroc': 0.9868473, 'binary_precision': 0.9392093, 'binary_recall': 0.90084946, 'binary_specificity': 0.9797283, 'binary_f1_score': 0.9196295}
confusion matrix:
       0      1
0  41467    858
1   1459  13256
---- Validation: 
scalar performance:
{'acc': 0.94002765, 'precision': 0.64412624, 'recall': 0.76718664, 'specificity': 0.76718664, 'f1': 0.6836863, 'auroc': 0.88977647, 'binary_precision': 0.30357143, 'binary_recall': 0.5816485, 'binary_specificity': 0.9527247, 'binary_f1_score': 0.39893335}
confusion matrix:
       0    1
0  17291  858
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9362416, 'precision': 0.6798901, 'recall': 0.8512963, 'specificity': 0.8512963, 'f1': 0.7320359, 'auroc': 0.91697514, 'binary_precision': 0.37078652, 'binary_recall': 0.7586207, 'binary_specificity': 0.943972, 'binary_f1_score': 0.49811324}
confusion matrix:
      0    1
0  5661  336
1    63  198
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_25.png
early stop counter: 21
val acc:0.94002765417099, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 25,now: 2024-06-25 13:33:40.326400,epoch time: 0:22:37.101829,used: 8:25:37.489109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9604313, 'precision': 0.95706797, 'recall': 0.9384811, 'specificity': 0.9384811, 'f1': 0.947275, 'auroc': 0.98749286, 'binary_precision': 0.9505387, 'binary_recall': 0.89312404, 'binary_specificity': 0.9838382, 'binary_f1_score': 0.92093736}
confusion matrix:
       0      1
0  41638    684
1   1573  13145
---- Validation: 
scalar performance:
{'acc': 0.946573, 'precision': 0.6577914, 'recall': 0.75707424, 'specificity': 0.75707424, 'f1': 0.69346344, 'auroc': 0.8892274, 'binary_precision': 0.33178005, 'binary_recall': 0.55365473, 'binary_specificity': 0.9604937, 'binary_f1_score': 0.41491842}
confusion matrix:
       0    1
0  17432  717
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94646853, 'precision': 0.7036587, 'recall': 0.84563833, 'specificity': 0.84563833, 'f1': 0.752839, 'auroc': 0.9167112, 'binary_precision': 0.41921398, 'binary_recall': 0.7356322, 'binary_specificity': 0.9556445, 'binary_f1_score': 0.53407514}
confusion matrix:
      0    1
0  5731  266
1    69  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_26.png
early stop counter: 22
val acc:0.94657301902771, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 26,now: 2024-06-25 13:55:23.654906,epoch time: 0:21:43.328506,used: 8:47:20.817615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9606241, 'precision': 0.95594096, 'recall': 0.9401621, 'specificity': 0.9401621, 'f1': 0.94768906, 'auroc': 0.98728585, 'binary_precision': 0.9467689, 'binary_recall': 0.89788014, 'binary_specificity': 0.9824441, 'binary_f1_score': 0.92167664}
confusion matrix:
       0      1
0  41579    743
1   1503  13215
---- Validation: 
scalar performance:
{'acc': 0.9432737, 'precision': 0.65132844, 'recall': 0.76586694, 'specificity': 0.76586694, 'f1': 0.68997526, 'auroc': 0.8899514, 'binary_precision': 0.31814274, 'binary_recall': 0.5754277, 'binary_specificity': 0.95630616, 'binary_f1_score': 0.40974534}
confusion matrix:
       0    1
0  17356  793
1    273  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9407159, 'precision': 0.6892688, 'recall': 0.84813386, 'specificity': 0.84813386, 'f1': 0.74046123, 'auroc': 0.91685057, 'binary_precision': 0.39, 'binary_recall': 0.74712646, 'binary_specificity': 0.94914126, 'binary_f1_score': 0.51248354}
confusion matrix:
      0    1
0  5692  305
1    66  195
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_27.png
early stop counter: 23
val acc:0.9432737231254578, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 27,now: 2024-06-25 14:15:06.094182,epoch time: 0:19:42.439276,used: 9:07:03.256891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9616059, 'precision': 0.95784473, 'recall': 0.9408361, 'specificity': 0.9408361, 'f1': 0.9489223, 'auroc': 0.98834634, 'binary_precision': 0.95050716, 'binary_recall': 0.8979273, 'binary_specificity': 0.98374486, 'binary_f1_score': 0.92346936}
confusion matrix:
       0      1
0  41637    688
1   1502  13213
---- Validation: 
scalar performance:
{'acc': 0.9452959, 'precision': 0.6558138, 'recall': 0.7631635, 'specificity': 0.7631635, 'f1': 0.6932751, 'auroc': 0.8895167, 'binary_precision': 0.32735425, 'binary_recall': 0.5676516, 'binary_specificity': 0.9586754, 'binary_f1_score': 0.41524458}
confusion matrix:
       0    1
0  17399  750
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9443912, 'precision': 0.69841766, 'recall': 0.84821916, 'specificity': 0.84821916, 'f1': 0.74881613, 'auroc': 0.91638124, 'binary_precision': 0.40842104, 'binary_recall': 0.743295, 'binary_specificity': 0.95314324, 'binary_f1_score': 0.52717394}
confusion matrix:
      0    1
0  5716  281
1    67  194
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_28.png
early stop counter: 24
val acc:0.9452958703041077, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 28,now: 2024-06-25 14:34:43.114818,epoch time: 0:19:37.020636,used: 9:26:40.277527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96241236, 'precision': 0.95715535, 'recall': 0.94376326, 'specificity': 0.94376326, 'f1': 0.95019823, 'auroc': 0.9878665, 'binary_precision': 0.9467775, 'binary_recall': 0.90522456, 'binary_specificity': 0.98230195, 'binary_f1_score': 0.92553484}
confusion matrix:
       0      1
0  41572    749
1   1395  13324
---- Validation: 
scalar performance:
{'acc': 0.9431673, 'precision': 0.6506853, 'recall': 0.7643117, 'specificity': 0.7643117, 'f1': 0.6890666, 'auroc': 0.8888229, 'binary_precision': 0.31696814, 'binary_recall': 0.57231724, 'binary_specificity': 0.95630616, 'binary_f1_score': 0.40798226}
confusion matrix:
       0    1
0  17356  793
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9405561, 'precision': 0.68887866, 'recall': 0.8480505, 'specificity': 0.8480505, 'f1': 0.7400811, 'auroc': 0.91550183, 'binary_precision': 0.38922155, 'binary_recall': 0.74712646, 'binary_specificity': 0.9489745, 'binary_f1_score': 0.511811}
confusion matrix:
      0    1
0  5691  306
1    66  195
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_29.png
early stop counter: 25
val acc:0.9431673288345337, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 29,now: 2024-06-25 14:54:03.520945,epoch time: 0:19:20.406127,used: 9:46:00.683654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96213186, 'precision': 0.9587294, 'recall': 0.9413391, 'specificity': 0.9413391, 'f1': 0.94959855, 'auroc': 0.98871565, 'binary_precision': 0.9520997, 'binary_recall': 0.89838916, 'binary_specificity': 0.984289, 'binary_f1_score': 0.92446494}
confusion matrix:
       0      1
0  41662    665
1   1495  13218
---- Validation: 
scalar performance:
{'acc': 0.94497657, 'precision': 0.6551178, 'recall': 0.7637483, 'specificity': 0.7637483, 'f1': 0.692814, 'auroc': 0.8892344, 'binary_precision': 0.32591274, 'binary_recall': 0.56920683, 'binary_specificity': 0.95828974, 'binary_f1_score': 0.41449606}
confusion matrix:
       0    1
0  17392  757
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9447108, 'precision': 0.699008, 'recall': 0.84655356, 'specificity': 0.84655356, 'f1': 0.7489803, 'auroc': 0.9152603, 'binary_precision': 0.40976647, 'binary_recall': 0.7394636, 'binary_specificity': 0.9536435, 'binary_f1_score': 0.5273224}
confusion matrix:
      0    1
0  5719  278
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_30.png
early stop counter: 26
val acc:0.9449765682220459, best validation acc: 0.9559919238090515, corresponding to test acc:                         0.956216037273407 / 0.9566954374313354
after epoch: 30,now: 2024-06-25 15:13:32.440755,epoch time: 0:19:28.919810,used: 10:05:29.603464,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:05:29.603464 at 2024-06-25 15:13:32.440755
persisted model performance metric: 

scalar performance:
{'acc': 0.95621604, 'precision': 0.727972, 'recall': 0.74628115, 'specificity': 0.74628115, 'f1': 0.73671836, 'auroc': 0.8992108, 'binary_precision': 0.4770318, 'binary_recall': 0.51724136, 'binary_specificity': 0.975321, 'binary_f1_score': 0.49632353}
confusion matrix:
      0    1
0  5849  148
1   126  135
oracle model performance metric: 

scalar performance:
{'acc': 0.95669544, 'precision': 0.73339164, 'recall': 0.78501034, 'specificity': 0.78501034, 'f1': 0.7562264, 'auroc': 0.9081054, 'binary_precision': 0.48447204, 'binary_recall': 0.59770113, 'binary_specificity': 0.9723195, 'binary_f1_score': 0.535163}
confusion matrix:
      0    1
0  5831  166
1   105  156
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191877 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |  17477 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191877 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |  17477 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189283 KiB | 457564 KiB | 758210 GiB | 758210 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 742654 GiB | 742654 GiB |
|       from small pool |  16469 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 516096 KiB | 516096 KiB | 516096 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39546 KiB |  75256 KiB | 410711 GiB | 410711 GiB |
|       from large pool |  30400 KiB |  70632 KiB | 395107 GiB | 395107 GiB |
|       from small pool |   9146 KiB |   9397 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7613    |  157526 K  |  157523 K  |
|       from large pool |      76    |     158    |   73194 K  |   73194 K  |
|       from small pool |    2890    |    7535    |   84331 K  |   84328 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7613    |  157526 K  |  157523 K  |
|       from large pool |      76    |     158    |   73194 K  |   73194 K  |
|       from small pool |    2890    |    7535    |   84331 K  |   84328 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3584    |   87145 K  |   87145 K  |
|       from large pool |       9    |      19    |   45496 K  |   45496 K  |
|       from small pool |      23    |    3576    |   41649 K  |   41649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 758210 GiB | 758210 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 742654 GiB | 742654 GiB |
|       from small pool |      0 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 516096 KiB | 516096 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  43008 KiB |  43008 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82786 KiB | 410711 GiB | 410711 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 395108 GiB | 395108 GiB |
|       from small pool |      0 KiB |  20341 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      42    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3584    |   87146 K  |   87146 K  |
|       from large pool |       3    |      19    |   45496 K  |   45496 K  |
|       from small pool |       0    |    3576    |   41650 K  |   41650 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 758210 GiB | 758210 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 742654 GiB | 742654 GiB |
|       from small pool |      0 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 516096 KiB | 516096 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  43008 KiB |  43008 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82786 KiB | 410711 GiB | 410711 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 395108 GiB | 395108 GiB |
|       from small pool |      0 KiB |  20341 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      42    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3584    |   87146 K  |   87146 K  |
|       from large pool |       3    |      19    |   45496 K  |   45496 K  |
|       from small pool |       0    |    3576    |   41650 K  |   41650 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223

 Experiment start at: 2024-06-25 15:21:26.532434
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7874437, 'precision': 0.7326796, 'recall': 0.6386478, 'specificity': 0.6386478, 'f1': 0.6570184, 'auroc': 0.8234985, 'binary_precision': 0.65874845, 'binary_recall': 0.33656982, 'binary_specificity': 0.94072574, 'binary_f1_score': 0.44551545}
confusion matrix:
       0     1
0  39899  2514
1   9566  4853
---- Validation: 
scalar performance:
{'acc': 0.93313766, 'precision': 0.4957481, 'recall': 0.49610817, 'specificity': 0.49610817, 'f1': 0.49589905, 'auroc': 0.76086533, 'binary_precision': 0.027687296, 'binary_recall': 0.02526003, 'binary_specificity': 0.9669563, 'binary_f1_score': 0.026418025}
confusion matrix:
       0    1
0  17470  597
1    656   17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93312925, 'precision': 0.5154137, 'recall': 0.51087284, 'specificity': 0.51087284, 'f1': 0.51214486, 'auroc': 0.8249638, 'binary_precision': 0.0718232, 'binary_recall': 0.05, 'binary_specificity': 0.9717457, 'binary_f1_score': 0.058956914}
confusion matrix:
      0    1
0  5778  168
1   247   13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-25 15:41:39.255418,epoch time: 0:20:12.722984,used: 0:20:12.722984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8807538, 'precision': 0.8770335, 'recall': 0.7953593, 'specificity': 0.7953593, 'f1': 0.82480216, 'auroc': 0.93034256, 'binary_precision': 0.8711996, 'binary_recall': 0.62198335, 'binary_specificity': 0.9687353, 'binary_f1_score': 0.7257941}
confusion matrix:
       0     1
0  41086  1326
1   5451  8969
---- Validation: 
scalar performance:
{'acc': 0.9423159, 'precision': 0.5808202, 'recall': 0.57954764, 'specificity': 0.57954764, 'f1': 0.5801774, 'auroc': 0.8271848, 'binary_precision': 0.1918429, 'binary_recall': 0.18870728, 'binary_specificity': 0.970388, 'binary_f1_score': 0.19026217}
confusion matrix:
       0    1
0  17532  535
1    546  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.942475, 'precision': 0.59635687, 'recall': 0.5672417, 'specificity': 0.5672417, 'f1': 0.57848555, 'auroc': 0.86692214, 'binary_precision': 0.22905028, 'binary_recall': 0.15769231, 'binary_specificity': 0.97679114, 'binary_f1_score': 0.18678816}
confusion matrix:
      0    1
0  5808  138
1   219   41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-25 16:01:40.861460,epoch time: 0:20:01.606042,used: 0:40:14.329026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9101914, 'precision': 0.9076984, 'recall': 0.8485174, 'specificity': 0.8485174, 'f1': 0.8726109, 'auroc': 0.9520052, 'binary_precision': 0.90349966, 'binary_recall': 0.723301, 'binary_specificity': 0.97373384, 'binary_f1_score': 0.8034202}
confusion matrix:
       0      1
0  41298   1114
1   3990  10430
---- Validation: 
scalar performance:
{'acc': 0.9501601, 'precision': 0.6446537, 'recall': 0.65085095, 'specificity': 0.65085095, 'f1': 0.6476756, 'auroc': 0.8492533, 'binary_precision': 0.314367, 'binary_recall': 0.32838038, 'binary_specificity': 0.9733215, 'binary_f1_score': 0.3212209}
confusion matrix:
       0    1
0  17585  482
1    452  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95246536, 'precision': 0.6912141, 'recall': 0.64785373, 'specificity': 0.64785373, 'f1': 0.66630924, 'auroc': 0.8859065, 'binary_precision': 0.4120603, 'binary_recall': 0.31538463, 'binary_specificity': 0.9803229, 'binary_f1_score': 0.3572985}
confusion matrix:
      0    1
0  5829  117
1   178   82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-25 16:21:36.499766,epoch time: 0:19:55.638306,used: 1:00:09.967332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92252606, 'precision': 0.92014575, 'recall': 0.8704589, 'specificity': 0.8704589, 'f1': 0.89154494, 'auroc': 0.9609916, 'binary_precision': 0.9160159, 'binary_recall': 0.76475483, 'binary_specificity': 0.97616297, 'binary_f1_score': 0.833579}
confusion matrix:
       0      1
0  41402   1011
1   3392  11027
---- Validation: 
scalar performance:
{'acc': 0.9548559, 'precision': 0.6748896, 'recall': 0.67689013, 'specificity': 0.67689013, 'f1': 0.6758833, 'auroc': 0.8591112, 'binary_precision': 0.37298092, 'binary_recall': 0.37741455, 'binary_specificity': 0.97636575, 'binary_f1_score': 0.37518463}
confusion matrix:
       0    1
0  17640  427
1    419  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.72755337, 'recall': 0.68874294, 'specificity': 0.68874294, 'f1': 0.7060749, 'auroc': 0.8982017, 'binary_precision': 0.4813084, 'binary_recall': 0.39615384, 'binary_specificity': 0.981332, 'binary_f1_score': 0.43459913}
confusion matrix:
      0    1
0  5835  111
1   157  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-25 16:41:14.033604,epoch time: 0:19:37.533838,used: 1:19:47.501170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9308312, 'precision': 0.92881083, 'recall': 0.88479614, 'specificity': 0.88479614, 'f1': 0.9039165, 'auroc': 0.9671979, 'binary_precision': 0.92524123, 'binary_recall': 0.79133147, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.85306317}
confusion matrix:
       0      1
0  41490    922
1   3009  11411
---- Validation: 
scalar performance:
{'acc': 0.9558698, 'precision': 0.6857065, 'recall': 0.69815874, 'specificity': 0.69815874, 'f1': 0.6917003, 'auroc': 0.86653745, 'binary_precision': 0.39305556, 'binary_recall': 0.4205052, 'binary_specificity': 0.97581226, 'binary_f1_score': 0.40631732}
confusion matrix:
       0    1
0  17630  437
1    390  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.7354889, 'recall': 0.7259431, 'specificity': 0.7259431, 'f1': 0.7306026, 'auroc': 0.906158, 'binary_precision': 0.4939759, 'binary_recall': 0.4730769, 'binary_specificity': 0.9788093, 'binary_f1_score': 0.48330057}
confusion matrix:
      0    1
0  5820  126
1   137  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-25 17:04:01.838299,epoch time: 0:22:47.804695,used: 1:42:35.305865,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9354061, 'precision': 0.9356424, 'recall': 0.8907381, 'specificity': 0.8907381, 'f1': 0.9102483, 'auroc': 0.97041154, 'binary_precision': 0.9360597, 'binary_recall': 0.8000555, 'binary_specificity': 0.9814208, 'binary_f1_score': 0.8627304}
confusion matrix:
       0      1
0  41625    788
1   2883  11536
---- Validation: 
scalar performance:
{'acc': 0.9590715, 'precision': 0.70400876, 'recall': 0.70196503, 'specificity': 0.70196503, 'f1': 0.702981, 'auroc': 0.8716131, 'binary_precision': 0.42942944, 'binary_recall': 0.42496285, 'binary_specificity': 0.9789672, 'binary_f1_score': 0.42718446}
confusion matrix:
       0    1
0  17687  380
1    387  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.7605548, 'recall': 0.7297162, 'specificity': 0.7297162, 'f1': 0.74403465, 'auroc': 0.9111801, 'binary_precision': 0.54385966, 'binary_recall': 0.47692308, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.5081968}
confusion matrix:
      0    1
0  5842  104
1   136  124
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-25 17:28:44.603700,epoch time: 0:24:42.765401,used: 2:07:18.071266,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9387141, 'precision': 0.93726075, 'recall': 0.8980293, 'specificity': 0.8980293, 'f1': 0.9153987, 'auroc': 0.97257197, 'binary_precision': 0.934653, 'binary_recall': 0.81543905, 'binary_specificity': 0.9806196, 'binary_f1_score': 0.8709857}
confusion matrix:
       0      1
0  41592    822
1   2661  11757
---- Validation: 
scalar performance:
{'acc': 0.95731056, 'precision': 0.6987847, 'recall': 0.7253708, 'specificity': 0.7253708, 'f1': 0.71112347, 'auroc': 0.8765825, 'binary_precision': 0.41720992, 'binary_recall': 0.4754829, 'binary_specificity': 0.97525877, 'binary_f1_score': 0.44444448}
confusion matrix:
       0    1
0  17620  447
1    353  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7448281, 'recall': 0.7725905, 'specificity': 0.7725905, 'f1': 0.75785303, 'auroc': 0.9150652, 'binary_precision': 0.50859106, 'binary_recall': 0.5692308, 'binary_specificity': 0.97595024, 'binary_f1_score': 0.5372051}
confusion matrix:
      0    1
0  5803  143
1   112  148
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_7.png
early stop counter: 1
val acc:0.9573105573654175, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 7,now: 2024-06-25 18:21:39.250401,epoch time: 0:52:54.646701,used: 3:00:12.717967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94427437, 'precision': 0.94099367, 'recall': 0.90942276, 'specificity': 0.90942276, 'f1': 0.9237585, 'auroc': 0.97649133, 'binary_precision': 0.9349725, 'binary_recall': 0.8386739, 'binary_specificity': 0.9801716, 'binary_f1_score': 0.88420904}
confusion matrix:
       0      1
0  41573    841
1   2326  12092
---- Validation: 
scalar performance:
{'acc': 0.9570971, 'precision': 0.69877785, 'recall': 0.7309823, 'specificity': 0.7309823, 'f1': 0.71349704, 'auroc': 0.8790343, 'binary_precision': 0.41677254, 'binary_recall': 0.48736998, 'binary_specificity': 0.9745946, 'binary_f1_score': 0.44931507}
confusion matrix:
       0    1
0  17608  459
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.74765587, 'recall': 0.7820377, 'specificity': 0.7820377, 'f1': 0.7635642, 'auroc': 0.91677403, 'binary_precision': 0.51342285, 'binary_recall': 0.5884615, 'binary_specificity': 0.97561383, 'binary_f1_score': 0.5483871}
confusion matrix:
      0    1
0  5801  145
1   107  153
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_8.png
early stop counter: 2
val acc:0.9570971131324768, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 8,now: 2024-06-25 19:16:03.331499,epoch time: 0:54:24.081098,used: 3:54:36.799065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94592834, 'precision': 0.94199204, 'recall': 0.9129394, 'specificity': 0.9129394, 'f1': 0.92623836, 'auroc': 0.9776382, 'binary_precision': 0.93471265, 'binary_recall': 0.8459671, 'binary_specificity': 0.9799118, 'binary_f1_score': 0.88812846}
confusion matrix:
       0      1
0  41561    852
1   2221  12198
---- Validation: 
scalar performance:
{'acc': 0.9568303, 'precision': 0.6990441, 'recall': 0.7394271, 'specificity': 0.7394271, 'f1': 0.7171022, 'auroc': 0.88028675, 'binary_precision': 0.41666666, 'binary_recall': 0.50520056, 'binary_specificity': 0.9736536, 'binary_f1_score': 0.4566823}
confusion matrix:
       0    1
0  17591  476
1    333  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.74315274, 'recall': 0.79624504, 'specificity': 0.79624504, 'f1': 0.7666836, 'auroc': 0.91736853, 'binary_precision': 0.503125, 'binary_recall': 0.61923075, 'binary_specificity': 0.9732593, 'binary_f1_score': 0.55517244}
confusion matrix:
      0    1
0  5787  159
1    99  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_9.png
early stop counter: 3
val acc:0.9568303227424622, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 9,now: 2024-06-25 19:36:16.908643,epoch time: 0:20:13.577144,used: 4:14:50.376209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9497466, 'precision': 0.9474963, 'recall': 0.91788286, 'specificity': 0.91788286, 'f1': 0.93143517, 'auroc': 0.9802196, 'binary_precision': 0.9433369, 'binary_recall': 0.85319, 'binary_specificity': 0.9825757, 'binary_f1_score': 0.89600176}
confusion matrix:
       0      1
0  41673    739
1   2117  12303
---- Validation: 
scalar performance:
{'acc': 0.9566169, 'precision': 0.69696164, 'recall': 0.7335943, 'specificity': 0.7335943, 'f1': 0.71348923, 'auroc': 0.88112414, 'binary_precision': 0.41293532, 'binary_recall': 0.49331352, 'binary_specificity': 0.97387505, 'binary_f1_score': 0.44955993}
confusion matrix:
       0    1
0  17595  472
1    341  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7471529, 'recall': 0.7966655, 'specificity': 0.7966655, 'f1': 0.76931316, 'auroc': 0.9178103, 'binary_precision': 0.51111114, 'binary_recall': 0.61923075, 'binary_specificity': 0.97410023, 'binary_f1_score': 0.56}
confusion matrix:
      0    1
0  5792  154
1    99  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_10.png
early stop counter: 4
val acc:0.9566168785095215, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 10,now: 2024-06-25 20:01:02.019371,epoch time: 0:24:45.110728,used: 4:39:35.486937,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9496059, 'precision': 0.94846714, 'recall': 0.91656554, 'specificity': 0.91656554, 'f1': 0.9310683, 'auroc': 0.98112416, 'binary_precision': 0.94637614, 'binary_recall': 0.8494937, 'binary_specificity': 0.98363745, 'binary_f1_score': 0.8953216}
confusion matrix:
       0      1
0  41720    694
1   2170  12248
---- Validation: 
scalar performance:
{'acc': 0.95624334, 'precision': 0.695037, 'recall': 0.73268527, 'specificity': 0.73268527, 'f1': 0.7119573, 'auroc': 0.882503, 'binary_precision': 0.40914708, 'binary_recall': 0.49182764, 'binary_specificity': 0.9735429, 'binary_f1_score': 0.44669363}
confusion matrix:
       0    1
0  17589  478
1    342  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7472474, 'recall': 0.8003435, 'specificity': 0.8003435, 'f1': 0.77082944, 'auroc': 0.9180283, 'binary_precision': 0.5109718, 'binary_recall': 0.6269231, 'binary_specificity': 0.9737639, 'binary_f1_score': 0.5630397}
confusion matrix:
      0    1
0  5790  156
1    97  163
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_11.png
early stop counter: 5
val acc:0.9562433362007141, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 11,now: 2024-06-25 20:27:25.312618,epoch time: 0:26:23.293247,used: 5:05:58.780184,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95096076, 'precision': 0.94718915, 'recall': 0.9214608, 'specificity': 0.9214608, 'f1': 0.93337345, 'auroc': 0.98219454, 'binary_precision': 0.94013923, 'binary_recall': 0.86157155, 'binary_specificity': 0.98135006, 'binary_f1_score': 0.89914227}
confusion matrix:
       0      1
0  41622    791
1   1996  12423
---- Validation: 
scalar performance:
{'acc': 0.95565635, 'precision': 0.69397914, 'recall': 0.74096406, 'specificity': 0.74096406, 'f1': 0.7145506, 'auroc': 0.88425434, 'binary_precision': 0.40639812, 'binary_recall': 0.5096582, 'binary_specificity': 0.9722699, 'binary_f1_score': 0.4522083}
confusion matrix:
       0    1
0  17566  501
1    330  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7422461, 'recall': 0.81078875, 'specificity': 0.81078875, 'f1': 0.7716048, 'auroc': 0.9188155, 'binary_precision': 0.5, 'binary_recall': 0.65, 'binary_specificity': 0.9715775, 'binary_f1_score': 0.5652174}
confusion matrix:
      0    1
0  5777  169
1    91  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_12.png
early stop counter: 6
val acc:0.9556563496589661, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 12,now: 2024-06-25 20:51:23.235522,epoch time: 0:23:57.922904,used: 5:29:56.703088,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9520693, 'precision': 0.9476143, 'recall': 0.92405736, 'specificity': 0.92405736, 'f1': 0.9350373, 'auroc': 0.9822436, 'binary_precision': 0.93923235, 'binary_recall': 0.8671891, 'binary_specificity': 0.9809257, 'binary_f1_score': 0.90177405}
confusion matrix:
       0      1
0  41604    809
1   1915  12504
---- Validation: 
scalar performance:
{'acc': 0.9548559, 'precision': 0.69127846, 'recall': 0.7448405, 'specificity': 0.7448405, 'f1': 0.71426535, 'auroc': 0.8851621, 'binary_precision': 0.40068886, 'binary_recall': 0.5185735, 'binary_specificity': 0.97110754, 'binary_f1_score': 0.4520725}
confusion matrix:
       0    1
0  17545  522
1    324  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.73485976, 'recall': 0.81721973, 'specificity': 0.81721973, 'f1': 0.76890105, 'auroc': 0.9186085, 'binary_precision': 0.48459384, 'binary_recall': 0.6653846, 'binary_specificity': 0.9690548, 'binary_f1_score': 0.56077796}
confusion matrix:
      0    1
0  5762  184
1    87  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_13.png
early stop counter: 7
val acc:0.9548559188842773, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 13,now: 2024-06-25 21:17:03.970074,epoch time: 0:25:40.734552,used: 5:55:37.437640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9527027, 'precision': 0.9500381, 'recall': 0.9233648, 'specificity': 0.9233648, 'f1': 0.9356881, 'auroc': 0.9830723, 'binary_precision': 0.9450683, 'binary_recall': 0.8638003, 'binary_specificity': 0.98292935, 'binary_f1_score': 0.9026087}
confusion matrix:
       0      1
0  41688    724
1   1964  12456
---- Validation: 
scalar performance:
{'acc': 0.95565635, 'precision': 0.69466174, 'recall': 0.7445404, 'specificity': 0.7445404, 'f1': 0.71634114, 'auroc': 0.8854953, 'binary_precision': 0.40749416, 'binary_recall': 0.51708764, 'binary_specificity': 0.97199315, 'binary_f1_score': 0.4557957}
confusion matrix:
       0    1
0  17561  506
1    325  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.740424, 'recall': 0.81789243, 'specificity': 0.81789243, 'f1': 0.77293104, 'auroc': 0.91898286, 'binary_precision': 0.495702, 'binary_recall': 0.6653846, 'binary_specificity': 0.9704003, 'binary_f1_score': 0.5681445}
confusion matrix:
      0    1
0  5770  176
1    87  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_14.png
early stop counter: 8
val acc:0.9556563496589661, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 14,now: 2024-06-25 21:41:57.464714,epoch time: 0:24:53.494640,used: 6:20:30.932280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9533889, 'precision': 0.9514117, 'recall': 0.9238658, 'specificity': 0.9238658, 'f1': 0.9365633, 'auroc': 0.98394084, 'binary_precision': 0.9477328, 'binary_recall': 0.8639295, 'binary_specificity': 0.98380214, 'binary_f1_score': 0.9038929}
confusion matrix:
       0      1
0  41726    687
1   1962  12457
---- Validation: 
scalar performance:
{'acc': 0.9552828, 'precision': 0.6914494, 'recall': 0.7364787, 'specificity': 0.7364787, 'f1': 0.71123433, 'auroc': 0.8847108, 'binary_precision': 0.40166867, 'binary_recall': 0.5007429, 'binary_specificity': 0.9722145, 'binary_f1_score': 0.4457672}
confusion matrix:
       0    1
0  17565  502
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.74232864, 'recall': 0.8126278, 'specificity': 0.8126278, 'f1': 0.77232754, 'auroc': 0.9184338, 'binary_precision': 0.5, 'binary_recall': 0.65384614, 'binary_specificity': 0.9714094, 'binary_f1_score': 0.56666666}
confusion matrix:
      0    1
0  5776  170
1    90  170
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_15.png
early stop counter: 9
val acc:0.9552828073501587, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 15,now: 2024-06-25 22:08:17.228438,epoch time: 0:26:19.763724,used: 6:46:50.696004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9548318, 'precision': 0.95086265, 'recall': 0.9283156, 'specificity': 0.9283156, 'f1': 0.9388635, 'auroc': 0.9847537, 'binary_precision': 0.943368, 'binary_recall': 0.8744799, 'binary_specificity': 0.98215127, 'binary_f1_score': 0.90761864}
confusion matrix:
       0      1
0  41655    757
1   1810  12610
---- Validation: 
scalar performance:
{'acc': 0.9528815, 'precision': 0.68401223, 'recall': 0.74810815, 'specificity': 0.74810815, 'f1': 0.71054745, 'auroc': 0.8855392, 'binary_precision': 0.38586956, 'binary_recall': 0.5274888, 'binary_specificity': 0.9687275, 'binary_f1_score': 0.44569993}
confusion matrix:
       0    1
0  17502  565
1    318  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95294875, 'precision': 0.722144, 'recall': 0.82280976, 'specificity': 0.82280976, 'f1': 0.7615851, 'auroc': 0.9189637, 'binary_precision': 0.45854923, 'binary_recall': 0.6807692, 'binary_specificity': 0.9648503, 'binary_f1_score': 0.5479876}
confusion matrix:
      0    1
0  5737  209
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_16.png
early stop counter: 10
val acc:0.9528815150260925, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 16,now: 2024-06-25 22:29:27.624820,epoch time: 0:21:10.396382,used: 7:08:01.092386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9560635, 'precision': 0.95214164, 'recall': 0.9303726, 'specificity': 0.9303726, 'f1': 0.94058275, 'auroc': 0.98516834, 'binary_precision': 0.944718, 'binary_recall': 0.87821627, 'binary_specificity': 0.9825289, 'binary_f1_score': 0.9102541}
confusion matrix:
       0      1
0  41672    741
1   1756  12663
---- Validation: 
scalar performance:
{'acc': 0.9519744, 'precision': 0.6811244, 'recall': 0.7504988, 'specificity': 0.7504988, 'f1': 0.7093308, 'auroc': 0.8856814, 'binary_precision': 0.37989417, 'binary_recall': 0.53343236, 'binary_specificity': 0.9675652, 'binary_f1_score': 0.44375774}
confusion matrix:
       0    1
0  17481  586
1    314  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95198196, 'precision': 0.71862733, 'recall': 0.8223052, 'specificity': 0.8223052, 'f1': 0.7588023, 'auroc': 0.9184668, 'binary_precision': 0.4515306, 'binary_recall': 0.6807692, 'binary_specificity': 0.96384126, 'binary_f1_score': 0.5429448}
confusion matrix:
      0    1
0  5731  215
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_17.png
early stop counter: 11
val acc:0.9519743919372559, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 17,now: 2024-06-25 22:50:16.007550,epoch time: 0:20:48.382730,used: 7:28:49.475116,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.95616907, 'precision': 0.9522203, 'recall': 0.9305806, 'specificity': 0.9305806, 'f1': 0.9407341, 'auroc': 0.98576224, 'binary_precision': 0.94474274, 'binary_recall': 0.87863237, 'binary_specificity': 0.9825289, 'binary_f1_score': 0.910489}
confusion matrix:
       0      1
0  41672    741
1   1750  12669
---- Validation: 
scalar performance:
{'acc': 0.95101386, 'precision': 0.6785108, 'recall': 0.75429225, 'specificity': 0.75429225, 'f1': 0.7086708, 'auroc': 0.88532174, 'binary_precision': 0.37435898, 'binary_recall': 0.54234767, 'binary_specificity': 0.96623677, 'binary_f1_score': 0.44296113}
confusion matrix:
       0    1
0  17457  610
1    308  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94956493, 'precision': 0.7105313, 'recall': 0.8228829, 'specificity': 0.8228829, 'f1': 0.7527417, 'auroc': 0.9179125, 'binary_precision': 0.4352078, 'binary_recall': 0.6846154, 'binary_specificity': 0.96115035, 'binary_f1_score': 0.5321375}
confusion matrix:
      0    1
0  5715  231
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_18.png
early stop counter: 12
val acc:0.9510138630867004, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 18,now: 2024-06-25 23:15:28.876926,epoch time: 0:25:12.869376,used: 7:54:02.344492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9584565, 'precision': 0.95377135, 'recall': 0.9352488, 'specificity': 0.9352488, 'f1': 0.9440224, 'auroc': 0.9867325, 'binary_precision': 0.9448133, 'binary_recall': 0.8881337, 'binary_specificity': 0.9823639, 'binary_f1_score': 0.9155972}
confusion matrix:
       0      1
0  41665    748
1   1613  12806
---- Validation: 
scalar performance:
{'acc': 0.94909286, 'precision': 0.67312855, 'recall': 0.75901806, 'specificity': 0.75901806, 'f1': 0.7060803, 'auroc': 0.8849497, 'binary_precision': 0.36319378, 'binary_recall': 0.55423474, 'binary_specificity': 0.9638014, 'binary_f1_score': 0.43882355}
confusion matrix:
       0    1
0  17413  654
1    300  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9471479, 'precision': 0.70362645, 'recall': 0.8271384, 'specificity': 0.8271384, 'f1': 0.74832803, 'auroc': 0.9173614, 'binary_precision': 0.42093024, 'binary_recall': 0.6961538, 'binary_specificity': 0.9581231, 'binary_f1_score': 0.5246377}
confusion matrix:
      0    1
0  5697  249
1    79  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_19.png
early stop counter: 13
val acc:0.9490928649902344, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 19,now: 2024-06-25 23:36:32.426964,epoch time: 0:21:03.550038,used: 8:15:05.894530,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9588436, 'precision': 0.9546397, 'recall': 0.9354203, 'specificity': 0.9354203, 'f1': 0.9445065, 'auroc': 0.98651016, 'binary_precision': 0.94661736, 'binary_recall': 0.88786405, 'binary_specificity': 0.9829765, 'binary_f1_score': 0.9162998}
confusion matrix:
       0      1
0  41690    722
1   1617  12803
---- Validation: 
scalar performance:
{'acc': 0.94893277, 'precision': 0.6729194, 'recall': 0.7603656, 'specificity': 0.7603656, 'f1': 0.70630765, 'auroc': 0.8861577, 'binary_precision': 0.36266926, 'binary_recall': 0.5572065, 'binary_specificity': 0.96352464, 'binary_f1_score': 0.43936732}
confusion matrix:
       0    1
0  17408  659
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9469868, 'precision': 0.7034061, 'recall': 0.82889336, 'specificity': 0.82889336, 'f1': 0.7485892, 'auroc': 0.917613, 'binary_precision': 0.4203233, 'binary_recall': 0.7, 'binary_specificity': 0.95778674, 'binary_f1_score': 0.5252525}
confusion matrix:
      0    1
0  5695  251
1    78  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_20.png
early stop counter: 14
val acc:0.9489327669143677, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 20,now: 2024-06-25 23:56:31.422908,epoch time: 0:19:58.995944,used: 8:35:04.890474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9590372, 'precision': 0.9537252, 'recall': 0.9369002, 'specificity': 0.9369002, 'f1': 0.94490933, 'auroc': 0.9866725, 'binary_precision': 0.94351524, 'binary_recall': 0.8919556, 'binary_specificity': 0.9818448, 'binary_f1_score': 0.9170112}
confusion matrix:
       0      1
0  41642    770
1   1558  12862
---- Validation: 
scalar performance:
{'acc': 0.94743866, 'precision': 0.66861975, 'recall': 0.7617365, 'specificity': 0.7617365, 'f1': 0.7033361, 'auroc': 0.88637745, 'binary_precision': 0.3539326, 'binary_recall': 0.56166416, 'binary_specificity': 0.9618088, 'binary_f1_score': 0.43423322}
confusion matrix:
       0    1
0  17377  690
1    295  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9456977, 'precision': 0.7004236, 'recall': 0.8337376, 'specificity': 0.8337376, 'f1': 0.74727345, 'auroc': 0.9176414, 'binary_precision': 0.41387025, 'binary_recall': 0.71153843, 'binary_specificity': 0.9559368, 'binary_f1_score': 0.5233381}
confusion matrix:
      0    1
0  5684  262
1    75  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_21.png
early stop counter: 15
val acc:0.947438657283783, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 21,now: 2024-06-26 00:18:38.248880,epoch time: 0:22:06.825972,used: 8:57:11.716446,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9569257, 'precision': 0.95471025, 'recall': 0.9301533, 'specificity': 0.9301533, 'f1': 0.9415824, 'auroc': 0.9861214, 'binary_precision': 0.9505494, 'binary_recall': 0.8757975, 'binary_specificity': 0.9845091, 'binary_f1_score': 0.91164374}
confusion matrix:
       0      1
0  41755    657
1   1791  12629
---- Validation: 
scalar performance:
{'acc': 0.9515475, 'precision': 0.6784171, 'recall': 0.7452705, 'specificity': 0.7452705, 'f1': 0.70570475, 'auroc': 0.8854749, 'binary_precision': 0.37486687, 'binary_recall': 0.5230312, 'binary_specificity': 0.9675098, 'binary_f1_score': 0.43672454}
confusion matrix:
       0    1
0  17480  587
1    321  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9521431, 'precision': 0.7190009, 'recall': 0.8205503, 'specificity': 0.8205503, 'f1': 0.7585621, 'auroc': 0.9170463, 'binary_precision': 0.45244217, 'binary_recall': 0.6769231, 'binary_specificity': 0.9641776, 'binary_f1_score': 0.5423729}
confusion matrix:
      0    1
0  5733  213
1    84  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_22.png
early stop counter: 16
val acc:0.9515475034713745, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 22,now: 2024-06-26 00:40:53.180732,epoch time: 0:22:14.931852,used: 9:19:26.648298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.95928353, 'precision': 0.9539741, 'recall': 0.93731344, 'specificity': 0.93731344, 'f1': 0.9452486, 'auroc': 0.9875566, 'binary_precision': 0.9437642, 'binary_recall': 0.892711, 'binary_specificity': 0.98191595, 'binary_f1_score': 0.917528}
confusion matrix:
       0      1
0  41646    767
1   1547  12872
---- Validation: 
scalar performance:
{'acc': 0.9464781, 'precision': 0.66584516, 'recall': 0.7619536, 'specificity': 0.7619536, 'f1': 0.7011785, 'auroc': 0.8862959, 'binary_precision': 0.34834558, 'binary_recall': 0.56315005, 'binary_specificity': 0.9607572, 'binary_f1_score': 0.4304372}
confusion matrix:
       0    1
0  17358  709
1    294  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94521433, 'precision': 0.69875765, 'recall': 0.8316463, 'specificity': 0.8316463, 'f1': 0.74536204, 'auroc': 0.9171524, 'binary_precision': 0.4107143, 'binary_recall': 0.7076923, 'binary_specificity': 0.9556004, 'binary_f1_score': 0.519774}
confusion matrix:
      0    1
0  5682  264
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_23.png
early stop counter: 17
val acc:0.9464781284332275, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 23,now: 2024-06-26 01:00:33.330584,epoch time: 0:19:40.149852,used: 9:39:06.798150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.959653, 'precision': 0.95573306, 'recall': 0.9365119, 'specificity': 0.9365119, 'f1': 0.9456005, 'auroc': 0.9873156, 'binary_precision': 0.94825166, 'binary_recall': 0.88952845, 'binary_specificity': 0.98349524, 'binary_f1_score': 0.9179519}
confusion matrix:
       0      1
0  41712    700
1   1593  12827
---- Validation: 
scalar performance:
{'acc': 0.94695836, 'precision': 0.66613305, 'recall': 0.75719583, 'specificity': 0.75719583, 'f1': 0.7001339, 'auroc': 0.8854041, 'binary_precision': 0.34929577, 'binary_recall': 0.55274886, 'binary_specificity': 0.9616428, 'binary_f1_score': 0.42807823}
confusion matrix:
       0    1
0  17374  693
1    301  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94521433, 'precision': 0.6973164, 'recall': 0.8224514, 'specificity': 0.8224514, 'f1': 0.7419344, 'auroc': 0.91662395, 'binary_precision': 0.4086758, 'binary_recall': 0.68846154, 'binary_specificity': 0.9564413, 'binary_f1_score': 0.512894}
confusion matrix:
      0    1
0  5687  259
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_24.png
early stop counter: 18
val acc:0.9469583630561829, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 24,now: 2024-06-26 01:19:56.210280,epoch time: 0:19:22.879696,used: 9:58:29.677846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9607967, 'precision': 0.9568471, 'recall': 0.9384875, 'specificity': 0.9384875, 'f1': 0.9471922, 'auroc': 0.98779976, 'binary_precision': 0.9492887, 'binary_recall': 0.89319646, 'binary_specificity': 0.98377854, 'binary_f1_score': 0.92038876}
confusion matrix:
       0      1
0  41725    688
1   1540  12879
---- Validation: 
scalar performance:
{'acc': 0.9453575, 'precision': 0.66185254, 'recall': 0.75851136, 'specificity': 0.75851136, 'f1': 0.69704735, 'auroc': 0.88562655, 'binary_precision': 0.34059945, 'binary_recall': 0.5572065, 'binary_specificity': 0.9598162, 'binary_f1_score': 0.4227734}
confusion matrix:
       0    1
0  17341  726
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9434418, 'precision': 0.693522, 'recall': 0.82888234, 'specificity': 0.82888234, 'f1': 0.7402237, 'auroc': 0.9167262, 'binary_precision': 0.40043762, 'binary_recall': 0.70384616, 'binary_specificity': 0.9539186, 'binary_f1_score': 0.51046026}
confusion matrix:
      0    1
0  5672  274
1    77  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_25.png
early stop counter: 19
val acc:0.9453575015068054, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 25,now: 2024-06-26 01:39:38.023374,epoch time: 0:19:41.813094,used: 10:18:11.490940,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96048003, 'precision': 0.95663524, 'recall': 0.93784046, 'specificity': 0.93784046, 'f1': 0.9467399, 'auroc': 0.986915, 'binary_precision': 0.94928765, 'binary_recall': 0.8918788, 'binary_specificity': 0.98380214, 'binary_f1_score': 0.91968817}
confusion matrix:
       0      1
0  41726    687
1   1559  12860
---- Validation: 
scalar performance:
{'acc': 0.947492, 'precision': 0.667626, 'recall': 0.75675726, 'specificity': 0.75675726, 'f1': 0.70118713, 'auroc': 0.8859887, 'binary_precision': 0.3523267, 'binary_recall': 0.551263, 'binary_specificity': 0.9622516, 'binary_f1_score': 0.4298957}
confusion matrix:
       0    1
0  17385  682
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94585884, 'precision': 0.69891775, 'recall': 0.8209488, 'specificity': 0.8209488, 'f1': 0.74289095, 'auroc': 0.91620934, 'binary_precision': 0.41203704, 'binary_recall': 0.6846154, 'binary_specificity': 0.9572822, 'binary_f1_score': 0.5144509}
confusion matrix:
      0    1
0  5692  254
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_26.png
early stop counter: 20
val acc:0.9474920034408569, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 26,now: 2024-06-26 01:59:17.497342,epoch time: 0:19:39.473968,used: 10:37:50.964908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96069115, 'precision': 0.95548934, 'recall': 0.9396103, 'specificity': 0.9396103, 'f1': 0.947192, 'auroc': 0.9876799, 'binary_precision': 0.94545984, 'binary_recall': 0.89681, 'binary_specificity': 0.9824106, 'binary_f1_score': 0.92049253}
confusion matrix:
       0      1
0  41666    746
1   1488  12932
---- Validation: 
scalar performance:
{'acc': 0.94295627, 'precision': 0.6569004, 'recall': 0.7644187, 'specificity': 0.7644187, 'f1': 0.69435614, 'auroc': 0.887198, 'binary_precision': 0.3301887, 'binary_recall': 0.57206535, 'binary_specificity': 0.956772, 'binary_f1_score': 0.4187058}
confusion matrix:
       0    1
0  17286  781
1    288  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9395746, 'precision': 0.6848221, 'recall': 0.8342202, 'specificity': 0.8342202, 'f1': 0.73358977, 'auroc': 0.9166026, 'binary_precision': 0.3824131, 'binary_recall': 0.7192308, 'binary_specificity': 0.9492096, 'binary_f1_score': 0.49933246}
confusion matrix:
      0    1
0  5644  302
1    73  187
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_27.png
early stop counter: 21
val acc:0.942956268787384, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 27,now: 2024-06-26 02:18:24.785621,epoch time: 0:19:07.288279,used: 10:56:58.253187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9616589, 'precision': 0.9556773, 'recall': 0.9420895, 'specificity': 0.9420895, 'f1': 0.9486208, 'auroc': 0.9884627, 'binary_precision': 0.9440615, 'binary_recall': 0.9023578, 'binary_specificity': 0.9818212, 'binary_f1_score': 0.9227387}
confusion matrix:
       0      1
0  41641    771
1   1408  13012
---- Validation: 
scalar performance:
{'acc': 0.94098186, 'precision': 0.65251017, 'recall': 0.7662558, 'specificity': 0.7662558, 'f1': 0.69094014, 'auroc': 0.88721037, 'binary_precision': 0.32122213, 'binary_recall': 0.5780089, 'binary_specificity': 0.9545027, 'binary_f1_score': 0.41295114}
confusion matrix:
       0    1
0  17245  822
1    284  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93683535, 'precision': 0.67906165, 'recall': 0.8364686, 'specificity': 0.8364686, 'f1': 0.728619, 'auroc': 0.9164862, 'binary_precision': 0.37058824, 'binary_recall': 0.72692305, 'binary_specificity': 0.9460141, 'binary_f1_score': 0.49090907}
confusion matrix:
      0    1
0  5625  321
1    71  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_28.png
early stop counter: 22
val acc:0.9409818649291992, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 28,now: 2024-06-26 02:37:28.426152,epoch time: 0:19:03.640531,used: 11:16:01.893718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9620812, 'precision': 0.9559319, 'recall': 0.9429903, 'specificity': 0.9429903, 'f1': 0.9492229, 'auroc': 0.9888246, 'binary_precision': 0.94396585, 'binary_recall': 0.90423024, 'binary_specificity': 0.9817504, 'binary_f1_score': 0.92367095}
confusion matrix:
       0      1
0  41638    774
1   1381  13039
---- Validation: 
scalar performance:
{'acc': 0.9431163, 'precision': 0.6569811, 'recall': 0.7630712, 'specificity': 0.7630712, 'f1': 0.6941094, 'auroc': 0.8868692, 'binary_precision': 0.3304573, 'binary_recall': 0.5690936, 'binary_specificity': 0.9570488, 'binary_f1_score': 0.41812226}
confusion matrix:
       0    1
0  17291  776
1    290  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9398969, 'precision': 0.6849589, 'recall': 0.83071035, 'specificity': 0.83071035, 'f1': 0.733008, 'auroc': 0.9155696, 'binary_precision': 0.3830228, 'binary_recall': 0.71153843, 'binary_specificity': 0.94988227, 'binary_f1_score': 0.4979812}
confusion matrix:
      0    1
0  5648  298
1    75  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_29.png
early stop counter: 23
val acc:0.943116307258606, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 29,now: 2024-06-26 02:56:34.642432,epoch time: 0:19:06.216280,used: 11:35:08.109998,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9602513, 'precision': 0.95702755, 'recall': 0.9368065, 'specificity': 0.9368065, 'f1': 0.94634235, 'auroc': 0.98840964, 'binary_precision': 0.9508939, 'binary_recall': 0.8892203, 'binary_specificity': 0.9843927, 'binary_f1_score': 0.9190236}
confusion matrix:
       0      1
0  41754    662
1   1597  12819
---- Validation: 
scalar performance:
{'acc': 0.94701177, 'precision': 0.66612875, 'recall': 0.75650823, 'specificity': 0.75650823, 'f1': 0.69994277, 'auroc': 0.8859701, 'binary_precision': 0.34934086, 'binary_recall': 0.551263, 'binary_specificity': 0.9617535, 'binary_f1_score': 0.42766568}
confusion matrix:
       0    1
0  17376  691
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94505316, 'precision': 0.6968497, 'recall': 0.8223673, 'specificity': 0.8223673, 'f1': 0.7415236, 'auroc': 0.9151414, 'binary_precision': 0.40774488, 'binary_recall': 0.68846154, 'binary_specificity': 0.95627314, 'binary_f1_score': 0.5121602}
confusion matrix:
      0    1
0  5686  260
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_30.png
early stop counter: 24
val acc:0.9470117688179016, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9613277316093445 / 0.9613277316093445
after epoch: 30,now: 2024-06-26 03:15:37.755750,epoch time: 0:19:03.113318,used: 11:54:11.223316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:54:11.223316 at 2024-06-26 03:15:37.755750
persisted model performance metric: 

scalar performance:
{'acc': 0.96132773, 'precision': 0.7605548, 'recall': 0.7297162, 'specificity': 0.7297162, 'f1': 0.74403465, 'auroc': 0.9111801, 'binary_precision': 0.54385966, 'binary_recall': 0.47692308, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.5081968}
confusion matrix:
      0    1
0  5842  104
1   136  124
oracle model performance metric: 

scalar performance:
{'acc': 0.96132773, 'precision': 0.7605548, 'recall': 0.7297162, 'specificity': 0.7297162, 'f1': 0.74403465, 'auroc': 0.9111801, 'binary_precision': 0.54385966, 'binary_recall': 0.47692308, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.5081968}
confusion matrix:
      0    1
0  5842  104
1   136  124
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190959 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  17465 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190959 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  17465 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189280 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  16466 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    792 MiB | 284672 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     54 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40464 KiB |  87618 KiB |    825 TiB |    825 TiB |
|       from large pool |  31306 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |   9158 KiB |  20341 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2942    |    7613    |  314084 K  |  314081 K  |
|       from large pool |      76    |     158    |  145894 K  |  145894 K  |
|       from small pool |    2866    |    7535    |  168189 K  |  168186 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2942    |    7613    |  314084 K  |  314081 K  |
|       from large pool |      76    |     158    |  145894 K  |  145894 K  |
|       from small pool |    2866    |    7535    |  168189 K  |  168186 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      60    |      19    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3584    |  175769 K  |  175769 K  |
|       from large pool |      10    |      22    |   87846 K  |   87846 K  |
|       from small pool |      22    |    3576    |   87922 K  |   87922 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |    792 MiB | 579584 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  26624 KiB |  43008 KiB |     54 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87618 KiB |    825 TiB |    825 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |      0 KiB |  21236 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  314084 K  |  314084 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168189 K  |  168189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  314084 K  |  314084 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168189 K  |  168189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      60    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      13    |      21    |      27    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3584    |  175770 K  |  175770 K  |
|       from large pool |       3    |      22    |   87846 K  |   87846 K  |
|       from small pool |       0    |    3576    |   87923 K  |   87923 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |    792 MiB | 579584 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  26624 KiB |  43008 KiB |     54 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87618 KiB |    825 TiB |    825 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |      0 KiB |  21236 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  314084 K  |  314084 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168189 K  |  168189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  314084 K  |  314084 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168189 K  |  168189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      60    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      13    |      21    |      27    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3584    |  175770 K  |  175770 K  |
|       from large pool |       3    |      22    |   87846 K  |   87846 K  |
|       from small pool |       0    |    3576    |   87923 K  |   87923 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223

 Experiment start at: 2024-06-26 03:23:27.685361
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.87251043, 'precision': 0.86668617, 'recall': 0.7910818, 'specificity': 0.7910818, 'f1': 0.818239, 'auroc': 0.9227388, 'binary_precision': 0.8572867, 'binary_recall': 0.61900985, 'binary_specificity': 0.9631538, 'binary_f1_score': 0.71891916}
confusion matrix:
       0     1
0  40752  1559
1   5764  9365
---- Validation: 
scalar performance:
{'acc': 0.9078464, 'precision': 0.57351494, 'recall': 0.6938151, 'specificity': 0.6938151, 'f1': 0.59773594, 'auroc': 0.8023678, 'binary_precision': 0.16587678, 'binary_recall': 0.4651163, 'binary_specificity': 0.9225139, 'binary_f1_score': 0.24454148}
confusion matrix:
       0     1
0  16763  1408
1    322   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418016, 'precision': 0.5189134, 'recall': 0.5608156, 'specificity': 0.5608156, 'f1': 0.51239043, 'auroc': 0.68442285, 'binary_precision': 0.07134637, 'binary_recall': 0.25619835, 'binary_specificity': 0.86543274, 'binary_f1_score': 0.11161116}
confusion matrix:
      0    1
0  5190  807
1   180   62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-26 03:43:22.042454,epoch time: 0:19:54.357093,used: 0:19:54.357093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90689415, 'precision': 0.9032042, 'recall': 0.85029006, 'specificity': 0.85029006, 'f1': 0.87202764, 'auroc': 0.9501852, 'binary_precision': 0.8967391, 'binary_recall': 0.73066753, 'binary_specificity': 0.9699125, 'binary_f1_score': 0.80522984}
confusion matrix:
       0      1
0  41037   1273
1   4075  11055
---- Validation: 
scalar performance:
{'acc': 0.93511957, 'precision': 0.6121191, 'recall': 0.7151309, 'specificity': 0.7151309, 'f1': 0.6438782, 'auroc': 0.8369796, 'binary_precision': 0.24204355, 'binary_recall': 0.48006645, 'binary_specificity': 0.9501954, 'binary_f1_score': 0.32182628}
confusion matrix:
       0    1
0  17266  905
1    313  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89501524, 'precision': 0.5533561, 'recall': 0.61823714, 'specificity': 0.61823714, 'f1': 0.5671134, 'auroc': 0.7903284, 'binary_precision': 0.13580246, 'binary_recall': 0.3181818, 'binary_specificity': 0.91829246, 'binary_f1_score': 0.19035846}
confusion matrix:
      0    1
0  5507  490
1   165   77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-26 04:02:57.609194,epoch time: 0:19:35.566740,used: 0:39:29.923833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9248607, 'precision': 0.9201589, 'recall': 0.8820592, 'specificity': 0.8820592, 'f1': 0.8987484, 'auroc': 0.9622961, 'binary_precision': 0.91149163, 'binary_recall': 0.79160607, 'binary_specificity': 0.9725124, 'binary_f1_score': 0.8473293}
confusion matrix:
       0      1
0  41147   1163
1   3153  11977
---- Validation: 
scalar performance:
{'acc': 0.94097906, 'precision': 0.62869805, 'recall': 0.7326126, 'specificity': 0.7326126, 'f1': 0.6628165, 'auroc': 0.8534839, 'binary_precision': 0.27410713, 'binary_recall': 0.5099668, 'binary_specificity': 0.95525837, 'binary_f1_score': 0.3565621}
confusion matrix:
       0    1
0  17358  813
1    295  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9078378, 'precision': 0.5884764, 'recall': 0.69232035, 'specificity': 0.69232035, 'f1': 0.61465967, 'auroc': 0.8364769, 'binary_precision': 0.2, 'binary_recall': 0.45867768, 'binary_specificity': 0.925963, 'binary_f1_score': 0.27854452}
confusion matrix:
      0    1
0  5553  444
1   131  111
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-26 04:22:52.247412,epoch time: 0:19:54.638218,used: 0:59:24.562051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9302577, 'precision': 0.9294723, 'recall': 0.8874571, 'specificity': 0.8874571, 'f1': 0.90568745, 'auroc': 0.96634805, 'binary_precision': 0.9280382, 'binary_recall': 0.7970124, 'binary_specificity': 0.97790176, 'binary_f1_score': 0.8575493}
confusion matrix:
       0      1
0  41376    935
1   3071  12058
---- Validation: 
scalar performance:
{'acc': 0.9487562, 'precision': 0.6468768, 'recall': 0.72779644, 'specificity': 0.72779644, 'f1': 0.67711216, 'auroc': 0.8615893, 'binary_precision': 0.31092438, 'binary_recall': 0.49169436, 'binary_specificity': 0.96389854, 'binary_f1_score': 0.3809524}
confusion matrix:
       0    1
0  17515  656
1    306  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.928995, 'precision': 0.6205848, 'recall': 0.70530856, 'specificity': 0.70530856, 'f1': 0.6491623, 'auroc': 0.85575503, 'binary_precision': 0.26352942, 'binary_recall': 0.46280992, 'binary_specificity': 0.94780725, 'binary_f1_score': 0.3358321}
confusion matrix:
      0    1
0  5684  313
1   130  112
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-26 04:42:23.997312,epoch time: 0:19:31.749900,used: 1:18:56.311951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9336525, 'precision': 0.9331792, 'recall': 0.8928551, 'specificity': 0.8928551, 'f1': 0.9104823, 'auroc': 0.96911955, 'binary_precision': 0.93230957, 'binary_recall': 0.8066499, 'binary_specificity': 0.9790603, 'binary_f1_score': 0.8649395}
confusion matrix:
       0      1
0  41426    886
1   2925  12203
---- Validation: 
scalar performance:
{'acc': 0.9525915, 'precision': 0.65790015, 'recall': 0.7233532, 'specificity': 0.7233532, 'f1': 0.6841192, 'auroc': 0.86668336, 'binary_precision': 0.33333334, 'binary_recall': 0.47840533, 'binary_specificity': 0.9683011, 'binary_f1_score': 0.39290586}
confusion matrix:
       0    1
0  17595  576
1    314  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9373297, 'precision': 0.6390532, 'recall': 0.7096441, 'specificity': 0.7096441, 'f1': 0.66563404, 'auroc': 0.86786026, 'binary_precision': 0.30026808, 'binary_recall': 0.46280992, 'binary_specificity': 0.95647824, 'binary_f1_score': 0.36422765}
confusion matrix:
      0    1
0  5736  261
1   130  112
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-26 05:01:45.292932,epoch time: 0:19:21.295620,used: 1:38:17.607571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9377263, 'precision': 0.93394125, 'recall': 0.90282947, 'specificity': 0.90282947, 'f1': 0.9168622, 'auroc': 0.9719331, 'binary_precision': 0.9267824, 'binary_recall': 0.8290813, 'binary_specificity': 0.97657764, 'binary_f1_score': 0.8752137}
confusion matrix:
       0      1
0  41319    991
1   2586  12544
---- Validation: 
scalar performance:
{'acc': 0.9487562, 'precision': 0.650172, 'recall': 0.7398422, 'specificity': 0.7398422, 'f1': 0.68296313, 'auroc': 0.871817, 'binary_precision': 0.3167006, 'binary_recall': 0.5166113, 'binary_specificity': 0.963073, 'binary_f1_score': 0.39267674}
confusion matrix:
       0    1
0  17500  671
1    291  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9325212, 'precision': 0.6446912, 'recall': 0.76662505, 'specificity': 0.76662505, 'f1': 0.68353856, 'auroc': 0.877651, 'binary_precision': 0.30669546, 'binary_recall': 0.58677685, 'binary_specificity': 0.94647324, 'binary_f1_score': 0.4028369}
confusion matrix:
      0    1
0  5676  321
1   100  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_6.png
early stop counter: 1
val acc:0.948756217956543, best validation acc: 0.9525914788246155, corresponding to test acc:                         0.9373297095298767 / 0.9373297095298767
after epoch: 6,now: 2024-06-26 05:21:20.949358,epoch time: 0:19:35.656426,used: 1:57:53.263997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9390843, 'precision': 0.93970895, 'recall': 0.900922, 'specificity': 0.900922, 'f1': 0.9180105, 'auroc': 0.9741715, 'binary_precision': 0.94086426, 'binary_recall': 0.82027894, 'binary_specificity': 0.98156506, 'binary_f1_score': 0.8764434}
confusion matrix:
       0      1
0  41531    780
1   2719  12410
---- Validation: 
scalar performance:
{'acc': 0.9545624, 'precision': 0.6670303, 'recall': 0.73079574, 'specificity': 0.73079574, 'f1': 0.69303024, 'auroc': 0.87480915, 'binary_precision': 0.35112694, 'binary_recall': 0.49169436, 'binary_specificity': 0.9698971, 'binary_f1_score': 0.4096886}
confusion matrix:
       0    1
0  17624  547
1    306  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9434204, 'precision': 0.66614187, 'recall': 0.75048435, 'specificity': 0.75048435, 'f1': 0.6981299, 'auroc': 0.88333833, 'binary_precision': 0.35120642, 'binary_recall': 0.5413223, 'binary_specificity': 0.95964646, 'binary_f1_score': 0.42601624}
confusion matrix:
      0    1
0  5755  242
1   111  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-26 05:42:06.221543,epoch time: 0:20:45.272185,used: 2:18:38.536182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94566506, 'precision': 0.9420878, 'recall': 0.9158397, 'specificity': 0.9158397, 'f1': 0.92789865, 'auroc': 0.9765347, 'binary_precision': 0.9352033, 'binary_recall': 0.852809, 'binary_specificity': 0.9788703, 'binary_f1_score': 0.8921078}
confusion matrix:
       0      1
0  41416    894
1   2227  12903
---- Validation: 
scalar performance:
{'acc': 0.94854313, 'precision': 0.65121925, 'recall': 0.74615645, 'specificity': 0.74615645, 'f1': 0.68543947, 'auroc': 0.8783432, 'binary_precision': 0.31836328, 'binary_recall': 0.5299003, 'binary_specificity': 0.96241266, 'binary_f1_score': 0.3977556}
confusion matrix:
       0    1
0  17488  683
1    283  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9344446, 'precision': 0.6562643, 'recall': 0.7993494, 'specificity': 0.7993494, 'f1': 0.70053124, 'auroc': 0.8878337, 'binary_precision': 0.32712215, 'binary_recall': 0.6528926, 'binary_specificity': 0.94580626, 'binary_f1_score': 0.43586206}
confusion matrix:
      0    1
0  5672  325
1    84  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_8.png
early stop counter: 1
val acc:0.948543131351471, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.94342041015625
after epoch: 8,now: 2024-06-26 06:02:17.128772,epoch time: 0:20:10.907229,used: 2:38:49.443411,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94623953, 'precision': 0.94346535, 'recall': 0.9159961, 'specificity': 0.9159961, 'f1': 0.92857075, 'auroc': 0.9788792, 'binary_precision': 0.9381458, 'binary_recall': 0.85208195, 'binary_specificity': 0.9799102, 'binary_f1_score': 0.8930452}
confusion matrix:
       0      1
0  41460    850
1   2238  12892
---- Validation: 
scalar performance:
{'acc': 0.9522186, 'precision': 0.6612233, 'recall': 0.7408277, 'specificity': 0.7408277, 'f1': 0.6919024, 'auroc': 0.88069093, 'binary_precision': 0.3387978, 'binary_recall': 0.51495016, 'binary_specificity': 0.9667052, 'binary_f1_score': 0.4087014}
confusion matrix:
       0    1
0  17566  605
1    292  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9440616, 'precision': 0.6771935, 'recall': 0.79245543, 'specificity': 0.79245543, 'f1': 0.71801496, 'auroc': 0.8913479, 'binary_precision': 0.36982968, 'binary_recall': 0.6280992, 'binary_specificity': 0.9568117, 'binary_f1_score': 0.46554366}
confusion matrix:
      0    1
0  5738  259
1    90  152
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_9.png
new oracle model saved
early stop counter: 2
val acc:0.9522185921669006, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9440615773200989
after epoch: 9,now: 2024-06-26 06:23:20.080777,epoch time: 0:21:02.952005,used: 2:59:52.395416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9477542, 'precision': 0.94268006, 'recall': 0.92082, 'specificity': 0.92082, 'f1': 0.93100816, 'auroc': 0.9798063, 'binary_precision': 0.9327719, 'binary_recall': 0.86390376, 'binary_specificity': 0.9777363, 'binary_f1_score': 0.89701796}
confusion matrix:
       0      1
0  41369    942
1   2059  13070
---- Validation: 
scalar performance:
{'acc': 0.9475843, 'precision': 0.6506791, 'recall': 0.7544947, 'specificity': 0.7544947, 'f1': 0.68702596, 'auroc': 0.88239735, 'binary_precision': 0.31669867, 'binary_recall': 0.5481728, 'binary_specificity': 0.9608167, 'binary_f1_score': 0.40145987}
confusion matrix:
       0    1
0  17459  712
1    272  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9309184, 'precision': 0.6513517, 'recall': 0.80742884, 'specificity': 0.80742884, 'f1': 0.69693786, 'auroc': 0.8943604, 'binary_precision': 0.31650487, 'binary_recall': 0.6735537, 'binary_specificity': 0.94130397, 'binary_f1_score': 0.4306473}
confusion matrix:
      0    1
0  5645  352
1    79  163
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_10.png
early stop counter: 3
val acc:0.9475842714309692, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9440615773200989
after epoch: 10,now: 2024-06-26 06:42:52.244661,epoch time: 0:19:32.163884,used: 3:19:24.559300,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9487117, 'precision': 0.9455378, 'recall': 0.92046773, 'specificity': 0.92046773, 'f1': 0.9320395, 'auroc': 0.9811207, 'binary_precision': 0.9394027, 'binary_recall': 0.8607879, 'binary_specificity': 0.9801475, 'binary_f1_score': 0.89837873}
confusion matrix:
       0      1
0  41472    840
1   2106  13022
---- Validation: 
scalar performance:
{'acc': 0.9521121, 'precision': 0.6622603, 'recall': 0.746394, 'specificity': 0.746394, 'f1': 0.69430244, 'auroc': 0.88401806, 'binary_precision': 0.3404941, 'binary_recall': 0.52657807, 'binary_specificity': 0.9662099, 'binary_f1_score': 0.41356814}
confusion matrix:
       0    1
0  17557  614
1    285  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9451835, 'precision': 0.6834303, 'recall': 0.808901, 'specificity': 0.808901, 'f1': 0.72721994, 'auroc': 0.89660525, 'binary_precision': 0.3809524, 'binary_recall': 0.661157, 'binary_specificity': 0.956645, 'binary_f1_score': 0.48338372}
confusion matrix:
      0    1
0  5737  260
1    82  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_11.png
new oracle model saved
early stop counter: 4
val acc:0.952112078666687, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.945183515548706
after epoch: 11,now: 2024-06-26 07:02:01.233921,epoch time: 0:19:08.989260,used: 3:38:33.548560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95099235, 'precision': 0.94744694, 'recall': 0.92461044, 'specificity': 0.92461044, 'f1': 0.93523145, 'auroc': 0.98210037, 'binary_precision': 0.9405409, 'binary_recall': 0.86886114, 'binary_specificity': 0.98035973, 'binary_f1_score': 0.9032813}
confusion matrix:
       0      1
0  41480    831
1   1984  13145
---- Validation: 
scalar performance:
{'acc': 0.9513663, 'precision': 0.6605311, 'recall': 0.74922097, 'specificity': 0.74922097, 'f1': 0.69374716, 'auroc': 0.88482606, 'binary_precision': 0.33683106, 'binary_recall': 0.5332226, 'binary_specificity': 0.9652193, 'binary_f1_score': 0.41286176}
confusion matrix:
       0    1
0  17539  632
1    281  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9445424, 'precision': 0.682, 'recall': 0.8105503, 'specificity': 0.8105503, 'f1': 0.7263694, 'auroc': 0.89753, 'binary_precision': 0.37793428, 'binary_recall': 0.6652893, 'binary_specificity': 0.95581126, 'binary_f1_score': 0.48203593}
confusion matrix:
      0    1
0  5732  265
1    81  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_12.png
early stop counter: 5
val acc:0.9513663053512573, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.945183515548706
after epoch: 12,now: 2024-06-26 07:21:26.606932,epoch time: 0:19:25.373011,used: 3:57:58.921571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9527159, 'precision': 0.94899577, 'recall': 0.9276275, 'specificity': 0.9276275, 'f1': 0.9376153, 'auroc': 0.9826592, 'binary_precision': 0.9417123, 'binary_recall': 0.8746117, 'binary_specificity': 0.98064333, 'binary_f1_score': 0.9069226}
confusion matrix:
       0      1
0  41492    819
1   1897  13232
---- Validation: 
scalar performance:
{'acc': 0.9525915, 'precision': 0.6643177, 'recall': 0.74824774, 'specificity': 0.74824774, 'f1': 0.6964147, 'auroc': 0.8862695, 'binary_precision': 0.34449244, 'binary_recall': 0.5299003, 'binary_specificity': 0.9665951, 'binary_f1_score': 0.41753924}
confusion matrix:
       0    1
0  17564  607
1    283  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9471069, 'precision': 0.6886981, 'recall': 0.8079188, 'specificity': 0.8079188, 'f1': 0.7314228, 'auroc': 0.8989763, 'binary_precision': 0.3916256, 'binary_recall': 0.6570248, 'binary_specificity': 0.9588127, 'binary_f1_score': 0.49074075}
confusion matrix:
      0    1
0  5750  247
1    83  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_13.png
new oracle model saved
early stop counter: 6
val acc:0.9525914788246155, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9471068978309631
after epoch: 13,now: 2024-06-26 07:40:47.224349,epoch time: 0:19:20.617417,used: 4:17:19.538988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9520195, 'precision': 0.94973177, 'recall': 0.92505705, 'specificity': 0.92505705, 'f1': 0.93647194, 'auroc': 0.9825827, 'binary_precision': 0.9453001, 'binary_recall': 0.8680767, 'binary_specificity': 0.98203737, 'binary_f1_score': 0.90504414}
confusion matrix:
       0      1
0  41550    760
1   1996  13134
---- Validation: 
scalar performance:
{'acc': 0.95386994, 'precision': 0.6671779, 'recall': 0.7416807, 'specificity': 0.7416807, 'f1': 0.696606, 'auroc': 0.88573146, 'binary_precision': 0.35067874, 'binary_recall': 0.51495016, 'binary_specificity': 0.9684112, 'binary_f1_score': 0.41722748}
confusion matrix:
       0    1
0  17597  574
1    292  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94919056, 'precision': 0.6951912, 'recall': 0.80900264, 'specificity': 0.80900264, 'f1': 0.73701024, 'auroc': 0.89894605, 'binary_precision': 0.40458015, 'binary_recall': 0.6570248, 'binary_specificity': 0.9609805, 'binary_f1_score': 0.5007874}
confusion matrix:
      0    1
0  5763  234
1    83  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_14.png
new oracle model saved
early stop counter: 7
val acc:0.9538699388504028, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 14,now: 2024-06-26 08:00:11.763458,epoch time: 0:19:24.539109,used: 4:36:44.078097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9546483, 'precision': 0.9507833, 'recall': 0.93095994, 'specificity': 0.93095994, 'f1': 0.9402741, 'auroc': 0.9838135, 'binary_precision': 0.9431746, 'binary_recall': 0.8808989, 'binary_specificity': 0.98102105, 'binary_f1_score': 0.91097367}
confusion matrix:
       0      1
0  41507    803
1   1802  13328
---- Validation: 
scalar performance:
{'acc': 0.950514, 'precision': 0.66010904, 'recall': 0.75841725, 'specificity': 0.75841725, 'f1': 0.69585705, 'auroc': 0.8870101, 'binary_precision': 0.33534744, 'binary_recall': 0.55315614, 'binary_specificity': 0.96367836, 'binary_f1_score': 0.41755486}
confusion matrix:
       0    1
0  17511  660
1    269  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.942619, 'precision': 0.67795473, 'recall': 0.815498, 'specificity': 0.815498, 'f1': 0.72388726, 'auroc': 0.89995337, 'binary_precision': 0.36936936, 'binary_recall': 0.677686, 'binary_specificity': 0.95331, 'binary_f1_score': 0.4781341}
confusion matrix:
      0    1
0  5717  280
1    78  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_15.png
early stop counter: 8
val acc:0.950514018535614, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 15,now: 2024-06-26 08:19:57.578001,epoch time: 0:19:45.814543,used: 4:56:29.892640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9556581, 'precision': 0.95088714, 'recall': 0.933556, 'specificity': 0.933556, 'f1': 0.94176334, 'auroc': 0.9841174, 'binary_precision': 0.94141585, 'binary_recall': 0.8868473, 'binary_specificity': 0.9802647, 'binary_f1_score': 0.9133172}
confusion matrix:
       0      1
0  41475    835
1   1712  13418
---- Validation: 
scalar performance:
{'acc': 0.9466255, 'precision': 0.65253705, 'recall': 0.7724695, 'specificity': 0.7724695, 'f1': 0.6926949, 'auroc': 0.8887718, 'binary_precision': 0.31916818, 'binary_recall': 0.58637875, 'binary_specificity': 0.95856035, 'binary_f1_score': 0.41334897}
confusion matrix:
       0    1
0  17418  753
1    249  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9342843, 'precision': 0.66185737, 'recall': 0.8270244, 'specificity': 0.8270244, 'f1': 0.7106312, 'auroc': 0.9012495, 'binary_precision': 0.3359375, 'binary_recall': 0.7107438, 'binary_specificity': 0.943305, 'binary_f1_score': 0.4562334}
confusion matrix:
      0    1
0  5657  340
1    70  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_16.png
early stop counter: 9
val acc:0.9466254711151123, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 16,now: 2024-06-26 08:42:59.687172,epoch time: 0:23:02.109171,used: 5:19:32.001811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9542131, 'precision': 0.94964945, 'recall': 0.93095803, 'specificity': 0.93095803, 'f1': 0.9397699, 'auroc': 0.9849825, 'binary_precision': 0.9406332, 'binary_recall': 0.8818164, 'binary_specificity': 0.98009974, 'binary_f1_score': 0.91027564}
confusion matrix:
       0      1
0  41469    842
1   1788  13341
---- Validation: 
scalar performance:
{'acc': 0.94715816, 'precision': 0.65284747, 'recall': 0.76792645, 'specificity': 0.76792645, 'f1': 0.691981, 'auroc': 0.8892591, 'binary_precision': 0.3201107, 'binary_recall': 0.57641196, 'binary_specificity': 0.9594409, 'binary_f1_score': 0.41162518}
confusion matrix:
       0    1
0  17434  737
1    255  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9368489, 'precision': 0.6672927, 'recall': 0.8283584, 'specificity': 0.8283584, 'f1': 0.7162821, 'auroc': 0.9018283, 'binary_precision': 0.3467742, 'binary_recall': 0.7107438, 'binary_specificity': 0.945973, 'binary_f1_score': 0.46612465}
confusion matrix:
      0    1
0  5673  324
1    70  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_17.png
early stop counter: 10
val acc:0.94715815782547, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 17,now: 2024-06-26 09:06:28.560887,epoch time: 0:23:28.873715,used: 5:43:00.875526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9563022, 'precision': 0.9523561, 'recall': 0.93375975, 'specificity': 0.93375975, 'f1': 0.9425335, 'auroc': 0.9854103, 'binary_precision': 0.94455403, 'binary_recall': 0.8861203, 'binary_specificity': 0.9813992, 'binary_f1_score': 0.9144046}
confusion matrix:
       0      1
0  41523    787
1   1723  13407
---- Validation: 
scalar performance:
{'acc': 0.94811696, 'precision': 0.65536606, 'recall': 0.76761866, 'specificity': 0.76761866, 'f1': 0.69411004, 'auroc': 0.8894708, 'binary_precision': 0.32518798, 'binary_recall': 0.57475084, 'binary_specificity': 0.9604865, 'binary_f1_score': 0.41536614}
confusion matrix:
       0    1
0  17453  718
1    256  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9379708, 'precision': 0.66939294, 'recall': 0.82695925, 'specificity': 0.82695925, 'f1': 0.7180984, 'auroc': 0.90221214, 'binary_precision': 0.35112935, 'binary_recall': 0.7066116, 'binary_specificity': 0.947307, 'binary_f1_score': 0.4691358}
confusion matrix:
      0    1
0  5681  316
1    71  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_18.png
early stop counter: 11
val acc:0.9481169581413269, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 18,now: 2024-06-26 09:30:22.422761,epoch time: 0:23:53.861874,used: 6:06:54.737400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95685935, 'precision': 0.95293903, 'recall': 0.93464744, 'specificity': 0.93464744, 'f1': 0.9432865, 'auroc': 0.9859446, 'binary_precision': 0.94517946, 'binary_recall': 0.8877065, 'binary_specificity': 0.9815883, 'binary_f1_score': 0.9155419}
confusion matrix:
       0      1
0  41531    779
1   1699  13431
---- Validation: 
scalar performance:
{'acc': 0.94848984, 'precision': 0.6564457, 'recall': 0.7678113, 'specificity': 0.7678113, 'f1': 0.69508654, 'auroc': 0.89020514, 'binary_precision': 0.32734153, 'binary_recall': 0.57475084, 'binary_specificity': 0.9608717, 'binary_f1_score': 0.41711876}
confusion matrix:
       0    1
0  17460  711
1    256  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93877226, 'precision': 0.6708322, 'recall': 0.82539344, 'specificity': 0.82539344, 'f1': 0.71921, 'auroc': 0.9033616, 'binary_precision': 0.35416666, 'binary_recall': 0.70247936, 'binary_specificity': 0.9483075, 'binary_f1_score': 0.47091413}
confusion matrix:
      0    1
0  5687  310
1    72  170
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_19.png
early stop counter: 12
val acc:0.9484898447990417, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 19,now: 2024-06-26 09:53:56.789638,epoch time: 0:23:34.366877,used: 6:30:29.104277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.95835656, 'precision': 0.95490766, 'recall': 0.93661904, 'specificity': 0.93661904, 'f1': 0.9452597, 'auroc': 0.98643804, 'binary_precision': 0.94807935, 'binary_recall': 0.8906808, 'binary_specificity': 0.9825573, 'binary_f1_score': 0.91848415}
confusion matrix:
       0      1
0  41572    738
1   1654  13476
---- Validation: 
scalar performance:
{'acc': 0.9512065, 'precision': 0.6630964, 'recall': 0.7619872, 'specificity': 0.7619872, 'f1': 0.6992119, 'auroc': 0.89018536, 'binary_precision': 0.34109312, 'binary_recall': 0.5598007, 'binary_specificity': 0.9641737, 'binary_f1_score': 0.42389938}
confusion matrix:
       0    1
0  17520  651
1    265  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9435807, 'precision': 0.6812277, 'recall': 0.8199637, 'specificity': 0.8199637, 'f1': 0.7277672, 'auroc': 0.9033842, 'binary_precision': 0.37556562, 'binary_recall': 0.6859504, 'binary_specificity': 0.953977, 'binary_f1_score': 0.48538008}
confusion matrix:
      0    1
0  5721  276
1    76  166
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_20.png
early stop counter: 13
val acc:0.9512065052986145, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 20,now: 2024-06-26 10:21:37.808509,epoch time: 0:27:41.018871,used: 6:58:10.123148,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9560063, 'precision': 0.95408297, 'recall': 0.93124485, 'specificity': 0.93124485, 'f1': 0.9418816, 'auroc': 0.98537815, 'binary_precision': 0.9503323, 'binary_recall': 0.8789161, 'binary_specificity': 0.9835736, 'binary_f1_score': 0.9132301}
confusion matrix:
       0      1
0  41615    695
1   1832  13298
---- Validation: 
scalar performance:
{'acc': 0.95200557, 'precision': 0.66591674, 'recall': 0.76320297, 'specificity': 0.76320297, 'f1': 0.7018063, 'auroc': 0.8909966, 'binary_precision': 0.34666666, 'binary_recall': 0.5614618, 'binary_specificity': 0.9649441, 'binary_f1_score': 0.428662}
confusion matrix:
       0    1
0  17534  637
1    264  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94502324, 'precision': 0.68478656, 'recall': 0.8187313, 'specificity': 0.8187313, 'f1': 0.73064315, 'auroc': 0.90383756, 'binary_precision': 0.38283062, 'binary_recall': 0.6818182, 'binary_specificity': 0.9556445, 'binary_f1_score': 0.4903417}
confusion matrix:
      0    1
0  5731  266
1    77  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_21.png
early stop counter: 14
val acc:0.9520055651664734, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 21,now: 2024-06-26 10:48:48.475861,epoch time: 0:27:10.667352,used: 7:25:20.790500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.95947075, 'precision': 0.9555501, 'recall': 0.93892187, 'specificity': 0.93892187, 'f1': 0.9468194, 'auroc': 0.98706615, 'binary_precision': 0.94774395, 'binary_recall': 0.8954987, 'binary_specificity': 0.98234504, 'binary_f1_score': 0.92088085}
confusion matrix:
       0      1
0  41564    747
1   1581  13548
---- Validation: 
scalar performance:
{'acc': 0.94721144, 'precision': 0.6529957, 'recall': 0.76795393, 'specificity': 0.76795393, 'f1': 0.6921175, 'auroc': 0.89063746, 'binary_precision': 0.3204063, 'binary_recall': 0.57641196, 'binary_specificity': 0.9594959, 'binary_f1_score': 0.41186944}
confusion matrix:
       0    1
0  17435  736
1    255  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93877226, 'precision': 0.6704425, 'recall': 0.82341063, 'specificity': 0.82341063, 'f1': 0.71847796, 'auroc': 0.9032471, 'binary_precision': 0.35355648, 'binary_recall': 0.6983471, 'binary_specificity': 0.9484742, 'binary_f1_score': 0.46944442}
confusion matrix:
      0    1
0  5688  309
1    73  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_22.png
early stop counter: 15
val acc:0.9472114443778992, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 22,now: 2024-06-26 11:15:47.473858,epoch time: 0:26:58.997997,used: 7:52:19.788497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9586177, 'precision': 0.9544618, 'recall': 0.93777287, 'specificity': 0.93777287, 'f1': 0.9456965, 'auroc': 0.98623073, 'binary_precision': 0.9461899, 'binary_recall': 0.8937211, 'binary_specificity': 0.98182464, 'binary_f1_score': 0.9192074}
confusion matrix:
       0      1
0  41541    769
1   1608  13522
---- Validation: 
scalar performance:
{'acc': 0.9455069, 'precision': 0.64994043, 'recall': 0.7734978, 'specificity': 0.7734978, 'f1': 0.6905646, 'auroc': 0.89049035, 'binary_precision': 0.31388152, 'binary_recall': 0.589701, 'binary_specificity': 0.9572946, 'binary_f1_score': 0.4096942}
confusion matrix:
       0    1
0  17395  776
1    247  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93668854, 'precision': 0.6673362, 'recall': 0.8302578, 'specificity': 0.8302578, 'f1': 0.7166412, 'auroc': 0.90374804, 'binary_precision': 0.3466934, 'binary_recall': 0.71487606, 'binary_specificity': 0.9456395, 'binary_f1_score': 0.4669366}
confusion matrix:
      0    1
0  5671  326
1    69  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_23.png
early stop counter: 16
val acc:0.9455068707466125, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 23,now: 2024-06-26 11:45:14.669811,epoch time: 0:29:27.195953,used: 8:21:46.984450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9575383, 'precision': 0.95603067, 'recall': 0.9333463, 'specificity': 0.9333463, 'f1': 0.9439207, 'auroc': 0.98713696, 'binary_precision': 0.95308816, 'binary_recall': 0.88222075, 'binary_specificity': 0.98447174, 'binary_f1_score': 0.91628623}
confusion matrix:
       0      1
0  41653    657
1   1782  13348
---- Validation: 
scalar performance:
{'acc': 0.9512065, 'precision': 0.66402906, 'recall': 0.7660024, 'specificity': 0.7660024, 'f1': 0.7010087, 'auroc': 0.8907934, 'binary_precision': 0.34268537, 'binary_recall': 0.5681063, 'binary_specificity': 0.96389854, 'binary_f1_score': 0.4275}
confusion matrix:
       0    1
0  17515  656
1    260  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94438213, 'precision': 0.68265927, 'recall': 0.8164151, 'specificity': 0.8164151, 'f1': 0.7282633, 'auroc': 0.90351653, 'binary_precision': 0.3787529, 'binary_recall': 0.677686, 'binary_specificity': 0.9551442, 'binary_f1_score': 0.48592588}
confusion matrix:
      0    1
0  5728  269
1    78  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_24.png
early stop counter: 17
val acc:0.9512065052986145, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 24,now: 2024-06-26 12:12:03.861216,epoch time: 0:26:49.191405,used: 8:48:36.175855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9586699, 'precision': 0.9549334, 'recall': 0.9374262, 'specificity': 0.9374262, 'f1': 0.94571775, 'auroc': 0.9868218, 'binary_precision': 0.94751614, 'binary_recall': 0.8925314, 'binary_specificity': 0.98232096, 'binary_f1_score': 0.9192022}
confusion matrix:
       0      1
0  41562    748
1   1626  13504
---- Validation: 
scalar performance:
{'acc': 0.94912905, 'precision': 0.65851873, 'recall': 0.7689445, 'specificity': 0.7689445, 'f1': 0.69712865, 'auroc': 0.8916185, 'binary_precision': 0.3314231, 'binary_recall': 0.57641196, 'binary_specificity': 0.9614771, 'binary_f1_score': 0.42086112}
confusion matrix:
       0    1
0  17471  700
1    255  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94309986, 'precision': 0.68032646, 'recall': 0.82169634, 'specificity': 0.82169634, 'f1': 0.7273239, 'auroc': 0.90390575, 'binary_precision': 0.3736018, 'binary_recall': 0.69008267, 'binary_specificity': 0.95331, 'binary_f1_score': 0.48476055}
confusion matrix:
      0    1
0  5717  280
1    75  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_25.png
early stop counter: 18
val acc:0.949129045009613, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 25,now: 2024-06-26 12:40:58.236696,epoch time: 0:28:54.375480,used: 9:17:30.551335,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.95934886, 'precision': 0.95476425, 'recall': 0.9394124, 'specificity': 0.9394124, 'f1': 0.94673187, 'auroc': 0.9873018, 'binary_precision': 0.94559765, 'binary_recall': 0.8972834, 'binary_specificity': 0.98154145, 'binary_f1_score': 0.92080724}
confusion matrix:
       0      1
0  41530    781
1   1554  13575
---- Validation: 
scalar performance:
{'acc': 0.9448676, 'precision': 0.65038, 'recall': 0.78200114, 'specificity': 0.78200114, 'f1': 0.69266695, 'auroc': 0.8923663, 'binary_precision': 0.3141631, 'binary_recall': 0.6079734, 'binary_specificity': 0.9560288, 'binary_f1_score': 0.41426146}
confusion matrix:
       0    1
0  17372  799
1    236  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93412405, 'precision': 0.66273683, 'recall': 0.8328892, 'specificity': 0.8328892, 'f1': 0.712422, 'auroc': 0.9042193, 'binary_precision': 0.3371869, 'binary_recall': 0.7231405, 'binary_specificity': 0.942638, 'binary_f1_score': 0.45992115}
confusion matrix:
      0    1
0  5653  344
1    67  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_26.png
early stop counter: 19
val acc:0.9448676109313965, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 26,now: 2024-06-26 13:04:52.915517,epoch time: 0:23:54.678821,used: 9:41:25.230156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9606546, 'precision': 0.9563133, 'recall': 0.9412997, 'specificity': 0.9412997, 'f1': 0.9484668, 'auroc': 0.98714507, 'binary_precision': 0.94762105, 'binary_recall': 0.9003966, 'binary_specificity': 0.98220277, 'binary_f1_score': 0.9234054}
confusion matrix:
       0      1
0  41557    753
1   1507  13623
---- Validation: 
scalar performance:
{'acc': 0.9440153, 'precision': 0.64899606, 'recall': 0.78477305, 'specificity': 0.78477305, 'f1': 0.69189125, 'auroc': 0.8922157, 'binary_precision': 0.31118587, 'binary_recall': 0.61461794, 'binary_specificity': 0.95492816, 'binary_f1_score': 0.41317698}
confusion matrix:
       0    1
0  17352  819
1    232  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9339638, 'precision': 0.6628101, 'recall': 0.8347886, 'specificity': 0.8347886, 'f1': 0.7127807, 'auroc': 0.9038526, 'binary_precision': 0.33716476, 'binary_recall': 0.72727275, 'binary_specificity': 0.9423045, 'binary_f1_score': 0.460733}
confusion matrix:
      0    1
0  5651  346
1    66  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_27.png
early stop counter: 20
val acc:0.9440153241157532, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 27,now: 2024-06-26 13:28:27.295154,epoch time: 0:23:34.379637,used: 10:04:59.609793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96147287, 'precision': 0.9554156, 'recall': 0.9444635, 'specificity': 0.9444635, 'f1': 0.94975734, 'auroc': 0.98797894, 'binary_precision': 0.94311786, 'binary_recall': 0.90852004, 'binary_specificity': 0.980407, 'binary_f1_score': 0.9254958}
confusion matrix:
       0      1
0  41482    829
1   1384  13745
---- Validation: 
scalar performance:
{'acc': 0.94065946, 'precision': 0.6426555, 'recall': 0.7894639, 'specificity': 0.7894639, 'f1': 0.6865263, 'auroc': 0.89302015, 'binary_precision': 0.29810727, 'binary_recall': 0.627907, 'binary_specificity': 0.95102084, 'binary_f1_score': 0.4042781}
confusion matrix:
       0    1
0  17281  890
1    224  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92803335, 'precision': 0.65285546, 'recall': 0.83765197, 'specificity': 0.83765197, 'f1': 0.7025735, 'auroc': 0.9047079, 'binary_precision': 0.31681415, 'binary_recall': 0.73966944, 'binary_specificity': 0.9356345, 'binary_f1_score': 0.44361833}
confusion matrix:
      0    1
0  5611  386
1    63  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_28.png
early stop counter: 21
val acc:0.9406594634056091, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 28,now: 2024-06-26 13:51:33.602424,epoch time: 0:23:06.307270,used: 10:28:05.917063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96061975, 'precision': 0.9571711, 'recall': 0.94032073, 'specificity': 0.94032073, 'f1': 0.9483202, 'auroc': 0.9879471, 'binary_precision': 0.95030797, 'binary_recall': 0.8974223, 'binary_specificity': 0.9832191, 'binary_f1_score': 0.9231083}
confusion matrix:
       0      1
0  41600    710
1   1552  13578
---- Validation: 
scalar performance:
{'acc': 0.9464124, 'precision': 0.65384626, 'recall': 0.78038996, 'specificity': 0.78038996, 'f1': 0.6955395, 'auroc': 0.89272714, 'binary_precision': 0.32123893, 'binary_recall': 0.60299003, 'binary_specificity': 0.9577899, 'binary_f1_score': 0.4191686}
confusion matrix:
       0    1
0  17404  767
1    239  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93716943, 'precision': 0.6687765, 'recall': 0.8324906, 'specificity': 0.8324906, 'f1': 0.7184372, 'auroc': 0.90449905, 'binary_precision': 0.3493976, 'binary_recall': 0.71900827, 'binary_specificity': 0.945973, 'binary_f1_score': 0.47027025}
confusion matrix:
      0    1
0  5673  324
1    68  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_29.png
early stop counter: 22
val acc:0.9464123845100403, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 29,now: 2024-06-26 14:14:07.518686,epoch time: 0:22:33.916262,used: 10:50:39.833325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96060234, 'precision': 0.9563951, 'recall': 0.9410701, 'specificity': 0.9410701, 'f1': 0.9483789, 'auroc': 0.98745155, 'binary_precision': 0.9479805, 'binary_recall': 0.8997951, 'binary_specificity': 0.98234504, 'binary_f1_score': 0.9232595}
confusion matrix:
       0      1
0  41564    747
1   1516  13613
---- Validation: 
scalar performance:
{'acc': 0.9468918, 'precision': 0.6540208, 'recall': 0.7758193, 'specificity': 0.7758193, 'f1': 0.6947389, 'auroc': 0.8918421, 'binary_precision': 0.32191163, 'binary_recall': 0.59302324, 'binary_specificity': 0.95861536, 'binary_f1_score': 0.41729984}
confusion matrix:
       0    1
0  17419  752
1    245  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9390928, 'precision': 0.6723437, 'recall': 0.82952565, 'specificity': 0.82952565, 'f1': 0.7214044, 'auroc': 0.90375566, 'binary_precision': 0.35684648, 'binary_recall': 0.7107438, 'binary_specificity': 0.9483075, 'binary_f1_score': 0.47513813}
confusion matrix:
      0    1
0  5687  310
1    70  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556223_30.png
early stop counter: 23
val acc:0.9468917846679688, best validation acc: 0.9545624256134033, corresponding to test acc:                         0.94342041015625 / 0.9491905570030212
after epoch: 30,now: 2024-06-26 14:37:24.735792,epoch time: 0:23:17.217106,used: 11:13:57.050431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_27_seed_2_21556223
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:13:57.050431 at 2024-06-26 14:37:24.735792
persisted model performance metric: 

scalar performance:
{'acc': 0.9434204, 'precision': 0.66614187, 'recall': 0.75048435, 'specificity': 0.75048435, 'f1': 0.6981299, 'auroc': 0.88333833, 'binary_precision': 0.35120642, 'binary_recall': 0.5413223, 'binary_specificity': 0.95964646, 'binary_f1_score': 0.42601624}
confusion matrix:
      0    1
0  5755  242
1   111  131
oracle model performance metric: 

scalar performance:
{'acc': 0.94919056, 'precision': 0.6951912, 'recall': 0.80900264, 'specificity': 0.80900264, 'f1': 0.73701024, 'auroc': 0.89894605, 'binary_precision': 0.40458015, 'binary_recall': 0.6570248, 'binary_specificity': 0.9609805, 'binary_f1_score': 0.5007874}
confusion matrix:
      0    1
0  5763  234
1    83  159
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190965 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190965 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189282 KiB | 457564 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  16468 KiB |  37503 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1080 MiB | 579584 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1014 MiB | 550912 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     66 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38410 KiB |  87618 KiB |   1252 TiB |   1252 TiB |
|       from large pool |  31306 KiB |  79555 KiB |   1205 TiB |   1205 TiB |
|       from small pool |   7104 KiB |  21236 KiB |     46 TiB |     46 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7663    |  471824 K  |  471821 K  |
|       from large pool |      76    |     158    |  219127 K  |  219126 K  |
|       from small pool |    2878    |    7585    |  252697 K  |  252694 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7663    |  471824 K  |  471821 K  |
|       from large pool |      76    |     158    |  219127 K  |  219126 K  |
|       from small pool |    2878    |    7585    |  252697 K  |  252694 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      78    |      37    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      33    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      29    |    3609    |  264703 K  |  264703 K  |
|       from large pool |      10    |      22    |  130502 K  |  130502 K  |
|       from small pool |      19    |    3599    |  134200 K  |  134200 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  37503 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB | 526336 KiB |   1080 MiB |    856 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1014 MiB |    814 MiB |
|       from small pool |  24576 KiB |  43008 KiB |     66 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87618 KiB |   1252 TiB |   1252 TiB |
|       from large pool |  23872 KiB |  79555 KiB |   1205 TiB |   1205 TiB |
|       from small pool |      0 KiB |  21236 KiB |     46 TiB |     46 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7663    |  471824 K  |  471824 K  |
|       from large pool |       2    |     158    |  219127 K  |  219127 K  |
|       from small pool |       0    |    7585    |  252697 K  |  252697 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7663    |  471824 K  |  471824 K  |
|       from large pool |       2    |     158    |  219127 K  |  219127 K  |
|       from small pool |       0    |    7585    |  252697 K  |  252697 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      42    |      78    |      56    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      12    |      21    |      33    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3609    |  264704 K  |  264704 K  |
|       from large pool |       3    |      22    |  130502 K  |  130502 K  |
|       from small pool |       0    |    3599    |  134201 K  |  134201 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jun 26 14:38:48 2024]
Finished job 0.
1 of 1 steps (100%) done
