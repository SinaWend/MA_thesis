Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun 24 14:30:49 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218

 Experiment start at: 2024-06-24 14:40:06.860621
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8582048, 'precision': 0.8633851, 'recall': 0.7507353, 'specificity': 0.7507353, 'f1': 0.78427315, 'auroc': 0.9156939, 'binary_precision': 0.87092805, 'binary_recall': 0.5287122, 'binary_specificity': 0.9727584, 'binary_f1_score': 0.6579837}
confusion matrix:
       0     1
0  41172  1153
1   6935  7780
---- Validation: 
scalar performance:
{'acc': 0.9426352, 'precision': 0.61390984, 'recall': 0.653028, 'specificity': 0.653028, 'f1': 0.6299827, 'auroc': 0.8245733, 'binary_precision': 0.25142857, 'binary_recall': 0.3421462, 'binary_specificity': 0.96390986, 'binary_f1_score': 0.28985506}
confusion matrix:
       0    1
0  17494  655
1    423  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93799937, 'precision': 0.6047381, 'recall': 0.5993514, 'specificity': 0.5993514, 'f1': 0.60195434, 'auroc': 0.82885635, 'binary_precision': 0.24291497, 'binary_recall': 0.22988506, 'binary_specificity': 0.9688178, 'binary_f1_score': 0.23622048}
confusion matrix:
      0    1
0  5810  187
1   201   60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-24 15:08:46.137567,epoch time: 0:28:39.276946,used: 0:28:39.276946,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.904716, 'precision': 0.9044928, 'recall': 0.8397385, 'specificity': 0.8397385, 'f1': 0.86535215, 'auroc': 0.9492572, 'binary_precision': 0.90411913, 'binary_recall': 0.70549065, 'binary_specificity': 0.9739864, 'binary_f1_score': 0.7925493}
confusion matrix:
       0      1
0  41223   1101
1   4334  10382
---- Validation: 
scalar performance:
{'acc': 0.9537569, 'precision': 0.6617789, 'recall': 0.68278766, 'specificity': 0.68278766, 'f1': 0.67154056, 'auroc': 0.84738076, 'binary_precision': 0.3452055, 'binary_recall': 0.3919129, 'binary_specificity': 0.97366244, 'binary_f1_score': 0.3670794}
confusion matrix:
       0    1
0  17671  478
1    391  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501438, 'precision': 0.67328435, 'recall': 0.6386699, 'specificity': 0.6386699, 'f1': 0.6537185, 'auroc': 0.8720639, 'binary_precision': 0.3768116, 'binary_recall': 0.29885057, 'binary_specificity': 0.9784892, 'binary_f1_score': 0.3333333}
confusion matrix:
      0    1
0  5868  129
1   183   78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-24 15:37:59.259215,epoch time: 0:29:13.121648,used: 0:57:52.398594,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9225982, 'precision': 0.9170486, 'recall': 0.8760712, 'specificity': 0.8760712, 'f1': 0.8938955, 'auroc': 0.96014, 'binary_precision': 0.9070723, 'binary_recall': 0.77992934, 'binary_specificity': 0.97221303, 'binary_f1_score': 0.83870965}
confusion matrix:
       0      1
0  41146   1176
1   3239  11479
---- Validation: 
scalar performance:
{'acc': 0.9538633, 'precision': 0.6719153, 'recall': 0.7165953, 'specificity': 0.7165953, 'f1': 0.6912848, 'auroc': 0.85916495, 'binary_precision': 0.36308068, 'binary_recall': 0.46189734, 'binary_specificity': 0.9712932, 'binary_f1_score': 0.40657085}
confusion matrix:
       0    1
0  17628  521
1    346  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9533397, 'precision': 0.71239066, 'recall': 0.73561877, 'specificity': 0.73561877, 'f1': 0.723304, 'auroc': 0.890504, 'binary_precision': 0.44673538, 'binary_recall': 0.49808428, 'binary_specificity': 0.97315323, 'binary_f1_score': 0.47101447}
confusion matrix:
      0    1
0  5836  161
1   131  130
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-24 16:05:28.727709,epoch time: 0:27:29.468494,used: 1:25:21.867088,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93146914, 'precision': 0.92949057, 'recall': 0.8880384, 'specificity': 0.8880384, 'f1': 0.90614045, 'auroc': 0.9656343, 'binary_precision': 0.9259259, 'binary_recall': 0.7982879, 'binary_specificity': 0.9777888, 'binary_f1_score': 0.8573826}
confusion matrix:
       0      1
0  41381    940
1   2969  11750
---- Validation: 
scalar performance:
{'acc': 0.9564176, 'precision': 0.68165016, 'recall': 0.71116716, 'specificity': 0.71116716, 'f1': 0.6951361, 'auroc': 0.8649323, 'binary_precision': 0.38297874, 'binary_recall': 0.44790047, 'binary_specificity': 0.97443384, 'binary_f1_score': 0.41290322}
confusion matrix:
       0    1
0  17685  464
1    355  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.7336729, 'recall': 0.7413678, 'specificity': 0.7413678, 'f1': 0.7374487, 'auroc': 0.8985956, 'binary_precision': 0.4888889, 'binary_recall': 0.50574714, 'binary_specificity': 0.9769885, 'binary_f1_score': 0.49717516}
confusion matrix:
      0    1
0  5859  138
1   129  132
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-24 16:31:58.476530,epoch time: 0:26:29.748821,used: 1:51:51.615909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9348177, 'precision': 0.9325443, 'recall': 0.8940489, 'specificity': 0.8940489, 'f1': 0.9110476, 'auroc': 0.9708346, 'binary_precision': 0.92841005, 'binary_recall': 0.8098118, 'binary_specificity': 0.978286, 'binary_f1_score': 0.8650649}
confusion matrix:
       0      1
0  41404    919
1   2799  11918
---- Validation: 
scalar performance:
{'acc': 0.9563112, 'precision': 0.6813239, 'recall': 0.7118621, 'specificity': 0.7118621, 'f1': 0.6952317, 'auroc': 0.8695072, 'binary_precision': 0.38227513, 'binary_recall': 0.44945568, 'binary_specificity': 0.97426856, 'binary_f1_score': 0.41315222}
confusion matrix:
       0    1
0  17682  467
1    354  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.73718363, 'recall': 0.7708519, 'specificity': 0.7708519, 'f1': 0.7527314, 'auroc': 0.9052687, 'binary_precision': 0.49333334, 'binary_recall': 0.5670498, 'binary_specificity': 0.974654, 'binary_f1_score': 0.52762926}
confusion matrix:
      0    1
0  5845  152
1   113  148
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_5.png
new oracle model saved
early stop counter: 1
val acc:0.9563112258911133, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 5,now: 2024-06-24 16:59:13.424590,epoch time: 0:27:14.948060,used: 2:19:06.563969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9398843, 'precision': 0.9368931, 'recall': 0.9034021, 'specificity': 0.9034021, 'f1': 0.918458, 'auroc': 0.97497916, 'binary_precision': 0.93136656, 'binary_recall': 0.828022, 'binary_specificity': 0.97878224, 'binary_f1_score': 0.8766591}
confusion matrix:
       0      1
0  41425    898
1   2531  12186
---- Validation: 
scalar performance:
{'acc': 0.9538633, 'precision': 0.67344284, 'recall': 0.7225957, 'specificity': 0.7225957, 'f1': 0.69449365, 'auroc': 0.87333584, 'binary_precision': 0.36570743, 'binary_recall': 0.47433904, 'binary_specificity': 0.9708524, 'binary_f1_score': 0.4129993}
confusion matrix:
       0    1
0  17620  529
1    338  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.73271275, 'recall': 0.7958375, 'specificity': 0.7958375, 'f1': 0.75990444, 'auroc': 0.9095199, 'binary_precision': 0.48214287, 'binary_recall': 0.62068963, 'binary_specificity': 0.9709855, 'binary_f1_score': 0.5427135}
confusion matrix:
      0    1
0  5823  174
1    99  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_6.png
early stop counter: 2
val acc:0.9538633227348328, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 6,now: 2024-06-24 17:22:42.102089,epoch time: 0:23:28.677499,used: 2:42:35.241468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9427069, 'precision': 0.93854326, 'recall': 0.90933883, 'specificity': 0.90933883, 'f1': 0.9226568, 'auroc': 0.9743991, 'binary_precision': 0.93074894, 'binary_recall': 0.8404132, 'binary_specificity': 0.97826445, 'binary_f1_score': 0.88327736}
confusion matrix:
       0      1
0  41407    920
1   2348  12365
---- Validation: 
scalar performance:
{'acc': 0.95317155, 'precision': 0.6750264, 'recall': 0.7402389, 'specificity': 0.7402389, 'f1': 0.70170754, 'auroc': 0.87636733, 'binary_precision': 0.36759776, 'binary_recall': 0.5116641, 'binary_specificity': 0.9688137, 'binary_f1_score': 0.42782834}
confusion matrix:
       0    1
0  17583  566
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9536593, 'precision': 0.7214729, 'recall': 0.79808486, 'specificity': 0.79808486, 'f1': 0.7531853, 'auroc': 0.9120301, 'binary_precision': 0.45938376, 'binary_recall': 0.62835246, 'binary_specificity': 0.96781725, 'binary_f1_score': 0.5307443}
confusion matrix:
      0    1
0  5804  193
1    97  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_7.png
early stop counter: 3
val acc:0.9531715512275696, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 7,now: 2024-06-24 17:45:23.236589,epoch time: 0:22:41.134500,used: 3:05:16.375968,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9450912, 'precision': 0.94000757, 'recall': 0.9143567, 'specificity': 0.9143567, 'f1': 0.92619115, 'auroc': 0.97821915, 'binary_precision': 0.9303812, 'binary_recall': 0.8508527, 'binary_specificity': 0.97786075, 'binary_f1_score': 0.88884157}
confusion matrix:
       0      1
0  41386    937
1   2195  12522
---- Validation: 
scalar performance:
{'acc': 0.951788, 'precision': 0.67036813, 'recall': 0.7417728, 'specificity': 0.7417728, 'f1': 0.6988865, 'auroc': 0.8787769, 'binary_precision': 0.35814455, 'binary_recall': 0.5163297, 'binary_specificity': 0.96721584, 'binary_f1_score': 0.4229299}
confusion matrix:
       0    1
0  17554  595
1    311  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95286036, 'precision': 0.7195399, 'recall': 0.808662, 'specificity': 0.808662, 'f1': 0.7553017, 'auroc': 0.9135628, 'binary_precision': 0.45454547, 'binary_recall': 0.651341, 'binary_specificity': 0.965983, 'binary_f1_score': 0.5354331}
confusion matrix:
      0    1
0  5793  204
1    91  170
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_8.png
early stop counter: 4
val acc:0.9517880082130432, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 8,now: 2024-06-24 18:59:27.197184,epoch time: 1:14:03.960595,used: 4:19:20.336563,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9476157, 'precision': 0.9413566, 'recall': 0.91986513, 'specificity': 0.91986513, 'f1': 0.9299144, 'auroc': 0.97871435, 'binary_precision': 0.9293454, 'binary_recall': 0.8625306, 'binary_specificity': 0.9771997, 'binary_f1_score': 0.89469224}
confusion matrix:
       0      1
0  41359    965
1   2023  12693
---- Validation: 
scalar performance:
{'acc': 0.95136225, 'precision': 0.66883206, 'recall': 0.74155235, 'specificity': 0.74155235, 'f1': 0.69770056, 'auroc': 0.8808491, 'binary_precision': 0.35508022, 'binary_recall': 0.5163297, 'binary_specificity': 0.966775, 'binary_f1_score': 0.4207858}
confusion matrix:
       0    1
0  17546  603
1    311  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95317996, 'precision': 0.721353, 'recall': 0.81432575, 'specificity': 0.81432575, 'f1': 0.7584008, 'auroc': 0.9145601, 'binary_precision': 0.45767197, 'binary_recall': 0.66283524, 'binary_specificity': 0.96581626, 'binary_f1_score': 0.54147106}
confusion matrix:
      0    1
0  5792  205
1    88  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_9.png
early stop counter: 5
val acc:0.9513622522354126, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 9,now: 2024-06-24 19:29:16.540614,epoch time: 0:29:49.343430,used: 4:49:09.679993,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95120966, 'precision': 0.9464966, 'recall': 0.9243523, 'specificity': 0.9243523, 'f1': 0.9346967, 'auroc': 0.9815136, 'binary_precision': 0.93746334, 'binary_recall': 0.8688592, 'binary_specificity': 0.97984546, 'binary_f1_score': 0.90185845}
confusion matrix:
       0      1
0  41470    853
1   1930  12787
---- Validation: 
scalar performance:
{'acc': 0.95003194, 'precision': 0.66475636, 'recall': 0.74311376, 'specificity': 0.74311376, 'f1': 0.6951531, 'auroc': 0.8824372, 'binary_precision': 0.34679088, 'binary_recall': 0.5209953, 'binary_specificity': 0.96523225, 'binary_f1_score': 0.41640773}
confusion matrix:
       0    1
0  17518  631
1    308  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9509428, 'precision': 0.7136242, 'recall': 0.8168231, 'specificity': 0.8168231, 'f1': 0.75341845, 'auroc': 0.9152137, 'binary_precision': 0.44191918, 'binary_recall': 0.6704981, 'binary_specificity': 0.96314824, 'binary_f1_score': 0.5327245}
confusion matrix:
      0    1
0  5776  221
1    86  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_10.png
early stop counter: 6
val acc:0.9500319361686707, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 10,now: 2024-06-24 19:56:19.319790,epoch time: 0:27:02.779176,used: 5:16:12.459169,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.949737, 'precision': 0.94538, 'recall': 0.9214984, 'specificity': 0.9214984, 'f1': 0.9325918, 'auroc': 0.98087686, 'binary_precision': 0.93707585, 'binary_recall': 0.86315143, 'binary_specificity': 0.97984546, 'binary_f1_score': 0.8985958}
confusion matrix:
       0      1
0  41470    853
1   2014  12703
---- Validation: 
scalar performance:
{'acc': 0.9499787, 'precision': 0.6645766, 'recall': 0.7430862, 'specificity': 0.7430862, 'f1': 0.6950095, 'auroc': 0.8827939, 'binary_precision': 0.34643227, 'binary_recall': 0.5209953, 'binary_specificity': 0.9651771, 'binary_f1_score': 0.41614905}
confusion matrix:
       0    1
0  17517  632
1    308  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95158195, 'precision': 0.71632004, 'recall': 0.8208213, 'specificity': 0.8208213, 'f1': 0.75663126, 'auroc': 0.9152961, 'binary_precision': 0.4469697, 'binary_recall': 0.6781609, 'binary_specificity': 0.9634817, 'binary_f1_score': 0.53881276}
confusion matrix:
      0    1
0  5778  219
1    84  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_11.png
early stop counter: 7
val acc:0.9499787092208862, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 11,now: 2024-06-24 21:14:38.533819,epoch time: 1:18:19.214029,used: 6:34:31.673198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9524895, 'precision': 0.9480507, 'recall': 0.9262382, 'specificity': 0.9262382, 'f1': 0.9364412, 'auroc': 0.98268783, 'binary_precision': 0.9395315, 'binary_recall': 0.8719935, 'binary_specificity': 0.98048294, 'binary_f1_score': 0.9045035}
confusion matrix:
       0      1
0  41496    826
1   1884  12834
---- Validation: 
scalar performance:
{'acc': 0.9498723, 'precision': 0.66640794, 'recall': 0.7520318, 'specificity': 0.7520318, 'f1': 0.6990004, 'auroc': 0.88437283, 'binary_precision': 0.34944612, 'binary_recall': 0.53965783, 'binary_specificity': 0.9644058, 'binary_f1_score': 0.42420536}
confusion matrix:
       0    1
0  17503  646
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495046, 'precision': 0.70993614, 'recall': 0.8252345, 'specificity': 0.8252345, 'f1': 0.7529276, 'auroc': 0.9158903, 'binary_precision': 0.43373495, 'binary_recall': 0.6896552, 'binary_specificity': 0.96081376, 'binary_f1_score': 0.5325444}
confusion matrix:
      0    1
0  5762  235
1    81  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_12.png
early stop counter: 8
val acc:0.9498723149299622, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 12,now: 2024-06-24 21:39:05.454467,epoch time: 0:24:26.920648,used: 6:58:58.593846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9531382, 'precision': 0.9495854, 'recall': 0.9264275, 'specificity': 0.9264275, 'f1': 0.93721855, 'auroc': 0.9827899, 'binary_precision': 0.94279414, 'binary_recall': 0.87123734, 'binary_specificity': 0.98161757, 'binary_f1_score': 0.9056044}
confusion matrix:
       0      1
0  41545    778
1   1895  12822
---- Validation: 
scalar performance:
{'acc': 0.95035124, 'precision': 0.6665755, 'recall': 0.74627936, 'specificity': 0.74627936, 'f1': 0.6974603, 'auroc': 0.8848046, 'binary_precision': 0.3502066, 'binary_recall': 0.5272162, 'binary_specificity': 0.96534246, 'binary_f1_score': 0.42085662}
confusion matrix:
       0    1
0  17520  629
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95126235, 'precision': 0.71541566, 'recall': 0.8224869, 'specificity': 0.8224869, 'f1': 0.7564252, 'auroc': 0.9155643, 'binary_precision': 0.445, 'binary_recall': 0.68199235, 'binary_specificity': 0.96298146, 'binary_f1_score': 0.5385779}
confusion matrix:
      0    1
0  5775  222
1    83  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_13.png
early stop counter: 9
val acc:0.9503512382507324, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 13,now: 2024-06-24 22:01:42.813904,epoch time: 0:22:37.359437,used: 7:21:35.953283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9544004, 'precision': 0.94985425, 'recall': 0.92955273, 'specificity': 0.92955273, 'f1': 0.93909645, 'auroc': 0.9836718, 'binary_precision': 0.94108653, 'binary_recall': 0.8782195, 'binary_specificity': 0.980886, 'binary_f1_score': 0.9085668}
confusion matrix:
       0      1
0  41516    809
1   1792  12923
---- Validation: 
scalar performance:
{'acc': 0.94641334, 'precision': 0.65769535, 'recall': 0.75849164, 'specificity': 0.75849164, 'f1': 0.6937368, 'auroc': 0.88559544, 'binary_precision': 0.3314815, 'binary_recall': 0.55676514, 'binary_specificity': 0.9602182, 'binary_f1_score': 0.41555426}
confusion matrix:
       0    1
0  17427  722
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9443912, 'precision': 0.69643736, 'recall': 0.8353928, 'specificity': 0.8353928, 'f1': 0.74424946, 'auroc': 0.9161319, 'binary_precision': 0.40563992, 'binary_recall': 0.71647507, 'binary_specificity': 0.9543105, 'binary_f1_score': 0.5180055}
confusion matrix:
      0    1
0  5723  274
1    74  187
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_14.png
early stop counter: 10
val acc:0.9464133381843567, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 14,now: 2024-06-24 22:25:05.062821,epoch time: 0:23:22.248917,used: 7:44:58.202200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9554874, 'precision': 0.9517969, 'recall': 0.93050295, 'specificity': 0.93050295, 'f1': 0.94048667, 'auroc': 0.98445034, 'binary_precision': 0.9447001, 'binary_recall': 0.8788909, 'binary_specificity': 0.98211503, 'binary_f1_score': 0.910608}
confusion matrix:
       0      1
0  41569    757
1   1782  12932
---- Validation: 
scalar performance:
{'acc': 0.94976586, 'precision': 0.6640475, 'recall': 0.7437261, 'specificity': 0.7437261, 'f1': 0.694798, 'auroc': 0.8863692, 'binary_precision': 0.34532374, 'binary_recall': 0.5225505, 'binary_specificity': 0.9649016, 'binary_f1_score': 0.41584158}
confusion matrix:
       0    1
0  17512  637
1    307  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95222116, 'precision': 0.71942174, 'recall': 0.8284842, 'specificity': 0.8284842, 'f1': 0.76121676, 'auroc': 0.916793, 'binary_precision': 0.4525, 'binary_recall': 0.6934866, 'binary_specificity': 0.9634817, 'binary_f1_score': 0.54765505}
confusion matrix:
      0    1
0  5778  219
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_15.png
early stop counter: 11
val acc:0.9497658610343933, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 15,now: 2024-06-24 22:48:06.039299,epoch time: 0:23:00.976478,used: 8:07:59.178678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9553997, 'precision': 0.9517096, 'recall': 0.9303552, 'specificity': 0.9303552, 'f1': 0.9403654, 'auroc': 0.9843943, 'binary_precision': 0.94461495, 'binary_recall': 0.878619, 'binary_specificity': 0.98209137, 'binary_f1_score': 0.91042256}
confusion matrix:
       0      1
0  41568    758
1   1786  12928
---- Validation: 
scalar performance:
{'acc': 0.95003194, 'precision': 0.6667604, 'recall': 0.75136435, 'specificity': 0.75136435, 'f1': 0.69908106, 'auroc': 0.8875641, 'binary_precision': 0.35020244, 'binary_recall': 0.5381026, 'binary_specificity': 0.96462613, 'binary_f1_score': 0.42427957}
confusion matrix:
       0    1
0  17507  642
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9511026, 'precision': 0.71638805, 'recall': 0.8352299, 'specificity': 0.8352299, 'f1': 0.7607463, 'auroc': 0.9174645, 'binary_precision': 0.44578314, 'binary_recall': 0.70881224, 'binary_specificity': 0.9616475, 'binary_f1_score': 0.54733723}
confusion matrix:
      0    1
0  5767  230
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_16.png
early stop counter: 12
val acc:0.9500319361686707, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 16,now: 2024-06-24 23:13:08.612572,epoch time: 0:25:02.573273,used: 8:33:01.751951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9568198, 'precision': 0.9536923, 'recall': 0.9321843, 'specificity': 0.9321843, 'f1': 0.9422654, 'auroc': 0.98522097, 'binary_precision': 0.94767994, 'binary_recall': 0.88128567, 'binary_specificity': 0.9830829, 'binary_f1_score': 0.9132777}
confusion matrix:
       0      1
0  41608    716
1   1747  12969
---- Validation: 
scalar performance:
{'acc': 0.9494998, 'precision': 0.6666039, 'recall': 0.7578394, 'specificity': 0.7578394, 'f1': 0.7007762, 'auroc': 0.8883828, 'binary_precision': 0.34940946, 'binary_recall': 0.5520995, 'binary_specificity': 0.96357924, 'binary_f1_score': 0.42796865}
confusion matrix:
       0    1
0  17488  661
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9496644, 'precision': 0.71187985, 'recall': 0.8363118, 'specificity': 0.8363118, 'f1': 0.7574277, 'auroc': 0.9177629, 'binary_precision': 0.43661973, 'binary_recall': 0.7126437, 'binary_specificity': 0.95998, 'binary_f1_score': 0.5414848}
confusion matrix:
      0    1
0  5757  240
1    75  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_17.png
early stop counter: 13
val acc:0.949499785900116, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 17,now: 2024-06-24 23:35:11.879025,epoch time: 0:22:03.266453,used: 8:55:05.018404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.95604837, 'precision': 0.9513564, 'recall': 0.9324882, 'specificity': 0.9324882, 'f1': 0.9413992, 'auroc': 0.9861038, 'binary_precision': 0.9422631, 'binary_recall': 0.88380784, 'binary_specificity': 0.9811686, 'binary_f1_score': 0.91209984}
confusion matrix:
       0      1
0  41526    797
1   1710  13007
---- Validation: 
scalar performance:
{'acc': 0.9481694, 'precision': 0.6625766, 'recall': 0.7579007, 'specificity': 0.7579007, 'f1': 0.69758445, 'auroc': 0.8874775, 'binary_precision': 0.3413231, 'binary_recall': 0.55365473, 'binary_specificity': 0.9621467, 'binary_f1_score': 0.42230132}
confusion matrix:
       0    1
0  17462  687
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9472675, 'precision': 0.7057245, 'recall': 0.8442229, 'specificity': 0.8442229, 'f1': 0.7542801, 'auroc': 0.91722363, 'binary_precision': 0.42350334, 'binary_recall': 0.7318008, 'binary_specificity': 0.956645, 'binary_f1_score': 0.53651685}
confusion matrix:
      0    1
0  5737  260
1    70  191
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_18.png
early stop counter: 14
val acc:0.9481694102287292, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 18,now: 2024-06-24 23:56:37.626708,epoch time: 0:21:25.747683,used: 9:16:30.766087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9580645, 'precision': 0.9529551, 'recall': 0.9362962, 'specificity': 0.9362962, 'f1': 0.94421875, 'auroc': 0.98521423, 'binary_precision': 0.94298244, 'binary_recall': 0.891328, 'binary_specificity': 0.9812645, 'binary_f1_score': 0.9164279}
confusion matrix:
       0      1
0  41533    793
1   1599  13115
---- Validation: 
scalar performance:
{'acc': 0.94753087, 'precision': 0.6613508, 'recall': 0.76057035, 'specificity': 0.76057035, 'f1': 0.6972789, 'auroc': 0.8868264, 'binary_precision': 0.33866414, 'binary_recall': 0.5598756, 'binary_specificity': 0.9612651, 'binary_f1_score': 0.42203984}
confusion matrix:
       0    1
0  17446  703
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94614893, 'precision': 0.7027453, 'recall': 0.8454716, 'specificity': 0.8454716, 'f1': 0.75201106, 'auroc': 0.9166492, 'binary_precision': 0.4173913, 'binary_recall': 0.7356322, 'binary_specificity': 0.955311, 'binary_f1_score': 0.5325936}
confusion matrix:
      0    1
0  5729  268
1    69  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_19.png
early stop counter: 15
val acc:0.9475308656692505, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 19,now: 2024-06-25 00:19:24.090272,epoch time: 0:22:46.463564,used: 9:39:17.229651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.95774895, 'precision': 0.95299816, 'recall': 0.93540704, 'specificity': 0.93540704, 'f1': 0.9437493, 'auroc': 0.98627234, 'binary_precision': 0.94375134, 'binary_recall': 0.8892437, 'binary_specificity': 0.9815703, 'binary_f1_score': 0.9156871}
confusion matrix:
       0      1
0  41543    780
1   1630  13087
---- Validation: 
scalar performance:
{'acc': 0.94604087, 'precision': 0.65680885, 'recall': 0.7590489, 'specificity': 0.7590489, 'f1': 0.69313335, 'auroc': 0.886973, 'binary_precision': 0.32966024, 'binary_recall': 0.55832034, 'binary_specificity': 0.9597774, 'binary_f1_score': 0.41454965}
confusion matrix:
       0    1
0  17419  730
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9434324, 'precision': 0.69529, 'recall': 0.8440542, 'specificity': 0.8440542, 'f1': 0.7451346, 'auroc': 0.9172901, 'binary_precision': 0.4025157, 'binary_recall': 0.7356322, 'binary_specificity': 0.95247626, 'binary_f1_score': 0.52032524}
confusion matrix:
      0    1
0  5712  285
1    69  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_20.png
early stop counter: 16
val acc:0.9460408687591553, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 20,now: 2024-06-25 00:43:30.697404,epoch time: 0:24:06.607132,used: 10:03:23.836783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9587132, 'precision': 0.9554223, 'recall': 0.93551767, 'specificity': 0.93551767, 'f1': 0.9448955, 'auroc': 0.9862058, 'binary_precision': 0.94906265, 'binary_recall': 0.8875977, 'binary_specificity': 0.98343766, 'binary_f1_score': 0.91730165}
confusion matrix:
       0      1
0  41624    701
1   1654  13061
---- Validation: 
scalar performance:
{'acc': 0.9492337, 'precision': 0.6655694, 'recall': 0.7569516, 'specificity': 0.7569516, 'f1': 0.69971764, 'auroc': 0.88683355, 'binary_precision': 0.3473994, 'binary_recall': 0.5505443, 'binary_specificity': 0.9633589, 'binary_f1_score': 0.4259928}
confusion matrix:
       0    1
0  17484  665
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949984, 'precision': 0.7135904, 'recall': 0.84197557, 'specificity': 0.84197557, 'f1': 0.7602819, 'auroc': 0.9166347, 'binary_precision': 0.43953487, 'binary_recall': 0.7241379, 'binary_specificity': 0.95981324, 'binary_f1_score': 0.54703325}
confusion matrix:
      0    1
0  5756  241
1    72  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_21.png
early stop counter: 17
val acc:0.9492337107658386, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 21,now: 2024-06-25 01:07:06.614241,epoch time: 0:23:35.916837,used: 10:26:59.753620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9585729, 'precision': 0.95636344, 'recall': 0.9342041, 'specificity': 0.9342041, 'f1': 0.9445756, 'auroc': 0.9874315, 'binary_precision': 0.952123, 'binary_recall': 0.88386, 'binary_specificity': 0.98454815, 'binary_f1_score': 0.9167225}
confusion matrix:
       0      1
0  41671    654
1   1709  13006
---- Validation: 
scalar performance:
{'acc': 0.9499255, 'precision': 0.66640574, 'recall': 0.7513093, 'specificity': 0.7513093, 'f1': 0.69879276, 'auroc': 0.8878764, 'binary_precision': 0.34949496, 'binary_recall': 0.5381026, 'binary_specificity': 0.9645159, 'binary_f1_score': 0.42375997}
confusion matrix:
       0    1
0  17505  644
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95222116, 'precision': 0.72080743, 'recall': 0.8413105, 'specificity': 0.8413105, 'f1': 0.76589286, 'auroc': 0.9165087, 'binary_precision': 0.45410627, 'binary_recall': 0.7203065, 'binary_specificity': 0.9623145, 'binary_f1_score': 0.55703706}
confusion matrix:
      0    1
0  5771  226
1    73  188
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_22.png
early stop counter: 18
val acc:0.9499254822731018, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 22,now: 2024-06-25 01:29:24.527272,epoch time: 0:22:17.913031,used: 10:49:17.666651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9598878, 'precision': 0.9552188, 'recall': 0.93890923, 'specificity': 0.93890923, 'f1': 0.94667625, 'auroc': 0.9875917, 'binary_precision': 0.9460915, 'binary_recall': 0.89556295, 'binary_specificity': 0.9822555, 'binary_f1_score': 0.92013407}
confusion matrix:
       0      1
0  41572    751
1   1537  13180
---- Validation: 
scalar performance:
{'acc': 0.9423691, 'precision': 0.648095, 'recall': 0.7616483, 'specificity': 0.7616483, 'f1': 0.68618584, 'auroc': 0.8886197, 'binary_precision': 0.31196582, 'binary_recall': 0.5676516, 'binary_specificity': 0.95564497, 'binary_f1_score': 0.40264755}
confusion matrix:
       0    1
0  17344  805
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9395973, 'precision': 0.6865696, 'recall': 0.8475502, 'specificity': 0.8475502, 'f1': 0.73781836, 'auroc': 0.9174472, 'binary_precision': 0.3846154, 'binary_recall': 0.74712646, 'binary_specificity': 0.94797397, 'binary_f1_score': 0.5078125}
confusion matrix:
      0    1
0  5685  312
1    66  195
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_23.png
early stop counter: 19
val acc:0.9423691034317017, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 23,now: 2024-06-25 01:51:10.623392,epoch time: 0:21:46.096120,used: 11:11:03.762771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9594846, 'precision': 0.95630234, 'recall': 0.9367095, 'specificity': 0.9367095, 'f1': 0.9459503, 'auroc': 0.98711354, 'binary_precision': 0.9501451, 'binary_recall': 0.8896514, 'binary_specificity': 0.9837677, 'binary_f1_score': 0.9189037}
confusion matrix:
       0      1
0  41636    687
1   1624  13093
---- Validation: 
scalar performance:
{'acc': 0.94678587, 'precision': 0.65841395, 'recall': 0.7571844, 'specificity': 0.7571844, 'f1': 0.6940055, 'auroc': 0.88974845, 'binary_precision': 0.33302152, 'binary_recall': 0.55365473, 'binary_specificity': 0.9607141, 'binary_f1_score': 0.41588783}
confusion matrix:
       0    1
0  17436  713
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9471077, 'precision': 0.7055096, 'recall': 0.8459718, 'specificity': 0.8459718, 'f1': 0.7545072, 'auroc': 0.9170581, 'binary_precision': 0.4229075, 'binary_recall': 0.7356322, 'binary_specificity': 0.95631146, 'binary_f1_score': 0.53706294}
confusion matrix:
      0    1
0  5735  262
1    69  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_24.png
early stop counter: 20
val acc:0.9467858672142029, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 24,now: 2024-06-25 02:13:21.806338,epoch time: 0:22:11.182946,used: 11:33:14.945717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96030855, 'precision': 0.9549028, 'recall': 0.94038945, 'specificity': 0.94038945, 'f1': 0.9473381, 'auroc': 0.9878845, 'binary_precision': 0.944274, 'binary_recall': 0.8992322, 'binary_specificity': 0.9815467, 'binary_f1_score': 0.9212029}
confusion matrix:
       0      1
0  41542    781
1   1483  13234
---- Validation: 
scalar performance:
{'acc': 0.9417837, 'precision': 0.64738965, 'recall': 0.7643454, 'specificity': 0.7643454, 'f1': 0.6861194, 'auroc': 0.8902744, 'binary_precision': 0.31034482, 'binary_recall': 0.57387245, 'binary_specificity': 0.9548184, 'binary_f1_score': 0.4028384}
confusion matrix:
       0    1
0  17329  820
1    274  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93799937, 'precision': 0.6828399, 'recall': 0.84671646, 'specificity': 0.84671646, 'f1': 0.7341151, 'auroc': 0.916816, 'binary_precision': 0.37717602, 'binary_recall': 0.74712646, 'binary_specificity': 0.94630647, 'binary_f1_score': 0.5012853}
confusion matrix:
      0    1
0  5675  322
1    66  195
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_25.png
early stop counter: 21
val acc:0.9417837262153625, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 25,now: 2024-06-25 02:36:56.830868,epoch time: 0:23:35.024530,used: 11:56:49.970247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9606066, 'precision': 0.9558839, 'recall': 0.9401692, 'specificity': 0.9401692, 'f1': 0.947667, 'auroc': 0.9882648, 'binary_precision': 0.9466332, 'binary_recall': 0.8979412, 'binary_specificity': 0.98239726, 'binary_f1_score': 0.9216445}
confusion matrix:
       0      1
0  41578    745
1   1502  13215
---- Validation: 
scalar performance:
{'acc': 0.94290125, 'precision': 0.6498176, 'recall': 0.7634239, 'specificity': 0.7634239, 'f1': 0.6881034, 'auroc': 0.89036846, 'binary_precision': 0.3152921, 'binary_recall': 0.57076204, 'binary_specificity': 0.95608574, 'binary_f1_score': 0.40619808}
confusion matrix:
       0    1
0  17352  797
1    276  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9392777, 'precision': 0.68581194, 'recall': 0.8473835, 'specificity': 0.8473835, 'f1': 0.73707104, 'auroc': 0.91685116, 'binary_precision': 0.38310412, 'binary_recall': 0.74712646, 'binary_specificity': 0.9476405, 'binary_f1_score': 0.5064935}
confusion matrix:
      0    1
0  5683  314
1    66  195
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_26.png
early stop counter: 22
val acc:0.9429012537002563, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 26,now: 2024-06-25 02:58:44.329265,epoch time: 0:21:47.498397,used: 12:18:37.468644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96134293, 'precision': 0.9561827, 'recall': 0.94186205, 'specificity': 0.94186205, 'f1': 0.94872344, 'auroc': 0.98808515, 'binary_precision': 0.9460288, 'binary_recall': 0.9016104, 'binary_specificity': 0.9821137, 'binary_f1_score': 0.92328566}
confusion matrix:
       0      1
0  41566    757
1   1448  13269
---- Validation: 
scalar performance:
{'acc': 0.94135803, 'precision': 0.64728105, 'recall': 0.7678753, 'specificity': 0.7678753, 'f1': 0.68674266, 'auroc': 0.8911955, 'binary_precision': 0.30985916, 'binary_recall': 0.5816485, 'binary_specificity': 0.95410216, 'binary_f1_score': 0.40432435}
confusion matrix:
       0    1
0  17316  833
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93767977, 'precision': 0.6833954, 'recall': 0.8538791, 'specificity': 0.8538791, 'f1': 0.7359112, 'auroc': 0.9166863, 'binary_precision': 0.3776091, 'binary_recall': 0.7624521, 'binary_specificity': 0.945306, 'binary_f1_score': 0.5050761}
confusion matrix:
      0    1
0  5669  328
1    62  199
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_27.png
early stop counter: 23
val acc:0.9413580298423767, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 27,now: 2024-06-25 03:20:19.541398,epoch time: 0:21:35.212133,used: 12:40:12.680777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96020335, 'precision': 0.9574047, 'recall': 0.93752635, 'specificity': 0.93752635, 'f1': 0.9468956, 'auroc': 0.98769355, 'binary_precision': 0.9519936, 'binary_recall': 0.89067066, 'binary_specificity': 0.98438203, 'binary_f1_score': 0.9203117}
confusion matrix:
       0      1
0  41662    661
1   1609  13108
---- Validation: 
scalar performance:
{'acc': 0.945083, 'precision': 0.65522695, 'recall': 0.7630533, 'specificity': 0.7630533, 'f1': 0.6927464, 'auroc': 0.890664, 'binary_precision': 0.3261841, 'binary_recall': 0.5676516, 'binary_specificity': 0.958455, 'binary_f1_score': 0.41430193}
confusion matrix:
       0    1
0  17395  754
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9439118, 'precision': 0.69713306, 'recall': 0.847969, 'specificity': 0.847969, 'f1': 0.747615, 'auroc': 0.91664606, 'binary_precision': 0.40585774, 'binary_recall': 0.743295, 'binary_specificity': 0.952643, 'binary_f1_score': 0.52503383}
confusion matrix:
      0    1
0  5713  284
1    67  194
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_28.png
early stop counter: 24
val acc:0.9450830221176147, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 28,now: 2024-06-25 03:40:38.471328,epoch time: 0:20:18.929930,used: 13:00:31.610707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9626578, 'precision': 0.95841336, 'recall': 0.9431058, 'specificity': 0.9431058, 'f1': 0.9504206, 'auroc': 0.9880082, 'binary_precision': 0.9500858, 'binary_recall': 0.9027042, 'binary_specificity': 0.9835074, 'binary_f1_score': 0.9257892}
confusion matrix:
       0      1
0  41624    698
1   1432  13286
---- Validation: 
scalar performance:
{'acc': 0.94258195, 'precision': 0.64956427, 'recall': 0.7655088, 'specificity': 0.7655088, 'f1': 0.6883239, 'auroc': 0.8904689, 'binary_precision': 0.31462586, 'binary_recall': 0.5754277, 'binary_specificity': 0.95558983, 'binary_f1_score': 0.40681696}
confusion matrix:
       0    1
0  17343  806
1    273  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9402365, 'precision': 0.68841016, 'recall': 0.84971607, 'specificity': 0.84971607, 'f1': 0.7399597, 'auroc': 0.9163637, 'binary_precision': 0.3881188, 'binary_recall': 0.75095785, 'binary_specificity': 0.9484742, 'binary_f1_score': 0.5117493}
confusion matrix:
      0    1
0  5688  309
1    65  196
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_29.png
early stop counter: 25
val acc:0.9425819516181946, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 29,now: 2024-06-25 04:04:23.487271,epoch time: 0:23:45.015943,used: 13:24:16.626650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96200913, 'precision': 0.95651317, 'recall': 0.9433243, 'specificity': 0.9433243, 'f1': 0.9496652, 'auroc': 0.9879248, 'binary_precision': 0.9456599, 'binary_recall': 0.90472305, 'binary_specificity': 0.98192555, 'binary_f1_score': 0.92473865}
confusion matrix:
       0      1
0  41560    765
1   1402  13313
---- Validation: 
scalar performance:
{'acc': 0.94061303, 'precision': 0.6456845, 'recall': 0.76823974, 'specificity': 0.76823974, 'f1': 0.68534225, 'auroc': 0.8902328, 'binary_precision': 0.30662307, 'binary_recall': 0.58320373, 'binary_specificity': 0.9532757, 'binary_f1_score': 0.4019293}
confusion matrix:
       0    1
0  17301  848
1    268  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9362416, 'precision': 0.68021667, 'recall': 0.8531287, 'specificity': 0.8531287, 'f1': 0.73266274, 'auroc': 0.91657436, 'binary_precision': 0.37126866, 'binary_recall': 0.7624521, 'binary_specificity': 0.9438052, 'binary_f1_score': 0.4993727}
confusion matrix:
      0    1
0  5660  337
1    62  199
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_30.png
early stop counter: 26
val acc:0.9406130313873291, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9573346376419067 / 0.9576541781425476
after epoch: 30,now: 2024-06-25 04:25:05.471462,epoch time: 0:20:41.984191,used: 13:44:58.610841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_14_40_06_seed_0_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:44:58.610841 at 2024-06-25 04:25:05.471462
persisted model performance metric: 

scalar performance:
{'acc': 0.95733464, 'precision': 0.7336729, 'recall': 0.7413678, 'specificity': 0.7413678, 'f1': 0.7374487, 'auroc': 0.8985956, 'binary_precision': 0.4888889, 'binary_recall': 0.50574714, 'binary_specificity': 0.9769885, 'binary_f1_score': 0.49717516}
confusion matrix:
      0    1
0  5859  138
1   129  132
oracle model performance metric: 

scalar performance:
{'acc': 0.9576542, 'precision': 0.73718363, 'recall': 0.7708519, 'specificity': 0.7708519, 'f1': 0.7527314, 'auroc': 0.9052687, 'binary_precision': 0.49333334, 'binary_recall': 0.5670498, 'binary_specificity': 0.974654, 'binary_f1_score': 0.52762926}
confusion matrix:
      0    1
0  5845  152
1   113  148
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191877 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |  17477 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191877 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |  17477 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189283 KiB | 457564 KiB | 758211 GiB | 758211 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 742655 GiB | 742655 GiB |
|       from small pool |  16469 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 516096 KiB | 516096 KiB | 516096 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39546 KiB |  75256 KiB | 410711 GiB | 410711 GiB |
|       from large pool |  30400 KiB |  70632 KiB | 395108 GiB | 395108 GiB |
|       from small pool |   9146 KiB |   9902 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7613    |  157526 K  |  157523 K  |
|       from large pool |      76    |     158    |   73194 K  |   73194 K  |
|       from small pool |    2890    |    7535    |   84331 K  |   84328 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7613    |  157526 K  |  157523 K  |
|       from large pool |      76    |     158    |   73194 K  |   73194 K  |
|       from small pool |    2890    |    7535    |   84331 K  |   84328 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3583    |   87087 K  |   87087 K  |
|       from large pool |       9    |      19    |   45496 K  |   45496 K  |
|       from small pool |      24    |    3575    |   41590 K  |   41590 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 758211 GiB | 758211 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 742655 GiB | 742655 GiB |
|       from small pool |      0 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 516096 KiB | 516096 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  43008 KiB |  43008 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82786 KiB | 410711 GiB | 410711 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 395108 GiB | 395108 GiB |
|       from small pool |      0 KiB |  20341 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      42    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3583    |   87088 K  |   87088 K  |
|       from large pool |       3    |      19    |   45496 K  |   45496 K  |
|       from small pool |       0    |    3575    |   41592 K  |   41592 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 758211 GiB | 758211 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 742655 GiB | 742655 GiB |
|       from small pool |      0 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 516096 KiB | 516096 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  43008 KiB |  43008 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82786 KiB | 410711 GiB | 410711 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 395108 GiB | 395108 GiB |
|       from small pool |      0 KiB |  20341 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      42    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3583    |   87088 K  |   87088 K  |
|       from large pool |       3    |      19    |   45496 K  |   45496 K  |
|       from small pool |       0    |    3575    |   41592 K  |   41592 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218

 Experiment start at: 2024-06-25 04:32:58.028501
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7886578, 'precision': 0.7327999, 'recall': 0.6442436, 'specificity': 0.6442436, 'f1': 0.66307455, 'auroc': 0.82436323, 'binary_precision': 0.6561244, 'binary_recall': 0.3510402, 'binary_specificity': 0.93744695, 'binary_f1_score': 0.4573752}
confusion matrix:
       0     1
0  39759  2653
1   9358  5062
---- Validation: 
scalar performance:
{'acc': 0.9339915, 'precision': 0.49613443, 'recall': 0.49655098, 'specificity': 0.49655098, 'f1': 0.4962939, 'auroc': 0.7617003, 'binary_precision': 0.028428094, 'binary_recall': 0.02526003, 'binary_specificity': 0.9678419, 'binary_f1_score': 0.02675059}
confusion matrix:
       0    1
0  17486  581
1    656   17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93329036, 'precision': 0.5131372, 'recall': 0.50911796, 'specificity': 0.50911796, 'f1': 0.5101098, 'auroc': 0.82509124, 'binary_precision': 0.06741573, 'binary_recall': 0.046153847, 'binary_specificity': 0.9720821, 'binary_f1_score': 0.05479452}
confusion matrix:
      0    1
0  5780  166
1   248   12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-25 04:55:03.817091,epoch time: 0:22:05.788590,used: 0:22:05.788590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.88341075, 'precision': 0.8780662, 'recall': 0.80169195, 'specificity': 0.80169195, 'f1': 0.8299187, 'auroc': 0.9313633, 'binary_precision': 0.86956936, 'binary_recall': 0.63580245, 'binary_specificity': 0.96758145, 'binary_f1_score': 0.7345352}
confusion matrix:
       0     1
0  41039  1375
1   5251  9167
---- Validation: 
scalar performance:
{'acc': 0.9425293, 'precision': 0.5763354, 'recall': 0.57250565, 'specificity': 0.57250565, 'f1': 0.57435644, 'auroc': 0.82661176, 'binary_precision': 0.18338558, 'binary_recall': 0.17384844, 'binary_specificity': 0.9711629, 'binary_f1_score': 0.1784897}
confusion matrix:
       0    1
0  17546  521
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9434418, 'precision': 0.5953919, 'recall': 0.5622293, 'specificity': 0.5622293, 'f1': 0.5743497, 'auroc': 0.86635685, 'binary_precision': 0.2275449, 'binary_recall': 0.14615385, 'binary_specificity': 0.97830474, 'binary_f1_score': 0.17798595}
confusion matrix:
      0    1
0  5817  129
1   222   38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-25 05:16:06.689134,epoch time: 0:21:02.872043,used: 0:43:08.660633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90813273, 'precision': 0.90695477, 'recall': 0.8436595, 'specificity': 0.8436595, 'f1': 0.86902463, 'auroc': 0.95137274, 'binary_precision': 0.9049925, 'binary_recall': 0.71276003, 'binary_specificity': 0.97455907, 'binary_f1_score': 0.7974551}
confusion matrix:
       0      1
0  41333   1079
1   4142  10278
---- Validation: 
scalar performance:
{'acc': 0.95, 'precision': 0.6394406, 'recall': 0.6400389, 'specificity': 0.6400389, 'f1': 0.63973904, 'auroc': 0.8484341, 'binary_precision': 0.30473372, 'binary_recall': 0.3060921, 'binary_specificity': 0.97398573, 'binary_f1_score': 0.3054114}
confusion matrix:
       0    1
0  17597  470
1    467  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95149857, 'precision': 0.68159103, 'recall': 0.6363153, 'specificity': 0.6363153, 'f1': 0.65518576, 'auroc': 0.8853457, 'binary_precision': 0.39378238, 'binary_recall': 0.2923077, 'binary_specificity': 0.9803229, 'binary_f1_score': 0.33554083}
confusion matrix:
      0    1
0  5829  117
1   184   76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-25 05:37:21.954100,epoch time: 0:21:15.264966,used: 1:04:23.925599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9212416, 'precision': 0.9195186, 'recall': 0.8675842, 'specificity': 0.8675842, 'f1': 0.8894465, 'auroc': 0.96050715, 'binary_precision': 0.91654795, 'binary_recall': 0.7586518, 'binary_specificity': 0.9765166, 'binary_f1_score': 0.8301586}
confusion matrix:
       0      1
0  41417    996
1   3480  10939
---- Validation: 
scalar performance:
{'acc': 0.95522946, 'precision': 0.67847, 'recall': 0.682806, 'specificity': 0.682806, 'f1': 0.680608, 'auroc': 0.8607362, 'binary_precision': 0.37971014, 'binary_recall': 0.38930163, 'binary_specificity': 0.9763104, 'binary_f1_score': 0.38444605}
confusion matrix:
       0    1
0  17639  428
1    411  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.7264319, 'recall': 0.68865883, 'specificity': 0.68865883, 'f1': 0.70557463, 'auroc': 0.8988389, 'binary_precision': 0.47906977, 'binary_recall': 0.39615384, 'binary_specificity': 0.9811638, 'binary_f1_score': 0.4336842}
confusion matrix:
      0    1
0  5834  112
1   157  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-25 05:58:42.499697,epoch time: 0:21:20.545597,used: 1:25:44.471196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9304089, 'precision': 0.92943484, 'recall': 0.8830801, 'specificity': 0.8830801, 'f1': 0.9030686, 'auroc': 0.9680437, 'binary_precision': 0.92772466, 'binary_recall': 0.7870024, 'binary_specificity': 0.9791578, 'binary_f1_score': 0.8515892}
confusion matrix:
       0      1
0  41530    884
1   3071  11347
---- Validation: 
scalar performance:
{'acc': 0.9566169, 'precision': 0.68944466, 'recall': 0.6978309, 'specificity': 0.6978309, 'f1': 0.69353354, 'auroc': 0.8664683, 'binary_precision': 0.4005682, 'binary_recall': 0.4190193, 'binary_specificity': 0.9766425, 'binary_f1_score': 0.40958607}
confusion matrix:
       0    1
0  17645  422
1    391  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.74363077, 'recall': 0.7229378, 'specificity': 0.7229378, 'f1': 0.73275995, 'auroc': 0.905753, 'binary_precision': 0.51054853, 'binary_recall': 0.4653846, 'binary_specificity': 0.9804911, 'binary_f1_score': 0.48692152}
confusion matrix:
      0    1
0  5830  116
1   139  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-25 06:21:58.307508,epoch time: 0:23:15.807811,used: 1:49:00.279007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93584603, 'precision': 0.9358425, 'recall': 0.89171946, 'specificity': 0.89171946, 'f1': 0.9109402, 'auroc': 0.9722041, 'binary_precision': 0.93583626, 'binary_recall': 0.80213606, 'binary_specificity': 0.9813029, 'binary_f1_score': 0.86384344}
confusion matrix:
       0      1
0  41620    793
1   2853  11566
---- Validation: 
scalar performance:
{'acc': 0.9592316, 'precision': 0.70511174, 'recall': 0.7027633, 'specificity': 0.7027633, 'f1': 0.7039298, 'auroc': 0.8718226, 'binary_precision': 0.43157893, 'binary_recall': 0.42644873, 'binary_specificity': 0.9790779, 'binary_f1_score': 0.42899847}
confusion matrix:
       0    1
0  17689  378
1    386  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.7604439, 'recall': 0.7315551, 'specificity': 0.7315551, 'f1': 0.7450366, 'auroc': 0.9113968, 'binary_precision': 0.54347825, 'binary_recall': 0.48076922, 'binary_specificity': 0.98234105, 'binary_f1_score': 0.5102041}
confusion matrix:
      0    1
0  5841  105
1   135  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-25 06:42:02.465504,epoch time: 0:20:04.157996,used: 2:09:04.437003,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93892527, 'precision': 0.93952453, 'recall': 0.8965163, 'specificity': 0.8965163, 'f1': 0.9153482, 'auroc': 0.9728095, 'binary_precision': 0.94058925, 'binary_recall': 0.81043214, 'binary_specificity': 0.9826005, 'binary_f1_score': 0.87067324}
confusion matrix:
       0      1
0  41677    738
1   2733  11684
---- Validation: 
scalar performance:
{'acc': 0.95981854, 'precision': 0.70945764, 'recall': 0.7073593, 'specificity': 0.7073593, 'f1': 0.70840245, 'auroc': 0.87523544, 'binary_precision': 0.43993995, 'binary_recall': 0.43536404, 'binary_specificity': 0.9793546, 'binary_f1_score': 0.43764}
confusion matrix:
       0    1
0  17694  373
1    380  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.76673836, 'recall': 0.7430936, 'specificity': 0.7430936, 'f1': 0.7542942, 'auroc': 0.91455984, 'binary_precision': 0.55508476, 'binary_recall': 0.50384617, 'binary_specificity': 0.98234105, 'binary_f1_score': 0.52822584}
confusion matrix:
      0    1
0  5841  105
1   129  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-25 07:02:18.406230,epoch time: 0:20:15.940726,used: 2:29:20.377729,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9441864, 'precision': 0.9420204, 'recall': 0.90820193, 'specificity': 0.90820193, 'f1': 0.9234562, 'auroc': 0.97601366, 'binary_precision': 0.93806964, 'binary_recall': 0.8351481, 'binary_specificity': 0.98125577, 'binary_f1_score': 0.883622}
confusion matrix:
       0      1
0  41618    795
1   2377  12042
---- Validation: 
scalar performance:
{'acc': 0.9569904, 'precision': 0.69824857, 'recall': 0.73092693, 'specificity': 0.73092693, 'f1': 0.71316135, 'auroc': 0.87899107, 'binary_precision': 0.41571608, 'binary_recall': 0.48736998, 'binary_specificity': 0.97448385, 'binary_f1_score': 0.4487004}
confusion matrix:
       0    1
0  17606  461
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7468818, 'recall': 0.7856316, 'specificity': 0.7856316, 'f1': 0.76463485, 'auroc': 0.9169234, 'binary_precision': 0.51155114, 'binary_recall': 0.59615386, 'binary_specificity': 0.97510934, 'binary_f1_score': 0.5506216}
confusion matrix:
      0    1
0  5798  148
1   105  155
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_8.png
early stop counter: 1
val acc:0.9569904208183289, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9622945785522461
after epoch: 8,now: 2024-06-25 07:22:21.616837,epoch time: 0:20:03.210607,used: 2:49:23.588336,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94466144, 'precision': 0.9455321, 'recall': 0.9062085, 'specificity': 0.9062085, 'f1': 0.923667, 'auroc': 0.9786577, 'binary_precision': 0.94709706, 'binary_recall': 0.8281434, 'binary_specificity': 0.9842737, 'binary_f1_score': 0.8836349}
confusion matrix:
       0      1
0  41746    667
1   2478  11941
---- Validation: 
scalar performance:
{'acc': 0.9586446, 'precision': 0.70448345, 'recall': 0.7181948, 'specificity': 0.7181948, 'f1': 0.7110855, 'auroc': 0.8780878, 'binary_precision': 0.42916667, 'binary_recall': 0.45913818, 'binary_specificity': 0.97725135, 'binary_f1_score': 0.44364682}
confusion matrix:
       0    1
0  17656  411
1    364  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.7665762, 'recall': 0.77636355, 'specificity': 0.77636355, 'f1': 0.77136946, 'auroc': 0.9171319, 'binary_precision': 0.55185187, 'binary_recall': 0.5730769, 'binary_specificity': 0.9796502, 'binary_f1_score': 0.5622642}
confusion matrix:
      0    1
0  5825  121
1   111  149
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_9.png
new oracle model saved
early stop counter: 2
val acc:0.9586446285247803, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 9,now: 2024-06-25 07:42:29.179430,epoch time: 0:20:07.562593,used: 3:09:31.150929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94842696, 'precision': 0.9453828, 'recall': 0.9163759, 'specificity': 0.9163759, 'f1': 0.9296677, 'auroc': 0.98051584, 'binary_precision': 0.9397489, 'binary_recall': 0.85130733, 'binary_specificity': 0.98144436, 'binary_f1_score': 0.8933445}
confusion matrix:
       0      1
0  41626    787
1   2144  12275
---- Validation: 
scalar performance:
{'acc': 0.9569904, 'precision': 0.69824857, 'recall': 0.73092693, 'specificity': 0.73092693, 'f1': 0.71316135, 'auroc': 0.8808511, 'binary_precision': 0.41571608, 'binary_recall': 0.48736998, 'binary_specificity': 0.97448385, 'binary_f1_score': 0.4487004}
confusion matrix:
       0    1
0  17606  461
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7496454, 'recall': 0.7987567, 'specificity': 0.7987567, 'f1': 0.77167076, 'auroc': 0.9182786, 'binary_precision': 0.51592356, 'binary_recall': 0.6230769, 'binary_specificity': 0.9744366, 'binary_f1_score': 0.56446}
confusion matrix:
      0    1
0  5794  152
1    98  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_10.png
early stop counter: 3
val acc:0.9569904208183289, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 10,now: 2024-06-25 08:02:29.356514,epoch time: 0:20:00.177084,used: 3:29:31.328013,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9495531, 'precision': 0.94530797, 'recall': 0.9195106, 'specificity': 0.9195106, 'f1': 0.93144757, 'auroc': 0.9805095, 'binary_precision': 0.937377, 'binary_recall': 0.85852003, 'binary_specificity': 0.98050123, 'binary_f1_score': 0.8962172}
confusion matrix:
       0      1
0  41586    827
1   2040  12379
---- Validation: 
scalar performance:
{'acc': 0.9568303, 'precision': 0.69865495, 'recall': 0.7372813, 'specificity': 0.7372813, 'f1': 0.716005, 'auroc': 0.88155776, 'binary_precision': 0.4160494, 'binary_recall': 0.5007429, 'binary_specificity': 0.9738197, 'binary_f1_score': 0.45448416}
confusion matrix:
       0    1
0  17594  473
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7456528, 'recall': 0.8001753, 'specificity': 0.8001753, 'f1': 0.769774, 'auroc': 0.91847074, 'binary_precision': 0.5077882, 'binary_recall': 0.6269231, 'binary_specificity': 0.97342753, 'binary_f1_score': 0.5611016}
confusion matrix:
      0    1
0  5788  158
1    97  163
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_11.png
early stop counter: 4
val acc:0.9568303227424622, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 11,now: 2024-06-25 08:22:56.876740,epoch time: 0:20:27.520226,used: 3:49:58.848239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.94964105, 'precision': 0.94784486, 'recall': 0.9172579, 'specificity': 0.9172579, 'f1': 0.93121594, 'auroc': 0.98153746, 'binary_precision': 0.9445342, 'binary_recall': 0.85151535, 'binary_specificity': 0.9830005, 'binary_f1_score': 0.895616}
confusion matrix:
       0      1
0  41692    721
1   2141  12278
---- Validation: 
scalar performance:
{'acc': 0.9566702, 'precision': 0.6977535, 'recall': 0.73648304, 'specificity': 0.73648304, 'f1': 0.71513605, 'auroc': 0.88317704, 'binary_precision': 0.41430333, 'binary_recall': 0.49925706, 'binary_specificity': 0.973709, 'binary_f1_score': 0.4528302}
confusion matrix:
       0    1
0  17592  475
1    337  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7466623, 'recall': 0.80761534, 'specificity': 0.80761534, 'f1': 0.77327275, 'auroc': 0.9190173, 'binary_precision': 0.50914633, 'binary_recall': 0.6423077, 'binary_specificity': 0.972923, 'binary_f1_score': 0.5680272}
confusion matrix:
      0    1
0  5785  161
1    93  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_12.png
early stop counter: 5
val acc:0.9566702246665955, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 12,now: 2024-06-25 08:43:21.709040,epoch time: 0:20:24.832300,used: 4:10:23.680539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9522276, 'precision': 0.9490994, 'recall': 0.9229872, 'specificity': 0.9229872, 'f1': 0.9350692, 'auroc': 0.98224044, 'binary_precision': 0.9432576, 'binary_recall': 0.8636332, 'binary_specificity': 0.9823412, 'binary_f1_score': 0.90169096}
confusion matrix:
       0      1
0  41666    749
1   1966  12451
---- Validation: 
scalar performance:
{'acc': 0.9546958, 'precision': 0.6911538, 'recall': 0.74761856, 'specificity': 0.74761856, 'f1': 0.7151934, 'auroc': 0.8840933, 'binary_precision': 0.40022677, 'binary_recall': 0.52451706, 'binary_specificity': 0.9707201, 'binary_f1_score': 0.4540193}
confusion matrix:
       0    1
0  17538  529
1    320  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548824, 'precision': 0.7288902, 'recall': 0.8164629, 'specificity': 0.8164629, 'f1': 0.76447934, 'auroc': 0.91932845, 'binary_precision': 0.4726776, 'binary_recall': 0.6653846, 'binary_specificity': 0.9675412, 'binary_f1_score': 0.5527156}
confusion matrix:
      0    1
0  5753  193
1    87  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_13.png
early stop counter: 6
val acc:0.9546958208084106, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 13,now: 2024-06-25 09:04:00.776312,epoch time: 0:20:39.067272,used: 4:31:02.747811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95412797, 'precision': 0.948948, 'recall': 0.92834747, 'specificity': 0.92834747, 'f1': 0.9380374, 'auroc': 0.98352313, 'binary_precision': 0.9391123, 'binary_recall': 0.87600553, 'binary_specificity': 0.9806894, 'binary_f1_score': 0.9064619}
confusion matrix:
       0      1
0  41593    819
1   1788  12632
---- Validation: 
scalar performance:
{'acc': 0.9517076, 'precision': 0.68150175, 'recall': 0.7567978, 'specificity': 0.7567978, 'f1': 0.7116276, 'auroc': 0.88414943, 'binary_precision': 0.38016528, 'binary_recall': 0.5468053, 'binary_specificity': 0.96679026, 'binary_f1_score': 0.44850698}
confusion matrix:
       0    1
0  17467  600
1    305  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9505317, 'precision': 0.71400607, 'recall': 0.8252264, 'specificity': 0.8252264, 'f1': 0.7561058, 'auroc': 0.91941774, 'binary_precision': 0.4419753, 'binary_recall': 0.68846154, 'binary_specificity': 0.96199125, 'binary_f1_score': 0.5383458}
confusion matrix:
      0    1
0  5720  226
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_14.png
early stop counter: 7
val acc:0.9517076015472412, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 14,now: 2024-06-25 09:25:19.657717,epoch time: 0:21:18.881405,used: 4:52:21.629216,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.95428634, 'precision': 0.9520944, 'recall': 0.9256115, 'specificity': 0.9256115, 'f1': 0.9378598, 'auroc': 0.98462903, 'binary_precision': 0.94800276, 'binary_recall': 0.8673972, 'binary_specificity': 0.98382574, 'binary_f1_score': 0.90591055}
confusion matrix:
       0      1
0  41727    686
1   1912  12507
---- Validation: 
scalar performance:
{'acc': 0.9548026, 'precision': 0.6906217, 'recall': 0.7426671, 'specificity': 0.7426671, 'f1': 0.7130381, 'auroc': 0.8839533, 'binary_precision': 0.3995381, 'binary_recall': 0.51411587, 'binary_specificity': 0.9712182, 'binary_f1_score': 0.4496426}
confusion matrix:
       0    1
0  17547  520
1    327  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.73554164, 'recall': 0.8173038, 'specificity': 0.8173038, 'f1': 0.76939964, 'auroc': 0.91907877, 'binary_precision': 0.48595506, 'binary_recall': 0.6653846, 'binary_specificity': 0.969223, 'binary_f1_score': 0.5616883}
confusion matrix:
      0    1
0  5763  183
1    87  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_15.png
early stop counter: 8
val acc:0.9548025727272034, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 15,now: 2024-06-25 09:50:30.571785,epoch time: 0:25:10.914068,used: 5:17:32.543284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.95506054, 'precision': 0.9519672, 'recall': 0.92782384, 'specificity': 0.92782384, 'f1': 0.9390677, 'auroc': 0.9852536, 'binary_precision': 0.9461533, 'binary_recall': 0.8725293, 'binary_specificity': 0.98311836, 'binary_f1_score': 0.90785104}
confusion matrix:
       0      1
0  41697    716
1   1838  12581
---- Validation: 
scalar performance:
{'acc': 0.9545357, 'precision': 0.68976116, 'recall': 0.7439592, 'specificity': 0.7439592, 'f1': 0.71295047, 'auroc': 0.88457656, 'binary_precision': 0.3977143, 'binary_recall': 0.51708764, 'binary_specificity': 0.9708308, 'binary_f1_score': 0.44961238}
confusion matrix:
       0    1
0  17540  527
1    325  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.7365817, 'recall': 0.8229049, 'specificity': 0.8229049, 'f1': 0.77200687, 'auroc': 0.9196708, 'binary_precision': 0.4875346, 'binary_recall': 0.6769231, 'binary_specificity': 0.9688867, 'binary_f1_score': 0.5668277}
confusion matrix:
      0    1
0  5761  185
1    84  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_16.png
early stop counter: 9
val acc:0.954535722732544, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 16,now: 2024-06-25 10:13:09.630069,epoch time: 0:22:39.058284,used: 5:40:11.601568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9547614, 'precision': 0.95258564, 'recall': 0.9264147, 'specificity': 0.9264147, 'f1': 0.93853116, 'auroc': 0.9849609, 'binary_precision': 0.94851995, 'binary_recall': 0.8688627, 'binary_specificity': 0.9839668, 'binary_f1_score': 0.9069456}
confusion matrix:
       0      1
0  41732    680
1   1891  12529
---- Validation: 
scalar performance:
{'acc': 0.95309496, 'precision': 0.68500626, 'recall': 0.74893415, 'specificity': 0.74893415, 'f1': 0.71151257, 'auroc': 0.88544583, 'binary_precision': 0.38779956, 'binary_recall': 0.5289747, 'binary_specificity': 0.9688936, 'binary_f1_score': 0.44751728}
confusion matrix:
       0    1
0  17505  562
1    317  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95343214, 'precision': 0.7239436, 'recall': 0.82306206, 'specificity': 0.82306206, 'f1': 0.7629941, 'auroc': 0.9195529, 'binary_precision': 0.46214098, 'binary_recall': 0.6807692, 'binary_specificity': 0.96535486, 'binary_f1_score': 0.55054426}
confusion matrix:
      0    1
0  5740  206
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_17.png
early stop counter: 10
val acc:0.9530949592590332, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 17,now: 2024-06-25 10:36:19.172951,epoch time: 0:23:09.542882,used: 6:03:21.144450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.95588756, 'precision': 0.9526927, 'recall': 0.9293351, 'specificity': 0.9293351, 'f1': 0.94024014, 'auroc': 0.9845196, 'binary_precision': 0.9466737, 'binary_recall': 0.8754335, 'binary_specificity': 0.9832367, 'binary_f1_score': 0.90966094}
confusion matrix:
       0      1
0  41703    711
1   1796  12622
---- Validation: 
scalar performance:
{'acc': 0.9498933, 'precision': 0.67503536, 'recall': 0.7558569, 'specificity': 0.7558569, 'f1': 0.7065888, 'auroc': 0.8853407, 'binary_precision': 0.36726546, 'binary_recall': 0.5468053, 'binary_specificity': 0.9649084, 'binary_f1_score': 0.43940297}
confusion matrix:
       0    1
0  17433  634
1    305  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94956493, 'precision': 0.7110128, 'recall': 0.82656085, 'specificity': 0.82656085, 'f1': 0.7541275, 'auroc': 0.919441, 'binary_precision': 0.43583536, 'binary_recall': 0.6923077, 'binary_specificity': 0.960814, 'binary_f1_score': 0.5349183}
confusion matrix:
      0    1
0  5713  233
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_18.png
early stop counter: 11
val acc:0.9498932957649231, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 18,now: 2024-06-25 10:58:55.082294,epoch time: 0:22:35.909343,used: 6:25:57.053793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95630985, 'precision': 0.95262086, 'recall': 0.9305645, 'specificity': 0.9305645, 'f1': 0.9409015, 'auroc': 0.9855495, 'binary_precision': 0.94564325, 'binary_recall': 0.87829405, 'binary_specificity': 0.98283505, 'binary_f1_score': 0.9107252}
confusion matrix:
       0      1
0  41684    728
1   1755  12665
---- Validation: 
scalar performance:
{'acc': 0.95218784, 'precision': 0.6816267, 'recall': 0.74917895, 'specificity': 0.74917895, 'f1': 0.7092496, 'auroc': 0.886062, 'binary_precision': 0.3810032, 'binary_recall': 0.5304606, 'binary_specificity': 0.9678973, 'binary_f1_score': 0.44347826}
confusion matrix:
       0    1
0  17487  580
1    316  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95246536, 'precision': 0.72057074, 'recall': 0.8243965, 'specificity': 0.8243965, 'f1': 0.76088405, 'auroc': 0.91876113, 'binary_precision': 0.45524296, 'binary_recall': 0.6846154, 'binary_specificity': 0.9641776, 'binary_f1_score': 0.546851}
confusion matrix:
      0    1
0  5733  213
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_19.png
early stop counter: 12
val acc:0.9521878361701965, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 19,now: 2024-06-25 11:20:56.258611,epoch time: 0:22:01.176317,used: 6:47:58.230110,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9572248, 'precision': 0.95357084, 'recall': 0.93208903, 'specificity': 0.93208903, 'f1': 0.9421757, 'auroc': 0.9860122, 'binary_precision': 0.9466468, 'binary_recall': 0.8810597, 'binary_specificity': 0.98311836, 'binary_f1_score': 0.91267645}
confusion matrix:
       0      1
0  41697    716
1   1715  12704
---- Validation: 
scalar performance:
{'acc': 0.94893277, 'precision': 0.6729194, 'recall': 0.7603656, 'specificity': 0.7603656, 'f1': 0.70630765, 'auroc': 0.8870878, 'binary_precision': 0.36266926, 'binary_recall': 0.5572065, 'binary_specificity': 0.96352464, 'binary_f1_score': 0.43936732}
confusion matrix:
       0    1
0  17408  659
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9474702, 'precision': 0.7053981, 'recall': 0.83282363, 'specificity': 0.83282363, 'f1': 0.75121945, 'auroc': 0.9188006, 'binary_precision': 0.42396313, 'binary_recall': 0.7076923, 'binary_specificity': 0.95795494, 'binary_f1_score': 0.5302594}
confusion matrix:
      0    1
0  5696  250
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_20.png
early stop counter: 13
val acc:0.9489327669143677, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 20,now: 2024-06-25 11:41:05.505317,epoch time: 0:20:09.246706,used: 7:08:07.476816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9572952, 'precision': 0.95394284, 'recall': 0.9319113, 'specificity': 0.9319113, 'f1': 0.94224, 'auroc': 0.9863517, 'binary_precision': 0.9476002, 'binary_recall': 0.8803745, 'binary_specificity': 0.9834481, 'binary_f1_score': 0.9127512}
confusion matrix:
       0      1
0  41710    702
1   1725  12695
---- Validation: 
scalar performance:
{'acc': 0.9477588, 'precision': 0.6694591, 'recall': 0.7611873, 'specificity': 0.7611873, 'f1': 0.7038484, 'auroc': 0.8869386, 'binary_precision': 0.35566038, 'binary_recall': 0.5601783, 'binary_specificity': 0.9621963, 'binary_f1_score': 0.43508366}
confusion matrix:
       0    1
0  17384  683
1    296  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9461811, 'precision': 0.70182514, 'recall': 0.83398986, 'specificity': 0.83398986, 'f1': 0.7485203, 'auroc': 0.91787755, 'binary_precision': 0.41666666, 'binary_recall': 0.71153843, 'binary_specificity': 0.9564413, 'binary_f1_score': 0.5255682}
confusion matrix:
      0    1
0  5687  259
1    75  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_21.png
early stop counter: 14
val acc:0.9477587938308716, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 21,now: 2024-06-25 12:03:45.324551,epoch time: 0:22:39.819234,used: 7:30:47.296050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9576119, 'precision': 0.95481724, 'recall': 0.9318906, 'specificity': 0.9318906, 'f1': 0.9426125, 'auroc': 0.986518, 'binary_precision': 0.94954336, 'binary_recall': 0.87967265, 'binary_specificity': 0.9841086, 'binary_f1_score': 0.9132736}
confusion matrix:
       0      1
0  41739    674
1   1735  12684
---- Validation: 
scalar performance:
{'acc': 0.9498933, 'precision': 0.6751948, 'recall': 0.7565721, 'specificity': 0.7565721, 'f1': 0.70692235, 'auroc': 0.8862523, 'binary_precision': 0.36752987, 'binary_recall': 0.5482912, 'binary_specificity': 0.96485305, 'binary_f1_score': 0.44007155}
confusion matrix:
       0    1
0  17432  635
1    304  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9469868, 'precision': 0.70231956, 'recall': 0.82153744, 'specificity': 0.82153744, 'f1': 0.7458266, 'auroc': 0.91773653, 'binary_precision': 0.41882354, 'binary_recall': 0.6846154, 'binary_specificity': 0.9584595, 'binary_f1_score': 0.51970804}
confusion matrix:
      0    1
0  5699  247
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_22.png
early stop counter: 15
val acc:0.9498932957649231, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 22,now: 2024-06-25 12:23:33.093151,epoch time: 0:19:47.768600,used: 7:50:35.064650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.95935386, 'precision': 0.9552856, 'recall': 0.9361476, 'specificity': 0.9361476, 'f1': 0.94519854, 'auroc': 0.9870013, 'binary_precision': 0.94752014, 'binary_recall': 0.8890353, 'binary_specificity': 0.98325986, 'binary_f1_score': 0.9173465}
confusion matrix:
       0      1
0  41703    710
1   1600  12819
---- Validation: 
scalar performance:
{'acc': 0.948079, 'precision': 0.669491, 'recall': 0.7570617, 'specificity': 0.7570617, 'f1': 0.70272386, 'auroc': 0.885924, 'binary_precision': 0.35604605, 'binary_recall': 0.551263, 'binary_specificity': 0.96286047, 'binary_f1_score': 0.43265304}
confusion matrix:
       0    1
0  17396  671
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9473091, 'precision': 0.7038512, 'recall': 0.8253836, 'specificity': 0.8253836, 'f1': 0.74806416, 'auroc': 0.9171046, 'binary_precision': 0.42154565, 'binary_recall': 0.6923077, 'binary_specificity': 0.9584595, 'binary_f1_score': 0.52401745}
confusion matrix:
      0    1
0  5699  247
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_23.png
early stop counter: 16
val acc:0.948078989982605, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 23,now: 2024-06-25 12:43:44.959736,epoch time: 0:20:11.866585,used: 8:10:46.931235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9588788, 'precision': 0.9559091, 'recall': 0.9342271, 'specificity': 0.9342271, 'f1': 0.94440615, 'auroc': 0.9872631, 'binary_precision': 0.9502832, 'binary_recall': 0.8841806, 'binary_specificity': 0.9842737, 'binary_f1_score': 0.91604096}
confusion matrix:
       0      1
0  41746    667
1   1670  12749
---- Validation: 
scalar performance:
{'acc': 0.9493063, 'precision': 0.67155445, 'recall': 0.749115, 'specificity': 0.749115, 'f1': 0.70196414, 'auroc': 0.8851222, 'binary_precision': 0.36080402, 'binary_recall': 0.53343236, 'binary_specificity': 0.9647977, 'binary_f1_score': 0.43045563}
confusion matrix:
       0    1
0  17431  636
1    314  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9489204, 'precision': 0.70841885, 'recall': 0.8225465, 'specificity': 0.8225465, 'f1': 0.7509854, 'auroc': 0.9171009, 'binary_precision': 0.43099272, 'binary_recall': 0.6846154, 'binary_specificity': 0.96047765, 'binary_f1_score': 0.5289747}
confusion matrix:
      0    1
0  5711  235
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_24.png
early stop counter: 17
val acc:0.949306309223175, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 24,now: 2024-06-25 13:04:25.937059,epoch time: 0:20:40.977323,used: 8:31:27.908558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9593891, 'precision': 0.9544487, 'recall': 0.9371131, 'specificity': 0.9371131, 'f1': 0.94535387, 'auroc': 0.98697525, 'binary_precision': 0.9449669, 'binary_recall': 0.8918863, 'binary_specificity': 0.9823399, 'binary_f1_score': 0.91765964}
confusion matrix:
       0      1
0  41663    749
1   1559  12861
---- Validation: 
scalar performance:
{'acc': 0.9455176, 'precision': 0.6628321, 'recall': 0.76074016, 'specificity': 0.76074016, 'f1': 0.6984196, 'auroc': 0.8852997, 'binary_precision': 0.3423913, 'binary_recall': 0.56166416, 'binary_specificity': 0.9598162, 'binary_f1_score': 0.42543614}
confusion matrix:
       0    1
0  17341  726
1    295  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9437641, 'precision': 0.69470304, 'recall': 0.8308896, 'specificity': 0.8308896, 'f1': 0.74170387, 'auroc': 0.9166666, 'binary_precision': 0.40262583, 'binary_recall': 0.7076923, 'binary_specificity': 0.9540868, 'binary_f1_score': 0.51324964}
confusion matrix:
      0    1
0  5673  273
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_25.png
early stop counter: 18
val acc:0.9455175995826721, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 25,now: 2024-06-25 13:32:11.779994,epoch time: 0:27:45.842935,used: 8:59:13.751493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9614126, 'precision': 0.95579064, 'recall': 0.9412804, 'specificity': 0.9412804, 'f1': 0.9482366, 'auroc': 0.9883462, 'binary_precision': 0.9449054, 'binary_recall': 0.90040916, 'binary_specificity': 0.9821517, 'binary_f1_score': 0.9221208}
confusion matrix:
       0      1
0  41656    757
1   1436  12983
---- Validation: 
scalar performance:
{'acc': 0.9406083, 'precision': 0.6522837, 'recall': 0.76892316, 'specificity': 0.76892316, 'f1': 0.69131064, 'auroc': 0.8857269, 'binary_precision': 0.32055464, 'binary_recall': 0.5839524, 'binary_specificity': 0.95389384, 'binary_f1_score': 0.41390204}
confusion matrix:
       0    1
0  17234  833
1    280  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.935224, 'precision': 0.67548734, 'recall': 0.8356277, 'specificity': 0.8356277, 'f1': 0.72502774, 'auroc': 0.91631997, 'binary_precision': 0.36346152, 'binary_recall': 0.72692305, 'binary_specificity': 0.9443323, 'binary_f1_score': 0.48461536}
confusion matrix:
      0    1
0  5615  331
1    71  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_26.png
early stop counter: 19
val acc:0.9406083226203918, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 26,now: 2024-06-25 13:55:33.451836,epoch time: 0:23:21.671842,used: 9:22:35.423335,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9604976, 'precision': 0.9563575, 'recall': 0.9381727, 'specificity': 0.9381727, 'f1': 0.9467983, 'auroc': 0.9873138, 'binary_precision': 0.94843084, 'binary_recall': 0.8928497, 'binary_specificity': 0.98349565, 'binary_f1_score': 0.9198014}
confusion matrix:
       0      1
0  41713    700
1   1545  12874
---- Validation: 
scalar performance:
{'acc': 0.9464248, 'precision': 0.66433275, 'recall': 0.7562038, 'specificity': 0.7562038, 'f1': 0.69843745, 'auroc': 0.88480264, 'binary_precision': 0.34575954, 'binary_recall': 0.551263, 'binary_specificity': 0.9611446, 'binary_f1_score': 0.42497137}
confusion matrix:
       0    1
0  17365  702
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9447309, 'precision': 0.6959227, 'recall': 0.82219917, 'specificity': 0.82219917, 'f1': 0.74070513, 'auroc': 0.9157313, 'binary_precision': 0.40589568, 'binary_recall': 0.68846154, 'binary_specificity': 0.9559368, 'binary_f1_score': 0.510699}
confusion matrix:
      0    1
0  5684  262
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_27.png
early stop counter: 20
val acc:0.9464247822761536, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 27,now: 2024-06-25 14:15:47.478079,epoch time: 0:20:14.026243,used: 9:42:49.449578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96188766, 'precision': 0.95696974, 'recall': 0.94134367, 'specificity': 0.94134367, 'f1': 0.94881165, 'auroc': 0.98862505, 'binary_precision': 0.9474799, 'binary_recall': 0.89963937, 'binary_specificity': 0.983048, 'binary_f1_score': 0.9229401}
confusion matrix:
       0      1
0  41695    719
1   1447  12971
---- Validation: 
scalar performance:
{'acc': 0.9431163, 'precision': 0.6571546, 'recall': 0.76378644, 'specificity': 0.76378644, 'f1': 0.6944258, 'auroc': 0.8853496, 'binary_precision': 0.33074936, 'binary_recall': 0.57057947, 'binary_specificity': 0.9569934, 'binary_f1_score': 0.41875684}
confusion matrix:
       0    1
0  17290  777
1    289  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9394135, 'precision': 0.68475664, 'recall': 0.83597505, 'specificity': 0.83597505, 'f1': 0.73387647, 'auroc': 0.9158089, 'binary_precision': 0.3821138, 'binary_recall': 0.72307694, 'binary_specificity': 0.94887316, 'binary_f1_score': 0.5}
confusion matrix:
      0    1
0  5642  304
1    72  188
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_28.png
early stop counter: 21
val acc:0.943116307258606, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 28,now: 2024-06-25 14:36:12.241898,epoch time: 0:20:24.763819,used: 10:03:14.213397,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9625563, 'precision': 0.9572513, 'recall': 0.9428904, 'specificity': 0.9428904, 'f1': 0.9497793, 'auroc': 0.9891869, 'binary_precision': 0.9469741, 'binary_recall': 0.9029685, 'binary_specificity': 0.9828123, 'binary_f1_score': 0.9244479}
confusion matrix:
       0      1
0  41685    729
1   1399  13019
---- Validation: 
scalar performance:
{'acc': 0.94407684, 'precision': 0.65993816, 'recall': 0.76499987, 'specificity': 0.76499987, 'f1': 0.6970777, 'auroc': 0.88620245, 'binary_precision': 0.33624455, 'binary_recall': 0.57206535, 'binary_specificity': 0.9579344, 'binary_f1_score': 0.42354235}
confusion matrix:
       0    1
0  17307  760
1    288  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94086367, 'precision': 0.68801117, 'recall': 0.83489287, 'specificity': 0.83489287, 'f1': 0.73663896, 'auroc': 0.91621387, 'binary_precision': 0.38877338, 'binary_recall': 0.7192308, 'binary_specificity': 0.95055497, 'binary_f1_score': 0.50472337}
confusion matrix:
      0    1
0  5652  294
1    73  187
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_29.png
early stop counter: 22
val acc:0.9440768361091614, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 29,now: 2024-06-25 14:56:54.448718,epoch time: 0:20:42.206820,used: 10:23:56.420217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9612718, 'precision': 0.95660025, 'recall': 0.9400418, 'specificity': 0.9400418, 'f1': 0.94793344, 'auroc': 0.9891891, 'binary_precision': 0.9476114, 'binary_recall': 0.89694154, 'binary_specificity': 0.98314196, 'binary_f1_score': 0.9215805}
confusion matrix:
       0      1
0  41698    715
1   1486  12933
---- Validation: 
scalar performance:
{'acc': 0.9453575, 'precision': 0.6625371, 'recall': 0.76137245, 'specificity': 0.76137245, 'f1': 0.6983398, 'auroc': 0.88632023, 'binary_precision': 0.3417493, 'binary_recall': 0.56315005, 'binary_specificity': 0.95959485, 'binary_f1_score': 0.42536473}
confusion matrix:
       0    1
0  17337  730
1    294  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.943603, 'precision': 0.6939622, 'recall': 0.8289665, 'specificity': 0.8289665, 'f1': 0.7406242, 'auroc': 0.9159642, 'binary_precision': 0.40131578, 'binary_recall': 0.70384616, 'binary_specificity': 0.9540868, 'binary_f1_score': 0.5111732}
confusion matrix:
      0    1
0  5673  273
1    77  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_30.png
early stop counter: 23
val acc:0.9453575015068054, best validation acc: 0.9598185420036316, corresponding to test acc:                         0.9622945785522461 / 0.9626168012619019
after epoch: 30,now: 2024-06-25 15:17:50.180130,epoch time: 0:20:55.731412,used: 10:44:52.151629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_04_32_57_seed_1_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:44:52.151629 at 2024-06-25 15:17:50.180130
persisted model performance metric: 

scalar performance:
{'acc': 0.9622946, 'precision': 0.76673836, 'recall': 0.7430936, 'specificity': 0.7430936, 'f1': 0.7542942, 'auroc': 0.91455984, 'binary_precision': 0.55508476, 'binary_recall': 0.50384617, 'binary_specificity': 0.98234105, 'binary_f1_score': 0.52822584}
confusion matrix:
      0    1
0  5841  105
1   129  131
oracle model performance metric: 

scalar performance:
{'acc': 0.9626168, 'precision': 0.7665762, 'recall': 0.77636355, 'specificity': 0.77636355, 'f1': 0.77136946, 'auroc': 0.9171319, 'binary_precision': 0.55185187, 'binary_recall': 0.5730769, 'binary_specificity': 0.9796502, 'binary_f1_score': 0.5622642}
confusion matrix:
      0    1
0  5825  121
1   111  149
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190959 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  17465 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190959 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  17465 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189280 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  16466 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    792 MiB | 284672 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     54 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40464 KiB |  85570 KiB |    824 TiB |    824 TiB |
|       from large pool |  31306 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |   9158 KiB |  20341 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2942    |    7613    |  314085 K  |  314082 K  |
|       from large pool |      76    |     158    |  145894 K  |  145894 K  |
|       from small pool |    2866    |    7535    |  168190 K  |  168187 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2942    |    7613    |  314085 K  |  314082 K  |
|       from large pool |      76    |     158    |  145894 K  |  145894 K  |
|       from small pool |    2866    |    7535    |  168190 K  |  168187 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      60    |      19    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3583    |  169161 K  |  169161 K  |
|       from large pool |      10    |      22    |   87846 K  |   87846 K  |
|       from small pool |      24    |    3575    |   81314 K  |   81314 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |    792 MiB | 579584 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  26624 KiB |  43008 KiB |     54 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  85570 KiB |    824 TiB |    824 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |      0 KiB |  21236 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  314085 K  |  314085 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168190 K  |  168190 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  314085 K  |  314085 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168190 K  |  168190 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      60    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      13    |      21    |      27    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3583    |  169162 K  |  169162 K  |
|       from large pool |       3    |      22    |   87846 K  |   87846 K  |
|       from small pool |       0    |    3575    |   81315 K  |   81315 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |    792 MiB | 579584 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  26624 KiB |  43008 KiB |     54 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  85570 KiB |    824 TiB |    824 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |      0 KiB |  21236 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  314085 K  |  314085 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168190 K  |  168190 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  314085 K  |  314085 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168190 K  |  168190 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      60    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      13    |      21    |      27    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3583    |  169162 K  |  169162 K  |
|       from large pool |       3    |      22    |   87846 K  |   87846 K  |
|       from small pool |       0    |    3575    |   81315 K  |   81315 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218

 Experiment start at: 2024-06-25 15:25:26.671326
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.87573117, 'precision': 0.87084836, 'recall': 0.7961343, 'specificity': 0.7961343, 'f1': 0.8232378, 'auroc': 0.9216484, 'binary_precision': 0.86293036, 'binary_recall': 0.6279331, 'binary_specificity': 0.9643355, 'binary_f1_score': 0.72691107}
confusion matrix:
       0     1
0  40802  1509
1   5629  9500
---- Validation: 
scalar performance:
{'acc': 0.9125872, 'precision': 0.57794863, 'recall': 0.69546103, 'specificity': 0.69546103, 'f1': 0.6036631, 'auroc': 0.8045861, 'binary_precision': 0.17470257, 'binary_recall': 0.46345514, 'binary_specificity': 0.92746687, 'binary_f1_score': 0.2537517}
confusion matrix:
       0     1
0  16853  1318
1    323   279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8446866, 'precision': 0.5185423, 'recall': 0.5583508, 'specificity': 0.5583508, 'f1': 0.51255536, 'auroc': 0.685446, 'binary_precision': 0.07083825, 'binary_recall': 0.24793388, 'binary_specificity': 0.86876774, 'binary_f1_score': 0.11019283}
confusion matrix:
      0    1
0  5210  787
1   182   60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-25 15:47:40.736240,epoch time: 0:22:14.064914,used: 0:22:14.064914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9102542, 'precision': 0.9074704, 'recall': 0.8552669, 'specificity': 0.8552669, 'f1': 0.87683344, 'auroc': 0.9515172, 'binary_precision': 0.90257484, 'binary_recall': 0.7390615, 'binary_specificity': 0.97147244, 'binary_f1_score': 0.8126748}
confusion matrix:
       0      1
0  41103   1207
1   3948  11182
---- Validation: 
scalar performance:
{'acc': 0.937197, 'precision': 0.6157365, 'recall': 0.71459794, 'specificity': 0.71459794, 'f1': 0.64724964, 'auroc': 0.8374983, 'binary_precision': 0.24934839, 'binary_recall': 0.47674417, 'binary_specificity': 0.9524517, 'binary_f1_score': 0.32743865}
confusion matrix:
       0    1
0  17307  864
1    315  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8975797, 'precision': 0.5553687, 'recall': 0.61957115, 'specificity': 0.61957115, 'f1': 0.56975687, 'auroc': 0.79053366, 'binary_precision': 0.13974592, 'binary_recall': 0.3181818, 'binary_specificity': 0.9209605, 'binary_f1_score': 0.19419925}
confusion matrix:
      0    1
0  5523  474
1   165   77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-25 16:10:41.724741,epoch time: 0:23:00.988501,used: 0:45:15.053415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92264974, 'precision': 0.9202543, 'recall': 0.8760861, 'specificity': 0.8760861, 'f1': 0.89502233, 'auroc': 0.96088016, 'binary_precision': 0.9159206, 'binary_recall': 0.77769697, 'binary_specificity': 0.9744753, 'binary_f1_score': 0.8411683}
confusion matrix:
       0      1
0  41232   1080
1   3363  11765
---- Validation: 
scalar performance:
{'acc': 0.94667876, 'precision': 0.63957816, 'recall': 0.72270805, 'specificity': 0.72270805, 'f1': 0.6699111, 'auroc': 0.85151136, 'binary_precision': 0.29663607, 'binary_recall': 0.4833887, 'binary_specificity': 0.96202743, 'binary_f1_score': 0.36765632}
confusion matrix:
       0    1
0  17481  690
1    311  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91841644, 'precision': 0.58977306, 'recall': 0.66213375, 'specificity': 0.66213375, 'f1': 0.612214, 'auroc': 0.83211714, 'binary_precision': 0.205298, 'binary_recall': 0.38429752, 'binary_specificity': 0.93996996, 'binary_f1_score': 0.2676259}
confusion matrix:
      0    1
0  5637  360
1   149   93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-25 16:33:29.362659,epoch time: 0:22:47.637918,used: 1:08:02.691333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9286734, 'precision': 0.92955315, 'recall': 0.88330305, 'specificity': 0.88330305, 'f1': 0.9030799, 'auroc': 0.966221, 'binary_precision': 0.9311396, 'binary_recall': 0.78742814, 'binary_specificity': 0.979178, 'binary_f1_score': 0.85327506}
confusion matrix:
       0      1
0  41430    881
1   3216  11913
---- Validation: 
scalar performance:
{'acc': 0.9493954, 'precision': 0.6488672, 'recall': 0.72812665, 'specificity': 0.72812665, 'f1': 0.67876554, 'auroc': 0.86114985, 'binary_precision': 0.3148936, 'binary_recall': 0.49169436, 'binary_specificity': 0.9645589, 'binary_f1_score': 0.383917}
confusion matrix:
       0    1
0  17527  644
1    306  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9296362, 'precision': 0.6205582, 'recall': 0.7016766, 'specificity': 0.7016766, 'f1': 0.6483478, 'auroc': 0.85504735, 'binary_precision': 0.26378897, 'binary_recall': 0.45454547, 'binary_specificity': 0.9488077, 'binary_f1_score': 0.33383915}
confusion matrix:
      0    1
0  5690  307
1   132  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-25 16:59:57.534809,epoch time: 0:26:28.172150,used: 1:34:30.863483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9360028, 'precision': 0.9313899, 'recall': 0.9007679, 'specificity': 0.9007679, 'f1': 0.914591, 'auroc': 0.9692766, 'binary_precision': 0.92265683, 'binary_recall': 0.8263053, 'binary_specificity': 0.97523046, 'binary_f1_score': 0.87182707}
confusion matrix:
       0      1
0  41262   1048
1   2628  12502
---- Validation: 
scalar performance:
{'acc': 0.94667876, 'precision': 0.644974, 'recall': 0.7419812, 'specificity': 0.7419812, 'f1': 0.6791973, 'auroc': 0.8690709, 'binary_precision': 0.30612245, 'binary_recall': 0.5232558, 'binary_specificity': 0.9607066, 'binary_f1_score': 0.3862661}
confusion matrix:
       0    1
0  17457  714
1    287  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9257894, 'precision': 0.6297769, 'recall': 0.75519234, 'specificity': 0.75519234, 'f1': 0.66701823, 'auroc': 0.8696759, 'binary_precision': 0.277666, 'binary_recall': 0.57024795, 'binary_specificity': 0.94013673, 'binary_f1_score': 0.37347767}
confusion matrix:
      0    1
0  5638  359
1   104  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_5.png
early stop counter: 1
val acc:0.9466787576675415, best validation acc: 0.9493954181671143, corresponding to test acc:                         0.9296361804008484 / 0.9296361804008484
after epoch: 5,now: 2024-06-25 17:32:01.866546,epoch time: 0:32:04.331737,used: 2:06:35.195220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9388928, 'precision': 0.9345223, 'recall': 0.905362, 'specificity': 0.905362, 'f1': 0.918603, 'auroc': 0.9720994, 'binary_precision': 0.9262031, 'binary_recall': 0.83450097, 'binary_specificity': 0.9762231, 'binary_f1_score': 0.877964}
confusion matrix:
       0      1
0  41304   1006
1   2504  12626
---- Validation: 
scalar performance:
{'acc': 0.9490758, 'precision': 0.65114826, 'recall': 0.7400073, 'specificity': 0.7400073, 'f1': 0.68379533, 'auroc': 0.8736831, 'binary_precision': 0.31864753, 'binary_recall': 0.5166113, 'binary_specificity': 0.9634032, 'binary_f1_score': 0.3941698}
confusion matrix:
       0    1
0  17506  665
1    291  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9331624, 'precision': 0.6465306, 'recall': 0.7689413, 'specificity': 0.7689413, 'f1': 0.6857069, 'auroc': 0.87888575, 'binary_precision': 0.31019524, 'binary_recall': 0.59090906, 'binary_specificity': 0.9469735, 'binary_f1_score': 0.40682787}
confusion matrix:
      0    1
0  5679  318
1    99  143
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_6.png
new oracle model saved
early stop counter: 2
val acc:0.9490758180618286, best validation acc: 0.9493954181671143, corresponding to test acc:                         0.9296361804008484 / 0.9331623911857605
after epoch: 6,now: 2024-06-25 19:06:59.265700,epoch time: 1:34:57.399154,used: 3:41:32.594374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94256616, 'precision': 0.9408145, 'recall': 0.90891707, 'specificity': 0.90891707, 'f1': 0.92329854, 'auroc': 0.9756043, 'binary_precision': 0.93750465, 'binary_recall': 0.8378057, 'binary_specificity': 0.9800284, 'binary_f1_score': 0.8848557}
confusion matrix:
       0      1
0  41465    845
1   2454  12676
---- Validation: 
scalar performance:
{'acc': 0.94928885, 'precision': 0.652229, 'recall': 0.7417234, 'specificity': 0.7417234, 'f1': 0.6851183, 'auroc': 0.8759242, 'binary_precision': 0.3206967, 'binary_recall': 0.5199336, 'binary_specificity': 0.9635133, 'binary_f1_score': 0.39670467}
confusion matrix:
       0    1
0  17508  663
1    289  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9354063, 'precision': 0.6551895, 'recall': 0.78597045, 'specificity': 0.78597045, 'f1': 0.697069, 'auroc': 0.8838868, 'binary_precision': 0.3261339, 'binary_recall': 0.62396693, 'binary_specificity': 0.94797397, 'binary_f1_score': 0.42836878}
confusion matrix:
      0    1
0  5685  312
1    91  151
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_7.png
new oracle model saved
early stop counter: 3
val acc:0.9492888450622559, best validation acc: 0.9493954181671143, corresponding to test acc:                         0.9296361804008484 / 0.9354063272476196
after epoch: 7,now: 2024-06-25 19:34:23.595658,epoch time: 0:27:24.329958,used: 4:08:56.924332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94552577, 'precision': 0.94084775, 'recall': 0.91672164, 'specificity': 0.91672164, 'f1': 0.9278789, 'auroc': 0.9771116, 'binary_precision': 0.93178385, 'binary_recall': 0.8558493, 'binary_specificity': 0.97759396, 'binary_f1_score': 0.8922038}
confusion matrix:
       0      1
0  41362    948
1   2181  12949
---- Validation: 
scalar performance:
{'acc': 0.94822353, 'precision': 0.650478, 'recall': 0.74679446, 'specificity': 0.74679446, 'f1': 0.68498635, 'auroc': 0.878333, 'binary_precision': 0.31683168, 'binary_recall': 0.53156143, 'binary_specificity': 0.96202743, 'binary_f1_score': 0.39702234}
confusion matrix:
       0    1
0  17481  690
1    282  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9338035, 'precision': 0.65491587, 'recall': 0.7990159, 'specificity': 0.7990159, 'f1': 0.6991593, 'auroc': 0.88901335, 'binary_precision': 0.32443532, 'binary_recall': 0.6528926, 'binary_specificity': 0.9451392, 'binary_f1_score': 0.43347052}
confusion matrix:
      0    1
0  5668  329
1    84  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_8.png
early stop counter: 4
val acc:0.9482235312461853, best validation acc: 0.9493954181671143, corresponding to test acc:                         0.9296361804008484 / 0.9354063272476196
after epoch: 8,now: 2024-06-25 20:07:37.573558,epoch time: 0:33:13.977900,used: 4:42:10.902232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9458914, 'precision': 0.94341874, 'recall': 0.9151181, 'specificity': 0.9151181, 'f1': 0.92803854, 'auroc': 0.97864187, 'binary_precision': 0.9386906, 'binary_recall': 0.85008925, 'binary_specificity': 0.980147, 'binary_f1_score': 0.89219564}
confusion matrix:
       0      1
0  41471    840
1   2268  12861
---- Validation: 
scalar performance:
{'acc': 0.95285785, 'precision': 0.66327894, 'recall': 0.74035484, 'specificity': 0.74035484, 'f1': 0.6933118, 'auroc': 0.88026327, 'binary_precision': 0.34295228, 'binary_recall': 0.51328903, 'binary_specificity': 0.96742064, 'binary_f1_score': 0.41117764}
confusion matrix:
       0    1
0  17579  592
1    293  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9458246, 'precision': 0.6819087, 'recall': 0.7913898, 'specificity': 0.7913898, 'f1': 0.72166145, 'auroc': 0.8913934, 'binary_precision': 0.37939698, 'binary_recall': 0.62396693, 'binary_specificity': 0.9588127, 'binary_f1_score': 0.47187504}
confusion matrix:
      0    1
0  5750  247
1    91  151
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-25 20:42:40.405605,epoch time: 0:35:02.832047,used: 5:17:13.734279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.948938, 'precision': 0.9456672, 'recall': 0.9209442, 'specificity': 0.9209442, 'f1': 0.93236876, 'auroc': 0.98052835, 'binary_precision': 0.9393372, 'binary_recall': 0.86178863, 'binary_specificity': 0.98009974, 'binary_f1_score': 0.8988935}
confusion matrix:
       0      1
0  41469    842
1   2091  13038
---- Validation: 
scalar performance:
{'acc': 0.9512065, 'precision': 0.65980196, 'recall': 0.74833536, 'specificity': 0.74833536, 'f1': 0.6929298, 'auroc': 0.8820511, 'binary_precision': 0.33542976, 'binary_recall': 0.53156143, 'binary_specificity': 0.9651092, 'binary_f1_score': 0.41131106}
confusion matrix:
       0    1
0  17537  634
1    282  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94197786, 'precision': 0.6743529, 'recall': 0.80525076, 'specificity': 0.80525076, 'f1': 0.71848196, 'auroc': 0.893363, 'binary_precision': 0.36301368, 'binary_recall': 0.6570248, 'binary_specificity': 0.9534767, 'binary_f1_score': 0.46764705}
confusion matrix:
      0    1
0  5718  279
1    83  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_10.png
early stop counter: 1
val acc:0.9512065052986145, best validation acc: 0.9528578519821167, corresponding to test acc:                         0.9458246231079102 / 0.9458246231079102
after epoch: 10,now: 2024-06-25 21:13:49.345978,epoch time: 0:31:08.940373,used: 5:48:22.674652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95088786, 'precision': 0.94713867, 'recall': 0.9246498, 'specificity': 0.9246498, 'f1': 0.93511987, 'auroc': 0.9811568, 'binary_precision': 0.9398271, 'binary_recall': 0.8692003, 'binary_specificity': 0.98009926, 'binary_f1_score': 0.903135}
confusion matrix:
       0      1
0  41468    842
1   1979  13151
---- Validation: 
scalar performance:
{'acc': 0.9513131, 'precision': 0.66015524, 'recall': 0.7483904, 'specificity': 0.7483904, 'f1': 0.69322294, 'auroc': 0.884609, 'binary_precision': 0.33613446, 'binary_recall': 0.53156143, 'binary_specificity': 0.9652193, 'binary_f1_score': 0.41184038}
confusion matrix:
       0    1
0  17539  632
1    282  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9440616, 'precision': 0.68067497, 'recall': 0.8103001, 'specificity': 0.8103001, 'f1': 0.7251611, 'auroc': 0.8968148, 'binary_precision': 0.37529138, 'binary_recall': 0.6652893, 'binary_specificity': 0.955311, 'binary_f1_score': 0.4798808}
confusion matrix:
      0    1
0  5729  268
1    81  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_11.png
early stop counter: 2
val acc:0.9513130784034729, best validation acc: 0.9528578519821167, corresponding to test acc:                         0.9458246231079102 / 0.9458246231079102
after epoch: 11,now: 2024-06-25 21:48:02.836727,epoch time: 0:34:13.490749,used: 6:22:36.165401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9504178, 'precision': 0.9475451, 'recall': 0.9229847, 'specificity': 0.9229847, 'f1': 0.93434525, 'auroc': 0.9810523, 'binary_precision': 0.941981, 'binary_recall': 0.8650185, 'binary_specificity': 0.980951, 'binary_f1_score': 0.90186083}
confusion matrix:
       0      1
0  41506    806
1   2042  13086
---- Validation: 
scalar performance:
{'acc': 0.95312417, 'precision': 0.66542566, 'recall': 0.74531066, 'specificity': 0.74531066, 'f1': 0.6963993, 'auroc': 0.88511944, 'binary_precision': 0.3469163, 'binary_recall': 0.5232558, 'binary_specificity': 0.96736556, 'binary_f1_score': 0.41721854}
confusion matrix:
       0    1
0  17578  593
1    287  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9469466, 'precision': 0.6882158, 'recall': 0.8078354, 'specificity': 0.8078354, 'f1': 0.73100126, 'auroc': 0.89796066, 'binary_precision': 0.3906634, 'binary_recall': 0.6570248, 'binary_specificity': 0.958646, 'binary_f1_score': 0.48998457}
confusion matrix:
      0    1
0  5749  248
1    83  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_12.png
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-06-25 22:14:01.634096,epoch time: 0:25:58.797369,used: 6:48:34.962770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95120126, 'precision': 0.94737506, 'recall': 0.92524457, 'specificity': 0.92524457, 'f1': 0.9355601, 'auroc': 0.9815108, 'binary_precision': 0.93990433, 'binary_recall': 0.87038994, 'binary_specificity': 0.98009926, 'binary_f1_score': 0.90381247}
confusion matrix:
       0      1
0  41468    842
1   1961  13169
---- Validation: 
scalar performance:
{'acc': 0.9501944, 'precision': 0.6581205, 'recall': 0.75423694, 'specificity': 0.75423694, 'f1': 0.6931573, 'auroc': 0.8863238, 'binary_precision': 0.33164814, 'binary_recall': 0.54485047, 'binary_specificity': 0.96362334, 'binary_f1_score': 0.4123193}
confusion matrix:
       0    1
0  17510  661
1    274  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9418176, 'precision': 0.67589235, 'recall': 0.8150811, 'specificity': 0.8150811, 'f1': 0.7219389, 'auroc': 0.899161, 'binary_precision': 0.36525613, 'binary_recall': 0.677686, 'binary_specificity': 0.95247626, 'binary_f1_score': 0.47467443}
confusion matrix:
      0    1
0  5712  285
1    78  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_13.png
early stop counter: 1
val acc:0.9501944184303284, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 13,now: 2024-06-25 22:35:47.380592,epoch time: 0:21:45.746496,used: 7:10:20.709266,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95285517, 'precision': 0.9499459, 'recall': 0.92704666, 'specificity': 0.92704666, 'f1': 0.9377004, 'auroc': 0.9829377, 'binary_precision': 0.9442775, 'binary_recall': 0.87250495, 'binary_specificity': 0.9815883, 'binary_f1_score': 0.90697354}
confusion matrix:
       0      1
0  41531    779
1   1929  13201
---- Validation: 
scalar performance:
{'acc': 0.9498748, 'precision': 0.6590692, 'recall': 0.7621023, 'specificity': 0.7621023, 'f1': 0.6959338, 'auroc': 0.88748944, 'binary_precision': 0.33300492, 'binary_recall': 0.5614618, 'binary_specificity': 0.9627428, 'binary_f1_score': 0.41805813}
confusion matrix:
       0    1
0  17494  677
1    264  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9403751, 'precision': 0.6738484, 'recall': 0.8222617, 'specificity': 0.8222617, 'f1': 0.72148526, 'auroc': 0.900648, 'binary_precision': 0.36051503, 'binary_recall': 0.6942149, 'binary_specificity': 0.9503085, 'binary_f1_score': 0.47457626}
confusion matrix:
      0    1
0  5699  298
1    74  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_14.png
early stop counter: 2
val acc:0.9498748183250427, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 14,now: 2024-06-25 22:59:40.588322,epoch time: 0:23:53.207730,used: 7:34:13.916996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9534993, 'precision': 0.9510026, 'recall': 0.92769617, 'specificity': 0.92769617, 'f1': 0.93852794, 'auroc': 0.9839964, 'binary_precision': 0.9461434, 'binary_recall': 0.8731659, 'binary_specificity': 0.98222643, 'binary_f1_score': 0.908191}
confusion matrix:
       0      1
0  41558    752
1   1919  13211
---- Validation: 
scalar performance:
{'acc': 0.9517392, 'precision': 0.6637157, 'recall': 0.757444, 'specificity': 0.757444, 'f1': 0.6985059, 'auroc': 0.8880167, 'binary_precision': 0.34265012, 'binary_recall': 0.5498339, 'binary_specificity': 0.9650542, 'binary_f1_score': 0.42219388}
confusion matrix:
       0    1
0  17536  635
1    271  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94374096, 'precision': 0.6809212, 'recall': 0.81608164, 'specificity': 0.81608164, 'f1': 0.7266575, 'auroc': 0.9011861, 'binary_precision': 0.37528604, 'binary_recall': 0.677686, 'binary_specificity': 0.95447725, 'binary_f1_score': 0.48306328}
confusion matrix:
      0    1
0  5724  273
1    78  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_15.png
early stop counter: 3
val acc:0.9517391920089722, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 15,now: 2024-06-25 23:25:23.813936,epoch time: 0:25:43.225614,used: 7:59:57.142610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.95637184, 'precision': 0.9516284, 'recall': 0.93469524, 'specificity': 0.93469524, 'f1': 0.9427251, 'auroc': 0.9845588, 'binary_precision': 0.9421986, 'binary_recall': 0.8888889, 'binary_specificity': 0.98050153, 'binary_f1_score': 0.91476774}
confusion matrix:
       0      1
0  41486    825
1   1681  13448
---- Validation: 
scalar performance:
{'acc': 0.94635916, 'precision': 0.6521988, 'recall': 0.77393806, 'specificity': 0.77393806, 'f1': 0.69270307, 'auroc': 0.8891095, 'binary_precision': 0.31838566, 'binary_recall': 0.589701, 'binary_specificity': 0.9581751, 'binary_f1_score': 0.41351193}
confusion matrix:
       0    1
0  17411  760
1    247  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93476516, 'precision': 0.66285056, 'recall': 0.8272745, 'specificity': 0.8272745, 'f1': 0.7116748, 'auroc': 0.90206254, 'binary_precision': 0.33791748, 'binary_recall': 0.7107438, 'binary_specificity': 0.9438052, 'binary_f1_score': 0.4580559}
confusion matrix:
      0    1
0  5660  337
1    70  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_16.png
early stop counter: 4
val acc:0.9463591575622559, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 16,now: 2024-06-25 23:47:35.548901,epoch time: 0:22:11.734965,used: 8:22:08.877575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.95577997, 'precision': 0.95214885, 'recall': 0.93257, 'specificity': 0.93257, 'f1': 0.9417788, 'auroc': 0.98525685, 'binary_precision': 0.94499433, 'binary_recall': 0.8835272, 'binary_specificity': 0.9816128, 'binary_f1_score': 0.9132277}
confusion matrix:
       0      1
0  41534    778
1   1762  13366
---- Validation: 
scalar performance:
{'acc': 0.9505673, 'precision': 0.66142416, 'recall': 0.7632631, 'specificity': 0.7632631, 'f1': 0.698173, 'auroc': 0.8890254, 'binary_precision': 0.3376494, 'binary_recall': 0.5631229, 'binary_specificity': 0.9634032, 'binary_f1_score': 0.42216685}
confusion matrix:
       0    1
0  17506  665
1    263  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94422185, 'precision': 0.68294716, 'recall': 0.8202972, 'specificity': 0.8202972, 'f1': 0.7293694, 'auroc': 0.9024271, 'binary_precision': 0.37899545, 'binary_recall': 0.6859504, 'binary_specificity': 0.95464396, 'binary_f1_score': 0.4882353}
confusion matrix:
      0    1
0  5725  272
1    76  166
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_17.png
early stop counter: 5
val acc:0.9505673050880432, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 17,now: 2024-06-26 00:10:48.946206,epoch time: 0:23:13.397305,used: 8:45:22.274880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9572946, 'precision': 0.9518848, 'recall': 0.9369139, 'specificity': 0.9369139, 'f1': 0.9440573, 'auroc': 0.98543096, 'binary_precision': 0.94105774, 'binary_recall': 0.8938463, 'binary_specificity': 0.97998154, 'binary_f1_score': 0.91684467}
confusion matrix:
       0      1
0  41464    847
1   1606  13523
---- Validation: 
scalar performance:
{'acc': 0.94848984, 'precision': 0.6556777, 'recall': 0.7645991, 'specificity': 0.7645991, 'f1': 0.6936773, 'auroc': 0.88938516, 'binary_precision': 0.32602477, 'binary_recall': 0.5681063, 'binary_specificity': 0.9610919, 'binary_f1_score': 0.41429436}
confusion matrix:
       0    1
0  17464  707
1    260  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.941497, 'precision': 0.67698014, 'recall': 0.824828, 'specificity': 0.824828, 'f1': 0.7248994, 'auroc': 0.9029777, 'binary_precision': 0.36659437, 'binary_recall': 0.6983471, 'binary_specificity': 0.95130897, 'binary_f1_score': 0.48079664}
confusion matrix:
      0    1
0  5705  292
1    73  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_18.png
early stop counter: 6
val acc:0.9484898447990417, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 18,now: 2024-06-26 00:33:55.185541,epoch time: 0:23:06.239335,used: 9:08:28.514215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95703346, 'precision': 0.9542198, 'recall': 0.93381023, 'specificity': 0.93381023, 'f1': 0.94338834, 'auroc': 0.9859153, 'binary_precision': 0.94868886, 'binary_recall': 0.8847323, 'binary_specificity': 0.9828882, 'binary_f1_score': 0.91559505}
confusion matrix:
       0      1
0  41586    724
1   1744  13386
---- Validation: 
scalar performance:
{'acc': 0.9506738, 'precision': 0.66081065, 'recall': 0.75930285, 'specificity': 0.75930285, 'f1': 0.6966575, 'auroc': 0.8895198, 'binary_precision': 0.33669356, 'binary_recall': 0.55481726, 'binary_specificity': 0.96378845, 'binary_f1_score': 0.41907153}
confusion matrix:
       0    1
0  17513  658
1    268  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9447027, 'precision': 0.6842574, 'recall': 0.82054734, 'specificity': 0.82054734, 'f1': 0.730582, 'auroc': 0.9036006, 'binary_precision': 0.3816092, 'binary_recall': 0.6859504, 'binary_specificity': 0.9551442, 'binary_f1_score': 0.4903988}
confusion matrix:
      0    1
0  5728  269
1    76  166
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_19.png
early stop counter: 7
val acc:0.9506738185882568, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 19,now: 2024-06-26 00:55:22.121086,epoch time: 0:21:26.935545,used: 9:29:55.449760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9561629, 'precision': 0.95374507, 'recall': 0.93198436, 'specificity': 0.93198436, 'f1': 0.9421528, 'auroc': 0.9855993, 'binary_precision': 0.94901377, 'binary_recall': 0.880891, 'binary_specificity': 0.9830777, 'binary_f1_score': 0.9136844}
confusion matrix:
       0      1
0  41595    716
1   1802  13327
---- Validation: 
scalar performance:
{'acc': 0.9507271, 'precision': 0.6623071, 'recall': 0.7649517, 'specificity': 0.7649517, 'f1': 0.69932765, 'auroc': 0.89003074, 'binary_precision': 0.3393035, 'binary_recall': 0.5664452, 'binary_specificity': 0.96345824, 'binary_f1_score': 0.4243933}
confusion matrix:
       0    1
0  17507  664
1    261  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94309986, 'precision': 0.67995834, 'recall': 0.8197136, 'specificity': 0.8197136, 'f1': 0.72657645, 'auroc': 0.90365636, 'binary_precision': 0.3730337, 'binary_recall': 0.6859504, 'binary_specificity': 0.9534767, 'binary_f1_score': 0.48326057}
confusion matrix:
      0    1
0  5718  279
1    76  166
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_20.png
early stop counter: 8
val acc:0.950727105140686, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 20,now: 2024-06-26 01:16:31.244507,epoch time: 0:21:09.123421,used: 9:51:04.573181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.95910513, 'precision': 0.9547236, 'recall': 0.93880105, 'specificity': 0.93880105, 'f1': 0.94637907, 'auroc': 0.9865438, 'binary_precision': 0.9459799, 'binary_recall': 0.8958953, 'binary_specificity': 0.98170686, 'binary_f1_score': 0.9202567}
confusion matrix:
       0      1
0  41537    774
1   1575  13554
---- Validation: 
scalar performance:
{'acc': 0.94864964, 'precision': 0.65614647, 'recall': 0.7646816, 'specificity': 0.7646816, 'f1': 0.6940974, 'auroc': 0.8903413, 'binary_precision': 0.32695985, 'binary_recall': 0.5681063, 'binary_specificity': 0.9612569, 'binary_f1_score': 0.41504854}
confusion matrix:
       0    1
0  17467  704
1    260  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9408559, 'precision': 0.67425346, 'recall': 0.8185463, 'specificity': 0.8185463, 'f1': 0.7211384, 'auroc': 0.90306723, 'binary_precision': 0.36165577, 'binary_recall': 0.6859504, 'binary_specificity': 0.95114225, 'binary_f1_score': 0.4736091}
confusion matrix:
      0    1
0  5704  293
1    76  166
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_21.png
early stop counter: 9
val acc:0.9486496448516846, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 21,now: 2024-06-26 01:37:48.377941,epoch time: 0:21:17.133434,used: 10:12:21.706615,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.95832175, 'precision': 0.95561486, 'recall': 0.93580294, 'specificity': 0.93580294, 'f1': 0.94512045, 'auroc': 0.9862571, 'binary_precision': 0.9502829, 'binary_recall': 0.8882205, 'binary_specificity': 0.9833853, 'binary_f1_score': 0.9182042}
confusion matrix:
       0      1
0  41609    703
1   1691  13437
---- Validation: 
scalar performance:
{'acc': 0.94822353, 'precision': 0.65528893, 'recall': 0.7660676, 'specificity': 0.7660676, 'f1': 0.693686, 'auroc': 0.8901441, 'binary_precision': 0.3251418, 'binary_recall': 0.5714286, 'binary_specificity': 0.9607066, 'binary_f1_score': 0.41445786}
confusion matrix:
       0    1
0  17457  714
1    258  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94021475, 'precision': 0.67307526, 'recall': 0.82019556, 'specificity': 0.82019556, 'f1': 0.7203653, 'auroc': 0.90307605, 'binary_precision': 0.35913977, 'binary_recall': 0.69008267, 'binary_specificity': 0.9503085, 'binary_f1_score': 0.47241864}
confusion matrix:
      0    1
0  5699  298
1    75  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_22.png
early stop counter: 10
val acc:0.9482235312461853, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 22,now: 2024-06-26 01:58:22.895408,epoch time: 0:20:34.517467,used: 10:32:56.224082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.958931, 'precision': 0.9557732, 'recall': 0.9372637, 'specificity': 0.9372637, 'f1': 0.946004, 'auroc': 0.98681015, 'binary_precision': 0.9495248, 'binary_recall': 0.8914739, 'binary_specificity': 0.9830536, 'binary_f1_score': 0.9195841}
confusion matrix:
       0      1
0  41593    717
1   1642  13488
---- Validation: 
scalar performance:
{'acc': 0.9512598, 'precision': 0.66364425, 'recall': 0.7636208, 'specificity': 0.7636208, 'f1': 0.7000811, 'auroc': 0.8903675, 'binary_precision': 0.34207872, 'binary_recall': 0.5631229, 'binary_specificity': 0.96411866, 'binary_f1_score': 0.42561203}
confusion matrix:
       0    1
0  17519  652
1    263  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9453438, 'precision': 0.6860327, 'recall': 0.82088083, 'specificity': 0.82088083, 'f1': 0.73221374, 'auroc': 0.9036137, 'binary_precision': 0.38515082, 'binary_recall': 0.6859504, 'binary_specificity': 0.95581126, 'binary_f1_score': 0.49331355}
confusion matrix:
      0    1
0  5732  265
1    76  166
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_23.png
early stop counter: 11
val acc:0.9512597918510437, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 23,now: 2024-06-26 02:18:39.129804,epoch time: 0:20:16.234396,used: 10:53:12.458478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9603064, 'precision': 0.95708466, 'recall': 0.9395773, 'specificity': 0.9395773, 'f1': 0.9478717, 'auroc': 0.9875654, 'binary_precision': 0.9506874, 'binary_recall': 0.89577, 'binary_specificity': 0.98338455, 'binary_f1_score': 0.922412}
confusion matrix:
       0      1
0  41607    703
1   1577  13553
---- Validation: 
scalar performance:
{'acc': 0.94753104, 'precision': 0.65465593, 'recall': 0.7713312, 'specificity': 0.7713312, 'f1': 0.6943273, 'auroc': 0.8904968, 'binary_precision': 0.3235023, 'binary_recall': 0.58305645, 'binary_specificity': 0.959606, 'binary_f1_score': 0.4161233}
confusion matrix:
       0    1
0  17437  734
1    251  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9390928, 'precision': 0.6711875, 'recall': 0.8235774, 'specificity': 0.8235774, 'f1': 0.71921957, 'auroc': 0.9034915, 'binary_precision': 0.355042, 'binary_recall': 0.6983471, 'binary_specificity': 0.9488077, 'binary_f1_score': 0.4707521}
confusion matrix:
      0    1
0  5690  307
1    73  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_24.png
early stop counter: 12
val acc:0.9475310444831848, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 24,now: 2024-06-26 02:39:07.302353,epoch time: 0:20:28.172549,used: 11:13:40.631027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.95961004, 'precision': 0.95514446, 'recall': 0.9397202, 'specificity': 0.9397202, 'f1': 0.94707286, 'auroc': 0.987716, 'binary_precision': 0.94621706, 'binary_recall': 0.8976867, 'binary_specificity': 0.9817537, 'binary_f1_score': 0.9213132}
confusion matrix:
       0      1
0  41538    772
1   1548  13582
---- Validation: 
scalar performance:
{'acc': 0.94268364, 'precision': 0.64540434, 'recall': 0.78247905, 'specificity': 0.78247905, 'f1': 0.68803483, 'auroc': 0.8906865, 'binary_precision': 0.30413222, 'binary_recall': 0.6112957, 'binary_specificity': 0.95366246, 'binary_f1_score': 0.40618104}
confusion matrix:
       0    1
0  17329  842
1    234  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9322007, 'precision': 0.6597228, 'recall': 0.83585423, 'specificity': 0.83585423, 'f1': 0.70972383, 'auroc': 0.9036764, 'binary_precision': 0.33084112, 'binary_recall': 0.73140496, 'binary_specificity': 0.9403035, 'binary_f1_score': 0.45559844}
confusion matrix:
      0    1
0  5639  358
1    65  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_25.png
early stop counter: 13
val acc:0.9426836371421814, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 25,now: 2024-06-26 02:59:44.323746,epoch time: 0:20:37.021393,used: 11:34:17.652420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.960376, 'precision': 0.9564323, 'recall': 0.94043124, 'specificity': 0.94043124, 'f1': 0.9480467, 'auroc': 0.98776734, 'binary_precision': 0.94856226, 'binary_recall': 0.8982816, 'binary_specificity': 0.98258096, 'binary_f1_score': 0.9227375}
confusion matrix:
       0      1
0  41573    737
1   1539  13591
---- Validation: 
scalar performance:
{'acc': 0.9446546, 'precision': 0.6488966, 'recall': 0.77787584, 'specificity': 0.77787584, 'f1': 0.6904799, 'auroc': 0.8905052, 'binary_precision': 0.3114754, 'binary_recall': 0.5996678, 'binary_specificity': 0.9560839, 'binary_f1_score': 0.4099943}
confusion matrix:
       0    1
0  17373  798
1    241  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9357269, 'precision': 0.66605926, 'recall': 0.83372295, 'specificity': 0.83372295, 'f1': 0.71592534, 'auroc': 0.90321267, 'binary_precision': 0.3438114, 'binary_recall': 0.7231405, 'binary_specificity': 0.9443055, 'binary_f1_score': 0.46604526}
confusion matrix:
      0    1
0  5663  334
1    67  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_26.png
early stop counter: 14
val acc:0.9446545839309692, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 26,now: 2024-06-26 03:20:35.125582,epoch time: 0:20:50.801836,used: 11:55:08.454256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.960289, 'precision': 0.95539063, 'recall': 0.94128203, 'specificity': 0.94128203, 'f1': 0.9480352, 'auroc': 0.98764807, 'binary_precision': 0.9455542, 'binary_recall': 0.9011171, 'binary_specificity': 0.9814469, 'binary_f1_score': 0.9228009}
confusion matrix:
       0      1
0  41526    785
1   1496  13633
---- Validation: 
scalar performance:
{'acc': 0.9461461, 'precision': 0.65143704, 'recall': 0.7730249, 'specificity': 0.7730249, 'f1': 0.6918242, 'auroc': 0.89088875, 'binary_precision': 0.3169203, 'binary_recall': 0.5880399, 'binary_specificity': 0.95801, 'binary_f1_score': 0.41186735}
confusion matrix:
       0    1
0  17408  763
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93716943, 'precision': 0.6679968, 'recall': 0.8285251, 'specificity': 0.8285251, 'f1': 0.71700346, 'auroc': 0.90277594, 'binary_precision': 0.34817815, 'binary_recall': 0.7107438, 'binary_specificity': 0.94630647, 'binary_f1_score': 0.4673913}
confusion matrix:
      0    1
0  5675  322
1    70  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_27.png
early stop counter: 15
val acc:0.9461460709571838, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 27,now: 2024-06-26 03:42:03.169257,epoch time: 0:21:28.043675,used: 12:16:36.497931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.961821, 'precision': 0.95853823, 'recall': 0.9421127, 'specificity': 0.9421127, 'f1': 0.9499223, 'auroc': 0.9889916, 'binary_precision': 0.95199496, 'binary_recall': 0.9004626, 'binary_specificity': 0.9837627, 'binary_f1_score': 0.9255121}
confusion matrix:
       0      1
0  41623    687
1   1506  13624
---- Validation: 
scalar performance:
{'acc': 0.94747776, 'precision': 0.65393317, 'recall': 0.76889455, 'specificity': 0.76889455, 'f1': 0.6931502, 'auroc': 0.89073837, 'binary_precision': 0.32222223, 'binary_recall': 0.5780731, 'binary_specificity': 0.959716, 'binary_f1_score': 0.41379312}
confusion matrix:
       0    1
0  17439  732
1    254  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9411765, 'precision': 0.6769331, 'recall': 0.82862675, 'specificity': 0.82862675, 'f1': 0.725593, 'auroc': 0.9022023, 'binary_precision': 0.366167, 'binary_recall': 0.7066116, 'binary_specificity': 0.950642, 'binary_f1_score': 0.48236948}
confusion matrix:
      0    1
0  5701  296
1    71  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_28.png
early stop counter: 16
val acc:0.9474777579307556, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 28,now: 2024-06-26 04:02:51.916534,epoch time: 0:20:48.747277,used: 12:37:25.245208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9628482, 'precision': 0.95821756, 'recall': 0.94518757, 'specificity': 0.94518757, 'f1': 0.95144737, 'auroc': 0.9884887, 'binary_precision': 0.9488809, 'binary_recall': 0.90786517, 'binary_specificity': 0.98251003, 'binary_f1_score': 0.92792}
confusion matrix:
       0      1
0  41570    740
1   1394  13736
---- Validation: 
scalar performance:
{'acc': 0.94129866, 'precision': 0.6429571, 'recall': 0.7849758, 'specificity': 0.7849758, 'f1': 0.6860826, 'auroc': 0.8919209, 'binary_precision': 0.29903537, 'binary_recall': 0.6179402, 'binary_specificity': 0.95201147, 'binary_f1_score': 0.40303358}
confusion matrix:
       0    1
0  17299  872
1    230  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9291553, 'precision': 0.6544411, 'recall': 0.8362528, 'specificity': 0.8362528, 'f1': 0.70413643, 'auroc': 0.9033822, 'binary_precision': 0.32014388, 'binary_recall': 0.7355372, 'binary_specificity': 0.9369685, 'binary_f1_score': 0.4461153}
confusion matrix:
      0    1
0  5619  378
1    64  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_29.png
early stop counter: 17
val acc:0.9412986636161804, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 29,now: 2024-06-26 04:23:45.602902,epoch time: 0:20:53.686368,used: 12:58:18.931576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.95954037, 'precision': 0.95668626, 'recall': 0.93795335, 'specificity': 0.93795335, 'f1': 0.94679433, 'auroc': 0.98829675, 'binary_precision': 0.95104253, 'binary_recall': 0.8923331, 'binary_specificity': 0.9835736, 'binary_f1_score': 0.9207528}
confusion matrix:
       0      1
0  41615    695
1   1629  13501
---- Validation: 
scalar performance:
{'acc': 0.94827676, 'precision': 0.65696394, 'recall': 0.77251947, 'specificity': 0.77251947, 'f1': 0.6966146, 'auroc': 0.89206815, 'binary_precision': 0.3280522, 'binary_recall': 0.58471763, 'binary_specificity': 0.96032137, 'binary_f1_score': 0.42029852}
confusion matrix:
       0    1
0  17450  721
1    250  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9411765, 'precision': 0.6769331, 'recall': 0.82862675, 'specificity': 0.82862675, 'f1': 0.725593, 'auroc': 0.90355235, 'binary_precision': 0.366167, 'binary_recall': 0.7066116, 'binary_specificity': 0.950642, 'binary_f1_score': 0.48236948}
confusion matrix:
      0    1
0  5701  296
1    71  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556218_30.png
early stop counter: 18
val acc:0.9482767581939697, best validation acc: 0.9531241655349731, corresponding to test acc:                         0.9469466209411621 / 0.9469466209411621
after epoch: 30,now: 2024-06-26 04:44:40.746141,epoch time: 0:20:55.143239,used: 13:19:14.074815,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_25_26_seed_2_21556218
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:19:14.074815 at 2024-06-26 04:44:40.746141
persisted model performance metric: 

scalar performance:
{'acc': 0.9469466, 'precision': 0.6882158, 'recall': 0.8078354, 'specificity': 0.8078354, 'f1': 0.73100126, 'auroc': 0.89796066, 'binary_precision': 0.3906634, 'binary_recall': 0.6570248, 'binary_specificity': 0.958646, 'binary_f1_score': 0.48998457}
confusion matrix:
      0    1
0  5749  248
1    83  159
oracle model performance metric: 

scalar performance:
{'acc': 0.9469466, 'precision': 0.6882158, 'recall': 0.8078354, 'specificity': 0.8078354, 'f1': 0.73100126, 'auroc': 0.89796066, 'binary_precision': 0.3906634, 'binary_recall': 0.6570248, 'binary_specificity': 0.958646, 'binary_f1_score': 0.48998457}
confusion matrix:
      0    1
0  5749  248
1    83  159
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190965 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190965 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189282 KiB | 457564 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  16468 KiB |  37503 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1080 MiB | 579584 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1014 MiB | 550912 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     66 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  42506 KiB |  89660 KiB |   1251 TiB |   1251 TiB |
|       from large pool |  31306 KiB |  79555 KiB |   1205 TiB |   1205 TiB |
|       from small pool |  11200 KiB |  21236 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7663    |  471825 K  |  471822 K  |
|       from large pool |      76    |     158    |  219127 K  |  219127 K  |
|       from small pool |    2878    |    7585    |  252697 K  |  252695 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7663    |  471825 K  |  471822 K  |
|       from large pool |      76    |     158    |  219127 K  |  219127 K  |
|       from small pool |    2878    |    7585    |  252697 K  |  252695 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      78    |      37    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      33    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3611    |  249780 K  |  249780 K  |
|       from large pool |      10    |      22    |  130502 K  |  130502 K  |
|       from small pool |      25    |    3601    |  119277 K  |  119277 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  37503 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB | 526336 KiB |   1080 MiB |    852 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1014 MiB |    814 MiB |
|       from small pool |  28672 KiB |  43008 KiB |     66 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  89660 KiB |   1251 TiB |   1251 TiB |
|       from large pool |  23872 KiB |  79555 KiB |   1205 TiB |   1205 TiB |
|       from small pool |      0 KiB |  21236 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7663    |  471825 K  |  471825 K  |
|       from large pool |       2    |     158    |  219127 K  |  219127 K  |
|       from small pool |       0    |    7585    |  252697 K  |  252697 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7663    |  471825 K  |  471825 K  |
|       from large pool |       2    |     158    |  219127 K  |  219127 K  |
|       from small pool |       0    |    7585    |  252697 K  |  252697 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      42    |      78    |      54    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      14    |      21    |      33    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3611    |  249782 K  |  249782 K  |
|       from large pool |       3    |      22    |  130502 K  |  130502 K  |
|       from small pool |       0    |    3601    |  119279 K  |  119279 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jun 26 04:46:08 2024]
Finished job 0.
1 of 1 steps (100%) done
