Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jun 25 01:32:55 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220

 Experiment start at: 2024-06-25 01:43:52.024087
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9299965, 'precision': 0.92842966, 'recall': 0.8851049, 'specificity': 0.8851049, 'f1': 0.9038979, 'auroc': 0.9674634, 'binary_precision': 0.9256231, 'binary_recall': 0.792349, 'binary_specificity': 0.97786075, 'binary_f1_score': 0.8538166}
confusion matrix:
       0      1
0  41386    937
1   3056  11661
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.95317155, 'precision': 0.6725117, 'recall': 0.7297381, 'specificity': 0.7297381, 'f1': 0.69641215, 'auroc': 0.86627173, 'binary_precision': 0.3633218, 'binary_recall': 0.48989114, 'binary_specificity': 0.9695851, 'binary_f1_score': 0.41721857}
confusion matrix:
       0    1
0  17597  552
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9544583, 'precision': 0.721134, 'recall': 0.7636874, 'specificity': 0.7636874, 'f1': 0.7402403, 'auroc': 0.89248323, 'binary_precision': 0.46178344, 'binary_recall': 0.5555556, 'binary_specificity': 0.9718192, 'binary_f1_score': 0.50434786}
confusion matrix:
      0    1
0  5828  169
1   116  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-25 02:40:19.779611,epoch time: 0:56:27.755524,used: 0:56:27.755524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9440393, 'precision': 0.94318306, 'recall': 0.90844023, 'specificity': 0.90844023, 'f1': 0.924029, 'auroc': 0.9770175, 'binary_precision': 0.94160473, 'binary_recall': 0.8348848, 'binary_specificity': 0.9819956, 'binary_f1_score': 0.88503927}
confusion matrix:
       0      1
0  41561    762
1   2430  12287
---- Validation: 
scalar performance:
{'acc': 0.9537037, 'precision': 0.6774506, 'recall': 0.7420145, 'specificity': 0.7420145, 'f1': 0.70399153, 'auroc': 0.87950885, 'binary_precision': 0.37232846, 'binary_recall': 0.5147745, 'binary_specificity': 0.9692545, 'binary_f1_score': 0.4321149}
confusion matrix:
       0    1
0  17591  558
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9544583, 'precision': 0.724383, 'recall': 0.79483706, 'specificity': 0.79483706, 'f1': 0.75404215, 'auroc': 0.90517294, 'binary_precision': 0.46551725, 'binary_recall': 0.62068963, 'binary_specificity': 0.9689845, 'binary_f1_score': 0.53201973}
confusion matrix:
      0    1
0  5811  186
1    99  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_2.png
better model found
persisted
after epoch: 2,now: 2024-06-25 03:35:30.577306,epoch time: 0:55:10.797695,used: 1:51:38.553219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94842213, 'precision': 0.94883126, 'recall': 0.9146582, 'specificity': 0.9146582, 'f1': 0.9300474, 'auroc': 0.9811511, 'binary_precision': 0.9495875, 'binary_recall': 0.8449096, 'binary_specificity': 0.98440677, 'binary_f1_score': 0.8941955}
confusion matrix:
       0      1
0  41666    660
1   2282  12432
---- Validation: 
scalar performance:
{'acc': 0.9544487, 'precision': 0.68125844, 'recall': 0.7461505, 'specificity': 0.7461505, 'f1': 0.70802486, 'auroc': 0.88750994, 'binary_precision': 0.37966102, 'binary_recall': 0.5225505, 'binary_specificity': 0.9697504, 'binary_f1_score': 0.43979058}
confusion matrix:
       0    1
0  17600  549
1    307  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.73714805, 'recall': 0.8090808, 'specificity': 0.8090808, 'f1': 0.7676268, 'auroc': 0.91123474, 'binary_precision': 0.48985508, 'binary_recall': 0.6475096, 'binary_specificity': 0.970652, 'binary_f1_score': 0.55775577}
confusion matrix:
      0    1
0  5821  176
1    92  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-25 04:30:45.047988,epoch time: 0:55:14.470682,used: 2:46:53.023901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95280504, 'precision': 0.95232576, 'recall': 0.92288345, 'specificity': 0.92288345, 'f1': 0.9363502, 'auroc': 0.98404825, 'binary_precision': 0.95142645, 'binary_recall': 0.8610545, 'binary_specificity': 0.9847124, 'binary_f1_score': 0.90398747}
confusion matrix:
       0      1
0  41675    647
1   2045  12673
---- Validation: 
scalar performance:
{'acc': 0.9518944, 'precision': 0.67303646, 'recall': 0.75157857, 'specificity': 0.75157857, 'f1': 0.70387757, 'auroc': 0.8891816, 'binary_precision': 0.362776, 'binary_recall': 0.5365474, 'binary_specificity': 0.9666097, 'binary_f1_score': 0.43287325}
confusion matrix:
       0    1
0  17543  606
1    298  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9539789, 'precision': 0.7253121, 'recall': 0.8239043, 'specificity': 0.8239043, 'f1': 0.76426816, 'auroc': 0.91156244, 'binary_precision': 0.46475196, 'binary_recall': 0.68199235, 'binary_specificity': 0.96581626, 'binary_f1_score': 0.5527951}
confusion matrix:
      0    1
0  5792  205
1    83  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_4.png
early stop counter: 1
val acc:0.9518944025039673, best validation acc: 0.9544486999511719, corresponding to test acc:                         0.9571748375892639 / 0.9571748375892639
after epoch: 4,now: 2024-06-25 05:26:06.282346,epoch time: 0:55:21.234358,used: 3:42:14.258259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95443547, 'precision': 0.95274484, 'recall': 0.9267614, 'specificity': 0.9267614, 'f1': 0.9387737, 'auroc': 0.9853238, 'binary_precision': 0.9495399, 'binary_recall': 0.86958885, 'binary_specificity': 0.98393387, 'binary_f1_score': 0.9078074}
confusion matrix:
       0      1
0  41645    680
1   1919  12796
---- Validation: 
scalar performance:
{'acc': 0.9539698, 'precision': 0.68032736, 'recall': 0.75040287, 'specificity': 0.75040287, 'f1': 0.7087854, 'auroc': 0.8933747, 'binary_precision': 0.37748346, 'binary_recall': 0.5318818, 'binary_specificity': 0.9689239, 'binary_f1_score': 0.4415752}
confusion matrix:
       0    1
0  17585  564
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.7402837, 'recall': 0.82765424, 'specificity': 0.82765424, 'f1': 0.7761784, 'auroc': 0.9133711, 'binary_precision': 0.49447513, 'binary_recall': 0.68582374, 'binary_specificity': 0.96948475, 'binary_f1_score': 0.57463884}
confusion matrix:
      0    1
0  5814  183
1    82  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_5.png
new oracle model saved
early stop counter: 2
val acc:0.9539697766304016, best validation acc: 0.9544486999511719, corresponding to test acc:                         0.9571748375892639 / 0.9576541781425476
after epoch: 5,now: 2024-06-25 06:21:48.926591,epoch time: 0:55:42.644245,used: 4:37:56.902504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.956925, 'precision': 0.95718014, 'recall': 0.9290817, 'specificity': 0.9290817, 'f1': 0.94200265, 'auroc': 0.9871646, 'binary_precision': 0.9576613, 'binary_recall': 0.8715596, 'binary_specificity': 0.9866037, 'binary_f1_score': 0.91258407}
confusion matrix:
       0      1
0  41758    567
1   1890  12825
---- Validation: 
scalar performance:
{'acc': 0.9527991, 'precision': 0.6775, 'recall': 0.7572973, 'specificity': 0.7572973, 'f1': 0.7089227, 'auroc': 0.89297986, 'binary_precision': 0.37130803, 'binary_recall': 0.5474339, 'binary_specificity': 0.9671607, 'binary_f1_score': 0.442489}
confusion matrix:
       0    1
0  17553  596
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95557684, 'precision': 0.73212403, 'recall': 0.8320674, 'specificity': 0.8320674, 'f1': 0.7717829, 'auroc': 0.9131175, 'binary_precision': 0.47769028, 'binary_recall': 0.697318, 'binary_specificity': 0.9668167, 'binary_f1_score': 0.5669782}
confusion matrix:
      0    1
0  5798  199
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_6.png
early stop counter: 3
val acc:0.9527990818023682, best validation acc: 0.9544486999511719, corresponding to test acc:                         0.9571748375892639 / 0.9576541781425476
after epoch: 6,now: 2024-06-25 07:16:59.602427,epoch time: 0:55:10.675836,used: 5:33:07.578340,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.959993, 'precision': 0.95789754, 'recall': 0.936476, 'specificity': 0.936476, 'f1': 0.9465271, 'auroc': 0.9882833, 'binary_precision': 0.95386523, 'binary_recall': 0.88788474, 'binary_specificity': 0.98506725, 'binary_f1_score': 0.9196932}
confusion matrix:
       0      1
0  41691    632
1   1650  13067
---- Validation: 
scalar performance:
{'acc': 0.9506705, 'precision': 0.6718298, 'recall': 0.7644459, 'specificity': 0.7644459, 'f1': 0.70670104, 'auroc': 0.89430714, 'binary_precision': 0.35940593, 'binary_recall': 0.5645412, 'binary_specificity': 0.96435064, 'binary_f1_score': 0.43920147}
confusion matrix:
       0    1
0  17502  647
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95174176, 'precision': 0.71856177, 'recall': 0.83556336, 'specificity': 0.83556336, 'f1': 0.76254857, 'auroc': 0.9130708, 'binary_precision': 0.45012164, 'binary_recall': 0.70881224, 'binary_specificity': 0.9623145, 'binary_f1_score': 0.5505952}
confusion matrix:
      0    1
0  5771  226
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_7.png
early stop counter: 4
val acc:0.9506704807281494, best validation acc: 0.9544486999511719, corresponding to test acc:                         0.9571748375892639 / 0.9576541781425476
after epoch: 7,now: 2024-06-25 08:12:19.259098,epoch time: 0:55:19.656671,used: 6:28:27.235011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9583976, 'precision': 0.95882225, 'recall': 0.9313736, 'specificity': 0.9313736, 'f1': 0.94402564, 'auroc': 0.987427, 'binary_precision': 0.9596245, 'binary_recall': 0.87555224, 'binary_specificity': 0.98719496, 'binary_f1_score': 0.91566265}
confusion matrix:
       0      1
0  41785    542
1   1831  12882
---- Validation: 
scalar performance:
{'acc': 0.9541294, 'precision': 0.681755, 'recall': 0.75423574, 'specificity': 0.75423574, 'f1': 0.7110448, 'auroc': 0.8942002, 'binary_precision': 0.3800657, 'binary_recall': 0.53965783, 'binary_specificity': 0.9688137, 'binary_f1_score': 0.44601542}
confusion matrix:
       0    1
0  17583  566
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.74960005, 'recall': 0.8324028, 'specificity': 0.8324028, 'f1': 0.78420186, 'auroc': 0.9137037, 'binary_precision': 0.5127479, 'binary_recall': 0.6934866, 'binary_specificity': 0.971319, 'binary_f1_score': 0.58957654}
confusion matrix:
      0    1
0  5825  172
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_8.png
new oracle model saved
early stop counter: 5
val acc:0.9541293978691101, best validation acc: 0.9544486999511719, corresponding to test acc:                         0.9571748375892639 / 0.9597315192222595
after epoch: 8,now: 2024-06-25 09:07:21.759557,epoch time: 0:55:02.500459,used: 7:23:29.735470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95985276, 'precision': 0.9598606, 'recall': 0.93419814, 'specificity': 0.93419814, 'f1': 0.94609284, 'auroc': 0.9878268, 'binary_precision': 0.95987564, 'binary_recall': 0.88120157, 'binary_specificity': 0.98719466, 'binary_f1_score': 0.91885763}
confusion matrix:
       0      1
0  41784    542
1   1748  12966
---- Validation: 
scalar performance:
{'acc': 0.9537569, 'precision': 0.68030584, 'recall': 0.7540429, 'specificity': 0.7540429, 'f1': 0.7099466, 'auroc': 0.89520854, 'binary_precision': 0.3771739, 'binary_recall': 0.53965783, 'binary_specificity': 0.968428, 'binary_f1_score': 0.44401792}
confusion matrix:
       0    1
0  17576  573
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7503295, 'recall': 0.83248615, 'specificity': 0.83248615, 'f1': 0.7847256, 'auroc': 0.9127207, 'binary_precision': 0.51420456, 'binary_recall': 0.6934866, 'binary_specificity': 0.97148573, 'binary_f1_score': 0.5905383}
confusion matrix:
      0    1
0  5826  171
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_9.png
new oracle model saved
early stop counter: 6
val acc:0.9537569284439087, best validation acc: 0.9544486999511719, corresponding to test acc:                         0.9571748375892639 / 0.9598913192749023
after epoch: 9,now: 2024-06-25 10:06:32.904178,epoch time: 0:59:11.144621,used: 8:22:40.880091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9611676, 'precision': 0.95745695, 'recall': 0.94005644, 'specificity': 0.94005644, 'f1': 0.9483188, 'auroc': 0.98844683, 'binary_precision': 0.9502269, 'binary_recall': 0.89643925, 'binary_specificity': 0.9836736, 'binary_f1_score': 0.9225498}
confusion matrix:
       0      1
0  41633    691
1   1524  13192
---- Validation: 
scalar performance:
{'acc': 0.94960624, 'precision': 0.67163646, 'recall': 0.7788961, 'specificity': 0.7788961, 'f1': 0.7103843, 'auroc': 0.89678717, 'binary_precision': 0.35794392, 'binary_recall': 0.5956454, 'binary_specificity': 0.9621467, 'binary_f1_score': 0.44716874}
confusion matrix:
       0    1
0  17462  687
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495046, 'precision': 0.71206456, 'recall': 0.84172547, 'specificity': 0.84172547, 'f1': 0.7589693, 'auroc': 0.91288114, 'binary_precision': 0.4364896, 'binary_recall': 0.7241379, 'binary_specificity': 0.959313, 'binary_f1_score': 0.54466856}
confusion matrix:
      0    1
0  5753  244
1    72  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_10.png
early stop counter: 7
val acc:0.9496062397956848, best validation acc: 0.9544486999511719, corresponding to test acc:                         0.9571748375892639 / 0.9598913192749023
after epoch: 10,now: 2024-06-25 11:03:02.761376,epoch time: 0:56:29.857198,used: 9:19:10.737289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96209675, 'precision': 0.95849156, 'recall': 0.9415058, 'specificity': 0.9415058, 'f1': 0.94958234, 'auroc': 0.98878014, 'binary_precision': 0.9514563, 'binary_recall': 0.8989604, 'binary_specificity': 0.9840512, 'binary_f1_score': 0.9244637}
confusion matrix:
       0      1
0  41648    675
1   1487  13230
---- Validation: 
scalar performance:
{'acc': 0.9498723, 'precision': 0.67167664, 'recall': 0.7752835, 'specificity': 0.7752835, 'f1': 0.70948994, 'auroc': 0.8977052, 'binary_precision': 0.35829383, 'binary_recall': 0.58786935, 'binary_specificity': 0.9626977, 'binary_f1_score': 0.44522965}
confusion matrix:
       0    1
0  17472  677
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9511026, 'precision': 0.71744335, 'recall': 0.8443916, 'specificity': 0.8443916, 'f1': 0.7640347, 'auroc': 0.9132792, 'binary_precision': 0.44705883, 'binary_recall': 0.72796935, 'binary_specificity': 0.96081376, 'binary_f1_score': 0.5539358}
confusion matrix:
      0    1
0  5762  235
1    71  190
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_11.png
early stop counter: 8
val acc:0.9498723149299622, best validation acc: 0.9544486999511719, corresponding to test acc:                         0.9571748375892639 / 0.9598913192749023
after epoch: 11,now: 2024-06-25 11:58:34.681124,epoch time: 0:55:31.919748,used: 10:14:42.657037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9633766, 'precision': 0.96132004, 'recall': 0.94207686, 'specificity': 0.94207686, 'f1': 0.95116997, 'auroc': 0.9900502, 'binary_precision': 0.9573343, 'binary_recall': 0.89807016, 'binary_specificity': 0.98608357, 'binary_f1_score': 0.9267558}
confusion matrix:
       0      1
0  41735    589
1   1500  13216
---- Validation: 
scalar performance:
{'acc': 0.95093656, 'precision': 0.6753042, 'recall': 0.77658457, 'specificity': 0.77658457, 'f1': 0.71275544, 'auroc': 0.89879143, 'binary_precision': 0.36547735, 'binary_recall': 0.58942455, 'binary_specificity': 0.9637446, 'binary_f1_score': 0.45119044}
confusion matrix:
       0    1
0  17491  658
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95302016, 'precision': 0.72358847, 'recall': 0.8417274, 'specificity': 0.8417274, 'f1': 0.76818776, 'auroc': 0.9136145, 'binary_precision': 0.4596577, 'binary_recall': 0.7203065, 'binary_specificity': 0.96314824, 'binary_f1_score': 0.56119406}
confusion matrix:
      0    1
0  5776  221
1    73  188
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_12.png
early stop counter: 9
val acc:0.9509365558624268, best validation acc: 0.9544486999511719, corresponding to test acc:                         0.9571748375892639 / 0.9598913192749023
after epoch: 12,now: 2024-06-25 12:52:53.812949,epoch time: 0:54:19.131825,used: 11:09:01.788862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96323633, 'precision': 0.9623283, 'recall': 0.940719, 'specificity': 0.940719, 'f1': 0.950861, 'auroc': 0.9896691, 'binary_precision': 0.96058106, 'binary_recall': 0.8941968, 'binary_specificity': 0.98724127, 'binary_f1_score': 0.926201}
confusion matrix:
       0      1
0  41784    540
1   1557  13159
---- Validation: 
scalar performance:
{'acc': 0.9527991, 'precision': 0.6800356, 'recall': 0.7692982, 'specificity': 0.7692982, 'f1': 0.7144078, 'auroc': 0.899739, 'binary_precision': 0.37551022, 'binary_recall': 0.57231724, 'binary_specificity': 0.96627915, 'binary_f1_score': 0.4534812}
confusion matrix:
       0    1
0  17537  612
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.7415322, 'recall': 0.83873165, 'specificity': 0.83873165, 'f1': 0.7806889, 'auroc': 0.91333914, 'binary_precision': 0.49597856, 'binary_recall': 0.70881224, 'binary_specificity': 0.968651, 'binary_f1_score': 0.5835962}
confusion matrix:
      0    1
0  5809  188
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_13.png
early stop counter: 10
val acc:0.9527990818023682, best validation acc: 0.9544486999511719, corresponding to test acc:                         0.9571748375892639 / 0.9598913192749023
after epoch: 13,now: 2024-06-25 13:51:51.541920,epoch time: 0:58:57.728971,used: 12:07:59.517833,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96314865, 'precision': 0.96342736, 'recall': 0.9394482, 'specificity': 0.9394482, 'f1': 0.95062625, 'auroc': 0.9908662, 'binary_precision': 0.96396, 'binary_recall': 0.89047426, 'binary_specificity': 0.9884221, 'binary_f1_score': 0.9257611}
confusion matrix:
       0      1
0  41832    490
1   1612  13106
---- Validation: 
scalar performance:
{'acc': 0.95333123, 'precision': 0.68011963, 'recall': 0.760573, 'specificity': 0.760573, 'f1': 0.711858, 'auroc': 0.8985381, 'binary_precision': 0.37632135, 'binary_recall': 0.55365473, 'binary_specificity': 0.9674913, 'binary_f1_score': 0.4480805}
confusion matrix:
       0    1
0  17559  590
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.75037175, 'recall': 0.8343185, 'specificity': 0.8343185, 'f1': 0.78538966, 'auroc': 0.91294754, 'binary_precision': 0.5141243, 'binary_recall': 0.697318, 'binary_specificity': 0.971319, 'binary_f1_score': 0.59186995}
confusion matrix:
      0    1
0  5825  172
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_14.png
early stop counter: 11
val acc:0.9533312320709229, best validation acc: 0.9544486999511719, corresponding to test acc:                         0.9571748375892639 / 0.9598913192749023
after epoch: 14,now: 2024-06-25 14:47:37.959193,epoch time: 0:55:46.417273,used: 13:03:45.935106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9651823, 'precision': 0.9632057, 'recall': 0.944994, 'specificity': 0.944994, 'f1': 0.9536284, 'auroc': 0.99082255, 'binary_precision': 0.9593619, 'binary_recall': 0.9032894, 'binary_specificity': 0.9866985, 'binary_f1_score': 0.9304816}
confusion matrix:
       0      1
0  41763    563
1   1423  13291
---- Validation: 
scalar performance:
{'acc': 0.9521605, 'precision': 0.6785392, 'recall': 0.7727179, 'specificity': 0.7727179, 'f1': 0.71424043, 'auroc': 0.9001001, 'binary_precision': 0.37225547, 'binary_recall': 0.5800933, 'binary_specificity': 0.96534246, 'binary_f1_score': 0.4534954}
confusion matrix:
       0    1
0  17520  629
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.7317854, 'recall': 0.83564866, 'specificity': 0.83564866, 'f1': 0.7726362, 'auroc': 0.91266584, 'binary_precision': 0.47668394, 'binary_recall': 0.70498085, 'binary_specificity': 0.9663165, 'binary_f1_score': 0.56877893}
confusion matrix:
      0    1
0  5795  202
1    77  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_15.png
early stop counter: 12
val acc:0.9521604776382446, best validation acc: 0.9544486999511719, corresponding to test acc:                         0.9571748375892639 / 0.9598913192749023
after epoch: 15,now: 2024-06-25 15:43:01.815083,epoch time: 0:55:23.855890,used: 13:59:09.790996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9637623, 'precision': 0.96218204, 'recall': 0.94224477, 'specificity': 0.94224477, 'f1': 0.951648, 'auroc': 0.9898709, 'binary_precision': 0.9591259, 'binary_recall': 0.8977914, 'binary_specificity': 0.98669815, 'binary_f1_score': 0.9274457}
confusion matrix:
       0      1
0  41762    563
1   1504  13211
---- Validation: 
scalar performance:
{'acc': 0.9526394, 'precision': 0.67930603, 'recall': 0.7684655, 'specificity': 0.7684655, 'f1': 0.71361035, 'auroc': 0.8999597, 'binary_precision': 0.37410805, 'binary_recall': 0.57076204, 'binary_specificity': 0.96616894, 'binary_f1_score': 0.4519704}
confusion matrix:
       0    1
0  17535  614
1    276  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.73955023, 'recall': 0.8384815, 'specificity': 0.8384815, 'f1': 0.77918553, 'auroc': 0.9129025, 'binary_precision': 0.49202126, 'binary_recall': 0.70881224, 'binary_specificity': 0.96815073, 'binary_f1_score': 0.5808477}
confusion matrix:
      0    1
0  5806  191
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_16.png
early stop counter: 13
val acc:0.9526394009590149, best validation acc: 0.9544486999511719, corresponding to test acc:                         0.9571748375892639 / 0.9598913192749023
after epoch: 16,now: 2024-06-25 16:38:51.526522,epoch time: 0:55:49.711439,used: 14:54:59.502435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9662167, 'precision': 0.9635363, 'recall': 0.9474259, 'specificity': 0.9474259, 'f1': 0.95511156, 'auroc': 0.9911901, 'binary_precision': 0.95828855, 'binary_recall': 0.9086029, 'binary_specificity': 0.9862489, 'binary_f1_score': 0.9327846}
confusion matrix:
       0      1
0  41742    582
1   1345  13371
---- Validation: 
scalar performance:
{'acc': 0.9509898, 'precision': 0.67579365, 'recall': 0.77811223, 'specificity': 0.77811223, 'f1': 0.71355456, 'auroc': 0.90039974, 'binary_precision': 0.36634615, 'binary_recall': 0.592535, 'binary_specificity': 0.96368945, 'binary_f1_score': 0.45276293}
confusion matrix:
       0    1
0  17490  659
1    262  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95222116, 'precision': 0.72100115, 'recall': 0.8431428, 'specificity': 0.8431428, 'f1': 0.76654506, 'auroc': 0.91392946, 'binary_precision': 0.45432693, 'binary_recall': 0.7241379, 'binary_specificity': 0.9621477, 'binary_f1_score': 0.5583456}
confusion matrix:
      0    1
0  5770  227
1    72  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_17.png
early stop counter: 14
val acc:0.9509897828102112, best validation acc: 0.9544486999511719, corresponding to test acc:                         0.9571748375892639 / 0.9598913192749023
after epoch: 17,now: 2024-06-25 17:50:38.264233,epoch time: 1:11:46.737711,used: 16:06:46.240146,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9654804, 'precision': 0.965474, 'recall': 0.9435898, 'specificity': 0.9435898, 'f1': 0.95385826, 'auroc': 0.9907104, 'binary_precision': 0.96546185, 'binary_recall': 0.8983558, 'binary_specificity': 0.9888238, 'binary_f1_score': 0.9307007}
confusion matrix:
       0      1
0  41849    473
1   1496  13222
---- Validation: 
scalar performance:
{'acc': 0.9555662, 'precision': 0.68755853, 'recall': 0.7549796, 'specificity': 0.7549796, 'f1': 0.7153662, 'auroc': 0.89996004, 'binary_precision': 0.39164785, 'binary_recall': 0.53965783, 'binary_specificity': 0.9703014, 'binary_f1_score': 0.45389143}
confusion matrix:
       0    1
0  17610  539
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.7734461, 'recall': 0.8349041, 'specificity': 0.8349041, 'f1': 0.8006288, 'auroc': 0.91299546, 'binary_precision': 0.5603715, 'binary_recall': 0.6934866, 'binary_specificity': 0.9763215, 'binary_f1_score': 0.61986303}
confusion matrix:
      0    1
0  5855  142
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_18.png
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-06-25 19:20:34.735376,epoch time: 1:29:56.471143,used: 17:36:42.711289,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9657784, 'precision': 0.9651524, 'recall': 0.94467044, 'specificity': 0.94467044, 'f1': 0.9543199, 'auroc': 0.99118507, 'binary_precision': 0.963943, 'binary_recall': 0.90106004, 'binary_specificity': 0.9882809, 'binary_f1_score': 0.93144137}
confusion matrix:
       0      1
0  41828    496
1   1456  13260
---- Validation: 
scalar performance:
{'acc': 0.9560983, 'precision': 0.69023293, 'recall': 0.7575053, 'specificity': 0.7575053, 'f1': 0.7180686, 'auroc': 0.90056074, 'binary_precision': 0.3968254, 'binary_recall': 0.5443235, 'binary_specificity': 0.9706871, 'binary_f1_score': 0.4590164}
confusion matrix:
       0    1
0  17617  532
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.7768359, 'recall': 0.83706987, 'specificity': 0.83706987, 'f1': 0.80358124, 'auroc': 0.9133411, 'binary_precision': 0.5669782, 'binary_recall': 0.697318, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.6254296}
confusion matrix:
      0    1
0  5858  139
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_19.png
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-06-25 20:25:01.420316,epoch time: 1:04:26.684940,used: 18:41:09.396229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96630436, 'precision': 0.9647331, 'recall': 0.9464655, 'specificity': 0.9464655, 'f1': 0.95512694, 'auroc': 0.991621, 'binary_precision': 0.96167725, 'binary_recall': 0.90547705, 'binary_specificity': 0.98745394, 'binary_f1_score': 0.9327313}
confusion matrix:
       0      1
0  41793    531
1   1391  13325
---- Validation: 
scalar performance:
{'acc': 0.95434225, 'precision': 0.68533325, 'recall': 0.76784694, 'specificity': 0.76784694, 'f1': 0.71793085, 'auroc': 0.9014164, 'binary_precision': 0.38624337, 'binary_recall': 0.5676516, 'binary_specificity': 0.9680423, 'binary_f1_score': 0.45969772}
confusion matrix:
       0    1
0  17569  580
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7541033, 'recall': 0.8384, 'specificity': 0.8384, 'f1': 0.78933984, 'auroc': 0.91267616, 'binary_precision': 0.52124643, 'binary_recall': 0.70498085, 'binary_specificity': 0.9718192, 'binary_f1_score': 0.5993485}
confusion matrix:
      0    1
0  5828  169
1    77  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_20.png
early stop counter: 1
val acc:0.954342246055603, best validation acc: 0.9560983180999756, corresponding to test acc:                         0.9651646018028259 / 0.9651646018028259
after epoch: 20,now: 2024-06-25 21:28:52.275474,epoch time: 1:03:50.855158,used: 19:45:00.251387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9652174, 'precision': 0.96558934, 'recall': 0.9427819, 'specificity': 0.9427819, 'f1': 0.9534552, 'auroc': 0.9907731, 'binary_precision': 0.9663028, 'binary_recall': 0.8964322, 'binary_specificity': 0.9891317, 'binary_f1_score': 0.9300571}
confusion matrix:
       0      1
0  41865    460
1   1524  13191
---- Validation: 
scalar performance:
{'acc': 0.9557791, 'precision': 0.68961406, 'recall': 0.7610903, 'specificity': 0.7610903, 'f1': 0.71884197, 'auroc': 0.90099776, 'binary_precision': 0.39532295, 'binary_recall': 0.5520995, 'binary_specificity': 0.970081, 'binary_f1_score': 0.46073976}
confusion matrix:
       0    1
0  17606  543
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.7775914, 'recall': 0.83898556, 'specificity': 0.83898556, 'f1': 0.8048012, 'auroc': 0.9120887, 'binary_precision': 0.56832296, 'binary_recall': 0.7011494, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.6277873}
confusion matrix:
      0    1
0  5858  139
1    78  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_21.png
new oracle model saved
early stop counter: 2
val acc:0.9557790756225586, best validation acc: 0.9560983180999756, corresponding to test acc:                         0.9651646018028259 / 0.9653244018554688
after epoch: 21,now: 2024-06-25 22:28:23.293687,epoch time: 0:59:31.018213,used: 20:44:31.269600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96691793, 'precision': 0.9648404, 'recall': 0.94799006, 'specificity': 0.94799006, 'f1': 0.9560127, 'auroc': 0.9910238, 'binary_precision': 0.9607815, 'binary_recall': 0.9088809, 'binary_specificity': 0.98709923, 'binary_f1_score': 0.9341108}
confusion matrix:
       0      1
0  41777    546
1   1341  13376
---- Validation: 
scalar performance:
{'acc': 0.9536505, 'precision': 0.6830087, 'recall': 0.76898897, 'specificity': 0.76898897, 'f1': 0.71655613, 'auroc': 0.90223926, 'binary_precision': 0.38149688, 'binary_recall': 0.57076204, 'binary_specificity': 0.96721584, 'binary_f1_score': 0.45732084}
confusion matrix:
       0    1
0  17554  595
1    276  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7505016, 'recall': 0.8398155, 'specificity': 0.8398155, 'f1': 0.787356, 'auroc': 0.9123591, 'binary_precision': 0.5138889, 'binary_recall': 0.70881224, 'binary_specificity': 0.97081876, 'binary_f1_score': 0.5958133}
confusion matrix:
      0    1
0  5822  175
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_22.png
early stop counter: 3
val acc:0.9536504745483398, best validation acc: 0.9560983180999756, corresponding to test acc:                         0.9651646018028259 / 0.9653244018554688
after epoch: 22,now: 2024-06-25 23:27:17.435669,epoch time: 0:58:54.141982,used: 21:43:25.411582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96751404, 'precision': 0.9653791, 'recall': 0.9490286, 'specificity': 0.9490286, 'f1': 0.9568254, 'auroc': 0.99229926, 'binary_precision': 0.96120197, 'binary_recall': 0.91083926, 'binary_specificity': 0.98721796, 'binary_f1_score': 0.9353432}
confusion matrix:
       0      1
0  41784    541
1   1312  13403
---- Validation: 
scalar performance:
{'acc': 0.9538633, 'precision': 0.6839558, 'recall': 0.7698492, 'specificity': 0.7698492, 'f1': 0.71752155, 'auroc': 0.90120006, 'binary_precision': 0.38333333, 'binary_recall': 0.57231724, 'binary_specificity': 0.9673811, 'binary_f1_score': 0.4591391}
confusion matrix:
       0    1
0  17557  592
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7504578, 'recall': 0.83798313, 'specificity': 0.83798313, 'f1': 0.7867048, 'auroc': 0.9112847, 'binary_precision': 0.5139665, 'binary_recall': 0.70498085, 'binary_specificity': 0.9709855, 'binary_f1_score': 0.5945073}
confusion matrix:
      0    1
0  5823  174
1    77  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_23.png
early stop counter: 4
val acc:0.9538633227348328, best validation acc: 0.9560983180999756, corresponding to test acc:                         0.9651646018028259 / 0.9653244018554688
after epoch: 23,now: 2024-06-26 00:23:56.106379,epoch time: 0:56:38.670710,used: 22:40:04.082292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96712834, 'precision': 0.96744967, 'recall': 0.94600123, 'specificity': 0.94600123, 'f1': 0.9560817, 'auroc': 0.99149823, 'binary_precision': 0.96806884, 'binary_recall': 0.9023512, 'binary_specificity': 0.98965126, 'binary_f1_score': 0.93405557}
confusion matrix:
       0      1
0  41886    438
1   1437  13279
---- Validation: 
scalar performance:
{'acc': 0.95572585, 'precision': 0.68852055, 'recall': 0.75656235, 'specificity': 0.75656235, 'f1': 0.7165663, 'auroc': 0.90056014, 'binary_precision': 0.3934611, 'binary_recall': 0.5427683, 'binary_specificity': 0.97035646, 'binary_f1_score': 0.45620915}
confusion matrix:
       0    1
0  17611  538
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.77162755, 'recall': 0.83656967, 'specificity': 0.83656967, 'f1': 0.8001342, 'auroc': 0.91072166, 'binary_precision': 0.55657494, 'binary_recall': 0.697318, 'binary_specificity': 0.97582126, 'binary_f1_score': 0.6190477}
confusion matrix:
      0    1
0  5852  145
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_24.png
early stop counter: 5
val acc:0.9557258486747742, best validation acc: 0.9560983180999756, corresponding to test acc:                         0.9651646018028259 / 0.9653244018554688
after epoch: 24,now: 2024-06-26 01:19:19.831351,epoch time: 0:55:23.724972,used: 23:35:27.807264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9668128, 'precision': 0.96598005, 'recall': 0.94658643, 'specificity': 0.94658643, 'f1': 0.95575345, 'auroc': 0.99213135, 'binary_precision': 0.9643659, 'binary_recall': 0.9047975, 'binary_specificity': 0.98837537, 'binary_f1_score': 0.9336325}
confusion matrix:
       0      1
0  41832    492
1   1401  13315
---- Validation: 
scalar performance:
{'acc': 0.9546083, 'precision': 0.6862165, 'recall': 0.7672347, 'specificity': 0.7672347, 'f1': 0.7183878, 'auroc': 0.90053535, 'binary_precision': 0.3880597, 'binary_recall': 0.5660964, 'binary_specificity': 0.96837294, 'binary_f1_score': 0.46046802}
confusion matrix:
       0    1
0  17575  574
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.75484484, 'recall': 0.83848345, 'specificity': 0.83848345, 'f1': 0.78987163, 'auroc': 0.910346, 'binary_precision': 0.52272725, 'binary_recall': 0.70498085, 'binary_specificity': 0.971986, 'binary_f1_score': 0.60032624}
confusion matrix:
      0    1
0  5829  168
1    77  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_25.png
early stop counter: 6
val acc:0.9546083211898804, best validation acc: 0.9560983180999756, corresponding to test acc:                         0.9651646018028259 / 0.9653244018554688
after epoch: 25,now: 2024-06-26 02:14:34.879616,epoch time: 0:55:15.048265,used: 1 day, 0:30:42.855529,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9684432, 'precision': 0.9659165, 'recall': 0.9509598, 'specificity': 0.9509598, 'f1': 0.9581213, 'auroc': 0.99195254, 'binary_precision': 0.9609509, 'binary_recall': 0.914843, 'binary_specificity': 0.9870765, 'binary_f1_score': 0.93733025}
confusion matrix:
       0      1
0  41779    547
1   1253  13461
---- Validation: 
scalar performance:
{'acc': 0.95157516, 'precision': 0.6774485, 'recall': 0.7769152, 'specificity': 0.7769152, 'f1': 0.7145498, 'auroc': 0.90051985, 'binary_precision': 0.3697561, 'binary_recall': 0.58942455, 'binary_specificity': 0.9644058, 'binary_f1_score': 0.45443645}
confusion matrix:
       0    1
0  17503  646
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9546181, 'precision': 0.7288898, 'recall': 0.83706415, 'specificity': 0.83706415, 'f1': 0.7709036, 'auroc': 0.9098854, 'binary_precision': 0.4707379, 'binary_recall': 0.70881224, 'binary_specificity': 0.965316, 'binary_f1_score': 0.56574917}
confusion matrix:
      0    1
0  5789  208
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_26.png
early stop counter: 7
val acc:0.9515751600265503, best validation acc: 0.9560983180999756, corresponding to test acc:                         0.9651646018028259 / 0.9653244018554688
after epoch: 26,now: 2024-06-26 03:09:14.331007,epoch time: 0:54:39.451391,used: 1 day, 1:25:22.306920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.96769524, 'recall': 0.94563985, 'specificity': 0.94563985, 'f1': 0.9559876, 'auroc': 0.9923842, 'binary_precision': 0.9688869, 'binary_recall': 0.9013453, 'binary_specificity': 0.9899343, 'binary_f1_score': 0.93389654}
confusion matrix:
       0      1
0  41896    426
1   1452  13266
---- Validation: 
scalar performance:
{'acc': 0.9559387, 'precision': 0.689559, 'recall': 0.7574227, 'specificity': 0.7574227, 'f1': 0.71757543, 'auroc': 0.9006627, 'binary_precision': 0.39548022, 'binary_recall': 0.5443235, 'binary_specificity': 0.9705218, 'binary_f1_score': 0.4581152}
confusion matrix:
       0    1
0  17614  535
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.77001417, 'recall': 0.8345705, 'specificity': 0.8345705, 'f1': 0.7983496, 'auroc': 0.91009486, 'binary_precision': 0.5535168, 'binary_recall': 0.6934866, 'binary_specificity': 0.9756545, 'binary_f1_score': 0.6156463}
confusion matrix:
      0    1
0  5851  146
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_27.png
early stop counter: 8
val acc:0.9559386968612671, best validation acc: 0.9560983180999756, corresponding to test acc:                         0.9651646018028259 / 0.9653244018554688
after epoch: 27,now: 2024-06-26 04:03:54.442251,epoch time: 0:54:40.111244,used: 1 day, 2:20:02.418164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9697581, 'precision': 0.96680605, 'recall': 0.9535825, 'specificity': 0.9535825, 'f1': 0.95994663, 'auroc': 0.99238896, 'binary_precision': 0.96097076, 'binary_recall': 0.92016035, 'binary_specificity': 0.9870047, 'binary_f1_score': 0.94012284}
confusion matrix:
       0      1
0  41773    550
1   1175  13542
---- Validation: 
scalar performance:
{'acc': 0.95333123, 'precision': 0.68227756, 'recall': 0.7710738, 'specificity': 0.7710738, 'f1': 0.71662706, 'auroc': 0.90126586, 'binary_precision': 0.3798768, 'binary_recall': 0.5754277, 'binary_specificity': 0.9667199, 'binary_f1_score': 0.4576376}
confusion matrix:
       0    1
0  17545  604
1    273  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7448318, 'recall': 0.83731616, 'specificity': 0.83731616, 'f1': 0.78256845, 'auroc': 0.91013134, 'binary_precision': 0.5027322, 'binary_recall': 0.70498085, 'binary_specificity': 0.9696515, 'binary_f1_score': 0.5869218}
confusion matrix:
      0    1
0  5815  182
1    77  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_28.png
early stop counter: 9
val acc:0.9533312320709229, best validation acc: 0.9560983180999756, corresponding to test acc:                         0.9651646018028259 / 0.9653244018554688
after epoch: 28,now: 2024-06-26 04:58:53.889248,epoch time: 0:54:59.446997,used: 1 day, 3:15:01.865161,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9685133, 'precision': 0.9655966, 'recall': 0.95147526, 'specificity': 0.95147526, 'f1': 0.9582529, 'auroc': 0.99252224, 'binary_precision': 0.95984906, 'binary_recall': 0.9162759, 'binary_specificity': 0.98667455, 'binary_f1_score': 0.93755645}
confusion matrix:
       0      1
0  41761    564
1   1232  13483
---- Validation: 
scalar performance:
{'acc': 0.9526926, 'precision': 0.68117476, 'recall': 0.77674365, 'specificity': 0.77674365, 'f1': 0.7174191, 'auroc': 0.9012298, 'binary_precision': 0.37724552, 'binary_recall': 0.58786935, 'binary_specificity': 0.96561795, 'binary_f1_score': 0.4595745}
confusion matrix:
       0    1
0  17525  624
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.7355554, 'recall': 0.8361489, 'specificity': 0.8361489, 'f1': 0.77555674, 'auroc': 0.90971094, 'binary_precision': 0.48421052, 'binary_recall': 0.70498085, 'binary_specificity': 0.967317, 'binary_f1_score': 0.57410294}
confusion matrix:
      0    1
0  5801  196
1    77  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_29.png
early stop counter: 10
val acc:0.9526926279067993, best validation acc: 0.9560983180999756, corresponding to test acc:                         0.9651646018028259 / 0.9653244018554688
after epoch: 29,now: 2024-06-26 05:55:23.206577,epoch time: 0:56:29.317329,used: 1 day, 4:11:31.182490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96896917, 'precision': 0.96906817, 'recall': 0.94925547, 'specificity': 0.94925547, 'f1': 0.95861393, 'auroc': 0.9922427, 'binary_precision': 0.9692598, 'binary_recall': 0.9085287, 'binary_specificity': 0.9899823, 'binary_f1_score': 0.93791217}
confusion matrix:
       0      1
0  41901    424
1   1346  13369
---- Validation: 
scalar performance:
{'acc': 0.9557791, 'precision': 0.68975747, 'recall': 0.76184034, 'specificity': 0.76184034, 'f1': 0.71919084, 'auroc': 0.90081966, 'binary_precision': 0.39555556, 'binary_recall': 0.55365473, 'binary_specificity': 0.9700259, 'binary_f1_score': 0.46143875}
confusion matrix:
       0    1
0  17605  544
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.7674948, 'recall': 0.8343204, 'specificity': 0.8343204, 'f1': 0.7966589, 'auroc': 0.9101224, 'binary_precision': 0.54848486, 'binary_recall': 0.6934866, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.6125211}
confusion matrix:
      0    1
0  5848  149
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_30.png
early stop counter: 11
val acc:0.9557790756225586, best validation acc: 0.9560983180999756, corresponding to test acc:                         0.9651646018028259 / 0.9653244018554688
after epoch: 30,now: 2024-06-26 06:50:11.356690,epoch time: 0:54:48.150113,used: 1 day, 5:06:19.332603,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_01_43_51_seed_0_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 1 day, 5:06:19.332603 at 2024-06-26 06:50:11.356690
persisted model performance metric: 

scalar performance:
{'acc': 0.9651646, 'precision': 0.7768359, 'recall': 0.83706987, 'specificity': 0.83706987, 'f1': 0.80358124, 'auroc': 0.9133411, 'binary_precision': 0.5669782, 'binary_recall': 0.697318, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.6254296}
confusion matrix:
      0    1
0  5858  139
1    79  182
oracle model performance metric: 

scalar performance:
{'acc': 0.9653244, 'precision': 0.7775914, 'recall': 0.83898556, 'specificity': 0.83898556, 'f1': 0.8048012, 'auroc': 0.9120887, 'binary_precision': 0.56832296, 'binary_recall': 0.7011494, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.6277873}
confusion matrix:
      0    1
0  5858  139
1    78  183
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191429 KiB |   2166 MiB |   5484 TiB |   5484 TiB |
|       from large pool | 173952 KiB |   2148 MiB |   5419 TiB |   5419 TiB |
|       from small pool |  17477 KiB |     37 MiB |     64 TiB |     64 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 191429 KiB |   2166 MiB |   5484 TiB |   5484 TiB |
|       from large pool | 173952 KiB |   2148 MiB |   5419 TiB |   5419 TiB |
|       from small pool |  17477 KiB |     37 MiB |     64 TiB |     64 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189283 KiB |   2164 MiB |   5483 TiB |   5483 TiB |
|       from large pool | 172814 KiB |   2147 MiB |   5419 TiB |   5419 TiB |
|       from small pool |  16469 KiB |     36 MiB |     64 TiB |     64 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2920 MiB |   2920 MiB |   2920 MiB |      0 B   |
|       from large pool |   2878 MiB |   2878 MiB |   2878 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  58426 KiB | 755097 KiB |   2989 TiB |   2989 TiB |
|       from large pool |  51328 KiB | 752954 KiB |   2924 TiB |   2924 TiB |
|       from small pool |   7098 KiB |   9995 KiB |     64 TiB |     64 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7593    |  680087 K  |  680084 K  |
|       from large pool |      76    |     253    |  482292 K  |  482292 K  |
|       from small pool |    2890    |    7516    |  197794 K  |  197792 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7593    |  680087 K  |  680084 K  |
|       from large pool |      76    |     253    |  482292 K  |  482292 K  |
|       from small pool |    2890    |    7516    |  197794 K  |  197792 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     120    |     120    |     120    |       0    |
|       from large pool |      99    |      99    |      99    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3584    |  461902 K  |  461902 K  |
|       from large pool |      11    |     101    |  366760 K  |  366760 K  |
|       from small pool |      20    |    3573    |   95142 K  |   95142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2166 MiB |   5484 TiB |   5484 TiB |
|       from large pool |  16640 KiB |   2148 MiB |   5419 TiB |   5419 TiB |
|       from small pool |      0 KiB |     37 MiB |     64 TiB |     64 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2166 MiB |   5484 TiB |   5484 TiB |
|       from large pool |  16640 KiB |   2148 MiB |   5419 TiB |   5419 TiB |
|       from small pool |      0 KiB |     37 MiB |     64 TiB |     64 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2164 MiB |   5483 TiB |   5483 TiB |
|       from large pool |  16640 KiB |   2147 MiB |   5419 TiB |   5419 TiB |
|       from small pool |      0 KiB |     36 MiB |     64 TiB |     64 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB |   2920 MiB |   2920 MiB |   2676 MiB |
|       from large pool | 225280 KiB |   2878 MiB |   2878 MiB |   2658 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 755097 KiB |   2989 TiB |   2989 TiB |
|       from large pool |  24320 KiB | 752954 KiB |   2924 TiB |   2924 TiB |
|       from small pool |      0 KiB |  18293 KiB |     64 TiB |     64 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7593    |  680087 K  |  680087 K  |
|       from large pool |       2    |     253    |  482292 K  |  482292 K  |
|       from small pool |       0    |    7516    |  197794 K  |  197794 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7593    |  680087 K  |  680087 K  |
|       from large pool |       2    |     253    |  482292 K  |  482292 K  |
|       from small pool |       0    |    7516    |  197794 K  |  197794 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     120    |     120    |      97    |
|       from large pool |      11    |      99    |      99    |      88    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3584    |  461903 K  |  461903 K  |
|       from large pool |       4    |     101    |  366760 K  |  366760 K  |
|       from small pool |       0    |    3573    |   95143 K  |   95143 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2166 MiB |   5484 TiB |   5484 TiB |
|       from large pool |  16640 KiB |   2148 MiB |   5419 TiB |   5419 TiB |
|       from small pool |      0 KiB |     37 MiB |     64 TiB |     64 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2166 MiB |   5484 TiB |   5484 TiB |
|       from large pool |  16640 KiB |   2148 MiB |   5419 TiB |   5419 TiB |
|       from small pool |      0 KiB |     37 MiB |     64 TiB |     64 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2164 MiB |   5483 TiB |   5483 TiB |
|       from large pool |  16640 KiB |   2147 MiB |   5419 TiB |   5419 TiB |
|       from small pool |      0 KiB |     36 MiB |     64 TiB |     64 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB |   2920 MiB |   2920 MiB |   2676 MiB |
|       from large pool | 225280 KiB |   2878 MiB |   2878 MiB |   2658 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 755097 KiB |   2989 TiB |   2989 TiB |
|       from large pool |  24320 KiB | 752954 KiB |   2924 TiB |   2924 TiB |
|       from small pool |      0 KiB |  18293 KiB |     64 TiB |     64 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7593    |  680087 K  |  680087 K  |
|       from large pool |       2    |     253    |  482292 K  |  482292 K  |
|       from small pool |       0    |    7516    |  197794 K  |  197794 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7593    |  680087 K  |  680087 K  |
|       from large pool |       2    |     253    |  482292 K  |  482292 K  |
|       from small pool |       0    |    7516    |  197794 K  |  197794 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     120    |     120    |      97    |
|       from large pool |      11    |      99    |      99    |      88    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3584    |  461903 K  |  461903 K  |
|       from large pool |       4    |     101    |  366760 K  |  366760 K  |
|       from small pool |       0    |    3573    |   95143 K  |   95143 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220

 Experiment start at: 2024-06-26 06:58:40.985325
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9234058, 'precision': 0.9301188, 'recall': 0.86435646, 'specificity': 0.86435646, 'f1': 0.89093095, 'auroc': 0.9658972, 'binary_precision': 0.9413312, 'binary_recall': 0.74448603, 'binary_specificity': 0.9842269, 'binary_f1_score': 0.83141625}
confusion matrix:
       0      1
0  41745    669
1   3684  10734
---- Validation: 
scalar performance:
{'acc': 0.9566169, 'precision': 0.68628895, 'recall': 0.6849561, 'specificity': 0.6849561, 'f1': 0.6856197, 'auroc': 0.86377525, 'binary_precision': 0.39520958, 'binary_recall': 0.3922734, 'binary_specificity': 0.9776388, 'binary_f1_score': 0.393736}
confusion matrix:
       0    1
0  17663  404
1    409  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.75722706, 'recall': 0.701795, 'specificity': 0.701795, 'f1': 0.72572154, 'auroc': 0.8989049, 'binary_precision': 0.53960395, 'binary_recall': 0.41923076, 'binary_specificity': 0.9843592, 'binary_f1_score': 0.47186145}
confusion matrix:
      0    1
0  5853   93
1   151  109
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-26 07:53:56.809796,epoch time: 0:55:15.824471,used: 0:55:15.824471,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9386789, 'precision': 0.94526386, 'recall': 0.8910172, 'specificity': 0.8910172, 'f1': 0.9139985, 'auroc': 0.9777945, 'binary_precision': 0.9566416, 'binary_recall': 0.79427063, 'binary_specificity': 0.98776376, 'binary_f1_score': 0.8679274}
confusion matrix:
       0      1
0  41896    519
1   2966  11451
---- Validation: 
scalar performance:
{'acc': 0.9608324, 'precision': 0.7159284, 'recall': 0.70788515, 'specificity': 0.70788515, 'f1': 0.7118203, 'auroc': 0.8796435, 'binary_precision': 0.45285934, 'binary_recall': 0.43536404, 'binary_specificity': 0.9804063, 'binary_f1_score': 0.44393936}
confusion matrix:
       0    1
0  17713  354
1    380  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.7987735, 'recall': 0.7600759, 'specificity': 0.7600759, 'f1': 0.7779202, 'auroc': 0.9121491, 'binary_precision': 0.61777776, 'binary_recall': 0.5346154, 'binary_specificity': 0.9855365, 'binary_f1_score': 0.57319593}
confusion matrix:
      0    1
0  5860   86
1   121  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-26 08:51:26.158082,epoch time: 0:57:29.348286,used: 1:52:45.172757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9485501, 'precision': 0.94968665, 'recall': 0.9126644, 'specificity': 0.9126644, 'f1': 0.9292413, 'auroc': 0.98180604, 'binary_precision': 0.95174474, 'binary_recall': 0.83980584, 'binary_specificity': 0.985523, 'binary_f1_score': 0.8922782}
confusion matrix:
       0      1
0  41798    614
1   2310  12110
---- Validation: 
scalar performance:
{'acc': 0.9557631, 'precision': 0.6967188, 'recall': 0.75317895, 'specificity': 0.75317895, 'f1': 0.720872, 'auroc': 0.88677007, 'binary_precision': 0.41095892, 'binary_recall': 0.53491825, 'binary_specificity': 0.97143966, 'binary_f1_score': 0.464816}
confusion matrix:
       0    1
0  17551  516
1    313  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.74845666, 'recall': 0.81697845, 'specificity': 0.81697845, 'f1': 0.7779271, 'auroc': 0.9158044, 'binary_precision': 0.5119048, 'binary_recall': 0.6615385, 'binary_specificity': 0.9724184, 'binary_f1_score': 0.5771812}
confusion matrix:
      0    1
0  5782  164
1    88  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_3.png
early stop counter: 1
val acc:0.9557631015777588, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 3,now: 2024-06-26 09:53:20.384156,epoch time: 1:01:54.226074,used: 2:54:39.398831,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95166457, 'precision': 0.95217395, 'recall': 0.9185679, 'specificity': 0.9185679, 'f1': 0.93378335, 'auroc': 0.9845966, 'binary_precision': 0.95310557, 'binary_recall': 0.85137665, 'binary_specificity': 0.9857591, 'binary_f1_score': 0.8993736}
confusion matrix:
       0      1
0  41809    604
1   2143  12276
---- Validation: 
scalar performance:
{'acc': 0.95368195, 'precision': 0.6883698, 'recall': 0.7542454, 'specificity': 0.7542454, 'f1': 0.7156351, 'auroc': 0.88627386, 'binary_precision': 0.39413682, 'binary_recall': 0.5393759, 'binary_specificity': 0.96911496, 'binary_f1_score': 0.455458}
confusion matrix:
       0    1
0  17509  558
1    310  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.73805225, 'recall': 0.824912, 'specificity': 0.824912, 'f1': 0.7737019, 'auroc': 0.91454697, 'binary_precision': 0.4903047, 'binary_recall': 0.6807692, 'binary_specificity': 0.9690548, 'binary_f1_score': 0.5700483}
confusion matrix:
      0    1
0  5762  184
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_4.png
early stop counter: 2
val acc:0.9536819458007812, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 4,now: 2024-06-26 11:00:13.088958,epoch time: 1:06:52.704802,used: 4:01:32.103633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95859724, 'precision': 0.95540595, 'recall': 0.93397367, 'specificity': 0.93397367, 'f1': 0.94404185, 'auroc': 0.98624605, 'binary_precision': 0.9493558, 'binary_recall': 0.8839806, 'binary_specificity': 0.9839668, 'binary_f1_score': 0.91550255}
confusion matrix:
       0      1
0  41732    680
1   1673  12747
---- Validation: 
scalar performance:
{'acc': 0.95026684, 'precision': 0.6784933, 'recall': 0.7660643, 'specificity': 0.7660643, 'f1': 0.7122133, 'auroc': 0.8896325, 'binary_precision': 0.37341154, 'binary_recall': 0.5676077, 'binary_specificity': 0.96452093, 'binary_f1_score': 0.4504717}
confusion matrix:
       0    1
0  17426  641
1    291  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9510152, 'precision': 0.7158781, 'recall': 0.82731766, 'specificity': 0.82731766, 'f1': 0.7581459, 'auroc': 0.9149008, 'binary_precision': 0.44554454, 'binary_recall': 0.6923077, 'binary_specificity': 0.9623276, 'binary_f1_score': 0.5421687}
confusion matrix:
      0    1
0  5722  224
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_5.png
early stop counter: 3
val acc:0.9502668380737305, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 5,now: 2024-06-26 12:10:09.177066,epoch time: 1:09:56.088108,used: 5:11:28.191741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9575767, 'precision': 0.95672, 'recall': 0.9299403, 'specificity': 0.9299403, 'f1': 0.9423282, 'auroc': 0.98713505, 'binary_precision': 0.9551209, 'binary_recall': 0.87383825, 'binary_specificity': 0.9860423, 'binary_f1_score': 0.91267335}
confusion matrix:
       0      1
0  41822    592
1   1819  12599
---- Validation: 
scalar performance:
{'acc': 0.95309496, 'precision': 0.6874707, 'recall': 0.7610937, 'specificity': 0.7610937, 'f1': 0.71728075, 'auroc': 0.8901557, 'binary_precision': 0.39180672, 'binary_recall': 0.55423474, 'binary_specificity': 0.9679526, 'binary_f1_score': 0.4590769}
confusion matrix:
       0    1
0  17488  579
1    300  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.7349522, 'recall': 0.8281696, 'specificity': 0.8281696, 'f1': 0.77258396, 'auroc': 0.91468406, 'binary_precision': 0.48378378, 'binary_recall': 0.68846154, 'binary_specificity': 0.96787757, 'binary_f1_score': 0.568254}
confusion matrix:
      0    1
0  5755  191
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_6.png
early stop counter: 4
val acc:0.9530949592590332, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 6,now: 2024-06-26 13:12:02.567720,epoch time: 1:01:53.390654,used: 6:13:21.582395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95787585, 'precision': 0.9567443, 'recall': 0.93071294, 'specificity': 0.93071294, 'f1': 0.94278127, 'auroc': 0.9875022, 'binary_precision': 0.95462793, 'binary_recall': 0.8755722, 'binary_specificity': 0.98585373, 'binary_f1_score': 0.91339266}
confusion matrix:
       0      1
0  41814    600
1   1794  12624
---- Validation: 
scalar performance:
{'acc': 0.9513874, 'precision': 0.682416, 'recall': 0.7666455, 'specificity': 0.7666455, 'f1': 0.715338, 'auroc': 0.8915299, 'binary_precision': 0.38123754, 'binary_recall': 0.5676077, 'binary_specificity': 0.9656833, 'binary_f1_score': 0.4561194}
confusion matrix:
       0    1
0  17447  620
1    291  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9540767, 'precision': 0.7272287, 'recall': 0.8325933, 'specificity': 0.8325933, 'f1': 0.76831716, 'auroc': 0.91461486, 'binary_precision': 0.46786633, 'binary_recall': 0.7, 'binary_specificity': 0.96518666, 'binary_f1_score': 0.56086284}
confusion matrix:
      0    1
0  5739  207
1    78  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_7.png
early stop counter: 5
val acc:0.9513874053955078, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 7,now: 2024-06-26 14:13:43.995849,epoch time: 1:01:41.428129,used: 7:15:03.010524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9597234, 'precision': 0.9593445, 'recall': 0.93314505, 'specificity': 0.93314505, 'f1': 0.94529223, 'auroc': 0.98823273, 'binary_precision': 0.9586358, 'binary_recall': 0.87918717, 'binary_specificity': 0.987103, 'binary_f1_score': 0.91719425}
confusion matrix:
       0      1
0  41866    547
1   1742  12677
---- Validation: 
scalar performance:
{'acc': 0.9507471, 'precision': 0.6814755, 'recall': 0.7727508, 'specificity': 0.7727508, 'f1': 0.7164254, 'auroc': 0.89275503, 'binary_precision': 0.37887597, 'binary_recall': 0.58098066, 'binary_specificity': 0.96452093, 'binary_f1_score': 0.458651}
confusion matrix:
       0    1
0  17426  641
1    282  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95246536, 'precision': 0.72154737, 'recall': 0.83359146, 'specificity': 0.83359146, 'f1': 0.7643012, 'auroc': 0.9135016, 'binary_precision': 0.4563591, 'binary_recall': 0.70384616, 'binary_specificity': 0.9633367, 'binary_f1_score': 0.5537065}
confusion matrix:
      0    1
0  5728  218
1    77  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_8.png
early stop counter: 6
val acc:0.9507470726966858, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 8,now: 2024-06-26 15:17:19.837932,epoch time: 1:03:35.842083,used: 8:18:38.852607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96111345, 'precision': 0.95998037, 'recall': 0.93622404, 'specificity': 0.93622404, 'f1': 0.94731843, 'auroc': 0.98875964, 'binary_precision': 0.9578458, 'binary_recall': 0.88569844, 'binary_specificity': 0.98674965, 'binary_f1_score': 0.9203603}
confusion matrix:
       0      1
0  41852    562
1   1648  12770
---- Validation: 
scalar performance:
{'acc': 0.95192105, 'precision': 0.6846275, 'recall': 0.76835275, 'specificity': 0.76835275, 'f1': 0.71749794, 'auroc': 0.8936316, 'binary_precision': 0.38554215, 'binary_recall': 0.57057947, 'binary_specificity': 0.9661261, 'binary_f1_score': 0.46015576}
confusion matrix:
       0    1
0  17455  612
1    289  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547212, 'precision': 0.7296637, 'recall': 0.83292973, 'specificity': 0.83292973, 'f1': 0.7702304, 'auroc': 0.9133432, 'binary_precision': 0.47272727, 'binary_recall': 0.7, 'binary_specificity': 0.9658594, 'binary_f1_score': 0.56434107}
confusion matrix:
      0    1
0  5743  203
1    78  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_9.png
early stop counter: 7
val acc:0.9519210457801819, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 9,now: 2024-06-26 16:19:27.133368,epoch time: 1:02:07.295436,used: 9:20:46.148043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9593363, 'precision': 0.9600936, 'recall': 0.93141675, 'specificity': 0.93141675, 'f1': 0.9446193, 'auroc': 0.98850083, 'binary_precision': 0.96150035, 'binary_recall': 0.8747399, 'binary_specificity': 0.98809355, 'binary_f1_score': 0.91607046}
confusion matrix:
       0      1
0  41909    505
1   1806  12612
---- Validation: 
scalar performance:
{'acc': 0.9530416, 'precision': 0.6883788, 'recall': 0.7667881, 'specificity': 0.7667881, 'f1': 0.71975666, 'auroc': 0.894032, 'binary_precision': 0.39318886, 'binary_recall': 0.5661218, 'binary_specificity': 0.9674545, 'binary_f1_score': 0.46406823}
confusion matrix:
       0    1
0  17479  588
1    292  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.741865, 'recall': 0.83268845, 'specificity': 0.83268845, 'f1': 0.77895105, 'auroc': 0.9124783, 'binary_precision': 0.49725273, 'binary_recall': 0.6961538, 'binary_specificity': 0.969223, 'binary_f1_score': 0.58012813}
confusion matrix:
      0    1
0  5763  183
1    79  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_10.png
early stop counter: 8
val acc:0.9530416131019592, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 10,now: 2024-06-26 17:20:07.825124,epoch time: 1:00:40.691756,used: 10:21:26.839799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96282023, 'precision': 0.9607879, 'recall': 0.93999994, 'specificity': 0.93999994, 'f1': 0.9497933, 'auroc': 0.9892894, 'binary_precision': 0.95692533, 'binary_recall': 0.89367455, 'binary_specificity': 0.98632526, 'binary_f1_score': 0.9242191}
confusion matrix:
       0      1
0  41834    580
1   1533  12885
---- Validation: 
scalar performance:
{'acc': 0.94951975, 'precision': 0.67822707, 'recall': 0.77640593, 'specificity': 0.77640593, 'f1': 0.7149264, 'auroc': 0.89545, 'binary_precision': 0.37207124, 'binary_recall': 0.58989596, 'binary_specificity': 0.96291584, 'binary_f1_score': 0.4563218}
confusion matrix:
       0    1
0  17397  670
1    276  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95278764, 'precision': 0.72288036, 'recall': 0.8355986, 'specificity': 0.8355986, 'f1': 0.76589906, 'auroc': 0.9121102, 'binary_precision': 0.45885286, 'binary_recall': 0.7076923, 'binary_specificity': 0.96350485, 'binary_f1_score': 0.55673224}
confusion matrix:
      0    1
0  5729  217
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_11.png
early stop counter: 9
val acc:0.9495197534561157, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 11,now: 2024-06-26 18:21:54.384720,epoch time: 1:01:46.559596,used: 11:23:13.399395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9624683, 'precision': 0.96178424, 'recall': 0.9380969, 'specificity': 0.9380969, 'f1': 0.94916517, 'auroc': 0.9900301, 'binary_precision': 0.96049476, 'binary_recall': 0.8886192, 'binary_specificity': 0.9875746, 'binary_f1_score': 0.9231601}
confusion matrix:
       0      1
0  41886    527
1   1606  12813
---- Validation: 
scalar performance:
{'acc': 0.9510672, 'precision': 0.6832966, 'recall': 0.7764932, 'specificity': 0.7764932, 'f1': 0.7188968, 'auroc': 0.89546263, 'binary_precision': 0.38223937, 'binary_recall': 0.5884101, 'binary_specificity': 0.9645763, 'binary_f1_score': 0.46342885}
confusion matrix:
       0    1
0  17427  640
1    277  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9537544, 'precision': 0.72620136, 'recall': 0.83426416, 'specificity': 0.83426416, 'f1': 0.7680416, 'auroc': 0.91160893, 'binary_precision': 0.46564886, 'binary_recall': 0.70384616, 'binary_specificity': 0.96468216, 'binary_f1_score': 0.5604901}
confusion matrix:
      0    1
0  5736  210
1    77  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_12.png
early stop counter: 10
val acc:0.9510672092437744, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 12,now: 2024-06-26 19:26:19.264496,epoch time: 1:04:24.879776,used: 12:27:38.279171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96236277, 'precision': 0.9612559, 'recall': 0.93832004, 'specificity': 0.93832004, 'f1': 0.94905937, 'auroc': 0.9898411, 'binary_precision': 0.95916533, 'binary_recall': 0.88951313, 'binary_specificity': 0.9871269, 'binary_f1_score': 0.9230271}
confusion matrix:
       0      1
0  41868    546
1   1593  12825
---- Validation: 
scalar performance:
{'acc': 0.94893277, 'precision': 0.67617404, 'recall': 0.7753862, 'specificity': 0.7753862, 'f1': 0.7130233, 'auroc': 0.8959025, 'binary_precision': 0.36802974, 'binary_recall': 0.5884101, 'binary_specificity': 0.9623623, 'binary_f1_score': 0.45283017}
confusion matrix:
       0    1
0  17387  680
1    277  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9503706, 'precision': 0.7150338, 'recall': 0.8380152, 'specificity': 0.8380152, 'f1': 0.7604029, 'auroc': 0.9109266, 'binary_precision': 0.44285715, 'binary_recall': 0.7153846, 'binary_specificity': 0.9606458, 'binary_f1_score': 0.5470588}
confusion matrix:
      0    1
0  5712  234
1    74  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_13.png
early stop counter: 11
val acc:0.9489327669143677, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 13,now: 2024-06-26 20:23:29.622206,epoch time: 0:57:10.357710,used: 13:24:48.636881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9633305, 'precision': 0.9613447, 'recall': 0.94082946, 'specificity': 0.94082946, 'f1': 0.95050275, 'auroc': 0.9901154, 'binary_precision': 0.95756674, 'binary_recall': 0.89514565, 'binary_specificity': 0.98651326, 'binary_f1_score': 0.92530465}
confusion matrix:
       0      1
0  41840    572
1   1512  12908
---- Validation: 
scalar performance:
{'acc': 0.9522412, 'precision': 0.686357, 'recall': 0.7713799, 'specificity': 0.7713799, 'f1': 0.71969944, 'auroc': 0.8957473, 'binary_precision': 0.38877755, 'binary_recall': 0.576523, 'binary_specificity': 0.96623677, 'binary_f1_score': 0.46439257}
confusion matrix:
       0    1
0  17457  610
1    285  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95601034, 'precision': 0.7345592, 'recall': 0.8317634, 'specificity': 0.8317634, 'f1': 0.77344894, 'auroc': 0.9104136, 'binary_precision': 0.48266667, 'binary_recall': 0.6961538, 'binary_specificity': 0.967373, 'binary_f1_score': 0.57007873}
confusion matrix:
      0    1
0  5752  194
1    79  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_14.png
early stop counter: 12
val acc:0.9522411823272705, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 14,now: 2024-06-26 21:18:14.193480,epoch time: 0:54:44.571274,used: 14:19:33.208155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96521324, 'precision': 0.9633732, 'recall': 0.9438726, 'specificity': 0.9438726, 'f1': 0.95309734, 'auroc': 0.9906837, 'binary_precision': 0.95986104, 'binary_recall': 0.90054786, 'binary_specificity': 0.98719734, 'binary_f1_score': 0.92925894}
confusion matrix:
       0      1
0  41870    543
1   1434  12985
---- Validation: 
scalar performance:
{'acc': 0.94909286, 'precision': 0.6771362, 'recall': 0.777615, 'specificity': 0.777615, 'f1': 0.7143888, 'auroc': 0.89730644, 'binary_precision': 0.36978683, 'binary_recall': 0.59286773, 'binary_specificity': 0.9623623, 'binary_f1_score': 0.4554794}
confusion matrix:
       0    1
0  17387  680
1    274  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9513374, 'precision': 0.71824956, 'recall': 0.83851975, 'specificity': 0.83851975, 'f1': 0.7631002, 'auroc': 0.9105766, 'binary_precision': 0.44927537, 'binary_recall': 0.7153846, 'binary_specificity': 0.9616549, 'binary_f1_score': 0.5519288}
confusion matrix:
      0    1
0  5718  228
1    74  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_15.png
early stop counter: 13
val acc:0.9490928649902344, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 15,now: 2024-06-26 22:15:42.839522,epoch time: 0:57:28.646042,used: 15:17:01.854197,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9639112, 'precision': 0.9638405, 'recall': 0.9399562, 'specificity': 0.9399562, 'f1': 0.95111465, 'auroc': 0.9900973, 'binary_precision': 0.96370727, 'binary_recall': 0.8913239, 'binary_specificity': 0.9885884, 'binary_f1_score': 0.92610335}
confusion matrix:
       0      1
0  41929    484
1   1567  12852
---- Validation: 
scalar performance:
{'acc': 0.9524013, 'precision': 0.6870821, 'recall': 0.7721782, 'specificity': 0.7721782, 'f1': 0.7204795, 'auroc': 0.89735687, 'binary_precision': 0.3901705, 'binary_recall': 0.5780089, 'binary_specificity': 0.96634746, 'binary_f1_score': 0.46586826}
confusion matrix:
       0    1
0  17459  608
1    284  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.7379387, 'recall': 0.8340229, 'specificity': 0.8340229, 'f1': 0.77659947, 'auroc': 0.909585, 'binary_precision': 0.48924732, 'binary_recall': 0.7, 'binary_specificity': 0.9680458, 'binary_f1_score': 0.5759494}
confusion matrix:
      0    1
0  5756  190
1    78  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_16.png
early stop counter: 14
val acc:0.9524012804031372, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 16,now: 2024-06-26 23:09:58.260022,epoch time: 0:54:15.420500,used: 16:11:17.274697,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96443903, 'precision': 0.9652324, 'recall': 0.9400352, 'specificity': 0.9400352, 'f1': 0.95176613, 'auroc': 0.9912743, 'binary_precision': 0.9667219, 'binary_recall': 0.8904917, 'binary_specificity': 0.98957866, 'binary_f1_score': 0.92704237}
confusion matrix:
       0      1
0  41971    442
1   1579  12840
---- Validation: 
scalar performance:
{'acc': 0.9562967, 'precision': 0.6993442, 'recall': 0.75488627, 'specificity': 0.75488627, 'f1': 0.72321296, 'auroc': 0.89738095, 'binary_precision': 0.41609195, 'binary_recall': 0.53789, 'binary_specificity': 0.97188246, 'binary_f1_score': 0.46921578}
confusion matrix:
       0    1
0  17559  508
1    311  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.75953794, 'recall': 0.82367265, 'specificity': 0.82367265, 'f1': 0.78755486, 'auroc': 0.9093775, 'binary_precision': 0.5335366, 'binary_recall': 0.6730769, 'binary_specificity': 0.97426844, 'binary_f1_score': 0.59523815}
confusion matrix:
      0    1
0  5793  153
1    85  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_17.png
early stop counter: 15
val acc:0.9562966823577881, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 17,now: 2024-06-27 00:03:21.325638,epoch time: 0:53:23.065616,used: 17:04:40.340313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9650725, 'precision': 0.96447146, 'recall': 0.94242793, 'specificity': 0.94242793, 'f1': 0.95278203, 'auroc': 0.99077594, 'binary_precision': 0.96333283, 'binary_recall': 0.89645606, 'binary_specificity': 0.9883998, 'binary_f1_score': 0.928692}
confusion matrix:
       0      1
0  41921    492
1   1493  12926
---- Validation: 
scalar performance:
{'acc': 0.95160085, 'precision': 0.68571436, 'recall': 0.779631, 'specificity': 0.779631, 'f1': 0.7216521, 'auroc': 0.8990724, 'binary_precision': 0.3868472, 'binary_recall': 0.5943536, 'binary_specificity': 0.9649084, 'binary_f1_score': 0.46865848}
confusion matrix:
       0    1
0  17433  634
1    273  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535933, 'precision': 0.72578275, 'recall': 0.83601904, 'specificity': 0.83601904, 'f1': 0.7682388, 'auroc': 0.9084394, 'binary_precision': 0.46464646, 'binary_recall': 0.7076923, 'binary_specificity': 0.96434575, 'binary_f1_score': 0.5609756}
confusion matrix:
      0    1
0  5734  212
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556220_18.png
early stop counter: 16
val acc:0.9516008496284485, best validation acc: 0.960832417011261, corresponding to test acc:                         0.9666451811790466 / 0.9666451811790466
after epoch: 18,now: 2024-06-27 00:56:42.354795,epoch time: 0:53:21.029157,used: 17:58:01.369470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_06_58_40_seed_1_21556220
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21556220 ON supergpu03 CANCELLED AT 2024-06-27T01:32:06 DUE TO TIME LIMIT ***
