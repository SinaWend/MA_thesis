Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jun 25 04:58:02 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224

 Experiment start at: 2024-06-25 05:08:02.837181
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.85292774, 'precision': 0.8578273, 'recall': 0.74097776, 'specificity': 0.74097776, 'f1': 0.7744274, 'auroc': 0.9151422, 'binary_precision': 0.864868, 'binary_recall': 0.509648, 'binary_specificity': 0.97230756, 'binary_f1_score': 0.6413578}
confusion matrix:
       0     1
0  41150  1172
1   7217  7501
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.94226265, 'precision': 0.6100583, 'recall': 0.64608467, 'specificity': 0.64608467, 'f1': 0.62497604, 'auroc': 0.82253385, 'binary_precision': 0.24421297, 'binary_recall': 0.3281493, 'binary_specificity': 0.9640201, 'binary_f1_score': 0.28002656}
confusion matrix:
       0    1
0  17496  653
1    432  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93863857, 'precision': 0.6067486, 'recall': 0.5996849, 'specificity': 0.5996849, 'f1': 0.6030636, 'auroc': 0.82764006, 'binary_precision': 0.24691358, 'binary_recall': 0.22988506, 'binary_specificity': 0.96948475, 'binary_f1_score': 0.23809522}
confusion matrix:
      0    1
0  5814  183
1   201   60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-25 05:28:22.617880,epoch time: 0:20:19.780699,used: 0:20:19.780699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90580297, 'precision': 0.903753, 'recall': 0.8432601, 'specificity': 0.8432601, 'f1': 0.8675672, 'auroc': 0.9498347, 'binary_precision': 0.9002827, 'binary_recall': 0.71402365, 'binary_specificity': 0.97249657, 'binary_f1_score': 0.7964078}
confusion matrix:
       0      1
0  41158   1164
1   4209  10509
---- Validation: 
scalar performance:
{'acc': 0.9536505, 'precision': 0.6586023, 'recall': 0.674482, 'specificity': 0.674482, 'f1': 0.6661026, 'auroc': 0.8471378, 'binary_precision': 0.33943662, 'binary_recall': 0.3748056, 'binary_specificity': 0.97415835, 'binary_f1_score': 0.35624537}
confusion matrix:
       0    1
0  17680  469
1    402  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495046, 'precision': 0.66607285, 'recall': 0.6291747, 'specificity': 0.6291747, 'f1': 0.64490104, 'auroc': 0.8706032, 'binary_precision': 0.3631841, 'binary_recall': 0.27969348, 'binary_specificity': 0.978656, 'binary_f1_score': 0.31601733}
confusion matrix:
      0    1
0  5869  128
1   188   73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-25 05:48:09.117004,epoch time: 0:19:46.499124,used: 0:40:06.279823,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9216515, 'precision': 0.92082334, 'recall': 0.86998904, 'specificity': 0.86998904, 'f1': 0.89139426, 'auroc': 0.96078813, 'binary_precision': 0.91937464, 'binary_recall': 0.7632509, 'binary_specificity': 0.9767271, 'binary_f1_score': 0.8340697}
confusion matrix:
       0      1
0  41339    985
1   3484  11232
---- Validation: 
scalar performance:
{'acc': 0.9563644, 'precision': 0.67551124, 'recall': 0.688638, 'specificity': 0.688638, 'f1': 0.6818028, 'auroc': 0.8574438, 'binary_precision': 0.37229437, 'binary_recall': 0.40124416, 'binary_specificity': 0.9760317, 'binary_f1_score': 0.38622752}
confusion matrix:
       0    1
0  17714  435
1    385  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.7279782, 'recall': 0.704471, 'specificity': 0.704471, 'f1': 0.7154913, 'auroc': 0.88852084, 'binary_precision': 0.4806867, 'binary_recall': 0.42911878, 'binary_specificity': 0.97982323, 'binary_f1_score': 0.45344132}
confusion matrix:
      0    1
0  5876  121
1   149  112
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-25 06:07:30.681214,epoch time: 0:19:21.564210,used: 0:59:27.844033,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9286115, 'precision': 0.92635566, 'recall': 0.88334477, 'specificity': 0.88334477, 'f1': 0.9020039, 'auroc': 0.96775246, 'binary_precision': 0.9223139, 'binary_recall': 0.7898206, 'binary_specificity': 0.9768689, 'binary_f1_score': 0.85094076}
confusion matrix:
       0      1
0  41345    979
1   3093  11623
---- Validation: 
scalar performance:
{'acc': 0.95689654, 'precision': 0.6812117, 'recall': 0.70016426, 'specificity': 0.70016426, 'f1': 0.69014823, 'auroc': 0.86411667, 'binary_precision': 0.3828892, 'binary_recall': 0.42457232, 'binary_specificity': 0.9757562, 'binary_f1_score': 0.4026549}
confusion matrix:
       0    1
0  17709  440
1    370  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7409568, 'recall': 0.7365378, 'specificity': 0.7365378, 'f1': 0.7387239, 'auroc': 0.8981828, 'binary_precision': 0.50390625, 'binary_recall': 0.49425286, 'binary_specificity': 0.97882277, 'binary_f1_score': 0.49903286}
confusion matrix:
      0    1
0  5870  127
1   132  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-25 06:26:48.616324,epoch time: 0:19:17.935110,used: 1:18:45.779143,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9347826, 'precision': 0.9339422, 'recall': 0.89263225, 'specificity': 0.89263225, 'f1': 0.91071653, 'auroc': 0.97029704, 'binary_precision': 0.93242604, 'binary_recall': 0.80555934, 'binary_specificity': 0.97970515, 'binary_f1_score': 0.8643623}
confusion matrix:
       0      1
0  41467    859
1   2861  11853
---- Validation: 
scalar performance:
{'acc': 0.9567369, 'precision': 0.68246955, 'recall': 0.70833224, 'specificity': 0.70833224, 'f1': 0.69441974, 'auroc': 0.8694787, 'binary_precision': 0.38482386, 'binary_recall': 0.44167963, 'binary_specificity': 0.9749848, 'binary_f1_score': 0.41129616}
confusion matrix:
       0    1
0  17695  454
1    359  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.74367326, 'recall': 0.76235723, 'specificity': 0.76235723, 'f1': 0.75261927, 'auroc': 0.9048554, 'binary_precision': 0.5070922, 'binary_recall': 0.54789275, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.5267035}
confusion matrix:
      0    1
0  5858  139
1   118  143
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_5.png
new oracle model saved
early stop counter: 1
val acc:0.9567369222640991, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9589325785636902
after epoch: 5,now: 2024-06-25 06:46:12.042908,epoch time: 0:19:23.426584,used: 1:38:09.205727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9405505, 'precision': 0.9371935, 'recall': 0.9048871, 'specificity': 0.9048871, 'f1': 0.91946757, 'auroc': 0.97384286, 'binary_precision': 0.9309689, 'binary_recall': 0.8312041, 'binary_specificity': 0.9785701, 'binary_f1_score': 0.87826246}
confusion matrix:
       0      1
0  41417    907
1   2484  12232
---- Validation: 
scalar performance:
{'acc': 0.95615155, 'precision': 0.6801976, 'recall': 0.71027935, 'specificity': 0.71027935, 'f1': 0.6939076, 'auroc': 0.8734468, 'binary_precision': 0.38013244, 'binary_recall': 0.44634527, 'binary_specificity': 0.9742135, 'binary_f1_score': 0.41058654}
confusion matrix:
       0    1
0  17681  468
1    356  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.74508786, 'recall': 0.780764, 'specificity': 0.780764, 'f1': 0.76153433, 'auroc': 0.90883374, 'binary_precision': 0.50830567, 'binary_recall': 0.5862069, 'binary_specificity': 0.975321, 'binary_f1_score': 0.544484}
confusion matrix:
      0    1
0  5849  148
1   108  153
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_6.png
new oracle model saved
early stop counter: 2
val acc:0.95615154504776, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.959092378616333
after epoch: 6,now: 2024-06-25 07:05:53.521223,epoch time: 0:19:41.478315,used: 1:57:50.684042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94219846, 'precision': 0.9414842, 'recall': 0.9051776, 'specificity': 0.9051776, 'f1': 0.921378, 'auroc': 0.9755403, 'binary_precision': 0.9401742, 'binary_recall': 0.8286899, 'binary_specificity': 0.98166525, 'binary_f1_score': 0.88091886}
confusion matrix:
       0      1
0  41548    776
1   2521  12195
---- Validation: 
scalar performance:
{'acc': 0.9562048, 'precision': 0.679515, 'recall': 0.7065566, 'specificity': 0.7065566, 'f1': 0.6919482, 'auroc': 0.8757743, 'binary_precision': 0.37903225, 'binary_recall': 0.43856922, 'binary_specificity': 0.97454405, 'binary_f1_score': 0.40663305}
confusion matrix:
       0    1
0  17687  462
1    361  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7583996, 'recall': 0.78384686, 'specificity': 0.78384686, 'f1': 0.77044064, 'auroc': 0.9109095, 'binary_precision': 0.5347222, 'binary_recall': 0.5900383, 'binary_specificity': 0.9776555, 'binary_f1_score': 0.56102}
confusion matrix:
      0    1
0  5863  134
1   107  154
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_7.png
new oracle model saved
early stop counter: 3
val acc:0.9562047719955444, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 7,now: 2024-06-25 07:25:23.532642,epoch time: 0:19:30.011419,used: 2:17:20.695461,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94342566, 'precision': 0.938925, 'recall': 0.91092974, 'specificity': 0.91092974, 'f1': 0.92374647, 'auroc': 0.97677565, 'binary_precision': 0.93046606, 'binary_recall': 0.8437861, 'binary_specificity': 0.97807336, 'binary_f1_score': 0.88500875}
confusion matrix:
       0      1
0  41395    928
1   2299  12418
---- Validation: 
scalar performance:
{'acc': 0.953278, 'precision': 0.6723777, 'recall': 0.72754306, 'specificity': 0.72754306, 'f1': 0.6955563, 'auroc': 0.8781415, 'binary_precision': 0.36321303, 'binary_recall': 0.4852255, 'binary_specificity': 0.9698606, 'binary_f1_score': 0.41544607}
confusion matrix:
       0    1
0  17602  547
1    331  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.7359747, 'recall': 0.80166805, 'specificity': 0.80166805, 'f1': 0.7641727, 'auroc': 0.91286767, 'binary_precision': 0.48816568, 'binary_recall': 0.6321839, 'binary_specificity': 0.97115225, 'binary_f1_score': 0.55091816}
confusion matrix:
      0    1
0  5824  173
1    96  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_8.png
early stop counter: 4
val acc:0.9532780051231384, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 8,now: 2024-06-25 07:45:01.408568,epoch time: 0:19:37.875926,used: 2:36:58.571387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9467216, 'precision': 0.94447166, 'recall': 0.91428816, 'specificity': 0.91428816, 'f1': 0.9280331, 'auroc': 0.9785596, 'binary_precision': 0.94026697, 'binary_recall': 0.8472883, 'binary_specificity': 0.9812881, 'binary_f1_score': 0.89135957}
confusion matrix:
       0      1
0  41534    792
1   2247  12467
---- Validation: 
scalar performance:
{'acc': 0.954023, 'precision': 0.6757555, 'recall': 0.7294289, 'specificity': 0.7294289, 'f1': 0.6984863, 'auroc': 0.8792448, 'binary_precision': 0.36984688, 'binary_recall': 0.48833594, 'binary_specificity': 0.9705218, 'binary_f1_score': 0.42091155}
confusion matrix:
       0    1
0  17614  535
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7426641, 'recall': 0.8024185, 'specificity': 0.8024185, 'f1': 0.76876044, 'auroc': 0.9140272, 'binary_precision': 0.50151974, 'binary_recall': 0.6321839, 'binary_specificity': 0.972653, 'binary_f1_score': 0.559322}
confusion matrix:
      0    1
0  5833  164
1    96  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_9.png
early stop counter: 5
val acc:0.954023003578186, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 9,now: 2024-06-25 08:04:41.905050,epoch time: 0:19:40.496482,used: 2:56:39.067869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94815916, 'precision': 0.9444059, 'recall': 0.9182192, 'specificity': 0.9182192, 'f1': 0.93029356, 'auroc': 0.9791434, 'binary_precision': 0.9373048, 'binary_recall': 0.8563566, 'binary_specificity': 0.98008174, 'binary_f1_score': 0.8950041}
confusion matrix:
       0      1
0  41480    843
1   2114  12603
---- Validation: 
scalar performance:
{'acc': 0.9507237, 'precision': 0.666019, 'recall': 0.7389716, 'specificity': 0.7389716, 'f1': 0.6948409, 'auroc': 0.8804295, 'binary_precision': 0.34962806, 'binary_recall': 0.5116641, 'binary_specificity': 0.96627915, 'binary_f1_score': 0.41540405}
confusion matrix:
       0    1
0  17537  612
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95302016, 'precision': 0.7209447, 'recall': 0.8160747, 'specificity': 0.8160747, 'f1': 0.75864804, 'auroc': 0.9146234, 'binary_precision': 0.4566929, 'binary_recall': 0.6666667, 'binary_specificity': 0.9654827, 'binary_f1_score': 0.5420561}
confusion matrix:
      0    1
0  5790  207
1    87  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_10.png
early stop counter: 6
val acc:0.9507237076759338, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 10,now: 2024-06-25 08:24:18.206317,epoch time: 0:19:36.301267,used: 3:16:15.369136,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9509993, 'precision': 0.9466841, 'recall': 0.92359006, 'specificity': 0.92359006, 'f1': 0.9343469, 'auroc': 0.98132837, 'binary_precision': 0.93843776, 'binary_recall': 0.8669566, 'binary_specificity': 0.98022354, 'binary_f1_score': 0.9012821}
confusion matrix:
       0      1
0  41486    837
1   1958  12759
---- Validation: 
scalar performance:
{'acc': 0.94902086, 'precision': 0.66215503, 'recall': 0.74559057, 'specificity': 0.74559057, 'f1': 0.69388795, 'auroc': 0.88187456, 'binary_precision': 0.34138972, 'binary_recall': 0.5272162, 'binary_specificity': 0.96396494, 'binary_f1_score': 0.41442543}
confusion matrix:
       0    1
0  17495  654
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495046, 'precision': 0.7096925, 'recall': 0.8234021, 'specificity': 0.8234021, 'f1': 0.7522363, 'auroc': 0.91548645, 'binary_precision': 0.43341404, 'binary_recall': 0.68582374, 'binary_specificity': 0.9609805, 'binary_f1_score': 0.5311573}
confusion matrix:
      0    1
0  5763  234
1    82  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_11.png
early stop counter: 7
val acc:0.9490208625793457, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 11,now: 2024-06-25 08:44:03.813752,epoch time: 0:19:45.607435,used: 3:36:00.976571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9502805, 'precision': 0.9470935, 'recall': 0.9212487, 'specificity': 0.9212487, 'f1': 0.9331858, 'auroc': 0.98197913, 'binary_precision': 0.94105417, 'binary_recall': 0.8612583, 'binary_specificity': 0.9812391, 'binary_f1_score': 0.8993898}
confusion matrix:
       0      1
0  41528    794
1   2042  12676
---- Validation: 
scalar performance:
{'acc': 0.94896764, 'precision': 0.6629102, 'recall': 0.7493133, 'specificity': 0.7493133, 'f1': 0.69552183, 'auroc': 0.88300467, 'binary_precision': 0.3426295, 'binary_recall': 0.5349922, 'binary_specificity': 0.9636344, 'binary_f1_score': 0.41772923}
confusion matrix:
       0    1
0  17489  660
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480665, 'precision': 0.70505995, 'recall': 0.82265174, 'specificity': 0.82265174, 'f1': 0.74834627, 'auroc': 0.91613305, 'binary_precision': 0.4241706, 'binary_recall': 0.68582374, 'binary_specificity': 0.95947975, 'binary_f1_score': 0.5241581}
confusion matrix:
      0    1
0  5754  243
1    82  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_12.png
early stop counter: 8
val acc:0.9489676356315613, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 12,now: 2024-06-25 09:04:21.553219,epoch time: 0:20:17.739467,used: 3:56:18.716038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.953892, 'precision': 0.9498619, 'recall': 0.9281684, 'specificity': 0.9281684, 'f1': 0.93832314, 'auroc': 0.98328745, 'binary_precision': 0.94212335, 'binary_recall': 0.8750255, 'binary_specificity': 0.98131126, 'binary_f1_score': 0.9073356}
confusion matrix:
       0      1
0  41534    791
1   1839  12876
---- Validation: 
scalar performance:
{'acc': 0.94971263, 'precision': 0.6646097, 'recall': 0.74669874, 'specificity': 0.74669874, 'f1': 0.6960908, 'auroc': 0.88356805, 'binary_precision': 0.34623218, 'binary_recall': 0.5287714, 'binary_specificity': 0.96462613, 'binary_f1_score': 0.41846156}
confusion matrix:
       0    1
0  17507  642
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9503036, 'precision': 0.71258676, 'recall': 0.82565135, 'specificity': 0.82565135, 'f1': 0.75512844, 'auroc': 0.9164467, 'binary_precision': 0.4390244, 'binary_recall': 0.6896552, 'binary_specificity': 0.9616475, 'binary_f1_score': 0.5365127}
confusion matrix:
      0    1
0  5767  230
1    81  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_13.png
early stop counter: 9
val acc:0.9497126340866089, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 13,now: 2024-06-25 09:24:54.625975,epoch time: 0:20:33.072756,used: 4:16:51.788794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95348877, 'precision': 0.9507823, 'recall': 0.9261804, 'specificity': 0.9261804, 'f1': 0.9375967, 'auroc': 0.98377556, 'binary_precision': 0.9456305, 'binary_recall': 0.86975133, 'binary_specificity': 0.9826095, 'binary_f1_score': 0.90610516}
confusion matrix:
       0      1
0  41586    736
1   1917  12801
---- Validation: 
scalar performance:
{'acc': 0.94960624, 'precision': 0.6649882, 'recall': 0.7496439, 'specificity': 0.7496439, 'f1': 0.6972261, 'auroc': 0.8845993, 'binary_precision': 0.3467742, 'binary_recall': 0.5349922, 'binary_specificity': 0.96429557, 'binary_f1_score': 0.4207951}
confusion matrix:
       0    1
0  17501  648
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9504634, 'precision': 0.7138073, 'recall': 0.8312317, 'specificity': 0.8312317, 'f1': 0.7576188, 'auroc': 0.91721535, 'binary_precision': 0.44096386, 'binary_recall': 0.7011494, 'binary_specificity': 0.96131396, 'binary_f1_score': 0.5414201}
confusion matrix:
      0    1
0  5765  232
1    78  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_14.png
early stop counter: 10
val acc:0.9496062397956848, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 14,now: 2024-06-25 09:46:11.557260,epoch time: 0:21:16.931285,used: 4:38:08.720079,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9544706, 'precision': 0.950058, 'recall': 0.9295335, 'specificity': 0.9295335, 'f1': 0.93917584, 'auroc': 0.984478, 'binary_precision': 0.9415537, 'binary_recall': 0.87801564, 'binary_specificity': 0.9810514, 'binary_f1_score': 0.9086753}
confusion matrix:
       0      1
0  41523    802
1   1795  12920
---- Validation: 
scalar performance:
{'acc': 0.947318, 'precision': 0.6601725, 'recall': 0.75820994, 'specificity': 0.75820994, 'f1': 0.695711, 'auroc': 0.8855847, 'binary_precision': 0.336475, 'binary_recall': 0.55520993, 'binary_specificity': 0.96121, 'binary_f1_score': 0.4190141}
confusion matrix:
       0    1
0  17445  704
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94598913, 'precision': 0.7014886, 'recall': 0.8398912, 'specificity': 0.8398912, 'f1': 0.74964446, 'auroc': 0.9170874, 'binary_precision': 0.41538462, 'binary_recall': 0.7241379, 'binary_specificity': 0.9556445, 'binary_f1_score': 0.52793294}
confusion matrix:
      0    1
0  5731  266
1    72  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_15.png
early stop counter: 11
val acc:0.9473180174827576, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 15,now: 2024-06-25 10:06:32.466154,epoch time: 0:20:20.908894,used: 4:58:29.628973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9545582, 'precision': 0.95130134, 'recall': 0.9284984, 'specificity': 0.9284984, 'f1': 0.9391397, 'auroc': 0.98426557, 'binary_precision': 0.94506866, 'binary_recall': 0.87466866, 'binary_specificity': 0.98232806, 'binary_f1_score': 0.9085069}
confusion matrix:
       0      1
0  41579    748
1   1844  12869
---- Validation: 
scalar performance:
{'acc': 0.95077693, 'precision': 0.6685759, 'recall': 0.74874985, 'specificity': 0.74874985, 'f1': 0.6996982, 'auroc': 0.8858433, 'binary_precision': 0.35403726, 'binary_recall': 0.5318818, 'binary_specificity': 0.96561795, 'binary_f1_score': 0.42510873}
confusion matrix:
       0    1
0  17525  624
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9536593, 'precision': 0.7249937, 'recall': 0.8328992, 'specificity': 0.8328992, 'f1': 0.76673746, 'auroc': 0.9172605, 'binary_precision': 0.46329114, 'binary_recall': 0.7011494, 'binary_specificity': 0.96464896, 'binary_f1_score': 0.55792683}
confusion matrix:
      0    1
0  5785  212
1    78  183
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_16.png
early stop counter: 12
val acc:0.9507769346237183, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 16,now: 2024-06-25 10:29:30.042777,epoch time: 0:22:57.576623,used: 5:21:27.205596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9559081, 'precision': 0.9521186, 'recall': 0.9313377, 'specificity': 0.9313377, 'f1': 0.9410963, 'auroc': 0.9852408, 'binary_precision': 0.944817, 'binary_recall': 0.88056254, 'binary_specificity': 0.9821129, 'binary_f1_score': 0.9115588}
confusion matrix:
       0      1
0  41564    757
1   1758  12961
---- Validation: 
scalar performance:
{'acc': 0.94902086, 'precision': 0.6648884, 'recall': 0.7568414, 'specificity': 0.7568414, 'f1': 0.6991491, 'auroc': 0.8868838, 'binary_precision': 0.34604105, 'binary_recall': 0.5505443, 'binary_specificity': 0.96313846, 'binary_f1_score': 0.42497}
confusion matrix:
       0    1
0  17480  669
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949185, 'precision': 0.7105876, 'recall': 0.837894, 'specificity': 0.837894, 'f1': 0.75678396, 'auroc': 0.9176817, 'binary_precision': 0.4338747, 'binary_recall': 0.71647507, 'binary_specificity': 0.959313, 'binary_f1_score': 0.54046243}
confusion matrix:
      0    1
0  5753  244
1    74  187
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_17.png
early stop counter: 13
val acc:0.9490208625793457, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 17,now: 2024-06-25 10:52:14.785712,epoch time: 0:22:44.742935,used: 5:44:11.948531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.95718795, 'precision': 0.9531331, 'recall': 0.9337363, 'specificity': 0.9337363, 'f1': 0.94288516, 'auroc': 0.98650074, 'binary_precision': 0.945287, 'binary_recall': 0.8852871, 'binary_specificity': 0.9821855, 'binary_f1_score': 0.9143038}
confusion matrix:
       0      1
0  41571    754
1   1688  13027
---- Validation: 
scalar performance:
{'acc': 0.9463602, 'precision': 0.6588122, 'recall': 0.76371455, 'specificity': 0.76371455, 'f1': 0.69595134, 'auroc': 0.887625, 'binary_precision': 0.33333334, 'binary_recall': 0.5676516, 'binary_specificity': 0.9597774, 'binary_f1_score': 0.420023}
confusion matrix:
       0    1
0  17419  730
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9440716, 'precision': 0.696712, 'recall': 0.8425554, 'specificity': 0.8425554, 'f1': 0.7460783, 'auroc': 0.917391, 'binary_precision': 0.40552017, 'binary_recall': 0.7318008, 'binary_specificity': 0.95331, 'binary_f1_score': 0.5218579}
confusion matrix:
      0    1
0  5717  280
1    70  191
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_18.png
early stop counter: 14
val acc:0.946360170841217, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 18,now: 2024-06-25 11:12:59.275295,epoch time: 0:20:44.489583,used: 6:04:56.438114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95708275, 'precision': 0.95475435, 'recall': 0.93182564, 'specificity': 0.93182564, 'f1': 0.9425291, 'auroc': 0.9866327, 'binary_precision': 0.95029736, 'binary_recall': 0.8796466, 'binary_specificity': 0.98400474, 'binary_f1_score': 0.91360813}
confusion matrix:
       0      1
0  41648    677
1   1771  12944
---- Validation: 
scalar performance:
{'acc': 0.9483291, 'precision': 0.66324884, 'recall': 0.7587334, 'specificity': 0.7587334, 'f1': 0.69834536, 'auroc': 0.8879445, 'binary_precision': 0.34261036, 'binary_recall': 0.55520993, 'binary_specificity': 0.96225685, 'binary_f1_score': 0.42373884}
confusion matrix:
       0    1
0  17464  685
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9477469, 'precision': 0.7071456, 'recall': 0.844473, 'specificity': 0.844473, 'f1': 0.75554585, 'auroc': 0.9171802, 'binary_precision': 0.4263393, 'binary_recall': 0.7318008, 'binary_specificity': 0.9571452, 'binary_f1_score': 0.53878707}
confusion matrix:
      0    1
0  5740  257
1    70  191
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_19.png
early stop counter: 15
val acc:0.9483290910720825, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 19,now: 2024-06-25 11:32:41.333706,epoch time: 0:19:42.058411,used: 6:24:38.496525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9580645, 'precision': 0.95441777, 'recall': 0.9347961, 'specificity': 0.9347961, 'f1': 0.94404674, 'auroc': 0.98583966, 'binary_precision': 0.9473646, 'binary_recall': 0.8867219, 'binary_specificity': 0.9828702, 'binary_f1_score': 0.9160407}
confusion matrix:
       0      1
0  41599    725
1   1667  13049
---- Validation: 
scalar performance:
{'acc': 0.9477437, 'precision': 0.662348, 'recall': 0.7621807, 'specificity': 0.7621807, 'f1': 0.698507, 'auroc': 0.8885655, 'binary_precision': 0.34054562, 'binary_recall': 0.562986, 'binary_specificity': 0.9613753, 'binary_f1_score': 0.4243845}
confusion matrix:
       0    1
0  17448  701
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94566953, 'precision': 0.70139, 'recall': 0.84522146, 'specificity': 0.84522146, 'f1': 0.7507768, 'auroc': 0.91783714, 'binary_precision': 0.41468683, 'binary_recall': 0.7356322, 'binary_specificity': 0.95481074, 'binary_f1_score': 0.5303868}
confusion matrix:
      0    1
0  5726  271
1    69  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_20.png
early stop counter: 16
val acc:0.9477437138557434, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 20,now: 2024-06-25 11:52:23.632316,epoch time: 0:19:42.298610,used: 6:44:20.795135,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9589937, 'precision': 0.9544172, 'recall': 0.9372992, 'specificity': 0.9372992, 'f1': 0.94543064, 'auroc': 0.9867568, 'binary_precision': 0.94549644, 'binary_recall': 0.89248335, 'binary_specificity': 0.98211503, 'binary_f1_score': 0.91822535}
confusion matrix:
       0      1
0  41569    757
1   1582  13132
---- Validation: 
scalar performance:
{'acc': 0.94705194, 'precision': 0.6599251, 'recall': 0.7603224, 'specificity': 0.7603224, 'f1': 0.69604266, 'auroc': 0.88807124, 'binary_precision': 0.33582088, 'binary_recall': 0.5598756, 'binary_specificity': 0.9607692, 'binary_f1_score': 0.41982505}
confusion matrix:
       0    1
0  17437  712
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94534993, 'precision': 0.70049614, 'recall': 0.84505475, 'specificity': 0.84505475, 'f1': 0.749959, 'auroc': 0.91776407, 'binary_precision': 0.41290322, 'binary_recall': 0.7356322, 'binary_specificity': 0.95447725, 'binary_f1_score': 0.5289256}
confusion matrix:
      0    1
0  5724  273
1    69  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_21.png
early stop counter: 17
val acc:0.9470519423484802, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 21,now: 2024-06-25 12:11:42.136862,epoch time: 0:19:18.504546,used: 7:03:39.299681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9586606, 'precision': 0.95400023, 'recall': 0.9368378, 'specificity': 0.9368378, 'f1': 0.9449886, 'auroc': 0.9865695, 'binary_precision': 0.9449165, 'binary_recall': 0.89175045, 'binary_specificity': 0.98192513, 'binary_f1_score': 0.917564}
confusion matrix:
       0      1
0  41559    765
1   1593  13123
---- Validation: 
scalar performance:
{'acc': 0.9457748, 'precision': 0.65678644, 'recall': 0.7619114, 'specificity': 0.7619114, 'f1': 0.6938066, 'auroc': 0.8891074, 'binary_precision': 0.32940108, 'binary_recall': 0.5645412, 'binary_specificity': 0.9592815, 'binary_f1_score': 0.41604584}
confusion matrix:
       0    1
0  17410  739
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9435922, 'precision': 0.6957139, 'recall': 0.84413755, 'specificity': 0.84413755, 'f1': 0.7455313, 'auroc': 0.9173399, 'binary_precision': 0.40336135, 'binary_recall': 0.7356322, 'binary_specificity': 0.952643, 'binary_f1_score': 0.52103126}
confusion matrix:
      0    1
0  5713  284
1    69  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_22.png
early stop counter: 18
val acc:0.9457747936248779, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 22,now: 2024-06-25 12:30:54.488463,epoch time: 0:19:12.351601,used: 7:22:51.651282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.957784, 'precision': 0.95497674, 'recall': 0.9334655, 'specificity': 0.9334655, 'f1': 0.9435507, 'auroc': 0.9869832, 'binary_precision': 0.94957983, 'binary_recall': 0.88323253, 'binary_specificity': 0.98369837, 'binary_f1_score': 0.91520536}
confusion matrix:
       0      1
0  41637    690
1   1718  12995
---- Validation: 
scalar performance:
{'acc': 0.9476373, 'precision': 0.66077, 'recall': 0.75687516, 'specificity': 0.75687516, 'f1': 0.69585466, 'auroc': 0.8882302, 'binary_precision': 0.33777356, 'binary_recall': 0.5520995, 'binary_specificity': 0.9616508, 'binary_f1_score': 0.41912633}
confusion matrix:
       0    1
0  17453  696
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9474273, 'precision': 0.7059434, 'recall': 0.8424739, 'specificity': 0.8424739, 'f1': 0.7540506, 'auroc': 0.91684926, 'binary_precision': 0.42410713, 'binary_recall': 0.72796935, 'binary_specificity': 0.9569785, 'binary_f1_score': 0.5359661}
confusion matrix:
      0    1
0  5739  258
1    71  190
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_23.png
early stop counter: 19
val acc:0.9476373195648193, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 23,now: 2024-06-25 12:50:18.943401,epoch time: 0:19:24.454938,used: 7:42:16.106220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96002805, 'precision': 0.9523132, 'recall': 0.9424415, 'specificity': 0.9424415, 'f1': 0.94723284, 'auroc': 0.98712945, 'binary_precision': 0.93691164, 'binary_recall': 0.90610135, 'binary_specificity': 0.9787817, 'binary_f1_score': 0.921249}
confusion matrix:
       0      1
0  41424    898
1   1382  13336
---- Validation: 
scalar performance:
{'acc': 0.9355045, 'precision': 0.63599885, 'recall': 0.77159536, 'specificity': 0.77159536, 'f1': 0.67661035, 'auroc': 0.88972175, 'binary_precision': 0.28689137, 'binary_recall': 0.5956454, 'binary_specificity': 0.9475453, 'binary_f1_score': 0.38725987}
confusion matrix:
       0    1
0  17197  952
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92729306, 'precision': 0.66332567, 'recall': 0.85212433, 'specificity': 0.85212433, 'f1': 0.71502626, 'auroc': 0.9170722, 'binary_precision': 0.33724833, 'binary_recall': 0.77011496, 'binary_specificity': 0.9341337, 'binary_f1_score': 0.46907818}
confusion matrix:
      0    1
0  5602  395
1    60  201
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_24.png
early stop counter: 20
val acc:0.9355044960975647, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 24,now: 2024-06-25 13:11:03.007158,epoch time: 0:20:44.063757,used: 8:03:00.169977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96039623, 'precision': 0.9548855, 'recall': 0.94064796, 'specificity': 0.94064796, 'f1': 0.94747007, 'auroc': 0.987044, 'binary_precision': 0.9440405, 'binary_recall': 0.8998437, 'binary_specificity': 0.98145217, 'binary_f1_score': 0.92141235}
confusion matrix:
       0      1
0  41538    785
1   1474  13243
---- Validation: 
scalar performance:
{'acc': 0.9409855, 'precision': 0.64582527, 'recall': 0.76543236, 'specificity': 0.76543236, 'f1': 0.68491435, 'auroc': 0.8895239, 'binary_precision': 0.3071192, 'binary_recall': 0.5769829, 'binary_specificity': 0.95388174, 'binary_f1_score': 0.4008644}
confusion matrix:
       0    1
0  17312  837
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9360818, 'precision': 0.6788826, 'recall': 0.8475483, 'specificity': 0.8475483, 'f1': 0.7304157, 'auroc': 0.9164806, 'binary_precision': 0.36911488, 'binary_recall': 0.75095785, 'binary_specificity': 0.94413877, 'binary_f1_score': 0.49494946}
confusion matrix:
      0    1
0  5662  335
1    65  196
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_25.png
early stop counter: 21
val acc:0.9409855008125305, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 25,now: 2024-06-25 13:34:02.252663,epoch time: 0:22:59.245505,used: 8:25:59.415482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9612728, 'precision': 0.9574455, 'recall': 0.9403423, 'specificity': 0.9403423, 'f1': 0.9484707, 'auroc': 0.9879807, 'binary_precision': 0.949982, 'binary_recall': 0.8971048, 'binary_specificity': 0.9835798, 'binary_f1_score': 0.92278653}
confusion matrix:
       0      1
0  41631    695
1   1514  13200
---- Validation: 
scalar performance:
{'acc': 0.9454555, 'precision': 0.6560746, 'recall': 0.7624961, 'specificity': 0.7624961, 'f1': 0.6933408, 'auroc': 0.8895687, 'binary_precision': 0.32792792, 'binary_recall': 0.5660964, 'binary_specificity': 0.9588958, 'binary_f1_score': 0.41528803}
confusion matrix:
       0    1
0  17403  746
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9432726, 'precision': 0.6951573, 'recall': 0.84580314, 'specificity': 0.84580314, 'f1': 0.7453845, 'auroc': 0.9161087, 'binary_precision': 0.40208334, 'binary_recall': 0.7394636, 'binary_specificity': 0.9521427, 'binary_f1_score': 0.52091765}
confusion matrix:
      0    1
0  5710  287
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_26.png
early stop counter: 22
val acc:0.9454554915428162, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 26,now: 2024-06-25 13:55:37.788661,epoch time: 0:21:35.535998,used: 8:47:34.951480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9613079, 'precision': 0.9581282, 'recall': 0.9397553, 'specificity': 0.9397553, 'f1': 0.948455, 'auroc': 0.98815376, 'binary_precision': 0.95195085, 'binary_recall': 0.8952232, 'binary_specificity': 0.9842875, 'binary_f1_score': 0.92271596}
confusion matrix:
       0      1
0  41658    665
1   1542  13175
---- Validation: 
scalar performance:
{'acc': 0.9427416, 'precision': 0.64959717, 'recall': 0.76409125, 'specificity': 0.76409125, 'f1': 0.68805087, 'auroc': 0.8895574, 'binary_precision': 0.31479898, 'binary_recall': 0.57231724, 'binary_specificity': 0.9558653, 'binary_f1_score': 0.40618104}
confusion matrix:
       0    1
0  17348  801
1    275  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9395973, 'precision': 0.685941, 'recall': 0.84388554, 'specificity': 0.84388554, 'f1': 0.73653543, 'auroc': 0.91596186, 'binary_precision': 0.3836978, 'binary_recall': 0.7394636, 'binary_specificity': 0.9483075, 'binary_f1_score': 0.5052356}
confusion matrix:
      0    1
0  5687  310
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_27.png
early stop counter: 23
val acc:0.9427415728569031, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 27,now: 2024-06-25 14:15:18.454935,epoch time: 0:19:40.666274,used: 9:07:15.617754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9600806, 'precision': 0.95581245, 'recall': 0.93882096, 'specificity': 0.93882096, 'f1': 0.9468969, 'auroc': 0.98802054, 'binary_precision': 0.9474858, 'binary_recall': 0.8948906, 'binary_specificity': 0.9827513, 'binary_f1_score': 0.92043746}
confusion matrix:
       0      1
0  41592    730
1   1547  13171
---- Validation: 
scalar performance:
{'acc': 0.9426884, 'precision': 0.64964795, 'recall': 0.7648138, 'specificity': 0.7648138, 'f1': 0.68825084, 'auroc': 0.8893335, 'binary_precision': 0.31484643, 'binary_recall': 0.57387245, 'binary_specificity': 0.9557551, 'binary_f1_score': 0.4066116}
confusion matrix:
       0    1
0  17346  803
1    274  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9400767, 'precision': 0.68771726, 'recall': 0.8478004, 'specificity': 0.8478004, 'f1': 0.73894584, 'auroc': 0.9153836, 'binary_precision': 0.38690478, 'binary_recall': 0.74712646, 'binary_specificity': 0.9484742, 'binary_f1_score': 0.5098039}
confusion matrix:
      0    1
0  5688  309
1    66  195
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_28.png
early stop counter: 24
val acc:0.9426884055137634, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 28,now: 2024-06-25 14:34:43.166655,epoch time: 0:19:24.711720,used: 9:26:40.329474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9615708, 'precision': 0.95690113, 'recall': 0.9417275, 'specificity': 0.9417275, 'f1': 0.9489798, 'auroc': 0.98799455, 'binary_precision': 0.94773716, 'binary_recall': 0.90072703, 'binary_specificity': 0.98272806, 'binary_f1_score': 0.9236343}
confusion matrix:
       0      1
0  41592    731
1   1461  13256
---- Validation: 
scalar performance:
{'acc': 0.94183695, 'precision': 0.64789355, 'recall': 0.76587313, 'specificity': 0.76587313, 'f1': 0.6868927, 'auroc': 0.88968503, 'binary_precision': 0.3112416, 'binary_recall': 0.5769829, 'binary_specificity': 0.95476335, 'binary_f1_score': 0.4043597}
confusion matrix:
       0    1
0  17328  821
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9389581, 'precision': 0.68569016, 'recall': 0.8508814, 'specificity': 0.8508814, 'f1': 0.73759687, 'auroc': 0.915689, 'binary_precision': 0.38252428, 'binary_recall': 0.7547893, 'binary_specificity': 0.9469735, 'binary_f1_score': 0.507732}
confusion matrix:
      0    1
0  5679  318
1    64  197
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_29.png
early stop counter: 25
val acc:0.941836953163147, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 29,now: 2024-06-25 14:54:03.493751,epoch time: 0:19:20.327096,used: 9:46:00.656570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9628331, 'precision': 0.9583719, 'recall': 0.9436197, 'specificity': 0.9436197, 'f1': 0.95068073, 'auroc': 0.9894655, 'binary_precision': 0.94960386, 'binary_recall': 0.90392065, 'binary_specificity': 0.98331875, 'binary_f1_score': 0.9261993}
confusion matrix:
       0      1
0  41617    706
1   1414  13303
---- Validation: 
scalar performance:
{'acc': 0.94215626, 'precision': 0.6486834, 'recall': 0.7660384, 'specificity': 0.7660384, 'f1': 0.6876424, 'auroc': 0.8901154, 'binary_precision': 0.3128162, 'binary_recall': 0.5769829, 'binary_specificity': 0.9550939, 'binary_f1_score': 0.40568617}
confusion matrix:
       0    1
0  17334  815
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9403963, 'precision': 0.68910074, 'recall': 0.85163176, 'specificity': 0.85163176, 'f1': 0.74097115, 'auroc': 0.9160353, 'binary_precision': 0.38932806, 'binary_recall': 0.7547893, 'binary_specificity': 0.9484742, 'binary_f1_score': 0.5136897}
confusion matrix:
      0    1
0  5688  309
1    64  197
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_30.png
early stop counter: 26
val acc:0.9421562552452087, best validation acc: 0.9568965435028076, corresponding to test acc:                         0.9586129784584045 / 0.9614893198013306
after epoch: 30,now: 2024-06-25 15:13:32.128820,epoch time: 0:19:28.635069,used: 10:05:29.291639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_05_08_02_seed_0_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:05:29.291639 at 2024-06-25 15:13:32.128820
persisted model performance metric: 

scalar performance:
{'acc': 0.958613, 'precision': 0.7409568, 'recall': 0.7365378, 'specificity': 0.7365378, 'f1': 0.7387239, 'auroc': 0.8981828, 'binary_precision': 0.50390625, 'binary_recall': 0.49425286, 'binary_specificity': 0.97882277, 'binary_f1_score': 0.49903286}
confusion matrix:
      0    1
0  5870  127
1   132  129
oracle model performance metric: 

scalar performance:
{'acc': 0.9614893, 'precision': 0.7583996, 'recall': 0.78384686, 'specificity': 0.78384686, 'f1': 0.77044064, 'auroc': 0.9109095, 'binary_precision': 0.5347222, 'binary_recall': 0.5900383, 'binary_specificity': 0.9776555, 'binary_f1_score': 0.56102}
confusion matrix:
      0    1
0  5863  134
1   107  154
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191877 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |  17477 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191877 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |  17477 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189283 KiB | 457564 KiB | 758211 GiB | 758210 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 742655 GiB | 742654 GiB |
|       from small pool |  16469 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 516096 KiB | 516096 KiB | 516096 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39546 KiB |  75256 KiB | 410711 GiB | 410711 GiB |
|       from large pool |  30400 KiB |  70632 KiB | 395108 GiB | 395108 GiB |
|       from small pool |   9146 KiB |   9397 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7613    |  157526 K  |  157523 K  |
|       from large pool |      76    |     158    |   73194 K  |   73194 K  |
|       from small pool |    2890    |    7535    |   84332 K  |   84329 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7613    |  157526 K  |  157523 K  |
|       from large pool |      76    |     158    |   73194 K  |   73194 K  |
|       from small pool |    2890    |    7535    |   84332 K  |   84329 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3583    |   87087 K  |   87087 K  |
|       from large pool |       9    |      19    |   45496 K  |   45496 K  |
|       from small pool |      24    |    3575    |   41591 K  |   41591 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 758211 GiB | 758211 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 742655 GiB | 742654 GiB |
|       from small pool |      0 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 516096 KiB | 516096 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  43008 KiB |  43008 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82786 KiB | 410711 GiB | 410711 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 395108 GiB | 395108 GiB |
|       from small pool |      0 KiB |  20341 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84332 K  |   84332 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84332 K  |   84332 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      42    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3583    |   87088 K  |   87088 K  |
|       from large pool |       3    |      19    |   45496 K  |   45496 K  |
|       from small pool |       0    |    3575    |   41592 K  |   41592 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 758211 GiB | 758211 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 742655 GiB | 742654 GiB |
|       from small pool |      0 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 516096 KiB | 516096 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  43008 KiB |  43008 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82786 KiB | 410711 GiB | 410711 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 395108 GiB | 395108 GiB |
|       from small pool |      0 KiB |  20341 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84332 K  |   84332 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84332 K  |   84332 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      42    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3583    |   87088 K  |   87088 K  |
|       from large pool |       3    |      19    |   45496 K  |   45496 K  |
|       from small pool |       0    |    3575    |   41592 K  |   41592 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224

 Experiment start at: 2024-06-25 15:21:26.532315
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.78065175, 'precision': 0.71802586, 'recall': 0.6289933, 'specificity': 0.6289933, 'f1': 0.645313, 'auroc': 0.8124989, 'binary_precision': 0.6337257, 'binary_recall': 0.32108182, 'binary_specificity': 0.93690467, 'binary_f1_score': 0.42621744}
confusion matrix:
       0     1
0  39736  2676
1   9790  4630
---- Validation: 
scalar performance:
{'acc': 0.93553895, 'precision': 0.4943061, 'recall': 0.49520776, 'specificity': 0.49520776, 'f1': 0.49466205, 'auroc': 0.7567557, 'binary_precision': 0.024866786, 'binary_recall': 0.020802377, 'binary_specificity': 0.96961313, 'binary_f1_score': 0.022653721}
confusion matrix:
       0    1
0  17518  549
1    659   14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93377376, 'precision': 0.5085272, 'recall': 0.50569224, 'specificity': 0.50569224, 'f1': 0.5060497, 'auroc': 0.82084596, 'binary_precision': 0.058479533, 'binary_recall': 0.03846154, 'binary_specificity': 0.972923, 'binary_f1_score': 0.046403717}
confusion matrix:
      0    1
0  5785  161
1   250   10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-25 15:41:39.208936,epoch time: 0:20:12.676621,used: 0:20:12.676621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8795221, 'precision': 0.8703785, 'recall': 0.7977027, 'specificity': 0.7977027, 'f1': 0.8247547, 'auroc': 0.9263061, 'binary_precision': 0.8557602, 'binary_recall': 0.6315972, 'binary_specificity': 0.96380824, 'binary_f1_score': 0.7267867}
confusion matrix:
       0     1
0  40878  1535
1   5312  9107
---- Validation: 
scalar performance:
{'acc': 0.9417823, 'precision': 0.57331336, 'recall': 0.57068765, 'specificity': 0.57068765, 'f1': 0.5719691, 'auroc': 0.82399607, 'binary_precision': 0.17746913, 'binary_recall': 0.17087667, 'binary_specificity': 0.9704987, 'binary_f1_score': 0.17411052}
confusion matrix:
       0    1
0  17534  533
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9419916, 'precision': 0.5860897, 'recall': 0.5577945, 'specificity': 0.5577945, 'f1': 0.56830823, 'auroc': 0.86356246, 'binary_precision': 0.20930232, 'binary_recall': 0.13846155, 'binary_specificity': 0.9771275, 'binary_f1_score': 0.16666667}
confusion matrix:
      0    1
0  5810  136
1   224   36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-25 16:01:40.871170,epoch time: 0:20:01.662234,used: 0:40:14.338855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9058101, 'precision': 0.90308475, 'recall': 0.8407892, 'specificity': 0.8407892, 'f1': 0.8657721, 'auroc': 0.94981, 'binary_precision': 0.89854056, 'binary_recall': 0.708787, 'binary_specificity': 0.9727914, 'binary_f1_score': 0.7924631}
confusion matrix:
       0      1
0  41259   1154
1   4199  10220
---- Validation: 
scalar performance:
{'acc': 0.94967985, 'precision': 0.6341712, 'recall': 0.63128966, 'specificity': 0.63128966, 'f1': 0.63271177, 'auroc': 0.8435237, 'binary_precision': 0.29483283, 'binary_recall': 0.2882615, 'binary_specificity': 0.9743178, 'binary_f1_score': 0.2915101}
confusion matrix:
       0    1
0  17603  464
1    479  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9505317, 'precision': 0.6682633, 'recall': 0.6174209, 'specificity': 0.6174209, 'f1': 0.6375212, 'auroc': 0.8812655, 'binary_precision': 0.36871508, 'binary_recall': 0.25384617, 'binary_specificity': 0.98099566, 'binary_f1_score': 0.3006834}
confusion matrix:
      0    1
0  5833  113
1   194   66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-25 16:21:36.499857,epoch time: 0:19:55.628687,used: 1:00:09.967542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9215055, 'precision': 0.9197023, 'recall': 0.86813533, 'specificity': 0.86813533, 'f1': 0.88987243, 'auroc': 0.9616456, 'binary_precision': 0.91659, 'binary_recall': 0.7597781, 'binary_specificity': 0.9764925, 'binary_f1_score': 0.83084977}
confusion matrix:
       0      1
0  41415    997
1   3464  10956
---- Validation: 
scalar performance:
{'acc': 0.9536286, 'precision': 0.6696699, 'recall': 0.6791147, 'specificity': 0.6791147, 'f1': 0.6742439, 'auroc': 0.85686743, 'binary_precision': 0.36235955, 'binary_recall': 0.3833581, 'binary_specificity': 0.97487134, 'binary_f1_score': 0.37256318}
confusion matrix:
       0    1
0  17613  454
1    415  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547212, 'precision': 0.71258163, 'recall': 0.6802938, 'specificity': 0.6802938, 'f1': 0.6949065, 'auroc': 0.89546037, 'binary_precision': 0.4520548, 'binary_recall': 0.38076922, 'binary_specificity': 0.97981834, 'binary_f1_score': 0.4133612}
confusion matrix:
      0    1
0  5826  120
1   161   99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-25 16:41:13.842057,epoch time: 0:19:37.342200,used: 1:19:47.309742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.92894846, 'precision': 0.9274636, 'recall': 0.8809873, 'specificity': 0.8809873, 'f1': 0.90100086, 'auroc': 0.9656625, 'binary_precision': 0.9248588, 'binary_recall': 0.7836188, 'binary_specificity': 0.9783557, 'binary_f1_score': 0.84840065}
confusion matrix:
       0      1
0  41495    918
1   3120  11299
---- Validation: 
scalar performance:
{'acc': 0.95565635, 'precision': 0.6851464, 'recall': 0.7001938, 'specificity': 0.7001938, 'f1': 0.69233185, 'auroc': 0.86574847, 'binary_precision': 0.39178082, 'binary_recall': 0.42496285, 'binary_specificity': 0.9754248, 'binary_f1_score': 0.4076978}
confusion matrix:
       0    1
0  17623  444
1    387  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.73472226, 'recall': 0.729537, 'specificity': 0.729537, 'f1': 0.7320964, 'auroc': 0.9047789, 'binary_precision': 0.492126, 'binary_recall': 0.48076922, 'binary_specificity': 0.97830474, 'binary_f1_score': 0.48638132}
confusion matrix:
      0    1
0  5817  129
1   135  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-25 17:04:01.461094,epoch time: 0:22:47.619037,used: 1:42:34.928779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93401605, 'precision': 0.9366627, 'recall': 0.8862134, 'specificity': 0.8862134, 'f1': 0.90775347, 'auroc': 0.97155654, 'binary_precision': 0.9412689, 'binary_recall': 0.78916705, 'binary_specificity': 0.98325986, 'binary_f1_score': 0.85853326}
confusion matrix:
       0      1
0  41703    710
1   3040  11379
---- Validation: 
scalar performance:
{'acc': 0.9588581, 'precision': 0.70203805, 'recall': 0.69827795, 'specificity': 0.69827795, 'f1': 0.7001379, 'auroc': 0.8709152, 'binary_precision': 0.4257576, 'binary_recall': 0.41753343, 'binary_specificity': 0.9790225, 'binary_f1_score': 0.42160538}
confusion matrix:
       0    1
0  17688  379
1    392  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.76163244, 'recall': 0.73163927, 'specificity': 0.73163927, 'f1': 0.74560106, 'auroc': 0.91073376, 'binary_precision': 0.5458515, 'binary_recall': 0.48076922, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.51124746}
confusion matrix:
      0    1
0  5842  104
1   135  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-25 17:28:44.603641,epoch time: 0:24:43.142547,used: 2:07:18.071326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94093114, 'precision': 0.9385923, 'recall': 0.902731, 'specificity': 0.902731, 'f1': 0.9187856, 'auroc': 0.974314, 'binary_precision': 0.9343541, 'binary_recall': 0.8251734, 'binary_specificity': 0.9802886, 'binary_f1_score': 0.8763764}
confusion matrix:
       0      1
0  41576    836
1   2521  11899
---- Validation: 
scalar performance:
{'acc': 0.9566702, 'precision': 0.6966766, 'recall': 0.7307609, 'specificity': 0.7307609, 'f1': 0.7121592, 'auroc': 0.8754939, 'binary_precision': 0.4125786, 'binary_recall': 0.48736998, 'binary_specificity': 0.9741518, 'binary_f1_score': 0.44686648}
confusion matrix:
       0    1
0  17600  467
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.74052453, 'recall': 0.77217007, 'specificity': 0.77217007, 'f1': 0.75522214, 'auroc': 0.9142216, 'binary_precision': 0.5, 'binary_recall': 0.5692308, 'binary_specificity': 0.97510934, 'binary_f1_score': 0.5323741}
confusion matrix:
      0    1
0  5798  148
1   112  148
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_7.png
early stop counter: 1
val acc:0.9566702246665955, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 7,now: 2024-06-25 18:21:39.250390,epoch time: 0:52:54.646749,used: 3:00:12.718075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94281393, 'precision': 0.94096977, 'recall': 0.90552, 'specificity': 0.90552, 'f1': 0.9214238, 'auroc': 0.9759593, 'binary_precision': 0.9376224, 'binary_recall': 0.8298079, 'binary_specificity': 0.98123217, 'binary_f1_score': 0.88042676}
confusion matrix:
       0      1
0  41617    796
1   2454  11965
---- Validation: 
scalar performance:
{'acc': 0.958111, 'precision': 0.7021899, 'recall': 0.7214944, 'specificity': 0.7214944, 'f1': 0.7113397, 'auroc': 0.8777261, 'binary_precision': 0.42432433, 'binary_recall': 0.4665676, 'binary_specificity': 0.9764211, 'binary_f1_score': 0.44444448}
confusion matrix:
       0    1
0  17641  426
1    359  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.75392413, 'recall': 0.76975346, 'specificity': 0.76975346, 'f1': 0.761565, 'auroc': 0.91596997, 'binary_precision': 0.5270758, 'binary_recall': 0.56153846, 'binary_specificity': 0.9779684, 'binary_f1_score': 0.5437617}
confusion matrix:
      0    1
0  5815  131
1   114  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_8.png
early stop counter: 2
val acc:0.9581109881401062, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 8,now: 2024-06-25 19:16:03.331496,epoch time: 0:54:24.081106,used: 3:54:36.799181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94562924, 'precision': 0.9417633, 'recall': 0.9123448, 'specificity': 0.9123448, 'f1': 0.9257953, 'auroc': 0.9777913, 'binary_precision': 0.93462247, 'binary_recall': 0.84477735, 'binary_specificity': 0.9799123, 'binary_f1_score': 0.8874316}
confusion matrix:
       0      1
0  41562    852
1   2238  12180
---- Validation: 
scalar performance:
{'acc': 0.95763075, 'precision': 0.70246494, 'recall': 0.73698115, 'specificity': 0.73698115, 'f1': 0.7181716, 'auroc': 0.88111734, 'binary_precision': 0.42370743, 'binary_recall': 0.49925706, 'binary_specificity': 0.9747053, 'binary_f1_score': 0.45839018}
confusion matrix:
       0    1
0  17610  457
1    337  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7487887, 'recall': 0.79683363, 'specificity': 0.79683363, 'f1': 0.77037674, 'auroc': 0.9180399, 'binary_precision': 0.514377, 'binary_recall': 0.61923075, 'binary_specificity': 0.9744366, 'binary_f1_score': 0.5619546}
confusion matrix:
      0    1
0  5794  152
1    99  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_9.png
early stop counter: 3
val acc:0.9576307535171509, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 9,now: 2024-06-25 19:36:16.426177,epoch time: 0:20:13.094681,used: 4:14:49.893862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94723046, 'precision': 0.94553375, 'recall': 0.9130056, 'specificity': 0.9130056, 'f1': 0.9277523, 'auroc': 0.9794349, 'binary_precision': 0.94242543, 'binary_recall': 0.8435289, 'binary_specificity': 0.9824822, 'binary_f1_score': 0.890239}
confusion matrix:
       0      1
0  41671    743
1   2256  12162
---- Validation: 
scalar performance:
{'acc': 0.95747066, 'precision': 0.70065176, 'recall': 0.731176, 'specificity': 0.731176, 'f1': 0.71467876, 'auroc': 0.8811344, 'binary_precision': 0.42051283, 'binary_recall': 0.48736998, 'binary_specificity': 0.974982, 'binary_f1_score': 0.4514797}
confusion matrix:
       0    1
0  17615  452
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7495259, 'recall': 0.7914008, 'specificity': 0.7914008, 'f1': 0.76859987, 'auroc': 0.9177741, 'binary_precision': 0.5163399, 'binary_recall': 0.6076923, 'binary_specificity': 0.97510934, 'binary_f1_score': 0.5583039}
confusion matrix:
      0    1
0  5798  148
1   102  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_10.png
early stop counter: 4
val acc:0.9574706554412842, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 10,now: 2024-06-25 20:01:02.019367,epoch time: 0:24:45.593190,used: 4:39:35.487052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9481806, 'precision': 0.94720453, 'recall': 0.91396785, 'specificity': 0.91396785, 'f1': 0.92901057, 'auroc': 0.9798598, 'binary_precision': 0.94541925, 'binary_recall': 0.84451073, 'binary_specificity': 0.9834249, 'binary_f1_score': 0.89212066}
confusion matrix:
       0      1
0  41710    703
1   2242  12177
---- Validation: 
scalar performance:
{'acc': 0.9573639, 'precision': 0.6989232, 'recall': 0.7246832, 'specificity': 0.7246832, 'f1': 0.71090627, 'auroc': 0.8813692, 'binary_precision': 0.41753927, 'binary_recall': 0.47399703, 'binary_specificity': 0.97536945, 'binary_f1_score': 0.44398052}
confusion matrix:
       0    1
0  17622  445
1    354  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.75920844, 'recall': 0.7904868, 'specificity': 0.7904868, 'f1': 0.7738292, 'auroc': 0.9182242, 'binary_precision': 0.53583616, 'binary_recall': 0.60384613, 'binary_specificity': 0.9771275, 'binary_f1_score': 0.5678119}
confusion matrix:
      0    1
0  5810  136
1   103  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_11.png
early stop counter: 5
val acc:0.9573639035224915, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 11,now: 2024-06-25 20:27:25.836715,epoch time: 0:26:23.817348,used: 5:05:59.304400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95085514, 'precision': 0.9477111, 'recall': 0.92066234, 'specificity': 0.92066234, 'f1': 0.9331381, 'auroc': 0.98092175, 'binary_precision': 0.941856, 'binary_recall': 0.859362, 'binary_specificity': 0.9819627, 'binary_f1_score': 0.89871997}
confusion matrix:
       0      1
0  41647    765
1   2028  12392
---- Validation: 
scalar performance:
{'acc': 0.95565635, 'precision': 0.69439024, 'recall': 0.7431098, 'specificity': 0.7431098, 'f1': 0.71562773, 'auroc': 0.8830022, 'binary_precision': 0.40705884, 'binary_recall': 0.51411587, 'binary_specificity': 0.97210383, 'binary_f1_score': 0.4543664}
confusion matrix:
       0    1
0  17563  504
1    327  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.73787767, 'recall': 0.81028426, 'specificity': 0.81028426, 'f1': 0.76853776, 'auroc': 0.91923535, 'binary_precision': 0.49127907, 'binary_recall': 0.65, 'binary_specificity': 0.9705685, 'binary_f1_score': 0.5596027}
confusion matrix:
      0    1
0  5771  175
1    91  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_12.png
early stop counter: 6
val acc:0.9556563496589661, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 12,now: 2024-06-25 20:51:23.235518,epoch time: 0:23:57.398803,used: 5:29:56.703203,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95196366, 'precision': 0.9478512, 'recall': 0.9235289, 'specificity': 0.9235289, 'f1': 0.9348401, 'auroc': 0.9824374, 'binary_precision': 0.940131, 'binary_recall': 0.86580205, 'binary_specificity': 0.98125577, 'binary_f1_score': 0.9014369}
confusion matrix:
       0      1
0  41618    795
1   1935  12484
---- Validation: 
scalar performance:
{'acc': 0.95597655, 'precision': 0.6944785, 'recall': 0.73612326, 'specificity': 0.73612326, 'f1': 0.71298516, 'auroc': 0.8841876, 'binary_precision': 0.407767, 'binary_recall': 0.49925706, 'binary_specificity': 0.97298944, 'binary_f1_score': 0.44889784}
confusion matrix:
       0    1
0  17579  488
1    337  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7450529, 'recall': 0.80560815, 'specificity': 0.80560815, 'f1': 0.7714875, 'auroc': 0.91926897, 'binary_precision': 0.50609756, 'binary_recall': 0.63846153, 'binary_specificity': 0.9727548, 'binary_f1_score': 0.5646258}
confusion matrix:
      0    1
0  5784  162
1    94  166
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_13.png
early stop counter: 7
val acc:0.9559765458106995, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 13,now: 2024-06-25 21:17:03.974484,epoch time: 0:25:40.738966,used: 5:55:37.442169,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9531074, 'precision': 0.94929975, 'recall': 0.9251878, 'specificity': 0.9251878, 'f1': 0.93641174, 'auroc': 0.9835768, 'binary_precision': 0.94214565, 'binary_recall': 0.86850685, 'binary_specificity': 0.98186874, 'binary_f1_score': 0.9038288}
confusion matrix:
       0      1
0  41644    769
1   1896  12523
---- Validation: 
scalar performance:
{'acc': 0.9552828, 'precision': 0.692163, 'recall': 0.7400551, 'specificity': 0.7400551, 'f1': 0.7130518, 'auroc': 0.88432, 'binary_precision': 0.40282685, 'binary_recall': 0.50817233, 'binary_specificity': 0.9719378, 'binary_f1_score': 0.44940865}
confusion matrix:
       0    1
0  17560  507
1    331  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.7376104, 'recall': 0.8175561, 'specificity': 0.8175561, 'f1': 0.77090406, 'auroc': 0.9196681, 'binary_precision': 0.49008498, 'binary_recall': 0.6653846, 'binary_specificity': 0.9697276, 'binary_f1_score': 0.5644372}
confusion matrix:
      0    1
0  5766  180
1    87  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_14.png
early stop counter: 8
val acc:0.9552828073501587, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 14,now: 2024-06-25 21:41:54.124149,epoch time: 0:24:50.149665,used: 6:20:27.591834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9543215, 'precision': 0.95149136, 'recall': 0.92630315, 'specificity': 0.92630315, 'f1': 0.9379959, 'auroc': 0.98367906, 'binary_precision': 0.9461887, 'binary_recall': 0.8694175, 'binary_specificity': 0.98318875, 'binary_f1_score': 0.90617996}
confusion matrix:
       0      1
0  41699    713
1   1883  12537
---- Validation: 
scalar performance:
{'acc': 0.95314837, 'precision': 0.68446684, 'recall': 0.74538547, 'specificity': 0.74538547, 'f1': 0.7099235, 'auroc': 0.88365614, 'binary_precision': 0.38699007, 'binary_recall': 0.5215453, 'binary_specificity': 0.96922565, 'binary_f1_score': 0.44430378}
confusion matrix:
       0    1
0  17511  556
1    322  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9531099, 'precision': 0.72255224, 'recall': 0.8210549, 'specificity': 0.8210549, 'f1': 0.76135397, 'auroc': 0.9190283, 'binary_precision': 0.45953003, 'binary_recall': 0.6769231, 'binary_specificity': 0.96518666, 'binary_f1_score': 0.54743385}
confusion matrix:
      0    1
0  5739  207
1    84  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_15.png
early stop counter: 9
val acc:0.953148365020752, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 15,now: 2024-06-25 22:08:17.228373,epoch time: 0:26:23.104224,used: 6:46:50.696058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9554476, 'precision': 0.95225227, 'recall': 0.92858255, 'specificity': 0.92858255, 'f1': 0.9396221, 'auroc': 0.98513764, 'binary_precision': 0.94623816, 'binary_recall': 0.8740463, 'binary_specificity': 0.9831188, 'binary_f1_score': 0.9087107}
confusion matrix:
       0      1
0  41698    716
1   1816  12602
---- Validation: 
scalar performance:
{'acc': 0.9527215, 'precision': 0.6838374, 'recall': 0.75017095, 'specificity': 0.75017095, 'f1': 0.7111232, 'auroc': 0.884813, 'binary_precision': 0.3853606, 'binary_recall': 0.5319465, 'binary_specificity': 0.9683954, 'binary_f1_score': 0.44694132}
confusion matrix:
       0    1
0  17496  571
1    315  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95262647, 'precision': 0.7209598, 'recall': 0.8226416, 'specificity': 0.8226416, 'f1': 0.7606524, 'auroc': 0.9194552, 'binary_precision': 0.45618558, 'binary_recall': 0.6807692, 'binary_specificity': 0.96451396, 'binary_f1_score': 0.5462963}
confusion matrix:
      0    1
0  5735  211
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_16.png
early stop counter: 10
val acc:0.9527214765548706, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 16,now: 2024-06-25 22:29:27.447534,epoch time: 0:21:10.219161,used: 7:08:00.915219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9560635, 'precision': 0.94970137, 'recall': 0.9329168, 'specificity': 0.9329168, 'f1': 0.940903, 'auroc': 0.98434365, 'binary_precision': 0.93747705, 'binary_recall': 0.8859223, 'binary_specificity': 0.9799113, 'binary_f1_score': 0.91097087}
confusion matrix:
       0      1
0  41560    852
1   1645  12775
---- Validation: 
scalar performance:
{'acc': 0.94845253, 'precision': 0.6719942, 'recall': 0.7629776, 'specificity': 0.7629776, 'f1': 0.70632935, 'auroc': 0.88674074, 'binary_precision': 0.36060894, 'binary_recall': 0.56315005, 'binary_specificity': 0.9628051, 'binary_f1_score': 0.43967518}
confusion matrix:
       0    1
0  17395  672
1    294  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94585884, 'precision': 0.7008887, 'recall': 0.83382165, 'specificity': 0.83382165, 'f1': 0.74768806, 'auroc': 0.91925085, 'binary_precision': 0.4147982, 'binary_recall': 0.71153843, 'binary_specificity': 0.95610493, 'binary_f1_score': 0.5240793}
confusion matrix:
      0    1
0  5685  261
1    75  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_17.png
early stop counter: 11
val acc:0.9484525322914124, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 17,now: 2024-06-25 22:50:16.007555,epoch time: 0:20:48.560021,used: 7:28:49.475240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.95555323, 'precision': 0.95328385, 'recall': 0.9278606, 'specificity': 0.9278606, 'f1': 0.9396589, 'auroc': 0.98553485, 'binary_precision': 0.9490335, 'binary_recall': 0.8716366, 'binary_specificity': 0.98408467, 'binary_f1_score': 0.90869}
confusion matrix:
       0      1
0  41737    675
1   1851  12569
---- Validation: 
scalar performance:
{'acc': 0.9546425, 'precision': 0.69021773, 'recall': 0.74401456, 'specificity': 0.74401456, 'f1': 0.7132698, 'auroc': 0.8863529, 'binary_precision': 0.39862543, 'binary_recall': 0.51708764, 'binary_specificity': 0.9709415, 'binary_f1_score': 0.45019406}
confusion matrix:
       0    1
0  17542  525
1    325  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.7359071, 'recall': 0.8228208, 'specificity': 0.8228208, 'f1': 0.77150786, 'auroc': 0.91883624, 'binary_precision': 0.48618785, 'binary_recall': 0.6769231, 'binary_specificity': 0.96871847, 'binary_f1_score': 0.5659164}
confusion matrix:
      0    1
0  5760  186
1    84  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_18.png
early stop counter: 12
val acc:0.9546424746513367, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 18,now: 2024-06-25 23:15:28.907100,epoch time: 0:25:12.899545,used: 7:54:02.374785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95724237, 'precision': 0.95322406, 'recall': 0.9324938, 'specificity': 0.9324938, 'f1': 0.94224846, 'auroc': 0.9857247, 'binary_precision': 0.9455924, 'binary_recall': 0.88224685, 'binary_specificity': 0.98274076, 'binary_f1_score': 0.91282195}
confusion matrix:
       0      1
0  41680    732
1   1698  12722
---- Validation: 
scalar performance:
{'acc': 0.95117396, 'precision': 0.67970675, 'recall': 0.75723636, 'specificity': 0.75723636, 'f1': 0.7104608, 'auroc': 0.88690984, 'binary_precision': 0.37653062, 'binary_recall': 0.5482912, 'binary_specificity': 0.96618146, 'binary_f1_score': 0.44646096}
confusion matrix:
       0    1
0  17456  611
1    304  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9500483, 'precision': 0.71261084, 'recall': 0.8268131, 'specificity': 0.8268131, 'f1': 0.7554562, 'auroc': 0.9190568, 'binary_precision': 0.4390244, 'binary_recall': 0.6923077, 'binary_specificity': 0.96131855, 'binary_f1_score': 0.5373134}
confusion matrix:
      0    1
0  5716  230
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_19.png
early stop counter: 13
val acc:0.9511739611625671, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 19,now: 2024-06-25 23:36:32.180945,epoch time: 0:21:03.273845,used: 8:15:05.648630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.95785826, 'precision': 0.9535022, 'recall': 0.9338867, 'specificity': 0.9338867, 'f1': 0.9431477, 'auroc': 0.98600066, 'binary_precision': 0.9452014, 'binary_recall': 0.8852209, 'binary_specificity': 0.9825525, 'binary_f1_score': 0.9142284}
confusion matrix:
       0      1
0  41673    740
1   1655  12764
---- Validation: 
scalar performance:
{'acc': 0.946905, 'precision': 0.6681225, 'recall': 0.7664666, 'specificity': 0.7664666, 'f1': 0.70420057, 'auroc': 0.886641, 'binary_precision': 0.3525641, 'binary_recall': 0.57206535, 'binary_specificity': 0.9608679, 'binary_f1_score': 0.4362606}
confusion matrix:
       0    1
0  17360  707
1    288  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94392526, 'precision': 0.6957346, 'recall': 0.8346516, 'specificity': 0.8346516, 'f1': 0.74345136, 'auroc': 0.9188239, 'binary_precision': 0.40434784, 'binary_recall': 0.7153846, 'binary_specificity': 0.9539186, 'binary_f1_score': 0.51666665}
confusion matrix:
      0    1
0  5672  274
1    74  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_20.png
early stop counter: 14
val acc:0.9469050168991089, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 20,now: 2024-06-25 23:56:31.422904,epoch time: 0:19:59.241959,used: 8:35:04.890589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.95815736, 'precision': 0.95508194, 'recall': 0.93310684, 'specificity': 0.93310684, 'f1': 0.943413, 'auroc': 0.9865564, 'binary_precision': 0.9492613, 'binary_recall': 0.88224685, 'binary_specificity': 0.9839668, 'binary_f1_score': 0.9145281}
confusion matrix:
       0      1
0  41732    680
1   1698  12722
---- Validation: 
scalar performance:
{'acc': 0.950587, 'precision': 0.67776746, 'recall': 0.75764716, 'specificity': 0.75764716, 'f1': 0.7091609, 'auroc': 0.8863175, 'binary_precision': 0.37260824, 'binary_recall': 0.5497771, 'binary_specificity': 0.9655172, 'binary_f1_score': 0.44417766}
confusion matrix:
       0    1
0  17444  623
1    303  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9489204, 'precision': 0.70841885, 'recall': 0.8225465, 'specificity': 0.8225465, 'f1': 0.7509854, 'auroc': 0.91858196, 'binary_precision': 0.43099272, 'binary_recall': 0.6846154, 'binary_specificity': 0.96047765, 'binary_f1_score': 0.5289747}
confusion matrix:
      0    1
0  5711  235
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_21.png
early stop counter: 15
val acc:0.9505869746208191, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 21,now: 2024-06-26 00:18:38.238036,epoch time: 0:22:06.815132,used: 8:57:11.705721,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.95782304, 'precision': 0.9561157, 'recall': 0.93118936, 'specificity': 0.93118936, 'f1': 0.94278115, 'auroc': 0.98648715, 'binary_precision': 0.9529119, 'binary_recall': 0.87711513, 'binary_specificity': 0.9852636, 'binary_f1_score': 0.9134438}
confusion matrix:
       0      1
0  41787    625
1   1772  12648
---- Validation: 
scalar performance:
{'acc': 0.9509072, 'precision': 0.67765456, 'recall': 0.75209105, 'specificity': 0.75209105, 'f1': 0.7073584, 'auroc': 0.88573706, 'binary_precision': 0.37281153, 'binary_recall': 0.53789, 'binary_specificity': 0.96629214, 'binary_f1_score': 0.4403893}
confusion matrix:
       0    1
0  17458  609
1    311  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9502095, 'precision': 0.71221626, 'recall': 0.8195413, 'specificity': 0.8195413, 'f1': 0.7531154, 'auroc': 0.9179752, 'binary_precision': 0.43890274, 'binary_recall': 0.6769231, 'binary_specificity': 0.96215945, 'binary_f1_score': 0.53252643}
confusion matrix:
      0    1
0  5721  225
1    84  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_22.png
early stop counter: 16
val acc:0.9509071707725525, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 22,now: 2024-06-26 00:40:52.247603,epoch time: 0:22:14.009567,used: 9:19:25.715288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9583861, 'precision': 0.9545887, 'recall': 0.9342137, 'specificity': 0.9342137, 'f1': 0.9438137, 'auroc': 0.98628455, 'binary_precision': 0.94736844, 'binary_recall': 0.8851436, 'binary_specificity': 0.9832838, 'binary_f1_score': 0.9151995}
confusion matrix:
       0      1
0  41705    709
1   1656  12762
---- Validation: 
scalar performance:
{'acc': 0.9493063, 'precision': 0.6733594, 'recall': 0.756983, 'specificity': 0.756983, 'f1': 0.705663, 'auroc': 0.8857938, 'binary_precision': 0.36381513, 'binary_recall': 0.5497771, 'binary_specificity': 0.9641889, 'binary_f1_score': 0.43786982}
confusion matrix:
       0    1
0  17420  647
1    303  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9471479, 'precision': 0.7028147, 'recall': 0.82162154, 'specificity': 0.82162154, 'f1': 0.74625033, 'auroc': 0.9170276, 'binary_precision': 0.4198113, 'binary_recall': 0.6846154, 'binary_specificity': 0.95862764, 'binary_f1_score': 0.5204679}
confusion matrix:
      0    1
0  5700  246
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_23.png
early stop counter: 17
val acc:0.949306309223175, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 23,now: 2024-06-26 01:00:33.472245,epoch time: 0:19:41.224642,used: 9:39:06.939930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9597234, 'precision': 0.9544135, 'recall': 0.9380659, 'specificity': 0.9380659, 'f1': 0.94585955, 'auroc': 0.9875034, 'binary_precision': 0.9441922, 'binary_recall': 0.89409804, 'binary_specificity': 0.9820338, 'binary_f1_score': 0.9184626}
confusion matrix:
       0      1
0  41651    762
1   1527  12892
---- Validation: 
scalar performance:
{'acc': 0.94701177, 'precision': 0.6669681, 'recall': 0.76008457, 'specificity': 0.76008457, 'f1': 0.70157886, 'auroc': 0.8863263, 'binary_precision': 0.35074627, 'binary_recall': 0.5586924, 'binary_specificity': 0.96147674, 'binary_f1_score': 0.43094555}
confusion matrix:
       0    1
0  17371  696
1    297  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94553655, 'precision': 0.6996808, 'recall': 0.8318145, 'specificity': 0.8318145, 'f1': 0.7461862, 'auroc': 0.917673, 'binary_precision': 0.41255605, 'binary_recall': 0.7076923, 'binary_specificity': 0.9559368, 'binary_f1_score': 0.5212465}
confusion matrix:
      0    1
0  5684  262
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_24.png
early stop counter: 18
val acc:0.9470117688179016, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 24,now: 2024-06-26 01:19:56.204078,epoch time: 0:19:22.731833,used: 9:58:29.671763,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96028644, 'precision': 0.95602405, 'recall': 0.93794316, 'specificity': 0.93794316, 'f1': 0.9465215, 'auroc': 0.98682064, 'binary_precision': 0.94786066, 'binary_recall': 0.89257973, 'binary_specificity': 0.9833066, 'binary_f1_score': 0.91938996}
confusion matrix:
       0      1
0  41704    708
1   1549  12871
---- Validation: 
scalar performance:
{'acc': 0.9473319, 'precision': 0.66745925, 'recall': 0.7581048, 'specificity': 0.7581048, 'f1': 0.7014283, 'auroc': 0.88685, 'binary_precision': 0.35188678, 'binary_recall': 0.55423474, 'binary_specificity': 0.96197486, 'binary_f1_score': 0.43046737}
confusion matrix:
       0    1
0  17380  687
1    300  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9461811, 'precision': 0.70155215, 'recall': 0.83215094, 'specificity': 0.83215094, 'f1': 0.74784696, 'auroc': 0.91779673, 'binary_precision': 0.4162896, 'binary_recall': 0.7076923, 'binary_specificity': 0.9566095, 'binary_f1_score': 0.52421653}
confusion matrix:
      0    1
0  5688  258
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_25.png
early stop counter: 19
val acc:0.9473319053649902, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 25,now: 2024-06-26 01:39:37.923756,epoch time: 0:19:41.719678,used: 10:18:11.391441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.95993453, 'precision': 0.9548321, 'recall': 0.93820393, 'specificity': 0.93820393, 'f1': 0.94612527, 'auroc': 0.9880804, 'binary_precision': 0.9450187, 'binary_recall': 0.8940907, 'binary_specificity': 0.98231715, 'binary_f1_score': 0.9188495}
confusion matrix:
       0      1
0  41664    750
1   1527  12891
---- Validation: 
scalar performance:
{'acc': 0.9464248, 'precision': 0.6656847, 'recall': 0.76192594, 'specificity': 0.76192594, 'f1': 0.70104194, 'auroc': 0.8872497, 'binary_precision': 0.3480257, 'binary_recall': 0.56315005, 'binary_specificity': 0.9607018, 'binary_f1_score': 0.43019298}
confusion matrix:
       0    1
0  17357  710
1    294  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94521433, 'precision': 0.69904065, 'recall': 0.83348536, 'specificity': 0.83348536, 'f1': 0.74603593, 'auroc': 0.9177456, 'binary_precision': 0.41111112, 'binary_recall': 0.71153843, 'binary_specificity': 0.95543224, 'binary_f1_score': 0.52112675}
confusion matrix:
      0    1
0  5681  265
1    75  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_26.png
early stop counter: 20
val acc:0.9464247822761536, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 26,now: 2024-06-26 01:59:17.393561,epoch time: 0:19:39.469805,used: 10:37:50.861246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96019846, 'precision': 0.9575845, 'recall': 0.93610716, 'specificity': 0.93610716, 'f1': 0.9461995, 'auroc': 0.9879383, 'binary_precision': 0.9526292, 'binary_recall': 0.88720864, 'binary_specificity': 0.9850057, 'binary_f1_score': 0.9187558}
confusion matrix:
       0      1
0  41780    636
1   1626  12790
---- Validation: 
scalar performance:
{'acc': 0.948826, 'precision': 0.6714321, 'recall': 0.7553034, 'specificity': 0.7553034, 'f1': 0.7037096, 'auroc': 0.88627005, 'binary_precision': 0.36007828, 'binary_recall': 0.5468053, 'binary_specificity': 0.9638014, 'binary_f1_score': 0.4342183}
confusion matrix:
       0    1
0  17413  654
1    305  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9477925, 'precision': 0.7048187, 'recall': 0.8219579, 'specificity': 0.8219579, 'f1': 0.74795634, 'auroc': 0.9166453, 'binary_precision': 0.42380953, 'binary_recall': 0.6846154, 'binary_specificity': 0.9593004, 'binary_f1_score': 0.5235294}
confusion matrix:
      0    1
0  5704  242
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_27.png
early stop counter: 21
val acc:0.948826014995575, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 27,now: 2024-06-26 02:18:21.401459,epoch time: 0:19:04.007898,used: 10:56:54.869144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96070874, 'precision': 0.95569736, 'recall': 0.9394356, 'specificity': 0.9394356, 'f1': 0.9471917, 'auroc': 0.9881214, 'binary_precision': 0.9460468, 'binary_recall': 0.896248, 'binary_specificity': 0.9826233, 'binary_f1_score': 0.92047435}
confusion matrix:
       0      1
0  41676    737
1   1496  12923
---- Validation: 
scalar performance:
{'acc': 0.9430096, 'precision': 0.65669554, 'recall': 0.76301587, 'specificity': 0.76301587, 'f1': 0.6938525, 'auroc': 0.88666546, 'binary_precision': 0.32988802, 'binary_recall': 0.5690936, 'binary_specificity': 0.9569381, 'binary_f1_score': 0.4176663}
confusion matrix:
       0    1
0  17289  778
1    290  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94021916, 'precision': 0.6864035, 'recall': 0.8345565, 'specificity': 0.8345565, 'f1': 0.7351071, 'auroc': 0.9164442, 'binary_precision': 0.385567, 'binary_recall': 0.7192308, 'binary_specificity': 0.94988227, 'binary_f1_score': 0.5020134}
confusion matrix:
      0    1
0  5648  298
1    73  187
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_28.png
early stop counter: 22
val acc:0.943009614944458, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 28,now: 2024-06-26 02:37:27.836374,epoch time: 0:19:06.434915,used: 11:16:01.304059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9604272, 'precision': 0.9571624, 'recall': 0.9371679, 'specificity': 0.9371679, 'f1': 0.9466032, 'auroc': 0.9882649, 'binary_precision': 0.9509448, 'binary_recall': 0.8899445, 'binary_specificity': 0.9843912, 'binary_f1_score': 0.919434}
confusion matrix:
       0      1
0  41750    662
1   1587  12833
---- Validation: 
scalar performance:
{'acc': 0.94631803, 'precision': 0.66435194, 'recall': 0.75757897, 'specificity': 0.75757897, 'f1': 0.69882095, 'auroc': 0.8866877, 'binary_precision': 0.34569046, 'binary_recall': 0.55423474, 'binary_specificity': 0.96092325, 'binary_f1_score': 0.42579907}
confusion matrix:
       0    1
0  17361  706
1    300  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94505316, 'precision': 0.6971432, 'recall': 0.82420635, 'specificity': 0.82420635, 'f1': 0.74221706, 'auroc': 0.91657823, 'binary_precision': 0.40816328, 'binary_recall': 0.6923077, 'binary_specificity': 0.95610493, 'binary_f1_score': 0.51355207}
confusion matrix:
      0    1
0  5685  261
1    80  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_29.png
early stop counter: 23
val acc:0.9463180303573608, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 29,now: 2024-06-26 02:56:34.642432,epoch time: 0:19:06.806058,used: 11:35:08.110117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9622044, 'precision': 0.95698977, 'recall': 0.94220006, 'specificity': 0.94220006, 'f1': 0.9492855, 'auroc': 0.9882506, 'binary_precision': 0.9469007, 'binary_recall': 0.9015882, 'binary_specificity': 0.98281187, 'binary_f1_score': 0.92368907}
confusion matrix:
       0      1
0  41684    729
1   1419  13000
---- Validation: 
scalar performance:
{'acc': 0.9437033, 'precision': 0.65874165, 'recall': 0.7640909, 'specificity': 0.7640909, 'f1': 0.6958481, 'auroc': 0.8863661, 'binary_precision': 0.33391306, 'binary_recall': 0.57057947, 'binary_specificity': 0.95760226, 'binary_f1_score': 0.42128363}
confusion matrix:
       0    1
0  17301  766
1    289  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9405414, 'precision': 0.6865627, 'recall': 0.8310467, 'specificity': 0.8310467, 'f1': 0.7345326, 'auroc': 0.91580635, 'binary_precision': 0.3862213, 'binary_recall': 0.71153843, 'binary_specificity': 0.95055497, 'binary_f1_score': 0.5006766}
confusion matrix:
      0    1
0  5652  294
1    75  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_30.png
early stop counter: 24
val acc:0.943703293800354, best validation acc: 0.958858072757721, corresponding to test acc:                         0.9614889025688171 / 0.9614889025688171
after epoch: 30,now: 2024-06-26 03:15:37.211072,epoch time: 0:19:02.568640,used: 11:54:10.678757,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_15_21_26_seed_1_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:54:10.678757 at 2024-06-26 03:15:37.211072
persisted model performance metric: 

scalar performance:
{'acc': 0.9614889, 'precision': 0.76163244, 'recall': 0.73163927, 'specificity': 0.73163927, 'f1': 0.74560106, 'auroc': 0.91073376, 'binary_precision': 0.5458515, 'binary_recall': 0.48076922, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.51124746}
confusion matrix:
      0    1
0  5842  104
1   135  125
oracle model performance metric: 

scalar performance:
{'acc': 0.9614889, 'precision': 0.76163244, 'recall': 0.73163927, 'specificity': 0.73163927, 'f1': 0.74560106, 'auroc': 0.91073376, 'binary_precision': 0.5458515, 'binary_recall': 0.48076922, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.51124746}
confusion matrix:
      0    1
0  5842  104
1   135  125
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190959 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  17465 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190959 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  17465 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189280 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  16466 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    792 MiB | 284672 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     54 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40464 KiB |  87618 KiB |    825 TiB |    825 TiB |
|       from large pool |  31306 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |   9158 KiB |  20341 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2942    |    7613    |  314085 K  |  314082 K  |
|       from large pool |      76    |     158    |  145894 K  |  145894 K  |
|       from small pool |    2866    |    7535    |  168190 K  |  168187 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2942    |    7613    |  314085 K  |  314082 K  |
|       from large pool |      76    |     158    |  145894 K  |  145894 K  |
|       from small pool |    2866    |    7535    |  168190 K  |  168187 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      60    |      19    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3583    |  175711 K  |  175711 K  |
|       from large pool |      10    |      22    |   87846 K  |   87846 K  |
|       from small pool |      22    |    3575    |   87864 K  |   87864 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |    792 MiB | 579584 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  26624 KiB |  43008 KiB |     54 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87618 KiB |    825 TiB |    825 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |      0 KiB |  21236 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  314085 K  |  314085 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168190 K  |  168190 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  314085 K  |  314085 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168190 K  |  168190 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      60    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      13    |      21    |      27    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3583    |  175712 K  |  175712 K  |
|       from large pool |       3    |      22    |   87846 K  |   87846 K  |
|       from small pool |       0    |    3575    |   87865 K  |   87865 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |    792 MiB | 579584 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  26624 KiB |  43008 KiB |     54 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87618 KiB |    825 TiB |    825 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |      0 KiB |  21236 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  314085 K  |  314085 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168190 K  |  168190 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  314085 K  |  314085 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168190 K  |  168190 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      60    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      13    |      21    |      27    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3583    |  175712 K  |  175712 K  |
|       from large pool |       3    |      22    |   87846 K  |   87846 K  |
|       from small pool |       0    |    3575    |   87865 K  |   87865 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224

 Experiment start at: 2024-06-26 03:23:30.157615
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8770195, 'precision': 0.86635715, 'recall': 0.8037605, 'specificity': 0.8037605, 'f1': 0.82766086, 'auroc': 0.9224241, 'binary_precision': 0.84850055, 'binary_recall': 0.64895236, 'binary_specificity': 0.9585687, 'binary_f1_score': 0.73543066}
confusion matrix:
       0     1
0  40558  1753
1   5311  9818
---- Validation: 
scalar performance:
{'acc': 0.89958984, 'precision': 0.5692443, 'recall': 0.6999897, 'specificity': 0.6999897, 'f1': 0.5917045, 'auroc': 0.8047236, 'binary_precision': 0.15676832, 'binary_recall': 0.48671097, 'binary_specificity': 0.9132684, 'binary_f1_score': 0.23715094}
confusion matrix:
       0     1
0  16595  1576
1    309   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82224715, 'precision': 0.5193497, 'recall': 0.57047117, 'specificity': 0.57047117, 'f1': 0.50806344, 'auroc': 0.6873381, 'binary_precision': 0.07121662, 'binary_recall': 0.29752067, 'binary_specificity': 0.8434217, 'binary_f1_score': 0.114924185}
confusion matrix:
      0    1
0  5058  939
1   170   72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-26 03:43:21.489865,epoch time: 0:19:51.332250,used: 0:19:51.332250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9077472, 'precision': 0.90457106, 'recall': 0.85128516, 'specificity': 0.85128516, 'f1': 0.8731653, 'auroc': 0.9501983, 'binary_precision': 0.8990096, 'binary_recall': 0.7319717, 'binary_specificity': 0.97059864, 'binary_f1_score': 0.80693704}
confusion matrix:
       0      1
0  41067   1244
1   4055  11074
---- Validation: 
scalar performance:
{'acc': 0.93538594, 'precision': 0.6135989, 'recall': 0.7184807, 'specificity': 0.7184807, 'f1': 0.6459018, 'auroc': 0.8369825, 'binary_precision': 0.24477862, 'binary_recall': 0.48671097, 'binary_specificity': 0.9502504, 'binary_f1_score': 0.32573652}
confusion matrix:
       0    1
0  17267  904
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89389324, 'precision': 0.5532284, 'recall': 0.61963624, 'specificity': 0.61963624, 'f1': 0.5669669, 'auroc': 0.7909726, 'binary_precision': 0.13541667, 'binary_recall': 0.32231405, 'binary_specificity': 0.91695845, 'binary_f1_score': 0.19070905}
confusion matrix:
      0    1
0  5499  498
1   164   78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-26 04:02:57.808616,epoch time: 0:19:36.318751,used: 0:39:27.651001,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92120475, 'precision': 0.92071974, 'recall': 0.87190634, 'specificity': 0.87190634, 'f1': 0.89249355, 'auroc': 0.9604894, 'binary_precision': 0.9198543, 'binary_recall': 0.76773083, 'binary_specificity': 0.97608185, 'binary_f1_score': 0.8369361}
confusion matrix:
       0      1
0  41299   1012
1   3514  11615
---- Validation: 
scalar performance:
{'acc': 0.9449209, 'precision': 0.63614386, 'recall': 0.7266183, 'specificity': 0.7266183, 'f1': 0.66803855, 'auroc': 0.85213757, 'binary_precision': 0.28947368, 'binary_recall': 0.49335548, 'binary_specificity': 0.9598811, 'binary_f1_score': 0.36486486}
confusion matrix:
       0    1
0  17442  729
1    305  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91553134, 'precision': 0.5886658, 'recall': 0.66856396, 'specificity': 0.66856396, 'f1': 0.61212325, 'auroc': 0.83415675, 'binary_precision': 0.20250522, 'binary_recall': 0.40082645, 'binary_specificity': 0.93630147, 'binary_f1_score': 0.26907074}
confusion matrix:
      0    1
0  5615  382
1   145   97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-26 04:22:51.737858,epoch time: 0:19:53.929242,used: 0:59:21.580243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9274547, 'precision': 0.92722464, 'recall': 0.8822491, 'specificity': 0.8822491, 'f1': 0.90154356, 'auroc': 0.9656953, 'binary_precision': 0.92680836, 'binary_recall': 0.78671515, 'binary_specificity': 0.977783, 'binary_f1_score': 0.85103494}
confusion matrix:
       0      1
0  41370    940
1   3227  11903
---- Validation: 
scalar performance:
{'acc': 0.94966173, 'precision': 0.6494879, 'recall': 0.72746116, 'specificity': 0.72746116, 'f1': 0.6790614, 'auroc': 0.86161494, 'binary_precision': 0.31618434, 'binary_recall': 0.4900332, 'binary_specificity': 0.9648891, 'binary_f1_score': 0.3843648}
confusion matrix:
       0    1
0  17533  638
1    307  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92995673, 'precision': 0.62054694, 'recall': 0.6998606, 'specificity': 0.6998606, 'f1': 0.6479313, 'auroc': 0.85566026, 'binary_precision': 0.2639225, 'binary_recall': 0.45041323, 'binary_specificity': 0.949308, 'binary_f1_score': 0.33282444}
confusion matrix:
      0    1
0  5693  304
1   133  109
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-26 04:42:24.300481,epoch time: 0:19:32.562623,used: 1:18:54.142866,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93502784, 'precision': 0.93323964, 'recall': 0.896391, 'specificity': 0.896391, 'f1': 0.9126896, 'auroc': 0.9705811, 'binary_precision': 0.9299185, 'binary_recall': 0.8147389, 'binary_specificity': 0.978043, 'binary_f1_score': 0.8685267}
confusion matrix:
       0      1
0  41381    929
1   2803  12327
---- Validation: 
scalar performance:
{'acc': 0.9505673, 'precision': 0.653743, 'recall': 0.7327472, 'specificity': 0.7327472, 'f1': 0.68384886, 'auroc': 0.8676717, 'binary_precision': 0.32435346, 'binary_recall': 0.5, 'binary_specificity': 0.96549445, 'binary_f1_score': 0.39346406}
confusion matrix:
       0    1
0  17544  627
1    301  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9310787, 'precision': 0.63087136, 'recall': 0.7262199, 'specificity': 0.7262199, 'f1': 0.66279477, 'auroc': 0.8687333, 'binary_precision': 0.2824074, 'binary_recall': 0.5041322, 'binary_specificity': 0.9483075, 'binary_f1_score': 0.3620178}
confusion matrix:
      0    1
0  5687  310
1   120  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-26 05:01:44.958830,epoch time: 0:19:20.658349,used: 1:38:14.801215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9400766, 'precision': 0.9371035, 'recall': 0.9059481, 'specificity': 0.9059481, 'f1': 0.92001295, 'auroc': 0.97364306, 'binary_precision': 0.9314775, 'binary_recall': 0.83382905, 'binary_specificity': 0.97806716, 'binary_f1_score': 0.87995255}
confusion matrix:
       0      1
0  41383    928
1   2514  12615
---- Validation: 
scalar performance:
{'acc': 0.94934213, 'precision': 0.6515449, 'recall': 0.73853874, 'specificity': 0.73853874, 'f1': 0.6837239, 'auroc': 0.87159765, 'binary_precision': 0.31954497, 'binary_recall': 0.51328903, 'binary_specificity': 0.96378845, 'binary_f1_score': 0.39388144}
confusion matrix:
       0    1
0  17513  658
1    293  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9342843, 'precision': 0.64744323, 'recall': 0.7635767, 'specificity': 0.7635767, 'f1': 0.685508, 'auroc': 0.8772857, 'binary_precision': 0.3125, 'binary_recall': 0.5785124, 'binary_specificity': 0.948641, 'binary_f1_score': 0.4057971}
confusion matrix:
      0    1
0  5689  308
1   102  140
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_6.png
new oracle model saved
early stop counter: 1
val acc:0.9493421316146851, best validation acc: 0.9505673050880432, corresponding to test acc:                         0.9310786724090576 / 0.9342843294143677
after epoch: 6,now: 2024-06-26 05:21:21.094463,epoch time: 0:19:36.135633,used: 1:57:50.936848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.940773, 'precision': 0.94105035, 'recall': 0.9040483, 'specificity': 0.9040483, 'f1': 0.92045516, 'auroc': 0.9759387, 'binary_precision': 0.9415663, 'binary_recall': 0.82643753, 'binary_specificity': 0.9816592, 'binary_f1_score': 0.88025343}
confusion matrix:
       0      1
0  41534    776
1   2626  12504
---- Validation: 
scalar performance:
{'acc': 0.95402974, 'precision': 0.6653783, 'recall': 0.73212665, 'specificity': 0.73212665, 'f1': 0.6922923, 'auroc': 0.87516654, 'binary_precision': 0.34772462, 'binary_recall': 0.4950166, 'binary_specificity': 0.9692367, 'binary_f1_score': 0.40849894}
confusion matrix:
       0    1
0  17612  559
1    304  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9422985, 'precision': 0.6638688, 'recall': 0.75386626, 'specificity': 0.75386626, 'f1': 0.6972728, 'auroc': 0.8836684, 'binary_precision': 0.34635416, 'binary_recall': 0.5495868, 'binary_specificity': 0.95814574, 'binary_f1_score': 0.42492014}
confusion matrix:
      0    1
0  5746  251
1   109  133
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-26 05:42:05.796174,epoch time: 0:20:44.701711,used: 2:18:35.638559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9455606, 'precision': 0.94131017, 'recall': 0.9163374, 'specificity': 0.9163374, 'f1': 0.92785585, 'auroc': 0.9782312, 'binary_precision': 0.9330976, 'binary_recall': 0.8545839, 'binary_specificity': 0.9780908, 'binary_f1_score': 0.8921166}
confusion matrix:
       0      1
0  41384    927
1   2200  12929
---- Validation: 
scalar performance:
{'acc': 0.94806373, 'precision': 0.6500075, 'recall': 0.74671185, 'specificity': 0.74671185, 'f1': 0.6845748, 'auroc': 0.878583, 'binary_precision': 0.31589338, 'binary_recall': 0.53156143, 'binary_specificity': 0.9618623, 'binary_f1_score': 0.39628485}
confusion matrix:
       0    1
0  17478  693
1    282  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93476516, 'precision': 0.65650463, 'recall': 0.7975334, 'specificity': 0.7975334, 'f1': 0.7004442, 'auroc': 0.88876736, 'binary_precision': 0.32776618, 'binary_recall': 0.6487603, 'binary_specificity': 0.94630647, 'binary_f1_score': 0.43550622}
confusion matrix:
      0    1
0  5675  322
1    85  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_8.png
early stop counter: 1
val acc:0.9480637311935425, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9422984719276428
after epoch: 8,now: 2024-06-26 06:02:16.990551,epoch time: 0:20:11.194377,used: 2:38:46.832936,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94712746, 'precision': 0.94193256, 'recall': 0.91990626, 'specificity': 0.91990626, 'f1': 0.9301647, 'auroc': 0.9782464, 'binary_precision': 0.9317955, 'binary_recall': 0.8623835, 'binary_specificity': 0.97742903, 'binary_f1_score': 0.89574677}
confusion matrix:
       0      1
0  41356    955
1   2082  13047
---- Validation: 
scalar performance:
{'acc': 0.94785064, 'precision': 0.6504233, 'recall': 0.750617, 'specificity': 0.750617, 'f1': 0.68588024, 'auroc': 0.88096356, 'binary_precision': 0.3164557, 'binary_recall': 0.5398671, 'binary_specificity': 0.961367, 'binary_f1_score': 0.3990178}
confusion matrix:
       0    1
0  17469  702
1    277  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93476516, 'precision': 0.6582567, 'recall': 0.8054644, 'specificity': 0.8054644, 'f1': 0.70352983, 'auroc': 0.89177716, 'binary_precision': 0.3305955, 'binary_recall': 0.6652893, 'binary_specificity': 0.9456395, 'binary_f1_score': 0.441701}
confusion matrix:
      0    1
0  5671  326
1    81  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_9.png
early stop counter: 2
val acc:0.9478506445884705, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9422984719276428
after epoch: 9,now: 2024-06-26 06:23:19.730619,epoch time: 0:21:02.740068,used: 2:59:49.573004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94684887, 'precision': 0.9434532, 'recall': 0.91761976, 'specificity': 0.91761976, 'f1': 0.9295083, 'auroc': 0.97880435, 'binary_precision': 0.9369076, 'binary_recall': 0.8558493, 'binary_specificity': 0.9793902, 'binary_f1_score': 0.894546}
confusion matrix:
       0      1
0  41438    872
1   2181  12949
---- Validation: 
scalar performance:
{'acc': 0.94950193, 'precision': 0.6545495, 'recall': 0.7482579, 'specificity': 0.7482579, 'f1': 0.688704, 'auroc': 0.88225794, 'binary_precision': 0.32489878, 'binary_recall': 0.5332226, 'binary_specificity': 0.96329314, 'binary_f1_score': 0.40377358}
confusion matrix:
       0    1
0  17504  667
1    281  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9403751, 'precision': 0.6710989, 'recall': 0.8083825, 'specificity': 0.8083825, 'f1': 0.7162044, 'auroc': 0.8947904, 'binary_precision': 0.3561947, 'binary_recall': 0.6652893, 'binary_specificity': 0.95147574, 'binary_f1_score': 0.46397695}
confusion matrix:
      0    1
0  5706  291
1    81  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_10.png
early stop counter: 3
val acc:0.9495019316673279, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9422984719276428
after epoch: 10,now: 2024-06-26 06:42:51.818266,epoch time: 0:19:32.087647,used: 3:19:21.660651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9476497, 'precision': 0.9462259, 'recall': 0.91701233, 'specificity': 0.91701233, 'f1': 0.93032074, 'auroc': 0.98060924, 'binary_precision': 0.94350946, 'binary_recall': 0.8522705, 'binary_specificity': 0.9817541, 'binary_f1_score': 0.8955721}
confusion matrix:
       0      1
0  41539    772
1   2235  12894
---- Validation: 
scalar performance:
{'acc': 0.9510467, 'precision': 0.65887296, 'recall': 0.7466467, 'specificity': 0.7466467, 'f1': 0.69173455, 'auroc': 0.8833541, 'binary_precision': 0.3336831, 'binary_recall': 0.5282392, 'binary_specificity': 0.9650542, 'binary_f1_score': 0.40900323}
confusion matrix:
       0    1
0  17536  635
1    284  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94374096, 'precision': 0.6786584, 'recall': 0.80418515, 'specificity': 0.80418515, 'f1': 0.72202253, 'auroc': 0.89622843, 'binary_precision': 0.37176472, 'binary_recall': 0.6528926, 'binary_specificity': 0.9554777, 'binary_f1_score': 0.47376317}
confusion matrix:
      0    1
0  5730  267
1    84  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_11.png
new oracle model saved
early stop counter: 4
val acc:0.9510467052459717, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.943740963935852
after epoch: 11,now: 2024-06-26 07:02:01.240437,epoch time: 0:19:09.422171,used: 3:38:31.082822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9485724, 'precision': 0.9482987, 'recall': 0.9174522, 'specificity': 0.9174522, 'f1': 0.9314394, 'auroc': 0.9810468, 'binary_precision': 0.94777876, 'binary_recall': 0.8516854, 'binary_specificity': 0.9832191, 'binary_f1_score': 0.89716625}
confusion matrix:
       0      1
0  41600    710
1   2244  12886
---- Validation: 
scalar performance:
{'acc': 0.9527513, 'precision': 0.6635003, 'recall': 0.7427089, 'specificity': 0.7427089, 'f1': 0.6941783, 'auroc': 0.88420355, 'binary_precision': 0.34323433, 'binary_recall': 0.5182724, 'binary_specificity': 0.96714544, 'binary_f1_score': 0.41297156}
confusion matrix:
       0    1
0  17574  597
1    290  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9487097, 'precision': 0.69332194, 'recall': 0.8067698, 'specificity': 0.8067698, 'f1': 0.73491645, 'auroc': 0.89831674, 'binary_precision': 0.40101522, 'binary_recall': 0.6528926, 'binary_specificity': 0.960647, 'binary_f1_score': 0.49685532}
confusion matrix:
      0    1
0  5761  236
1    84  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_12.png
new oracle model saved
early stop counter: 5
val acc:0.9527512788772583, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 12,now: 2024-06-26 07:21:25.876668,epoch time: 0:19:24.636231,used: 3:57:55.719053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95226324, 'precision': 0.94903487, 'recall': 0.926386, 'specificity': 0.926386, 'f1': 0.9369296, 'auroc': 0.9833409, 'binary_precision': 0.94274074, 'binary_recall': 0.8717033, 'binary_specificity': 0.98106873, 'binary_f1_score': 0.9058314}
confusion matrix:
       0      1
0  41510    801
1   1941  13188
---- Validation: 
scalar performance:
{'acc': 0.9514729, 'precision': 0.66068786, 'recall': 0.7484729, 'specificity': 0.7484729, 'f1': 0.69366395, 'auroc': 0.88613975, 'binary_precision': 0.33719704, 'binary_recall': 0.53156143, 'binary_specificity': 0.9653844, 'binary_f1_score': 0.412637}
confusion matrix:
       0    1
0  17542  629
1    282  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9463055, 'precision': 0.6866672, 'recall': 0.8094846, 'specificity': 0.8094846, 'f1': 0.73010755, 'auroc': 0.90010774, 'binary_precision': 0.3874092, 'binary_recall': 0.661157, 'binary_specificity': 0.95781225, 'binary_f1_score': 0.48854965}
confusion matrix:
      0    1
0  5744  253
1    82  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_13.png
early stop counter: 6
val acc:0.9514728784561157, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 13,now: 2024-06-26 07:40:46.473239,epoch time: 0:19:20.596571,used: 4:17:16.315624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9517235, 'precision': 0.9481882, 'recall': 0.9258114, 'specificity': 0.9258114, 'f1': 0.9362354, 'auroc': 0.9822415, 'binary_precision': 0.9412899, 'binary_recall': 0.8710509, 'binary_specificity': 0.980572, 'binary_f1_score': 0.90480936}
confusion matrix:
       0      1
0  41488    822
1   1951  13179
---- Validation: 
scalar performance:
{'acc': 0.9507271, 'precision': 0.65883136, 'recall': 0.75049686, 'specificity': 0.75049686, 'f1': 0.69274545, 'auroc': 0.88642085, 'binary_precision': 0.33333334, 'binary_recall': 0.53654486, 'binary_specificity': 0.96444887, 'binary_f1_score': 0.4112031}
confusion matrix:
       0    1
0  17525  646
1    279  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94550407, 'precision': 0.6850667, 'recall': 0.8130332, 'specificity': 0.8130332, 'f1': 0.7295862, 'auroc': 0.9004824, 'binary_precision': 0.38388625, 'binary_recall': 0.6694215, 'binary_specificity': 0.956645, 'binary_f1_score': 0.4879518}
confusion matrix:
      0    1
0  5737  260
1    80  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_14.png
early stop counter: 7
val acc:0.950727105140686, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 14,now: 2024-06-26 08:00:11.470161,epoch time: 0:19:24.996922,used: 4:36:41.312546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.95236766, 'precision': 0.9502932, 'recall': 0.92542076, 'specificity': 0.92542076, 'f1': 0.9369214, 'auroc': 0.98329216, 'binary_precision': 0.94627684, 'binary_recall': 0.86847323, 'binary_specificity': 0.98236823, 'binary_f1_score': 0.9057072}
confusion matrix:
       0      1
0  41564    746
1   1990  13140
---- Validation: 
scalar performance:
{'acc': 0.95280457, 'precision': 0.6654537, 'recall': 0.7499639, 'specificity': 0.7499639, 'f1': 0.6977792, 'auroc': 0.88767076, 'binary_precision': 0.34665227, 'binary_recall': 0.5332226, 'binary_specificity': 0.9667052, 'binary_f1_score': 0.42015707}
confusion matrix:
       0    1
0  17566  605
1    281  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9475877, 'precision': 0.6905031, 'recall': 0.81015164, 'specificity': 0.81015164, 'f1': 0.73347557, 'auroc': 0.9013963, 'binary_precision': 0.39506173, 'binary_recall': 0.661157, 'binary_specificity': 0.95914626, 'binary_f1_score': 0.49459043}
confusion matrix:
      0    1
0  5752  245
1    82  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_15.png
early stop counter: 8
val acc:0.9528045654296875, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 15,now: 2024-06-26 08:19:55.855761,epoch time: 0:19:44.385600,used: 4:56:25.698146,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9549791, 'precision': 0.95138407, 'recall': 0.9312233, 'specificity': 0.9312233, 'f1': 0.94068706, 'auroc': 0.9841013, 'binary_precision': 0.94431454, 'binary_recall': 0.8810232, 'binary_specificity': 0.98142326, 'binary_f1_score': 0.9115716}
confusion matrix:
       0      1
0  41525    786
1   1800  13329
---- Validation: 
scalar performance:
{'acc': 0.949715, 'precision': 0.6597198, 'recall': 0.7668381, 'specificity': 0.7668381, 'f1': 0.6976418, 'auroc': 0.8894361, 'binary_precision': 0.3339806, 'binary_recall': 0.5714286, 'binary_specificity': 0.96224755, 'binary_f1_score': 0.4215686}
confusion matrix:
       0    1
0  17485  686
1    258  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94213814, 'precision': 0.6789568, 'recall': 0.82714427, 'specificity': 0.82714427, 'f1': 0.7271842, 'auroc': 0.90252423, 'binary_precision': 0.37037036, 'binary_recall': 0.70247936, 'binary_specificity': 0.9518092, 'binary_f1_score': 0.48502135}
confusion matrix:
      0    1
0  5708  289
1    72  170
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_16.png
early stop counter: 9
val acc:0.9497150182723999, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 16,now: 2024-06-26 08:42:59.912151,epoch time: 0:23:04.056390,used: 5:19:29.754536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.95490944, 'precision': 0.9512067, 'recall': 0.9312184, 'specificity': 0.9312184, 'f1': 0.94060594, 'auroc': 0.98421365, 'binary_precision': 0.94392127, 'binary_recall': 0.8811554, 'binary_specificity': 0.98128146, 'binary_f1_score': 0.911459}
confusion matrix:
       0      1
0  41519    792
1   1798  13331
---- Validation: 
scalar performance:
{'acc': 0.94838333, 'precision': 0.6559444, 'recall': 0.76695323, 'specificity': 0.76695323, 'f1': 0.69445586, 'auroc': 0.8894892, 'binary_precision': 0.32639545, 'binary_recall': 0.5730897, 'binary_specificity': 0.9608167, 'binary_f1_score': 0.4159132}
confusion matrix:
       0    1
0  17459  712
1    257  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9410162, 'precision': 0.67579174, 'recall': 0.8245779, 'specificity': 0.8245779, 'f1': 0.7237464, 'auroc': 0.90256834, 'binary_precision': 0.36422414, 'binary_recall': 0.6983471, 'binary_specificity': 0.95080876, 'binary_f1_score': 0.4787535}
confusion matrix:
      0    1
0  5702  295
1    73  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_17.png
early stop counter: 10
val acc:0.9483833312988281, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 17,now: 2024-06-26 09:06:28.443715,epoch time: 0:23:28.531564,used: 5:42:58.286100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9568071, 'precision': 0.9516332, 'recall': 0.9358578, 'specificity': 0.9358578, 'f1': 0.94336593, 'auroc': 0.98570013, 'binary_precision': 0.94130784, 'binary_recall': 0.8915917, 'binary_specificity': 0.9801238, 'binary_f1_score': 0.91577554}
confusion matrix:
       0      1
0  41471    841
1   1640  13488
---- Validation: 
scalar performance:
{'acc': 0.94854313, 'precision': 0.65621865, 'recall': 0.7662327, 'specificity': 0.7662327, 'f1': 0.6945236, 'auroc': 0.88982177, 'binary_precision': 0.3269962, 'binary_recall': 0.5714286, 'binary_specificity': 0.9610368, 'binary_f1_score': 0.41596133}
confusion matrix:
       0    1
0  17463  708
1    258  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9403751, 'precision': 0.6738484, 'recall': 0.8222617, 'specificity': 0.8222617, 'f1': 0.72148526, 'auroc': 0.90331393, 'binary_precision': 0.36051503, 'binary_recall': 0.6942149, 'binary_specificity': 0.9503085, 'binary_f1_score': 0.47457626}
confusion matrix:
      0    1
0  5699  298
1    74  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_18.png
early stop counter: 11
val acc:0.948543131351471, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 18,now: 2024-06-26 09:30:22.422768,epoch time: 0:23:53.979053,used: 6:06:52.265153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.95668525, 'precision': 0.9528471, 'recall': 0.9342674, 'specificity': 0.9342674, 'f1': 0.94303465, 'auroc': 0.9858148, 'binary_precision': 0.94525856, 'binary_recall': 0.88689846, 'binary_specificity': 0.9816364, 'binary_f1_score': 0.915149}
confusion matrix:
       0      1
0  41535    777
1   1711  13417
---- Validation: 
scalar performance:
{'acc': 0.9495552, 'precision': 0.6592336, 'recall': 0.7667555, 'specificity': 0.7667555, 'f1': 0.6972122, 'auroc': 0.8900844, 'binary_precision': 0.33301064, 'binary_recall': 0.5714286, 'binary_specificity': 0.96208245, 'binary_f1_score': 0.42079514}
confusion matrix:
       0    1
0  17482  689
1    258  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9411765, 'precision': 0.67580897, 'recall': 0.82267857, 'specificity': 0.82267857, 'f1': 0.72339195, 'auroc': 0.90391684, 'binary_precision': 0.36442515, 'binary_recall': 0.6942149, 'binary_specificity': 0.95114225, 'binary_f1_score': 0.47795162}
confusion matrix:
      0    1
0  5704  293
1    74  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_19.png
early stop counter: 12
val acc:0.9495552182197571, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 19,now: 2024-06-26 09:53:56.269892,epoch time: 0:23:33.847124,used: 6:30:26.112277,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9574338, 'precision': 0.9526535, 'recall': 0.93647766, 'specificity': 0.93647766, 'f1': 0.94416785, 'auroc': 0.98629975, 'binary_precision': 0.94312465, 'binary_recall': 0.8921938, 'binary_specificity': 0.9807615, 'binary_f1_score': 0.91695255}
confusion matrix:
       0      1
0  41497    814
1   1631  13498
---- Validation: 
scalar performance:
{'acc': 0.945933, 'precision': 0.65087, 'recall': 0.7729149, 'specificity': 0.7729149, 'f1': 0.6912887, 'auroc': 0.8901708, 'binary_precision': 0.31578946, 'binary_recall': 0.5880399, 'binary_specificity': 0.9577899, 'binary_f1_score': 0.4109112}
confusion matrix:
       0    1
0  17404  767
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93476516, 'precision': 0.6644455, 'recall': 0.8352055, 'specificity': 0.8352055, 'f1': 0.7145191, 'auroc': 0.90372944, 'binary_precision': 0.34042552, 'binary_recall': 0.72727275, 'binary_specificity': 0.94313824, 'binary_f1_score': 0.4637681}
confusion matrix:
      0    1
0  5656  341
1    66  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_20.png
early stop counter: 13
val acc:0.9459329843521118, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 20,now: 2024-06-26 10:21:34.476245,epoch time: 0:27:38.206353,used: 6:58:04.318630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.95685935, 'precision': 0.95341563, 'recall': 0.9341556, 'specificity': 0.9341556, 'f1': 0.9432254, 'auroc': 0.9861526, 'binary_precision': 0.9466215, 'binary_recall': 0.88617885, 'binary_specificity': 0.9821323, 'binary_f1_score': 0.9154035}
confusion matrix:
       0      1
0  41555    756
1   1722  13407
---- Validation: 
scalar performance:
{'acc': 0.94833004, 'precision': 0.65598124, 'recall': 0.7677287, 'specificity': 0.7677287, 'f1': 0.6946671, 'auroc': 0.89072883, 'binary_precision': 0.3264151, 'binary_recall': 0.57475084, 'binary_specificity': 0.9607066, 'binary_f1_score': 0.4163658}
confusion matrix:
       0    1
0  17457  714
1    256  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9398942, 'precision': 0.6730775, 'recall': 0.8239943, 'specificity': 0.8239943, 'f1': 0.72108954, 'auroc': 0.90406656, 'binary_precision': 0.35881105, 'binary_recall': 0.6983471, 'binary_specificity': 0.94964147, 'binary_f1_score': 0.4740533}
confusion matrix:
      0    1
0  5695  302
1    73  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_21.png
early stop counter: 14
val acc:0.9483300447463989, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 21,now: 2024-06-26 10:48:48.475859,epoch time: 0:27:13.999614,used: 7:25:18.318244,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9579213, 'precision': 0.9529224, 'recall': 0.9375124, 'specificity': 0.9375124, 'f1': 0.9448563, 'auroc': 0.9863206, 'binary_precision': 0.9429308, 'binary_recall': 0.894382, 'binary_specificity': 0.98064286, 'binary_f1_score': 0.91801494}
confusion matrix:
       0      1
0  41491    819
1   1598  13532
---- Validation: 
scalar performance:
{'acc': 0.9459863, 'precision': 0.65120286, 'recall': 0.7737454, 'specificity': 0.7737454, 'f1': 0.69176316, 'auroc': 0.891012, 'binary_precision': 0.31639928, 'binary_recall': 0.589701, 'binary_specificity': 0.9577899, 'binary_f1_score': 0.41183293}
confusion matrix:
       0    1
0  17404  767
1    247  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93652827, 'precision': 0.66738033, 'recall': 0.83215714, 'specificity': 0.83215714, 'f1': 0.71699697, 'auroc': 0.9042255, 'binary_precision': 0.34661356, 'binary_recall': 0.71900827, 'binary_specificity': 0.945306, 'binary_f1_score': 0.46774194}
confusion matrix:
      0    1
0  5669  328
1    68  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_22.png
early stop counter: 15
val acc:0.945986270904541, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 22,now: 2024-06-26 11:15:47.064624,epoch time: 0:26:58.588765,used: 7:52:16.907009,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9588266, 'precision': 0.95561194, 'recall': 0.93715036, 'specificity': 0.93715036, 'f1': 0.9458691, 'auroc': 0.98719156, 'binary_precision': 0.94925034, 'binary_recall': 0.8913417, 'binary_specificity': 0.9829591, 'binary_f1_score': 0.9193851}
confusion matrix:
       0      1
0  41589    721
1   1644  13486
---- Validation: 
scalar performance:
{'acc': 0.94902253, 'precision': 0.6576331, 'recall': 0.7664803, 'specificity': 0.7664803, 'f1': 0.69579023, 'auroc': 0.8903776, 'binary_precision': 0.32981783, 'binary_recall': 0.5714286, 'binary_specificity': 0.9615321, 'binary_f1_score': 0.4182371}
confusion matrix:
       0    1
0  17472  699
1    258  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9408559, 'precision': 0.6750196, 'recall': 0.8225118, 'specificity': 0.8225118, 'f1': 0.7226264, 'auroc': 0.9034338, 'binary_precision': 0.36285096, 'binary_recall': 0.6942149, 'binary_specificity': 0.95080876, 'binary_f1_score': 0.47659573}
confusion matrix:
      0    1
0  5702  295
1    74  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_23.png
early stop counter: 16
val acc:0.9490225315093994, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 23,now: 2024-06-26 11:45:14.357603,epoch time: 0:29:27.292979,used: 8:21:44.199988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.958461, 'precision': 0.9559113, 'recall': 0.9358833, 'specificity': 0.9358833, 'f1': 0.9452964, 'auroc': 0.98705894, 'binary_precision': 0.9508916, 'binary_recall': 0.8881692, 'binary_specificity': 0.9835973, 'binary_f1_score': 0.9184609}
confusion matrix:
       0      1
0  41616    694
1   1692  13438
---- Validation: 
scalar performance:
{'acc': 0.9485964, 'precision': 0.65675676, 'recall': 0.7678663, 'specificity': 0.7678663, 'f1': 0.69536686, 'auroc': 0.89084756, 'binary_precision': 0.32796207, 'binary_recall': 0.57475084, 'binary_specificity': 0.9609818, 'binary_f1_score': 0.41762218}
confusion matrix:
       0    1
0  17462  709
1    256  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9408559, 'precision': 0.67652225, 'recall': 0.8304428, 'specificity': 0.8304428, 'f1': 0.7255521, 'auroc': 0.9038395, 'binary_precision': 0.36518046, 'binary_recall': 0.7107438, 'binary_specificity': 0.9501417, 'binary_f1_score': 0.4824684}
confusion matrix:
      0    1
0  5698  299
1    70  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_24.png
early stop counter: 17
val acc:0.9485964179039001, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 24,now: 2024-06-26 12:12:03.876318,epoch time: 0:26:49.518715,used: 8:48:33.718703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96128136, 'precision': 0.95625937, 'recall': 0.9430413, 'specificity': 0.9430413, 'f1': 0.94938636, 'auroc': 0.9875876, 'binary_precision': 0.94614214, 'binary_recall': 0.9044944, 'binary_specificity': 0.9815883, 'binary_f1_score': 0.9248496}
confusion matrix:
       0      1
0  41531    779
1   1445  13685
---- Validation: 
scalar performance:
{'acc': 0.9428967, 'precision': 0.64476496, 'recall': 0.7777709, 'specificity': 0.7777709, 'f1': 0.686566, 'auroc': 0.8912582, 'binary_precision': 0.30318257, 'binary_recall': 0.6013289, 'binary_specificity': 0.9542128, 'binary_f1_score': 0.40311804}
confusion matrix:
       0    1
0  17339  832
1    240  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9313993, 'precision': 0.65858966, 'recall': 0.8374201, 'specificity': 0.8374201, 'f1': 0.70874083, 'auroc': 0.90427583, 'binary_precision': 0.32841328, 'binary_recall': 0.7355372, 'binary_specificity': 0.939303, 'binary_f1_score': 0.45408165}
confusion matrix:
      0    1
0  5633  364
1    64  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_25.png
early stop counter: 18
val acc:0.9428967237472534, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 25,now: 2024-06-26 12:40:55.017204,epoch time: 0:28:51.140886,used: 9:17:24.859589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.95940113, 'precision': 0.9561843, 'recall': 0.93809235, 'specificity': 0.93809235, 'f1': 0.9466471, 'auroc': 0.98744726, 'binary_precision': 0.9498102, 'binary_recall': 0.89306015, 'binary_specificity': 0.98312455, 'binary_f1_score': 0.9205614}
confusion matrix:
       0      1
0  41596    714
1   1618  13512
---- Validation: 
scalar performance:
{'acc': 0.9463059, 'precision': 0.651865, 'recall': 0.7731075, 'specificity': 0.7731075, 'f1': 0.69222724, 'auroc': 0.8916607, 'binary_precision': 0.3177738, 'binary_recall': 0.5880399, 'binary_specificity': 0.9581751, 'binary_f1_score': 0.4125874}
confusion matrix:
       0    1
0  17411  760
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93716943, 'precision': 0.6687765, 'recall': 0.8324906, 'specificity': 0.8324906, 'f1': 0.7184372, 'auroc': 0.90464306, 'binary_precision': 0.3493976, 'binary_recall': 0.71900827, 'binary_specificity': 0.945973, 'binary_f1_score': 0.47027025}
confusion matrix:
      0    1
0  5673  324
1    68  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_26.png
early stop counter: 19
val acc:0.9463058710098267, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 26,now: 2024-06-26 13:04:49.996427,epoch time: 0:23:54.979223,used: 9:41:19.838812,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9602716, 'precision': 0.9559438, 'recall': 0.9406544, 'specificity': 0.9406544, 'f1': 0.94794667, 'auroc': 0.9878106, 'binary_precision': 0.9472878, 'binary_recall': 0.8992002, 'binary_specificity': 0.98210865, 'binary_f1_score': 0.92261785}
confusion matrix:
       0      1
0  41554    757
1   1525  13604
---- Validation: 
scalar performance:
{'acc': 0.94705164, 'precision': 0.6542705, 'recall': 0.7750988, 'specificity': 0.7750988, 'f1': 0.69480807, 'auroc': 0.89190966, 'binary_precision': 0.32246378, 'binary_recall': 0.5913621, 'binary_specificity': 0.9588355, 'binary_f1_score': 0.41735056}
confusion matrix:
       0    1
0  17423  748
1    246  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9397339, 'precision': 0.6745921, 'recall': 0.83382463, 'specificity': 0.83382463, 'f1': 0.724337, 'auroc': 0.9038948, 'binary_precision': 0.36099586, 'binary_recall': 0.71900827, 'binary_specificity': 0.948641, 'binary_f1_score': 0.480663}
confusion matrix:
      0    1
0  5689  308
1    68  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_27.png
early stop counter: 20
val acc:0.9470516443252563, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 27,now: 2024-06-26 13:28:27.045077,epoch time: 0:23:37.048650,used: 10:04:56.887462,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9604979, 'precision': 0.9568707, 'recall': 0.94029534, 'specificity': 0.94029534, 'f1': 0.94817066, 'auroc': 0.98735344, 'binary_precision': 0.94964683, 'binary_recall': 0.8976071, 'binary_specificity': 0.9829835, 'binary_f1_score': 0.92289394}
confusion matrix:
       0      1
0  41592    720
1   1549  13579
---- Validation: 
scalar performance:
{'acc': 0.9467853, 'precision': 0.65316266, 'recall': 0.7733551, 'specificity': 0.7733551, 'f1': 0.6934441, 'auroc': 0.89119506, 'binary_precision': 0.320362, 'binary_recall': 0.5880399, 'binary_specificity': 0.95867044, 'binary_f1_score': 0.41476277}
confusion matrix:
       0    1
0  17420  751
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9397339, 'precision': 0.6749641, 'recall': 0.8358073, 'specificity': 0.8358073, 'f1': 0.72504956, 'auroc': 0.90346617, 'binary_precision': 0.36157024, 'binary_recall': 0.7231405, 'binary_specificity': 0.9484742, 'binary_f1_score': 0.48209366}
confusion matrix:
      0    1
0  5688  309
1    67  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_28.png
early stop counter: 21
val acc:0.9467852711677551, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 28,now: 2024-06-26 13:51:33.564457,epoch time: 0:23:06.519380,used: 10:28:03.406842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.962883, 'precision': 0.9578217, 'recall': 0.9456967, 'specificity': 0.9456967, 'f1': 0.9515377, 'auroc': 0.988837, 'binary_precision': 0.94758594, 'binary_recall': 0.90937936, 'binary_specificity': 0.9820141, 'binary_f1_score': 0.92808956}
confusion matrix:
       0      1
0  41550    761
1   1371  13758
---- Validation: 
scalar performance:
{'acc': 0.9440153, 'precision': 0.64843416, 'recall': 0.7823639, 'specificity': 0.7823639, 'f1': 0.6909075, 'auroc': 0.89150035, 'binary_precision': 0.31022823, 'binary_recall': 0.6096346, 'binary_specificity': 0.95509326, 'binary_f1_score': 0.4112045}
confusion matrix:
       0    1
0  17355  816
1    235  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93332267, 'precision': 0.66152406, 'recall': 0.83445513, 'specificity': 0.83445513, 'f1': 0.7114041, 'auroc': 0.90404844, 'binary_precision': 0.33460075, 'binary_recall': 0.72727275, 'binary_specificity': 0.94163746, 'binary_f1_score': 0.45833334}
confusion matrix:
      0    1
0  5647  350
1    66  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_29.png
early stop counter: 22
val acc:0.9440153241157532, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 29,now: 2024-06-26 14:14:11.255885,epoch time: 0:22:37.691428,used: 10:50:41.098270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96058494, 'precision': 0.95593685, 'recall': 0.94150716, 'specificity': 0.94150716, 'f1': 0.94840765, 'auroc': 0.9886733, 'binary_precision': 0.94661206, 'binary_recall': 0.9011897, 'binary_specificity': 0.98182464, 'binary_f1_score': 0.9233426}
confusion matrix:
       0      1
0  41541    769
1   1495  13635
---- Validation: 
scalar performance:
{'acc': 0.9469451, 'precision': 0.6539782, 'recall': 0.7750438, 'specificity': 0.7750438, 'f1': 0.694535, 'auroc': 0.8915832, 'binary_precision': 0.32188064, 'binary_recall': 0.5913621, 'binary_specificity': 0.95872545, 'binary_f1_score': 0.4168618}
confusion matrix:
       0    1
0  17421  750
1    246  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9400545, 'precision': 0.6757163, 'recall': 0.8359741, 'specificity': 0.8359741, 'f1': 0.72580326, 'auroc': 0.9042448, 'binary_precision': 0.36307055, 'binary_recall': 0.7231405, 'binary_specificity': 0.9488077, 'binary_f1_score': 0.48342544}
confusion matrix:
      0    1
0  5690  307
1    67  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556224_30.png
early stop counter: 23
val acc:0.946945071220398, best validation acc: 0.9540297389030457, corresponding to test acc:                         0.9422984719276428 / 0.9487097263336182
after epoch: 30,now: 2024-06-26 14:37:24.735787,epoch time: 0:23:13.479902,used: 11:13:54.578172,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_03_23_30_seed_2_21556224
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:13:54.578172 at 2024-06-26 14:37:24.735787
persisted model performance metric: 

scalar performance:
{'acc': 0.9422985, 'precision': 0.6638688, 'recall': 0.75386626, 'specificity': 0.75386626, 'f1': 0.6972728, 'auroc': 0.8836684, 'binary_precision': 0.34635416, 'binary_recall': 0.5495868, 'binary_specificity': 0.95814574, 'binary_f1_score': 0.42492014}
confusion matrix:
      0    1
0  5746  251
1   109  133
oracle model performance metric: 

scalar performance:
{'acc': 0.9487097, 'precision': 0.69332194, 'recall': 0.8067698, 'specificity': 0.8067698, 'f1': 0.73491645, 'auroc': 0.89831674, 'binary_precision': 0.40101522, 'binary_recall': 0.6528926, 'binary_specificity': 0.960647, 'binary_f1_score': 0.49685532}
confusion matrix:
      0    1
0  5761  236
1    84  158
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190965 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190965 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189282 KiB | 457564 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  16468 KiB |  37503 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1080 MiB | 579584 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1014 MiB | 550912 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     66 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38410 KiB |  87618 KiB |   1252 TiB |   1252 TiB |
|       from large pool |  31306 KiB |  79555 KiB |   1205 TiB |   1205 TiB |
|       from small pool |   7104 KiB |  21236 KiB |     46 TiB |     46 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7663    |  471825 K  |  471822 K  |
|       from large pool |      76    |     158    |  219127 K  |  219127 K  |
|       from small pool |    2878    |    7585    |  252698 K  |  252695 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7663    |  471825 K  |  471822 K  |
|       from large pool |      76    |     158    |  219127 K  |  219127 K  |
|       from small pool |    2878    |    7585    |  252698 K  |  252695 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      78    |      37    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      33    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      29    |    3609    |  264644 K  |  264644 K  |
|       from large pool |      10    |      22    |  130502 K  |  130502 K  |
|       from small pool |      19    |    3599    |  134141 K  |  134141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  37503 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB | 526336 KiB |   1080 MiB |    856 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1014 MiB |    814 MiB |
|       from small pool |  24576 KiB |  43008 KiB |     66 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87618 KiB |   1252 TiB |   1252 TiB |
|       from large pool |  23872 KiB |  79555 KiB |   1205 TiB |   1205 TiB |
|       from small pool |      0 KiB |  21236 KiB |     46 TiB |     46 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7663    |  471825 K  |  471825 K  |
|       from large pool |       2    |     158    |  219127 K  |  219127 K  |
|       from small pool |       0    |    7585    |  252698 K  |  252698 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7663    |  471825 K  |  471825 K  |
|       from large pool |       2    |     158    |  219127 K  |  219127 K  |
|       from small pool |       0    |    7585    |  252698 K  |  252698 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      42    |      78    |      56    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      12    |      21    |      33    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3609    |  264646 K  |  264646 K  |
|       from large pool |       3    |      22    |  130502 K  |  130502 K  |
|       from small pool |       0    |    3599    |  134143 K  |  134143 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jun 26 14:38:48 2024]
Finished job 0.
1 of 1 steps (100%) done
