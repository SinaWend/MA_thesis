Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jun 24 12:30:47 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217

 Experiment start at: 2024-06-24 12:41:20.009111
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.86365706, 'precision': 0.8655195, 'recall': 0.76329756, 'specificity': 0.76329756, 'f1': 0.79569066, 'auroc': 0.9182503, 'binary_precision': 0.868301, 'binary_recall': 0.5559179, 'binary_specificity': 0.9706772, 'binary_f1_score': 0.67785096}
confusion matrix:
       0     1
0  41081  1241
1   6536  8182
---- Validation: 
scalar performance:
{'acc': 0.942103, 'precision': 0.6140204, 'recall': 0.65650284, 'specificity': 0.65650284, 'f1': 0.6312021, 'auroc': 0.82584643, 'binary_precision': 0.25139666, 'binary_recall': 0.34992224, 'binary_specificity': 0.9630834, 'binary_f1_score': 0.2925878}
confusion matrix:
       0    1
0  17479  670
1    418  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93751997, 'precision': 0.60655236, 'recall': 0.6045983, 'specificity': 0.6045983, 'f1': 0.6055638, 'auroc': 0.8308209, 'binary_precision': 0.24609375, 'binary_recall': 0.2413793, 'binary_specificity': 0.96781725, 'binary_f1_score': 0.24371372}
confusion matrix:
      0    1
0  5804  193
1   198   63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-24 13:08:46.137507,epoch time: 0:27:26.128396,used: 0:27:26.128396,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90987027, 'precision': 0.90816927, 'recall': 0.85011756, 'specificity': 0.85011756, 'f1': 0.87373936, 'auroc': 0.95090103, 'binary_precision': 0.9052658, 'binary_recall': 0.7266735, 'binary_specificity': 0.9735617, 'binary_f1_score': 0.80619746}
confusion matrix:
       0      1
0  41206   1119
1   4022  10693
---- Validation: 
scalar performance:
{'acc': 0.9537037, 'precision': 0.66106206, 'recall': 0.68126005, 'specificity': 0.68126005, 'f1': 0.6704698, 'auroc': 0.8475195, 'binary_precision': 0.34387895, 'binary_recall': 0.3888025, 'binary_specificity': 0.9737176, 'binary_f1_score': 0.3649635}
confusion matrix:
       0    1
0  17672  477
1    393  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.950783, 'precision': 0.6812854, 'recall': 0.6518298, 'specificity': 0.6518298, 'f1': 0.66503143, 'auroc': 0.8744703, 'binary_precision': 0.39170507, 'binary_recall': 0.3256705, 'binary_specificity': 0.977989, 'binary_f1_score': 0.35564852}
confusion matrix:
      0    1
0  5865  132
1   176   85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-24 13:38:36.286112,epoch time: 0:29:50.148605,used: 0:57:16.277001,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92293125, 'precision': 0.9223433, 'recall': 0.87202686, 'specificity': 0.87202686, 'f1': 0.89326954, 'auroc': 0.9611998, 'binary_precision': 0.9213126, 'binary_recall': 0.766832, 'binary_specificity': 0.9772217, 'binary_f1_score': 0.83700407}
confusion matrix:
       0      1
0  41357    964
1   3432  11287
---- Validation: 
scalar performance:
{'acc': 0.95647085, 'precision': 0.67749375, 'recall': 0.69394344, 'specificity': 0.69394344, 'f1': 0.6853004, 'auroc': 0.8587557, 'binary_precision': 0.37588653, 'binary_recall': 0.41213062, 'binary_specificity': 0.9757562, 'binary_f1_score': 0.39317507}
confusion matrix:
       0    1
0  17709  440
1    378  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.7287707, 'recall': 0.7136327, 'specificity': 0.7136327, 'f1': 0.7209041, 'auroc': 0.8908515, 'binary_precision': 0.4814815, 'binary_recall': 0.44827586, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.4642857}
confusion matrix:
      0    1
0  5871  126
1   144  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-24 14:05:52.281738,epoch time: 0:27:15.995626,used: 1:24:32.272627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93024194, 'precision': 0.926131, 'recall': 0.887923, 'specificity': 0.887923, 'f1': 0.9047679, 'auroc': 0.96673226, 'binary_precision': 0.9186618, 'binary_recall': 0.80048925, 'binary_specificity': 0.97535676, 'binary_f1_score': 0.855514}
confusion matrix:
       0      1
0  41281   1043
1   2936  11780
---- Validation: 
scalar performance:
{'acc': 0.9559919, 'precision': 0.68000025, 'recall': 0.71244687, 'specificity': 0.71244687, 'f1': 0.69468236, 'auroc': 0.865222, 'binary_precision': 0.37958115, 'binary_recall': 0.45101088, 'binary_specificity': 0.97388285, 'binary_f1_score': 0.41222456}
confusion matrix:
       0    1
0  17675  474
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95605624, 'precision': 0.72713035, 'recall': 0.7461978, 'specificity': 0.7461978, 'f1': 0.73622036, 'auroc': 0.89958775, 'binary_precision': 0.4753521, 'binary_recall': 0.51724136, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.49541283}
confusion matrix:
      0    1
0  5848  149
1   126  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_4.png
early stop counter: 1
val acc:0.9559919238090515, best validation acc: 0.9564708471298218, corresponding to test acc:                         0.9568552374839783 / 0.9568552374839783
after epoch: 4,now: 2024-06-24 14:31:58.666605,epoch time: 0:26:06.384867,used: 1:50:38.657494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9363955, 'precision': 0.93337864, 'recall': 0.8974612, 'specificity': 0.8974612, 'f1': 0.91346145, 'auroc': 0.9707736, 'binary_precision': 0.92784935, 'binary_recall': 0.81701434, 'binary_specificity': 0.977908, 'binary_f1_score': 0.8689117}
confusion matrix:
       0      1
0  41388    935
1   2693  12024
---- Validation: 
scalar performance:
{'acc': 0.957003, 'precision': 0.6832406, 'recall': 0.7062198, 'specificity': 0.7062198, 'f1': 0.69395363, 'auroc': 0.8697393, 'binary_precision': 0.38651994, 'binary_recall': 0.43701398, 'binary_specificity': 0.97542566, 'binary_f1_score': 0.41021898}
confusion matrix:
       0    1
0  17703  446
1    362  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7428375, 'recall': 0.76410615, 'specificity': 0.76410615, 'f1': 0.7529593, 'auroc': 0.9057907, 'binary_precision': 0.50526315, 'binary_recall': 0.55172414, 'binary_specificity': 0.97648823, 'binary_f1_score': 0.52747256}
confusion matrix:
      0    1
0  5856  141
1   117  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-24 14:59:12.854110,epoch time: 0:27:14.187505,used: 2:17:52.844999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94105893, 'precision': 0.93609214, 'recall': 0.9073626, 'specificity': 0.9073626, 'f1': 0.9204743, 'auroc': 0.97342145, 'binary_precision': 0.92678344, 'binary_recall': 0.8377387, 'binary_specificity': 0.9769865, 'binary_f1_score': 0.8800143}
confusion matrix:
       0      1
0  41349    974
1   2388  12329
---- Validation: 
scalar performance:
{'acc': 0.95349085, 'precision': 0.6746851, 'recall': 0.73365366, 'specificity': 0.73365366, 'f1': 0.69924533, 'auroc': 0.87311614, 'binary_precision': 0.3673938, 'binary_recall': 0.4976672, 'binary_specificity': 0.9696402, 'binary_f1_score': 0.42272127}
confusion matrix:
       0    1
0  17598  551
1    323  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.72863317, 'recall': 0.7971697, 'specificity': 0.7971697, 'f1': 0.7577096, 'auroc': 0.9089018, 'binary_precision': 0.4738372, 'binary_recall': 0.6245211, 'binary_specificity': 0.96981823, 'binary_f1_score': 0.538843}
confusion matrix:
      0    1
0  5816  181
1    98  163
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_6.png
early stop counter: 1
val acc:0.9534908533096313, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9587727785110474
after epoch: 6,now: 2024-06-24 15:23:41.478780,epoch time: 0:24:28.624670,used: 2:42:21.469669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9437588, 'precision': 0.9371247, 'recall': 0.91371214, 'specificity': 0.91371214, 'f1': 0.9245833, 'auroc': 0.9751824, 'binary_precision': 0.92447823, 'binary_recall': 0.8516204, 'binary_specificity': 0.975804, 'binary_f1_score': 0.88655496}
confusion matrix:
       0      1
0  41297   1024
1   2184  12535
---- Validation: 
scalar performance:
{'acc': 0.95226693, 'precision': 0.67159206, 'recall': 0.73977053, 'specificity': 0.73977053, 'f1': 0.69912726, 'auroc': 0.8761053, 'binary_precision': 0.3607456, 'binary_recall': 0.5116641, 'binary_specificity': 0.96787703, 'binary_f1_score': 0.42315114}
confusion matrix:
       0    1
0  17566  583
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95190156, 'precision': 0.7145918, 'recall': 0.7971677, 'specificity': 0.7971677, 'f1': 0.7480704, 'auroc': 0.9115248, 'binary_precision': 0.4456522, 'binary_recall': 0.62835246, 'binary_specificity': 0.965983, 'binary_f1_score': 0.5214626}
confusion matrix:
      0    1
0  5793  204
1    97  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_7.png
early stop counter: 2
val acc:0.9522669315338135, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9587727785110474
after epoch: 7,now: 2024-06-24 15:46:43.851514,epoch time: 0:23:02.372734,used: 3:05:23.842403,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94440746, 'precision': 0.94196534, 'recall': 0.9105771, 'specificity': 0.9105771, 'f1': 0.9248055, 'auroc': 0.9781239, 'binary_precision': 0.9374195, 'binary_recall': 0.8406713, 'binary_specificity': 0.98048294, 'binary_f1_score': 0.88641334}
confusion matrix:
       0      1
0  41496    826
1   2345  12373
---- Validation: 
scalar performance:
{'acc': 0.9545019, 'precision': 0.67720705, 'recall': 0.72742665, 'specificity': 0.72742665, 'f1': 0.6987221, 'auroc': 0.8782799, 'binary_precision': 0.37290168, 'binary_recall': 0.4836703, 'binary_specificity': 0.971183, 'binary_f1_score': 0.4211239}
confusion matrix:
       0    1
0  17626  523
1    332  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7456981, 'recall': 0.8009196, 'specificity': 0.8009196, 'f1': 0.77009445, 'auroc': 0.91348994, 'binary_precision': 0.50773996, 'binary_recall': 0.62835246, 'binary_specificity': 0.9734867, 'binary_f1_score': 0.56164384}
confusion matrix:
      0    1
0  5838  159
1    97  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_8.png
new oracle model saved
early stop counter: 3
val acc:0.9545019268989563, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.959092378616333
after epoch: 8,now: 2024-06-24 17:01:53.058035,epoch time: 1:15:09.206521,used: 4:20:33.048924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.945845, 'precision': 0.9440341, 'recall': 0.91241515, 'specificity': 0.91241515, 'f1': 0.9267464, 'auroc': 0.9786167, 'binary_precision': 0.9406638, 'binary_recall': 0.84333175, 'binary_specificity': 0.98149854, 'binary_f1_score': 0.88934267}
confusion matrix:
       0      1
0  41538    783
1   2306  12413
---- Validation: 
scalar performance:
{'acc': 0.9543955, 'precision': 0.6765797, 'recall': 0.7266215, 'specificity': 0.7266215, 'f1': 0.69801736, 'auroc': 0.87997687, 'binary_precision': 0.37170264, 'binary_recall': 0.4821151, 'binary_specificity': 0.97112787, 'binary_f1_score': 0.41976982}
confusion matrix:
       0    1
0  17625  524
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7449758, 'recall': 0.8026686, 'specificity': 0.8026686, 'f1': 0.7703182, 'auroc': 0.9149556, 'binary_precision': 0.506135, 'binary_recall': 0.6321839, 'binary_specificity': 0.97315323, 'binary_f1_score': 0.5621806}
confusion matrix:
      0    1
0  5836  161
1    96  165
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_9.png
early stop counter: 4
val acc:0.9543954730033875, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.959092378616333
after epoch: 9,now: 2024-06-24 17:29:15.166391,epoch time: 0:27:22.108356,used: 4:47:55.157280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94740534, 'precision': 0.94602597, 'recall': 0.9146309, 'specificity': 0.9146309, 'f1': 0.9288794, 'auroc': 0.9796369, 'binary_precision': 0.94345623, 'binary_recall': 0.8469117, 'binary_specificity': 0.98235005, 'binary_f1_score': 0.8925809}
confusion matrix:
       0      1
0  41576    747
1   2253  12464
---- Validation: 
scalar performance:
{'acc': 0.9548212, 'precision': 0.6771214, 'recall': 0.72159153, 'specificity': 0.72159153, 'f1': 0.6964979, 'auroc': 0.88154507, 'binary_precision': 0.3731527, 'binary_recall': 0.47122863, 'binary_specificity': 0.9719544, 'binary_f1_score': 0.41649488}
confusion matrix:
       0    1
0  17640  509
1    340  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7563621, 'recall': 0.8020035, 'specificity': 0.8020035, 'f1': 0.77704376, 'auroc': 0.91517794, 'binary_precision': 0.52903223, 'binary_recall': 0.62835246, 'binary_specificity': 0.9756545, 'binary_f1_score': 0.5744308}
confusion matrix:
      0    1
0  5851  146
1    97  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_10.png
new oracle model saved
early stop counter: 5
val acc:0.9548212289810181, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 10,now: 2024-06-24 17:56:16.644765,epoch time: 0:27:01.478374,used: 5:14:56.635654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95120966, 'precision': 0.94549775, 'recall': 0.92540205, 'specificity': 0.92540205, 'f1': 0.9348471, 'auroc': 0.981071, 'binary_precision': 0.93447876, 'binary_recall': 0.87207013, 'binary_specificity': 0.97873396, 'binary_f1_score': 0.9021965}
confusion matrix:
       0      1
0  41421    900
1   1883  12836
---- Validation: 
scalar performance:
{'acc': 0.94673264, 'precision': 0.65916896, 'recall': 0.7609072, 'specificity': 0.7609072, 'f1': 0.69556165, 'auroc': 0.883553, 'binary_precision': 0.33425927, 'binary_recall': 0.5614308, 'binary_specificity': 0.9603835, 'binary_f1_score': 0.41903657}
confusion matrix:
       0    1
0  17430  719
1    282  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94247365, 'precision': 0.690664, 'recall': 0.8307276, 'specificity': 0.8307276, 'f1': 0.7381523, 'auroc': 0.91654956, 'binary_precision': 0.3944563, 'binary_recall': 0.70881224, 'binary_specificity': 0.952643, 'binary_f1_score': 0.50684935}
confusion matrix:
      0    1
0  5713  284
1    76  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_11.png
early stop counter: 6
val acc:0.9467326402664185, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 11,now: 2024-06-24 19:14:59.820613,epoch time: 1:18:43.175848,used: 6:33:39.811502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95462835, 'precision': 0.94951487, 'recall': 0.9305303, 'specificity': 0.9305303, 'f1': 0.9394903, 'auroc': 0.98285556, 'binary_precision': 0.93961143, 'binary_recall': 0.8807421, 'binary_specificity': 0.9803185, 'binary_f1_score': 0.9092248}
confusion matrix:
       0      1
0  41491    833
1   1755  12961
---- Validation: 
scalar performance:
{'acc': 0.95008516, 'precision': 0.6660378, 'recall': 0.7476417, 'specificity': 0.7476417, 'f1': 0.697453, 'auroc': 0.8846948, 'binary_precision': 0.34902763, 'binary_recall': 0.5303266, 'binary_specificity': 0.96495676, 'binary_f1_score': 0.42098764}
confusion matrix:
       0    1
0  17513  636
1    302  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9506232, 'precision': 0.7136651, 'recall': 0.82581806, 'specificity': 0.82581806, 'f1': 0.75601697, 'auroc': 0.9168211, 'binary_precision': 0.44117647, 'binary_recall': 0.6896552, 'binary_specificity': 0.961981, 'binary_f1_score': 0.5381165}
confusion matrix:
      0    1
0  5769  228
1    81  180
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_12.png
early stop counter: 7
val acc:0.9500851631164551, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 12,now: 2024-06-24 19:39:05.316282,epoch time: 0:24:05.495669,used: 6:57:45.307171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95168304, 'precision': 0.9486988, 'recall': 0.92340815, 'specificity': 0.92340815, 'f1': 0.9351138, 'auroc': 0.98285484, 'binary_precision': 0.9430328, 'binary_recall': 0.86498606, 'binary_specificity': 0.98183024, 'binary_f1_score': 0.9023249}
confusion matrix:
       0      1
0  41554    769
1   1987  12730
---- Validation: 
scalar performance:
{'acc': 0.94976586, 'precision': 0.66605586, 'recall': 0.7519767, 'specificity': 0.7519767, 'f1': 0.6987129, 'auroc': 0.8849238, 'binary_precision': 0.3487437, 'binary_recall': 0.53965783, 'binary_specificity': 0.96429557, 'binary_f1_score': 0.42368743}
confusion matrix:
       0    1
0  17501  648
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9503036, 'precision': 0.7128179, 'recall': 0.82748365, 'specificity': 0.82748365, 'f1': 0.7558149, 'auroc': 0.9166684, 'binary_precision': 0.4393204, 'binary_recall': 0.6934866, 'binary_specificity': 0.96148074, 'binary_f1_score': 0.53789}
confusion matrix:
      0    1
0  5766  231
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_13.png
early stop counter: 8
val acc:0.9497658610343933, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 13,now: 2024-06-24 20:02:08.103098,epoch time: 0:23:02.786816,used: 7:20:48.093987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95387447, 'precision': 0.9503341, 'recall': 0.927655, 'specificity': 0.927655, 'f1': 0.93824005, 'auroc': 0.98348844, 'binary_precision': 0.9435555, 'binary_recall': 0.87347966, 'binary_specificity': 0.98183024, 'binary_f1_score': 0.90716624}
confusion matrix:
       0      1
0  41554    769
1   1862  12855
---- Validation: 
scalar performance:
{'acc': 0.94886124, 'precision': 0.6636633, 'recall': 0.75375855, 'specificity': 0.75375855, 'f1': 0.6973406, 'auroc': 0.8855469, 'binary_precision': 0.3438114, 'binary_recall': 0.5443235, 'binary_specificity': 0.96319354, 'binary_f1_score': 0.42143288}
confusion matrix:
       0    1
0  17481  668
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9483861, 'precision': 0.70734745, 'recall': 0.83198017, 'specificity': 0.83198017, 'f1': 0.75262326, 'auroc': 0.91689265, 'binary_precision': 0.427907, 'binary_recall': 0.70498085, 'binary_specificity': 0.9589795, 'binary_f1_score': 0.53256154}
confusion matrix:
      0    1
0  5751  246
1    77  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_14.png
early stop counter: 9
val acc:0.9488612413406372, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 14,now: 2024-06-24 20:25:29.479088,epoch time: 0:23:21.375990,used: 7:44:09.469977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.95662695, 'precision': 0.95232606, 'recall': 0.9330517, 'specificity': 0.9330517, 'f1': 0.9421449, 'auroc': 0.98444366, 'binary_precision': 0.94400114, 'binary_recall': 0.88434356, 'binary_specificity': 0.9817598, 'binary_f1_score': 0.91319907}
confusion matrix:
       0      1
0  41552    772
1   1702  13014
---- Validation: 
scalar performance:
{'acc': 0.9484887, 'precision': 0.6624861, 'recall': 0.75356567, 'specificity': 0.75356567, 'f1': 0.69635624, 'auroc': 0.8861991, 'binary_precision': 0.34146342, 'binary_recall': 0.5443235, 'binary_specificity': 0.9628079, 'binary_f1_score': 0.4196643}
confusion matrix:
       0    1
0  17474  675
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9490253, 'precision': 0.70984465, 'recall': 0.8359783, 'specificity': 0.8359783, 'f1': 0.75568676, 'auroc': 0.91708755, 'binary_precision': 0.43255815, 'binary_recall': 0.7126437, 'binary_specificity': 0.959313, 'binary_f1_score': 0.5383503}
confusion matrix:
      0    1
0  5753  244
1    75  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_15.png
early stop counter: 10
val acc:0.948488712310791, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 15,now: 2024-06-24 20:48:42.438670,epoch time: 0:23:12.959582,used: 8:07:22.429559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9558029, 'precision': 0.9505807, 'recall': 0.9326441, 'specificity': 0.9326441, 'f1': 0.941138, 'auroc': 0.9848589, 'binary_precision': 0.9404289, 'binary_recall': 0.8847826, 'binary_specificity': 0.98050565, 'binary_f1_score': 0.9117575}
confusion matrix:
       0      1
0  41495    825
1   1696  13024
---- Validation: 
scalar performance:
{'acc': 0.94715834, 'precision': 0.6602399, 'recall': 0.7603775, 'specificity': 0.7603775, 'f1': 0.69631636, 'auroc': 0.8870729, 'binary_precision': 0.3364486, 'binary_recall': 0.5598756, 'binary_specificity': 0.9608794, 'binary_f1_score': 0.42031524}
confusion matrix:
       0    1
0  17439  710
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94550973, 'precision': 0.700125, 'recall': 0.8396411, 'specificity': 0.8396411, 'f1': 0.74841225, 'auroc': 0.91719556, 'binary_precision': 0.41266376, 'binary_recall': 0.7241379, 'binary_specificity': 0.9551442, 'binary_f1_score': 0.52573013}
confusion matrix:
      0    1
0  5728  269
1    72  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_16.png
early stop counter: 11
val acc:0.9471583366394043, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 16,now: 2024-06-24 21:13:06.980443,epoch time: 0:24:24.541773,used: 8:31:46.971332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.95596075, 'precision': 0.9499225, 'recall': 0.9337623, 'specificity': 0.9337623, 'f1': 0.9414558, 'auroc': 0.9850576, 'binary_precision': 0.9381192, 'binary_recall': 0.88789237, 'binary_specificity': 0.9796323, 'binary_f1_score': 0.912315}
confusion matrix:
       0      1
0  41460    862
1   1650  13068
---- Validation: 
scalar performance:
{'acc': 0.9468391, 'precision': 0.66019744, 'recall': 0.76396245, 'specificity': 0.76396245, 'f1': 0.69717354, 'auroc': 0.88864195, 'binary_precision': 0.33609575, 'binary_recall': 0.5676516, 'binary_specificity': 0.96027327, 'binary_f1_score': 0.42220935}
confusion matrix:
       0    1
0  17428  721
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9439118, 'precision': 0.69656694, 'recall': 0.8443043, 'specificity': 0.8443043, 'f1': 0.74632764, 'auroc': 0.91805804, 'binary_precision': 0.4050633, 'binary_recall': 0.7356322, 'binary_specificity': 0.95297647, 'binary_f1_score': 0.522449}
confusion matrix:
      0    1
0  5715  282
1    69  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_17.png
early stop counter: 12
val acc:0.9468390941619873, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 17,now: 2024-06-24 21:35:48.262175,epoch time: 0:22:41.281732,used: 8:54:28.253064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.95631135, 'precision': 0.95230937, 'recall': 0.932226, 'specificity': 0.932226, 'f1': 0.9416775, 'auroc': 0.98549217, 'binary_precision': 0.9445818, 'binary_recall': 0.88245684, 'binary_specificity': 0.98199517, 'binary_f1_score': 0.91246307}
confusion matrix:
       0      1
0  41560    762
1   1730  12988
---- Validation: 
scalar performance:
{'acc': 0.94790334, 'precision': 0.66194004, 'recall': 0.758513, 'specificity': 0.758513, 'f1': 0.69722974, 'auroc': 0.88788974, 'binary_precision': 0.34, 'binary_recall': 0.55520993, 'binary_specificity': 0.9618161, 'binary_f1_score': 0.42173657}
confusion matrix:
       0    1
0  17456  693
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94694793, 'precision': 0.7042704, 'recall': 0.84039146, 'specificity': 0.84039146, 'f1': 0.7521365, 'auroc': 0.9178753, 'binary_precision': 0.42093542, 'binary_recall': 0.7241379, 'binary_specificity': 0.956645, 'binary_f1_score': 0.53239435}
confusion matrix:
      0    1
0  5737  260
1    72  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_18.png
early stop counter: 13
val acc:0.9479033350944519, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 18,now: 2024-06-24 21:57:53.465817,epoch time: 0:22:05.203642,used: 9:16:33.456706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9570126, 'precision': 0.9527874, 'recall': 0.9336219, 'specificity': 0.9336219, 'f1': 0.94266737, 'auroc': 0.9863268, 'binary_precision': 0.9446056, 'binary_recall': 0.8852949, 'binary_specificity': 0.9819488, 'binary_f1_score': 0.91398907}
confusion matrix:
       0      1
0  41560    764
1   1688  13028
---- Validation: 
scalar performance:
{'acc': 0.94822264, 'precision': 0.66327596, 'recall': 0.76017845, 'specificity': 0.76017845, 'f1': 0.6987462, 'auroc': 0.8883672, 'binary_precision': 0.34255725, 'binary_recall': 0.55832034, 'binary_specificity': 0.9620365, 'binary_f1_score': 0.42460084}
confusion matrix:
       0    1
0  17460  689
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94630873, 'precision': 0.70320106, 'recall': 0.84555495, 'specificity': 0.84555495, 'f1': 0.7524246, 'auroc': 0.9179909, 'binary_precision': 0.41830066, 'binary_recall': 0.7356322, 'binary_specificity': 0.9554777, 'binary_f1_score': 0.53333336}
confusion matrix:
      0    1
0  5730  267
1    69  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_19.png
early stop counter: 14
val acc:0.9482226371765137, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 19,now: 2024-06-24 22:20:22.125237,epoch time: 0:22:28.659420,used: 9:39:02.116126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9595196, 'precision': 0.95473075, 'recall': 0.9384174, 'specificity': 0.9384174, 'f1': 0.9461856, 'auroc': 0.9866674, 'binary_precision': 0.9453697, 'binary_recall': 0.8948155, 'binary_specificity': 0.98201925, 'binary_f1_score': 0.9193982}
confusion matrix:
       0      1
0  41562    761
1   1548  13169
---- Validation: 
scalar performance:
{'acc': 0.9451894, 'precision': 0.65515375, 'recall': 0.7616083, 'specificity': 0.7616083, 'f1': 0.6923456, 'auroc': 0.8883555, 'binary_precision': 0.32614556, 'binary_recall': 0.5645412, 'binary_specificity': 0.9586754, 'binary_f1_score': 0.41343963}
confusion matrix:
       0    1
0  17399  750
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94183445, 'precision': 0.6911471, 'recall': 0.8432205, 'specificity': 0.8432205, 'f1': 0.7412188, 'auroc': 0.9175309, 'binary_precision': 0.3942505, 'binary_recall': 0.7356322, 'binary_specificity': 0.95080876, 'binary_f1_score': 0.51336896}
confusion matrix:
      0    1
0  5702  295
1    69  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_20.png
early stop counter: 15
val acc:0.9451894164085388, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 20,now: 2024-06-24 22:43:29.085759,epoch time: 0:23:06.960522,used: 10:02:09.076648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9593969, 'precision': 0.95499814, 'recall': 0.937796, 'specificity': 0.937796, 'f1': 0.945966, 'auroc': 0.9867714, 'binary_precision': 0.9464247, 'binary_recall': 0.89317024, 'binary_specificity': 0.98242176, 'binary_f1_score': 0.9190266}
confusion matrix:
       0      1
0  41581    744
1   1572  13143
---- Validation: 
scalar performance:
{'acc': 0.9447105, 'precision': 0.65347123, 'recall': 0.7598603, 'specificity': 0.7598603, 'f1': 0.6904953, 'auroc': 0.88772726, 'binary_precision': 0.32289803, 'binary_recall': 0.5614308, 'binary_specificity': 0.95828974, 'binary_f1_score': 0.40999433}
confusion matrix:
       0    1
0  17392  757
1    282  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9407159, 'precision': 0.68865573, 'recall': 0.8444692, 'specificity': 0.8444692, 'f1': 0.7391786, 'auroc': 0.91721344, 'binary_precision': 0.3891129, 'binary_recall': 0.7394636, 'binary_specificity': 0.94947475, 'binary_f1_score': 0.50990754}
confusion matrix:
      0    1
0  5694  303
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_21.png
early stop counter: 16
val acc:0.9447104930877686, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 21,now: 2024-06-24 23:06:46.466543,epoch time: 0:23:17.380784,used: 10:25:26.457432,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9606592, 'precision': 0.9553099, 'recall': 0.9409075, 'specificity': 0.9409075, 'f1': 0.94780564, 'auroc': 0.9875432, 'binary_precision': 0.94478923, 'binary_recall': 0.90010196, 'binary_specificity': 0.98171294, 'binary_f1_score': 0.9219044}
confusion matrix:
       0      1
0  41551    774
1   1470  13245
---- Validation: 
scalar performance:
{'acc': 0.9430609, 'precision': 0.65004015, 'recall': 0.76275647, 'specificity': 0.76275647, 'f1': 0.688156, 'auroc': 0.8889846, 'binary_precision': 0.31578946, 'binary_recall': 0.56920683, 'binary_specificity': 0.95630616, 'binary_f1_score': 0.4062153}
confusion matrix:
       0    1
0  17356  793
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9387983, 'precision': 0.68436795, 'recall': 0.84530103, 'specificity': 0.84530103, 'f1': 0.73531646, 'auroc': 0.91762996, 'binary_precision': 0.38039216, 'binary_recall': 0.743295, 'binary_specificity': 0.947307, 'binary_f1_score': 0.50324255}
confusion matrix:
      0    1
0  5681  316
1    67  194
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_22.png
early stop counter: 17
val acc:0.9430608749389648, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 22,now: 2024-06-24 23:29:34.724035,epoch time: 0:22:48.257492,used: 10:48:14.714924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.960817, 'precision': 0.9564651, 'recall': 0.9401304, 'specificity': 0.9401304, 'f1': 0.9479103, 'auroc': 0.98684466, 'binary_precision': 0.9479578, 'binary_recall': 0.8973906, 'binary_specificity': 0.9828702, 'binary_f1_score': 0.92198145}
confusion matrix:
       0      1
0  41599    725
1   1510  13206
---- Validation: 
scalar performance:
{'acc': 0.9432737, 'precision': 0.6502156, 'recall': 0.7613666, 'specificity': 0.7613666, 'f1': 0.68800616, 'auroc': 0.8889884, 'binary_precision': 0.31624675, 'binary_recall': 0.5660964, 'binary_specificity': 0.9566367, 'binary_f1_score': 0.40579712}
confusion matrix:
       0    1
0  17362  787
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9400767, 'precision': 0.68771726, 'recall': 0.8478004, 'specificity': 0.8478004, 'f1': 0.73894584, 'auroc': 0.91745496, 'binary_precision': 0.38690478, 'binary_recall': 0.74712646, 'binary_specificity': 0.9484742, 'binary_f1_score': 0.5098039}
confusion matrix:
      0    1
0  5688  309
1    66  195
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_23.png
early stop counter: 18
val acc:0.9432737231254578, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 23,now: 2024-06-24 23:51:52.601089,epoch time: 0:22:17.877054,used: 11:10:32.591978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96002805, 'precision': 0.95602846, 'recall': 0.9384463, 'specificity': 0.9384463, 'f1': 0.94678855, 'auroc': 0.986966, 'binary_precision': 0.94824106, 'binary_recall': 0.893857, 'binary_specificity': 0.9830356, 'binary_f1_score': 0.9202463}
confusion matrix:
       0      1
0  41606    718
1   1562  13154
---- Validation: 
scalar performance:
{'acc': 0.945828, 'precision': 0.6558341, 'recall': 0.75743854, 'specificity': 0.75743854, 'f1': 0.69192284, 'auroc': 0.8884455, 'binary_precision': 0.3278237, 'binary_recall': 0.55520993, 'binary_specificity': 0.9596672, 'binary_f1_score': 0.4122402}
confusion matrix:
       0    1
0  17417  732
1    286  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9443912, 'precision': 0.69786, 'recall': 0.8445544, 'specificity': 0.8445544, 'f1': 0.74752927, 'auroc': 0.9165969, 'binary_precision': 0.40764332, 'binary_recall': 0.7356322, 'binary_specificity': 0.9534767, 'binary_f1_score': 0.5245902}
confusion matrix:
      0    1
0  5718  279
1    69  192
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_24.png
early stop counter: 19
val acc:0.9458280205726624, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 24,now: 2024-06-25 00:14:12.002076,epoch time: 0:22:19.400987,used: 11:32:51.992965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96023846, 'precision': 0.9563372, 'recall': 0.9387023, 'specificity': 0.9387023, 'f1': 0.9470686, 'auroc': 0.9882773, 'binary_precision': 0.948742, 'binary_recall': 0.89420396, 'binary_specificity': 0.9832006, 'binary_f1_score': 0.920666}
confusion matrix:
       0      1
0  41612    711
1   1557  13160
---- Validation: 
scalar performance:
{'acc': 0.94572157, 'precision': 0.655903, 'recall': 0.7588836, 'specificity': 0.7588836, 'f1': 0.69233173, 'auroc': 0.88831145, 'binary_precision': 0.3278539, 'binary_recall': 0.55832034, 'binary_specificity': 0.9594468, 'binary_f1_score': 0.4131185}
confusion matrix:
       0    1
0  17413  736
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.943752, 'precision': 0.6964247, 'recall': 0.8460533, 'specificity': 0.8460533, 'f1': 0.7465745, 'auroc': 0.9167106, 'binary_precision': 0.40461215, 'binary_recall': 0.7394636, 'binary_specificity': 0.952643, 'binary_f1_score': 0.5230352}
confusion matrix:
      0    1
0  5713  284
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_25.png
early stop counter: 20
val acc:0.9457215666770935, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 25,now: 2024-06-25 00:37:12.645914,epoch time: 0:23:00.643838,used: 11:55:52.636803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.95897615, 'precision': 0.95570314, 'recall': 0.93593514, 'specificity': 0.93593514, 'f1': 0.9452529, 'auroc': 0.98803115, 'binary_precision': 0.9493754, 'binary_recall': 0.8883376, 'binary_specificity': 0.9835326, 'binary_f1_score': 0.9178428}
confusion matrix:
       0      1
0  41629    697
1   1643  13071
---- Validation: 
scalar performance:
{'acc': 0.9446573, 'precision': 0.6529535, 'recall': 0.7583326, 'specificity': 0.7583326, 'f1': 0.6896947, 'auroc': 0.8886267, 'binary_precision': 0.3219731, 'binary_recall': 0.55832034, 'binary_specificity': 0.9583448, 'binary_f1_score': 0.40841863}
confusion matrix:
       0    1
0  17393  756
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9435922, 'precision': 0.6962855, 'recall': 0.8478023, 'specificity': 0.8478023, 'f1': 0.746819, 'auroc': 0.9164908, 'binary_precision': 0.40416667, 'binary_recall': 0.743295, 'binary_specificity': 0.9523095, 'binary_f1_score': 0.52361673}
confusion matrix:
      0    1
0  5711  286
1    67  194
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_26.png
early stop counter: 21
val acc:0.9446573257446289, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 26,now: 2024-06-25 00:59:19.652834,epoch time: 0:22:07.006920,used: 12:17:59.643723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9606767, 'precision': 0.95614576, 'recall': 0.94007695, 'specificity': 0.94007695, 'f1': 0.9477359, 'auroc': 0.987615, 'binary_precision': 0.9472816, 'binary_recall': 0.8975195, 'binary_specificity': 0.98263437, 'binary_f1_score': 0.9217294}
confusion matrix:
       0      1
0  41590    735
1   1508  13207
---- Validation: 
scalar performance:
{'acc': 0.9452959, 'precision': 0.6556313, 'recall': 0.7624135, 'specificity': 0.7624135, 'f1': 0.692943, 'auroc': 0.8896847, 'binary_precision': 0.32704404, 'binary_recall': 0.5660964, 'binary_specificity': 0.9587305, 'binary_f1_score': 0.41457862}
confusion matrix:
       0    1
0  17400  749
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.944551, 'precision': 0.6985729, 'recall': 0.8464702, 'specificity': 0.8464702, 'f1': 0.7485769, 'auroc': 0.9169457, 'binary_precision': 0.4088983, 'binary_recall': 0.7394636, 'binary_specificity': 0.9534767, 'binary_f1_score': 0.526603}
confusion matrix:
      0    1
0  5718  279
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_27.png
early stop counter: 22
val acc:0.9452958703041077, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 27,now: 2024-06-25 01:21:30.135107,epoch time: 0:22:10.482273,used: 12:40:10.125996,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96239483, 'precision': 0.95806456, 'recall': 0.94274193, 'specificity': 0.94274193, 'f1': 0.95006335, 'auroc': 0.9884137, 'binary_precision': 0.94957083, 'binary_recall': 0.9021407, 'binary_specificity': 0.9833432, 'binary_f1_score': 0.9252483}
confusion matrix:
       0      1
0  41620    705
1   1440  13275
---- Validation: 
scalar performance:
{'acc': 0.9417837, 'precision': 0.64776266, 'recall': 0.7658456, 'specificity': 0.7658456, 'f1': 0.6867682, 'auroc': 0.8897474, 'binary_precision': 0.3109807, 'binary_recall': 0.5769829, 'binary_specificity': 0.9547083, 'binary_f1_score': 0.40413943}
confusion matrix:
       0    1
0  17327  822
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93783957, 'precision': 0.6831185, 'recall': 0.8502978, 'specificity': 0.8502978, 'f1': 0.73501927, 'auroc': 0.9165324, 'binary_precision': 0.37739465, 'binary_recall': 0.7547893, 'binary_specificity': 0.94580626, 'binary_f1_score': 0.50319284}
confusion matrix:
      0    1
0  5672  325
1    64  197
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_28.png
early stop counter: 23
val acc:0.9417837262153625, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 28,now: 2024-06-25 01:43:35.617273,epoch time: 0:22:05.482166,used: 13:02:15.608162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9623247, 'precision': 0.96010935, 'recall': 0.94048154, 'specificity': 0.94048154, 'f1': 0.9497439, 'auroc': 0.98863894, 'binary_precision': 0.9558216, 'binary_recall': 0.895352, 'binary_specificity': 0.985611, 'binary_f1_score': 0.9245991}
confusion matrix:
       0      1
0  41715    609
1   1540  13176
---- Validation: 
scalar performance:
{'acc': 0.9452959, 'precision': 0.6552646, 'recall': 0.7609134, 'specificity': 0.7609134, 'f1': 0.6922763, 'auroc': 0.8888366, 'binary_precision': 0.3264202, 'binary_recall': 0.562986, 'binary_specificity': 0.9588407, 'binary_f1_score': 0.413242}
confusion matrix:
       0    1
0  17402  747
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9447108, 'precision': 0.699008, 'recall': 0.84655356, 'specificity': 0.84655356, 'f1': 0.7489803, 'auroc': 0.91607046, 'binary_precision': 0.40976647, 'binary_recall': 0.7394636, 'binary_specificity': 0.9536435, 'binary_f1_score': 0.5273224}
confusion matrix:
      0    1
0  5719  278
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_29.png
early stop counter: 24
val acc:0.9452958703041077, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 29,now: 2024-06-25 02:05:50.091715,epoch time: 0:22:14.474442,used: 13:24:30.082604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.961676, 'precision': 0.95829403, 'recall': 0.94058955, 'specificity': 0.94058955, 'f1': 0.94898945, 'auroc': 0.9884485, 'binary_precision': 0.95170826, 'binary_recall': 0.89701086, 'binary_specificity': 0.98416823, 'binary_f1_score': 0.9235504}
confusion matrix:
       0      1
0  41650    670
1   1516  13204
---- Validation: 
scalar performance:
{'acc': 0.94290125, 'precision': 0.6498176, 'recall': 0.7634239, 'specificity': 0.7634239, 'f1': 0.6881034, 'auroc': 0.8889936, 'binary_precision': 0.3152921, 'binary_recall': 0.57076204, 'binary_specificity': 0.95608574, 'binary_f1_score': 0.40619808}
confusion matrix:
       0    1
0  17352  797
1    276  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9403963, 'precision': 0.6884899, 'recall': 0.8479671, 'specificity': 0.8479671, 'f1': 0.7397018, 'auroc': 0.9159554, 'binary_precision': 0.3884462, 'binary_recall': 0.74712646, 'binary_specificity': 0.9488077, 'binary_f1_score': 0.5111402}
confusion matrix:
      0    1
0  5690  307
1    66  195
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_30.png
early stop counter: 25
val acc:0.9429012537002563, best validation acc: 0.9570029973983765, corresponding to test acc:                         0.9587727785110474 / 0.9611697196960449
after epoch: 30,now: 2024-06-25 02:28:11.257463,epoch time: 0:22:21.165748,used: 13:46:51.248352,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_41_19_seed_0_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:46:51.248352 at 2024-06-25 02:28:11.257463
persisted model performance metric: 

scalar performance:
{'acc': 0.9587728, 'precision': 0.7428375, 'recall': 0.76410615, 'specificity': 0.76410615, 'f1': 0.7529593, 'auroc': 0.9057907, 'binary_precision': 0.50526315, 'binary_recall': 0.55172414, 'binary_specificity': 0.97648823, 'binary_f1_score': 0.52747256}
confusion matrix:
      0    1
0  5856  141
1   117  144
oracle model performance metric: 

scalar performance:
{'acc': 0.9611697, 'precision': 0.7563621, 'recall': 0.8020035, 'specificity': 0.8020035, 'f1': 0.77704376, 'auroc': 0.91517794, 'binary_precision': 0.52903223, 'binary_recall': 0.62835246, 'binary_specificity': 0.9756545, 'binary_f1_score': 0.5744308}
confusion matrix:
      0    1
0  5851  146
1    97  164
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191877 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |  17477 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 191877 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |  17477 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189283 KiB | 457564 KiB | 758211 GiB | 758211 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 742655 GiB | 742655 GiB |
|       from small pool |  16469 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 516096 KiB | 516096 KiB | 516096 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  43008 KiB |  43008 KiB |  43008 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39546 KiB |  75256 KiB | 410711 GiB | 410711 GiB |
|       from large pool |  30400 KiB |  70632 KiB | 395108 GiB | 395108 GiB |
|       from small pool |   9146 KiB |   9902 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7613    |  157526 K  |  157523 K  |
|       from large pool |      76    |     158    |   73194 K  |   73194 K  |
|       from small pool |    2890    |    7535    |   84331 K  |   84329 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7613    |  157526 K  |  157523 K  |
|       from large pool |      76    |     158    |   73194 K  |   73194 K  |
|       from small pool |    2890    |    7535    |   84331 K  |   84329 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |      42    |      42    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3584    |   87145 K  |   87145 K  |
|       from large pool |       9    |      19    |   45496 K  |   45496 K  |
|       from small pool |      23    |    3576    |   41649 K  |   41649 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 758211 GiB | 758211 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 742655 GiB | 742655 GiB |
|       from small pool |      0 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 516096 KiB | 516096 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  43008 KiB |  43008 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82786 KiB | 410712 GiB | 410712 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 395108 GiB | 395108 GiB |
|       from small pool |      0 KiB |  20341 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      42    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3584    |   87147 K  |   87147 K  |
|       from large pool |       3    |      19    |   45496 K  |   45496 K  |
|       from small pool |       0    |    3576    |   41650 K  |   41650 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB | 758247 GiB | 758247 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 742663 GiB | 742663 GiB |
|       from small pool |      0 KiB |  38507 KiB |  15584 GiB |  15584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB | 758211 GiB | 758211 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 742655 GiB | 742655 GiB |
|       from small pool |      0 KiB |  37503 KiB |  15556 GiB |  15556 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 516096 KiB | 516096 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  26624 KiB |  43008 KiB |  43008 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  82786 KiB | 410712 GiB | 410712 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 395108 GiB | 395108 GiB |
|       from small pool |      0 KiB |  20341 KiB |  15603 GiB |  15603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  157526 K  |  157526 K  |
|       from large pool |       2    |     158    |   73194 K  |   73194 K  |
|       from small pool |       0    |    7535    |   84331 K  |   84331 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      42    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3584    |   87147 K  |   87147 K  |
|       from large pool |       3    |      19    |   45496 K  |   45496 K  |
|       from small pool |       0    |    3576    |   41650 K  |   41650 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217

 Experiment start at: 2024-06-25 02:35:59.001279
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.78587765, 'precision': 0.72445977, 'recall': 0.64526594, 'specificity': 0.64526594, 'f1': 0.66334224, 'auroc': 0.8197535, 'binary_precision': 0.6384445, 'binary_recall': 0.35980305, 'binary_specificity': 0.9307288, 'binary_f1_score': 0.46023512}
confusion matrix:
       0     1
0  39475  2938
1   9231  5188
---- Validation: 
scalar performance:
{'acc': 0.93127, 'precision': 0.49571997, 'recall': 0.49585482, 'specificity': 0.49585482, 'f1': 0.49578348, 'auroc': 0.76035297, 'binary_precision': 0.02764977, 'binary_recall': 0.026745914, 'binary_specificity': 0.96496373, 'binary_f1_score': 0.027190331}
confusion matrix:
       0    1
0  17434  633
1    655   18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9320013, 'precision': 0.51639664, 'recall': 0.5121232, 'specificity': 0.5121232, 'f1': 0.5134719, 'auroc': 0.8227218, 'binary_precision': 0.07368421, 'binary_recall': 0.053846154, 'binary_specificity': 0.9704003, 'binary_f1_score': 0.062222216}
confusion matrix:
      0    1
0  5770  176
1   246   14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-25 02:58:25.949043,epoch time: 0:22:26.947764,used: 0:22:26.947764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.87888867, 'precision': 0.8727218, 'recall': 0.79386806, 'specificity': 0.79386806, 'f1': 0.82249695, 'auroc': 0.92766726, 'binary_precision': 0.86300576, 'binary_recall': 0.6212636, 'binary_specificity': 0.96647257, 'binary_f1_score': 0.72244847}
confusion matrix:
       0     1
0  40991  1422
1   5461  8958
---- Validation: 
scalar performance:
{'acc': 0.94156885, 'precision': 0.5773464, 'recall': 0.5770144, 'specificity': 0.5770144, 'f1': 0.5771799, 'auroc': 0.82632184, 'binary_precision': 0.18507463, 'binary_recall': 0.18424962, 'binary_specificity': 0.96977913, 'binary_f1_score': 0.1846612}
confusion matrix:
       0    1
0  17521  546
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94263613, 'precision': 0.59539425, 'recall': 0.56548685, 'specificity': 0.56548685, 'f1': 0.57688004, 'auroc': 0.8647876, 'binary_precision': 0.22727273, 'binary_recall': 0.15384616, 'binary_specificity': 0.9771275, 'binary_f1_score': 0.18348625}
confusion matrix:
      0    1
0  5810  136
1   220   40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-25 03:20:09.377151,epoch time: 0:21:43.428108,used: 0:44:10.375872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9083087, 'precision': 0.9061167, 'recall': 0.8448435, 'specificity': 0.8448435, 'f1': 0.86956835, 'auroc': 0.95018363, 'binary_precision': 0.9024476, 'binary_recall': 0.7159997, 'binary_specificity': 0.9736873, 'binary_f1_score': 0.7984841}
confusion matrix:
       0      1
0  41297   1116
1   4095  10324
---- Validation: 
scalar performance:
{'acc': 0.94978654, 'precision': 0.63854146, 'recall': 0.6399282, 'specificity': 0.6399282, 'f1': 0.6392308, 'auroc': 0.8472009, 'binary_precision': 0.30294117, 'binary_recall': 0.3060921, 'binary_specificity': 0.9737643, 'binary_f1_score': 0.3045085}
confusion matrix:
       0    1
0  17593  474
1    467  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9518208, 'precision': 0.6830396, 'recall': 0.6346445, 'specificity': 0.6346445, 'f1': 0.654541, 'auroc': 0.88469434, 'binary_precision': 0.3968254, 'binary_recall': 0.28846154, 'binary_specificity': 0.98082745, 'binary_f1_score': 0.33407572}
confusion matrix:
      0    1
0  5832  114
1   185   75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-25 03:42:53.857122,epoch time: 0:22:44.479971,used: 1:06:54.855843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9207665, 'precision': 0.92086226, 'recall': 0.86513734, 'specificity': 0.86513734, 'f1': 0.8883079, 'auroc': 0.9604403, 'binary_precision': 0.9210258, 'binary_recall': 0.752202, 'binary_specificity': 0.97807276, 'binary_f1_score': 0.828097}
confusion matrix:
       0      1
0  41483    930
1   3573  10846
---- Validation: 
scalar performance:
{'acc': 0.95549625, 'precision': 0.67634165, 'recall': 0.67078483, 'specificity': 0.67078483, 'f1': 0.6735119, 'auroc': 0.8588286, 'binary_precision': 0.37634408, 'binary_recall': 0.3640416, 'binary_specificity': 0.9775281, 'binary_f1_score': 0.37009063}
confusion matrix:
       0    1
0  17661  406
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.7292766, 'recall': 0.66692734, 'specificity': 0.66692734, 'f1': 0.6925055, 'auroc': 0.897247, 'binary_precision': 0.486631, 'binary_recall': 0.35, 'binary_specificity': 0.9838547, 'binary_f1_score': 0.40715885}
confusion matrix:
      0   1
0  5850  96
1   169  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-25 04:05:06.093523,epoch time: 0:22:12.236401,used: 1:29:07.092244,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.92710096, 'precision': 0.9311955, 'recall': 0.8729209, 'specificity': 0.8729209, 'f1': 0.89709413, 'auroc': 0.9659189, 'binary_precision': 0.9381663, 'binary_recall': 0.7629352, 'binary_specificity': 0.9829066, 'binary_f1_score': 0.84152544}
confusion matrix:
       0      1
0  41689    725
1   3418  11000
---- Validation: 
scalar performance:
{'acc': 0.9584312, 'precision': 0.6967487, 'recall': 0.6851818, 'specificity': 0.6851818, 'f1': 0.69076544, 'auroc': 0.8670788, 'binary_precision': 0.41613925, 'binary_recall': 0.3907875, 'binary_specificity': 0.97957605, 'binary_f1_score': 0.40306515}
confusion matrix:
       0    1
0  17698  369
1    410  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7613007, 'recall': 0.7020472, 'specificity': 0.7020472, 'f1': 0.7273916, 'auroc': 0.90618706, 'binary_precision': 0.5477387, 'binary_recall': 0.41923076, 'binary_specificity': 0.98486376, 'binary_f1_score': 0.47494555}
confusion matrix:
      0    1
0  5856   90
1   151  109
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-25 04:27:30.902559,epoch time: 0:22:24.809036,used: 1:51:31.901280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9362859, 'precision': 0.9309894, 'recall': 0.8975133, 'specificity': 0.8975133, 'f1': 0.91257524, 'auroc': 0.9707985, 'binary_precision': 0.9213422, 'binary_recall': 0.81879336, 'binary_specificity': 0.9762331, 'binary_f1_score': 0.8670461}
confusion matrix:
       0      1
0  41404   1008
1   2613  11807
---- Validation: 
scalar performance:
{'acc': 0.95688367, 'precision': 0.6941751, 'recall': 0.71298987, 'specificity': 0.71298987, 'f1': 0.703084, 'auroc': 0.8709557, 'binary_precision': 0.40890688, 'binary_recall': 0.45022288, 'binary_specificity': 0.9757569, 'binary_f1_score': 0.4285714}
confusion matrix:
       0    1
0  17629  438
1    370  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7431338, 'recall': 0.74492157, 'specificity': 0.74492157, 'f1': 0.7440239, 'auroc': 0.9106587, 'binary_precision': 0.50763357, 'binary_recall': 0.51153845, 'binary_specificity': 0.97830474, 'binary_f1_score': 0.5095785}
confusion matrix:
      0    1
0  5817  129
1   127  133
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_6.png
early stop counter: 1
val acc:0.9568836688995361, best validation acc: 0.9584311842918396, corresponding to test acc:                         0.9611666202545166 / 0.9611666202545166
after epoch: 6,now: 2024-06-25 04:49:11.138849,epoch time: 0:21:40.236290,used: 2:13:12.137570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94028014, 'precision': 0.939921, 'recall': 0.89974844, 'specificity': 0.89974844, 'f1': 0.9174994, 'auroc': 0.9750551, 'binary_precision': 0.939278, 'binary_recall': 0.81746304, 'binary_specificity': 0.9820338, 'binary_f1_score': 0.8741471}
confusion matrix:
       0      1
0  41651    762
1   2632  11787
---- Validation: 
scalar performance:
{'acc': 0.9585912, 'precision': 0.7038057, 'recall': 0.7160213, 'specificity': 0.7160213, 'f1': 0.7097108, 'auroc': 0.8763169, 'binary_precision': 0.42797202, 'binary_recall': 0.45468053, 'binary_specificity': 0.97736204, 'binary_f1_score': 0.44092217}
confusion matrix:
       0    1
0  17658  409
1    367  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.75210726, 'recall': 0.75303435, 'specificity': 0.75303435, 'f1': 0.7525698, 'auroc': 0.91441107, 'binary_precision': 0.5249042, 'binary_recall': 0.52692306, 'binary_specificity': 0.97914565, 'binary_f1_score': 0.5259117}
confusion matrix:
      0    1
0  5822  124
1   123  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_7.png
better model found
persisted
after epoch: 7,now: 2024-06-25 05:11:06.334782,epoch time: 0:21:55.195933,used: 2:35:07.333503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94302505, 'precision': 0.9403343, 'recall': 0.9066859, 'specificity': 0.9066859, 'f1': 0.92186356, 'auroc': 0.9774656, 'binary_precision': 0.93542606, 'binary_recall': 0.8329172, 'binary_specificity': 0.98045456, 'binary_f1_score': 0.88120055}
confusion matrix:
       0      1
0  41585    829
1   2409  12009
---- Validation: 
scalar performance:
{'acc': 0.95832443, 'precision': 0.7042168, 'recall': 0.7266119, 'specificity': 0.7266119, 'f1': 0.7147497, 'auroc': 0.8789669, 'binary_precision': 0.428, 'binary_recall': 0.4769688, 'binary_specificity': 0.97625506, 'binary_f1_score': 0.4511595}
confusion matrix:
       0    1
0  17638  429
1    352  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7502899, 'recall': 0.78412896, 'specificity': 0.78412896, 'f1': 0.76597923, 'auroc': 0.91695964, 'binary_precision': 0.5185185, 'binary_recall': 0.5923077, 'binary_specificity': 0.97595024, 'binary_f1_score': 0.55296224}
confusion matrix:
      0    1
0  5803  143
1   106  154
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_8.png
early stop counter: 1
val acc:0.9583244323730469, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 8,now: 2024-06-25 05:32:45.886710,epoch time: 0:21:39.551928,used: 2:56:46.885431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9470897, 'precision': 0.9428977, 'recall': 0.9152102, 'specificity': 0.9152102, 'f1': 0.92794037, 'auroc': 0.9778904, 'binary_precision': 0.9351125, 'binary_recall': 0.85048544, 'binary_specificity': 0.97993493, 'binary_f1_score': 0.8907935}
confusion matrix:
       0      1
0  41561    851
1   2156  12264
---- Validation: 
scalar performance:
{'acc': 0.9568303, 'precision': 0.6995561, 'recall': 0.7422882, 'specificity': 0.7422882, 'f1': 0.71855146, 'auroc': 0.8805406, 'binary_precision': 0.41747573, 'binary_recall': 0.5111441, 'binary_specificity': 0.97343224, 'binary_f1_score': 0.45958582}
confusion matrix:
       0    1
0  17587  480
1    329  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.73861504, 'recall': 0.7975795, 'specificity': 0.7975795, 'f1': 0.7643465, 'auroc': 0.9184164, 'binary_precision': 0.49390244, 'binary_recall': 0.6230769, 'binary_specificity': 0.9720821, 'binary_f1_score': 0.5510204}
confusion matrix:
      0    1
0  5780  166
1    98  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_9.png
early stop counter: 2
val acc:0.9568303227424622, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 9,now: 2024-06-25 05:54:34.315455,epoch time: 0:21:48.428745,used: 3:18:35.314176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94823337, 'precision': 0.9439682, 'recall': 0.91725326, 'specificity': 0.91725326, 'f1': 0.9295764, 'auroc': 0.9789845, 'binary_precision': 0.9360231, 'binary_recall': 0.85435885, 'binary_specificity': 0.9801476, 'binary_f1_score': 0.8933286}
confusion matrix:
       0      1
0  41571    842
1   2100  12319
---- Validation: 
scalar performance:
{'acc': 0.955603, 'precision': 0.6946933, 'recall': 0.74594325, 'specificity': 0.74594325, 'f1': 0.71688724, 'auroc': 0.8817027, 'binary_precision': 0.40745053, 'binary_recall': 0.5200594, 'binary_specificity': 0.9718271, 'binary_f1_score': 0.45691904}
confusion matrix:
       0    1
0  17558  509
1    323  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.7320047, 'recall': 0.80593354, 'specificity': 0.80593354, 'f1': 0.76306486, 'auroc': 0.9192263, 'binary_precision': 0.47988507, 'binary_recall': 0.6423077, 'binary_specificity': 0.9695594, 'binary_f1_score': 0.54934216}
confusion matrix:
      0    1
0  5765  181
1    93  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_10.png
early stop counter: 3
val acc:0.9556030035018921, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 10,now: 2024-06-25 06:16:58.861592,epoch time: 0:22:24.546137,used: 3:40:59.860313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9485501, 'precision': 0.94725907, 'recall': 0.9149071, 'specificity': 0.9149071, 'f1': 0.92958903, 'auroc': 0.9809694, 'binary_precision': 0.94489163, 'binary_recall': 0.84660196, 'binary_specificity': 0.9832123, 'binary_f1_score': 0.89305043}
confusion matrix:
       0      1
0  41700    712
1   2212  12208
---- Validation: 
scalar performance:
{'acc': 0.9576841, 'precision': 0.7007098, 'recall': 0.72556454, 'specificity': 0.72556454, 'f1': 0.7123082, 'auroc': 0.88224375, 'binary_precision': 0.42105263, 'binary_recall': 0.4754829, 'binary_specificity': 0.9756462, 'binary_f1_score': 0.4466155}
confusion matrix:
       0    1
0  17627  440
1    353  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7573133, 'recall': 0.7958356, 'specificity': 0.7958356, 'f1': 0.77503705, 'auroc': 0.91984785, 'binary_precision': 0.53156143, 'binary_recall': 0.61538464, 'binary_specificity': 0.9762866, 'binary_f1_score': 0.57040995}
confusion matrix:
      0    1
0  5805  141
1   100  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_11.png
early stop counter: 4
val acc:0.9576840996742249, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 11,now: 2024-06-25 06:38:58.463466,epoch time: 0:21:59.601874,used: 4:02:59.462187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95118946, 'precision': 0.9480747, 'recall': 0.92120206, 'specificity': 0.92120206, 'f1': 0.93360436, 'auroc': 0.9816739, 'binary_precision': 0.9422712, 'binary_recall': 0.8603232, 'binary_specificity': 0.98208094, 'binary_f1_score': 0.89943445}
confusion matrix:
       0      1
0  41653    760
1   2014  12405
---- Validation: 
scalar performance:
{'acc': 0.95720387, 'precision': 0.7005986, 'recall': 0.7381903, 'specificity': 0.7381903, 'f1': 0.71754915, 'auroc': 0.8841239, 'binary_precision': 0.41987577, 'binary_recall': 0.5022288, 'binary_specificity': 0.9741518, 'binary_f1_score': 0.4573748}
confusion matrix:
       0    1
0  17600  467
1    335  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.75141394, 'recall': 0.8081199, 'specificity': 0.8081199, 'f1': 0.77645975, 'auroc': 0.92078704, 'binary_precision': 0.51863354, 'binary_recall': 0.6423077, 'binary_specificity': 0.973932, 'binary_f1_score': 0.5738832}
confusion matrix:
      0    1
0  5791  155
1    93  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_12.png
early stop counter: 5
val acc:0.9572038650512695, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 12,now: 2024-06-25 07:02:29.445485,epoch time: 0:23:30.982019,used: 4:26:30.444206,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95301944, 'precision': 0.949898, 'recall': 0.9243462, 'specificity': 0.9243462, 'f1': 0.9361909, 'auroc': 0.9825846, 'binary_precision': 0.94405806, 'binary_recall': 0.86613953, 'binary_specificity': 0.98255295, 'binary_f1_score': 0.9034218}
confusion matrix:
       0      1
0  41674    740
1   1930  12488
---- Validation: 
scalar performance:
{'acc': 0.95426893, 'precision': 0.6902008, 'recall': 0.7516888, 'specificity': 0.7516888, 'f1': 0.7160022, 'auroc': 0.88545626, 'binary_precision': 0.39800444, 'binary_recall': 0.53343236, 'binary_specificity': 0.9699452, 'binary_f1_score': 0.455873}
confusion matrix:
       0    1
0  17524  543
1    314  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9540767, 'precision': 0.7262164, 'recall': 0.8215594, 'specificity': 0.8215594, 'f1': 0.7641932, 'auroc': 0.9209546, 'binary_precision': 0.46684352, 'binary_recall': 0.6769231, 'binary_specificity': 0.96619576, 'binary_f1_score': 0.55259025}
confusion matrix:
      0    1
0  5745  201
1    84  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_13.png
early stop counter: 6
val acc:0.9542689323425293, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 13,now: 2024-06-25 07:25:24.401703,epoch time: 0:22:54.956218,used: 4:49:25.400424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95300186, 'precision': 0.9492909, 'recall': 0.92491543, 'specificity': 0.92491543, 'f1': 0.93625295, 'auroc': 0.9826895, 'binary_precision': 0.9423236, 'binary_recall': 0.8678918, 'binary_specificity': 0.9819391, 'binary_f1_score': 0.90357745}
confusion matrix:
       0      1
0  41646    766
1   1905  12515
---- Validation: 
scalar performance:
{'acc': 0.9537887, 'precision': 0.6879426, 'recall': 0.7500092, 'specificity': 0.7500092, 'f1': 0.71388805, 'auroc': 0.885453, 'binary_precision': 0.3936053, 'binary_recall': 0.5304606, 'binary_specificity': 0.96955776, 'binary_f1_score': 0.4518987}
confusion matrix:
       0    1
0  17517  550
1    316  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9537544, 'precision': 0.72480434, 'recall': 0.81955224, 'specificity': 0.81955224, 'f1': 0.76253843, 'auroc': 0.91992486, 'binary_precision': 0.464191, 'binary_recall': 0.6730769, 'binary_specificity': 0.96602756, 'binary_f1_score': 0.5494506}
confusion matrix:
      0    1
0  5744  202
1    85  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_14.png
early stop counter: 7
val acc:0.953788697719574, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 14,now: 2024-06-25 07:50:35.334925,epoch time: 0:25:10.933222,used: 5:14:36.333646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9538992, 'precision': 0.9511328, 'recall': 0.92551666, 'specificity': 0.92551666, 'f1': 0.93739194, 'auroc': 0.9843174, 'binary_precision': 0.9459562, 'binary_recall': 0.8678918, 'binary_specificity': 0.98314154, 'binary_f1_score': 0.90524405}
confusion matrix:
       0      1
0  41697    715
1   1905  12515
---- Validation: 
scalar performance:
{'acc': 0.95400214, 'precision': 0.68852955, 'recall': 0.74868935, 'specificity': 0.74868935, 'f1': 0.7138241, 'auroc': 0.8869376, 'binary_precision': 0.39488322, 'binary_recall': 0.5274888, 'binary_specificity': 0.9698899, 'binary_f1_score': 0.45165393}
confusion matrix:
       0    1
0  17523  544
1    318  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548824, 'precision': 0.72951514, 'recall': 0.8238188, 'specificity': 0.8238188, 'f1': 0.7672932, 'auroc': 0.92034465, 'binary_precision': 0.47326204, 'binary_recall': 0.6807692, 'binary_specificity': 0.96686846, 'binary_f1_score': 0.5583596}
confusion matrix:
      0    1
0  5749  197
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_15.png
early stop counter: 8
val acc:0.9540021419525146, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 15,now: 2024-06-25 08:14:13.649900,epoch time: 0:23:38.314975,used: 5:38:14.648621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9559227, 'precision': 0.9541657, 'recall': 0.9279938, 'specificity': 0.9279938, 'f1': 0.94011503, 'auroc': 0.98497665, 'binary_precision': 0.9508817, 'binary_recall': 0.87128985, 'binary_specificity': 0.9846977, 'binary_f1_score': 0.90934753}
confusion matrix:
       0      1
0  41763    649
1   1856  12564
---- Validation: 
scalar performance:
{'acc': 0.95384204, 'precision': 0.6872871, 'recall': 0.74574524, 'specificity': 0.74574524, 'f1': 0.7119519, 'auroc': 0.8861122, 'binary_precision': 0.39261746, 'binary_recall': 0.5215453, 'binary_specificity': 0.9699452, 'binary_f1_score': 0.4479898}
confusion matrix:
       0    1
0  17524  543
1    322  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95568806, 'precision': 0.732589, 'recall': 0.82240033, 'specificity': 0.82240033, 'f1': 0.7690344, 'auroc': 0.9202159, 'binary_precision': 0.47956404, 'binary_recall': 0.6769231, 'binary_specificity': 0.96787757, 'binary_f1_score': 0.5614035}
confusion matrix:
      0    1
0  5755  191
1    84  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_16.png
early stop counter: 9
val acc:0.953842043876648, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 16,now: 2024-06-25 08:38:03.301071,epoch time: 0:23:49.651171,used: 6:02:04.299792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9548318, 'precision': 0.9520756, 'recall': 0.9270984, 'specificity': 0.9270984, 'f1': 0.9387021, 'auroc': 0.9852264, 'binary_precision': 0.946908, 'binary_recall': 0.8707955, 'binary_specificity': 0.9834013, 'binary_f1_score': 0.9072582}
confusion matrix:
       0      1
0  41709    704
1   1863  12556
---- Validation: 
scalar performance:
{'acc': 0.9512273, 'precision': 0.67897284, 'recall': 0.75297236, 'specificity': 0.75297236, 'f1': 0.7085904, 'auroc': 0.8855916, 'binary_precision': 0.3753878, 'binary_recall': 0.5393759, 'binary_specificity': 0.9665689, 'binary_f1_score': 0.44268292}
confusion matrix:
       0    1
0  17463  604
1    310  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95149857, 'precision': 0.7173364, 'recall': 0.8257309, 'specificity': 0.8257309, 'f1': 0.7588185, 'auroc': 0.91980255, 'binary_precision': 0.44862154, 'binary_recall': 0.68846154, 'binary_specificity': 0.96300036, 'binary_f1_score': 0.5432474}
confusion matrix:
      0    1
0  5726  220
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_17.png
early stop counter: 10
val acc:0.9512273073196411, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 17,now: 2024-06-25 09:01:25.283930,epoch time: 0:23:21.982859,used: 6:25:26.282651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.954603, 'precision': 0.9511701, 'recall': 0.92738426, 'specificity': 0.92738426, 'f1': 0.93847144, 'auroc': 0.9850896, 'binary_precision': 0.94471157, 'binary_recall': 0.87212205, 'binary_specificity': 0.9826464, 'binary_f1_score': 0.9069667}
confusion matrix:
       0      1
0  41676    736
1   1844  12576
---- Validation: 
scalar performance:
{'acc': 0.9521345, 'precision': 0.68095756, 'recall': 0.74700546, 'specificity': 0.74700546, 'f1': 0.708059, 'auroc': 0.8849107, 'binary_precision': 0.37982833, 'binary_recall': 0.52600294, 'binary_specificity': 0.968008, 'binary_f1_score': 0.4411215}
confusion matrix:
       0    1
0  17489  578
1    319  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542378, 'precision': 0.7270062, 'recall': 0.8234825, 'specificity': 0.8234825, 'f1': 0.765369, 'auroc': 0.91935563, 'binary_precision': 0.46825397, 'binary_recall': 0.6807692, 'binary_specificity': 0.96619576, 'binary_f1_score': 0.5548589}
confusion matrix:
      0    1
0  5745  201
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_18.png
early stop counter: 11
val acc:0.9521344900131226, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 18,now: 2024-06-25 09:24:41.363694,epoch time: 0:23:16.079764,used: 6:48:42.362415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9585445, 'precision': 0.95472866, 'recall': 0.93450296, 'specificity': 0.93450296, 'f1': 0.94403696, 'auroc': 0.9859538, 'binary_precision': 0.94746995, 'binary_recall': 0.88569844, 'binary_specificity': 0.9833074, 'binary_f1_score': 0.91554344}
confusion matrix:
       0      1
0  41706    708
1   1648  12770
---- Validation: 
scalar performance:
{'acc': 0.9513874, 'precision': 0.6784589, 'recall': 0.74804854, 'specificity': 0.74804854, 'f1': 0.70664364, 'auroc': 0.88520944, 'binary_precision': 0.37473685, 'binary_recall': 0.5289747, 'binary_specificity': 0.9671224, 'binary_f1_score': 0.43869376}
confusion matrix:
       0    1
0  17473  594
1    317  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9531099, 'precision': 0.7229283, 'recall': 0.82473284, 'specificity': 0.82473284, 'f1': 0.7627487, 'auroc': 0.91899335, 'binary_precision': 0.45994833, 'binary_recall': 0.6846154, 'binary_specificity': 0.9648503, 'binary_f1_score': 0.5502319}
confusion matrix:
      0    1
0  5737  209
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_19.png
early stop counter: 12
val acc:0.9513874053955078, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 19,now: 2024-06-25 09:47:34.543113,epoch time: 0:22:53.179419,used: 7:11:35.541834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9583861, 'precision': 0.9537852, 'recall': 0.9350414, 'specificity': 0.9350414, 'f1': 0.94391394, 'auroc': 0.9861219, 'binary_precision': 0.9449941, 'binary_recall': 0.8876482, 'binary_specificity': 0.98243463, 'binary_f1_score': 0.9154239}
confusion matrix:
       0      1
0  41668    745
1   1620  12799
---- Validation: 
scalar performance:
{'acc': 0.9482391, 'precision': 0.66984135, 'recall': 0.75642943, 'specificity': 0.75642943, 'f1': 0.7028154, 'auroc': 0.88554955, 'binary_precision': 0.35679847, 'binary_recall': 0.5497771, 'binary_specificity': 0.96308184, 'binary_f1_score': 0.43274856}
confusion matrix:
       0    1
0  17400  667
1    303  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9474702, 'precision': 0.7053981, 'recall': 0.83282363, 'specificity': 0.83282363, 'f1': 0.75121945, 'auroc': 0.91882, 'binary_precision': 0.42396313, 'binary_recall': 0.7076923, 'binary_specificity': 0.95795494, 'binary_f1_score': 0.5302594}
confusion matrix:
      0    1
0  5696  250
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_20.png
early stop counter: 13
val acc:0.9482390880584717, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 20,now: 2024-06-25 10:09:54.080059,epoch time: 0:22:19.536946,used: 7:33:55.078780,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.957999, 'precision': 0.9538963, 'recall': 0.9338628, 'specificity': 0.9338628, 'f1': 0.94331026, 'auroc': 0.98522806, 'binary_precision': 0.94608825, 'binary_recall': 0.8848661, 'binary_specificity': 0.98285943, 'binary_f1_score': 0.9144536}
confusion matrix:
       0      1
0  41687    727
1   1660  12758
---- Validation: 
scalar performance:
{'acc': 0.94797224, 'precision': 0.67013466, 'recall': 0.76129794, 'specificity': 0.76129794, 'f1': 0.7044091, 'auroc': 0.8859656, 'binary_precision': 0.35700756, 'binary_recall': 0.5601783, 'binary_specificity': 0.96241766, 'binary_f1_score': 0.43609023}
confusion matrix:
       0    1
0  17388  679
1    296  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9473091, 'precision': 0.7051702, 'recall': 0.8345785, 'specificity': 0.8345785, 'f1': 0.75146675, 'auroc': 0.9185684, 'binary_precision': 0.42334095, 'binary_recall': 0.71153843, 'binary_specificity': 0.9576186, 'binary_f1_score': 0.5308465}
confusion matrix:
      0    1
0  5694  252
1    75  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_21.png
early stop counter: 14
val acc:0.9479722380638123, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 21,now: 2024-06-25 10:32:01.703218,epoch time: 0:22:07.623159,used: 7:56:02.701939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9592659, 'precision': 0.9553324, 'recall': 0.9358598, 'specificity': 0.9358598, 'f1': 0.94506, 'auroc': 0.9871632, 'binary_precision': 0.94783187, 'binary_recall': 0.8883418, 'binary_specificity': 0.98337775, 'binary_f1_score': 0.9171231}
confusion matrix:
       0      1
0  41708    705
1   1610  12809
---- Validation: 
scalar performance:
{'acc': 0.94951975, 'precision': 0.6731086, 'recall': 0.7528021, 'specificity': 0.7528021, 'f1': 0.70423317, 'auroc': 0.8854834, 'binary_precision': 0.36363637, 'binary_recall': 0.5408618, 'binary_specificity': 0.96474236, 'binary_f1_score': 0.4348865}
confusion matrix:
       0    1
0  17430  637
1    309  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9477925, 'precision': 0.7045525, 'recall': 0.8201189, 'specificity': 0.8201189, 'f1': 0.7472559, 'auroc': 0.9177506, 'binary_precision': 0.423445, 'binary_recall': 0.6807692, 'binary_specificity': 0.95946854, 'binary_f1_score': 0.5221239}
confusion matrix:
      0    1
0  5705  241
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_22.png
early stop counter: 15
val acc:0.9495197534561157, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 22,now: 2024-06-25 10:54:05.092572,epoch time: 0:22:03.389354,used: 8:18:06.091293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9596706, 'precision': 0.95452654, 'recall': 0.9378017, 'specificity': 0.9378017, 'f1': 0.94576657, 'auroc': 0.9867104, 'binary_precision': 0.9446359, 'binary_recall': 0.89340454, 'binary_specificity': 0.98219883, 'binary_f1_score': 0.9183063}
confusion matrix:
       0      1
0  41658    755
1   1537  12882
---- Validation: 
scalar performance:
{'acc': 0.946905, 'precision': 0.66613746, 'recall': 0.7578834, 'specificity': 0.7578834, 'f1': 0.7003243, 'auroc': 0.8863081, 'binary_precision': 0.34925094, 'binary_recall': 0.55423474, 'binary_specificity': 0.96153206, 'binary_f1_score': 0.4284894}
confusion matrix:
       0    1
0  17372  695
1    300  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94602, 'precision': 0.70108116, 'recall': 0.8320668, 'specificity': 0.8320668, 'f1': 0.7474302, 'auroc': 0.9177637, 'binary_precision': 0.4153499, 'binary_recall': 0.7076923, 'binary_specificity': 0.9564413, 'binary_f1_score': 0.5234709}
confusion matrix:
      0    1
0  5687  259
1    76  184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_23.png
early stop counter: 16
val acc:0.9469050168991089, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 23,now: 2024-06-25 11:24:05.653831,epoch time: 0:30:00.561259,used: 8:48:06.652552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.95954746, 'precision': 0.9534178, 'recall': 0.9386347, 'specificity': 0.9386347, 'f1': 0.94571394, 'auroc': 0.98704374, 'binary_precision': 0.94156224, 'binary_recall': 0.89617866, 'binary_specificity': 0.9810907, 'binary_f1_score': 0.9183101}
confusion matrix:
       0      1
0  41611    802
1   1497  12922
---- Validation: 
scalar performance:
{'acc': 0.94503736, 'precision': 0.6617855, 'recall': 0.76192164, 'specificity': 0.76192164, 'f1': 0.6978607, 'auroc': 0.88665265, 'binary_precision': 0.34019697, 'binary_recall': 0.56463593, 'binary_specificity': 0.9592074, 'binary_f1_score': 0.424581}
confusion matrix:
       0    1
0  17330  737
1    293  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9423139, 'precision': 0.6911142, 'recall': 0.8319717, 'specificity': 0.8319717, 'f1': 0.73880076, 'auroc': 0.9173808, 'binary_precision': 0.39529914, 'binary_recall': 0.71153843, 'binary_specificity': 0.952405, 'binary_f1_score': 0.5082418}
confusion matrix:
      0    1
0  5663  283
1    75  185
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_24.png
early stop counter: 17
val acc:0.9450373649597168, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 24,now: 2024-06-25 11:52:22.266030,epoch time: 0:28:16.612199,used: 9:16:23.264751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9576471, 'precision': 0.9553765, 'recall': 0.93143356, 'specificity': 0.93143356, 'f1': 0.9425986, 'auroc': 0.98667896, 'binary_precision': 0.9511041, 'binary_recall': 0.87821627, 'binary_specificity': 0.9846509, 'binary_f1_score': 0.91320807}
confusion matrix:
       0      1
0  41762    651
1   1756  12663
---- Validation: 
scalar performance:
{'acc': 0.9483991, 'precision': 0.6703604, 'recall': 0.7565125, 'specificity': 0.7565125, 'f1': 0.7032388, 'auroc': 0.88603336, 'binary_precision': 0.35783365, 'binary_recall': 0.5497771, 'binary_specificity': 0.9632479, 'binary_f1_score': 0.43350908}
confusion matrix:
       0    1
0  17403  664
1    303  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9473091, 'precision': 0.70331216, 'recall': 0.8217056, 'specificity': 0.8217056, 'f1': 0.74667513, 'auroc': 0.91683096, 'binary_precision': 0.4208038, 'binary_recall': 0.6846154, 'binary_specificity': 0.95879585, 'binary_f1_score': 0.52122986}
confusion matrix:
      0    1
0  5701  245
1    82  178
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_25.png
early stop counter: 18
val acc:0.9483991265296936, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 25,now: 2024-06-25 12:14:38.814026,epoch time: 0:22:16.547996,used: 9:38:39.812747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9605328, 'precision': 0.9576936, 'recall': 0.93691087, 'specificity': 0.93691087, 'f1': 0.94669664, 'auroc': 0.98827296, 'binary_precision': 0.9522996, 'binary_recall': 0.8889583, 'binary_specificity': 0.98486346, 'binary_f1_score': 0.91953945}
confusion matrix:
       0      1
0  41772    642
1   1601  12817
---- Validation: 
scalar performance:
{'acc': 0.948666, 'precision': 0.670573, 'recall': 0.7537898, 'specificity': 0.7537898, 'f1': 0.7026157, 'auroc': 0.8854099, 'binary_precision': 0.35847208, 'binary_recall': 0.54383355, 'binary_specificity': 0.9637461, 'binary_f1_score': 0.43211335}
confusion matrix:
       0    1
0  17412  655
1    307  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9476313, 'precision': 0.70404595, 'recall': 0.8200348, 'specificity': 0.8200348, 'f1': 0.7468276, 'auroc': 0.916327, 'binary_precision': 0.42243436, 'binary_recall': 0.6807692, 'binary_specificity': 0.9593004, 'binary_f1_score': 0.521355}
confusion matrix:
      0    1
0  5704  242
1    83  177
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_26.png
early stop counter: 19
val acc:0.948665976524353, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 26,now: 2024-06-25 12:37:05.848673,epoch time: 0:22:27.034647,used: 10:01:06.847394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9604624, 'precision': 0.9570748, 'recall': 0.93735164, 'specificity': 0.93735164, 'f1': 0.9466661, 'auroc': 0.9873538, 'binary_precision': 0.9506182, 'binary_recall': 0.89043, 'binary_specificity': 0.9842733, 'binary_f1_score': 0.9195402}
confusion matrix:
       0      1
0  41745    667
1   1580  12840
---- Validation: 
scalar performance:
{'acc': 0.946905, 'precision': 0.6659687, 'recall': 0.7571682, 'specificity': 0.7571682, 'f1': 0.6999965, 'auroc': 0.88597345, 'binary_precision': 0.34896812, 'binary_recall': 0.55274886, 'binary_specificity': 0.9615874, 'binary_f1_score': 0.4278321}
confusion matrix:
       0    1
0  17373  694
1    301  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9456977, 'precision': 0.6987293, 'recall': 0.8227037, 'specificity': 0.8227037, 'f1': 0.7431731, 'auroc': 0.9162268, 'binary_precision': 0.41149426, 'binary_recall': 0.68846154, 'binary_specificity': 0.95694584, 'binary_f1_score': 0.51510787}
confusion matrix:
      0    1
0  5690  256
1    81  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_27.png
early stop counter: 20
val acc:0.9469050168991089, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 27,now: 2024-06-25 12:59:52.216282,epoch time: 0:22:46.367609,used: 10:23:53.215003,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9619229, 'precision': 0.95693195, 'recall': 0.941485, 'specificity': 0.941485, 'f1': 0.94887114, 'auroc': 0.98823524, 'binary_precision': 0.9472954, 'binary_recall': 0.89999306, 'binary_specificity': 0.9829769, 'binary_f1_score': 0.92303866}
confusion matrix:
       0      1
0  41691    722
1   1442  12977
---- Validation: 
scalar performance:
{'acc': 0.9402881, 'precision': 0.64991, 'recall': 0.7623197, 'specificity': 0.7623197, 'f1': 0.68777823, 'auroc': 0.88596284, 'binary_precision': 0.31630972, 'binary_recall': 0.57057947, 'binary_specificity': 0.9540599, 'binary_f1_score': 0.40699524}
confusion matrix:
       0    1
0  17237  830
1    289  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9358685, 'precision': 0.6769005, 'recall': 0.8359641, 'specificity': 0.8359641, 'f1': 0.72645456, 'auroc': 0.91607606, 'binary_precision': 0.36627907, 'binary_recall': 0.72692305, 'binary_specificity': 0.94500506, 'binary_f1_score': 0.4871134}
confusion matrix:
      0    1
0  5619  327
1    71  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_28.png
early stop counter: 21
val acc:0.9402881264686584, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 28,now: 2024-06-25 13:22:00.019074,epoch time: 0:22:07.802792,used: 10:46:01.017795,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9607264, 'precision': 0.95592976, 'recall': 0.9392414, 'specificity': 0.9392414, 'f1': 0.94719136, 'auroc': 0.9882091, 'binary_precision': 0.9467048, 'binary_recall': 0.8956238, 'binary_specificity': 0.982859, 'binary_f1_score': 0.9204562}
confusion matrix:
       0      1
0  41686    727
1   1505  12914
---- Validation: 
scalar performance:
{'acc': 0.9410352, 'precision': 0.6514056, 'recall': 0.7612766, 'specificity': 0.7612766, 'f1': 0.6888725, 'auroc': 0.88589454, 'binary_precision': 0.319398, 'binary_recall': 0.5676077, 'binary_specificity': 0.9549455, 'binary_f1_score': 0.40877473}
confusion matrix:
       0    1
0  17253  814
1    291  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93683535, 'precision': 0.67906165, 'recall': 0.8364686, 'specificity': 0.8364686, 'f1': 0.728619, 'auroc': 0.9158329, 'binary_precision': 0.37058824, 'binary_recall': 0.72692305, 'binary_specificity': 0.9460141, 'binary_f1_score': 0.49090907}
confusion matrix:
      0    1
0  5625  321
1    71  189
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_29.png
early stop counter: 22
val acc:0.9410352110862732, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 29,now: 2024-06-25 13:44:16.215749,epoch time: 0:22:16.196675,used: 11:08:17.214470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9605856, 'precision': 0.95624626, 'recall': 0.9385326, 'specificity': 0.9385326, 'f1': 0.9469461, 'auroc': 0.9871209, 'binary_precision': 0.94792587, 'binary_recall': 0.89375865, 'binary_specificity': 0.9833066, 'binary_f1_score': 0.9200457}
confusion matrix:
       0      1
0  41704    708
1   1532  12888
---- Validation: 
scalar performance:
{'acc': 0.9431163, 'precision': 0.65628195, 'recall': 0.7602101, 'specificity': 0.7602101, 'f1': 0.6928367, 'auroc': 0.88547397, 'binary_precision': 0.3292789, 'binary_recall': 0.56315005, 'binary_specificity': 0.95727015, 'binary_f1_score': 0.41557017}
confusion matrix:
       0    1
0  17295  772
1    294  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9392523, 'precision': 0.684041, 'recall': 0.83405197, 'specificity': 0.83405197, 'f1': 0.73283637, 'auroc': 0.9150503, 'binary_precision': 0.3808554, 'binary_recall': 0.7192308, 'binary_specificity': 0.94887316, 'binary_f1_score': 0.49800265}
confusion matrix:
      0    1
0  5642  304
1    73  187
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_30.png
early stop counter: 23
val acc:0.943116307258606, best validation acc: 0.9585912227630615, corresponding to test acc:                         0.9601998329162598 / 0.9611666202545166
after epoch: 30,now: 2024-06-25 14:09:45.637443,epoch time: 0:25:29.421694,used: 11:33:46.636164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_02_35_58_seed_1_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:33:46.636164 at 2024-06-25 14:09:45.637443
persisted model performance metric: 

scalar performance:
{'acc': 0.96019983, 'precision': 0.75210726, 'recall': 0.75303435, 'specificity': 0.75303435, 'f1': 0.7525698, 'auroc': 0.91441107, 'binary_precision': 0.5249042, 'binary_recall': 0.52692306, 'binary_specificity': 0.97914565, 'binary_f1_score': 0.5259117}
confusion matrix:
      0    1
0  5822  124
1   123  137
oracle model performance metric: 

scalar performance:
{'acc': 0.9611666, 'precision': 0.7613007, 'recall': 0.7020472, 'specificity': 0.7020472, 'f1': 0.7273916, 'auroc': 0.90618706, 'binary_precision': 0.5477387, 'binary_recall': 0.41923076, 'binary_specificity': 0.98486376, 'binary_f1_score': 0.47494555}
confusion matrix:
      0    1
0  5856   90
1   151  109
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190959 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  17465 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190959 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  17465 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189280 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |  16466 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    792 MiB | 284672 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     54 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40464 KiB |  87618 KiB |    824 TiB |    824 TiB |
|       from large pool |  31306 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |   9158 KiB |  20341 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2942    |    7613    |  314084 K  |  314081 K  |
|       from large pool |      76    |     158    |  145894 K  |  145894 K  |
|       from small pool |    2866    |    7535    |  168189 K  |  168186 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2942    |    7613    |  314084 K  |  314081 K  |
|       from large pool |      76    |     158    |  145894 K  |  145894 K  |
|       from small pool |    2866    |    7535    |  168189 K  |  168186 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      60    |      19    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      21    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3584    |  169218 K  |  169218 K  |
|       from large pool |      10    |      22    |   87846 K  |   87846 K  |
|       from small pool |      22    |    3576    |   81372 K  |   81372 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |    792 MiB | 579584 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  26624 KiB |  43008 KiB |     54 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87618 KiB |    824 TiB |    824 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |      0 KiB |  21236 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  314084 K  |  314084 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168189 K  |  168189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  314084 K  |  314084 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168189 K  |  168189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      60    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      13    |      21    |      27    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3584    |  169220 K  |  169220 K  |
|       from large pool |       3    |      22    |   87846 K  |   87846 K  |
|       from small pool |       0    |    3576    |   81373 K  |   81373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  38507 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   1475 TiB |   1475 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |  37503 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |    792 MiB | 579584 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  26624 KiB |  43008 KiB |     54 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87618 KiB |    824 TiB |    824 TiB |
|       from large pool |  23872 KiB |  79555 KiB |    794 TiB |    794 TiB |
|       from small pool |      0 KiB |  21236 KiB |     30 TiB |     30 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  314084 K  |  314084 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168189 K  |  168189 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  314084 K  |  314084 K  |
|       from large pool |       2    |     158    |  145894 K  |  145894 K  |
|       from small pool |       0    |    7535    |  168189 K  |  168189 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      60    |      37    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      13    |      21    |      27    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3584    |  169220 K  |  169220 K  |
|       from large pool |       3    |      22    |   87846 K  |   87846 K  |
|       from small pool |       0    |    3576    |   81373 K  |   81373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217

 Experiment start at: 2024-06-25 14:19:13.468284
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.87146586, 'precision': 0.8670635, 'recall': 0.78798604, 'specificity': 0.78798604, 'f1': 0.81592876, 'auroc': 0.9206356, 'binary_precision': 0.86002415, 'binary_recall': 0.6115664, 'binary_specificity': 0.9644056, 'binary_f1_score': 0.714821}
confusion matrix:
       0     1
0  40804  1506
1   5877  9253
---- Validation: 
scalar performance:
{'acc': 0.9083791, 'precision': 0.5744671, 'recall': 0.69569635, 'specificity': 0.69569635, 'f1': 0.5990787, 'auroc': 0.8027595, 'binary_precision': 0.16765755, 'binary_recall': 0.46843854, 'binary_specificity': 0.92295414, 'binary_f1_score': 0.24693519}
confusion matrix:
       0     1
0  16771  1400
1    320   282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84260297, 'precision': 0.5185519, 'recall': 0.55924964, 'specificity': 0.55924964, 'f1': 0.51208496, 'auroc': 0.6840533, 'binary_precision': 0.07076566, 'binary_recall': 0.2520661, 'binary_specificity': 0.8664332, 'binary_f1_score': 0.11050725}
confusion matrix:
      0    1
0  5196  801
1   181   61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-25 14:45:58.432493,epoch time: 0:26:44.964209,used: 0:26:44.964209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9093315, 'precision': 0.9066752, 'recall': 0.85354954, 'specificity': 0.85354954, 'f1': 0.8754088, 'auroc': 0.9510722, 'binary_precision': 0.902018, 'binary_recall': 0.7356732, 'binary_specificity': 0.9714259, 'binary_f1_score': 0.81039757}
confusion matrix:
       0      1
0  41102   1209
1   3999  11130
---- Validation: 
scalar performance:
{'acc': 0.93511957, 'precision': 0.6130873, 'recall': 0.71834314, 'specificity': 0.71834314, 'f1': 0.64537805, 'auroc': 0.8360268, 'binary_precision': 0.24376039, 'binary_recall': 0.48671097, 'binary_specificity': 0.94997525, 'binary_f1_score': 0.3248337}
confusion matrix:
       0    1
0  17262  909
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8922904, 'precision': 0.5520473, 'recall': 0.6188025, 'specificity': 0.6188025, 'f1': 0.5653617, 'auroc': 0.78671086, 'binary_precision': 0.1331058, 'binary_recall': 0.32231405, 'binary_specificity': 0.91529095, 'binary_f1_score': 0.1884058}
confusion matrix:
      0    1
0  5489  508
1   164   78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-25 15:14:09.630055,epoch time: 0:28:11.197562,used: 0:54:56.161771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92120475, 'precision': 0.9176698, 'recall': 0.874709, 'specificity': 0.874709, 'f1': 0.8931828, 'auroc': 0.9605264, 'binary_precision': 0.9112559, 'binary_recall': 0.7764558, 'binary_specificity': 0.97296214, 'binary_f1_score': 0.8384725}
confusion matrix:
       0      1
0  41167   1144
1   3382  11747
---- Validation: 
scalar performance:
{'acc': 0.9436957, 'precision': 0.63388896, 'recall': 0.7291976, 'specificity': 0.7291976, 'f1': 0.6667078, 'auroc': 0.85301316, 'binary_precision': 0.28476822, 'binary_recall': 0.5, 'binary_specificity': 0.95839524, 'binary_f1_score': 0.3628692}
confusion matrix:
       0    1
0  17415  756
1    301  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9120051, 'precision': 0.5862327, 'recall': 0.67267793, 'specificity': 0.67267793, 'f1': 0.6101078, 'auroc': 0.8324989, 'binary_precision': 0.19723865, 'binary_recall': 0.41322315, 'binary_specificity': 0.9321327, 'binary_f1_score': 0.26702267}
confusion matrix:
      0    1
0  5590  407
1   142  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-25 16:20:16.993081,epoch time: 1:06:07.363026,used: 2:01:03.524797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9301184, 'precision': 0.92724925, 'recall': 0.8891672, 'specificity': 0.8891672, 'f1': 0.90590036, 'auroc': 0.96597415, 'binary_precision': 0.92194974, 'binary_recall': 0.8026307, 'binary_specificity': 0.9757037, 'binary_f1_score': 0.8581625}
confusion matrix:
       0      1
0  41283   1028
1   2986  12143
---- Validation: 
scalar performance:
{'acc': 0.9459863, 'precision': 0.64240414, 'recall': 0.73921436, 'specificity': 0.73921436, 'f1': 0.6763568, 'auroc': 0.86319077, 'binary_precision': 0.3011583, 'binary_recall': 0.5182724, 'binary_specificity': 0.9601563, 'binary_f1_score': 0.38095236}
confusion matrix:
       0    1
0  17447  724
1    290  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91985893, 'precision': 0.6104581, 'recall': 0.71840084, 'specificity': 0.71840084, 'f1': 0.64177084, 'auroc': 0.85676587, 'binary_precision': 0.242, 'binary_recall': 0.5, 'binary_specificity': 0.93680173, 'binary_f1_score': 0.32614556}
confusion matrix:
      0    1
0  5618  379
1   121  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-25 17:22:25.162820,epoch time: 1:02:08.169739,used: 3:03:11.694536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93541086, 'precision': 0.9308863, 'recall': 0.8996868, 'specificity': 0.8996868, 'f1': 0.9137409, 'auroc': 0.96946657, 'binary_precision': 0.9223373, 'binary_recall': 0.8241904, 'binary_specificity': 0.9751832, 'binary_f1_score': 0.87050617}
confusion matrix:
       0      1
0  41260   1050
1   2660  12470
---- Validation: 
scalar performance:
{'acc': 0.9458265, 'precision': 0.64391416, 'recall': 0.7463592, 'specificity': 0.7463592, 'f1': 0.67932063, 'auroc': 0.8696803, 'binary_precision': 0.3036897, 'binary_recall': 0.5332226, 'binary_specificity': 0.9594959, 'binary_f1_score': 0.38698015}
confusion matrix:
       0    1
0  17435  736
1    281  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9229043, 'precision': 0.62804395, 'recall': 0.76558805, 'specificity': 0.76558805, 'f1': 0.6667164, 'auroc': 0.8705379, 'binary_precision': 0.27324477, 'binary_recall': 0.59504133, 'binary_specificity': 0.93613476, 'binary_f1_score': 0.37451234}
confusion matrix:
      0    1
0  5614  383
1    98  144
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_5.png
new oracle model saved
early stop counter: 1
val acc:0.9458264708518982, best validation acc: 0.945986270904541, corresponding to test acc:                         0.9198589324951172 / 0.9229043126106262
after epoch: 5,now: 2024-06-25 17:52:24.070520,epoch time: 0:29:58.907700,used: 3:33:10.602236,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9362813, 'precision': 0.93493676, 'recall': 0.89806974, 'specificity': 0.89806974, 'f1': 0.91438615, 'auroc': 0.97186226, 'binary_precision': 0.93243855, 'binary_recall': 0.8173166, 'binary_specificity': 0.97882295, 'binary_f1_score': 0.8710904}
confusion matrix:
       0      1
0  41414    896
1   2764  12366
---- Validation: 
scalar performance:
{'acc': 0.95408297, 'precision': 0.6645496, 'recall': 0.7281389, 'specificity': 0.7281389, 'f1': 0.69040835, 'auroc': 0.87219656, 'binary_precision': 0.3463357, 'binary_recall': 0.48671097, 'binary_specificity': 0.9695669, 'binary_f1_score': 0.40469617}
confusion matrix:
       0    1
0  17618  553
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94326013, 'precision': 0.6621865, 'recall': 0.73652184, 'specificity': 0.73652184, 'f1': 0.69107604, 'auroc': 0.8768889, 'binary_precision': 0.34444445, 'binary_recall': 0.5123967, 'binary_specificity': 0.960647, 'binary_f1_score': 0.41196012}
confusion matrix:
      0    1
0  5761  236
1   118  124
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-25 18:31:54.079067,epoch time: 0:39:30.008547,used: 4:12:40.610783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.941835, 'precision': 0.9341501, 'recall': 0.9137493, 'specificity': 0.9137493, 'f1': 0.9232855, 'auroc': 0.9755491, 'binary_precision': 0.9190899, 'binary_recall': 0.8543953, 'binary_specificity': 0.9731033, 'binary_f1_score': 0.88556266}
confusion matrix:
       0      1
0  41172   1138
1   2203  12927
---- Validation: 
scalar performance:
{'acc': 0.9462526, 'precision': 0.64612836, 'recall': 0.7505946, 'specificity': 0.7505946, 'f1': 0.6822085, 'auroc': 0.8762585, 'binary_precision': 0.30783758, 'binary_recall': 0.5415282, 'binary_specificity': 0.959661, 'binary_f1_score': 0.39253458}
confusion matrix:
       0    1
0  17438  733
1    276  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92867446, 'precision': 0.64441, 'recall': 0.79436517, 'specificity': 0.79436517, 'f1': 0.68786484, 'auroc': 0.88326466, 'binary_precision': 0.30367506, 'binary_recall': 0.6487603, 'binary_specificity': 0.93996996, 'binary_f1_score': 0.41370222}
confusion matrix:
      0    1
0  5637  360
1    85  157
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_7.png
early stop counter: 1
val acc:0.9462525844573975, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.943260133266449
after epoch: 7,now: 2024-06-25 19:05:48.836830,epoch time: 0:33:54.757763,used: 4:46:35.368546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94395894, 'precision': 0.93733853, 'recall': 0.91614634, 'specificity': 0.91614634, 'f1': 0.9260333, 'auroc': 0.977085, 'binary_precision': 0.9243925, 'binary_recall': 0.8573695, 'binary_specificity': 0.9749232, 'binary_f1_score': 0.8896204}
confusion matrix:
       0      1
0  41249   1061
1   2158  12972
---- Validation: 
scalar performance:
{'acc': 0.94721144, 'precision': 0.6492099, 'recall': 0.75269604, 'specificity': 0.75269604, 'f1': 0.6853474, 'auroc': 0.879177, 'binary_precision': 0.3138756, 'binary_recall': 0.54485047, 'binary_specificity': 0.96054155, 'binary_f1_score': 0.39829993}
confusion matrix:
       0    1
0  17454  717
1    274  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.930117, 'precision': 0.64757085, 'recall': 0.7970983, 'specificity': 0.7970983, 'f1': 0.6915152, 'auroc': 0.8887329, 'binary_precision': 0.30980393, 'binary_recall': 0.6528926, 'binary_specificity': 0.94130397, 'binary_f1_score': 0.42021278}
confusion matrix:
      0    1
0  5645  352
1    84  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_8.png
early stop counter: 2
val acc:0.9472114443778992, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.943260133266449
after epoch: 8,now: 2024-06-25 19:41:54.152491,epoch time: 0:36:05.315661,used: 5:22:40.684207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94385445, 'precision': 0.9427838, 'recall': 0.9104072, 'specificity': 0.9104072, 'f1': 0.924991, 'auroc': 0.9782717, 'binary_precision': 0.9407627, 'binary_recall': 0.8397224, 'binary_specificity': 0.9810919, 'binary_f1_score': 0.8873756}
confusion matrix:
       0      1
0  41510    800
1   2425  12705
---- Validation: 
scalar performance:
{'acc': 0.95333725, 'precision': 0.6640074, 'recall': 0.7365872, 'specificity': 0.7365872, 'f1': 0.692706, 'auroc': 0.88044906, 'binary_precision': 0.3446712, 'binary_recall': 0.50498337, 'binary_specificity': 0.9681911, 'binary_f1_score': 0.4097035}
confusion matrix:
       0    1
0  17593  578
1    298  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9471069, 'precision': 0.6842984, 'recall': 0.7841259, 'specificity': 0.7841259, 'f1': 0.7216576, 'auroc': 0.8914381, 'binary_precision': 0.38481677, 'binary_recall': 0.607438, 'binary_specificity': 0.96081376, 'binary_f1_score': 0.47115386}
confusion matrix:
      0    1
0  5762  235
1    95  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_9.png
new oracle model saved
early stop counter: 3
val acc:0.9533372521400452, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 9,now: 2024-06-25 20:10:33.049821,epoch time: 0:28:38.897330,used: 5:51:19.581537,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94801533, 'precision': 0.9454911, 'recall': 0.9186875, 'specificity': 0.9186875, 'f1': 0.93099046, 'auroc': 0.97916627, 'binary_precision': 0.9406386, 'binary_recall': 0.8567085, 'binary_specificity': 0.9806665, 'binary_f1_score': 0.896714}
confusion matrix:
       0      1
0  41492    818
1   2168  12962
---- Validation: 
scalar performance:
{'acc': 0.9514196, 'precision': 0.65990996, 'recall': 0.7460363, 'specificity': 0.7460363, 'f1': 0.69237864, 'auroc': 0.8823849, 'binary_precision': 0.3358051, 'binary_recall': 0.52657807, 'binary_specificity': 0.96549445, 'binary_f1_score': 0.41009057}
confusion matrix:
       0    1
0  17544  627
1    285  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9418176, 'precision': 0.67353916, 'recall': 0.8031846, 'specificity': 0.8031846, 'f1': 0.71731246, 'auroc': 0.89443135, 'binary_precision': 0.36155605, 'binary_recall': 0.6528926, 'binary_specificity': 0.9534767, 'binary_f1_score': 0.46539026}
confusion matrix:
      0    1
0  5718  279
1    84  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_10.png
early stop counter: 4
val acc:0.9514195919036865, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 10,now: 2024-06-25 20:34:26.346386,epoch time: 0:23:53.296565,used: 6:15:12.878102,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9483461, 'precision': 0.94356465, 'recall': 0.9214978, 'specificity': 0.9214978, 'f1': 0.9317775, 'auroc': 0.98058605, 'binary_precision': 0.93423307, 'binary_recall': 0.864763, 'binary_specificity': 0.9782326, 'binary_f1_score': 0.89815676}
confusion matrix:
       0      1
0  41390    921
1   2046  13083
---- Validation: 
scalar performance:
{'acc': 0.9475843, 'precision': 0.6520857, 'recall': 0.7601161, 'specificity': 0.7601161, 'f1': 0.6895476, 'auroc': 0.8843864, 'binary_precision': 0.31912878, 'binary_recall': 0.5598007, 'binary_specificity': 0.96043146, 'binary_f1_score': 0.40651387}
confusion matrix:
       0    1
0  17452  719
1    265  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93236095, 'precision': 0.6563256, 'recall': 0.81809294, 'specificity': 0.81809294, 'f1': 0.7036325, 'auroc': 0.89690644, 'binary_precision': 0.3255814, 'binary_recall': 0.6942149, 'binary_specificity': 0.941971, 'binary_f1_score': 0.4432718}
confusion matrix:
      0    1
0  5649  348
1    74  168
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_11.png
early stop counter: 5
val acc:0.9475842714309692, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 11,now: 2024-06-25 20:59:40.323193,epoch time: 0:25:13.976807,used: 6:40:26.854909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9501567, 'precision': 0.9463768, 'recall': 0.9234741, 'specificity': 0.9234741, 'f1': 0.934121, 'auroc': 0.9824277, 'binary_precision': 0.9390165, 'binary_recall': 0.8670853, 'binary_specificity': 0.9798629, 'binary_f1_score': 0.9016185}
confusion matrix:
       0      1
0  41458    852
1   2011  13119
---- Validation: 
scalar performance:
{'acc': 0.9504075, 'precision': 0.6582022, 'recall': 0.75193787, 'specificity': 0.75193787, 'f1': 0.69262296, 'auroc': 0.8856655, 'binary_precision': 0.3319714, 'binary_recall': 0.5398671, 'binary_specificity': 0.96400857, 'binary_f1_score': 0.4111322}
confusion matrix:
       0    1
0  17517  654
1    277  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9418176, 'precision': 0.67472804, 'recall': 0.8091329, 'specificity': 0.8091329, 'f1': 0.71964604, 'auroc': 0.8980792, 'binary_precision': 0.36343116, 'binary_recall': 0.6652893, 'binary_specificity': 0.95297647, 'binary_f1_score': 0.47007304}
confusion matrix:
      0    1
0  5715  282
1    81  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_12.png
early stop counter: 6
val acc:0.9504075050354004, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 12,now: 2024-06-25 21:25:37.996510,epoch time: 0:25:57.673317,used: 7:06:24.528226,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95114905, 'precision': 0.9490409, 'recall': 0.92344284, 'specificity': 0.92344284, 'f1': 0.9352484, 'auroc': 0.9821552, 'binary_precision': 0.94497, 'binary_recall': 0.8648952, 'binary_specificity': 0.9819905, 'binary_f1_score': 0.90316117}
confusion matrix:
       0      1
0  41549    762
1   2044  13085
---- Validation: 
scalar performance:
{'acc': 0.9507804, 'precision': 0.659004, 'recall': 0.7505244, 'specificity': 0.7505244, 'f1': 0.6928906, 'auroc': 0.8866431, 'binary_precision': 0.33367768, 'binary_recall': 0.53654486, 'binary_specificity': 0.9645039, 'binary_f1_score': 0.41146496}
confusion matrix:
       0    1
0  17526  645
1    279  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9435807, 'precision': 0.67936826, 'recall': 0.81005, 'specificity': 0.81005, 'f1': 0.7239622, 'auroc': 0.89955175, 'binary_precision': 0.3726852, 'binary_recall': 0.6652893, 'binary_specificity': 0.95481074, 'binary_f1_score': 0.47774482}
confusion matrix:
      0    1
0  5726  271
1    81  161
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_13.png
early stop counter: 7
val acc:0.9507803916931152, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 13,now: 2024-06-25 21:48:03.613728,epoch time: 0:22:25.617218,used: 7:28:50.145444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95214134, 'precision': 0.9459567, 'recall': 0.9292582, 'specificity': 0.9292582, 'f1': 0.9371755, 'auroc': 0.9830303, 'binary_precision': 0.93366027, 'binary_recall': 0.8808989, 'binary_specificity': 0.97761756, 'binary_f1_score': 0.9065125}
confusion matrix:
       0      1
0  41363    947
1   1802  13328
---- Validation: 
scalar performance:
{'acc': 0.94795716, 'precision': 0.65490764, 'recall': 0.7675361, 'specificity': 0.7675361, 'f1': 0.6936938, 'auroc': 0.8878312, 'binary_precision': 0.32427368, 'binary_recall': 0.57475084, 'binary_specificity': 0.96032137, 'binary_f1_score': 0.41461957}
confusion matrix:
       0    1
0  17450  721
1    256  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9350858, 'precision': 0.6631158, 'recall': 0.8254585, 'specificity': 0.8254585, 'f1': 0.7116537, 'auroc': 0.900185, 'binary_precision': 0.33861387, 'binary_recall': 0.7066116, 'binary_specificity': 0.9443055, 'binary_f1_score': 0.45783135}
confusion matrix:
      0    1
0  5663  334
1    71  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_14.png
early stop counter: 8
val acc:0.9479571580886841, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 14,now: 2024-06-25 22:10:51.480729,epoch time: 0:22:47.867001,used: 7:51:38.012445,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9528029, 'precision': 0.9502907, 'recall': 0.9265613, 'specificity': 0.9265613, 'f1': 0.9375732, 'auroc': 0.9844301, 'binary_precision': 0.9454089, 'binary_recall': 0.8711085, 'binary_specificity': 0.9820141, 'binary_f1_score': 0.9067391}
confusion matrix:
       0      1
0  41550    761
1   1950  13179
---- Validation: 
scalar performance:
{'acc': 0.9503542, 'precision': 0.66018057, 'recall': 0.76074386, 'specificity': 0.76074386, 'f1': 0.69651103, 'auroc': 0.8879682, 'binary_precision': 0.33532935, 'binary_recall': 0.55813956, 'binary_specificity': 0.9633482, 'binary_f1_score': 0.41895264}
confusion matrix:
       0    1
0  17505  666
1    266  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94245875, 'precision': 0.6782922, 'recall': 0.81938004, 'specificity': 0.81938004, 'f1': 0.7250029, 'auroc': 0.90085816, 'binary_precision': 0.36971048, 'binary_recall': 0.6859504, 'binary_specificity': 0.95280975, 'binary_f1_score': 0.4804631}
confusion matrix:
      0    1
0  5714  283
1    76  166
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_15.png
early stop counter: 9
val acc:0.9503542184829712, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 15,now: 2024-06-25 22:34:42.172019,epoch time: 0:23:50.691290,used: 8:15:28.703735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.95665044, 'precision': 0.9509982, 'recall': 0.9361191, 'specificity': 0.9361191, 'f1': 0.9432198, 'auroc': 0.98466647, 'binary_precision': 0.9396828, 'binary_recall': 0.8927297, 'binary_specificity': 0.9795084, 'binary_f1_score': 0.9156047}
confusion matrix:
       0      1
0  41443    867
1   1623  13507
---- Validation: 
scalar performance:
{'acc': 0.9434294, 'precision': 0.6468117, 'recall': 0.78125817, 'specificity': 0.78125817, 'f1': 0.68916106, 'auroc': 0.8890735, 'binary_precision': 0.30704698, 'binary_recall': 0.6079734, 'binary_specificity': 0.95454293, 'binary_f1_score': 0.40802675}
confusion matrix:
       0    1
0  17345  826
1    236  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92691135, 'precision': 0.6488152, 'recall': 0.82715464, 'specificity': 0.82715464, 'f1': 0.6968873, 'auroc': 0.9018339, 'binary_precision': 0.30960855, 'binary_recall': 0.71900827, 'binary_specificity': 0.935301, 'binary_f1_score': 0.43283582}
confusion matrix:
      0    1
0  5609  388
1    68  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_16.png
early stop counter: 10
val acc:0.9434294104576111, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 16,now: 2024-06-25 22:57:06.267012,epoch time: 0:22:24.094993,used: 8:37:52.798728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9543524, 'precision': 0.9502689, 'recall': 0.93069166, 'specificity': 0.93069166, 'f1': 0.93989646, 'auroc': 0.98386157, 'binary_precision': 0.94222474, 'binary_recall': 0.8806927, 'binary_specificity': 0.9806906, 'binary_f1_score': 0.91042024}
confusion matrix:
       0      1
0  41494    817
1   1805  13324
---- Validation: 
scalar performance:
{'acc': 0.9468918, 'precision': 0.6526899, 'recall': 0.770198, 'specificity': 0.770198, 'f1': 0.69234073, 'auroc': 0.88928753, 'binary_precision': 0.3196347, 'binary_recall': 0.5813953, 'binary_specificity': 0.9590006, 'binary_f1_score': 0.4124926}
confusion matrix:
       0    1
0  17426  745
1    252  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93652827, 'precision': 0.66659427, 'recall': 0.82819164, 'specificity': 0.82819164, 'f1': 0.71556413, 'auroc': 0.9018938, 'binary_precision': 0.34538153, 'binary_recall': 0.7107438, 'binary_specificity': 0.9456395, 'binary_f1_score': 0.46486488}
confusion matrix:
      0    1
0  5671  326
1    70  172
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_17.png
early stop counter: 11
val acc:0.9468917846679688, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 17,now: 2024-06-25 23:18:56.490315,epoch time: 0:21:50.223303,used: 8:59:43.022031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9562848, 'precision': 0.9517678, 'recall': 0.9343211, 'specificity': 0.9343211, 'f1': 0.9425814, 'auroc': 0.9848595, 'binary_precision': 0.942803, 'binary_recall': 0.8879048, 'binary_specificity': 0.9807374, 'binary_f1_score': 0.9145308}
confusion matrix:
       0      1
0  41495    815
1   1696  13434
---- Validation: 
scalar performance:
{'acc': 0.9459863, 'precision': 0.65081936, 'recall': 0.7721393, 'specificity': 0.7721393, 'f1': 0.6910808, 'auroc': 0.88960266, 'binary_precision': 0.3157424, 'binary_recall': 0.58637875, 'binary_specificity': 0.9578999, 'binary_f1_score': 0.4104651}
confusion matrix:
       0    1
0  17406  765
1    249  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93652827, 'precision': 0.6661976, 'recall': 0.82620895, 'specificity': 0.82620895, 'f1': 0.71484196, 'auroc': 0.9027289, 'binary_precision': 0.34475806, 'binary_recall': 0.7066116, 'binary_specificity': 0.94580626, 'binary_f1_score': 0.4634146}
confusion matrix:
      0    1
0  5672  325
1    71  171
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_18.png
early stop counter: 12
val acc:0.945986270904541, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 18,now: 2024-06-25 23:41:58.283511,epoch time: 0:23:01.793196,used: 9:22:44.815227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9571901, 'precision': 0.9541247, 'recall': 0.93432, 'specificity': 0.93432, 'f1': 0.94363165, 'auroc': 0.98650783, 'binary_precision': 0.94808686, 'binary_recall': 0.8859881, 'binary_specificity': 0.9826518, 'binary_f1_score': 0.91598624}
confusion matrix:
       0      1
0  41576    734
1   1725  13405
---- Validation: 
scalar performance:
{'acc': 0.94998133, 'precision': 0.65997046, 'recall': 0.7645665, 'specificity': 0.7645665, 'f1': 0.6972951, 'auroc': 0.89036196, 'binary_precision': 0.3346418, 'binary_recall': 0.5664452, 'binary_specificity': 0.9626878, 'binary_f1_score': 0.42072794}
confusion matrix:
       0    1
0  17493  678
1    261  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9416573, 'precision': 0.6766295, 'recall': 0.820946, 'specificity': 0.820946, 'f1': 0.7238051, 'auroc': 0.90296215, 'binary_precision': 0.36622807, 'binary_recall': 0.69008267, 'binary_specificity': 0.9518092, 'binary_f1_score': 0.47851005}
confusion matrix:
      0    1
0  5708  289
1    75  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_19.png
early stop counter: 13
val acc:0.9499813318252563, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 19,now: 2024-06-26 00:03:26.176671,epoch time: 0:21:27.893160,used: 9:44:12.708387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9575035, 'precision': 0.9541477, 'recall': 0.93512714, 'specificity': 0.93512714, 'f1': 0.9440919, 'auroc': 0.98607326, 'binary_precision': 0.9475206, 'binary_recall': 0.8878387, 'binary_specificity': 0.9824155, 'binary_f1_score': 0.9167093}
confusion matrix:
       0      1
0  41566    744
1   1697  13433
---- Validation: 
scalar performance:
{'acc': 0.94806373, 'precision': 0.6555954, 'recall': 0.7691972, 'specificity': 0.7691972, 'f1': 0.6946697, 'auroc': 0.8904338, 'binary_precision': 0.3255379, 'binary_recall': 0.5780731, 'binary_specificity': 0.96032137, 'binary_f1_score': 0.41651708}
confusion matrix:
       0    1
0  17450  721
1    254  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9392531, 'precision': 0.6715623, 'recall': 0.8236608, 'specificity': 0.8236608, 'f1': 0.7195918, 'auroc': 0.9029453, 'binary_precision': 0.35578948, 'binary_recall': 0.6983471, 'binary_specificity': 0.9489745, 'binary_f1_score': 0.4714087}
confusion matrix:
      0    1
0  5691  306
1    73  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_20.png
early stop counter: 14
val acc:0.9480637311935425, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 20,now: 2024-06-26 00:24:47.054446,epoch time: 0:21:20.877775,used: 10:05:33.586162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9588092, 'precision': 0.9545629, 'recall': 0.93817556, 'specificity': 0.93817556, 'f1': 0.9459634, 'auroc': 0.9862269, 'binary_precision': 0.94610274, 'binary_recall': 0.89457333, 'binary_specificity': 0.9817778, 'binary_f1_score': 0.91961676}
confusion matrix:
       0      1
0  41540    771
1   1595  13534
---- Validation: 
scalar performance:
{'acc': 0.9462526, 'precision': 0.6524823, 'recall': 0.77629215, 'specificity': 0.77629215, 'f1': 0.6934523, 'auroc': 0.8912835, 'binary_precision': 0.31878895, 'binary_recall': 0.59468436, 'binary_specificity': 0.9578999, 'binary_f1_score': 0.41507244}
confusion matrix:
       0    1
0  17406  765
1    244  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.936368, 'precision': 0.6666421, 'recall': 0.830091, 'specificity': 0.830091, 'f1': 0.7159246, 'auroc': 0.9035572, 'binary_precision': 0.34530938, 'binary_recall': 0.71487606, 'binary_specificity': 0.945306, 'binary_f1_score': 0.46567968}
confusion matrix:
      0    1
0  5669  328
1    69  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_21.png
early stop counter: 15
val acc:0.9462525844573975, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 21,now: 2024-06-26 00:46:14.210618,epoch time: 0:21:27.156172,used: 10:27:00.742334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.95685935, 'precision': 0.95258904, 'recall': 0.9350083, 'specificity': 0.9350083, 'f1': 0.94332963, 'auroc': 0.9860126, 'binary_precision': 0.94411683, 'binary_recall': 0.8888301, 'binary_specificity': 0.9811865, 'binary_f1_score': 0.91563964}
confusion matrix:
       0      1
0  41514    796
1   1682  13448
---- Validation: 
scalar performance:
{'acc': 0.94838333, 'precision': 0.65613574, 'recall': 0.7677562, 'specificity': 0.7677562, 'f1': 0.6948068, 'auroc': 0.8907368, 'binary_precision': 0.32672334, 'binary_recall': 0.57475084, 'binary_specificity': 0.96076167, 'binary_f1_score': 0.4166165}
confusion matrix:
       0    1
0  17458  713
1    256  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9403751, 'precision': 0.6734634, 'recall': 0.82027894, 'specificity': 0.82027894, 'f1': 0.7207437, 'auroc': 0.90298265, 'binary_precision': 0.3599138, 'binary_recall': 0.69008267, 'binary_specificity': 0.9504752, 'binary_f1_score': 0.47308782}
confusion matrix:
      0    1
0  5700  297
1    75  167
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_22.png
early stop counter: 16
val acc:0.9483833312988281, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 22,now: 2024-06-26 01:07:39.883253,epoch time: 0:21:25.672635,used: 10:48:26.414969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.957399, 'precision': 0.9535705, 'recall': 0.93543833, 'specificity': 0.93543833, 'f1': 0.9440073, 'auroc': 0.9870386, 'binary_precision': 0.94598776, 'binary_recall': 0.88902843, 'binary_specificity': 0.98184824, 'binary_f1_score': 0.91662407}
confusion matrix:
       0      1
0  41542    768
1   1679  13451
---- Validation: 
scalar performance:
{'acc': 0.94769084, 'precision': 0.6543418, 'recall': 0.7682016, 'specificity': 0.7682016, 'f1': 0.6933523, 'auroc': 0.89088273, 'binary_precision': 0.32309124, 'binary_recall': 0.57641196, 'binary_specificity': 0.9599912, 'binary_f1_score': 0.41408113}
confusion matrix:
       0    1
0  17444  727
1    255  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94021475, 'precision': 0.67384475, 'recall': 0.82416105, 'specificity': 0.82416105, 'f1': 0.721844, 'auroc': 0.90290326, 'binary_precision': 0.36034116, 'binary_recall': 0.6983471, 'binary_specificity': 0.949975, 'binary_f1_score': 0.4753868}
confusion matrix:
      0    1
0  5697  300
1    73  169
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_23.png
early stop counter: 17
val acc:0.9476908445358276, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 23,now: 2024-06-26 01:29:42.286637,epoch time: 0:22:02.403384,used: 11:10:28.818353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.95927924, 'precision': 0.9559895, 'recall': 0.9379672, 'specificity': 0.9379672, 'f1': 0.9464905, 'auroc': 0.9872566, 'binary_precision': 0.9494694, 'binary_recall': 0.89292794, 'binary_specificity': 0.98300636, 'binary_f1_score': 0.92033106}
confusion matrix:
       0      1
0  41591    719
1   1620  13510
---- Validation: 
scalar performance:
{'acc': 0.94822353, 'precision': 0.6554813, 'recall': 0.7668706, 'specificity': 0.7668706, 'f1': 0.69403756, 'auroc': 0.890919, 'binary_precision': 0.3254717, 'binary_recall': 0.5730897, 'binary_specificity': 0.9606516, 'binary_f1_score': 0.41516244}
confusion matrix:
       0    1
0  17456  715
1    257  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94069564, 'precision': 0.67538583, 'recall': 0.82639396, 'specificity': 0.82639396, 'f1': 0.723716, 'auroc': 0.9034172, 'binary_precision': 0.36324787, 'binary_recall': 0.70247936, 'binary_specificity': 0.9503085, 'binary_f1_score': 0.47887325}
confusion matrix:
      0    1
0  5699  298
1    72  170
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_24.png
early stop counter: 18
val acc:0.9482235312461853, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 24,now: 2024-06-26 01:51:24.524055,epoch time: 0:21:42.237418,used: 11:32:11.055771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9587222, 'precision': 0.9535465, 'recall': 0.93900824, 'specificity': 0.93900824, 'f1': 0.9459562, 'auroc': 0.98713374, 'binary_precision': 0.9431708, 'binary_recall': 0.8973495, 'binary_specificity': 0.980667, 'binary_f1_score': 0.9196898}
confusion matrix:
       0      1
0  41493    818
1   1553  13576
---- Validation: 
scalar performance:
{'acc': 0.943749, 'precision': 0.64777946, 'recall': 0.7822263, 'specificity': 0.7822263, 'f1': 0.69026124, 'auroc': 0.892004, 'binary_precision': 0.30892256, 'binary_recall': 0.6096346, 'binary_specificity': 0.9548181, 'binary_f1_score': 0.41005588}
confusion matrix:
       0    1
0  17350  821
1    235  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9331624, 'precision': 0.66120565, 'recall': 0.83437175, 'specificity': 0.83437175, 'f1': 0.71106184, 'auroc': 0.90412974, 'binary_precision': 0.33396584, 'binary_recall': 0.72727275, 'binary_specificity': 0.94147074, 'binary_f1_score': 0.45773733}
confusion matrix:
      0    1
0  5646  351
1    66  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_25.png
early stop counter: 19
val acc:0.9437490105628967, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 25,now: 2024-06-26 02:13:26.835886,epoch time: 0:22:02.311831,used: 11:54:13.367602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9606372, 'precision': 0.9567296, 'recall': 0.9408208, 'specificity': 0.9408208, 'f1': 0.9483948, 'auroc': 0.9874264, 'binary_precision': 0.9489291, 'binary_recall': 0.8989425, 'binary_specificity': 0.9826991, 'binary_f1_score': 0.9232597}
confusion matrix:
       0      1
0  41578    732
1   1529  13601
---- Validation: 
scalar performance:
{'acc': 0.9456667, 'precision': 0.65035903, 'recall': 0.7735803, 'specificity': 0.7735803, 'f1': 0.6909629, 'auroc': 0.8918731, 'binary_precision': 0.3147163, 'binary_recall': 0.589701, 'binary_specificity': 0.9574597, 'binary_f1_score': 0.41040465}
confusion matrix:
       0    1
0  17398  773
1    247  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93716943, 'precision': 0.66916275, 'recall': 0.8344734, 'specificity': 0.8344734, 'f1': 0.7191483, 'auroc': 0.9037923, 'binary_precision': 0.35, 'binary_recall': 0.7231405, 'binary_specificity': 0.94580626, 'binary_f1_score': 0.4716981}
confusion matrix:
      0    1
0  5672  325
1    67  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_26.png
early stop counter: 20
val acc:0.9456666707992554, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 26,now: 2024-06-26 02:35:56.788866,epoch time: 0:22:29.952980,used: 12:16:43.320582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96128136, 'precision': 0.95607686, 'recall': 0.9432266, 'specificity': 0.9432266, 'f1': 0.949402, 'auroc': 0.9886146, 'binary_precision': 0.9455801, 'binary_recall': 0.9050767, 'binary_specificity': 0.98137647, 'binary_f1_score': 0.9248852}
confusion matrix:
       0      1
0  41524    788
1   1436  13692
---- Validation: 
scalar performance:
{'acc': 0.9454003, 'precision': 0.65004605, 'recall': 0.77504885, 'specificity': 0.77504885, 'f1': 0.6909775, 'auroc': 0.891959, 'binary_precision': 0.31398416, 'binary_recall': 0.59302324, 'binary_specificity': 0.95707446, 'binary_f1_score': 0.41058078}
confusion matrix:
       0    1
0  17391  780
1    245  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9368489, 'precision': 0.66846347, 'recall': 0.8343066, 'specificity': 0.8343066, 'f1': 0.7184262, 'auroc': 0.9040891, 'binary_precision': 0.34860557, 'binary_recall': 0.7231405, 'binary_specificity': 0.9454727, 'binary_f1_score': 0.4704301}
confusion matrix:
      0    1
0  5670  327
1    67  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_27.png
early stop counter: 21
val acc:0.9454002976417542, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 27,now: 2024-06-26 02:58:13.318708,epoch time: 0:22:16.529842,used: 12:38:59.850424,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96108985, 'precision': 0.95714885, 'recall': 0.94159514, 'specificity': 0.94159514, 'f1': 0.9490086, 'auroc': 0.98805904, 'binary_precision': 0.9492718, 'binary_recall': 0.9003966, 'binary_specificity': 0.9827937, 'binary_f1_score': 0.92418844}
confusion matrix:
       0      1
0  41582    728
1   1507  13623
---- Validation: 
scalar performance:
{'acc': 0.94635916, 'precision': 0.65238893, 'recall': 0.7747411, 'specificity': 0.7747411, 'f1': 0.6930435, 'auroc': 0.8920779, 'binary_precision': 0.31871083, 'binary_recall': 0.5913621, 'binary_specificity': 0.9581201, 'binary_f1_score': 0.4141943}
confusion matrix:
       0    1
0  17410  761
1    246  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93652827, 'precision': 0.6677698, 'recall': 0.8341398, 'specificity': 0.8341398, 'f1': 0.7177075, 'auroc': 0.9034014, 'binary_precision': 0.3472222, 'binary_recall': 0.7231405, 'binary_specificity': 0.9451392, 'binary_f1_score': 0.4691689}
confusion matrix:
      0    1
0  5668  329
1    67  175
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_28.png
early stop counter: 22
val acc:0.9463591575622559, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 28,now: 2024-06-26 03:20:43.727173,epoch time: 0:22:30.408465,used: 13:01:30.258889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96081126, 'precision': 0.95665455, 'recall': 0.9413636, 'specificity': 0.9413636, 'f1': 0.9486572, 'auroc': 0.98869634, 'binary_precision': 0.94833946, 'binary_recall': 0.9002644, 'binary_specificity': 0.98246276, 'binary_f1_score': 0.9236768}
confusion matrix:
       0      1
0  41568    742
1   1509  13621
---- Validation: 
scalar performance:
{'acc': 0.9454003, 'precision': 0.65099484, 'recall': 0.77906406, 'specificity': 0.77906406, 'f1': 0.6926586, 'auroc': 0.89289767, 'binary_precision': 0.31560594, 'binary_recall': 0.6013289, 'binary_specificity': 0.95679927, 'binary_f1_score': 0.41395083}
confusion matrix:
       0    1
0  17386  785
1    240  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93524605, 'precision': 0.66544205, 'recall': 0.83545566, 'specificity': 0.83545566, 'f1': 0.7155717, 'auroc': 0.9042352, 'binary_precision': 0.34241244, 'binary_recall': 0.72727275, 'binary_specificity': 0.9436385, 'binary_f1_score': 0.46560845}
confusion matrix:
      0    1
0  5659  338
1    66  176
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_29.png
early stop counter: 23
val acc:0.9454002976417542, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 29,now: 2024-06-26 03:43:53.487080,epoch time: 0:23:09.759907,used: 13:24:40.018796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96089834, 'precision': 0.95798266, 'recall': 0.9402338, 'specificity': 0.9402338, 'f1': 0.94863766, 'auroc': 0.9883394, 'binary_precision': 0.95219713, 'binary_recall': 0.8965631, 'binary_specificity': 0.98390454, 'binary_f1_score': 0.92354304}
confusion matrix:
       0      1
0  41629    681
1   1565  13565
---- Validation: 
scalar performance:
{'acc': 0.94763756, 'precision': 0.6557103, 'recall': 0.7745985, 'specificity': 0.7745985, 'f1': 0.6959782, 'auroc': 0.8924011, 'binary_precision': 0.32538956, 'binary_recall': 0.589701, 'binary_specificity': 0.9594959, 'binary_f1_score': 0.4193739}
confusion matrix:
       0    1
0  17435  736
1    247  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94053537, 'precision': 0.6761198, 'recall': 0.83225876, 'specificity': 0.83225876, 'f1': 0.72551066, 'auroc': 0.90378726, 'binary_precision': 0.36421052, 'binary_recall': 0.71487606, 'binary_specificity': 0.94964147, 'binary_f1_score': 0.48256624}
confusion matrix:
      0    1
0  5695  302
1    69  173
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21556217_30.png
early stop counter: 24
val acc:0.9476375579833984, best validation acc: 0.9540829658508301, corresponding to test acc:                         0.943260133266449 / 0.9471068978309631
after epoch: 30,now: 2024-06-26 04:07:20.236828,epoch time: 0:23:26.749748,used: 13:48:06.768544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_25_14_19_13_seed_2_21556217
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:48:06.768544 at 2024-06-26 04:07:20.236828
persisted model performance metric: 

scalar performance:
{'acc': 0.94326013, 'precision': 0.6621865, 'recall': 0.73652184, 'specificity': 0.73652184, 'f1': 0.69107604, 'auroc': 0.8768889, 'binary_precision': 0.34444445, 'binary_recall': 0.5123967, 'binary_specificity': 0.960647, 'binary_f1_score': 0.41196012}
confusion matrix:
      0    1
0  5761  236
1   118  124
oracle model performance metric: 

scalar performance:
{'acc': 0.9471069, 'precision': 0.6842984, 'recall': 0.7841259, 'specificity': 0.7841259, 'f1': 0.7216576, 'auroc': 0.8914381, 'binary_precision': 0.38481677, 'binary_recall': 0.607438, 'binary_specificity': 0.96081376, 'binary_f1_score': 0.47115386}
confusion matrix:
      0    1
0  5762  235
1    95  147
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_dial_irm_lr1e5_bs16_classbalancing10/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190965 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190965 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 173494 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  17471 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189282 KiB | 457564 KiB |   2216 TiB |   2216 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   2171 TiB |   2171 TiB |
|       from small pool |  16468 KiB |  37503 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1080 MiB | 579584 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1014 MiB | 550912 KiB |
|       from small pool |  38912 KiB |  43008 KiB |     66 MiB |  28672 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40458 KiB |  87618 KiB |   1251 TiB |   1251 TiB |
|       from large pool |  31306 KiB |  79555 KiB |   1205 TiB |   1205 TiB |
|       from small pool |   9152 KiB |  21236 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7663    |  471823 K  |  471820 K  |
|       from large pool |      76    |     158    |  219127 K  |  219126 K  |
|       from small pool |    2878    |    7585    |  252696 K  |  252693 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7663    |  471823 K  |  471820 K  |
|       from large pool |      76    |     158    |  219127 K  |  219126 K  |
|       from small pool |    2878    |    7585    |  252696 K  |  252693 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      42    |      78    |      37    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      21    |      33    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3611    |  249513 K  |  249513 K  |
|       from large pool |      10    |      22    |  130502 K  |  130502 K  |
|       from small pool |      25    |    3601    |  119010 K  |  119010 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 461403 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  17088 KiB | 428048 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  38507 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457564 KiB |   2216 TiB |   2216 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   2171 TiB |   2171 TiB |
|       from small pool |      0 KiB |  37503 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB |   1080 MiB |    854 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1014 MiB |    814 MiB |
|       from small pool |  26624 KiB |  43008 KiB |     66 MiB |     40 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  87618 KiB |   1251 TiB |   1251 TiB |
|       from large pool |  23872 KiB |  79555 KiB |   1205 TiB |   1205 TiB |
|       from small pool |      0 KiB |  21236 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7663    |  471823 K  |  471823 K  |
|       from large pool |       2    |     158    |  219127 K  |  219127 K  |
|       from small pool |       0    |    7585    |  252696 K  |  252696 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7663    |  471823 K  |  471823 K  |
|       from large pool |       2    |     158    |  219127 K  |  219127 K  |
|       from small pool |       0    |    7585    |  252696 K  |  252696 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      42    |      78    |      55    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      13    |      21    |      33    |      20    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3611    |  249514 K  |  249514 K  |
|       from large pool |       3    |      22    |  130502 K  |  130502 K  |
|       from small pool |       0    |    3601    |  119011 K  |  119011 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jun 26 04:08:46 2024]
Finished job 0.
1 of 1 steps (100%) done
