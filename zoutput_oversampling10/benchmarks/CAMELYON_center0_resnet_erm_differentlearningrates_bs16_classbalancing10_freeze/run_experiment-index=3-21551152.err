Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun 23 13:13:25 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152

 Experiment start at: 2024-06-23 13:18:01.078580
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.84330297, 'precision': 0.890784, 'recall': 0.70316064, 'specificity': 0.70316064, 'f1': 0.74024916, 'auroc': 0.93172896, 'binary_precision': 0.95198625, 'binary_recall': 0.4135752, 'binary_specificity': 0.9927461, 'binary_f1_score': 0.5766389}
confusion matrix:
       0     1
0  42015   307
1   8631  6087
---- Validation: 
scalar performance:
{'acc': 0.9620051, 'precision': 0.5082428, 'recall': 0.5010442, 'specificity': 0.5010442, 'f1': 0.49585536, 'auroc': 0.5331491, 'binary_precision': 0.050632913, 'binary_recall': 0.00622084, 'binary_specificity': 0.99586755, 'binary_f1_score': 0.011080332}
confusion matrix:
       0   1
0  18074  75
1    639   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542985, 'precision': 0.55085975, 'recall': 0.5070773, 'specificity': 0.5070773, 'f1': 0.5051898, 'auroc': 0.66867596, 'binary_precision': 0.14285715, 'binary_recall': 0.019157087, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.033783786}
confusion matrix:
      0   1
0  5967  30
1   256   5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-23 13:42:54.721681,epoch time: 0:24:53.643101,used: 0:24:53.643101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9144635, 'precision': 0.91939914, 'recall': 0.8526859, 'specificity': 0.8526859, 'f1': 0.87919784, 'auroc': 0.96245104, 'binary_precision': 0.927671, 'binary_recall': 0.7250306, 'binary_specificity': 0.9803412, 'binary_f1_score': 0.8139278}
confusion matrix:
       0      1
0  41490    832
1   4047  10671
---- Validation: 
scalar performance:
{'acc': 0.94423157, 'precision': 0.56173664, 'recall': 0.5563473, 'specificity': 0.5563473, 'f1': 0.5588769, 'auroc': 0.6817222, 'binary_precision': 0.15384616, 'binary_recall': 0.1399689, 'binary_specificity': 0.97272575, 'binary_f1_score': 0.1465798}
confusion matrix:
       0    1
0  17654  495
1    553   90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9439118, 'precision': 0.61928445, 'recall': 0.5914423, 'specificity': 0.5914423, 'f1': 0.6030912, 'auroc': 0.74409175, 'binary_precision': 0.27272728, 'binary_recall': 0.20689656, 'binary_specificity': 0.975988, 'binary_f1_score': 0.23529412}
confusion matrix:
      0    1
0  5853  144
1   207   54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_2.png
early stop counter: 1
val acc:0.9442315697669983, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9542984962463379
after epoch: 2,now: 2024-06-23 14:02:49.737495,epoch time: 0:19:55.015814,used: 0:44:48.658915,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9332398, 'precision': 0.93498313, 'recall': 0.8877115, 'specificity': 0.8877115, 'f1': 0.90801036, 'auroc': 0.9738641, 'binary_precision': 0.9380773, 'binary_recall': 0.79364, 'binary_specificity': 0.981783, 'binary_f1_score': 0.8598351}
confusion matrix:
       0      1
0  41552    771
1   3037  11680
---- Validation: 
scalar performance:
{'acc': 0.94753087, 'precision': 0.6102, 'recall': 0.6158097, 'specificity': 0.6158097, 'f1': 0.6129204, 'auroc': 0.7018392, 'binary_precision': 0.24667652, 'binary_recall': 0.25972006, 'binary_specificity': 0.9718993, 'binary_f1_score': 0.2530303}
confusion matrix:
       0    1
0  17639  510
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9493448, 'precision': 0.67154086, 'recall': 0.6455824, 'specificity': 0.6455824, 'f1': 0.6573082, 'auroc': 0.76975715, 'binary_precision': 0.37272727, 'binary_recall': 0.31417623, 'binary_specificity': 0.9769885, 'binary_f1_score': 0.34095633}
confusion matrix:
      0    1
0  5859  138
1   179   82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_3.png
early stop counter: 2
val acc:0.9475308656692505, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9542984962463379
after epoch: 3,now: 2024-06-23 14:19:30.486379,epoch time: 0:16:40.748884,used: 1:01:29.407799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9410238, 'precision': 0.9423059, 'recall': 0.90138376, 'specificity': 0.90138376, 'f1': 0.9193812, 'auroc': 0.976231, 'binary_precision': 0.94462717, 'binary_recall': 0.81947273, 'binary_specificity': 0.9832947, 'binary_f1_score': 0.8776104}
confusion matrix:
       0      1
0  41615    707
1   2657  12061
---- Validation: 
scalar performance:
{'acc': 0.95003194, 'precision': 0.6262551, 'recall': 0.6306055, 'specificity': 0.6306055, 'f1': 0.62838644, 'auroc': 0.70448303, 'binary_precision': 0.2777778, 'binary_recall': 0.28771386, 'binary_specificity': 0.97349715, 'binary_f1_score': 0.28265852}
confusion matrix:
       0    1
0  17668  481
1    458  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9498242, 'precision': 0.6772045, 'recall': 0.6549942, 'specificity': 0.6549942, 'f1': 0.66522586, 'auroc': 0.7671907, 'binary_precision': 0.38325992, 'binary_recall': 0.33333334, 'binary_specificity': 0.976655, 'binary_f1_score': 0.3565574}
confusion matrix:
      0    1
0  5857  140
1   174   87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_4.png
early stop counter: 3
val acc:0.9500319361686707, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9542984962463379
after epoch: 4,now: 2024-06-23 14:35:35.901951,epoch time: 0:16:05.415572,used: 1:17:34.823371,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9504032, 'precision': 0.9455785, 'recall': 0.9230912, 'specificity': 0.9230912, 'f1': 0.9335828, 'auroc': 0.9825115, 'binary_precision': 0.9363436, 'binary_recall': 0.8666667, 'binary_specificity': 0.9795157, 'binary_f1_score': 0.9001588}
confusion matrix:
       0      1
0  41458    867
1   1962  12753
---- Validation: 
scalar performance:
{'acc': 0.94364625, 'precision': 0.6200496, 'recall': 0.66180205, 'specificity': 0.66180205, 'f1': 0.6371911, 'auroc': 0.75147986, 'binary_precision': 0.26309794, 'binary_recall': 0.3592535, 'binary_specificity': 0.96435064, 'binary_f1_score': 0.30374753}
confusion matrix:
       0    1
0  17502  647
1    412  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94519013, 'precision': 0.6678281, 'recall': 0.68922293, 'specificity': 0.68922293, 'f1': 0.6777599, 'auroc': 0.79109097, 'binary_precision': 0.3614865, 'binary_recall': 0.4099617, 'binary_specificity': 0.9684842, 'binary_f1_score': 0.3842011}
confusion matrix:
      0    1
0  5808  189
1   154  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_5.png
early stop counter: 4
val acc:0.943646252155304, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9542984962463379
after epoch: 5,now: 2024-06-23 14:51:39.539324,epoch time: 0:16:03.637373,used: 1:33:38.460744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95264727, 'precision': 0.95223224, 'recall': 0.92254645, 'specificity': 0.92254645, 'f1': 0.9361144, 'auroc': 0.9843067, 'binary_precision': 0.9514541, 'binary_recall': 0.8603561, 'binary_specificity': 0.9847368, 'binary_f1_score': 0.9036149}
confusion matrix:
       0      1
0  41678    646
1   2055  12661
---- Validation: 
scalar performance:
{'acc': 0.94971263, 'precision': 0.6446757, 'recall': 0.67844373, 'specificity': 0.67844373, 'f1': 0.6594834, 'auroc': 0.77289623, 'binary_precision': 0.31125, 'binary_recall': 0.38724726, 'binary_specificity': 0.9696402, 'binary_f1_score': 0.34511432}
confusion matrix:
       0    1
0  17598  551
1    394  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.7311455, 'recall': 0.69014585, 'specificity': 0.69014585, 'f1': 0.7083646, 'auroc': 0.8164307, 'binary_precision': 0.48826292, 'binary_recall': 0.39846742, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.43881857}
confusion matrix:
      0    1
0  5888  109
1   157  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_6.png
new oracle model saved
early stop counter: 5
val acc:0.9497126340866089, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9574943780899048
after epoch: 6,now: 2024-06-23 15:07:57.879424,epoch time: 0:16:18.340100,used: 1:49:56.800844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95546985, 'precision': 0.9544012, 'recall': 0.92791426, 'specificity': 0.92791426, 'f1': 0.94014513, 'auroc': 0.985288, 'binary_precision': 0.95237744, 'binary_recall': 0.8709743, 'binary_specificity': 0.9848542, 'binary_f1_score': 0.90985876}
confusion matrix:
       0      1
0  41681    641
1   1899  12819
---- Validation: 
scalar performance:
{'acc': 0.9532248, 'precision': 0.6527274, 'recall': 0.6630107, 'specificity': 0.6630107, 'f1': 0.657674, 'auroc': 0.7554325, 'binary_precision': 0.32848838, 'binary_recall': 0.35147744, 'binary_specificity': 0.97454405, 'binary_f1_score': 0.33959427}
confusion matrix:
       0    1
0  17687  462
1    417  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.73192686, 'recall': 0.6847322, 'specificity': 0.6847322, 'f1': 0.7052773, 'auroc': 0.79664034, 'binary_precision': 0.49029127, 'binary_recall': 0.38697317, 'binary_specificity': 0.98249125, 'binary_f1_score': 0.4325482}
confusion matrix:
      0    1
0  5892  105
1   160  101
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_7.png
new oracle model saved
early stop counter: 6
val acc:0.953224778175354, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9576541781425476
after epoch: 7,now: 2024-06-23 15:24:10.587992,epoch time: 0:16:12.708568,used: 2:06:09.509412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9588359, 'precision': 0.9533932, 'recall': 0.93795323, 'specificity': 0.93795323, 'f1': 0.9453235, 'auroc': 0.98692393, 'binary_precision': 0.94272625, 'binary_recall': 0.89480835, 'binary_specificity': 0.9810982, 'binary_f1_score': 0.9181425}
confusion matrix:
       0      1
0  41524    800
1   1548  13168
---- Validation: 
scalar performance:
{'acc': 0.94662625, 'precision': 0.6439055, 'recall': 0.706098, 'specificity': 0.706098, 'f1': 0.6684653, 'auroc': 0.7875109, 'binary_precision': 0.30769232, 'binary_recall': 0.44790047, 'binary_specificity': 0.96429557, 'binary_f1_score': 0.36478785}
confusion matrix:
       0    1
0  17501  648
1    355  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495046, 'precision': 0.6927359, 'recall': 0.72079146, 'specificity': 0.72079146, 'f1': 0.7056439, 'auroc': 0.82845765, 'binary_precision': 0.40863788, 'binary_recall': 0.47126436, 'binary_specificity': 0.9703185, 'binary_f1_score': 0.4377224}
confusion matrix:
      0    1
0  5819  178
1   138  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_8.png
early stop counter: 7
val acc:0.9466262459754944, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9576541781425476
after epoch: 8,now: 2024-06-23 15:41:50.297181,epoch time: 0:17:39.709189,used: 2:23:49.218601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9611676, 'precision': 0.96269786, 'recall': 0.93498504, 'specificity': 0.93498504, 'f1': 0.9477601, 'auroc': 0.9881034, 'binary_precision': 0.96558917, 'binary_recall': 0.8808861, 'binary_specificity': 0.98908395, 'binary_f1_score': 0.92129487}
confusion matrix:
       0      1
0  41861    462
1   1753  12964
---- Validation: 
scalar performance:
{'acc': 0.96078116, 'precision': 0.6974876, 'recall': 0.6751734, 'specificity': 0.6751734, 'f1': 0.6855749, 'auroc': 0.78717864, 'binary_precision': 0.41725352, 'binary_recall': 0.36858475, 'binary_specificity': 0.98176205, 'binary_f1_score': 0.39141208}
confusion matrix:
       0    1
0  17818  331
1    406  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.8036823, 'recall': 0.705392, 'specificity': 0.705392, 'f1': 0.74397534, 'auroc': 0.82500386, 'binary_precision': 0.6321839, 'binary_recall': 0.42145595, 'binary_specificity': 0.989328, 'binary_f1_score': 0.50574714}
confusion matrix:
      0    1
0  5933   64
1   151  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_9.png
new oracle model saved
early stop counter: 8
val acc:0.9607811570167542, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9656440019607544
after epoch: 9,now: 2024-06-23 15:57:54.991364,epoch time: 0:16:04.694183,used: 2:39:53.912784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96591866, 'precision': 0.96146476, 'recall': 0.9487543, 'specificity': 0.9487543, 'f1': 0.95487714, 'auroc': 0.98971653, 'binary_precision': 0.95265096, 'binary_recall': 0.91329163, 'binary_specificity': 0.984217, 'binary_f1_score': 0.9325562}
confusion matrix:
       0      1
0  41656    668
1   1276  13440
---- Validation: 
scalar performance:
{'acc': 0.95508724, 'precision': 0.6764304, 'recall': 0.7142287, 'specificity': 0.7142287, 'f1': 0.6932228, 'auroc': 0.80191445, 'binary_precision': 0.37229988, 'binary_recall': 0.45567653, 'binary_specificity': 0.9727809, 'binary_f1_score': 0.40979022}
confusion matrix:
       0    1
0  17655  494
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.76244056, 'recall': 0.71979856, 'specificity': 0.71979856, 'f1': 0.73898554, 'auroc': 0.83422816, 'binary_precision': 0.5483871, 'binary_recall': 0.4559387, 'binary_specificity': 0.9836585, 'binary_f1_score': 0.49790794}
confusion matrix:
      0    1
0  5899   98
1   142  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_10.png
early stop counter: 9
val acc:0.9550872445106506, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9656440019607544
after epoch: 10,now: 2024-06-23 16:14:07.368177,epoch time: 0:16:12.376813,used: 2:56:06.289597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96637446, 'precision': 0.9644433, 'recall': 0.94692177, 'specificity': 0.94692177, 'f1': 0.9552474, 'auroc': 0.99081576, 'binary_precision': 0.9606798, 'binary_recall': 0.9067428, 'binary_specificity': 0.9871007, 'binary_f1_score': 0.9329324}
confusion matrix:
       0      1
0  41782    546
1   1372  13340
---- Validation: 
scalar performance:
{'acc': 0.95950407, 'precision': 0.6976851, 'recall': 0.71276504, 'specificity': 0.71276504, 'f1': 0.7049102, 'auroc': 0.8131177, 'binary_precision': 0.4149856, 'binary_recall': 0.44790047, 'binary_specificity': 0.9776296, 'binary_f1_score': 0.43081525}
confusion matrix:
       0    1
0  17743  406
1    355  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.79871094, 'recall': 0.725631, 'specificity': 0.725631, 'f1': 0.75647855, 'auroc': 0.8454112, 'binary_precision': 0.62051284, 'binary_recall': 0.46360153, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.5307018}
confusion matrix:
      0    1
0  5923   74
1   140  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_11.png
new oracle model saved
early stop counter: 10
val acc:0.9595040678977966, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9658037424087524
after epoch: 11,now: 2024-06-23 16:30:10.524706,epoch time: 0:16:03.156529,used: 3:12:09.446126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96704066, 'precision': 0.962087, 'recall': 0.9511504, 'specificity': 0.9511504, 'f1': 0.9564465, 'auroc': 0.99103075, 'binary_precision': 0.9522266, 'binary_recall': 0.9183202, 'binary_specificity': 0.9839807, 'binary_f1_score': 0.9349661}
confusion matrix:
       0      1
0  41646    678
1   1202  13514
---- Validation: 
scalar performance:
{'acc': 0.95035124, 'precision': 0.6583259, 'recall': 0.714777, 'specificity': 0.714777, 'f1': 0.6815612, 'auroc': 0.8071392, 'binary_precision': 0.33597285, 'binary_recall': 0.46189734, 'binary_specificity': 0.9676566, 'binary_f1_score': 0.38899806}
confusion matrix:
       0    1
0  17562  587
1    346  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.72754025, 'recall': 0.7317059, 'specificity': 0.7317059, 'f1': 0.72960126, 'auroc': 0.8212018, 'binary_precision': 0.4774436, 'binary_recall': 0.48659003, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.48197344}
confusion matrix:
      0    1
0  5858  139
1   134  127
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_12.png
early stop counter: 11
val acc:0.9503512382507324, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9658037424087524
after epoch: 12,now: 2024-06-23 16:46:34.892728,epoch time: 0:16:24.368022,used: 3:28:33.814148,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96740884, 'precision': 0.96326387, 'recall': 0.9509109, 'specificity': 0.9509109, 'f1': 0.95686895, 'auroc': 0.99065685, 'binary_precision': 0.9550506, 'binary_recall': 0.91682523, 'binary_specificity': 0.9849967, 'binary_f1_score': 0.93554765}
confusion matrix:
       0      1
0  41689    635
1   1224  13492
---- Validation: 
scalar performance:
{'acc': 0.9537037, 'precision': 0.6740891, 'recall': 0.7277634, 'specificity': 0.7277634, 'f1': 0.6967821, 'auroc': 0.810961, 'binary_precision': 0.36662748, 'binary_recall': 0.4852255, 'binary_specificity': 0.9703014, 'binary_f1_score': 0.41767067}
confusion matrix:
       0    1
0  17610  539
1    331  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.74145555, 'recall': 0.7201302, 'specificity': 0.7201302, 'f1': 0.73023, 'auroc': 0.8327012, 'binary_precision': 0.5063291, 'binary_recall': 0.4597701, 'binary_specificity': 0.98049027, 'binary_f1_score': 0.4819277}
confusion matrix:
      0    1
0  5880  117
1   141  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_13.png
early stop counter: 12
val acc:0.9537037014961243, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9658037424087524
after epoch: 13,now: 2024-06-23 17:02:46.583058,epoch time: 0:16:11.690330,used: 3:44:45.504478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9665147, 'precision': 0.96320707, 'recall': 0.94855475, 'specificity': 0.94855475, 'f1': 0.95557433, 'auroc': 0.99051225, 'binary_precision': 0.95670164, 'binary_recall': 0.9114509, 'binary_specificity': 0.9856586, 'binary_f1_score': 0.9335282}
confusion matrix:
       0      1
0  41718    607
1   1303  13412
---- Validation: 
scalar performance:
{'acc': 0.9551405, 'precision': 0.6795841, 'recall': 0.72625715, 'specificity': 0.72625715, 'f1': 0.69983053, 'auroc': 0.8107641, 'binary_precision': 0.3777506, 'binary_recall': 0.4805599, 'binary_specificity': 0.9719544, 'binary_f1_score': 0.42299795}
confusion matrix:
       0    1
0  17640  509
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.73429155, 'recall': 0.7213789, 'specificity': 0.7213789, 'f1': 0.72762537, 'auroc': 0.82645476, 'binary_precision': 0.49186993, 'binary_recall': 0.46360153, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.47731754}
confusion matrix:
      0    1
0  5872  125
1   140  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_14.png
early stop counter: 13
val acc:0.9551404714584351, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9658037424087524
after epoch: 14,now: 2024-06-23 17:19:30.875116,epoch time: 0:16:44.292058,used: 4:01:29.796536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9672686, 'precision': 0.9650912, 'recall': 0.9486637, 'specificity': 0.9486637, 'f1': 0.95649505, 'auroc': 0.9902003, 'binary_precision': 0.9608321, 'binary_recall': 0.91022766, 'binary_specificity': 0.9870998, 'binary_f1_score': 0.93484557}
confusion matrix:
       0      1
0  41779    546
1   1321  13394
---- Validation: 
scalar performance:
{'acc': 0.9562048, 'precision': 0.6827863, 'recall': 0.7200576, 'specificity': 0.7200576, 'f1': 0.69944257, 'auroc': 0.80567425, 'binary_precision': 0.3846154, 'binary_recall': 0.466563, 'binary_specificity': 0.9735523, 'binary_f1_score': 0.42164442}
confusion matrix:
       0    1
0  17669  480
1    343  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.78630966, 'recall': 0.7397894, 'specificity': 0.7397894, 'f1': 0.7607367, 'auroc': 0.84845424, 'binary_precision': 0.59447, 'binary_recall': 0.49425286, 'binary_specificity': 0.985326, 'binary_f1_score': 0.5397489}
confusion matrix:
      0    1
0  5909   88
1   132  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_15.png
early stop counter: 14
val acc:0.9562047719955444, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9658037424087524
after epoch: 15,now: 2024-06-23 17:35:36.183600,epoch time: 0:16:05.308484,used: 4:17:35.105020,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9697756, 'precision': 0.963318, 'recall': 0.9573437, 'specificity': 0.9573437, 'f1': 0.9602793, 'auroc': 0.9917315, 'binary_precision': 0.950246, 'binary_recall': 0.93165296, 'binary_specificity': 0.98303443, 'binary_f1_score': 0.94085765}
confusion matrix:
       0      1
0  41603    718
1   1006  13713
---- Validation: 
scalar performance:
{'acc': 0.9505641, 'precision': 0.6662066, 'recall': 0.7418892, 'specificity': 0.7418892, 'f1': 0.6958707, 'auroc': 0.8262734, 'binary_precision': 0.34978992, 'binary_recall': 0.5178849, 'binary_specificity': 0.96589345, 'binary_f1_score': 0.41755486}
confusion matrix:
       0    1
0  17530  619
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9493448, 'precision': 0.6939442, 'recall': 0.7298697, 'specificity': 0.7298697, 'f1': 0.71011436, 'auroc': 0.8399123, 'binary_precision': 0.41025642, 'binary_recall': 0.49042144, 'binary_specificity': 0.969318, 'binary_f1_score': 0.44677138}
confusion matrix:
      0    1
0  5813  184
1   133  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_16.png
early stop counter: 15
val acc:0.9505640864372253, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9658037424087524
after epoch: 16,now: 2024-06-23 17:52:11.692274,epoch time: 0:16:35.508674,used: 4:34:10.613694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9706872, 'precision': 0.9691479, 'recall': 0.953699, 'specificity': 0.953699, 'f1': 0.96108854, 'auroc': 0.9922062, 'binary_precision': 0.9661259, 'binary_recall': 0.9185975, 'binary_specificity': 0.9888004, 'binary_f1_score': 0.94176245}
confusion matrix:
       0      1
0  41849    474
1   1198  13519
---- Validation: 
scalar performance:
{'acc': 0.95843977, 'precision': 0.69405806, 'recall': 0.7227148, 'specificity': 0.7227148, 'f1': 0.70726293, 'auroc': 0.82378894, 'binary_precision': 0.40700808, 'binary_recall': 0.4696734, 'binary_specificity': 0.9757562, 'binary_f1_score': 0.4361011}
confusion matrix:
       0    1
0  17709  440
1    341  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7502904, 'recall': 0.72262955, 'specificity': 0.72262955, 'f1': 0.7355391, 'auroc': 0.84096247, 'binary_precision': 0.52380955, 'binary_recall': 0.46360153, 'binary_specificity': 0.9816575, 'binary_f1_score': 0.49186993}
confusion matrix:
      0    1
0  5887  110
1   140  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_17.png
early stop counter: 16
val acc:0.9584397673606873, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9658037424087524
after epoch: 17,now: 2024-06-23 18:07:35.729873,epoch time: 0:15:24.037599,used: 4:49:34.651293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97179174, 'precision': 0.96821517, 'recall': 0.9575832, 'specificity': 0.9575832, 'f1': 0.9627392, 'auroc': 0.993112, 'binary_precision': 0.9610865, 'binary_recall': 0.9282316, 'binary_specificity': 0.9869347, 'binary_f1_score': 0.9443734}
confusion matrix:
       0      1
0  41773    553
1   1056  13658
---- Validation: 
scalar performance:
{'acc': 0.95434225, 'precision': 0.6727791, 'recall': 0.71234286, 'specificity': 0.71234286, 'f1': 0.69021416, 'auroc': 0.8176191, 'binary_precision': 0.3651192, 'binary_recall': 0.4525661, 'binary_specificity': 0.9721197, 'binary_f1_score': 0.40416667}
confusion matrix:
       0    1
0  17643  506
1    352  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95254076, 'precision': 0.707145, 'recall': 0.72604024, 'specificity': 0.72604024, 'f1': 0.71611214, 'auroc': 0.8332864, 'binary_precision': 0.43706295, 'binary_recall': 0.4789272, 'binary_specificity': 0.97315323, 'binary_f1_score': 0.4570384}
confusion matrix:
      0    1
0  5836  161
1   136  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_18.png
early stop counter: 17
val acc:0.954342246055603, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9658037424087524
after epoch: 18,now: 2024-06-23 18:24:36.011636,epoch time: 0:17:00.281763,used: 5:06:34.933056,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9700386, 'precision': 0.9669218, 'recall': 0.95421225, 'specificity': 0.95421225, 'f1': 0.96033823, 'auroc': 0.993267, 'binary_precision': 0.960751, 'binary_recall': 0.921514, 'binary_specificity': 0.9869105, 'binary_f1_score': 0.94072354}
confusion matrix:
       0      1
0  41770    554
1   1155  13561
---- Validation: 
scalar performance:
{'acc': 0.9553533, 'precision': 0.6817197, 'recall': 0.7316177, 'specificity': 0.7316177, 'f1': 0.70320356, 'auroc': 0.83766186, 'binary_precision': 0.38164252, 'binary_recall': 0.49144635, 'binary_specificity': 0.97178906, 'binary_f1_score': 0.4296397}
confusion matrix:
       0    1
0  17637  512
1    327  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7491105, 'recall': 0.7317078, 'specificity': 0.7317078, 'f1': 0.74004996, 'auroc': 0.8570652, 'binary_precision': 0.5206612, 'binary_recall': 0.4827586, 'binary_specificity': 0.980657, 'binary_f1_score': 0.500994}
confusion matrix:
      0    1
0  5881  116
1   135  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_19.png
early stop counter: 18
val acc:0.955353319644928, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9658037424087524
after epoch: 19,now: 2024-06-23 18:39:40.021175,epoch time: 0:15:04.009539,used: 5:21:38.942595,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9727209, 'precision': 0.9680947, 'recall': 0.9602286, 'specificity': 0.9602286, 'f1': 0.96407366, 'auroc': 0.99282813, 'binary_precision': 0.95878947, 'binary_recall': 0.93442065, 'binary_specificity': 0.9860366, 'binary_f1_score': 0.94644815}
confusion matrix:
       0      1
0  41734    591
1    965  13750
---- Validation: 
scalar performance:
{'acc': 0.95285225, 'precision': 0.6721826, 'recall': 0.7333231, 'specificity': 0.7333231, 'f1': 0.6974128, 'auroc': 0.80834377, 'binary_precision': 0.36240092, 'binary_recall': 0.4976672, 'binary_specificity': 0.968979, 'binary_f1_score': 0.41939712}
confusion matrix:
       0    1
0  17586  563
1    323  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.74913526, 'recall': 0.72621083, 'specificity': 0.72621083, 'f1': 0.73704314, 'auroc': 0.8414381, 'binary_precision': 0.5211864, 'binary_recall': 0.47126436, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.49496982}
confusion matrix:
      0    1
0  5884  113
1   138  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_20.png
early stop counter: 19
val acc:0.9528522491455078, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9658037424087524
after epoch: 20,now: 2024-06-23 18:55:33.812964,epoch time: 0:15:53.791789,used: 5:37:32.734384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97056454, 'precision': 0.9648546, 'recall': 0.95782673, 'specificity': 0.95782673, 'f1': 0.96126974, 'auroc': 0.99280035, 'binary_precision': 0.95333797, 'binary_recall': 0.93150777, 'binary_specificity': 0.98414576, 'binary_f1_score': 0.94229645}
confusion matrix:
       0      1
0  41652    671
1   1008  13709
---- Validation: 
scalar performance:
{'acc': 0.95498085, 'precision': 0.682137, 'recall': 0.7404255, 'specificity': 0.7404255, 'f1': 0.7066522, 'auroc': 0.8351203, 'binary_precision': 0.38183933, 'binary_recall': 0.5101089, 'binary_specificity': 0.97074217, 'binary_f1_score': 0.43675098}
confusion matrix:
       0    1
0  17618  531
1    315  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.75636125, 'recall': 0.74695015, 'specificity': 0.74695015, 'f1': 0.75155544, 'auroc': 0.8581015, 'binary_precision': 0.53386456, 'binary_recall': 0.51341, 'binary_specificity': 0.98049027, 'binary_f1_score': 0.5234375}
confusion matrix:
      0    1
0  5880  117
1   127  134
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_21.png
early stop counter: 20
val acc:0.9549808502197266, best validation acc: 0.962005078792572, corresponding to test acc:                         0.9542984962463379 / 0.9658037424087524
after epoch: 21,now: 2024-06-23 19:10:38.216919,epoch time: 0:15:04.403955,used: 5:52:37.138339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_01_seed_0_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 5:52:37.138339 at 2024-06-23 19:10:38.216919
persisted model performance metric: 

scalar performance:
{'acc': 0.9542985, 'precision': 0.55085975, 'recall': 0.5070773, 'specificity': 0.5070773, 'f1': 0.5051898, 'auroc': 0.66867596, 'binary_precision': 0.14285715, 'binary_recall': 0.019157087, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.033783786}
confusion matrix:
      0   1
0  5967  30
1   256   5
oracle model performance metric: 

scalar performance:
{'acc': 0.96580374, 'precision': 0.79871094, 'recall': 0.725631, 'specificity': 0.725631, 'f1': 0.75647855, 'auroc': 0.8454112, 'binary_precision': 0.62051284, 'binary_recall': 0.46360153, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.5307018}
confusion matrix:
      0    1
0  5923   74
1   140  121
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 640729 KiB |    807 TiB |    807 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    807 TiB |    807 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 640729 KiB |    807 TiB |    807 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    807 TiB |    807 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 632296 KiB |    805 TiB |    805 TiB |
|       from large pool | 165120 KiB | 560704 KiB |    805 TiB |    805 TiB |
|       from small pool |  35968 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB | 755712 KiB | 755712 KiB |      0 B   |
|       from large pool | 679936 KiB | 679936 KiB | 679936 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  79692 KiB | 217798 KiB | 326086 GiB | 326086 GiB |
|       from large pool |  67584 KiB | 213792 KiB | 325816 GiB | 325816 GiB |
|       from small pool |  12108 KiB |  13958 KiB |    270 GiB |    270 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    7879    |   71505 K  |   71502 K  |
|       from large pool |      36    |      76    |   28996 K  |   28996 K  |
|       from small pool |    3216    |    7842    |   42509 K  |   42506 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    7879    |   71505 K  |   71502 K  |
|       from large pool |      36    |      76    |   28996 K  |   28996 K  |
|       from small pool |    3216    |    7842    |   42509 K  |   42506 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3581    |   32134 K  |   32134 K  |
|       from large pool |       7    |      11    |   10369 K  |   10369 K  |
|       from small pool |      30    |    3574    |   21764 K  |   21764 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    807 TiB |    807 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    807 TiB |    807 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    807 TiB |    807 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    807 TiB |    807 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    805 TiB |    805 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    805 TiB |    805 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 217798 KiB | 326086 GiB | 326086 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 325816 GiB | 325816 GiB |
|       from small pool |      0 KiB |  19703 KiB |    270 GiB |    270 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |   71505 K  |   71505 K  |
|       from large pool |       2    |      76    |   28996 K  |   28996 K  |
|       from small pool |       0    |    7842    |   42509 K  |   42509 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |   71505 K  |   71505 K  |
|       from large pool |       2    |      76    |   28996 K  |   28996 K  |
|       from small pool |       0    |    7842    |   42509 K  |   42509 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   32135 K  |   32135 K  |
|       from large pool |       3    |      13    |   10369 K  |   10369 K  |
|       from small pool |       0    |    3574    |   21766 K  |   21766 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    807 TiB |    807 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    807 TiB |    807 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    807 TiB |    807 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    807 TiB |    807 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    805 TiB |    805 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    805 TiB |    805 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 217798 KiB | 326086 GiB | 326086 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 325816 GiB | 325816 GiB |
|       from small pool |      0 KiB |  19703 KiB |    270 GiB |    270 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |   71505 K  |   71505 K  |
|       from large pool |       2    |      76    |   28996 K  |   28996 K  |
|       from small pool |       0    |    7842    |   42509 K  |   42509 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |   71505 K  |   71505 K  |
|       from large pool |       2    |      76    |   28996 K  |   28996 K  |
|       from small pool |       0    |    7842    |   42509 K  |   42509 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   32135 K  |   32135 K  |
|       from large pool |       3    |      13    |   10369 K  |   10369 K  |
|       from small pool |       0    |    3574    |   21766 K  |   21766 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152

 Experiment start at: 2024-06-23 19:17:35.953778
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8565597, 'precision': 0.8911748, 'recall': 0.7275711, 'specificity': 0.7275711, 'f1': 0.7668741, 'auroc': 0.93078494, 'binary_precision': 0.93745637, 'binary_recall': 0.46570498, 'binary_specificity': 0.9894372, 'binary_f1_score': 0.62227786}
confusion matrix:
       0     1
0  41965   448
1   7704  6715
---- Validation: 
scalar performance:
{'acc': 0.9546958, 'precision': 0.4847075, 'recall': 0.4958445, 'specificity': 0.4958445, 'f1': 0.48958588, 'auroc': 0.53466177, 'binary_precision': 0.0056179776, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99020314, 'binary_f1_score': 0.0023501762}
confusion matrix:
       0    1
0  17890  177
1    672    1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95601034, 'precision': 0.47900856, 'recall': 0.49890682, 'specificity': 0.49890682, 'f1': 0.48875523, 'auroc': 0.5973654, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5933  13
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-23 19:33:37.862994,epoch time: 0:16:01.909216,used: 0:16:01.909216,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9032235, 'precision': 0.9153205, 'recall': 0.82471716, 'specificity': 0.82471716, 'f1': 0.8576943, 'auroc': 0.9525449, 'binary_precision': 0.9342618, 'binary_recall': 0.6653489, 'binary_specificity': 0.98408544, 'binary_f1_score': 0.77720165}
confusion matrix:
       0     1
0  41739   675
1   4825  9593
---- Validation: 
scalar performance:
{'acc': 0.9471718, 'precision': 0.54842025, 'recall': 0.53128207, 'specificity': 0.53128207, 'f1': 0.5372096, 'auroc': 0.6376916, 'binary_precision': 0.13053612, 'binary_recall': 0.08320951, 'binary_specificity': 0.9793546, 'binary_f1_score': 0.10163339}
confusion matrix:
       0    1
0  17694  373
1    617   56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94875926, 'precision': 0.5572078, 'recall': 0.5190296, 'specificity': 0.5190296, 'f1': 0.5246154, 'auroc': 0.71458447, 'binary_precision': 0.15476191, 'binary_recall': 0.05, 'binary_specificity': 0.9880592, 'binary_f1_score': 0.0755814}
confusion matrix:
      0   1
0  5875  71
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_2.png
early stop counter: 1
val acc:0.9471718072891235, best validation acc: 0.9546958208084106, corresponding to test acc:                         0.9560103416442871 / 0.9560103416442871
after epoch: 2,now: 2024-06-23 19:49:33.252101,epoch time: 0:15:55.389107,used: 0:31:57.298323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93704253, 'precision': 0.9345085, 'recall': 0.89613116, 'specificity': 0.89613116, 'f1': 0.9131509, 'auroc': 0.97268414, 'binary_precision': 0.929954, 'binary_recall': 0.81308085, 'binary_specificity': 0.9791814, 'binary_f1_score': 0.8675991}
confusion matrix:
       0      1
0  41531    883
1   2695  11723
---- Validation: 
scalar performance:
{'acc': 0.94364995, 'precision': 0.5926642, 'recall': 0.59239906, 'specificity': 0.59239906, 'f1': 0.5925314, 'auroc': 0.7028153, 'binary_precision': 0.21460506, 'binary_recall': 0.21396731, 'binary_specificity': 0.9708308, 'binary_f1_score': 0.21428572}
confusion matrix:
       0    1
0  17540  527
1    529  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9456977, 'precision': 0.6004802, 'recall': 0.5578896, 'specificity': 0.5578896, 'f1': 0.57195926, 'auroc': 0.7553724, 'binary_precision': 0.23809524, 'binary_recall': 0.13461539, 'binary_specificity': 0.9811638, 'binary_f1_score': 0.17199017}
confusion matrix:
      0    1
0  5834  112
1   225   35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_3.png
early stop counter: 2
val acc:0.94364994764328, best validation acc: 0.9546958208084106, corresponding to test acc:                         0.9560103416442871 / 0.9560103416442871
after epoch: 3,now: 2024-06-23 20:05:15.405708,epoch time: 0:15:42.153607,used: 0:47:39.451930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93558204, 'precision': 0.9395031, 'recall': 0.88785064, 'specificity': 0.88785064, 'f1': 0.9098505, 'auroc': 0.9761393, 'binary_precision': 0.94631153, 'binary_recall': 0.7909557, 'binary_specificity': 0.9847456, 'binary_f1_score': 0.86168724}
confusion matrix:
       0      1
0  41767    647
1   3014  11404
---- Validation: 
scalar performance:
{'acc': 0.94925296, 'precision': 0.60789806, 'recall': 0.5881522, 'specificity': 0.5881522, 'f1': 0.5968129, 'auroc': 0.7211815, 'binary_precision': 0.24542125, 'binary_recall': 0.19910847, 'binary_specificity': 0.977196, 'binary_f1_score': 0.21985234}
confusion matrix:
       0    1
0  17655  412
1    539  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9506929, 'precision': 0.6659514, 'recall': 0.610149, 'specificity': 0.610149, 'f1': 0.6314169, 'auroc': 0.781266, 'binary_precision': 0.3647059, 'binary_recall': 0.23846154, 'binary_specificity': 0.98183656, 'binary_f1_score': 0.2883721}
confusion matrix:
      0    1
0  5838  108
1   198   62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_4.png
early stop counter: 3
val acc:0.9492529630661011, best validation acc: 0.9546958208084106, corresponding to test acc:                         0.9560103416442871 / 0.9560103416442871
after epoch: 4,now: 2024-06-23 20:20:59.742001,epoch time: 0:15:44.336293,used: 1:03:23.788223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9469313, 'precision': 0.94725585, 'recall': 0.9106132, 'specificity': 0.9106132, 'f1': 0.92702603, 'auroc': 0.9816884, 'binary_precision': 0.94784385, 'binary_recall': 0.8368819, 'binary_specificity': 0.9843444, 'binary_f1_score': 0.88891345}
confusion matrix:
       0      1
0  41749    664
1   2352  12067
---- Validation: 
scalar performance:
{'acc': 0.9503202, 'precision': 0.6395411, 'recall': 0.6373439, 'specificity': 0.6373439, 'f1': 0.63843215, 'auroc': 0.7519579, 'binary_precision': 0.30513597, 'binary_recall': 0.30014858, 'binary_specificity': 0.9745392, 'binary_f1_score': 0.30262172}
confusion matrix:
       0    1
0  17607  460
1    471  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.7300323, 'recall': 0.6596555, 'specificity': 0.6596555, 'f1': 0.6876063, 'auroc': 0.8037504, 'binary_precision': 0.48876405, 'binary_recall': 0.33461538, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.39726028}
confusion matrix:
      0   1
0  5855  91
1   173  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_5.png
new oracle model saved
early stop counter: 4
val acc:0.9503201842308044, best validation acc: 0.9546958208084106, corresponding to test acc:                         0.9560103416442871 / 0.9574605226516724
after epoch: 5,now: 2024-06-23 20:36:00.414854,epoch time: 0:15:00.672853,used: 1:18:24.461076,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.953952, 'precision': 0.94914585, 'recall': 0.9276533, 'specificity': 0.9276533, 'f1': 0.9377363, 'auroc': 0.98401, 'binary_precision': 0.94004476, 'binary_recall': 0.8742631, 'binary_specificity': 0.9810436, 'binary_f1_score': 0.90596133}
confusion matrix:
       0      1
0  41609    804
1   1813  12606
---- Validation: 
scalar performance:
{'acc': 0.9505336, 'precision': 0.65476775, 'recall': 0.6739332, 'specificity': 0.6739332, 'f1': 0.6636945, 'auroc': 0.7850816, 'binary_precision': 0.33289474, 'binary_recall': 0.37592867, 'binary_specificity': 0.9719378, 'binary_f1_score': 0.35310537}
confusion matrix:
       0    1
0  17560  507
1    420  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.72227573, 'recall': 0.6992723, 'specificity': 0.6992723, 'f1': 0.7100514, 'auroc': 0.8275809, 'binary_precision': 0.4698276, 'binary_recall': 0.41923076, 'binary_specificity': 0.97931385, 'binary_f1_score': 0.44308943}
confusion matrix:
      0    1
0  5823  123
1   151  109
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_6.png
early stop counter: 5
val acc:0.9505336284637451, best validation acc: 0.9546958208084106, corresponding to test acc:                         0.9560103416442871 / 0.9574605226516724
after epoch: 6,now: 2024-06-23 20:51:23.096147,epoch time: 0:15:22.681293,used: 1:33:47.142369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9562746, 'precision': 0.9569113, 'recall': 0.92633015, 'specificity': 0.92633015, 'f1': 0.9403196, 'auroc': 0.9854765, 'binary_precision': 0.958087, 'binary_recall': 0.865534, 'binary_specificity': 0.9871263, 'binary_f1_score': 0.90946186}
confusion matrix:
       0      1
0  41866    546
1   1939  12481
---- Validation: 
scalar performance:
{'acc': 0.9551761, 'precision': 0.6725924, 'recall': 0.6641814, 'specificity': 0.6641814, 'f1': 0.6682656, 'auroc': 0.7702195, 'binary_precision': 0.36932707, 'binary_recall': 0.35066864, 'binary_specificity': 0.97769415, 'binary_f1_score': 0.35975605}
confusion matrix:
       0    1
0  17664  403
1    437  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.7649765, 'recall': 0.7207735, 'specificity': 0.7207735, 'f1': 0.7405992, 'auroc': 0.8245991, 'binary_precision': 0.5534884, 'binary_recall': 0.4576923, 'binary_specificity': 0.9838547, 'binary_f1_score': 0.5010527}
confusion matrix:
      0    1
0  5850   96
1   141  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-23 21:06:45.855312,epoch time: 0:15:22.759165,used: 1:49:09.901534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9604448, 'precision': 0.95827854, 'recall': 0.93610406, 'specificity': 0.93610406, 'f1': 0.9465039, 'auroc': 0.9874325, 'binary_precision': 0.9541791, 'binary_recall': 0.88668513, 'binary_specificity': 0.985523, 'binary_f1_score': 0.9191948}
confusion matrix:
       0      1
0  41798    614
1   1634  12786
---- Validation: 
scalar performance:
{'acc': 0.9504269, 'precision': 0.6518009, 'recall': 0.6667252, 'specificity': 0.6667252, 'f1': 0.6588519, 'auroc': 0.79526734, 'binary_precision': 0.32749325, 'binary_recall': 0.36106983, 'binary_specificity': 0.9723806, 'binary_f1_score': 0.34346288}
confusion matrix:
       0    1
0  17568  499
1    430  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.74138445, 'recall': 0.7190917, 'specificity': 0.7190917, 'f1': 0.7296211, 'auroc': 0.8310331, 'binary_precision': 0.506383, 'binary_recall': 0.4576923, 'binary_specificity': 0.9804911, 'binary_f1_score': 0.48080805}
confusion matrix:
      0    1
0  5830  116
1   141  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_8.png
early stop counter: 1
val acc:0.9504268765449524, best validation acc: 0.9551761150360107, corresponding to test acc:                         0.9618111252784729 / 0.9618111252784729
after epoch: 8,now: 2024-06-23 21:22:19.722366,epoch time: 0:15:33.867054,used: 2:04:43.768588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9620636, 'precision': 0.961856, 'recall': 0.936956, 'specificity': 0.936956, 'f1': 0.94855046, 'auroc': 0.9880879, 'binary_precision': 0.9614661, 'binary_recall': 0.88598377, 'binary_specificity': 0.9879282, 'binary_f1_score': 0.922183}
confusion matrix:
       0      1
0  41901    512
1   1644  12775
---- Validation: 
scalar performance:
{'acc': 0.9594984, 'precision': 0.69538987, 'recall': 0.6499719, 'specificity': 0.6499719, 'f1': 0.6692909, 'auroc': 0.7913908, 'binary_precision': 0.41601562, 'binary_recall': 0.3164933, 'binary_specificity': 0.9834505, 'binary_f1_score': 0.35949367}
confusion matrix:
       0    1
0  17768  299
1    460  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.8211713, 'recall': 0.6862642, 'specificity': 0.6862642, 'f1': 0.73389995, 'auroc': 0.8221383, 'binary_precision': 0.6689189, 'binary_recall': 0.38076922, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.4852941}
confusion matrix:
      0   1
0  5897  49
1   161  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-23 21:38:05.866693,epoch time: 0:15:46.144327,used: 2:20:29.912915,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9624683, 'precision': 0.95975095, 'recall': 0.9400916, 'specificity': 0.9400916, 'f1': 0.9493817, 'auroc': 0.98966885, 'binary_precision': 0.954569, 'binary_recall': 0.8946602, 'binary_specificity': 0.985523, 'binary_f1_score': 0.9236442}
confusion matrix:
       0      1
0  41798    614
1   1519  12901
---- Validation: 
scalar performance:
{'acc': 0.95416224, 'precision': 0.67116785, 'recall': 0.6758151, 'specificity': 0.6758151, 'f1': 0.6734555, 'auroc': 0.80289197, 'binary_precision': 0.36560693, 'binary_recall': 0.37592867, 'binary_specificity': 0.9757016, 'binary_f1_score': 0.37069595}
confusion matrix:
       0    1
0  17628  439
1    420  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.76369333, 'recall': 0.7206894, 'specificity': 0.7206894, 'f1': 0.74003017, 'auroc': 0.8401233, 'binary_precision': 0.5509259, 'binary_recall': 0.4576923, 'binary_specificity': 0.9836865, 'binary_f1_score': 0.5}
confusion matrix:
      0    1
0  5849   97
1   141  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_10.png
early stop counter: 1
val acc:0.9541622400283813, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9661617875099182
after epoch: 10,now: 2024-06-23 21:53:20.109101,epoch time: 0:15:14.242408,used: 2:35:44.155323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9634009, 'precision': 0.9516392, 'recall': 0.95172185, 'specificity': 0.95172185, 'f1': 0.95168054, 'auroc': 0.9895636, 'binary_precision': 0.9277543, 'binary_recall': 0.92801166, 'binary_specificity': 0.97543204, 'binary_f1_score': 0.92788297}
confusion matrix:
       0      1
0  41371   1042
1   1038  13381
---- Validation: 
scalar performance:
{'acc': 0.9420491, 'precision': 0.6428157, 'recall': 0.72031695, 'specificity': 0.72031695, 'f1': 0.6716607, 'auroc': 0.80604625, 'binary_precision': 0.3053723, 'binary_recall': 0.48142645, 'binary_specificity': 0.9592074, 'binary_f1_score': 0.37370247}
confusion matrix:
       0    1
0  17330  737
1    349  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9442475, 'precision': 0.67807317, 'recall': 0.73735344, 'specificity': 0.73735344, 'f1': 0.70265925, 'auroc': 0.8358495, 'binary_precision': 0.3778409, 'binary_recall': 0.51153845, 'binary_specificity': 0.9631685, 'binary_f1_score': 0.4346405}
confusion matrix:
      0    1
0  5727  219
1   127  133
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_11.png
early stop counter: 2
val acc:0.9420490860939026, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9661617875099182
after epoch: 11,now: 2024-06-23 22:08:14.153825,epoch time: 0:14:54.044724,used: 2:50:38.200047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96725434, 'precision': 0.96267563, 'recall': 0.9501152, 'specificity': 0.9501152, 'f1': 0.9561752, 'auroc': 0.9901748, 'binary_precision': 0.95375055, 'binary_recall': 0.91532004, 'binary_specificity': 0.9849103, 'binary_f1_score': 0.9341402}
confusion matrix:
       0      1
0  41773    640
1   1221  13198
---- Validation: 
scalar performance:
{'acc': 0.95368195, 'precision': 0.6784669, 'recall': 0.7098989, 'specificity': 0.7098989, 'f1': 0.6927097, 'auroc': 0.8182652, 'binary_precision': 0.37766623, 'binary_recall': 0.4472511, 'binary_specificity': 0.97254664, 'binary_f1_score': 0.4095238}
confusion matrix:
       0    1
0  17571  496
1    372  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.74602425, 'recall': 0.7414959, 'specificity': 0.7414959, 'f1': 0.743736, 'auroc': 0.8512478, 'binary_precision': 0.5137255, 'binary_recall': 0.50384617, 'binary_specificity': 0.97914565, 'binary_f1_score': 0.50873786}
confusion matrix:
      0    1
0  5822  124
1   129  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_12.png
early stop counter: 3
val acc:0.9536819458007812, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9661617875099182
after epoch: 12,now: 2024-06-23 22:23:35.464084,epoch time: 0:15:21.310259,used: 3:05:59.510306,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9663394, 'precision': 0.9658929, 'recall': 0.94442105, 'specificity': 0.94442105, 'f1': 0.9545257, 'auroc': 0.99053955, 'binary_precision': 0.9650454, 'binary_recall': 0.8999237, 'binary_specificity': 0.9889185, 'binary_f1_score': 0.9313476}
confusion matrix:
       0      1
0  41943    470
1   1443  12976
---- Validation: 
scalar performance:
{'acc': 0.9573639, 'precision': 0.69172215, 'recall': 0.6903504, 'specificity': 0.6903504, 'f1': 0.6910334, 'auroc': 0.8106476, 'binary_precision': 0.4056886, 'binary_recall': 0.4026746, 'binary_specificity': 0.9780262, 'binary_f1_score': 0.40417597}
confusion matrix:
       0    1
0  17670  397
1    402  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.78245485, 'recall': 0.72370565, 'specificity': 0.72370565, 'f1': 0.7492467, 'auroc': 0.83635736, 'binary_precision': 0.5882353, 'binary_recall': 0.46153846, 'binary_specificity': 0.98587286, 'binary_f1_score': 0.51724136}
confusion matrix:
      0    1
0  5862   84
1   140  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_13.png
early stop counter: 4
val acc:0.9573639035224915, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9661617875099182
after epoch: 13,now: 2024-06-23 22:39:10.365282,epoch time: 0:15:34.901198,used: 3:21:34.411504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96632177, 'precision': 0.962987, 'recall': 0.9472444, 'specificity': 0.9472444, 'f1': 0.9547714, 'auroc': 0.99066067, 'binary_precision': 0.9565503, 'binary_recall': 0.9085171, 'binary_specificity': 0.9859716, 'binary_f1_score': 0.93191516}
confusion matrix:
       0      1
0  41819    595
1   1319  13099
---- Validation: 
scalar performance:
{'acc': 0.95720387, 'precision': 0.6942011, 'recall': 0.705288, 'specificity': 0.705288, 'f1': 0.69956833, 'auroc': 0.82290125, 'binary_precision': 0.40953717, 'binary_recall': 0.43387815, 'binary_specificity': 0.97669786, 'binary_f1_score': 0.4213564}
confusion matrix:
       0    1
0  17646  421
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.812247, 'recall': 0.7402675, 'specificity': 0.7402675, 'f1': 0.7710269, 'auroc': 0.8520279, 'binary_precision': 0.64646465, 'binary_recall': 0.4923077, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.5589519}
confusion matrix:
      0    1
0  5876   70
1   132  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_14.png
new oracle model saved
early stop counter: 5
val acc:0.9572038650512695, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9674508571624756
after epoch: 14,now: 2024-06-23 22:54:28.948252,epoch time: 0:15:18.582970,used: 3:36:52.994474,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97054476, 'precision': 0.96764493, 'recall': 0.9539447, 'specificity': 0.9539447, 'f1': 0.9605368, 'auroc': 0.9918598, 'binary_precision': 0.9620097, 'binary_recall': 0.9202441, 'binary_specificity': 0.98764527, 'binary_f1_score': 0.9406635}
confusion matrix:
       0      1
0  41889    524
1   1150  13269
---- Validation: 
scalar performance:
{'acc': 0.9540555, 'precision': 0.67720616, 'recall': 0.69864833, 'specificity': 0.69864833, 'f1': 0.6872194, 'auroc': 0.8127528, 'binary_precision': 0.37598944, 'binary_recall': 0.42347696, 'binary_specificity': 0.9738197, 'binary_f1_score': 0.39832288}
confusion matrix:
       0    1
0  17594  473
1    388  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.7523371, 'recall': 0.7346445, 'specificity': 0.7346445, 'f1': 0.7431245, 'auroc': 0.83908117, 'binary_precision': 0.526971, 'binary_recall': 0.48846152, 'binary_specificity': 0.98082745, 'binary_f1_score': 0.506986}
confusion matrix:
      0    1
0  5832  114
1   133  127
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_15.png
early stop counter: 6
val acc:0.9540554881095886, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9674508571624756
after epoch: 15,now: 2024-06-23 23:10:04.004919,epoch time: 0:15:35.056667,used: 3:52:28.051141,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.967835, 'precision': 0.9669289, 'recall': 0.9473946, 'specificity': 0.9473946, 'f1': 0.9566395, 'auroc': 0.9910406, 'binary_precision': 0.96519876, 'binary_recall': 0.9058946, 'binary_specificity': 0.98889464, 'binary_f1_score': 0.93460685}
confusion matrix:
       0      1
0  41941    471
1   1357  13063
---- Validation: 
scalar performance:
{'acc': 0.9568303, 'precision': 0.6914083, 'recall': 0.70151794, 'specificity': 0.70151794, 'f1': 0.696314, 'auroc': 0.828732, 'binary_precision': 0.40422535, 'binary_recall': 0.42644873, 'binary_specificity': 0.9765872, 'binary_f1_score': 0.41503978}
confusion matrix:
       0    1
0  17644  423
1    386  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.8041538, 'recall': 0.7248829, 'specificity': 0.7248829, 'f1': 0.7578889, 'auroc': 0.85461605, 'binary_precision': 0.6315789, 'binary_recall': 0.46153846, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.53333336}
confusion matrix:
      0    1
0  5876   70
1   140  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_16.png
early stop counter: 7
val acc:0.9568303227424622, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9674508571624756
after epoch: 16,now: 2024-06-23 23:27:00.364470,epoch time: 0:16:56.359551,used: 4:09:24.410692,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9706503, 'precision': 0.9687675, 'recall': 0.95310265, 'specificity': 0.95310265, 'f1': 0.96059954, 'auroc': 0.99134624, 'binary_precision': 0.96512985, 'binary_recall': 0.9174757, 'binary_specificity': 0.9887296, 'binary_f1_score': 0.94069964}
confusion matrix:
       0      1
0  41934    478
1   1190  13230
---- Validation: 
scalar performance:
{'acc': 0.95635, 'precision': 0.6916018, 'recall': 0.71342844, 'specificity': 0.71342844, 'f1': 0.7018396, 'auroc': 0.8234836, 'binary_precision': 0.40371847, 'binary_recall': 0.45170876, 'binary_specificity': 0.9751481, 'binary_f1_score': 0.42636743}
confusion matrix:
       0    1
0  17618  449
1    369  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.79816186, 'recall': 0.7283086, 'specificity': 0.7283086, 'f1': 0.75804996, 'auroc': 0.84738934, 'binary_precision': 0.61928934, 'binary_recall': 0.46923077, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.53391683}
confusion matrix:
      0    1
0  5871   75
1   138  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_17.png
early stop counter: 8
val acc:0.9563500285148621, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9674508571624756
after epoch: 17,now: 2024-06-23 23:42:53.782086,epoch time: 0:15:53.417616,used: 4:25:17.828308,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9699465, 'precision': 0.9662297, 'recall': 0.9537728, 'specificity': 0.9537728, 'f1': 0.9597868, 'auroc': 0.99200916, 'binary_precision': 0.95898026, 'binary_recall': 0.92093766, 'binary_specificity': 0.9866079, 'binary_f1_score': 0.93957406}
confusion matrix:
       0      1
0  41845    568
1   1140  13279
---- Validation: 
scalar performance:
{'acc': 0.95624334, 'precision': 0.69228953, 'recall': 0.71909523, 'specificity': 0.71909523, 'f1': 0.70468897, 'auroc': 0.83707106, 'binary_precision': 0.40466926, 'binary_recall': 0.46359584, 'binary_specificity': 0.9745946, 'binary_f1_score': 0.43213296}
confusion matrix:
       0    1
0  17608  459
1    361  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.798678, 'recall': 0.7320707, 'specificity': 0.7320707, 'f1': 0.7606964, 'auroc': 0.8550058, 'binary_precision': 0.62, 'binary_recall': 0.47692308, 'binary_specificity': 0.9872183, 'binary_f1_score': 0.53913045}
confusion matrix:
      0    1
0  5870   76
1   136  124
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_18.png
early stop counter: 9
val acc:0.9562433362007141, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9674508571624756
after epoch: 18,now: 2024-06-23 23:58:44.090728,epoch time: 0:15:50.308642,used: 4:41:08.136950,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.972146, 'precision': 0.966231, 'recall': 0.959826, 'specificity': 0.959826, 'f1': 0.9629713, 'auroc': 0.99226487, 'binary_precision': 0.9544714, 'binary_recall': 0.9348128, 'binary_specificity': 0.9848392, 'binary_f1_score': 0.94453984}
confusion matrix:
       0      1
0  41769    643
1    940  13480
---- Validation: 
scalar performance:
{'acc': 0.95373535, 'precision': 0.68329895, 'recall': 0.72923875, 'specificity': 0.72923875, 'f1': 0.70330834, 'auroc': 0.8387499, 'binary_precision': 0.38588235, 'binary_recall': 0.48736998, 'binary_specificity': 0.97110754, 'binary_f1_score': 0.43072882}
confusion matrix:
       0    1
0  17545  522
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7452014, 'recall': 0.7506068, 'specificity': 0.7506068, 'f1': 0.7478703, 'auroc': 0.8583126, 'binary_precision': 0.5112782, 'binary_recall': 0.52307695, 'binary_specificity': 0.97813654, 'binary_f1_score': 0.5171103}
confusion matrix:
      0    1
0  5816  130
1   124  136
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_19.png
early stop counter: 10
val acc:0.9537353515625, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9674508571624756
after epoch: 19,now: 2024-06-24 00:14:55.051637,epoch time: 0:16:10.960909,used: 4:57:19.097859,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9704392, 'precision': 0.96952116, 'recall': 0.9517883, 'specificity': 0.9517883, 'f1': 0.9602268, 'auroc': 0.991827, 'binary_precision': 0.96775854, 'binary_recall': 0.913927, 'binary_specificity': 0.98964965, 'binary_f1_score': 0.94007283}
confusion matrix:
       0      1
0  41975    439
1   1241  13177
---- Validation: 
scalar performance:
{'acc': 0.95789754, 'precision': 0.6975738, 'recall': 0.703502, 'specificity': 0.703502, 'f1': 0.7004878, 'auroc': 0.8118864, 'binary_precision': 0.4164265, 'binary_recall': 0.4294205, 'binary_specificity': 0.97758347, 'binary_f1_score': 0.4228237}
confusion matrix:
       0    1
0  17662  405
1    384  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.7860629, 'recall': 0.72763586, 'specificity': 0.72763586, 'f1': 0.75311637, 'auroc': 0.8401071, 'binary_precision': 0.595122, 'binary_recall': 0.46923077, 'binary_specificity': 0.986041, 'binary_f1_score': 0.5247312}
confusion matrix:
      0    1
0  5863   83
1   138  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_20.png
early stop counter: 11
val acc:0.9578975439071655, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9674508571624756
after epoch: 20,now: 2024-06-24 00:30:20.171647,epoch time: 0:15:25.120010,used: 5:12:44.217869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9717765, 'precision': 0.97069883, 'recall': 0.954195, 'specificity': 0.954195, 'f1': 0.9620769, 'auroc': 0.9929067, 'binary_precision': 0.968622, 'binary_recall': 0.91850466, 'binary_specificity': 0.9898854, 'binary_f1_score': 0.94289786}
confusion matrix:
       0      1
0  41985    429
1   1175  13243
---- Validation: 
scalar performance:
{'acc': 0.9578442, 'precision': 0.69941366, 'recall': 0.7142033, 'specificity': 0.7142033, 'f1': 0.7065062, 'auroc': 0.8370284, 'binary_precision': 0.41931033, 'binary_recall': 0.45170876, 'binary_specificity': 0.97669786, 'binary_f1_score': 0.434907}
confusion matrix:
       0    1
0  17646  421
1    369  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.8372363, 'recall': 0.72639656, 'specificity': 0.72639656, 'f1': 0.7697644, 'auroc': 0.8541651, 'binary_precision': 0.6976744, 'binary_recall': 0.46153846, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.5555556}
confusion matrix:
      0    1
0  5894   52
1   140  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_21.png
new oracle model saved
early stop counter: 12
val acc:0.9578441977500916, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9690622091293335
after epoch: 21,now: 2024-06-24 00:45:46.082976,epoch time: 0:15:25.911329,used: 5:28:10.129198,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9731137, 'precision': 0.96930325, 'recall': 0.9592157, 'specificity': 0.9592157, 'f1': 0.9641196, 'auroc': 0.99276495, 'binary_precision': 0.961814, 'binary_recall': 0.9309986, 'binary_specificity': 0.9874328, 'binary_f1_score': 0.9461555}
confusion matrix:
       0      1
0  41879    533
1    995  13425
---- Validation: 
scalar performance:
{'acc': 0.95640343, 'precision': 0.69607425, 'recall': 0.73419887, 'specificity': 0.73419887, 'f1': 0.7131967, 'auroc': 0.8394047, 'binary_precision': 0.41111112, 'binary_recall': 0.4947994, 'binary_specificity': 0.9735983, 'binary_f1_score': 0.4490897}
confusion matrix:
       0    1
0  17590  477
1    340  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.7946125, 'recall': 0.77286476, 'specificity': 0.77286476, 'f1': 0.7832693, 'auroc': 0.8705976, 'binary_precision': 0.60833335, 'binary_recall': 0.56153846, 'binary_specificity': 0.98419106, 'binary_f1_score': 0.584}
confusion matrix:
      0    1
0  5852   94
1   114  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_22.png
early stop counter: 13
val acc:0.9564034342765808, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9690622091293335
after epoch: 22,now: 2024-06-24 01:01:08.480727,epoch time: 0:15:22.397751,used: 5:43:32.526949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9732721, 'precision': 0.9671273, 'recall': 0.9619726, 'specificity': 0.9619726, 'f1': 0.96451306, 'auroc': 0.99266636, 'binary_precision': 0.95486283, 'binary_recall': 0.9390345, 'binary_specificity': 0.98491067, 'binary_f1_score': 0.9468826}
confusion matrix:
       0      1
0  41774    640
1    879  13539
---- Validation: 
scalar performance:
{'acc': 0.95522946, 'precision': 0.68851465, 'recall': 0.72357625, 'specificity': 0.72357625, 'f1': 0.7043265, 'auroc': 0.8246069, 'binary_precision': 0.39676616, 'binary_recall': 0.47399703, 'binary_specificity': 0.9731555, 'binary_f1_score': 0.43195665}
confusion matrix:
       0    1
0  17582  485
1    354  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.77214587, 'recall': 0.74903107, 'specificity': 0.74903107, 'f1': 0.760008, 'auroc': 0.8485259, 'binary_precision': 0.56540084, 'binary_recall': 0.5153846, 'binary_specificity': 0.98267746, 'binary_f1_score': 0.53923535}
confusion matrix:
      0    1
0  5843  103
1   126  134
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_23.png
early stop counter: 14
val acc:0.9552294611930847, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9690622091293335
after epoch: 23,now: 2024-06-24 01:16:43.414906,epoch time: 0:15:34.934179,used: 5:59:07.461128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9744334, 'precision': 0.97013086, 'recall': 0.9619536, 'specificity': 0.9619536, 'f1': 0.96595037, 'auroc': 0.9934492, 'binary_precision': 0.9616234, 'binary_recall': 0.9366158, 'binary_specificity': 0.98729134, 'binary_f1_score': 0.9489549}
confusion matrix:
       0      1
0  41873    539
1    914  13506
---- Validation: 
scalar performance:
{'acc': 0.9560299, 'precision': 0.6940284, 'recall': 0.7325746, 'specificity': 0.7325746, 'f1': 0.7112993, 'auroc': 0.8517082, 'binary_precision': 0.4071341, 'binary_recall': 0.49182764, 'binary_specificity': 0.9733215, 'binary_f1_score': 0.44549125}
confusion matrix:
       0    1
0  17585  482
1    342  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.78991854, 'recall': 0.75020826, 'specificity': 0.75020826, 'f1': 0.76842105, 'auroc': 0.87095976, 'binary_precision': 0.60089684, 'binary_recall': 0.5153846, 'binary_specificity': 0.98503196, 'binary_f1_score': 0.55486536}
confusion matrix:
      0    1
0  5857   89
1   126  134
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_24.png
early stop counter: 15
val acc:0.9560298919677734, best validation acc: 0.959498405456543, corresponding to test acc:                         0.9661617875099182 / 0.9690622091293335
after epoch: 24,now: 2024-06-24 01:32:41.150005,epoch time: 0:15:57.735099,used: 6:15:05.196227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9729026, 'precision': 0.9725467, 'recall': 0.9553871, 'specificity': 0.9553871, 'f1': 0.9635691, 'auroc': 0.99309886, 'binary_precision': 0.97186196, 'binary_recall': 0.919828, 'binary_specificity': 0.9909462, 'binary_f1_score': 0.9451293}
confusion matrix:
       0      1
0  42029    384
1   1156  13263
---- Validation: 
scalar performance:
{'acc': 0.9596051, 'precision': 0.70716333, 'recall': 0.7015265, 'specificity': 0.7015265, 'f1': 0.70430076, 'auroc': 0.8349009, 'binary_precision': 0.4357798, 'binary_recall': 0.42347696, 'binary_specificity': 0.97957605, 'binary_f1_score': 0.42954034}
confusion matrix:
       0    1
0  17698  369
1    388  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.8134315, 'recall': 0.72346437, 'specificity': 0.72346437, 'f1': 0.76005924, 'auroc': 0.855244, 'binary_precision': 0.6502732, 'binary_recall': 0.4576923, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.53724605}
confusion matrix:
      0    1
0  5882   64
1   141  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_25.png
better model found
persisted
after epoch: 25,now: 2024-06-24 01:48:05.772142,epoch time: 0:15:24.622137,used: 6:30:29.818364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.97300816, 'precision': 0.97352535, 'recall': 0.95472544, 'specificity': 0.95472544, 'f1': 0.9636501, 'auroc': 0.993986, 'binary_precision': 0.97451574, 'binary_recall': 0.91760874, 'binary_specificity': 0.99184215, 'binary_f1_score': 0.9452065}
confusion matrix:
       0      1
0  42067    346
1   1188  13231
---- Validation: 
scalar performance:
{'acc': 0.96093917, 'precision': 0.71633756, 'recall': 0.7057947, 'specificity': 0.7057947, 'f1': 0.7109172, 'auroc': 0.83574057, 'binary_precision': 0.45383412, 'binary_recall': 0.4309064, 'binary_specificity': 0.980683, 'binary_f1_score': 0.4420732}
confusion matrix:
       0    1
0  17718  349
1    383  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.8386104, 'recall': 0.71703345, 'specificity': 0.71703345, 'f1': 0.76313496, 'auroc': 0.8579546, 'binary_precision': 0.7012195, 'binary_recall': 0.44230768, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.5424528}
confusion matrix:
      0    1
0  5897   49
1   145  115
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_26.png
better model found
persisted
after epoch: 26,now: 2024-06-24 02:03:15.563212,epoch time: 0:15:09.791070,used: 6:45:39.609434,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9736592, 'precision': 0.9708048, 'recall': 0.95914406, 'specificity': 0.95914406, 'f1': 0.9647887, 'auroc': 0.99338675, 'binary_precision': 0.96522176, 'binary_recall': 0.9296761, 'binary_specificity': 0.988612, 'binary_f1_score': 0.94711554}
confusion matrix:
       0      1
0  41930    483
1   1014  13405
---- Validation: 
scalar performance:
{'acc': 0.95848453, 'precision': 0.7037182, 'recall': 0.718827, 'specificity': 0.718827, 'f1': 0.7109643, 'auroc': 0.8557383, 'binary_precision': 0.4275862, 'binary_recall': 0.46062407, 'binary_specificity': 0.9770299, 'binary_f1_score': 0.44349068}
confusion matrix:
       0    1
0  17652  415
1    363  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703513, 'precision': 0.8394448, 'recall': 0.7509761, 'specificity': 0.7509761, 'f1': 0.7878645, 'auroc': 0.8689602, 'binary_precision': 0.7, 'binary_recall': 0.51153845, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.59111106}
confusion matrix:
      0    1
0  5889   57
1   127  133
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_27.png
new oracle model saved
early stop counter: 1
val acc:0.9584845304489136, best validation acc: 0.9609391689300537, corresponding to test acc:                         0.968739926815033 / 0.9703512787818909
after epoch: 27,now: 2024-06-24 02:18:24.711591,epoch time: 0:15:09.148379,used: 7:00:48.757813,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9748557, 'precision': 0.97549814, 'recall': 0.9577027, 'specificity': 0.9577027, 'f1': 0.96617633, 'auroc': 0.99372375, 'binary_precision': 0.97673225, 'binary_recall': 0.9228795, 'binary_specificity': 0.9925259, 'binary_f1_score': 0.94904256}
confusion matrix:
       0      1
0  42096    317
1   1112  13307
---- Validation: 
scalar performance:
{'acc': 0.9627001, 'precision': 0.72775954, 'recall': 0.69597894, 'specificity': 0.69597894, 'f1': 0.71052974, 'auroc': 0.8439201, 'binary_precision': 0.47743055, 'binary_recall': 0.40861812, 'binary_specificity': 0.9833398, 'binary_f1_score': 0.4403523}
confusion matrix:
       0    1
0  17766  301
1    398  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97196263, 'precision': 0.8914547, 'recall': 0.7150372, 'specificity': 0.7150372, 'f1': 0.77525723, 'auroc': 0.86928314, 'binary_precision': 0.80714285, 'binary_recall': 0.43461537, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.565}
confusion matrix:
      0    1
0  5919   27
1   147  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_28.png
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-06-24 02:33:38.795012,epoch time: 0:15:14.083421,used: 7:16:02.841234,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9758763, 'precision': 0.97045755, 'recall': 0.9655732, 'specificity': 0.9655732, 'f1': 0.9679825, 'auroc': 0.9940938, 'binary_precision': 0.95963085, 'binary_recall': 0.9446564, 'binary_specificity': 0.98649, 'binary_f1_score': 0.9520847}
confusion matrix:
       0      1
0  41840    573
1    798  13621
---- Validation: 
scalar performance:
{'acc': 0.9564568, 'precision': 0.6963289, 'recall': 0.7342265, 'specificity': 0.7342265, 'f1': 0.7133624, 'auroc': 0.84298074, 'binary_precision': 0.41161928, 'binary_recall': 0.4947994, 'binary_specificity': 0.9736536, 'binary_f1_score': 0.4493927}
confusion matrix:
       0    1
0  17591  476
1    340  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.79420143, 'recall': 0.7374195, 'specificity': 0.7374195, 'f1': 0.7624091, 'auroc': 0.8647487, 'binary_precision': 0.6105769, 'binary_recall': 0.48846152, 'binary_specificity': 0.9863774, 'binary_f1_score': 0.54273504}
confusion matrix:
      0    1
0  5865   81
1   133  127
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_29.png
early stop counter: 1
val acc:0.9564567804336548, best validation acc: 0.9627001285552979, corresponding to test acc:                         0.9719626307487488 / 0.9719626307487488
after epoch: 29,now: 2024-06-24 02:48:51.452322,epoch time: 0:15:12.657310,used: 7:31:15.498544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9776182, 'precision': 0.97761977, 'recall': 0.96294314, 'specificity': 0.96294314, 'f1': 0.96999365, 'auroc': 0.9946837, 'binary_precision': 0.9776228, 'binary_recall': 0.9331484, 'binary_specificity': 0.9927379, 'binary_f1_score': 0.954868}
confusion matrix:
       0      1
0  42104    308
1    964  13456
---- Validation: 
scalar performance:
{'acc': 0.9608858, 'precision': 0.7159824, 'recall': 0.70576704, 'specificity': 0.70576704, 'f1': 0.71073467, 'auroc': 0.8396484, 'binary_precision': 0.453125, 'binary_recall': 0.4309064, 'binary_specificity': 0.98062766, 'binary_f1_score': 0.44173646}
confusion matrix:
       0    1
0  17717  350
1    383  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.8312566, 'recall': 0.7223822, 'specificity': 0.7223822, 'f1': 0.76496786, 'auroc': 0.86513555, 'binary_precision': 0.68604654, 'binary_recall': 0.45384616, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.5462963}
confusion matrix:
      0    1
0  5892   54
1   142  118
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_30.png
early stop counter: 2
val acc:0.9608858227729797, best validation acc: 0.9627001285552979, corresponding to test acc:                         0.9719626307487488 / 0.9719626307487488
after epoch: 30,now: 2024-06-24 03:04:12.300288,epoch time: 0:15:20.847966,used: 7:46:36.346510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_19_17_35_seed_1_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:46:36.346510 at 2024-06-24 03:04:12.300288
persisted model performance metric: 

scalar performance:
{'acc': 0.97196263, 'precision': 0.8914547, 'recall': 0.7150372, 'specificity': 0.7150372, 'f1': 0.77525723, 'auroc': 0.86928314, 'binary_precision': 0.80714285, 'binary_recall': 0.43461537, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.565}
confusion matrix:
      0    1
0  5919   27
1   147  113
oracle model performance metric: 

scalar performance:
{'acc': 0.97196263, 'precision': 0.8914547, 'recall': 0.7150372, 'specificity': 0.7150372, 'f1': 0.77525723, 'auroc': 0.86928314, 'binary_precision': 0.80714285, 'binary_recall': 0.43461537, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.565}
confusion matrix:
      0    1
0  5919   27
1   147  113
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204071 KiB | 640729 KiB |   1959 TiB |   1959 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1958 TiB |   1958 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204071 KiB | 640729 KiB |   1959 TiB |   1959 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1958 TiB |   1958 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 632296 KiB |   1950 TiB |   1950 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   1949 TiB |   1949 TiB |
|       from small pool |  35966 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1120 MiB | 471040 KiB |
|       from large pool | 600064 KiB | 679936 KiB |   1020 MiB | 444416 KiB |
|       from small pool |  75776 KiB |  75776 KiB |    100 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80600 KiB | 218089 KiB | 726562 GiB | 726562 GiB |
|       from large pool |  68480 KiB | 217080 KiB | 725913 GiB | 725913 GiB |
|       from small pool |  12120 KiB |  19703 KiB |    649 GiB |    649 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    7879    |  173077 K  |  173074 K  |
|       from large pool |      36    |      76    |   70177 K  |   70177 K  |
|       from small pool |    3192    |    7842    |  102900 K  |  102896 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    7879    |  173077 K  |  173074 K  |
|       from large pool |      36    |      76    |   70177 K  |   70177 K  |
|       from small pool |    3192    |    7842    |  102900 K  |  102896 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      68    |      17    |
|       from large pool |      14    |      14    |      18    |       4    |
|       from small pool |      37    |      37    |      50    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3581    |   79058 K  |   79058 K  |
|       from large pool |       5    |      13    |   26459 K  |   26459 K  |
|       from small pool |      30    |    3574    |   52599 K  |   52599 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1959 TiB |   1959 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1959 TiB |   1959 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1950 TiB |   1950 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1949 TiB |   1949 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1120 MiB |    842 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 726563 GiB | 726563 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 725913 GiB | 725913 GiB |
|       from small pool |      0 KiB |  19715 KiB |    649 GiB |    649 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  173077 K  |  173077 K  |
|       from large pool |       2    |      76    |   70177 K  |   70177 K  |
|       from small pool |       0    |    7842    |  102900 K  |  102900 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  173077 K  |  173077 K  |
|       from large pool |       2    |      76    |   70177 K  |   70177 K  |
|       from small pool |       0    |    7842    |  102900 K  |  102900 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      68    |      34    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   79060 K  |   79060 K  |
|       from large pool |       3    |      13    |   26459 K  |   26459 K  |
|       from small pool |       0    |    3574    |   52601 K  |   52601 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1959 TiB |   1959 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1959 TiB |   1959 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1958 TiB |   1958 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1950 TiB |   1950 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1949 TiB |   1949 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1120 MiB |    842 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 726563 GiB | 726563 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 725913 GiB | 725913 GiB |
|       from small pool |      0 KiB |  19715 KiB |    649 GiB |    649 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  173077 K  |  173077 K  |
|       from large pool |       2    |      76    |   70177 K  |   70177 K  |
|       from small pool |       0    |    7842    |  102900 K  |  102900 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  173077 K  |  173077 K  |
|       from large pool |       2    |      76    |   70177 K  |   70177 K  |
|       from small pool |       0    |    7842    |  102900 K  |  102900 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      68    |      34    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   79060 K  |   79060 K  |
|       from large pool |       3    |      13    |   26459 K  |   26459 K  |
|       from small pool |       0    |    3574    |   52601 K  |   52601 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152

 Experiment start at: 2024-06-24 03:10:38.145819
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8575731, 'precision': 0.903338, 'recall': 0.7351455, 'specificity': 0.7351455, 'f1': 0.7746548, 'auroc': 0.9320358, 'binary_precision': 0.9651848, 'binary_recall': 0.476436, 'binary_specificity': 0.993855, 'binary_f1_score': 0.6379608}
confusion matrix:
       0     1
0  42051   260
1   7921  7208
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.962233, 'precision': 0.5572747, 'recall': 0.5147228, 'specificity': 0.5147228, 'f1': 0.51958156, 'auroc': 0.62784004, 'binary_precision': 0.14569536, 'binary_recall': 0.036544852, 'binary_specificity': 0.9929008, 'binary_f1_score': 0.058432937}
confusion matrix:
       0    1
0  18042  129
1    580   22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95752525, 'precision': 0.6141555, 'recall': 0.523858, 'specificity': 0.523858, 'f1': 0.5338013, 'auroc': 0.7004198, 'binary_precision': 0.26530612, 'binary_recall': 0.053719006, 'binary_specificity': 0.993997, 'binary_f1_score': 0.08934707}
confusion matrix:
      0   1
0  5961  36
1   229  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-24 03:26:59.924821,epoch time: 0:16:21.779002,used: 0:16:21.779002,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9090007, 'precision': 0.9222053, 'recall': 0.84056467, 'specificity': 0.84056467, 'f1': 0.8710712, 'auroc': 0.95892894, 'binary_precision': 0.94379705, 'binary_recall': 0.6959482, 'binary_specificity': 0.98518115, 'binary_f1_score': 0.8011413}
confusion matrix:
       0      1
0  41684    627
1   4600  10529
---- Validation: 
scalar performance:
{'acc': 0.95264477, 'precision': 0.5944272, 'recall': 0.5796351, 'specificity': 0.5796351, 'f1': 0.58626586, 'auroc': 0.7105242, 'binary_precision': 0.21584159, 'binary_recall': 0.18106312, 'binary_specificity': 0.97820705, 'binary_f1_score': 0.19692864}
confusion matrix:
       0    1
0  17775  396
1    493  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95207566, 'precision': 0.65246356, 'recall': 0.6102466, 'specificity': 0.6102466, 'f1': 0.6273658, 'auroc': 0.7645372, 'binary_precision': 0.33526012, 'binary_recall': 0.23966943, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.27951807}
confusion matrix:
      0    1
0  5882  115
1   184   58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_2.png
early stop counter: 1
val acc:0.9526447653770447, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9575252532958984
after epoch: 2,now: 2024-06-24 03:42:49.524361,epoch time: 0:15:49.599540,used: 0:32:11.378542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92822075, 'precision': 0.92904395, 'recall': 0.88259244, 'specificity': 0.88259244, 'f1': 0.90243644, 'auroc': 0.9698756, 'binary_precision': 0.9305273, 'binary_recall': 0.7861723, 'binary_specificity': 0.97901255, 'binary_f1_score': 0.8522805}
confusion matrix:
       0      1
0  41423    888
1   3235  11894
---- Validation: 
scalar performance:
{'acc': 0.94215095, 'precision': 0.5839363, 'recall': 0.60874546, 'specificity': 0.60874546, 'f1': 0.5943343, 'auroc': 0.7323873, 'binary_precision': 0.1928934, 'binary_recall': 0.25249168, 'binary_specificity': 0.9649992, 'binary_f1_score': 0.21870503}
confusion matrix:
       0    1
0  17535  636
1    450  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9447027, 'precision': 0.6425198, 'recall': 0.65994537, 'specificity': 0.65994537, 'f1': 0.6506291, 'auroc': 0.7709998, 'binary_precision': 0.31135532, 'binary_recall': 0.35123968, 'binary_specificity': 0.968651, 'binary_f1_score': 0.33009708}
confusion matrix:
      0    1
0  5809  188
1   157   85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_3.png
early stop counter: 2
val acc:0.9421509504318237, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9575252532958984
after epoch: 3,now: 2024-06-24 03:58:28.028307,epoch time: 0:15:38.503946,used: 0:47:49.882488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9395195, 'precision': 0.93818974, 'recall': 0.9034468, 'specificity': 0.9034468, 'f1': 0.91895145, 'auroc': 0.9785945, 'binary_precision': 0.93570095, 'binary_recall': 0.82721925, 'binary_specificity': 0.97967434, 'binary_f1_score': 0.87812245}
confusion matrix:
       0      1
0  41451    860
1   2614  12515
---- Validation: 
scalar performance:
{'acc': 0.94284344, 'precision': 0.60256505, 'recall': 0.6452403, 'specificity': 0.6452403, 'f1': 0.6194175, 'auroc': 0.7528527, 'binary_precision': 0.22774567, 'binary_recall': 0.32724252, 'binary_specificity': 0.9632381, 'binary_f1_score': 0.2685753}
confusion matrix:
       0    1
0  17503  668
1    405  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9490303, 'precision': 0.66748357, 'recall': 0.6859894, 'specificity': 0.6859894, 'f1': 0.67616546, 'auroc': 0.78805315, 'binary_precision': 0.35925925, 'binary_recall': 0.40082645, 'binary_specificity': 0.97115225, 'binary_f1_score': 0.37890622}
confusion matrix:
      0    1
0  5824  173
1   145   97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_4.png
early stop counter: 3
val acc:0.9428434371948242, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9575252532958984
after epoch: 4,now: 2024-06-24 04:14:26.219070,epoch time: 0:15:58.190763,used: 1:03:48.073251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9473886, 'precision': 0.94724995, 'recall': 0.9153749, 'specificity': 0.9153749, 'f1': 0.92977643, 'auroc': 0.98312974, 'binary_precision': 0.94698757, 'binary_recall': 0.8477198, 'binary_specificity': 0.98303, 'binary_f1_score': 0.8946084}
confusion matrix:
       0      1
0  41592    718
1   2304  12826
---- Validation: 
scalar performance:
{'acc': 0.94870293, 'precision': 0.62322605, 'recall': 0.6579037, 'specificity': 0.6579037, 'f1': 0.63802564, 'auroc': 0.7854035, 'binary_precision': 0.2682927, 'binary_recall': 0.34717607, 'binary_specificity': 0.9686313, 'binary_f1_score': 0.30267924}
confusion matrix:
       0    1
0  17601  570
1    393  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552813, 'precision': 0.69788945, 'recall': 0.68924093, 'specificity': 0.68924093, 'f1': 0.69345385, 'auroc': 0.80124974, 'binary_precision': 0.4199134, 'binary_recall': 0.40082645, 'binary_specificity': 0.9776555, 'binary_f1_score': 0.410148}
confusion matrix:
      0    1
0  5863  134
1   145   97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_5.png
early stop counter: 4
val acc:0.9487029314041138, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9575252532958984
after epoch: 5,now: 2024-06-24 04:30:24.918381,epoch time: 0:15:58.699311,used: 1:19:46.772562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9529248, 'precision': 0.94797826, 'recall': 0.92923427, 'specificity': 0.92923427, 'f1': 0.9380669, 'auroc': 0.98464835, 'binary_precision': 0.9382098, 'binary_recall': 0.87917244, 'binary_specificity': 0.97929615, 'binary_f1_score': 0.9077322}
confusion matrix:
       0      1
0  41435    876
1   1828  13301
---- Validation: 
scalar performance:
{'acc': 0.9452405, 'precision': 0.6208738, 'recall': 0.6769944, 'specificity': 0.6769944, 'f1': 0.64261705, 'auroc': 0.80194795, 'binary_precision': 0.2622768, 'binary_recall': 0.39036545, 'binary_specificity': 0.96362334, 'binary_f1_score': 0.31375167}
confusion matrix:
       0    1
0  17510  661
1    367  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9567238, 'precision': 0.7081745, 'recall': 0.69990504, 'specificity': 0.69990504, 'f1': 0.7039436, 'auroc': 0.80542976, 'binary_precision': 0.43965518, 'binary_recall': 0.4214876, 'binary_specificity': 0.9783225, 'binary_f1_score': 0.43037975}
confusion matrix:
      0    1
0  5867  130
1   140  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_6.png
early stop counter: 5
val acc:0.9452404975891113, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9575252532958984
after epoch: 6,now: 2024-06-24 04:46:14.152620,epoch time: 0:15:49.234239,used: 1:35:36.006801,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9535341, 'precision': 0.95826095, 'recall': 0.9211127, 'specificity': 0.9211127, 'f1': 0.93767786, 'auroc': 0.9869189, 'binary_precision': 0.9670865, 'binary_recall': 0.852601, 'binary_specificity': 0.98962444, 'binary_f1_score': 0.9062423}
confusion matrix:
       0      1
0  41872    439
1   2230  12899
---- Validation: 
scalar performance:
{'acc': 0.9582379, 'precision': 0.66418374, 'recall': 0.66523826, 'specificity': 0.66523826, 'f1': 0.6647091, 'auroc': 0.78850085, 'binary_precision': 0.34983498, 'binary_recall': 0.35215947, 'binary_specificity': 0.9783171, 'binary_f1_score': 0.3509934}
confusion matrix:
       0    1
0  17777  394
1    390  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.79119873, 'recall': 0.6951606, 'specificity': 0.6951606, 'f1': 0.7326814, 'auroc': 0.8143712, 'binary_precision': 0.60625, 'binary_recall': 0.40082645, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.48258704}
confusion matrix:
      0   1
0  5934  63
1   145  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_7.png
new oracle model saved
early stop counter: 6
val acc:0.958237886428833, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9666613340377808
after epoch: 7,now: 2024-06-24 05:02:10.265042,epoch time: 0:15:56.112422,used: 1:51:32.119223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95947075, 'precision': 0.9565085, 'recall': 0.9379486, 'specificity': 0.9379486, 'f1': 0.9467124, 'auroc': 0.98543537, 'binary_precision': 0.9506477, 'binary_recall': 0.8924653, 'binary_specificity': 0.9834318, 'binary_f1_score': 0.9206382}
confusion matrix:
       0      1
0  41609    701
1   1627  13503
---- Validation: 
scalar performance:
{'acc': 0.9508336, 'precision': 0.6405665, 'recall': 0.686308, 'specificity': 0.686308, 'f1': 0.6596919, 'auroc': 0.77279663, 'binary_precision': 0.30111524, 'binary_recall': 0.4036545, 'binary_specificity': 0.96896154, 'binary_f1_score': 0.3449255}
confusion matrix:
       0    1
0  17607  564
1    359  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.956243, 'precision': 0.7067661, 'recall': 0.70758593, 'specificity': 0.70758593, 'f1': 0.7071751, 'auroc': 0.8006789, 'binary_precision': 0.436214, 'binary_recall': 0.43801653, 'binary_specificity': 0.97715527, 'binary_f1_score': 0.43711343}
confusion matrix:
      0    1
0  5860  137
1   136  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_8.png
early stop counter: 7
val acc:0.9508336186408997, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9666613340377808
after epoch: 8,now: 2024-06-24 05:17:37.935683,epoch time: 0:15:27.670641,used: 2:06:59.789864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9611769, 'precision': 0.959013, 'recall': 0.9399346, 'specificity': 0.9399346, 'f1': 0.94893265, 'auroc': 0.987985, 'binary_precision': 0.9547377, 'binary_recall': 0.89504296, 'binary_specificity': 0.98482627, 'binary_f1_score': 0.9239271}
confusion matrix:
       0      1
0  41668    642
1   1588  13542
---- Validation: 
scalar performance:
{'acc': 0.95184577, 'precision': 0.6450114, 'recall': 0.68924, 'specificity': 0.68924, 'f1': 0.66371435, 'auroc': 0.796973, 'binary_precision': 0.3098237, 'binary_recall': 0.40863788, 'binary_specificity': 0.9698421, 'binary_f1_score': 0.35243556}
confusion matrix:
       0    1
0  17623  548
1    356  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94854945, 'precision': 0.67487884, 'recall': 0.7194458, 'specificity': 0.7194458, 'f1': 0.6941957, 'auroc': 0.8150308, 'binary_precision': 0.3713355, 'binary_recall': 0.47107437, 'binary_specificity': 0.96781725, 'binary_f1_score': 0.41530055}
confusion matrix:
      0    1
0  5804  193
1   128  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_9.png
early stop counter: 8
val acc:0.9518457651138306, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9666613340377808
after epoch: 9,now: 2024-06-24 05:32:49.526297,epoch time: 0:15:11.590614,used: 2:22:11.380478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95985377, 'precision': 0.96009594, 'recall': 0.93544877, 'specificity': 0.93544877, 'f1': 0.94687873, 'auroc': 0.98795474, 'binary_precision': 0.960566, 'binary_recall': 0.8838731, 'binary_specificity': 0.98702437, 'binary_f1_score': 0.92062515}
confusion matrix:
       0      1
0  41761    549
1   1757  13373
---- Validation: 
scalar performance:
{'acc': 0.95413625, 'precision': 0.658093, 'recall': 0.704075, 'specificity': 0.704075, 'f1': 0.67771214, 'auroc': 0.8173661, 'binary_precision': 0.33503184, 'binary_recall': 0.43687707, 'binary_specificity': 0.9712729, 'binary_f1_score': 0.37923577}
confusion matrix:
       0    1
0  17649  522
1    339  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.7379017, 'recall': 0.7180181, 'specificity': 0.7180181, 'f1': 0.7274686, 'auroc': 0.8401563, 'binary_precision': 0.49773756, 'binary_recall': 0.45454547, 'binary_specificity': 0.98149073, 'binary_f1_score': 0.47516197}
confusion matrix:
      0    1
0  5886  111
1   132  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_10.png
early stop counter: 9
val acc:0.9541362524032593, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9666613340377808
after epoch: 10,now: 2024-06-24 05:48:42.391277,epoch time: 0:15:52.864980,used: 2:38:04.245458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96554667, 'precision': 0.96670735, 'recall': 0.9438349, 'specificity': 0.9438349, 'f1': 0.95451385, 'auroc': 0.9899607, 'binary_precision': 0.9689751, 'binary_recall': 0.89795107, 'binary_specificity': 0.98971874, 'binary_f1_score': 0.9321121}
confusion matrix:
       0      1
0  41875    435
1   1544  13586
---- Validation: 
scalar performance:
{'acc': 0.9571725, 'precision': 0.6652113, 'recall': 0.68476415, 'specificity': 0.68476415, 'f1': 0.6743619, 'auroc': 0.8014505, 'binary_precision': 0.35059172, 'binary_recall': 0.3936877, 'binary_specificity': 0.9758406, 'binary_f1_score': 0.37089202}
confusion matrix:
       0    1
0  17732  439
1    365  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.7423116, 'recall': 0.7104206, 'specificity': 0.7104206, 'f1': 0.72509724, 'auroc': 0.8129636, 'binary_precision': 0.50717705, 'binary_recall': 0.43801653, 'binary_specificity': 0.98282474, 'binary_f1_score': 0.47006652}
confusion matrix:
      0    1
0  5894  103
1   136  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_11.png
early stop counter: 10
val acc:0.9571725130081177, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9666613340377808
after epoch: 11,now: 2024-06-24 06:03:56.615723,epoch time: 0:15:14.224446,used: 2:53:18.469904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9630571, 'precision': 0.9626993, 'recall': 0.94123214, 'specificity': 0.94123214, 'f1': 0.9512899, 'auroc': 0.9903069, 'binary_precision': 0.96199745, 'binary_recall': 0.89510906, 'binary_specificity': 0.98735523, 'binary_f1_score': 0.9273487}
confusion matrix:
       0      1
0  41775    535
1   1587  13543
---- Validation: 
scalar performance:
{'acc': 0.9572791, 'precision': 0.6681359, 'recall': 0.6928497, 'specificity': 0.6928497, 'f1': 0.67952436, 'auroc': 0.8165386, 'binary_precision': 0.35590777, 'binary_recall': 0.410299, 'binary_specificity': 0.9754004, 'binary_f1_score': 0.38117287}
confusion matrix:
       0    1
0  17724  447
1    355  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.79338586, 'recall': 0.71333873, 'specificity': 0.71333873, 'f1': 0.74635136, 'auroc': 0.8243089, 'binary_precision': 0.6091954, 'binary_recall': 0.43801653, 'binary_specificity': 0.988661, 'binary_f1_score': 0.5096154}
confusion matrix:
      0    1
0  5929   68
1   136  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_12.png
new oracle model saved
early stop counter: 11
val acc:0.9572790861129761, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9673024415969849
after epoch: 12,now: 2024-06-24 06:19:08.294613,epoch time: 0:15:11.678890,used: 3:08:30.148794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96538997, 'precision': 0.9670781, 'recall': 0.94309163, 'specificity': 0.94309163, 'f1': 0.95425415, 'auroc': 0.99018025, 'binary_precision': 0.97036505, 'binary_recall': 0.89596826, 'binary_specificity': 0.99021506, 'binary_f1_score': 0.9316839}
confusion matrix:
       0      1
0  41896    414
1   1574  13556
---- Validation: 
scalar performance:
{'acc': 0.9582912, 'precision': 0.67598724, 'recall': 0.7038121, 'specificity': 0.7038121, 'f1': 0.6887374, 'auroc': 0.8195262, 'binary_precision': 0.37089872, 'binary_recall': 0.43189368, 'binary_specificity': 0.97573054, 'binary_f1_score': 0.39907902}
confusion matrix:
       0    1
0  17730  441
1    342  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.77341926, 'recall': 0.714321, 'specificity': 0.714321, 'f1': 0.73987305, 'auroc': 0.82880473, 'binary_precision': 0.56914896, 'binary_recall': 0.44214877, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.49767447}
confusion matrix:
      0    1
0  5916   81
1   135  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_13.png
early stop counter: 12
val acc:0.9582911729812622, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9673024415969849
after epoch: 13,now: 2024-06-24 06:34:25.000515,epoch time: 0:15:16.705902,used: 3:23:46.854696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9673398, 'precision': 0.9650071, 'recall': 0.95012057, 'specificity': 0.95012057, 'f1': 0.9572381, 'auroc': 0.99036384, 'binary_precision': 0.96033067, 'binary_recall': 0.9137361, 'binary_specificity': 0.98650503, 'binary_f1_score': 0.9364541}
confusion matrix:
       0      1
0  41741    571
1   1305  13823
---- Validation: 
scalar performance:
{'acc': 0.95328397, 'precision': 0.65449685, 'recall': 0.7028317, 'specificity': 0.7028317, 'f1': 0.67487764, 'auroc': 0.8107166, 'binary_precision': 0.3279099, 'binary_recall': 0.43521595, 'binary_specificity': 0.9704474, 'binary_f1_score': 0.37401855}
confusion matrix:
       0    1
0  17634  537
1    340  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9570444, 'precision': 0.71135765, 'recall': 0.7080028, 'specificity': 0.7080028, 'f1': 0.7096648, 'auroc': 0.8096488, 'binary_precision': 0.44537815, 'binary_recall': 0.43801653, 'binary_specificity': 0.977989, 'binary_f1_score': 0.44166666}
confusion matrix:
      0    1
0  5865  132
1   136  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_14.png
early stop counter: 13
val acc:0.953283965587616, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9673024415969849
after epoch: 14,now: 2024-06-24 06:49:42.354844,epoch time: 0:15:17.354329,used: 3:39:04.209025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9684192, 'precision': 0.96702194, 'recall': 0.9509436, 'specificity': 0.9509436, 'f1': 0.9586054, 'auroc': 0.9921136, 'binary_precision': 0.96423095, 'binary_recall': 0.9140119, 'binary_specificity': 0.9878752, 'binary_f1_score': 0.9384501}
confusion matrix:
       0      1
0  41797    513
1   1301  13829
---- Validation: 
scalar performance:
{'acc': 0.9568529, 'precision': 0.67148393, 'recall': 0.71190274, 'specificity': 0.71190274, 'f1': 0.68925405, 'auroc': 0.8301145, 'binary_precision': 0.36133334, 'binary_recall': 0.4501661, 'binary_specificity': 0.9736393, 'binary_f1_score': 0.40088755}
confusion matrix:
       0    1
0  17692  479
1    331  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.75778097, 'recall': 0.71142113, 'specificity': 0.71142113, 'f1': 0.73203015, 'auroc': 0.8335594, 'binary_precision': 0.53807104, 'binary_recall': 0.43801653, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.4829157}
confusion matrix:
      0    1
0  5906   91
1   136  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_15.png
early stop counter: 14
val acc:0.956852912902832, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9673024415969849
after epoch: 15,now: 2024-06-24 07:04:58.841330,epoch time: 0:15:16.486486,used: 3:54:20.695511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96831477, 'precision': 0.96375406, 'recall': 0.9540123, 'specificity': 0.9540123, 'f1': 0.958742, 'auroc': 0.9912311, 'binary_precision': 0.95444924, 'binary_recall': 0.9237887, 'binary_specificity': 0.98423576, 'binary_f1_score': 0.93886876}
confusion matrix:
       0      1
0  41644    667
1   1153  13976
---- Validation: 
scalar performance:
{'acc': 0.95429605, 'precision': 0.6680014, 'recall': 0.73868865, 'specificity': 0.73868865, 'f1': 0.6962717, 'auroc': 0.8438901, 'binary_precision': 0.35253456, 'binary_recall': 0.50830567, 'binary_specificity': 0.9690716, 'binary_f1_score': 0.41632655}
confusion matrix:
       0    1
0  17609  562
1    296  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.7379017, 'recall': 0.7180181, 'specificity': 0.7180181, 'f1': 0.7274686, 'auroc': 0.8420533, 'binary_precision': 0.49773756, 'binary_recall': 0.45454547, 'binary_specificity': 0.98149073, 'binary_f1_score': 0.47516197}
confusion matrix:
      0    1
0  5886  111
1   132  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_16.png
early stop counter: 15
val acc:0.9542960524559021, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9673024415969849
after epoch: 16,now: 2024-06-24 07:20:15.478617,epoch time: 0:15:16.637287,used: 4:09:37.332798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96810585, 'precision': 0.9645093, 'recall': 0.95266026, 'specificity': 0.95266026, 'f1': 0.9583772, 'auroc': 0.9913761, 'binary_precision': 0.9572244, 'binary_recall': 0.9200212, 'binary_specificity': 0.98529935, 'binary_f1_score': 0.9382541}
confusion matrix:
       0      1
0  41689    622
1   1210  13919
---- Validation: 
scalar performance:
{'acc': 0.95482874, 'precision': 0.6686827, 'recall': 0.73334247, 'specificity': 0.73334247, 'f1': 0.6950322, 'auroc': 0.83681726, 'binary_precision': 0.3542654, 'binary_recall': 0.49667773, 'binary_specificity': 0.9700072, 'binary_f1_score': 0.41355464}
confusion matrix:
       0    1
0  17626  545
1    303  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.7401092, 'recall': 0.71620214, 'specificity': 0.71620214, 'f1': 0.727447, 'auroc': 0.83596206, 'binary_precision': 0.50230414, 'binary_recall': 0.45041323, 'binary_specificity': 0.981991, 'binary_f1_score': 0.47494552}
confusion matrix:
      0    1
0  5889  108
1   133  109
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_17.png
early stop counter: 16
val acc:0.9548287391662598, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9673024415969849
after epoch: 17,now: 2024-06-24 07:36:03.861755,epoch time: 0:15:48.383138,used: 4:25:25.715936,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9711351, 'precision': 0.9633168, 'recall': 0.9622129, 'specificity': 0.9622129, 'f1': 0.9627631, 'auroc': 0.99260974, 'binary_precision': 0.94686216, 'binary_recall': 0.9433576, 'binary_specificity': 0.9810683, 'binary_f1_score': 0.9451066}
confusion matrix:
       0      1
0  41509    801
1    857  14273
---- Validation: 
scalar performance:
{'acc': 0.94934213, 'precision': 0.65426093, 'recall': 0.7489784, 'specificity': 0.7489784, 'f1': 0.68865454, 'auroc': 0.84279794, 'binary_precision': 0.3242699, 'binary_recall': 0.53488374, 'binary_specificity': 0.963073, 'binary_f1_score': 0.40376174}
confusion matrix:
       0    1
0  17500  671
1    280  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9544799, 'precision': 0.70354337, 'recall': 0.7403754, 'specificity': 0.7403754, 'f1': 0.72019064, 'auroc': 0.8478633, 'binary_precision': 0.42708334, 'binary_recall': 0.5082645, 'binary_specificity': 0.97248626, 'binary_f1_score': 0.46415097}
confusion matrix:
      0    1
0  5832  165
1   119  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_18.png
early stop counter: 17
val acc:0.9493421316146851, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9673024415969849
after epoch: 18,now: 2024-06-24 07:51:20.251130,epoch time: 0:15:16.389375,used: 4:40:42.105311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97094357, 'precision': 0.9693674, 'recall': 0.9552046, 'specificity': 0.9552046, 'f1': 0.96199435, 'auroc': 0.99253696, 'binary_precision': 0.96619797, 'binary_recall': 0.9219432, 'binary_specificity': 0.9884661, 'binary_f1_score': 0.94355196}
confusion matrix:
       0      1
0  41822    488
1   1181  13949
---- Validation: 
scalar performance:
{'acc': 0.9572258, 'precision': 0.6779365, 'recall': 0.7313685, 'specificity': 0.7313685, 'f1': 0.70066756, 'auroc': 0.83409125, 'binary_precision': 0.37294564, 'binary_recall': 0.4900332, 'binary_specificity': 0.97270375, 'binary_f1_score': 0.4235463}
confusion matrix:
       0    1
0  17675  496
1    307  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.76000154, 'recall': 0.71951884, 'specificity': 0.71951884, 'f1': 0.7378417, 'auroc': 0.8414478, 'binary_precision': 0.5418719, 'binary_recall': 0.45454547, 'binary_specificity': 0.98449224, 'binary_f1_score': 0.49438202}
confusion matrix:
      0    1
0  5904   93
1   132  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_19.png
early stop counter: 18
val acc:0.9572257995605469, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9673024415969849
after epoch: 19,now: 2024-06-24 08:06:33.328319,epoch time: 0:15:13.077189,used: 4:55:55.182500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.97094357, 'precision': 0.970292, 'recall': 0.9542892, 'specificity': 0.9542892, 'f1': 0.96192014, 'auroc': 0.99262136, 'binary_precision': 0.96898955, 'binary_recall': 0.91909575, 'binary_specificity': 0.98948264, 'binary_f1_score': 0.9433834}
confusion matrix:
       0      1
0  41866    445
1   1224  13905
---- Validation: 
scalar performance:
{'acc': 0.95962286, 'precision': 0.6864352, 'recall': 0.7197579, 'specificity': 0.7197579, 'f1': 0.7015451, 'auroc': 0.82855475, 'binary_precision': 0.3907563, 'binary_recall': 0.46345514, 'binary_specificity': 0.97606075, 'binary_f1_score': 0.42401215}
confusion matrix:
       0    1
0  17736  435
1    323  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.75475883, 'recall': 0.71918535, 'specificity': 0.71918535, 'f1': 0.7354702, 'auroc': 0.84211314, 'binary_precision': 0.531401, 'binary_recall': 0.45454547, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.48997775}
confusion matrix:
      0    1
0  5900   97
1   132  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_20.png
early stop counter: 19
val acc:0.959622859954834, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9673024415969849
after epoch: 20,now: 2024-06-24 08:21:50.535105,epoch time: 0:15:17.206786,used: 5:11:12.389286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97231895, 'precision': 0.96991384, 'recall': 0.95826113, 'specificity': 0.95826113, 'f1': 0.9638896, 'auroc': 0.9933262, 'binary_precision': 0.9650364, 'binary_recall': 0.92855257, 'binary_specificity': 0.98796976, 'binary_f1_score': 0.94644296}
confusion matrix:
       0      1
0  41801    509
1   1081  14049
---- Validation: 
scalar performance:
{'acc': 0.9589304, 'precision': 0.6866715, 'recall': 0.7362642, 'specificity': 0.7362642, 'f1': 0.70816183, 'auroc': 0.84497267, 'binary_precision': 0.39011705, 'binary_recall': 0.49833888, 'binary_specificity': 0.97418964, 'binary_f1_score': 0.43763676}
confusion matrix:
       0    1
0  17702  469
1    302  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.78436553, 'recall': 0.7309333, 'specificity': 0.7309333, 'f1': 0.75456226, 'auroc': 0.8482003, 'binary_precision': 0.5897436, 'binary_recall': 0.4752066, 'binary_specificity': 0.98666, 'binary_f1_score': 0.5263158}
confusion matrix:
      0    1
0  5917   80
1   127  115
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551152_21.png
early stop counter: 20
val acc:0.9589303731918335, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9575252532958984 / 0.9673024415969849
after epoch: 21,now: 2024-06-24 08:37:14.160343,epoch time: 0:15:23.625238,used: 5:26:36.014524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_10_38_seed_2_21551152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 5:26:36.014524 at 2024-06-24 08:37:14.160343
persisted model performance metric: 

scalar performance:
{'acc': 0.95752525, 'precision': 0.6141555, 'recall': 0.523858, 'specificity': 0.523858, 'f1': 0.5338013, 'auroc': 0.7004198, 'binary_precision': 0.26530612, 'binary_recall': 0.053719006, 'binary_specificity': 0.993997, 'binary_f1_score': 0.08934707}
confusion matrix:
      0   1
0  5961  36
1   229  13
oracle model performance metric: 

scalar performance:
{'acc': 0.96730244, 'precision': 0.79338586, 'recall': 0.71333873, 'specificity': 0.71333873, 'f1': 0.74635136, 'auroc': 0.8243089, 'binary_precision': 0.6091954, 'binary_recall': 0.43801653, 'binary_specificity': 0.988661, 'binary_f1_score': 0.5096154}
confusion matrix:
      0    1
0  5929   68
1   136  106
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204077 KiB | 640729 KiB |   2773 TiB |   2773 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2772 TiB |   2772 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204077 KiB | 640729 KiB |   2773 TiB |   2773 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2772 TiB |   2772 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 632296 KiB |   2759 TiB |   2759 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   2758 TiB |   2758 TiB |
|       from small pool |  35967 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1502 MiB |    842 MiB |
|       from large pool | 600064 KiB | 679936 KiB |   1376 MiB |    790 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    126 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  82642 KiB | 218089 KiB |    986 TiB |    986 TiB |
|       from large pool |  68480 KiB | 217080 KiB |    985 TiB |    985 TiB |
|       from small pool |  14162 KiB |  19715 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    7929    |  244930 K  |  244927 K  |
|       from large pool |      36    |      76    |   99316 K  |   99316 K  |
|       from small pool |    3204    |    7892    |  145613 K  |  145610 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    7929    |  244930 K  |  244927 K  |
|       from large pool |      36    |      76    |   99316 K  |   99316 K  |
|       from small pool |    3204    |    7892    |  145613 K  |  145610 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      85    |      34    |
|       from large pool |      14    |      14    |      22    |       8    |
|       from small pool |      37    |      37    |      63    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3604    |  112306 K  |  112306 K  |
|       from large pool |       5    |      13    |   37843 K  |   37843 K  |
|       from small pool |      32    |    3599    |   74462 K  |   74462 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   2773 TiB |   2773 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2772 TiB |   2772 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   2773 TiB |   2773 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2772 TiB |   2772 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   2759 TiB |   2759 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2758 TiB |   2758 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 755712 KiB |   1502 MiB |   1222 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1376 MiB |   1146 MiB |
|       from small pool |  51200 KiB |  75776 KiB |    126 MiB |     76 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB |    986 TiB |    986 TiB |
|       from large pool |  55040 KiB | 217080 KiB |    985 TiB |    985 TiB |
|       from small pool |      0 KiB |  21757 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7929    |  244930 K  |  244930 K  |
|       from large pool |       2    |      76    |   99316 K  |   99316 K  |
|       from small pool |       0    |    7892    |  145613 K  |  145613 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7929    |  244930 K  |  244930 K  |
|       from large pool |       2    |      76    |   99316 K  |   99316 K  |
|       from small pool |       0    |    7892    |  145613 K  |  145613 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      51    |      85    |      50    |
|       from large pool |      10    |      14    |      22    |      12    |
|       from small pool |      25    |      37    |      63    |      38    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3604    |  112307 K  |  112307 K  |
|       from large pool |       3    |      13    |   37843 K  |   37843 K  |
|       from small pool |       0    |    3599    |   74463 K  |   74463 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jun 24 08:38:13 2024]
Finished job 0.
1 of 1 steps (100%) done
