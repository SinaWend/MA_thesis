Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun 23 13:13:24 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148

 Experiment start at: 2024-06-23 13:21:30.317652
before training, model accuracy: 0.31128156185150146
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9123598, 'precision': 0.91824603, 'recall': 0.848258, 'specificity': 0.848258, 'f1': 0.8757132, 'auroc': 0.9624182, 'binary_precision': 0.92802393, 'binary_recall': 0.71581954, 'binary_specificity': 0.98069656, 'binary_f1_score': 0.808225}
confusion matrix:
       0      1
0  41507    817
1   4182  10534
---- Validation: 
scalar performance:
{'acc': 0.9446573, 'precision': 0.5803014, 'recall': 0.57981944, 'specificity': 0.57981944, 'f1': 0.5800595, 'auroc': 0.6629709, 'binary_precision': 0.18935837, 'binary_recall': 0.1881804, 'binary_specificity': 0.9714585, 'binary_f1_score': 0.18876755}
confusion matrix:
       0    1
0  17631  518
1    522  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9482263, 'precision': 0.65492755, 'recall': 0.6193461, 'specificity': 0.6193461, 'f1': 0.6343888, 'auroc': 0.75694454, 'binary_precision': 0.34170854, 'binary_recall': 0.2605364, 'binary_specificity': 0.97815573, 'binary_f1_score': 0.29565218}
confusion matrix:
      0    1
0  5866  131
1   193   68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-23 13:49:20.749716,epoch time: 0:27:50.432064,used: 0:27:50.432064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94407433, 'precision': 0.9428812, 'recall': 0.9088291, 'specificity': 0.9088291, 'f1': 0.92413956, 'auroc': 0.9786484, 'binary_precision': 0.94067734, 'binary_recall': 0.8359943, 'binary_specificity': 0.98166394, 'binary_f1_score': 0.8852518}
confusion matrix:
       0      1
0  41545    776
1   2414  12305
---- Validation: 
scalar performance:
{'acc': 0.94870156, 'precision': 0.6300245, 'recall': 0.6494182, 'specificity': 0.6494182, 'f1': 0.63892096, 'auroc': 0.7364707, 'binary_precision': 0.28398386, 'binary_recall': 0.3281493, 'binary_specificity': 0.9706871, 'binary_f1_score': 0.30447328}
confusion matrix:
       0    1
0  17617  532
1    432  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95270056, 'precision': 0.6973534, 'recall': 0.6711536, 'specificity': 0.6711536, 'f1': 0.6831707, 'auroc': 0.78645325, 'binary_precision': 0.42222223, 'binary_recall': 0.36398467, 'binary_specificity': 0.9783225, 'binary_f1_score': 0.3909465}
confusion matrix:
      0    1
0  5867  130
1   166   95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-23 14:15:42.485849,epoch time: 0:26:21.736133,used: 0:54:12.168197,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9536992, 'precision': 0.94922286, 'recall': 0.92831635, 'specificity': 0.92831635, 'f1': 0.938125, 'auroc': 0.98458993, 'binary_precision': 0.94060564, 'binary_recall': 0.8758663, 'binary_specificity': 0.9807665, 'binary_f1_score': 0.9070823}
confusion matrix:
       0      1
0  41508    814
1   1827  12891
---- Validation: 
scalar performance:
{'acc': 0.9487548, 'precision': 0.6385234, 'recall': 0.6704473, 'specificity': 0.6704473, 'f1': 0.65253496, 'auroc': 0.7675835, 'binary_precision': 0.29949874, 'binary_recall': 0.3716952, 'binary_specificity': 0.9691994, 'binary_f1_score': 0.33171406}
confusion matrix:
       0    1
0  17590  559
1    404  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95254076, 'precision': 0.70154846, 'recall': 0.69489056, 'specificity': 0.69489056, 'f1': 0.69815445, 'auroc': 0.8024843, 'binary_precision': 0.42857143, 'binary_recall': 0.41379312, 'binary_specificity': 0.975988, 'binary_f1_score': 0.42105263}
confusion matrix:
      0    1
0  5853  144
1   153  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_3.png
better model found
persisted
after epoch: 3,now: 2024-06-23 14:36:34.105567,epoch time: 0:20:51.619718,used: 1:15:03.787915,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9606241, 'precision': 0.95641005, 'recall': 0.9396746, 'specificity': 0.9396746, 'f1': 0.94763565, 'auroc': 0.98831284, 'binary_precision': 0.9481817, 'binary_recall': 0.8963854, 'binary_specificity': 0.9829639, 'binary_f1_score': 0.9215563}
confusion matrix:
       0      1
0  41601    721
1   1525  13193
---- Validation: 
scalar performance:
{'acc': 0.95035124, 'precision': 0.6517912, 'recall': 0.69302535, 'specificity': 0.69302535, 'f1': 0.66952, 'auroc': 0.7799145, 'binary_precision': 0.3244552, 'binary_recall': 0.41679627, 'binary_specificity': 0.9692545, 'binary_f1_score': 0.36487406}
confusion matrix:
       0    1
0  17591  558
1    375  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9498242, 'precision': 0.6921737, 'recall': 0.7117965, 'specificity': 0.7117965, 'f1': 0.70142496, 'auroc': 0.815554, 'binary_precision': 0.4083045, 'binary_recall': 0.45210728, 'binary_specificity': 0.97148573, 'binary_f1_score': 0.42909095}
confusion matrix:
      0    1
0  5826  171
1   143  118
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_4.png
better model found
persisted
after epoch: 4,now: 2024-06-23 14:57:10.817774,epoch time: 0:20:36.712207,used: 1:35:40.500122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9629383, 'precision': 0.95941806, 'recall': 0.94283265, 'specificity': 0.94283265, 'f1': 0.9507292, 'auroc': 0.98894745, 'binary_precision': 0.95253825, 'binary_recall': 0.90128404, 'binary_specificity': 0.98438126, 'binary_f1_score': 0.92620265}
confusion matrix:
       0      1
0  41660    661
1   1453  13266
---- Validation: 
scalar performance:
{'acc': 0.9524798, 'precision': 0.6654932, 'recall': 0.71287876, 'specificity': 0.71287876, 'f1': 0.6857401, 'auroc': 0.8079505, 'binary_precision': 0.35047847, 'binary_recall': 0.45567653, 'binary_specificity': 0.970081, 'binary_f1_score': 0.39621365}
confusion matrix:
       0    1
0  17606  543
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9534995, 'precision': 0.71101344, 'recall': 0.72104347, 'specificity': 0.72104347, 'f1': 0.71589315, 'auroc': 0.82680225, 'binary_precision': 0.4452555, 'binary_recall': 0.46743295, 'binary_specificity': 0.974654, 'binary_f1_score': 0.45607477}
confusion matrix:
      0    1
0  5845  152
1   139  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-23 15:19:42.217344,epoch time: 0:22:31.399570,used: 1:58:11.899692,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96392006, 'precision': 0.96541387, 'recall': 0.9395731, 'specificity': 0.9395731, 'f1': 0.95155877, 'auroc': 0.98913217, 'binary_precision': 0.9682528, 'binary_recall': 0.8892816, 'binary_specificity': 0.98986465, 'binary_f1_score': 0.92708844}
confusion matrix:
       0      1
0  41898    429
1   1629  13084
---- Validation: 
scalar performance:
{'acc': 0.9593444, 'precision': 0.6910195, 'recall': 0.68643045, 'specificity': 0.68643045, 'f1': 0.6886933, 'auroc': 0.7979858, 'binary_precision': 0.40350878, 'binary_recall': 0.3934681, 'binary_specificity': 0.9793928, 'binary_f1_score': 0.39842516}
confusion matrix:
       0    1
0  17775  374
1    390  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.77551377, 'recall': 0.7039746, 'specificity': 0.7039746, 'f1': 0.7337475, 'auroc': 0.8177327, 'binary_precision': 0.57591623, 'binary_recall': 0.42145595, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.4867257}
confusion matrix:
      0    1
0  5916   81
1   151  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-23 15:42:07.447199,epoch time: 0:22:25.229855,used: 2:20:37.129547,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96714586, 'precision': 0.96206105, 'recall': 0.95146513, 'specificity': 0.95146513, 'f1': 0.9566014, 'auroc': 0.9905982, 'binary_precision': 0.9519285, 'binary_recall': 0.9190677, 'binary_specificity': 0.9838626, 'binary_f1_score': 0.93520945}
confusion matrix:
       0      1
0  41641    683
1   1191  13525
---- Validation: 
scalar performance:
{'acc': 0.9523733, 'precision': 0.6636094, 'recall': 0.70757324, 'specificity': 0.70757324, 'f1': 0.6825654, 'auroc': 0.8098997, 'binary_precision': 0.34708738, 'binary_recall': 0.44479004, 'binary_specificity': 0.97035646, 'binary_f1_score': 0.38991138}
confusion matrix:
       0    1
0  17611  538
1    357  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95302016, 'precision': 0.70739233, 'recall': 0.713464, 'specificity': 0.713464, 'f1': 0.7103772, 'auroc': 0.8235644, 'binary_precision': 0.43866172, 'binary_recall': 0.45210728, 'binary_specificity': 0.97482073, 'binary_f1_score': 0.44528303}
confusion matrix:
      0    1
0  5846  151
1   143  118
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_7.png
early stop counter: 1
val acc:0.9523733258247375, best validation acc: 0.9593443870544434, corresponding to test acc:                         0.9629274606704712 / 0.9629274606704712
after epoch: 7,now: 2024-06-23 16:03:25.783425,epoch time: 0:21:18.336226,used: 2:41:55.465773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9684432, 'precision': 0.95856726, 'recall': 0.9590547, 'specificity': 0.9590547, 'f1': 0.9588107, 'auroc': 0.9923843, 'binary_precision': 0.9381275, 'binary_recall': 0.9396575, 'binary_specificity': 0.97845197, 'binary_f1_score': 0.9388919}
confusion matrix:
       0      1
0  41412    912
1    888  13828
---- Validation: 
scalar performance:
{'acc': 0.949553, 'precision': 0.664631, 'recall': 0.7488663, 'specificity': 0.7488663, 'f1': 0.69672936, 'auroc': 0.8358543, 'binary_precision': 0.34611502, 'binary_recall': 0.533437, 'binary_specificity': 0.96429557, 'binary_f1_score': 0.41982862}
confusion matrix:
       0    1
0  17501  648
1    300  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7392392, 'recall': 0.7418681, 'specificity': 0.7418681, 'f1': 0.74054545, 'auroc': 0.8494247, 'binary_precision': 0.5, 'binary_recall': 0.50574714, 'binary_specificity': 0.977989, 'binary_f1_score': 0.5028572}
confusion matrix:
      0    1
0  5865  132
1   129  132
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_8.png
early stop counter: 2
val acc:0.9495530128479004, best validation acc: 0.9593443870544434, corresponding to test acc:                         0.9629274606704712 / 0.9629274606704712
after epoch: 8,now: 2024-06-23 16:24:51.694791,epoch time: 0:21:25.911366,used: 3:03:21.377139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9726157, 'precision': 0.9681205, 'recall': 0.9599118, 'specificity': 0.9599118, 'f1': 0.9639205, 'auroc': 0.99278724, 'binary_precision': 0.95908964, 'binary_recall': 0.9336686, 'binary_specificity': 0.9861551, 'binary_f1_score': 0.9462084}
confusion matrix:
       0      1
0  41740    586
1    976  13738
---- Validation: 
scalar performance:
{'acc': 0.95955724, 'precision': 0.7014908, 'recall': 0.73154396, 'specificity': 0.73154396, 'f1': 0.7153319, 'auroc': 0.827062, 'binary_precision': 0.42126516, 'binary_recall': 0.4867807, 'binary_specificity': 0.9763072, 'binary_f1_score': 0.45165944}
confusion matrix:
       0    1
0  17719  430
1    330  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.79869264, 'recall': 0.73121136, 'specificity': 0.73121136, 'f1': 0.76014596, 'auroc': 0.8515247, 'binary_precision': 0.62, 'binary_recall': 0.47509578, 'binary_specificity': 0.987327, 'binary_f1_score': 0.53796095}
confusion matrix:
      0    1
0  5921   76
1   137  124
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-23 16:45:44.011028,epoch time: 0:20:52.316237,used: 3:24:13.693376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9720372, 'precision': 0.96865547, 'recall': 0.9578043, 'specificity': 0.9578043, 'f1': 0.9630634, 'auroc': 0.99281037, 'binary_precision': 0.9619175, 'binary_recall': 0.9283919, 'binary_specificity': 0.9872168, 'binary_f1_score': 0.9448574}
confusion matrix:
       0      1
0  41780    541
1   1054  13665
---- Validation: 
scalar performance:
{'acc': 0.9563112, 'precision': 0.6856431, 'recall': 0.7306135, 'specificity': 0.7306135, 'f1': 0.705341, 'auroc': 0.8313803, 'binary_precision': 0.38957816, 'binary_recall': 0.48833594, 'binary_specificity': 0.9728911, 'binary_f1_score': 0.43340236}
confusion matrix:
       0    1
0  17657  492
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.7624651, 'recall': 0.73637295, 'specificity': 0.73637295, 'f1': 0.74864495, 'auroc': 0.85517347, 'binary_precision': 0.5470086, 'binary_recall': 0.49042144, 'binary_specificity': 0.9823245, 'binary_f1_score': 0.51717174}
confusion matrix:
      0    1
0  5891  106
1   133  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_10.png
early stop counter: 1
val acc:0.9563112258911133, best validation acc: 0.9595572352409363, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 10,now: 2024-06-23 17:07:21.063028,epoch time: 0:21:37.052000,used: 3:45:50.745376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9709502, 'precision': 0.9614382, 'recall': 0.9628053, 'specificity': 0.9628053, 'f1': 0.962119, 'auroc': 0.99266577, 'binary_precision': 0.9416898, 'binary_recall': 0.94597715, 'binary_specificity': 0.97963333, 'binary_f1_score': 0.94382864}
confusion matrix:
       0      1
0  41462    862
1    795  13921
---- Validation: 
scalar performance:
{'acc': 0.95200086, 'precision': 0.6744343, 'recall': 0.75613403, 'specificity': 0.75613403, 'f1': 0.7062932, 'auroc': 0.8348227, 'binary_precision': 0.36524454, 'binary_recall': 0.5458787, 'binary_specificity': 0.96638936, 'binary_f1_score': 0.43765587}
confusion matrix:
       0    1
0  17539  610
1    292  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95653564, 'precision': 0.73055565, 'recall': 0.75744194, 'specificity': 0.75744194, 'f1': 0.7431433, 'auroc': 0.8555664, 'binary_precision': 0.48122868, 'binary_recall': 0.54022986, 'binary_specificity': 0.974654, 'binary_f1_score': 0.5090253}
confusion matrix:
      0    1
0  5845  152
1   120  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_11.png
early stop counter: 2
val acc:0.9520008563995361, best validation acc: 0.9595572352409363, corresponding to test acc:                         0.9659635424613953 / 0.9659635424613953
after epoch: 11,now: 2024-06-23 17:28:06.010783,epoch time: 0:20:44.947755,used: 4:06:35.693131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9710554, 'precision': 0.9707199, 'recall': 0.9531244, 'specificity': 0.9531244, 'f1': 0.96149075, 'auroc': 0.9924959, 'binary_precision': 0.9700655, 'binary_recall': 0.91607773, 'binary_specificity': 0.9901711, 'binary_f1_score': 0.94229895}
confusion matrix:
       0      1
0  41908    416
1   1235  13481
---- Validation: 
scalar performance:
{'acc': 0.96099406, 'precision': 0.7062954, 'recall': 0.7127864, 'specificity': 0.7127864, 'f1': 0.70948404, 'auroc': 0.82021445, 'binary_precision': 0.43222892, 'binary_recall': 0.44634527, 'binary_specificity': 0.9792275, 'binary_f1_score': 0.4391737}
confusion matrix:
       0    1
0  17772  377
1    356  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.80753446, 'recall': 0.72421557, 'specificity': 0.72421557, 'f1': 0.7586006, 'auroc': 0.83906865, 'binary_precision': 0.63829786, 'binary_recall': 0.4597701, 'binary_specificity': 0.988661, 'binary_f1_score': 0.5345211}
confusion matrix:
      0    1
0  5929   68
1   141  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_12.png
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-06-23 17:49:41.745309,epoch time: 0:21:35.734526,used: 4:28:11.427657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9756311, 'precision': 0.97185576, 'recall': 0.9641421, 'specificity': 0.9641421, 'f1': 0.96791524, 'auroc': 0.99416053, 'binary_precision': 0.96425587, 'binary_recall': 0.940405, 'binary_specificity': 0.9878792, 'binary_f1_score': 0.95218104}
confusion matrix:
       0      1
0  41811    513
1    877  13839
---- Validation: 
scalar performance:
{'acc': 0.95583224, 'precision': 0.6856097, 'recall': 0.74011624, 'specificity': 0.74011624, 'f1': 0.70885456, 'auroc': 0.8390927, 'binary_precision': 0.38882282, 'binary_recall': 0.5085537, 'binary_specificity': 0.97167885, 'binary_f1_score': 0.4407008}
confusion matrix:
       0    1
0  17635  514
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.7564176, 'recall': 0.7451178, 'specificity': 0.7451178, 'f1': 0.75062275, 'auroc': 0.8586931, 'binary_precision': 0.53413653, 'binary_recall': 0.5095785, 'binary_specificity': 0.980657, 'binary_f1_score': 0.52156866}
confusion matrix:
      0    1
0  5881  116
1   128  133
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_13.png
early stop counter: 1
val acc:0.9558322429656982, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9666027426719666 / 0.9666027426719666
after epoch: 13,now: 2024-06-23 18:09:44.376721,epoch time: 0:20:02.631412,used: 4:48:14.059069,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9752805, 'precision': 0.9724988, 'recall': 0.96252966, 'specificity': 0.96252966, 'f1': 0.96737516, 'auroc': 0.9942446, 'binary_precision': 0.9669404, 'binary_recall': 0.93618757, 'binary_specificity': 0.9888718, 'binary_f1_score': 0.9513155}
confusion matrix:
       0      1
0  41854    471
1    939  13776
---- Validation: 
scalar performance:
{'acc': 0.95977014, 'precision': 0.7025025, 'recall': 0.7309041, 'specificity': 0.7309041, 'f1': 0.71564615, 'auroc': 0.8277938, 'binary_precision': 0.42333785, 'binary_recall': 0.4852255, 'binary_specificity': 0.9765827, 'binary_f1_score': 0.45217392}
confusion matrix:
       0    1
0  17724  425
1    331  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.80120885, 'recall': 0.73879087, 'specificity': 0.73879087, 'f1': 0.7659644, 'auroc': 0.85261965, 'binary_precision': 0.62439024, 'binary_recall': 0.49042144, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.5493562}
confusion matrix:
      0    1
0  5920   77
1   133  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_14.png
early stop counter: 2
val acc:0.959770143032074, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9666027426719666 / 0.9666027426719666
after epoch: 14,now: 2024-06-23 18:30:01.575725,epoch time: 0:20:17.199004,used: 5:08:31.258073,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97613955, 'precision': 0.9749536, 'recall': 0.96232843, 'specificity': 0.96232843, 'f1': 0.96842027, 'auroc': 0.9941759, 'binary_precision': 0.97260374, 'binary_recall': 0.93380004, 'binary_specificity': 0.9908569, 'binary_f1_score': 0.952807}
confusion matrix:
       0      1
0  41940    387
1    974  13739
---- Validation: 
scalar performance:
{'acc': 0.95945084, 'precision': 0.70038414, 'recall': 0.7284887, 'specificity': 0.7284887, 'f1': 0.71338934, 'auroc': 0.8349017, 'binary_precision': 0.4192673, 'binary_recall': 0.4805599, 'binary_specificity': 0.9764174, 'binary_f1_score': 0.4478261}
confusion matrix:
       0    1
0  17721  428
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8043605, 'recall': 0.7184684, 'specificity': 0.7184684, 'f1': 0.7535498, 'auroc': 0.85175973, 'binary_precision': 0.63243246, 'binary_recall': 0.44827586, 'binary_specificity': 0.988661, 'binary_f1_score': 0.52466375}
confusion matrix:
      0    1
0  5929   68
1   144  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_15.png
early stop counter: 3
val acc:0.9594508409500122, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9666027426719666 / 0.9666027426719666
after epoch: 15,now: 2024-06-23 18:50:47.047285,epoch time: 0:20:45.471560,used: 5:29:16.729633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.977507, 'precision': 0.9726625, 'recall': 0.96837914, 'specificity': 0.96837914, 'f1': 0.970495, 'auroc': 0.99426866, 'binary_precision': 0.9627971, 'binary_recall': 0.9495176, 'binary_specificity': 0.9872407, 'binary_f1_score': 0.95611125}
confusion matrix:
       0      1
0  41782    540
1    743  13975
---- Validation: 
scalar performance:
{'acc': 0.95647085, 'precision': 0.69067633, 'recall': 0.75169766, 'specificity': 0.75169766, 'f1': 0.71636117, 'auroc': 0.8306541, 'binary_precision': 0.39813736, 'binary_recall': 0.5318818, 'binary_specificity': 0.97151357, 'binary_f1_score': 0.45539284}
confusion matrix:
       0    1
0  17632  517
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.7943289, 'recall': 0.742122, 'specificity': 0.742122, 'f1': 0.765376, 'auroc': 0.85945785, 'binary_precision': 0.6103286, 'binary_recall': 0.49808428, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.5485232}
confusion matrix:
      0    1
0  5914   83
1   131  130
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_16.png
early stop counter: 4
val acc:0.9564708471298218, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9666027426719666 / 0.9666027426719666
after epoch: 16,now: 2024-06-23 19:11:40.254711,epoch time: 0:20:53.207426,used: 5:50:09.937059,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9747896, 'precision': 0.97050905, 'recall': 0.96328884, 'specificity': 0.96328884, 'f1': 0.9668253, 'auroc': 0.9941815, 'binary_precision': 0.96187824, 'binary_recall': 0.9395257, 'binary_specificity': 0.98705196, 'binary_f1_score': 0.95057064}
confusion matrix:
       0      1
0  41775    548
1    890  13827
---- Validation: 
scalar performance:
{'acc': 0.95689654, 'precision': 0.6897477, 'recall': 0.737667, 'specificity': 0.737667, 'f1': 0.71063054, 'auroc': 0.8382382, 'binary_precision': 0.39729398, 'binary_recall': 0.5023328, 'binary_specificity': 0.97300124, 'binary_f1_score': 0.44368133}
confusion matrix:
       0    1
0  17659  490
1    320  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.77198815, 'recall': 0.7277949, 'specificity': 0.7277949, 'f1': 0.747686, 'auroc': 0.85098994, 'binary_precision': 0.56682026, 'binary_recall': 0.47126436, 'binary_specificity': 0.98432547, 'binary_f1_score': 0.5146443}
confusion matrix:
      0    1
0  5903   94
1   138  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_17.png
early stop counter: 5
val acc:0.9568965435028076, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9666027426719666 / 0.9666027426719666
after epoch: 17,now: 2024-06-23 19:32:21.580848,epoch time: 0:20:41.326137,used: 6:10:51.263196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9759292, 'precision': 0.9737898, 'recall': 0.96294665, 'specificity': 0.96294665, 'f1': 0.9682044, 'auroc': 0.9949388, 'binary_precision': 0.96952635, 'binary_recall': 0.93612397, 'binary_specificity': 0.9897694, 'binary_f1_score': 0.95253235}
confusion matrix:
       0      1
0  41891    433
1    940  13776
---- Validation: 
scalar performance:
{'acc': 0.95780116, 'precision': 0.6954215, 'recall': 0.7456359, 'specificity': 0.7456359, 'f1': 0.71726274, 'auroc': 0.8390221, 'binary_precision': 0.40808824, 'binary_recall': 0.5178849, 'binary_specificity': 0.97338694, 'binary_f1_score': 0.45647702}
confusion matrix:
       0    1
0  17666  483
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.77297866, 'recall': 0.740788, 'specificity': 0.740788, 'f1': 0.7557435, 'auroc': 0.8566991, 'binary_precision': 0.5676856, 'binary_recall': 0.49808428, 'binary_specificity': 0.9834917, 'binary_f1_score': 0.53061223}
confusion matrix:
      0    1
0  5898   99
1   131  130
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_18.png
early stop counter: 6
val acc:0.9578011631965637, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9666027426719666 / 0.9666027426719666
after epoch: 18,now: 2024-06-23 19:53:55.728803,epoch time: 0:21:34.147955,used: 6:32:25.411151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9771739, 'precision': 0.9761522, 'recall': 0.963872, 'specificity': 0.963872, 'f1': 0.9698038, 'auroc': 0.99494267, 'binary_precision': 0.97412515, 'binary_recall': 0.9363914, 'binary_specificity': 0.9913526, 'binary_f1_score': 0.95488566}
confusion matrix:
       0      1
0  41959    366
1    936  13779
---- Validation: 
scalar performance:
{'acc': 0.96110046, 'precision': 0.7098337, 'recall': 0.7308428, 'specificity': 0.7308428, 'f1': 0.7197715, 'auroc': 0.8338727, 'binary_precision': 0.43802816, 'binary_recall': 0.4836703, 'binary_specificity': 0.9780153, 'binary_f1_score': 0.45971915}
confusion matrix:
       0    1
0  17750  399
1    332  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.83028406, 'recall': 0.7233837, 'specificity': 0.7233837, 'f1': 0.76540995, 'auroc': 0.8543921, 'binary_precision': 0.68390805, 'binary_recall': 0.4559387, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.5471264}
confusion matrix:
      0    1
0  5942   55
1   142  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_19.png
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-06-23 20:14:42.499994,epoch time: 0:20:46.771191,used: 6:53:12.182342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9782784, 'precision': 0.9736563, 'recall': 0.96940553, 'specificity': 0.96940553, 'f1': 0.9715055, 'auroc': 0.9954772, 'binary_precision': 0.9642439, 'binary_recall': 0.95107365, 'binary_specificity': 0.9877375, 'binary_f1_score': 0.95761347}
confusion matrix:
       0      1
0  41805    519
1    720  13996
---- Validation: 
scalar performance:
{'acc': 0.9554598, 'precision': 0.6887344, 'recall': 0.76317513, 'specificity': 0.76317513, 'f1': 0.7189066, 'auroc': 0.84168315, 'binary_precision': 0.3934066, 'binary_recall': 0.55676514, 'binary_specificity': 0.9695851, 'binary_f1_score': 0.46104315}
confusion matrix:
       0    1
0  17597  552
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.75779194, 'recall': 0.76910484, 'specificity': 0.76910484, 'f1': 0.7633098, 'auroc': 0.8677474, 'binary_precision': 0.53479856, 'binary_recall': 0.55938697, 'binary_specificity': 0.97882277, 'binary_f1_score': 0.54681647}
confusion matrix:
      0    1
0  5870  127
1   115  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_20.png
early stop counter: 1
val acc:0.9554597735404968, best validation acc: 0.9611004590988159, corresponding to test acc:                         0.9685202836990356 / 0.9685202836990356
after epoch: 20,now: 2024-06-23 20:36:04.150938,epoch time: 0:21:21.650944,used: 7:14:33.833286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9778226, 'precision': 0.976411, 'recall': 0.96533656, 'specificity': 0.96533656, 'f1': 0.9707042, 'auroc': 0.99511504, 'binary_precision': 0.97359896, 'binary_recall': 0.93953395, 'binary_specificity': 0.9911392, 'binary_f1_score': 0.9562632}
confusion matrix:
       0      1
0  41946    375
1    890  13829
---- Validation: 
scalar performance:
{'acc': 0.95721585, 'precision': 0.6913777, 'recall': 0.7385824, 'specificity': 0.7385824, 'f1': 0.7120146, 'auroc': 0.8480936, 'binary_precision': 0.40049443, 'binary_recall': 0.503888, 'binary_specificity': 0.9732768, 'binary_f1_score': 0.44628096}
confusion matrix:
       0    1
0  17664  485
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.76727104, 'recall': 0.7108871, 'specificity': 0.7108871, 'f1': 0.7353281, 'auroc': 0.8521713, 'binary_precision': 0.5588235, 'binary_recall': 0.43678162, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.4903226}
confusion matrix:
      0    1
0  5907   90
1   147  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_21.png
early stop counter: 2
val acc:0.9572158455848694, best validation acc: 0.9611004590988159, corresponding to test acc:                         0.9685202836990356 / 0.9685202836990356
after epoch: 21,now: 2024-06-23 20:56:31.377600,epoch time: 0:20:27.226662,used: 7:35:01.059948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9785589, 'precision': 0.97534806, 'recall': 0.9683773, 'specificity': 0.9683773, 'f1': 0.97179496, 'auroc': 0.99566543, 'binary_precision': 0.96886724, 'binary_recall': 0.94733983, 'binary_specificity': 0.98941475, 'binary_f1_score': 0.95798266}
confusion matrix:
       0      1
0  41875    448
1    775  13942
---- Validation: 
scalar performance:
{'acc': 0.95987654, 'precision': 0.70707387, 'recall': 0.7557111, 'specificity': 0.7557111, 'f1': 0.72848797, 'auroc': 0.86030436, 'binary_precision': 0.4307116, 'binary_recall': 0.5365474, 'binary_specificity': 0.9748747, 'binary_f1_score': 0.4778393}
confusion matrix:
       0    1
0  17693  456
1    298  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.83808684, 'recall': 0.73121333, 'specificity': 0.73121333, 'f1': 0.77355826, 'auroc': 0.8686503, 'binary_precision': 0.6988636, 'binary_recall': 0.47126436, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.56292903}
confusion matrix:
      0    1
0  5944   53
1   138  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_22.png
new oracle model saved
early stop counter: 3
val acc:0.959876537322998, best validation acc: 0.9611004590988159, corresponding to test acc:                         0.9685202836990356 / 0.9694790840148926
after epoch: 22,now: 2024-06-23 21:17:24.588056,epoch time: 0:20:53.210456,used: 7:55:54.270404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97834855, 'precision': 0.9751996, 'recall': 0.96797466, 'specificity': 0.96797466, 'f1': 0.9715143, 'auroc': 0.99549985, 'binary_precision': 0.9688478, 'binary_recall': 0.94653535, 'binary_specificity': 0.989414, 'binary_f1_score': 0.9575616}
confusion matrix:
       0      1
0  41872    448
1    787  13933
---- Validation: 
scalar performance:
{'acc': 0.95812047, 'precision': 0.694679, 'recall': 0.73380035, 'specificity': 0.73380035, 'f1': 0.712201, 'auroc': 0.832531, 'binary_precision': 0.40745503, 'binary_recall': 0.49300155, 'binary_specificity': 0.9745991, 'binary_f1_score': 0.44616467}
confusion matrix:
       0    1
0  17688  461
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.7649951, 'recall': 0.71996534, 'specificity': 0.71996534, 'f1': 0.74011624, 'auroc': 0.8521515, 'binary_precision': 0.5534884, 'binary_recall': 0.4559387, 'binary_specificity': 0.983992, 'binary_f1_score': 0.5}
confusion matrix:
      0    1
0  5901   96
1   142  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_23.png
early stop counter: 4
val acc:0.9581204652786255, best validation acc: 0.9611004590988159, corresponding to test acc:                         0.9685202836990356 / 0.9694790840148926
after epoch: 23,now: 2024-06-23 21:38:32.335334,epoch time: 0:21:07.747278,used: 8:17:02.017682,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97777, 'precision': 0.9751034, 'recall': 0.9665142, 'specificity': 0.9665142, 'f1': 0.9707061, 'auroc': 0.99539423, 'binary_precision': 0.96974987, 'binary_recall': 0.94325906, 'binary_specificity': 0.9897694, 'binary_f1_score': 0.95632106}
confusion matrix:
       0      1
0  41891    433
1    835  13881
---- Validation: 
scalar performance:
{'acc': 0.959238, 'precision': 0.7021647, 'recall': 0.74487966, 'specificity': 0.74487966, 'f1': 0.7211997, 'auroc': 0.85133636, 'binary_precision': 0.42165604, 'binary_recall': 0.5147745, 'binary_specificity': 0.9749848, 'binary_f1_score': 0.4635854}
confusion matrix:
       0    1
0  17695  454
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8106326, 'recall': 0.7392911, 'specificity': 0.7392911, 'f1': 0.7698003, 'auroc': 0.86838436, 'binary_precision': 0.6432161, 'binary_recall': 0.49042144, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.5565217}
confusion matrix:
      0    1
0  5926   71
1   133  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_24.png
early stop counter: 5
val acc:0.9592379927635193, best validation acc: 0.9611004590988159, corresponding to test acc:                         0.9685202836990356 / 0.9694790840148926
after epoch: 24,now: 2024-06-23 21:59:21.929666,epoch time: 0:20:49.594332,used: 8:37:51.612014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97890955, 'precision': 0.9760678, 'recall': 0.9685659, 'specificity': 0.9685659, 'f1': 0.97223854, 'auroc': 0.9960945, 'binary_precision': 0.9703425, 'binary_recall': 0.9471967, 'binary_specificity': 0.98993504, 'binary_f1_score': 0.9586299}
confusion matrix:
       0      1
0  41899    426
1    777  13938
---- Validation: 
scalar performance:
{'acc': 0.960728, 'precision': 0.7099763, 'recall': 0.74565107, 'specificity': 0.74565107, 'f1': 0.7262307, 'auroc': 0.8625353, 'binary_precision': 0.4372523, 'binary_recall': 0.5147745, 'binary_specificity': 0.97652763, 'binary_f1_score': 0.47285715}
confusion matrix:
       0    1
0  17723  426
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.84273446, 'recall': 0.70322806, 'specificity': 0.70322806, 'f1': 0.7533627, 'auroc': 0.8677461, 'binary_precision': 0.7105263, 'binary_recall': 0.41379312, 'binary_specificity': 0.992663, 'binary_f1_score': 0.5230024}
confusion matrix:
      0    1
0  5953   44
1   153  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_25.png
early stop counter: 6
val acc:0.9607279896736145, best validation acc: 0.9611004590988159, corresponding to test acc:                         0.9685202836990356 / 0.9694790840148926
after epoch: 25,now: 2024-06-23 22:22:47.468359,epoch time: 0:23:25.538693,used: 9:01:17.150707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9787693, 'precision': 0.97583884, 'recall': 0.96842706, 'specificity': 0.96842706, 'f1': 0.97205645, 'auroc': 0.9949912, 'binary_precision': 0.9699332, 'binary_recall': 0.9470608, 'binary_specificity': 0.98979324, 'binary_f1_score': 0.9583605}
confusion matrix:
       0      1
0  41893    432
1    779  13936
---- Validation: 
scalar performance:
{'acc': 0.95945084, 'precision': 0.70434606, 'recall': 0.75174034, 'specificity': 0.75174034, 'f1': 0.7252419, 'auroc': 0.844895, 'binary_precision': 0.42553192, 'binary_recall': 0.5287714, 'binary_specificity': 0.97470933, 'binary_f1_score': 0.47156727}
confusion matrix:
       0    1
0  17690  459
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.8035644, 'recall': 0.7258811, 'specificity': 0.7258811, 'f1': 0.7583624, 'auroc': 0.863302, 'binary_precision': 0.6302083, 'binary_recall': 0.46360153, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.53421634}
confusion matrix:
      0    1
0  5926   71
1   140  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_26.png
early stop counter: 7
val acc:0.9594508409500122, best validation acc: 0.9611004590988159, corresponding to test acc:                         0.9685202836990356 / 0.9694790840148926
after epoch: 26,now: 2024-06-23 22:45:57.671961,epoch time: 0:23:10.203602,used: 9:24:27.354309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9796108, 'precision': 0.9758088, 'recall': 0.97072446, 'specificity': 0.97072446, 'f1': 0.97323054, 'auroc': 0.9960585, 'binary_precision': 0.9680873, 'binary_recall': 0.9523648, 'binary_specificity': 0.9890842, 'binary_f1_score': 0.9601617}
confusion matrix:
       0      1
0  41862    462
1    701  14015
---- Validation: 
scalar performance:
{'acc': 0.9589187, 'precision': 0.7023325, 'recall': 0.75521517, 'specificity': 0.75521517, 'f1': 0.7252921, 'auroc': 0.8481045, 'binary_precision': 0.42124543, 'binary_recall': 0.5365474, 'binary_specificity': 0.97388285, 'binary_f1_score': 0.4719562}
confusion matrix:
       0    1
0  17675  474
1    298  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.78901446, 'recall': 0.7269631, 'specificity': 0.7269631, 'f1': 0.7538039, 'auroc': 0.85961735, 'binary_precision': 0.6009852, 'binary_recall': 0.46743295, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.5258621}
confusion matrix:
      0    1
0  5916   81
1   139  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_27.png
early stop counter: 8
val acc:0.9589186906814575, best validation acc: 0.9611004590988159, corresponding to test acc:                         0.9685202836990356 / 0.9694790840148926
after epoch: 27,now: 2024-06-23 23:09:01.682187,epoch time: 0:23:04.010226,used: 9:47:31.364535,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97834855, 'precision': 0.97780573, 'recall': 0.9653285, 'specificity': 0.9653285, 'f1': 0.97135305, 'auroc': 0.995289, 'binary_precision': 0.9767294, 'binary_recall': 0.9384302, 'binary_specificity': 0.99222684, 'binary_f1_score': 0.95719683}
confusion matrix:
       0      1
0  41996    329
1    906  13809
---- Validation: 
scalar performance:
{'acc': 0.96141976, 'precision': 0.71047145, 'recall': 0.72275746, 'specificity': 0.72275746, 'f1': 0.71641755, 'auroc': 0.83922124, 'binary_precision': 0.4398827, 'binary_recall': 0.466563, 'binary_specificity': 0.978952, 'binary_f1_score': 0.45283017}
confusion matrix:
       0    1
0  17767  382
1    343  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.8089199, 'recall': 0.6925656, 'specificity': 0.6925656, 'f1': 0.73576766, 'auroc': 0.8537902, 'binary_precision': 0.64375, 'binary_recall': 0.394636, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.4893112}
confusion matrix:
      0    1
0  5940   57
1   158  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_28.png
better model found
persisted
after epoch: 28,now: 2024-06-23 23:32:57.475508,epoch time: 0:23:55.793321,used: 10:11:27.157856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9786641, 'precision': 0.9757446, 'recall': 0.9682504, 'specificity': 0.9682504, 'f1': 0.9719193, 'auroc': 0.99562204, 'binary_precision': 0.9698615, 'binary_recall': 0.94673187, 'binary_specificity': 0.9897689, 'binary_f1_score': 0.9581571}
confusion matrix:
       0      1
0  41889    433
1    784  13934
---- Validation: 
scalar performance:
{'acc': 0.95955724, 'precision': 0.7031693, 'recall': 0.7412947, 'specificity': 0.7412947, 'f1': 0.72037286, 'auroc': 0.8503795, 'binary_precision': 0.4239272, 'binary_recall': 0.5069984, 'binary_specificity': 0.97559094, 'binary_f1_score': 0.46175638}
confusion matrix:
       0    1
0  17706  443
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.796571, 'recall': 0.70505846, 'specificity': 0.70505846, 'f1': 0.74150264, 'auroc': 0.860114, 'binary_precision': 0.6179775, 'binary_recall': 0.42145595, 'binary_specificity': 0.988661, 'binary_f1_score': 0.5011389}
confusion matrix:
      0    1
0  5929   68
1   151  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_29.png
early stop counter: 1
val acc:0.9595572352409363, best validation acc: 0.9614197611808777, corresponding to test acc:                         0.9656440019607544 / 0.9694790840148926
after epoch: 29,now: 2024-06-23 23:56:34.803743,epoch time: 0:23:37.328235,used: 10:35:04.486091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9806802, 'precision': 0.97963715, 'recall': 0.96965164, 'specificity': 0.96965164, 'f1': 0.9745076, 'auroc': 0.9962802, 'binary_precision': 0.97755176, 'binary_recall': 0.9468642, 'binary_specificity': 0.9924391, 'binary_f1_score': 0.9619633}
confusion matrix:
       0      1
0  42003    320
1    782  13935
---- Validation: 
scalar performance:
{'acc': 0.96227115, 'precision': 0.717419, 'recall': 0.7359492, 'specificity': 0.7359492, 'f1': 0.72625697, 'auroc': 0.84456915, 'binary_precision': 0.45285714, 'binary_recall': 0.49300155, 'binary_specificity': 0.9788969, 'binary_f1_score': 0.47207743}
confusion matrix:
       0    1
0  17766  383
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.82359827, 'recall': 0.72496593, 'specificity': 0.72496593, 'f1': 0.7644464, 'auroc': 0.86052895, 'binary_precision': 0.6703911, 'binary_recall': 0.4597701, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.54545456}
confusion matrix:
      0    1
0  5938   59
1   141  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_30.png
better model found
persisted
after epoch: 30,now: 2024-06-24 00:19:09.903400,epoch time: 0:22:35.099657,used: 10:57:39.585748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_21_30_seed_0_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:57:39.585748 at 2024-06-24 00:19:09.903400
persisted model performance metric: 

scalar performance:
{'acc': 0.9680409, 'precision': 0.82359827, 'recall': 0.72496593, 'specificity': 0.72496593, 'f1': 0.7644464, 'auroc': 0.86052895, 'binary_precision': 0.6703911, 'binary_recall': 0.4597701, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.54545456}
confusion matrix:
      0    1
0  5938   59
1   141  120
oracle model performance metric: 

scalar performance:
{'acc': 0.9694791, 'precision': 0.83808684, 'recall': 0.73121333, 'specificity': 0.73121333, 'f1': 0.77355826, 'auroc': 0.8686503, 'binary_precision': 0.6988636, 'binary_recall': 0.47126436, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.56292903}
confusion matrix:
      0    1
0  5944   53
1   138  123
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 571737 KiB | 508356 GiB | 508356 GiB |
|       from large pool | 167936 KiB | 499008 KiB | 507637 GiB | 507636 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 571737 KiB | 508356 GiB | 508356 GiB |
|       from large pool | 167936 KiB | 499008 KiB | 507637 GiB | 507636 GiB |
|       from small pool |  37043 KiB |  75475 KiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 563304 KiB | 503851 GiB | 503851 GiB |
|       from large pool | 165120 KiB | 491712 KiB | 503153 GiB | 503153 GiB |
|       from small pool |  35968 KiB |  74337 KiB |    697 GiB |    697 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 727040 KiB | 727040 KiB | 727040 KiB |      0 B   |
|       from large pool | 651264 KiB | 651264 KiB | 651264 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  81740 KiB | 209453 KiB | 317914 GiB | 317914 GiB |
|       from large pool |  67584 KiB | 208064 KiB | 317137 GiB | 317137 GiB |
|       from small pool |  14156 KiB |  14156 KiB |    776 GiB |    776 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    7879    |  102526 K  |  102523 K  |
|       from large pool |      36    |      76    |   34502 K  |   34502 K  |
|       from small pool |    3216    |    7842    |   68023 K  |   68020 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    7879    |  102526 K  |  102523 K  |
|       from large pool |      36    |      76    |   34502 K  |   34502 K  |
|       from small pool |    3216    |    7842    |   68023 K  |   68020 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      52    |      52    |      52    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    3581    |   45624 K  |   45624 K  |
|       from large pool |       7    |      11    |   13437 K  |   13437 K  |
|       from small pool |      32    |    3574    |   32187 K  |   32187 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB | 508356 GiB | 508356 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 507637 GiB | 507637 GiB |
|       from small pool |      0 KiB |  75475 KiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB | 508356 GiB | 508356 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 507637 GiB | 507637 GiB |
|       from small pool |      0 KiB |  75475 KiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 503851 GiB | 503851 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 503153 GiB | 503153 GiB |
|       from small pool |      0 KiB |  74337 KiB |    697 GiB |    697 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 727040 KiB | 727040 KiB | 440320 KiB |
|       from large pool | 235520 KiB | 651264 KiB | 651264 KiB | 415744 KiB |
|       from small pool |  51200 KiB |  75776 KiB |  75776 KiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB | 317914 GiB | 317914 GiB |
|       from large pool |  55040 KiB | 208064 KiB | 317138 GiB | 317137 GiB |
|       from small pool |      0 KiB |  21751 KiB |    776 GiB |    776 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  102526 K  |  102526 K  |
|       from large pool |       2    |      76    |   34502 K  |   34502 K  |
|       from small pool |       0    |    7842    |   68023 K  |   68023 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  102526 K  |  102526 K  |
|       from large pool |       2    |      76    |   34502 K  |   34502 K  |
|       from small pool |       0    |    7842    |   68023 K  |   68023 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      52    |      52    |      17    |
|       from large pool |      10    |      15    |      15    |       5    |
|       from small pool |      25    |      37    |      37    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   45626 K  |   45626 K  |
|       from large pool |       3    |      13    |   13437 K  |   13437 K  |
|       from small pool |       0    |    3574    |   32188 K  |   32188 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB | 508356 GiB | 508356 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 507637 GiB | 507637 GiB |
|       from small pool |      0 KiB |  75475 KiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB | 508356 GiB | 508356 GiB |
|       from large pool |  16640 KiB | 499008 KiB | 507637 GiB | 507637 GiB |
|       from small pool |      0 KiB |  75475 KiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB | 503851 GiB | 503851 GiB |
|       from large pool |  16640 KiB | 491712 KiB | 503153 GiB | 503153 GiB |
|       from small pool |      0 KiB |  74337 KiB |    697 GiB |    697 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 727040 KiB | 727040 KiB | 440320 KiB |
|       from large pool | 235520 KiB | 651264 KiB | 651264 KiB | 415744 KiB |
|       from small pool |  51200 KiB |  75776 KiB |  75776 KiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB | 317914 GiB | 317914 GiB |
|       from large pool |  55040 KiB | 208064 KiB | 317138 GiB | 317137 GiB |
|       from small pool |      0 KiB |  21751 KiB |    776 GiB |    776 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  102526 K  |  102526 K  |
|       from large pool |       2    |      76    |   34502 K  |   34502 K  |
|       from small pool |       0    |    7842    |   68023 K  |   68023 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  102526 K  |  102526 K  |
|       from large pool |       2    |      76    |   34502 K  |   34502 K  |
|       from small pool |       0    |    7842    |   68023 K  |   68023 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      52    |      52    |      17    |
|       from large pool |      10    |      15    |      15    |       5    |
|       from small pool |      25    |      37    |      37    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   45626 K  |   45626 K  |
|       from large pool |       3    |      13    |   13437 K  |   13437 K  |
|       from small pool |       0    |    3574    |   32188 K  |   32188 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148

 Experiment start at: 2024-06-24 00:27:42.196128
before training, model accuracy: 0.1456654816865921
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91283077, 'precision': 0.91576755, 'recall': 0.8486514, 'specificity': 0.8486514, 'f1': 0.8753564, 'auroc': 0.9540528, 'binary_precision': 0.92062926, 'binary_recall': 0.71835774, 'binary_specificity': 0.97894514, 'binary_f1_score': 0.807012}
confusion matrix:
       0      1
0  41520    893
1   4061  10358
---- Validation: 
scalar performance:
{'acc': 0.9435432, 'precision': 0.5714371, 'recall': 0.5630177, 'specificity': 0.5630177, 'f1': 0.5668805, 'auroc': 0.64506805, 'binary_precision': 0.17428088, 'binary_recall': 0.15304606, 'binary_specificity': 0.97298944, 'binary_f1_score': 0.16297467}
confusion matrix:
       0    1
0  17579  488
1    570  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9427973, 'precision': 0.5595224, 'recall': 0.53246915, 'specificity': 0.53246915, 'f1': 0.5403622, 'auroc': 0.7196907, 'binary_precision': 0.15827338, 'binary_recall': 0.08461539, 'binary_specificity': 0.9803229, 'binary_f1_score': 0.110275686}
confusion matrix:
      0    1
0  5829  117
1   238   22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-24 00:49:25.787039,epoch time: 0:21:43.590911,used: 0:21:43.590911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9411071, 'precision': 0.9401599, 'recall': 0.9017156, 'specificity': 0.9017156, 'f1': 0.91879725, 'auroc': 0.97666854, 'binary_precision': 0.93845546, 'binary_recall': 0.8217506, 'binary_specificity': 0.9816806, 'binary_f1_score': 0.8762342}
confusion matrix:
       0      1
0  41637    777
1   2570  11848
---- Validation: 
scalar performance:
{'acc': 0.94471717, 'precision': 0.60039246, 'recall': 0.6001052, 'specificity': 0.6001052, 'f1': 0.6002486, 'auroc': 0.71793914, 'binary_precision': 0.22950819, 'binary_recall': 0.22882615, 'binary_specificity': 0.9713843, 'binary_f1_score': 0.22916667}
confusion matrix:
       0    1
0  17550  517
1    519  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9500483, 'precision': 0.6668489, 'recall': 0.6208466, 'specificity': 0.6208466, 'f1': 0.639513, 'auroc': 0.7732645, 'binary_precision': 0.3655914, 'binary_recall': 0.26153848, 'binary_specificity': 0.98015475, 'binary_f1_score': 0.30493274}
confusion matrix:
      0    1
0  5828  118
1   192   68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-24 01:11:09.746382,epoch time: 0:21:43.959343,used: 0:43:27.550254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95252675, 'precision': 0.9494641, 'recall': 0.9234484, 'specificity': 0.9234484, 'f1': 0.93549, 'auroc': 0.98292696, 'binary_precision': 0.943742, 'binary_recall': 0.864415, 'binary_specificity': 0.9824818, 'binary_f1_score': 0.9023384}
confusion matrix:
       0      1
0  41670    743
1   1955  12464
---- Validation: 
scalar performance:
{'acc': 0.94935966, 'precision': 0.6447845, 'recall': 0.65901905, 'specificity': 0.65901905, 'f1': 0.6515075, 'auroc': 0.7707894, 'binary_precision': 0.31401616, 'binary_recall': 0.346211, 'binary_specificity': 0.9718271, 'binary_f1_score': 0.3293286}
confusion matrix:
       0    1
0  17558  509
1    440  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.74581784, 'recall': 0.67897034, 'specificity': 0.67897034, 'f1': 0.7064297, 'auroc': 0.8170037, 'binary_precision': 0.5187166, 'binary_recall': 0.37307692, 'binary_specificity': 0.98486376, 'binary_f1_score': 0.4340045}
confusion matrix:
      0   1
0  5856  90
1   163  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-24 01:32:59.789054,epoch time: 0:21:50.042672,used: 1:05:17.592926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95562357, 'precision': 0.95770526, 'recall': 0.92389345, 'specificity': 0.92389345, 'f1': 0.9392177, 'auroc': 0.986417, 'binary_precision': 0.9615146, 'binary_recall': 0.8594812, 'binary_specificity': 0.98830575, 'binary_f1_score': 0.9076394}
confusion matrix:
       0      1
0  41918    496
1   2026  12392
---- Validation: 
scalar performance:
{'acc': 0.95592314, 'precision': 0.67024326, 'recall': 0.64525664, 'specificity': 0.64525664, 'f1': 0.65660894, 'auroc': 0.77642006, 'binary_precision': 0.36602452, 'binary_recall': 0.31054977, 'binary_specificity': 0.9799635, 'binary_f1_score': 0.33601284}
confusion matrix:
       0    1
0  17705  362
1    464  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.78126967, 'recall': 0.69202244, 'specificity': 0.69202244, 'f1': 0.72722167, 'auroc': 0.8176104, 'binary_precision': 0.5885714, 'binary_recall': 0.39615384, 'binary_specificity': 0.987891, 'binary_f1_score': 0.47356322}
confusion matrix:
      0    1
0  5874   72
1   157  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-24 01:54:23.242437,epoch time: 0:21:23.453383,used: 1:26:41.046309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96350646, 'precision': 0.96110225, 'recall': 0.9415424, 'specificity': 0.9415424, 'f1': 0.95079017, 'auroc': 0.98890746, 'binary_precision': 0.9565153, 'binary_recall': 0.8969487, 'binary_specificity': 0.986136, 'binary_f1_score': 0.9257748}
confusion matrix:
       0      1
0  41824    588
1   1486  12934
---- Validation: 
scalar performance:
{'acc': 0.9558698, 'precision': 0.68622804, 'recall': 0.7003045, 'specificity': 0.7003045, 'f1': 0.69297147, 'auroc': 0.8053497, 'binary_precision': 0.3939394, 'binary_recall': 0.42496285, 'binary_specificity': 0.9756462, 'binary_f1_score': 0.40886348}
confusion matrix:
       0    1
0  17627  440
1    387  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.78560317, 'recall': 0.74435496, 'specificity': 0.74435496, 'f1': 0.7631715, 'auroc': 0.84150606, 'binary_precision': 0.5927602, 'binary_recall': 0.50384617, 'binary_specificity': 0.98486376, 'binary_f1_score': 0.54469854}
confusion matrix:
      0    1
0  5856   90
1   129  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_5.png
new oracle model saved
early stop counter: 1
val acc:0.9558697938919067, best validation acc: 0.9559231400489807, corresponding to test acc:                         0.963100254535675 / 0.9647115468978882
after epoch: 5,now: 2024-06-24 02:16:00.172617,epoch time: 0:21:36.930180,used: 1:48:17.976489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96794057, 'precision': 0.9617505, 'recall': 0.953001, 'specificity': 0.953001, 'f1': 0.9572681, 'auroc': 0.9910461, 'binary_precision': 0.94953966, 'binary_recall': 0.9226715, 'binary_specificity': 0.9833306, 'binary_f1_score': 0.9359127}
confusion matrix:
       0      1
0  41706    707
1   1115  13304
---- Validation: 
scalar performance:
{'acc': 0.9521345, 'precision': 0.67583925, 'recall': 0.7248322, 'specificity': 0.7248322, 'f1': 0.6968523, 'auroc': 0.83160734, 'binary_precision': 0.37126437, 'binary_recall': 0.47994056, 'binary_specificity': 0.9697238, 'binary_f1_score': 0.41866496}
confusion matrix:
       0    1
0  17520  547
1    350  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.73570347, 'recall': 0.76071566, 'specificity': 0.76071566, 'f1': 0.7474829, 'auroc': 0.86819386, 'binary_precision': 0.4913495, 'binary_recall': 0.54615384, 'binary_specificity': 0.9752775, 'binary_f1_score': 0.5173042}
confusion matrix:
      0    1
0  5799  147
1   118  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_6.png
early stop counter: 2
val acc:0.9521344900131226, best validation acc: 0.9559231400489807, corresponding to test acc:                         0.963100254535675 / 0.9647115468978882
after epoch: 6,now: 2024-06-24 02:37:33.053837,epoch time: 0:21:32.881220,used: 2:09:50.857709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9679582, 'precision': 0.958241, 'recall': 0.95704305, 'specificity': 0.95704305, 'f1': 0.95763993, 'auroc': 0.9918171, 'binary_precision': 0.9385922, 'binary_recall': 0.9348821, 'binary_specificity': 0.979204, 'binary_f1_score': 0.9367335}
confusion matrix:
       0      1
0  41530    882
1    939  13481
---- Validation: 
scalar performance:
{'acc': 0.9519744, 'precision': 0.6751997, 'recall': 0.72474915, 'specificity': 0.72474915, 'f1': 0.69640326, 'auroc': 0.8231466, 'binary_precision': 0.36998853, 'binary_recall': 0.47994056, 'binary_specificity': 0.96955776, 'binary_f1_score': 0.41785252}
confusion matrix:
       0    1
0  17517  550
1    350  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.7279464, 'recall': 0.7562809, 'specificity': 0.7562809, 'f1': 0.7411542, 'auroc': 0.85498667, 'binary_precision': 0.47619048, 'binary_recall': 0.53846157, 'binary_specificity': 0.97410023, 'binary_f1_score': 0.5054152}
confusion matrix:
      0    1
0  5792  154
1   120  140
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_7.png
early stop counter: 3
val acc:0.9519743919372559, best validation acc: 0.9559231400489807, corresponding to test acc:                         0.963100254535675 / 0.9647115468978882
after epoch: 7,now: 2024-06-24 02:59:05.197979,epoch time: 0:21:32.144142,used: 2:31:23.001851,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96998173, 'precision': 0.9715338, 'recall': 0.94866633, 'specificity': 0.94866633, 'f1': 0.959396, 'auroc': 0.9920844, 'binary_precision': 0.97447, 'binary_recall': 0.90539604, 'binary_specificity': 0.9919366, 'binary_f1_score': 0.93866396}
confusion matrix:
       0      1
0  42072    342
1   1364  13054
---- Validation: 
scalar performance:
{'acc': 0.95997864, 'precision': 0.7074259, 'recall': 0.68956065, 'specificity': 0.68956065, 'f1': 0.69803727, 'auroc': 0.81465375, 'binary_precision': 0.43719414, 'binary_recall': 0.39821693, 'binary_specificity': 0.9809044, 'binary_f1_score': 0.41679627}
confusion matrix:
       0    1
0  17722  345
1    405  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.8235811, 'recall': 0.7258079, 'specificity': 0.7258079, 'f1': 0.76503813, 'auroc': 0.8495834, 'binary_precision': 0.6703911, 'binary_recall': 0.46153846, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.546697}
confusion matrix:
      0    1
0  5887   59
1   140  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_8.png
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-06-24 03:21:08.334200,epoch time: 0:22:03.136221,used: 2:53:26.138072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9713542, 'precision': 0.9675406, 'recall': 0.95624936, 'specificity': 0.95624936, 'f1': 0.9617192, 'auroc': 0.9921968, 'binary_precision': 0.96007484, 'binary_recall': 0.9255843, 'binary_specificity': 0.9869144, 'binary_f1_score': 0.9425141}
confusion matrix:
       0      1
0  41858    555
1   1073  13346
---- Validation: 
scalar performance:
{'acc': 0.9548026, 'precision': 0.6896078, 'recall': 0.73766017, 'specificity': 0.73766017, 'f1': 0.71051645, 'auroc': 0.84809375, 'binary_precision': 0.39788732, 'binary_recall': 0.5037147, 'binary_specificity': 0.9716057, 'binary_f1_score': 0.44459015}
confusion matrix:
       0    1
0  17554  513
1    334  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.7891898, 'recall': 0.7538863, 'specificity': 0.7538863, 'f1': 0.77024615, 'auroc': 0.8667947, 'binary_precision': 0.59911895, 'binary_recall': 0.52307695, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.55852157}
confusion matrix:
      0    1
0  5855   91
1   124  136
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_9.png
early stop counter: 1
val acc:0.9548025727272034, best validation acc: 0.9599786400794983, corresponding to test acc:                         0.967934250831604 / 0.967934250831604
after epoch: 9,now: 2024-06-24 03:42:46.297728,epoch time: 0:21:37.963528,used: 3:15:04.101600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9721284, 'precision': 0.9684346, 'recall': 0.9574342, 'specificity': 0.9574342, 'f1': 0.96276784, 'auroc': 0.99221206, 'binary_precision': 0.96119577, 'binary_recall': 0.92760056, 'binary_specificity': 0.98726773, 'binary_f1_score': 0.94409937}
confusion matrix:
       0      1
0  41872    540
1   1044  13376
---- Validation: 
scalar performance:
{'acc': 0.95373535, 'precision': 0.6845683, 'recall': 0.7349609, 'specificity': 0.7349609, 'f1': 0.7062622, 'auroc': 0.84124494, 'binary_precision': 0.38799077, 'binary_recall': 0.49925706, 'binary_specificity': 0.97066474, 'binary_f1_score': 0.4366472}
confusion matrix:
       0    1
0  17537  530
1    337  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.78496397, 'recall': 0.75547296, 'specificity': 0.75547296, 'f1': 0.76931095, 'auroc': 0.86304426, 'binary_precision': 0.5905172, 'binary_recall': 0.52692306, 'binary_specificity': 0.98402286, 'binary_f1_score': 0.5569106}
confusion matrix:
      0    1
0  5851   95
1   123  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_10.png
early stop counter: 2
val acc:0.9537353515625, best validation acc: 0.9599786400794983, corresponding to test acc:                         0.967934250831604 / 0.967934250831604
after epoch: 10,now: 2024-06-24 04:04:41.421499,epoch time: 0:21:55.123771,used: 3:36:59.225371,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97101986, 'precision': 0.97164106, 'recall': 0.95128465, 'specificity': 0.95128465, 'f1': 0.96090364, 'auroc': 0.99256504, 'binary_precision': 0.9728249, 'binary_recall': 0.9112221, 'binary_specificity': 0.9913472, 'binary_f1_score': 0.9410164}
confusion matrix:
       0      1
0  42047    367
1   1280  13138
---- Validation: 
scalar performance:
{'acc': 0.9597652, 'precision': 0.70936126, 'recall': 0.70876217, 'specificity': 0.70876217, 'f1': 0.70906126, 'auroc': 0.8355882, 'binary_precision': 0.4396423, 'binary_recall': 0.4383358, 'binary_specificity': 0.97918856, 'binary_f1_score': 0.4389881}
confusion matrix:
       0    1
0  17691  376
1    378  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96825653, 'precision': 0.8230101, 'recall': 0.735171, 'specificity': 0.735171, 'f1': 0.77140975, 'auroc': 0.85925126, 'binary_precision': 0.6684492, 'binary_recall': 0.48076922, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.5592841}
confusion matrix:
      0    1
0  5884   62
1   135  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_11.png
new oracle model saved
early stop counter: 3
val acc:0.9597651958465576, best validation acc: 0.9599786400794983, corresponding to test acc:                         0.967934250831604 / 0.9682565331459045
after epoch: 11,now: 2024-06-24 04:26:25.246946,epoch time: 0:21:43.825447,used: 3:58:43.050818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97167087, 'precision': 0.9693819, 'recall': 0.9552282, 'specificity': 0.9552282, 'f1': 0.9620311, 'auroc': 0.99231946, 'binary_precision': 0.964939, 'binary_recall': 0.92184466, 'binary_specificity': 0.9886117, 'binary_f1_score': 0.9428997}
confusion matrix:
       0      1
0  41929    483
1   1127  13293
---- Validation: 
scalar performance:
{'acc': 0.9576841, 'precision': 0.69991636, 'recall': 0.72127295, 'specificity': 0.72127295, 'f1': 0.7099753, 'auroc': 0.8406577, 'binary_precision': 0.4197861, 'binary_recall': 0.4665676, 'binary_specificity': 0.9759783, 'binary_f1_score': 0.44194227}
confusion matrix:
       0    1
0  17633  434
1    359  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.80624163, 'recall': 0.74369323, 'specificity': 0.74369323, 'f1': 0.7709903, 'auroc': 0.8559277, 'binary_precision': 0.63414633, 'binary_recall': 0.5, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.5591398}
confusion matrix:
      0    1
0  5871   75
1   130  130
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_12.png
early stop counter: 4
val acc:0.9576840996742249, best validation acc: 0.9599786400794983, corresponding to test acc:                         0.967934250831604 / 0.9682565331459045
after epoch: 12,now: 2024-06-24 04:47:48.849733,epoch time: 0:21:23.602787,used: 4:20:06.653605,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9718996, 'precision': 0.9722518, 'recall': 0.95301855, 'specificity': 0.95301855, 'f1': 0.9621362, 'auroc': 0.99270344, 'binary_precision': 0.9729251, 'binary_recall': 0.91468996, 'binary_specificity': 0.9913472, 'binary_f1_score': 0.9429092}
confusion matrix:
       0      1
0  42047    367
1   1230  13188
---- Validation: 
scalar performance:
{'acc': 0.95981854, 'precision': 0.7081406, 'recall': 0.6994914, 'specificity': 0.6994914, 'f1': 0.7037118, 'auroc': 0.82445145, 'binary_precision': 0.4378882, 'binary_recall': 0.4190193, 'binary_specificity': 0.9799635, 'binary_f1_score': 0.42824602}
confusion matrix:
       0    1
0  17705  362
1    391  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.80181307, 'recall': 0.7322389, 'specificity': 0.7322389, 'f1': 0.7619587, 'auroc': 0.8502246, 'binary_precision': 0.6262626, 'binary_recall': 0.47692308, 'binary_specificity': 0.98755467, 'binary_f1_score': 0.5414847}
confusion matrix:
      0    1
0  5872   74
1   136  124
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_13.png
early stop counter: 5
val acc:0.9598185420036316, best validation acc: 0.9599786400794983, corresponding to test acc:                         0.967934250831604 / 0.9682565331459045
after epoch: 13,now: 2024-06-24 05:09:09.569664,epoch time: 0:21:20.719931,used: 4:41:27.373536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9720756, 'precision': 0.9726877, 'recall': 0.9530735, 'specificity': 0.9530735, 'f1': 0.9623624, 'auroc': 0.9931942, 'binary_precision': 0.97385716, 'binary_recall': 0.91449374, 'binary_specificity': 0.9916533, 'binary_f1_score': 0.9432423}
confusion matrix:
       0      1
0  42058    354
1   1233  13187
---- Validation: 
scalar performance:
{'acc': 0.96195304, 'precision': 0.72298604, 'recall': 0.70345944, 'specificity': 0.70345944, 'f1': 0.7127187, 'auroc': 0.8274987, 'binary_precision': 0.46732026, 'binary_recall': 0.42496285, 'binary_specificity': 0.98195606, 'binary_f1_score': 0.4451362}
confusion matrix:
       0    1
0  17741  326
1    387  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.86405873, 'recall': 0.72364354, 'specificity': 0.72364354, 'f1': 0.7754288, 'auroc': 0.85277414, 'binary_precision': 0.75159234, 'binary_recall': 0.45384616, 'binary_specificity': 0.993441, 'binary_f1_score': 0.56594723}
confusion matrix:
      0    1
0  5907   39
1   142  118
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_14.png
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-06-24 05:30:55.366027,epoch time: 0:21:45.796363,used: 5:03:13.169899,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97293776, 'precision': 0.97294915, 'recall': 0.9550848, 'specificity': 0.9550848, 'f1': 0.9635868, 'auroc': 0.993822, 'binary_precision': 0.97297096, 'binary_recall': 0.91884583, 'binary_specificity': 0.9913238, 'binary_f1_score': 0.9451341}
confusion matrix:
       0      1
0  42047    368
1   1170  13247
---- Validation: 
scalar performance:
{'acc': 0.9603522, 'precision': 0.71227133, 'recall': 0.7040597, 'specificity': 0.7040597, 'f1': 0.70807374, 'auroc': 0.8439399, 'binary_precision': 0.44582042, 'binary_recall': 0.42793462, 'binary_specificity': 0.98018485, 'binary_f1_score': 0.43669447}
confusion matrix:
       0    1
0  17709  358
1    385  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9695456, 'precision': 0.8446133, 'recall': 0.7248098, 'specificity': 0.7248098, 'f1': 0.7708037, 'auroc': 0.8536516, 'binary_precision': 0.71257484, 'binary_recall': 0.4576923, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.55737704}
confusion matrix:
      0    1
0  5898   48
1   141  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_15.png
early stop counter: 1
val acc:0.9603521823883057, best validation acc: 0.9619530439376831, corresponding to test acc:                         0.9708346724510193 / 0.9708346724510193
after epoch: 15,now: 2024-06-24 05:52:35.207286,epoch time: 0:21:39.841259,used: 5:24:53.011158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97526044, 'precision': 0.97062314, 'recall': 0.96369386, 'specificity': 0.96369386, 'f1': 0.9670925, 'auroc': 0.9939966, 'binary_precision': 0.96141845, 'binary_recall': 0.9402136, 'binary_specificity': 0.98717403, 'binary_f1_score': 0.9506978}
confusion matrix:
       0      1
0  41870    544
1    862  13556
---- Validation: 
scalar performance:
{'acc': 0.9552828, 'precision': 0.69355065, 'recall': 0.74720776, 'specificity': 0.74720776, 'f1': 0.716616, 'auroc': 0.85372245, 'binary_precision': 0.4050633, 'binary_recall': 0.5230312, 'binary_specificity': 0.9713843, 'binary_f1_score': 0.4565499}
confusion matrix:
       0    1
0  17550  517
1    321  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.7906179, 'recall': 0.7670114, 'specificity': 0.7670114, 'f1': 0.7782515, 'auroc': 0.8788688, 'binary_precision': 0.60084033, 'binary_recall': 0.55, 'binary_specificity': 0.98402286, 'binary_f1_score': 0.57429725}
confusion matrix:
      0    1
0  5851   95
1   117  143
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_16.png
early stop counter: 2
val acc:0.9552828073501587, best validation acc: 0.9619530439376831, corresponding to test acc:                         0.9708346724510193 / 0.9708346724510193
after epoch: 16,now: 2024-06-24 06:14:09.508993,epoch time: 0:21:34.301707,used: 5:46:27.312865,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9760698, 'precision': 0.96854377, 'recall': 0.96824336, 'specificity': 0.96824336, 'f1': 0.96839345, 'auroc': 0.9945226, 'binary_precision': 0.9532801, 'binary_recall': 0.95235455, 'binary_specificity': 0.98413223, 'binary_f1_score': 0.9528171}
confusion matrix:
       0      1
0  41740    673
1    687  13732
---- Validation: 
scalar performance:
{'acc': 0.955016, 'precision': 0.6960754, 'recall': 0.7670969, 'specificity': 0.7670969, 'f1': 0.725307, 'auroc': 0.8618345, 'binary_precision': 0.40860215, 'binary_recall': 0.56463593, 'binary_specificity': 0.96955776, 'binary_f1_score': 0.47411102}
confusion matrix:
       0    1
0  17517  550
1    293  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.7862487, 'recall': 0.7629971, 'specificity': 0.7629971, 'f1': 0.7740675, 'auroc': 0.8822764, 'binary_precision': 0.59243697, 'binary_recall': 0.5423077, 'binary_specificity': 0.9836865, 'binary_f1_score': 0.56626505}
confusion matrix:
      0    1
0  5849   97
1   119  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_17.png
early stop counter: 3
val acc:0.955016016960144, best validation acc: 0.9619530439376831, corresponding to test acc:                         0.9708346724510193 / 0.9708346724510193
after epoch: 17,now: 2024-06-24 06:35:31.866814,epoch time: 0:21:22.357821,used: 6:07:49.670686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97448623, 'precision': 0.9760939, 'recall': 0.95617616, 'specificity': 0.95617616, 'f1': 0.96560574, 'auroc': 0.99463034, 'binary_precision': 0.9791636, 'binary_recall': 0.9190014, 'binary_specificity': 0.9933509, 'binary_f1_score': 0.94812906}
confusion matrix:
       0      1
0  42130    282
1   1168  13252
---- Validation: 
scalar performance:
{'acc': 0.9626467, 'precision': 0.7270074, 'recall': 0.69237494, 'specificity': 0.69237494, 'f1': 0.7080841, 'auroc': 0.8520415, 'binary_precision': 0.47619048, 'binary_recall': 0.4011887, 'binary_specificity': 0.9835612, 'binary_f1_score': 0.43548387}
confusion matrix:
       0    1
0  17770  297
1    403  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705124, 'precision': 0.8819754, 'recall': 0.6995685, 'specificity': 0.6995685, 'f1': 0.7595626, 'auroc': 0.86278236, 'binary_precision': 0.7894737, 'binary_recall': 0.40384614, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.53435117}
confusion matrix:
      0    1
0  5918   28
1   155  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_18.png
better model found
persisted
after epoch: 18,now: 2024-06-24 06:56:44.834337,epoch time: 0:21:12.967523,used: 6:29:02.638209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97589386, 'precision': 0.97703147, 'recall': 0.958973, 'specificity': 0.958973, 'f1': 0.96756744, 'auroc': 0.9948099, 'binary_precision': 0.9792156, 'binary_recall': 0.9246186, 'binary_specificity': 0.9933274, 'binary_f1_score': 0.95113426}
confusion matrix:
       0      1
0  42129    283
1   1087  13333
---- Validation: 
scalar performance:
{'acc': 0.9620064, 'precision': 0.72398764, 'recall': 0.70920926, 'specificity': 0.70920926, 'f1': 0.71631414, 'auroc': 0.8419479, 'binary_precision': 0.46889952, 'binary_recall': 0.43684992, 'binary_specificity': 0.98156863, 'binary_f1_score': 0.4523077}
confusion matrix:
       0    1
0  17734  333
1    379  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.831385, 'recall': 0.7035719, 'specificity': 0.7035719, 'f1': 0.7506143, 'auroc': 0.8479936, 'binary_precision': 0.6878981, 'binary_recall': 0.41538462, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.51798564}
confusion matrix:
      0    1
0  5897   49
1   152  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_19.png
early stop counter: 1
val acc:0.9620063900947571, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9705123901367188 / 0.9708346724510193
after epoch: 19,now: 2024-06-24 07:18:20.091183,epoch time: 0:21:35.256846,used: 6:50:37.895055,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9774071, 'precision': 0.9753673, 'recall': 0.9646096, 'specificity': 0.9646096, 'f1': 0.9698322, 'auroc': 0.99500084, 'binary_precision': 0.97136503, 'binary_recall': 0.9386269, 'binary_specificity': 0.9905923, 'binary_f1_score': 0.9547154}
confusion matrix:
       0      1
0  42013    399
1    885  13535
---- Validation: 
scalar performance:
{'acc': 0.9596051, 'precision': 0.7118306, 'recall': 0.7308524, 'specificity': 0.7308524, 'f1': 0.7208766, 'auroc': 0.84774715, 'binary_precision': 0.44293478, 'binary_recall': 0.48439822, 'binary_specificity': 0.97730666, 'binary_f1_score': 0.46273953}
confusion matrix:
       0    1
0  17657  410
1    347  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.8362714, 'recall': 0.7244735, 'specificity': 0.7244735, 'f1': 0.7680477, 'auroc': 0.8671279, 'binary_precision': 0.69590646, 'binary_recall': 0.4576923, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.5522042}
confusion matrix:
      0    1
0  5894   52
1   141  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_20.png
early stop counter: 2
val acc:0.9596050977706909, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9705123901367188 / 0.9708346724510193
after epoch: 20,now: 2024-06-24 07:39:56.905191,epoch time: 0:21:36.814008,used: 7:12:14.709063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97717834, 'precision': 0.9712681, 'recall': 0.96829784, 'specificity': 0.96829784, 'f1': 0.96977085, 'auroc': 0.99459255, 'binary_precision': 0.9593866, 'binary_recall': 0.9502705, 'binary_specificity': 0.98632526, 'binary_f1_score': 0.9548068}
confusion matrix:
       0      1
0  41834    580
1    717  13701
---- Validation: 
scalar performance:
{'acc': 0.9554429, 'precision': 0.69478977, 'recall': 0.7501518, 'specificity': 0.7501518, 'f1': 0.71850395, 'auroc': 0.8572414, 'binary_precision': 0.40732265, 'binary_recall': 0.5289747, 'binary_specificity': 0.9713289, 'binary_f1_score': 0.46024564}
confusion matrix:
       0    1
0  17549  518
1    317  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.7715273, 'recall': 0.73231196, 'specificity': 0.73231196, 'f1': 0.75019467, 'auroc': 0.8668853, 'binary_precision': 0.5656109, 'binary_recall': 0.48076922, 'binary_specificity': 0.9838547, 'binary_f1_score': 0.5197506}
confusion matrix:
      0    1
0  5850   96
1   135  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_21.png
early stop counter: 3
val acc:0.9554429054260254, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9705123901367188 / 0.9708346724510193
after epoch: 21,now: 2024-06-24 08:01:27.890829,epoch time: 0:21:30.985638,used: 7:33:45.694701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97877955, 'precision': 0.97498953, 'recall': 0.96870685, 'specificity': 0.96870685, 'f1': 0.9717946, 'auroc': 0.99508333, 'binary_precision': 0.9674498, 'binary_recall': 0.9482591, 'binary_specificity': 0.9891545, 'binary_f1_score': 0.95775837}
confusion matrix:
       0      1
0  41954    460
1    746  13672
---- Validation: 
scalar performance:
{'acc': 0.9565101, 'precision': 0.69778323, 'recall': 0.74069154, 'specificity': 0.74069154, 'f1': 0.7168267, 'auroc': 0.846213, 'binary_precision': 0.41404358, 'binary_recall': 0.50817233, 'binary_specificity': 0.9732108, 'binary_f1_score': 0.45630416}
confusion matrix:
       0    1
0  17583  484
1    331  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.7694379, 'recall': 0.7525408, 'specificity': 0.7525408, 'f1': 0.7606792, 'auroc': 0.8723395, 'binary_precision': 0.5596708, 'binary_recall': 0.52307695, 'binary_specificity': 0.9820047, 'binary_f1_score': 0.5407555}
confusion matrix:
      0    1
0  5839  107
1   124  136
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_22.png
early stop counter: 4
val acc:0.9565101265907288, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9705123901367188 / 0.9708346724510193
after epoch: 22,now: 2024-06-24 08:23:17.837441,epoch time: 0:21:49.946612,used: 7:55:35.641313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97844523, 'precision': 0.9764163, 'recall': 0.9663311, 'specificity': 0.9663311, 'f1': 0.9712367, 'auroc': 0.9953079, 'binary_precision': 0.9724271, 'binary_recall': 0.9417395, 'binary_specificity': 0.9909228, 'binary_f1_score': 0.9568373}
confusion matrix:
       0      1
0  42029    385
1    840  13578
---- Validation: 
scalar performance:
{'acc': 0.9603522, 'precision': 0.7167805, 'recall': 0.73624676, 'specificity': 0.73624676, 'f1': 0.7260387, 'auroc': 0.86706054, 'binary_precision': 0.45244566, 'binary_recall': 0.4947994, 'binary_specificity': 0.97769415, 'binary_f1_score': 0.47267568}
confusion matrix:
       0    1
0  17664  403
1    340  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709958, 'precision': 0.8664696, 'recall': 0.72372764, 'specificity': 0.72372764, 'f1': 0.77615136, 'auroc': 0.87679404, 'binary_precision': 0.75641024, 'binary_recall': 0.45384616, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.5673077}
confusion matrix:
      0    1
0  5908   38
1   142  118
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_23.png
new oracle model saved
early stop counter: 5
val acc:0.9603521823883057, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9705123901367188 / 0.9709957838058472
after epoch: 23,now: 2024-06-24 08:44:06.161764,epoch time: 0:20:48.324323,used: 8:16:23.965636,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9782517, 'precision': 0.97571814, 'recall': 0.9665257, 'specificity': 0.9665257, 'f1': 0.9710077, 'auroc': 0.99519944, 'binary_precision': 0.9707227, 'binary_recall': 0.94271845, 'binary_specificity': 0.9903329, 'binary_f1_score': 0.9565156}
confusion matrix:
       0      1
0  42002    410
1    826  13594
---- Validation: 
scalar performance:
{'acc': 0.95757735, 'precision': 0.70317113, 'recall': 0.7426756, 'specificity': 0.7426756, 'f1': 0.7209196, 'auroc': 0.8517126, 'binary_precision': 0.42469135, 'binary_recall': 0.5111441, 'binary_specificity': 0.9742071, 'binary_f1_score': 0.46392444}
confusion matrix:
       0    1
0  17601  466
1    329  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.78752345, 'recall': 0.72772, 'specificity': 0.72772, 'f1': 0.75372446, 'auroc': 0.86455274, 'binary_precision': 0.5980392, 'binary_recall': 0.46923077, 'binary_specificity': 0.9862092, 'binary_f1_score': 0.52586204}
confusion matrix:
      0    1
0  5864   82
1   138  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_24.png
early stop counter: 6
val acc:0.9575773477554321, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9705123901367188 / 0.9709957838058472
after epoch: 24,now: 2024-06-24 09:05:24.962673,epoch time: 0:21:18.800909,used: 8:37:42.766545,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9796593, 'precision': 0.97727585, 'recall': 0.96872747, 'specificity': 0.96872747, 'f1': 0.9729033, 'auroc': 0.995757, 'binary_precision': 0.9725666, 'binary_recall': 0.9465326, 'binary_specificity': 0.9909224, 'binary_f1_score': 0.95937306}
confusion matrix:
       0      1
0  42027    385
1    771  13649
---- Validation: 
scalar performance:
{'acc': 0.95987195, 'precision': 0.71490914, 'recall': 0.7424351, 'specificity': 0.7424351, 'f1': 0.72772986, 'auroc': 0.8638126, 'binary_precision': 0.44823065, 'binary_recall': 0.50817233, 'binary_specificity': 0.97669786, 'binary_f1_score': 0.4763231}
confusion matrix:
       0    1
0  17646  421
1    331  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97067356, 'precision': 0.8521855, 'recall': 0.7364324, 'specificity': 0.7364324, 'f1': 0.78175586, 'auroc': 0.8812419, 'binary_precision': 0.7267442, 'binary_recall': 0.48076922, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.5787037}
confusion matrix:
      0    1
0  5899   47
1   135  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_25.png
early stop counter: 7
val acc:0.9598719477653503, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9705123901367188 / 0.9709957838058472
after epoch: 25,now: 2024-06-24 09:27:57.381548,epoch time: 0:22:32.418875,used: 9:00:15.185420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9802928, 'precision': 0.9767524, 'recall': 0.9709811, 'specificity': 0.9709811, 'f1': 0.9738217, 'auroc': 0.99639416, 'binary_precision': 0.969697, 'binary_recall': 0.9520771, 'binary_specificity': 0.98988515, 'binary_f1_score': 0.96080625}
confusion matrix:
       0      1
0  41984    429
1    691  13728
---- Validation: 
scalar performance:
{'acc': 0.9578442, 'precision': 0.70707595, 'recall': 0.7592651, 'specificity': 0.7592651, 'f1': 0.729828, 'auroc': 0.86181843, 'binary_precision': 0.43125734, 'binary_recall': 0.54531944, 'binary_specificity': 0.9732108, 'binary_f1_score': 0.48162726}
confusion matrix:
       0    1
0  17583  484
1    306  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.77621925, 'recall': 0.7363263, 'specificity': 0.7363263, 'f1': 0.7545202, 'auroc': 0.8714391, 'binary_precision': 0.57466066, 'binary_recall': 0.48846152, 'binary_specificity': 0.98419106, 'binary_f1_score': 0.5280665}
confusion matrix:
      0    1
0  5852   94
1   133  127
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_26.png
early stop counter: 8
val acc:0.9578441977500916, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9705123901367188 / 0.9709957838058472
after epoch: 26,now: 2024-06-24 09:51:12.347188,epoch time: 0:23:14.965640,used: 9:23:30.151060,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97948337, 'precision': 0.97663724, 'recall': 0.9689054, 'specificity': 0.9689054, 'f1': 0.9726906, 'auroc': 0.9957254, 'binary_precision': 0.9710001, 'binary_recall': 0.9474305, 'binary_specificity': 0.9903803, 'binary_f1_score': 0.9590705}
confusion matrix:
       0      1
0  42005    408
1    758  13661
---- Validation: 
scalar performance:
{'acc': 0.9585912, 'precision': 0.70935285, 'recall': 0.7503541, 'specificity': 0.7503541, 'f1': 0.7277655, 'auroc': 0.8618947, 'binary_precision': 0.43649817, 'binary_recall': 0.52600294, 'binary_specificity': 0.9747053, 'binary_f1_score': 0.47708896}
confusion matrix:
       0    1
0  17610  457
1    319  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.79106116, 'recall': 0.7130081, 'specificity': 0.7130081, 'f1': 0.74527, 'auroc': 0.8667889, 'binary_precision': 0.60638297, 'binary_recall': 0.43846154, 'binary_specificity': 0.98755467, 'binary_f1_score': 0.50892854}
confusion matrix:
      0    1
0  5872   74
1   146  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_27.png
early stop counter: 9
val acc:0.9585912227630615, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9705123901367188 / 0.9709957838058472
after epoch: 27,now: 2024-06-24 10:18:58.199306,epoch time: 0:27:45.852118,used: 9:51:16.003178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9806623, 'precision': 0.97780704, 'recall': 0.97088385, 'specificity': 0.97088385, 'f1': 0.9742809, 'auroc': 0.99622214, 'binary_precision': 0.9721375, 'binary_recall': 0.9510334, 'binary_specificity': 0.9907342, 'binary_f1_score': 0.9614697}
confusion matrix:
       0      1
0  42021    393
1    706  13712
---- Validation: 
scalar performance:
{'acc': 0.9607257, 'precision': 0.7173542, 'recall': 0.7235657, 'specificity': 0.7235657, 'f1': 0.72041035, 'auroc': 0.8503487, 'binary_precision': 0.45454547, 'binary_recall': 0.4680535, 'binary_specificity': 0.9790779, 'binary_f1_score': 0.4612006}
confusion matrix:
       0    1
0  17689  378
1    358  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.83617926, 'recall': 0.7282355, 'specificity': 0.7282355, 'f1': 0.7707872, 'auroc': 0.8653715, 'binary_precision': 0.6954023, 'binary_recall': 0.4653846, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.5576037}
confusion matrix:
      0    1
0  5893   53
1   139  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_28.png
early stop counter: 10
val acc:0.960725724697113, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9705123901367188 / 0.9709957838058472
after epoch: 28,now: 2024-06-24 10:46:20.564682,epoch time: 0:27:22.365376,used: 10:18:38.368554,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9777766, 'precision': 0.97918785, 'recall': 0.96185446, 'specificity': 0.96185446, 'f1': 0.9701227, 'auroc': 0.9952751, 'binary_precision': 0.98190343, 'binary_recall': 0.9295325, 'binary_specificity': 0.99417645, 'binary_f1_score': 0.9550006}
confusion matrix:
       0      1
0  42167    247
1   1016  13402
---- Validation: 
scalar performance:
{'acc': 0.9627535, 'precision': 0.7281753, 'recall': 0.69600666, 'specificity': 0.69600666, 'f1': 0.71072024, 'auroc': 0.84139067, 'binary_precision': 0.47826087, 'binary_recall': 0.40861812, 'binary_specificity': 0.98339516, 'binary_f1_score': 0.44070515}
confusion matrix:
       0    1
0  17767  300
1    398  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.8370348, 'recall': 0.7019011, 'specificity': 0.7019011, 'f1': 0.75078756, 'auroc': 0.8660263, 'binary_precision': 0.6993464, 'binary_recall': 0.41153845, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.5181598}
confusion matrix:
      0    1
0  5900   46
1   153  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_29.png
better model found
persisted
after epoch: 29,now: 2024-06-24 11:13:59.082882,epoch time: 0:27:38.518200,used: 10:46:16.886754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97967696, 'precision': 0.9794657, 'recall': 0.96658814, 'specificity': 0.96658814, 'f1': 0.972806, 'auroc': 0.99564373, 'binary_precision': 0.9790538, 'binary_recall': 0.9400139, 'binary_specificity': 0.99316233, 'binary_f1_score': 0.9591368}
confusion matrix:
       0      1
0  42122    290
1    865  13555
---- Validation: 
scalar performance:
{'acc': 0.9623266, 'precision': 0.72720027, 'recall': 0.7193891, 'specificity': 0.7193891, 'f1': 0.7232176, 'auroc': 0.8616471, 'binary_precision': 0.47457626, 'binary_recall': 0.4576523, 'binary_specificity': 0.98112583, 'binary_f1_score': 0.46596065}
confusion matrix:
       0    1
0  17726  341
1    365  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671286, 'precision': 0.82922125, 'recall': 0.6959637, 'specificity': 0.6959637, 'f1': 0.74392724, 'auroc': 0.8656653, 'binary_precision': 0.68421054, 'binary_recall': 0.4, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.50485444}
confusion matrix:
      0    1
0  5898   48
1   156  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_30.png
early stop counter: 1
val acc:0.9623265862464905, best validation acc: 0.9627534747123718, corresponding to test acc:                         0.967934250831604 / 0.9709957838058472
after epoch: 30,now: 2024-06-24 11:51:29.764475,epoch time: 0:37:30.681593,used: 11:23:47.568347,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_00_27_42_seed_1_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:23:47.568347 at 2024-06-24 11:51:29.764475
persisted model performance metric: 

scalar performance:
{'acc': 0.96793425, 'precision': 0.8370348, 'recall': 0.7019011, 'specificity': 0.7019011, 'f1': 0.75078756, 'auroc': 0.8660263, 'binary_precision': 0.6993464, 'binary_recall': 0.41153845, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.5181598}
confusion matrix:
      0    1
0  5900   46
1   153  107
oracle model performance metric: 

scalar performance:
{'acc': 0.9709958, 'precision': 0.8664696, 'recall': 0.72372764, 'specificity': 0.72372764, 'f1': 0.77615136, 'auroc': 0.87679404, 'binary_precision': 0.75641024, 'binary_recall': 0.45384616, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.5673077}
confusion matrix:
      0    1
0  5908   38
1   142  118
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204071 KiB | 571737 KiB |    994 TiB |    994 TiB |
|       from large pool | 167040 KiB | 499008 KiB |    992 TiB |    992 TiB |
|       from small pool |  37031 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204071 KiB | 571737 KiB |    994 TiB |    994 TiB |
|       from large pool | 167040 KiB | 499008 KiB |    992 TiB |    992 TiB |
|       from small pool |  37031 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 563304 KiB |    982 TiB |    982 TiB |
|       from large pool | 165120 KiB | 491712 KiB |    980 TiB |    980 TiB |
|       from small pool |  35966 KiB |  74337 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 778240 KiB | 778240 KiB |   1190 MiB | 440320 KiB |
|       from large pool | 702464 KiB | 702464 KiB |   1092 MiB | 415744 KiB |
|       from small pool |  75776 KiB |  75776 KiB |     98 MiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80600 KiB | 209453 KiB | 639645 GiB | 639645 GiB |
|       from large pool |  68480 KiB | 208064 KiB | 638108 GiB | 638108 GiB |
|       from small pool |  12120 KiB |  21751 KiB |   1537 GiB |   1537 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    7879    |  204645 K  |  204642 K  |
|       from large pool |      36    |      76    |   68866 K  |   68866 K  |
|       from small pool |    3192    |    7842    |  135779 K  |  135776 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    7879    |  204645 K  |  204642 K  |
|       from large pool |      36    |      76    |   68866 K  |   68866 K  |
|       from small pool |    3192    |    7842    |  135779 K  |  135776 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      53    |      70    |      17    |
|       from large pool |      16    |      16    |      21    |       5    |
|       from small pool |      37    |      37    |      49    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3581    |   92079 K  |   92079 K  |
|       from large pool |       5    |      13    |   27904 K  |   27904 K  |
|       from small pool |      30    |    3574    |   64174 K  |   64174 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB |    994 TiB |    994 TiB |
|       from large pool |  16640 KiB | 499008 KiB |    992 TiB |    992 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB |    994 TiB |    994 TiB |
|       from large pool |  16640 KiB | 499008 KiB |    992 TiB |    992 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB |    982 TiB |    982 TiB |
|       from large pool |  16640 KiB | 491712 KiB |    980 TiB |    980 TiB |
|       from small pool |      0 KiB |  74337 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 778240 KiB |   1190 MiB |    912 MiB |
|       from large pool | 235520 KiB | 702464 KiB |   1092 MiB |    862 MiB |
|       from small pool |  49152 KiB |  75776 KiB |     98 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB | 639646 GiB | 639646 GiB |
|       from large pool |  55040 KiB | 208064 KiB | 638109 GiB | 638108 GiB |
|       from small pool |      0 KiB |  21751 KiB |   1537 GiB |   1537 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  204645 K  |  204645 K  |
|       from large pool |       2    |      76    |   68866 K  |   68866 K  |
|       from small pool |       0    |    7842    |  135779 K  |  135779 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  204645 K  |  204645 K  |
|       from large pool |       2    |      76    |   68866 K  |   68866 K  |
|       from small pool |       0    |    7842    |  135779 K  |  135779 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      53    |      70    |      36    |
|       from large pool |      10    |      16    |      21    |      11    |
|       from small pool |      24    |      37    |      49    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   92080 K  |   92080 K  |
|       from large pool |       3    |      13    |   27904 K  |   27904 K  |
|       from small pool |       0    |    3574    |   64175 K  |   64175 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 571737 KiB |    994 TiB |    994 TiB |
|       from large pool |  16640 KiB | 499008 KiB |    992 TiB |    992 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 571737 KiB |    994 TiB |    994 TiB |
|       from large pool |  16640 KiB | 499008 KiB |    992 TiB |    992 TiB |
|       from small pool |      0 KiB |  75475 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 563304 KiB |    982 TiB |    982 TiB |
|       from large pool |  16640 KiB | 491712 KiB |    980 TiB |    980 TiB |
|       from small pool |      0 KiB |  74337 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 778240 KiB |   1190 MiB |    912 MiB |
|       from large pool | 235520 KiB | 702464 KiB |   1092 MiB |    862 MiB |
|       from small pool |  49152 KiB |  75776 KiB |     98 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB | 639646 GiB | 639646 GiB |
|       from large pool |  55040 KiB | 208064 KiB | 638109 GiB | 638108 GiB |
|       from small pool |      0 KiB |  21751 KiB |   1537 GiB |   1537 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  204645 K  |  204645 K  |
|       from large pool |       2    |      76    |   68866 K  |   68866 K  |
|       from small pool |       0    |    7842    |  135779 K  |  135779 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  204645 K  |  204645 K  |
|       from large pool |       2    |      76    |   68866 K  |   68866 K  |
|       from small pool |       0    |    7842    |  135779 K  |  135779 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      53    |      70    |      36    |
|       from large pool |      10    |      16    |      21    |      11    |
|       from small pool |      24    |      37    |      49    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   92080 K  |   92080 K  |
|       from large pool |       3    |      13    |   27904 K  |   27904 K  |
|       from small pool |       0    |    3574    |   64175 K  |   64175 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148

 Experiment start at: 2024-06-24 12:04:53.789167
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9036212, 'precision': 0.9188411, 'recall': 0.83008707, 'specificity': 0.83008707, 'f1': 0.8622153, 'auroc': 0.9607126, 'binary_precision': 0.9432637, 'binary_recall': 0.6746861, 'binary_specificity': 0.98548806, 'binary_f1_score': 0.78668314}
confusion matrix:
       0      1
0  41696    614
1   4922  10208
---- Validation: 
scalar performance:
{'acc': 0.9517925, 'precision': 0.5869051, 'recall': 0.57357347, 'specificity': 0.57357347, 'f1': 0.57955605, 'auroc': 0.677106, 'binary_precision': 0.20118344, 'binary_recall': 0.16943522, 'binary_specificity': 0.97771174, 'binary_f1_score': 0.18394952}
confusion matrix:
       0    1
0  17766  405
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95031255, 'precision': 0.64132184, 'recall': 0.6073467, 'specificity': 0.6073467, 'f1': 0.6215751, 'auroc': 0.7470678, 'binary_precision': 0.31318682, 'binary_recall': 0.23553719, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.2688679}
confusion matrix:
      0    1
0  5872  125
1   185   57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-24 12:30:03.226448,epoch time: 0:25:09.437281,used: 0:25:09.437281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93821377, 'precision': 0.93686867, 'recall': 0.9012866, 'specificity': 0.9012866, 'f1': 0.9171139, 'auroc': 0.9758704, 'binary_precision': 0.9343586, 'binary_recall': 0.82325333, 'binary_specificity': 0.9793198, 'binary_f1_score': 0.87529427}
confusion matrix:
       0      1
0  41436    875
1   2674  12455
---- Validation: 
scalar performance:
{'acc': 0.94316304, 'precision': 0.599872, 'recall': 0.63737494, 'specificity': 0.63737494, 'f1': 0.61499465, 'auroc': 0.7364415, 'binary_precision': 0.22288439, 'binary_recall': 0.31063122, 'binary_specificity': 0.96411866, 'binary_f1_score': 0.259542}
confusion matrix:
       0    1
0  17519  652
1    415  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95047283, 'precision': 0.66757697, 'recall': 0.6669123, 'specificity': 0.6669123, 'f1': 0.66724384, 'auroc': 0.7638061, 'binary_precision': 0.36099586, 'binary_recall': 0.35950413, 'binary_specificity': 0.9743205, 'binary_f1_score': 0.36024845}
confusion matrix:
      0    1
0  5843  154
1   155   87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_2.png
new oracle model saved
early stop counter: 1
val acc:0.9431630373001099, best validation acc: 0.9517924785614014, corresponding to test acc:                         0.9503125548362732 / 0.9504728317260742
after epoch: 2,now: 2024-06-24 12:55:49.277887,epoch time: 0:25:46.051439,used: 0:50:55.488720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.953656, 'precision': 0.95037305, 'recall': 0.92873275, 'specificity': 0.92873275, 'f1': 0.9388418, 'auroc': 0.9850657, 'binary_precision': 0.9439499, 'binary_recall': 0.87606585, 'binary_specificity': 0.98139966, 'binary_f1_score': 0.9087419}
confusion matrix:
       0      1
0  41524    787
1   1875  13254
---- Validation: 
scalar performance:
{'acc': 0.94864964, 'precision': 0.6286515, 'recall': 0.6723311, 'specificity': 0.6723311, 'f1': 0.6467432, 'auroc': 0.79677916, 'binary_precision': 0.27818626, 'binary_recall': 0.37707642, 'binary_specificity': 0.96758574, 'binary_f1_score': 0.3201692}
confusion matrix:
       0    1
0  17582  589
1    375  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9567238, 'precision': 0.7071357, 'recall': 0.69395685, 'specificity': 0.69395685, 'f1': 0.70029783, 'auroc': 0.8109461, 'binary_precision': 0.4380531, 'binary_recall': 0.4090909, 'binary_specificity': 0.97882277, 'binary_f1_score': 0.42307693}
confusion matrix:
      0    1
0  5870  127
1   143   99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_3.png
new oracle model saved
early stop counter: 2
val acc:0.9486496448516846, best validation acc: 0.9517924785614014, corresponding to test acc:                         0.9503125548362732 / 0.9567238092422485
after epoch: 3,now: 2024-06-24 13:21:36.440593,epoch time: 0:25:47.162706,used: 1:16:42.651426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95797354, 'precision': 0.9544351, 'recall': 0.9360831, 'specificity': 0.9360831, 'f1': 0.94475126, 'auroc': 0.98705983, 'binary_precision': 0.9474314, 'binary_recall': 0.8898215, 'binary_specificity': 0.9823446, 'binary_f1_score': 0.91772324}
confusion matrix:
       0      1
0  41563    747
1   1667  13463
---- Validation: 
scalar performance:
{'acc': 0.94950193, 'precision': 0.63630474, 'recall': 0.6864231, 'specificity': 0.6864231, 'f1': 0.65678984, 'auroc': 0.80830145, 'binary_precision': 0.29256594, 'binary_recall': 0.4053156, 'binary_specificity': 0.96753067, 'binary_f1_score': 0.33983284}
confusion matrix:
       0    1
0  17581  590
1    358  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.956243, 'precision': 0.7067661, 'recall': 0.70758593, 'specificity': 0.70758593, 'f1': 0.7071751, 'auroc': 0.81442374, 'binary_precision': 0.436214, 'binary_recall': 0.43801653, 'binary_specificity': 0.97715527, 'binary_f1_score': 0.43711343}
confusion matrix:
      0    1
0  5860  137
1   136  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_4.png
early stop counter: 3
val acc:0.9495019316673279, best validation acc: 0.9517924785614014, corresponding to test acc:                         0.9503125548362732 / 0.9567238092422485
after epoch: 4,now: 2024-06-24 13:46:22.646207,epoch time: 0:24:46.205614,used: 1:41:28.857040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9633182, 'precision': 0.9626, 'recall': 0.94200385, 'specificity': 0.94200385, 'f1': 0.95167893, 'auroc': 0.98848647, 'binary_precision': 0.96118706, 'binary_recall': 0.89695966, 'binary_specificity': 0.987048, 'binary_f1_score': 0.9279634}
confusion matrix:
       0      1
0  41762    548
1   1559  13571
---- Validation: 
scalar performance:
{'acc': 0.9547222, 'precision': 0.6573481, 'recall': 0.693938, 'specificity': 0.693938, 'f1': 0.67344356, 'auroc': 0.8087276, 'binary_precision': 0.3342246, 'binary_recall': 0.4152824, 'binary_specificity': 0.97259367, 'binary_f1_score': 0.3703704}
confusion matrix:
       0    1
0  17673  498
1    352  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.7460102, 'recall': 0.71067077, 'specificity': 0.71067077, 'f1': 0.72679836, 'auroc': 0.8189563, 'binary_precision': 0.5145631, 'binary_recall': 0.43801653, 'binary_specificity': 0.983325, 'binary_f1_score': 0.4732143}
confusion matrix:
      0    1
0  5897  100
1   136  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-24 14:12:23.755828,epoch time: 0:26:01.109621,used: 2:07:29.966661,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.965477, 'precision': 0.96276873, 'recall': 0.9474788, 'specificity': 0.9474788, 'f1': 0.9547781, 'auroc': 0.9901961, 'binary_precision': 0.95734763, 'binary_recall': 0.90944546, 'binary_specificity': 0.985512, 'binary_f1_score': 0.93278193}
confusion matrix:
       0      1
0  41698    613
1   1370  13759
---- Validation: 
scalar performance:
{'acc': 0.9558941, 'precision': 0.6685328, 'recall': 0.71622574, 'specificity': 0.71622574, 'f1': 0.6889863, 'auroc': 0.8234873, 'binary_precision': 0.3551282, 'binary_recall': 0.4601329, 'binary_specificity': 0.97231853, 'binary_f1_score': 0.4008683}
confusion matrix:
       0    1
0  17668  503
1    325  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.73677886, 'recall': 0.7179347, 'specificity': 0.7179347, 'f1': 0.72691417, 'auroc': 0.8331425, 'binary_precision': 0.4954955, 'binary_recall': 0.45454547, 'binary_specificity': 0.981324, 'binary_f1_score': 0.47413796}
confusion matrix:
      0    1
0  5885  112
1   132  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_6.png
better model found
persisted
after epoch: 6,now: 2024-06-24 14:41:16.324047,epoch time: 0:28:52.568219,used: 2:36:22.534880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9671309, 'precision': 0.96356714, 'recall': 0.951043, 'specificity': 0.951043, 'f1': 0.95707273, 'auroc': 0.9912708, 'binary_precision': 0.9563659, 'binary_recall': 0.9170467, 'binary_specificity': 0.98503935, 'binary_f1_score': 0.9362937}
confusion matrix:
       0      1
0  41678    633
1   1255  13874
---- Validation: 
scalar performance:
{'acc': 0.95482874, 'precision': 0.6655937, 'recall': 0.7212967, 'specificity': 0.7212967, 'f1': 0.68882954, 'auroc': 0.8282529, 'binary_precision': 0.34889436, 'binary_recall': 0.4717608, 'binary_specificity': 0.97083265, 'binary_f1_score': 0.40112993}
confusion matrix:
       0    1
0  17641  530
1    318  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.72800237, 'recall': 0.72709805, 'specificity': 0.72709805, 'f1': 0.7275492, 'auroc': 0.83648694, 'binary_precision': 0.47717842, 'binary_recall': 0.4752066, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.47619048}
confusion matrix:
      0    1
0  5871  126
1   127  115
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_7.png
early stop counter: 1
val acc:0.9548287391662598, best validation acc: 0.9558941125869751, corresponding to test acc:                         0.9608911871910095 / 0.9621734023094177
after epoch: 7,now: 2024-06-24 15:15:08.293171,epoch time: 0:33:51.969124,used: 3:10:14.504004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9685933, 'precision': 0.9640807, 'recall': 0.95441365, 'specificity': 0.95441365, 'f1': 0.95910835, 'auroc': 0.992131, 'binary_precision': 0.9548713, 'binary_recall': 0.92444974, 'binary_specificity': 0.98437756, 'binary_f1_score': 0.93941426}
confusion matrix:
       0      1
0  41650    661
1   1143  13986
---- Validation: 
scalar performance:
{'acc': 0.95269805, 'precision': 0.66430074, 'recall': 0.74669665, 'specificity': 0.74669665, 'f1': 0.6959535, 'auroc': 0.8443011, 'binary_precision': 0.3445652, 'binary_recall': 0.52657807, 'binary_specificity': 0.96681523, 'binary_f1_score': 0.41655716}
confusion matrix:
       0    1
0  17568  603
1    285  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.73927325, 'recall': 0.7240497, 'specificity': 0.7240497, 'f1': 0.7313781, 'auroc': 0.84721076, 'binary_precision': 0.5, 'binary_recall': 0.46694216, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.48290598}
confusion matrix:
      0    1
0  5884  113
1   129  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_8.png
early stop counter: 2
val acc:0.9526980519294739, best validation acc: 0.9558941125869751, corresponding to test acc:                         0.9608911871910095 / 0.9621734023094177
after epoch: 8,now: 2024-06-24 15:53:08.649710,epoch time: 0:38:00.356539,used: 3:48:14.860543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9698816, 'precision': 0.97002435, 'recall': 0.9518088, 'specificity': 0.9518088, 'f1': 0.96043766, 'auroc': 0.99163306, 'binary_precision': 0.97030747, 'binary_recall': 0.91361535, 'binary_specificity': 0.99000233, 'binary_f1_score': 0.9411084}
confusion matrix:
       0      1
0  41887    423
1   1307  13823
---- Validation: 
scalar performance:
{'acc': 0.95951635, 'precision': 0.68229026, 'recall': 0.704445, 'specificity': 0.704445, 'f1': 0.69264686, 'auroc': 0.8300326, 'binary_precision': 0.38348082, 'binary_recall': 0.43189368, 'binary_specificity': 0.9769963, 'binary_f1_score': 0.40624997}
confusion matrix:
       0    1
0  17753  418
1    342  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96714216, 'precision': 0.7916434, 'recall': 0.7132554, 'specificity': 0.7132554, 'f1': 0.74569815, 'auroc': 0.82829297, 'binary_precision': 0.60571426, 'binary_recall': 0.43801653, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.5083933}
confusion matrix:
      0    1
0  5928   69
1   136  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_9.png
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-06-24 16:24:50.085913,epoch time: 0:31:41.436203,used: 4:19:56.296746,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9716574, 'precision': 0.96852297, 'recall': 0.95793945, 'specificity': 0.95793945, 'f1': 0.9630671, 'auroc': 0.99249864, 'binary_precision': 0.962144, 'binary_recall': 0.9289491, 'binary_specificity': 0.9869298, 'binary_f1_score': 0.9452552}
confusion matrix:
       0      1
0  41757    553
1   1075  14055
---- Validation: 
scalar performance:
{'acc': 0.95429605, 'precision': 0.66936094, 'recall': 0.74430996, 'specificity': 0.74430996, 'f1': 0.6990202, 'auroc': 0.84616065, 'binary_precision': 0.3548753, 'binary_recall': 0.5199336, 'binary_specificity': 0.96868634, 'binary_f1_score': 0.4218329}
confusion matrix:
       0    1
0  17602  569
1    289  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.7450917, 'recall': 0.73438025, 'specificity': 0.73438025, 'f1': 0.7396006, 'auroc': 0.85047483, 'binary_precision': 0.51082253, 'binary_recall': 0.4876033, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.4989429}
confusion matrix:
      0    1
0  5884  113
1   124  118
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_10.png
early stop counter: 1
val acc:0.9542960524559021, best validation acc: 0.9595163464546204, corresponding to test acc:                         0.9671421647071838 / 0.9671421647071838
after epoch: 10,now: 2024-06-24 16:55:10.795987,epoch time: 0:30:20.710074,used: 4:50:17.006820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97164, 'precision': 0.97327214, 'recall': 0.9532332, 'specificity': 0.9532332, 'f1': 0.96267974, 'auroc': 0.99283445, 'binary_precision': 0.976493, 'binary_recall': 0.9143367, 'binary_specificity': 0.9921297, 'binary_f1_score': 0.9443932}
confusion matrix:
       0      1
0  41978    333
1   1296  13833
---- Validation: 
scalar performance:
{'acc': 0.9626591, 'precision': 0.70012593, 'recall': 0.70365936, 'specificity': 0.70365936, 'f1': 0.7018752, 'auroc': 0.8178073, 'binary_precision': 0.4192496, 'binary_recall': 0.4269103, 'binary_specificity': 0.9804084, 'binary_f1_score': 0.42304525}
confusion matrix:
       0    1
0  17815  356
1    345  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.81197727, 'recall': 0.7141725, 'specificity': 0.7141725, 'f1': 0.75304866, 'auroc': 0.8375784, 'binary_precision': 0.64634144, 'binary_recall': 0.43801653, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.5221675}
confusion matrix:
      0    1
0  5939   58
1   136  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_11.png
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-06-24 17:22:11.414702,epoch time: 0:27:00.618715,used: 5:17:17.625535,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97369426, 'precision': 0.9734786, 'recall': 0.9583031, 'specificity': 0.9583031, 'f1': 0.96556026, 'auroc': 0.9933851, 'binary_precision': 0.9730462, 'binary_recall': 0.9257766, 'binary_specificity': 0.9908296, 'binary_f1_score': 0.94882303}
confusion matrix:
       0      1
0  41922    388
1   1123  14007
---- Validation: 
scalar performance:
{'acc': 0.95983595, 'precision': 0.68627465, 'recall': 0.71424663, 'specificity': 0.71424663, 'f1': 0.6991526, 'auroc': 0.8468943, 'binary_precision': 0.3908046, 'binary_recall': 0.45182723, 'binary_specificity': 0.9766661, 'binary_f1_score': 0.4191063}
confusion matrix:
       0    1
0  17747  424
1    330  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.79632497, 'recall': 0.7094567, 'specificity': 0.7094567, 'f1': 0.74463, 'auroc': 0.8414979, 'binary_precision': 0.61538464, 'binary_recall': 0.42975205, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.5060827}
confusion matrix:
      0    1
0  5932   65
1   138  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_12.png
early stop counter: 1
val acc:0.959835946559906, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9689052700996399
after epoch: 12,now: 2024-06-24 17:44:03.897092,epoch time: 0:21:52.482390,used: 5:39:10.107925,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9733113, 'precision': 0.97034085, 'recall': 0.9604399, 'specificity': 0.9604399, 'f1': 0.9652474, 'auroc': 0.9937382, 'binary_precision': 0.96428084, 'binary_recall': 0.9332408, 'binary_specificity': 0.9876391, 'binary_f1_score': 0.94850695}
confusion matrix:
       0      1
0  41788    523
1   1010  14119
---- Validation: 
scalar performance:
{'acc': 0.9581314, 'precision': 0.6861564, 'recall': 0.7511094, 'specificity': 0.7511094, 'f1': 0.7131371, 'auroc': 0.85252523, 'binary_precision': 0.38807786, 'binary_recall': 0.5299003, 'binary_specificity': 0.97231853, 'binary_f1_score': 0.44803372}
confusion matrix:
       0    1
0  17668  503
1    283  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96537906, 'precision': 0.7723243, 'recall': 0.72225195, 'specificity': 0.72225195, 'f1': 0.7444546, 'auroc': 0.84940004, 'binary_precision': 0.56632656, 'binary_recall': 0.45867768, 'binary_specificity': 0.98582625, 'binary_f1_score': 0.50684935}
confusion matrix:
      0    1
0  5912   85
1   131  111
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_13.png
early stop counter: 2
val acc:0.9581313729286194, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9689052700996399
after epoch: 13,now: 2024-06-24 19:04:04.779171,epoch time: 1:20:00.882079,used: 6:59:10.990004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9745648, 'precision': 0.97226095, 'recall': 0.9617791, 'specificity': 0.9617791, 'f1': 0.9668608, 'auroc': 0.9941064, 'binary_precision': 0.96756977, 'binary_recall': 0.93476105, 'binary_specificity': 0.98879725, 'binary_f1_score': 0.9508825}
confusion matrix:
       0      1
0  41837    474
1    987  14142
---- Validation: 
scalar performance:
{'acc': 0.96015555, 'precision': 0.6933225, 'recall': 0.7401093, 'specificity': 0.7401093, 'f1': 0.71385443, 'auroc': 0.85307884, 'binary_precision': 0.403183, 'binary_recall': 0.50498337, 'binary_specificity': 0.9752353, 'binary_f1_score': 0.44837755}
confusion matrix:
       0    1
0  17721  450
1    298  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.969867, 'precision': 0.8178571, 'recall': 0.728552, 'specificity': 0.728552, 'f1': 0.7651551, 'auroc': 0.8547745, 'binary_precision': 0.65697676, 'binary_recall': 0.46694216, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.5458937}
confusion matrix:
      0    1
0  5938   59
1   129  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_14.png
new oracle model saved
early stop counter: 3
val acc:0.9601555466651917, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 14,now: 2024-06-24 19:32:39.642882,epoch time: 0:28:34.863711,used: 7:27:45.853715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9742514, 'precision': 0.9717449, 'recall': 0.96148354, 'specificity': 0.96148354, 'f1': 0.96646124, 'auroc': 0.994334, 'binary_precision': 0.966637, 'binary_recall': 0.934501, 'binary_specificity': 0.9884661, 'binary_f1_score': 0.95029736}
confusion matrix:
       0      1
0  41822    488
1    991  14139
---- Validation: 
scalar performance:
{'acc': 0.955681, 'precision': 0.67326677, 'recall': 0.738601, 'specificity': 0.738601, 'f1': 0.69998956, 'auroc': 0.84073377, 'binary_precision': 0.36309522, 'binary_recall': 0.50664455, 'binary_specificity': 0.9705575, 'binary_f1_score': 0.42302358}
confusion matrix:
       0    1
0  17636  535
1    297  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.75766873, 'recall': 0.7134039, 'specificity': 0.7134039, 'f1': 0.73320115, 'auroc': 0.8328179, 'binary_precision': 0.53768843, 'binary_recall': 0.44214877, 'binary_specificity': 0.984659, 'binary_f1_score': 0.48526078}
confusion matrix:
      0    1
0  5905   92
1   135  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_15.png
early stop counter: 4
val acc:0.9556810259819031, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 15,now: 2024-06-24 20:18:58.295977,epoch time: 0:46:18.653095,used: 8:14:04.506810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9763057, 'precision': 0.9687589, 'recall': 0.9702871, 'specificity': 0.9702871, 'f1': 0.9695195, 'auroc': 0.994568, 'binary_precision': 0.95271915, 'binary_recall': 0.95756775, 'binary_specificity': 0.98300636, 'binary_f1_score': 0.9551373}
confusion matrix:
       0      1
0  41591    719
1    642  14488
---- Validation: 
scalar performance:
{'acc': 0.9525382, 'precision': 0.67225575, 'recall': 0.7843574, 'specificity': 0.7843574, 'f1': 0.71243, 'auroc': 0.8556021, 'binary_precision': 0.35791543, 'binary_recall': 0.60465115, 'binary_specificity': 0.96406364, 'binary_f1_score': 0.44966024}
confusion matrix:
       0    1
0  17518  653
1    238  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9578458, 'precision': 0.71944547, 'recall': 0.7341953, 'specificity': 0.7341953, 'f1': 0.7265456, 'auroc': 0.8474171, 'binary_precision': 0.45945945, 'binary_recall': 0.49173555, 'binary_specificity': 0.976655, 'binary_f1_score': 0.4750499}
confusion matrix:
      0    1
0  5857  140
1   123  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_16.png
early stop counter: 5
val acc:0.9525381922721863, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 16,now: 2024-06-24 21:26:47.366437,epoch time: 1:07:49.070460,used: 9:21:53.577270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9745822, 'precision': 0.9677677, 'recall': 0.96665305, 'specificity': 0.96665305, 'f1': 0.96720856, 'auroc': 0.99449825, 'binary_precision': 0.95342666, 'binary_recall': 0.9498975, 'binary_specificity': 0.9834086, 'binary_f1_score': 0.9516589}
confusion matrix:
       0      1
0  41609    702
1    758  14371
---- Validation: 
scalar performance:
{'acc': 0.956267, 'precision': 0.68111455, 'recall': 0.76379824, 'specificity': 0.76379824, 'f1': 0.7136643, 'auroc': 0.85343724, 'binary_precision': 0.37710437, 'binary_recall': 0.55813956, 'binary_specificity': 0.96945685, 'binary_f1_score': 0.45010048}
confusion matrix:
       0    1
0  17616  555
1    266  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.7370767, 'recall': 0.723883, 'specificity': 0.723883, 'f1': 0.7302656, 'auroc': 0.84612834, 'binary_precision': 0.49561402, 'binary_recall': 0.46694216, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.48085105}
confusion matrix:
      0    1
0  5882  115
1   129  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_17.png
early stop counter: 6
val acc:0.9562669992446899, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 17,now: 2024-06-24 21:55:41.428978,epoch time: 0:28:54.062541,used: 9:50:47.639811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9774199, 'precision': 0.9726798, 'recall': 0.9689417, 'specificity': 0.9689417, 'f1': 0.97079027, 'auroc': 0.994712, 'binary_precision': 0.9627969, 'binary_recall': 0.9510245, 'binary_specificity': 0.9868589, 'binary_f1_score': 0.9568745}
confusion matrix:
       0      1
0  41754    556
1    741  14389
---- Validation: 
scalar performance:
{'acc': 0.9568529, 'precision': 0.6823311, 'recall': 0.75847954, 'specificity': 0.75847954, 'f1': 0.7128888, 'auroc': 0.84731805, 'binary_precision': 0.3799076, 'binary_recall': 0.54651165, 'binary_specificity': 0.9704474, 'binary_f1_score': 0.44822887}
confusion matrix:
       0    1
0  17634  537
1    273  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645777, 'precision': 0.76427615, 'recall': 0.7337315, 'specificity': 0.7337315, 'f1': 0.74795216, 'auroc': 0.8528589, 'binary_precision': 0.5492958, 'binary_recall': 0.48347107, 'binary_specificity': 0.983992, 'binary_f1_score': 0.51428574}
confusion matrix:
      0    1
0  5901   96
1   125  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_18.png
early stop counter: 7
val acc:0.956852912902832, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 18,now: 2024-06-24 22:21:44.756953,epoch time: 0:26:03.327975,used: 10:16:50.967786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97531337, 'precision': 0.97524893, 'recall': 0.96075857, 'specificity': 0.96075857, 'f1': 0.9677036, 'auroc': 0.9945998, 'binary_precision': 0.97511953, 'binary_recall': 0.930002, 'binary_specificity': 0.9915152, 'binary_f1_score': 0.9520265}
confusion matrix:
       0      1
0  41952    359
1   1059  14070
---- Validation: 
scalar performance:
{'acc': 0.9598892, 'precision': 0.691194, 'recall': 0.7359565, 'specificity': 0.7359565, 'f1': 0.71091557, 'auroc': 0.85420644, 'binary_precision': 0.39919892, 'binary_recall': 0.49667773, 'binary_specificity': 0.9752353, 'binary_f1_score': 0.44263506}
confusion matrix:
       0    1
0  17721  450
1    303  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.967623, 'precision': 0.8015332, 'recall': 0.6996263, 'specificity': 0.6996263, 'f1': 0.7391377, 'auroc': 0.8475958, 'binary_precision': 0.62658226, 'binary_recall': 0.4090909, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.49500003}
confusion matrix:
      0   1
0  5938  59
1   143  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_19.png
early stop counter: 8
val acc:0.9598891735076904, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 19,now: 2024-06-24 22:47:01.182402,epoch time: 0:25:16.425449,used: 10:42:07.393235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9764624, 'precision': 0.9720739, 'recall': 0.96701634, 'specificity': 0.96701634, 'f1': 0.9695078, 'auroc': 0.9941462, 'binary_precision': 0.96296793, 'binary_recall': 0.94705534, 'binary_specificity': 0.9869774, 'binary_f1_score': 0.9549454}
confusion matrix:
       0      1
0  41760    551
1    801  14328
---- Validation: 
scalar performance:
{'acc': 0.9571193, 'precision': 0.6815934, 'recall': 0.7497836, 'specificity': 0.7497836, 'f1': 0.7095321, 'auroc': 0.8443161, 'binary_precision': 0.37902266, 'binary_recall': 0.5282392, 'binary_specificity': 0.97132796, 'binary_f1_score': 0.44136018}
confusion matrix:
       0    1
0  17650  521
1    284  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.72997415, 'recall': 0.73907787, 'specificity': 0.73907787, 'f1': 0.73442525, 'auroc': 0.84895825, 'binary_precision': 0.48015872, 'binary_recall': 0.5, 'binary_specificity': 0.97815573, 'binary_f1_score': 0.48987857}
confusion matrix:
      0    1
0  5866  131
1   121  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_20.png
early stop counter: 9
val acc:0.9571192860603333, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 20,now: 2024-06-24 23:12:46.608295,epoch time: 0:25:45.425893,used: 11:07:52.819128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9760097, 'precision': 0.97524023, 'recall': 0.96257097, 'specificity': 0.96257097, 'f1': 0.9686755, 'auroc': 0.99488336, 'binary_precision': 0.9736842, 'binary_recall': 0.93417054, 'binary_specificity': 0.9909714, 'binary_f1_score': 0.95351815}
confusion matrix:
       0      1
0  41928    382
1    996  14134
---- Validation: 
scalar performance:
{'acc': 0.96068823, 'precision': 0.69306844, 'recall': 0.72512656, 'specificity': 0.72512656, 'f1': 0.70770717, 'auroc': 0.84515053, 'binary_precision': 0.4036827, 'binary_recall': 0.47342193, 'binary_specificity': 0.9768312, 'binary_f1_score': 0.4357798}
confusion matrix:
       0    1
0  17750  421
1    317  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.7919134, 'recall': 0.69920945, 'specificity': 0.69920945, 'f1': 0.73587155, 'auroc': 0.8399358, 'binary_precision': 0.607362, 'binary_recall': 0.4090909, 'binary_specificity': 0.989328, 'binary_f1_score': 0.48888886}
confusion matrix:
      0   1
0  5933  64
1   143  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_21.png
early stop counter: 10
val acc:0.9606882333755493, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 21,now: 2024-06-24 23:36:07.367600,epoch time: 0:23:20.759305,used: 11:31:13.578433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9770543, 'precision': 0.97727704, 'recall': 0.96328, 'specificity': 0.96328, 'f1': 0.9699998, 'auroc': 0.99492085, 'binary_precision': 0.9777255, 'binary_recall': 0.93417054, 'binary_specificity': 0.9923895, 'binary_f1_score': 0.95545197}
confusion matrix:
       0      1
0  41988    322
1    996  14134
---- Validation: 
scalar performance:
{'acc': 0.96196663, 'precision': 0.697416, 'recall': 0.7113321, 'specificity': 0.7113321, 'f1': 0.70410705, 'auroc': 0.852221, 'binary_precision': 0.4133127, 'binary_recall': 0.4435216, 'binary_specificity': 0.9791426, 'binary_f1_score': 0.4278846}
confusion matrix:
       0    1
0  17792  379
1    335  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.8182576, 'recall': 0.7002933, 'specificity': 0.7002933, 'f1': 0.7445252, 'auroc': 0.83880097, 'binary_precision': 0.66, 'binary_recall': 0.4090909, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.50510204}
confusion matrix:
      0   1
0  5946  51
1   143  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_22.png
early stop counter: 11
val acc:0.9619666337966919, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 22,now: 2024-06-25 00:01:42.948248,epoch time: 0:25:35.580648,used: 11:56:49.159081,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97804666, 'precision': 0.97582, 'recall': 0.9673078, 'specificity': 0.9673078, 'f1': 0.9714596, 'auroc': 0.9952715, 'binary_precision': 0.9712538, 'binary_recall': 0.94461334, 'binary_specificity': 0.99000233, 'binary_f1_score': 0.9577484}
confusion matrix:
       0      1
0  41887    423
1    838  14292
---- Validation: 
scalar performance:
{'acc': 0.96079475, 'precision': 0.69957125, 'recall': 0.75730354, 'specificity': 0.75730354, 'f1': 0.72431076, 'auroc': 0.8584949, 'binary_precision': 0.41454083, 'binary_recall': 0.5398671, 'binary_specificity': 0.97473997, 'binary_f1_score': 0.46897545}
confusion matrix:
       0    1
0  17712  459
1    277  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648982, 'precision': 0.76968366, 'recall': 0.7081226, 'specificity': 0.7081226, 'f1': 0.7344733, 'auroc': 0.8485627, 'binary_precision': 0.56216216, 'binary_recall': 0.42975205, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.4871194}
confusion matrix:
      0    1
0  5916   81
1   138  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_23.png
early stop counter: 12
val acc:0.9607947468757629, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 23,now: 2024-06-25 00:27:57.743203,epoch time: 0:26:14.794955,used: 12:23:03.954036,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.978569, 'precision': 0.97248995, 'recall': 0.9722692, 'specificity': 0.9722692, 'f1': 0.97237945, 'auroc': 0.9957752, 'binary_precision': 0.95965344, 'binary_recall': 0.9589557, 'binary_specificity': 0.9855826, 'binary_f1_score': 0.95930445}
confusion matrix:
       0      1
0  41700    610
1    621  14509
---- Validation: 
scalar performance:
{'acc': 0.9552016, 'precision': 0.67897666, 'recall': 0.7728844, 'specificity': 0.7728844, 'f1': 0.7147374, 'auroc': 0.8652697, 'binary_precision': 0.3721925, 'binary_recall': 0.5780731, 'binary_specificity': 0.9676958, 'binary_f1_score': 0.4528302}
confusion matrix:
       0    1
0  17584  587
1    254  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.7450917, 'recall': 0.73438025, 'specificity': 0.73438025, 'f1': 0.7396006, 'auroc': 0.8546127, 'binary_precision': 0.51082253, 'binary_recall': 0.4876033, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.4989429}
confusion matrix:
      0    1
0  5884  113
1   124  118
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_24.png
early stop counter: 13
val acc:0.9552016258239746, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 24,now: 2024-06-25 00:54:02.252114,epoch time: 0:26:04.508911,used: 12:49:08.462947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9781163, 'precision': 0.9762662, 'recall': 0.9670367, 'specificity': 0.9670367, 'f1': 0.9715291, 'auroc': 0.9958855, 'binary_precision': 0.9724814, 'binary_recall': 0.94362193, 'binary_specificity': 0.99045146, 'binary_f1_score': 0.95783436}
confusion matrix:
       0      1
0  41906    404
1    853  14277
---- Validation: 
scalar performance:
{'acc': 0.96052843, 'precision': 0.69596344, 'recall': 0.7443172, 'specificity': 0.7443172, 'f1': 0.7171346, 'auroc': 0.86552894, 'binary_precision': 0.40819022, 'binary_recall': 0.51328903, 'binary_specificity': 0.9753453, 'binary_f1_score': 0.45474616}
confusion matrix:
       0    1
0  17723  448
1    293  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.78514683, 'recall': 0.7269678, 'specificity': 0.7269678, 'f1': 0.7523772, 'auroc': 0.8632009, 'binary_precision': 0.591623, 'binary_recall': 0.46694216, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.52194}
confusion matrix:
      0    1
0  5919   78
1   129  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_25.png
early stop counter: 14
val acc:0.9605284333229065, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 25,now: 2024-06-25 01:23:21.631384,epoch time: 0:29:19.379270,used: 13:18:27.842217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.979039, 'precision': 0.977384, 'recall': 0.9683211, 'specificity': 0.9683211, 'f1': 0.9727349, 'auroc': 0.99527, 'binary_precision': 0.9739959, 'binary_recall': 0.94567084, 'binary_specificity': 0.9909714, 'binary_f1_score': 0.95962447}
confusion matrix:
       0      1
0  41928    382
1    822  14308
---- Validation: 
scalar performance:
{'acc': 0.96068823, 'precision': 0.69450635, 'recall': 0.73235404, 'specificity': 0.73235404, 'f1': 0.71153176, 'auroc': 0.8467934, 'binary_precision': 0.40607736, 'binary_recall': 0.4883721, 'binary_specificity': 0.97633594, 'binary_f1_score': 0.4434389}
confusion matrix:
       0    1
0  17741  430
1    308  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9677833, 'precision': 0.806723, 'recall': 0.6917788, 'specificity': 0.6917788, 'f1': 0.73465204, 'auroc': 0.83688676, 'binary_precision': 0.6375839, 'binary_recall': 0.39256197, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.4859335}
confusion matrix:
      0   1
0  5943  54
1   147  95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_26.png
early stop counter: 15
val acc:0.9606882333755493, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 26,now: 2024-06-25 01:48:23.602960,epoch time: 0:25:01.971576,used: 13:43:29.813793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97820336, 'precision': 0.97677016, 'recall': 0.9667561, 'specificity': 0.9667561, 'f1': 0.97161937, 'auroc': 0.99525243, 'binary_precision': 0.97384596, 'binary_recall': 0.9425644, 'binary_specificity': 0.9909478, 'binary_f1_score': 0.9579498}
confusion matrix:
       0      1
0  41927    383
1    869  14261
---- Validation: 
scalar performance:
{'acc': 0.9621797, 'precision': 0.706327, 'recall': 0.75560987, 'specificity': 0.75560987, 'f1': 0.7280051, 'auroc': 0.8608005, 'binary_precision': 0.42819148, 'binary_recall': 0.53488374, 'binary_specificity': 0.97633594, 'binary_f1_score': 0.47562778}
confusion matrix:
       0    1
0  17741  430
1    280  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692258, 'precision': 0.81685674, 'recall': 0.7123565, 'specificity': 0.7123565, 'f1': 0.7532444, 'auroc': 0.85804385, 'binary_precision': 0.65625, 'binary_recall': 0.4338843, 'binary_specificity': 0.99082875, 'binary_f1_score': 0.5223881}
confusion matrix:
      0    1
0  5942   55
1   137  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_27.png
early stop counter: 16
val acc:0.9621797204017639, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 27,now: 2024-06-25 02:16:14.456243,epoch time: 0:27:50.853283,used: 14:11:20.667076,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.97790736, 'precision': 0.9718629, 'recall': 0.9711607, 'specificity': 0.9711607, 'f1': 0.97151107, 'auroc': 0.99488115, 'binary_precision': 0.95912284, 'binary_recall': 0.95690393, 'binary_specificity': 0.9854175, 'binary_f1_score': 0.95801204}
confusion matrix:
       0      1
0  41694    617
1    652  14477
---- Validation: 
scalar performance:
{'acc': 0.955681, 'precision': 0.6794796, 'recall': 0.76670766, 'specificity': 0.76670766, 'f1': 0.71332306, 'auroc': 0.8653927, 'binary_precision': 0.37362638, 'binary_recall': 0.56478405, 'binary_specificity': 0.9686313, 'binary_f1_score': 0.44973546}
confusion matrix:
       0    1
0  17601  570
1    262  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7390347, 'recall': 0.7181015, 'specificity': 0.7181015, 'f1': 0.7280253, 'auroc': 0.8470764, 'binary_precision': 0.5, 'binary_recall': 0.45454547, 'binary_specificity': 0.9816575, 'binary_f1_score': 0.47619048}
confusion matrix:
      0    1
0  5887  110
1   132  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_28.png
early stop counter: 17
val acc:0.9556810259819031, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 28,now: 2024-06-25 02:42:56.030173,epoch time: 0:26:41.573930,used: 14:38:02.241006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9790912, 'precision': 0.9747318, 'recall': 0.9712225, 'specificity': 0.9712225, 'f1': 0.9729593, 'auroc': 0.996122, 'binary_precision': 0.9656348, 'binary_recall': 0.95459354, 'binary_specificity': 0.98785156, 'binary_f1_score': 0.9600824}
confusion matrix:
       0      1
0  41796    514
1    687  14443
---- Validation: 
scalar performance:
{'acc': 0.95978266, 'precision': 0.695664, 'recall': 0.76240206, 'specificity': 0.76240206, 'f1': 0.7235183, 'auroc': 0.8674411, 'binary_precision': 0.40636474, 'binary_recall': 0.551495, 'binary_specificity': 0.9733091, 'binary_f1_score': 0.46793517}
confusion matrix:
       0    1
0  17686  485
1    270  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.79378986, 'recall': 0.69929284, 'specificity': 0.69929284, 'f1': 0.73651874, 'auroc': 0.8496254, 'binary_precision': 0.6111111, 'binary_recall': 0.4090909, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.490099}
confusion matrix:
      0   1
0  5934  63
1   143  99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_29.png
early stop counter: 18
val acc:0.9597826600074768, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 29,now: 2024-06-25 03:08:39.380565,epoch time: 0:25:43.350392,used: 15:03:45.591398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9784993, 'precision': 0.97755325, 'recall': 0.9667447, 'specificity': 0.9667447, 'f1': 0.9719821, 'auroc': 0.99555016, 'binary_precision': 0.97562814, 'binary_recall': 0.94190353, 'binary_specificity': 0.9915859, 'binary_f1_score': 0.9584692}
confusion matrix:
       0      1
0  41954    356
1    879  14251
---- Validation: 
scalar performance:
{'acc': 0.96079475, 'precision': 0.6953789, 'recall': 0.73401517, 'specificity': 0.73401517, 'f1': 0.7127309, 'auroc': 0.86067164, 'binary_precision': 0.4077135, 'binary_recall': 0.49169436, 'binary_specificity': 0.97633594, 'binary_f1_score': 0.44578314}
confusion matrix:
       0    1
0  17741  430
1    306  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96842444, 'precision': 0.80766225, 'recall': 0.7099569, 'specificity': 0.7099569, 'f1': 0.7486314, 'auroc': 0.8562553, 'binary_precision': 0.6380368, 'binary_recall': 0.42975205, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.5135802}
confusion matrix:
      0    1
0  5938   59
1   138  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551148_30.png
early stop counter: 19
val acc:0.9607947468757629, best validation acc: 0.9626591205596924, corresponding to test acc:                         0.9689052700996399 / 0.9698669910430908
after epoch: 30,now: 2024-06-25 03:35:26.911640,epoch time: 0:26:47.531075,used: 15:30:33.122473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_12_04_53_seed_2_21551148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:30:33.122473 at 2024-06-25 03:35:26.911640
persisted model performance metric: 

scalar performance:
{'acc': 0.96890527, 'precision': 0.81197727, 'recall': 0.7141725, 'specificity': 0.7141725, 'f1': 0.75304866, 'auroc': 0.8375784, 'binary_precision': 0.64634144, 'binary_recall': 0.43801653, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.5221675}
confusion matrix:
      0    1
0  5939   58
1   136  106
oracle model performance metric: 

scalar performance:
{'acc': 0.969867, 'precision': 0.8178571, 'recall': 0.728552, 'specificity': 0.728552, 'f1': 0.7651551, 'auroc': 0.8547745, 'binary_precision': 0.65697676, 'binary_recall': 0.46694216, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.5458937}
confusion matrix:
      0    1
0  5938   59
1   129  113
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204077 KiB | 632448 KiB |   1496 TiB |   1496 TiB |
|       from large pool | 167040 KiB | 559724 KiB |   1494 TiB |   1494 TiB |
|       from small pool |  37037 KiB |  75475 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204077 KiB | 632448 KiB |   1496 TiB |   1496 TiB |
|       from large pool | 167040 KiB | 559724 KiB |   1494 TiB |   1494 TiB |
|       from small pool |  37037 KiB |  75475 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 625043 KiB |   1476 TiB |   1476 TiB |
|       from large pool | 165120 KiB | 553452 KiB |   1474 TiB |   1474 TiB |
|       from small pool |  35967 KiB |  74337 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 778240 KiB | 778240 KiB |   1672 MiB |    912 MiB |
|       from large pool | 702464 KiB | 702464 KiB |   1548 MiB |    862 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    124 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  78546 KiB | 209453 KiB |    941 TiB |    941 TiB |
|       from large pool |  68480 KiB | 208064 KiB |    939 TiB |    939 TiB |
|       from small pool |  10066 KiB |  21751 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    7929    |  307669 K  |  307666 K  |
|       from large pool |      36    |      76    |  103540 K  |  103540 K  |
|       from small pool |    3204    |    7892    |  204129 K  |  204125 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    7929    |  307669 K  |  307666 K  |
|       from large pool |      36    |      76    |  103540 K  |  103540 K  |
|       from small pool |    3204    |    7892    |  204129 K  |  204125 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |      53    |      89    |      36    |
|       from large pool |      16    |      16    |      27    |      11    |
|       from small pool |      37    |      37    |      62    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3604    |  139156 K  |  139156 K  |
|       from large pool |       5    |      13    |   42503 K  |   42503 K  |
|       from small pool |      29    |    3599    |   96653 K  |   96653 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 632448 KiB |   1496 TiB |   1496 TiB |
|       from large pool |  16640 KiB | 559724 KiB |   1494 TiB |   1494 TiB |
|       from small pool |      0 KiB |  75475 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 632448 KiB |   1496 TiB |   1496 TiB |
|       from large pool |  16640 KiB | 559724 KiB |   1494 TiB |   1494 TiB |
|       from small pool |      0 KiB |  75475 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 625043 KiB |   1476 TiB |   1476 TiB |
|       from large pool |  16640 KiB | 553452 KiB |   1474 TiB |   1474 TiB |
|       from small pool |      0 KiB |  74337 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 282624 KiB | 778240 KiB |   1672 MiB |   1396 MiB |
|       from large pool | 235520 KiB | 702464 KiB |   1548 MiB |   1318 MiB |
|       from small pool |  47104 KiB |  75776 KiB |    124 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 209453 KiB |    941 TiB |    941 TiB |
|       from large pool |  55040 KiB | 208064 KiB |    939 TiB |    939 TiB |
|       from small pool |      0 KiB |  21751 KiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7929    |  307669 K  |  307669 K  |
|       from large pool |       2    |      76    |  103540 K  |  103540 K  |
|       from small pool |       0    |    7892    |  204129 K  |  204129 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7929    |  307669 K  |  307669 K  |
|       from large pool |       2    |      76    |  103540 K  |  103540 K  |
|       from small pool |       0    |    7892    |  204129 K  |  204129 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      33    |      53    |      89    |      56    |
|       from large pool |      10    |      16    |      27    |      17    |
|       from small pool |      23    |      37    |      62    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3604    |  139157 K  |  139157 K  |
|       from large pool |       3    |      13    |   42503 K  |   42503 K  |
|       from small pool |       0    |    3599    |   96654 K  |   96654 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jun 25 03:36:57 2024]
Finished job 0.
1 of 1 steps (100%) done
