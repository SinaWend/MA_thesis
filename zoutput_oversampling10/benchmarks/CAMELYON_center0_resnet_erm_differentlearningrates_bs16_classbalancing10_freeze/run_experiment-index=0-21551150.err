Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun 23 13:13:27 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150

 Experiment start at: 2024-06-23 13:19:29.893449
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9681627, 'precision': 0.9625274, 'recall': 0.9537413, 'specificity': 0.9537413, 'f1': 0.9580231, 'auroc': 0.9911983, 'binary_precision': 0.9512315, 'binary_recall': 0.92394996, 'binary_specificity': 0.9835326, 'binary_f1_score': 0.93739223}
confusion matrix:
       0      1
0  41629    697
1   1119  13595
---- Validation: 
scalar performance:
{'acc': 0.9541294, 'precision': 0.67601335, 'recall': 0.7287339, 'specificity': 0.7287339, 'f1': 0.6984091, 'auroc': 0.8202172, 'binary_precision': 0.3704142, 'binary_recall': 0.4867807, 'binary_specificity': 0.9706871, 'binary_f1_score': 0.42069894}
confusion matrix:
       0    1
0  17617  532
1    330  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9546181, 'precision': 0.71780896, 'recall': 0.7289564, 'specificity': 0.7289564, 'f1': 0.72322154, 'auroc': 0.8401353, 'binary_precision': 0.45818183, 'binary_recall': 0.4827586, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.47014925}
confusion matrix:
      0    1
0  5848  149
1   135  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-23 13:42:59.358027,epoch time: 0:23:29.464578,used: 0:23:29.464578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9763675, 'precision': 0.97381866, 'recall': 0.96408224, 'specificity': 0.96408224, 'f1': 0.9688182, 'auroc': 0.99479616, 'binary_precision': 0.9687215, 'binary_recall': 0.938702, 'binary_specificity': 0.9894625, 'binary_f1_score': 0.95347553}
confusion matrix:
       0      1
0  41879    446
1    902  13813
---- Validation: 
scalar performance:
{'acc': 0.96110046, 'precision': 0.7105086, 'recall': 0.73534316, 'specificity': 0.73534316, 'f1': 0.722143, 'auroc': 0.8473302, 'binary_precision': 0.43905818, 'binary_recall': 0.49300155, 'binary_specificity': 0.97768474, 'binary_f1_score': 0.46446887}
confusion matrix:
       0    1
0  17744  405
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8155006, 'recall': 0.72646475, 'specificity': 0.72646475, 'f1': 0.7628498, 'auroc': 0.85976624, 'binary_precision': 0.65405405, 'binary_recall': 0.46360153, 'binary_specificity': 0.989328, 'binary_f1_score': 0.5426009}
confusion matrix:
      0    1
0  5933   64
1   140  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-23 14:03:36.630558,epoch time: 0:20:37.272531,used: 0:44:06.737109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.979979, 'precision': 0.9758065, 'recall': 0.97173035, 'specificity': 0.97173035, 'f1': 0.97374517, 'auroc': 0.9953097, 'binary_precision': 0.96730226, 'binary_recall': 0.95468444, 'binary_specificity': 0.98877627, 'binary_f1_score': 0.9609519}
confusion matrix:
       0      1
0  41846    475
1    667  14052
---- Validation: 
scalar performance:
{'acc': 0.9566837, 'precision': 0.6930221, 'recall': 0.75930846, 'specificity': 0.75930846, 'f1': 0.7205992, 'auroc': 0.84196436, 'binary_precision': 0.40228572, 'binary_recall': 0.5474339, 'binary_specificity': 0.971183, 'binary_f1_score': 0.4637681}
confusion matrix:
       0    1
0  17626  523
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.7589975, 'recall': 0.73612285, 'specificity': 0.73612285, 'f1': 0.74695987, 'auroc': 0.8586279, 'binary_precision': 0.54008436, 'binary_recall': 0.49042144, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.5140562}
confusion matrix:
      0    1
0  5888  109
1   133  128
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_3.png
early stop counter: 1
val acc:0.9566836953163147, best validation acc: 0.9611004590988159, corresponding to test acc:                         0.9674017429351807 / 0.9674017429351807
after epoch: 3,now: 2024-06-23 14:24:20.526723,epoch time: 0:20:43.896165,used: 1:04:50.633274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9796634, 'precision': 0.9796709, 'recall': 0.96694404, 'specificity': 0.96694404, 'f1': 0.97308594, 'auroc': 0.99647975, 'binary_precision': 0.9796857, 'binary_recall': 0.94066876, 'binary_specificity': 0.9932193, 'binary_f1_score': 0.9597809}
confusion matrix:
       0      1
0  42039    287
1    873  13841
---- Validation: 
scalar performance:
{'acc': 0.9620583, 'precision': 0.7162276, 'recall': 0.7365891, 'specificity': 0.7365891, 'f1': 0.7258916, 'auroc': 0.86082405, 'binary_precision': 0.45042494, 'binary_recall': 0.49455675, 'binary_specificity': 0.9786214, 'binary_f1_score': 0.47146034}
confusion matrix:
       0    1
0  17761  388
1    325  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685203, 'precision': 0.8579082, 'recall': 0.6849047, 'specificity': 0.6849047, 'f1': 0.74123883, 'auroc': 0.8609139, 'binary_precision': 0.74242425, 'binary_recall': 0.37547892, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.4987277}
confusion matrix:
      0   1
0  5963  34
1   163  98
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-23 14:45:14.915602,epoch time: 0:20:54.388879,used: 1:25:45.022153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98173213, 'precision': 0.97805, 'recall': 0.9740821, 'specificity': 0.9740821, 'f1': 0.9760442, 'auroc': 0.9966508, 'binary_precision': 0.9705437, 'binary_recall': 0.9582767, 'binary_specificity': 0.98988754, 'binary_f1_score': 0.96437114}
confusion matrix:
       0      1
0  41896    428
1    614  14102
---- Validation: 
scalar performance:
{'acc': 0.9605683, 'precision': 0.7088878, 'recall': 0.7440683, 'specificity': 0.7440683, 'f1': 0.724929, 'auroc': 0.85779923, 'binary_precision': 0.4351852, 'binary_recall': 0.5116641, 'binary_specificity': 0.97647256, 'binary_f1_score': 0.47033596}
confusion matrix:
       0    1
0  17722  427
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7769567, 'recall': 0.6799875, 'specificity': 0.6799875, 'f1': 0.7169565, 'auroc': 0.85857165, 'binary_precision': 0.5808383, 'binary_recall': 0.3716475, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.45327103}
confusion matrix:
      0   1
0  5927  70
1   164  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_5.png
early stop counter: 1
val acc:0.9605683088302612, best validation acc: 0.9620583057403564, corresponding to test acc:                         0.9685202836990356 / 0.9685202836990356
after epoch: 5,now: 2024-06-23 15:06:08.029197,epoch time: 0:20:53.113595,used: 1:46:38.135748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98231065, 'precision': 0.97973555, 'recall': 0.9738722, 'specificity': 0.9738722, 'f1': 0.97675645, 'auroc': 0.99667275, 'binary_precision': 0.9745188, 'binary_recall': 0.956439, 'binary_specificity': 0.99130535, 'binary_f1_score': 0.9653942}
confusion matrix:
       0      1
0  41957    368
1    641  14074
---- Validation: 
scalar performance:
{'acc': 0.96078116, 'precision': 0.7110186, 'recall': 0.750929, 'specificity': 0.750929, 'f1': 0.72901964, 'auroc': 0.85815775, 'binary_precision': 0.43896103, 'binary_recall': 0.525661, 'binary_specificity': 0.97619706, 'binary_f1_score': 0.4784147}
confusion matrix:
       0    1
0  17717  432
1    305  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.7751987, 'recall': 0.705807, 'specificity': 0.705807, 'f1': 0.7348764, 'auroc': 0.8598859, 'binary_precision': 0.5751295, 'binary_recall': 0.42528737, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.4889868}
confusion matrix:
      0    1
0  5915   82
1   150  111
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_6.png
early stop counter: 2
val acc:0.9607811570167542, best validation acc: 0.9620583057403564, corresponding to test acc:                         0.9685202836990356 / 0.9685202836990356
after epoch: 6,now: 2024-06-23 15:26:53.609938,epoch time: 0:20:45.580741,used: 2:07:23.716489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98331, 'precision': 0.9807662, 'recall': 0.9754765, 'specificity': 0.9754765, 'f1': 0.97808284, 'auroc': 0.9969653, 'binary_precision': 0.975603, 'binary_recall': 0.95929325, 'binary_specificity': 0.99165976, 'binary_f1_score': 0.9673794}
confusion matrix:
       0      1
0  41972    353
1    599  14116
---- Validation: 
scalar performance:
{'acc': 0.96248406, 'precision': 0.7171266, 'recall': 0.7233085, 'specificity': 0.7233085, 'f1': 0.72016865, 'auroc': 0.8516663, 'binary_precision': 0.4531722, 'binary_recall': 0.466563, 'binary_specificity': 0.980054, 'binary_f1_score': 0.4597701}
confusion matrix:
       0    1
0  17787  362
1    343  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.7800364, 'recall': 0.6893993, 'specificity': 0.6893993, 'f1': 0.72492224, 'auroc': 0.86058414, 'binary_precision': 0.5862069, 'binary_recall': 0.3908046, 'binary_specificity': 0.987994, 'binary_f1_score': 0.4689655}
confusion matrix:
      0    1
0  5925   72
1   159  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_7.png
better model found
persisted
after epoch: 7,now: 2024-06-23 15:47:54.438984,epoch time: 0:21:00.829046,used: 2:28:24.545535,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9837132, 'precision': 0.9826205, 'recall': 0.9746678, 'specificity': 0.9746678, 'f1': 0.9785577, 'auroc': 0.99685955, 'binary_precision': 0.9804208, 'binary_recall': 0.9559753, 'binary_specificity': 0.9933603, 'binary_f1_score': 0.96804374}
confusion matrix:
       0      1
0  42040    281
1    648  14071
---- Validation: 
scalar performance:
{'acc': 0.9612069, 'precision': 0.71122885, 'recall': 0.7361483, 'specificity': 0.7361483, 'f1': 0.72290325, 'auroc': 0.8581081, 'binary_precision': 0.44044322, 'binary_recall': 0.49455675, 'binary_specificity': 0.9777398, 'binary_f1_score': 0.46593407}
confusion matrix:
       0    1
0  17745  404
1    325  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.77870786, 'recall': 0.65783274, 'specificity': 0.65783274, 'f1': 0.69961566, 'auroc': 0.84894145, 'binary_precision': 0.5862069, 'binary_recall': 0.3256705, 'binary_specificity': 0.989995, 'binary_f1_score': 0.41871926}
confusion matrix:
      0   1
0  5937  60
1   176  85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_8.png
early stop counter: 1
val acc:0.9612069129943848, best validation acc: 0.9624840617179871, corresponding to test acc:                         0.963087260723114 / 0.9685202836990356
after epoch: 8,now: 2024-06-23 16:08:37.698861,epoch time: 0:20:43.259877,used: 2:49:07.805412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98381835, 'precision': 0.9826702, 'recall': 0.9748895, 'specificity': 0.9748895, 'f1': 0.9786972, 'auroc': 0.99673516, 'binary_precision': 0.980358, 'binary_recall': 0.95644194, 'binary_specificity': 0.9933371, 'binary_f1_score': 0.9682523}
confusion matrix:
       0      1
0  42042    282
1    641  14075
---- Validation: 
scalar performance:
{'acc': 0.9613133, 'precision': 0.71351016, 'recall': 0.74820423, 'specificity': 0.74820423, 'f1': 0.72938204, 'auroc': 0.86152846, 'binary_precision': 0.44414893, 'binary_recall': 0.5194401, 'binary_specificity': 0.9769684, 'binary_f1_score': 0.47885302}
confusion matrix:
       0    1
0  17731  418
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.7711443, 'recall': 0.674157, 'specificity': 0.674157, 'f1': 0.7108144, 'auroc': 0.86077774, 'binary_precision': 0.56969696, 'binary_recall': 0.36015326, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.44131455}
confusion matrix:
      0   1
0  5926  71
1   167  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_9.png
early stop counter: 2
val acc:0.9613133072853088, best validation acc: 0.9624840617179871, corresponding to test acc:                         0.963087260723114 / 0.9685202836990356
after epoch: 9,now: 2024-06-23 16:29:07.737139,epoch time: 0:20:30.038278,used: 3:09:37.843690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9838359, 'precision': 0.98228586, 'recall': 0.9753211, 'specificity': 0.9753211, 'f1': 0.9787371, 'auroc': 0.9974464, 'binary_precision': 0.97915655, 'binary_recall': 0.95773023, 'binary_specificity': 0.992912, 'binary_f1_score': 0.9683249}
confusion matrix:
       0      1
0  42025    300
1    622  14093
---- Validation: 
scalar performance:
{'acc': 0.9600894, 'precision': 0.70608616, 'recall': 0.7423203, 'specificity': 0.7423203, 'f1': 0.72254115, 'auroc': 0.8693656, 'binary_precision': 0.42969775, 'binary_recall': 0.5085537, 'binary_specificity': 0.97608685, 'binary_f1_score': 0.465812}
confusion matrix:
       0    1
0  17715  434
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.78241014, 'recall': 0.6728249, 'specificity': 0.6728249, 'f1': 0.7128997, 'auroc': 0.8617283, 'binary_precision': 0.5923567, 'binary_recall': 0.35632184, 'binary_specificity': 0.989328, 'binary_f1_score': 0.4449761}
confusion matrix:
      0   1
0  5933  64
1   168  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_10.png
early stop counter: 3
val acc:0.960089385509491, best validation acc: 0.9624840617179871, corresponding to test acc:                         0.963087260723114 / 0.9685202836990356
after epoch: 10,now: 2024-06-23 16:49:34.207398,epoch time: 0:20:26.470259,used: 3:30:04.313949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98487025, 'precision': 0.98331726, 'recall': 0.977018, 'specificity': 0.977018, 'f1': 0.9801135, 'auroc': 0.9975692, 'binary_precision': 0.98017466, 'binary_recall': 0.9607936, 'binary_specificity': 0.99324244, 'binary_f1_score': 0.9703874}
confusion matrix:
       0      1
0  42037    286
1    577  14140
---- Validation: 
scalar performance:
{'acc': 0.96003616, 'precision': 0.7045814, 'recall': 0.7347921, 'specificity': 0.7347921, 'f1': 0.71850765, 'auroc': 0.8682381, 'binary_precision': 0.4272237, 'binary_recall': 0.49300155, 'binary_specificity': 0.9765827, 'binary_f1_score': 0.45776173}
confusion matrix:
       0    1
0  17724  425
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.7854067, 'recall': 0.6822367, 'specificity': 0.6822367, 'f1': 0.7211184, 'auroc': 0.8683448, 'binary_precision': 0.597561, 'binary_recall': 0.37547892, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.46117648}
confusion matrix:
      0   1
0  5931  66
1   163  98
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_11.png
early stop counter: 4
val acc:0.9600361585617065, best validation acc: 0.9624840617179871, corresponding to test acc:                         0.963087260723114 / 0.9685202836990356
after epoch: 11,now: 2024-06-23 17:10:08.311770,epoch time: 0:20:34.104372,used: 3:50:38.418321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.984432, 'precision': 0.9841436, 'recall': 0.9750385, 'specificity': 0.9750385, 'f1': 0.9794785, 'auroc': 0.9972014, 'binary_precision': 0.9835653, 'binary_recall': 0.9556295, 'binary_specificity': 0.99444747, 'binary_f1_score': 0.9693962}
confusion matrix:
       0      1
0  42088    235
1    653  14064
---- Validation: 
scalar performance:
{'acc': 0.9605683, 'precision': 0.70425326, 'recall': 0.71556616, 'specificity': 0.71556616, 'f1': 0.70973706, 'auroc': 0.87375414, 'binary_precision': 0.42794117, 'binary_recall': 0.4525661, 'binary_specificity': 0.9785663, 'binary_f1_score': 0.4399093}
confusion matrix:
       0    1
0  17760  389
1    352  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.76949626, 'recall': 0.5945329, 'specificity': 0.5945329, 'f1': 0.63552195, 'auroc': 0.842571, 'binary_precision': 0.5730337, 'binary_recall': 0.1954023, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.2914286}
confusion matrix:
      0   1
0  5959  38
1   210  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_12.png
early stop counter: 5
val acc:0.9605683088302612, best validation acc: 0.9624840617179871, corresponding to test acc:                         0.963087260723114 / 0.9685202836990356
after epoch: 12,now: 2024-06-23 17:31:03.379498,epoch time: 0:20:55.067728,used: 4:11:33.486049,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.985291, 'precision': 0.98440266, 'recall': 0.97703433, 'specificity': 0.97703433, 'f1': 0.9806447, 'auroc': 0.99730766, 'binary_precision': 0.9826111, 'binary_recall': 0.95997554, 'binary_specificity': 0.9940932, 'binary_f1_score': 0.9711615}
confusion matrix:
       0      1
0  42074    250
1    589  14127
---- Validation: 
scalar performance:
{'acc': 0.96301615, 'precision': 0.7176925, 'recall': 0.7003323, 'specificity': 0.7003323, 'f1': 0.7086075, 'auroc': 0.8569907, 'binary_precision': 0.4559322, 'binary_recall': 0.41835147, 'binary_specificity': 0.9823131, 'binary_f1_score': 0.43633413}
confusion matrix:
       0    1
0  17828  321
1    374  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.72491306, 'recall': 0.6041095, 'specificity': 0.6041095, 'f1': 0.63947874, 'auroc': 0.83013916, 'binary_precision': 0.48305085, 'binary_recall': 0.21839081, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.30079156}
confusion matrix:
      0   1
0  5936  61
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_13.png
better model found
persisted
after epoch: 13,now: 2024-06-23 17:51:41.790467,epoch time: 0:20:38.410969,used: 4:32:11.897018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9858696, 'precision': 0.98571825, 'recall': 0.97724825, 'specificity': 0.97724825, 'f1': 0.9813862, 'auroc': 0.9975568, 'binary_precision': 0.9854142, 'binary_recall': 0.9594347, 'binary_specificity': 0.9950618, 'binary_f1_score': 0.97225094}
confusion matrix:
       0      1
0  42114    209
1    597  14120
---- Validation: 
scalar performance:
{'acc': 0.9625372, 'precision': 0.71688426, 'recall': 0.7188357, 'specificity': 0.7188357, 'f1': 0.7178551, 'auroc': 0.8600689, 'binary_precision': 0.45300463, 'binary_recall': 0.45723173, 'binary_specificity': 0.9804397, 'binary_f1_score': 0.45510837}
confusion matrix:
       0    1
0  17794  355
1    349  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7292318, 'recall': 0.6061086, 'specificity': 0.6061086, 'f1': 0.6421997, 'auroc': 0.83903575, 'binary_precision': 0.4915254, 'binary_recall': 0.22222222, 'binary_specificity': 0.989995, 'binary_f1_score': 0.30606863}
confusion matrix:
      0   1
0  5937  60
1   203  58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_14.png
early stop counter: 1
val acc:0.9625372290611267, best validation acc: 0.963016152381897, corresponding to test acc:                         0.9576541781425476 / 0.9685202836990356
after epoch: 14,now: 2024-06-23 18:12:23.282667,epoch time: 0:20:41.492200,used: 4:52:53.389218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98497546, 'precision': 0.9827399, 'recall': 0.9778867, 'specificity': 0.9778867, 'f1': 0.9802811, 'auroc': 0.9974283, 'binary_precision': 0.9781949, 'binary_recall': 0.9632398, 'binary_specificity': 0.9925336, 'binary_f1_score': 0.9706598}
confusion matrix:
       0      1
0  42007    316
1    541  14176
---- Validation: 
scalar performance:
{'acc': 0.96078116, 'precision': 0.70787674, 'recall': 0.7299274, 'specificity': 0.7299274, 'f1': 0.71827316, 'auroc': 0.861792, 'binary_precision': 0.43417367, 'binary_recall': 0.4821151, 'binary_specificity': 0.9777398, 'binary_f1_score': 0.45689023}
confusion matrix:
       0    1
0  17745  404
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.7568761, 'recall': 0.6863163, 'specificity': 0.6863163, 'f1': 0.7152542, 'auroc': 0.85911584, 'binary_precision': 0.54010695, 'binary_recall': 0.38697317, 'binary_specificity': 0.9856595, 'binary_f1_score': 0.45089284}
confusion matrix:
      0    1
0  5911   86
1   160  101
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_15.png
early stop counter: 2
val acc:0.9607811570167542, best validation acc: 0.963016152381897, corresponding to test acc:                         0.9576541781425476 / 0.9685202836990356
after epoch: 15,now: 2024-06-23 18:32:59.044540,epoch time: 0:20:35.761873,used: 5:13:29.151091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98592216, 'precision': 0.98451054, 'recall': 0.9785888, 'specificity': 0.9785888, 'f1': 0.98150194, 'auroc': 0.9977683, 'binary_precision': 0.98165077, 'binary_recall': 0.9634387, 'binary_specificity': 0.99373895, 'binary_f1_score': 0.97245944}
confusion matrix:
       0      1
0  42060    265
1    538  14177
---- Validation: 
scalar performance:
{'acc': 0.9608876, 'precision': 0.7091829, 'recall': 0.7344829, 'specificity': 0.7344829, 'f1': 0.72101593, 'auroc': 0.8753854, 'binary_precision': 0.4364641, 'binary_recall': 0.49144635, 'binary_specificity': 0.9775194, 'binary_f1_score': 0.46232626}
confusion matrix:
       0    1
0  17741  408
1    327  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7399022, 'recall': 0.6413398, 'specificity': 0.6413398, 'f1': 0.67623556, 'auroc': 0.8492701, 'binary_precision': 0.50993377, 'binary_recall': 0.29501915, 'binary_specificity': 0.98766047, 'binary_f1_score': 0.37378642}
confusion matrix:
      0   1
0  5923  74
1   184  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_16.png
early stop counter: 3
val acc:0.960887610912323, best validation acc: 0.963016152381897, corresponding to test acc:                         0.9576541781425476 / 0.9685202836990356
after epoch: 16,now: 2024-06-23 18:53:26.636502,epoch time: 0:20:27.591962,used: 5:33:56.743053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9858871, 'precision': 0.9820108, 'recall': 0.9810903, 'specificity': 0.9810903, 'f1': 0.9815493, 'auroc': 0.9976444, 'binary_precision': 0.97402865, 'binary_recall': 0.9711819, 'binary_specificity': 0.9909986, 'binary_f1_score': 0.9726032}
confusion matrix:
       0      1
0  41946    381
1    424  14289
---- Validation: 
scalar performance:
{'acc': 0.9589187, 'precision': 0.70017064, 'recall': 0.7424642, 'specificity': 0.7424642, 'f1': 0.7190159, 'auroc': 0.87347776, 'binary_precision': 0.4178344, 'binary_recall': 0.5101089, 'binary_specificity': 0.97481954, 'binary_f1_score': 0.45938376}
confusion matrix:
       0    1
0  17692  457
1    315  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.7083356, 'recall': 0.6377566, 'specificity': 0.6377566, 'f1': 0.66479087, 'auroc': 0.8410081, 'binary_precision': 0.44705883, 'binary_recall': 0.29118773, 'binary_specificity': 0.98432547, 'binary_f1_score': 0.35266823}
confusion matrix:
      0   1
0  5903  94
1   185  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_17.png
early stop counter: 4
val acc:0.9589186906814575, best validation acc: 0.963016152381897, corresponding to test acc:                         0.9576541781425476 / 0.9685202836990356
after epoch: 17,now: 2024-06-23 19:13:55.725969,epoch time: 0:20:29.089467,used: 5:54:25.832520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98562413, 'precision': 0.9851887, 'recall': 0.9771219, 'specificity': 0.9771219, 'f1': 0.9810671, 'auroc': 0.99748707, 'binary_precision': 0.9843129, 'binary_recall': 0.95955956, 'binary_specificity': 0.9946842, 'binary_f1_score': 0.9717786}
confusion matrix:
       0      1
0  42102    225
1    595  14118
---- Validation: 
scalar performance:
{'acc': 0.96301615, 'precision': 0.72188264, 'recall': 0.73483485, 'specificity': 0.73483485, 'f1': 0.72815204, 'auroc': 0.8788237, 'binary_precision': 0.46187684, 'binary_recall': 0.48989114, 'binary_specificity': 0.9797785, 'binary_f1_score': 0.4754717}
confusion matrix:
       0    1
0  17782  367
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7406081, 'recall': 0.59186685, 'specificity': 0.59186685, 'f1': 0.6290545, 'auroc': 0.845335, 'binary_precision': 0.5154639, 'binary_recall': 0.19157088, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.2793296}
confusion matrix:
      0   1
0  5950  47
1   211  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_18.png
early stop counter: 5
val acc:0.963016152381897, best validation acc: 0.963016152381897, corresponding to test acc:                         0.9576541781425476 / 0.9685202836990356
after epoch: 18,now: 2024-06-23 19:34:18.274054,epoch time: 0:20:22.548085,used: 6:14:48.380605,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98544884, 'precision': 0.9816389, 'recall': 0.98031276, 'specificity': 0.98031276, 'f1': 0.9809734, 'auroc': 0.997687, 'binary_precision': 0.9738009, 'binary_recall': 0.969699, 'binary_specificity': 0.9909265, 'binary_f1_score': 0.97174567}
confusion matrix:
       0      1
0  41937    384
1    446  14273
---- Validation: 
scalar performance:
{'acc': 0.9581737, 'precision': 0.69523084, 'recall': 0.735328, 'specificity': 0.735328, 'f1': 0.7131485, 'auroc': 0.87078106, 'binary_precision': 0.4084507, 'binary_recall': 0.496112, 'binary_specificity': 0.97454405, 'binary_f1_score': 0.4480337}
confusion matrix:
       0    1
0  17687  462
1    324  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.7127572, 'recall': 0.62534714, 'specificity': 0.62534714, 'f1': 0.65615714, 'auroc': 0.8301595, 'binary_precision': 0.45695364, 'binary_recall': 0.26436782, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.33495146}
confusion matrix:
      0   1
0  5915  82
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_19.png
early stop counter: 6
val acc:0.9581736922264099, best validation acc: 0.963016152381897, corresponding to test acc:                         0.9576541781425476 / 0.9685202836990356
after epoch: 19,now: 2024-06-23 19:54:51.962082,epoch time: 0:20:33.688028,used: 6:35:22.068633,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98639554, 'precision': 0.98569953, 'recall': 0.97864056, 'specificity': 0.97864056, 'f1': 0.9821025, 'auroc': 0.9980695, 'binary_precision': 0.98429465, 'binary_recall': 0.9626206, 'binary_specificity': 0.9946605, 'binary_f1_score': 0.973337}
confusion matrix:
       0      1
0  42100    226
1    550  14164
---- Validation: 
scalar performance:
{'acc': 0.962218, 'precision': 0.71406233, 'recall': 0.71342003, 'specificity': 0.71342003, 'f1': 0.71374065, 'auroc': 0.87323976, 'binary_precision': 0.4477379, 'binary_recall': 0.44634527, 'binary_specificity': 0.9804948, 'binary_f1_score': 0.44704053}
confusion matrix:
       0    1
0  17795  354
1    356  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.7221377, 'recall': 0.58395386, 'specificity': 0.58395386, 'f1': 0.6179543, 'auroc': 0.81970835, 'binary_precision': 0.47916666, 'binary_recall': 0.17624521, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.2577031}
confusion matrix:
      0   1
0  5947  50
1   215  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_20.png
early stop counter: 7
val acc:0.9622179865837097, best validation acc: 0.963016152381897, corresponding to test acc:                         0.9576541781425476 / 0.9685202836990356
after epoch: 20,now: 2024-06-23 20:15:19.970645,epoch time: 0:20:28.008563,used: 6:55:50.077196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9868338, 'precision': 0.985804, 'recall': 0.97969073, 'specificity': 0.97969073, 'f1': 0.98269665, 'auroc': 0.99783117, 'binary_precision': 0.983719, 'binary_recall': 0.96493375, 'binary_specificity': 0.9944477, 'binary_f1_score': 0.97423583}
confusion matrix:
       0      1
0  42090    235
1    516  14199
---- Validation: 
scalar performance:
{'acc': 0.9625372, 'precision': 0.71587247, 'recall': 0.7113352, 'specificity': 0.7113352, 'f1': 0.7135767, 'auroc': 0.8669392, 'binary_precision': 0.45151034, 'binary_recall': 0.44167963, 'binary_specificity': 0.9809907, 'binary_f1_score': 0.4465409}
confusion matrix:
       0    1
0  17804  345
1    359  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.7189167, 'recall': 0.6038594, 'specificity': 0.6038594, 'f1': 0.6381713, 'auroc': 0.83589876, 'binary_precision': 0.47107437, 'binary_recall': 0.21839081, 'binary_specificity': 0.989328, 'binary_f1_score': 0.2984293}
confusion matrix:
      0   1
0  5933  64
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_21.png
early stop counter: 8
val acc:0.9625372290611267, best validation acc: 0.963016152381897, corresponding to test acc:                         0.9576541781425476 / 0.9685202836990356
after epoch: 21,now: 2024-06-23 20:35:54.508940,epoch time: 0:20:34.538295,used: 7:16:24.615491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98669356, 'precision': 0.98392904, 'recall': 0.9812346, 'specificity': 0.9812346, 'f1': 0.98257184, 'auroc': 0.9981884, 'binary_precision': 0.9782698, 'binary_recall': 0.96995854, 'binary_specificity': 0.9925107, 'binary_f1_score': 0.9740964}
confusion matrix:
       0      1
0  42010    317
1    442  14271
---- Validation: 
scalar performance:
{'acc': 0.95977014, 'precision': 0.7046472, 'recall': 0.7436551, 'specificity': 0.7436551, 'f1': 0.7222226, 'auroc': 0.8832392, 'binary_precision': 0.42671853, 'binary_recall': 0.5116641, 'binary_specificity': 0.975646, 'binary_f1_score': 0.46534654}
confusion matrix:
       0    1
0  17707  442
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7379537, 'recall': 0.62293315, 'specificity': 0.62293315, 'f1': 0.6598013, 'auroc': 0.8428557, 'binary_precision': 0.50757575, 'binary_recall': 0.256705, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.34096694}
confusion matrix:
      0   1
0  5932  65
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_22.png
early stop counter: 9
val acc:0.959770143032074, best validation acc: 0.963016152381897, corresponding to test acc:                         0.9576541781425476 / 0.9685202836990356
after epoch: 22,now: 2024-06-23 20:56:21.650544,epoch time: 0:20:27.141604,used: 7:36:51.757095,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9871143, 'precision': 0.9860647, 'recall': 0.98016787, 'specificity': 0.98016787, 'f1': 0.9830692, 'auroc': 0.99784935, 'binary_precision': 0.983938, 'binary_recall': 0.9658172, 'binary_specificity': 0.9945186, 'binary_f1_score': 0.9747934}
confusion matrix:
       0      1
0  42093    232
1    503  14212
---- Validation: 
scalar performance:
{'acc': 0.96301615, 'precision': 0.7194347, 'recall': 0.7138333, 'specificity': 0.7138333, 'f1': 0.71659327, 'auroc': 0.87578493, 'binary_precision': 0.45846644, 'binary_recall': 0.44634527, 'binary_specificity': 0.9813213, 'binary_f1_score': 0.45232463}
confusion matrix:
       0    1
0  17810  339
1    356  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.7249007, 'recall': 0.58586955, 'specificity': 0.58586955, 'f1': 0.62042785, 'auroc': 0.8243085, 'binary_precision': 0.48453608, 'binary_recall': 0.18007663, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.26256981}
confusion matrix:
      0   1
0  5947  50
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_23.png
early stop counter: 10
val acc:0.963016152381897, best validation acc: 0.963016152381897, corresponding to test acc:                         0.9576541781425476 / 0.9685202836990356
after epoch: 23,now: 2024-06-23 21:17:17.551924,epoch time: 0:20:55.901380,used: 7:57:47.658475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98669356, 'precision': 0.9855982, 'recall': 0.97953427, 'specificity': 0.97953427, 'f1': 0.9825163, 'auroc': 0.99805343, 'binary_precision': 0.9833795, 'binary_recall': 0.96473944, 'binary_specificity': 0.99432904, 'binary_f1_score': 0.9739703}
confusion matrix:
       0      1
0  42081    240
1    519  14200
---- Validation: 
scalar performance:
{'acc': 0.9642401, 'precision': 0.727236, 'recall': 0.70396614, 'specificity': 0.70396614, 'f1': 0.7148985, 'auroc': 0.86861, 'binary_precision': 0.47478262, 'binary_recall': 0.42457232, 'binary_specificity': 0.98336, 'binary_f1_score': 0.44827586}
confusion matrix:
       0    1
0  17847  302
1    370  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7592808, 'recall': 0.6090248, 'specificity': 0.6090248, 'f1': 0.65003633, 'auroc': 0.83078253, 'binary_precision': 0.55140185, 'binary_recall': 0.22605364, 'binary_specificity': 0.991996, 'binary_f1_score': 0.32065216}
confusion matrix:
      0   1
0  5949  48
1   202  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_24.png
better model found
persisted
after epoch: 24,now: 2024-06-23 21:38:22.214113,epoch time: 0:21:04.662189,used: 8:18:52.320664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98600984, 'precision': 0.98272717, 'recall': 0.98066586, 'specificity': 0.98066586, 'f1': 0.98169065, 'auroc': 0.9975681, 'binary_precision': 0.9759918, 'binary_recall': 0.9696249, 'binary_specificity': 0.99170685, 'binary_f1_score': 0.9727979}
confusion matrix:
       0      1
0  41973    351
1    447  14269
---- Validation: 
scalar performance:
{'acc': 0.95737547, 'precision': 0.68967015, 'recall': 0.7266641, 'specificity': 0.7266641, 'f1': 0.70628697, 'auroc': 0.87477016, 'binary_precision': 0.39793283, 'binary_recall': 0.47900465, 'binary_specificity': 0.97432363, 'binary_f1_score': 0.43472123}
confusion matrix:
       0    1
0  17683  466
1    335  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95317996, 'precision': 0.6831376, 'recall': 0.612769, 'specificity': 0.612769, 'f1': 0.63824755, 'auroc': 0.8258246, 'binary_precision': 0.39873418, 'binary_recall': 0.2413793, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.300716}
confusion matrix:
      0   1
0  5902  95
1   198  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_25.png
early stop counter: 1
val acc:0.9573754668235779, best validation acc: 0.9642400741577148, corresponding to test acc:                         0.9600511193275452 / 0.9685202836990356
after epoch: 25,now: 2024-06-23 21:59:11.247804,epoch time: 0:20:49.033691,used: 8:39:41.354355,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9866059, 'precision': 0.9838895, 'recall': 0.9810444, 'specificity': 0.9810444, 'f1': 0.9824559, 'auroc': 0.9977163, 'binary_precision': 0.9783309, 'binary_recall': 0.9695549, 'binary_specificity': 0.992534, 'binary_f1_score': 0.97392315}
confusion matrix:
       0      1
0  42009    316
1    448  14267
---- Validation: 
scalar performance:
{'acc': 0.96094084, 'precision': 0.70914197, 'recall': 0.7322602, 'specificity': 0.7322602, 'f1': 0.72001565, 'auroc': 0.8724252, 'binary_precision': 0.43654114, 'binary_recall': 0.4867807, 'binary_specificity': 0.9777398, 'binary_f1_score': 0.4602941}
confusion matrix:
       0    1
0  17745  404
1    330  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550975, 'precision': 0.70694304, 'recall': 0.64308685, 'specificity': 0.64308685, 'f1': 0.6683207, 'auroc': 0.84178984, 'binary_precision': 0.44382024, 'binary_recall': 0.30268198, 'binary_specificity': 0.9834917, 'binary_f1_score': 0.35990885}
confusion matrix:
      0   1
0  5898  99
1   182  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_26.png
early stop counter: 2
val acc:0.9609408378601074, best validation acc: 0.9642400741577148, corresponding to test acc:                         0.9600511193275452 / 0.9685202836990356
after epoch: 26,now: 2024-06-23 22:22:37.099191,epoch time: 0:23:25.851387,used: 9:03:07.205742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98679876, 'precision': 0.9854722, 'recall': 0.9799342, 'specificity': 0.9799342, 'f1': 0.9826616, 'auroc': 0.9982556, 'binary_precision': 0.9827813, 'binary_recall': 0.9657516, 'binary_specificity': 0.99411684, 'binary_f1_score': 0.9741921}
confusion matrix:
       0      1
0  42075    249
1    504  14212
---- Validation: 
scalar performance:
{'acc': 0.95780116, 'precision': 0.6891914, 'recall': 0.7148837, 'specificity': 0.7148837, 'f1': 0.7011042, 'auroc': 0.86255085, 'binary_precision': 0.39782017, 'binary_recall': 0.4541213, 'binary_specificity': 0.975646, 'binary_f1_score': 0.42411038}
confusion matrix:
       0    1
0  17707  442
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9488655, 'precision': 0.66011775, 'recall': 0.62334424, 'specificity': 0.62334424, 'f1': 0.6389025, 'auroc': 0.8307915, 'binary_precision': 0.3517588, 'binary_recall': 0.26819924, 'binary_specificity': 0.9784892, 'binary_f1_score': 0.30434784}
confusion matrix:
      0    1
0  5868  129
1   191   70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_27.png
early stop counter: 3
val acc:0.9578011631965637, best validation acc: 0.9642400741577148, corresponding to test acc:                         0.9600511193275452 / 0.9685202836990356
after epoch: 27,now: 2024-06-23 22:43:35.032721,epoch time: 0:20:57.933530,used: 9:24:05.139272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9867286, 'precision': 0.98338664, 'recall': 0.9819046, 'specificity': 0.9819046, 'f1': 0.98264265, 'auroc': 0.9975002, 'binary_precision': 0.9765156, 'binary_recall': 0.97193724, 'binary_specificity': 0.991872, 'binary_f1_score': 0.97422105}
confusion matrix:
       0      1
0  41979    344
1    413  14304
---- Validation: 
scalar performance:
{'acc': 0.9574819, 'precision': 0.6927727, 'recall': 0.7394702, 'specificity': 0.7394702, 'f1': 0.71323687, 'auroc': 0.8748224, 'binary_precision': 0.4032258, 'binary_recall': 0.5054432, 'binary_specificity': 0.97349715, 'binary_f1_score': 0.44858524}
confusion matrix:
       0    1
0  17668  481
1    318  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9475871, 'precision': 0.6626393, 'recall': 0.64466524, 'specificity': 0.64466524, 'f1': 0.65302724, 'auroc': 0.83548045, 'binary_precision': 0.35497835, 'binary_recall': 0.31417623, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.3333333}
confusion matrix:
      0    1
0  5848  149
1   179   82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_28.png
early stop counter: 4
val acc:0.9574819207191467, best validation acc: 0.9642400741577148, corresponding to test acc:                         0.9600511193275452 / 0.9685202836990356
after epoch: 28,now: 2024-06-23 23:04:40.689183,epoch time: 0:21:05.656462,used: 9:45:10.795734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9871143, 'precision': 0.9867764, 'recall': 0.97946215, 'specificity': 0.97946215, 'f1': 0.9830469, 'auroc': 0.9981642, 'binary_precision': 0.9860947, 'binary_recall': 0.9636499, 'binary_specificity': 0.9952743, 'binary_f1_score': 0.97474307}
confusion matrix:
       0      1
0  42122    200
1    535  14183
---- Validation: 
scalar performance:
{'acc': 0.9643465, 'precision': 0.7252679, 'recall': 0.6755191, 'specificity': 0.6755191, 'f1': 0.6969481, 'auroc': 0.8691424, 'binary_precision': 0.47283703, 'binary_recall': 0.36547434, 'binary_specificity': 0.98556393, 'binary_f1_score': 0.4122807}
confusion matrix:
       0    1
0  17887  262
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.6967333, 'recall': 0.5812044, 'specificity': 0.5812044, 'f1': 0.61159277, 'auroc': 0.8284277, 'binary_precision': 0.42857143, 'binary_recall': 0.1724138, 'binary_specificity': 0.989995, 'binary_f1_score': 0.24590163}
confusion matrix:
      0   1
0  5937  60
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_29.png
better model found
persisted
after epoch: 29,now: 2024-06-23 23:27:36.707619,epoch time: 0:22:56.018436,used: 10:08:06.814170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9876578, 'precision': 0.98583215, 'recall': 0.9818438, 'specificity': 0.9818438, 'f1': 0.9838163, 'auroc': 0.9979887, 'binary_precision': 0.98210967, 'binary_recall': 0.9698308, 'binary_specificity': 0.9938568, 'binary_f1_score': 0.9759316}
confusion matrix:
       0      1
0  42063    260
1    444  14273
---- Validation: 
scalar performance:
{'acc': 0.9616326, 'precision': 0.7108637, 'recall': 0.7168672, 'specificity': 0.7168672, 'f1': 0.7138179, 'auroc': 0.88275754, 'binary_precision': 0.4410876, 'binary_recall': 0.4541213, 'binary_specificity': 0.9796132, 'binary_f1_score': 0.44750956}
confusion matrix:
       0    1
0  17779  370
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.7425926, 'recall': 0.6029442, 'specificity': 0.6029442, 'f1': 0.6411828, 'auroc': 0.83288825, 'binary_precision': 0.5185185, 'binary_recall': 0.21455939, 'binary_specificity': 0.991329, 'binary_f1_score': 0.30352303}
confusion matrix:
      0   1
0  5945  52
1   205  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_30.png
early stop counter: 1
val acc:0.9616326093673706, best validation acc: 0.9643465280532837, corresponding to test acc:                         0.9558964371681213 / 0.9685202836990356
after epoch: 30,now: 2024-06-23 23:49:56.294663,epoch time: 0:22:19.587044,used: 10:30:26.401214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_19_29_seed_0_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:30:26.401214 at 2024-06-23 23:49:56.294663
persisted model performance metric: 

scalar performance:
{'acc': 0.95589644, 'precision': 0.6967333, 'recall': 0.5812044, 'specificity': 0.5812044, 'f1': 0.61159277, 'auroc': 0.8284277, 'binary_precision': 0.42857143, 'binary_recall': 0.1724138, 'binary_specificity': 0.989995, 'binary_f1_score': 0.24590163}
confusion matrix:
      0   1
0  5937  60
1   216  45
oracle model performance metric: 

scalar performance:
{'acc': 0.9685203, 'precision': 0.8579082, 'recall': 0.6849047, 'specificity': 0.6849047, 'f1': 0.74123883, 'auroc': 0.8609139, 'binary_precision': 0.74242425, 'binary_recall': 0.37547892, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.4987277}
confusion matrix:
      0   1
0  5963  34
1   163  98
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 640729 KiB |   1151 TiB |   1151 TiB |
|       from large pool | 167936 KiB | 568000 KiB |   1151 TiB |   1151 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 640729 KiB |   1151 TiB |   1151 TiB |
|       from large pool | 167936 KiB | 568000 KiB |   1151 TiB |   1151 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 632296 KiB |   1149 TiB |   1149 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   1148 TiB |   1148 TiB |
|       from small pool |  35968 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB | 755712 KiB | 755712 KiB |      0 B   |
|       from large pool | 679936 KiB | 679936 KiB | 679936 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  81740 KiB | 217798 KiB | 464906 GiB | 464906 GiB |
|       from large pool |  67584 KiB | 213792 KiB | 464521 GiB | 464521 GiB |
|       from small pool |  14156 KiB |  14156 KiB |    384 GiB |    384 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    7879    |  101972 K  |  101969 K  |
|       from large pool |      36    |      76    |   41347 K  |   41347 K  |
|       from small pool |    3216    |    7842    |   60625 K  |   60621 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    7879    |  101972 K  |  101969 K  |
|       from large pool |      36    |      76    |   41347 K  |   41347 K  |
|       from small pool |    3216    |    7842    |   60625 K  |   60621 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    3581    |   45849 K  |   45848 K  |
|       from large pool |       7    |      11    |   14786 K  |   14786 K  |
|       from small pool |      32    |    3574    |   31062 K  |   31062 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1151 TiB |   1151 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1151 TiB |   1151 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1151 TiB |   1151 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1151 TiB |   1151 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1149 TiB |   1149 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1148 TiB |   1148 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 755712 KiB | 755712 KiB | 468992 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  51200 KiB |  75776 KiB |  75776 KiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 217798 KiB | 464906 GiB | 464906 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 464521 GiB | 464521 GiB |
|       from small pool |      0 KiB |  21751 KiB |    384 GiB |    384 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  101972 K  |  101972 K  |
|       from large pool |       2    |      76    |   41347 K  |   41347 K  |
|       from small pool |       0    |    7842    |   60625 K  |   60625 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  101972 K  |  101972 K  |
|       from large pool |       2    |      76    |   41347 K  |   41347 K  |
|       from small pool |       0    |    7842    |   60625 K  |   60625 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      51    |      51    |      16    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      25    |      37    |      37    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   45850 K  |   45850 K  |
|       from large pool |       3    |      13    |   14786 K  |   14786 K  |
|       from small pool |       0    |    3574    |   31063 K  |   31063 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1151 TiB |   1151 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1151 TiB |   1151 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1151 TiB |   1151 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1151 TiB |   1151 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1149 TiB |   1149 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1148 TiB |   1148 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 755712 KiB | 755712 KiB | 468992 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  51200 KiB |  75776 KiB |  75776 KiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 217798 KiB | 464906 GiB | 464906 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 464521 GiB | 464521 GiB |
|       from small pool |      0 KiB |  21751 KiB |    384 GiB |    384 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  101972 K  |  101972 K  |
|       from large pool |       2    |      76    |   41347 K  |   41347 K  |
|       from small pool |       0    |    7842    |   60625 K  |   60625 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  101972 K  |  101972 K  |
|       from large pool |       2    |      76    |   41347 K  |   41347 K  |
|       from small pool |       0    |    7842    |   60625 K  |   60625 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      51    |      51    |      16    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      25    |      37    |      37    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   45850 K  |   45850 K  |
|       from large pool |       3    |      13    |   14786 K  |   14786 K  |
|       from small pool |       0    |    3574    |   31063 K  |   31063 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150

 Experiment start at: 2024-06-23 23:58:21.785043
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96927786, 'precision': 0.967489, 'recall': 0.95069563, 'specificity': 0.95069563, 'f1': 0.9587058, 'auroc': 0.9917371, 'binary_precision': 0.9640451, 'binary_recall': 0.9129681, 'binary_specificity': 0.9884231, 'binary_f1_score': 0.9378117}
confusion matrix:
       0      1
0  41921    491
1   1255  13165
---- Validation: 
scalar performance:
{'acc': 0.9584312, 'precision': 0.69594276, 'recall': 0.68160546, 'specificity': 0.68160546, 'f1': 0.6884637, 'auroc': 0.8113344, 'binary_precision': 0.414791, 'binary_recall': 0.3833581, 'binary_specificity': 0.9798528, 'binary_f1_score': 0.39845556}
confusion matrix:
       0    1
0  17703  364
1    415  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.76932937, 'recall': 0.7173478, 'specificity': 0.7173478, 'f1': 0.74020433, 'auroc': 0.8301418, 'binary_precision': 0.5625, 'binary_recall': 0.45, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.49999994}
confusion matrix:
      0    1
0  5855   91
1   143  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-24 00:19:30.088649,epoch time: 0:21:08.303606,used: 0:21:08.303606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97631615, 'precision': 0.9695581, 'recall': 0.9677905, 'specificity': 0.9677905, 'f1': 0.96866995, 'auroc': 0.99419034, 'binary_precision': 0.95591825, 'binary_recall': 0.950482, 'binary_specificity': 0.9850989, 'binary_f1_score': 0.9531924}
confusion matrix:
       0      1
0  41781    632
1    714  13705
---- Validation: 
scalar performance:
{'acc': 0.9552828, 'precision': 0.6956689, 'recall': 0.758652, 'specificity': 0.758652, 'f1': 0.7221299, 'auroc': 0.8547201, 'binary_precision': 0.40843508, 'binary_recall': 0.5468053, 'binary_specificity': 0.9704987, 'binary_f1_score': 0.4675985}
confusion matrix:
       0    1
0  17534  533
1    305  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.76673293, 'recall': 0.7578896, 'specificity': 0.7578896, 'f1': 0.7622266, 'auroc': 0.87390745, 'binary_precision': 0.55378485, 'binary_recall': 0.5346154, 'binary_specificity': 0.9811638, 'binary_f1_score': 0.5440313}
confusion matrix:
      0    1
0  5834  112
1   121  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_2.png
new oracle model saved
early stop counter: 1
val acc:0.9552828073501587, best validation acc: 0.9584311842918396, corresponding to test acc:                         0.9622945785522461 / 0.962455689907074
after epoch: 2,now: 2024-06-24 00:39:58.757726,epoch time: 0:20:28.669077,used: 0:41:36.972683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97932506, 'precision': 0.976948, 'recall': 0.9681567, 'specificity': 0.9681567, 'f1': 0.9724482, 'auroc': 0.9951048, 'binary_precision': 0.9722559, 'binary_recall': 0.9454848, 'binary_specificity': 0.9908285, 'binary_f1_score': 0.9586835}
confusion matrix:
       0      1
0  42025    389
1    786  13632
---- Validation: 
scalar performance:
{'acc': 0.9610459, 'precision': 0.72002745, 'recall': 0.72945386, 'specificity': 0.72945386, 'f1': 0.7246287, 'auroc': 0.85457015, 'binary_precision': 0.45945945, 'binary_recall': 0.47994056, 'binary_specificity': 0.9789672, 'binary_f1_score': 0.46947673}
confusion matrix:
       0    1
0  17687  380
1    350  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9698679, 'precision': 0.85425663, 'recall': 0.71762204, 'specificity': 0.71762204, 'f1': 0.76798445, 'auroc': 0.8662014, 'binary_precision': 0.7324841, 'binary_recall': 0.44230768, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.55155873}
confusion matrix:
      0    1
0  5904   42
1   145  115
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-24 01:00:29.082282,epoch time: 0:20:30.324556,used: 1:02:07.297239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9825978, 'precision': 0.9803121, 'recall': 0.973534, 'specificity': 0.973534, 'f1': 0.9768616, 'auroc': 0.99672014, 'binary_precision': 0.9757705, 'binary_recall': 0.95513177, 'binary_specificity': 0.99193627, 'binary_f1_score': 0.9653408}
confusion matrix:
       0      1
0  42070    342
1    647  13773
---- Validation: 
scalar performance:
{'acc': 0.96221983, 'precision': 0.7266725, 'recall': 0.72147954, 'specificity': 0.72147954, 'f1': 0.72404206, 'auroc': 0.8559429, 'binary_precision': 0.4733638, 'binary_recall': 0.46210995, 'binary_specificity': 0.9808491, 'binary_f1_score': 0.46766916}
confusion matrix:
       0    1
0  17721  346
1    362  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.8372028, 'recall': 0.698139, 'specificity': 0.698139, 'f1': 0.7477656, 'auroc': 0.86669123, 'binary_precision': 0.7, 'binary_recall': 0.40384614, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.5121951}
confusion matrix:
      0    1
0  5901   45
1   155  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_4.png
better model found
persisted
after epoch: 4,now: 2024-06-24 01:21:10.818499,epoch time: 0:20:41.736217,used: 1:22:49.033456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98131335, 'precision': 0.97408575, 'recall': 0.9767221, 'specificity': 0.9767221, 'f1': 0.97539437, 'auroc': 0.99653053, 'binary_precision': 0.9592847, 'binary_recall': 0.96740186, 'binary_specificity': 0.9860423, 'binary_f1_score': 0.9633262}
confusion matrix:
       0      1
0  41822    592
1    470  13948
---- Validation: 
scalar performance:
{'acc': 0.9592316, 'precision': 0.7155231, 'recall': 0.77285945, 'specificity': 0.77285945, 'f1': 0.7403508, 'auroc': 0.8673251, 'binary_precision': 0.44715446, 'binary_recall': 0.57206535, 'binary_specificity': 0.9736536, 'binary_f1_score': 0.5019556}
confusion matrix:
       0    1
0  17591  476
1    288  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.7579653, 'recall': 0.711074, 'specificity': 0.711074, 'f1': 0.73186314, 'auroc': 0.86747587, 'binary_precision': 0.54028434, 'binary_recall': 0.43846154, 'binary_specificity': 0.9836865, 'binary_f1_score': 0.48407644}
confusion matrix:
      0    1
0  5849   97
1   146  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_5.png
early stop counter: 1
val acc:0.9592316150665283, best validation acc: 0.9622198343276978, corresponding to test acc:                         0.9677731394767761 / 0.9698678851127625
after epoch: 5,now: 2024-06-24 01:41:48.924820,epoch time: 0:20:38.106321,used: 1:43:27.139777,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9816477, 'precision': 0.98183143, 'recall': 0.96948385, 'specificity': 0.96948385, 'f1': 0.97545576, 'auroc': 0.99644387, 'binary_precision': 0.9821905, 'binary_recall': 0.94479126, 'binary_specificity': 0.99417645, 'binary_f1_score': 0.963128}
confusion matrix:
       0      1
0  42167    247
1    796  13622
---- Validation: 
scalar performance:
{'acc': 0.9648346, 'precision': 0.74577427, 'recall': 0.7228356, 'specificity': 0.7228356, 'f1': 0.7336766, 'auroc': 0.86776364, 'binary_precision': 0.5115132, 'binary_recall': 0.46210995, 'binary_specificity': 0.9835612, 'binary_f1_score': 0.48555815}
confusion matrix:
       0    1
0  17770  297
1    362  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.84016645, 'recall': 0.65675634, 'specificity': 0.65675634, 'f1': 0.71139306, 'auroc': 0.8651364, 'binary_precision': 0.7094017, 'binary_recall': 0.31923077, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.4403183}
confusion matrix:
      0   1
0  5912  34
1   177  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_6.png
better model found
persisted
after epoch: 6,now: 2024-06-24 02:02:49.771710,epoch time: 0:21:00.846890,used: 2:04:27.986667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9834776, 'precision': 0.9795315, 'recall': 0.9767312, 'specificity': 0.9767312, 'f1': 0.9781208, 'auroc': 0.9970658, 'binary_precision': 0.9715925, 'binary_recall': 0.96303487, 'binary_specificity': 0.99042743, 'binary_f1_score': 0.9672948}
confusion matrix:
       0      1
0  42007    406
1    533  13886
---- Validation: 
scalar performance:
{'acc': 0.96120596, 'precision': 0.72333807, 'recall': 0.7509949, 'specificity': 0.7509949, 'f1': 0.7362523, 'auroc': 0.867411, 'binary_precision': 0.4644737, 'binary_recall': 0.52451706, 'binary_specificity': 0.9774727, 'binary_f1_score': 0.49267268}
confusion matrix:
       0    1
0  17660  407
1    320  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.7723007, 'recall': 0.6600028, 'specificity': 0.6600028, 'f1': 0.6998411, 'auroc': 0.8611117, 'binary_precision': 0.5733333, 'binary_recall': 0.33076924, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.4195122}
confusion matrix:
      0   1
0  5882  64
1   174  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_7.png
early stop counter: 1
val acc:0.9612059593200684, best validation acc: 0.9648345708847046, corresponding to test acc:                         0.9660006165504456 / 0.9698678851127625
after epoch: 7,now: 2024-06-24 02:23:18.920685,epoch time: 0:20:29.148975,used: 2:24:57.135642,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98286176, 'precision': 0.9812627, 'recall': 0.973276, 'specificity': 0.973276, 'f1': 0.9771843, 'auroc': 0.99664927, 'binary_precision': 0.978097, 'binary_recall': 0.95381415, 'binary_specificity': 0.9927379, 'binary_f1_score': 0.96580297}
confusion matrix:
       0      1
0  42104    308
1    666  13754
---- Validation: 
scalar performance:
{'acc': 0.9633938, 'precision': 0.73608434, 'recall': 0.7428311, 'specificity': 0.7428311, 'f1': 0.7394042, 'auroc': 0.86757946, 'binary_precision': 0.4906205, 'binary_recall': 0.50520056, 'binary_specificity': 0.9804616, 'binary_f1_score': 0.4978038}
confusion matrix:
       0    1
0  17714  353
1    333  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.793484, 'recall': 0.67020684, 'specificity': 0.67020684, 'f1': 0.71362567, 'auroc': 0.8608779, 'binary_precision': 0.6148649, 'binary_recall': 0.35, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.44607845}
confusion matrix:
      0   1
0  5889  57
1   169  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_8.png
early stop counter: 2
val acc:0.9633938074111938, best validation acc: 0.9648345708847046, corresponding to test acc:                         0.9660006165504456 / 0.9698678851127625
after epoch: 8,now: 2024-06-24 02:44:06.087030,epoch time: 0:20:47.166345,used: 2:45:44.301987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9834424, 'precision': 0.97844195, 'recall': 0.9778062, 'specificity': 0.9778062, 'f1': 0.97812355, 'auroc': 0.9968347, 'binary_precision': 0.9683113, 'binary_recall': 0.96636385, 'binary_specificity': 0.9892486, 'binary_f1_score': 0.9673366}
confusion matrix:
       0      1
0  41957    456
1    485  13934
---- Validation: 
scalar performance:
{'acc': 0.95944506, 'precision': 0.71515185, 'recall': 0.76152587, 'specificity': 0.76152587, 'f1': 0.73576754, 'auroc': 0.87994087, 'binary_precision': 0.44727272, 'binary_recall': 0.5482912, 'binary_specificity': 0.9747606, 'binary_f1_score': 0.49265686}
confusion matrix:
       0    1
0  17611  456
1    304  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.72615856, 'recall': 0.6612422, 'specificity': 0.6612422, 'f1': 0.6874918, 'auroc': 0.8572562, 'binary_precision': 0.48087433, 'binary_recall': 0.33846155, 'binary_specificity': 0.98402286, 'binary_f1_score': 0.3972912}
confusion matrix:
      0   1
0  5851  95
1   172  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_9.png
early stop counter: 3
val acc:0.959445059299469, best validation acc: 0.9648345708847046, corresponding to test acc:                         0.9660006165504456 / 0.9698678851127625
after epoch: 9,now: 2024-06-24 03:04:40.843897,epoch time: 0:20:34.756867,used: 3:06:19.058854,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9822491, 'recall': 0.9745846, 'specificity': 0.9745846, 'f1': 0.9783387, 'auroc': 0.99716175, 'binary_precision': 0.9793265, 'binary_recall': 0.95603025, 'binary_specificity': 0.9931389, 'binary_f1_score': 0.9675382}
confusion matrix:
       0      1
0  42122    291
1    634  13785
---- Validation: 
scalar performance:
{'acc': 0.9627535, 'precision': 0.730946, 'recall': 0.7296242, 'specificity': 0.7296242, 'f1': 0.73028296, 'auroc': 0.87414485, 'binary_precision': 0.4813154, 'binary_recall': 0.47845468, 'binary_specificity': 0.9807937, 'binary_f1_score': 0.47988078}
confusion matrix:
       0    1
0  17720  347
1    351  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.748492, 'recall': 0.64411366, 'specificity': 0.64411366, 'f1': 0.6806799, 'auroc': 0.85527766, 'binary_precision': 0.527027, 'binary_recall': 0.3, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.38235295}
confusion matrix:
      0   1
0  5876  70
1   182  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_10.png
early stop counter: 4
val acc:0.9627534747123718, best validation acc: 0.9648345708847046, corresponding to test acc:                         0.9660006165504456 / 0.9698678851127625
after epoch: 10,now: 2024-06-24 03:25:03.101197,epoch time: 0:20:22.257300,used: 3:26:41.316154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9856595, 'precision': 0.9848919, 'recall': 0.9770944, 'specificity': 0.9770944, 'f1': 0.98091286, 'auroc': 0.9976101, 'binary_precision': 0.98337126, 'binary_recall': 0.95970595, 'binary_specificity': 0.9944828, 'binary_f1_score': 0.9713945}
confusion matrix:
       0      1
0  42179    234
1    581  13838
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.7417735, 'recall': 0.7396976, 'specificity': 0.7396976, 'f1': 0.7407305, 'auroc': 0.8786749, 'binary_precision': 0.5022489, 'binary_recall': 0.49777117, 'binary_specificity': 0.98162395, 'binary_f1_score': 0.5}
confusion matrix:
       0    1
0  17735  332
1    338  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.76029533, 'recall': 0.6279833, 'specificity': 0.6279833, 'f1': 0.6689522, 'auroc': 0.85493964, 'binary_precision': 0.552, 'binary_recall': 0.2653846, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.35844156}
confusion matrix:
      0   1
0  5890  56
1   191  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_11.png
early stop counter: 5
val acc:0.9642475843429565, best validation acc: 0.9648345708847046, corresponding to test acc:                         0.9660006165504456 / 0.9698678851127625
after epoch: 11,now: 2024-06-24 03:45:28.949377,epoch time: 0:20:25.848180,used: 3:47:07.164334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9848677, 'precision': 0.9863031, 'recall': 0.9736326, 'specificity': 0.9736326, 'f1': 0.97975785, 'auroc': 0.9976318, 'binary_precision': 0.98910534, 'binary_recall': 0.95082533, 'binary_specificity': 0.9964399, 'binary_f1_score': 0.9695876}
confusion matrix:
       0      1
0  42263    151
1    709  13709
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.76837194, 'recall': 0.68677634, 'specificity': 0.68677634, 'f1': 0.7194908, 'auroc': 0.8719715, 'binary_precision': 0.55939525, 'binary_recall': 0.38484398, 'binary_specificity': 0.9887087, 'binary_f1_score': 0.4559859}
confusion matrix:
       0    1
0  17863  204
1    414  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.79989207, 'recall': 0.5656259, 'specificity': 0.5656259, 'f1': 0.60098463, 'auroc': 0.8462311, 'binary_precision': 0.6363636, 'binary_recall': 0.13461539, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.22222222}
confusion matrix:
      0   1
0  5926  20
1   225  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_12.png
better model found
persisted
after epoch: 12,now: 2024-06-24 04:05:53.619940,epoch time: 0:20:24.670563,used: 4:07:31.834897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9859058, 'precision': 0.9841081, 'recall': 0.97854114, 'specificity': 0.97854114, 'f1': 0.98128355, 'auroc': 0.99714184, 'binary_precision': 0.9805222, 'binary_recall': 0.9635897, 'binary_specificity': 0.99349254, 'binary_f1_score': 0.97198224}
confusion matrix:
       0      1
0  42137    276
1    525  13894
---- Validation: 
scalar performance:
{'acc': 0.9615795, 'precision': 0.72452307, 'recall': 0.7411749, 'specificity': 0.7411749, 'f1': 0.732512, 'auroc': 0.87296736, 'binary_precision': 0.46758622, 'binary_recall': 0.5037147, 'binary_specificity': 0.9786351, 'binary_f1_score': 0.48497856}
confusion matrix:
       0    1
0  17681  386
1    334  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.72915804, 'recall': 0.64862156, 'specificity': 0.64862156, 'f1': 0.679128, 'auroc': 0.84943885, 'binary_precision': 0.48795182, 'binary_recall': 0.31153846, 'binary_specificity': 0.98570466, 'binary_f1_score': 0.3802817}
confusion matrix:
      0   1
0  5861  85
1   179  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_13.png
early stop counter: 1
val acc:0.9615795016288757, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 13,now: 2024-06-24 04:26:26.561563,epoch time: 0:20:32.941623,used: 4:28:04.776520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9853604, 'precision': 0.98404574, 'recall': 0.97714704, 'specificity': 0.97714704, 'f1': 0.98053336, 'auroc': 0.99742126, 'binary_precision': 0.9814342, 'binary_recall': 0.9604716, 'binary_specificity': 0.9938225, 'binary_f1_score': 0.97083974}
confusion matrix:
       0      1
0  42150    262
1    570  13850
---- Validation: 
scalar performance:
{'acc': 0.9632871, 'precision': 0.73495096, 'recall': 0.73562306, 'specificity': 0.73562306, 'f1': 0.7352865, 'auroc': 0.8867947, 'binary_precision': 0.4888889, 'binary_recall': 0.49034175, 'binary_specificity': 0.9809044, 'binary_f1_score': 0.48961425}
confusion matrix:
       0    1
0  17722  345
1    343  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.73780787, 'recall': 0.6086684, 'specificity': 0.6086684, 'f1': 0.646197, 'auroc': 0.85162795, 'binary_precision': 0.5086207, 'binary_recall': 0.22692308, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.3138298}
confusion matrix:
      0   1
0  5889  57
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_14.png
early stop counter: 2
val acc:0.9632871150970459, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 14,now: 2024-06-24 04:46:52.287589,epoch time: 0:20:25.726026,used: 4:48:30.502546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98574746, 'precision': 0.9835491, 'recall': 0.9786856, 'specificity': 0.9786856, 'f1': 0.98108596, 'auroc': 0.99747896, 'binary_precision': 0.97915494, 'binary_recall': 0.9643501, 'binary_specificity': 0.9930212, 'binary_f1_score': 0.97169614}
confusion matrix:
       0      1
0  42118    296
1    514  13904
---- Validation: 
scalar performance:
{'acc': 0.9615795, 'precision': 0.72319615, 'recall': 0.7283001, 'specificity': 0.7283001, 'f1': 0.7257155, 'auroc': 0.88415146, 'binary_precision': 0.46589258, 'binary_recall': 0.4769688, 'binary_specificity': 0.97963136, 'binary_f1_score': 0.47136563}
confusion matrix:
       0    1
0  17699  368
1    352  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.722242, 'recall': 0.65004015, 'specificity': 0.65004015, 'f1': 0.6781485, 'auroc': 0.8570228, 'binary_precision': 0.47398844, 'binary_recall': 0.31538463, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.37875292}
confusion matrix:
      0   1
0  5855  91
1   178  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_15.png
early stop counter: 3
val acc:0.9615795016288757, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 15,now: 2024-06-24 05:07:26.634270,epoch time: 0:20:34.346681,used: 5:09:04.849227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9855715, 'precision': 0.9826962, 'recall': 0.9790964, 'specificity': 0.9790964, 'f1': 0.980879, 'auroc': 0.99759585, 'binary_precision': 0.97692525, 'binary_recall': 0.9659501, 'binary_specificity': 0.99224275, 'binary_f1_score': 0.97140664}
confusion matrix:
       0      1
0  42083    329
1    491  13929
---- Validation: 
scalar performance:
{'acc': 0.96168625, 'precision': 0.7248899, 'recall': 0.73836917, 'specificity': 0.73836917, 'f1': 0.73140764, 'auroc': 0.87699616, 'binary_precision': 0.46853146, 'binary_recall': 0.49777117, 'binary_specificity': 0.9789672, 'binary_f1_score': 0.48270893}
confusion matrix:
       0    1
0  17687  380
1    338  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.75537765, 'recall': 0.6166971, 'specificity': 0.6166971, 'f1': 0.6571677, 'auroc': 0.8372437, 'binary_precision': 0.54310346, 'binary_recall': 0.2423077, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.3351064}
confusion matrix:
      0   1
0  5893  53
1   197  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_16.png
early stop counter: 4
val acc:0.9616862535476685, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 16,now: 2024-06-24 05:28:39.317703,epoch time: 0:21:12.683433,used: 5:30:17.532660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9844278, 'precision': 0.9851706, 'recall': 0.9735701, 'specificity': 0.9735701, 'f1': 0.97919357, 'auroc': 0.9975333, 'binary_precision': 0.98662543, 'binary_recall': 0.9515257, 'binary_specificity': 0.99561447, 'binary_f1_score': 0.96875775}
confusion matrix:
       0      1
0  42226    186
1    699  13721
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.7540188, 'recall': 0.7097436, 'specificity': 0.7097436, 'f1': 0.7295272, 'auroc': 0.87310886, 'binary_precision': 0.5289855, 'binary_recall': 0.43387815, 'binary_specificity': 0.9856091, 'binary_f1_score': 0.47673467}
confusion matrix:
       0    1
0  17807  260
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.77605706, 'recall': 0.6304109, 'specificity': 0.6304109, 'f1': 0.67423713, 'auroc': 0.8422383, 'binary_precision': 0.5833333, 'binary_recall': 0.26923078, 'binary_specificity': 0.991591, 'binary_f1_score': 0.36842105}
confusion matrix:
      0   1
0  5896  50
1   190  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_17.png
early stop counter: 5
val acc:0.96579509973526, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 17,now: 2024-06-24 05:49:44.744895,epoch time: 0:21:05.427192,used: 5:51:22.959852,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9864689, 'precision': 0.9853584, 'recall': 0.97877985, 'specificity': 0.97877985, 'f1': 0.982012, 'auroc': 0.9980693, 'binary_precision': 0.9831504, 'binary_recall': 0.96317106, 'binary_specificity': 0.99438864, 'binary_f1_score': 0.97305816}
confusion matrix:
       0      1
0  42176    238
1    531  13887
---- Validation: 
scalar performance:
{'acc': 0.96152616, 'precision': 0.7236886, 'recall': 0.7361404, 'specificity': 0.7361404, 'f1': 0.72972363, 'auroc': 0.8898078, 'binary_precision': 0.46629214, 'binary_recall': 0.49331352, 'binary_specificity': 0.9789672, 'binary_f1_score': 0.47942236}
confusion matrix:
       0    1
0  17687  380
1    341  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.7179222, 'recall': 0.60966647, 'specificity': 0.60966647, 'f1': 0.6434948, 'auroc': 0.85640895, 'binary_precision': 0.46875, 'binary_recall': 0.23076923, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.30927837}
confusion matrix:
      0   1
0  5878  68
1   200  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_18.png
early stop counter: 6
val acc:0.9615261554718018, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 18,now: 2024-06-24 06:10:45.804853,epoch time: 0:21:01.059958,used: 6:12:24.019810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9865041, 'precision': 0.9856807, 'recall': 0.9785541, 'specificity': 0.9785541, 'f1': 0.9820504, 'auroc': 0.9975629, 'binary_precision': 0.9840459, 'binary_recall': 0.9624133, 'binary_specificity': 0.9946949, 'binary_f1_score': 0.9731094}
confusion matrix:
       0      1
0  42187    225
1    542  13878
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.74166936, 'recall': 0.7089964, 'specificity': 0.7089964, 'f1': 0.7240074, 'auroc': 0.8733506, 'binary_precision': 0.50431776, 'binary_recall': 0.43387815, 'binary_specificity': 0.9841147, 'binary_f1_score': 0.46645367}
confusion matrix:
       0    1
0  17780  287
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.80142355, 'recall': 0.6143645, 'specificity': 0.6143645, 'f1': 0.6616436, 'auroc': 0.8368567, 'binary_precision': 0.6354167, 'binary_recall': 0.23461539, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.34269664}
confusion matrix:
      0   1
0  5911  35
1   199  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_19.png
early stop counter: 7
val acc:0.9643543362617493, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 19,now: 2024-06-24 06:31:11.543282,epoch time: 0:20:25.738429,used: 6:32:49.758239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98529, 'precision': 0.98320717, 'recall': 0.9778081, 'specificity': 0.9778081, 'f1': 0.98046887, 'auroc': 0.9975488, 'binary_precision': 0.9790506, 'binary_recall': 0.96261877, 'binary_specificity': 0.9929974, 'binary_f1_score': 0.9707651}
confusion matrix:
       0      1
0  42116    297
1    539  13880
---- Validation: 
scalar performance:
{'acc': 0.9603522, 'precision': 0.71912944, 'recall': 0.75555897, 'specificity': 0.75555897, 'f1': 0.73575515, 'auroc': 0.8887167, 'binary_precision': 0.4556962, 'binary_recall': 0.53491825, 'binary_specificity': 0.9761997, 'binary_f1_score': 0.49213943}
confusion matrix:
       0    1
0  17637  430
1    313  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.7283488, 'recall': 0.65589345, 'specificity': 0.65589345, 'f1': 0.68433946, 'auroc': 0.8593246, 'binary_precision': 0.4857143, 'binary_recall': 0.32692307, 'binary_specificity': 0.98486376, 'binary_f1_score': 0.39080462}
confusion matrix:
      0   1
0  5856  90
1   175  85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_20.png
early stop counter: 8
val acc:0.9603521823883057, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 20,now: 2024-06-24 06:51:30.479158,epoch time: 0:20:18.935876,used: 6:53:08.694115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98668003, 'precision': 0.98640025, 'recall': 0.97830456, 'specificity': 0.97830456, 'f1': 0.98226625, 'auroc': 0.99789727, 'binary_precision': 0.9858464, 'binary_recall': 0.9613011, 'binary_specificity': 0.99530804, 'binary_f1_score': 0.973419}
confusion matrix:
       0      1
0  42214    199
1    558  13861
---- Validation: 
scalar performance:
{'acc': 0.96568835, 'precision': 0.75306284, 'recall': 0.7096883, 'specificity': 0.7096883, 'f1': 0.7291106, 'auroc': 0.8881179, 'binary_precision': 0.5270758, 'binary_recall': 0.43387815, 'binary_specificity': 0.9854984, 'binary_f1_score': 0.47595763}
confusion matrix:
       0    1
0  17805  262
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.74387425, 'recall': 0.58492976, 'specificity': 0.58492976, 'f1': 0.6215738, 'auroc': 0.84348184, 'binary_precision': 0.52272725, 'binary_recall': 0.17692308, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.26436782}
confusion matrix:
      0   1
0  5904  42
1   214  46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_21.png
early stop counter: 9
val acc:0.9656883478164673, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 21,now: 2024-06-24 07:12:05.318072,epoch time: 0:20:34.838914,used: 7:13:43.533029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98602897, 'precision': 0.9823662, 'recall': 0.98068357, 'specificity': 0.98068357, 'f1': 0.98152107, 'auroc': 0.9976355, 'binary_precision': 0.97497034, 'binary_recall': 0.96983147, 'binary_specificity': 0.9915356, 'binary_f1_score': 0.9723941}
confusion matrix:
       0      1
0  42054    359
1    435  13984
---- Validation: 
scalar performance:
{'acc': 0.9600854, 'precision': 0.7167273, 'recall': 0.74755263, 'specificity': 0.74755263, 'f1': 0.73097634, 'auroc': 0.89200425, 'binary_precision': 0.45148772, 'binary_recall': 0.5185735, 'binary_specificity': 0.9765318, 'binary_f1_score': 0.48271093}
confusion matrix:
       0    1
0  17643  424
1    324  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.71680534, 'recall': 0.5931997, 'specificity': 0.5931997, 'f1': 0.6271261, 'auroc': 0.8500422, 'binary_precision': 0.4678899, 'binary_recall': 0.19615385, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.27642274}
confusion matrix:
      0   1
0  5888  58
1   209  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_22.png
early stop counter: 10
val acc:0.960085391998291, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 22,now: 2024-06-24 07:32:29.515930,epoch time: 0:20:24.197858,used: 7:34:07.730887,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98537797, 'precision': 0.986575, 'recall': 0.97470856, 'specificity': 0.97470856, 'f1': 0.98045754, 'auroc': 0.9976572, 'binary_precision': 0.98891765, 'binary_recall': 0.95304805, 'binary_specificity': 0.99636906, 'binary_f1_score': 0.97065157}
confusion matrix:
       0      1
0  42259    154
1    677  13742
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.75570774, 'recall': 0.6947784, 'specificity': 0.6947784, 'f1': 0.7206647, 'auroc': 0.87702715, 'binary_precision': 0.53346455, 'binary_recall': 0.4026746, 'binary_specificity': 0.98688215, 'binary_f1_score': 0.45893312}
confusion matrix:
       0    1
0  17830  237
1    402  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7637602, 'recall': 0.57431626, 'specificity': 0.57431626, 'f1': 0.6104577, 'auroc': 0.8386836, 'binary_precision': 0.5633803, 'binary_recall': 0.15384616, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.24169184}
confusion matrix:
      0   1
0  5915  31
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_23.png
early stop counter: 11
val acc:0.965901792049408, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 23,now: 2024-06-24 07:52:57.550111,epoch time: 0:20:28.034181,used: 7:54:35.765068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9864161, 'precision': 0.98370814, 'recall': 0.9803239, 'specificity': 0.9803239, 'f1': 0.9820008, 'auroc': 0.9976753, 'binary_precision': 0.97827, 'binary_recall': 0.9679567, 'binary_specificity': 0.9926911, 'binary_f1_score': 0.97308606}
confusion matrix:
       0      1
0  42104    310
1    462  13956
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.73715246, 'recall': 0.7429141, 'specificity': 0.7429141, 'f1': 0.7399943, 'auroc': 0.89386815, 'binary_precision': 0.49275362, 'binary_recall': 0.50520056, 'binary_specificity': 0.98062766, 'binary_f1_score': 0.49889946}
confusion matrix:
       0    1
0  17717  350
1    333  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.7223023, 'recall': 0.6007238, 'specificity': 0.6007238, 'f1': 0.635659, 'auroc': 0.83988833, 'binary_precision': 0.47826087, 'binary_recall': 0.21153846, 'binary_specificity': 0.9899092, 'binary_f1_score': 0.29333335}
confusion matrix:
      0   1
0  5886  60
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_24.png
early stop counter: 12
val acc:0.9635539054870605, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 24,now: 2024-06-24 08:13:24.490846,epoch time: 0:20:26.940735,used: 8:15:02.705803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98687357, 'precision': 0.9845823, 'recall': 0.9806533, 'specificity': 0.9806533, 'f1': 0.9825973, 'auroc': 0.99796283, 'binary_precision': 0.97998875, 'binary_recall': 0.9680261, 'binary_specificity': 0.99328053, 'binary_f1_score': 0.9739707}
confusion matrix:
       0      1
0  42129    285
1    461  13957
---- Validation: 
scalar performance:
{'acc': 0.9618463, 'precision': 0.72333986, 'recall': 0.7134178, 'specificity': 0.7134178, 'f1': 0.7182516, 'auroc': 0.88373697, 'binary_precision': 0.46728972, 'binary_recall': 0.44576523, 'binary_specificity': 0.98107046, 'binary_f1_score': 0.45627373}
confusion matrix:
       0    1
0  17725  342
1    373  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.7219285, 'recall': 0.6244625, 'specificity': 0.6244625, 'f1': 0.6576178, 'auroc': 0.8479227, 'binary_precision': 0.4755245, 'binary_recall': 0.26153848, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.337469}
confusion matrix:
      0   1
0  5871  75
1   192  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_25.png
early stop counter: 13
val acc:0.9618462920188904, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 25,now: 2024-06-24 08:34:32.530725,epoch time: 0:21:08.039879,used: 8:36:10.745682,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9872783, 'precision': 0.98479927, 'recall': 0.9815196, 'specificity': 0.9815196, 'f1': 0.9831452, 'auroc': 0.997939, 'binary_precision': 0.97981924, 'binary_recall': 0.9698294, 'binary_specificity': 0.9932098, 'binary_f1_score': 0.97479874}
confusion matrix:
       0      1
0  42126    288
1    435  13983
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.7392238, 'recall': 0.7409344, 'specificity': 0.7409344, 'f1': 0.74007565, 'auroc': 0.8956472, 'binary_precision': 0.49705014, 'binary_recall': 0.5007429, 'binary_specificity': 0.98112583, 'binary_f1_score': 0.49888968}
confusion matrix:
       0    1
0  17726  341
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606832, 'precision': 0.7662033, 'recall': 0.6319135, 'specificity': 0.6319135, 'f1': 0.67379314, 'auroc': 0.8585415, 'binary_precision': 0.56349206, 'binary_recall': 0.27307692, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.36787567}
confusion matrix:
      0   1
0  5891  55
1   189  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_26.png
early stop counter: 14
val acc:0.9638740420341492, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 26,now: 2024-06-24 08:54:51.180781,epoch time: 0:20:18.650056,used: 8:56:29.395738,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98660964, 'precision': 0.9839312, 'recall': 0.9806118, 'specificity': 0.9806118, 'f1': 0.9822568, 'auroc': 0.99787027, 'binary_precision': 0.9785519, 'binary_recall': 0.96843785, 'binary_specificity': 0.99278575, 'binary_f1_score': 0.9734686}
confusion matrix:
       0      1
0  42110    306
1    455  13961
---- Validation: 
scalar performance:
{'acc': 0.9617396, 'precision': 0.72590554, 'recall': 0.7455495, 'specificity': 0.7455495, 'f1': 0.73526436, 'auroc': 0.88545936, 'binary_precision': 0.47002724, 'binary_recall': 0.51263, 'binary_specificity': 0.978469, 'binary_f1_score': 0.4904051}
confusion matrix:
       0    1
0  17678  389
1    328  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548824, 'precision': 0.6983804, 'recall': 0.6104964, 'specificity': 0.6104964, 'f1': 0.6400843, 'auroc': 0.83822286, 'binary_precision': 0.42957747, 'binary_recall': 0.23461539, 'binary_specificity': 0.9863774, 'binary_f1_score': 0.3034826}
confusion matrix:
      0   1
0  5865  81
1   199  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_27.png
early stop counter: 15
val acc:0.9617395997047424, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 27,now: 2024-06-24 09:15:22.592882,epoch time: 0:20:31.412101,used: 9:17:00.807839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.986117, 'precision': 0.9832341, 'recall': 0.9800101, 'specificity': 0.9800101, 'f1': 0.9816083, 'auroc': 0.99785304, 'binary_precision': 0.9774415, 'binary_recall': 0.9676122, 'binary_specificity': 0.992408, 'binary_f1_score': 0.97250205}
confusion matrix:
       0      1
0  42091    322
1    467  13952
---- Validation: 
scalar performance:
{'acc': 0.9617396, 'precision': 0.7243627, 'recall': 0.72981364, 'specificity': 0.72981364, 'f1': 0.72705114, 'auroc': 0.8810022, 'binary_precision': 0.46811596, 'binary_recall': 0.47994056, 'binary_specificity': 0.97968674, 'binary_f1_score': 0.4739545}
confusion matrix:
       0    1
0  17700  367
1    350  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.7107049, 'recall': 0.5856756, 'specificity': 0.5856756, 'f1': 0.61831385, 'auroc': 0.824278, 'binary_precision': 0.4563107, 'binary_recall': 0.18076923, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.25895315}
confusion matrix:
      0   1
0  5890  56
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_28.png
early stop counter: 16
val acc:0.9617395997047424, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 28,now: 2024-06-24 09:37:00.396210,epoch time: 0:21:37.803328,used: 9:38:38.611167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9877006, 'precision': 0.98618805, 'recall': 0.98123026, 'specificity': 0.98123026, 'f1': 0.9836768, 'auroc': 0.99824405, 'binary_precision': 0.98316544, 'binary_recall': 0.9680954, 'binary_specificity': 0.9943651, 'binary_f1_score': 0.9755723}
confusion matrix:
       0      1
0  42175    239
1    460  13958
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73998344, 'recall': 0.72173285, 'specificity': 0.72173285, 'f1': 0.7304536, 'auroc': 0.8875785, 'binary_precision': 0.5, 'binary_recall': 0.46062407, 'binary_specificity': 0.9828417, 'binary_f1_score': 0.479505}
confusion matrix:
       0    1
0  17757  310
1    363  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9555269, 'precision': 0.69689155, 'recall': 0.5869259, 'specificity': 0.5869259, 'f1': 0.61757046, 'auroc': 0.8374524, 'binary_precision': 0.42857143, 'binary_recall': 0.18461539, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.2580645}
confusion matrix:
      0   1
0  5882  64
1   212  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_29.png
early stop counter: 17
val acc:0.9640874862670898, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 29,now: 2024-06-24 10:03:30.089711,epoch time: 0:26:29.693501,used: 10:05:08.304668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.986117, 'precision': 0.98439014, 'recall': 0.97881997, 'specificity': 0.97881997, 'f1': 0.9815639, 'auroc': 0.9975518, 'binary_precision': 0.98094565, 'binary_recall': 0.9640058, 'binary_specificity': 0.99363405, 'binary_f1_score': 0.972402}
confusion matrix:
       0      1
0  42143    270
1    519  13900
---- Validation: 
scalar performance:
{'acc': 0.9617396, 'precision': 0.72180104, 'recall': 0.70620984, 'specificity': 0.70620984, 'f1': 0.7136849, 'auroc': 0.8747427, 'binary_precision': 0.46474358, 'binary_recall': 0.4309064, 'binary_specificity': 0.98151326, 'binary_f1_score': 0.4471858}
confusion matrix:
       0    1
0  17733  334
1    383  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.7242484, 'recall': 0.65564114, 'specificity': 0.65564114, 'f1': 0.682873, 'auroc': 0.8429961, 'binary_precision': 0.4775281, 'binary_recall': 0.32692307, 'binary_specificity': 0.9843592, 'binary_f1_score': 0.38812786}
confusion matrix:
      0   1
0  5853  93
1   175  85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_30.png
early stop counter: 18
val acc:0.9617395997047424, best validation acc: 0.9670224189758301, corresponding to test acc:                         0.9605220556259155 / 0.9698678851127625
after epoch: 30,now: 2024-06-24 10:25:27.385471,epoch time: 0:21:57.295760,used: 10:27:05.600428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_23_58_21_seed_1_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:27:05.600428 at 2024-06-24 10:25:27.385471
persisted model performance metric: 

scalar performance:
{'acc': 0.96052206, 'precision': 0.79989207, 'recall': 0.5656259, 'specificity': 0.5656259, 'f1': 0.60098463, 'auroc': 0.8462311, 'binary_precision': 0.6363636, 'binary_recall': 0.13461539, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.22222222}
confusion matrix:
      0   1
0  5926  20
1   225  35
oracle model performance metric: 

scalar performance:
{'acc': 0.9698679, 'precision': 0.85425663, 'recall': 0.71762204, 'specificity': 0.71762204, 'f1': 0.76798445, 'auroc': 0.8662014, 'binary_precision': 0.7324841, 'binary_recall': 0.44230768, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.55155873}
confusion matrix:
      0    1
0  5904   42
1   145  115
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204071 KiB | 640729 KiB |   2303 TiB |   2303 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2302 TiB |   2302 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204071 KiB | 640729 KiB |   2303 TiB |   2303 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2302 TiB |   2302 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 632296 KiB |   2293 TiB |   2293 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   2292 TiB |   2292 TiB |
|       from small pool |  35966 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1118 MiB | 468992 KiB |
|       from large pool | 600064 KiB | 679936 KiB |   1020 MiB | 444416 KiB |
|       from small pool |  75776 KiB |  75776 KiB |     98 MiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80600 KiB | 218089 KiB |    845 TiB |    845 TiB |
|       from large pool |  68480 KiB | 217080 KiB |    844 TiB |    844 TiB |
|       from small pool |  12120 KiB |  21751 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    7879    |  203540 K  |  203537 K  |
|       from large pool |      36    |      76    |   82528 K  |   82528 K  |
|       from small pool |    3192    |    7842    |  121012 K  |  121008 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    7879    |  203540 K  |  203537 K  |
|       from large pool |      36    |      76    |   82528 K  |   82528 K  |
|       from small pool |    3192    |    7842    |  121012 K  |  121008 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      67    |      16    |
|       from large pool |      14    |      14    |      18    |       4    |
|       from small pool |      37    |      37    |      49    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3581    |   92706 K  |   92706 K  |
|       from large pool |       5    |      13    |   30876 K  |   30876 K  |
|       from small pool |      30    |    3574    |   61830 K  |   61830 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   2303 TiB |   2303 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2302 TiB |   2302 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   2303 TiB |   2303 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2302 TiB |   2302 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   2293 TiB |   2293 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2292 TiB |   2292 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1118 MiB |    840 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |     98 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB |    845 TiB |    845 TiB |
|       from large pool |  55040 KiB | 217080 KiB |    844 TiB |    844 TiB |
|       from small pool |      0 KiB |  21751 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  203540 K  |  203540 K  |
|       from large pool |       2    |      76    |   82528 K  |   82528 K  |
|       from small pool |       0    |    7842    |  121012 K  |  121012 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  203540 K  |  203540 K  |
|       from large pool |       2    |      76    |   82528 K  |   82528 K  |
|       from small pool |       0    |    7842    |  121012 K  |  121012 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      67    |      33    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      49    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   92708 K  |   92708 K  |
|       from large pool |       3    |      13    |   30876 K  |   30876 K  |
|       from small pool |       0    |    3574    |   61832 K  |   61832 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   2303 TiB |   2303 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2302 TiB |   2302 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   2303 TiB |   2303 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2302 TiB |   2302 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   2293 TiB |   2293 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2292 TiB |   2292 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1118 MiB |    840 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |     98 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB |    845 TiB |    845 TiB |
|       from large pool |  55040 KiB | 217080 KiB |    844 TiB |    844 TiB |
|       from small pool |      0 KiB |  21751 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  203540 K  |  203540 K  |
|       from large pool |       2    |      76    |   82528 K  |   82528 K  |
|       from small pool |       0    |    7842    |  121012 K  |  121012 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  203540 K  |  203540 K  |
|       from large pool |       2    |      76    |   82528 K  |   82528 K  |
|       from small pool |       0    |    7842    |  121012 K  |  121012 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      67    |      33    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      49    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   92708 K  |   92708 K  |
|       from large pool |       3    |      13    |   30876 K  |   30876 K  |
|       from small pool |       0    |    3574    |   61832 K  |   61832 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150

 Experiment start at: 2024-06-24 10:35:57.685213
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96970755, 'precision': 0.9706157, 'recall': 0.9507962, 'specificity': 0.9507962, 'f1': 0.9601412, 'auroc': 0.9914757, 'binary_precision': 0.9724084, 'binary_recall': 0.9108335, 'binary_specificity': 0.9907589, 'binary_f1_score': 0.9406143}
confusion matrix:
       0      1
0  41920    391
1   1349  13780
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.95946306, 'precision': 0.6812031, 'recall': 0.70120525, 'specificity': 0.70120525, 'f1': 0.69060993, 'auroc': 0.8343413, 'binary_precision': 0.38152012, 'binary_recall': 0.42524916, 'binary_specificity': 0.9771614, 'binary_f1_score': 0.40219957}
confusion matrix:
       0    1
0  17756  415
1    346  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.778389, 'recall': 0.7125884, 'specificity': 0.7125884, 'f1': 0.74057585, 'auroc': 0.8387141, 'binary_precision': 0.57923496, 'binary_recall': 0.43801653, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.49882355}
confusion matrix:
      0    1
0  5920   77
1   136  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-24 11:04:17.244575,epoch time: 0:28:19.559362,used: 0:28:19.559362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9744951, 'precision': 0.97534156, 'recall': 0.9585707, 'specificity': 0.9585707, 'f1': 0.9665553, 'auroc': 0.994864, 'binary_precision': 0.97703, 'binary_recall': 0.9249174, 'binary_specificity': 0.99222404, 'binary_f1_score': 0.95025975}
confusion matrix:
       0      1
0  41981    329
1   1136  13994
---- Validation: 
scalar performance:
{'acc': 0.9612209, 'precision': 0.693535, 'recall': 0.713356, 'specificity': 0.713356, 'f1': 0.7029002, 'auroc': 0.84783965, 'binary_precision': 0.4054054, 'binary_recall': 0.44850498, 'binary_specificity': 0.97820705, 'binary_f1_score': 0.4258675}
confusion matrix:
       0    1
0  17775  396
1    332  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890527, 'precision': 0.8202929, 'recall': 0.69632787, 'specificity': 0.69632787, 'f1': 0.74197686, 'auroc': 0.8459097, 'binary_precision': 0.6643836, 'binary_recall': 0.40082645, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.5}
confusion matrix:
      0   1
0  5948  49
1   145  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-24 11:34:57.820170,epoch time: 0:30:40.575595,used: 0:59:00.134957,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97816855, 'precision': 0.9790882, 'recall': 0.96439517, 'specificity': 0.96439517, 'f1': 0.9714364, 'auroc': 0.99570835, 'binary_precision': 0.9809359, 'binary_recall': 0.93528986, 'binary_specificity': 0.99350053, 'binary_f1_score': 0.95756924}
confusion matrix:
       0      1
0  42036    275
1    979  14150
---- Validation: 
scalar performance:
{'acc': 0.9634049, 'precision': 0.7048873, 'recall': 0.70324147, 'specificity': 0.70324147, 'f1': 0.7040607, 'auroc': 0.8418981, 'binary_precision': 0.42881072, 'binary_recall': 0.42524916, 'binary_specificity': 0.98123384, 'binary_f1_score': 0.42702252}
confusion matrix:
       0    1
0  17830  341
1    346  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705081, 'precision': 0.84625155, 'recall': 0.69517887, 'specificity': 0.69517887, 'f1': 0.74771714, 'auroc': 0.83656216, 'binary_precision': 0.7164179, 'binary_recall': 0.3966942, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.51063836}
confusion matrix:
      0   1
0  5959  38
1   146  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-24 12:06:47.930480,epoch time: 0:31:50.110310,used: 1:30:50.245267,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9801706, 'precision': 0.9752875, 'recall': 0.97352624, 'specificity': 0.97352624, 'f1': 0.9744023, 'auroc': 0.9963439, 'binary_precision': 0.9650336, 'binary_recall': 0.95948446, 'binary_specificity': 0.98756796, 'binary_f1_score': 0.962251}
confusion matrix:
       0      1
0  41784    526
1    613  14517
---- Validation: 
scalar performance:
{'acc': 0.9575454, 'precision': 0.6892208, 'recall': 0.7797165, 'specificity': 0.7797165, 'f1': 0.7245099, 'auroc': 0.86825186, 'binary_precision': 0.3922652, 'binary_recall': 0.589701, 'binary_specificity': 0.969732, 'binary_f1_score': 0.4711347}
confusion matrix:
       0    1
0  17621  550
1    247  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.74733937, 'recall': 0.73652977, 'specificity': 0.73652977, 'f1': 0.74179804, 'auroc': 0.86143076, 'binary_precision': 0.5151515, 'binary_recall': 0.49173555, 'binary_specificity': 0.981324, 'binary_f1_score': 0.50317127}
confusion matrix:
      0    1
0  5885  112
1   123  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_4.png
early stop counter: 1
val acc:0.9575453996658325, best validation acc: 0.9634048938751221, corresponding to test acc:                         0.9705080986022949 / 0.9705080986022949
after epoch: 4,now: 2024-06-24 12:29:13.767187,epoch time: 0:22:25.836707,used: 1:53:16.081974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.981633, 'precision': 0.978454, 'recall': 0.97405183, 'specificity': 0.97405183, 'f1': 0.9762251, 'auroc': 0.99666524, 'binary_precision': 0.97184044, 'binary_recall': 0.9580304, 'binary_specificity': 0.99007326, 'binary_f1_score': 0.964886}
confusion matrix:
       0      1
0  41890    420
1    635  14495
---- Validation: 
scalar performance:
{'acc': 0.96026206, 'precision': 0.7005737, 'recall': 0.7787107, 'specificity': 0.7787107, 'f1': 0.7324251, 'auroc': 0.88384384, 'binary_precision': 0.41509435, 'binary_recall': 0.58471763, 'binary_specificity': 0.97270375, 'binary_f1_score': 0.48551726}
confusion matrix:
       0    1
0  17675  496
1    250  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9681039, 'precision': 0.7975366, 'recall': 0.72961754, 'specificity': 0.72961754, 'f1': 0.75872236, 'auroc': 0.86410356, 'binary_precision': 0.61621624, 'binary_recall': 0.47107437, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.53395784}
confusion matrix:
      0    1
0  5926   71
1   128  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_5.png
early stop counter: 2
val acc:0.9602620601654053, best validation acc: 0.9634048938751221, corresponding to test acc:                         0.9705080986022949 / 0.9705080986022949
after epoch: 5,now: 2024-06-24 12:52:34.776055,epoch time: 0:23:21.008868,used: 2:16:37.090842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9810585, 'precision': 0.97594005, 'recall': 0.9752116, 'specificity': 0.9752116, 'f1': 0.9755751, 'auroc': 0.99679756, 'binary_precision': 0.9651517, 'binary_recall': 0.9628553, 'binary_specificity': 0.98756796, 'binary_f1_score': 0.96400213}
confusion matrix:
       0      1
0  41784    526
1    562  14568
---- Validation: 
scalar performance:
{'acc': 0.95919675, 'precision': 0.69281316, 'recall': 0.76129633, 'specificity': 0.76129633, 'f1': 0.72118855, 'auroc': 0.86911845, 'binary_precision': 0.40072638, 'binary_recall': 0.5498339, 'binary_specificity': 0.97275877, 'binary_f1_score': 0.46358544}
confusion matrix:
       0    1
0  17676  495
1    271  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589678, 'precision': 0.7201635, 'recall': 0.68322766, 'specificity': 0.68322766, 'f1': 0.6997725, 'auroc': 0.8464361, 'binary_precision': 0.465, 'binary_recall': 0.38429752, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.42081448}
confusion matrix:
      0    1
0  5890  107
1   149   93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_6.png
early stop counter: 3
val acc:0.9591967463493347, best validation acc: 0.9634048938751221, corresponding to test acc:                         0.9705080986022949 / 0.9705080986022949
after epoch: 6,now: 2024-06-24 13:15:04.169100,epoch time: 0:22:29.393045,used: 2:39:06.483887,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98194635, 'precision': 0.9824255, 'recall': 0.9708679, 'specificity': 0.9708679, 'f1': 0.97645867, 'auroc': 0.9965817, 'binary_precision': 0.9833985, 'binary_recall': 0.9474554, 'binary_specificity': 0.99428034, 'binary_f1_score': 0.9650924}
confusion matrix:
       0      1
0  42068    242
1    795  14335
---- Validation: 
scalar performance:
{'acc': 0.96628135, 'precision': 0.7280317, 'recall': 0.7240006, 'specificity': 0.7240006, 'f1': 0.72599614, 'auroc': 0.8689333, 'binary_precision': 0.47377327, 'binary_recall': 0.4651163, 'binary_specificity': 0.9828848, 'binary_f1_score': 0.46940488}
confusion matrix:
       0    1
0  17860  311
1    322  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.81503963, 'recall': 0.64765817, 'specificity': 0.64765817, 'f1': 0.69826275, 'auroc': 0.85149395, 'binary_precision': 0.6576577, 'binary_recall': 0.30165288, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.41359773}
confusion matrix:
      0   1
0  5959  38
1   169  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_7.png
better model found
persisted
after epoch: 7,now: 2024-06-24 13:39:59.136957,epoch time: 0:24:54.967857,used: 3:04:01.451744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9829909, 'precision': 0.9828655, 'recall': 0.97312665, 'specificity': 0.97312665, 'f1': 0.97786236, 'auroc': 0.99723566, 'binary_precision': 0.9826093, 'binary_recall': 0.9522802, 'binary_specificity': 0.9939731, 'binary_f1_score': 0.967207}
confusion matrix:
       0      1
0  42055    255
1    722  14408
---- Validation: 
scalar performance:
{'acc': 0.9645235, 'precision': 0.71425897, 'recall': 0.71425897, 'specificity': 0.71425897, 'f1': 0.71425897, 'auroc': 0.86585426, 'binary_precision': 0.44684386, 'binary_recall': 0.44684386, 'binary_specificity': 0.9816741, 'binary_f1_score': 0.44684386}
confusion matrix:
       0    1
0  17838  333
1    333  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658599, 'precision': 0.8101705, 'recall': 0.62733054, 'specificity': 0.62733054, 'f1': 0.6770674, 'auroc': 0.82604784, 'binary_precision': 0.6494845, 'binary_recall': 0.2603306, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.37168145}
confusion matrix:
      0   1
0  5963  34
1   179  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_8.png
early stop counter: 1
val acc:0.9645234942436218, best validation acc: 0.9662813544273376, corresponding to test acc:                         0.9668216109275818 / 0.9705080986022949
after epoch: 8,now: 2024-06-24 14:05:35.528174,epoch time: 0:25:36.391217,used: 3:29:37.842961,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98360026, 'precision': 0.98296666, 'recall': 0.9746003, 'specificity': 0.9746003, 'f1': 0.97868466, 'auroc': 0.99726534, 'binary_precision': 0.9816663, 'binary_recall': 0.955582, 'binary_specificity': 0.99361867, 'binary_f1_score': 0.9684485}
confusion matrix:
       0      1
0  42041    270
1    672  14457
---- Validation: 
scalar performance:
{'acc': 0.9618601, 'precision': 0.7015836, 'recall': 0.7369746, 'specificity': 0.7369746, 'f1': 0.71766865, 'auroc': 0.8784087, 'binary_precision': 0.4199438, 'binary_recall': 0.49667773, 'binary_specificity': 0.9772715, 'binary_f1_score': 0.45509893}
confusion matrix:
       0    1
0  17758  413
1    303  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.744726, 'recall': 0.66101885, 'specificity': 0.66101885, 'f1': 0.6931971, 'auroc': 0.84439725, 'binary_precision': 0.51592356, 'binary_recall': 0.33471075, 'binary_specificity': 0.987327, 'binary_f1_score': 0.40601504}
confusion matrix:
      0   1
0  5921  76
1   161  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_9.png
early stop counter: 2
val acc:0.9618601202964783, best validation acc: 0.9662813544273376, corresponding to test acc:                         0.9668216109275818 / 0.9705080986022949
after epoch: 9,now: 2024-06-24 14:28:14.096082,epoch time: 0:22:38.567908,used: 3:52:16.410869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9846274, 'precision': 0.9822865, 'recall': 0.9779739, 'specificity': 0.9779739, 'f1': 0.98010373, 'auroc': 0.99768865, 'binary_precision': 0.97741437, 'binary_recall': 0.9639128, 'binary_specificity': 0.992035, 'binary_f1_score': 0.97061664}
confusion matrix:
       0      1
0  41973    337
1    546  14584
---- Validation: 
scalar performance:
{'acc': 0.95999575, 'precision': 0.6980357, 'recall': 0.7705426, 'specificity': 0.7705426, 'f1': 0.72792906, 'auroc': 0.8879702, 'binary_precision': 0.4105642, 'binary_recall': 0.5681063, 'binary_specificity': 0.97297895, 'binary_f1_score': 0.47665507}
confusion matrix:
       0    1
0  17680  491
1    260  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.73026097, 'recall': 0.6543203, 'specificity': 0.6543203, 'f1': 0.6838443, 'auroc': 0.8455572, 'binary_precision': 0.4875, 'binary_recall': 0.32231405, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.3880597}
confusion matrix:
      0   1
0  5915  82
1   164  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_10.png
early stop counter: 3
val acc:0.9599957466125488, best validation acc: 0.9662813544273376, corresponding to test acc:                         0.9668216109275818 / 0.9705080986022949
after epoch: 10,now: 2024-06-24 14:57:43.170392,epoch time: 0:29:29.074310,used: 4:21:45.485179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98523676, 'precision': 0.9847475, 'recall': 0.97707, 'specificity': 0.97707, 'f1': 0.98082584, 'auroc': 0.9976156, 'binary_precision': 0.9837409, 'binary_recall': 0.9598123, 'binary_specificity': 0.9943277, 'binary_f1_score': 0.97162926}
confusion matrix:
       0      1
0  42071    240
1    608  14521
---- Validation: 
scalar performance:
{'acc': 0.9650562, 'precision': 0.71865016, 'recall': 0.7193524, 'specificity': 0.7193524, 'f1': 0.7190007, 'auroc': 0.8727385, 'binary_precision': 0.455298, 'binary_recall': 0.45681062, 'binary_specificity': 0.98189425, 'binary_f1_score': 0.45605305}
confusion matrix:
       0    1
0  17842  329
1    327  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.74880165, 'recall': 0.61351645, 'specificity': 0.61351645, 'f1': 0.65312755, 'auroc': 0.8373493, 'binary_precision': 0.5277778, 'binary_recall': 0.23553719, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.3257143}
confusion matrix:
      0   1
0  5946  51
1   185  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_11.png
early stop counter: 4
val acc:0.9650561809539795, best validation acc: 0.9662813544273376, corresponding to test acc:                         0.9668216109275818 / 0.9705080986022949
after epoch: 11,now: 2024-06-24 15:34:05.472823,epoch time: 0:36:22.302431,used: 4:58:07.787610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9857939, 'precision': 0.9821098, 'recall': 0.9812486, 'specificity': 0.9812486, 'f1': 0.9816781, 'auroc': 0.99795747, 'binary_precision': 0.9743488, 'binary_recall': 0.97164387, 'binary_specificity': 0.9908534, 'binary_f1_score': 0.9729944}
confusion matrix:
       0      1
0  41924    387
1    429  14700
---- Validation: 
scalar performance:
{'acc': 0.96127415, 'precision': 0.70145386, 'recall': 0.754339, 'specificity': 0.754339, 'f1': 0.7244299, 'auroc': 0.89170766, 'binary_precision': 0.4185137, 'binary_recall': 0.5332226, 'binary_specificity': 0.9754554, 'binary_f1_score': 0.46895546}
confusion matrix:
       0    1
0  17725  446
1    281  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.7519256, 'recall': 0.62954515, 'specificity': 0.62954515, 'f1': 0.6689132, 'auroc': 0.84991515, 'binary_precision': 0.5327869, 'binary_recall': 0.26859504, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.35714287}
confusion matrix:
      0   1
0  5940  57
1   177  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_12.png
early stop counter: 5
val acc:0.9612741470336914, best validation acc: 0.9662813544273376, corresponding to test acc:                         0.9668216109275818 / 0.9705080986022949
after epoch: 12,now: 2024-06-24 16:05:35.512206,epoch time: 0:31:30.039383,used: 5:29:37.826993,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9845578, 'precision': 0.9842334, 'recall': 0.9758249, 'specificity': 0.9758249, 'f1': 0.9799296, 'auroc': 0.997385, 'binary_precision': 0.9835676, 'binary_recall': 0.95736945, 'binary_specificity': 0.99428034, 'binary_f1_score': 0.97029173}
confusion matrix:
       0      1
0  42068    242
1    645  14485
---- Validation: 
scalar performance:
{'acc': 0.9623928, 'precision': 0.70136875, 'recall': 0.7187797, 'specificity': 0.7187797, 'f1': 0.7096681, 'auroc': 0.8732846, 'binary_precision': 0.4207317, 'binary_recall': 0.45847178, 'binary_specificity': 0.97908753, 'binary_f1_score': 0.43879175}
confusion matrix:
       0    1
0  17791  380
1    326  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.7177756, 'recall': 0.6083837, 'specificity': 0.6083837, 'f1': 0.64246255, 'auroc': 0.8383297, 'binary_precision': 0.4661017, 'binary_recall': 0.22727273, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.30555555}
confusion matrix:
      0   1
0  5934  63
1   187  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_13.png
early stop counter: 6
val acc:0.9623928070068359, best validation acc: 0.9662813544273376, corresponding to test acc:                         0.9668216109275818 / 0.9705080986022949
after epoch: 13,now: 2024-06-24 16:34:35.161273,epoch time: 0:28:59.649067,used: 5:58:37.476060,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9856546, 'precision': 0.9829749, 'recall': 0.97996414, 'specificity': 0.97996414, 'f1': 0.98145664, 'auroc': 0.99763584, 'binary_precision': 0.9773728, 'binary_recall': 0.9679403, 'binary_specificity': 0.99198806, 'binary_f1_score': 0.9726337}
confusion matrix:
       0      1
0  41973    339
1    485  14643
---- Validation: 
scalar performance:
{'acc': 0.9635114, 'precision': 0.7102096, 'recall': 0.73140323, 'specificity': 0.73140323, 'f1': 0.7202357, 'auroc': 0.8705689, 'binary_precision': 0.437594, 'binary_recall': 0.4833887, 'binary_specificity': 0.97941774, 'binary_f1_score': 0.4593528}
confusion matrix:
       0    1
0  17797  374
1    311  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.7637279, 'recall': 0.6279793, 'specificity': 0.6279793, 'f1': 0.6698253, 'auroc': 0.8271744, 'binary_precision': 0.5565217, 'binary_recall': 0.2644628, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.35854343}
confusion matrix:
      0   1
0  5946  51
1   178  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_14.png
early stop counter: 7
val acc:0.9635114073753357, best validation acc: 0.9662813544273376, corresponding to test acc:                         0.9668216109275818 / 0.9705080986022949
after epoch: 14,now: 2024-06-24 17:07:07.263299,epoch time: 0:32:32.102026,used: 6:31:09.578086,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.983844, 'precision': 0.98558855, 'recall': 0.9726851, 'specificity': 0.9726851, 'f1': 0.97890484, 'auroc': 0.997635, 'binary_precision': 0.9891162, 'binary_recall': 0.94910437, 'binary_specificity': 0.99626577, 'binary_f1_score': 0.96869737}
confusion matrix:
       0      1
0  42153    158
1    770  14359
---- Validation: 
scalar performance:
{'acc': 0.9667075, 'precision': 0.7289458, 'recall': 0.69531095, 'specificity': 0.69531095, 'f1': 0.7106499, 'auroc': 0.8786795, 'binary_precision': 0.4774951, 'binary_recall': 0.4053156, 'binary_specificity': 0.98530626, 'binary_f1_score': 0.43845463}
confusion matrix:
       0    1
0  17904  267
1    358  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.7961437, 'recall': 0.58064365, 'specificity': 0.58064365, 'f1': 0.62143534, 'auroc': 0.8305985, 'binary_precision': 0.625, 'binary_recall': 0.16528925, 'binary_specificity': 0.995998, 'binary_f1_score': 0.2614379}
confusion matrix:
      0   1
0  5973  24
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_15.png
better model found
persisted
after epoch: 15,now: 2024-06-24 17:32:25.059550,epoch time: 0:25:17.796251,used: 6:56:27.374337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98610723, 'precision': 0.9840554, 'recall': 0.98003983, 'specificity': 0.98003983, 'f1': 0.9820248, 'auroc': 0.99784714, 'binary_precision': 0.9797804, 'binary_recall': 0.96721745, 'binary_specificity': 0.9928622, 'binary_f1_score': 0.97345835}
confusion matrix:
       0      1
0  42008    302
1    496  14634
---- Validation: 
scalar performance:
{'acc': 0.9617003, 'precision': 0.70167434, 'recall': 0.7425134, 'specificity': 0.7425134, 'f1': 0.71997553, 'auroc': 0.88522923, 'binary_precision': 0.41975307, 'binary_recall': 0.50830567, 'binary_specificity': 0.97672117, 'binary_f1_score': 0.45980468}
confusion matrix:
       0    1
0  17748  423
1    296  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95752525, 'precision': 0.6973016, 'recall': 0.62497777, 'specificity': 0.62497777, 'f1': 0.65188587, 'auroc': 0.83125794, 'binary_precision': 0.42384106, 'binary_recall': 0.2644628, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.32569975}
confusion matrix:
      0   1
0  5910  87
1   178  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_16.png
early stop counter: 1
val acc:0.9617003202438354, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 16,now: 2024-06-24 18:03:49.192431,epoch time: 0:31:24.132881,used: 7:27:51.507218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98513234, 'precision': 0.98525655, 'recall': 0.97629845, 'specificity': 0.97629845, 'f1': 0.98066497, 'auroc': 0.9972085, 'binary_precision': 0.9855112, 'binary_recall': 0.95763105, 'binary_specificity': 0.99496585, 'binary_f1_score': 0.9713711}
confusion matrix:
       0      1
0  42098    213
1    641  14488
---- Validation: 
scalar performance:
{'acc': 0.965216, 'precision': 0.71827614, 'recall': 0.70738924, 'specificity': 0.70738924, 'f1': 0.7126775, 'auroc': 0.869091, 'binary_precision': 0.45534152, 'binary_recall': 0.43189368, 'binary_specificity': 0.9828848, 'binary_f1_score': 0.44330776}
confusion matrix:
       0    1
0  17860  311
1    342  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.708962, 'recall': 0.5726944, 'specificity': 0.5726944, 'f1': 0.60391283, 'auroc': 0.8186569, 'binary_precision': 0.4512195, 'binary_recall': 0.15289256, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.22839507}
confusion matrix:
      0   1
0  5952  45
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_17.png
early stop counter: 2
val acc:0.9652159810066223, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 17,now: 2024-06-24 19:17:51.407024,epoch time: 1:14:02.214593,used: 8:41:53.721811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98647285, 'precision': 0.9851866, 'recall': 0.9798422, 'specificity': 0.9798422, 'f1': 0.9824741, 'auroc': 0.9982332, 'binary_precision': 0.9825187, 'binary_recall': 0.9658295, 'binary_specificity': 0.9938549, 'binary_f1_score': 0.9741026}
confusion matrix:
       0      1
0  42050    260
1    517  14613
---- Validation: 
scalar performance:
{'acc': 0.9632984, 'precision': 0.7053269, 'recall': 0.7096108, 'specificity': 0.7096108, 'f1': 0.7074441, 'auroc': 0.8853352, 'binary_precision': 0.4292683, 'binary_recall': 0.4385382, 'binary_specificity': 0.9806835, 'binary_f1_score': 0.43385372}
confusion matrix:
       0    1
0  17820  351
1    338  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.73367715, 'recall': 0.5812924, 'specificity': 0.5812924, 'f1': 0.61658764, 'auroc': 0.8281179, 'binary_precision': 0.5, 'binary_recall': 0.1694215, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.25308642}
confusion matrix:
      0   1
0  5956  41
1   201  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_18.png
early stop counter: 3
val acc:0.9632983803749084, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 18,now: 2024-06-24 19:44:17.520413,epoch time: 0:26:26.113389,used: 9:08:19.835200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9854283, 'precision': 0.9844767, 'recall': 0.97783697, 'specificity': 0.97783697, 'f1': 0.9810946, 'auroc': 0.997635, 'binary_precision': 0.9825118, 'binary_recall': 0.9617952, 'binary_specificity': 0.99387866, 'binary_f1_score': 0.9720431}
confusion matrix:
       0      1
0  42052    259
1    578  14551
---- Validation: 
scalar performance:
{'acc': 0.9638843, 'precision': 0.7087133, 'recall': 0.70670134, 'specificity': 0.70670134, 'f1': 0.70770186, 'auroc': 0.8740454, 'binary_precision': 0.4362416, 'binary_recall': 0.43189368, 'binary_specificity': 0.981509, 'binary_f1_score': 0.43405673}
confusion matrix:
       0    1
0  17835  336
1    342  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.74202204, 'recall': 0.6013699, 'specificity': 0.6013699, 'f1': 0.6397142, 'auroc': 0.8120569, 'binary_precision': 0.5151515, 'binary_recall': 0.2107438, 'binary_specificity': 0.991996, 'binary_f1_score': 0.29912025}
confusion matrix:
      0   1
0  5949  48
1   191  51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_19.png
early stop counter: 4
val acc:0.9638842940330505, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 19,now: 2024-06-24 21:06:10.907856,epoch time: 1:21:53.387443,used: 10:30:13.222643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98642063, 'precision': 0.98440063, 'recall': 0.9805073, 'specificity': 0.9805073, 'f1': 0.9824325, 'auroc': 0.99778175, 'binary_precision': 0.98019004, 'binary_recall': 0.9680106, 'binary_specificity': 0.993004, 'binary_f1_score': 0.9740622}
confusion matrix:
       0      1
0  42014    296
1    484  14646
---- Validation: 
scalar performance:
{'acc': 0.9620199, 'precision': 0.7016393, 'recall': 0.7322389, 'specificity': 0.7322389, 'f1': 0.7157228, 'auroc': 0.886531, 'binary_precision': 0.42037302, 'binary_recall': 0.48671097, 'binary_specificity': 0.97776675, 'binary_f1_score': 0.45111623}
confusion matrix:
       0    1
0  17767  404
1    309  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9570444, 'precision': 0.67989933, 'recall': 0.59102106, 'specificity': 0.59102106, 'f1': 0.6187745, 'auroc': 0.82548696, 'binary_precision': 0.39166668, 'binary_recall': 0.19421488, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.2596685}
confusion matrix:
      0   1
0  5924  73
1   195  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_20.png
early stop counter: 5
val acc:0.9620199203491211, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 20,now: 2024-06-24 21:37:08.176694,epoch time: 0:30:57.268838,used: 11:01:10.491481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9857591, 'precision': 0.98407924, 'recall': 0.9791029, 'specificity': 0.9791029, 'f1': 0.98155606, 'auroc': 0.99757814, 'binary_precision': 0.980591, 'binary_recall': 0.96503633, 'binary_specificity': 0.9931695, 'binary_f1_score': 0.9727515}
confusion matrix:
       0      1
0  42021    289
1    529  14601
---- Validation: 
scalar performance:
{'acc': 0.9632451, 'precision': 0.7084495, 'recall': 0.7304626, 'specificity': 0.7304626, 'f1': 0.71883595, 'auroc': 0.88461435, 'binary_precision': 0.43413174, 'binary_recall': 0.48172757, 'binary_specificity': 0.9791976, 'binary_f1_score': 0.45669287}
confusion matrix:
       0    1
0  17793  378
1    312  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589678, 'precision': 0.7103255, 'recall': 0.62374544, 'specificity': 0.62374544, 'f1': 0.65433943, 'auroc': 0.83088034, 'binary_precision': 0.45, 'binary_recall': 0.2603306, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.32984293}
confusion matrix:
      0   1
0  5920  77
1   179  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_21.png
early stop counter: 6
val acc:0.9632450938224792, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 21,now: 2024-06-24 21:59:56.151025,epoch time: 0:22:47.974331,used: 11:23:58.465812,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98645544, 'precision': 0.98580796, 'recall': 0.97917116, 'specificity': 0.97917116, 'f1': 0.9824276, 'auroc': 0.997867, 'binary_precision': 0.984471, 'binary_recall': 0.9637782, 'binary_specificity': 0.99456406, 'binary_f1_score': 0.9740147}
confusion matrix:
       0      1
0  42081    230
1    548  14581
---- Validation: 
scalar performance:
{'acc': 0.96431047, 'precision': 0.71278226, 'recall': 0.7141489, 'specificity': 0.7141489, 'f1': 0.7134631, 'auroc': 0.88001543, 'binary_precision': 0.4438944, 'binary_recall': 0.44684386, 'binary_specificity': 0.98145396, 'binary_f1_score': 0.44536427}
confusion matrix:
       0    1
0  17834  337
1    333  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95768553, 'precision': 0.68922406, 'recall': 0.5973028, 'specificity': 0.5973028, 'f1': 0.62646616, 'auroc': 0.82608694, 'binary_precision': 0.40983605, 'binary_recall': 0.20661157, 'binary_specificity': 0.987994, 'binary_f1_score': 0.27472526}
confusion matrix:
      0   1
0  5925  72
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_22.png
early stop counter: 7
val acc:0.9643104672431946, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 22,now: 2024-06-24 22:23:04.784139,epoch time: 0:23:08.633114,used: 11:47:07.098926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98615944, 'precision': 0.9874741, 'recall': 0.9767847, 'specificity': 0.9767847, 'f1': 0.9819704, 'auroc': 0.9979801, 'binary_precision': 0.9901525, 'binary_recall': 0.9569729, 'binary_specificity': 0.9965966, 'binary_f1_score': 0.97327995}
confusion matrix:
       0      1
0  42166    144
1    651  14479
---- Validation: 
scalar performance:
{'acc': 0.96612155, 'precision': 0.7195704, 'recall': 0.66047716, 'specificity': 0.66047716, 'f1': 0.68493116, 'auroc': 0.8781357, 'binary_precision': 0.46100917, 'binary_recall': 0.33388704, 'binary_specificity': 0.9870673, 'binary_f1_score': 0.3872832}
confusion matrix:
       0    1
0  17936  235
1    401  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.7183094, 'recall': 0.5493184, 'specificity': 0.5493184, 'f1': 0.57469076, 'auroc': 0.81045604, 'binary_precision': 0.4716981, 'binary_recall': 0.10330579, 'binary_specificity': 0.995331, 'binary_f1_score': 0.16949153}
confusion matrix:
      0   1
0  5969  28
1   217  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_23.png
early stop counter: 8
val acc:0.9661215543746948, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 23,now: 2024-06-24 22:46:48.787923,epoch time: 0:23:44.003784,used: 12:10:51.102710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98539346, 'precision': 0.9825252, 'recall': 0.9797454, 'specificity': 0.9797454, 'f1': 0.9811243, 'auroc': 0.99791384, 'binary_precision': 0.97652394, 'binary_recall': 0.96781015, 'binary_specificity': 0.9916806, 'binary_f1_score': 0.9721475}
confusion matrix:
       0      1
0  41959    352
1    487  14642
---- Validation: 
scalar performance:
{'acc': 0.9618601, 'precision': 0.6978934, 'recall': 0.7168984, 'specificity': 0.7168984, 'f1': 0.706905, 'auroc': 0.87504953, 'binary_precision': 0.41389728, 'binary_recall': 0.4551495, 'binary_specificity': 0.9786473, 'binary_f1_score': 0.4335443}
confusion matrix:
       0    1
0  17783  388
1    328  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9559224, 'precision': 0.6881348, 'recall': 0.63604045, 'specificity': 0.63604045, 'f1': 0.6572763, 'auroc': 0.8248263, 'binary_precision': 0.40462428, 'binary_recall': 0.2892562, 'binary_specificity': 0.98282474, 'binary_f1_score': 0.3373494}
confusion matrix:
      0    1
0  5894  103
1   172   70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_24.png
early stop counter: 9
val acc:0.9618601202964783, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 24,now: 2024-06-24 23:12:29.291938,epoch time: 0:25:40.504015,used: 12:36:31.606725,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9872214, 'precision': 0.9864468, 'recall': 0.9805191, 'specificity': 0.9805191, 'f1': 0.9834336, 'auroc': 0.99780494, 'binary_precision': 0.9848434, 'binary_recall': 0.966356, 'binary_specificity': 0.99468225, 'binary_f1_score': 0.9755121}
confusion matrix:
       0      1
0  42086    225
1    509  14620
---- Validation: 
scalar performance:
{'acc': 0.9618601, 'precision': 0.6983599, 'recall': 0.71930754, 'specificity': 0.71930754, 'f1': 0.70824146, 'auroc': 0.88327, 'binary_precision': 0.41467065, 'binary_recall': 0.4601329, 'binary_specificity': 0.9784822, 'binary_f1_score': 0.43622047}
confusion matrix:
       0    1
0  17780  391
1    325  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7346681, 'recall': 0.607068, 'specificity': 0.607068, 'f1': 0.6443088, 'auroc': 0.8232815, 'binary_precision': 0.5, 'binary_recall': 0.2231405, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.30857143}
confusion matrix:
      0   1
0  5943  54
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_25.png
early stop counter: 10
val acc:0.9618601202964783, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 25,now: 2024-06-24 23:35:06.530148,epoch time: 0:22:37.238210,used: 12:59:08.844935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9869081, 'precision': 0.98605955, 'recall': 0.98009515, 'specificity': 0.98009515, 'f1': 0.98302734, 'auroc': 0.99805725, 'binary_precision': 0.9843034, 'binary_recall': 0.9656973, 'binary_specificity': 0.994493, 'binary_f1_score': 0.9749115}
confusion matrix:
       0      1
0  42077    233
1    519  14611
---- Validation: 
scalar performance:
{'acc': 0.96510947, 'precision': 0.7174805, 'recall': 0.7073342, 'specificity': 0.7073342, 'f1': 0.71227217, 'auroc': 0.88590723, 'binary_precision': 0.4537522, 'binary_recall': 0.43189368, 'binary_specificity': 0.98277473, 'binary_f1_score': 0.44255316}
confusion matrix:
       0    1
0  17858  313
1    342  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.72179866, 'recall': 0.6085505, 'specificity': 0.6085505, 'f1': 0.6434003, 'auroc': 0.8310269, 'binary_precision': 0.47413793, 'binary_recall': 0.22727273, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.3072626}
confusion matrix:
      0   1
0  5936  61
1   187  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_26.png
early stop counter: 11
val acc:0.9651094675064087, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 26,now: 2024-06-24 23:56:29.245167,epoch time: 0:21:22.715019,used: 13:20:31.559954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98642063, 'precision': 0.98574156, 'recall': 0.9791486, 'specificity': 0.9791486, 'f1': 0.9823841, 'auroc': 0.9975313, 'binary_precision': 0.9843391, 'binary_recall': 0.9637806, 'binary_specificity': 0.9945167, 'binary_f1_score': 0.97395146}
confusion matrix:
       0      1
0  42078    232
1    548  14582
---- Validation: 
scalar performance:
{'acc': 0.96526927, 'precision': 0.72128975, 'recall': 0.72909904, 'specificity': 0.72909904, 'f1': 0.7251189, 'auroc': 0.89451706, 'binary_precision': 0.4599359, 'binary_recall': 0.47674417, 'binary_specificity': 0.98145396, 'binary_f1_score': 0.46818924}
confusion matrix:
       0    1
0  17834  337
1    315  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.74938893, 'recall': 0.60756826, 'specificity': 0.60756826, 'f1': 0.647252, 'auroc': 0.83828306, 'binary_precision': 0.5294118, 'binary_recall': 0.2231405, 'binary_specificity': 0.991996, 'binary_f1_score': 0.3139535}
confusion matrix:
      0   1
0  5949  48
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_27.png
early stop counter: 12
val acc:0.9652692675590515, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 27,now: 2024-06-25 00:19:14.950103,epoch time: 0:22:45.704936,used: 13:43:17.264890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9875174, 'precision': 0.9857522, 'recall': 0.9819939, 'specificity': 0.9819939, 'f1': 0.9838531, 'auroc': 0.9981308, 'binary_precision': 0.98207116, 'binary_recall': 0.9703219, 'binary_specificity': 0.99366593, 'binary_f1_score': 0.9761612}
confusion matrix:
       0      1
0  42043    268
1    449  14680
---- Validation: 
scalar performance:
{'acc': 0.9598892, 'precision': 0.691194, 'recall': 0.7359565, 'specificity': 0.7359565, 'f1': 0.71091557, 'auroc': 0.887516, 'binary_precision': 0.39919892, 'binary_recall': 0.49667773, 'binary_specificity': 0.9752353, 'binary_f1_score': 0.44263506}
confusion matrix:
       0    1
0  17721  450
1    303  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572047, 'precision': 0.68761283, 'recall': 0.6049836, 'specificity': 0.6049836, 'f1': 0.6329697, 'auroc': 0.82442045, 'binary_precision': 0.40601504, 'binary_recall': 0.2231405, 'binary_specificity': 0.9868267, 'binary_f1_score': 0.28800002}
confusion matrix:
      0   1
0  5918  79
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_28.png
early stop counter: 13
val acc:0.9598891735076904, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 28,now: 2024-06-25 00:43:28.840489,epoch time: 0:24:13.890386,used: 14:07:31.155276,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9873085, 'precision': 0.9846604, 'recall': 0.982574, 'specificity': 0.982574, 'f1': 0.983611, 'auroc': 0.9981569, 'binary_precision': 0.97910565, 'binary_recall': 0.9725692, 'binary_specificity': 0.99257874, 'binary_f1_score': 0.9758265}
confusion matrix:
       0      1
0  41997    314
1    415  14714
---- Validation: 
scalar performance:
{'acc': 0.9624993, 'precision': 0.7057074, 'recall': 0.740517, 'specificity': 0.740517, 'f1': 0.7215836, 'auroc': 0.892308, 'binary_precision': 0.4279661, 'binary_recall': 0.50332224, 'binary_specificity': 0.97771174, 'binary_f1_score': 0.4625954}
confusion matrix:
       0    1
0  17766  405
1    299  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.72294, 'recall': 0.6164814, 'specificity': 0.6164814, 'f1': 0.6509644, 'auroc': 0.8323361, 'binary_precision': 0.47580644, 'binary_recall': 0.24380165, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.32240438}
confusion matrix:
      0   1
0  5932  65
1   183  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_29.png
early stop counter: 14
val acc:0.9624993205070496, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 29,now: 2024-06-25 01:07:22.026885,epoch time: 0:23:53.186396,used: 14:31:24.341672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98629874, 'precision': 0.9865594, 'recall': 0.97802436, 'specificity': 0.97802436, 'f1': 0.98219, 'auroc': 0.9978099, 'binary_precision': 0.98709416, 'binary_recall': 0.96053934, 'binary_specificity': 0.99550945, 'binary_f1_score': 0.97363573}
confusion matrix:
       0      1
0  42121    190
1    597  14532
---- Validation: 
scalar performance:
{'acc': 0.964417, 'precision': 0.71156645, 'recall': 0.70135516, 'specificity': 0.70135516, 'f1': 0.7063197, 'auroc': 0.88466465, 'binary_precision': 0.44230768, 'binary_recall': 0.4202658, 'binary_specificity': 0.9824445, 'binary_f1_score': 0.4310051}
confusion matrix:
       0    1
0  17852  319
1    349  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.74508953, 'recall': 0.59550506, 'specificity': 0.59550506, 'f1': 0.63391346, 'auroc': 0.8327718, 'binary_precision': 0.5217391, 'binary_recall': 0.1983471, 'binary_specificity': 0.992663, 'binary_f1_score': 0.28742513}
confusion matrix:
      0   1
0  5953  44
1   194  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551150_30.png
early stop counter: 15
val acc:0.9644169807434082, best validation acc: 0.9667075276374817, corresponding to test acc:                         0.9637762308120728 / 0.9705080986022949
after epoch: 30,now: 2024-06-25 01:29:44.311299,epoch time: 0:22:22.284414,used: 14:53:46.626086,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_10_35_57_seed_2_21551150
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:53:46.626086 at 2024-06-25 01:29:44.311299
persisted model performance metric: 

scalar performance:
{'acc': 0.96377623, 'precision': 0.7961437, 'recall': 0.58064365, 'specificity': 0.58064365, 'f1': 0.62143534, 'auroc': 0.8305985, 'binary_precision': 0.625, 'binary_recall': 0.16528925, 'binary_specificity': 0.995998, 'binary_f1_score': 0.2614379}
confusion matrix:
      0   1
0  5973  24
1   202  40
oracle model performance metric: 

scalar performance:
{'acc': 0.9705081, 'precision': 0.84625155, 'recall': 0.69517887, 'specificity': 0.69517887, 'f1': 0.74771714, 'auroc': 0.83656216, 'binary_precision': 0.7164179, 'binary_recall': 0.3966942, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.51063836}
confusion matrix:
      0   1
0  5959  38
1   146  96
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204077 KiB | 640729 KiB |   3464 TiB |   3464 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   3463 TiB |   3463 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204077 KiB | 640729 KiB |   3464 TiB |   3464 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   3463 TiB |   3463 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 632296 KiB |   3447 TiB |   3447 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   3446 TiB |   3446 TiB |
|       from small pool |  35967 KiB |  73944 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1500 MiB |    840 MiB |
|       from large pool | 600064 KiB | 679936 KiB |   1376 MiB |    790 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    124 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  82642 KiB | 218089 KiB |   1239 TiB |   1239 TiB |
|       from large pool |  68480 KiB | 217080 KiB |   1238 TiB |   1238 TiB |
|       from small pool |  14162 KiB |  21751 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    7929    |  306010 K  |  306006 K  |
|       from large pool |      36    |      76    |  124080 K  |  124080 K  |
|       from small pool |    3204    |    7892    |  181929 K  |  181926 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    7929    |  306010 K  |  306006 K  |
|       from large pool |      36    |      76    |  124080 K  |  124080 K  |
|       from small pool |    3204    |    7892    |  181929 K  |  181926 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      84    |      33    |
|       from large pool |      14    |      14    |      22    |       8    |
|       from small pool |      37    |      37    |      62    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      38    |    3604    |  140151 K  |  140151 K  |
|       from large pool |       5    |      13    |   47110 K  |   47110 K  |
|       from small pool |      33    |    3599    |   93040 K  |   93040 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   3464 TiB |   3464 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   3463 TiB |   3463 TiB |
|       from small pool |      0 KiB |  75082 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   3464 TiB |   3464 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   3463 TiB |   3463 TiB |
|       from small pool |      0 KiB |  75082 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   3447 TiB |   3447 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   3446 TiB |   3446 TiB |
|       from small pool |      0 KiB |  73944 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 755712 KiB |   1500 MiB |   1220 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1376 MiB |   1146 MiB |
|       from small pool |  51200 KiB |  75776 KiB |    124 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB |   1239 TiB |   1239 TiB |
|       from large pool |  55040 KiB | 217080 KiB |   1238 TiB |   1238 TiB |
|       from small pool |      0 KiB |  21757 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7929    |  306010 K  |  306010 K  |
|       from large pool |       2    |      76    |  124080 K  |  124080 K  |
|       from small pool |       0    |    7892    |  181929 K  |  181929 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7929    |  306010 K  |  306010 K  |
|       from large pool |       2    |      76    |  124080 K  |  124080 K  |
|       from small pool |       0    |    7892    |  181929 K  |  181929 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      51    |      84    |      49    |
|       from large pool |      10    |      14    |      22    |      12    |
|       from small pool |      25    |      37    |      62    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3604    |  140152 K  |  140152 K  |
|       from large pool |       3    |      13    |   47110 K  |   47110 K  |
|       from small pool |       0    |    3599    |   93041 K  |   93041 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Tue Jun 25 01:31:13 2024]
Finished job 0.
1 of 1 steps (100%) done
