Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun 23 13:13:25 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149

 Experiment start at: 2024-06-23 13:18:59.075613
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7456697, 'precision': 0.73261416, 'recall': 0.51015943, 'specificity': 0.51015943, 'f1': 0.4494088, 'auroc': 0.70916045, 'binary_precision': 0.7193347, 'binary_recall': 0.023508629, 'binary_specificity': 0.9968102, 'binary_f1_score': 0.045529313}
confusion matrix:
       0    1
0  42187  135
1  14372  346
---- Validation: 
scalar performance:
{'acc': 0.9628033, 'precision': 0.4828405, 'recall': 0.49845722, 'specificity': 0.49845722, 'f1': 0.49052462, 'auroc': 0.3909576, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18093  56
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.5970574, 'recall': 0.506579, 'specificity': 0.506579, 'f1': 0.5033573, 'auroc': 0.4874177, 'binary_precision': 0.23529412, 'binary_recall': 0.01532567, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.028776977}
confusion matrix:
      0   1
0  5984  13
1   257   4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-23 13:42:53.735385,epoch time: 0:23:54.659772,used: 0:23:54.659772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.75059605, 'precision': 0.8487443, 'recall': 0.5173019, 'specificity': 0.5173019, 'f1': 0.46201932, 'auroc': 0.85594, 'binary_precision': 0.9488117, 'binary_recall': 0.035265338, 'binary_specificity': 0.99933845, 'binary_f1_score': 0.06800315}
confusion matrix:
       0    1
0  42295   28
1  14198  519
---- Validation: 
scalar performance:
{'acc': 0.96557045, 'precision': 0.482888, 'recall': 0.4998898, 'specificity': 0.4998898, 'f1': 0.49124184, 'auroc': 0.47449037, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  18145  4
1    643  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.5613209, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-23 14:02:53.638513,epoch time: 0:19:59.903128,used: 0:43:54.562900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7863079, 'precision': 0.84697425, 'recall': 0.59154415, 'specificity': 0.59154415, 'f1': 0.59351176, 'auroc': 0.91714823, 'binary_precision': 0.91488665, 'binary_recall': 0.18920755, 'binary_specificity': 0.9938808, 'binary_f1_score': 0.31356648}
confusion matrix:
       0     1
0  42067   259
1  11930  2784
---- Validation: 
scalar performance:
{'acc': 0.96322906, 'precision': 0.48284784, 'recall': 0.4986776, 'specificity': 0.4986776, 'f1': 0.4906351, 'auroc': 0.5201096, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18101  48
1    643   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.5793369, 'recall': 0.5047466, 'specificity': 0.5047466, 'f1': 0.49984017, 'auroc': 0.62573063, 'binary_precision': 0.2, 'binary_recall': 0.011494253, 'binary_specificity': 0.997999, 'binary_f1_score': 0.02173913}
confusion matrix:
      0   1
0  5985  12
1   258   3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_3.png
early stop counter: 1
val acc:0.9632290601730347, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 3,now: 2024-06-23 14:22:30.883341,epoch time: 0:19:37.244828,used: 1:03:31.807728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8295582, 'precision': 0.87913966, 'recall': 0.6770601, 'specificity': 0.6770601, 'f1': 0.7095589, 'auroc': 0.9267076, 'binary_precision': 0.9409998, 'binary_recall': 0.36201155, 'binary_specificity': 0.9921087, 'binary_f1_score': 0.52287}
confusion matrix:
       0     1
0  41991   334
1   9388  5327
---- Validation: 
scalar performance:
{'acc': 0.96104723, 'precision': 0.49361274, 'recall': 0.49904817, 'specificity': 0.49904817, 'f1': 0.49278474, 'auroc': 0.5665016, 'binary_precision': 0.021505376, 'binary_recall': 0.00311042, 'binary_specificity': 0.99498594, 'binary_f1_score': 0.0054347827}
confusion matrix:
       0   1
0  18058  91
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9536593, 'precision': 0.56852835, 'recall': 0.5122408, 'specificity': 0.5122408, 'f1': 0.5142683, 'auroc': 0.6540978, 'binary_precision': 0.17777778, 'binary_recall': 0.03065134, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.052287582}
confusion matrix:
      0   1
0  5960  37
1   253   8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_4.png
early stop counter: 2
val acc:0.9610472321510315, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 4,now: 2024-06-23 14:41:58.699946,epoch time: 0:19:27.816605,used: 1:22:59.624333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8664446, 'precision': 0.898836, 'recall': 0.7511173, 'specificity': 0.7511173, 'f1': 0.7906028, 'auroc': 0.943815, 'binary_precision': 0.94384694, 'binary_recall': 0.5128432, 'binary_specificity': 0.9893914, 'binary_f1_score': 0.66458267}
confusion matrix:
       0     1
0  41875   449
1   7169  7547
---- Validation: 
scalar performance:
{'acc': 0.95769477, 'precision': 0.51714313, 'recall': 0.50481313, 'specificity': 0.50481313, 'f1': 0.5038401, 'auroc': 0.57906127, 'binary_precision': 0.06818182, 'binary_recall': 0.01866252, 'binary_specificity': 0.9909637, 'binary_f1_score': 0.029304031}
confusion matrix:
       0    1
0  17985  164
1    631   12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95238096, 'precision': 0.59999955, 'recall': 0.5280648, 'specificity': 0.5280648, 'f1': 0.53897566, 'auroc': 0.68702424, 'binary_precision': 0.23943663, 'binary_recall': 0.0651341, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.10240964}
confusion matrix:
      0   1
0  5943  54
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_5.png
early stop counter: 3
val acc:0.9576947689056396, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 5,now: 2024-06-23 15:01:17.549030,epoch time: 0:19:18.849084,used: 1:42:18.473417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.88082045, 'precision': 0.9040902, 'recall': 0.78145874, 'specificity': 0.78145874, 'f1': 0.8193004, 'auroc': 0.9478005, 'binary_precision': 0.9381569, 'binary_recall': 0.5761261, 'binary_specificity': 0.98679143, 'binary_f1_score': 0.7138648}
confusion matrix:
       0     1
0  41762   559
1   6239  8480
---- Validation: 
scalar performance:
{'acc': 0.954768, 'precision': 0.52368885, 'recall': 0.5092983, 'specificity': 0.5092983, 'f1': 0.51088965, 'auroc': 0.6107588, 'binary_precision': 0.08097166, 'binary_recall': 0.0311042, 'binary_specificity': 0.98749244, 'binary_f1_score': 0.04494382}
confusion matrix:
       0    1
0  17922  227
1    623   20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480665, 'precision': 0.587862, 'recall': 0.53864, 'specificity': 0.53864, 'f1': 0.55096096, 'auroc': 0.7168344, 'binary_precision': 0.21428572, 'binary_recall': 0.09195402, 'binary_specificity': 0.985326, 'binary_f1_score': 0.12868632}
confusion matrix:
      0   1
0  5909  88
1   237  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_6.png
early stop counter: 4
val acc:0.9547680020332336, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 6,now: 2024-06-23 15:20:25.532830,epoch time: 0:19:07.983800,used: 2:01:26.457217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8930049, 'precision': 0.9105457, 'recall': 0.8063027, 'specificity': 0.8063027, 'f1': 0.8416706, 'auroc': 0.954762, 'binary_precision': 0.93733495, 'binary_recall': 0.62718314, 'binary_specificity': 0.9854223, 'binary_f1_score': 0.75151664}
confusion matrix:
       0     1
0  41708   617
1   5486  9229
---- Validation: 
scalar performance:
{'acc': 0.95349085, 'precision': 0.5455246, 'recall': 0.5221381, 'specificity': 0.5221381, 'f1': 0.5280712, 'auroc': 0.6001246, 'binary_precision': 0.1237785, 'binary_recall': 0.05909798, 'binary_specificity': 0.98517823, 'binary_f1_score': 0.08}
confusion matrix:
       0    1
0  17880  269
1    605   38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.950783, 'precision': 0.6214095, 'recall': 0.5510514, 'specificity': 0.5510514, 'f1': 0.56884474, 'auroc': 0.7005407, 'binary_precision': 0.28037384, 'binary_recall': 0.11494253, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.16304348}
confusion matrix:
      0   1
0  5920  77
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_7.png
early stop counter: 5
val acc:0.9534908533096313, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 7,now: 2024-06-23 15:41:04.126188,epoch time: 0:20:38.593358,used: 2:22:05.050575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9033836, 'precision': 0.91629994, 'recall': 0.82749337, 'specificity': 0.82749337, 'f1': 0.8598474, 'auroc': 0.95696247, 'binary_precision': 0.9367822, 'binary_recall': 0.67072177, 'binary_specificity': 0.98426497, 'binary_f1_score': 0.781734}
confusion matrix:
       0     1
0  41660   666
1   4845  9869
---- Validation: 
scalar performance:
{'acc': 0.95077693, 'precision': 0.56229967, 'recall': 0.5402345, 'specificity': 0.5402345, 'f1': 0.54811823, 'auroc': 0.6655529, 'binary_precision': 0.15609756, 'binary_recall': 0.09953344, 'binary_specificity': 0.9809356, 'binary_f1_score': 0.12155745}
confusion matrix:
       0    1
0  17803  346
1    579   64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9472675, 'precision': 0.63311565, 'recall': 0.58952844, 'specificity': 0.58952844, 'f1': 0.606159, 'auroc': 0.7468802, 'binary_precision': 0.30057803, 'binary_recall': 0.19923371, 'binary_specificity': 0.97982323, 'binary_f1_score': 0.23963133}
confusion matrix:
      0    1
0  5876  121
1   209   52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_8.png
early stop counter: 6
val acc:0.9507769346237183, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 8,now: 2024-06-23 15:59:55.700372,epoch time: 0:18:51.574184,used: 2:40:56.624759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.90880084, 'precision': 0.9174405, 'recall': 0.84000677, 'specificity': 0.84000677, 'f1': 0.86952233, 'auroc': 0.9587516, 'binary_precision': 0.93152547, 'binary_recall': 0.69785297, 'binary_specificity': 0.98216057, 'binary_f1_score': 0.79793346}
confusion matrix:
       0      1
0  41567    755
1   4447  10271
---- Validation: 
scalar performance:
{'acc': 0.94960624, 'precision': 0.55223536, 'recall': 0.53437805, 'specificity': 0.53437805, 'f1': 0.5407585, 'auroc': 0.63334334, 'binary_precision': 0.13636364, 'binary_recall': 0.08864697, 'binary_specificity': 0.9801091, 'binary_f1_score': 0.10744581}
confusion matrix:
       0    1
0  17788  361
1    586   57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94550973, 'precision': 0.61605746, 'recall': 0.57761735, 'specificity': 0.57761735, 'f1': 0.5921249, 'auroc': 0.72597027, 'binary_precision': 0.26744187, 'binary_recall': 0.17624521, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.21247114}
confusion matrix:
      0    1
0  5871  126
1   215   46
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_9.png
early stop counter: 7
val acc:0.9496062397956848, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 9,now: 2024-06-23 16:18:47.354525,epoch time: 0:18:51.654153,used: 2:59:48.278912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.90748596, 'precision': 0.9199963, 'recall': 0.83495617, 'specificity': 0.83495617, 'f1': 0.86652267, 'auroc': 0.9622812, 'binary_precision': 0.9400466, 'binary_recall': 0.68510467, 'binary_specificity': 0.98480767, 'binary_f1_score': 0.79257894}
confusion matrix:
       0      1
0  41681    643
1   4634  10082
---- Validation: 
scalar performance:
{'acc': 0.9516283, 'precision': 0.5663608, 'recall': 0.54142535, 'specificity': 0.54142535, 'f1': 0.55012345, 'auroc': 0.6679195, 'binary_precision': 0.16414142, 'binary_recall': 0.10108865, 'binary_specificity': 0.98176205, 'binary_f1_score': 0.12512031}
confusion matrix:
       0    1
0  17818  331
1    578   65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949185, 'precision': 0.62465304, 'recall': 0.5648763, 'specificity': 0.5648763, 'f1': 0.58333004, 'auroc': 0.7439326, 'binary_precision': 0.2857143, 'binary_recall': 0.14559387, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.1928934}
confusion matrix:
      0   1
0  5902  95
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_10.png
early stop counter: 8
val acc:0.9516283273696899, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 10,now: 2024-06-23 16:37:34.832217,epoch time: 0:18:47.477692,used: 3:18:35.756604,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91837305, 'precision': 0.9230679, 'recall': 0.8596374, 'specificity': 0.8596374, 'f1': 0.8852185, 'auroc': 0.9658936, 'binary_precision': 0.9310138, 'binary_recall': 0.73829424, 'binary_specificity': 0.9809805, 'binary_f1_score': 0.8235294}
confusion matrix:
       0      1
0  41520    805
1   3851  10864
---- Validation: 
scalar performance:
{'acc': 0.94423157, 'precision': 0.57861316, 'recall': 0.578849, 'specificity': 0.578849, 'f1': 0.5787308, 'auroc': 0.685308, 'binary_precision': 0.18604651, 'binary_recall': 0.1866252, 'binary_specificity': 0.9710728, 'binary_f1_score': 0.1863354}
confusion matrix:
       0    1
0  17624  525
1    523  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94247365, 'precision': 0.61692935, 'recall': 0.5961889, 'specificity': 0.5961889, 'f1': 0.60530543, 'auroc': 0.74323237, 'binary_precision': 0.26760563, 'binary_recall': 0.21839081, 'binary_specificity': 0.973987, 'binary_f1_score': 0.24050634}
confusion matrix:
      0    1
0  5841  156
1   204   57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_11.png
early stop counter: 9
val acc:0.9442315697669983, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 11,now: 2024-06-23 16:56:13.466551,epoch time: 0:18:38.634334,used: 3:37:14.390938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9218443, 'precision': 0.92758286, 'recall': 0.86482203, 'specificity': 0.86482203, 'f1': 0.8902739, 'auroc': 0.9679501, 'binary_precision': 0.9373295, 'binary_recall': 0.74701005, 'binary_specificity': 0.98263395, 'binary_f1_score': 0.8314173}
confusion matrix:
       0      1
0  41589    735
1   3723  10993
---- Validation: 
scalar performance:
{'acc': 0.94886124, 'precision': 0.5816679, 'recall': 0.5662447, 'specificity': 0.5662447, 'f1': 0.57294047, 'auroc': 0.7090427, 'binary_precision': 0.19305019, 'binary_recall': 0.15552099, 'binary_specificity': 0.9769684, 'binary_f1_score': 0.17226529}
confusion matrix:
       0    1
0  17731  418
1    543  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95126235, 'precision': 0.67729455, 'recall': 0.6319242, 'specificity': 0.6319242, 'f1': 0.65071344, 'auroc': 0.77239, 'binary_precision': 0.38541666, 'binary_recall': 0.2835249, 'binary_specificity': 0.9803235, 'binary_f1_score': 0.32671082}
confusion matrix:
      0    1
0  5879  118
1   187   74
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_12.png
early stop counter: 10
val acc:0.9488612413406372, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 12,now: 2024-06-23 17:15:14.453397,epoch time: 0:19:00.986846,used: 3:56:15.377784,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92314166, 'precision': 0.9277015, 'recall': 0.86800116, 'specificity': 0.86800116, 'f1': 0.8924749, 'auroc': 0.96738696, 'binary_precision': 0.9355084, 'binary_recall': 0.7540772, 'binary_specificity': 0.98192513, 'binary_f1_score': 0.83505154}
confusion matrix:
       0      1
0  41559    765
1   3619  11097
---- Validation: 
scalar performance:
{'acc': 0.945828, 'precision': 0.60299623, 'recall': 0.61192787, 'specificity': 0.61192787, 'f1': 0.60723454, 'auroc': 0.69636005, 'binary_precision': 0.23252496, 'binary_recall': 0.2534992, 'binary_specificity': 0.97035646, 'binary_f1_score': 0.24255951}
confusion matrix:
       0    1
0  17611  538
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9504634, 'precision': 0.6744611, 'recall': 0.6370043, 'specificity': 0.6370043, 'f1': 0.6530874, 'auroc': 0.77134913, 'binary_precision': 0.37931034, 'binary_recall': 0.29501915, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.33189654}
confusion matrix:
      0    1
0  5871  126
1   184   77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_13.png
early stop counter: 11
val acc:0.9458280205726624, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 13,now: 2024-06-23 17:33:56.454392,epoch time: 0:18:42.000995,used: 4:14:57.378779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9301718, 'precision': 0.92862964, 'recall': 0.88535774, 'specificity': 0.88535774, 'f1': 0.9041337, 'auroc': 0.97190464, 'binary_precision': 0.92586714, 'binary_recall': 0.79278237, 'binary_specificity': 0.97793317, 'binary_f1_score': 0.854172}
confusion matrix:
       0      1
0  41392    934
1   3049  11665
---- Validation: 
scalar performance:
{'acc': 0.93917626, 'precision': 0.592105, 'recall': 0.62198514, 'specificity': 0.62198514, 'f1': 0.60442555, 'auroc': 0.7184682, 'binary_precision': 0.20997679, 'binary_recall': 0.281493, 'binary_specificity': 0.96247727, 'binary_f1_score': 0.24053156}
confusion matrix:
       0    1
0  17468  681
1    462  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9402365, 'precision': 0.6338601, 'recall': 0.6426623, 'specificity': 0.6426623, 'f1': 0.6380891, 'auroc': 0.76849216, 'binary_precision': 0.29749104, 'binary_recall': 0.31800765, 'binary_specificity': 0.967317, 'binary_f1_score': 0.3074074}
confusion matrix:
      0    1
0  5801  196
1   178   83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_14.png
early stop counter: 12
val acc:0.9391762614250183, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 14,now: 2024-06-23 17:52:36.897363,epoch time: 0:18:40.442971,used: 4:33:37.821750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9228787, 'precision': 0.93333566, 'recall': 0.8630146, 'specificity': 0.8630146, 'f1': 0.8909013, 'auroc': 0.9728806, 'binary_precision': 0.95079964, 'binary_recall': 0.73933136, 'binary_specificity': 0.98669785, 'binary_f1_score': 0.83183616}
confusion matrix:
       0      1
0  41761    563
1   3836  10880
---- Validation: 
scalar performance:
{'acc': 0.9520541, 'precision': 0.5924154, 'recall': 0.56564754, 'specificity': 0.56564754, 'f1': 0.5762383, 'auroc': 0.70848674, 'binary_precision': 0.21460177, 'binary_recall': 0.15085536, 'binary_specificity': 0.9804397, 'binary_f1_score': 0.17716895}
confusion matrix:
       0    1
0  17794  355
1    546   97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9506232, 'precision': 0.6412163, 'recall': 0.572956, 'specificity': 0.572956, 'f1': 0.5941258, 'auroc': 0.7598921, 'binary_precision': 0.3181818, 'binary_recall': 0.16091955, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.21374045}
confusion matrix:
      0   1
0  5907  90
1   219  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_15.png
early stop counter: 13
val acc:0.9520540833473206, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 15,now: 2024-06-23 18:11:12.801289,epoch time: 0:18:35.903926,used: 4:52:13.725676,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9318023, 'precision': 0.9363134, 'recall': 0.88288736, 'specificity': 0.88288736, 'f1': 0.90538013, 'auroc': 0.9737624, 'binary_precision': 0.9441891, 'binary_recall': 0.78184044, 'binary_specificity': 0.9839342, 'binary_f1_score': 0.8553796}
confusion matrix:
       0      1
0  41646    680
1   3210  11504
---- Validation: 
scalar performance:
{'acc': 0.9498191, 'precision': 0.60047466, 'recall': 0.5869921, 'specificity': 0.5869921, 'f1': 0.59314066, 'auroc': 0.7078031, 'binary_precision': 0.22924188, 'binary_recall': 0.19751166, 'binary_specificity': 0.97647256, 'binary_f1_score': 0.21219715}
confusion matrix:
       0    1
0  17722  427
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9475871, 'precision': 0.6515504, 'recall': 0.6190126, 'specificity': 0.6190126, 'f1': 0.632944, 'auroc': 0.7534195, 'binary_precision': 0.33497536, 'binary_recall': 0.2605364, 'binary_specificity': 0.97748876, 'binary_f1_score': 0.29310343}
confusion matrix:
      0    1
0  5862  135
1   193   68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_16.png
early stop counter: 14
val acc:0.9498190879821777, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 16,now: 2024-06-23 18:30:04.538242,epoch time: 0:18:51.736953,used: 5:11:05.462629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9391655, 'precision': 0.9382989, 'recall': 0.90018165, 'specificity': 0.90018165, 'f1': 0.91707116, 'auroc': 0.97574914, 'binary_precision': 0.9367187, 'binary_recall': 0.8196209, 'binary_specificity': 0.9807424, 'binary_f1_score': 0.8742663}
confusion matrix:
       0      1
0  41506    815
1   2655  12064
---- Validation: 
scalar performance:
{'acc': 0.9441784, 'precision': 0.6046509, 'recall': 0.6238248, 'specificity': 0.6238248, 'f1': 0.6132512, 'auroc': 0.7215432, 'binary_precision': 0.23498695, 'binary_recall': 0.2799378, 'binary_specificity': 0.96771175, 'binary_f1_score': 0.25550035}
confusion matrix:
       0    1
0  17563  586
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94151485, 'precision': 0.6421115, 'recall': 0.652491, 'specificity': 0.652491, 'f1': 0.6470785, 'auroc': 0.77148217, 'binary_precision': 0.31316727, 'binary_recall': 0.33716476, 'binary_specificity': 0.96781725, 'binary_f1_score': 0.32472324}
confusion matrix:
      0    1
0  5804  193
1   173   88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_17.png
early stop counter: 15
val acc:0.9441784024238586, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 17,now: 2024-06-23 18:49:54.323010,epoch time: 0:19:49.784768,used: 5:30:55.247397,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9437588, 'precision': 0.9392005, 'recall': 0.91154814, 'specificity': 0.91154814, 'f1': 0.9242227, 'auroc': 0.97888255, 'binary_precision': 0.9306242, 'binary_recall': 0.84499866, 'binary_specificity': 0.97809756, 'binary_f1_score': 0.88574684}
confusion matrix:
       0      1
0  41397    927
1   2281  12435
---- Validation: 
scalar performance:
{'acc': 0.9384845, 'precision': 0.6086595, 'recall': 0.66363007, 'specificity': 0.66363007, 'f1': 0.62932265, 'auroc': 0.7363864, 'binary_precision': 0.24012157, 'binary_recall': 0.36858475, 'binary_specificity': 0.9586754, 'binary_f1_score': 0.29079753}
confusion matrix:
       0    1
0  17399  750
1    406  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9443912, 'precision': 0.6576029, 'recall': 0.6668181, 'specificity': 0.6668181, 'f1': 0.66205335, 'auroc': 0.784734, 'binary_precision': 0.3429603, 'binary_recall': 0.36398467, 'binary_specificity': 0.9696515, 'binary_f1_score': 0.35315987}
confusion matrix:
      0    1
0  5815  182
1   166   95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_18.png
early stop counter: 16
val acc:0.9384844899177551, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 18,now: 2024-06-23 19:08:59.097247,epoch time: 0:19:04.774237,used: 5:50:00.021634,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9384642, 'precision': 0.9393342, 'recall': 0.89738643, 'specificity': 0.89738643, 'f1': 0.9157525, 'auroc': 0.97823894, 'binary_precision': 0.94090337, 'binary_recall': 0.812517, 'binary_specificity': 0.98225594, 'binary_f1_score': 0.87200993}
confusion matrix:
       0      1
0  41573    751
1   2759  11957
---- Validation: 
scalar performance:
{'acc': 0.94886124, 'precision': 0.618077, 'recall': 0.62249887, 'specificity': 0.62249887, 'f1': 0.62023914, 'auroc': 0.73962003, 'binary_precision': 0.26197603, 'binary_recall': 0.27216175, 'binary_specificity': 0.97283596, 'binary_f1_score': 0.2669718}
confusion matrix:
       0    1
0  17656  493
1    468  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9488655, 'precision': 0.665532, 'recall': 0.63617057, 'specificity': 0.63617057, 'f1': 0.64916044, 'auroc': 0.7736621, 'binary_precision': 0.36150235, 'binary_recall': 0.29501915, 'binary_specificity': 0.977322, 'binary_f1_score': 0.32489452}
confusion matrix:
      0    1
0  5861  136
1   184   77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_19.png
early stop counter: 17
val acc:0.9488612413406372, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 19,now: 2024-06-23 19:27:35.176149,epoch time: 0:18:36.078902,used: 6:08:36.100536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9438639, 'precision': 0.9379975, 'recall': 0.91304505, 'specificity': 0.91304505, 'f1': 0.9245775, 'auroc': 0.9798125, 'binary_precision': 0.9268709, 'binary_recall': 0.8493849, 'binary_specificity': 0.9767052, 'binary_f1_score': 0.8864378}
confusion matrix:
       0      1
0  41341    986
1   2216  12497
---- Validation: 
scalar performance:
{'acc': 0.9371009, 'precision': 0.61006486, 'recall': 0.67491466, 'specificity': 0.67491466, 'f1': 0.63341725, 'auroc': 0.76032126, 'binary_precision': 0.24210526, 'binary_recall': 0.3934681, 'binary_specificity': 0.95636123, 'binary_f1_score': 0.29976302}
confusion matrix:
       0    1
0  17357  792
1    390  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9400767, 'precision': 0.65424275, 'recall': 0.6993813, 'specificity': 0.6993813, 'f1': 0.67331564, 'auroc': 0.80004114, 'binary_precision': 0.33333334, 'binary_recall': 0.43678162, 'binary_specificity': 0.961981, 'binary_f1_score': 0.37810948}
confusion matrix:
      0    1
0  5769  228
1   147  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_20.png
early stop counter: 18
val acc:0.937100887298584, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 20,now: 2024-06-23 19:46:28.337963,epoch time: 0:18:53.161814,used: 6:27:29.262350,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.94985974, 'precision': 0.9428257, 'recall': 0.9244982, 'specificity': 0.9244982, 'f1': 0.93315566, 'auroc': 0.9819806, 'binary_precision': 0.9291869, 'binary_recall': 0.8721033, 'binary_specificity': 0.97689307, 'binary_f1_score': 0.8997406}
confusion matrix:
       0      1
0  41347    978
1   1882  12833
---- Validation: 
scalar performance:
{'acc': 0.9431673, 'precision': 0.62302816, 'recall': 0.67280495, 'specificity': 0.67280495, 'f1': 0.6428688, 'auroc': 0.7494453, 'binary_precision': 0.26826608, 'binary_recall': 0.38258165, 'binary_specificity': 0.96302825, 'binary_f1_score': 0.3153846}
confusion matrix:
       0    1
0  17478  671
1    397  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9487057, 'precision': 0.6847124, 'recall': 0.7002189, 'specificity': 0.7002189, 'f1': 0.6920972, 'auroc': 0.8022747, 'binary_precision': 0.3943662, 'binary_recall': 0.42911878, 'binary_specificity': 0.971319, 'binary_f1_score': 0.41100916}
confusion matrix:
      0    1
0  5825  172
1   149  112
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_21.png
early stop counter: 19
val acc:0.9431673288345337, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 21,now: 2024-06-23 20:05:15.630412,epoch time: 0:18:47.292449,used: 6:46:16.554799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9437588, 'precision': 0.94427764, 'recall': 0.9067055, 'specificity': 0.9067055, 'f1': 0.9234195, 'auroc': 0.9788445, 'binary_precision': 0.94522667, 'binary_recall': 0.83013994, 'binary_specificity': 0.9832711, 'binary_f1_score': 0.88395315}
confusion matrix:
       0      1
0  41614    708
1   2500  12218
---- Validation: 
scalar performance:
{'acc': 0.95035124, 'precision': 0.63464516, 'recall': 0.6465219, 'specificity': 0.6465219, 'f1': 0.6402869, 'auroc': 0.72222185, 'binary_precision': 0.2934473, 'binary_recall': 0.32037324, 'binary_specificity': 0.9726707, 'binary_f1_score': 0.30631968}
confusion matrix:
       0    1
0  17653  496
1    437  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549377, 'precision': 0.7117045, 'recall': 0.6741532, 'specificity': 0.6741532, 'f1': 0.6908226, 'auroc': 0.7809882, 'binary_precision': 0.45070422, 'binary_recall': 0.3678161, 'binary_specificity': 0.98049027, 'binary_f1_score': 0.4050633}
confusion matrix:
      0    1
0  5880  117
1   165   96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_22.png
early stop counter: 20
val acc:0.9503512382507324, best validation acc: 0.9655704498291016, corresponding to test acc:                         0.9581335783004761 / 0.9581335783004761
after epoch: 22,now: 2024-06-23 20:24:06.066676,epoch time: 0:18:50.436264,used: 7:05:06.991063,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_59_seed_0_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 22 with time: 7:05:06.991063 at 2024-06-23 20:24:06.066676
persisted model performance metric: 

scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.5613209, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.5613209, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 640729 KiB |    845 TiB |    845 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    845 TiB |    845 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 640729 KiB |    845 TiB |    845 TiB |
|       from large pool | 167936 KiB | 568000 KiB |    845 TiB |    845 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 632296 KiB |    843 TiB |    843 TiB |
|       from large pool | 165120 KiB | 560704 KiB |    843 TiB |    843 TiB |
|       from small pool |  35968 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB | 755712 KiB | 755712 KiB |      0 B   |
|       from large pool | 679936 KiB | 679936 KiB | 679936 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  79692 KiB | 217798 KiB | 341510 GiB | 341510 GiB |
|       from large pool |  67584 KiB | 213792 KiB | 341227 GiB | 341227 GiB |
|       from small pool |  12108 KiB |  13958 KiB |    282 GiB |    282 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    7879    |   74889 K  |   74886 K  |
|       from large pool |      36    |      76    |   30368 K  |   30368 K  |
|       from small pool |    3216    |    7842    |   44520 K  |   44517 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    7879    |   74889 K  |   74886 K  |
|       from large pool |      36    |      76    |   30368 K  |   30368 K  |
|       from small pool |    3216    |    7842    |   44520 K  |   44517 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3581    |   33656 K  |   33656 K  |
|       from large pool |       7    |      11    |   10860 K  |   10860 K  |
|       from small pool |      30    |    3574    |   22796 K  |   22796 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    845 TiB |    845 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    845 TiB |    845 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    845 TiB |    845 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    845 TiB |    845 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    843 TiB |    843 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    843 TiB |    843 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 217798 KiB | 341510 GiB | 341510 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 341227 GiB | 341227 GiB |
|       from small pool |      0 KiB |  19703 KiB |    282 GiB |    282 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |   74889 K  |   74889 K  |
|       from large pool |       2    |      76    |   30368 K  |   30368 K  |
|       from small pool |       0    |    7842    |   44520 K  |   44520 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |   74889 K  |   74889 K  |
|       from large pool |       2    |      76    |   30368 K  |   30368 K  |
|       from small pool |       0    |    7842    |   44520 K  |   44520 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   33658 K  |   33658 K  |
|       from large pool |       3    |      13    |   10860 K  |   10860 K  |
|       from small pool |       0    |    3574    |   22797 K  |   22797 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |    845 TiB |    845 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    845 TiB |    845 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |    845 TiB |    845 TiB |
|       from large pool |  16640 KiB | 568000 KiB |    845 TiB |    845 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |    843 TiB |    843 TiB |
|       from large pool |  16640 KiB | 560704 KiB |    843 TiB |    843 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB | 755712 KiB | 471040 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  49152 KiB |  75776 KiB |  75776 KiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 217798 KiB | 341510 GiB | 341510 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 341227 GiB | 341227 GiB |
|       from small pool |      0 KiB |  19703 KiB |    282 GiB |    282 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |   74889 K  |   74889 K  |
|       from large pool |       2    |      76    |   30368 K  |   30368 K  |
|       from small pool |       0    |    7842    |   44520 K  |   44520 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |   74889 K  |   74889 K  |
|       from large pool |       2    |      76    |   30368 K  |   30368 K  |
|       from small pool |       0    |    7842    |   44520 K  |   44520 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      51    |      17    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      24    |      37    |      37    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   33658 K  |   33658 K  |
|       from large pool |       3    |      13    |   10860 K  |   10860 K  |
|       from small pool |       0    |    3574    |   22797 K  |   22797 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149

 Experiment start at: 2024-06-23 20:31:54.448502
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.74765974, 'precision': 0.6799662, 'recall': 0.5058175, 'specificity': 0.5058175, 'f1': 0.44198358, 'auroc': 0.6529584, 'binary_precision': 0.61142856, 'binary_recall': 0.014841529, 'binary_specificity': 0.99679345, 'binary_f1_score': 0.028979618}
confusion matrix:
       0    1
0  42277  136
1  14205  214
---- Validation: 
scalar performance:
{'acc': 0.9522945, 'precision': 0.48409665, 'recall': 0.49459913, 'specificity': 0.49459913, 'f1': 0.4888976, 'auroc': 0.34540284, 'binary_precision': 0.004484305, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9877124, 'binary_f1_score': 0.002232143}
confusion matrix:
       0    1
0  17845  222
1    672    1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95198196, 'precision': 0.49149773, 'recall': 0.49864358, 'specificity': 0.49864358, 'f1': 0.49103147, 'auroc': 0.26575395, 'binary_precision': 0.025, 'binary_recall': 0.0038461538, 'binary_specificity': 0.993441, 'binary_f1_score': 0.006666667}
confusion matrix:
      0   1
0  5907  39
1   259   1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-23 20:51:25.970443,epoch time: 0:19:31.521941,used: 0:19:31.521941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.751742, 'precision': 0.782295, 'recall': 0.5128217, 'specificity': 0.5128217, 'f1': 0.4554571, 'auroc': 0.8067514, 'binary_precision': 0.81338745, 'binary_recall': 0.027812457, 'binary_specificity': 0.9978309, 'binary_f1_score': 0.053785797}
confusion matrix:
       0    1
0  42322   92
1  14017  401
---- Validation: 
scalar performance:
{'acc': 0.96152616, 'precision': 0.48199764, 'recall': 0.49867162, 'specificity': 0.49867162, 'f1': 0.4901929, 'auroc': 0.37330064, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99734324, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18019  48
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3123724, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-23 21:11:13.846858,epoch time: 0:19:47.876415,used: 0:39:19.398356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7859129, 'precision': 0.8551633, 'recall': 0.58218825, 'specificity': 0.58218825, 'f1': 0.5798031, 'auroc': 0.8861754, 'binary_precision': 0.93141764, 'binary_recall': 0.16859698, 'binary_specificity': 0.9957796, 'binary_f1_score': 0.28551292}
confusion matrix:
       0     1
0  42234   179
1  11988  2431
---- Validation: 
scalar performance:
{'acc': 0.9610459, 'precision': 0.48198897, 'recall': 0.49842253, 'specificity': 0.49842253, 'f1': 0.49006802, 'auroc': 0.42390606, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99684507, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18010  57
1    673   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.4790424, 'recall': 0.49974772, 'specificity': 0.49974772, 'f1': 0.48917606, 'auroc': 0.44149414, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5943  3
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_3.png
early stop counter: 1
val acc:0.9610459208488464, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 3,now: 2024-06-23 21:31:40.850263,epoch time: 0:20:27.003405,used: 0:59:46.401761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.83273506, 'precision': 0.87788165, 'recall': 0.67890155, 'specificity': 0.67890155, 'f1': 0.71248573, 'auroc': 0.9123709, 'binary_precision': 0.9342524, 'binary_recall': 0.3665742, 'binary_specificity': 0.9912289, 'binary_f1_score': 0.5265465}
confusion matrix:
       0     1
0  42040   372
1   9134  5286
---- Validation: 
scalar performance:
{'acc': 0.9569904, 'precision': 0.48564404, 'recall': 0.49703452, 'specificity': 0.49703452, 'f1': 0.4902483, 'auroc': 0.4761272, 'binary_precision': 0.0074074073, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99258316, 'binary_f1_score': 0.0024752475}
confusion matrix:
       0    1
0  17933  134
1    672    1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.47903225, 'recall': 0.49949545, 'specificity': 0.49949545, 'f1': 0.4890499, 'auroc': 0.48188955, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5940  6
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_4.png
early stop counter: 2
val acc:0.9569904208183289, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 4,now: 2024-06-23 21:51:34.467197,epoch time: 0:19:53.616934,used: 1:19:40.018695,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.85124576, 'precision': 0.8872987, 'recall': 0.71705675, 'specificity': 0.71705675, 'f1': 0.75557274, 'auroc': 0.9272244, 'binary_precision': 0.93482065, 'binary_recall': 0.44465253, 'binary_specificity': 0.989461, 'binary_f1_score': 0.6026509}
confusion matrix:
       0     1
0  41967   447
1   8007  6411
---- Validation: 
scalar performance:
{'acc': 0.9554429, 'precision': 0.4849609, 'recall': 0.49623194, 'specificity': 0.49623194, 'f1': 0.48980102, 'auroc': 0.52062434, 'binary_precision': 0.0060975607, 'binary_recall': 0.0014858841, 'binary_specificity': 0.990978, 'binary_f1_score': 0.002389486}
confusion matrix:
       0    1
0  17904  163
1    672    1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.47900516, 'recall': 0.49882275, 'specificity': 0.49882275, 'f1': 0.48871315, 'auroc': 0.5975938, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5932  14
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_5.png
early stop counter: 3
val acc:0.9554429054260254, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 5,now: 2024-06-23 22:13:59.196580,epoch time: 0:22:24.729383,used: 1:42:04.748078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8713401, 'precision': 0.89659536, 'recall': 0.7592009, 'specificity': 0.7592009, 'f1': 0.7983507, 'auroc': 0.937163, 'binary_precision': 0.9321333, 'binary_recall': 0.5315578, 'binary_specificity': 0.98684394, 'binary_f1_score': 0.6770318}
confusion matrix:
       0     1
0  41856   558
1   6754  7664
---- Validation: 
scalar performance:
{'acc': 0.9522945, 'precision': 0.48851252, 'recall': 0.49602968, 'specificity': 0.49602968, 'f1': 0.49111354, 'auroc': 0.5608623, 'binary_precision': 0.013215859, 'binary_recall': 0.004457652, 'binary_specificity': 0.9876017, 'binary_f1_score': 0.006666667}
confusion matrix:
       0    1
0  17843  224
1    670    3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95343214, 'precision': 0.4789542, 'recall': 0.4975614, 'specificity': 0.4975614, 'f1': 0.4880805, 'auroc': 0.6473385, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5917  29
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_6.png
early stop counter: 4
val acc:0.9522945284843445, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 6,now: 2024-06-23 22:35:38.190753,epoch time: 0:21:38.994173,used: 2:03:43.742251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.89474237, 'precision': 0.90822256, 'recall': 0.8085867, 'specificity': 0.8085867, 'f1': 0.8432369, 'auroc': 0.9474212, 'binary_precision': 0.9288401, 'binary_recall': 0.6336778, 'binary_specificity': 0.98349565, 'binary_f1_score': 0.7533806}
confusion matrix:
       0     1
0  41713   700
1   5282  9137
---- Validation: 
scalar performance:
{'acc': 0.9471718, 'precision': 0.5139953, 'recall': 0.5076782, 'specificity': 0.5076782, 'f1': 0.5086183, 'auroc': 0.61293006, 'binary_precision': 0.063360885, 'binary_recall': 0.034175333, 'binary_specificity': 0.98118114, 'binary_f1_score': 0.04440154}
confusion matrix:
       0    1
0  17727  340
1    650   23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94505316, 'precision': 0.5015466, 'recall': 0.50054467, 'specificity': 0.50054467, 'f1': 0.49732718, 'auroc': 0.70111793, 'binary_precision': 0.04494382, 'binary_recall': 0.015384615, 'binary_specificity': 0.98570466, 'binary_f1_score': 0.022922637}
confusion matrix:
      0   1
0  5861  85
1   256   4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_7.png
early stop counter: 5
val acc:0.9471718072891235, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 7,now: 2024-06-23 22:55:18.500977,epoch time: 0:19:40.310224,used: 2:23:24.052475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.90162235, 'precision': 0.9071391, 'recall': 0.82653964, 'specificity': 0.82653964, 'f1': 0.85677826, 'auroc': 0.94535935, 'binary_precision': 0.9159442, 'binary_recall': 0.67411053, 'binary_specificity': 0.97896874, 'binary_f1_score': 0.7766369}
confusion matrix:
       0     1
0  41521   892
1   4699  9720
---- Validation: 
scalar performance:
{'acc': 0.94050163, 'precision': 0.52010155, 'recall': 0.51566315, 'specificity': 0.51566315, 'f1': 0.517327, 'auroc': 0.5743613, 'binary_precision': 0.075, 'binary_recall': 0.05794948, 'binary_specificity': 0.97337687, 'binary_f1_score': 0.065381385}
confusion matrix:
       0    1
0  17586  481
1    634   39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9403803, 'precision': 0.4918309, 'recall': 0.49626705, 'specificity': 0.49626705, 'f1': 0.4926082, 'auroc': 0.6354718, 'binary_precision': 0.02586207, 'binary_recall': 0.011538462, 'binary_specificity': 0.98099566, 'binary_f1_score': 0.015957447}
confusion matrix:
      0    1
0  5833  113
1   257    3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_8.png
early stop counter: 6
val acc:0.9405016303062439, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 8,now: 2024-06-23 23:15:34.292726,epoch time: 0:20:15.791749,used: 2:43:39.844224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.91247886, 'precision': 0.9187123, 'recall': 0.84544027, 'specificity': 0.84544027, 'f1': 0.8740157, 'auroc': 0.95758355, 'binary_precision': 0.9288893, 'binary_recall': 0.7093418, 'binary_specificity': 0.98153865, 'binary_f1_score': 0.80440426}
confusion matrix:
       0      1
0  41630    783
1   4191  10228
---- Validation: 
scalar performance:
{'acc': 0.94621134, 'precision': 0.5789337, 'recall': 0.5636862, 'specificity': 0.5636862, 'f1': 0.5702619, 'auroc': 0.68010867, 'binary_precision': 0.18923934, 'binary_recall': 0.15156017, 'binary_specificity': 0.97581226, 'binary_f1_score': 0.16831683}
confusion matrix:
       0    1
0  17630  437
1    571  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9466645, 'precision': 0.55056626, 'recall': 0.5197754, 'specificity': 0.5197754, 'f1': 0.5252662, 'auroc': 0.7486448, 'binary_precision': 0.14141414, 'binary_recall': 0.053846154, 'binary_specificity': 0.98570466, 'binary_f1_score': 0.07799443}
confusion matrix:
      0   1
0  5861  85
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_9.png
early stop counter: 7
val acc:0.9462113380432129, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 9,now: 2024-06-23 23:36:35.594041,epoch time: 0:21:01.301315,used: 3:04:41.145539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9120742, 'precision': 0.9201843, 'recall': 0.84332526, 'specificity': 0.84332526, 'f1': 0.87294483, 'auroc': 0.9588491, 'binary_precision': 0.93332106, 'binary_recall': 0.70374477, 'binary_specificity': 0.9829058, 'binary_f1_score': 0.8024354}
confusion matrix:
       0      1
0  41687    725
1   4272  10148
---- Validation: 
scalar performance:
{'acc': 0.94471717, 'precision': 0.54288375, 'recall': 0.5307243, 'specificity': 0.5307243, 'f1': 0.53530705, 'auroc': 0.6422274, 'binary_precision': 0.11949685, 'binary_recall': 0.08469539, 'binary_specificity': 0.9767532, 'binary_f1_score': 0.09913042}
confusion matrix:
       0    1
0  17647  420
1    616   57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94505316, 'precision': 0.54746914, 'recall': 0.52077353, 'specificity': 0.52077353, 'f1': 0.5262713, 'auroc': 0.7226869, 'binary_precision': 0.13513513, 'binary_recall': 0.057692308, 'binary_specificity': 0.9838547, 'binary_f1_score': 0.08086253}
confusion matrix:
      0   1
0  5850  96
1   245  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_10.png
early stop counter: 8
val acc:0.9447171688079834, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 10,now: 2024-06-23 23:58:53.263559,epoch time: 0:22:17.669518,used: 3:26:58.815057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91510063, 'precision': 0.91801775, 'recall': 0.8527219, 'specificity': 0.8527219, 'f1': 0.8789189, 'auroc': 0.9610771, 'binary_precision': 0.9228735, 'binary_recall': 0.7260749, 'binary_specificity': 0.97936904, 'binary_f1_score': 0.8127304}
confusion matrix:
       0      1
0  41537    875
1   3950  10470
---- Validation: 
scalar performance:
{'acc': 0.94364995, 'precision': 0.5566934, 'recall': 0.54590666, 'specificity': 0.54590666, 'f1': 0.55051506, 'auroc': 0.6563287, 'binary_precision': 0.14602588, 'binary_recall': 0.11738484, 'binary_specificity': 0.97442853, 'binary_f1_score': 0.13014828}
confusion matrix:
       0    1
0  17605  462
1    594   79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94553655, 'precision': 0.57060444, 'recall': 0.53389865, 'specificity': 0.53389865, 'f1': 0.5435434, 'auroc': 0.7412813, 'binary_precision': 0.18032786, 'binary_recall': 0.08461539, 'binary_specificity': 0.98318195, 'binary_f1_score': 0.11518325}
confusion matrix:
      0    1
0  5846  100
1   238   22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_11.png
early stop counter: 9
val acc:0.94364994764328, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 11,now: 2024-06-24 00:18:18.262848,epoch time: 0:19:24.999289,used: 3:46:23.814346,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.92057294, 'precision': 0.9231192, 'recall': 0.86271894, 'specificity': 0.86271894, 'f1': 0.8874645, 'auroc': 0.9622829, 'binary_precision': 0.92741865, 'binary_recall': 0.7452667, 'binary_specificity': 0.9801712, 'binary_f1_score': 0.82642466}
confusion matrix:
       0      1
0  41572    841
1   3673  10746
---- Validation: 
scalar performance:
{'acc': 0.9466382, 'precision': 0.56870705, 'recall': 0.5510328, 'specificity': 0.5510328, 'f1': 0.55814826, 'auroc': 0.6755278, 'binary_precision': 0.16969697, 'binary_recall': 0.124814264, 'binary_specificity': 0.97725135, 'binary_f1_score': 0.14383562}
confusion matrix:
       0    1
0  17656  411
1    589   84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94263613, 'precision': 0.5589539, 'recall': 0.53238505, 'specificity': 0.53238505, 'f1': 0.5401815, 'auroc': 0.7440325, 'binary_precision': 0.15714286, 'binary_recall': 0.08461539, 'binary_specificity': 0.98015475, 'binary_f1_score': 0.11}
confusion matrix:
      0    1
0  5828  118
1   238   22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_12.png
early stop counter: 10
val acc:0.9466382265090942, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 12,now: 2024-06-24 00:37:27.987606,epoch time: 0:19:09.724758,used: 4:05:33.539104,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9262387, 'precision': 0.921824, 'recall': 0.8789429, 'specificity': 0.8789429, 'f1': 0.89758205, 'auroc': 0.9668355, 'binary_precision': 0.91401505, 'binary_recall': 0.7829253, 'binary_specificity': 0.9749605, 'binary_f1_score': 0.84340674}
confusion matrix:
       0      1
0  41351   1062
1   3130  11289
---- Validation: 
scalar performance:
{'acc': 0.93890077, 'precision': 0.5674459, 'recall': 0.57062376, 'specificity': 0.57062376, 'f1': 0.5689858, 'auroc': 0.70203483, 'binary_precision': 0.16572239, 'binary_recall': 0.17384844, 'binary_specificity': 0.9673991, 'binary_f1_score': 0.16968818}
confusion matrix:
       0    1
0  17478  589
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94521433, 'precision': 0.60514724, 'recall': 0.56499326, 'specificity': 0.56499326, 'f1': 0.57912767, 'auroc': 0.7673329, 'binary_precision': 0.24683544, 'binary_recall': 0.15, 'binary_specificity': 0.97998655, 'binary_f1_score': 0.18660288}
confusion matrix:
      0    1
0  5827  119
1   221   39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_13.png
early stop counter: 11
val acc:0.9389007687568665, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 13,now: 2024-06-24 00:57:20.796005,epoch time: 0:19:52.808399,used: 4:25:26.347503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.93315387, 'precision': 0.92455494, 'recall': 0.89540887, 'specificity': 0.89540887, 'f1': 0.90868056, 'auroc': 0.97092086, 'binary_precision': 0.90871304, 'binary_recall': 0.8187808, 'binary_specificity': 0.9720369, 'binary_f1_score': 0.861406}
confusion matrix:
       0      1
0  41227   1186
1   2613  11806
---- Validation: 
scalar performance:
{'acc': 0.9347385, 'precision': 0.5839938, 'recall': 0.6113812, 'specificity': 0.6113812, 'f1': 0.59520644, 'auroc': 0.72980917, 'binary_precision': 0.19579646, 'binary_recall': 0.26300147, 'binary_specificity': 0.9597609, 'binary_f1_score': 0.22447686}
confusion matrix:
       0    1
0  17340  727
1    496  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94456977, 'precision': 0.62470335, 'recall': 0.5940807, 'specificity': 0.5940807, 'f1': 0.6067617, 'auroc': 0.784781, 'binary_precision': 0.28350514, 'binary_recall': 0.21153846, 'binary_specificity': 0.97662294, 'binary_f1_score': 0.24229075}
confusion matrix:
      0    1
0  5807  139
1   205   55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_14.png
early stop counter: 12
val acc:0.9347385168075562, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 14,now: 2024-06-24 01:16:51.064312,epoch time: 0:19:30.268307,used: 4:44:56.615810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.93781674, 'precision': 0.9289928, 'recall': 0.90386033, 'specificity': 0.90386033, 'f1': 0.91546786, 'auroc': 0.9731255, 'binary_precision': 0.91252273, 'binary_recall': 0.8349286, 'binary_specificity': 0.972792, 'binary_f1_score': 0.8720029}
confusion matrix:
       0      1
0  41260   1154
1   2380  12038
---- Validation: 
scalar performance:
{'acc': 0.9353255, 'precision': 0.5822438, 'recall': 0.60596347, 'specificity': 0.60596347, 'f1': 0.5921661, 'auroc': 0.732123, 'binary_precision': 0.1927024, 'binary_recall': 0.2511144, 'binary_specificity': 0.9608125, 'binary_f1_score': 0.21806452}
confusion matrix:
       0    1
0  17359  708
1    504  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9398969, 'precision': 0.6061865, 'recall': 0.5916421, 'specificity': 0.5916421, 'f1': 0.5982375, 'auroc': 0.7792789, 'binary_precision': 0.24663678, 'binary_recall': 0.21153846, 'binary_specificity': 0.9717457, 'binary_f1_score': 0.22774327}
confusion matrix:
      0    1
0  5778  168
1   205   55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_15.png
early stop counter: 13
val acc:0.9353255033493042, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 15,now: 2024-06-24 01:36:04.732721,epoch time: 0:19:13.668409,used: 5:04:10.284219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9280159, 'precision': 0.9320916, 'recall': 0.8745569, 'specificity': 0.8745569, 'f1': 0.89849454, 'auroc': 0.97041976, 'binary_precision': 0.93904614, 'binary_recall': 0.7660194, 'binary_specificity': 0.9830944, 'binary_f1_score': 0.8437536}
confusion matrix:
       0      1
0  41695    717
1   3374  11046
---- Validation: 
scalar performance:
{'acc': 0.9485592, 'precision': 0.58861166, 'recall': 0.5663344, 'specificity': 0.5663344, 'f1': 0.57546186, 'auroc': 0.69096226, 'binary_precision': 0.20841683, 'binary_recall': 0.15453194, 'binary_specificity': 0.97813696, 'binary_f1_score': 0.1774744}
confusion matrix:
       0    1
0  17672  395
1    569  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9506929, 'precision': 0.6450157, 'recall': 0.5752083, 'specificity': 0.5752083, 'f1': 0.5969651, 'auroc': 0.76407796, 'binary_precision': 0.32575756, 'binary_recall': 0.16538462, 'binary_specificity': 0.98503196, 'binary_f1_score': 0.21938775}
confusion matrix:
      0   1
0  5857  89
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_16.png
early stop counter: 14
val acc:0.9485592246055603, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 16,now: 2024-06-24 01:54:54.019360,epoch time: 0:18:49.286639,used: 5:22:59.570858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.93980503, 'precision': 0.93276435, 'recall': 0.9054442, 'specificity': 0.9054442, 'f1': 0.91798687, 'auroc': 0.9744047, 'binary_precision': 0.9197008, 'binary_recall': 0.8356915, 'binary_specificity': 0.9751969, 'binary_f1_score': 0.87568593}
confusion matrix:
       0      1
0  41362   1052
1   2369  12049
---- Validation: 
scalar performance:
{'acc': 0.93820703, 'precision': 0.5919988, 'recall': 0.6138953, 'specificity': 0.6138953, 'f1': 0.6014708, 'auroc': 0.717692, 'binary_precision': 0.2116528, 'binary_recall': 0.26448736, 'binary_specificity': 0.96330327, 'binary_f1_score': 0.23513871}
confusion matrix:
       0    1
0  17404  663
1    495  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9403803, 'precision': 0.6329864, 'recall': 0.63786906, 'specificity': 0.63786906, 'f1': 0.6353736, 'auroc': 0.7698084, 'binary_precision': 0.2962963, 'binary_recall': 0.30769232, 'binary_specificity': 0.9680458, 'binary_f1_score': 0.3018868}
confusion matrix:
      0    1
0  5756  190
1   180   80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_17.png
early stop counter: 15
val acc:0.9382070302963257, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 17,now: 2024-06-24 02:14:21.275160,epoch time: 0:19:27.255800,used: 5:42:26.826658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.94057924, 'precision': 0.933685, 'recall': 0.90666026, 'specificity': 0.90666026, 'f1': 0.91908175, 'auroc': 0.97623897, 'binary_precision': 0.9208781, 'binary_recall': 0.8377947, 'binary_specificity': 0.9755258, 'binary_f1_score': 0.87737393}
confusion matrix:
       0      1
0  41374   1038
1   2339  12081
---- Validation: 
scalar performance:
{'acc': 0.93959445, 'precision': 0.608094, 'recall': 0.6410797, 'specificity': 0.6410797, 'f1': 0.6218859, 'auroc': 0.7393118, 'binary_precision': 0.24184477, 'binary_recall': 0.31946507, 'binary_specificity': 0.9626944, 'binary_f1_score': 0.2752881}
confusion matrix:
       0    1
0  17393  674
1    458  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95230424, 'precision': 0.69070536, 'recall': 0.6496087, 'specificity': 0.6496087, 'f1': 0.66726875, 'auroc': 0.7908691, 'binary_precision': 0.4108911, 'binary_recall': 0.31923077, 'binary_specificity': 0.97998655, 'binary_f1_score': 0.35930738}
confusion matrix:
      0    1
0  5827  119
1   177   83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_18.png
early stop counter: 16
val acc:0.9395944476127625, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 18,now: 2024-06-24 02:33:36.653825,epoch time: 0:19:15.378665,used: 6:01:42.205323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9410895, 'precision': 0.9342369, 'recall': 0.9075003, 'specificity': 0.9075003, 'f1': 0.9198024, 'auroc': 0.9773185, 'binary_precision': 0.9214955, 'binary_recall': 0.8393092, 'binary_specificity': 0.97569144, 'binary_f1_score': 0.87848437}
confusion matrix:
       0      1
0  41382   1031
1   2317  12102
---- Validation: 
scalar performance:
{'acc': 0.93986124, 'precision': 0.5993564, 'recall': 0.6211906, 'specificity': 0.6211906, 'f1': 0.60892165, 'auroc': 0.7378912, 'binary_precision': 0.22584541, 'binary_recall': 0.2778603, 'binary_specificity': 0.96452093, 'binary_f1_score': 0.2491672}
confusion matrix:
       0    1
0  17426  641
1    486  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9437641, 'precision': 0.6463252, 'recall': 0.6414739, 'specificity': 0.6414739, 'f1': 0.6438501, 'auroc': 0.78231263, 'binary_precision': 0.32270917, 'binary_recall': 0.31153846, 'binary_specificity': 0.9714094, 'binary_f1_score': 0.31702542}
confusion matrix:
      0    1
0  5776  170
1   179   81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_19.png
early stop counter: 17
val acc:0.9398612380027771, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 19,now: 2024-06-24 02:52:36.707718,epoch time: 0:19:00.053893,used: 6:20:42.259216,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9410719, 'precision': 0.9431913, 'recall': 0.8989057, 'specificity': 0.8989057, 'f1': 0.9182477, 'auroc': 0.97658825, 'binary_precision': 0.9469477, 'binary_recall': 0.8133019, 'binary_specificity': 0.98450947, 'binary_f1_score': 0.8750513}
confusion matrix:
       0      1
0  41756    657
1   2692  11727
---- Validation: 
scalar performance:
{'acc': 0.94951975, 'precision': 0.61909485, 'recall': 0.6040265, 'specificity': 0.6040265, 'f1': 0.610948, 'auroc': 0.72254765, 'binary_precision': 0.26666668, 'binary_recall': 0.23179792, 'binary_specificity': 0.97625506, 'binary_f1_score': 0.24801272}
confusion matrix:
       0    1
0  17638  429
1    517  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542378, 'precision': 0.69117326, 'recall': 0.606482, 'specificity': 0.606482, 'f1': 0.6349427, 'auroc': 0.7725594, 'binary_precision': 0.41549295, 'binary_recall': 0.22692308, 'binary_specificity': 0.986041, 'binary_f1_score': 0.29353234}
confusion matrix:
      0   1
0  5863  83
1   201  59
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_20.png
early stop counter: 18
val acc:0.9495197534561157, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 20,now: 2024-06-24 03:11:25.667021,epoch time: 0:18:48.959303,used: 6:39:31.218519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9387669, 'precision': 0.9419834, 'recall': 0.8939806, 'specificity': 0.8939806, 'f1': 0.91469026, 'auroc': 0.9776709, 'binary_precision': 0.9476268, 'binary_recall': 0.8030513, 'binary_specificity': 0.98490995, 'binary_f1_score': 0.8693694}
confusion matrix:
       0      1
0  41772    640
1   2840  11580
---- Validation: 
scalar performance:
{'acc': 0.9504269, 'precision': 0.6353423, 'recall': 0.6273855, 'specificity': 0.6273855, 'f1': 0.63122094, 'auroc': 0.7349111, 'binary_precision': 0.29746836, 'binary_recall': 0.2793462, 'binary_specificity': 0.9754248, 'binary_f1_score': 0.2881226}
confusion matrix:
       0    1
0  17623  444
1    485  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9553658, 'precision': 0.7096127, 'recall': 0.63833344, 'specificity': 0.63833344, 'f1': 0.66559815, 'auroc': 0.7844744, 'binary_precision': 0.44970414, 'binary_recall': 0.2923077, 'binary_specificity': 0.9843592, 'binary_f1_score': 0.35431236}
confusion matrix:
      0   1
0  5853  93
1   184  76
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_21.png
early stop counter: 19
val acc:0.9504268765449524, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 21,now: 2024-06-24 03:30:17.024501,epoch time: 0:18:51.357480,used: 6:58:22.575999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.94703686, 'precision': 0.9341363, 'recall': 0.92476356, 'specificity': 0.92476356, 'f1': 0.92931616, 'auroc': 0.9813633, 'binary_precision': 0.90878475, 'binary_recall': 0.8795423, 'binary_specificity': 0.9699849, 'binary_f1_score': 0.8939245}
confusion matrix:
       0      1
0  41139   1273
1   1737  12683
---- Validation: 
scalar performance:
{'acc': 0.93132335, 'precision': 0.5993818, 'recall': 0.6596787, 'specificity': 0.6596787, 'f1': 0.6206604, 'auroc': 0.78004944, 'binary_precision': 0.22292419, 'binary_recall': 0.36701337, 'binary_specificity': 0.95234406, 'binary_f1_score': 0.27737227}
confusion matrix:
       0    1
0  17206  861
1    426  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9395746, 'precision': 0.65485823, 'recall': 0.7036521, 'specificity': 0.7036521, 'f1': 0.67522067, 'auroc': 0.8119602, 'binary_precision': 0.33429396, 'binary_recall': 0.44615385, 'binary_specificity': 0.96115035, 'binary_f1_score': 0.38220757}
confusion matrix:
      0    1
0  5715  231
1   144  116
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_22.png
early stop counter: 20
val acc:0.9313233494758606, best validation acc: 0.9615261554718018, corresponding to test acc:                         0.9581050872802734 / 0.9581050872802734
after epoch: 22,now: 2024-06-24 03:49:02.220847,epoch time: 0:18:45.196346,used: 7:17:07.772345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_20_31_54_seed_1_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 22 with time: 7:17:07.772345 at 2024-06-24 03:49:02.220847
persisted model performance metric: 

scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3123724, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.3123724, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204071 KiB | 640729 KiB |   1691 TiB |   1691 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1691 TiB |   1691 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204071 KiB | 640729 KiB |   1691 TiB |   1691 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   1691 TiB |   1691 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 632296 KiB |   1684 TiB |   1684 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   1683 TiB |   1683 TiB |
|       from small pool |  35966 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1120 MiB | 471040 KiB |
|       from large pool | 600064 KiB | 679936 KiB |   1020 MiB | 444416 KiB |
|       from small pool |  75776 KiB |  75776 KiB |    100 MiB |  26624 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  82648 KiB | 218089 KiB | 635739 GiB | 635739 GiB |
|       from large pool |  68480 KiB | 217080 KiB | 635178 GiB | 635178 GiB |
|       from small pool |  14168 KiB |  19703 KiB |    561 GiB |    561 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    7879    |  149481 K  |  149478 K  |
|       from large pool |      36    |      76    |   60614 K  |   60614 K  |
|       from small pool |    3192    |    7842    |   88867 K  |   88863 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    7879    |  149481 K  |  149478 K  |
|       from large pool |      36    |      76    |   60614 K  |   60614 K  |
|       from small pool |    3192    |    7842    |   88867 K  |   88863 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      68    |      17    |
|       from large pool |      14    |      14    |      18    |       4    |
|       from small pool |      37    |      37    |      50    |      13    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3581    |   68079 K  |   68079 K  |
|       from large pool |       5    |      13    |   22677 K  |   22677 K  |
|       from small pool |      32    |    3574    |   45402 K  |   45402 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1691 TiB |   1691 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1691 TiB |   1691 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1691 TiB |   1691 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1691 TiB |   1691 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1684 TiB |   1684 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1683 TiB |   1683 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 755712 KiB |   1120 MiB |    840 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  51200 KiB |  75776 KiB |    100 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 635739 GiB | 635739 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 635178 GiB | 635178 GiB |
|       from small pool |      0 KiB |  21763 KiB |    561 GiB |    561 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  149481 K  |  149481 K  |
|       from large pool |       2    |      76    |   60614 K  |   60614 K  |
|       from small pool |       0    |    7842    |   88867 K  |   88867 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  149481 K  |  149481 K  |
|       from large pool |       2    |      76    |   60614 K  |   60614 K  |
|       from small pool |       0    |    7842    |   88867 K  |   88867 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      51    |      68    |      33    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      25    |      37    |      50    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   68080 K  |   68080 K  |
|       from large pool |       3    |      13    |   22677 K  |   22677 K  |
|       from small pool |       0    |    3574    |   45403 K  |   45403 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1691 TiB |   1691 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1691 TiB |   1691 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1691 TiB |   1691 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1691 TiB |   1691 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1684 TiB |   1684 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1683 TiB |   1683 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 755712 KiB |   1120 MiB |    840 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  51200 KiB |  75776 KiB |    100 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB | 635739 GiB | 635739 GiB |
|       from large pool |  55040 KiB | 217080 KiB | 635178 GiB | 635178 GiB |
|       from small pool |      0 KiB |  21763 KiB |    561 GiB |    561 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  149481 K  |  149481 K  |
|       from large pool |       2    |      76    |   60614 K  |   60614 K  |
|       from small pool |       0    |    7842    |   88867 K  |   88867 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  149481 K  |  149481 K  |
|       from large pool |       2    |      76    |   60614 K  |   60614 K  |
|       from small pool |       0    |    7842    |   88867 K  |   88867 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      51    |      68    |      33    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      25    |      37    |      50    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   68080 K  |   68080 K  |
|       from large pool |       3    |      13    |   22677 K  |   22677 K  |
|       from small pool |       0    |    3574    |   45403 K  |   45403 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149

 Experiment start at: 2024-06-24 03:56:14.964961
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7384401, 'precision': 0.74419904, 'recall': 0.5045415, 'specificity': 0.5045415, 'f1': 0.43470806, 'auroc': 0.7177243, 'binary_precision': 0.75, 'binary_recall': 0.010312004, 'binary_specificity': 0.998771, 'binary_f1_score': 0.020344287}
confusion matrix:
       0    1
0  42260   52
1  14972  156
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9676663, 'precision': 0.65075344, 'recall': 0.50387764, 'specificity': 0.50387764, 'f1': 0.49988526, 'auroc': 0.5101621, 'binary_precision': 0.33333334, 'binary_recall': 0.008305647, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.016207455}
confusion matrix:
       0   1
0  18161  10
1    597   5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7308278, 'recall': 0.50594825, 'specificity': 0.50594825, 'f1': 0.50220305, 'auroc': 0.5616865, 'binary_precision': 0.5, 'binary_recall': 0.012396694, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.024193548}
confusion matrix:
      0  1
0  5994  3
1   239  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-24 04:15:41.303872,epoch time: 0:19:26.338911,used: 0:19:26.338911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.75339484, 'precision': 0.8596225, 'recall': 0.53251755, 'specificity': 0.53251755, 'f1': 0.48985115, 'auroc': 0.85648644, 'binary_precision': 0.9697856, 'binary_recall': 0.06576773, 'binary_specificity': 0.99926734, 'binary_f1_score': 0.12318166}
confusion matrix:
       0    1
0  42280   31
1  14134  995
---- Validation: 
scalar performance:
{'acc': 0.9675598, 'precision': 0.59941983, 'recall': 0.5022165, 'specificity': 0.5022165, 'f1': 0.49663296, 'auroc': 0.57141197, 'binary_precision': 0.23076923, 'binary_recall': 0.004983389, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.009756098}
confusion matrix:
       0   1
0  18161  10
1    599   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.6807507, 'recall': 0.5038821, 'specificity': 0.5038821, 'f1': 0.49816337, 'auroc': 0.6368308, 'binary_precision': 0.4, 'binary_recall': 0.008264462, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.016194332}
confusion matrix:
      0  1
0  5994  3
1   240  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_2.png
early stop counter: 1
val acc:0.967559814453125, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 2,now: 2024-06-24 04:34:41.631173,epoch time: 0:19:00.327301,used: 0:38:26.666212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7942375, 'precision': 0.88280165, 'recall': 0.6106285, 'specificity': 0.6106285, 'f1': 0.6201648, 'auroc': 0.9143472, 'binary_precision': 0.98335767, 'binary_recall': 0.2226041, 'binary_specificity': 0.9986528, 'binary_f1_score': 0.36302885}
confusion matrix:
       0     1
0  42253    57
1  11762  3368
---- Validation: 
scalar performance:
{'acc': 0.96622807, 'precision': 0.53403884, 'recall': 0.5023317, 'specificity': 0.5023317, 'f1': 0.49764067, 'auroc': 0.59591544, 'binary_precision': 0.1, 'binary_recall': 0.006644518, 'binary_specificity': 0.9980188, 'binary_f1_score': 0.012461059}
confusion matrix:
       0   1
0  18135  36
1    598   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.6784799, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_3.png
early stop counter: 2
val acc:0.9662280678749084, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 3,now: 2024-06-24 04:53:42.554763,epoch time: 0:19:00.923590,used: 0:57:27.589802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8283252, 'precision': 0.8949176, 'recall': 0.67677796, 'specificity': 0.67677796, 'f1': 0.70889974, 'auroc': 0.924829, 'binary_precision': 0.97735095, 'binary_recall': 0.35651025, 'binary_specificity': 0.99704564, 'binary_f1_score': 0.52244663}
confusion matrix:
       0     1
0  42185   125
1   9736  5394
---- Validation: 
scalar performance:
{'acc': 0.96484315, 'precision': 0.54826945, 'recall': 0.50643456, 'specificity': 0.50643456, 'f1': 0.50575453, 'auroc': 0.594872, 'binary_precision': 0.12820514, 'binary_recall': 0.016611295, 'binary_specificity': 0.9962578, 'binary_f1_score': 0.029411763}
confusion matrix:
       0   1
0  18103  68
1    592  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.691716, 'recall': 0.51561177, 'specificity': 0.51561177, 'f1': 0.52062434, 'auroc': 0.68560004, 'binary_precision': 0.42105263, 'binary_recall': 0.03305785, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.06130268}
confusion matrix:
      0   1
0  5986  11
1   234   8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_4.png
early stop counter: 3
val acc:0.9648431539535522, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 4,now: 2024-06-24 05:12:42.718659,epoch time: 0:19:00.163896,used: 1:16:27.753698,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8651114, 'precision': 0.904649, 'recall': 0.750852, 'specificity': 0.750852, 'f1': 0.7905052, 'auroc': 0.94151413, 'binary_precision': 0.95953685, 'binary_recall': 0.50938535, 'binary_specificity': 0.99231863, 'binary_f1_score': 0.6654866}
confusion matrix:
       0     1
0  41985   325
1   7423  7707
---- Validation: 
scalar performance:
{'acc': 0.96079475, 'precision': 0.5483185, 'recall': 0.5147829, 'specificity': 0.5147829, 'f1': 0.51940197, 'auroc': 0.6430479, 'binary_precision': 0.12777779, 'binary_recall': 0.03820598, 'binary_specificity': 0.99135983, 'binary_f1_score': 0.05882353}
confusion matrix:
       0    1
0  18014  157
1    579   23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9570444, 'precision': 0.59592724, 'recall': 0.5196424, 'specificity': 0.5196424, 'f1': 0.52693665, 'auroc': 0.72488856, 'binary_precision': 0.22916667, 'binary_recall': 0.045454547, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.07586207}
confusion matrix:
      0   1
0  5960  37
1   231  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_5.png
early stop counter: 4
val acc:0.9607947468757629, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 5,now: 2024-06-24 05:32:02.195126,epoch time: 0:19:19.476467,used: 1:35:47.230165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.89112115, 'precision': 0.91263807, 'recall': 0.8048185, 'specificity': 0.8048185, 'f1': 0.8405338, 'auroc': 0.95006704, 'binary_precision': 0.94557685, 'binary_recall': 0.62244695, 'binary_specificity': 0.98719007, 'binary_f1_score': 0.75071746}
confusion matrix:
       0     1
0  41769   542
1   5712  9417
---- Validation: 
scalar performance:
{'acc': 0.95418954, 'precision': 0.55986816, 'recall': 0.5370684, 'specificity': 0.5370684, 'f1': 0.5449447, 'auroc': 0.66445374, 'binary_precision': 0.14945652, 'binary_recall': 0.091362126, 'binary_specificity': 0.98277473, 'binary_f1_score': 0.11340205}
confusion matrix:
       0    1
0  17858  313
1    547   55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9544799, 'precision': 0.631842, 'recall': 0.5579632, 'specificity': 0.5579632, 'f1': 0.57789075, 'auroc': 0.72618055, 'binary_precision': 0.29807693, 'binary_recall': 0.12809917, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.17919075}
confusion matrix:
      0   1
0  5924  73
1   211  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_6.png
early stop counter: 5
val acc:0.9541895389556885, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 6,now: 2024-06-24 05:51:18.319749,epoch time: 0:19:16.124623,used: 1:55:03.354788,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8981372, 'precision': 0.9089297, 'recall': 0.82366836, 'specificity': 0.82366836, 'f1': 0.854617, 'auroc': 0.94881725, 'binary_precision': 0.9263071, 'binary_recall': 0.66629213, 'binary_specificity': 0.98104465, 'binary_f1_score': 0.77507406}
confusion matrix:
       0      1
0  41508    802
1   5049  10081
---- Validation: 
scalar performance:
{'acc': 0.94785064, 'precision': 0.5588067, 'recall': 0.5522641, 'specificity': 0.5522641, 'f1': 0.5552787, 'auroc': 0.6776091, 'binary_precision': 0.14634146, 'binary_recall': 0.1295681, 'binary_specificity': 0.9749601, 'binary_f1_score': 0.13744493}
confusion matrix:
       0    1
0  17716  455
1    524   78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9515948, 'precision': 0.6416924, 'recall': 0.59611726, 'specificity': 0.59611726, 'f1': 0.6137314, 'auroc': 0.7368016, 'binary_precision': 0.3148148, 'binary_recall': 0.2107438, 'binary_specificity': 0.98149073, 'binary_f1_score': 0.25247523}
confusion matrix:
      0    1
0  5886  111
1   191   51
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_7.png
early stop counter: 6
val acc:0.9478506445884705, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 7,now: 2024-06-24 06:10:34.186283,epoch time: 0:19:15.866534,used: 2:14:19.221322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.903656, 'precision': 0.91662776, 'recall': 0.8316288, 'specificity': 0.8316288, 'f1': 0.862788, 'auroc': 0.952708, 'binary_precision': 0.9376083, 'binary_recall': 0.67942363, 'binary_specificity': 0.98383397, 'binary_f1_score': 0.7879043}
confusion matrix:
       0      1
0  41627    684
1   4850  10279
---- Validation: 
scalar performance:
{'acc': 0.94827676, 'precision': 0.561991, 'recall': 0.5548934, 'specificity': 0.5548934, 'f1': 0.55815846, 'auroc': 0.6634904, 'binary_precision': 0.15254237, 'binary_recall': 0.1345515, 'binary_specificity': 0.9752353, 'binary_f1_score': 0.14298321}
confusion matrix:
       0    1
0  17721  450
1    521   81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9469466, 'precision': 0.623901, 'recall': 0.60361314, 'specificity': 0.60361314, 'f1': 0.6126593, 'auroc': 0.7239722, 'binary_precision': 0.27860695, 'binary_recall': 0.23140496, 'binary_specificity': 0.97582126, 'binary_f1_score': 0.25282165}
confusion matrix:
      0    1
0  5852  145
1   186   56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_8.png
early stop counter: 7
val acc:0.9482767581939697, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 8,now: 2024-06-24 06:29:48.127222,epoch time: 0:19:13.940939,used: 2:33:33.162261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.89968663, 'precision': 0.9124715, 'recall': 0.8249749, 'specificity': 0.8249749, 'f1': 0.8565748, 'auroc': 0.9524766, 'binary_precision': 0.9329821, 'binary_recall': 0.6670853, 'binary_specificity': 0.98286456, 'binary_f1_score': 0.7779406}
confusion matrix:
       0      1
0  41585    725
1   5037  10093
---- Validation: 
scalar performance:
{'acc': 0.9450274, 'precision': 0.56553054, 'recall': 0.5684728, 'specificity': 0.5684728, 'f1': 0.56695944, 'auroc': 0.6867449, 'binary_precision': 0.15873016, 'binary_recall': 0.16611296, 'binary_specificity': 0.97083265, 'binary_f1_score': 0.16233768}
confusion matrix:
       0    1
0  17641  530
1    502  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94614524, 'precision': 0.6228357, 'recall': 0.6071617, 'specificity': 0.6071617, 'f1': 0.6143489, 'auroc': 0.74564207, 'binary_precision': 0.2761905, 'binary_recall': 0.23966943, 'binary_specificity': 0.974654, 'binary_f1_score': 0.2566372}
confusion matrix:
      0    1
0  5845  152
1   184   58
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_9.png
early stop counter: 8
val acc:0.9450274109840393, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 9,now: 2024-06-24 06:49:00.095886,epoch time: 0:19:11.968664,used: 2:52:45.130925,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9129875, 'precision': 0.9231024, 'recall': 0.84950095, 'specificity': 0.84950095, 'f1': 0.877886, 'auroc': 0.95818794, 'binary_precision': 0.9399861, 'binary_recall': 0.71533376, 'binary_specificity': 0.98366815, 'binary_f1_score': 0.81241554}
confusion matrix:
       0      1
0  41619    691
1   4307  10823
---- Validation: 
scalar performance:
{'acc': 0.94864964, 'precision': 0.57578206, 'recall': 0.57114697, 'specificity': 0.57114697, 'f1': 0.5733719, 'auroc': 0.67412657, 'binary_precision': 0.17907801, 'binary_recall': 0.16777408, 'binary_specificity': 0.97451985, 'binary_f1_score': 0.17324185}
confusion matrix:
       0    1
0  17708  463
1    501  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9515948, 'precision': 0.65642214, 'recall': 0.6238756, 'specificity': 0.6238756, 'f1': 0.6379277, 'auroc': 0.73765105, 'binary_precision': 0.34210527, 'binary_recall': 0.26859504, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.30092594}
confusion matrix:
      0    1
0  5872  125
1   177   65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_10.png
early stop counter: 9
val acc:0.9486496448516846, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 10,now: 2024-06-24 07:08:12.138065,epoch time: 0:19:12.042179,used: 3:11:57.173104,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.90379524, 'precision': 0.9180285, 'recall': 0.83103323, 'specificity': 0.83103323, 'f1': 0.8627186, 'auroc': 0.96083975, 'binary_precision': 0.940955, 'binary_recall': 0.67726374, 'binary_specificity': 0.98480266, 'binary_f1_score': 0.78762496}
confusion matrix:
       0      1
0  41667    643
1   4883  10247
---- Validation: 
scalar performance:
{'acc': 0.9495552, 'precision': 0.57857764, 'recall': 0.57161474, 'specificity': 0.57161474, 'f1': 0.5748932, 'auroc': 0.70007825, 'binary_precision': 0.1846435, 'binary_recall': 0.16777408, 'binary_specificity': 0.9754554, 'binary_f1_score': 0.17580505}
confusion matrix:
       0    1
0  17725  446
1    501  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94598496, 'precision': 0.59430164, 'recall': 0.5674235, 'specificity': 0.5674235, 'f1': 0.57804364, 'auroc': 0.7373811, 'binary_precision': 0.22222222, 'binary_recall': 0.1570248, 'binary_specificity': 0.97782224, 'binary_f1_score': 0.18401937}
confusion matrix:
      0    1
0  5864  133
1   204   38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_11.png
early stop counter: 10
val acc:0.9495552182197571, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 11,now: 2024-06-24 07:27:11.168543,epoch time: 0:18:59.030478,used: 3:30:56.203582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9178795, 'precision': 0.9251479, 'recall': 0.85989106, 'specificity': 0.85989106, 'f1': 0.88589525, 'auroc': 0.9654554, 'binary_precision': 0.93755776, 'binary_recall': 0.737343, 'binary_specificity': 0.98243916, 'binary_f1_score': 0.8254837}
confusion matrix:
       0      1
0  41567    743
1   3974  11156
---- Validation: 
scalar performance:
{'acc': 0.9452938, 'precision': 0.59347034, 'recall': 0.61358106, 'specificity': 0.61358106, 'f1': 0.6023225, 'auroc': 0.7236618, 'binary_precision': 0.21166892, 'binary_recall': 0.2591362, 'binary_specificity': 0.968026, 'binary_f1_score': 0.23300971}
confusion matrix:
       0    1
0  17590  581
1    446  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95111394, 'precision': 0.653756, 'recall': 0.6236255, 'specificity': 0.6236255, 'f1': 0.6367624, 'auroc': 0.7594259, 'binary_precision': 0.33678755, 'binary_recall': 0.26859504, 'binary_specificity': 0.978656, 'binary_f1_score': 0.2988506}
confusion matrix:
      0    1
0  5869  128
1   177   65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_12.png
early stop counter: 11
val acc:0.9452937841415405, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 12,now: 2024-06-24 07:46:10.979154,epoch time: 0:18:59.810611,used: 3:49:56.014193,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.92670614, 'precision': 0.9298667, 'recall': 0.878047, 'specificity': 0.878047, 'f1': 0.8997828, 'auroc': 0.9685426, 'binary_precision': 0.9354761, 'binary_recall': 0.7752148, 'binary_specificity': 0.98087925, 'binary_f1_score': 0.84783864}
confusion matrix:
       0      1
0  41501    809
1   3401  11729
---- Validation: 
scalar performance:
{'acc': 0.9390614, 'precision': 0.57849103, 'recall': 0.60955864, 'specificity': 0.60955864, 'f1': 0.5907541, 'auroc': 0.7171434, 'binary_precision': 0.18192488, 'binary_recall': 0.25747508, 'binary_specificity': 0.9616422, 'binary_f1_score': 0.21320495}
confusion matrix:
       0    1
0  17474  697
1    447  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9427793, 'precision': 0.6359384, 'recall': 0.65894485, 'specificity': 0.65894485, 'f1': 0.6463543, 'auroc': 0.7593039, 'binary_precision': 0.2982456, 'binary_recall': 0.35123968, 'binary_specificity': 0.96665, 'binary_f1_score': 0.32258064}
confusion matrix:
      0    1
0  5797  200
1   157   85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_13.png
early stop counter: 12
val acc:0.9390614032745361, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 13,now: 2024-06-24 08:05:27.559860,epoch time: 0:19:16.580706,used: 4:09:12.594899,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92987466, 'precision': 0.9333831, 'recall': 0.8830569, 'specificity': 0.8830569, 'f1': 0.9043179, 'auroc': 0.9718236, 'binary_precision': 0.93964356, 'binary_recall': 0.7841232, 'binary_specificity': 0.9819905, 'binary_f1_score': 0.85486776}
confusion matrix:
       0      1
0  41549    762
1   3266  11863
---- Validation: 
scalar performance:
{'acc': 0.94683856, 'precision': 0.59697807, 'recall': 0.61277294, 'specificity': 0.61277294, 'f1': 0.604148, 'auroc': 0.7255559, 'binary_precision': 0.21875, 'binary_recall': 0.25581396, 'binary_specificity': 0.969732, 'binary_f1_score': 0.23583461}
confusion matrix:
       0    1
0  17621  550
1    448  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95031255, 'precision': 0.6619633, 'recall': 0.65294975, 'specificity': 0.65294975, 'f1': 0.6573047, 'auroc': 0.7673141, 'binary_precision': 0.3508772, 'binary_recall': 0.3305785, 'binary_specificity': 0.975321, 'binary_f1_score': 0.34042552}
confusion matrix:
      0    1
0  5849  148
1   162   80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_14.png
early stop counter: 13
val acc:0.9468385577201843, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 14,now: 2024-06-24 08:24:45.593563,epoch time: 0:19:18.033703,used: 4:28:30.628602,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9344185, 'precision': 0.93840164, 'recall': 0.8902324, 'specificity': 0.8902324, 'f1': 0.9107866, 'auroc': 0.972433, 'binary_precision': 0.9455643, 'binary_recall': 0.7968667, 'binary_specificity': 0.98359805, 'binary_f1_score': 0.8648706}
confusion matrix:
       0      1
0  41618    694
1   3073  12055
---- Validation: 
scalar performance:
{'acc': 0.94715816, 'precision': 0.6012631, 'recall': 0.6193625, 'specificity': 0.6193625, 'f1': 0.60941, 'auroc': 0.72780883, 'binary_precision': 0.22689076, 'binary_recall': 0.269103, 'binary_specificity': 0.9696219, 'binary_f1_score': 0.24620062}
confusion matrix:
       0    1
0  17619  552
1    440  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95287704, 'precision': 0.6765324, 'recall': 0.65824926, 'specificity': 0.65824926, 'f1': 0.66680974, 'auroc': 0.7644366, 'binary_precision': 0.37962964, 'binary_recall': 0.338843, 'binary_specificity': 0.9776555, 'binary_f1_score': 0.35807863}
confusion matrix:
      0    1
0  5863  134
1   160   82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_15.png
early stop counter: 14
val acc:0.94715815782547, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 15,now: 2024-06-24 08:44:04.695372,epoch time: 0:19:19.101809,used: 4:47:49.730411,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.93151116, 'precision': 0.93508446, 'recall': 0.8857456, 'specificity': 0.8857456, 'f1': 0.90667903, 'auroc': 0.96953344, 'binary_precision': 0.94148266, 'binary_recall': 0.7890284, 'binary_specificity': 0.98246276, 'binary_f1_score': 0.85854006}
confusion matrix:
       0      1
0  41568    742
1   3192  11938
---- Validation: 
scalar performance:
{'acc': 0.9464657, 'precision': 0.5869242, 'recall': 0.5965194, 'specificity': 0.5965194, 'f1': 0.59140986, 'auroc': 0.69318706, 'binary_precision': 0.19970194, 'binary_recall': 0.22259136, 'binary_specificity': 0.9704474, 'binary_f1_score': 0.21052632}
confusion matrix:
       0    1
0  17634  537
1    468  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949992, 'precision': 0.6611679, 'recall': 0.6547657, 'specificity': 0.6547657, 'f1': 0.6578904, 'auroc': 0.7511421, 'binary_precision': 0.34913793, 'binary_recall': 0.33471075, 'binary_specificity': 0.97482073, 'binary_f1_score': 0.34177217}
confusion matrix:
      0    1
0  5846  151
1   161   81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_16.png
early stop counter: 15
val acc:0.9464656710624695, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 16,now: 2024-06-24 09:03:43.071156,epoch time: 0:19:38.375784,used: 5:07:28.106195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.93537605, 'precision': 0.9372903, 'recall': 0.89360654, 'specificity': 0.89360654, 'f1': 0.91252065, 'auroc': 0.97455066, 'binary_precision': 0.94077677, 'binary_recall': 0.8053407, 'binary_specificity': 0.9818723, 'binary_f1_score': 0.86780626}
confusion matrix:
       0      1
0  41544    767
1   2945  12184
---- Validation: 
scalar performance:
{'acc': 0.94902253, 'precision': 0.60956204, 'recall': 0.6251438, 'specificity': 0.6251438, 'f1': 0.61673146, 'auroc': 0.7545527, 'binary_precision': 0.2431259, 'binary_recall': 0.27906978, 'binary_specificity': 0.9712179, 'binary_f1_score': 0.25986078}
confusion matrix:
       0    1
0  17648  523
1    434  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9567238, 'precision': 0.70031196, 'recall': 0.66025025, 'specificity': 0.66025025, 'f1': 0.6777312, 'auroc': 0.77618027, 'binary_precision': 0.42708334, 'binary_recall': 0.338843, 'binary_specificity': 0.9816575, 'binary_f1_score': 0.37788016}
confusion matrix:
      0    1
0  5887  110
1   160   82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_17.png
early stop counter: 16
val acc:0.9490225315093994, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 17,now: 2024-06-24 09:23:07.027036,epoch time: 0:19:23.955880,used: 5:26:52.062075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9358809, 'precision': 0.93756586, 'recall': 0.89465606, 'specificity': 0.89465606, 'f1': 0.9132855, 'auroc': 0.97511977, 'binary_precision': 0.94064206, 'binary_recall': 0.8075347, 'binary_specificity': 0.98177737, 'binary_f1_score': 0.86902094}
confusion matrix:
       0      1
0  41539    771
1   2912  12218
---- Validation: 
scalar performance:
{'acc': 0.9427369, 'precision': 0.59952366, 'recall': 0.6387609, 'specificity': 0.6387609, 'f1': 0.6151836, 'auroc': 0.74178624, 'binary_precision': 0.22209166, 'binary_recall': 0.3139535, 'binary_specificity': 0.96356833, 'binary_f1_score': 0.26015142}
confusion matrix:
       0    1
0  17509  662
1    413  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9482289, 'precision': 0.66420734, 'recall': 0.6855725, 'specificity': 0.6855725, 'f1': 0.6741187, 'auroc': 0.78352195, 'binary_precision': 0.35272726, 'binary_recall': 0.40082645, 'binary_specificity': 0.9703185, 'binary_f1_score': 0.3752418}
confusion matrix:
      0    1
0  5819  178
1   145   97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_18.png
early stop counter: 17
val acc:0.9427369236946106, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 18,now: 2024-06-24 09:43:02.810440,epoch time: 0:19:55.783404,used: 5:46:47.845479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9419742, 'precision': 0.940955, 'recall': 0.90724146, 'specificity': 0.90724146, 'f1': 0.9223522, 'auroc': 0.97898185, 'binary_precision': 0.9390398, 'binary_recall': 0.8338401, 'binary_specificity': 0.98064286, 'binary_f1_score': 0.8833188}
confusion matrix:
       0      1
0  41491    819
1   2514  12616
---- Validation: 
scalar performance:
{'acc': 0.9471049, 'precision': 0.604307, 'recall': 0.62575936, 'specificity': 0.62575936, 'f1': 0.6138213, 'auroc': 0.76186866, 'binary_precision': 0.23255815, 'binary_recall': 0.28239202, 'binary_specificity': 0.96912664, 'binary_f1_score': 0.2550638}
confusion matrix:
       0    1
0  17610  561
1    432  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9517551, 'precision': 0.6718817, 'recall': 0.6616311, 'specificity': 0.6616311, 'f1': 0.6665722, 'auroc': 0.7883233, 'binary_precision': 0.37004405, 'binary_recall': 0.34710744, 'binary_specificity': 0.97615474, 'binary_f1_score': 0.35820895}
confusion matrix:
      0    1
0  5854  143
1   158   84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_19.png
early stop counter: 18
val acc:0.9471048712730408, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 19,now: 2024-06-24 10:05:04.149280,epoch time: 0:22:01.338840,used: 6:08:49.184319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9388405, 'precision': 0.9404337, 'recall': 0.8996583, 'specificity': 0.8996583, 'f1': 0.91750973, 'auroc': 0.9761193, 'binary_precision': 0.94336313, 'binary_recall': 0.81685394, 'binary_specificity': 0.98246276, 'binary_f1_score': 0.8755623}
confusion matrix:
       0      1
0  41568    742
1   2771  12359
---- Validation: 
scalar performance:
{'acc': 0.94715816, 'precision': 0.6097706, 'recall': 0.6370295, 'specificity': 0.6370295, 'f1': 0.62158716, 'auroc': 0.7573122, 'binary_precision': 0.24274406, 'binary_recall': 0.30564785, 'binary_specificity': 0.9684112, 'binary_f1_score': 0.27058822}
confusion matrix:
       0    1
0  17597  574
1    418  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94662607, 'precision': 0.6567028, 'recall': 0.68077326, 'specificity': 0.68077326, 'f1': 0.6677171, 'auroc': 0.7869086, 'binary_precision': 0.3380783, 'binary_recall': 0.39256197, 'binary_specificity': 0.9689845, 'binary_f1_score': 0.3632887}
confusion matrix:
      0    1
0  5811  186
1   147   95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_20.png
early stop counter: 19
val acc:0.94715815782547, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 20,now: 2024-06-24 10:25:50.723340,epoch time: 0:20:46.574060,used: 6:29:35.758379,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.94094706, 'precision': 0.9460511, 'recall': 0.90012693, 'specificity': 0.90012693, 'f1': 0.91994226, 'auroc': 0.9787346, 'binary_precision': 0.9553107, 'binary_recall': 0.8138674, 'binary_specificity': 0.98638654, 'binary_f1_score': 0.8789349}
confusion matrix:
       0      1
0  41735    576
1   2816  12313
---- Validation: 
scalar performance:
{'acc': 0.9508869, 'precision': 0.6132279, 'recall': 0.62048554, 'specificity': 0.62048554, 'f1': 0.6167222, 'auroc': 0.75335395, 'binary_precision': 0.25077882, 'binary_recall': 0.26744187, 'binary_specificity': 0.9735293, 'binary_f1_score': 0.25884247}
confusion matrix:
       0    1
0  17690  481
1    441  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9560827, 'precision': 0.69544613, 'recall': 0.657934, 'specificity': 0.657934, 'f1': 0.674403, 'auroc': 0.77735007, 'binary_precision': 0.41752577, 'binary_recall': 0.33471075, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.37155965}
confusion matrix:
      0    1
0  5884  113
1   161   81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551149_21.png
early stop counter: 20
val acc:0.9508869051933289, best validation acc: 0.9676663279533386, corresponding to test acc:                         0.9612117409706116 / 0.9612117409706116
after epoch: 21,now: 2024-06-24 10:47:28.480157,epoch time: 0:21:37.756817,used: 6:51:13.515196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_03_56_14_seed_2_21551149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 6:51:13.515196 at 2024-06-24 10:47:28.480157
persisted model performance metric: 

scalar performance:
{'acc': 0.96121174, 'precision': 0.7308278, 'recall': 0.50594825, 'specificity': 0.50594825, 'f1': 0.50220305, 'auroc': 0.5616865, 'binary_precision': 0.5, 'binary_recall': 0.012396694, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.024193548}
confusion matrix:
      0  1
0  5994  3
1   239  3
oracle model performance metric: 

scalar performance:
{'acc': 0.96121174, 'precision': 0.7308278, 'recall': 0.50594825, 'specificity': 0.50594825, 'f1': 0.50220305, 'auroc': 0.5616865, 'binary_precision': 0.5, 'binary_recall': 0.012396694, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.024193548}
confusion matrix:
      0  1
0  5994  3
1   239  3
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204077 KiB | 640729 KiB |   2506 TiB |   2506 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2505 TiB |   2505 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204077 KiB | 640729 KiB |   2506 TiB |   2506 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2505 TiB |   2505 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 632296 KiB |   2494 TiB |   2494 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   2493 TiB |   2493 TiB |
|       from small pool |  35967 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1500 MiB |    840 MiB |
|       from large pool | 600064 KiB | 679936 KiB |   1376 MiB |    790 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    124 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  82642 KiB | 218089 KiB |    897 TiB |    897 TiB |
|       from large pool |  68480 KiB | 217080 KiB |    896 TiB |    896 TiB |
|       from small pool |  14162 KiB |  21763 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    7929    |  221333 K  |  221330 K  |
|       from large pool |      36    |      76    |   89754 K  |   89754 K  |
|       from small pool |    3204    |    7892    |  131579 K  |  131576 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    7929    |  221333 K  |  221330 K  |
|       from large pool |      36    |      76    |   89754 K  |   89754 K  |
|       from small pool |    3204    |    7892    |  131579 K  |  131576 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      84    |      33    |
|       from large pool |      14    |      14    |      22    |       8    |
|       from small pool |      37    |      37    |      62    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3604    |  101326 K  |  101326 K  |
|       from large pool |       5    |      13    |   34061 K  |   34061 K  |
|       from small pool |      32    |    3599    |   67265 K  |   67265 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   2506 TiB |   2506 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2505 TiB |   2505 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   2506 TiB |   2506 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2505 TiB |   2505 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   2494 TiB |   2494 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2493 TiB |   2493 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 755712 KiB |   1500 MiB |   1220 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1376 MiB |   1146 MiB |
|       from small pool |  51200 KiB |  75776 KiB |    124 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB |    897 TiB |    897 TiB |
|       from large pool |  55040 KiB | 217080 KiB |    896 TiB |    896 TiB |
|       from small pool |      0 KiB |  21763 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7929    |  221333 K  |  221333 K  |
|       from large pool |       2    |      76    |   89754 K  |   89754 K  |
|       from small pool |       0    |    7892    |  131579 K  |  131579 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7929    |  221333 K  |  221333 K  |
|       from large pool |       2    |      76    |   89754 K  |   89754 K  |
|       from small pool |       0    |    7892    |  131579 K  |  131579 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      51    |      84    |      49    |
|       from large pool |      10    |      14    |      22    |      12    |
|       from small pool |      25    |      37    |      62    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3604    |  101328 K  |  101328 K  |
|       from large pool |       3    |      13    |   34061 K  |   34061 K  |
|       from small pool |       0    |    3599    |   67266 K  |   67266 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jun 24 10:48:37 2024]
Finished job 0.
1 of 1 steps (100%) done
