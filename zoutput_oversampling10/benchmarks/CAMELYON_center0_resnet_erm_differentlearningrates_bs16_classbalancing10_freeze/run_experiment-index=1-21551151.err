Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jun 23 13:13:25 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151

 Experiment start at: 2024-06-23 13:18:34.474316
before training, model accuracy: 0.3101629912853241
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.960852, 'precision': 0.956169, 'recall': 0.94052434, 'specificity': 0.94052434, 'f1': 0.94799066, 'auroc': 0.9878813, 'binary_precision': 0.9469952, 'binary_recall': 0.89853203, 'binary_specificity': 0.98251665, 'binary_f1_score': 0.92212737}
confusion matrix:
       0      1
0  41586    740
1   1493  13221
---- Validation: 
scalar performance:
{'acc': 0.95051086, 'precision': 0.6516641, 'recall': 0.6908579, 'specificity': 0.6908579, 'f1': 0.66863453, 'auroc': 0.78927517, 'binary_precision': 0.3243574, 'binary_recall': 0.41213062, 'binary_specificity': 0.9695851, 'binary_f1_score': 0.3630137}
confusion matrix:
       0    1
0  17597  552
1    378  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95286036, 'precision': 0.7059456, 'recall': 0.70971596, 'specificity': 0.70971596, 'f1': 0.70781094, 'auroc': 0.8053886, 'binary_precision': 0.43609023, 'binary_recall': 0.44444445, 'binary_specificity': 0.9749875, 'binary_f1_score': 0.44022772}
confusion matrix:
      0    1
0  5847  150
1   145  116
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-23 13:42:56.931590,epoch time: 0:24:22.457274,used: 0:24:22.457274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97042423, 'precision': 0.96159375, 'recall': 0.9611228, 'specificity': 0.9611228, 'f1': 0.96135795, 'auroc': 0.9929824, 'binary_precision': 0.94337827, 'binary_recall': 0.94190395, 'binary_specificity': 0.9803417, 'binary_f1_score': 0.94264054}
confusion matrix:
       0      1
0  41491    832
1    855  13862
---- Validation: 
scalar performance:
{'acc': 0.9477437, 'precision': 0.6619922, 'recall': 0.76068056, 'specificity': 0.76068056, 'f1': 0.6978321, 'auroc': 0.83801484, 'binary_precision': 0.33994335, 'binary_recall': 0.5598756, 'binary_specificity': 0.9614855, 'binary_f1_score': 0.42303175}
confusion matrix:
       0    1
0  17450  699
1    283  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95206136, 'precision': 0.71084243, 'recall': 0.7642691, 'specificity': 0.7642691, 'f1': 0.7340419, 'auroc': 0.86263824, 'binary_precision': 0.4410876, 'binary_recall': 0.55938697, 'binary_specificity': 0.96915126, 'binary_f1_score': 0.49324325}
confusion matrix:
      0    1
0  5812  185
1   115  146
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_2.png
early stop counter: 1
val acc:0.9477437138557434, best validation acc: 0.9505108594894409, corresponding to test acc:                         0.9528603553771973 / 0.9528603553771973
after epoch: 2,now: 2024-06-23 14:02:49.239259,epoch time: 0:19:52.307669,used: 0:44:14.764943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97443897, 'precision': 0.96942276, 'recall': 0.9634958, 'specificity': 0.9634958, 'f1': 0.96640944, 'auroc': 0.9935887, 'binary_precision': 0.95926565, 'binary_recall': 0.9408847, 'binary_specificity': 0.9861069, 'binary_f1_score': 0.94998634}
confusion matrix:
       0      1
0  41735    588
1    870  13847
---- Validation: 
scalar performance:
{'acc': 0.95764154, 'precision': 0.6943897, 'recall': 0.7440532, 'specificity': 0.7440532, 'f1': 0.71600634, 'auroc': 0.8350818, 'binary_precision': 0.40613496, 'binary_recall': 0.5147745, 'binary_specificity': 0.97333187, 'binary_f1_score': 0.45404664}
confusion matrix:
       0    1
0  17665  484
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.7707123, 'recall': 0.73878896, 'specificity': 0.73878896, 'f1': 0.75361955, 'auroc': 0.8609452, 'binary_precision': 0.5633188, 'binary_recall': 0.49425286, 'binary_specificity': 0.983325, 'binary_f1_score': 0.52653056}
confusion matrix:
      0    1
0  5897  100
1   132  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-23 14:19:22.641636,epoch time: 0:16:33.402377,used: 1:00:48.167320,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97766477, 'precision': 0.97296304, 'recall': 0.9684855, 'specificity': 0.9684855, 'f1': 0.970696, 'auroc': 0.99527884, 'binary_precision': 0.96339446, 'binary_recall': 0.9495176, 'binary_specificity': 0.98745334, 'binary_f1_score': 0.95640564}
confusion matrix:
       0      1
0  41791    531
1    743  13975
---- Validation: 
scalar performance:
{'acc': 0.95918477, 'precision': 0.7004658, 'recall': 0.73660153, 'specificity': 0.73660153, 'f1': 0.7168336, 'auroc': 0.8319068, 'binary_precision': 0.41884816, 'binary_recall': 0.4976672, 'binary_specificity': 0.97553587, 'binary_f1_score': 0.4548685}
confusion matrix:
       0    1
0  17705  444
1    323  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.78595746, 'recall': 0.74162173, 'specificity': 0.74162173, 'f1': 0.7616941, 'auroc': 0.85502565, 'binary_precision': 0.5936073, 'binary_recall': 0.49808428, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.5416666}
confusion matrix:
      0    1
0  5908   89
1   131  130
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-23 14:34:20.322057,epoch time: 0:14:57.680421,used: 1:15:45.847741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9778226, 'precision': 0.9776443, 'recall': 0.96411383, 'specificity': 0.96411383, 'f1': 0.97062755, 'auroc': 0.99544334, 'binary_precision': 0.97729206, 'binary_recall': 0.9357886, 'binary_specificity': 0.9924391, 'binary_f1_score': 0.9560901}
confusion matrix:
       0      1
0  42003    320
1    945  13772
---- Validation: 
scalar performance:
{'acc': 0.9623776, 'precision': 0.71806884, 'recall': 0.73600435, 'specificity': 0.73600435, 'f1': 0.7266372, 'auroc': 0.85752064, 'binary_precision': 0.45415473, 'binary_recall': 0.49300155, 'binary_specificity': 0.9790071, 'binary_f1_score': 0.4727815}
confusion matrix:
       0    1
0  17768  381
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.85195684, 'recall': 0.7167214, 'specificity': 0.7167214, 'f1': 0.76665115, 'auroc': 0.86556625, 'binary_precision': 0.7278481, 'binary_recall': 0.44061303, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.54892606}
confusion matrix:
      0    1
0  5954   43
1   146  115
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-23 14:49:41.715554,epoch time: 0:15:21.393497,used: 1:31:07.241238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.979418, 'precision': 0.97632474, 'recall': 0.9696621, 'specificity': 0.9696621, 'f1': 0.97293174, 'auroc': 0.995756, 'binary_precision': 0.97007567, 'binary_recall': 0.9495073, 'binary_specificity': 0.9898169, 'binary_f1_score': 0.95968133}
confusion matrix:
       0      1
0  41894    431
1    743  13972
---- Validation: 
scalar performance:
{'acc': 0.96110046, 'precision': 0.7133513, 'recall': 0.7555946, 'specificity': 0.7555946, 'f1': 0.7323178, 'auroc': 0.8527118, 'binary_precision': 0.44329897, 'binary_recall': 0.5349922, 'binary_specificity': 0.97619706, 'binary_f1_score': 0.4848485}
confusion matrix:
       0    1
0  17717  432
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.8119438, 'recall': 0.7356264, 'specificity': 0.7356264, 'f1': 0.7678581, 'auroc': 0.87153983, 'binary_precision': 0.64615387, 'binary_recall': 0.4827586, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.5526316}
confusion matrix:
      0    1
0  5928   69
1   135  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_6.png
early stop counter: 1
val acc:0.9611004590988159, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 6,now: 2024-06-23 15:04:43.463330,epoch time: 0:15:01.747776,used: 1:46:08.989014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9809432, 'precision': 0.9803558, 'recall': 0.9696259, 'specificity': 0.9696259, 'f1': 0.97483325, 'auroc': 0.9961585, 'binary_precision': 0.97918427, 'binary_recall': 0.9462453, 'binary_specificity': 0.99300647, 'binary_f1_score': 0.96243304}
confusion matrix:
       0      1
0  42029    296
1    791  13924
---- Validation: 
scalar performance:
{'acc': 0.96152616, 'precision': 0.7122256, 'recall': 0.7303132, 'specificity': 0.7303132, 'f1': 0.72085166, 'auroc': 0.84375066, 'binary_precision': 0.44285715, 'binary_recall': 0.4821151, 'binary_specificity': 0.9785112, 'binary_f1_score': 0.46165302}
confusion matrix:
       0    1
0  17759  390
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8043605, 'recall': 0.7184684, 'specificity': 0.7184684, 'f1': 0.7535498, 'auroc': 0.86424756, 'binary_precision': 0.63243246, 'binary_recall': 0.44827586, 'binary_specificity': 0.988661, 'binary_f1_score': 0.52466375}
confusion matrix:
      0    1
0  5929   68
1   144  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_7.png
early stop counter: 2
val acc:0.9615261554718018, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 7,now: 2024-06-23 15:21:18.202976,epoch time: 0:16:34.739646,used: 2:02:43.728660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98183733, 'precision': 0.9767466, 'recall': 0.9757731, 'specificity': 0.9757731, 'f1': 0.9762585, 'auroc': 0.9960377, 'binary_precision': 0.9662623, 'binary_recall': 0.9632423, 'binary_specificity': 0.98830396, 'binary_f1_score': 0.96474993}
confusion matrix:
       0      1
0  41827    495
1    541  14177
---- Validation: 
scalar performance:
{'acc': 0.9556194, 'precision': 0.6905157, 'recall': 0.76925826, 'specificity': 0.76925826, 'f1': 0.722139, 'auroc': 0.86287355, 'binary_precision': 0.39653304, 'binary_recall': 0.56920683, 'binary_specificity': 0.9693096, 'binary_f1_score': 0.46743298}
confusion matrix:
       0    1
0  17592  557
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.7666764, 'recall': 0.72929376, 'specificity': 0.72929376, 'f1': 0.7463911, 'auroc': 0.86710215, 'binary_precision': 0.5560538, 'binary_recall': 0.47509578, 'binary_specificity': 0.9834917, 'binary_f1_score': 0.51239663}
confusion matrix:
      0    1
0  5898   99
1   137  124
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_8.png
early stop counter: 3
val acc:0.9556193947792053, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 8,now: 2024-06-23 15:40:50.595710,epoch time: 0:19:32.392734,used: 2:22:16.121394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9819425, 'precision': 0.9800832, 'recall': 0.9725425, 'specificity': 0.9725425, 'f1': 0.9762347, 'auroc': 0.9965745, 'binary_precision': 0.9763363, 'binary_recall': 0.9531186, 'binary_specificity': 0.99196637, 'binary_f1_score': 0.96458775}
confusion matrix:
       0      1
0  41982    340
1    690  14028
---- Validation: 
scalar performance:
{'acc': 0.9618987, 'precision': 0.71497357, 'recall': 0.73425627, 'specificity': 0.73425627, 'f1': 0.7241476, 'auroc': 0.8459856, 'binary_precision': 0.44807965, 'binary_recall': 0.48989114, 'binary_specificity': 0.9786214, 'binary_f1_score': 0.4680535}
confusion matrix:
       0    1
0  17761  388
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.83467674, 'recall': 0.70481026, 'specificity': 0.70481026, 'f1': 0.75249976, 'auroc': 0.8575589, 'binary_precision': 0.6942675, 'binary_recall': 0.41762453, 'binary_specificity': 0.991996, 'binary_f1_score': 0.52153116}
confusion matrix:
      0    1
0  5949   48
1   152  109
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_9.png
early stop counter: 4
val acc:0.961898684501648, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 9,now: 2024-06-23 15:56:01.308497,epoch time: 0:15:10.712787,used: 2:37:26.834181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98269635, 'precision': 0.9792874, 'recall': 0.9753734, 'specificity': 0.9753734, 'f1': 0.97730917, 'auroc': 0.99688715, 'binary_precision': 0.9723369, 'binary_recall': 0.96024466, 'binary_specificity': 0.99050206, 'binary_f1_score': 0.9662529}
confusion matrix:
       0      1
0  41923    402
1    585  14130
---- Validation: 
scalar performance:
{'acc': 0.95992976, 'precision': 0.7075683, 'recall': 0.7572387, 'specificity': 0.7572387, 'f1': 0.7293878, 'auroc': 0.8531554, 'binary_precision': 0.43159205, 'binary_recall': 0.53965783, 'binary_specificity': 0.97481954, 'binary_f1_score': 0.479613}
confusion matrix:
       0    1
0  17692  457
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.80417114, 'recall': 0.7240488, 'specificity': 0.7240488, 'f1': 0.7573311, 'auroc': 0.86512846, 'binary_precision': 0.6315789, 'binary_recall': 0.4597701, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.53215075}
confusion matrix:
      0    1
0  5927   70
1   141  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_10.png
early stop counter: 5
val acc:0.9599297642707825, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9697986841201782 / 0.9697986841201782
after epoch: 10,now: 2024-06-23 16:10:56.525984,epoch time: 0:14:55.217487,used: 2:52:22.051668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9826438, 'precision': 0.981431, 'recall': 0.9730357, 'specificity': 0.9730357, 'f1': 0.97713685, 'auroc': 0.99648273, 'binary_precision': 0.97899365, 'binary_recall': 0.9531834, 'binary_specificity': 0.99288803, 'binary_f1_score': 0.9659161}
confusion matrix:
       0      1
0  42022    301
1    689  14028
---- Validation: 
scalar performance:
{'acc': 0.9632822, 'precision': 0.72359073, 'recall': 0.7349726, 'specificity': 0.7349726, 'f1': 0.7291228, 'auroc': 0.8525231, 'binary_precision': 0.46528804, 'binary_recall': 0.48989114, 'binary_specificity': 0.980054, 'binary_f1_score': 0.47727272}
confusion matrix:
       0    1
0  17787  362
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8047601, 'recall': 0.6457568, 'specificity': 0.6457568, 'f1': 0.6943007, 'auroc': 0.84803367, 'binary_precision': 0.6393443, 'binary_recall': 0.29885057, 'binary_specificity': 0.992663, 'binary_f1_score': 0.4073107}
confusion matrix:
      0   1
0  5953  44
1   183  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_11.png
better model found
persisted
after epoch: 11,now: 2024-06-23 16:26:11.817868,epoch time: 0:15:15.291884,used: 3:07:37.343552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9834151, 'precision': 0.978097, 'recall': 0.9786053, 'specificity': 0.9786053, 'f1': 0.97835076, 'auroc': 0.99745655, 'binary_precision': 0.96709186, 'binary_recall': 0.9686693, 'binary_specificity': 0.9885413, 'binary_f1_score': 0.9678799}
confusion matrix:
       0      1
0  41841    485
1    461  14253
---- Validation: 
scalar performance:
{'acc': 0.95881224, 'precision': 0.70351124, 'recall': 0.76566076, 'specificity': 0.76566076, 'f1': 0.729894, 'auroc': 0.86702776, 'binary_precision': 0.4228504, 'binary_recall': 0.55832034, 'binary_specificity': 0.97300124, 'binary_f1_score': 0.4812332}
confusion matrix:
       0    1
0  17659  490
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.780115, 'recall': 0.7042247, 'specificity': 0.7042247, 'f1': 0.73550016, 'auroc': 0.86680824, 'binary_precision': 0.5851064, 'binary_recall': 0.42145595, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.48997772}
confusion matrix:
      0    1
0  5919   78
1   151  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_12.png
early stop counter: 1
val acc:0.9588122367858887, best validation acc: 0.9632822275161743, corresponding to test acc:                         0.9637264013290405 / 0.9697986841201782
after epoch: 12,now: 2024-06-23 16:41:03.355642,epoch time: 0:14:51.537774,used: 3:22:28.881326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9799439, 'precision': 0.98238313, 'recall': 0.96510226, 'specificity': 0.96510226, 'f1': 0.9733393, 'auroc': 0.9964517, 'binary_precision': 0.98715186, 'binary_recall': 0.934434, 'binary_specificity': 0.9957705, 'binary_f1_score': 0.9600698}
confusion matrix:
       0      1
0  42143    179
1    965  13753
---- Validation: 
scalar performance:
{'acc': 0.9632822, 'precision': 0.7191628, 'recall': 0.69671977, 'specificity': 0.69671977, 'f1': 0.7072619, 'auroc': 0.8714308, 'binary_precision': 0.45913044, 'binary_recall': 0.41057542, 'binary_specificity': 0.9828641, 'binary_f1_score': 0.43349755}
confusion matrix:
       0    1
0  17838  311
1    379  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96324706, 'precision': 0.83651304, 'recall': 0.5996983, 'specificity': 0.5996983, 'f1': 0.6482964, 'auroc': 0.85138696, 'binary_precision': 0.70666665, 'binary_recall': 0.20306513, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.3154762}
confusion matrix:
      0   1
0  5975  22
1   208  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_13.png
early stop counter: 2
val acc:0.9632822275161743, best validation acc: 0.9632822275161743, corresponding to test acc:                         0.9637264013290405 / 0.9697986841201782
after epoch: 13,now: 2024-06-23 16:56:01.657529,epoch time: 0:14:58.301887,used: 3:37:27.183213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98345023, 'precision': 0.9807172, 'recall': 0.975906, 'specificity': 0.975906, 'f1': 0.9782797, 'auroc': 0.9968823, 'binary_precision': 0.9751604, 'binary_recall': 0.960318, 'binary_specificity': 0.991494, 'binary_f1_score': 0.9676823}
confusion matrix:
       0      1
0  41963    360
1    584  14133
---- Validation: 
scalar performance:
{'acc': 0.96141976, 'precision': 0.7143018, 'recall': 0.74975944, 'specificity': 0.74975944, 'f1': 0.73049796, 'auroc': 0.85292864, 'binary_precision': 0.44562334, 'binary_recall': 0.5225505, 'binary_specificity': 0.9769684, 'binary_f1_score': 0.4810308}
confusion matrix:
       0    1
0  17731  418
1    307  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7464137, 'recall': 0.6526673, 'specificity': 0.6526673, 'f1': 0.6871197, 'auroc': 0.8459625, 'binary_precision': 0.5220126, 'binary_recall': 0.31800765, 'binary_specificity': 0.987327, 'binary_f1_score': 0.3952381}
confusion matrix:
      0   1
0  5921  76
1   178  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_14.png
early stop counter: 3
val acc:0.9614197611808777, best validation acc: 0.9632822275161743, corresponding to test acc:                         0.9637264013290405 / 0.9697986841201782
after epoch: 14,now: 2024-06-23 17:11:11.462903,epoch time: 0:15:09.805374,used: 3:52:36.988587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9842742, 'precision': 0.98267925, 'recall': 0.9760793, 'specificity': 0.9760793, 'f1': 0.9793197, 'auroc': 0.9970999, 'binary_precision': 0.9794558, 'binary_recall': 0.95915174, 'binary_specificity': 0.9930068, 'binary_f1_score': 0.96919745}
confusion matrix:
       0      1
0  42031    296
1    601  14112
---- Validation: 
scalar performance:
{'acc': 0.96168584, 'precision': 0.7113123, 'recall': 0.7176449, 'specificity': 0.7176449, 'f1': 0.7144258, 'auroc': 0.8563324, 'binary_precision': 0.44193062, 'binary_recall': 0.45567653, 'binary_specificity': 0.9796132, 'binary_f1_score': 0.4486983}
confusion matrix:
       0    1
0  17779  370
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.8017243, 'recall': 0.6512538, 'specificity': 0.6512538, 'f1': 0.69886696, 'auroc': 0.8530549, 'binary_precision': 0.6328125, 'binary_recall': 0.31034482, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.41645244}
confusion matrix:
      0   1
0  5950  47
1   180  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_15.png
early stop counter: 4
val acc:0.961685836315155, best validation acc: 0.9632822275161743, corresponding to test acc:                         0.9637264013290405 / 0.9697986841201782
after epoch: 15,now: 2024-06-23 17:26:08.098010,epoch time: 0:14:56.635107,used: 4:07:33.623694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9847125, 'precision': 0.9804659, 'recall': 0.97957003, 'specificity': 0.97957003, 'f1': 0.9800168, 'auroc': 0.99750084, 'binary_precision': 0.97171867, 'binary_recall': 0.9689454, 'binary_specificity': 0.9901947, 'binary_f1_score': 0.97033006}
confusion matrix:
       0      1
0  41909    415
1    457  14259
---- Validation: 
scalar performance:
{'acc': 0.95679015, 'precision': 0.6940313, 'recall': 0.7623638, 'specificity': 0.7623638, 'f1': 0.72233677, 'auroc': 0.86205125, 'binary_precision': 0.40408626, 'binary_recall': 0.55365473, 'binary_specificity': 0.9710728, 'binary_f1_score': 0.46719158}
confusion matrix:
       0    1
0  17624  525
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542985, 'precision': 0.7101469, 'recall': 0.68847835, 'specificity': 0.68847835, 'f1': 0.6986314, 'auroc': 0.853831, 'binary_precision': 0.44635195, 'binary_recall': 0.39846742, 'binary_specificity': 0.9784892, 'binary_f1_score': 0.42105263}
confusion matrix:
      0    1
0  5868  129
1   157  104
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_16.png
early stop counter: 5
val acc:0.9567901492118835, best validation acc: 0.9632822275161743, corresponding to test acc:                         0.9637264013290405 / 0.9697986841201782
after epoch: 16,now: 2024-06-23 17:42:34.487159,epoch time: 0:16:26.389149,used: 4:24:00.012843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9836781, 'precision': 0.9795775, 'recall': 0.97772264, 'specificity': 0.97772264, 'f1': 0.9786453, 'auroc': 0.99728835, 'binary_precision': 0.97115713, 'binary_recall': 0.9654165, 'binary_specificity': 0.9900288, 'binary_f1_score': 0.9682783}
confusion matrix:
       0      1
0  41900    422
1    509  14209
---- Validation: 
scalar performance:
{'acc': 0.9575883, 'precision': 0.6975376, 'recall': 0.762777, 'specificity': 0.762777, 'f1': 0.7248714, 'auroc': 0.8552705, 'binary_precision': 0.41108546, 'binary_recall': 0.55365473, 'binary_specificity': 0.9718993, 'binary_f1_score': 0.47183567}
confusion matrix:
       0    1
0  17639  510
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95286036, 'precision': 0.69072753, 'recall': 0.6419196, 'specificity': 0.6419196, 'f1': 0.66216546, 'auroc': 0.83910394, 'binary_precision': 0.41145834, 'binary_recall': 0.30268198, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.34878588}
confusion matrix:
      0    1
0  5884  113
1   182   79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_17.png
early stop counter: 6
val acc:0.9575883150100708, best validation acc: 0.9632822275161743, corresponding to test acc:                         0.9637264013290405 / 0.9697986841201782
after epoch: 17,now: 2024-06-23 17:57:23.564837,epoch time: 0:14:49.077678,used: 4:38:49.090521,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.982159, 'recall': 0.97839606, 'specificity': 0.97839606, 'f1': 0.98025805, 'auroc': 0.99736774, 'binary_precision': 0.9764835, 'binary_recall': 0.96487296, 'binary_specificity': 0.9919191, 'binary_f1_score': 0.9706435}
confusion matrix:
       0      1
0  41980    342
1    517  14201
---- Validation: 
scalar performance:
{'acc': 0.95828015, 'precision': 0.6986343, 'recall': 0.7511343, 'specificity': 0.7511343, 'f1': 0.7213877, 'auroc': 0.8658061, 'binary_precision': 0.4141291, 'binary_recall': 0.5287714, 'binary_specificity': 0.97349715, 'binary_f1_score': 0.46448085}
confusion matrix:
       0    1
0  17668  481
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.74190557, 'recall': 0.68906385, 'specificity': 0.68906385, 'f1': 0.71180093, 'auroc': 0.85945785, 'binary_precision': 0.509901, 'binary_recall': 0.394636, 'binary_specificity': 0.9834917, 'binary_f1_score': 0.4449244}
confusion matrix:
      0    1
0  5898   99
1   158  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_18.png
early stop counter: 7
val acc:0.9582801461219788, best validation acc: 0.9632822275161743, corresponding to test acc:                         0.9637264013290405 / 0.9697986841201782
after epoch: 18,now: 2024-06-23 18:12:26.679828,epoch time: 0:15:03.114991,used: 4:53:52.205512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98585206, 'precision': 0.9833154, 'recall': 0.97962976, 'specificity': 0.97962976, 'f1': 0.98145396, 'auroc': 0.997453, 'binary_precision': 0.9781383, 'binary_recall': 0.9667731, 'binary_specificity': 0.99248636, 'binary_f1_score': 0.9724225}
confusion matrix:
       0      1
0  42005    318
1    489  14228
---- Validation: 
scalar performance:
{'acc': 0.95875907, 'precision': 0.70067865, 'recall': 0.7498821, 'specificity': 0.7498821, 'f1': 0.7222185, 'auroc': 0.8699364, 'binary_precision': 0.41831684, 'binary_recall': 0.525661, 'binary_specificity': 0.9741033, 'binary_f1_score': 0.4658856}
confusion matrix:
       0    1
0  17679  470
1    305  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.7292024, 'recall': 0.64808553, 'specificity': 0.64808553, 'f1': 0.67873514, 'auroc': 0.8520071, 'binary_precision': 0.48795182, 'binary_recall': 0.31034482, 'binary_specificity': 0.98582625, 'binary_f1_score': 0.3793911}
confusion matrix:
      0   1
0  5912  85
1   180  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_19.png
early stop counter: 8
val acc:0.958759069442749, best validation acc: 0.9632822275161743, corresponding to test acc:                         0.9637264013290405 / 0.9697986841201782
after epoch: 19,now: 2024-06-23 18:27:16.032307,epoch time: 0:14:49.352479,used: 5:08:41.557991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9857644, 'precision': 0.98440194, 'recall': 0.9782865, 'specificity': 0.9782865, 'f1': 0.9812933, 'auroc': 0.99755394, 'binary_precision': 0.98164314, 'binary_recall': 0.9628346, 'binary_specificity': 0.9937385, 'binary_f1_score': 0.9721479}
confusion matrix:
       0      1
0  42057    265
1    547  14171
---- Validation: 
scalar performance:
{'acc': 0.9605683, 'precision': 0.70567465, 'recall': 0.7238168, 'specificity': 0.7238168, 'f1': 0.7143115, 'auroc': 0.8693271, 'binary_precision': 0.43019944, 'binary_recall': 0.4696734, 'binary_specificity': 0.9779602, 'binary_f1_score': 0.44907063}
confusion matrix:
       0    1
0  17749  400
1    341  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.75946283, 'recall': 0.62010217, 'specificity': 0.62010217, 'f1': 0.66124606, 'auroc': 0.8496866, 'binary_precision': 0.5508475, 'binary_recall': 0.24904214, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.3430079}
confusion matrix:
      0   1
0  5944  53
1   196  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_20.png
early stop counter: 9
val acc:0.9605683088302612, best validation acc: 0.9632822275161743, corresponding to test acc:                         0.9637264013290405 / 0.9697986841201782
after epoch: 20,now: 2024-06-23 18:42:03.707393,epoch time: 0:14:47.675086,used: 5:23:29.233077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9848878, 'precision': 0.98495245, 'recall': 0.97543, 'specificity': 0.97543, 'f1': 0.98006845, 'auroc': 0.997491, 'binary_precision': 0.985082, 'binary_recall': 0.9558923, 'binary_specificity': 0.99496764, 'binary_f1_score': 0.97026765}
confusion matrix:
       0      1
0  42113    213
1    649  14065
---- Validation: 
scalar performance:
{'acc': 0.964453, 'precision': 0.7285745, 'recall': 0.7003261, 'specificity': 0.7003261, 'f1': 0.7134105, 'auroc': 0.8549206, 'binary_precision': 0.47771835, 'binary_recall': 0.41679627, 'binary_specificity': 0.98385584, 'binary_f1_score': 0.4451827}
confusion matrix:
       0    1
0  17856  293
1    375  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.7961904, 'recall': 0.61194104, 'specificity': 0.61194104, 'f1': 0.6583214, 'auroc': 0.84495556, 'binary_precision': 0.625, 'binary_recall': 0.22988506, 'binary_specificity': 0.993997, 'binary_f1_score': 0.33613446}
confusion matrix:
      0   1
0  5961  36
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_21.png
better model found
persisted
after epoch: 21,now: 2024-06-23 18:56:55.973317,epoch time: 0:14:52.265924,used: 5:38:21.499001,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98467743, 'precision': 0.97966653, 'recall': 0.98034596, 'specificity': 0.98034596, 'f1': 0.9800056, 'auroc': 0.99773216, 'binary_precision': 0.9692881, 'binary_recall': 0.97139555, 'binary_specificity': 0.9892964, 'binary_f1_score': 0.9703407}
confusion matrix:
       0      1
0  41869    453
1    421  14297
---- Validation: 
scalar performance:
{'acc': 0.957748, 'precision': 0.69914085, 'recall': 0.76811004, 'specificity': 0.76811004, 'f1': 0.7278076, 'auroc': 0.8753877, 'binary_precision': 0.41391107, 'binary_recall': 0.5645412, 'binary_specificity': 0.97167885, 'binary_f1_score': 0.47763157}
confusion matrix:
       0    1
0  17635  514
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95286036, 'precision': 0.69379747, 'recall': 0.65291363, 'specificity': 0.65291363, 'f1': 0.670556, 'auroc': 0.8518225, 'binary_precision': 0.41666666, 'binary_recall': 0.3256705, 'binary_specificity': 0.9801567, 'binary_f1_score': 0.36559138}
confusion matrix:
      0    1
0  5878  119
1   176   85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_22.png
early stop counter: 1
val acc:0.9577479958534241, best validation acc: 0.9644529819488525, corresponding to test acc:                         0.9621284604072571 / 0.9697986841201782
after epoch: 22,now: 2024-06-23 19:11:39.661814,epoch time: 0:14:43.688497,used: 5:53:05.187498,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98457223, 'precision': 0.98530734, 'recall': 0.9742688, 'specificity': 0.9742688, 'f1': 0.97962356, 'auroc': 0.9974319, 'binary_precision': 0.98677266, 'binary_recall': 0.95297956, 'binary_specificity': 0.99555796, 'binary_f1_score': 0.9695818}
confusion matrix:
       0      1
0  42135    188
1    692  14025
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.73592865, 'recall': 0.69854426, 'specificity': 0.69854426, 'f1': 0.71544456, 'auroc': 0.8571291, 'binary_precision': 0.49256507, 'binary_recall': 0.41213062, 'binary_specificity': 0.9849579, 'binary_f1_score': 0.44877222}
confusion matrix:
       0    1
0  17876  273
1    378  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.80265003, 'recall': 0.640093, 'specificity': 0.640093, 'f1': 0.6884552, 'auroc': 0.8508463, 'binary_precision': 0.63559324, 'binary_recall': 0.28735632, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.39577836}
confusion matrix:
      0   1
0  5954  43
1   186  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_23.png
better model found
persisted
after epoch: 23,now: 2024-06-23 19:26:40.799470,epoch time: 0:15:01.137656,used: 6:08:06.325154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9858345, 'precision': 0.9834517, 'recall': 0.97943854, 'specificity': 0.97943854, 'f1': 0.9814231, 'auroc': 0.99773693, 'binary_precision': 0.97859454, 'binary_recall': 0.96622497, 'binary_specificity': 0.9926521, 'binary_f1_score': 0.97237045}
confusion matrix:
       0      1
0  42014    311
1    497  14218
---- Validation: 
scalar performance:
{'acc': 0.95753515, 'precision': 0.6958398, 'recall': 0.75449884, 'specificity': 0.75449884, 'f1': 0.720801, 'auroc': 0.86958855, 'binary_precision': 0.40828404, 'binary_recall': 0.5365474, 'binary_specificity': 0.97245026, 'binary_f1_score': 0.46370965}
confusion matrix:
       0    1
0  17649  500
1    298  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95653564, 'precision': 0.7234515, 'recall': 0.68048394, 'specificity': 0.68048394, 'f1': 0.6993483, 'auroc': 0.85062456, 'binary_precision': 0.47368422, 'binary_recall': 0.37931034, 'binary_specificity': 0.9816575, 'binary_f1_score': 0.4212766}
confusion matrix:
      0    1
0  5887  110
1   162   99
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_24.png
early stop counter: 1
val acc:0.9575351476669312, best validation acc: 0.9653576016426086, corresponding to test acc:                         0.9634068608283997 / 0.9697986841201782
after epoch: 24,now: 2024-06-23 19:41:42.102381,epoch time: 0:15:01.302911,used: 6:23:07.628065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9858345, 'precision': 0.9847137, 'recall': 0.9781541, 'specificity': 0.9781541, 'f1': 0.9813754, 'auroc': 0.9973837, 'binary_precision': 0.9824476, 'binary_recall': 0.96228594, 'binary_specificity': 0.9940223, 'binary_f1_score': 0.97226226}
confusion matrix:
       0      1
0  42071    253
1    555  14161
---- Validation: 
scalar performance:
{'acc': 0.963708, 'precision': 0.7242246, 'recall': 0.7134414, 'specificity': 0.7134414, 'f1': 0.71868396, 'auroc': 0.86813134, 'binary_precision': 0.4680851, 'binary_recall': 0.44479004, 'binary_specificity': 0.9820927, 'binary_f1_score': 0.45614034}
confusion matrix:
       0    1
0  17824  325
1    357  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7689097, 'recall': 0.6389258, 'specificity': 0.6389258, 'f1': 0.6808175, 'auroc': 0.85368437, 'binary_precision': 0.5681818, 'binary_recall': 0.28735632, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.3816794}
confusion matrix:
      0   1
0  5940  57
1   186  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_25.png
early stop counter: 2
val acc:0.9637079834938049, best validation acc: 0.9653576016426086, corresponding to test acc:                         0.9634068608283997 / 0.9697986841201782
after epoch: 25,now: 2024-06-23 19:56:33.346165,epoch time: 0:14:51.243784,used: 6:37:58.871849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9847475, 'precision': 0.98481154, 'recall': 0.9752054, 'specificity': 0.9752054, 'f1': 0.97988355, 'auroc': 0.997206, 'binary_precision': 0.98493975, 'binary_recall': 0.95549065, 'binary_specificity': 0.99492013, 'binary_f1_score': 0.96999174}
confusion matrix:
       0      1
0  42109    215
1    655  14061
---- Validation: 
scalar performance:
{'acc': 0.96376115, 'precision': 0.72238505, 'recall': 0.6932174, 'specificity': 0.6932174, 'f1': 0.7066551, 'auroc': 0.85998565, 'binary_precision': 0.46582735, 'binary_recall': 0.40279937, 'binary_specificity': 0.9836355, 'binary_f1_score': 0.43202668}
confusion matrix:
       0    1
0  17852  297
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.7684362, 'recall': 0.60561025, 'specificity': 0.60561025, 'f1': 0.6477343, 'auroc': 0.83762074, 'binary_precision': 0.57, 'binary_recall': 0.21839081, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.31578946}
confusion matrix:
      0   1
0  5954  43
1   204  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_26.png
early stop counter: 3
val acc:0.9637611508369446, best validation acc: 0.9653576016426086, corresponding to test acc:                         0.9634068608283997 / 0.9697986841201782
after epoch: 26,now: 2024-06-23 20:11:38.083929,epoch time: 0:15:04.737764,used: 6:53:03.609613,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98515075, 'precision': 0.98502064, 'recall': 0.9760519, 'specificity': 0.9760519, 'f1': 0.9804273, 'auroc': 0.99758124, 'binary_precision': 0.9847595, 'binary_recall': 0.9572545, 'binary_specificity': 0.9948494, 'binary_f1_score': 0.97081226}
confusion matrix:
       0      1
0  42107    218
1    629  14086
---- Validation: 
scalar performance:
{'acc': 0.96259046, 'precision': 0.7174294, 'recall': 0.7203634, 'specificity': 0.7203634, 'f1': 0.7188853, 'auroc': 0.8535131, 'binary_precision': 0.45398772, 'binary_recall': 0.46034214, 'binary_specificity': 0.9803846, 'binary_f1_score': 0.45714283}
confusion matrix:
       0    1
0  17793  356
1    347  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.77676284, 'recall': 0.6651621, 'specificity': 0.6651621, 'f1': 0.70522535, 'auroc': 0.8543948, 'binary_precision': 0.5816994, 'binary_recall': 0.34099618, 'binary_specificity': 0.989328, 'binary_f1_score': 0.4299517}
confusion matrix:
      0   1
0  5933  64
1   172  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_27.png
early stop counter: 4
val acc:0.9625904560089111, best validation acc: 0.9653576016426086, corresponding to test acc:                         0.9634068608283997 / 0.9697986841201782
after epoch: 27,now: 2024-06-23 20:26:28.656618,epoch time: 0:14:50.572689,used: 7:07:54.182302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98543125, 'precision': 0.9832112, 'recall': 0.9786138, 'specificity': 0.9786138, 'f1': 0.98088354, 'auroc': 0.99743557, 'binary_precision': 0.9786941, 'binary_recall': 0.9645284, 'binary_specificity': 0.9926992, 'binary_f1_score': 0.9715595}
confusion matrix:
       0      1
0  42015    309
1    522  14194
---- Validation: 
scalar performance:
{'acc': 0.96062154, 'precision': 0.7093992, 'recall': 0.74559593, 'specificity': 0.74559593, 'f1': 0.72586524, 'auroc': 0.8643906, 'binary_precision': 0.43610013, 'binary_recall': 0.5147745, 'binary_specificity': 0.9764174, 'binary_f1_score': 0.47218257}
confusion matrix:
       0    1
0  17721  428
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.7533138, 'recall': 0.65116847, 'specificity': 0.65116847, 'f1': 0.6877388, 'auroc': 0.84394866, 'binary_precision': 0.53594774, 'binary_recall': 0.31417623, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.39613527}
confusion matrix:
      0   1
0  5926  71
1   179  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_28.png
early stop counter: 5
val acc:0.9606215357780457, best validation acc: 0.9653576016426086, corresponding to test acc:                         0.9634068608283997 / 0.9697986841201782
after epoch: 28,now: 2024-06-23 20:41:31.273448,epoch time: 0:15:02.616830,used: 7:22:56.799132,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98553646, 'precision': 0.9819912, 'recall': 0.9801696, 'specificity': 0.9801696, 'f1': 0.9810758, 'auroc': 0.9974109, 'binary_precision': 0.97471124, 'binary_recall': 0.9690813, 'binary_specificity': 0.9912579, 'binary_f1_score': 0.97188807}
confusion matrix:
       0      1
0  41954    370
1    455  14261
---- Validation: 
scalar performance:
{'acc': 0.95838654, 'precision': 0.699915, 'recall': 0.75568974, 'specificity': 0.75568974, 'f1': 0.72390735, 'auroc': 0.86906314, 'binary_precision': 0.41636583, 'binary_recall': 0.5381026, 'binary_specificity': 0.9732768, 'binary_f1_score': 0.4694708}
confusion matrix:
       0    1
0  17664  485
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95222116, 'precision': 0.6870862, 'recall': 0.64341843, 'specificity': 0.64341843, 'f1': 0.66189253, 'auroc': 0.842188, 'binary_precision': 0.4040404, 'binary_recall': 0.3065134, 'binary_specificity': 0.9803235, 'binary_f1_score': 0.34858388}
confusion matrix:
      0    1
0  5879  118
1   181   80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_29.png
early stop counter: 6
val acc:0.9583865404129028, best validation acc: 0.9653576016426086, corresponding to test acc:                         0.9634068608283997 / 0.9697986841201782
after epoch: 29,now: 2024-06-23 20:56:25.772545,epoch time: 0:14:54.499097,used: 7:37:51.298229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9856066, 'precision': 0.9826522, 'recall': 0.9796638, 'specificity': 0.9796638, 'f1': 0.98114574, 'auroc': 0.9975729, 'binary_precision': 0.9766086, 'binary_recall': 0.96738464, 'binary_specificity': 0.99194294, 'binary_f1_score': 0.97197473}
confusion matrix:
       0      1
0  41982    341
1    480  14237
---- Validation: 
scalar performance:
{'acc': 0.962218, 'precision': 0.71700054, 'recall': 0.7351716, 'specificity': 0.7351716, 'f1': 0.7256742, 'auroc': 0.88028127, 'binary_precision': 0.45207438, 'binary_recall': 0.49144635, 'binary_specificity': 0.9788969, 'binary_f1_score': 0.4709389}
confusion matrix:
       0    1
0  17766  383
1    327  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.79467636, 'recall': 0.6193538, 'specificity': 0.6193538, 'f1': 0.66611385, 'auroc': 0.8483426, 'binary_precision': 0.6213592, 'binary_recall': 0.24521072, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.35164833}
confusion matrix:
      0   1
0  5958  39
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_30.png
early stop counter: 7
val acc:0.9622179865837097, best validation acc: 0.9653576016426086, corresponding to test acc:                         0.9634068608283997 / 0.9697986841201782
after epoch: 30,now: 2024-06-23 21:11:44.565207,epoch time: 0:15:18.792662,used: 7:53:10.090891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_13_18_34_seed_0_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:53:10.090891 at 2024-06-23 21:11:44.565207
persisted model performance metric: 

scalar performance:
{'acc': 0.96340686, 'precision': 0.80265003, 'recall': 0.640093, 'specificity': 0.640093, 'f1': 0.6884552, 'auroc': 0.8508463, 'binary_precision': 0.63559324, 'binary_recall': 0.28735632, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.39577836}
confusion matrix:
      0   1
0  5954  43
1   186  75
oracle model performance metric: 

scalar performance:
{'acc': 0.9697987, 'precision': 0.85195684, 'recall': 0.7167214, 'specificity': 0.7167214, 'f1': 0.76665115, 'auroc': 0.86556625, 'binary_precision': 0.7278481, 'binary_recall': 0.44061303, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.54892606}
confusion matrix:
      0    1
0  5954   43
1   146  115
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204979 KiB | 640729 KiB |   1151 TiB |   1151 TiB |
|       from large pool | 167936 KiB | 568000 KiB |   1151 TiB |   1151 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204979 KiB | 640729 KiB |   1151 TiB |   1151 TiB |
|       from large pool | 167936 KiB | 568000 KiB |   1151 TiB |   1151 TiB |
|       from small pool |  37043 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201088 KiB | 632296 KiB |   1149 TiB |   1149 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   1148 TiB |   1148 TiB |
|       from small pool |  35968 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 755712 KiB | 755712 KiB | 755712 KiB |      0 B   |
|       from large pool | 679936 KiB | 679936 KiB | 679936 KiB |      0 B   |
|       from small pool |  75776 KiB |  75776 KiB |  75776 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  81740 KiB | 217798 KiB | 464906 GiB | 464906 GiB |
|       from large pool |  67584 KiB | 213792 KiB | 464521 GiB | 464521 GiB |
|       from small pool |  14156 KiB |  14156 KiB |    384 GiB |    384 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3252    |    7879    |  101973 K  |  101969 K  |
|       from large pool |      36    |      76    |   41347 K  |   41347 K  |
|       from small pool |    3216    |    7842    |   60625 K  |   60622 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3252    |    7879    |  101973 K  |  101969 K  |
|       from large pool |      36    |      76    |   41347 K  |   41347 K  |
|       from small pool |    3216    |    7842    |   60625 K  |   60622 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      51    |       0    |
|       from large pool |      14    |      14    |      14    |       0    |
|       from small pool |      37    |      37    |      37    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    3581    |   45849 K  |   45849 K  |
|       from large pool |       7    |      11    |   14786 K  |   14786 K  |
|       from small pool |      32    |    3574    |   31062 K  |   31062 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1151 TiB |   1151 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1151 TiB |   1151 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1151 TiB |   1151 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1151 TiB |   1151 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1149 TiB |   1149 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1148 TiB |   1148 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 755712 KiB | 755712 KiB | 468992 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  51200 KiB |  75776 KiB |  75776 KiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 217798 KiB | 464906 GiB | 464906 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 464521 GiB | 464521 GiB |
|       from small pool |      0 KiB |  21751 KiB |    384 GiB |    384 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  101973 K  |  101973 K  |
|       from large pool |       2    |      76    |   41347 K  |   41347 K  |
|       from small pool |       0    |    7842    |   60625 K  |   60625 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  101973 K  |  101973 K  |
|       from large pool |       2    |      76    |   41347 K  |   41347 K  |
|       from small pool |       0    |    7842    |   60625 K  |   60625 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      51    |      51    |      16    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      25    |      37    |      37    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   45850 K  |   45850 K  |
|       from large pool |       3    |      13    |   14786 K  |   14786 K  |
|       from small pool |       0    |    3574    |   31063 K  |   31063 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   1151 TiB |   1151 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1151 TiB |   1151 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   1151 TiB |   1151 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   1151 TiB |   1151 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   1149 TiB |   1149 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   1148 TiB |   1148 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 755712 KiB | 755712 KiB | 468992 KiB |
|       from large pool | 235520 KiB | 679936 KiB | 679936 KiB | 444416 KiB |
|       from small pool |  51200 KiB |  75776 KiB |  75776 KiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 217798 KiB | 464906 GiB | 464906 GiB |
|       from large pool |  55040 KiB | 213792 KiB | 464521 GiB | 464521 GiB |
|       from small pool |      0 KiB |  21751 KiB |    384 GiB |    384 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  101973 K  |  101973 K  |
|       from large pool |       2    |      76    |   41347 K  |   41347 K  |
|       from small pool |       0    |    7842    |   60625 K  |   60625 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  101973 K  |  101973 K  |
|       from large pool |       2    |      76    |   41347 K  |   41347 K  |
|       from small pool |       0    |    7842    |   60625 K  |   60625 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      51    |      51    |      16    |
|       from large pool |      10    |      14    |      14    |       4    |
|       from small pool |      25    |      37    |      37    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   45850 K  |   45850 K  |
|       from large pool |       3    |      13    |   14786 K  |   14786 K  |
|       from small pool |       0    |    3574    |   31063 K  |   31063 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151

 Experiment start at: 2024-06-23 21:17:29.300648
before training, model accuracy: 0.14647115767002106
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96111345, 'precision': 0.95986074, 'recall': 0.9363347, 'specificity': 0.9363347, 'f1': 0.94732875, 'auroc': 0.9876473, 'binary_precision': 0.95749944, 'binary_recall': 0.8860373, 'binary_specificity': 0.9866321, 'binary_f1_score': 0.9203833}
confusion matrix:
       0      1
0  41848    567
1   1643  12774
---- Validation: 
scalar performance:
{'acc': 0.95218784, 'precision': 0.6621015, 'recall': 0.6755064, 'specificity': 0.6755064, 'f1': 0.66849345, 'auroc': 0.7923033, 'binary_precision': 0.3474692, 'binary_recall': 0.37741455, 'binary_specificity': 0.9735983, 'binary_f1_score': 0.36182332}
confusion matrix:
       0    1
0  17590  477
1    419  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.7468958, 'recall': 0.71031725, 'specificity': 0.71031725, 'f1': 0.72694016, 'auroc': 0.8217437, 'binary_precision': 0.5181818, 'binary_recall': 0.43846154, 'binary_specificity': 0.9821729, 'binary_f1_score': 0.475}
confusion matrix:
      0    1
0  5840  106
1   146  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-23 21:32:57.892222,epoch time: 0:15:28.591574,used: 0:15:28.591574,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9700345, 'precision': 0.9682344, 'recall': 0.951975, 'specificity': 0.951975, 'f1': 0.959743, 'auroc': 0.99226844, 'binary_precision': 0.9647635, 'binary_recall': 0.9153142, 'binary_specificity': 0.98863584, 'binary_f1_score': 0.9393886}
confusion matrix:
       0      1
0  41932    482
1   1221  13197
---- Validation: 
scalar performance:
{'acc': 0.9580043, 'precision': 0.6978842, 'recall': 0.7021268, 'specificity': 0.7021268, 'f1': 0.6999798, 'auroc': 0.82870245, 'binary_precision': 0.41715115, 'binary_recall': 0.42644873, 'binary_specificity': 0.97780484, 'binary_f1_score': 0.4217487}
confusion matrix:
       0    1
0  17666  401
1    386  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.8089224, 'recall': 0.73073626, 'specificity': 0.73073626, 'f1': 0.76351184, 'auroc': 0.8490349, 'binary_precision': 0.640625, 'binary_recall': 0.4730769, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.54424775}
confusion matrix:
      0    1
0  5877   69
1   137  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-23 21:47:41.043764,epoch time: 0:14:43.151542,used: 0:30:11.743116,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97378236, 'precision': 0.9736579, 'recall': 0.95664287, 'specificity': 0.95664287, 'f1': 0.9647604, 'auroc': 0.99397254, 'binary_precision': 0.9734183, 'binary_recall': 0.92184466, 'binary_specificity': 0.99144113, 'binary_f1_score': 0.9469298}
confusion matrix:
       0      1
0  42049    363
1   1127  13293
---- Validation: 
scalar performance:
{'acc': 0.95944506, 'precision': 0.70753074, 'recall': 0.7093114, 'specificity': 0.7093114, 'f1': 0.70841676, 'auroc': 0.85185975, 'binary_precision': 0.4359352, 'binary_recall': 0.4398217, 'binary_specificity': 0.97880113, 'binary_f1_score': 0.43786985}
confusion matrix:
       0    1
0  17684  383
1    377  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.8312501, 'recall': 0.7299063, 'specificity': 0.7299063, 'f1': 0.77043796, 'auroc': 0.8670367, 'binary_precision': 0.6853933, 'binary_recall': 0.46923077, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.55707765}
confusion matrix:
      0    1
0  5890   56
1   138  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-23 22:03:16.539907,epoch time: 0:15:35.496143,used: 0:45:47.239259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.974363, 'precision': 0.9639863, 'recall': 0.96872616, 'specificity': 0.96872616, 'f1': 0.9663243, 'auroc': 0.9944807, 'binary_precision': 0.94257426, 'binary_recall': 0.95728153, 'binary_specificity': 0.9801707, 'binary_f1_score': 0.94987094}
confusion matrix:
       0      1
0  41571    841
1    616  13804
---- Validation: 
scalar performance:
{'acc': 0.9488794, 'precision': 0.67645156, 'recall': 0.7775043, 'specificity': 0.7775043, 'f1': 0.7138126, 'auroc': 0.8667484, 'binary_precision': 0.36842105, 'binary_recall': 0.59286773, 'binary_specificity': 0.9621409, 'binary_f1_score': 0.45444188}
confusion matrix:
       0    1
0  17383  684
1    274  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.75115466, 'recall': 0.782374, 'specificity': 0.782374, 'f1': 0.7657162, 'auroc': 0.8772848, 'binary_precision': 0.52040815, 'binary_recall': 0.5884615, 'binary_specificity': 0.9762866, 'binary_f1_score': 0.5523465}
confusion matrix:
      0    1
0  5805  141
1   107  153
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_4.png
early stop counter: 1
val acc:0.9488794207572937, best validation acc: 0.959445059299469, corresponding to test acc:                         0.968739926815033 / 0.968739926815033
after epoch: 4,now: 2024-06-23 22:19:54.801587,epoch time: 0:16:38.261680,used: 1:02:25.500939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9774071, 'precision': 0.9752978, 'recall': 0.96467423, 'specificity': 0.96467423, 'f1': 0.9698336, 'auroc': 0.9945734, 'binary_precision': 0.97115797, 'binary_recall': 0.93882644, 'binary_specificity': 0.990522, 'binary_f1_score': 0.9547186}
confusion matrix:
       0      1
0  42012    402
1    882  13536
---- Validation: 
scalar performance:
{'acc': 0.9611526, 'precision': 0.7194955, 'recall': 0.7194955, 'specificity': 0.7194955, 'f1': 0.7194955, 'auroc': 0.8540232, 'binary_precision': 0.45913818, 'binary_recall': 0.45913818, 'binary_specificity': 0.9798528, 'binary_f1_score': 0.45913818}
confusion matrix:
       0    1
0  17703  364
1    364  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970029, 'precision': 0.84391963, 'recall': 0.736096, 'specificity': 0.736096, 'f1': 0.77893174, 'auroc': 0.8733971, 'binary_precision': 0.71022725, 'binary_recall': 0.48076922, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.57339454}
confusion matrix:
      0    1
0  5895   51
1   135  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-23 22:36:02.333779,epoch time: 0:16:07.532192,used: 1:18:33.033131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.978674, 'precision': 0.97595036, 'recall': 0.96742475, 'specificity': 0.96742475, 'f1': 0.9715893, 'auroc': 0.9958992, 'binary_precision': 0.9705694, 'binary_recall': 0.944587, 'binary_specificity': 0.99026245, 'binary_f1_score': 0.95740193}
confusion matrix:
       0      1
0  42000    413
1    799  13620
---- Validation: 
scalar performance:
{'acc': 0.9601921, 'precision': 0.7150037, 'recall': 0.7297263, 'specificity': 0.7297263, 'f1': 0.7220882, 'auroc': 0.85930395, 'binary_precision': 0.44937587, 'binary_recall': 0.48142645, 'binary_specificity': 0.9780262, 'binary_f1_score': 0.46484932}
confusion matrix:
       0    1
0  17670  397
1    349  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.8292481, 'recall': 0.7185361, 'specificity': 0.7185361, 'f1': 0.761505, 'auroc': 0.86671257, 'binary_precision': 0.68235296, 'binary_recall': 0.44615385, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.53953487}
confusion matrix:
      0    1
0  5892   54
1   144  116
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_6.png
early stop counter: 1
val acc:0.960192084312439, best validation acc: 0.9611526131629944, corresponding to test acc:                         0.9700289964675903 / 0.9700289964675903
after epoch: 6,now: 2024-06-23 22:53:10.256762,epoch time: 0:17:07.922983,used: 1:35:40.956114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97921944, 'precision': 0.9782871, 'recall': 0.9665333, 'specificity': 0.9665333, 'f1': 0.97222537, 'auroc': 0.9958111, 'binary_precision': 0.97646296, 'binary_recall': 0.9407767, 'binary_specificity': 0.9922899, 'binary_f1_score': 0.95828766}
confusion matrix:
       0      1
0  42085    327
1    854  13566
---- Validation: 
scalar performance:
{'acc': 0.9629136, 'precision': 0.73161584, 'recall': 0.7239851, 'specificity': 0.7239851, 'f1': 0.7277285, 'auroc': 0.85480595, 'binary_precision': 0.48307693, 'binary_recall': 0.4665676, 'binary_specificity': 0.9814026, 'binary_f1_score': 0.47467875}
confusion matrix:
       0    1
0  17731  336
1    359  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.8368796, 'recall': 0.70566314, 'specificity': 0.70566314, 'f1': 0.7537665, 'auroc': 0.86560404, 'binary_precision': 0.69871795, 'binary_recall': 0.41923076, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.52403843}
confusion matrix:
      0    1
0  5899   47
1   151  109
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_7.png
better model found
persisted
after epoch: 7,now: 2024-06-23 23:09:38.592549,epoch time: 0:16:28.335787,used: 1:52:09.291901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98110217, 'precision': 0.9788315, 'recall': 0.9710183, 'specificity': 0.9710183, 'f1': 0.974843, 'auroc': 0.9965837, 'binary_precision': 0.97433525, 'binary_recall': 0.95054793, 'binary_specificity': 0.99148864, 'binary_f1_score': 0.96229464}
confusion matrix:
       0      1
0  42053    361
1    713  13705
---- Validation: 
scalar performance:
{'acc': 0.9614728, 'precision': 0.72267616, 'recall': 0.7296753, 'specificity': 0.7296753, 'f1': 0.7261144, 'auroc': 0.8681893, 'binary_precision': 0.4647482, 'binary_recall': 0.47994056, 'binary_specificity': 0.97941, 'binary_f1_score': 0.4722222}
confusion matrix:
       0    1
0  17695  372
1    350  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.82144463, 'recall': 0.69378835, 'specificity': 0.69378835, 'f1': 0.7401241, 'auroc': 0.8690495, 'binary_precision': 0.66883117, 'binary_recall': 0.39615384, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.4975845}
confusion matrix:
      0    1
0  5895   51
1   157  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_8.png
early stop counter: 1
val acc:0.9614728093147278, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9680953621864319 / 0.9700289964675903
after epoch: 8,now: 2024-06-23 23:27:00.493564,epoch time: 0:17:21.901015,used: 2:09:31.192916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9809966, 'precision': 0.9796169, 'recall': 0.96993864, 'specificity': 0.96993864, 'f1': 0.97465265, 'auroc': 0.9961391, 'binary_precision': 0.9769005, 'binary_recall': 0.94749254, 'binary_specificity': 0.9923848, 'binary_f1_score': 0.9619718}
confusion matrix:
       0      1
0  42092    323
1    757  13660
---- Validation: 
scalar performance:
{'acc': 0.9614728, 'precision': 0.7223644, 'recall': 0.7268142, 'specificity': 0.7268142, 'f1': 0.7245644, 'auroc': 0.85947084, 'binary_precision': 0.4643377, 'binary_recall': 0.47399703, 'binary_specificity': 0.97963136, 'binary_f1_score': 0.46911767}
confusion matrix:
       0    1
0  17699  368
1    354  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.8107885, 'recall': 0.6802427, 'specificity': 0.6802427, 'f1': 0.72629714, 'auroc': 0.8594879, 'binary_precision': 0.6486486, 'binary_recall': 0.36923078, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.47058824}
confusion matrix:
      0   1
0  5894  52
1   164  96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_9.png
early stop counter: 2
val acc:0.9614728093147278, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9680953621864319 / 0.9700289964675903
after epoch: 9,now: 2024-06-23 23:42:53.879855,epoch time: 0:15:53.386291,used: 2:25:24.579207,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.98059237, 'recall': 0.9727738, 'specificity': 0.9727738, 'f1': 0.97660136, 'auroc': 0.99651825, 'binary_precision': 0.976969, 'binary_recall': 0.95318675, 'binary_specificity': 0.99236083, 'binary_f1_score': 0.9649313}
confusion matrix:
       0      1
0  42089    324
1    675  13744
---- Validation: 
scalar performance:
{'acc': 0.96195304, 'precision': 0.72674036, 'recall': 0.74065334, 'specificity': 0.74065334, 'f1': 0.7334627, 'auroc': 0.8646953, 'binary_precision': 0.47206703, 'binary_recall': 0.5022288, 'binary_specificity': 0.9790779, 'binary_f1_score': 0.48668104}
confusion matrix:
       0    1
0  17689  378
1    335  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.796212, 'recall': 0.674053, 'specificity': 0.674053, 'f1': 0.71749747, 'auroc': 0.86468554, 'binary_precision': 0.62, 'binary_recall': 0.3576923, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.45365852}
confusion matrix:
      0   1
0  5889  57
1   167  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_10.png
early stop counter: 3
val acc:0.9619530439376831, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9680953621864319 / 0.9700289964675903
after epoch: 10,now: 2024-06-23 23:58:43.563967,epoch time: 0:15:49.684112,used: 2:41:14.263319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98221076, 'precision': 0.9765429, 'recall': 0.9764775, 'specificity': 0.9764775, 'f1': 0.97651017, 'auroc': 0.9965017, 'binary_precision': 0.96503884, 'binary_recall': 0.9648381, 'binary_specificity': 0.98811686, 'binary_f1_score': 0.96493846}
confusion matrix:
       0      1
0  41909    504
1    507  13912
---- Validation: 
scalar performance:
{'acc': 0.9558698, 'precision': 0.6989361, 'recall': 0.763248, 'specificity': 0.763248, 'f1': 0.7259438, 'auroc': 0.8680333, 'binary_precision': 0.41463414, 'binary_recall': 0.5557206, 'binary_specificity': 0.9707754, 'binary_f1_score': 0.4749206}
confusion matrix:
       0    1
0  17539  528
1    299  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.7715308, 'recall': 0.74343, 'specificity': 0.74343, 'f1': 0.75661254, 'auroc': 0.8723919, 'binary_precision': 0.5646552, 'binary_recall': 0.50384617, 'binary_specificity': 0.9830138, 'binary_f1_score': 0.53252035}
confusion matrix:
      0    1
0  5845  101
1   129  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_11.png
early stop counter: 4
val acc:0.9558697938919067, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9680953621864319 / 0.9700289964675903
after epoch: 11,now: 2024-06-24 00:14:55.951360,epoch time: 0:16:12.387393,used: 2:57:26.650712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98342484, 'precision': 0.98003644, 'recall': 0.9760562, 'specificity': 0.9760562, 'f1': 0.978025, 'auroc': 0.99690616, 'binary_precision': 0.97324437, 'binary_recall': 0.9610957, 'binary_specificity': 0.9910167, 'binary_f1_score': 0.9671319}
confusion matrix:
       0      1
0  42031    381
1    561  13859
---- Validation: 
scalar performance:
{'acc': 0.9618463, 'precision': 0.72668016, 'recall': 0.7470354, 'specificity': 0.7470354, 'f1': 0.73636293, 'auroc': 0.86576355, 'binary_precision': 0.4714674, 'binary_recall': 0.51560175, 'binary_specificity': 0.978469, 'binary_f1_score': 0.49254793}
confusion matrix:
       0    1
0  17678  389
1    326  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.7642227, 'recall': 0.65222645, 'specificity': 0.65222645, 'f1': 0.69135344, 'auroc': 0.8533524, 'binary_precision': 0.5578231, 'binary_recall': 0.31538463, 'binary_specificity': 0.98906827, 'binary_f1_score': 0.4029484}
confusion matrix:
      0   1
0  5881  65
1   178  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_12.png
early stop counter: 5
val acc:0.9618462920188904, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9680953621864319 / 0.9700289964675903
after epoch: 12,now: 2024-06-24 00:30:19.992558,epoch time: 0:15:24.041198,used: 3:12:50.691910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98340726, 'precision': 0.981282, 'recall': 0.97471285, 'specificity': 0.97471285, 'f1': 0.97793984, 'auroc': 0.9967291, 'binary_precision': 0.9770571, 'binary_recall': 0.95706457, 'binary_specificity': 0.9923612, 'binary_f1_score': 0.96695757}
confusion matrix:
       0      1
0  42091    324
1    619  13798
---- Validation: 
scalar performance:
{'acc': 0.96205974, 'precision': 0.727015, 'recall': 0.7364171, 'specificity': 0.7364171, 'f1': 0.7316083, 'auroc': 0.86099404, 'binary_precision': 0.47293448, 'binary_recall': 0.49331352, 'binary_specificity': 0.9795207, 'binary_f1_score': 0.48290908}
confusion matrix:
       0    1
0  17697  370
1    341  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.80936134, 'recall': 0.66519445, 'specificity': 0.66519445, 'f1': 0.71306777, 'auroc': 0.85773516, 'binary_precision': 0.64705884, 'binary_recall': 0.33846155, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.44444448}
confusion matrix:
      0   1
0  5898  48
1   172  88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_13.png
early stop counter: 6
val acc:0.962059736251831, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9680953621864319 / 0.9700289964675903
after epoch: 13,now: 2024-06-24 00:45:43.560089,epoch time: 0:15:23.567531,used: 3:28:14.259441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98314327, 'precision': 0.97946453, 'recall': 0.975888, 'specificity': 0.975888, 'f1': 0.977659, 'auroc': 0.99679554, 'binary_precision': 0.97208196, 'binary_recall': 0.96115965, 'binary_specificity': 0.9906163, 'binary_f1_score': 0.9665899}
confusion matrix:
       0      1
0  42016    398
1    560  13858
---- Validation: 
scalar performance:
{'acc': 0.95928496, 'precision': 0.71291476, 'recall': 0.7507139, 'specificity': 0.7507139, 'f1': 0.7300581, 'auroc': 0.86611897, 'binary_precision': 0.44360903, 'binary_recall': 0.52600294, 'binary_specificity': 0.9754248, 'binary_f1_score': 0.4813052}
confusion matrix:
       0    1
0  17623  444
1    319  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.7897476, 'recall': 0.705484, 'specificity': 0.705484, 'f1': 0.73959565, 'auroc': 0.86757743, 'binary_precision': 0.6043956, 'binary_recall': 0.42307693, 'binary_specificity': 0.987891, 'binary_f1_score': 0.4977376}
confusion matrix:
      0    1
0  5874   72
1   150  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_14.png
early stop counter: 7
val acc:0.9592849612236023, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9680953621864319 / 0.9700289964675903
after epoch: 14,now: 2024-06-24 01:01:05.136575,epoch time: 0:15:21.576486,used: 3:43:35.835927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9847269, 'precision': 0.98079205, 'recall': 0.9788052, 'specificity': 0.9788052, 'f1': 0.9797933, 'auroc': 0.99702126, 'binary_precision': 0.97285414, 'binary_recall': 0.9667823, 'binary_specificity': 0.9908281, 'binary_f1_score': 0.96980864}
confusion matrix:
       0      1
0  42023    389
1    479  13941
---- Validation: 
scalar performance:
{'acc': 0.9607791, 'precision': 0.720025, 'recall': 0.74290556, 'specificity': 0.74290556, 'f1': 0.73082376, 'auroc': 0.8724363, 'binary_precision': 0.45844504, 'binary_recall': 0.50817233, 'binary_specificity': 0.9776388, 'binary_f1_score': 0.48202962}
confusion matrix:
       0    1
0  17663  404
1    331  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.74810976, 'recall': 0.65146965, 'specificity': 0.65146965, 'f1': 0.6866119, 'auroc': 0.8588426, 'binary_precision': 0.525641, 'binary_recall': 0.31538463, 'binary_specificity': 0.98755467, 'binary_f1_score': 0.39423078}
confusion matrix:
      0   1
0  5872  74
1   178  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_15.png
early stop counter: 8
val acc:0.960779070854187, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9680953621864319 / 0.9700289964675903
after epoch: 15,now: 2024-06-24 01:16:43.414913,epoch time: 0:15:38.278338,used: 3:59:14.114265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98449814, 'precision': 0.98213875, 'recall': 0.9767741, 'specificity': 0.9767741, 'f1': 0.97941804, 'auroc': 0.9974446, 'binary_precision': 0.9774298, 'binary_recall': 0.961093, 'binary_specificity': 0.9924551, 'binary_f1_score': 0.96919256}
confusion matrix:
       0      1
0  42093    320
1    561  13858
---- Validation: 
scalar performance:
{'acc': 0.9618997, 'precision': 0.7277014, 'recall': 0.754931, 'specificity': 0.754931, 'f1': 0.74044675, 'auroc': 0.87955093, 'binary_precision': 0.4729194, 'binary_recall': 0.5319465, 'binary_specificity': 0.9779155, 'binary_f1_score': 0.5006993}
confusion matrix:
       0    1
0  17668  399
1    315  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.7740556, 'recall': 0.6526469, 'specificity': 0.6526469, 'f1': 0.6940717, 'auroc': 0.8605986, 'binary_precision': 0.57746476, 'binary_recall': 0.31538463, 'binary_specificity': 0.9899092, 'binary_f1_score': 0.4079602}
confusion matrix:
      0   1
0  5886  60
1   178  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_16.png
early stop counter: 9
val acc:0.9618996977806091, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9680953621864319 / 0.9700289964675903
after epoch: 16,now: 2024-06-24 01:32:41.498693,epoch time: 0:15:58.083780,used: 4:15:12.198045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98433983, 'precision': 0.9796399, 'recall': 0.9789806, 'specificity': 0.9789806, 'f1': 0.9793097, 'auroc': 0.99696404, 'binary_precision': 0.97011817, 'binary_recall': 0.96809983, 'binary_specificity': 0.98986137, 'binary_f1_score': 0.969108}
confusion matrix:
       0      1
0  41982    430
1    460  13960
---- Validation: 
scalar performance:
{'acc': 0.95597655, 'precision': 0.69951844, 'recall': 0.76401865, 'specificity': 0.76401865, 'f1': 0.7266066, 'auroc': 0.8753058, 'binary_precision': 0.41574278, 'binary_recall': 0.5572065, 'binary_specificity': 0.9708308, 'binary_f1_score': 0.47619048}
confusion matrix:
       0    1
0  17540  527
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95520467, 'precision': 0.7189972, 'recall': 0.7044529, 'specificity': 0.7044529, 'f1': 0.71143675, 'auroc': 0.86277914, 'binary_precision': 0.46280992, 'binary_recall': 0.43076923, 'binary_specificity': 0.97813654, 'binary_f1_score': 0.44621515}
confusion matrix:
      0    1
0  5816  130
1   148  112
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_17.png
early stop counter: 10
val acc:0.9559765458106995, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9680953621864319 / 0.9700289964675903
after epoch: 17,now: 2024-06-24 01:48:06.323422,epoch time: 0:15:24.824729,used: 4:30:37.022774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98412865, 'precision': 0.983862, 'recall': 0.9740547, 'specificity': 0.9740547, 'f1': 0.9788313, 'auroc': 0.99701643, 'binary_precision': 0.9833369, 'binary_recall': 0.9536029, 'binary_specificity': 0.9945064, 'binary_f1_score': 0.9682417}
confusion matrix:
       0      1
0  42180    233
1    669  13750
---- Validation: 
scalar performance:
{'acc': 0.9629669, 'precision': 0.73135984, 'recall': 0.71542954, 'specificity': 0.71542954, 'f1': 0.7230753, 'auroc': 0.8701422, 'binary_precision': 0.4832, 'binary_recall': 0.448737, 'binary_specificity': 0.9821221, 'binary_f1_score': 0.4653313}
confusion matrix:
       0    1
0  17744  323
1    371  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.7836853, 'recall': 0.6493053, 'specificity': 0.6493053, 'f1': 0.6933103, 'auroc': 0.85821724, 'binary_precision': 0.5970149, 'binary_recall': 0.30769232, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.4060914}
confusion matrix:
      0   1
0  5892  54
1   180  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_18.png
better model found
persisted
after epoch: 18,now: 2024-06-24 02:03:12.480271,epoch time: 0:15:06.156849,used: 4:45:43.179623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98456854, 'precision': 0.98185635, 'recall': 0.9772573, 'specificity': 0.9772573, 'f1': 0.97952855, 'auroc': 0.9971366, 'binary_precision': 0.97643006, 'binary_recall': 0.9624133, 'binary_specificity': 0.9921013, 'binary_f1_score': 0.969371}
confusion matrix:
       0      1
0  42077    335
1    542  13878
---- Validation: 
scalar performance:
{'acc': 0.9602455, 'precision': 0.7163513, 'recall': 0.73762196, 'specificity': 0.73762196, 'f1': 0.7264205, 'auroc': 0.85935366, 'binary_precision': 0.45148247, 'binary_recall': 0.49777117, 'binary_specificity': 0.9774727, 'binary_f1_score': 0.47349823}
confusion matrix:
       0    1
0  17660  407
1    338  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.72177833, 'recall': 0.6463621, 'specificity': 0.6463621, 'f1': 0.67525595, 'auroc': 0.8431722, 'binary_precision': 0.4733728, 'binary_recall': 0.30769232, 'binary_specificity': 0.98503196, 'binary_f1_score': 0.3729604}
confusion matrix:
      0   1
0  5857  89
1   180  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_19.png
early stop counter: 1
val acc:0.9602454900741577, best validation acc: 0.9629669189453125, corresponding to test acc:                         0.9622945785522461 / 0.9700289964675903
after epoch: 19,now: 2024-06-24 02:18:22.205367,epoch time: 0:15:09.725096,used: 5:00:52.904719,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98453337, 'precision': 0.9836091, 'recall': 0.9753772, 'specificity': 0.9753772, 'f1': 0.97940344, 'auroc': 0.9971752, 'binary_precision': 0.98178065, 'binary_recall': 0.95679015, 'binary_specificity': 0.99396425, 'binary_f1_score': 0.9691244}
confusion matrix:
       0      1
0  42158    256
1    623  13795
---- Validation: 
scalar performance:
{'acc': 0.9632871, 'precision': 0.7339338, 'recall': 0.71917194, 'specificity': 0.71917194, 'f1': 0.7262826, 'auroc': 0.86756706, 'binary_precision': 0.4880763, 'binary_recall': 0.45616642, 'binary_specificity': 0.98217744, 'binary_f1_score': 0.47158217}
confusion matrix:
       0    1
0  17745  322
1    366  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7580881, 'recall': 0.6149422, 'specificity': 0.6149422, 'f1': 0.6558785, 'auroc': 0.8481796, 'binary_precision': 0.54867256, 'binary_recall': 0.23846154, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.3324397}
confusion matrix:
      0   1
0  5895  51
1   198  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_20.png
better model found
persisted
after epoch: 20,now: 2024-06-24 02:33:34.719358,epoch time: 0:15:12.513991,used: 5:16:05.418710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9848853, 'precision': 0.9806689, 'recall': 0.979368, 'specificity': 0.979368, 'f1': 0.9800161, 'auroc': 0.9977399, 'binary_precision': 0.97214484, 'binary_recall': 0.968167, 'binary_specificity': 0.99056894, 'binary_f1_score': 0.97015184}
confusion matrix:
       0      1
0  42013    400
1    459  13960
---- Validation: 
scalar performance:
{'acc': 0.9606724, 'precision': 0.7211117, 'recall': 0.7578708, 'specificity': 0.7578708, 'f1': 0.73788905, 'auroc': 0.8871006, 'binary_precision': 0.45949367, 'binary_recall': 0.5393759, 'binary_specificity': 0.97636575, 'binary_f1_score': 0.4962406}
confusion matrix:
       0    1
0  17640  427
1    310  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7643579, 'recall': 0.67446244, 'specificity': 0.67446244, 'f1': 0.7090583, 'auroc': 0.8667726, 'binary_precision': 0.556213, 'binary_recall': 0.36153847, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.43822846}
confusion matrix:
      0   1
0  5871  75
1   166  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_21.png
early stop counter: 1
val acc:0.9606723785400391, best validation acc: 0.9632871150970459, corresponding to test acc:                         0.9598775506019592 / 0.9700289964675903
after epoch: 21,now: 2024-06-24 02:48:51.049892,epoch time: 0:15:16.330534,used: 5:31:21.749244,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9851492, 'precision': 0.98310924, 'recall': 0.9775319, 'specificity': 0.9775319, 'f1': 0.9802792, 'auroc': 0.9975574, 'binary_precision': 0.9790402, 'binary_recall': 0.9620666, 'binary_specificity': 0.9929973, 'binary_f1_score': 0.9704792}
confusion matrix:
       0      1
0  42115    297
1    547  13873
---- Validation: 
scalar performance:
{'acc': 0.96152616, 'precision': 0.7230115, 'recall': 0.72970295, 'specificity': 0.72970295, 'f1': 0.7263013, 'auroc': 0.87266576, 'binary_precision': 0.46541786, 'binary_recall': 0.47994056, 'binary_specificity': 0.9794653, 'binary_f1_score': 0.47256768}
confusion matrix:
       0    1
0  17696  371
1    350  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.7206228, 'recall': 0.6152675, 'specificity': 0.6152675, 'f1': 0.64919794, 'auroc': 0.84641063, 'binary_precision': 0.47368422, 'binary_recall': 0.2423077, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.3206107}
confusion matrix:
      0   1
0  5876  70
1   197  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_22.png
early stop counter: 2
val acc:0.9615261554718018, best validation acc: 0.9632871150970459, corresponding to test acc:                         0.9598775506019592 / 0.9700289964675903
after epoch: 22,now: 2024-06-24 03:04:12.388762,epoch time: 0:15:21.338870,used: 5:46:43.088114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98544836, 'precision': 0.9826093, 'recall': 0.9788537, 'specificity': 0.9788537, 'f1': 0.98071265, 'auroc': 0.99752843, 'binary_precision': 0.9769139, 'binary_recall': 0.96546465, 'binary_specificity': 0.99224275, 'binary_f1_score': 0.9711556}
confusion matrix:
       0      1
0  42083    329
1    498  13922
---- Validation: 
scalar performance:
{'acc': 0.9604055, 'precision': 0.71966434, 'recall': 0.75773245, 'specificity': 0.75773245, 'f1': 0.73697305, 'auroc': 0.8842066, 'binary_precision': 0.45660377, 'binary_recall': 0.5393759, 'binary_specificity': 0.976089, 'binary_f1_score': 0.4945504}
confusion matrix:
       0    1
0  17635  432
1    310  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.75338125, 'recall': 0.631409, 'specificity': 0.631409, 'f1': 0.6707231, 'auroc': 0.854477, 'binary_precision': 0.5378788, 'binary_recall': 0.27307692, 'binary_specificity': 0.989741, 'binary_f1_score': 0.3622449}
confusion matrix:
      0   1
0  5885  61
1   189  71
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_23.png
early stop counter: 3
val acc:0.9604055285453796, best validation acc: 0.9632871150970459, corresponding to test acc:                         0.9598775506019592 / 0.9700289964675903
after epoch: 23,now: 2024-06-24 03:20:15.314901,epoch time: 0:16:02.926139,used: 6:02:46.014253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9847797, 'precision': 0.98276055, 'recall': 0.976894, 'specificity': 0.976894, 'f1': 0.9797815, 'auroc': 0.9975623, 'binary_precision': 0.97873694, 'binary_recall': 0.9608849, 'binary_specificity': 0.9929031, 'binary_f1_score': 0.96972877}
confusion matrix:
       0      1
0  42112    301
1    564  13855
---- Validation: 
scalar performance:
{'acc': 0.9627535, 'precision': 0.73067135, 'recall': 0.7260479, 'specificity': 0.7260479, 'f1': 0.72833323, 'auroc': 0.87763774, 'binary_precision': 0.48103186, 'binary_recall': 0.47102526, 'binary_specificity': 0.98107046, 'binary_f1_score': 0.475976}
confusion matrix:
       0    1
0  17725  342
1    356  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7329564, 'recall': 0.5956273, 'specificity': 0.5956273, 'f1': 0.63206697, 'auroc': 0.8522795, 'binary_precision': 0.5, 'binary_recall': 0.2, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.2857143}
confusion matrix:
      0   1
0  5894  52
1   208  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_24.png
early stop counter: 4
val acc:0.9627534747123718, best validation acc: 0.9632871150970459, corresponding to test acc:                         0.9598775506019592 / 0.9700289964675903
after epoch: 24,now: 2024-06-24 03:35:28.577241,epoch time: 0:15:13.262340,used: 6:17:59.276593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9856595, 'precision': 0.98707604, 'recall': 0.9749674, 'specificity': 0.9749674, 'f1': 0.9808302, 'auroc': 0.99771196, 'binary_precision': 0.98984665, 'binary_recall': 0.95325935, 'binary_specificity': 0.9966755, 'binary_f1_score': 0.9712086}
confusion matrix:
       0      1
0  42271    141
1    674  13746
---- Validation: 
scalar performance:
{'acc': 0.96611524, 'precision': 0.7583995, 'recall': 0.68702114, 'specificity': 0.68702114, 'f1': 0.7163677, 'auroc': 0.8695276, 'binary_precision': 0.5394191, 'binary_recall': 0.38632986, 'binary_specificity': 0.9877124, 'binary_f1_score': 0.45021647}
confusion matrix:
       0    1
0  17845  222
1    413  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7466345, 'recall': 0.58685285, 'specificity': 0.58685285, 'f1': 0.62410104, 'auroc': 0.84841716, 'binary_precision': 0.5280899, 'binary_recall': 0.18076923, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.269341}
confusion matrix:
      0   1
0  5904  42
1   213  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_25.png
better model found
persisted
after epoch: 25,now: 2024-06-24 03:50:41.169515,epoch time: 0:15:12.592274,used: 6:33:11.868867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98553634, 'precision': 0.98353666, 'recall': 0.9781346, 'specificity': 0.9781346, 'f1': 0.9807968, 'auroc': 0.99738586, 'binary_precision': 0.9795458, 'binary_recall': 0.9631068, 'binary_specificity': 0.99316233, 'binary_f1_score': 0.97125673}
confusion matrix:
       0      1
0  42122    290
1    532  13888
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7397717, 'recall': 0.7160107, 'specificity': 0.7160107, 'f1': 0.72719693, 'auroc': 0.877942, 'binary_precision': 0.5, 'binary_recall': 0.448737, 'binary_specificity': 0.9832844, 'binary_f1_score': 0.47298354}
confusion matrix:
       0    1
0  17765  302
1    371  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95955527, 'precision': 0.7602267, 'recall': 0.58351123, 'specificity': 0.58351123, 'f1': 0.621568, 'auroc': 0.84894127, 'binary_precision': 0.5555556, 'binary_recall': 0.17307693, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.26392964}
confusion matrix:
      0   1
0  5910  36
1   215  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_26.png
early stop counter: 1
val acc:0.9640874862670898, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9589107036590576 / 0.9700289964675903
after epoch: 26,now: 2024-06-24 04:05:54.940552,epoch time: 0:15:13.771037,used: 6:48:25.639904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98492044, 'precision': 0.9817536, 'recall': 0.9783169, 'specificity': 0.9783169, 'f1': 0.98001945, 'auroc': 0.99723685, 'binary_precision': 0.9753943, 'binary_recall': 0.96490985, 'binary_specificity': 0.991724, 'binary_f1_score': 0.97012377}
confusion matrix:
       0      1
0  42061    351
1    506  13914
---- Validation: 
scalar performance:
{'acc': 0.9605656, 'precision': 0.71988606, 'recall': 0.7520933, 'specificity': 0.7520933, 'f1': 0.7347415, 'auroc': 0.87623537, 'binary_precision': 0.45747423, 'binary_recall': 0.5274888, 'binary_specificity': 0.97669786, 'binary_f1_score': 0.4899931}
confusion matrix:
       0    1
0  17646  421
1    318  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.7179211, 'recall': 0.64794886, 'specificity': 0.64794886, 'f1': 0.67528176, 'auroc': 0.8481552, 'binary_precision': 0.46551725, 'binary_recall': 0.31153846, 'binary_specificity': 0.9843592, 'binary_f1_score': 0.37327185}
confusion matrix:
      0   1
0  5853  93
1   179  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_27.png
early stop counter: 2
val acc:0.9605656266212463, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9589107036590576 / 0.9700289964675903
after epoch: 27,now: 2024-06-24 04:21:36.463071,epoch time: 0:15:41.522519,used: 7:04:07.162423,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98583543, 'precision': 0.98347664, 'recall': 0.97899526, 'specificity': 0.97899526, 'f1': 0.9812093, 'auroc': 0.99753666, 'binary_precision': 0.9787563, 'binary_recall': 0.96511066, 'binary_specificity': 0.99287987, 'binary_f1_score': 0.9718856}
confusion matrix:
       0      1
0  42113    302
1    503  13914
---- Validation: 
scalar performance:
{'acc': 0.96179295, 'precision': 0.7243401, 'recall': 0.72626495, 'specificity': 0.72626495, 'f1': 0.72529787, 'auroc': 0.86534727, 'binary_precision': 0.46833578, 'binary_recall': 0.47251114, 'binary_specificity': 0.9800188, 'binary_f1_score': 0.4704142}
confusion matrix:
       0    1
0  17706  361
1    355  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9545601, 'precision': 0.7017766, 'recall': 0.63239604, 'specificity': 0.63239604, 'f1': 0.6587951, 'auroc': 0.84527624, 'binary_precision': 0.43452382, 'binary_recall': 0.28076923, 'binary_specificity': 0.98402286, 'binary_f1_score': 0.3411215}
confusion matrix:
      0   1
0  5851  95
1   187  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_28.png
early stop counter: 3
val acc:0.9617929458618164, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9589107036590576 / 0.9700289964675903
after epoch: 28,now: 2024-06-24 04:36:58.995861,epoch time: 0:15:22.532790,used: 7:19:29.695213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.985853, 'precision': 0.9805235, 'recall': 0.98219067, 'specificity': 0.98219067, 'f1': 0.9813533, 'auroc': 0.9979863, 'binary_precision': 0.9696447, 'binary_recall': 0.9747555, 'binary_specificity': 0.9896258, 'binary_f1_score': 0.97219336}
confusion matrix:
       0      1
0  41973    440
1    364  14055
---- Validation: 
scalar performance:
{'acc': 0.95720387, 'precision': 0.7069, 'recall': 0.77752995, 'specificity': 0.77752995, 'f1': 0.7363087, 'auroc': 0.88882005, 'binary_precision': 0.4295082, 'binary_recall': 0.5839524, 'binary_specificity': 0.97110754, 'binary_f1_score': 0.4949622}
confusion matrix:
       0    1
0  17545  522
1    280  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.7233433, 'recall': 0.65923506, 'specificity': 0.65923506, 'f1': 0.68515086, 'auroc': 0.8473552, 'binary_precision': 0.47540984, 'binary_recall': 0.33461538, 'binary_specificity': 0.9838547, 'binary_f1_score': 0.39277652}
confusion matrix:
      0   1
0  5850  96
1   173  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_29.png
early stop counter: 4
val acc:0.9572038650512695, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9589107036590576 / 0.9700289964675903
after epoch: 29,now: 2024-06-24 04:52:14.046379,epoch time: 0:15:15.050518,used: 7:34:44.745731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98664486, 'precision': 0.9838704, 'recall': 0.9807767, 'specificity': 0.9807767, 'f1': 0.9823109, 'auroc': 0.9979, 'binary_precision': 0.9782928, 'binary_recall': 0.9688627, 'binary_specificity': 0.99269074, 'binary_f1_score': 0.97355497}
confusion matrix:
       0      1
0  42102    310
1    449  13971
---- Validation: 
scalar performance:
{'acc': 0.96237993, 'precision': 0.72947, 'recall': 0.74159, 'specificity': 0.74159, 'f1': 0.73535395, 'auroc': 0.890442, 'binary_precision': 0.4774648, 'binary_recall': 0.5037147, 'binary_specificity': 0.9794653, 'binary_f1_score': 0.4902386}
confusion matrix:
       0    1
0  17696  371
1    334  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.7306936, 'recall': 0.5973822, 'specificity': 0.5973822, 'f1': 0.6335798, 'auroc': 0.8575933, 'binary_precision': 0.49532712, 'binary_recall': 0.20384616, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.28882834}
confusion matrix:
      0   1
0  5892  54
1   207  53
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_30.png
early stop counter: 5
val acc:0.9623799324035645, best validation acc: 0.9661152362823486, corresponding to test acc:                         0.9589107036590576 / 0.9700289964675903
after epoch: 30,now: 2024-06-24 05:07:22.322433,epoch time: 0:15:08.276054,used: 7:49:53.021785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_23_21_17_29_seed_1_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 7:49:53.021785 at 2024-06-24 05:07:22.322433
persisted model performance metric: 

scalar performance:
{'acc': 0.9589107, 'precision': 0.7466345, 'recall': 0.58685285, 'specificity': 0.58685285, 'f1': 0.62410104, 'auroc': 0.84841716, 'binary_precision': 0.5280899, 'binary_recall': 0.18076923, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.269341}
confusion matrix:
      0   1
0  5904  42
1   213  47
oracle model performance metric: 

scalar performance:
{'acc': 0.970029, 'precision': 0.84391963, 'recall': 0.736096, 'specificity': 0.736096, 'f1': 0.77893174, 'auroc': 0.8733971, 'binary_precision': 0.71022725, 'binary_recall': 0.48076922, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.57339454}
confusion matrix:
      0    1
0  5895   51
1   135  125
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204071 KiB | 640729 KiB |   2303 TiB |   2303 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2302 TiB |   2302 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204071 KiB | 640729 KiB |   2303 TiB |   2303 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   2302 TiB |   2302 TiB |
|       from small pool |  37031 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201086 KiB | 632296 KiB |   2293 TiB |   2293 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   2292 TiB |   2292 TiB |
|       from small pool |  35966 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1118 MiB | 468992 KiB |
|       from large pool | 600064 KiB | 679936 KiB |   1020 MiB | 444416 KiB |
|       from small pool |  75776 KiB |  75776 KiB |     98 MiB |  24576 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  80600 KiB | 218089 KiB |    845 TiB |    845 TiB |
|       from large pool |  68480 KiB | 217080 KiB |    844 TiB |    844 TiB |
|       from small pool |  12120 KiB |  21751 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3228    |    7879    |  203543 K  |  203540 K  |
|       from large pool |      36    |      76    |   82528 K  |   82528 K  |
|       from small pool |    3192    |    7842    |  121015 K  |  121012 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3228    |    7879    |  203543 K  |  203540 K  |
|       from large pool |      36    |      76    |   82528 K  |   82528 K  |
|       from small pool |    3192    |    7842    |  121015 K  |  121012 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      67    |      16    |
|       from large pool |      14    |      14    |      18    |       4    |
|       from small pool |      37    |      37    |      49    |      12    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3581    |   92773 K  |   92773 K  |
|       from large pool |       5    |      13    |   30876 K  |   30876 K  |
|       from small pool |      30    |    3574    |   61897 K  |   61897 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   2303 TiB |   2303 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2302 TiB |   2302 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   2303 TiB |   2303 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2302 TiB |   2302 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   2293 TiB |   2293 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2292 TiB |   2292 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1118 MiB |    840 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |     98 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB |    845 TiB |    845 TiB |
|       from large pool |  55040 KiB | 217080 KiB |    844 TiB |    844 TiB |
|       from small pool |      0 KiB |  21751 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  203543 K  |  203543 K  |
|       from large pool |       2    |      76    |   82528 K  |   82528 K  |
|       from small pool |       0    |    7842    |  121015 K  |  121015 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  203543 K  |  203543 K  |
|       from large pool |       2    |      76    |   82528 K  |   82528 K  |
|       from small pool |       0    |    7842    |  121015 K  |  121015 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      67    |      33    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      49    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   92774 K  |   92774 K  |
|       from large pool |       3    |      13    |   30876 K  |   30876 K  |
|       from small pool |       0    |    3574    |   61898 K  |   61898 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   2303 TiB |   2303 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2302 TiB |   2302 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   2303 TiB |   2303 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   2302 TiB |   2302 TiB |
|       from small pool |      0 KiB |  75082 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   2293 TiB |   2293 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   2292 TiB |   2292 TiB |
|       from small pool |      0 KiB |  73944 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 284672 KiB | 755712 KiB |   1118 MiB |    840 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1020 MiB |    790 MiB |
|       from small pool |  49152 KiB |  75776 KiB |     98 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB |    845 TiB |    845 TiB |
|       from large pool |  55040 KiB | 217080 KiB |    844 TiB |    844 TiB |
|       from small pool |      0 KiB |  21751 KiB |      0 TiB |      0 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7879    |  203543 K  |  203543 K  |
|       from large pool |       2    |      76    |   82528 K  |   82528 K  |
|       from small pool |       0    |    7842    |  121015 K  |  121015 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7879    |  203543 K  |  203543 K  |
|       from large pool |       2    |      76    |   82528 K  |   82528 K  |
|       from small pool |       0    |    7842    |  121015 K  |  121015 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      34    |      51    |      67    |      33    |
|       from large pool |      10    |      14    |      18    |       8    |
|       from small pool |      24    |      37    |      49    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3581    |   92774 K  |   92774 K  |
|       from large pool |       3    |      13    |   30876 K  |   30876 K  |
|       from small pool |       0    |    3574    |   61898 K  |   61898 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151

 Experiment start at: 2024-06-24 05:13:18.838488
before training, model accuracy: 0.0544959120452404
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9560585, 'precision': 0.9578552, 'recall': 0.9278157, 'specificity': 0.9278157, 'f1': 0.94150895, 'auroc': 0.9866289, 'binary_precision': 0.9612823, 'binary_recall': 0.868134, 'binary_specificity': 0.9874973, 'binary_f1_score': 0.91233677}
confusion matrix:
       0      1
0  41782    529
1   1995  13134
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9523784, 'precision': 0.64260423, 'recall': 0.6766664, 'specificity': 0.6766664, 'f1': 0.65751624, 'auroc': 0.79991114, 'binary_precision': 0.30585107, 'binary_recall': 0.3820598, 'binary_specificity': 0.9712729, 'binary_f1_score': 0.3397341}
confusion matrix:
       0    1
0  17649  522
1    372  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589678, 'precision': 0.7229868, 'recall': 0.7070205, 'specificity': 0.7070205, 'f1': 0.71466595, 'auroc': 0.8158108, 'binary_precision': 0.46875, 'binary_recall': 0.4338843, 'binary_specificity': 0.9801567, 'binary_f1_score': 0.4506438}
confusion matrix:
      0    1
0  5878  119
1   137  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-24 05:29:42.522749,epoch time: 0:16:23.684261,used: 0:16:23.684261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97050834, 'precision': 0.9695066, 'recall': 0.95393264, 'specificity': 0.95393264, 'f1': 0.96136785, 'auroc': 0.9922621, 'binary_precision': 0.96750176, 'binary_recall': 0.9189028, 'binary_specificity': 0.9889624, 'binary_f1_score': 0.94257635}
confusion matrix:
       0      1
0  41843    467
1   1227  13903
---- Validation: 
scalar performance:
{'acc': 0.95914346, 'precision': 0.68436605, 'recall': 0.7211164, 'specificity': 0.7211164, 'f1': 0.7008482, 'auroc': 0.8315724, 'binary_precision': 0.38651994, 'binary_recall': 0.4667774, 'binary_specificity': 0.9754554, 'binary_f1_score': 0.42287433}
confusion matrix:
       0    1
0  17725  446
1    321  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9669819, 'precision': 0.7854931, 'recall': 0.73299944, 'specificity': 0.73299944, 'f1': 0.7562854, 'auroc': 0.83863765, 'binary_precision': 0.59183675, 'binary_recall': 0.47933885, 'binary_specificity': 0.98666, 'binary_f1_score': 0.52968043}
confusion matrix:
      0    1
0  5917   80
1   126  116
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-24 05:46:10.274229,epoch time: 0:16:27.751480,used: 0:32:51.435741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97668874, 'precision': 0.9727373, 'recall': 0.9669152, 'specificity': 0.9669152, 'f1': 0.96977687, 'auroc': 0.9944037, 'binary_precision': 0.96456003, 'binary_recall': 0.9462621, 'binary_specificity': 0.98756826, 'binary_f1_score': 0.95532346}
confusion matrix:
       0      1
0  41785    526
1    813  14316
---- Validation: 
scalar performance:
{'acc': 0.9580781, 'precision': 0.6862459, 'recall': 0.75268805, 'specificity': 0.75268805, 'f1': 0.7137375, 'auroc': 0.84540045, 'binary_precision': 0.38814995, 'binary_recall': 0.5332226, 'binary_specificity': 0.9721534, 'binary_f1_score': 0.44926527}
confusion matrix:
       0    1
0  17665  506
1    281  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.75827104, 'recall': 0.7034902, 'specificity': 0.7034902, 'f1': 0.72723746, 'auroc': 0.84395504, 'binary_precision': 0.53968257, 'binary_recall': 0.4214876, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.47331786}
confusion matrix:
      0    1
0  5910   87
1   140  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_3.png
early stop counter: 1
val acc:0.9580780863761902, best validation acc: 0.9591434597969055, corresponding to test acc:                         0.9669818878173828 / 0.9669818878173828
after epoch: 3,now: 2024-06-24 06:02:15.591013,epoch time: 0:16:05.316784,used: 0:48:56.752525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97635794, 'precision': 0.9749305, 'recall': 0.9637819, 'specificity': 0.9637819, 'f1': 0.9691775, 'auroc': 0.9948771, 'binary_precision': 0.97202986, 'binary_recall': 0.9372067, 'binary_specificity': 0.9903571, 'binary_f1_score': 0.95430064}
confusion matrix:
       0      1
0  41903    408
1    950  14179
---- Validation: 
scalar performance:
{'acc': 0.9588771, 'precision': 0.6884086, 'recall': 0.74587333, 'specificity': 0.74587333, 'f1': 0.71281797, 'auroc': 0.85601336, 'binary_precision': 0.3929471, 'binary_recall': 0.5182724, 'binary_specificity': 0.9734742, 'binary_f1_score': 0.44699138}
confusion matrix:
       0    1
0  17689  482
1    290  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.7847952, 'recall': 0.72093624, 'specificity': 0.72093624, 'f1': 0.74837863, 'auroc': 0.84957355, 'binary_precision': 0.5913978, 'binary_recall': 0.45454547, 'binary_specificity': 0.987327, 'binary_f1_score': 0.51401865}
confusion matrix:
      0    1
0  5921   76
1   132  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_4.png
early stop counter: 2
val acc:0.9588770866394043, best validation acc: 0.9591434597969055, corresponding to test acc:                         0.9669818878173828 / 0.9669818878173828
after epoch: 4,now: 2024-06-24 06:17:53.502514,epoch time: 0:15:37.911501,used: 1:04:34.664026,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9784645, 'precision': 0.9759933, 'recall': 0.96822506, 'specificity': 0.96822506, 'f1': 0.97202224, 'auroc': 0.99545324, 'binary_precision': 0.9709133, 'binary_recall': 0.9465891, 'binary_specificity': 0.989861, 'binary_f1_score': 0.9585969}
confusion matrix:
       0      1
0  41883    429
1    808  14320
---- Validation: 
scalar performance:
{'acc': 0.95866406, 'precision': 0.68575174, 'recall': 0.73773277, 'specificity': 0.73773277, 'f1': 0.70811224, 'auroc': 0.85511565, 'binary_precision': 0.3881748, 'binary_recall': 0.5016611, 'binary_specificity': 0.9738044, 'binary_f1_score': 0.43768114}
confusion matrix:
       0    1
0  17695  476
1    300  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.7615001, 'recall': 0.6996914, 'specificity': 0.6996914, 'f1': 0.7259604, 'auroc': 0.8390538, 'binary_precision': 0.5464481, 'binary_recall': 0.41322315, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.47058827}
confusion matrix:
      0    1
0  5914   83
1   142  100
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_5.png
early stop counter: 3
val acc:0.958664059638977, best validation acc: 0.9591434597969055, corresponding to test acc:                         0.9669818878173828 / 0.9669818878173828
after epoch: 5,now: 2024-06-24 06:33:24.991718,epoch time: 0:15:31.489204,used: 1:20:06.153230,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9790564, 'precision': 0.9746265, 'recall': 0.97124004, 'specificity': 0.97124004, 'f1': 0.9729166, 'auroc': 0.99567044, 'binary_precision': 0.96537894, 'binary_recall': 0.9547227, 'binary_specificity': 0.9877573, 'binary_f1_score': 0.96002126}
confusion matrix:
       0      1
0  41793    518
1    685  14444
---- Validation: 
scalar performance:
{'acc': 0.9590369, 'precision': 0.69296765, 'recall': 0.7660321, 'specificity': 0.7660321, 'f1': 0.7228912, 'auroc': 0.86285555, 'binary_precision': 0.40071344, 'binary_recall': 0.5598007, 'binary_specificity': 0.9722635, 'binary_f1_score': 0.4670825}
confusion matrix:
       0    1
0  17667  504
1    265  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96650106, 'precision': 0.7832122, 'recall': 0.72085285, 'specificity': 0.72085285, 'f1': 0.74773735, 'auroc': 0.8501916, 'binary_precision': 0.5882353, 'binary_recall': 0.45454547, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.51282054}
confusion matrix:
      0    1
0  5920   77
1   132  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_6.png
early stop counter: 4
val acc:0.9590368866920471, best validation acc: 0.9591434597969055, corresponding to test acc:                         0.9669818878173828 / 0.9669818878173828
after epoch: 6,now: 2024-06-24 06:48:48.711335,epoch time: 0:15:23.719617,used: 1:35:29.872847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9797876, 'precision': 0.9793158, 'recall': 0.9683392, 'specificity': 0.9683392, 'f1': 0.9736563, 'auroc': 0.9959943, 'binary_precision': 0.9783562, 'binary_recall': 0.944147, 'binary_specificity': 0.9925315, 'binary_f1_score': 0.9609472}
confusion matrix:
       0      1
0  41995    316
1    845  14284
---- Validation: 
scalar performance:
{'acc': 0.9617536, 'precision': 0.7008537, 'recall': 0.7361165, 'specificity': 0.7361165, 'f1': 0.7168801, 'auroc': 0.8675796, 'binary_precision': 0.41853932, 'binary_recall': 0.4950166, 'binary_specificity': 0.9772164, 'binary_f1_score': 0.45357686}
confusion matrix:
       0    1
0  17757  414
1    304  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703478, 'precision': 0.8286029, 'recall': 0.71888834, 'specificity': 0.71888834, 'f1': 0.7616675, 'auroc': 0.85716224, 'binary_precision': 0.6792453, 'binary_recall': 0.446281, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.5386534}
confusion matrix:
      0    1
0  5946   51
1   134  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_7.png
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-06-24 07:04:16.718292,epoch time: 0:15:28.006957,used: 1:50:57.879804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9798921, 'precision': 0.9799091, 'recall': 0.96802974, 'specificity': 0.96802974, 'f1': 0.9737694, 'auroc': 0.9962399, 'binary_precision': 0.9799437, 'binary_recall': 0.942961, 'binary_specificity': 0.99309856, 'binary_f1_score': 0.96109664}
confusion matrix:
       0      1
0  42018    292
1    863  14267
---- Validation: 
scalar performance:
{'acc': 0.9637778, 'precision': 0.7103119, 'recall': 0.72110116, 'specificity': 0.72110116, 'f1': 0.71555525, 'auroc': 0.859817, 'binary_precision': 0.4384858, 'binary_recall': 0.46179402, 'binary_specificity': 0.9804084, 'binary_f1_score': 0.4498382}
confusion matrix:
       0    1
0  17815  356
1    324  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96906555, 'precision': 0.8400327, 'recall': 0.6706356, 'specificity': 0.6706356, 'f1': 0.724723, 'auroc': 0.8442622, 'binary_precision': 0.7058824, 'binary_recall': 0.34710744, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.46537396}
confusion matrix:
      0   1
0  5962  35
1   158  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_8.png
better model found
persisted
after epoch: 8,now: 2024-06-24 07:19:42.906829,epoch time: 0:15:26.188537,used: 2:06:24.068341,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98192894, 'precision': 0.97747326, 'recall': 0.9758874, 'specificity': 0.9758874, 'f1': 0.9766767, 'auroc': 0.99666953, 'binary_precision': 0.96811056, 'binary_recall': 0.9631196, 'binary_specificity': 0.98865515, 'binary_f1_score': 0.96560866}
confusion matrix:
       0      1
0  41830    480
1    558  14572
---- Validation: 
scalar performance:
{'acc': 0.9598892, 'precision': 0.6954531, 'recall': 0.7584418, 'specificity': 0.7584418, 'f1': 0.7219913, 'auroc': 0.87180996, 'binary_precision': 0.40621117, 'binary_recall': 0.54318935, 'binary_specificity': 0.9736943, 'binary_f1_score': 0.46481875}
confusion matrix:
       0    1
0  17693  478
1    275  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96730244, 'precision': 0.80042505, 'recall': 0.6915286, 'specificity': 0.6915286, 'f1': 0.73267585, 'auroc': 0.8538255, 'binary_precision': 0.625, 'binary_recall': 0.39256197, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.4822335}
confusion matrix:
      0   1
0  5940  57
1   147  95
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_9.png
early stop counter: 1
val acc:0.9598891735076904, best validation acc: 0.9637777805328369, corresponding to test acc:                         0.9690655469894409 / 0.9703478217124939
after epoch: 9,now: 2024-06-24 07:35:08.353012,epoch time: 0:15:25.446183,used: 2:21:49.514524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9812674, 'precision': 0.9789896, 'recall': 0.9725299, 'specificity': 0.9725299, 'f1': 0.97569996, 'auroc': 0.9966183, 'binary_precision': 0.9742845, 'binary_recall': 0.9540648, 'binary_specificity': 0.99099505, 'binary_f1_score': 0.96406865}
confusion matrix:
       0      1
0  41929    381
1    695  14435
---- Validation: 
scalar performance:
{'acc': 0.9620199, 'precision': 0.705968, 'recall': 0.7587395, 'specificity': 0.7587395, 'f1': 0.7289746, 'auroc': 0.8770535, 'binary_precision': 0.42726082, 'binary_recall': 0.5415282, 'binary_specificity': 0.9759507, 'binary_f1_score': 0.47765568}
confusion matrix:
       0    1
0  17734  437
1    276  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9679436, 'precision': 0.80977273, 'recall': 0.6898794, 'specificity': 0.6898794, 'f1': 0.73399675, 'auroc': 0.856061, 'binary_precision': 0.6438356, 'binary_recall': 0.38842976, 'binary_specificity': 0.991329, 'binary_f1_score': 0.48453605}
confusion matrix:
      0   1
0  5945  52
1   148  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_10.png
early stop counter: 2
val acc:0.9620199203491211, best validation acc: 0.9637777805328369, corresponding to test acc:                         0.9690655469894409 / 0.9703478217124939
after epoch: 10,now: 2024-06-24 07:50:32.972185,epoch time: 0:15:24.619173,used: 2:37:14.133697,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9830258, 'precision': 0.9803864, 'recall': 0.97571665, 'specificity': 0.97571665, 'f1': 0.9780203, 'auroc': 0.99680537, 'binary_precision': 0.974901, 'binary_recall': 0.9602724, 'binary_specificity': 0.9911609, 'binary_f1_score': 0.9675314}
confusion matrix:
       0      1
0  41938    374
1    601  14527
---- Validation: 
scalar performance:
{'acc': 0.95898366, 'precision': 0.6915468, 'recall': 0.7595802, 'specificity': 0.7595802, 'f1': 0.71973264, 'auroc': 0.8548409, 'binary_precision': 0.3983051, 'binary_recall': 0.54651165, 'binary_specificity': 0.97264874, 'binary_f1_score': 0.46078435}
confusion matrix:
       0    1
0  17674  497
1    273  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95816636, 'precision': 0.71786, 'recall': 0.70660365, 'specificity': 0.70660365, 'f1': 0.7120613, 'auroc': 0.83979523, 'binary_precision': 0.4585153, 'binary_recall': 0.4338843, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.4458599}
confusion matrix:
      0    1
0  5873  124
1   137  105
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_11.png
early stop counter: 3
val acc:0.9589836597442627, best validation acc: 0.9637777805328369, corresponding to test acc:                         0.9690655469894409 / 0.9703478217124939
after epoch: 11,now: 2024-06-24 08:05:56.628402,epoch time: 0:15:23.656217,used: 2:52:37.789914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98206824, 'precision': 0.97687453, 'recall': 0.97691506, 'specificity': 0.97691506, 'f1': 0.9768948, 'auroc': 0.9967139, 'binary_precision': 0.9658978, 'binary_recall': 0.96602553, 'binary_specificity': 0.9878046, 'binary_f1_score': 0.96596164}
confusion matrix:
       0      1
0  41795    516
1    514  14615
---- Validation: 
scalar performance:
{'acc': 0.95850426, 'precision': 0.6919302, 'recall': 0.7729844, 'specificity': 0.7729844, 'f1': 0.72441715, 'auroc': 0.87588346, 'binary_precision': 0.3981588, 'binary_recall': 0.57475084, 'binary_specificity': 0.9712179, 'binary_f1_score': 0.47042826}
confusion matrix:
       0    1
0  17648  523
1    256  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.72553164, 'recall': 0.68950933, 'specificity': 0.68950933, 'f1': 0.7057459, 'auroc': 0.8549613, 'binary_precision': 0.47524753, 'binary_recall': 0.3966942, 'binary_specificity': 0.9823245, 'binary_f1_score': 0.4324324}
confusion matrix:
      0    1
0  5891  106
1   146   96
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_12.png
early stop counter: 4
val acc:0.9585042595863342, best validation acc: 0.9637777805328369, corresponding to test acc:                         0.9690655469894409 / 0.9703478217124939
after epoch: 12,now: 2024-06-24 08:21:40.126302,epoch time: 0:15:43.497900,used: 3:08:21.287814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98349583, 'precision': 0.98078465, 'recall': 0.9765476, 'specificity': 0.9765476, 'f1': 0.9786405, 'auroc': 0.99681056, 'binary_precision': 0.9751407, 'binary_recall': 0.9618639, 'binary_specificity': 0.9912314, 'binary_f1_score': 0.96845675}
confusion matrix:
       0      1
0  41939    371
1    577  14553
---- Validation: 
scalar performance:
{'acc': 0.95978266, 'precision': 0.6937745, 'recall': 0.7519624, 'specificity': 0.7519624, 'f1': 0.71856046, 'auroc': 0.87317973, 'binary_precision': 0.40328696, 'binary_recall': 0.5299003, 'binary_specificity': 0.97402453, 'binary_f1_score': 0.4580043}
confusion matrix:
       0    1
0  17699  472
1    283  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.7475495, 'recall': 0.681013, 'specificity': 0.681013, 'f1': 0.7084833, 'auroc': 0.84977615, 'binary_precision': 0.52, 'binary_recall': 0.37603307, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.43645084}
confusion matrix:
      0   1
0  5913  84
1   151  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_13.png
early stop counter: 5
val acc:0.9597826600074768, best validation acc: 0.9637777805328369, corresponding to test acc:                         0.9690655469894409 / 0.9703478217124939
after epoch: 13,now: 2024-06-24 08:37:14.031530,epoch time: 0:15:33.905228,used: 3:23:55.193042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98213786, 'precision': 0.9787354, 'recall': 0.9750927, 'specificity': 0.9750927, 'f1': 0.976895, 'auroc': 0.9969175, 'binary_precision': 0.9716388, 'binary_recall': 0.9602062, 'binary_specificity': 0.9899792, 'binary_f1_score': 0.96588874}
confusion matrix:
       0      1
0  41888    424
1    602  14526
---- Validation: 
scalar performance:
{'acc': 0.96127415, 'precision': 0.70037085, 'recall': 0.7479146, 'specificity': 0.7479146, 'f1': 0.7212944, 'auroc': 0.87387705, 'binary_precision': 0.41677764, 'binary_recall': 0.5199336, 'binary_specificity': 0.97589564, 'binary_f1_score': 0.46267557}
confusion matrix:
       0    1
0  17733  438
1    289  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96297485, 'precision': 0.75424755, 'recall': 0.67143285, 'specificity': 0.67143285, 'f1': 0.7038343, 'auroc': 0.8440453, 'binary_precision': 0.5341615, 'binary_recall': 0.3553719, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.426799}
confusion matrix:
      0   1
0  5922  75
1   156  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_14.png
early stop counter: 6
val acc:0.9612741470336914, best validation acc: 0.9637777805328369, corresponding to test acc:                         0.9690655469894409 / 0.9703478217124939
after epoch: 14,now: 2024-06-24 08:53:56.230672,epoch time: 0:16:42.199142,used: 3:40:37.392184,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9834262, 'precision': 0.98059165, 'recall': 0.97656286, 'specificity': 0.97656286, 'f1': 0.978554, 'auroc': 0.99754393, 'binary_precision': 0.9746869, 'binary_recall': 0.9620596, 'binary_specificity': 0.99106616, 'binary_f1_score': 0.9683321}
confusion matrix:
       0      1
0  41933    378
1    574  14555
---- Validation: 
scalar performance:
{'acc': 0.96052843, 'precision': 0.70040417, 'recall': 0.77001476, 'specificity': 0.77001476, 'f1': 0.729378, 'auroc': 0.8808545, 'binary_precision': 0.41534713, 'binary_recall': 0.5664452, 'binary_specificity': 0.9735843, 'binary_f1_score': 0.47926915}
confusion matrix:
       0    1
0  17691  480
1    261  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.75778097, 'recall': 0.71142113, 'specificity': 0.71142113, 'f1': 0.73203015, 'auroc': 0.85408044, 'binary_precision': 0.53807104, 'binary_recall': 0.43801653, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.4829157}
confusion matrix:
      0    1
0  5906   91
1   136  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_15.png
early stop counter: 7
val acc:0.9605284333229065, best validation acc: 0.9637777805328369, corresponding to test acc:                         0.9690655469894409 / 0.9703478217124939
after epoch: 15,now: 2024-06-24 09:11:09.216016,epoch time: 0:17:12.985344,used: 3:57:50.377528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9843489, 'precision': 0.98233646, 'recall': 0.9771904, 'specificity': 0.9771904, 'f1': 0.9797257, 'auroc': 0.99704957, 'binary_precision': 0.9781601, 'binary_recall': 0.9620621, 'binary_specificity': 0.99231863, 'binary_f1_score': 0.9700443}
confusion matrix:
       0      1
0  41985    325
1    574  14556
---- Validation: 
scalar performance:
{'acc': 0.9624993, 'precision': 0.7053193, 'recall': 0.73810786, 'specificity': 0.73810786, 'f1': 0.7203489, 'auroc': 0.8587433, 'binary_precision': 0.42735043, 'binary_recall': 0.49833888, 'binary_specificity': 0.97787684, 'binary_f1_score': 0.4601227}
confusion matrix:
       0    1
0  17769  402
1    302  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.7456106, 'recall': 0.6273123, 'specificity': 0.6273123, 'f1': 0.66555953, 'auroc': 0.83293784, 'binary_precision': 0.5203252, 'binary_recall': 0.2644628, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.35068488}
confusion matrix:
      0   1
0  5938  59
1   178  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_16.png
early stop counter: 8
val acc:0.9624993205070496, best validation acc: 0.9637777805328369, corresponding to test acc:                         0.9690655469894409 / 0.9703478217124939
after epoch: 16,now: 2024-06-24 09:28:30.736743,epoch time: 0:17:21.520727,used: 4:15:11.898255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98361766, 'precision': 0.9822166, 'recall': 0.975399, 'specificity': 0.975399, 'f1': 0.9787419, 'auroc': 0.9974508, 'binary_precision': 0.9793257, 'binary_recall': 0.9580304, 'binary_specificity': 0.9927677, 'binary_f1_score': 0.968561}
confusion matrix:
       0      1
0  42004    306
1    635  14495
---- Validation: 
scalar performance:
{'acc': 0.9628189, 'precision': 0.70778626, 'recall': 0.74228823, 'specificity': 0.74228823, 'f1': 0.72354966, 'auroc': 0.8696637, 'binary_precision': 0.43201134, 'binary_recall': 0.50664455, 'binary_specificity': 0.97793186, 'binary_f1_score': 0.46636087}
confusion matrix:
       0    1
0  17770  401
1    297  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95640326, 'precision': 0.6892229, 'recall': 0.6283596, 'specificity': 0.6283596, 'f1': 0.6521025, 'auroc': 0.83174527, 'binary_precision': 0.4074074, 'binary_recall': 0.27272728, 'binary_specificity': 0.983992, 'binary_f1_score': 0.3267327}
confusion matrix:
      0   1
0  5901  96
1   176  66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_17.png
early stop counter: 9
val acc:0.9628189206123352, best validation acc: 0.9637777805328369, corresponding to test acc:                         0.9690655469894409 / 0.9703478217124939
after epoch: 17,now: 2024-06-24 09:46:02.045608,epoch time: 0:17:31.308865,used: 4:32:43.207120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9841922, 'precision': 0.9835081, 'recall': 0.975598, 'specificity': 0.975598, 'f1': 0.97946465, 'auroc': 0.9973074, 'binary_precision': 0.9821017, 'binary_recall': 0.95743555, 'binary_specificity': 0.99376035, 'binary_f1_score': 0.9696117}
confusion matrix:
       0      1
0  42046    264
1    644  14486
---- Validation: 
scalar performance:
{'acc': 0.96649444, 'precision': 0.7294496, 'recall': 0.7217015, 'specificity': 0.7217015, 'f1': 0.72550154, 'auroc': 0.8731293, 'binary_precision': 0.4767642, 'binary_recall': 0.4601329, 'binary_specificity': 0.98327005, 'binary_f1_score': 0.46830094}
confusion matrix:
       0    1
0  17867  304
1    325  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.7574178, 'recall': 0.60781837, 'specificity': 0.60781837, 'f1': 0.648759, 'auroc': 0.8334763, 'binary_precision': 0.54545456, 'binary_recall': 0.2231405, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.31671554}
confusion matrix:
      0   1
0  5952  45
1   188  54
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_18.png
better model found
persisted
after epoch: 18,now: 2024-06-24 10:05:02.152904,epoch time: 0:19:00.107296,used: 4:51:43.314416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9830432, 'precision': 0.9843724, 'recall': 0.9718034, 'specificity': 0.9718034, 'f1': 0.97786695, 'auroc': 0.9971749, 'binary_precision': 0.98706305, 'binary_recall': 0.94805026, 'binary_specificity': 0.9955566, 'binary_f1_score': 0.9671634}
confusion matrix:
       0      1
0  42122    188
1    786  14344
---- Validation: 
scalar performance:
{'acc': 0.9655356, 'precision': 0.722455, 'recall': 0.7228123, 'specificity': 0.7228123, 'f1': 0.7226335, 'auroc': 0.87950474, 'binary_precision': 0.46268657, 'binary_recall': 0.46345514, 'binary_specificity': 0.9821694, 'binary_f1_score': 0.46307054}
confusion matrix:
       0    1
0  17847  324
1    323  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.7805658, 'recall': 0.62451404, 'specificity': 0.62451404, 'f1': 0.669483, 'auroc': 0.84688485, 'binary_precision': 0.5904762, 'binary_recall': 0.25619835, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.3573487}
confusion matrix:
      0   1
0  5954  43
1   180  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_19.png
early stop counter: 1
val acc:0.965535581111908, best validation acc: 0.9664944410324097, corresponding to test acc:                         0.9626542925834656 / 0.9703478217124939
after epoch: 19,now: 2024-06-24 10:25:49.022996,epoch time: 0:20:46.870092,used: 5:12:30.184508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9834784, 'precision': 0.9841831, 'recall': 0.97309506, 'specificity': 0.97309506, 'f1': 0.97846663, 'auroc': 0.997265, 'binary_precision': 0.98561645, 'binary_recall': 0.9511534, 'binary_specificity': 0.9950368, 'binary_f1_score': 0.96807826}
confusion matrix:
       0      1
0  42101    210
1    739  14390
---- Validation: 
scalar performance:
{'acc': 0.96606827, 'precision': 0.72468066, 'recall': 0.7062234, 'specificity': 0.7062234, 'f1': 0.71501243, 'auroc': 0.87769014, 'binary_precision': 0.46823958, 'binary_recall': 0.42857143, 'binary_specificity': 0.9838754, 'binary_f1_score': 0.44752818}
confusion matrix:
       0    1
0  17878  293
1    344  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9640968, 'precision': 0.7905819, 'recall': 0.59865505, 'specificity': 0.59865505, 'f1': 0.64296037, 'auroc': 0.83868897, 'binary_precision': 0.6125, 'binary_recall': 0.20247933, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.30434784}
confusion matrix:
      0   1
0  5966  31
1   193  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_20.png
early stop counter: 2
val acc:0.9660682678222656, best validation acc: 0.9664944410324097, corresponding to test acc:                         0.9626542925834656 / 0.9703478217124939
after epoch: 20,now: 2024-06-24 10:47:05.276684,epoch time: 0:21:16.253688,used: 5:33:46.438196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98488855, 'precision': 0.98275995, 'recall': 0.97817236, 'specificity': 0.97817236, 'f1': 0.9804362, 'auroc': 0.99754834, 'binary_precision': 0.9783338, 'binary_recall': 0.9639788, 'binary_specificity': 0.9923659, 'binary_f1_score': 0.97110325}
confusion matrix:
       0      1
0  41987    323
1    545  14585
---- Validation: 
scalar performance:
{'acc': 0.9637778, 'precision': 0.71104276, 'recall': 0.7259195, 'specificity': 0.7259195, 'f1': 0.71819717, 'auroc': 0.8734312, 'binary_precision': 0.43962848, 'binary_recall': 0.4717608, 'binary_specificity': 0.98007816, 'binary_f1_score': 0.45512822}
confusion matrix:
       0    1
0  17809  362
1    318  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9631351, 'precision': 0.75996625, 'recall': 0.6358268, 'specificity': 0.6358268, 'f1': 0.67629766, 'auroc': 0.843816, 'binary_precision': 0.5483871, 'binary_recall': 0.28099173, 'binary_specificity': 0.990662, 'binary_f1_score': 0.37158468}
confusion matrix:
      0   1
0  5941  56
1   174  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_21.png
early stop counter: 3
val acc:0.9637777805328369, best validation acc: 0.9664944410324097, corresponding to test acc:                         0.9626542925834656 / 0.9703478217124939
after epoch: 21,now: 2024-06-24 11:09:33.887127,epoch time: 0:22:28.610443,used: 5:56:15.048639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98360026, 'precision': 0.98437715, 'recall': 0.9732218, 'specificity': 0.9732218, 'f1': 0.97862506, 'auroc': 0.9970499, 'binary_precision': 0.98595697, 'binary_recall': 0.9512888, 'binary_specificity': 0.9951548, 'binary_f1_score': 0.9683127}
confusion matrix:
       0      1
0  42105    205
1    737  14393
---- Validation: 
scalar performance:
{'acc': 0.9675065, 'precision': 0.73790544, 'recall': 0.73025477, 'specificity': 0.73025477, 'f1': 0.7340108, 'auroc': 0.86702836, 'binary_precision': 0.49312714, 'binary_recall': 0.47674417, 'binary_specificity': 0.98376536, 'binary_f1_score': 0.4847973}
confusion matrix:
       0    1
0  17876  295
1    315  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.7691787, 'recall': 0.6261633, 'specificity': 0.6261633, 'f1': 0.66910946, 'auroc': 0.83614445, 'binary_precision': 0.5675676, 'binary_recall': 0.2603306, 'binary_specificity': 0.991996, 'binary_f1_score': 0.35694054}
confusion matrix:
      0   1
0  5949  48
1   179  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_22.png
better model found
persisted
after epoch: 22,now: 2024-06-24 11:34:52.813361,epoch time: 0:25:18.926234,used: 6:21:33.974873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98464483, 'precision': 0.9817074, 'recall': 0.97862256, 'specificity': 0.97862256, 'f1': 0.9801514, 'auroc': 0.9973308, 'binary_precision': 0.9755674, 'binary_recall': 0.9658956, 'binary_specificity': 0.9913496, 'binary_f1_score': 0.9707074}
confusion matrix:
       0      1
0  41944    366
1    516  14614
---- Validation: 
scalar performance:
{'acc': 0.9610611, 'precision': 0.7005017, 'recall': 0.75503194, 'specificity': 0.75503194, 'f1': 0.724077, 'auroc': 0.8704004, 'binary_precision': 0.41655886, 'binary_recall': 0.53488374, 'binary_specificity': 0.9751802, 'binary_f1_score': 0.46836364}
confusion matrix:
       0    1
0  17720  451
1    280  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95816636, 'precision': 0.71448255, 'recall': 0.6828108, 'specificity': 0.6828108, 'f1': 0.69720674, 'auroc': 0.84089994, 'binary_precision': 0.45365855, 'binary_recall': 0.38429752, 'binary_specificity': 0.981324, 'binary_f1_score': 0.4161074}
confusion matrix:
      0    1
0  5885  112
1   149   93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_23.png
early stop counter: 1
val acc:0.9610611200332642, best validation acc: 0.9675065279006958, corresponding to test acc:                         0.9636159539222717 / 0.9703478217124939
after epoch: 23,now: 2024-06-24 12:04:33.553485,epoch time: 0:29:40.740124,used: 6:51:14.714997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9852716, 'precision': 0.9864702, 'recall': 0.97548, 'specificity': 0.97548, 'f1': 0.9808068, 'auroc': 0.99789405, 'binary_precision': 0.9889094, 'binary_recall': 0.9547888, 'binary_specificity': 0.99617124, 'binary_f1_score': 0.97154963}
confusion matrix:
       0      1
0  42149    162
1    684  14445
---- Validation: 
scalar performance:
{'acc': 0.96649444, 'precision': 0.7274706, 'recall': 0.6992161, 'specificity': 0.6992161, 'f1': 0.71230495, 'auroc': 0.88254386, 'binary_precision': 0.47428572, 'binary_recall': 0.41362128, 'binary_specificity': 0.98481095, 'binary_f1_score': 0.4418811}
confusion matrix:
       0    1
0  17895  276
1    353  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.7972306, 'recall': 0.5846925, 'specificity': 0.5846925, 'f1': 0.6266775, 'auroc': 0.8357419, 'binary_precision': 0.6268657, 'binary_recall': 0.17355372, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.27184466}
confusion matrix:
      0   1
0  5972  25
1   200  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_24.png
early stop counter: 2
val acc:0.9664944410324097, best validation acc: 0.9675065279006958, corresponding to test acc:                         0.9636159539222717 / 0.9703478217124939
after epoch: 24,now: 2024-06-24 12:25:47.435847,epoch time: 0:21:13.882362,used: 7:12:28.597359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9841748, 'precision': 0.9817179, 'recall': 0.97736824, 'specificity': 0.97736824, 'f1': 0.979516, 'auroc': 0.99705034, 'binary_precision': 0.9766054, 'binary_recall': 0.962985, 'binary_specificity': 0.99175155, 'binary_f1_score': 0.9697473}
confusion matrix:
       0      1
0  41962    349
1    560  14569
---- Validation: 
scalar performance:
{'acc': 0.96228623, 'precision': 0.70566225, 'recall': 0.74763435, 'specificity': 0.74763435, 'f1': 0.724459, 'auroc': 0.87703395, 'binary_precision': 0.42739725, 'binary_recall': 0.5182724, 'binary_specificity': 0.9769963, 'binary_f1_score': 0.46846846}
confusion matrix:
       0    1
0  17753  418
1    290  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95656353, 'precision': 0.68851507, 'recall': 0.6224948, 'specificity': 0.6224948, 'f1': 0.64747417, 'auroc': 0.82995266, 'binary_precision': 0.4064516, 'binary_recall': 0.2603306, 'binary_specificity': 0.984659, 'binary_f1_score': 0.31738037}
confusion matrix:
      0   1
0  5905  92
1   179  63
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_25.png
early stop counter: 3
val acc:0.9622862339019775, best validation acc: 0.9675065279006958, corresponding to test acc:                         0.9636159539222717 / 0.9703478217124939
after epoch: 25,now: 2024-06-24 12:45:38.395734,epoch time: 0:19:50.959887,used: 7:32:19.557246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98539346, 'precision': 0.985654, 'recall': 0.9765832, 'specificity': 0.9765832, 'f1': 0.9810034, 'auroc': 0.99732435, 'binary_precision': 0.98618764, 'binary_recall': 0.9579643, 'binary_specificity': 0.99520206, 'binary_f1_score': 0.97187114}
confusion matrix:
       0      1
0  42107    203
1    636  14494
---- Validation: 
scalar performance:
{'acc': 0.9674, 'precision': 0.7363881, 'recall': 0.71735096, 'specificity': 0.71735096, 'f1': 0.72642696, 'auroc': 0.8867438, 'binary_precision': 0.49094203, 'binary_recall': 0.4501661, 'binary_specificity': 0.9845358, 'binary_f1_score': 0.46967074}
confusion matrix:
       0    1
0  17890  281
1    331  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.74493444, 'recall': 0.5974878, 'specificity': 0.5974878, 'f1': 0.6360326, 'auroc': 0.83992565, 'binary_precision': 0.5212766, 'binary_recall': 0.20247933, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.29166663}
confusion matrix:
      0   1
0  5952  45
1   193  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_26.png
early stop counter: 4
val acc:0.9674000144004822, best validation acc: 0.9675065279006958, corresponding to test acc:                         0.9636159539222717 / 0.9703478217124939
after epoch: 26,now: 2024-06-24 13:05:29.501560,epoch time: 0:19:51.105826,used: 7:52:10.663072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9842444, 'precision': 0.9833531, 'recall': 0.97588813, 'specificity': 0.97588813, 'f1': 0.97954184, 'auroc': 0.99747056, 'binary_precision': 0.98151785, 'binary_recall': 0.9582287, 'binary_specificity': 0.9935476, 'binary_f1_score': 0.9697334}
confusion matrix:
       0      1
0  42037    273
1    632  14498
---- Validation: 
scalar performance:
{'acc': 0.9629255, 'precision': 0.70753634, 'recall': 0.7367219, 'specificity': 0.7367219, 'f1': 0.7210512, 'auroc': 0.8866528, 'binary_precision': 0.43188405, 'binary_recall': 0.4950166, 'binary_specificity': 0.9784272, 'binary_f1_score': 0.4613003}
confusion matrix:
       0    1
0  17779  392
1    304  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.7105742, 'recall': 0.60218537, 'specificity': 0.60218537, 'f1': 0.63522184, 'auroc': 0.831893, 'binary_precision': 0.45217392, 'binary_recall': 0.21487603, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.29131654}
confusion matrix:
      0   1
0  5934  63
1   190  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_27.png
early stop counter: 5
val acc:0.9629254937171936, best validation acc: 0.9675065279006958, corresponding to test acc:                         0.9636159539222717 / 0.9703478217124939
after epoch: 27,now: 2024-06-24 13:26:36.753318,epoch time: 0:21:07.251758,used: 8:13:17.914830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9857416, 'precision': 0.9834873, 'recall': 0.97966325, 'specificity': 0.97966325, 'f1': 0.9815545, 'auroc': 0.9975699, 'binary_precision': 0.9787875, 'binary_recall': 0.9668187, 'binary_specificity': 0.9925079, 'binary_f1_score': 0.9727663}
confusion matrix:
       0      1
0  41994    317
1    502  14627
---- Validation: 
scalar performance:
{'acc': 0.9637778, 'precision': 0.7123301, 'recall': 0.734753, 'specificity': 0.734753, 'f1': 0.7229109, 'auroc': 0.8753935, 'binary_precision': 0.44161677, 'binary_recall': 0.4900332, 'binary_specificity': 0.9794728, 'binary_f1_score': 0.46456692}
confusion matrix:
       0    1
0  17798  373
1    307  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584869, 'precision': 0.7045884, 'recall': 0.6195298, 'specificity': 0.6195298, 'f1': 0.6493999, 'auroc': 0.82616174, 'binary_precision': 0.4388489, 'binary_recall': 0.2520661, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.32020998}
confusion matrix:
      0   1
0  5919  78
1   181  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_28.png
early stop counter: 6
val acc:0.9637777805328369, best validation acc: 0.9675065279006958, corresponding to test acc:                         0.9636159539222717 / 0.9703478217124939
after epoch: 28,now: 2024-06-24 13:45:55.440769,epoch time: 0:19:18.687451,used: 8:32:36.602281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9859854, 'precision': 0.9853325, 'recall': 0.9784286, 'specificity': 0.9784286, 'f1': 0.98181355, 'auroc': 0.9973041, 'binary_precision': 0.9839854, 'binary_recall': 0.96245867, 'binary_specificity': 0.9943985, 'binary_f1_score': 0.97310305}
confusion matrix:
       0      1
0  42073    237
1    568  14562
---- Validation: 
scalar performance:
{'acc': 0.96510947, 'precision': 0.7186267, 'recall': 0.71616775, 'specificity': 0.71616775, 'f1': 0.71738946, 'auroc': 0.87396526, 'binary_precision': 0.4554622, 'binary_recall': 0.4501661, 'binary_specificity': 0.9821694, 'binary_f1_score': 0.45279866}
confusion matrix:
       0    1
0  17847  324
1    331  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.73116803, 'recall': 0.6207804, 'specificity': 0.6207804, 'f1': 0.65659404, 'auroc': 0.82588124, 'binary_precision': 0.4919355, 'binary_recall': 0.2520661, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.3333333}
confusion matrix:
      0   1
0  5934  63
1   181  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_29.png
early stop counter: 7
val acc:0.9651094675064087, best validation acc: 0.9675065279006958, corresponding to test acc:                         0.9636159539222717 / 0.9703478217124939
after epoch: 29,now: 2024-06-24 14:05:30.597131,epoch time: 0:19:35.156362,used: 8:52:11.758643,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9854979, 'precision': 0.98467404, 'recall': 0.9778217, 'specificity': 0.9778217, 'f1': 0.9811817, 'auroc': 0.9980353, 'binary_precision': 0.9829741, 'binary_recall': 0.96159947, 'binary_specificity': 0.99404395, 'binary_f1_score': 0.9721693}
confusion matrix:
       0      1
0  42058    252
1    581  14549
---- Validation: 
scalar performance:
{'acc': 0.9634049, 'precision': 0.706988, 'recall': 0.7152872, 'specificity': 0.7152872, 'f1': 0.7110461, 'auroc': 0.8847358, 'binary_precision': 0.4322169, 'binary_recall': 0.4501661, 'binary_specificity': 0.9804084, 'binary_f1_score': 0.44100899}
confusion matrix:
       0    1
0  17815  356
1    331  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.705568, 'recall': 0.59805316, 'specificity': 0.59805316, 'f1': 0.6303279, 'auroc': 0.8279624, 'binary_precision': 0.44247788, 'binary_recall': 0.20661157, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.28169015}
confusion matrix:
      0   1
0  5934  63
1   192  50
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21551151_30.png
early stop counter: 8
val acc:0.9634048938751221, best validation acc: 0.9675065279006958, corresponding to test acc:                         0.9636159539222717 / 0.9703478217124939
after epoch: 30,now: 2024-06-24 14:26:23.939892,epoch time: 0:20:53.342761,used: 9:13:05.101404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_24_05_13_18_seed_2_21551151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:13:05.101404 at 2024-06-24 14:26:23.939892
persisted model performance metric: 

scalar performance:
{'acc': 0.96361595, 'precision': 0.7691787, 'recall': 0.6261633, 'specificity': 0.6261633, 'f1': 0.66910946, 'auroc': 0.83614445, 'binary_precision': 0.5675676, 'binary_recall': 0.2603306, 'binary_specificity': 0.991996, 'binary_f1_score': 0.35694054}
confusion matrix:
      0   1
0  5949  48
1   179  63
oracle model performance metric: 

scalar performance:
{'acc': 0.9703478, 'precision': 0.8286029, 'recall': 0.71888834, 'specificity': 0.71888834, 'f1': 0.7616675, 'auroc': 0.85716224, 'binary_precision': 0.6792453, 'binary_recall': 0.446281, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.5386534}
confusion matrix:
      0    1
0  5946   51
1   134  108
results aggregation path: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_erm_differentlearningrates_bs16_classbalancing10/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 204077 KiB | 640729 KiB |   3464 TiB |   3464 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   3463 TiB |   3463 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 204077 KiB | 640729 KiB |   3464 TiB |   3464 TiB |
|       from large pool | 167040 KiB | 568000 KiB |   3463 TiB |   3463 TiB |
|       from small pool |  37037 KiB |  75082 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 201087 KiB | 632296 KiB |   3447 TiB |   3447 TiB |
|       from large pool | 165120 KiB | 560704 KiB |   3446 TiB |   3446 TiB |
|       from small pool |  35967 KiB |  73944 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 675840 KiB | 755712 KiB |   1500 MiB |    840 MiB |
|       from large pool | 600064 KiB | 679936 KiB |   1376 MiB |    790 MiB |
|       from small pool |  75776 KiB |  75776 KiB |    124 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  82642 KiB | 218089 KiB |   1239 TiB |   1239 TiB |
|       from large pool |  68480 KiB | 217080 KiB |   1238 TiB |   1238 TiB |
|       from small pool |  14162 KiB |  21751 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3240    |    7929    |  306014 K  |  306010 K  |
|       from large pool |      36    |      76    |  124080 K  |  124080 K  |
|       from small pool |    3204    |    7892    |  181933 K  |  181930 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3240    |    7929    |  306014 K  |  306010 K  |
|       from large pool |      36    |      76    |  124080 K  |  124080 K  |
|       from small pool |    3204    |    7892    |  181933 K  |  181930 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |      51    |      84    |      33    |
|       from large pool |      14    |      14    |      22    |       8    |
|       from small pool |      37    |      37    |      62    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      38    |    3604    |  140102 K  |  140102 K  |
|       from large pool |       5    |      13    |   47110 K  |   47110 K  |
|       from small pool |      33    |    3599    |   92991 K  |   92991 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB | 640729 KiB |   3464 TiB |   3464 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   3463 TiB |   3463 TiB |
|       from small pool |      0 KiB |  75082 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB | 640729 KiB |   3464 TiB |   3464 TiB |
|       from large pool |  16640 KiB | 568000 KiB |   3463 TiB |   3463 TiB |
|       from small pool |      0 KiB |  75082 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 632296 KiB |   3447 TiB |   3447 TiB |
|       from large pool |  16640 KiB | 560704 KiB |   3446 TiB |   3446 TiB |
|       from small pool |      0 KiB |  73944 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 755712 KiB |   1500 MiB |   1220 MiB |
|       from large pool | 235520 KiB | 679936 KiB |   1376 MiB |   1146 MiB |
|       from small pool |  51200 KiB |  75776 KiB |    124 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55040 KiB | 218089 KiB |   1239 TiB |   1239 TiB |
|       from large pool |  55040 KiB | 217080 KiB |   1238 TiB |   1238 TiB |
|       from small pool |      0 KiB |  21757 KiB |      1 TiB |      1 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7929    |  306014 K  |  306014 K  |
|       from large pool |       2    |      76    |  124080 K  |  124080 K  |
|       from small pool |       0    |    7892    |  181933 K  |  181933 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7929    |  306014 K  |  306014 K  |
|       from large pool |       2    |      76    |  124080 K  |  124080 K  |
|       from small pool |       0    |    7892    |  181933 K  |  181933 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      35    |      51    |      84    |      49    |
|       from large pool |      10    |      14    |      22    |      12    |
|       from small pool |      25    |      37    |      62    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3604    |  140103 K  |  140103 K  |
|       from large pool |       3    |      13    |   47110 K  |   47110 K  |
|       from small pool |       0    |    3599    |   92992 K  |   92992 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jun 24 14:27:25 2024]
Finished job 0.
1 of 1 steps (100%) done
