Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 10 04:43:05 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619

 Experiment start at: 2024-07-10 04:49:25.126493
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93981415, 'precision': 0.95873225, 'recall': 0.88578856, 'specificity': 0.88578856, 'f1': 0.91499114, 'auroc': 0.96586746, 'binary_precision': 0.99043643, 'binary_recall': 0.774176, 'binary_specificity': 0.99740106, 'binary_f1_score': 0.8690544}
confusion matrix:
       0      1
0  42215    110
1   3323  11392
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.95008516, 'precision': 0.5461988, 'recall': 0.52862555, 'specificity': 0.52862555, 'f1': 0.53446484, 'auroc': 0.79778194, 'binary_precision': 0.124681935, 'binary_recall': 0.07620529, 'binary_specificity': 0.9810458, 'binary_f1_score': 0.09459459}
confusion matrix:
       0    1
0  17805  344
1    594   49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9493448, 'precision': 0.5987438, 'recall': 0.54113936, 'specificity': 0.54113936, 'f1': 0.55507356, 'auroc': 0.82880044, 'binary_precision': 0.23584905, 'binary_recall': 0.09578544, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.13623978}
confusion matrix:
      0   1
0  5916  81
1   236  25
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 05:11:49.412898,epoch time: 0:22:24.286405,used: 0:22:24.286405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9545582, 'precision': 0.964977, 'recall': 0.9164927, 'specificity': 0.9164927, 'f1': 0.93751466, 'auroc': 0.9814584, 'binary_precision': 0.983566, 'binary_recall': 0.83785254, 'binary_specificity': 0.9951329, 'binary_f1_score': 0.90488076}
confusion matrix:
       0      1
0  42119    206
1   2386  12329
---- Validation: 
scalar performance:
{'acc': 0.95184124, 'precision': 0.6216699, 'recall': 0.6082905, 'specificity': 0.6082905, 'f1': 0.61451674, 'auroc': 0.8555876, 'binary_precision': 0.27017543, 'binary_recall': 0.23950233, 'binary_specificity': 0.9770786, 'binary_f1_score': 0.2539159}
confusion matrix:
       0    1
0  17733  416
1    489  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542985, 'precision': 0.69994974, 'recall': 0.6390053, 'specificity': 0.6390053, 'f1': 0.66315836, 'auroc': 0.8812099, 'binary_precision': 0.4301676, 'binary_recall': 0.29501915, 'binary_specificity': 0.9829915, 'binary_f1_score': 0.35}
confusion matrix:
      0    1
0  5895  102
1   184   77
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-10 05:33:42.621213,epoch time: 0:21:53.208315,used: 0:44:17.494720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9612728, 'precision': 0.9681454, 'recall': 0.93049085, 'specificity': 0.93049085, 'f1': 0.9473721, 'auroc': 0.985638, 'binary_precision': 0.9807811, 'binary_recall': 0.86688864, 'binary_specificity': 0.99409306, 'binary_f1_score': 0.9203246}
confusion matrix:
       0      1
0  42073    250
1   1959  12758
---- Validation: 
scalar performance:
{'acc': 0.95508724, 'precision': 0.66129017, 'recall': 0.66322494, 'specificity': 0.66322494, 'f1': 0.6622509, 'auroc': 0.8778894, 'binary_precision': 0.34562212, 'binary_recall': 0.34992224, 'binary_specificity': 0.97652763, 'binary_f1_score': 0.3477589}
confusion matrix:
       0    1
0  17723  426
1    418  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.75162905, 'recall': 0.7135512, 'specificity': 0.7135512, 'f1': 0.73081934, 'auroc': 0.8988044, 'binary_precision': 0.5272727, 'binary_recall': 0.44444445, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.48232847}
confusion matrix:
      0    1
0  5893  104
1   145  116
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-10 05:55:30.022970,epoch time: 0:21:47.401757,used: 1:06:04.896477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9670582, 'precision': 0.9696702, 'recall': 0.94376326, 'specificity': 0.94376326, 'f1': 0.9557879, 'auroc': 0.98866934, 'binary_precision': 0.9746377, 'binary_recall': 0.8956309, 'binary_specificity': 0.9918957, 'binary_f1_score': 0.93346554}
confusion matrix:
       0      1
0  41980    343
1   1536  13181
---- Validation: 
scalar performance:
{'acc': 0.95317155, 'precision': 0.66599715, 'recall': 0.7049863, 'specificity': 0.7049863, 'f1': 0.68311596, 'auroc': 0.89029026, 'binary_precision': 0.35205993, 'binary_recall': 0.43856922, 'binary_specificity': 0.97140336, 'binary_f1_score': 0.39058173}
confusion matrix:
       0    1
0  17630  519
1    361  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.75924283, 'recall': 0.7875949, 'specificity': 0.7875949, 'f1': 0.7725786, 'auroc': 0.90647495, 'binary_precision': 0.53608245, 'binary_recall': 0.59770113, 'binary_specificity': 0.97748876, 'binary_f1_score': 0.5652174}
confusion matrix:
      0    1
0  5862  135
1   105  156
new oracle model saved
early stop counter: 1
val acc:0.9531715512275696, best validation acc: 0.9550872445106506, corresponding to test acc:                         0.960210919380188 / 0.9616490602493286
after epoch: 4,now: 2024-07-10 06:17:13.871923,epoch time: 0:21:43.848953,used: 1:27:48.745430,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9705996, 'precision': 0.97172797, 'recall': 0.95098364, 'specificity': 0.95098364, 'f1': 0.96076, 'auroc': 0.9900882, 'binary_precision': 0.973908, 'binary_recall': 0.9104498, 'binary_specificity': 0.9915174, 'binary_f1_score': 0.94111043}
confusion matrix:
       0      1
0  41963    359
1   1318  13400
---- Validation: 
scalar performance:
{'acc': 0.9526394, 'precision': 0.6708087, 'recall': 0.73096275, 'specificity': 0.73096275, 'f1': 0.69566476, 'auroc': 0.8973858, 'binary_precision': 0.3598184, 'binary_recall': 0.49300155, 'binary_specificity': 0.9689239, 'binary_f1_score': 0.4160105}
confusion matrix:
       0    1
0  17585  564
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.75306594, 'recall': 0.81266403, 'specificity': 0.81266403, 'f1': 0.7792553, 'auroc': 0.91134334, 'binary_precision': 0.5214724, 'binary_recall': 0.651341, 'binary_specificity': 0.973987, 'binary_f1_score': 0.57921636}
confusion matrix:
      0    1
0  5841  156
1    91  170
early stop counter: 2
val acc:0.9526394009590149, best validation acc: 0.9550872445106506, corresponding to test acc:                         0.960210919380188 / 0.9616490602493286
after epoch: 5,now: 2024-07-10 06:38:47.869672,epoch time: 0:21:33.997749,used: 1:49:22.743179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97207224, 'precision': 0.9721, 'recall': 0.954455, 'specificity': 0.954455, 'f1': 0.9628453, 'auroc': 0.9908601, 'binary_precision': 0.97215426, 'binary_recall': 0.9180539, 'binary_specificity': 0.99085605, 'binary_f1_score': 0.94432986}
confusion matrix:
       0      1
0  41936    387
1   1206  13511
---- Validation: 
scalar performance:
{'acc': 0.9513091, 'precision': 0.6723307, 'recall': 0.75727594, 'specificity': 0.75727594, 'f1': 0.7050454, 'auroc': 0.903383, 'binary_precision': 0.3609407, 'binary_recall': 0.5489891, 'binary_specificity': 0.9655628, 'binary_f1_score': 0.4355336}
confusion matrix:
       0    1
0  17524  625
1    290  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9541387, 'precision': 0.72626346, 'recall': 0.82765234, 'specificity': 0.82765234, 'f1': 0.76611674, 'auroc': 0.91548455, 'binary_precision': 0.46632123, 'binary_recall': 0.6896552, 'binary_specificity': 0.9656495, 'binary_f1_score': 0.5564142}
confusion matrix:
      0    1
0  5791  206
1    81  180
early stop counter: 3
val acc:0.951309084892273, best validation acc: 0.9550872445106506, corresponding to test acc:                         0.960210919380188 / 0.9616490602493286
after epoch: 6,now: 2024-07-10 07:00:24.361791,epoch time: 0:21:36.492119,used: 2:10:59.235298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9741936, 'precision': 0.97667193, 'recall': 0.9556352, 'specificity': 0.9556352, 'f1': 0.96554947, 'auroc': 0.99243116, 'binary_precision': 0.9814586, 'binary_recall': 0.9172953, 'binary_specificity': 0.99397516, 'binary_f1_score': 0.9482928}
confusion matrix:
       0      1
0  42070    255
1   1217  13498
---- Validation: 
scalar performance:
{'acc': 0.95732224, 'precision': 0.69051015, 'recall': 0.731887, 'specificity': 0.731887, 'f1': 0.70888, 'auroc': 0.90273523, 'binary_precision': 0.39923954, 'binary_recall': 0.48989114, 'binary_specificity': 0.97388285, 'binary_f1_score': 0.43994412}
confusion matrix:
       0    1
0  17675  474
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.75386953, 'recall': 0.81274736, 'specificity': 0.81274736, 'f1': 0.77979225, 'auroc': 0.9159107, 'binary_precision': 0.52307695, 'binary_recall': 0.651341, 'binary_specificity': 0.97415376, 'binary_f1_score': 0.5802048}
confusion matrix:
      0    1
0  5842  155
1    91  170
better model found
persisted
after epoch: 7,now: 2024-07-10 07:21:57.312315,epoch time: 0:21:32.950524,used: 2:32:32.185822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97587657, 'precision': 0.97671187, 'recall': 0.95994854, 'specificity': 0.95994854, 'f1': 0.96794456, 'auroc': 0.9922789, 'binary_precision': 0.9783466, 'binary_recall': 0.92703307, 'binary_specificity': 0.9928641, 'binary_f1_score': 0.9519989}
confusion matrix:
       0      1
0  42019    302
1   1074  13645
---- Validation: 
scalar performance:
{'acc': 0.9527991, 'precision': 0.6778246, 'recall': 0.7587974, 'specificity': 0.7587974, 'f1': 0.70962036, 'auroc': 0.9060816, 'binary_precision': 0.37184873, 'binary_recall': 0.5505443, 'binary_specificity': 0.96705055, 'binary_f1_score': 0.4438871}
confusion matrix:
       0    1
0  17551  598
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95222116, 'precision': 0.71942174, 'recall': 0.8284842, 'specificity': 0.8284842, 'f1': 0.76121676, 'auroc': 0.9173616, 'binary_precision': 0.4525, 'binary_recall': 0.6934866, 'binary_specificity': 0.9634817, 'binary_f1_score': 0.54765505}
confusion matrix:
      0    1
0  5778  219
1    80  181
early stop counter: 1
val acc:0.9527990818023682, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 8,now: 2024-07-10 07:43:28.264135,epoch time: 0:21:30.951820,used: 2:54:03.137642,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9768408, 'precision': 0.97823846, 'recall': 0.9609901, 'specificity': 0.9609901, 'f1': 0.969208, 'auroc': 0.9931396, 'binary_precision': 0.9809695, 'binary_recall': 0.9282414, 'binary_specificity': 0.9937388, 'binary_f1_score': 0.9538773}
confusion matrix:
       0      1
0  42059    265
1   1056  13660
---- Validation: 
scalar performance:
{'acc': 0.9533844, 'precision': 0.68262327, 'recall': 0.7718514, 'specificity': 0.7718514, 'f1': 0.71711725, 'auroc': 0.9100528, 'binary_precision': 0.38051283, 'binary_recall': 0.5769829, 'binary_specificity': 0.9667199, 'binary_f1_score': 0.45859087}
confusion matrix:
       0    1
0  17545  604
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949185, 'precision': 0.7105876, 'recall': 0.837894, 'specificity': 0.837894, 'f1': 0.75678396, 'auroc': 0.91812444, 'binary_precision': 0.4338747, 'binary_recall': 0.71647507, 'binary_specificity': 0.959313, 'binary_f1_score': 0.54046243}
confusion matrix:
      0    1
0  5753  244
1    74  187
early stop counter: 2
val acc:0.9533843994140625, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 9,now: 2024-07-10 08:04:49.676979,epoch time: 0:21:21.412844,used: 3:15:24.550486,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97908485, 'precision': 0.9795474, 'recall': 0.96556276, 'specificity': 0.96556276, 'f1': 0.97228783, 'auroc': 0.9945837, 'binary_precision': 0.9804604, 'binary_recall': 0.93762314, 'binary_specificity': 0.9935024, 'binary_f1_score': 0.9585634}
confusion matrix:
       0      1
0  42048    275
1    918  13799
---- Validation: 
scalar performance:
{'acc': 0.94971263, 'precision': 0.6724495, 'recall': 0.7812013, 'specificity': 0.7812013, 'f1': 0.711637, 'auroc': 0.91066694, 'binary_precision': 0.3594041, 'binary_recall': 0.60031104, 'binary_specificity': 0.96209157, 'binary_f1_score': 0.4496214}
confusion matrix:
       0    1
0  17461  688
1    257  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94103545, 'precision': 0.6891386, 'recall': 0.8428036, 'specificity': 0.8428036, 'f1': 0.7392953, 'auroc': 0.9173393, 'binary_precision': 0.3902439, 'binary_recall': 0.7356322, 'binary_specificity': 0.949975, 'binary_f1_score': 0.5099602}
confusion matrix:
      0    1
0  5697  300
1    69  192
early stop counter: 3
val acc:0.9497126340866089, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 10,now: 2024-07-10 08:26:14.013936,epoch time: 0:21:24.336957,used: 3:36:48.887443,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9789271, 'precision': 0.98093367, 'recall': 0.963832, 'specificity': 0.963832, 'f1': 0.9719864, 'auroc': 0.9945233, 'binary_precision': 0.9848572, 'binary_recall': 0.9326492, 'binary_specificity': 0.9950149, 'binary_f1_score': 0.95804244}
confusion matrix:
       0      1
0  42115    211
1    991  13723
---- Validation: 
scalar performance:
{'acc': 0.9533844, 'precision': 0.680003, 'recall': 0.75910044, 'specificity': 0.75910044, 'f1': 0.7113182, 'auroc': 0.90827155, 'binary_precision': 0.37619555, 'binary_recall': 0.5505443, 'binary_specificity': 0.9676566, 'binary_f1_score': 0.44696972}
confusion matrix:
       0    1
0  17562  587
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9483861, 'precision': 0.7075979, 'recall': 0.8338125, 'specificity': 0.8338125, 'f1': 0.7532954, 'auroc': 0.9173354, 'binary_precision': 0.42824075, 'binary_recall': 0.70881224, 'binary_specificity': 0.9588127, 'binary_f1_score': 0.5339105}
confusion matrix:
      0    1
0  5750  247
1    76  185
early stop counter: 4
val acc:0.9533843994140625, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 11,now: 2024-07-10 08:48:03.984265,epoch time: 0:21:49.970329,used: 3:58:38.857772,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98054, 'precision': 0.9792284, 'recall': 0.9696901, 'specificity': 0.9696901, 'f1': 0.9743341, 'auroc': 0.99504924, 'binary_precision': 0.97660244, 'binary_recall': 0.9472719, 'binary_specificity': 0.9921083, 'binary_f1_score': 0.96171355}
confusion matrix:
       0      1
0  41989    334
1    776  13941
---- Validation: 
scalar performance:
{'acc': 0.9454555, 'precision': 0.6609759, 'recall': 0.7834977, 'specificity': 0.7834977, 'f1': 0.7023687, 'auroc': 0.909408, 'binary_precision': 0.3361921, 'binary_recall': 0.6096423, 'binary_specificity': 0.957353, 'binary_f1_score': 0.43338862}
confusion matrix:
       0    1
0  17375  774
1    251  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93208694, 'precision': 0.66949797, 'recall': 0.8399669, 'specificity': 0.8399669, 'f1': 0.7198231, 'auroc': 0.91745687, 'binary_precision': 0.35090908, 'binary_recall': 0.7394636, 'binary_specificity': 0.9404702, 'binary_f1_score': 0.4759556}
confusion matrix:
      0    1
0  5640  357
1    68  193
early stop counter: 5
val acc:0.9454554915428162, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 12,now: 2024-07-10 09:09:19.357687,epoch time: 0:21:15.373422,used: 4:19:54.231194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9810659, 'precision': 0.9827151, 'recall': 0.96767735, 'specificity': 0.96767735, 'f1': 0.9748902, 'auroc': 0.99542224, 'binary_precision': 0.9859617, 'binary_recall': 0.94000953, 'binary_specificity': 0.9953451, 'binary_f1_score': 0.9624374}
confusion matrix:
       0      1
0  42124    197
1    883  13836
---- Validation: 
scalar performance:
{'acc': 0.95210725, 'precision': 0.67380446, 'recall': 0.7516888, 'specificity': 0.7516888, 'f1': 0.70447904, 'auroc': 0.90806603, 'binary_precision': 0.36430833, 'binary_recall': 0.5365474, 'binary_specificity': 0.96683013, 'binary_f1_score': 0.43396223}
confusion matrix:
       0    1
0  17547  602
1    298  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94263345, 'precision': 0.6898402, 'recall': 0.8234817, 'specificity': 0.8234817, 'f1': 0.73582196, 'auroc': 0.9124607, 'binary_precision': 0.39347827, 'binary_recall': 0.6934866, 'binary_specificity': 0.9534767, 'binary_f1_score': 0.5020805}
confusion matrix:
      0    1
0  5718  279
1    80  181
early stop counter: 6
val acc:0.9521072506904602, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 13,now: 2024-07-10 09:30:34.745930,epoch time: 0:21:15.388243,used: 4:41:09.619437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98211783, 'precision': 0.9831718, 'recall': 0.9699483, 'specificity': 0.9699483, 'f1': 0.97632337, 'auroc': 0.99543595, 'binary_precision': 0.9852576, 'binary_recall': 0.9448107, 'binary_specificity': 0.9950859, 'binary_f1_score': 0.96461034}
confusion matrix:
       0      1
0  42119    208
1    812  13901
---- Validation: 
scalar performance:
{'acc': 0.9538633, 'precision': 0.6780824, 'recall': 0.74209714, 'specificity': 0.74209714, 'f1': 0.7044581, 'auroc': 0.90676665, 'binary_precision': 0.37358916, 'binary_recall': 0.5147745, 'binary_specificity': 0.9694198, 'binary_f1_score': 0.43296272}
confusion matrix:
       0    1
0  17594  555
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94503033, 'precision': 0.69469655, 'recall': 0.8137383, 'specificity': 0.8137383, 'f1': 0.73761225, 'auroc': 0.91052425, 'binary_precision': 0.40415704, 'binary_recall': 0.6704981, 'binary_specificity': 0.9569785, 'binary_f1_score': 0.5043228}
confusion matrix:
      0    1
0  5739  258
1    86  175
early stop counter: 7
val acc:0.9538633227348328, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 14,now: 2024-07-10 09:51:54.764822,epoch time: 0:21:20.018892,used: 5:02:29.638329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98211783, 'precision': 0.98472595, 'recall': 0.968487, 'specificity': 0.968487, 'f1': 0.9762523, 'auroc': 0.9956602, 'binary_precision': 0.98984116, 'binary_recall': 0.94032896, 'binary_specificity': 0.9966451, 'binary_f1_score': 0.96445006}
confusion matrix:
       0      1
0  42184    142
1    878  13836
---- Validation: 
scalar performance:
{'acc': 0.95455515, 'precision': 0.6783167, 'recall': 0.73120445, 'specificity': 0.73120445, 'f1': 0.70082253, 'auroc': 0.9044806, 'binary_precision': 0.37485173, 'binary_recall': 0.49144635, 'binary_specificity': 0.9709626, 'binary_f1_score': 0.42530283}
confusion matrix:
       0    1
0  17622  527
1    327  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.944551, 'precision': 0.69236445, 'recall': 0.80799115, 'specificity': 0.80799115, 'f1': 0.7342423, 'auroc': 0.9097782, 'binary_precision': 0.4, 'binary_recall': 0.65900385, 'binary_specificity': 0.9569785, 'binary_f1_score': 0.49782926}
confusion matrix:
      0    1
0  5739  258
1    89  172
early stop counter: 8
val acc:0.9545551538467407, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 15,now: 2024-07-10 10:13:15.430467,epoch time: 0:21:20.665645,used: 5:23:50.303974,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98364305, 'precision': 0.98382616, 'recall': 0.9732865, 'specificity': 0.9732865, 'f1': 0.9784057, 'auroc': 0.9961302, 'binary_precision': 0.98419166, 'binary_recall': 0.9518891, 'binary_specificity': 0.99468386, 'binary_f1_score': 0.96777093}
confusion matrix:
       0      1
0  42099    225
1    708  14008
---- Validation: 
scalar performance:
{'acc': 0.94827586, 'precision': 0.6629054, 'recall': 0.7579558, 'specificity': 0.7579558, 'f1': 0.6978638, 'auroc': 0.9055476, 'binary_precision': 0.34197888, 'binary_recall': 0.55365473, 'binary_specificity': 0.96225685, 'binary_f1_score': 0.42280287}
confusion matrix:
       0    1
0  17464  685
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92969, 'precision': 0.6602861, 'recall': 0.81672823, 'specificity': 0.81672823, 'f1': 0.7069048, 'auroc': 0.9097432, 'binary_precision': 0.3345656, 'binary_recall': 0.6934866, 'binary_specificity': 0.93996996, 'binary_f1_score': 0.45137155}
confusion matrix:
      0    1
0  5637  360
1    80  181
early stop counter: 9
val acc:0.9482758641242981, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 16,now: 2024-07-10 10:38:35.689506,epoch time: 0:25:20.259039,used: 5:49:10.563013,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98392355, 'precision': 0.98287463, 'recall': 0.97495615, 'specificity': 0.97495615, 'f1': 0.97882986, 'auroc': 0.99621767, 'binary_precision': 0.98076385, 'binary_recall': 0.95643306, 'binary_specificity': 0.9934793, 'binary_f1_score': 0.9684456}
confusion matrix:
       0      1
0  42051    276
1    641  14072
---- Validation: 
scalar performance:
{'acc': 0.9402937, 'precision': 0.6508135, 'recall': 0.7928262, 'specificity': 0.7928262, 'f1': 0.6947882, 'auroc': 0.9114442, 'binary_precision': 0.3150579, 'binary_recall': 0.63452566, 'binary_specificity': 0.95112675, 'binary_f1_score': 0.42105263}
confusion matrix:
       0    1
0  17262  887
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91722596, 'precision': 0.64077955, 'recall': 0.81755435, 'specificity': 0.81755435, 'f1': 0.6860595, 'auroc': 0.9131034, 'binary_precision': 0.2950558, 'binary_recall': 0.70881224, 'binary_specificity': 0.9262965, 'binary_f1_score': 0.41666663}
confusion matrix:
      0    1
0  5555  442
1    76  185
early stop counter: 10
val acc:0.9402937293052673, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 17,now: 2024-07-10 11:04:54.800214,epoch time: 0:26:19.110708,used: 6:15:29.673721,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9840638, 'precision': 0.9817294, 'recall': 0.9764943, 'specificity': 0.9764943, 'f1': 0.97907424, 'auroc': 0.9962779, 'binary_precision': 0.97699004, 'binary_recall': 0.96085626, 'binary_specificity': 0.9921323, 'binary_f1_score': 0.968856}
confusion matrix:
       0      1
0  41992    333
1    576  14139
---- Validation: 
scalar performance:
{'acc': 0.9371541, 'precision': 0.639236, 'recall': 0.77169937, 'specificity': 0.77169937, 'f1': 0.6798321, 'auroc': 0.9047467, 'binary_precision': 0.29339477, 'binary_recall': 0.5940902, 'binary_specificity': 0.9493085, 'binary_f1_score': 0.39280203}
confusion matrix:
       0    1
0  17229  920
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91706616, 'precision': 0.63929373, 'recall': 0.811974, 'specificity': 0.811974, 'f1': 0.68380827, 'auroc': 0.9073456, 'binary_precision': 0.2926045, 'binary_recall': 0.697318, 'binary_specificity': 0.92662996, 'binary_f1_score': 0.41223103}
confusion matrix:
      0    1
0  5557  440
1    79  182
early stop counter: 11
val acc:0.9371541142463684, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 18,now: 2024-07-10 11:29:18.931923,epoch time: 0:24:24.131709,used: 6:39:53.805430,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9844495, 'precision': 0.9845839, 'recall': 0.9746485, 'specificity': 0.9746485, 'f1': 0.9794824, 'auroc': 0.9967756, 'binary_precision': 0.98485273, 'binary_recall': 0.9544003, 'binary_specificity': 0.99489665, 'binary_f1_score': 0.96938735}
confusion matrix:
       0      1
0  42109    216
1    671  14044
---- Validation: 
scalar performance:
{'acc': 0.94896764, 'precision': 0.65949595, 'recall': 0.7358123, 'specificity': 0.7358123, 'f1': 0.68902934, 'auroc': 0.90201557, 'binary_precision': 0.33677685, 'binary_recall': 0.5069984, 'binary_specificity': 0.96462613, 'binary_f1_score': 0.40471753}
confusion matrix:
       0    1
0  17507  642
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93799937, 'precision': 0.67377985, 'recall': 0.7990758, 'specificity': 0.7990758, 'f1': 0.7163277, 'auroc': 0.903054, 'binary_precision': 0.36344087, 'binary_recall': 0.6475096, 'binary_specificity': 0.950642, 'binary_f1_score': 0.46556476}
confusion matrix:
      0    1
0  5701  296
1    92  169
early stop counter: 12
val acc:0.9489676356315613, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 19,now: 2024-07-10 11:51:11.039469,epoch time: 0:21:52.107546,used: 7:01:45.912976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9858871, 'precision': 0.9840927, 'recall': 0.9789187, 'specificity': 0.9789187, 'f1': 0.98146915, 'auroc': 0.9969865, 'binary_precision': 0.980449, 'binary_recall': 0.96452355, 'binary_specificity': 0.9933138, 'binary_f1_score': 0.9724211}
confusion matrix:
       0      1
0  42043    283
1    522  14192
---- Validation: 
scalar performance:
{'acc': 0.9476905, 'precision': 0.6603843, 'recall': 0.75465256, 'specificity': 0.75465256, 'f1': 0.6949625, 'auroc': 0.9046587, 'binary_precision': 0.33716476, 'binary_recall': 0.5474339, 'binary_specificity': 0.9618712, 'binary_f1_score': 0.41730884}
confusion matrix:
       0    1
0  17457  692
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93720037, 'precision': 0.67297596, 'recall': 0.80415595, 'specificity': 0.80415595, 'f1': 0.7166963, 'auroc': 0.90378225, 'binary_precision': 0.36134455, 'binary_recall': 0.65900385, 'binary_specificity': 0.949308, 'binary_f1_score': 0.46675715}
confusion matrix:
      0    1
0  5693  304
1    89  172
early stop counter: 13
val acc:0.947690486907959, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 20,now: 2024-07-10 12:14:09.251658,epoch time: 0:22:58.212189,used: 7:24:44.125165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9856066, 'precision': 0.98529017, 'recall': 0.97698236, 'specificity': 0.97698236, 'f1': 0.98104274, 'auroc': 0.996784, 'binary_precision': 0.984654, 'binary_recall': 0.9591629, 'binary_specificity': 0.9948019, 'binary_f1_score': 0.9717413}
confusion matrix:
       0      1
0  42103    220
1    601  14116
---- Validation: 
scalar performance:
{'acc': 0.94737124, 'precision': 0.65941817, 'recall': 0.7544873, 'specificity': 0.7544873, 'f1': 0.6941371, 'auroc': 0.90382826, 'binary_precision': 0.3352381, 'binary_recall': 0.5474339, 'binary_specificity': 0.9615406, 'binary_f1_score': 0.4158299}
confusion matrix:
       0    1
0  17451  698
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9338447, 'precision': 0.6660967, 'recall': 0.80606973, 'specificity': 0.80606973, 'f1': 0.71073544, 'auroc': 0.90561503, 'binary_precision': 0.3473054, 'binary_recall': 0.6666667, 'binary_specificity': 0.9454727, 'binary_f1_score': 0.4566929}
confusion matrix:
      0    1
0  5670  327
1    87  174
early stop counter: 14
val acc:0.947371244430542, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 21,now: 2024-07-10 12:37:31.117383,epoch time: 0:23:21.865725,used: 7:48:05.990890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98704416, 'precision': 0.9860602, 'recall': 0.9799876, 'specificity': 0.9799876, 'f1': 0.98297393, 'auroc': 0.9973546, 'binary_precision': 0.9840676, 'binary_recall': 0.96540946, 'binary_specificity': 0.99456584, 'binary_f1_score': 0.97464925}
confusion matrix:
       0      1
0  42095    230
1    509  14206
---- Validation: 
scalar performance:
{'acc': 0.9415709, 'precision': 0.6441912, 'recall': 0.75373447, 'specificity': 0.75373447, 'f1': 0.68100405, 'auroc': 0.90087056, 'binary_precision': 0.30472103, 'binary_recall': 0.5520995, 'binary_specificity': 0.9553694, 'binary_f1_score': 0.3926991}
confusion matrix:
       0    1
0  17339  810
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9303292, 'precision': 0.65502286, 'recall': 0.78774446, 'specificity': 0.78774446, 'f1': 0.6968515, 'auroc': 0.8992965, 'binary_precision': 0.32673267, 'binary_recall': 0.6321839, 'binary_specificity': 0.943305, 'binary_f1_score': 0.4308094}
confusion matrix:
      0    1
0  5657  340
1    96  165
early stop counter: 15
val acc:0.9415708780288696, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 22,now: 2024-07-10 13:05:21.159268,epoch time: 0:27:50.041885,used: 8:15:56.032775,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9865007, 'precision': 0.98577344, 'recall': 0.97884804, 'specificity': 0.97884804, 'f1': 0.9822457, 'auroc': 0.9971094, 'binary_precision': 0.9843045, 'binary_recall': 0.96303594, 'binary_specificity': 0.99466014, 'binary_f1_score': 0.9735541}
confusion matrix:
       0      1
0  42097    226
1    544  14173
---- Validation: 
scalar performance:
{'acc': 0.9438591, 'precision': 0.64751714, 'recall': 0.74516845, 'specificity': 0.74516845, 'f1': 0.6819486, 'auroc': 0.89975584, 'binary_precision': 0.3120438, 'binary_recall': 0.5318818, 'binary_specificity': 0.958455, 'binary_f1_score': 0.3933295}
confusion matrix:
       0    1
0  17395  754
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9338447, 'precision': 0.66082764, 'recall': 0.78224933, 'specificity': 0.78224933, 'f1': 0.70117784, 'auroc': 0.89960504, 'binary_precision': 0.33894736, 'binary_recall': 0.61685824, 'binary_specificity': 0.9476405, 'binary_f1_score': 0.4375}
confusion matrix:
      0    1
0  5683  314
1   100  161
early stop counter: 16
val acc:0.9438591003417969, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 23,now: 2024-07-10 13:36:42.838059,epoch time: 0:31:21.678791,used: 8:47:17.711566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9867812, 'precision': 0.98550296, 'recall': 0.9798537, 'specificity': 0.9798537, 'f1': 0.98263496, 'auroc': 0.9976423, 'binary_precision': 0.9829113, 'binary_recall': 0.96554303, 'binary_specificity': 0.99416435, 'binary_f1_score': 0.9741497}
confusion matrix:
       0      1
0  42079    247
1    507  14207
---- Validation: 
scalar performance:
{'acc': 0.9483823, 'precision': 0.659158, 'recall': 0.7415097, 'specificity': 0.7415097, 'f1': 0.69041467, 'auroc': 0.9004929, 'binary_precision': 0.3356784, 'binary_recall': 0.5194401, 'binary_specificity': 0.96357924, 'binary_f1_score': 0.40781438}
confusion matrix:
       0    1
0  17488  661
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94199425, 'precision': 0.68054986, 'recall': 0.7828368, 'specificity': 0.7828368, 'f1': 0.7181443, 'auroc': 0.89824575, 'binary_precision': 0.37857142, 'binary_recall': 0.6091954, 'binary_specificity': 0.95647824, 'binary_f1_score': 0.46696034}
confusion matrix:
      0    1
0  5736  261
1   102  159
early stop counter: 17
val acc:0.9483823180198669, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 24,now: 2024-07-10 14:02:18.812131,epoch time: 0:25:35.974072,used: 9:12:53.685638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98648316, 'precision': 0.98683864, 'recall': 0.97774637, 'specificity': 0.97774637, 'f1': 0.9821811, 'auroc': 0.9973661, 'binary_precision': 0.98755157, 'binary_recall': 0.95969826, 'binary_specificity': 0.99579453, 'binary_f1_score': 0.9734257}
confusion matrix:
       0      1
0  42148    178
1    593  14121
---- Validation: 
scalar performance:
{'acc': 0.9537037, 'precision': 0.67390513, 'recall': 0.72701335, 'specificity': 0.72701335, 'f1': 0.6963925, 'auroc': 0.9011934, 'binary_precision': 0.3663133, 'binary_recall': 0.4836703, 'binary_specificity': 0.97035646, 'binary_f1_score': 0.41689008}
confusion matrix:
       0    1
0  17611  538
1    332  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.733897, 'recall': 0.78142905, 'specificity': 0.78142905, 'f1': 0.75512755, 'auroc': 0.8993219, 'binary_precision': 0.4858044, 'binary_recall': 0.5900383, 'binary_specificity': 0.97281975, 'binary_f1_score': 0.53287196}
confusion matrix:
      0    1
0  5834  163
1   107  154
early stop counter: 18
val acc:0.9537037014961243, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 25,now: 2024-07-10 14:25:34.669249,epoch time: 0:23:15.857118,used: 9:36:09.542756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9876753, 'precision': 0.9880388, 'recall': 0.9796839, 'specificity': 0.9796839, 'f1': 0.98376745, 'auroc': 0.997246, 'binary_precision': 0.98876953, 'binary_recall': 0.96317184, 'binary_specificity': 0.9961959, 'binary_f1_score': 0.97580284}
confusion matrix:
       0      1
0  42162    161
1    542  14175
---- Validation: 
scalar performance:
{'acc': 0.9593976, 'precision': 0.69601727, 'recall': 0.70745957, 'specificity': 0.70745957, 'f1': 0.70155394, 'auroc': 0.9057876, 'binary_precision': 0.41202345, 'binary_recall': 0.43701398, 'binary_specificity': 0.9779051, 'binary_f1_score': 0.42415094}
confusion matrix:
       0    1
0  17748  401
1    362  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.75843656, 'recall': 0.74894917, 'specificity': 0.74894917, 'f1': 0.7535919, 'auroc': 0.89908075, 'binary_precision': 0.5378486, 'binary_recall': 0.51724136, 'binary_specificity': 0.980657, 'binary_f1_score': 0.5273437}
confusion matrix:
      0    1
0  5881  116
1   126  135
better model found
persisted
after epoch: 26,now: 2024-07-10 14:50:19.567472,epoch time: 0:24:44.898223,used: 10:00:54.440979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9882188, 'precision': 0.9869623, 'recall': 0.98217463, 'specificity': 0.98217463, 'f1': 0.98453736, 'auroc': 0.9978634, 'binary_precision': 0.98440737, 'binary_recall': 0.9696887, 'binary_specificity': 0.9946605, 'binary_f1_score': 0.9769926}
confusion matrix:
       0      1
0  42100    226
1    446  14268
---- Validation: 
scalar performance:
{'acc': 0.951788, 'precision': 0.67054784, 'recall': 0.74252284, 'specificity': 0.74252284, 'f1': 0.6992529, 'auroc': 0.90738356, 'binary_precision': 0.35844994, 'binary_recall': 0.5178849, 'binary_specificity': 0.9671607, 'binary_f1_score': 0.42366412}
confusion matrix:
       0    1
0  17553  596
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.7341788, 'recall': 0.77418303, 'specificity': 0.77418303, 'f1': 0.7523623, 'auroc': 0.8994839, 'binary_precision': 0.48701298, 'binary_recall': 0.57471263, 'binary_specificity': 0.9736535, 'binary_f1_score': 0.52724075}
confusion matrix:
      0    1
0  5839  158
1   111  150
early stop counter: 1
val acc:0.9517880082130432, best validation acc: 0.9593976140022278, corresponding to test acc:                         0.9613295197486877 / 0.9616490602493286
after epoch: 27,now: 2024-07-10 15:15:45.808920,epoch time: 0:25:26.241448,used: 10:26:20.682427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98830646, 'precision': 0.98835504, 'recall': 0.9810111, 'specificity': 0.9810111, 'f1': 0.98461056, 'auroc': 0.9974611, 'binary_precision': 0.988453, 'binary_recall': 0.9659439, 'binary_specificity': 0.9960783, 'binary_f1_score': 0.97706884}
confusion matrix:
       0      1
0  42163    166
1    501  14210
---- Validation: 
scalar performance:
{'acc': 0.95769477, 'precision': 0.68996143, 'recall': 0.720829, 'specificity': 0.720829, 'f1': 0.70406973, 'auroc': 0.90692675, 'binary_precision': 0.39893618, 'binary_recall': 0.466563, 'binary_specificity': 0.97509503, 'binary_f1_score': 0.43010753}
confusion matrix:
       0    1
0  17697  452
1    343  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.778721, 'recall': 0.76335967, 'specificity': 0.76335967, 'f1': 0.77079415, 'auroc': 0.90031946, 'binary_precision': 0.57723576, 'binary_recall': 0.5440613, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.5601577}
confusion matrix:
      0    1
0  5893  104
1   119  142
new oracle model saved
early stop counter: 2
val acc:0.9576947689056396, best validation acc: 0.9593976140022278, corresponding to test acc:                         0.9613295197486877 / 0.9643656015396118
after epoch: 28,now: 2024-07-10 15:42:24.120502,epoch time: 0:26:38.311582,used: 10:52:58.994009,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9889025, 'precision': 0.9891919, 'recall': 0.9817507, 'specificity': 0.9817507, 'f1': 0.985397, 'auroc': 0.9979702, 'binary_precision': 0.98977536, 'binary_recall': 0.96697474, 'binary_specificity': 0.9965268, 'binary_f1_score': 0.97824216}
confusion matrix:
       0      1
0  42177    147
1    486  14230
---- Validation: 
scalar performance:
{'acc': 0.9571094, 'precision': 0.6853758, 'recall': 0.71302545, 'specificity': 0.71302545, 'f1': 0.698102, 'auroc': 0.90590256, 'binary_precision': 0.39030954, 'binary_recall': 0.45101088, 'binary_specificity': 0.97503996, 'binary_f1_score': 0.41847044}
confusion matrix:
       0    1
0  17696  453
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.78625166, 'recall': 0.76202756, 'specificity': 0.76202756, 'f1': 0.7735362, 'auroc': 0.9004919, 'binary_precision': 0.59243697, 'binary_recall': 0.54022986, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.56513023}
confusion matrix:
      0    1
0  5900   97
1   120  141
new oracle model saved
early stop counter: 3
val acc:0.9571093916893005, best validation acc: 0.9593976140022278, corresponding to test acc:                         0.9613295197486877 / 0.9653244018554688
after epoch: 29,now: 2024-07-10 16:04:29.683395,epoch time: 0:22:05.562893,used: 11:15:04.556902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9876578, 'precision': 0.9893371, 'recall': 0.9783854, 'specificity': 0.9783854, 'f1': 0.9837011, 'auroc': 0.99751866, 'binary_precision': 0.99268633, 'binary_recall': 0.95922804, 'binary_specificity': 0.99754274, 'binary_f1_score': 0.97567046}
confusion matrix:
       0      1
0  42220    104
1    600  14116
---- Validation: 
scalar performance:
{'acc': 0.9605683, 'precision': 0.6972332, 'recall': 0.6803136, 'specificity': 0.6803136, 'f1': 0.68834424, 'auroc': 0.9011067, 'binary_precision': 0.41638225, 'binary_recall': 0.37947124, 'binary_specificity': 0.981156, 'binary_f1_score': 0.3970708}
confusion matrix:
       0    1
0  17807  342
1    399  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.81162417, 'recall': 0.7318784, 'specificity': 0.7318784, 'f1': 0.7652336, 'auroc': 0.8959154, 'binary_precision': 0.6458333, 'binary_recall': 0.47509578, 'binary_specificity': 0.988661, 'binary_f1_score': 0.54746133}
confusion matrix:
      0    1
0  5929   68
1   137  124
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-10 16:26:44.314693,epoch time: 0:22:14.631298,used: 11:37:19.188200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_49_25_seed_0_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:37:19.188200 at 2024-07-10 16:26:44.314693
persisted model performance metric: 

scalar performance:
{'acc': 0.96724194, 'precision': 0.81162417, 'recall': 0.7318784, 'specificity': 0.7318784, 'f1': 0.7652336, 'auroc': 0.8959154, 'binary_precision': 0.6458333, 'binary_recall': 0.47509578, 'binary_specificity': 0.988661, 'binary_f1_score': 0.54746133}
confusion matrix:
      0    1
0  5929   68
1   137  124
oracle model performance metric: 

scalar performance:
{'acc': 0.96724194, 'precision': 0.81162417, 'recall': 0.7318784, 'specificity': 0.7318784, 'f1': 0.7652336, 'auroc': 0.8959154, 'binary_precision': 0.6458333, 'binary_recall': 0.47509578, 'binary_specificity': 0.988661, 'binary_f1_score': 0.54746133}
confusion matrix:
      0    1
0  5929   68
1   137  124
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  16482 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59895 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |   9133 KiB |  11093 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7625    |  195065 K  |  195062 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84573 K  |   84570 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7625    |  195065 K  |  195062 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84573 K  |   84570 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3589    |  120671 K  |  120671 K  |
|       from large pool |      10    |     350    |   85092 K  |   85092 K  |
|       from small pool |      26    |    3579    |   35579 K  |   35579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  195065 K  |  195065 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84573 K  |   84573 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  195065 K  |  195065 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84573 K  |   84573 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  120673 K  |  120672 K  |
|       from large pool |       3    |     350    |   85092 K  |   85092 K  |
|       from small pool |       0    |    3579    |   35580 K  |   35580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  195065 K  |  195065 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84573 K  |   84573 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  195065 K  |  195065 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84573 K  |   84573 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  120673 K  |  120672 K  |
|       from large pool |       3    |     350    |   85092 K  |   85092 K  |
|       from small pool |       0    |    3579    |   35580 K  |   35580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619

 Experiment start at: 2024-07-10 16:45:40.372230
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9268194, 'precision': 0.9346018, 'recall': 0.86951315, 'specificity': 0.86951315, 'f1': 0.8959567, 'auroc': 0.94443715, 'binary_precision': 0.947644, 'binary_recall': 0.7531729, 'binary_specificity': 0.9858534, 'binary_f1_score': 0.83929056}
confusion matrix:
       0      1
0  41813    600
1   3559  10860
---- Validation: 
scalar performance:
{'acc': 0.9470651, 'precision': 0.4995278, 'recall': 0.49975497, 'specificity': 0.49975497, 'f1': 0.49820855, 'auroc': 0.74297893, 'binary_precision': 0.034985423, 'binary_recall': 0.017830608, 'binary_specificity': 0.9816793, 'binary_f1_score': 0.023622045}
confusion matrix:
       0    1
0  17736  331
1    661   12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9395746, 'precision': 0.48721066, 'recall': 0.49400762, 'specificity': 0.49400762, 'f1': 0.4896949, 'auroc': 0.7177851, 'binary_precision': 0.016806724, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9803229, 'binary_f1_score': 0.01055409}
confusion matrix:
      0    1
0  5829  117
1   258    2
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 17:07:55.386557,epoch time: 0:22:15.014327,used: 0:22:15.014327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9510839, 'precision': 0.96142817, 'recall': 0.90930444, 'specificity': 0.90930444, 'f1': 0.93170416, 'auroc': 0.9722316, 'binary_precision': 0.9794859, 'binary_recall': 0.8244799, 'binary_specificity': 0.994129, 'binary_f1_score': 0.89532346}
confusion matrix:
       0      1
0  42163    249
1   2531  11889
---- Validation: 
scalar performance:
{'acc': 0.9526681, 'precision': 0.52502394, 'recall': 0.5098135, 'specificity': 0.5098135, 'f1': 0.5114961, 'auroc': 0.8010602, 'binary_precision': 0.08527132, 'binary_recall': 0.03268945, 'binary_specificity': 0.9869375, 'binary_f1_score': 0.04726101}
confusion matrix:
       0    1
0  17831  236
1    651   22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.943603, 'precision': 0.49459392, 'recall': 0.49794883, 'specificity': 0.49794883, 'f1': 0.4939114, 'auroc': 0.79645056, 'binary_precision': 0.03125, 'binary_recall': 0.011538462, 'binary_specificity': 0.9843592, 'binary_f1_score': 0.016853932}
confusion matrix:
      0   1
0  5853  93
1   257   3
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-10 17:29:37.600771,epoch time: 0:21:42.214214,used: 0:43:57.228541,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96202844, 'precision': 0.9684208, 'recall': 0.9309955, 'specificity': 0.9309955, 'f1': 0.9478333, 'auroc': 0.9822545, 'binary_precision': 0.98002976, 'binary_recall': 0.8680031, 'binary_specificity': 0.993988, 'binary_f1_score': 0.9206209}
confusion matrix:
       0      1
0  42160    255
1   1903  12514
---- Validation: 
scalar performance:
{'acc': 0.9562967, 'precision': 0.60226583, 'recall': 0.5431671, 'specificity': 0.5431671, 'f1': 0.55819035, 'auroc': 0.836763, 'binary_precision': 0.23741007, 'binary_recall': 0.09806835, 'binary_specificity': 0.9882659, 'binary_f1_score': 0.13880126}
confusion matrix:
       0    1
0  17855  212
1    607   66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94924265, 'precision': 0.5600836, 'recall': 0.51928186, 'specificity': 0.51928186, 'f1': 0.5250754, 'auroc': 0.842397, 'binary_precision': 0.16049382, 'binary_recall': 0.05, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.07624634}
confusion matrix:
      0   1
0  5878  68
1   247  13
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-10 17:51:10.869066,epoch time: 0:21:33.268295,used: 1:05:30.496836,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9675359, 'precision': 0.9689841, 'recall': 0.9446471, 'specificity': 0.9446471, 'f1': 0.9560139, 'auroc': 0.98629975, 'binary_precision': 0.9717116, 'binary_recall': 0.8981828, 'binary_specificity': 0.9911114, 'binary_f1_score': 0.93350154}
confusion matrix:
       0      1
0  42037    377
1   1468  12950
---- Validation: 
scalar performance:
{'acc': 0.9577908, 'precision': 0.65206736, 'recall': 0.5818512, 'specificity': 0.5818512, 'f1': 0.60479605, 'auroc': 0.8552015, 'binary_precision': 0.33426967, 'binary_recall': 0.1768202, 'binary_specificity': 0.98688215, 'binary_f1_score': 0.23129252}
confusion matrix:
       0    1
0  17830  237
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95278764, 'precision': 0.61742, 'recall': 0.53400475, 'specificity': 0.53400475, 'f1': 0.54793155, 'auroc': 0.87053514, 'binary_precision': 0.2739726, 'binary_recall': 0.07692308, 'binary_specificity': 0.9910864, 'binary_f1_score': 0.12012013}
confusion matrix:
      0   1
0  5893  53
1   240  20
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-10 18:12:51.062667,epoch time: 0:21:40.193601,used: 1:27:10.690437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96984094, 'precision': 0.9697637, 'recall': 0.9499713, 'specificity': 0.9499713, 'f1': 0.9593358, 'auroc': 0.98854434, 'binary_precision': 0.9696163, 'binary_recall': 0.9096331, 'binary_specificity': 0.9903096, 'binary_f1_score': 0.9386674}
confusion matrix:
       0      1
0  42002    411
1   1303  13116
---- Validation: 
scalar performance:
{'acc': 0.9599253, 'precision': 0.67021734, 'recall': 0.5779513, 'specificity': 0.5779513, 'f1': 0.6045855, 'auroc': 0.8598094, 'binary_precision': 0.37086093, 'binary_recall': 0.16641901, 'binary_specificity': 0.9894836, 'binary_f1_score': 0.22974358}
confusion matrix:
       0    1
0  17877  190
1    561  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.68608886, 'recall': 0.5414558, 'specificity': 0.5414558, 'f1': 0.56162405, 'auroc': 0.8798151, 'binary_precision': 0.4107143, 'binary_recall': 0.08846154, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.14556962}
confusion matrix:
      0   1
0  5913  33
1   237  23
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-10 18:38:08.823009,epoch time: 0:25:17.760342,used: 1:52:28.450779,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97197, 'precision': 0.9743811, 'recall': 0.9512178, 'specificity': 0.9512178, 'f1': 0.96208274, 'auroc': 0.99048555, 'binary_precision': 0.9789411, 'binary_recall': 0.9090846, 'binary_specificity': 0.9933509, 'binary_f1_score': 0.9427205}
confusion matrix:
       0      1
0  42130    282
1   1311  13109
---- Validation: 
scalar performance:
{'acc': 0.96109927, 'precision': 0.6932996, 'recall': 0.59715706, 'specificity': 0.59715706, 'f1': 0.6273203, 'auroc': 0.8730384, 'binary_precision': 0.41566265, 'binary_recall': 0.205052, 'binary_specificity': 0.98926216, 'binary_f1_score': 0.27462685}
confusion matrix:
       0    1
0  17873  194
1    535  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.76989853, 'recall': 0.57816243, 'specificity': 0.57816243, 'f1': 0.615819, 'auroc': 0.90192115, 'binary_precision': 0.5753425, 'binary_recall': 0.16153847, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.25225225}
confusion matrix:
      0   1
0  5915  31
1   218  42
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-10 19:07:18.480492,epoch time: 0:29:09.657483,used: 2:21:38.108262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.97492963, 'recall': 0.96278286, 'specificity': 0.96278286, 'f1': 0.96865714, 'auroc': 0.9926288, 'binary_precision': 0.9717396, 'binary_recall': 0.93480825, 'binary_specificity': 0.9907575, 'binary_f1_score': 0.9529162}
confusion matrix:
       0      1
0  42021    392
1    940  13479
---- Validation: 
scalar performance:
{'acc': 0.96179295, 'precision': 0.7105048, 'recall': 0.63041914, 'specificity': 0.63041914, 'f1': 0.65990543, 'auroc': 0.87875324, 'binary_precision': 0.44768855, 'binary_recall': 0.27340266, 'binary_specificity': 0.98743564, 'binary_f1_score': 0.33948338}
confusion matrix:
       0    1
0  17840  227
1    489  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.81084406, 'recall': 0.6239799, 'specificity': 0.6239799, 'f1': 0.67332417, 'auroc': 0.9090984, 'binary_precision': 0.65346533, 'binary_recall': 0.25384617, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.36565098}
confusion matrix:
      0   1
0  5911  35
1   194  66
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-10 19:35:00.818290,epoch time: 0:27:42.337798,used: 2:49:20.446060,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.976844, 'precision': 0.97574854, 'recall': 0.9627198, 'specificity': 0.9627198, 'f1': 0.96900576, 'auroc': 0.9932637, 'binary_precision': 0.9736138, 'binary_recall': 0.9340454, 'binary_specificity': 0.99139416, 'binary_f1_score': 0.9534192}
confusion matrix:
       0      1
0  42048    365
1    951  13468
---- Validation: 
scalar performance:
{'acc': 0.9620064, 'precision': 0.71800196, 'recall': 0.66128635, 'specificity': 0.66128635, 'f1': 0.6848793, 'auroc': 0.8849921, 'binary_precision': 0.46044624, 'binary_recall': 0.33729568, 'binary_specificity': 0.985277, 'binary_f1_score': 0.38936538}
confusion matrix:
       0    1
0  17801  266
1    446  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.83658415, 'recall': 0.6641964, 'specificity': 0.6641964, 'f1': 0.71783286, 'auroc': 0.9161995, 'binary_precision': 0.7016129, 'binary_recall': 0.33461538, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.45312497}
confusion matrix:
      0   1
0  5909  37
1   173  87
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-10 20:02:37.755756,epoch time: 0:27:36.937466,used: 3:16:57.383526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97758305, 'precision': 0.9779035, 'recall': 0.96257627, 'specificity': 0.96257627, 'f1': 0.9699265, 'auroc': 0.9937506, 'binary_precision': 0.9785236, 'binary_recall': 0.93210816, 'binary_specificity': 0.99304444, 'binary_f1_score': 0.9547521}
confusion matrix:
       0      1
0  42117    295
1    979  13441
---- Validation: 
scalar performance:
{'acc': 0.96221983, 'precision': 0.7175467, 'recall': 0.6456612, 'specificity': 0.6456612, 'f1': 0.6736277, 'auroc': 0.8852662, 'binary_precision': 0.46067417, 'binary_recall': 0.30460623, 'binary_specificity': 0.9867161, 'binary_f1_score': 0.3667263}
confusion matrix:
       0    1
0  17827  240
1    468  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.8320533, 'recall': 0.64145577, 'specificity': 0.64145577, 'f1': 0.6947542, 'auroc': 0.9156071, 'binary_precision': 0.6944444, 'binary_recall': 0.28846154, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.40760866}
confusion matrix:
      0   1
0  5913  33
1   185  75
better model found
persisted
after epoch: 9,now: 2024-07-10 20:30:09.138931,epoch time: 0:27:31.383175,used: 3:44:28.766701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97870916, 'precision': 0.9795104, 'recall': 0.9639901, 'specificity': 0.9639901, 'f1': 0.9714304, 'auroc': 0.9944987, 'binary_precision': 0.9810606, 'binary_recall': 0.93411016, 'binary_specificity': 0.99386996, 'binary_f1_score': 0.95700985}
confusion matrix:
       0      1
0  42154    260
1    950  13468
---- Validation: 
scalar performance:
{'acc': 0.9632337, 'precision': 0.72733295, 'recall': 0.6411801, 'specificity': 0.6411801, 'f1': 0.67302287, 'auroc': 0.8855845, 'binary_precision': 0.48058254, 'binary_recall': 0.29420504, 'binary_specificity': 0.9881552, 'binary_f1_score': 0.36497697}
confusion matrix:
       0    1
0  17853  214
1    475  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.83754146, 'recall': 0.6359388, 'specificity': 0.6359388, 'f1': 0.6898494, 'auroc': 0.9128367, 'binary_precision': 0.7058824, 'binary_recall': 0.2769231, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.39779007}
confusion matrix:
      0   1
0  5916  30
1   188  72
better model found
persisted
after epoch: 10,now: 2024-07-10 20:53:18.985132,epoch time: 0:23:09.846201,used: 4:07:38.612902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97941303, 'precision': 0.9795189, 'recall': 0.96583915, 'specificity': 0.96583915, 'f1': 0.97243, 'auroc': 0.9949529, 'binary_precision': 0.9797248, 'binary_recall': 0.93828017, 'binary_specificity': 0.9933981, 'binary_f1_score': 0.95855474}
confusion matrix:
       0      1
0  42132    280
1    890  13530
---- Validation: 
scalar performance:
{'acc': 0.9623266, 'precision': 0.7209377, 'recall': 0.66216767, 'specificity': 0.66216767, 'f1': 0.6864937, 'auroc': 0.8900182, 'binary_precision': 0.46625766, 'binary_recall': 0.33878157, 'binary_specificity': 0.9855538, 'binary_f1_score': 0.39242685}
confusion matrix:
       0    1
0  17806  261
1    445  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.85756475, 'recall': 0.6950497, 'specificity': 0.6950497, 'f1': 0.7501124, 'auroc': 0.9178698, 'binary_precision': 0.7410072, 'binary_recall': 0.39615384, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.5162907}
confusion matrix:
      0    1
0  5910   36
1   157  103
new oracle model saved
early stop counter: 1
val acc:0.9623265862464905, best validation acc: 0.9632337093353271, corresponding to test acc:                         0.9648727178573608 / 0.9689010381698608
after epoch: 11,now: 2024-07-10 21:16:04.997495,epoch time: 0:22:46.012363,used: 4:30:24.625265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9801696, 'precision': 0.9807962, 'recall': 0.96659577, 'specificity': 0.96659577, 'f1': 0.9734287, 'auroc': 0.9952556, 'binary_precision': 0.98201334, 'binary_recall': 0.93903875, 'binary_specificity': 0.9941527, 'binary_f1_score': 0.9600454}
confusion matrix:
       0      1
0  42165    248
1    879  13540
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.7271498, 'recall': 0.6504232, 'specificity': 0.6504232, 'f1': 0.6800774, 'auroc': 0.8877162, 'binary_precision': 0.47954544, 'binary_recall': 0.31352153, 'binary_specificity': 0.98732495, 'binary_f1_score': 0.37915543}
confusion matrix:
       0    1
0  17838  229
1    462  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.8495078, 'recall': 0.6570086, 'specificity': 0.6570086, 'f1': 0.7132858, 'auroc': 0.9134449, 'binary_precision': 0.7280702, 'binary_recall': 0.31923077, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.44385028}
confusion matrix:
      0   1
0  5915  31
1   177  83
early stop counter: 2
val acc:0.9631270170211792, best validation acc: 0.9632337093353271, corresponding to test acc:                         0.9648727178573608 / 0.9689010381698608
after epoch: 12,now: 2024-07-10 21:38:38.361900,epoch time: 0:22:33.364405,used: 4:52:57.989670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98119015, 'precision': 0.98283553, 'recall': 0.96732527, 'specificity': 0.96732527, 'f1': 0.97476375, 'auroc': 0.9958397, 'binary_precision': 0.9860201, 'binary_recall': 0.93917745, 'binary_specificity': 0.9954731, 'binary_f1_score': 0.9620289}
confusion matrix:
       0      1
0  42221    192
1    877  13542
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.74154234, 'recall': 0.63466394, 'specificity': 0.63466394, 'f1': 0.6712834, 'auroc': 0.8900249, 'binary_precision': 0.50948507, 'binary_recall': 0.2793462, 'binary_specificity': 0.9899817, 'binary_f1_score': 0.36084452}
confusion matrix:
       0    1
0  17886  181
1    485  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.8697463, 'recall': 0.65751314, 'specificity': 0.65751314, 'f1': 0.71715754, 'auroc': 0.9169411, 'binary_precision': 0.7685185, 'binary_recall': 0.31923077, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.45108694}
confusion matrix:
      0   1
0  5921  25
1   177  83
better model found
persisted
after epoch: 13,now: 2024-07-10 22:01:23.523135,epoch time: 0:22:45.161235,used: 5:15:43.150905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9814893, 'precision': 0.9792628, 'recall': 0.97162414, 'specificity': 0.97162414, 'f1': 0.9753653, 'auroc': 0.9956578, 'binary_precision': 0.97485083, 'binary_recall': 0.951595, 'binary_specificity': 0.9916533, 'binary_f1_score': 0.96308255}
confusion matrix:
       0      1
0  42058    354
1    698  13722
---- Validation: 
scalar performance:
{'acc': 0.96125937, 'precision': 0.71540207, 'recall': 0.68378747, 'specificity': 0.68378747, 'f1': 0.6981817, 'auroc': 0.8921181, 'binary_precision': 0.45359018, 'binary_recall': 0.38484398, 'binary_specificity': 0.9827309, 'binary_f1_score': 0.41639873}
confusion matrix:
       0    1
0  17755  312
1    414  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.82719564, 'recall': 0.7146899, 'specificity': 0.7146899, 'f1': 0.7580106, 'auroc': 0.9150994, 'binary_precision': 0.6785714, 'binary_recall': 0.43846154, 'binary_specificity': 0.9909183, 'binary_f1_score': 0.53271025}
confusion matrix:
      0    1
0  5892   54
1   146  114
early stop counter: 1
val acc:0.9612593650817871, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9674508571624756 / 0.9689010381698608
after epoch: 14,now: 2024-07-10 22:24:16.601864,epoch time: 0:22:53.078729,used: 5:38:36.229634,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98229873, 'precision': 0.9816271, 'recall': 0.9714112, 'specificity': 0.9714112, 'f1': 0.9763805, 'auroc': 0.9959502, 'binary_precision': 0.9803065, 'binary_recall': 0.94930655, 'binary_specificity': 0.99351597, 'binary_f1_score': 0.96455747}
confusion matrix:
       0      1
0  42137    275
1    731  13689
---- Validation: 
scalar performance:
{'acc': 0.96211314, 'precision': 0.72106516, 'recall': 0.6770776, 'specificity': 0.6770776, 'f1': 0.69633865, 'auroc': 0.89495206, 'binary_precision': 0.46542057, 'binary_recall': 0.36998513, 'binary_specificity': 0.98417, 'binary_f1_score': 0.41225168}
confusion matrix:
       0    1
0  17781  286
1    424  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970029, 'precision': 0.85518384, 'recall': 0.7195451, 'specificity': 0.7195451, 'f1': 0.7697581, 'auroc': 0.9164319, 'binary_precision': 0.73417723, 'binary_recall': 0.44615385, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.5550239}
confusion matrix:
      0    1
0  5904   42
1   144  116
new oracle model saved
early stop counter: 2
val acc:0.9621131420135498, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9674508571624756 / 0.9700289964675903
after epoch: 15,now: 2024-07-10 22:46:55.193449,epoch time: 0:22:38.591585,used: 6:01:14.821219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9823163, 'precision': 0.9810411, 'recall': 0.97203934, 'specificity': 0.97203934, 'f1': 0.9764322, 'auroc': 0.99621904, 'binary_precision': 0.97852457, 'binary_recall': 0.9511755, 'binary_specificity': 0.9929031, 'binary_f1_score': 0.9646562}
confusion matrix:
       0      1
0  42112    301
1    704  13715
---- Validation: 
scalar performance:
{'acc': 0.9620064, 'precision': 0.7194302, 'recall': 0.6713001, 'specificity': 0.6713001, 'f1': 0.6920316, 'auroc': 0.89228714, 'binary_precision': 0.46257198, 'binary_recall': 0.35809806, 'binary_specificity': 0.98450214, 'binary_f1_score': 0.4036851}
confusion matrix:
       0    1
0  17787  280
1    432  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.8232, 'recall': 0.71452177, 'specificity': 0.71452177, 'f1': 0.7566869, 'auroc': 0.91018915, 'binary_precision': 0.67058825, 'binary_recall': 0.43846154, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.53023255}
confusion matrix:
      0    1
0  5890   56
1   146  114
early stop counter: 3
val acc:0.9620063900947571, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9674508571624756 / 0.9700289964675903
after epoch: 16,now: 2024-07-10 23:09:31.049899,epoch time: 0:22:35.856450,used: 6:23:50.677669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9831961, 'precision': 0.9838115, 'recall': 0.97164464, 'specificity': 0.97164464, 'f1': 0.97753304, 'auroc': 0.9961864, 'binary_precision': 0.98501444, 'binary_recall': 0.9481934, 'binary_specificity': 0.99509585, 'binary_f1_score': 0.9662533}
confusion matrix:
       0      1
0  42205    208
1    747  13672
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.73533183, 'recall': 0.6565328, 'specificity': 0.6565328, 'f1': 0.68710417, 'auroc': 0.89431, 'binary_precision': 0.4954751, 'binary_recall': 0.3254086, 'binary_specificity': 0.98765707, 'binary_f1_score': 0.39282507}
confusion matrix:
       0    1
0  17844  223
1    454  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.863415, 'recall': 0.6800855, 'specificity': 0.6800855, 'f1': 0.737965, 'auroc': 0.91533446, 'binary_precision': 0.75396824, 'binary_recall': 0.3653846, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.49222797}
confusion matrix:
      0   1
0  5915  31
1   165  95
early stop counter: 4
val acc:0.9638740420341492, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9674508571624756 / 0.9700289964675903
after epoch: 17,now: 2024-07-10 23:32:04.133953,epoch time: 0:22:33.084054,used: 6:46:23.761723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98384714, 'precision': 0.9854485, 'recall': 0.97178507, 'specificity': 0.97178507, 'f1': 0.9783722, 'auroc': 0.9963292, 'binary_precision': 0.9885656, 'binary_recall': 0.9472954, 'binary_specificity': 0.99627465, 'binary_f1_score': 0.9674906}
confusion matrix:
       0      1
0  42254    158
1    760  13660
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.749085, 'recall': 0.63997525, 'specificity': 0.63997525, 'f1': 0.6776143, 'auroc': 0.8919326, 'binary_precision': 0.5241935, 'binary_recall': 0.2897474, 'binary_specificity': 0.99020314, 'binary_f1_score': 0.37320575}
confusion matrix:
       0    1
0  17890  177
1    478  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.8561356, 'recall': 0.6420444, 'specificity': 0.6420444, 'f1': 0.6990018, 'auroc': 0.91258717, 'binary_precision': 0.7425743, 'binary_recall': 0.28846154, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.41551247}
confusion matrix:
      0   1
0  5920  26
1   185  75
better model found
persisted
after epoch: 18,now: 2024-07-10 23:54:14.527410,epoch time: 0:22:10.393457,used: 7:08:34.155180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98333687, 'precision': 0.9853971, 'recall': 0.970503, 'specificity': 0.970503, 'f1': 0.9776598, 'auroc': 0.9968746, 'binary_precision': 0.98939264, 'binary_recall': 0.9444483, 'binary_specificity': 0.99655765, 'binary_f1_score': 0.9663982}
confusion matrix:
       0      1
0  42267    146
1    801  13618
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.7397702, 'recall': 0.65031683, 'specificity': 0.65031683, 'f1': 0.6836456, 'auroc': 0.8968586, 'binary_precision': 0.5048077, 'binary_recall': 0.31203565, 'binary_specificity': 0.988598, 'binary_f1_score': 0.3856749}
confusion matrix:
       0    1
0  17861  206
1    463  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.86276674, 'recall': 0.6895327, 'specificity': 0.6895327, 'f1': 0.74642396, 'auroc': 0.91443807, 'binary_precision': 0.7518797, 'binary_recall': 0.3846154, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.5089059}
confusion matrix:
      0    1
0  5913   33
1   160  100
early stop counter: 1
val acc:0.9643009901046753, best validation acc: 0.9650480151176453, corresponding to test acc:                         0.9660006165504456 / 0.9700289964675903
after epoch: 19,now: 2024-07-11 00:15:38.183833,epoch time: 0:21:23.656423,used: 7:29:57.811603,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9848677, 'precision': 0.985139, 'recall': 0.97475576, 'specificity': 0.97475576, 'f1': 0.9798056, 'auroc': 0.996716, 'binary_precision': 0.98567235, 'binary_recall': 0.9542271, 'binary_specificity': 0.99528444, 'binary_f1_score': 0.96969485}
confusion matrix:
       0      1
0  42213    200
1    660  13759
---- Validation: 
scalar performance:
{'acc': 0.96302027, 'precision': 0.7273834, 'recall': 0.6632427, 'specificity': 0.6632427, 'f1': 0.68941957, 'auroc': 0.8961038, 'binary_precision': 0.47907948, 'binary_recall': 0.34026745, 'binary_specificity': 0.986218, 'binary_f1_score': 0.39791486}
confusion matrix:
       0    1
0  17818  249
1    444  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.8384758, 'recall': 0.6963, 'specificity': 0.6963, 'f1': 0.7465714, 'auroc': 0.91486907, 'binary_precision': 0.7027027, 'binary_recall': 0.4, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.5098039}
confusion matrix:
      0    1
0  5902   44
1   156  104
early stop counter: 2
val acc:0.9630202651023865, best validation acc: 0.9650480151176453, corresponding to test acc:                         0.9660006165504456 / 0.9700289964675903
after epoch: 20,now: 2024-07-11 00:37:21.419128,epoch time: 0:21:43.235295,used: 7:51:41.046898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9850084, 'precision': 0.9844205, 'recall': 0.97583425, 'specificity': 0.97583425, 'f1': 0.98002994, 'auroc': 0.9971168, 'binary_precision': 0.98325855, 'binary_recall': 0.9572092, 'binary_specificity': 0.9944593, 'binary_f1_score': 0.97005904}
confusion matrix:
       0      1
0  42178    235
1    617  13802
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.73195887, 'recall': 0.6556515, 'specificity': 0.6556515, 'f1': 0.68542486, 'auroc': 0.89205945, 'binary_precision': 0.48878923, 'binary_recall': 0.32392272, 'binary_specificity': 0.9873803, 'binary_f1_score': 0.38963357}
confusion matrix:
       0    1
0  17839  228
1    455  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.8381592, 'recall': 0.6623574, 'specificity': 0.6623574, 'f1': 0.71640277, 'auroc': 0.90981007, 'binary_precision': 0.704918, 'binary_recall': 0.33076924, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.45026183}
confusion matrix:
      0   1
0  5910  36
1   174  86
early stop counter: 3
val acc:0.9635539054870605, best validation acc: 0.9650480151176453, corresponding to test acc:                         0.9660006165504456 / 0.9700289964675903
after epoch: 21,now: 2024-07-11 00:59:05.815900,epoch time: 0:21:44.396772,used: 8:13:25.443670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9843046, 'precision': 0.9870472, 'recall': 0.9714718, 'specificity': 0.9714718, 'f1': 0.9789438, 'auroc': 0.99707234, 'binary_precision': 0.9923564, 'binary_recall': 0.94541925, 'binary_specificity': 0.9975243, 'binary_f1_score': 0.96831936}
confusion matrix:
       0      1
0  42308    105
1    787  13632
---- Validation: 
scalar performance:
{'acc': 0.9647812, 'precision': 0.74596417, 'recall': 0.6291079, 'specificity': 0.6291079, 'f1': 0.66741955, 'auroc': 0.89247435, 'binary_precision': 0.518732, 'binary_recall': 0.26745912, 'binary_specificity': 0.99075663, 'binary_f1_score': 0.3529412}
confusion matrix:
       0    1
0  17900  167
1    493  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8678713, 'recall': 0.6252413, 'specificity': 0.6252413, 'f1': 0.6818836, 'auroc': 0.90823954, 'binary_precision': 0.76744187, 'binary_recall': 0.25384617, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.3815029}
confusion matrix:
      0   1
0  5926  20
1   194  66
early stop counter: 4
val acc:0.9647812247276306, best validation acc: 0.9650480151176453, corresponding to test acc:                         0.9660006165504456 / 0.9700289964675903
after epoch: 22,now: 2024-07-11 01:20:49.741796,epoch time: 0:21:43.925896,used: 8:35:09.369566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9855891, 'precision': 0.98657435, 'recall': 0.975262, 'specificity': 0.975262, 'f1': 0.9807507, 'auroc': 0.99732125, 'binary_precision': 0.9885057, 'binary_recall': 0.9542964, 'binary_specificity': 0.99622756, 'binary_f1_score': 0.97109985}
confusion matrix:
       0      1
0  42253    160
1    659  13760
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.73854095, 'recall': 0.6495462, 'specificity': 0.6495462, 'f1': 0.68269986, 'auroc': 0.8958597, 'binary_precision': 0.50240386, 'binary_recall': 0.31054977, 'binary_specificity': 0.9885427, 'binary_f1_score': 0.3838384}
confusion matrix:
       0    1
0  17860  207
1    464  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.83581084, 'recall': 0.65474916, 'specificity': 0.65474916, 'f1': 0.70865744, 'auroc': 0.9106704, 'binary_precision': 0.7008547, 'binary_recall': 0.31538463, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.43501326}
confusion matrix:
      0   1
0  5911  35
1   178  82
early stop counter: 5
val acc:0.9641942381858826, best validation acc: 0.9650480151176453, corresponding to test acc:                         0.9660006165504456 / 0.9700289964675903
after epoch: 23,now: 2024-07-11 01:42:43.317814,epoch time: 0:21:53.576018,used: 8:57:02.945584,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98583543, 'precision': 0.98652774, 'recall': 0.9759549, 'specificity': 0.9759549, 'f1': 0.98109484, 'auroc': 0.9969872, 'binary_precision': 0.9878879, 'binary_recall': 0.9558946, 'binary_specificity': 0.99601525, 'binary_f1_score': 0.97162795}
confusion matrix:
       0      1
0  42243    169
1    636  13784
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.7305457, 'recall': 0.63705456, 'specificity': 0.63705456, 'f1': 0.67056525, 'auroc': 0.8966206, 'binary_precision': 0.48730963, 'binary_recall': 0.28528973, 'binary_specificity': 0.9888194, 'binary_f1_score': 0.35988754}
confusion matrix:
       0    1
0  17865  202
1    481  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.8324697, 'recall': 0.6621892, 'specificity': 0.6621892, 'f1': 0.7151455, 'auroc': 0.91207165, 'binary_precision': 0.6935484, 'binary_recall': 0.33076924, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.44791666}
confusion matrix:
      0   1
0  5908  38
1   174  86
early stop counter: 6
val acc:0.9635539054870605, best validation acc: 0.9650480151176453, corresponding to test acc:                         0.9660006165504456 / 0.9700289964675903
after epoch: 24,now: 2024-07-11 02:04:25.090088,epoch time: 0:21:41.772274,used: 9:18:44.717858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9855891, 'precision': 0.9848668, 'recall': 0.97693413, 'specificity': 0.97693413, 'f1': 0.98081744, 'auroc': 0.9974847, 'binary_precision': 0.9834364, 'binary_recall': 0.959362, 'binary_specificity': 0.9945063, 'binary_f1_score': 0.97125006}
confusion matrix:
       0      1
0  42179    233
1    586  13834
---- Validation: 
scalar performance:
{'acc': 0.964301, 'precision': 0.73961973, 'recall': 0.6424489, 'specificity': 0.6424489, 'f1': 0.677318, 'auroc': 0.89886224, 'binary_precision': 0.50507617, 'binary_recall': 0.29569092, 'binary_specificity': 0.98920685, 'binary_f1_score': 0.37300846}
confusion matrix:
       0    1
0  17872  195
1    474  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96696746, 'precision': 0.841217, 'recall': 0.6756507, 'specificity': 0.6756507, 'f1': 0.7293249, 'auroc': 0.91063285, 'binary_precision': 0.7099237, 'binary_recall': 0.3576923, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.47570333}
confusion matrix:
      0   1
0  5908  38
1   167  93
early stop counter: 7
val acc:0.9643009901046753, best validation acc: 0.9650480151176453, corresponding to test acc:                         0.9660006165504456 / 0.9700289964675903
after epoch: 25,now: 2024-07-11 02:25:59.111956,epoch time: 0:21:34.021868,used: 9:40:18.739726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98625773, 'precision': 0.9870503, 'recall': 0.97655827, 'specificity': 0.97655827, 'f1': 0.9816601, 'auroc': 0.9977249, 'binary_precision': 0.9886079, 'binary_recall': 0.9568655, 'binary_specificity': 0.99625105, 'binary_f1_score': 0.9724777}
confusion matrix:
       0      1
0  42253    159
1    622  13798
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.72751075, 'recall': 0.6048675, 'specificity': 0.6048675, 'f1': 0.6411052, 'auroc': 0.8923943, 'binary_precision': 0.48355263, 'binary_recall': 0.21842496, 'binary_specificity': 0.9913101, 'binary_f1_score': 0.30092117}
confusion matrix:
       0    1
0  17910  157
1    526  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.8280546, 'recall': 0.6206383, 'specificity': 0.6206383, 'f1': 0.671974, 'auroc': 0.90632045, 'binary_precision': 0.68817204, 'binary_recall': 0.24615385, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.36260623}
confusion matrix:
      0   1
0  5917  29
1   196  64
early stop counter: 8
val acc:0.9635539054870605, best validation acc: 0.9650480151176453, corresponding to test acc:                         0.9660006165504456 / 0.9700289964675903
after epoch: 26,now: 2024-07-11 02:47:31.664248,epoch time: 0:21:32.552292,used: 10:01:51.292018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98736626, 'precision': 0.98766005, 'recall': 0.97887874, 'specificity': 0.97887874, 'f1': 0.9831685, 'auroc': 0.997949, 'binary_precision': 0.9882403, 'binary_recall': 0.9616478, 'binary_specificity': 0.99610966, 'binary_f1_score': 0.97476274}
confusion matrix:
       0      1
0  42248    165
1    553  13866
---- Validation: 
scalar performance:
{'acc': 0.9629136, 'precision': 0.7199764, 'recall': 0.6138339, 'specificity': 0.6138339, 'f1': 0.6481058, 'auroc': 0.8947052, 'binary_precision': 0.46783626, 'binary_recall': 0.23774146, 'binary_specificity': 0.9899264, 'binary_f1_score': 0.31527093}
confusion matrix:
       0    1
0  17885  182
1    513  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.83145523, 'recall': 0.652742, 'specificity': 0.652742, 'f1': 0.7059218, 'auroc': 0.9083991, 'binary_precision': 0.6923077, 'binary_recall': 0.31153846, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.42970824}
confusion matrix:
      0   1
0  5910  36
1   179  81
early stop counter: 9
val acc:0.9629135727882385, best validation acc: 0.9650480151176453, corresponding to test acc:                         0.9660006165504456 / 0.9700289964675903
after epoch: 27,now: 2024-07-11 03:09:09.177799,epoch time: 0:21:37.513551,used: 10:23:28.805569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98613596, 'recall': 0.9776326, 'specificity': 0.9776326, 'f1': 0.98178923, 'auroc': 0.99744594, 'binary_precision': 0.985756, 'binary_recall': 0.9599806, 'binary_specificity': 0.99528456, 'binary_f1_score': 0.97269756}
confusion matrix:
       0      1
0  42214    200
1    577  13841
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.7236685, 'recall': 0.6253612, 'specificity': 0.6253612, 'f1': 0.6590863, 'auroc': 0.895707, 'binary_precision': 0.47439352, 'binary_recall': 0.2615156, 'binary_specificity': 0.98920685, 'binary_f1_score': 0.33716473}
confusion matrix:
       0    1
0  17872  195
1    497  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.8274498, 'recall': 0.6356866, 'specificity': 0.6356866, 'f1': 0.6880878, 'auroc': 0.9080182, 'binary_precision': 0.6857143, 'binary_recall': 0.2769231, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.39452058}
confusion matrix:
      0   1
0  5913  33
1   188  72
early stop counter: 10
val acc:0.9630736112594604, best validation acc: 0.9650480151176453, corresponding to test acc:                         0.9660006165504456 / 0.9700289964675903
after epoch: 28,now: 2024-07-11 03:30:46.620339,epoch time: 0:21:37.442540,used: 10:45:06.248109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98694396, 'precision': 0.9855056, 'recall': 0.9798993, 'specificity': 0.9798993, 'f1': 0.9826609, 'auroc': 0.99760383, 'binary_precision': 0.9826369, 'binary_recall': 0.9655986, 'binary_specificity': 0.99420005, 'binary_f1_score': 0.97404325}
confusion matrix:
       0      1
0  42168    246
1    496  13922
---- Validation: 
scalar performance:
{'acc': 0.9629669, 'precision': 0.72382987, 'recall': 0.63603485, 'specificity': 0.63603485, 'f1': 0.6679774, 'auroc': 0.9000014, 'binary_precision': 0.4739454, 'binary_recall': 0.28380385, 'binary_specificity': 0.9882659, 'binary_f1_score': 0.3550186}
confusion matrix:
       0    1
0  17855  212
1    482  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.8242711, 'recall': 0.66193694, 'specificity': 0.66193694, 'f1': 0.7132825, 'auroc': 0.9123781, 'binary_precision': 0.6771653, 'binary_recall': 0.33076924, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.44444445}
confusion matrix:
      0   1
0  5905  41
1   174  86
early stop counter: 11
val acc:0.9629669189453125, best validation acc: 0.9650480151176453, corresponding to test acc:                         0.9660006165504456 / 0.9700289964675903
after epoch: 29,now: 2024-07-11 03:52:35.799705,epoch time: 0:21:49.179366,used: 11:06:55.427475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98722553, 'precision': 0.98663545, 'recall': 0.97951686, 'specificity': 0.97951686, 'f1': 0.9830095, 'auroc': 0.99747276, 'binary_precision': 0.9854641, 'binary_recall': 0.9638671, 'binary_specificity': 0.9951666, 'binary_f1_score': 0.97454596}
confusion matrix:
       0      1
0  42208    205
1    521  13898
---- Validation: 
scalar performance:
{'acc': 0.9626467, 'precision': 0.7172753, 'recall': 0.6172719, 'specificity': 0.6172719, 'f1': 0.65059197, 'auroc': 0.89825547, 'binary_precision': 0.46218488, 'binary_recall': 0.24517088, 'binary_specificity': 0.9893729, 'binary_f1_score': 0.32038835}
confusion matrix:
       0    1
0  17875  192
1    508  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.81018865, 'recall': 0.63334304, 'specificity': 0.63334304, 'f1': 0.6829874, 'auroc': 0.9073404, 'binary_precision': 0.6513761, 'binary_recall': 0.27307692, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.38482386}
confusion matrix:
      0   1
0  5908  38
1   189  71
early stop counter: 12
val acc:0.9626467227935791, best validation acc: 0.9650480151176453, corresponding to test acc:                         0.9660006165504456 / 0.9700289964675903
after epoch: 30,now: 2024-07-11 04:14:25.342516,epoch time: 0:21:49.542811,used: 11:28:44.970286,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_45_40_seed_1_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:28:44.970286 at 2024-07-11 04:14:25.342516
persisted model performance metric: 

scalar performance:
{'acc': 0.9660006, 'precision': 0.8561356, 'recall': 0.6420444, 'specificity': 0.6420444, 'f1': 0.6990018, 'auroc': 0.91258717, 'binary_precision': 0.7425743, 'binary_recall': 0.28846154, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.41551247}
confusion matrix:
      0   1
0  5920  26
1   185  75
oracle model performance metric: 

scalar performance:
{'acc': 0.970029, 'precision': 0.85518384, 'recall': 0.7195451, 'specificity': 0.7195451, 'f1': 0.7697581, 'auroc': 0.9164319, 'binary_precision': 0.73417723, 'binary_recall': 0.44615385, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.5550239}
confusion matrix:
      0    1
0  5904   42
1   144  116
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |  17479 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |  17479 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   7827 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   2320 TiB |   2320 TiB |
|       from small pool |  16480 KiB |     36 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  16790 MiB |   8278 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  16734 MiB |   8260 MiB |
|       from small pool |     38 MiB |     44 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38830 KiB | 732464 KiB |   1304 TiB |   1304 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1274 TiB |   1274 TiB |
|       from small pool |   7097 KiB |  23272 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7625    |  388810 K  |  388807 K  |
|       from large pool |      79    |     762    |  220130 K  |  220130 K  |
|       from small pool |    2875    |    7544    |  168680 K  |  168677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7625    |  388810 K  |  388807 K  |
|       from large pool |      79    |     762    |  220130 K  |  220130 K  |
|       from small pool |    2875    |    7544    |  168680 K  |  168677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |     715    |     347    |
|       from large pool |     349    |     349    |     687    |     338    |
|       from small pool |      19    |      22    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3589    |  230563 K  |  230563 K  |
|       from large pool |      11    |     352    |  159260 K  |  159260 K  |
|       from small pool |      25    |    3579    |   71302 K  |   71302 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     36 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16790 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     44 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1304 TiB |   1304 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1274 TiB |   1274 TiB |
|       from small pool |      0 KiB |  23272 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  388810 K  |  388810 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168680 K  |  168680 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  388810 K  |  388810 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168680 K  |  168680 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     715    |     693    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      22    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  230564 K  |  230564 K  |
|       from large pool |       3    |     352    |  159260 K  |  159260 K  |
|       from small pool |       0    |    3579    |   71304 K  |   71304 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     36 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16790 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     44 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1304 TiB |   1304 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1274 TiB |   1274 TiB |
|       from small pool |      0 KiB |  23272 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  388810 K  |  388810 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168680 K  |  168680 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  388810 K  |  388810 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168680 K  |  168680 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     715    |     693    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      22    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  230564 K  |  230564 K  |
|       from large pool |       3    |     352    |  159260 K  |  159260 K  |
|       from small pool |       0    |    3579    |   71304 K  |   71304 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619

 Experiment start at: 2024-07-11 04:33:14.646852
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9421135, 'precision': 0.95045197, 'recall': 0.8994325, 'specificity': 0.8994325, 'f1': 0.9211274, 'auroc': 0.9701568, 'binary_precision': 0.965384, 'binary_recall': 0.8092405, 'binary_specificity': 0.98962444, 'binary_f1_score': 0.8804429}
confusion matrix:
       0      1
0  41872    439
1   2886  12243
---- Validation: 
scalar performance:
{'acc': 0.9571725, 'precision': 0.61751676, 'recall': 0.5835801, 'specificity': 0.5835801, 'f1': 0.5971794, 'auroc': 0.7859225, 'binary_precision': 0.26179245, 'binary_recall': 0.18438539, 'binary_specificity': 0.98277473, 'binary_f1_score': 0.21637426}
confusion matrix:
       0    1
0  17858  313
1    491  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93059784, 'precision': 0.5170912, 'recall': 0.5157992, 'specificity': 0.5157992, 'f1': 0.51638645, 'auroc': 0.6471383, 'binary_precision': 0.07174888, 'binary_recall': 0.0661157, 'binary_specificity': 0.9654827, 'binary_f1_score': 0.0688172}
confusion matrix:
      0    1
0  5790  207
1   226   16
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 04:55:43.060442,epoch time: 0:22:28.413590,used: 0:22:28.413590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9590181, 'precision': 0.9638266, 'recall': 0.92997754, 'specificity': 0.92997754, 'f1': 0.94525313, 'auroc': 0.98093987, 'binary_precision': 0.9729049, 'binary_recall': 0.86860543, 'binary_specificity': 0.9913496, 'binary_f1_score': 0.9178015}
confusion matrix:
       0      1
0  41944    366
1   1988  13142
---- Validation: 
scalar performance:
{'acc': 0.9629787, 'precision': 0.66338134, 'recall': 0.5873824, 'specificity': 0.5873824, 'f1': 0.612384, 'auroc': 0.81822675, 'binary_precision': 0.3533123, 'binary_recall': 0.18604651, 'binary_specificity': 0.9887183, 'binary_f1_score': 0.2437432}
confusion matrix:
       0    1
0  17966  205
1    490  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9427793, 'precision': 0.54627156, 'recall': 0.53006667, 'specificity': 0.53006667, 'f1': 0.53560257, 'auroc': 0.73450434, 'binary_precision': 0.12903225, 'binary_recall': 0.08264463, 'binary_specificity': 0.97748876, 'binary_f1_score': 0.10075566}
confusion matrix:
      0    1
0  5862  135
1   222   20
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-11 05:17:52.917386,epoch time: 0:22:09.856944,used: 0:44:38.270534,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96229106, 'precision': 0.96936435, 'recall': 0.93336266, 'specificity': 0.93336266, 'f1': 0.94953114, 'auroc': 0.98499256, 'binary_precision': 0.9826495, 'binary_recall': 0.87223214, 'binary_specificity': 0.9944932, 'binary_f1_score': 0.92415434}
confusion matrix:
       0      1
0  42078    233
1   1933  13196
---- Validation: 
scalar performance:
{'acc': 0.96644115, 'precision': 0.7014808, 'recall': 0.5690948, 'specificity': 0.5690948, 'f1': 0.59963566, 'auroc': 0.8367957, 'binary_precision': 0.43069306, 'binary_recall': 0.14451827, 'binary_specificity': 0.99367124, 'binary_f1_score': 0.2164179}
confusion matrix:
       0    1
0  18056  115
1    515   87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9517551, 'precision': 0.5969791, 'recall': 0.54464936, 'specificity': 0.54464936, 'f1': 0.55881476, 'auroc': 0.7960309, 'binary_precision': 0.2293578, 'binary_recall': 0.10330579, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.14245014}
confusion matrix:
      0   1
0  5913  84
1   217  25
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-11 05:39:48.655145,epoch time: 0:21:55.737759,used: 1:06:34.008293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9698642, 'precision': 0.9733088, 'recall': 0.9487188, 'specificity': 0.9487188, 'f1': 0.9601562, 'auroc': 0.988667, 'binary_precision': 0.98001003, 'binary_recall': 0.90403175, 'binary_specificity': 0.9934058, 'binary_f1_score': 0.9404889}
confusion matrix:
       0      1
0  42031    279
1   1452  13678
---- Validation: 
scalar performance:
{'acc': 0.96580195, 'precision': 0.69980294, 'recall': 0.59124994, 'specificity': 0.59124994, 'f1': 0.62312794, 'auroc': 0.85331887, 'binary_precision': 0.42592594, 'binary_recall': 0.1910299, 'binary_specificity': 0.9914699, 'binary_f1_score': 0.26376146}
confusion matrix:
       0    1
0  18016  155
1    487  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9515948, 'precision': 0.6440779, 'recall': 0.60008276, 'specificity': 0.60008276, 'f1': 0.6173916, 'auroc': 0.83103466, 'binary_precision': 0.3192771, 'binary_recall': 0.21900827, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.25980392}
confusion matrix:
      0    1
0  5884  113
1   189   53
early stop counter: 1
val acc:0.9658019542694092, best validation acc: 0.9664411544799805, corresponding to test acc:                         0.9517551064491272 / 0.9517551064491272
after epoch: 4,now: 2024-07-11 06:01:31.678088,epoch time: 0:21:43.022943,used: 1:28:17.031236,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97090876, 'precision': 0.97416043, 'recall': 0.9505742, 'specificity': 0.9505742, 'f1': 0.9615791, 'auroc': 0.9903258, 'binary_precision': 0.98050696, 'binary_recall': 0.9076008, 'binary_specificity': 0.9935476, 'binary_f1_score': 0.9426463}
confusion matrix:
       0      1
0  42037    273
1   1398  13732
---- Validation: 
scalar performance:
{'acc': 0.96606827, 'precision': 0.7080152, 'recall': 0.60503936, 'specificity': 0.60503936, 'f1': 0.6378124, 'auroc': 0.8609908, 'binary_precision': 0.44147158, 'binary_recall': 0.2192691, 'binary_specificity': 0.99080956, 'binary_f1_score': 0.29300776}
confusion matrix:
       0    1
0  18004  167
1    470  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9517551, 'precision': 0.6582246, 'recall': 0.62594175, 'specificity': 0.62594175, 'f1': 0.6399301, 'auroc': 0.84521943, 'binary_precision': 0.34554973, 'binary_recall': 0.27272728, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.3048499}
confusion matrix:
      0    1
0  5872  125
1   176   66
early stop counter: 2
val acc:0.9660682678222656, best validation acc: 0.9664411544799805, corresponding to test acc:                         0.9517551064491272 / 0.9517551064491272
after epoch: 5,now: 2024-07-11 06:23:18.354952,epoch time: 0:21:46.676864,used: 1:50:03.708100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9728761, 'precision': 0.97566295, 'recall': 0.9541571, 'specificity': 0.9541571, 'f1': 0.9642558, 'auroc': 0.99204123, 'binary_precision': 0.98113877, 'binary_recall': 0.9146011, 'binary_specificity': 0.9937132, 'binary_f1_score': 0.9467023}
confusion matrix:
       0      1
0  42045    266
1   1292  13837
---- Validation: 
scalar performance:
{'acc': 0.9665477, 'precision': 0.7146905, 'recall': 0.6044839, 'specificity': 0.6044839, 'f1': 0.6386249, 'auroc': 0.86564153, 'binary_precision': 0.4548611, 'binary_recall': 0.21760798, 'binary_specificity': 0.99135983, 'binary_f1_score': 0.294382}
confusion matrix:
       0    1
0  18014  157
1    471  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949992, 'precision': 0.65062785, 'recall': 0.6289901, 'specificity': 0.6289901, 'f1': 0.63881814, 'auroc': 0.85612553, 'binary_precision': 0.33009708, 'binary_recall': 0.28099173, 'binary_specificity': 0.9769885, 'binary_f1_score': 0.30357143}
confusion matrix:
      0    1
0  5859  138
1   174   68
better model found
persisted
after epoch: 6,now: 2024-07-11 06:45:13.053934,epoch time: 0:21:54.698982,used: 2:11:58.407082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9756442, 'precision': 0.9760511, 'recall': 0.96083224, 'specificity': 0.96083224, 'f1': 0.96811163, 'auroc': 0.992695, 'binary_precision': 0.97686696, 'binary_recall': 0.9295346, 'binary_specificity': 0.9921299, 'binary_f1_score': 0.9526132}
confusion matrix:
       0      1
0  41979    333
1   1066  14062
---- Validation: 
scalar performance:
{'acc': 0.96569544, 'precision': 0.71127105, 'recall': 0.63777167, 'specificity': 0.63777167, 'f1': 0.6659391, 'auroc': 0.86997515, 'binary_precision': 0.4458763, 'binary_recall': 0.28737542, 'binary_specificity': 0.98816794, 'binary_f1_score': 0.349495}
confusion matrix:
       0    1
0  17956  215
1    429  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9416573, 'precision': 0.6346902, 'recall': 0.66430944, 'specificity': 0.66430944, 'f1': 0.64771754, 'auroc': 0.862496, 'binary_precision': 0.295302, 'binary_recall': 0.36363637, 'binary_specificity': 0.9649825, 'binary_f1_score': 0.32592592}
confusion matrix:
      0    1
0  5787  210
1   154   88
early stop counter: 1
val acc:0.9656954407691956, best validation acc: 0.9665477275848389, corresponding to test acc:                         0.9499920010566711 / 0.9517551064491272
after epoch: 7,now: 2024-07-11 07:07:07.595720,epoch time: 0:21:54.541786,used: 2:33:52.948868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97642756, 'precision': 0.97825044, 'recall': 0.9607506, 'specificity': 0.9607506, 'f1': 0.96906793, 'auroc': 0.9937439, 'binary_precision': 0.98187923, 'binary_recall': 0.92762244, 'binary_specificity': 0.99387866, 'binary_f1_score': 0.95398}
confusion matrix:
       0      1
0  42052    259
1   1095  14034
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.7148906, 'recall': 0.61564404, 'specificity': 0.61564404, 'f1': 0.6488232, 'auroc': 0.8706575, 'binary_precision': 0.45454547, 'binary_recall': 0.24086379, 'binary_specificity': 0.9904243, 'binary_f1_score': 0.31487513}
confusion matrix:
       0    1
0  17997  174
1    457  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94614524, 'precision': 0.63976026, 'recall': 0.6408683, 'specificity': 0.6408683, 'f1': 0.6403116, 'auroc': 0.8646444, 'binary_precision': 0.30737704, 'binary_recall': 0.30991736, 'binary_specificity': 0.9718192, 'binary_f1_score': 0.30864197}
confusion matrix:
      0    1
0  5828  169
1   167   75
early stop counter: 2
val acc:0.9663878679275513, best validation acc: 0.9665477275848389, corresponding to test acc:                         0.9499920010566711 / 0.9517551064491272
after epoch: 8,now: 2024-07-11 07:29:06.214173,epoch time: 0:21:58.618453,used: 2:55:51.567321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97764623, 'precision': 0.98099005, 'recall': 0.9612994, 'specificity': 0.9612994, 'f1': 0.97060275, 'auroc': 0.9939208, 'binary_precision': 0.9876021, 'binary_recall': 0.92675835, 'binary_specificity': 0.99584043, 'binary_f1_score': 0.9562133}
confusion matrix:
       0      1
0  42136    176
1   1108  14020
---- Validation: 
scalar performance:
{'acc': 0.96606827, 'precision': 0.7147752, 'recall': 0.63475215, 'specificity': 0.63475215, 'f1': 0.6646242, 'auroc': 0.87598205, 'binary_precision': 0.4530831, 'binary_recall': 0.2807309, 'binary_specificity': 0.98877335, 'binary_f1_score': 0.3466667}
confusion matrix:
       0    1
0  17967  204
1    433  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.942619, 'precision': 0.6414251, 'recall': 0.6747234, 'specificity': 0.6747234, 'f1': 0.65595675, 'auroc': 0.86864924, 'binary_precision': 0.307947, 'binary_recall': 0.38429752, 'binary_specificity': 0.9651492, 'binary_f1_score': 0.34191176}
confusion matrix:
      0    1
0  5788  209
1   149   93
early stop counter: 3
val acc:0.9660682678222656, best validation acc: 0.9665477275848389, corresponding to test acc:                         0.9499920010566711 / 0.9517551064491272
after epoch: 9,now: 2024-07-11 07:51:03.979095,epoch time: 0:21:57.764922,used: 3:17:49.332243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97780293, 'precision': 0.9791938, 'recall': 0.96335924, 'specificity': 0.96335924, 'f1': 0.9709226, 'auroc': 0.99427927, 'binary_precision': 0.9819776, 'binary_recall': 0.93283975, 'binary_specificity': 0.9938788, 'binary_f1_score': 0.95677817}
confusion matrix:
       0      1
0  42053    259
1   1016  14112
---- Validation: 
scalar performance:
{'acc': 0.96622807, 'precision': 0.7144819, 'recall': 0.623592, 'specificity': 0.623592, 'f1': 0.6555342, 'auroc': 0.8782301, 'binary_precision': 0.45321637, 'binary_recall': 0.25747508, 'binary_specificity': 0.9897089, 'binary_f1_score': 0.32838982}
confusion matrix:
       0    1
0  17984  187
1    447  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94774806, 'precision': 0.6549318, 'recall': 0.66351223, 'specificity': 0.66351223, 'f1': 0.6590848, 'auroc': 0.8723749, 'binary_precision': 0.3359375, 'binary_recall': 0.3553719, 'binary_specificity': 0.9716525, 'binary_f1_score': 0.34538153}
confusion matrix:
      0    1
0  5827  170
1   156   86
early stop counter: 4
val acc:0.9662280678749084, best validation acc: 0.9665477275848389, corresponding to test acc:                         0.9499920010566711 / 0.9517551064491272
after epoch: 10,now: 2024-07-11 08:12:52.776219,epoch time: 0:21:48.797124,used: 3:39:38.129367,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97910863, 'precision': 0.98130924, 'recall': 0.9646957, 'specificity': 0.9646957, 'f1': 0.97261536, 'auroc': 0.994614, 'binary_precision': 0.9857043, 'binary_recall': 0.93423665, 'binary_specificity': 0.9951548, 'binary_f1_score': 0.95928067}
confusion matrix:
       0      1
0  42105    205
1    995  14135
---- Validation: 
scalar performance:
{'acc': 0.96628135, 'precision': 0.7198065, 'recall': 0.65092313, 'specificity': 0.65092313, 'f1': 0.6782807, 'auroc': 0.8824584, 'binary_precision': 0.46210268, 'binary_recall': 0.3139535, 'binary_specificity': 0.9878928, 'binary_f1_score': 0.37388724}
confusion matrix:
       0    1
0  17951  220
1    413  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9416573, 'precision': 0.6391319, 'recall': 0.6762059, 'specificity': 0.6762059, 'f1': 0.65502906, 'auroc': 0.86908877, 'binary_precision': 0.30322582, 'binary_recall': 0.38842976, 'binary_specificity': 0.963982, 'binary_f1_score': 0.34057972}
confusion matrix:
      0    1
0  5781  216
1   148   94
early stop counter: 5
val acc:0.9662813544273376, best validation acc: 0.9665477275848389, corresponding to test acc:                         0.9499920010566711 / 0.9517551064491272
after epoch: 11,now: 2024-07-11 08:34:45.070608,epoch time: 0:21:52.294389,used: 4:01:30.423756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9799965, 'precision': 0.9809711, 'recall': 0.96727276, 'specificity': 0.96727276, 'f1': 0.9738574, 'auroc': 0.99512386, 'binary_precision': 0.9829361, 'binary_recall': 0.9403833, 'binary_specificity': 0.99416214, 'binary_f1_score': 0.961189}
confusion matrix:
       0      1
0  42063    247
1    902  14228
---- Validation: 
scalar performance:
{'acc': 0.96617484, 'precision': 0.7192878, 'recall': 0.6548834, 'specificity': 0.6548834, 'f1': 0.68094516, 'auroc': 0.88358366, 'binary_precision': 0.4608076, 'binary_recall': 0.32225913, 'binary_specificity': 0.9875076, 'binary_f1_score': 0.37927663}
confusion matrix:
       0    1
0  17944  227
1    408  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94374096, 'precision': 0.6511269, 'recall': 0.69315165, 'specificity': 0.69315165, 'f1': 0.66906434, 'auroc': 0.8676335, 'binary_precision': 0.3258786, 'binary_recall': 0.4214876, 'binary_specificity': 0.96481574, 'binary_f1_score': 0.36756754}
confusion matrix:
      0    1
0  5786  211
1   140  102
early stop counter: 6
val acc:0.966174840927124, best validation acc: 0.9665477275848389, corresponding to test acc:                         0.9499920010566711 / 0.9517551064491272
after epoch: 12,now: 2024-07-11 08:56:43.333363,epoch time: 0:21:58.262755,used: 4:23:28.686511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9810411, 'precision': 0.98267007, 'recall': 0.96831954, 'specificity': 0.96831954, 'f1': 0.9752062, 'auroc': 0.9958086, 'binary_precision': 0.98594767, 'binary_recall': 0.94143695, 'binary_specificity': 0.9952022, 'binary_f1_score': 0.96317834}
confusion matrix:
       0      1
0  42108    203
1    886  14243
---- Validation: 
scalar performance:
{'acc': 0.9655356, 'precision': 0.71561456, 'recall': 0.6706141, 'specificity': 0.6706141, 'f1': 0.69019973, 'auroc': 0.88688993, 'binary_precision': 0.4524313, 'binary_recall': 0.3554817, 'binary_specificity': 0.9857465, 'binary_f1_score': 0.39813954}
confusion matrix:
       0    1
0  17912  259
1    388  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9390928, 'precision': 0.64543414, 'recall': 0.71650946, 'specificity': 0.71650946, 'f1': 0.67251515, 'auroc': 0.8702389, 'binary_precision': 0.3125, 'binary_recall': 0.4752066, 'binary_specificity': 0.95781225, 'binary_f1_score': 0.37704918}
confusion matrix:
      0    1
0  5744  253
1   127  115
early stop counter: 7
val acc:0.965535581111908, best validation acc: 0.9665477275848389, corresponding to test acc:                         0.9499920010566711 / 0.9517551064491272
after epoch: 13,now: 2024-07-11 09:18:49.553951,epoch time: 0:22:06.220588,used: 4:45:34.907099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9816504, 'precision': 0.98451674, 'recall': 0.9681387, 'specificity': 0.9681387, 'f1': 0.97595465, 'auroc': 0.9960809, 'binary_precision': 0.9902473, 'binary_recall': 0.9395862, 'binary_specificity': 0.99669117, 'binary_f1_score': 0.9642518}
confusion matrix:
       0      1
0  42171    140
1    914  14215
---- Validation: 
scalar performance:
{'acc': 0.96617484, 'precision': 0.7173945, 'recall': 0.64283764, 'specificity': 0.64283764, 'f1': 0.6715758, 'auroc': 0.8867624, 'binary_precision': 0.4578005, 'binary_recall': 0.29734218, 'binary_specificity': 0.98833305, 'binary_f1_score': 0.36052367}
confusion matrix:
       0    1
0  17959  212
1    423  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9445424, 'precision': 0.65054834, 'recall': 0.68365484, 'specificity': 0.68365484, 'f1': 0.66513807, 'auroc': 0.86909574, 'binary_precision': 0.32550335, 'binary_recall': 0.40082645, 'binary_specificity': 0.96648324, 'binary_f1_score': 0.35925925}
confusion matrix:
      0    1
0  5796  201
1   145   97
early stop counter: 8
val acc:0.966174840927124, best validation acc: 0.9665477275848389, corresponding to test acc:                         0.9499920010566711 / 0.9517551064491272
after epoch: 14,now: 2024-07-11 09:41:09.558488,epoch time: 0:22:20.004537,used: 5:07:54.911636,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98208565, 'precision': 0.9806539, 'recall': 0.9729792, 'specificity': 0.9729792, 'f1': 0.97673273, 'auroc': 0.99626446, 'binary_precision': 0.9777085, 'binary_recall': 0.9537343, 'binary_specificity': 0.99222404, 'binary_f1_score': 0.96557266}
confusion matrix:
       0      1
0  41981    329
1    700  14430
---- Validation: 
scalar performance:
{'acc': 0.96633464, 'precision': 0.72322613, 'recall': 0.67263293, 'specificity': 0.67263293, 'f1': 0.6943457, 'auroc': 0.8913103, 'binary_precision': 0.46753246, 'binary_recall': 0.358804, 'binary_specificity': 0.98646194, 'binary_f1_score': 0.406015}
confusion matrix:
       0    1
0  17925  246
1    386  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94197786, 'precision': 0.64874864, 'recall': 0.70214826, 'specificity': 0.70214826, 'f1': 0.67055637, 'auroc': 0.87195325, 'binary_precision': 0.3203593, 'binary_recall': 0.44214877, 'binary_specificity': 0.9621477, 'binary_f1_score': 0.37152782}
confusion matrix:
      0    1
0  5770  227
1   135  107
early stop counter: 9
val acc:0.9663346409797668, best validation acc: 0.9665477275848389, corresponding to test acc:                         0.9499920010566711 / 0.9517551064491272
after epoch: 15,now: 2024-07-11 10:03:27.333264,epoch time: 0:22:17.774776,used: 5:30:12.686412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98213786, 'precision': 0.98463833, 'recall': 0.96925515, 'specificity': 0.96925515, 'f1': 0.9766172, 'auroc': 0.9963561, 'binary_precision': 0.98965347, 'binary_recall': 0.94203186, 'binary_specificity': 0.99647844, 'binary_f1_score': 0.9652556}
confusion matrix:
       0      1
0  42162    149
1    877  14252
---- Validation: 
scalar performance:
{'acc': 0.9671869, 'precision': 0.7310566, 'recall': 0.6658458, 'specificity': 0.6658458, 'f1': 0.69253623, 'auroc': 0.89313143, 'binary_precision': 0.48364487, 'binary_recall': 0.34385383, 'binary_specificity': 0.9878378, 'binary_f1_score': 0.40194178}
confusion matrix:
       0    1
0  17950  221
1    395  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9445424, 'precision': 0.6568389, 'recall': 0.7034823, 'specificity': 0.7034823, 'f1': 0.6765556, 'auroc': 0.86902183, 'binary_precision': 0.336478, 'binary_recall': 0.44214877, 'binary_specificity': 0.96481574, 'binary_f1_score': 0.38214284}
confusion matrix:
      0    1
0  5786  211
1   135  107
better model found
persisted
after epoch: 16,now: 2024-07-11 10:25:35.423228,epoch time: 0:22:08.089964,used: 5:52:20.776376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9834436, 'precision': 0.9820726, 'recall': 0.9750885, 'specificity': 0.9750885, 'f1': 0.97851133, 'auroc': 0.9965867, 'binary_precision': 0.97924554, 'binary_recall': 0.95743275, 'binary_specificity': 0.9927442, 'binary_f1_score': 0.9682163}
confusion matrix:
       0      1
0  42004    307
1    644  14485
---- Validation: 
scalar performance:
{'acc': 0.96564215, 'precision': 0.7207457, 'recall': 0.701185, 'specificity': 0.701185, 'f1': 0.71046054, 'auroc': 0.8946078, 'binary_precision': 0.4606947, 'binary_recall': 0.41860464, 'binary_specificity': 0.98376536, 'binary_f1_score': 0.4386423}
confusion matrix:
       0    1
0  17876  295
1    350  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93300205, 'precision': 0.63256377, 'recall': 0.7192894, 'specificity': 0.7192894, 'f1': 0.6627522, 'auroc': 0.8662768, 'binary_precision': 0.28640777, 'binary_recall': 0.4876033, 'binary_specificity': 0.9509755, 'binary_f1_score': 0.36085626}
confusion matrix:
      0    1
0  5703  294
1   124  118
early stop counter: 1
val acc:0.9656421542167664, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.944542407989502 / 0.9517551064491272
after epoch: 17,now: 2024-07-11 10:47:39.959679,epoch time: 0:22:04.536451,used: 6:14:25.312827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9844011, 'precision': 0.9849049, 'recall': 0.9747603, 'specificity': 0.9747603, 'f1': 0.9796884, 'auroc': 0.99664974, 'binary_precision': 0.9859328, 'binary_recall': 0.9543892, 'binary_specificity': 0.99513143, 'binary_f1_score': 0.96990466}
confusion matrix:
       0      1
0  42106    206
1    690  14438
---- Validation: 
scalar performance:
{'acc': 0.96510947, 'precision': 0.71267515, 'recall': 0.67521226, 'specificity': 0.67521226, 'f1': 0.69192857, 'auroc': 0.8914257, 'binary_precision': 0.44624746, 'binary_recall': 0.3654485, 'binary_specificity': 0.98497605, 'binary_f1_score': 0.4018265}
confusion matrix:
       0    1
0  17898  273
1    382  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93604743, 'precision': 0.6358857, 'recall': 0.7089771, 'specificity': 0.7089771, 'f1': 0.66294694, 'auroc': 0.8628639, 'binary_precision': 0.29396325, 'binary_recall': 0.46280992, 'binary_specificity': 0.9551442, 'binary_f1_score': 0.35955057}
confusion matrix:
      0    1
0  5728  269
1   130  112
early stop counter: 2
val acc:0.9651094675064087, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.944542407989502 / 0.9517551064491272
after epoch: 18,now: 2024-07-11 11:10:04.933645,epoch time: 0:22:24.973966,used: 6:36:50.286793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98481894, 'precision': 0.9843501, 'recall': 0.976383, 'specificity': 0.976383, 'f1': 0.9802772, 'auroc': 0.9962903, 'binary_precision': 0.98338646, 'binary_recall': 0.9585564, 'binary_specificity': 0.9942095, 'binary_f1_score': 0.9708127}
confusion matrix:
       0      1
0  42066    245
1    627  14502
---- Validation: 
scalar performance:
{'acc': 0.9645235, 'precision': 0.71437347, 'recall': 0.715062, 'specificity': 0.715062, 'f1': 0.71471715, 'auroc': 0.89799464, 'binary_precision': 0.44701988, 'binary_recall': 0.44850498, 'binary_specificity': 0.98161906, 'binary_f1_score': 0.44776118}
confusion matrix:
       0    1
0  17837  334
1    332  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9318801, 'precision': 0.63015854, 'recall': 0.7187058, 'specificity': 0.7187058, 'f1': 0.66053486, 'auroc': 0.86551476, 'binary_precision': 0.28162292, 'binary_recall': 0.4876033, 'binary_specificity': 0.94980824, 'binary_f1_score': 0.3570348}
confusion matrix:
      0    1
0  5696  301
1   124  118
early stop counter: 3
val acc:0.9645234942436218, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.944542407989502 / 0.9517551064491272
after epoch: 19,now: 2024-07-11 11:32:22.228055,epoch time: 0:22:17.294410,used: 6:59:07.581203,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98497564, 'precision': 0.9874381, 'recall': 0.97381413, 'specificity': 0.97381413, 'f1': 0.980369, 'auroc': 0.9968838, 'binary_precision': 0.9924065, 'binary_recall': 0.95022804, 'binary_specificity': 0.9974002, 'binary_f1_score': 0.97085935}
confusion matrix:
       0      1
0  42201    110
1    753  14376
---- Validation: 
scalar performance:
{'acc': 0.96526927, 'precision': 0.7172848, 'recall': 0.69697714, 'specificity': 0.69697714, 'f1': 0.7065762, 'auroc': 0.89923453, 'binary_precision': 0.4540441, 'binary_recall': 0.410299, 'binary_specificity': 0.9836553, 'binary_f1_score': 0.43106455}
confusion matrix:
       0    1
0  17874  297
1    355  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93604743, 'precision': 0.6358857, 'recall': 0.7089771, 'specificity': 0.7089771, 'f1': 0.66294694, 'auroc': 0.86361104, 'binary_precision': 0.29396325, 'binary_recall': 0.46280992, 'binary_specificity': 0.9551442, 'binary_f1_score': 0.35955057}
confusion matrix:
      0    1
0  5728  269
1   130  112
early stop counter: 4
val acc:0.9652692675590515, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.944542407989502 / 0.9517551064491272
after epoch: 20,now: 2024-07-11 11:54:36.620805,epoch time: 0:22:14.392750,used: 7:21:21.973953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98523676, 'precision': 0.9856332, 'recall': 0.9762008, 'specificity': 0.9762008, 'f1': 0.9807925, 'auroc': 0.99698365, 'binary_precision': 0.9864441, 'binary_recall': 0.9571051, 'binary_specificity': 0.9952966, 'binary_f1_score': 0.9715532}
confusion matrix:
       0      1
0  42111    199
1    649  14481
---- Validation: 
scalar performance:
{'acc': 0.9628722, 'precision': 0.7056664, 'recall': 0.7270578, 'specificity': 0.7270578, 'f1': 0.7157676, 'auroc': 0.9004764, 'binary_precision': 0.4287856, 'binary_recall': 0.47508305, 'binary_specificity': 0.9790325, 'binary_f1_score': 0.4507486}
confusion matrix:
       0    1
0  17790  381
1    316  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9240263, 'precision': 0.62066364, 'recall': 0.732465, 'specificity': 0.732465, 'f1': 0.6542803, 'auroc': 0.8631084, 'binary_precision': 0.26131687, 'binary_recall': 0.5247934, 'binary_specificity': 0.94013673, 'binary_f1_score': 0.3489011}
confusion matrix:
      0    1
0  5638  359
1   115  127
early stop counter: 5
val acc:0.9628722071647644, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.944542407989502 / 0.9517551064491272
after epoch: 21,now: 2024-07-11 12:16:56.099732,epoch time: 0:22:19.478927,used: 7:43:41.452880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9856546, 'precision': 0.9861386, 'recall': 0.9767817, 'specificity': 0.9767817, 'f1': 0.98133767, 'auroc': 0.9971787, 'binary_precision': 0.98712885, 'binary_recall': 0.9580304, 'binary_specificity': 0.995533, 'binary_f1_score': 0.972362}
confusion matrix:
       0      1
0  42121    189
1    635  14495
---- Validation: 
scalar performance:
{'acc': 0.9642039, 'precision': 0.70824933, 'recall': 0.69080544, 'specificity': 0.69080544, 'f1': 0.6991011, 'auroc': 0.8973398, 'binary_precision': 0.43636364, 'binary_recall': 0.3986711, 'binary_specificity': 0.98293984, 'binary_f1_score': 0.4166667}
confusion matrix:
       0    1
0  17861  310
1    362  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93236095, 'precision': 0.6268382, 'recall': 0.7050767, 'specificity': 0.7050767, 'f1': 0.6545303, 'auroc': 0.8574463, 'binary_precision': 0.2761194, 'binary_recall': 0.45867768, 'binary_specificity': 0.95147574, 'binary_f1_score': 0.34472048}
confusion matrix:
      0    1
0  5706  291
1   131  111
early stop counter: 6
val acc:0.9642038941383362, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.944542407989502 / 0.9517551064491272
after epoch: 22,now: 2024-07-11 12:39:13.711584,epoch time: 0:22:17.611852,used: 8:05:59.064732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9867688, 'precision': 0.9881766, 'recall': 0.97766405, 'specificity': 0.97766405, 'f1': 0.98276687, 'auroc': 0.9975189, 'binary_precision': 0.9910464, 'binary_recall': 0.9584242, 'binary_specificity': 0.9969039, 'binary_f1_score': 0.97446233}
confusion matrix:
       0      1
0  42180    131
1    629  14500
---- Validation: 
scalar performance:
{'acc': 0.9638843, 'precision': 0.7070585, 'recall': 0.69706476, 'specificity': 0.69706476, 'f1': 0.70192325, 'auroc': 0.8977463, 'binary_precision': 0.43356642, 'binary_recall': 0.41196012, 'binary_specificity': 0.9821694, 'binary_f1_score': 0.4224872}
confusion matrix:
       0    1
0  17847  324
1    354  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9318801, 'precision': 0.6258098, 'recall': 0.7048266, 'specificity': 0.7048266, 'f1': 0.65359974, 'auroc': 0.8574864, 'binary_precision': 0.27407408, 'binary_recall': 0.45867768, 'binary_specificity': 0.9509755, 'binary_f1_score': 0.34312212}
confusion matrix:
      0    1
0  5703  294
1   131  111
early stop counter: 7
val acc:0.9638842940330505, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.944542407989502 / 0.9517551064491272
after epoch: 23,now: 2024-07-11 13:01:23.548526,epoch time: 0:22:09.836942,used: 8:28:08.901674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98668176, 'precision': 0.98701847, 'recall': 0.97856164, 'specificity': 0.97856164, 'f1': 0.9826901, 'auroc': 0.99726784, 'binary_precision': 0.98770964, 'binary_recall': 0.96140116, 'binary_specificity': 0.99572206, 'binary_f1_score': 0.9743779}
confusion matrix:
       0      1
0  42129    181
1    584  14546
---- Validation: 
scalar performance:
{'acc': 0.9620199, 'precision': 0.70219797, 'recall': 0.73545104, 'specificity': 0.73545104, 'f1': 0.71740043, 'auroc': 0.90165746, 'binary_precision': 0.4212766, 'binary_recall': 0.49335548, 'binary_specificity': 0.97754663, 'binary_f1_score': 0.45447588}
confusion matrix:
       0    1
0  17763  408
1    305  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92450714, 'precision': 0.6167541, 'recall': 0.71685326, 'specificity': 0.71685326, 'f1': 0.6478318, 'auroc': 0.8604027, 'binary_precision': 0.254818, 'binary_recall': 0.49173555, 'binary_specificity': 0.941971, 'binary_f1_score': 0.33568406}
confusion matrix:
      0    1
0  5649  348
1   123  119
early stop counter: 8
val acc:0.9620199203491211, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.944542407989502 / 0.9517551064491272
after epoch: 24,now: 2024-07-11 13:25:18.843526,epoch time: 0:23:55.295000,used: 8:52:04.196674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.987204, 'precision': 0.98814106, 'recall': 0.97880876, 'specificity': 0.97880876, 'f1': 0.98335373, 'auroc': 0.9978787, 'binary_precision': 0.99005854, 'binary_recall': 0.96106815, 'binary_specificity': 0.99654937, 'binary_f1_score': 0.97534794}
confusion matrix:
       0      1
0  42165    146
1    589  14540
---- Validation: 
scalar performance:
{'acc': 0.96463007, 'precision': 0.7148918, 'recall': 0.71351093, 'specificity': 0.71351093, 'f1': 0.7141989, 'auroc': 0.9017545, 'binary_precision': 0.44816053, 'binary_recall': 0.4451827, 'binary_specificity': 0.9818392, 'binary_f1_score': 0.44666666}
confusion matrix:
       0    1
0  17841  330
1    334  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9344446, 'precision': 0.63147694, 'recall': 0.7061606, 'specificity': 0.7061606, 'f1': 0.6586495, 'auroc': 0.86147964, 'binary_precision': 0.28534704, 'binary_recall': 0.45867768, 'binary_specificity': 0.9536435, 'binary_f1_score': 0.3518225}
confusion matrix:
      0    1
0  5719  278
1   131  111
early stop counter: 9
val acc:0.9646300673484802, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.944542407989502 / 0.9517551064491272
after epoch: 25,now: 2024-07-11 13:49:37.192071,epoch time: 0:24:18.348545,used: 9:16:22.545219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9862117, 'precision': 0.98840535, 'recall': 0.9760347, 'specificity': 0.9760347, 'f1': 0.9820082, 'auroc': 0.9975958, 'binary_precision': 0.99285024, 'binary_recall': 0.95452744, 'binary_specificity': 0.99754196, 'binary_f1_score': 0.9733118}
confusion matrix:
       0      1
0  42206    104
1    688  14442
---- Validation: 
scalar performance:
{'acc': 0.96590847, 'precision': 0.72074586, 'recall': 0.6836555, 'specificity': 0.6836555, 'f1': 0.7003108, 'auroc': 0.9010189, 'binary_precision': 0.4618474, 'binary_recall': 0.3820598, 'binary_specificity': 0.98525125, 'binary_f1_score': 0.4181818}
confusion matrix:
       0    1
0  17903  268
1    372  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93877226, 'precision': 0.6285445, 'recall': 0.6687569, 'specificity': 0.6687569, 'f1': 0.645316, 'auroc': 0.857816, 'binary_precision': 0.2826087, 'binary_recall': 0.37603307, 'binary_specificity': 0.96148074, 'binary_f1_score': 0.32269502}
confusion matrix:
      0    1
0  5766  231
1   151   91
early stop counter: 10
val acc:0.9659084677696228, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.944542407989502 / 0.9517551064491272
after epoch: 26,now: 2024-07-11 14:16:27.412010,epoch time: 0:26:50.219939,used: 9:43:12.765158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9859331, 'precision': 0.9869877, 'recall': 0.9766722, 'specificity': 0.9766722, 'f1': 0.9816817, 'auroc': 0.9972917, 'binary_precision': 0.9891386, 'binary_recall': 0.95710224, 'binary_specificity': 0.9962421, 'binary_f1_score': 0.9728567}
confusion matrix:
       0      1
0  42152    159
1    649  14480
---- Validation: 
scalar performance:
{'acc': 0.962233, 'precision': 0.70485735, 'recall': 0.74439466, 'specificity': 0.74439466, 'f1': 0.72266567, 'auroc': 0.90757406, 'binary_precision': 0.42600277, 'binary_recall': 0.5116279, 'binary_specificity': 0.9771614, 'binary_f1_score': 0.46490568}
confusion matrix:
       0    1
0  17756  415
1    294  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93059784, 'precision': 0.62810946, 'recall': 0.72002155, 'specificity': 0.72002155, 'f1': 0.65901065, 'auroc': 0.86724186, 'binary_precision': 0.2773893, 'binary_recall': 0.49173555, 'binary_specificity': 0.9483075, 'binary_f1_score': 0.3546945}
confusion matrix:
      0    1
0  5687  310
1   123  119
early stop counter: 11
val acc:0.9622330069541931, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.944542407989502 / 0.9517551064491272
after epoch: 27,now: 2024-07-11 14:41:46.311208,epoch time: 0:25:18.899198,used: 10:08:31.664356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9865773, 'precision': 0.98829216, 'recall': 0.97706693, 'specificity': 0.97706693, 'f1': 0.98250484, 'auroc': 0.9974983, 'binary_precision': 0.9917797, 'binary_recall': 0.95697004, 'binary_specificity': 0.99716383, 'binary_f1_score': 0.97406393}
confusion matrix:
       0      1
0  42191    120
1    651  14478
---- Validation: 
scalar performance:
{'acc': 0.9634582, 'precision': 0.7082535, 'recall': 0.72093606, 'specificity': 0.72093606, 'f1': 0.71438456, 'auroc': 0.904714, 'binary_precision': 0.434375, 'binary_recall': 0.46179402, 'binary_specificity': 0.98007816, 'binary_f1_score': 0.44766507}
confusion matrix:
       0    1
0  17809  362
1    324  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9342843, 'precision': 0.6291818, 'recall': 0.700129, 'specificity': 0.700129, 'f1': 0.6552273, 'auroc': 0.8608409, 'binary_precision': 0.28125, 'binary_recall': 0.446281, 'binary_specificity': 0.953977, 'binary_f1_score': 0.34504795}
confusion matrix:
      0    1
0  5721  276
1   134  108
early stop counter: 12
val acc:0.9634581804275513, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.944542407989502 / 0.9517551064491272
after epoch: 28,now: 2024-07-11 15:06:24.336158,epoch time: 0:24:38.024950,used: 10:33:09.689306,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98776114, 'precision': 0.98960656, 'recall': 0.97882724, 'specificity': 0.97882724, 'f1': 0.98405623, 'auroc': 0.9979507, 'binary_precision': 0.9933657, 'binary_recall': 0.9599471, 'binary_specificity': 0.9977074, 'binary_f1_score': 0.9763705}
confusion matrix:
       0      1
0  42213     97
1    606  14524
---- Validation: 
scalar performance:
{'acc': 0.9648964, 'precision': 0.71741945, 'recall': 0.7184668, 'specificity': 0.7184668, 'f1': 0.7179417, 'auroc': 0.9037852, 'binary_precision': 0.45289257, 'binary_recall': 0.4551495, 'binary_specificity': 0.98178416, 'binary_f1_score': 0.45401824}
confusion matrix:
       0    1
0  17840  331
1    328  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9350858, 'precision': 0.62840307, 'recall': 0.6926149, 'specificity': 0.6926149, 'f1': 0.65259045, 'auroc': 0.85926986, 'binary_precision': 0.28032345, 'binary_recall': 0.42975205, 'binary_specificity': 0.9554777, 'binary_f1_score': 0.33931485}
confusion matrix:
      0    1
0  5730  267
1   138  104
early stop counter: 13
val acc:0.9648963809013367, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.944542407989502 / 0.9517551064491272
after epoch: 29,now: 2024-07-11 15:30:16.426502,epoch time: 0:23:52.090344,used: 10:57:01.779650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98756963, 'precision': 0.98747814, 'recall': 0.9803945, 'specificity': 0.9803945, 'f1': 0.9838662, 'auroc': 0.9978609, 'binary_precision': 0.98728955, 'binary_recall': 0.9652323, 'binary_specificity': 0.9955567, 'binary_f1_score': 0.9761364}
confusion matrix:
       0      1
0  42123    188
1    526  14603
---- Validation: 
scalar performance:
{'acc': 0.9645768, 'precision': 0.71659034, 'recall': 0.72874135, 'specificity': 0.72874135, 'f1': 0.7224804, 'auroc': 0.90788656, 'binary_precision': 0.45054945, 'binary_recall': 0.47674417, 'binary_specificity': 0.9807385, 'binary_f1_score': 0.4632768}
confusion matrix:
       0    1
0  17821  350
1    315  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93877226, 'precision': 0.6409271, 'recall': 0.7044462, 'specificity': 0.7044462, 'f1': 0.66558653, 'auroc': 0.8645197, 'binary_precision': 0.3044693, 'binary_recall': 0.45041323, 'binary_specificity': 0.9584792, 'binary_f1_score': 0.36333334}
confusion matrix:
      0    1
0  5748  249
1   133  109
early stop counter: 14
val acc:0.964576780796051, best validation acc: 0.9671869277954102, corresponding to test acc:                         0.944542407989502 / 0.9517551064491272
after epoch: 30,now: 2024-07-11 15:53:30.281284,epoch time: 0:23:13.854782,used: 11:20:15.634432,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_33_14_seed_2_21806619
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:20:15.634432 at 2024-07-11 15:53:30.281284
persisted model performance metric: 

scalar performance:
{'acc': 0.9445424, 'precision': 0.6568389, 'recall': 0.7034823, 'specificity': 0.7034823, 'f1': 0.6765556, 'auroc': 0.86902183, 'binary_precision': 0.336478, 'binary_recall': 0.44214877, 'binary_specificity': 0.96481574, 'binary_f1_score': 0.38214284}
confusion matrix:
      0    1
0  5786  211
1   135  107
oracle model performance metric: 

scalar performance:
{'acc': 0.9517551, 'precision': 0.5969791, 'recall': 0.54464936, 'specificity': 0.54464936, 'f1': 0.55881476, 'auroc': 0.7960309, 'binary_precision': 0.2293578, 'binary_recall': 0.10330579, 'binary_specificity': 0.98599297, 'binary_f1_score': 0.14245014}
confusion matrix:
      0   1
0  5913  84
1   217  25
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |  17485 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |  17485 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   7827 MiB |   3528 TiB |   3528 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   3483 TiB |   3483 TiB |
|       from small pool |  16481 KiB |     36 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8530 MiB |  25070 MiB |  16560 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  25000 MiB |  16528 MiB |
|       from small pool |     38 MiB |     44 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38824 KiB | 732464 KiB |   1915 TiB |   1915 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1870 TiB |   1870 TiB |
|       from small pool |   7091 KiB |  23272 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7675    |  583984 K  |  583981 K  |
|       from large pool |      79    |     762    |  330548 K  |  330548 K  |
|       from small pool |    2887    |    7594    |  253436 K  |  253433 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7675    |  583984 K  |  583981 K  |
|       from large pool |      79    |     762    |  330548 K  |  330548 K  |
|       from small pool |    2887    |    7594    |  253436 K  |  253433 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     371    |    1060    |     693    |
|       from large pool |     348    |     349    |    1025    |     677    |
|       from small pool |      19    |      22    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3612    |  343658 K  |  343658 K  |
|       from large pool |      11    |     352    |  236042 K  |  236042 K  |
|       from small pool |      23    |    3602    |  107616 K  |  107616 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |      0 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |      0 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   3528 TiB |   3528 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   3483 TiB |   3483 TiB |
|       from small pool |      0 KiB |     36 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  25070 MiB |  24840 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25000 MiB |  24794 MiB |
|       from small pool |  24576 KiB |     44 MiB |     70 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1915 TiB |   1915 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1870 TiB |   1870 TiB |
|       from small pool |      0 KiB |  23272 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7675    |  583984 K  |  583984 K  |
|       from large pool |       2    |     762    |  330548 K  |  330548 K  |
|       from small pool |       0    |    7594    |  253436 K  |  253436 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7675    |  583984 K  |  583984 K  |
|       from large pool |       2    |     762    |  330548 K  |  330548 K  |
|       from small pool |       0    |    7594    |  253436 K  |  253436 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |    1060    |    1038    |
|       from large pool |      10    |     349    |    1025    |    1015    |
|       from small pool |      12    |      22    |      35    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |  343660 K  |  343660 K  |
|       from large pool |       3    |     352    |  236042 K  |  236042 K  |
|       from small pool |       0    |    3602    |  107617 K  |  107617 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Jul 11 16:09:27 2024]
Finished job 0.
1 of 1 steps (100%) done
