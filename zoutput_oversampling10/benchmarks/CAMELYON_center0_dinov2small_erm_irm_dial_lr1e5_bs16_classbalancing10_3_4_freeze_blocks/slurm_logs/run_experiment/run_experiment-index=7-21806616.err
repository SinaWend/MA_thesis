Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 10 04:11:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616

 Experiment start at: 2024-07-10 04:18:27.579537
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96267533, 'precision': 0.97221243, 'recall': 0.9306382, 'specificity': 0.9306382, 'f1': 0.949088, 'auroc': 0.986356, 'binary_precision': 0.9895769, 'binary_recall': 0.86444247, 'binary_specificity': 0.99683386, 'binary_f1_score': 0.9227868}
confusion matrix:
       0      1
0  42189    134
1   1995  12722
---- Validation: 
scalar performance:
{'acc': 0.96439976, 'precision': 0.72091836, 'recall': 0.6365438, 'specificity': 0.6365438, 'f1': 0.66765946, 'auroc': 0.8938445, 'binary_precision': 0.46683672, 'binary_recall': 0.28460342, 'binary_specificity': 0.9884842, 'binary_f1_score': 0.35362318}
confusion matrix:
       0    1
0  17940  209
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.73377895, 'recall': 0.6136047, 'specificity': 0.6136047, 'f1': 0.6502814, 'auroc': 0.89480436, 'binary_precision': 0.5, 'binary_recall': 0.23754789, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.32207793}
confusion matrix:
      0   1
0  5935  62
1   199  62
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 04:40:50.745966,epoch time: 0:22:23.166429,used: 0:22:23.166429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97030157, 'precision': 0.9769466, 'recall': 0.9455757, 'specificity': 0.9455757, 'f1': 0.95993346, 'auroc': 0.9914535, 'binary_precision': 0.98940325, 'binary_recall': 0.894483, 'binary_specificity': 0.9966684, 'binary_f1_score': 0.9395518}
confusion matrix:
       0      1
0  42181    141
1   1553  13165
---- Validation: 
scalar performance:
{'acc': 0.96062154, 'precision': 0.70470035, 'recall': 0.71634376, 'specificity': 0.71634376, 'f1': 0.71033967, 'auroc': 0.9105586, 'binary_precision': 0.4287812, 'binary_recall': 0.4541213, 'binary_specificity': 0.9785663, 'binary_f1_score': 0.4410876}
confusion matrix:
       0    1
0  17760  389
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7412975, 'recall': 0.7694365, 'specificity': 0.7694365, 'f1': 0.75447524, 'auroc': 0.91002464, 'binary_precision': 0.5017065, 'binary_recall': 0.5632184, 'binary_specificity': 0.9756545, 'binary_f1_score': 0.5306859}
confusion matrix:
      0    1
0  5851  146
1   114  147
new oracle model saved
early stop counter: 1
val acc:0.9606215357780457, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9584531784057617
after epoch: 2,now: 2024-07-10 05:02:35.669468,epoch time: 0:21:44.923502,used: 0:44:08.089931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9784362, 'precision': 0.98170924, 'recall': 0.96186805, 'specificity': 0.96186805, 'f1': 0.9712577, 'auroc': 0.99370617, 'binary_precision': 0.9880582, 'binary_recall': 0.9276347, 'binary_specificity': 0.99610144, 'binary_f1_score': 0.9568935}
confusion matrix:
       0      1
0  42158    165
1   1065  13652
---- Validation: 
scalar performance:
{'acc': 0.9557791, 'precision': 0.68961406, 'recall': 0.7610903, 'specificity': 0.7610903, 'f1': 0.71884197, 'auroc': 0.9172046, 'binary_precision': 0.39532295, 'binary_recall': 0.5520995, 'binary_specificity': 0.970081, 'binary_f1_score': 0.46073976}
confusion matrix:
       0    1
0  17606  543
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9504634, 'precision': 0.7128944, 'recall': 0.82390237, 'specificity': 0.82390237, 'f1': 0.7548816, 'auroc': 0.9125804, 'binary_precision': 0.43980345, 'binary_recall': 0.68582374, 'binary_specificity': 0.961981, 'binary_f1_score': 0.53592813}
confusion matrix:
      0    1
0  5769  228
1    82  179
early stop counter: 2
val acc:0.9557790756225586, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9584531784057617
after epoch: 3,now: 2024-07-10 05:24:21.245167,epoch time: 0:21:45.575699,used: 1:05:53.665630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9798913, 'precision': 0.9827794, 'recall': 0.9645971, 'specificity': 0.9645971, 'f1': 0.9732427, 'auroc': 0.9947175, 'binary_precision': 0.98840976, 'binary_recall': 0.9329981, 'binary_specificity': 0.99619603, 'binary_f1_score': 0.9599049}
confusion matrix:
       0      1
0  42163    161
1    986  13730
---- Validation: 
scalar performance:
{'acc': 0.9541294, 'precision': 0.68903434, 'recall': 0.7917385, 'specificity': 0.7917385, 'f1': 0.7277381, 'auroc': 0.92333186, 'binary_precision': 0.39190522, 'binary_recall': 0.61741835, 'binary_specificity': 0.96605873, 'binary_f1_score': 0.47946855}
confusion matrix:
       0    1
0  17533  616
1    246  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9509428, 'precision': 0.71606684, 'recall': 0.8369788, 'specificity': 0.8369788, 'f1': 0.7609644, 'auroc': 0.91550374, 'binary_precision': 0.4449761, 'binary_recall': 0.7126437, 'binary_specificity': 0.96131396, 'binary_f1_score': 0.54786456}
confusion matrix:
      0    1
0  5765  232
1    75  186
early stop counter: 3
val acc:0.9541293978691101, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9584531784057617
after epoch: 4,now: 2024-07-10 05:46:02.688239,epoch time: 0:21:41.443072,used: 1:27:35.108702,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98183733, 'precision': 0.98413306, 'recall': 0.9683261, 'specificity': 0.9683261, 'f1': 0.97589314, 'auroc': 0.99547106, 'binary_precision': 0.98864204, 'binary_recall': 0.94040906, 'binary_specificity': 0.9962432, 'binary_f1_score': 0.9639225}
confusion matrix:
       0      1
0  42164    159
1    877  13840
---- Validation: 
scalar performance:
{'acc': 0.9526394, 'precision': 0.6862296, 'recall': 0.80446815, 'specificity': 0.80446815, 'f1': 0.7288711, 'auroc': 0.92541134, 'binary_precision': 0.38532963, 'binary_recall': 0.64541215, 'binary_specificity': 0.96352416, 'binary_f1_score': 0.48255816}
confusion matrix:
       0    1
0  17487  662
1    228  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495046, 'precision': 0.71206456, 'recall': 0.84172547, 'specificity': 0.84172547, 'f1': 0.7589693, 'auroc': 0.91577935, 'binary_precision': 0.4364896, 'binary_recall': 0.7241379, 'binary_specificity': 0.959313, 'binary_f1_score': 0.54466856}
confusion matrix:
      0    1
0  5753  244
1    72  189
early stop counter: 4
val acc:0.9526394009590149, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9584531784057617
after epoch: 5,now: 2024-07-10 06:07:34.494038,epoch time: 0:21:31.805799,used: 1:49:06.914501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9839937, 'precision': 0.9834139, 'recall': 0.9746073, 'specificity': 0.9746073, 'f1': 0.9789051, 'auroc': 0.9964076, 'binary_precision': 0.98225015, 'binary_recall': 0.95521575, 'binary_specificity': 0.9939988, 'binary_f1_score': 0.9685443}
confusion matrix:
       0      1
0  42071    254
1    659  14056
---- Validation: 
scalar performance:
{'acc': 0.9452959, 'precision': 0.67030334, 'recall': 0.83066845, 'specificity': 0.83066845, 'f1': 0.72035855, 'auroc': 0.92604274, 'binary_precision': 0.35135135, 'binary_recall': 0.7076205, 'binary_specificity': 0.95371646, 'binary_f1_score': 0.4695562}
confusion matrix:
       0    1
0  17309  840
1    188  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9387983, 'precision': 0.6859436, 'recall': 0.8544627, 'specificity': 0.8544627, 'f1': 0.73848283, 'auroc': 0.9173597, 'binary_precision': 0.3826923, 'binary_recall': 0.7624521, 'binary_specificity': 0.94647324, 'binary_f1_score': 0.509603}
confusion matrix:
      0    1
0  5676  321
1    62  199
early stop counter: 5
val acc:0.9452958703041077, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9584531784057617
after epoch: 6,now: 2024-07-10 06:29:36.585972,epoch time: 0:22:02.091934,used: 2:11:09.006435,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98441446, 'precision': 0.9866928, 'recall': 0.9725482, 'specificity': 0.9725482, 'f1': 0.97935236, 'auroc': 0.99664396, 'binary_precision': 0.9911919, 'binary_recall': 0.94802636, 'binary_specificity': 0.99707, 'binary_f1_score': 0.9691287}
confusion matrix:
       0      1
0  42197    124
1    765  13954
---- Validation: 
scalar performance:
{'acc': 0.95285225, 'precision': 0.6902831, 'recall': 0.82407975, 'specificity': 0.82407975, 'f1': 0.7370656, 'auroc': 0.9255408, 'binary_precision': 0.392, 'binary_recall': 0.6858476, 'binary_specificity': 0.962312, 'binary_f1_score': 0.49886873}
confusion matrix:
       0    1
0  17465  684
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9511026, 'precision': 0.71617347, 'recall': 0.8333975, 'specificity': 0.8333975, 'f1': 0.7600769, 'auroc': 0.9098747, 'binary_precision': 0.44552058, 'binary_recall': 0.70498085, 'binary_specificity': 0.9618142, 'binary_f1_score': 0.54599404}
confusion matrix:
      0    1
0  5768  229
1    77  184
early stop counter: 6
val acc:0.9528522491455078, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9584531784057617
after epoch: 7,now: 2024-07-10 06:52:06.740551,epoch time: 0:22:30.154579,used: 2:33:39.161014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9846599, 'precision': 0.9876906, 'recall': 0.9722394, 'specificity': 0.9722394, 'f1': 0.97964656, 'auroc': 0.9964201, 'binary_precision': 0.99365056, 'binary_recall': 0.9465815, 'binary_specificity': 0.99789727, 'binary_f1_score': 0.96954507}
confusion matrix:
       0      1
0  42237     89
1    786  13928
---- Validation: 
scalar performance:
{'acc': 0.9567369, 'precision': 0.6993681, 'recall': 0.79533863, 'specificity': 0.79533863, 'f1': 0.7366843, 'auroc': 0.92387843, 'binary_precision': 0.41237113, 'binary_recall': 0.62208396, 'binary_specificity': 0.9685933, 'binary_f1_score': 0.49597028}
confusion matrix:
       0    1
0  17579  570
1    243  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.74928796, 'recall': 0.8195765, 'specificity': 0.8195765, 'f1': 0.779426, 'auroc': 0.90943754, 'binary_precision': 0.5132743, 'binary_recall': 0.6666667, 'binary_specificity': 0.97248626, 'binary_f1_score': 0.58}
confusion matrix:
      0    1
0  5832  165
1    87  174
new oracle model saved
early stop counter: 7
val acc:0.9567369222640991, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9597315192222595
after epoch: 8,now: 2024-07-10 07:14:16.071874,epoch time: 0:22:09.331323,used: 2:55:48.492337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9854839, 'precision': 0.9882382, 'recall': 0.9738449, 'specificity': 0.9738449, 'f1': 0.9807651, 'auroc': 0.9972056, 'binary_precision': 0.99367404, 'binary_recall': 0.9497928, 'binary_specificity': 0.997897, 'binary_f1_score': 0.971238}
confusion matrix:
       0      1
0  42232     89
1    739  13980
---- Validation: 
scalar performance:
{'acc': 0.9548212, 'precision': 0.6932476, 'recall': 0.8018474, 'specificity': 0.8018474, 'f1': 0.73383653, 'auroc': 0.9236146, 'binary_precision': 0.39961013, 'binary_recall': 0.63763607, 'binary_specificity': 0.96605873, 'binary_f1_score': 0.49131215}
confusion matrix:
       0    1
0  17533  616
1    233  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.751399, 'recall': 0.8070003, 'specificity': 0.8070003, 'f1': 0.7760161, 'auroc': 0.9055457, 'binary_precision': 0.51863354, 'binary_recall': 0.63984674, 'binary_specificity': 0.97415376, 'binary_f1_score': 0.5728988}
confusion matrix:
      0    1
0  5842  155
1    94  167
new oracle model saved
early stop counter: 8
val acc:0.9548212289810181, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.960210919380188
after epoch: 9,now: 2024-07-10 07:36:07.700792,epoch time: 0:21:51.628918,used: 3:17:40.121255,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.987202, 'precision': 0.9881737, 'recall': 0.97832334, 'specificity': 0.97832334, 'f1': 0.9831183, 'auroc': 0.9974874, 'binary_precision': 0.99011844, 'binary_recall': 0.9599783, 'binary_specificity': 0.99666846, 'binary_f1_score': 0.9748154}
confusion matrix:
       0      1
0  42182    141
1    589  14128
---- Validation: 
scalar performance:
{'acc': 0.9477437, 'precision': 0.6765137, 'recall': 0.83043563, 'specificity': 0.83043563, 'f1': 0.7261814, 'auroc': 0.9255708, 'binary_precision': 0.36385542, 'binary_recall': 0.7045101, 'binary_specificity': 0.95636123, 'binary_f1_score': 0.47987285}
confusion matrix:
       0    1
0  17357  792
1    190  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95238096, 'precision': 0.72058266, 'recall': 0.83406454, 'specificity': 0.83406454, 'f1': 0.76370245, 'auroc': 0.90988714, 'binary_precision': 0.454321, 'binary_recall': 0.70498085, 'binary_specificity': 0.96314824, 'binary_f1_score': 0.5525526}
confusion matrix:
      0    1
0  5776  221
1    77  184
early stop counter: 9
val acc:0.9477437138557434, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.960210919380188
after epoch: 10,now: 2024-07-10 07:58:02.671196,epoch time: 0:21:54.970404,used: 3:39:35.091659,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98769283, 'precision': 0.9874195, 'recall': 0.9803372, 'specificity': 0.9803372, 'f1': 0.98381066, 'auroc': 0.9979658, 'binary_precision': 0.9868677, 'binary_recall': 0.96514, 'binary_specificity': 0.9955344, 'binary_f1_score': 0.9758829}
confusion matrix:
       0      1
0  42135    189
1    513  14203
---- Validation: 
scalar performance:
{'acc': 0.9508833, 'precision': 0.6832354, 'recall': 0.8185601, 'specificity': 0.8185601, 'f1': 0.7297158, 'auroc': 0.92613536, 'binary_precision': 0.37826088, 'binary_recall': 0.67651635, 'binary_specificity': 0.9606039, 'binary_f1_score': 0.48522028}
confusion matrix:
       0    1
0  17434  715
1    208  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7470896, 'recall': 0.82115865, 'specificity': 0.82115865, 'f1': 0.77855176, 'auroc': 0.9074817, 'binary_precision': 0.50872093, 'binary_recall': 0.6704981, 'binary_specificity': 0.9718192, 'binary_f1_score': 0.5785124}
confusion matrix:
      0    1
0  5828  169
1    86  175
early stop counter: 10
val acc:0.9508833289146423, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.960210919380188
after epoch: 11,now: 2024-07-10 08:20:02.317899,epoch time: 0:21:59.646703,used: 4:01:34.738362,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.987202, 'precision': 0.9897376, 'recall': 0.9768386, 'specificity': 0.9768386, 'f1': 0.9830666, 'auroc': 0.9979203, 'binary_precision': 0.99476475, 'binary_recall': 0.9554257, 'binary_specificity': 0.99825156, 'binary_f1_score': 0.9746984}
confusion matrix:
       0      1
0  42249     74
1    656  14061
---- Validation: 
scalar performance:
{'acc': 0.9615794, 'precision': 0.7191354, 'recall': 0.78284454, 'specificity': 0.78284454, 'f1': 0.74641085, 'auroc': 0.92343324, 'binary_precision': 0.45292014, 'binary_recall': 0.59097975, 'binary_specificity': 0.97470933, 'binary_f1_score': 0.5128205}
confusion matrix:
       0    1
0  17690  459
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.84065634, 'recall': 0.7726085, 'specificity': 0.7726085, 'f1': 0.80244195, 'auroc': 0.9026413, 'binary_precision': 0.7004831, 'binary_recall': 0.5555556, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.6196582}
confusion matrix:
      0    1
0  5935   62
1   116  145
new oracle model saved
early stop counter: 11
val acc:0.9615793824195862, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9715564250946045
after epoch: 12,now: 2024-07-10 08:43:06.919441,epoch time: 0:23:04.601542,used: 4:24:39.339904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98848176, 'precision': 0.9898677, 'recall': 0.98000443, 'specificity': 0.98000443, 'f1': 0.9848061, 'auroc': 0.9978608, 'binary_precision': 0.9926414, 'binary_recall': 0.9624898, 'binary_specificity': 0.99751914, 'binary_f1_score': 0.97733307}
confusion matrix:
       0      1
0  42219    105
1    552  14164
---- Validation: 
scalar performance:
{'acc': 0.959983, 'precision': 0.71237767, 'recall': 0.79026866, 'specificity': 0.79026866, 'f1': 0.7444593, 'auroc': 0.92176175, 'binary_precision': 0.43883276, 'binary_recall': 0.60808706, 'binary_specificity': 0.97245026, 'binary_f1_score': 0.5097784}
confusion matrix:
       0    1
0  17649  500
1    252  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9713966, 'precision': 0.8333132, 'recall': 0.7853515, 'specificity': 0.7853515, 'f1': 0.80726194, 'auroc': 0.9059998, 'binary_precision': 0.6846847, 'binary_recall': 0.58237547, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.6293996}
confusion matrix:
      0    1
0  5927   70
1   109  152
early stop counter: 12
val acc:0.9599829912185669, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9715564250946045
after epoch: 13,now: 2024-07-10 09:05:08.225357,epoch time: 0:22:01.305916,used: 4:46:40.645820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98863953, 'precision': 0.98829246, 'recall': 0.98194826, 'specificity': 0.98194826, 'f1': 0.9850662, 'auroc': 0.9978092, 'binary_precision': 0.98759013, 'binary_recall': 0.9681256, 'binary_specificity': 0.99577093, 'binary_f1_score': 0.97776103}
confusion matrix:
       0      1
0  42147    179
1    469  14245
---- Validation: 
scalar performance:
{'acc': 0.9517348, 'precision': 0.68616915, 'recall': 0.820501, 'specificity': 0.820501, 'f1': 0.73270124, 'auroc': 0.92396516, 'binary_precision': 0.38400704, 'binary_recall': 0.67962676, 'binary_specificity': 0.9613753, 'binary_f1_score': 0.49073556}
confusion matrix:
       0    1
0  17448  701
1    206  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.7701701, 'recall': 0.79775715, 'specificity': 0.79775715, 'f1': 0.78320026, 'auroc': 0.9034792, 'binary_precision': 0.55709344, 'binary_recall': 0.61685824, 'binary_specificity': 0.978656, 'binary_f1_score': 0.5854546}
confusion matrix:
      0    1
0  5869  128
1   100  161
early stop counter: 13
val acc:0.9517347812652588, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9715564250946045
after epoch: 14,now: 2024-07-10 09:27:16.055871,epoch time: 0:22:07.830514,used: 5:08:48.476334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98895514, 'precision': 0.9911171, 'recall': 0.9800366, 'specificity': 0.9800366, 'f1': 0.9854137, 'auroc': 0.9979799, 'binary_precision': 0.995428, 'binary_recall': 0.961609, 'binary_specificity': 0.99846417, 'binary_f1_score': 0.97822636}
confusion matrix:
       0      1
0  42258     65
1    565  14152
---- Validation: 
scalar performance:
{'acc': 0.961473, 'precision': 0.71808535, 'recall': 0.77828914, 'specificity': 0.77828914, 'f1': 0.7440517, 'auroc': 0.9186052, 'binary_precision': 0.45114595, 'binary_recall': 0.5816485, 'binary_specificity': 0.97492975, 'binary_f1_score': 0.5081522}
confusion matrix:
       0    1
0  17694  455
1    269  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9717162, 'precision': 0.85485137, 'recall': 0.75070393, 'specificity': 0.75070393, 'f1': 0.7928953, 'auroc': 0.89622545, 'binary_precision': 0.7307692, 'binary_recall': 0.5095785, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.60045147}
confusion matrix:
      0    1
0  5948   49
1   128  133
new oracle model saved
early stop counter: 14
val acc:0.9614729881286621, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9717162251472473
after epoch: 15,now: 2024-07-10 09:49:41.141508,epoch time: 0:22:25.085637,used: 5:31:13.561971,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98941094, 'precision': 0.99017334, 'recall': 0.9821166, 'specificity': 0.9821166, 'f1': 0.9860581, 'auroc': 0.9983029, 'binary_precision': 0.9917079, 'binary_recall': 0.9670449, 'binary_specificity': 0.99718827, 'binary_f1_score': 0.9792211}
confusion matrix:
       0      1
0  42204    119
1    485  14232
---- Validation: 
scalar performance:
{'acc': 0.959238, 'precision': 0.705753, 'recall': 0.7673813, 'specificity': 0.7673813, 'f1': 0.7319969, 'auroc': 0.91977227, 'binary_precision': 0.42721894, 'binary_recall': 0.5614308, 'binary_specificity': 0.97333187, 'binary_f1_score': 0.48521507}
confusion matrix:
       0    1
0  17665  484
1    282  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.82962465, 'recall': 0.7514523, 'specificity': 0.7514523, 'f1': 0.7846978, 'auroc': 0.8934239, 'binary_precision': 0.680203, 'binary_recall': 0.51341, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.5851528}
confusion matrix:
      0    1
0  5934   63
1   127  134
early stop counter: 15
val acc:0.9592379927635193, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9717162251472473
after epoch: 16,now: 2024-07-10 10:12:01.377754,epoch time: 0:22:20.236246,used: 5:53:33.798217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9894986, 'precision': 0.9919966, 'recall': 0.98059845, 'specificity': 0.98059845, 'f1': 0.98612535, 'auroc': 0.9986024, 'binary_precision': 0.996972, 'binary_recall': 0.96221286, 'binary_specificity': 0.9989841, 'binary_f1_score': 0.9792841}
confusion matrix:
       0      1
0  42283     43
1    556  14158
---- Validation: 
scalar performance:
{'acc': 0.9638676, 'precision': 0.7284844, 'recall': 0.74727654, 'specificity': 0.74727654, 'f1': 0.7374634, 'auroc': 0.9200121, 'binary_precision': 0.47421202, 'binary_recall': 0.5147745, 'binary_specificity': 0.9797785, 'binary_f1_score': 0.49366146}
confusion matrix:
       0    1
0  17782  367
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.8398143, 'recall': 0.69373286, 'specificity': 0.69373286, 'f1': 0.74477166, 'auroc': 0.8870796, 'binary_precision': 0.70547944, 'binary_recall': 0.394636, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.50614256}
confusion matrix:
      0    1
0  5954   43
1   158  103
early stop counter: 16
val acc:0.9638676047325134, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9717162251472473
after epoch: 17,now: 2024-07-10 10:38:35.629866,epoch time: 0:26:34.252112,used: 6:20:08.050329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99056804, 'precision': 0.99148065, 'recall': 0.98385024, 'specificity': 0.98385024, 'f1': 0.98758775, 'auroc': 0.9979485, 'binary_precision': 0.99332035, 'binary_recall': 0.96996874, 'binary_specificity': 0.9977317, 'binary_f1_score': 0.9815057}
confusion matrix:
       0      1
0  42226     96
1    442  14276
---- Validation: 
scalar performance:
{'acc': 0.9589187, 'precision': 0.7077619, 'recall': 0.7912178, 'specificity': 0.7912178, 'f1': 0.74153197, 'auroc': 0.9228225, 'binary_precision': 0.4295082, 'binary_recall': 0.61119753, 'binary_specificity': 0.9712381, 'binary_f1_score': 0.504493}
confusion matrix:
       0    1
0  17627  522
1    250  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.8251767, 'recall': 0.74562186, 'specificity': 0.74562186, 'f1': 0.7792376, 'auroc': 0.8923381, 'binary_precision': 0.6717949, 'binary_recall': 0.5019157, 'binary_specificity': 0.989328, 'binary_f1_score': 0.5745614}
confusion matrix:
      0    1
0  5933   64
1   130  131
early stop counter: 17
val acc:0.9589186906814575, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9717162251472473
after epoch: 18,now: 2024-07-10 11:04:54.790791,epoch time: 0:26:19.160925,used: 6:46:27.211254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9901122, 'precision': 0.9916571, 'recall': 0.9824994, 'specificity': 0.9824994, 'f1': 0.9869666, 'auroc': 0.9980718, 'binary_precision': 0.994756, 'binary_recall': 0.9667709, 'binary_specificity': 0.99822795, 'binary_f1_score': 0.98056376}
confusion matrix:
       0      1
0  42249     75
1    489  14227
---- Validation: 
scalar performance:
{'acc': 0.9626437, 'precision': 0.72220725, 'recall': 0.75864375, 'specificity': 0.75864375, 'f1': 0.73886794, 'auroc': 0.9174558, 'binary_precision': 0.4608234, 'binary_recall': 0.53965783, 'binary_specificity': 0.9776296, 'binary_f1_score': 0.49713466}
confusion matrix:
       0    1
0  17743  406
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.8363916, 'recall': 0.7198858, 'specificity': 0.7198858, 'f1': 0.7646607, 'auroc': 0.88086855, 'binary_precision': 0.6964286, 'binary_recall': 0.44827586, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.54545456}
confusion matrix:
      0    1
0  5946   51
1   144  117
early stop counter: 18
val acc:0.9626436829566956, best validation acc: 0.9643997550010681, corresponding to test acc:                         0.9582933783531189 / 0.9717162251472473
after epoch: 19,now: 2024-07-10 11:29:18.837885,epoch time: 0:24:24.047094,used: 7:10:51.258348,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99065566, 'precision': 0.9922527, 'recall': 0.9833321, 'specificity': 0.9833321, 'f1': 0.98768663, 'auroc': 0.9986154, 'binary_precision': 0.995459, 'binary_recall': 0.9682, 'binary_specificity': 0.99846417, 'binary_f1_score': 0.98164034}
confusion matrix:
       0      1
0  42258     65
1    468  14249
---- Validation: 
scalar performance:
{'acc': 0.9653044, 'precision': 0.7382205, 'recall': 0.7517706, 'specificity': 0.7517706, 'f1': 0.7447858, 'auroc': 0.9199987, 'binary_precision': 0.49339208, 'binary_recall': 0.5225505, 'binary_specificity': 0.9809907, 'binary_f1_score': 0.50755286}
confusion matrix:
       0    1
0  17804  345
1    307  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9699584, 'precision': 0.86342955, 'recall': 0.7058108, 'specificity': 0.7058108, 'f1': 0.7607107, 'auroc': 0.8827121, 'binary_precision': 0.7517241, 'binary_recall': 0.41762453, 'binary_specificity': 0.993997, 'binary_f1_score': 0.5369458}
confusion matrix:
      0    1
0  5961   36
1   152  109
better model found
persisted
after epoch: 20,now: 2024-07-10 11:51:22.773326,epoch time: 0:22:03.935441,used: 7:32:55.193789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9903401, 'precision': 0.99283767, 'recall': 0.9819647, 'specificity': 0.9819647, 'f1': 0.9872447, 'auroc': 0.99855864, 'binary_precision': 0.9978209, 'binary_recall': 0.9646619, 'binary_specificity': 0.9992676, 'binary_f1_score': 0.98096126}
confusion matrix:
       0      1
0  42294     31
1    520  14195
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.75127774, 'recall': 0.74070644, 'specificity': 0.74070644, 'f1': 0.7458657, 'auroc': 0.9207486, 'binary_precision': 0.5203252, 'binary_recall': 0.4976672, 'binary_specificity': 0.98374563, 'binary_f1_score': 0.50874406}
confusion matrix:
       0    1
0  17854  295
1    323  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.8971522, 'recall': 0.66699827, 'specificity': 0.66699827, 'f1': 0.7312279, 'auroc': 0.88117146, 'binary_precision': 0.8224299, 'binary_recall': 0.33716476, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.47826084}
confusion matrix:
      0   1
0  5978  19
1   173  88
better model found
persisted
after epoch: 21,now: 2024-07-10 12:13:17.375638,epoch time: 0:21:54.602312,used: 7:54:49.796101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99225104, 'precision': 0.9931626, 'recall': 0.9865773, 'specificity': 0.9865773, 'f1': 0.98981225, 'auroc': 0.99874824, 'binary_precision': 0.9950059, 'binary_recall': 0.9748556, 'binary_specificity': 0.9982989, 'binary_f1_score': 0.9848277}
confusion matrix:
       0      1
0  42253     72
1    370  14345
---- Validation: 
scalar performance:
{'acc': 0.96216476, 'precision': 0.7215279, 'recall': 0.7771472, 'specificity': 0.7771472, 'f1': 0.7458304, 'auroc': 0.92135024, 'binary_precision': 0.45812806, 'binary_recall': 0.5785381, 'binary_specificity': 0.9757562, 'binary_f1_score': 0.5113402}
confusion matrix:
       0    1
0  17709  440
1    271  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697987, 'precision': 0.8455665, 'recall': 0.72588307, 'specificity': 0.72588307, 'f1': 0.77190197, 'auroc': 0.8832703, 'binary_precision': 0.71428573, 'binary_recall': 0.4597701, 'binary_specificity': 0.991996, 'binary_f1_score': 0.55944055}
confusion matrix:
      0    1
0  5949   48
1   141  120
early stop counter: 1
val acc:0.9621647596359253, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9693192839622498 / 0.9717162251472473
after epoch: 22,now: 2024-07-10 12:35:18.286638,epoch time: 0:22:00.911000,used: 8:16:50.707101,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9908135, 'precision': 0.9920125, 'recall': 0.9839703, 'specificity': 0.9839703, 'f1': 0.98790526, 'auroc': 0.9986234, 'binary_precision': 0.99442625, 'binary_recall': 0.9698308, 'binary_specificity': 0.99810976, 'binary_f1_score': 0.98197454}
confusion matrix:
       0      1
0  42243     80
1    444  14273
---- Validation: 
scalar performance:
{'acc': 0.96365476, 'precision': 0.72923946, 'recall': 0.7719181, 'specificity': 0.7719181, 'f1': 0.7485323, 'auroc': 0.92290384, 'binary_precision': 0.47395834, 'binary_recall': 0.5660964, 'binary_specificity': 0.9777398, 'binary_f1_score': 0.51594615}
confusion matrix:
       0    1
0  17745  404
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.86708134, 'recall': 0.71347356, 'specificity': 0.71347356, 'f1': 0.7680102, 'auroc': 0.88319993, 'binary_precision': 0.75838923, 'binary_recall': 0.4329502, 'binary_specificity': 0.993997, 'binary_f1_score': 0.55121946}
confusion matrix:
      0    1
0  5961   36
1   148  113
early stop counter: 2
val acc:0.9636547565460205, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9693192839622498 / 0.9717162251472473
after epoch: 23,now: 2024-07-10 12:57:14.256989,epoch time: 0:21:55.970351,used: 8:38:46.677452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9912693, 'precision': 0.99310374, 'recall': 0.98410016, 'specificity': 0.98410016, 'f1': 0.9884944, 'auroc': 0.99854994, 'binary_precision': 0.9967857, 'binary_recall': 0.9692872, 'binary_specificity': 0.9989131, 'binary_f1_score': 0.9828441}
confusion matrix:
       0      1
0  42277     46
1    452  14265
---- Validation: 
scalar performance:
{'acc': 0.96546406, 'precision': 0.73867655, 'recall': 0.73760223, 'specificity': 0.73760223, 'f1': 0.738138, 'auroc': 0.91788864, 'binary_precision': 0.4953125, 'binary_recall': 0.49300155, 'binary_specificity': 0.9822029, 'binary_f1_score': 0.49415436}
confusion matrix:
       0    1
0  17826  323
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.896436, 'recall': 0.65750307, 'specificity': 0.65750307, 'f1': 0.7212186, 'auroc': 0.87749034, 'binary_precision': 0.8217822, 'binary_recall': 0.31800765, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.45856354}
confusion matrix:
      0   1
0  5979  18
1   178  83
early stop counter: 3
val acc:0.9654640555381775, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9693192839622498 / 0.9717162251472473
after epoch: 24,now: 2024-07-10 13:19:12.010194,epoch time: 0:21:57.753205,used: 9:00:44.430657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99190044, 'precision': 0.9934093, 'recall': 0.98543215, 'specificity': 0.98543215, 'f1': 0.9893364, 'auroc': 0.99865615, 'binary_precision': 0.9964472, 'binary_recall': 0.9720693, 'binary_specificity': 0.99879503, 'binary_f1_score': 0.9841073}
confusion matrix:
       0      1
0  42274     51
1    411  14304
---- Validation: 
scalar performance:
{'acc': 0.9620583, 'precision': 0.71905774, 'recall': 0.75984085, 'specificity': 0.75984085, 'f1': 0.7374869, 'auroc': 0.91815966, 'binary_precision': 0.4544271, 'binary_recall': 0.5427683, 'binary_specificity': 0.97691333, 'binary_f1_score': 0.49468467}
confusion matrix:
       0    1
0  17730  419
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.84810257, 'recall': 0.7090585, 'specificity': 0.7090585, 'f1': 0.7594953, 'auroc': 0.8785604, 'binary_precision': 0.72077924, 'binary_recall': 0.42528737, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.53493977}
confusion matrix:
      0    1
0  5954   43
1   150  111
early stop counter: 4
val acc:0.9620583057403564, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9693192839622498 / 0.9717162251472473
after epoch: 25,now: 2024-07-10 13:46:31.292568,epoch time: 0:27:19.282374,used: 9:28:03.713031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99102384, 'precision': 0.99336135, 'recall': 0.9832245, 'specificity': 0.9832245, 'f1': 0.98815703, 'auroc': 0.9988335, 'binary_precision': 0.99803644, 'binary_recall': 0.96711063, 'binary_specificity': 0.99933845, 'binary_f1_score': 0.9823302}
confusion matrix:
       0      1
0  42296     28
1    484  14232
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7514553, 'recall': 0.7257053, 'specificity': 0.7257053, 'f1': 0.73780847, 'auroc': 0.9201014, 'binary_precision': 0.5217391, 'binary_recall': 0.466563, 'binary_specificity': 0.98484766, 'binary_f1_score': 0.49261084}
confusion matrix:
       0    1
0  17874  275
1    343  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.9005739, 'recall': 0.6405118, 'specificity': 0.6405118, 'f1': 0.7031267, 'auroc': 0.87590367, 'binary_precision': 0.83146065, 'binary_recall': 0.2835249, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.42285714}
confusion matrix:
      0   1
0  5982  15
1   187  74
early stop counter: 5
val acc:0.9671136736869812, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9693192839622498 / 0.9717162251472473
after epoch: 26,now: 2024-07-10 14:09:40.010483,epoch time: 0:23:08.717915,used: 9:51:12.430946,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9917426, 'precision': 0.9926606, 'recall': 0.9857479, 'specificity': 0.9857479, 'f1': 0.9891406, 'auroc': 0.9988284, 'binary_precision': 0.99451506, 'binary_recall': 0.9733623, 'binary_specificity': 0.9981334, 'binary_f1_score': 0.98382497}
confusion matrix:
       0      1
0  42245     79
1    392  14324
---- Validation: 
scalar performance:
{'acc': 0.9608344, 'precision': 0.7109864, 'recall': 0.74870634, 'specificity': 0.74870634, 'f1': 0.7280927, 'auroc': 0.90972936, 'binary_precision': 0.43905637, 'binary_recall': 0.5209953, 'binary_specificity': 0.9764174, 'binary_f1_score': 0.47652918}
confusion matrix:
       0    1
0  17721  428
1    308  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.83149827, 'recall': 0.6521709, 'specificity': 0.6521709, 'f1': 0.705388, 'auroc': 0.8663866, 'binary_precision': 0.6923077, 'binary_recall': 0.31034482, 'binary_specificity': 0.993997, 'binary_f1_score': 0.4285714}
confusion matrix:
      0   1
0  5961  36
1   180  81
early stop counter: 6
val acc:0.9608343839645386, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9693192839622498 / 0.9717162251472473
after epoch: 27,now: 2024-07-10 14:33:13.554221,epoch time: 0:23:33.543738,used: 10:14:45.974684,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9913745, 'precision': 0.9935705, 'recall': 0.98392725, 'specificity': 0.98392725, 'f1': 0.9886259, 'auroc': 0.99870044, 'binary_precision': 0.9979696, 'binary_recall': 0.9685398, 'binary_specificity': 0.9993148, 'binary_f1_score': 0.98303455}
confusion matrix:
       0      1
0  42294     29
1    463  14254
---- Validation: 
scalar performance:
{'acc': 0.96663475, 'precision': 0.7474304, 'recall': 0.7254574, 'specificity': 0.7254574, 'f1': 0.73587596, 'auroc': 0.91724163, 'binary_precision': 0.51369864, 'binary_recall': 0.466563, 'binary_specificity': 0.98435175, 'binary_f1_score': 0.48899755}
confusion matrix:
       0    1
0  17865  284
1    343  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9646852, 'precision': 0.8723192, 'recall': 0.6059457, 'specificity': 0.6059457, 'f1': 0.65909815, 'auroc': 0.86757475, 'binary_precision': 0.7777778, 'binary_recall': 0.21455939, 'binary_specificity': 0.997332, 'binary_f1_score': 0.33633634}
confusion matrix:
      0   1
0  5981  16
1   205  56
early stop counter: 7
val acc:0.9666347503662109, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9693192839622498 / 0.9717162251472473
after epoch: 28,now: 2024-07-10 14:57:58.166903,epoch time: 0:24:44.612682,used: 10:39:30.587366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99188286, 'precision': 0.99309826, 'recall': 0.98568815, 'specificity': 0.98568815, 'f1': 0.9893203, 'auroc': 0.9989778, 'binary_precision': 0.99555, 'binary_recall': 0.97288847, 'binary_specificity': 0.99848783, 'binary_f1_score': 0.9840888}
confusion matrix:
       0      1
0  42259     64
1    399  14318
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.7363368, 'recall': 0.75013274, 'specificity': 0.75013274, 'f1': 0.74301565, 'auroc': 0.9211192, 'binary_precision': 0.48973608, 'binary_recall': 0.5194401, 'binary_specificity': 0.98082536, 'binary_f1_score': 0.5041509}
confusion matrix:
       0    1
0  17801  348
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.85848415, 'recall': 0.6604174, 'specificity': 0.6604174, 'f1': 0.7182242, 'auroc': 0.8751515, 'binary_precision': 0.74561405, 'binary_recall': 0.3256705, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.45333335}
confusion matrix:
      0   1
0  5968  29
1   176  85
early stop counter: 8
val acc:0.9650382995605469, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9693192839622498 / 0.9717162251472473
after epoch: 29,now: 2024-07-10 15:22:49.566019,epoch time: 0:24:51.399116,used: 11:04:21.986482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9917251, 'precision': 0.99306136, 'recall': 0.98531497, 'specificity': 0.98531497, 'f1': 0.9891085, 'auroc': 0.99871695, 'binary_precision': 0.9957539, 'binary_recall': 0.97207123, 'binary_specificity': 0.99855876, 'binary_f1_score': 0.9837701}
confusion matrix:
       0      1
0  42263     61
1    411  14305
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.7436653, 'recall': 0.7476835, 'specificity': 0.7476835, 'f1': 0.745656, 'auroc': 0.92343616, 'binary_precision': 0.5045872, 'binary_recall': 0.5132193, 'binary_specificity': 0.98214775, 'binary_f1_score': 0.5088666}
confusion matrix:
       0    1
0  17825  324
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.86637974, 'recall': 0.6285173, 'specificity': 0.6285173, 'f1': 0.6854907, 'auroc': 0.8701463, 'binary_precision': 0.76404494, 'binary_recall': 0.2605364, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.38857144}
confusion matrix:
      0   1
0  5976  21
1   193  68
early stop counter: 9
val acc:0.9661026000976562, best validation acc: 0.9671136736869812, corresponding to test acc:                         0.9693192839622498 / 0.9717162251472473
after epoch: 30,now: 2024-07-10 15:49:49.947155,epoch time: 0:27:00.381136,used: 11:31:22.367618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_18_27_seed_0_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:31:22.367618 at 2024-07-10 15:49:49.947155
persisted model performance metric: 

scalar performance:
{'acc': 0.9693193, 'precision': 0.8971522, 'recall': 0.66699827, 'specificity': 0.66699827, 'f1': 0.7312279, 'auroc': 0.88117146, 'binary_precision': 0.8224299, 'binary_recall': 0.33716476, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.47826084}
confusion matrix:
      0   1
0  5978  19
1   173  88
oracle model performance metric: 

scalar performance:
{'acc': 0.9717162, 'precision': 0.85485137, 'recall': 0.75070393, 'specificity': 0.75070393, 'f1': 0.7928953, 'auroc': 0.89622545, 'binary_precision': 0.7307692, 'binary_recall': 0.5095785, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.60045147}
confusion matrix:
      0    1
0  5948   49
1   128  133
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 246504 KiB |   4095 MiB |   2977 TiB |   2977 TiB |
|       from large pool | 229013 KiB |   4075 MiB |   2944 TiB |   2944 TiB |
|       from small pool |  17491 KiB |     37 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 246504 KiB |   4095 MiB |   2977 TiB |   2977 TiB |
|       from large pool | 229013 KiB |   4075 MiB |   2944 TiB |   2944 TiB |
|       from small pool |  17491 KiB |     37 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 244357 KiB |   4093 MiB |   2977 TiB |   2977 TiB |
|       from large pool | 227875 KiB |   4074 MiB |   2943 TiB |   2943 TiB |
|       from small pool |  16482 KiB |     36 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4494 MiB |   4494 MiB |   4494 MiB |      0 B   |
|       from large pool |   4452 MiB |   4452 MiB |   4452 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  46360 KiB | 394288 KiB |   1518 TiB |   1518 TiB |
|       from large pool |  39275 KiB | 393106 KiB |   1485 TiB |   1485 TiB |
|       from small pool |   7085 KiB |   9383 KiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7605    |  401486 K  |  401483 K  |
|       from large pool |      79    |     423    |  275569 K  |  275569 K  |
|       from small pool |    2899    |    7525    |  125917 K  |  125914 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7605    |  401486 K  |  401483 K  |
|       from large pool |      79    |     423    |  275569 K  |  275569 K  |
|       from small pool |    2899    |    7525    |  125917 K  |  125914 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     205    |     205    |     205    |       0    |
|       from large pool |     184    |     184    |     184    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3586    |  266651 K  |  266651 K  |
|       from large pool |      10    |     183    |  202191 K  |  202191 K  |
|       from small pool |      21    |    3576    |   64459 K  |   64459 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   4095 MiB |   2977 TiB |   2977 TiB |
|       from large pool |  65536 KiB |   4075 MiB |   2944 TiB |   2944 TiB |
|       from small pool |      0 KiB |     37 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   4095 MiB |   2977 TiB |   2977 TiB |
|       from large pool |  65536 KiB |   4075 MiB |   2944 TiB |   2944 TiB |
|       from small pool |      0 KiB |     37 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   4093 MiB |   2977 TiB |   2977 TiB |
|       from large pool |  65536 KiB |   4074 MiB |   2943 TiB |   2943 TiB |
|       from small pool |      0 KiB |     36 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 292864 KiB |   4494 MiB |   4494 MiB |   4208 MiB |
|       from large pool | 268288 KiB |   4452 MiB |   4452 MiB |   4190 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 394288 KiB |   1518 TiB |   1518 TiB |
|       from large pool |      0 B   | 393106 KiB |   1485 TiB |   1485 TiB |
|       from small pool |      0 B   |  18291 KiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |  401486 K  |  401486 K  |
|       from large pool |       2    |     423    |  275569 K  |  275569 K  |
|       from small pool |       0    |    7525    |  125917 K  |  125917 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |  401486 K  |  401486 K  |
|       from large pool |       2    |     423    |  275569 K  |  275569 K  |
|       from small pool |       0    |    7525    |  125917 K  |  125917 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     205    |     205    |     181    |
|       from large pool |      12    |     184    |     184    |     172    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3586    |  266652 K  |  266652 K  |
|       from large pool |       0    |     183    |  202191 K  |  202191 K  |
|       from small pool |       0    |    3576    |   64460 K  |   64460 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   4095 MiB |   2977 TiB |   2977 TiB |
|       from large pool |  65536 KiB |   4075 MiB |   2944 TiB |   2944 TiB |
|       from small pool |      0 KiB |     37 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   4095 MiB |   2977 TiB |   2977 TiB |
|       from large pool |  65536 KiB |   4075 MiB |   2944 TiB |   2944 TiB |
|       from small pool |      0 KiB |     37 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   4093 MiB |   2977 TiB |   2977 TiB |
|       from large pool |  65536 KiB |   4074 MiB |   2943 TiB |   2943 TiB |
|       from small pool |      0 KiB |     36 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 292864 KiB |   4494 MiB |   4494 MiB |   4208 MiB |
|       from large pool | 268288 KiB |   4452 MiB |   4452 MiB |   4190 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 394288 KiB |   1518 TiB |   1518 TiB |
|       from large pool |      0 B   | 393106 KiB |   1485 TiB |   1485 TiB |
|       from small pool |      0 B   |  18291 KiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |  401486 K  |  401486 K  |
|       from large pool |       2    |     423    |  275569 K  |  275569 K  |
|       from small pool |       0    |    7525    |  125917 K  |  125917 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |  401486 K  |  401486 K  |
|       from large pool |       2    |     423    |  275569 K  |  275569 K  |
|       from small pool |       0    |    7525    |  125917 K  |  125917 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     205    |     205    |     181    |
|       from large pool |      12    |     184    |     184    |     172    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3586    |  266652 K  |  266652 K  |
|       from large pool |       0    |     183    |  202191 K  |  202191 K  |
|       from small pool |       0    |    3576    |   64460 K  |   64460 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616

 Experiment start at: 2024-07-10 16:05:32.592850
before training, model accuracy: 0.6475991010665894
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96456224, 'precision': 0.9666325, 'recall': 0.9390687, 'specificity': 0.9390687, 'f1': 0.9518187, 'auroc': 0.98301214, 'binary_precision': 0.97049457, 'binary_recall': 0.8873093, 'binary_specificity': 0.9908281, 'binary_f1_score': 0.9270396}
confusion matrix:
       0      1
0  42023    389
1   1625  12795
---- Validation: 
scalar performance:
{'acc': 0.94951975, 'precision': 0.6499361, 'recall': 0.6712616, 'specificity': 0.6712616, 'f1': 0.65976423, 'auroc': 0.8712484, 'binary_precision': 0.32341528, 'binary_recall': 0.37147102, 'binary_specificity': 0.97105217, 'binary_f1_score': 0.34578148}
confusion matrix:
       0    1
0  17544  523
1    423  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9505317, 'precision': 0.667444, 'recall': 0.61558187, 'specificity': 0.61558187, 'f1': 0.635923, 'auroc': 0.8774655, 'binary_precision': 0.36723164, 'binary_recall': 0.25, 'binary_specificity': 0.9811638, 'binary_f1_score': 0.29748285}
confusion matrix:
      0    1
0  5834  112
1   195   65
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 16:28:51.928361,epoch time: 0:23:19.335511,used: 0:23:19.335511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9700169, 'precision': 0.97457194, 'recall': 0.9460187, 'specificity': 0.9460187, 'f1': 0.9592128, 'auroc': 0.9910996, 'binary_precision': 0.98305726, 'binary_recall': 0.8972954, 'binary_specificity': 0.99474204, 'binary_f1_score': 0.93822056}
confusion matrix:
       0      1
0  42189    223
1   1481  12939
---- Validation: 
scalar performance:
{'acc': 0.9611526, 'precision': 0.71599275, 'recall': 0.6930306, 'specificity': 0.6930306, 'f1': 0.70378345, 'auroc': 0.8977407, 'binary_precision': 0.45409015, 'binary_recall': 0.40416047, 'binary_specificity': 0.9819007, 'binary_f1_score': 0.42767295}
confusion matrix:
       0    1
0  17740  327
1    401  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.79564595, 'recall': 0.63852364, 'specificity': 0.63852364, 'f1': 0.6856521, 'auroc': 0.9155423, 'binary_precision': 0.62184876, 'binary_recall': 0.2846154, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.39050135}
confusion matrix:
      0   1
0  5901  45
1   186  74
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-10 16:51:11.256094,epoch time: 0:22:19.327733,used: 0:45:38.663244,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.975454, 'precision': 0.97721815, 'recall': 0.9576458, 'specificity': 0.9576458, 'f1': 0.96692234, 'auroc': 0.9935789, 'binary_precision': 0.9805904, 'binary_recall': 0.92149246, 'binary_specificity': 0.9937991, 'binary_f1_score': 0.9501233}
confusion matrix:
       0      1
0  42150    263
1   1132  13287
---- Validation: 
scalar performance:
{'acc': 0.9613127, 'precision': 0.72035545, 'recall': 0.718148, 'specificity': 0.718148, 'f1': 0.71924543, 'auroc': 0.90873665, 'binary_precision': 0.46096095, 'binary_recall': 0.45616642, 'binary_specificity': 0.98012954, 'binary_f1_score': 0.45855114}
confusion matrix:
       0    1
0  17708  359
1    366  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.8041538, 'recall': 0.7248829, 'specificity': 0.7248829, 'f1': 0.7578889, 'auroc': 0.9175806, 'binary_precision': 0.6315789, 'binary_recall': 0.46153846, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.53333336}
confusion matrix:
      0    1
0  5876   70
1   140  120
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-10 17:13:23.697699,epoch time: 0:22:12.441605,used: 1:07:51.104849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97934264, 'precision': 0.98164046, 'recall': 0.9636385, 'specificity': 0.9636385, 'f1': 0.97221273, 'auroc': 0.9953079, 'binary_precision': 0.986055, 'binary_recall': 0.93175673, 'binary_specificity': 0.99552023, 'binary_f1_score': 0.9581372}
confusion matrix:
       0      1
0  42223    190
1    984  13435
---- Validation: 
scalar performance:
{'acc': 0.96302027, 'precision': 0.7315377, 'recall': 0.7125962, 'specificity': 0.7125962, 'f1': 0.72161275, 'auroc': 0.91196525, 'binary_precision': 0.48376623, 'binary_recall': 0.44279346, 'binary_specificity': 0.98239887, 'binary_f1_score': 0.46237394}
confusion matrix:
       0    1
0  17749  318
1    375  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96825653, 'precision': 0.82140505, 'recall': 0.738849, 'specificity': 0.738849, 'f1': 0.7733613, 'auroc': 0.9196771, 'binary_precision': 0.66492146, 'binary_recall': 0.48846152, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.56319284}
confusion matrix:
      0    1
0  5882   64
1   133  127
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-10 17:35:26.510783,epoch time: 0:22:02.813084,used: 1:29:53.917933,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9814717, 'precision': 0.98412645, 'recall': 0.96685016, 'specificity': 0.96685016, 'f1': 0.97509754, 'auroc': 0.99602485, 'binary_precision': 0.9892387, 'binary_recall': 0.9371662, 'binary_specificity': 0.9965341, 'binary_f1_score': 0.9624986}
confusion matrix:
       0      1
0  42266    147
1    906  13513
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.7343246, 'recall': 0.7426927, 'specificity': 0.7426927, 'f1': 0.7384259, 'auroc': 0.91346014, 'binary_precision': 0.48710603, 'binary_recall': 0.50520056, 'binary_specificity': 0.98018485, 'binary_f1_score': 0.4959883}
confusion matrix:
       0    1
0  17709  358
1    333  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.80153215, 'recall': 0.7714462, 'specificity': 0.7714462, 'f1': 0.78560185, 'auroc': 0.922009, 'binary_precision': 0.6223176, 'binary_recall': 0.5576923, 'binary_specificity': 0.9852001, 'binary_f1_score': 0.5882353}
confusion matrix:
      0    1
0  5858   88
1   115  145
better model found
persisted
after epoch: 5,now: 2024-07-10 17:57:13.684741,epoch time: 0:21:47.173958,used: 1:51:41.091891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.982897, 'precision': 0.98401344, 'recall': 0.97066605, 'specificity': 0.97066605, 'f1': 0.97710544, 'auroc': 0.9960296, 'binary_precision': 0.9861885, 'binary_recall': 0.94583535, 'binary_specificity': 0.9954967, 'binary_f1_score': 0.96559054}
confusion matrix:
       0      1
0  42222    191
1    781  13638
---- Validation: 
scalar performance:
{'acc': 0.9624333, 'precision': 0.7303745, 'recall': 0.74877036, 'specificity': 0.74877036, 'f1': 0.7391735, 'auroc': 0.9151554, 'binary_precision': 0.478738, 'binary_recall': 0.5185735, 'binary_specificity': 0.9789672, 'binary_f1_score': 0.4978602}
confusion matrix:
       0    1
0  17687  380
1    324  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.77194595, 'recall': 0.774945, 'specificity': 0.774945, 'f1': 0.7734362, 'auroc': 0.9199313, 'binary_precision': 0.56273764, 'binary_recall': 0.5692308, 'binary_specificity': 0.98065925, 'binary_f1_score': 0.5659656}
confusion matrix:
      0    1
0  5831  115
1   112  148
early stop counter: 1
val acc:0.9624332785606384, best validation acc: 0.9631270170211792, corresponding to test acc:                         0.9672897458076477 / 0.9682565331459045
after epoch: 6,now: 2024-07-10 18:18:57.753473,epoch time: 0:21:44.068732,used: 2:13:25.160623,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98249227, 'precision': 0.98535, 'recall': 0.96835786, 'specificity': 0.96835786, 'f1': 0.976477, 'auroc': 0.99670625, 'binary_precision': 0.99085855, 'binary_recall': 0.93966293, 'binary_specificity': 0.9970528, 'binary_f1_score': 0.9645819}
confusion matrix:
       0      1
0  42288    125
1    870  13549
---- Validation: 
scalar performance:
{'acc': 0.9627535, 'precision': 0.7319027, 'recall': 0.742499, 'specificity': 0.742499, 'f1': 0.73706734, 'auroc': 0.9129379, 'binary_precision': 0.4822695, 'binary_recall': 0.50520056, 'binary_specificity': 0.9797974, 'binary_f1_score': 0.4934688}
confusion matrix:
       0    1
0  17702  365
1    333  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.7723693, 'recall': 0.7583101, 'specificity': 0.7583101, 'f1': 0.76512855, 'auroc': 0.91830367, 'binary_precision': 0.56504065, 'binary_recall': 0.5346154, 'binary_specificity': 0.9820047, 'binary_f1_score': 0.5494071}
confusion matrix:
      0    1
0  5839  107
1   121  139
early stop counter: 2
val acc:0.9627534747123718, best validation acc: 0.9631270170211792, corresponding to test acc:                         0.9672897458076477 / 0.9682565331459045
after epoch: 7,now: 2024-07-10 18:44:47.777028,epoch time: 0:25:50.023555,used: 2:39:15.184178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98405826, 'precision': 0.98609924, 'recall': 0.9717206, 'specificity': 0.9717206, 'f1': 0.9786398, 'auroc': 0.9969834, 'binary_precision': 0.99006385, 'binary_recall': 0.9466713, 'binary_specificity': 0.9967698, 'binary_f1_score': 0.9678815}
confusion matrix:
       0      1
0  42275    137
1    769  13651
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.7390996, 'recall': 0.7380733, 'specificity': 0.7380733, 'f1': 0.73858523, 'auroc': 0.9178355, 'binary_precision': 0.49701494, 'binary_recall': 0.4947994, 'binary_specificity': 0.9813472, 'binary_f1_score': 0.49590468}
confusion matrix:
       0    1
0  17730  337
1    340  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.7709563, 'recall': 0.7489469, 'specificity': 0.7489469, 'f1': 0.75942373, 'auroc': 0.91691846, 'binary_precision': 0.56302524, 'binary_recall': 0.5153846, 'binary_specificity': 0.98250926, 'binary_f1_score': 0.5381526}
confusion matrix:
      0    1
0  5842  104
1   126  134
better model found
persisted
after epoch: 8,now: 2024-07-10 19:08:00.410668,epoch time: 0:23:12.633640,used: 3:02:27.817818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9852372, 'precision': 0.9852507, 'recall': 0.9756213, 'specificity': 0.9756213, 'f1': 0.9803139, 'auroc': 0.99686986, 'binary_precision': 0.9852773, 'binary_recall': 0.95609957, 'binary_specificity': 0.995143, 'binary_f1_score': 0.9704692}
confusion matrix:
       0      1
0  42207    206
1    633  13786
---- Validation: 
scalar performance:
{'acc': 0.963714, 'precision': 0.739171, 'recall': 0.7630246, 'specificity': 0.7630246, 'f1': 0.7504593, 'auroc': 0.91729116, 'binary_precision': 0.49528936, 'binary_recall': 0.5468053, 'binary_specificity': 0.97924393, 'binary_f1_score': 0.51977396}
confusion matrix:
       0    1
0  17692  375
1    305  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.75736, 'recall': 0.74977684, 'specificity': 0.74977684, 'f1': 0.7535038, 'auroc': 0.91717637, 'binary_precision': 0.53571427, 'binary_recall': 0.5192308, 'binary_specificity': 0.9803229, 'binary_f1_score': 0.5273438}
confusion matrix:
      0    1
0  5829  117
1   125  135
early stop counter: 1
val acc:0.9637140035629272, best validation acc: 0.9638740420341492, corresponding to test acc:                         0.9629390835762024 / 0.9682565331459045
after epoch: 9,now: 2024-07-10 19:35:00.086164,epoch time: 0:26:59.675496,used: 3:29:27.493314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98622257, 'precision': 0.98810387, 'recall': 0.9754591, 'specificity': 0.9754591, 'f1': 0.9815733, 'auroc': 0.9973808, 'binary_precision': 0.99177784, 'binary_recall': 0.9536061, 'binary_specificity': 0.99731207, 'binary_f1_score': 0.97231746}
confusion matrix:
       0      1
0  42298    114
1    669  13751
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7430222, 'recall': 0.756204, 'specificity': 0.756204, 'f1': 0.7494174, 'auroc': 0.91903204, 'binary_precision': 0.5035162, 'binary_recall': 0.5319465, 'binary_specificity': 0.9804616, 'binary_f1_score': 0.5173411}
confusion matrix:
       0    1
0  17714  353
1    315  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.7655655, 'recall': 0.74300957, 'specificity': 0.74300957, 'f1': 0.75372, 'auroc': 0.91621, 'binary_precision': 0.5527426, 'binary_recall': 0.50384617, 'binary_specificity': 0.9821729, 'binary_f1_score': 0.52716297}
confusion matrix:
      0    1
0  5840  106
1   129  131
better model found
persisted
after epoch: 10,now: 2024-07-10 20:02:37.240639,epoch time: 0:27:37.154475,used: 3:57:04.647789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9872607, 'precision': 0.98740125, 'recall': 0.9788538, 'specificity': 0.9788538, 'f1': 0.98303175, 'auroc': 0.9975563, 'binary_precision': 0.98767895, 'binary_recall': 0.9617865, 'binary_specificity': 0.9959211, 'binary_f1_score': 0.97456074}
confusion matrix:
       0      1
0  42240    173
1    551  13868
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.7414947, 'recall': 0.74253094, 'specificity': 0.74253094, 'f1': 0.74201155, 'auroc': 0.91885126, 'binary_precision': 0.50147927, 'binary_recall': 0.5037147, 'binary_specificity': 0.9813472, 'binary_f1_score': 0.5025945}
confusion matrix:
       0    1
0  17730  337
1    334  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.759012, 'recall': 0.71483606, 'specificity': 0.71483606, 'f1': 0.73459005, 'auroc': 0.91165614, 'binary_precision': 0.5420561, 'binary_recall': 0.44615385, 'binary_specificity': 0.9835183, 'binary_f1_score': 0.48945147}
confusion matrix:
      0    1
0  5848   98
1   144  116
early stop counter: 1
val acc:0.9641942381858826, best validation acc: 0.9643543362617493, corresponding to test acc:                         0.9621334075927734 / 0.9682565331459045
after epoch: 11,now: 2024-07-10 20:30:09.021346,epoch time: 0:27:31.780707,used: 4:24:36.428496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9864865, 'precision': 0.9871103, 'recall': 0.9770992, 'specificity': 0.9770992, 'f1': 0.9819735, 'auroc': 0.9975236, 'binary_precision': 0.988338, 'binary_recall': 0.9580415, 'binary_specificity': 0.9961568, 'binary_f1_score': 0.972954}
confusion matrix:
       0      1
0  42250    163
1    605  13814
---- Validation: 
scalar performance:
{'acc': 0.9641409, 'precision': 0.7415345, 'recall': 0.75394756, 'specificity': 0.75394756, 'f1': 0.7475661, 'auroc': 0.9197521, 'binary_precision': 0.50070524, 'binary_recall': 0.5274888, 'binary_specificity': 0.9804063, 'binary_f1_score': 0.51374817}
confusion matrix:
       0    1
0  17713  354
1    318  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.752707, 'recall': 0.71809363, 'specificity': 0.71809363, 'f1': 0.7339535, 'auroc': 0.9095863, 'binary_precision': 0.529148, 'binary_recall': 0.45384616, 'binary_specificity': 0.98234105, 'binary_f1_score': 0.48861283}
confusion matrix:
      0    1
0  5841  105
1   142  118
early stop counter: 2
val acc:0.9641408920288086, best validation acc: 0.9643543362617493, corresponding to test acc:                         0.9621334075927734 / 0.9682565331459045
after epoch: 12,now: 2024-07-10 20:52:47.927394,epoch time: 0:22:38.906048,used: 4:47:15.334544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9876654, 'precision': 0.988593, 'recall': 0.97876006, 'specificity': 0.97876006, 'f1': 0.98355037, 'auroc': 0.9980645, 'binary_precision': 0.9904197, 'binary_recall': 0.9606796, 'binary_specificity': 0.99684054, 'binary_f1_score': 0.97532296}
confusion matrix:
       0      1
0  42278    134
1    567  13853
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.7468265, 'recall': 0.76864034, 'specificity': 0.76864034, 'f1': 0.75721455, 'auroc': 0.9223186, 'binary_precision': 0.5102041, 'binary_recall': 0.5572065, 'binary_specificity': 0.98007417, 'binary_f1_score': 0.53267044}
confusion matrix:
       0    1
0  17707  360
1    298  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.7628314, 'recall': 0.7317233, 'specificity': 0.7317233, 'f1': 0.74616766, 'auroc': 0.910394, 'binary_precision': 0.5482456, 'binary_recall': 0.48076922, 'binary_specificity': 0.98267746, 'binary_f1_score': 0.51229507}
confusion matrix:
      0    1
0  5843  103
1   135  125
better model found
persisted
after epoch: 13,now: 2024-07-10 21:14:55.773142,epoch time: 0:22:07.845748,used: 5:09:23.180292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9899431, 'recall': 0.9807748, 'specificity': 0.9807748, 'f1': 0.98524964, 'auroc': 0.9980655, 'binary_precision': 0.99193776, 'binary_recall': 0.9642139, 'binary_specificity': 0.99733573, 'binary_f1_score': 0.9778793}
confusion matrix:
       0      1
0  42300    113
1    516  13903
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.74289274, 'recall': 0.7733151, 'specificity': 0.7733151, 'f1': 0.757094, 'auroc': 0.9190512, 'binary_precision': 0.50197107, 'binary_recall': 0.5676077, 'binary_specificity': 0.9790225, 'binary_f1_score': 0.5327754}
confusion matrix:
       0    1
0  17688  379
1    291  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.74701947, 'recall': 0.73974097, 'specificity': 0.73974097, 'f1': 0.743318, 'auroc': 0.90472555, 'binary_precision': 0.515873, 'binary_recall': 0.5, 'binary_specificity': 0.979482, 'binary_f1_score': 0.5078125}
confusion matrix:
      0    1
0  5824  122
1   130  130
early stop counter: 1
val acc:0.9642475843429565, best validation acc: 0.9648879170417786, corresponding to test acc:                         0.961650013923645 / 0.9682565331459045
after epoch: 14,now: 2024-07-10 21:36:43.063689,epoch time: 0:21:47.290547,used: 5:31:10.470839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98835164, 'precision': 0.99022424, 'recall': 0.9789896, 'specificity': 0.9789896, 'f1': 0.9844433, 'auroc': 0.99826324, 'binary_precision': 0.9938967, 'binary_recall': 0.95998335, 'binary_specificity': 0.9979959, 'binary_f1_score': 0.97664577}
confusion matrix:
       0      1
0  42328     85
1    577  13842
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.7425302, 'recall': 0.7625861, 'specificity': 0.7625861, 'f1': 0.75211006, 'auroc': 0.92145336, 'binary_precision': 0.502052, 'binary_recall': 0.54531944, 'binary_specificity': 0.9798528, 'binary_f1_score': 0.52279204}
confusion matrix:
       0    1
0  17703  364
1    306  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.7436665, 'recall': 0.72477686, 'specificity': 0.72477686, 'f1': 0.73378634, 'auroc': 0.90259576, 'binary_precision': 0.51046026, 'binary_recall': 0.46923077, 'binary_specificity': 0.9803229, 'binary_f1_score': 0.48897797}
confusion matrix:
      0    1
0  5829  117
1   138  122
early stop counter: 2
val acc:0.9642475843429565, best validation acc: 0.9648879170417786, corresponding to test acc:                         0.961650013923645 / 0.9682565331459045
after epoch: 15,now: 2024-07-10 21:58:58.177377,epoch time: 0:22:15.113688,used: 5:53:25.584527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9863633, 'precision': 0.99016786, 'recall': 0.9739057, 'specificity': 0.9739057, 'f1': 0.98169565, 'auroc': 0.9982058, 'binary_precision': 0.9975206, 'binary_recall': 0.94861305, 'binary_specificity': 0.9991983, 'binary_f1_score': 0.97245234}
confusion matrix:
       0      1
0  42378     34
1    741  13679
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.75926805, 'recall': 0.73731124, 'specificity': 0.73731124, 'f1': 0.7477484, 'auroc': 0.91840106, 'binary_precision': 0.53745925, 'binary_recall': 0.49034175, 'binary_specificity': 0.9842807, 'binary_f1_score': 0.5128205}
confusion matrix:
       0    1
0  17783  284
1    343  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.7721896, 'recall': 0.66928184, 'specificity': 0.66928184, 'f1': 0.707303, 'auroc': 0.90780663, 'binary_precision': 0.572327, 'binary_recall': 0.35, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.4343675}
confusion matrix:
      0   1
0  5878  68
1   169  91
better model found
persisted
after epoch: 16,now: 2024-07-10 22:21:27.753254,epoch time: 0:22:29.575877,used: 6:15:55.160404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98856276, 'precision': 0.9904372, 'recall': 0.9793384, 'specificity': 0.9793384, 'f1': 0.9847281, 'auroc': 0.99808687, 'binary_precision': 0.9941151, 'binary_recall': 0.9606103, 'binary_specificity': 0.9980666, 'binary_f1_score': 0.9770755}
confusion matrix:
       0      1
0  42330     82
1    568  13852
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.746788, 'recall': 0.74148786, 'specificity': 0.74148786, 'f1': 0.7441057, 'auroc': 0.91705245, 'binary_precision': 0.51215804, 'binary_recall': 0.5007429, 'binary_specificity': 0.9822328, 'binary_f1_score': 0.50638616}
confusion matrix:
       0    1
0  17746  321
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.7748158, 'recall': 0.682407, 'specificity': 0.682407, 'f1': 0.71814233, 'auroc': 0.90013266, 'binary_precision': 0.5764706, 'binary_recall': 0.37692308, 'binary_specificity': 0.987891, 'binary_f1_score': 0.45581397}
confusion matrix:
      0   1
0  5874  72
1   162  98
early stop counter: 1
val acc:0.9649413228034973, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9618111252784729 / 0.9682565331459045
after epoch: 17,now: 2024-07-10 22:43:17.969467,epoch time: 0:21:50.216213,used: 6:37:45.376617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9889675, 'precision': 0.9908271, 'recall': 0.9800215, 'specificity': 0.9800215, 'f1': 0.985273, 'auroc': 0.99886, 'binary_precision': 0.9944791, 'binary_recall': 0.9618585, 'binary_specificity': 0.9981845, 'binary_f1_score': 0.9778968}
confusion matrix:
       0      1
0  42335     77
1    550  13870
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7581178, 'recall': 0.71499956, 'specificity': 0.71499956, 'f1': 0.7343722, 'auroc': 0.9205672, 'binary_precision': 0.5368043, 'binary_recall': 0.44427934, 'binary_specificity': 0.9857198, 'binary_f1_score': 0.48617887}
confusion matrix:
       0    1
0  17809  258
1    374  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9624557, 'precision': 0.7816421, 'recall': 0.66226226, 'specificity': 0.66226226, 'f1': 0.7040549, 'auroc': 0.9055946, 'binary_precision': 0.59183675, 'binary_recall': 0.33461538, 'binary_specificity': 0.9899092, 'binary_f1_score': 0.42751843}
confusion matrix:
      0   1
0  5886  60
1   173  87
early stop counter: 2
val acc:0.9662753343582153, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9618111252784729 / 0.9682565331459045
after epoch: 18,now: 2024-07-10 23:05:04.458447,epoch time: 0:21:46.488980,used: 6:59:31.865597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98997045, 'precision': 0.99149513, 'recall': 0.9819968, 'specificity': 0.9819968, 'f1': 0.9866291, 'auroc': 0.9985474, 'binary_precision': 0.9945012, 'binary_recall': 0.965809, 'binary_specificity': 0.9981845, 'binary_f1_score': 0.97994506}
confusion matrix:
       0      1
0  42336     77
1    493  13926
---- Validation: 
scalar performance:
{'acc': 0.9657951, 'precision': 0.7535485, 'recall': 0.7247642, 'specificity': 0.7247642, 'f1': 0.7381898, 'auroc': 0.92154396, 'binary_precision': 0.52693605, 'binary_recall': 0.46508172, 'binary_specificity': 0.98444676, 'binary_f1_score': 0.49408054}
confusion matrix:
       0    1
0  17786  281
1    360  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96052206, 'precision': 0.7661209, 'recall': 0.62263453, 'specificity': 0.62263453, 'f1': 0.66488767, 'auroc': 0.90119326, 'binary_precision': 0.5641026, 'binary_recall': 0.25384617, 'binary_specificity': 0.99142283, 'binary_f1_score': 0.35013264}
confusion matrix:
      0   1
0  5895  51
1   194  66
early stop counter: 3
val acc:0.96579509973526, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9618111252784729 / 0.9682565331459045
after epoch: 19,now: 2024-07-10 23:26:48.258783,epoch time: 0:21:43.800336,used: 7:21:15.665933,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98912585, 'precision': 0.9908122, 'recall': 0.9804467, 'specificity': 0.9804467, 'f1': 0.9854902, 'auroc': 0.9984162, 'binary_precision': 0.99412817, 'binary_recall': 0.96282685, 'binary_specificity': 0.9980666, 'binary_f1_score': 0.9782272}
confusion matrix:
       0      1
0  42331     82
1    536  13883
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.74956167, 'recall': 0.73381364, 'specificity': 0.73381364, 'f1': 0.74140066, 'auroc': 0.9190475, 'binary_precision': 0.518283, 'binary_recall': 0.48439822, 'binary_specificity': 0.9832291, 'binary_f1_score': 0.500768}
confusion matrix:
       0    1
0  17764  303
1    347  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.7763908, 'recall': 0.6750511, 'specificity': 0.6750511, 'f1': 0.71299064, 'auroc': 0.9035554, 'binary_precision': 0.5802469, 'binary_recall': 0.36153847, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.44549763}
confusion matrix:
      0   1
0  5878  68
1   166  94
early stop counter: 4
val acc:0.9653148055076599, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9618111252784729 / 0.9682565331459045
after epoch: 20,now: 2024-07-10 23:48:34.076696,epoch time: 0:21:45.817913,used: 7:43:01.483846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99025196, 'precision': 0.99146867, 'recall': 0.9827565, 'specificity': 0.9827565, 'f1': 0.98701423, 'auroc': 0.99861157, 'binary_precision': 0.9938729, 'binary_recall': 0.96754056, 'binary_specificity': 0.99797237, 'binary_f1_score': 0.98053}
confusion matrix:
       0      1
0  42328     86
1    468  13950
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.7394403, 'recall': 0.7459412, 'specificity': 0.7459412, 'f1': 0.7426418, 'auroc': 0.9221072, 'binary_precision': 0.49710983, 'binary_recall': 0.5111441, 'binary_specificity': 0.98073834, 'binary_f1_score': 0.5040293}
confusion matrix:
       0    1
0  17719  348
1    329  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.80197865, 'recall': 0.68550736, 'specificity': 0.68550736, 'f1': 0.72828126, 'auroc': 0.9093405, 'binary_precision': 0.6305733, 'binary_recall': 0.38076922, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.47482014}
confusion matrix:
      0   1
0  5888  58
1   161  99
early stop counter: 5
val acc:0.9638740420341492, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9618111252784729 / 0.9682565331459045
after epoch: 21,now: 2024-07-11 00:10:39.576223,epoch time: 0:22:05.499527,used: 8:05:06.983373,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9908326, 'precision': 0.9915981, 'recall': 0.9841536, 'specificity': 0.9841536, 'f1': 0.98780394, 'auroc': 0.9988049, 'binary_precision': 0.9931167, 'binary_recall': 0.97059435, 'binary_specificity': 0.99771297, 'binary_f1_score': 0.98172635}
confusion matrix:
       0      1
0  42316     97
1    424  13995
---- Validation: 
scalar performance:
{'acc': 0.96435434, 'precision': 0.7436682, 'recall': 0.7769468, 'specificity': 0.7769468, 'f1': 0.75910926, 'auroc': 0.92347, 'binary_precision': 0.50325096, 'binary_recall': 0.5750371, 'binary_specificity': 0.9788565, 'binary_f1_score': 0.5367545}
confusion matrix:
       0    1
0  17685  382
1    286  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.78568286, 'recall': 0.7294749, 'specificity': 0.7294749, 'f1': 0.75413257, 'auroc': 0.9021414, 'binary_precision': 0.5942029, 'binary_recall': 0.4730769, 'binary_specificity': 0.98587286, 'binary_f1_score': 0.5267666}
confusion matrix:
      0    1
0  5862   84
1   137  123
early stop counter: 6
val acc:0.9643543362617493, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9618111252784729 / 0.9682565331459045
after epoch: 22,now: 2024-07-11 00:32:15.962919,epoch time: 0:21:36.386696,used: 8:26:43.370069,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99039274, 'precision': 0.99092627, 'recall': 0.98365295, 'specificity': 0.98365295, 'f1': 0.9872209, 'auroc': 0.99854743, 'binary_precision': 0.99198526, 'binary_recall': 0.96997017, 'binary_specificity': 0.99733573, 'binary_f1_score': 0.9808542}
confusion matrix:
       0      1
0  42300    113
1    433  13986
---- Validation: 
scalar performance:
{'acc': 0.96029884, 'precision': 0.7226392, 'recall': 0.79057944, 'specificity': 0.79057944, 'f1': 0.75148684, 'auroc': 0.9238508, 'binary_precision': 0.46006748, 'binary_recall': 0.6077266, 'binary_specificity': 0.97343224, 'binary_f1_score': 0.52368754}
confusion matrix:
       0    1
0  17587  480
1    264  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95939416, 'precision': 0.74711883, 'recall': 0.74893594, 'specificity': 0.74893594, 'f1': 0.74802357, 'auroc': 0.90240675, 'binary_precision': 0.5152672, 'binary_recall': 0.5192308, 'binary_specificity': 0.9786411, 'binary_f1_score': 0.5172414}
confusion matrix:
      0    1
0  5819  127
1   125  135
early stop counter: 7
val acc:0.9602988362312317, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9618111252784729 / 0.9682565331459045
after epoch: 23,now: 2024-07-11 00:53:51.912844,epoch time: 0:21:35.949925,used: 8:48:19.319994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9909734, 'precision': 0.9921886, 'recall': 0.9839494, 'specificity': 0.9839494, 'f1': 0.9879811, 'auroc': 0.9986088, 'binary_precision': 0.99459344, 'binary_recall': 0.9696907, 'binary_specificity': 0.99820817, 'binary_f1_score': 0.98198414}
confusion matrix:
       0      1
0  42338     76
1    437  13981
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.7487521, 'recall': 0.7244598, 'specificity': 0.7244598, 'f1': 0.7359089, 'auroc': 0.9203706, 'binary_precision': 0.5173554, 'binary_recall': 0.46508172, 'binary_specificity': 0.98383796, 'binary_f1_score': 0.48982784}
confusion matrix:
       0    1
0  17775  292
1    360  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.7884699, 'recall': 0.6606756, 'specificity': 0.6606756, 'f1': 0.704355, 'auroc': 0.89668226, 'binary_precision': 0.6056338, 'binary_recall': 0.33076924, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.4278607}
confusion matrix:
      0   1
0  5890  56
1   174  86
early stop counter: 8
val acc:0.965208113193512, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9618111252784729 / 0.9682565331459045
after epoch: 24,now: 2024-07-11 01:15:29.450132,epoch time: 0:21:37.537288,used: 9:09:56.857282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9914661, 'precision': 0.9917208, 'recall': 0.98569953, 'specificity': 0.98569953, 'f1': 0.9886631, 'auroc': 0.99886835, 'binary_precision': 0.9922283, 'binary_recall': 0.97399265, 'binary_specificity': 0.9974065, 'binary_f1_score': 0.9830259}
confusion matrix:
       0      1
0  42303    110
1    375  14044
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.74413854, 'recall': 0.7434399, 'specificity': 0.7434399, 'f1': 0.7437887, 'auroc': 0.9212035, 'binary_precision': 0.5067064, 'binary_recall': 0.50520056, 'binary_specificity': 0.9816793, 'binary_f1_score': 0.50595236}
confusion matrix:
       0    1
0  17736  331
1    333  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.7914183, 'recall': 0.67012274, 'specificity': 0.67012274, 'f1': 0.7130379, 'auroc': 0.9005834, 'binary_precision': 0.6107383, 'binary_recall': 0.35, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.44498777}
confusion matrix:
      0   1
0  5888  58
1   169  91
early stop counter: 9
val acc:0.9645677804946899, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9618111252784729 / 0.9682565331459045
after epoch: 25,now: 2024-07-11 01:37:12.871705,epoch time: 0:21:43.421573,used: 9:31:40.278855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9914837, 'precision': 0.9932201, 'recall': 0.9842913, 'specificity': 0.9842913, 'f1': 0.98865294, 'auroc': 0.9986608, 'binary_precision': 0.99664956, 'binary_recall': 0.9696907, 'binary_specificity': 0.9988919, 'binary_f1_score': 0.9829853}
confusion matrix:
       0      1
0  42367     47
1    437  13981
---- Validation: 
scalar performance:
{'acc': 0.9648879, 'precision': 0.7463277, 'recall': 0.73573804, 'specificity': 0.73573804, 'f1': 0.74090254, 'auroc': 0.9208173, 'binary_precision': 0.5116641, 'binary_recall': 0.48885587, 'binary_specificity': 0.98262024, 'binary_f1_score': 0.5}
confusion matrix:
       0    1
0  17753  314
1    344  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.77400315, 'recall': 0.66936594, 'specificity': 0.66936594, 'f1': 0.7078651, 'auroc': 0.89713544, 'binary_precision': 0.5759494, 'binary_recall': 0.35, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.4354067}
confusion matrix:
      0   1
0  5879  67
1   169  91
early stop counter: 10
val acc:0.9648879170417786, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9618111252784729 / 0.9682565331459045
after epoch: 26,now: 2024-07-11 01:58:43.870006,epoch time: 0:21:30.998301,used: 9:53:11.277156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9918356, 'precision': 0.99333453, 'recall': 0.9850993, 'specificity': 0.9850993, 'f1': 0.9891294, 'auroc': 0.99873775, 'binary_precision': 0.99630105, 'binary_recall': 0.9714246, 'binary_specificity': 0.998774, 'binary_f1_score': 0.9837055}
confusion matrix:
       0      1
0  42362     52
1    412  14006
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.7470814, 'recall': 0.7629459, 'specificity': 0.7629459, 'f1': 0.7547364, 'auroc': 0.9216418, 'binary_precision': 0.5111421, 'binary_recall': 0.54531944, 'binary_specificity': 0.98057234, 'binary_f1_score': 0.5276779}
confusion matrix:
       0    1
0  17716  351
1    306  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.80344737, 'recall': 0.7117578, 'specificity': 0.7117578, 'f1': 0.74850816, 'auroc': 0.904912, 'binary_precision': 0.6312849, 'binary_recall': 0.43461537, 'binary_specificity': 0.9889001, 'binary_f1_score': 0.51480633}
confusion matrix:
      0    1
0  5880   66
1   147  113
early stop counter: 11
val acc:0.9649413228034973, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9618111252784729 / 0.9682565331459045
after epoch: 27,now: 2024-07-11 02:20:14.339612,epoch time: 0:21:30.469606,used: 10:14:41.746762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99030477, 'precision': 0.9924386, 'recall': 0.9819702, 'specificity': 0.9819702, 'f1': 0.987063, 'auroc': 0.99863255, 'binary_precision': 0.99663395, 'binary_recall': 0.96504855, 'binary_specificity': 0.99889183, 'binary_f1_score': 0.98058695}
confusion matrix:
       0      1
0  42365     47
1    504  13916
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.74947673, 'recall': 0.6980226, 'specificity': 0.6980226, 'f1': 0.7204538, 'auroc': 0.9175065, 'binary_precision': 0.5207547, 'binary_recall': 0.410104, 'binary_specificity': 0.98594123, 'binary_f1_score': 0.45885286}
confusion matrix:
       0    1
0  17813  254
1    397  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.82704294, 'recall': 0.6544969, 'specificity': 0.6544969, 'f1': 0.7068134, 'auroc': 0.9039912, 'binary_precision': 0.68333334, 'binary_recall': 0.31538463, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.43157896}
confusion matrix:
      0   1
0  5908  38
1   178  82
early stop counter: 12
val acc:0.9652614593505859, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9618111252784729 / 0.9682565331459045
after epoch: 28,now: 2024-07-11 02:41:44.967614,epoch time: 0:21:30.628002,used: 10:36:12.374764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9925218, 'precision': 0.9931321, 'recall': 0.9870943, 'specificity': 0.9870943, 'f1': 0.99006605, 'auroc': 0.9990163, 'binary_precision': 0.9943483, 'binary_recall': 0.9760749, 'binary_specificity': 0.99811375, 'binary_f1_score': 0.98512685}
confusion matrix:
       0      1
0  42332     80
1    345  14075
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.74747205, 'recall': 0.72366154, 'specificity': 0.72366154, 'f1': 0.7348939, 'auroc': 0.9180526, 'binary_precision': 0.5148515, 'binary_recall': 0.46359584, 'binary_specificity': 0.9837272, 'binary_f1_score': 0.48788118}
confusion matrix:
       0    1
0  17773  294
1    361  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.80972266, 'recall': 0.6914448, 'specificity': 0.6914448, 'f1': 0.735098, 'auroc': 0.9009057, 'binary_precision': 0.6455696, 'binary_recall': 0.3923077, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.48803827}
confusion matrix:
      0    1
0  5890   56
1   158  102
early stop counter: 13
val acc:0.9650480151176453, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9618111252784729 / 0.9682565331459045
after epoch: 29,now: 2024-07-11 03:03:15.723042,epoch time: 0:21:30.755428,used: 10:57:43.130192,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9921699, 'precision': 0.99331987, 'recall': 0.985988, 'specificity': 0.985988, 'f1': 0.9895845, 'auroc': 0.9989761, 'binary_precision': 0.9956022, 'binary_recall': 0.97343785, 'binary_specificity': 0.9985382, 'binary_f1_score': 0.98439527}
confusion matrix:
       0      1
0  42351     62
1    383  14036
---- Validation: 
scalar performance:
{'acc': 0.96584845, 'precision': 0.7537209, 'recall': 0.73552096, 'specificity': 0.73552096, 'f1': 0.7442427, 'auroc': 0.9163387, 'binary_precision': 0.5264847, 'binary_recall': 0.48736998, 'binary_specificity': 0.9836719, 'binary_f1_score': 0.5061728}
confusion matrix:
       0    1
0  17772  295
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.84107447, 'recall': 0.6624415, 'specificity': 0.6624415, 'f1': 0.7170359, 'auroc': 0.8988685, 'binary_precision': 0.7107438, 'binary_recall': 0.33076924, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.45144358}
confusion matrix:
      0   1
0  5911  35
1   174  86
early stop counter: 14
val acc:0.965848445892334, best validation acc: 0.9665421843528748, corresponding to test acc:                         0.9618111252784729 / 0.9682565331459045
after epoch: 30,now: 2024-07-11 03:24:46.210178,epoch time: 0:21:30.487136,used: 11:19:13.617328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_05_32_seed_1_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:19:13.617328 at 2024-07-11 03:24:46.210178
persisted model performance metric: 

scalar performance:
{'acc': 0.9618111, 'precision': 0.7721896, 'recall': 0.66928184, 'specificity': 0.66928184, 'f1': 0.707303, 'auroc': 0.90780663, 'binary_precision': 0.572327, 'binary_recall': 0.35, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.4343675}
confusion matrix:
      0   1
0  5878  68
1   169  91
oracle model performance metric: 

scalar performance:
{'acc': 0.96825653, 'precision': 0.82140505, 'recall': 0.738849, 'specificity': 0.738849, 'f1': 0.7733613, 'auroc': 0.9196771, 'binary_precision': 0.66492146, 'binary_recall': 0.48846152, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.56319284}
confusion matrix:
      0    1
0  5882   64
1   133  127
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 247388 KiB |   4095 MiB |   5944 TiB |   5944 TiB |
|       from large pool | 229909 KiB |   4076 MiB |   5877 TiB |   5877 TiB |
|       from small pool |  17479 KiB |     37 MiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 247388 KiB |   4095 MiB |   5944 TiB |   5944 TiB |
|       from large pool | 229909 KiB |   4076 MiB |   5877 TiB |   5877 TiB |
|       from small pool |  17479 KiB |     37 MiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 244355 KiB |   4093 MiB |   5944 TiB |   5944 TiB |
|       from large pool | 227875 KiB |   4074 MiB |   5877 TiB |   5877 TiB |
|       from small pool |  16480 KiB |     36 MiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4484 MiB |   4494 MiB |   8692 MiB |   4208 MiB |
|       from large pool |   4446 MiB |   4452 MiB |   8636 MiB |   4190 MiB |
|       from small pool |     38 MiB |     42 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47524 KiB | 394288 KiB |   3007 TiB |   3007 TiB |
|       from large pool |  38379 KiB | 393106 KiB |   2940 TiB |   2940 TiB |
|       from small pool |   9145 KiB |  18291 KiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7605    |     801 M  |     801 M  |
|       from large pool |      79    |     423    |     550 M  |     550 M  |
|       from small pool |    2875    |    7525    |     251 M  |     251 M  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7605    |     801 M  |     801 M  |
|       from large pool |      79    |     423    |     550 M  |     550 M  |
|       from small pool |    2875    |    7525    |     251 M  |     251 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     203    |     205    |     384    |     181    |
|       from large pool |     184    |     184    |     356    |     172    |
|       from small pool |      19    |      21    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3586    |  517378 K  |  517378 K  |
|       from large pool |       8    |     183    |  386929 K  |  386929 K  |
|       from small pool |      23    |    3576    |  130449 K  |  130449 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   4095 MiB |   5944 TiB |   5944 TiB |
|       from large pool |  65536 KiB |   4076 MiB |   5877 TiB |   5877 TiB |
|       from small pool |      0 KiB |     37 MiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   4095 MiB |   5944 TiB |   5944 TiB |
|       from large pool |  65536 KiB |   4076 MiB |   5877 TiB |   5877 TiB |
|       from small pool |      0 KiB |     37 MiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   4093 MiB |   5944 TiB |   5944 TiB |
|       from large pool |  65536 KiB |   4074 MiB |   5877 TiB |   5877 TiB |
|       from small pool |      0 KiB |     36 MiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 294912 KiB |   4494 MiB |   8692 MiB |   8404 MiB |
|       from large pool | 268288 KiB |   4452 MiB |   8636 MiB |   8374 MiB |
|       from small pool |  26624 KiB |     42 MiB |     56 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 394288 KiB |   3007 TiB |   3007 TiB |
|       from large pool |      0 B   | 393106 KiB |   2940 TiB |   2940 TiB |
|       from small pool |      0 B   |  20351 KiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |     801 M  |     801 M  |
|       from large pool |       2    |     423    |     550 M  |     550 M  |
|       from small pool |       0    |    7525    |     251 M  |     251 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |     801 M  |     801 M  |
|       from large pool |       2    |     423    |     550 M  |     550 M  |
|       from small pool |       0    |    7525    |     251 M  |     251 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     205    |     384    |     359    |
|       from large pool |      12    |     184    |     356    |     344    |
|       from small pool |      13    |      21    |      28    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3586    |  517379 K  |  517379 K  |
|       from large pool |       0    |     183    |  386929 K  |  386929 K  |
|       from small pool |       0    |    3576    |  130450 K  |  130450 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   4095 MiB |   5944 TiB |   5944 TiB |
|       from large pool |  65536 KiB |   4076 MiB |   5877 TiB |   5877 TiB |
|       from small pool |      0 KiB |     37 MiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   4095 MiB |   5944 TiB |   5944 TiB |
|       from large pool |  65536 KiB |   4076 MiB |   5877 TiB |   5877 TiB |
|       from small pool |      0 KiB |     37 MiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   4093 MiB |   5944 TiB |   5944 TiB |
|       from large pool |  65536 KiB |   4074 MiB |   5877 TiB |   5877 TiB |
|       from small pool |      0 KiB |     36 MiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 294912 KiB |   4494 MiB |   8692 MiB |   8404 MiB |
|       from large pool | 268288 KiB |   4452 MiB |   8636 MiB |   8374 MiB |
|       from small pool |  26624 KiB |     42 MiB |     56 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 394288 KiB |   3007 TiB |   3007 TiB |
|       from large pool |      0 B   | 393106 KiB |   2940 TiB |   2940 TiB |
|       from small pool |      0 B   |  20351 KiB |     67 TiB |     67 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |     801 M  |     801 M  |
|       from large pool |       2    |     423    |     550 M  |     550 M  |
|       from small pool |       0    |    7525    |     251 M  |     251 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |     801 M  |     801 M  |
|       from large pool |       2    |     423    |     550 M  |     550 M  |
|       from small pool |       0    |    7525    |     251 M  |     251 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     205    |     384    |     359    |
|       from large pool |      12    |     184    |     356    |     344    |
|       from small pool |      13    |      21    |      28    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3586    |  517379 K  |  517379 K  |
|       from large pool |       0    |     183    |  386929 K  |  386929 K  |
|       from small pool |       0    |    3576    |  130450 K  |  130450 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616

 Experiment start at: 2024-07-11 03:37:55.756260
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96660864, 'precision': 0.9689423, 'recall': 0.9444709, 'specificity': 0.9444709, 'f1': 0.9558469, 'auroc': 0.98771405, 'binary_precision': 0.9734805, 'binary_recall': 0.8976867, 'binary_specificity': 0.99125504, 'binary_f1_score': 0.93404865}
confusion matrix:
       0      1
0  41940    370
1   1548  13582
---- Validation: 
scalar performance:
{'acc': 0.96478987, 'precision': 0.69338745, 'recall': 0.60919726, 'specificity': 0.60919726, 'f1': 0.6382507, 'auroc': 0.8554949, 'binary_precision': 0.4119403, 'binary_recall': 0.22923589, 'binary_specificity': 0.9891586, 'binary_f1_score': 0.2945571}
confusion matrix:
       0    1
0  17974  197
1    464  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957365, 'precision': 0.6875793, 'recall': 0.6011015, 'specificity': 0.6011015, 'f1': 0.62955606, 'auroc': 0.85446584, 'binary_precision': 0.40625, 'binary_recall': 0.21487603, 'binary_specificity': 0.987327, 'binary_f1_score': 0.28108105}
confusion matrix:
      0   1
0  5921  76
1   190  52
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 04:00:07.776235,epoch time: 0:22:12.019975,used: 0:22:12.019975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97372913, 'precision': 0.9759914, 'recall': 0.9560127, 'specificity': 0.9560127, 'f1': 0.9654367, 'auroc': 0.99179053, 'binary_precision': 0.98045856, 'binary_recall': 0.91857237, 'binary_specificity': 0.9934531, 'binary_f1_score': 0.9485071}
confusion matrix:
       0      1
0  42033    277
1   1232  13898
---- Validation: 
scalar performance:
{'acc': 0.9617003, 'precision': 0.68361807, 'recall': 0.6614055, 'specificity': 0.6614055, 'f1': 0.6717049, 'auroc': 0.88556254, 'binary_precision': 0.3889943, 'binary_recall': 0.34053156, 'binary_specificity': 0.9822795, 'binary_f1_score': 0.36315325}
confusion matrix:
       0    1
0  17849  322
1    397  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.72641367, 'recall': 0.6738142, 'specificity': 0.6738142, 'f1': 0.6962011, 'auroc': 0.8894186, 'binary_precision': 0.47826087, 'binary_recall': 0.36363637, 'binary_specificity': 0.983992, 'binary_f1_score': 0.41314554}
confusion matrix:
      0   1
0  5901  96
1   154  88
new oracle model saved
early stop counter: 1
val acc:0.9617003202438354, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9599294662475586
after epoch: 2,now: 2024-07-11 04:21:49.837094,epoch time: 0:21:42.060859,used: 0:43:54.080834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9774721, 'precision': 0.97741544, 'recall': 0.9642217, 'specificity': 0.9642217, 'f1': 0.9705707, 'auroc': 0.99412405, 'binary_precision': 0.97730094, 'binary_recall': 0.93621945, 'binary_specificity': 0.99222404, 'binary_f1_score': 0.9563192}
confusion matrix:
       0      1
0  41981    329
1    965  14165
---- Validation: 
scalar performance:
{'acc': 0.96127415, 'precision': 0.6924692, 'recall': 0.7069591, 'specificity': 0.7069591, 'f1': 0.6994173, 'auroc': 0.8986872, 'binary_precision': 0.403698, 'binary_recall': 0.43521595, 'binary_specificity': 0.9787023, 'binary_f1_score': 0.41886494}
confusion matrix:
       0    1
0  17784  387
1    340  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.7332059, 'recall': 0.69595784, 'specificity': 0.69595784, 'f1': 0.712752, 'auroc': 0.90316147, 'binary_precision': 0.490099, 'binary_recall': 0.4090909, 'binary_specificity': 0.98282474, 'binary_f1_score': 0.44594592}
confusion matrix:
      0    1
0  5894  103
1   143   99
new oracle model saved
early stop counter: 2
val acc:0.9612741470336914, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9605706334114075
after epoch: 3,now: 2024-07-11 04:43:26.968195,epoch time: 0:21:37.131101,used: 1:05:31.211935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97806406, 'precision': 0.98302495, 'recall': 0.9605213, 'specificity': 0.9605213, 'f1': 0.9710717, 'auroc': 0.9949351, 'binary_precision': 0.99275154, 'binary_recall': 0.9234532, 'binary_specificity': 0.99758935, 'binary_f1_score': 0.95684934}
confusion matrix:
       0      1
0  42210    102
1   1158  13970
---- Validation: 
scalar performance:
{'acc': 0.9645235, 'precision': 0.704187, 'recall': 0.65724254, 'specificity': 0.65724254, 'f1': 0.6773134, 'auroc': 0.8981176, 'binary_precision': 0.4304348, 'binary_recall': 0.32890365, 'binary_specificity': 0.9855814, 'binary_f1_score': 0.37288132}
confusion matrix:
       0    1
0  17909  262
1    404  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.76788384, 'recall': 0.6521057, 'specificity': 0.6521057, 'f1': 0.6922948, 'auroc': 0.9033077, 'binary_precision': 0.56296295, 'binary_recall': 0.3140496, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.403183}
confusion matrix:
      0   1
0  5938  59
1   166  76
new oracle model saved
early stop counter: 3
val acc:0.9645234942436218, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 4,now: 2024-07-11 05:05:08.753045,epoch time: 0:21:41.784850,used: 1:27:12.996785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9812152, 'precision': 0.98170114, 'recall': 0.9696922, 'specificity': 0.9696922, 'f1': 0.9754933, 'auroc': 0.9959529, 'binary_precision': 0.98268634, 'binary_recall': 0.9453404, 'binary_specificity': 0.99404395, 'binary_f1_score': 0.96365166}
confusion matrix:
       0      1
0  42058    252
1    827  14303
---- Validation: 
scalar performance:
{'acc': 0.9587706, 'precision': 0.6827054, 'recall': 0.72172683, 'specificity': 0.72172683, 'f1': 0.7000741, 'auroc': 0.90073633, 'binary_precision': 0.3831522, 'binary_recall': 0.46843854, 'binary_specificity': 0.97501516, 'binary_f1_score': 0.42152464}
confusion matrix:
       0    1
0  17717  454
1    320  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95640326, 'precision': 0.7055757, 'recall': 0.6957728, 'specificity': 0.6957728, 'f1': 0.7005367, 'auroc': 0.8998755, 'binary_precision': 0.4347826, 'binary_recall': 0.41322315, 'binary_specificity': 0.9783225, 'binary_f1_score': 0.4237288}
confusion matrix:
      0    1
0  5867  130
1   142  100
early stop counter: 4
val acc:0.9587705731391907, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 5,now: 2024-07-11 05:26:57.883859,epoch time: 0:21:49.130814,used: 1:49:02.127599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98366994, 'precision': 0.9858544, 'recall': 0.97199535, 'specificity': 0.97199535, 'f1': 0.9786577, 'auroc': 0.99635154, 'binary_precision': 0.9902584, 'binary_recall': 0.9473232, 'binary_specificity': 0.99666744, 'binary_f1_score': 0.9683151}
confusion matrix:
       0      1
0  42169    141
1    797  14333
---- Validation: 
scalar performance:
{'acc': 0.9618601, 'precision': 0.6966144, 'recall': 0.710474, 'specificity': 0.710474, 'f1': 0.7032782, 'auroc': 0.9055464, 'binary_precision': 0.4117647, 'binary_recall': 0.44186047, 'binary_specificity': 0.97908753, 'binary_f1_score': 0.42628208}
confusion matrix:
       0    1
0  17791  380
1    336  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.7431468, 'recall': 0.67878014, 'specificity': 0.67878014, 'f1': 0.70544374, 'auroc': 0.90053546, 'binary_precision': 0.5113636, 'binary_recall': 0.37190083, 'binary_specificity': 0.9856595, 'binary_f1_score': 0.43062204}
confusion matrix:
      0   1
0  5911  86
1   152  90
early stop counter: 5
val acc:0.9618601202964783, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 6,now: 2024-07-11 05:48:44.371946,epoch time: 0:21:46.488087,used: 2:10:48.615686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9842444, 'precision': 0.9856818, 'recall': 0.9736166, 'specificity': 0.9736166, 'f1': 0.9794462, 'auroc': 0.99726194, 'binary_precision': 0.98859656, 'binary_recall': 0.9511566, 'binary_specificity': 0.9960766, 'binary_f1_score': 0.96951526}
confusion matrix:
       0      1
0  42144    166
1    739  14391
---- Validation: 
scalar performance:
{'acc': 0.9564268, 'precision': 0.67762864, 'recall': 0.74460757, 'specificity': 0.74460757, 'f1': 0.7050378, 'auroc': 0.9065132, 'binary_precision': 0.37142858, 'binary_recall': 0.5182724, 'binary_specificity': 0.97094274, 'binary_f1_score': 0.4327323}
confusion matrix:
       0    1
0  17643  528
1    290  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9517551, 'precision': 0.6869665, 'recall': 0.7171478, 'specificity': 0.7171478, 'f1': 0.70074236, 'auroc': 0.8965626, 'binary_precision': 0.39575973, 'binary_recall': 0.46280992, 'binary_specificity': 0.97148573, 'binary_f1_score': 0.42666668}
confusion matrix:
      0    1
0  5826  171
1   130  112
early stop counter: 6
val acc:0.9564267992973328, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 7,now: 2024-07-11 06:10:37.387189,epoch time: 0:21:53.015243,used: 2:32:41.630929,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.985585, 'precision': 0.9866618, 'recall': 0.97609615, 'specificity': 0.97609615, 'f1': 0.98122334, 'auroc': 0.99742734, 'binary_precision': 0.9888562, 'binary_recall': 0.9560447, 'binary_specificity': 0.9961476, 'binary_f1_score': 0.9721737}
confusion matrix:
       0      1
0  42148    163
1    665  14464
---- Validation: 
scalar performance:
{'acc': 0.9590369, 'precision': 0.688671, 'recall': 0.7435467, 'specificity': 0.7435467, 'f1': 0.7121494, 'auroc': 0.9094185, 'binary_precision': 0.39363056, 'binary_recall': 0.51328903, 'binary_specificity': 0.9738044, 'binary_f1_score': 0.44556594}
confusion matrix:
       0    1
0  17695  476
1    293  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.7266995, 'recall': 0.7014058, 'specificity': 0.7014058, 'f1': 0.71320343, 'auroc': 0.901049, 'binary_precision': 0.47663552, 'binary_recall': 0.4214876, 'binary_specificity': 0.981324, 'binary_f1_score': 0.4473684}
confusion matrix:
      0    1
0  5885  112
1   140  102
early stop counter: 7
val acc:0.9590368866920471, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 8,now: 2024-07-11 06:32:34.774853,epoch time: 0:21:57.387664,used: 2:54:39.018593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98635095, 'precision': 0.9871851, 'recall': 0.9775516, 'specificity': 0.9775516, 'f1': 0.982239, 'auroc': 0.9975828, 'binary_precision': 0.9888904, 'binary_recall': 0.9589557, 'binary_specificity': 0.99614745, 'binary_f1_score': 0.973693}
confusion matrix:
       0      1
0  42147    163
1    621  14509
---- Validation: 
scalar performance:
{'acc': 0.9590369, 'precision': 0.6885083, 'recall': 0.7427437, 'specificity': 0.7427437, 'f1': 0.7117497, 'auroc': 0.90728676, 'binary_precision': 0.3933589, 'binary_recall': 0.5116279, 'binary_specificity': 0.9738594, 'binary_f1_score': 0.44476536}
confusion matrix:
       0    1
0  17696  475
1    294  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95928836, 'precision': 0.72406876, 'recall': 0.6972736, 'specificity': 0.6972736, 'f1': 0.7097021, 'auroc': 0.89508975, 'binary_precision': 0.4716981, 'binary_recall': 0.41322315, 'binary_specificity': 0.981324, 'binary_f1_score': 0.44052863}
confusion matrix:
      0    1
0  5885  112
1   142  100
early stop counter: 8
val acc:0.9590368866920471, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 9,now: 2024-07-11 06:54:24.240201,epoch time: 0:21:49.465348,used: 3:16:28.483941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98776114, 'precision': 0.9893608, 'recall': 0.97906077, 'specificity': 0.97906077, 'f1': 0.9840639, 'auroc': 0.9976056, 'binary_precision': 0.99262446, 'binary_recall': 0.96067417, 'binary_specificity': 0.99744743, 'binary_f1_score': 0.97638804}
confusion matrix:
       0      1
0  42202    108
1    595  14535
---- Validation: 
scalar performance:
{'acc': 0.9615405, 'precision': 0.6980606, 'recall': 0.7271729, 'specificity': 0.7271729, 'f1': 0.71149194, 'auroc': 0.9078232, 'binary_precision': 0.41354465, 'binary_recall': 0.47674417, 'binary_specificity': 0.97760165, 'binary_f1_score': 0.4429012}
confusion matrix:
       0    1
0  17764  407
1    315  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.7312355, 'recall': 0.6464727, 'specificity': 0.6464727, 'f1': 0.67815864, 'auroc': 0.8936274, 'binary_precision': 0.49006623, 'binary_recall': 0.30578512, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.3765903}
confusion matrix:
      0   1
0  5920  77
1   168  74
early stop counter: 9
val acc:0.9615405201911926, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 10,now: 2024-07-11 07:16:22.141393,epoch time: 0:21:57.901192,used: 3:38:26.385133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9871518, 'precision': 0.988592, 'recall': 0.9782425, 'specificity': 0.9782425, 'f1': 0.9832686, 'auroc': 0.99759996, 'binary_precision': 0.99152946, 'binary_recall': 0.9594157, 'binary_specificity': 0.9970693, 'binary_f1_score': 0.9752083}
confusion matrix:
       0      1
0  42187    124
1    614  14515
---- Validation: 
scalar performance:
{'acc': 0.9579716, 'precision': 0.6839429, 'recall': 0.74379945, 'specificity': 0.74379945, 'f1': 0.7090974, 'auroc': 0.9105517, 'binary_precision': 0.3841388, 'binary_recall': 0.51495016, 'binary_specificity': 0.97264874, 'binary_f1_score': 0.44002837}
confusion matrix:
       0    1
0  17674  497
1    292  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589678, 'precision': 0.7185752, 'recall': 0.67133117, 'specificity': 0.67133117, 'f1': 0.6917014, 'auroc': 0.89418036, 'binary_precision': 0.46276596, 'binary_recall': 0.35950413, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.40465117}
confusion matrix:
      0    1
0  5896  101
1   155   87
early stop counter: 10
val acc:0.9579715728759766, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 11,now: 2024-07-11 07:38:29.910266,epoch time: 0:22:07.768873,used: 4:00:34.154006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98814416, 'precision': 0.98871756, 'recall': 0.98065823, 'specificity': 0.98065823, 'f1': 0.9845975, 'auroc': 0.9979302, 'binary_precision': 0.98989624, 'binary_recall': 0.9648381, 'binary_specificity': 0.9964784, 'binary_f1_score': 0.9772065}
confusion matrix:
       0      1
0  42161    149
1    532  14598
---- Validation: 
scalar performance:
{'acc': 0.9554147, 'precision': 0.67604995, 'recall': 0.75532746, 'specificity': 0.75532746, 'f1': 0.70733225, 'auroc': 0.9108385, 'binary_precision': 0.367531, 'binary_recall': 0.5415282, 'binary_specificity': 0.96912664, 'binary_f1_score': 0.43787777}
confusion matrix:
       0    1
0  17610  561
1    276  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957365, 'precision': 0.71043587, 'recall': 0.69032484, 'specificity': 0.69032484, 'f1': 0.6998028, 'auroc': 0.8960744, 'binary_precision': 0.44495413, 'binary_recall': 0.40082645, 'binary_specificity': 0.97982323, 'binary_f1_score': 0.42173913}
confusion matrix:
      0    1
0  5876  121
1   145   97
early stop counter: 11
val acc:0.9554147124290466, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 12,now: 2024-07-11 08:00:11.821016,epoch time: 0:21:41.910750,used: 4:22:16.064756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98938024, 'precision': 0.989413, 'recall': 0.98315126, 'specificity': 0.98315126, 'f1': 0.9862275, 'auroc': 0.9981772, 'binary_precision': 0.9894808, 'binary_recall': 0.9699894, 'binary_specificity': 0.9963131, 'binary_f1_score': 0.9796381}
confusion matrix:
       0      1
0  42156    156
1    454  14674
---- Validation: 
scalar performance:
{'acc': 0.95424277, 'precision': 0.67425865, 'recall': 0.7667678, 'specificity': 0.7667678, 'f1': 0.70935595, 'auroc': 0.9117178, 'binary_precision': 0.3631523, 'binary_recall': 0.5664452, 'binary_specificity': 0.9670904, 'binary_f1_score': 0.44256976}
confusion matrix:
       0    1
0  17573  598
1    261  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9554416, 'precision': 0.700037, 'recall': 0.69527256, 'specificity': 0.69527256, 'f1': 0.6976217, 'auroc': 0.8947972, 'binary_precision': 0.42372882, 'binary_recall': 0.41322315, 'binary_specificity': 0.977322, 'binary_f1_score': 0.41841006}
confusion matrix:
      0    1
0  5861  136
1   142  100
early stop counter: 12
val acc:0.9542427659034729, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 13,now: 2024-07-11 08:22:10.162561,epoch time: 0:21:58.341545,used: 4:44:14.406301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98948467, 'precision': 0.99041885, 'recall': 0.9824375, 'specificity': 0.9824375, 'f1': 0.9863399, 'auroc': 0.99816036, 'binary_precision': 0.9923395, 'binary_recall': 0.96754575, 'binary_specificity': 0.9973293, 'binary_f1_score': 0.9797858}
confusion matrix:
       0      1
0  42198    113
1    491  14638
---- Validation: 
scalar performance:
{'acc': 0.95946306, 'precision': 0.6910168, 'recall': 0.74537295, 'specificity': 0.74537295, 'f1': 0.71435165, 'auroc': 0.91126794, 'binary_precision': 0.39820743, 'binary_recall': 0.5166113, 'binary_specificity': 0.9741346, 'binary_f1_score': 0.4497469}
confusion matrix:
       0    1
0  17701  470
1    291  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96025, 'precision': 0.72561145, 'recall': 0.6382916, 'specificity': 0.6382916, 'f1': 0.67015594, 'auroc': 0.8956599, 'binary_precision': 0.47945204, 'binary_recall': 0.2892562, 'binary_specificity': 0.987327, 'binary_f1_score': 0.36082473}
confusion matrix:
      0   1
0  5921  76
1   172  70
early stop counter: 13
val acc:0.9594630599021912, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 14,now: 2024-07-11 08:44:24.409930,epoch time: 0:22:14.247369,used: 5:06:28.653670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9895021, 'precision': 0.9913607, 'recall': 0.98157775, 'specificity': 0.98157775, 'f1': 0.98633736, 'auroc': 0.99853003, 'binary_precision': 0.9951592, 'binary_recall': 0.96483344, 'binary_specificity': 0.998322, 'binary_f1_score': 0.9797617}
confusion matrix:
       0      1
0  42241     71
1    532  14596
---- Validation: 
scalar performance:
{'acc': 0.96004903, 'precision': 0.6877668, 'recall': 0.7159628, 'specificity': 0.7159628, 'f1': 0.7007486, 'auroc': 0.90607345, 'binary_precision': 0.39367816, 'binary_recall': 0.4551495, 'binary_specificity': 0.9767762, 'binary_f1_score': 0.42218795}
confusion matrix:
       0    1
0  17749  422
1    328  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9554416, 'precision': 0.66702914, 'recall': 0.5941528, 'specificity': 0.5941528, 'f1': 0.6188334, 'auroc': 0.8841568, 'binary_precision': 0.36567163, 'binary_recall': 0.20247933, 'binary_specificity': 0.98582625, 'binary_f1_score': 0.26063827}
confusion matrix:
      0   1
0  5912  85
1   193  49
early stop counter: 14
val acc:0.960049033164978, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 15,now: 2024-07-11 09:06:42.862750,epoch time: 0:22:18.452820,used: 5:28:47.106490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9891539, 'precision': 0.99068034, 'recall': 0.98134255, 'specificity': 0.98134255, 'f1': 0.985891, 'auroc': 0.99827695, 'binary_precision': 0.99380445, 'binary_recall': 0.96483576, 'binary_specificity': 0.9978493, 'binary_f1_score': 0.9791059}
confusion matrix:
       0      1
0  42220     91
1    532  14597
---- Validation: 
scalar performance:
{'acc': 0.9632451, 'precision': 0.70690256, 'recall': 0.720826, 'specificity': 0.720826, 'f1': 0.7136099, 'auroc': 0.910216, 'binary_precision': 0.431677, 'binary_recall': 0.46179402, 'binary_specificity': 0.97985804, 'binary_f1_score': 0.44622794}
confusion matrix:
       0    1
0  17805  366
1    324  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.77351815, 'recall': 0.61228406, 'specificity': 0.61228406, 'f1': 0.65584177, 'auroc': 0.89341295, 'binary_precision': 0.57731956, 'binary_recall': 0.23140496, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.3303835}
confusion matrix:
      0   1
0  5956  41
1   186  56
early stop counter: 15
val acc:0.9632450938224792, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 16,now: 2024-07-11 09:28:57.701121,epoch time: 0:22:14.838371,used: 5:51:01.944861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98948467, 'precision': 0.9917532, 'recall': 0.9811636, 'specificity': 0.9811636, 'f1': 0.9863042, 'auroc': 0.9984439, 'binary_precision': 0.9963775, 'binary_recall': 0.9635799, 'binary_specificity': 0.99874735, 'binary_f1_score': 0.9797043}
confusion matrix:
       0      1
0  42258     53
1    551  14578
---- Validation: 
scalar performance:
{'acc': 0.9646833, 'precision': 0.7110865, 'recall': 0.68623483, 'specificity': 0.68623483, 'f1': 0.6977932, 'auroc': 0.90558493, 'binary_precision': 0.44234404, 'binary_recall': 0.38870433, 'binary_specificity': 0.98376536, 'binary_f1_score': 0.41379312}
confusion matrix:
       0    1
0  17876  295
1    368  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.7175376, 'recall': 0.5729445, 'specificity': 0.5729445, 'f1': 0.605106, 'auroc': 0.88162744, 'binary_precision': 0.46835443, 'binary_recall': 0.15289256, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.23052959}
confusion matrix:
      0   1
0  5955  42
1   205  37
early stop counter: 16
val acc:0.9646832942962646, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 17,now: 2024-07-11 09:51:35.831439,epoch time: 0:22:38.130318,used: 6:13:40.075179,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9900766, 'precision': 0.9913926, 'recall': 0.9830092, 'specificity': 0.9830092, 'f1': 0.9871039, 'auroc': 0.9984795, 'binary_precision': 0.9940949, 'binary_recall': 0.96807456, 'binary_specificity': 0.9979438, 'binary_f1_score': 0.98091227}
confusion matrix:
       0      1
0  42224     87
1    483  14646
---- Validation: 
scalar performance:
{'acc': 0.95919675, 'precision': 0.6917684, 'recall': 0.75567496, 'specificity': 0.75567496, 'f1': 0.71853715, 'auroc': 0.9154184, 'binary_precision': 0.39901477, 'binary_recall': 0.538206, 'binary_specificity': 0.973144, 'binary_f1_score': 0.4582744}
confusion matrix:
       0    1
0  17683  488
1    278  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.7176619, 'recall': 0.6378747, 'specificity': 0.6378747, 'f1': 0.6676495, 'auroc': 0.89408135, 'binary_precision': 0.46357617, 'binary_recall': 0.2892562, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.35623407}
confusion matrix:
      0   1
0  5916  81
1   172  70
early stop counter: 17
val acc:0.9591967463493347, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 18,now: 2024-07-11 10:14:06.897812,epoch time: 0:22:31.066373,used: 6:36:11.141552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99086004, 'precision': 0.99105304, 'recall': 0.9853465, 'specificity': 0.9853465, 'f1': 0.9881546, 'auroc': 0.99867666, 'binary_precision': 0.991453, 'binary_recall': 0.9736946, 'binary_specificity': 0.99699837, 'binary_f1_score': 0.9824936}
confusion matrix:
       0      1
0  42183    127
1    398  14732
---- Validation: 
scalar performance:
{'acc': 0.9607415, 'precision': 0.70051324, 'recall': 0.7645035, 'specificity': 0.7645035, 'f1': 0.72752625, 'auroc': 0.9168601, 'binary_precision': 0.41594023, 'binary_recall': 0.55481726, 'binary_specificity': 0.97418964, 'binary_f1_score': 0.47544482}
confusion matrix:
       0    1
0  17702  469
1    268  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.76767695, 'recall': 0.6321115, 'specificity': 0.6321115, 'f1': 0.67447853, 'auroc': 0.89664817, 'binary_precision': 0.5641026, 'binary_recall': 0.27272728, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.367688}
confusion matrix:
      0   1
0  5946  51
1   176  66
early stop counter: 18
val acc:0.9607415199279785, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 19,now: 2024-07-11 10:36:34.649201,epoch time: 0:22:27.751389,used: 6:58:38.892941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99051183, 'precision': 0.99170923, 'recall': 0.9838142, 'specificity': 0.9838142, 'f1': 0.98767567, 'auroc': 0.9985887, 'binary_precision': 0.99417186, 'binary_recall': 0.96966094, 'binary_specificity': 0.9979674, 'binary_f1_score': 0.9817634}
confusion matrix:
       0      1
0  42225     86
1    459  14670
---- Validation: 
scalar performance:
{'acc': 0.9627657, 'precision': 0.7077268, 'recall': 0.7438668, 'specificity': 0.7438668, 'f1': 0.7241698, 'auroc': 0.9150475, 'binary_precision': 0.4317862, 'binary_recall': 0.5099668, 'binary_specificity': 0.97776675, 'binary_f1_score': 0.46763137}
confusion matrix:
       0    1
0  17767  404
1    295  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.782022, 'recall': 0.600471, 'specificity': 0.600471, 'f1': 0.64407533, 'auroc': 0.89682174, 'binary_precision': 0.5952381, 'binary_recall': 0.20661157, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.30674845}
confusion matrix:
      0   1
0  5963  34
1   192  50
early stop counter: 19
val acc:0.9627656936645508, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 20,now: 2024-07-11 10:59:11.845965,epoch time: 0:22:37.196764,used: 7:21:16.089705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99068594, 'precision': 0.9916296, 'recall': 0.98433673, 'specificity': 0.98433673, 'f1': 0.9879097, 'auroc': 0.99853325, 'binary_precision': 0.99357456, 'binary_recall': 0.9709187, 'binary_specificity': 0.9977547, 'binary_f1_score': 0.982116}
confusion matrix:
       0      1
0  42215     95
1    440  14690
---- Validation: 
scalar performance:
{'acc': 0.9621797, 'precision': 0.70403886, 'recall': 0.7411549, 'specificity': 0.7411549, 'f1': 0.72085345, 'auroc': 0.91441274, 'binary_precision': 0.424581, 'binary_recall': 0.50498337, 'binary_specificity': 0.9773265, 'binary_f1_score': 0.461305}
confusion matrix:
       0    1
0  17759  412
1    298  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9615323, 'precision': 0.7393901, 'recall': 0.6072348, 'specificity': 0.6072348, 'f1': 0.6452795, 'auroc': 0.8876153, 'binary_precision': 0.509434, 'binary_recall': 0.2231405, 'binary_specificity': 0.991329, 'binary_f1_score': 0.31034482}
confusion matrix:
      0   1
0  5945  52
1   188  54
early stop counter: 20
val acc:0.9621797204017639, best validation acc: 0.964789867401123, corresponding to test acc:                         0.9573649764060974 / 0.9639365077018738
after epoch: 21,now: 2024-07-11 11:21:28.617727,epoch time: 0:22:16.771762,used: 7:43:32.861467,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_37_55_seed_2_21806616
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 21 with time: 7:43:32.861467 at 2024-07-11 11:21:28.617727
persisted model performance metric: 

scalar performance:
{'acc': 0.957365, 'precision': 0.6875793, 'recall': 0.6011015, 'specificity': 0.6011015, 'f1': 0.62955606, 'auroc': 0.85446584, 'binary_precision': 0.40625, 'binary_recall': 0.21487603, 'binary_specificity': 0.987327, 'binary_f1_score': 0.28108105}
confusion matrix:
      0   1
0  5921  76
1   190  52
oracle model performance metric: 

scalar performance:
{'acc': 0.9639365, 'precision': 0.76788384, 'recall': 0.6521057, 'specificity': 0.6521057, 'f1': 0.6922948, 'auroc': 0.9033077, 'binary_precision': 0.56296295, 'binary_recall': 0.3140496, 'binary_specificity': 0.9901618, 'binary_f1_score': 0.403183}
confusion matrix:
      0   1
0  5938  59
1   166  76
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 247394 KiB |   4095 MiB |   8047 TiB |   8047 TiB |
|       from large pool | 229909 KiB |   4076 MiB |   7956 TiB |   7956 TiB |
|       from small pool |  17485 KiB |     37 MiB |     91 TiB |     91 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 247394 KiB |   4095 MiB |   8047 TiB |   8047 TiB |
|       from large pool | 229909 KiB |   4076 MiB |   7956 TiB |   7956 TiB |
|       from small pool |  17485 KiB |     37 MiB |     91 TiB |     91 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 244356 KiB |   4093 MiB |   8047 TiB |   8047 TiB |
|       from large pool | 227875 KiB |   4074 MiB |   7955 TiB |   7955 TiB |
|       from small pool |  16481 KiB |     36 MiB |     91 TiB |     91 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4484 MiB |   4494 MiB |  12888 MiB |   8404 MiB |
|       from large pool |   4446 MiB |   4452 MiB |  12820 MiB |   8374 MiB |
|       from small pool |     38 MiB |     42 MiB |     68 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47518 KiB | 394288 KiB |   4063 TiB |   4063 TiB |
|       from large pool |  38379 KiB | 393106 KiB |   3971 TiB |   3971 TiB |
|       from small pool |   9139 KiB |  20351 KiB |     92 TiB |     92 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7655    |    1085 M  |    1085 M  |
|       from large pool |      79    |     423    |     744 M  |     744 M  |
|       from small pool |    2887    |    7575    |     340 M  |     340 M  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7655    |    1085 M  |    1085 M  |
|       from large pool |      79    |     423    |     744 M  |     744 M  |
|       from small pool |    2887    |    7575    |     340 M  |     340 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     203    |     205    |     562    |     359    |
|       from large pool |     184    |     184    |     528    |     344    |
|       from small pool |      19    |      21    |      34    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      29    |    3608    |  697797 K  |  697797 K  |
|       from large pool |       8    |     183    |  517867 K  |  517867 K  |
|       from small pool |      21    |    3600    |  179929 K  |  179929 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65536 KiB |   4095 MiB |   8047 TiB |   8047 TiB |
|       from large pool |  65536 KiB |   4076 MiB |   7956 TiB |   7956 TiB |
|       from small pool |      0 KiB |     37 MiB |     91 TiB |     91 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  65536 KiB |   4095 MiB |   8047 TiB |   8047 TiB |
|       from large pool |  65536 KiB |   4076 MiB |   7956 TiB |   7956 TiB |
|       from small pool |      0 KiB |     37 MiB |     91 TiB |     91 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  65536 KiB |   4093 MiB |   8047 TiB |   8047 TiB |
|       from large pool |  65536 KiB |   4074 MiB |   7955 TiB |   7955 TiB |
|       from small pool |      0 KiB |     36 MiB |     91 TiB |     91 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 294912 KiB |   4494 MiB |  12888 MiB |  12600 MiB |
|       from large pool | 268288 KiB |   4452 MiB |  12820 MiB |  12558 MiB |
|       from small pool |  26624 KiB |     42 MiB |     68 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   | 394288 KiB |   4063 TiB |   4063 TiB |
|       from large pool |      0 B   | 393106 KiB |   3971 TiB |   3971 TiB |
|       from small pool |      0 B   |  21230 KiB |     92 TiB |     92 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7655    |    1085 M  |    1085 M  |
|       from large pool |       2    |     423    |     744 M  |     744 M  |
|       from small pool |       0    |    7575    |     340 M  |     340 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7655    |    1085 M  |    1085 M  |
|       from large pool |       2    |     423    |     744 M  |     744 M  |
|       from small pool |       0    |    7575    |     340 M  |     340 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     205    |     562    |     537    |
|       from large pool |      12    |     184    |     528    |     516    |
|       from small pool |      13    |      21    |      34    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |    3608    |  697798 K  |  697798 K  |
|       from large pool |       0    |     183    |  517867 K  |  517867 K  |
|       from small pool |       0    |    3600    |  179930 K  |  179930 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Jul 11 11:29:41 2024]
Finished job 0.
1 of 1 steps (100%) done
