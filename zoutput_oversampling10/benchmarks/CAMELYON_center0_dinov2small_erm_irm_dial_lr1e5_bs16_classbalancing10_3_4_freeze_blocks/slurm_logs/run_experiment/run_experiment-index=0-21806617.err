Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 10 02:11:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617

 Experiment start at: 2024-07-10 02:19:25.745267
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96597123, 'precision': 0.9698187, 'recall': 0.9408554, 'specificity': 0.9408554, 'f1': 0.9541806, 'auroc': 0.98690796, 'binary_precision': 0.97707075, 'binary_recall': 0.8889644, 'binary_specificity': 0.9927464, 'binary_f1_score': 0.9309375}
confusion matrix:
       0      1
0  42017    307
1   1634  13082
---- Validation: 
scalar performance:
{'acc': 0.95689654, 'precision': 0.67569953, 'recall': 0.6799128, 'specificity': 0.6799128, 'f1': 0.6777775, 'auroc': 0.8877605, 'binary_precision': 0.37329286, 'binary_recall': 0.38258165, 'binary_specificity': 0.9772439, 'binary_f1_score': 0.37788016}
confusion matrix:
       0    1
0  17736  413
1    397  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.7691303, 'recall': 0.71838313, 'specificity': 0.71838313, 'f1': 0.7407757, 'auroc': 0.906795, 'binary_precision': 0.5619048, 'binary_recall': 0.45210728, 'binary_specificity': 0.984659, 'binary_f1_score': 0.50106156}
confusion matrix:
      0    1
0  5905   92
1   143  118
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 02:44:47.741304,epoch time: 0:25:21.996037,used: 0:25:21.996037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97473705, 'precision': 0.9775722, 'recall': 0.9562037, 'specificity': 0.9562037, 'f1': 0.9662663, 'auroc': 0.99249804, 'binary_precision': 0.98304343, 'binary_recall': 0.9179125, 'binary_specificity': 0.99449486, 'binary_f1_score': 0.9493622}
confusion matrix:
       0      1
0  42091    233
1   1208  13508
---- Validation: 
scalar performance:
{'acc': 0.95732224, 'precision': 0.6914256, 'recall': 0.7363874, 'specificity': 0.7363874, 'f1': 0.71120346, 'auroc': 0.90563893, 'binary_precision': 0.40074906, 'binary_recall': 0.4992224, 'binary_specificity': 0.9735523, 'binary_f1_score': 0.44459832}
confusion matrix:
       0    1
0  17669  480
1    322  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7485795, 'recall': 0.8213254, 'specificity': 0.8213254, 'f1': 0.7795969, 'auroc': 0.9195466, 'binary_precision': 0.5116959, 'binary_recall': 0.6704981, 'binary_specificity': 0.97215277, 'binary_f1_score': 0.58043116}
confusion matrix:
      0    1
0  5830  167
1    86  175
better model found
persisted
after epoch: 2,now: 2024-07-10 03:09:34.262969,epoch time: 0:24:46.521665,used: 0:50:08.517702,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9801017, 'precision': 0.9804555, 'recall': 0.96733767, 'specificity': 0.96733767, 'f1': 0.9736618, 'auroc': 0.99413306, 'binary_precision': 0.9811561, 'binary_recall': 0.94096065, 'binary_specificity': 0.9937147, 'binary_f1_score': 0.9606381}
confusion matrix:
       0      1
0  42055    266
1    869  13850
---- Validation: 
scalar performance:
{'acc': 0.9481694, 'precision': 0.6682012, 'recall': 0.7826525, 'specificity': 0.7826525, 'f1': 0.7084408, 'auroc': 0.9127526, 'binary_precision': 0.35076645, 'binary_recall': 0.60497665, 'binary_specificity': 0.9603284, 'binary_f1_score': 0.44406393}
confusion matrix:
       0    1
0  17429  720
1    254  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9397571, 'precision': 0.68600833, 'recall': 0.8421366, 'specificity': 0.8421366, 'f1': 0.7362639, 'auroc': 0.920972, 'binary_precision': 0.384, 'binary_recall': 0.7356322, 'binary_specificity': 0.948641, 'binary_f1_score': 0.5045992}
confusion matrix:
      0    1
0  5689  308
1    69  192
early stop counter: 1
val acc:0.9481694102287292, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9595717191696167 / 0.9624480605125427
after epoch: 3,now: 2024-07-10 03:34:22.918014,epoch time: 0:24:48.655045,used: 1:14:57.172747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9804348, 'precision': 0.9841615, 'recall': 0.96472174, 'specificity': 0.96472174, 'f1': 0.973935, 'auroc': 0.9952433, 'binary_precision': 0.99140114, 'binary_recall': 0.9322552, 'binary_specificity': 0.99718827, 'binary_f1_score': 0.9609189}
confusion matrix:
       0      1
0  42204    119
1    997  13720
---- Validation: 
scalar performance:
{'acc': 0.95615155, 'precision': 0.6880914, 'recall': 0.7455319, 'specificity': 0.7455319, 'f1': 0.7124453, 'auroc': 0.9067098, 'binary_precision': 0.393404, 'binary_recall': 0.5194401, 'binary_specificity': 0.9716238, 'binary_f1_score': 0.44772115}
confusion matrix:
       0    1
0  17634  515
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9475871, 'precision': 0.70135283, 'recall': 0.80774295, 'specificity': 0.80774295, 'f1': 0.74137956, 'auroc': 0.9156802, 'binary_precision': 0.4180929, 'binary_recall': 0.6551724, 'binary_specificity': 0.9603135, 'binary_f1_score': 0.5104478}
confusion matrix:
      0    1
0  5759  238
1    90  171
early stop counter: 2
val acc:0.95615154504776, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9595717191696167 / 0.9624480605125427
after epoch: 4,now: 2024-07-10 03:59:11.281588,epoch time: 0:24:48.363574,used: 1:39:45.536321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98287165, 'precision': 0.9832735, 'recall': 0.971812, 'specificity': 0.971812, 'f1': 0.97736454, 'auroc': 0.996441, 'binary_precision': 0.9840733, 'binary_recall': 0.94896364, 'binary_specificity': 0.9946604, 'binary_f1_score': 0.9661996}
confusion matrix:
       0      1
0  42099    226
1    751  13964
---- Validation: 
scalar performance:
{'acc': 0.9411452, 'precision': 0.65446186, 'recall': 0.80076754, 'specificity': 0.80076754, 'f1': 0.69972664, 'auroc': 0.91549504, 'binary_precision': 0.321786, 'binary_recall': 0.65007776, 'binary_specificity': 0.9514574, 'binary_f1_score': 0.43048403}
confusion matrix:
       0    1
0  17268  881
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9188239, 'precision': 0.6464042, 'recall': 0.8330468, 'specificity': 0.8330468, 'f1': 0.6940286, 'auroc': 0.92095923, 'binary_precision': 0.3048973, 'binary_recall': 0.7394636, 'binary_specificity': 0.92662996, 'binary_f1_score': 0.43176737}
confusion matrix:
      0    1
0  5557  440
1    68  193
early stop counter: 3
val acc:0.9411451816558838, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9595717191696167 / 0.9624480605125427
after epoch: 5,now: 2024-07-10 04:24:16.354108,epoch time: 0:25:05.072520,used: 2:04:50.608841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9835203, 'precision': 0.98676604, 'recall': 0.97019154, 'specificity': 0.97019154, 'f1': 0.9781118, 'auroc': 0.9968933, 'binary_precision': 0.99312764, 'binary_recall': 0.94265133, 'binary_specificity': 0.99773175, 'binary_f1_score': 0.9672314}
confusion matrix:
       0      1
0  42227     96
1    844  13873
---- Validation: 
scalar performance:
{'acc': 0.9539698, 'precision': 0.6773072, 'recall': 0.7369019, 'specificity': 0.7369019, 'f1': 0.70215386, 'auroc': 0.9039885, 'binary_precision': 0.37241378, 'binary_recall': 0.503888, 'binary_specificity': 0.9699157, 'binary_f1_score': 0.42828816}
confusion matrix:
       0    1
0  17603  546
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94087565, 'precision': 0.67666745, 'recall': 0.77858853, 'specificity': 0.77858853, 'f1': 0.71389663, 'auroc': 0.90515053, 'binary_precision': 0.3711584, 'binary_recall': 0.6015326, 'binary_specificity': 0.9556445, 'binary_f1_score': 0.45906433}
confusion matrix:
      0    1
0  5731  266
1   104  157
early stop counter: 4
val acc:0.9539697766304016, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9595717191696167 / 0.9624480605125427
after epoch: 6,now: 2024-07-10 04:49:17.851363,epoch time: 0:25:01.497255,used: 2:29:52.106096,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9862377, 'precision': 0.98583525, 'recall': 0.9780884, 'specificity': 0.9780884, 'f1': 0.98188055, 'auroc': 0.99734634, 'binary_precision': 0.98502475, 'binary_recall': 0.96125615, 'binary_specificity': 0.9949206, 'binary_f1_score': 0.9729953}
confusion matrix:
       0      1
0  42113    215
1    570  14142
---- Validation: 
scalar performance:
{'acc': 0.94934016, 'precision': 0.66356575, 'recall': 0.747256, 'specificity': 0.747256, 'f1': 0.6954497, 'auroc': 0.90389246, 'binary_precision': 0.34409687, 'binary_recall': 0.5303266, 'binary_specificity': 0.96418536, 'binary_f1_score': 0.41738063}
confusion matrix:
       0    1
0  17499  650
1    302  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93192714, 'precision': 0.65663373, 'recall': 0.78124887, 'specificity': 0.78124887, 'f1': 0.6971407, 'auroc': 0.8943424, 'binary_precision': 0.3305955, 'binary_recall': 0.61685824, 'binary_specificity': 0.9456395, 'binary_f1_score': 0.43048128}
confusion matrix:
      0    1
0  5671  326
1   100  161
early stop counter: 5
val acc:0.9493401646614075, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9595717191696167 / 0.9624480605125427
after epoch: 7,now: 2024-07-10 05:14:21.484679,epoch time: 0:25:03.633316,used: 2:54:55.739412,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9870091, 'precision': 0.9876532, 'recall': 0.97832507, 'specificity': 0.97832507, 'f1': 0.9828721, 'auroc': 0.997381, 'binary_precision': 0.9889441, 'binary_recall': 0.96038324, 'binary_specificity': 0.9962669, 'binary_f1_score': 0.9744544}
confusion matrix:
       0      1
0  42166    158
1    583  14133
---- Validation: 
scalar performance:
{'acc': 0.9572691, 'precision': 0.6861687, 'recall': 0.71310806, 'specificity': 0.71310806, 'f1': 0.69859827, 'auroc': 0.90572834, 'binary_precision': 0.3918919, 'binary_recall': 0.45101088, 'binary_specificity': 0.97520524, 'binary_f1_score': 0.4193782}
confusion matrix:
       0    1
0  17699  450
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95317996, 'precision': 0.713938, 'recall': 0.7520264, 'specificity': 0.7520264, 'f1': 0.731168, 'auroc': 0.89599365, 'binary_precision': 0.4483871, 'binary_recall': 0.532567, 'binary_specificity': 0.97148573, 'binary_f1_score': 0.48686513}
confusion matrix:
      0    1
0  5826  171
1   122  139
early stop counter: 6
val acc:0.9572690725326538, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9595717191696167 / 0.9624480605125427
after epoch: 8,now: 2024-07-10 05:39:16.112940,epoch time: 0:24:54.628261,used: 3:19:50.367673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9875701, 'precision': 0.9885837, 'recall': 0.9788804, 'specificity': 0.9788804, 'f1': 0.98360586, 'auroc': 0.9973198, 'binary_precision': 0.990613, 'binary_recall': 0.9609269, 'binary_specificity': 0.9968339, 'binary_f1_score': 0.97554415}
confusion matrix:
       0      1
0  42190    134
1    575  14141
---- Validation: 
scalar performance:
{'acc': 0.95391655, 'precision': 0.6717489, 'recall': 0.7151227, 'specificity': 0.7151227, 'f1': 0.6906247, 'auroc': 0.89943486, 'binary_precision': 0.36285362, 'binary_recall': 0.45878693, 'binary_specificity': 0.9714585, 'binary_f1_score': 0.40521976}
confusion matrix:
       0    1
0  17631  518
1    348  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9544583, 'precision': 0.7207259, 'recall': 0.76002276, 'specificity': 0.76002276, 'f1': 0.7385082, 'auroc': 0.8962257, 'binary_precision': 0.46129033, 'binary_recall': 0.54789275, 'binary_specificity': 0.97215277, 'binary_f1_score': 0.5008757}
confusion matrix:
      0    1
0  5830  167
1   118  143
early stop counter: 7
val acc:0.9539165496826172, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9595717191696167 / 0.9624480605125427
after epoch: 9,now: 2024-07-10 06:04:08.252206,epoch time: 0:24:52.139266,used: 3:44:42.506939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98818374, 'precision': 0.9900162, 'recall': 0.97909176, 'specificity': 0.97909176, 'f1': 0.9843949, 'auroc': 0.9972806, 'binary_precision': 0.9936709, 'binary_recall': 0.9603099, 'binary_specificity': 0.99787366, 'binary_f1_score': 0.97670555}
confusion matrix:
       0      1
0  42236     90
1    584  14130
---- Validation: 
scalar performance:
{'acc': 0.9604087, 'precision': 0.6923291, 'recall': 0.6644798, 'specificity': 0.6644798, 'f1': 0.6771735, 'auroc': 0.8970263, 'binary_precision': 0.40767825, 'binary_recall': 0.34681183, 'binary_specificity': 0.98214775, 'binary_f1_score': 0.37478992}
confusion matrix:
       0    1
0  17825  324
1    420  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.74691486, 'recall': 0.71138537, 'specificity': 0.71138537, 'f1': 0.7275825, 'auroc': 0.8883114, 'binary_precision': 0.518018, 'binary_recall': 0.44061303, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.47619048}
confusion matrix:
      0    1
0  5890  107
1   146  115
better model found
persisted
after epoch: 10,now: 2024-07-10 06:29:07.160773,epoch time: 0:24:58.908567,used: 4:09:41.415506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.988061, 'precision': 0.98977053, 'recall': 0.9790078, 'specificity': 0.9790078, 'f1': 0.98423463, 'auroc': 0.9975289, 'binary_precision': 0.9931815, 'binary_recall': 0.96030724, 'binary_specificity': 0.9977083, 'binary_f1_score': 0.9764678}
confusion matrix:
       0      1
0  42230     97
1    584  14129
---- Validation: 
scalar performance:
{'acc': 0.9571626, 'precision': 0.6881604, 'recall': 0.7243038, 'specificity': 0.7243038, 'f1': 0.7044194, 'auroc': 0.9091001, 'binary_precision': 0.3950777, 'binary_recall': 0.47433904, 'binary_specificity': 0.97426856, 'binary_f1_score': 0.4310954}
confusion matrix:
       0    1
0  17682  467
1    338  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.7511034, 'recall': 0.75386256, 'specificity': 0.75386256, 'f1': 0.75247437, 'auroc': 0.8940278, 'binary_precision': 0.52272725, 'binary_recall': 0.52873564, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.5257143}
confusion matrix:
      0    1
0  5871  126
1   123  138
early stop counter: 1
val acc:0.957162618637085, best validation acc: 0.9604086875915527, corresponding to test acc:                         0.9595717191696167 / 0.9624480605125427
after epoch: 11,now: 2024-07-10 06:54:38.326153,epoch time: 0:25:31.165380,used: 4:35:12.580886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9883941, 'precision': 0.9894856, 'recall': 0.98014486, 'specificity': 0.98014486, 'f1': 0.9846985, 'auroc': 0.998171, 'binary_precision': 0.99167365, 'binary_recall': 0.9631014, 'binary_specificity': 0.9971883, 'binary_f1_score': 0.97717863}
confusion matrix:
       0      1
0  42205    119
1    543  14173
---- Validation: 
scalar performance:
{'acc': 0.95764154, 'precision': 0.68279076, 'recall': 0.6915493, 'specificity': 0.6915493, 'f1': 0.68705285, 'auroc': 0.9010727, 'binary_precision': 0.38666666, 'binary_recall': 0.4059098, 'binary_specificity': 0.9771888, 'binary_f1_score': 0.39605463}
confusion matrix:
       0    1
0  17735  414
1    382  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.7707814, 'recall': 0.7498663, 'specificity': 0.7498663, 'f1': 0.75984806, 'auroc': 0.8966817, 'binary_precision': 0.5625, 'binary_recall': 0.51724136, 'binary_specificity': 0.98249125, 'binary_f1_score': 0.53892213}
confusion matrix:
      0    1
0  5892  105
1   126  135
new oracle model saved
early stop counter: 2
val acc:0.9576415419578552, best validation acc: 0.9604086875915527, corresponding to test acc:                         0.9595717191696167 / 0.963087260723114
after epoch: 12,now: 2024-07-10 07:19:11.438958,epoch time: 0:24:33.112805,used: 4:59:45.693691,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.990007, 'precision': 0.98998976, 'recall': 0.983846, 'specificity': 0.983846, 'f1': 0.98686725, 'auroc': 0.99820495, 'binary_precision': 0.98995495, 'binary_recall': 0.9711179, 'binary_specificity': 0.9965741, 'binary_f1_score': 0.9804459}
confusion matrix:
       0      1
0  42180    145
1    425  14290
---- Validation: 
scalar performance:
{'acc': 0.9526926, 'precision': 0.66488564, 'recall': 0.7077386, 'specificity': 0.7077386, 'f1': 0.6834512, 'auroc': 0.90302825, 'binary_precision': 0.34963325, 'binary_recall': 0.44479004, 'binary_specificity': 0.9706871, 'binary_f1_score': 0.39151266}
confusion matrix:
       0    1
0  17617  532
1    357  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.75336987, 'recall': 0.73753834, 'specificity': 0.73753834, 'f1': 0.7451633, 'auroc': 0.8897784, 'binary_precision': 0.52868855, 'binary_recall': 0.49425286, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.51089114}
confusion matrix:
      0    1
0  5882  115
1   132  129
early stop counter: 3
val acc:0.9526926279067993, best validation acc: 0.9604086875915527, corresponding to test acc:                         0.9595717191696167 / 0.963087260723114
after epoch: 13,now: 2024-07-10 07:43:58.280086,epoch time: 0:24:46.841128,used: 5:24:32.534819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9893759, 'precision': 0.98705685, 'recall': 0.9851511, 'specificity': 0.9851511, 'f1': 0.986099, 'auroc': 0.9981412, 'binary_precision': 0.98229545, 'binary_recall': 0.97642183, 'binary_specificity': 0.9938804, 'binary_f1_score': 0.9793498}
confusion matrix:
       0      1
0  42064    259
1    347  14370
---- Validation: 
scalar performance:
{'acc': 0.94715834, 'precision': 0.65315783, 'recall': 0.7326254, 'specificity': 0.7326254, 'f1': 0.6832586, 'auroc': 0.9042295, 'binary_precision': 0.3242972, 'binary_recall': 0.5023328, 'binary_specificity': 0.96291804, 'binary_f1_score': 0.39414275}
confusion matrix:
       0    1
0  17476  673
1    320  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9493448, 'precision': 0.6990914, 'recall': 0.75735474, 'specificity': 0.75735474, 'f1': 0.7238428, 'auroc': 0.89102805, 'binary_precision': 0.41812867, 'binary_recall': 0.54789275, 'binary_specificity': 0.9668167, 'binary_f1_score': 0.4742952}
confusion matrix:
      0    1
0  5798  199
1   118  143
early stop counter: 4
val acc:0.9471583366394043, best validation acc: 0.9604086875915527, corresponding to test acc:                         0.9595717191696167 / 0.963087260723114
after epoch: 14,now: 2024-07-10 08:11:19.150687,epoch time: 0:27:20.870601,used: 5:51:53.405420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9903927, 'precision': 0.9914079, 'recall': 0.9834631, 'specificity': 0.9834631, 'f1': 0.98735136, 'auroc': 0.998425, 'binary_precision': 0.9934518, 'binary_recall': 0.96914715, 'binary_specificity': 0.9977791, 'binary_f1_score': 0.981149}
confusion matrix:
       0      1
0  42231     94
1    454  14261
---- Validation: 
scalar performance:
{'acc': 0.9550341, 'precision': 0.6701137, 'recall': 0.6916995, 'specificity': 0.6916995, 'f1': 0.6801637, 'auroc': 0.89658237, 'binary_precision': 0.36126372, 'binary_recall': 0.40902022, 'binary_specificity': 0.97437876, 'binary_f1_score': 0.38366154}
confusion matrix:
       0    1
0  17684  465
1    380  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.7585968, 'recall': 0.7011418, 'specificity': 0.7011418, 'f1': 0.72580963, 'auroc': 0.8821689, 'binary_precision': 0.54228854, 'binary_recall': 0.41762453, 'binary_specificity': 0.984659, 'binary_f1_score': 0.47186148}
confusion matrix:
      0    1
0  5905   92
1   152  109
early stop counter: 5
val acc:0.955034077167511, best validation acc: 0.9604086875915527, corresponding to test acc:                         0.9595717191696167 / 0.963087260723114
after epoch: 15,now: 2024-07-10 08:39:25.432360,epoch time: 0:28:06.281673,used: 6:19:59.687093,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99019986, 'precision': 0.99155414, 'recall': 0.9828255, 'specificity': 0.9828255, 'f1': 0.9870883, 'auroc': 0.998287, 'binary_precision': 0.99427456, 'binary_recall': 0.9675885, 'binary_specificity': 0.9980625, 'binary_f1_score': 0.98075}
confusion matrix:
       0      1
0  42241     82
1    477  14240
---- Validation: 
scalar performance:
{'acc': 0.9628033, 'precision': 0.7041204, 'recall': 0.63496727, 'specificity': 0.63496727, 'f1': 0.66164374, 'auroc': 0.896703, 'binary_precision': 0.43333334, 'binary_recall': 0.2830482, 'binary_specificity': 0.9868863, 'binary_f1_score': 0.3424271}
confusion matrix:
       0    1
0  17911  238
1    461  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96292746, 'precision': 0.8058653, 'recall': 0.62151957, 'specificity': 0.62151957, 'f1': 0.6700138, 'auroc': 0.8776374, 'binary_precision': 0.64356434, 'binary_recall': 0.24904214, 'binary_specificity': 0.993997, 'binary_f1_score': 0.35911602}
confusion matrix:
      0   1
0  5961  36
1   196  65
better model found
persisted
after epoch: 16,now: 2024-07-10 09:06:23.677945,epoch time: 0:26:58.245585,used: 6:46:57.932678,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9903927, 'precision': 0.99108815, 'recall': 0.98377347, 'specificity': 0.98377347, 'f1': 0.98735934, 'auroc': 0.99831307, 'binary_precision': 0.9924911, 'binary_recall': 0.97009856, 'binary_specificity': 0.9974483, 'binary_f1_score': 0.9811671}
confusion matrix:
       0      1
0  42217    108
1    440  14275
---- Validation: 
scalar performance:
{'acc': 0.9630694, 'precision': 0.71260726, 'recall': 0.6643572, 'specificity': 0.6643572, 'f1': 0.6850219, 'auroc': 0.9012748, 'binary_precision': 0.44827586, 'binary_recall': 0.3437014, 'binary_specificity': 0.98501295, 'binary_f1_score': 0.38908452}
confusion matrix:
       0    1
0  17877  272
1    422  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.8155842, 'recall': 0.6666628, 'specificity': 0.6666628, 'f1': 0.71575403, 'auroc': 0.8823037, 'binary_precision': 0.65925926, 'binary_recall': 0.34099618, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.44949496}
confusion matrix:
      0   1
0  5951  46
1   172  89
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-10 09:31:36.871494,epoch time: 0:25:13.193549,used: 7:12:11.126227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99095374, 'precision': 0.9918319, 'recall': 0.98450613, 'specificity': 0.98450613, 'f1': 0.9880974, 'auroc': 0.99833477, 'binary_precision': 0.9936036, 'binary_recall': 0.97118586, 'binary_specificity': 0.99782634, 'binary_f1_score': 0.98226684}
confusion matrix:
       0      1
0  42233     92
1    424  14291
---- Validation: 
scalar performance:
{'acc': 0.9589719, 'precision': 0.6806836, 'recall': 0.65698546, 'specificity': 0.65698546, 'f1': 0.66788703, 'auroc': 0.8948108, 'binary_precision': 0.38489208, 'binary_recall': 0.33281493, 'binary_specificity': 0.981156, 'binary_f1_score': 0.3569641}
confusion matrix:
       0    1
0  17807  342
1    429  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7431666, 'recall': 0.65250057, 'specificity': 0.65250057, 'f1': 0.6860987, 'auroc': 0.8738873, 'binary_precision': 0.51552796, 'binary_recall': 0.31800765, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.3933649}
confusion matrix:
      0   1
0  5919  78
1   178  83
early stop counter: 1
val acc:0.9589719176292419, best validation acc: 0.9630693793296814, corresponding to test acc:                         0.9651646018028259 / 0.9651646018028259
after epoch: 18,now: 2024-07-10 09:57:32.181110,epoch time: 0:25:55.309616,used: 7:38:06.435843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9911115, 'precision': 0.9924426, 'recall': 0.9843253, 'specificity': 0.9843253, 'f1': 0.98829633, 'auroc': 0.9986328, 'binary_precision': 0.9951216, 'binary_recall': 0.9703044, 'binary_specificity': 0.9983461, 'binary_f1_score': 0.98255634}
confusion matrix:
       0      1
0  42254     70
1    437  14279
---- Validation: 
scalar performance:
{'acc': 0.9608876, 'precision': 0.69805574, 'recall': 0.6744785, 'specificity': 0.6744785, 'f1': 0.68542355, 'auroc': 0.90574974, 'binary_precision': 0.41843972, 'binary_recall': 0.36702955, 'binary_specificity': 0.9819274, 'binary_f1_score': 0.3910522}
confusion matrix:
       0    1
0  17821  328
1    407  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.8424302, 'recall': 0.6769084, 'specificity': 0.6769084, 'f1': 0.7307308, 'auroc': 0.88336694, 'binary_precision': 0.7121212, 'binary_recall': 0.36015326, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.4783715}
confusion matrix:
      0   1
0  5959  38
1   167  94
new oracle model saved
early stop counter: 2
val acc:0.960887610912323, best validation acc: 0.9630693793296814, corresponding to test acc:                         0.9651646018028259 / 0.9672419428825378
after epoch: 19,now: 2024-07-10 10:22:11.715816,epoch time: 0:24:39.534706,used: 8:02:45.970549,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99035764, 'precision': 0.9918448, 'recall': 0.9829529, 'specificity': 0.9829529, 'f1': 0.9872936, 'auroc': 0.99841595, 'binary_precision': 0.99483025, 'binary_recall': 0.9676542, 'binary_specificity': 0.99825156, 'binary_f1_score': 0.98105407}
confusion matrix:
       0      1
0  42250     74
1    476  14240
---- Validation: 
scalar performance:
{'acc': 0.96248406, 'precision': 0.69724154, 'recall': 0.621301, 'specificity': 0.621301, 'f1': 0.6491168, 'auroc': 0.8995401, 'binary_precision': 0.42051283, 'binary_recall': 0.25505444, 'binary_specificity': 0.9875475, 'binary_f1_score': 0.31752178}
confusion matrix:
       0    1
0  17923  226
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.78124356, 'recall': 0.60411143, 'specificity': 0.60411143, 'f1': 0.64775556, 'auroc': 0.87461036, 'binary_precision': 0.59574467, 'binary_recall': 0.21455939, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.31549296}
confusion matrix:
      0   1
0  5959  38
1   205  56
early stop counter: 3
val acc:0.9624840617179871, best validation acc: 0.9630693793296814, corresponding to test acc:                         0.9651646018028259 / 0.9672419428825378
after epoch: 20,now: 2024-07-10 10:47:14.370131,epoch time: 0:25:02.654315,used: 8:27:48.624864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99169004, 'precision': 0.99116325, 'recall': 0.98708653, 'specificity': 0.98708653, 'f1': 0.9891026, 'auroc': 0.9987452, 'binary_precision': 0.9900895, 'binary_recall': 0.9775754, 'binary_specificity': 0.99659765, 'binary_f1_score': 0.98379266}
confusion matrix:
       0      1
0  42180    144
1    330  14386
---- Validation: 
scalar performance:
{'acc': 0.9569498, 'precision': 0.6791301, 'recall': 0.6911912, 'specificity': 0.6911912, 'f1': 0.68493545, 'auroc': 0.8992051, 'binary_precision': 0.37936047, 'binary_recall': 0.4059098, 'binary_specificity': 0.97647256, 'binary_f1_score': 0.39218634}
confusion matrix:
       0    1
0  17722  427
1    382  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.7118959, 'recall': 0.65607995, 'specificity': 0.65607995, 'f1': 0.67912495, 'auroc': 0.86942804, 'binary_precision': 0.4526316, 'binary_recall': 0.32950193, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.38137472}
confusion matrix:
      0    1
0  5893  104
1   175   86
early stop counter: 4
val acc:0.956949770450592, best validation acc: 0.9630693793296814, corresponding to test acc:                         0.9651646018028259 / 0.9672419428825378
after epoch: 21,now: 2024-07-10 11:12:24.565940,epoch time: 0:25:10.195809,used: 8:52:58.820673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9921108, 'precision': 0.99167347, 'recall': 0.98768175, 'specificity': 0.98768175, 'f1': 0.9896562, 'auroc': 0.9984858, 'binary_precision': 0.9907815, 'binary_recall': 0.9785297, 'binary_specificity': 0.9968338, 'binary_f1_score': 0.9846175}
confusion matrix:
       0      1
0  42188    134
1    316  14402
---- Validation: 
scalar performance:
{'acc': 0.9597169, 'precision': 0.69613975, 'recall': 0.6993742, 'specificity': 0.6993742, 'f1': 0.697742, 'auroc': 0.9076046, 'binary_precision': 0.41284403, 'binary_recall': 0.41990668, 'binary_specificity': 0.9788418, 'binary_f1_score': 0.41634542}
confusion matrix:
       0    1
0  17765  384
1    373  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.7235945, 'recall': 0.66049504, 'specificity': 0.66049504, 'f1': 0.6861247, 'auroc': 0.87523234, 'binary_precision': 0.47567567, 'binary_recall': 0.33716476, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.39461884}
confusion matrix:
      0   1
0  5900  97
1   173  88
early stop counter: 5
val acc:0.9597169160842896, best validation acc: 0.9630693793296814, corresponding to test acc:                         0.9651646018028259 / 0.9672419428825378
after epoch: 22,now: 2024-07-10 11:38:29.860429,epoch time: 0:26:05.294489,used: 9:19:04.115162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9918303, 'precision': 0.9923557, 'recall': 0.9862699, 'specificity': 0.9862699, 'f1': 0.9892634, 'auroc': 0.9987218, 'binary_precision': 0.9934197, 'binary_recall': 0.9747842, 'binary_specificity': 0.9977556, 'binary_f1_score': 0.98401374}
confusion matrix:
       0      1
0  42232     95
1    371  14342
---- Validation: 
scalar performance:
{'acc': 0.9590783, 'precision': 0.6917328, 'recall': 0.69604343, 'specificity': 0.69604343, 'f1': 0.6938609, 'auroc': 0.9101127, 'binary_precision': 0.40425533, 'binary_recall': 0.41368586, 'binary_specificity': 0.978401, 'binary_f1_score': 0.40891623}
confusion matrix:
       0    1
0  17757  392
1    377  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.8140086, 'recall': 0.6778236, 'specificity': 0.6778236, 'f1': 0.72507185, 'auroc': 0.8865769, 'binary_precision': 0.6551724, 'binary_recall': 0.36398467, 'binary_specificity': 0.9916625, 'binary_f1_score': 0.4679803}
confusion matrix:
      0   1
0  5947  50
1   166  95
early stop counter: 6
val acc:0.959078311920166, best validation acc: 0.9630693793296814, corresponding to test acc:                         0.9651646018028259 / 0.9672419428825378
after epoch: 23,now: 2024-07-10 12:04:21.943220,epoch time: 0:25:52.082791,used: 9:44:56.197953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99161994, 'precision': 0.99104905, 'recall': 0.98701787, 'specificity': 0.98701787, 'f1': 0.9890117, 'auroc': 0.9985713, 'binary_precision': 0.9898851, 'binary_recall': 0.977509, 'binary_specificity': 0.9965267, 'binary_f1_score': 0.98365813}
confusion matrix:
       0      1
0  42176    147
1    331  14386
---- Validation: 
scalar performance:
{'acc': 0.95349085, 'precision': 0.68040454, 'recall': 0.7591556, 'specificity': 0.7591556, 'f1': 0.71162915, 'auroc': 0.9162552, 'binary_precision': 0.37699682, 'binary_recall': 0.5505443, 'binary_specificity': 0.9677668, 'binary_f1_score': 0.44753477}
confusion matrix:
       0    1
0  17564  585
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9511026, 'precision': 0.7045945, 'recall': 0.7491102, 'specificity': 0.7491102, 'f1': 0.7242929, 'auroc': 0.88732505, 'binary_precision': 0.42990655, 'binary_recall': 0.52873564, 'binary_specificity': 0.96948475, 'binary_f1_score': 0.47422683}
confusion matrix:
      0    1
0  5814  183
1   123  138
early stop counter: 7
val acc:0.9534908533096313, best validation acc: 0.9630693793296814, corresponding to test acc:                         0.9651646018028259 / 0.9672419428825378
after epoch: 24,now: 2024-07-10 12:32:10.746376,epoch time: 0:27:48.803156,used: 10:12:45.001109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.991392, 'precision': 0.99256194, 'recall': 0.98493445, 'specificity': 0.98493445, 'f1': 0.9886708, 'auroc': 0.99848866, 'binary_precision': 0.99491996, 'binary_recall': 0.9715936, 'binary_specificity': 0.9982753, 'binary_f1_score': 0.9831184}
confusion matrix:
       0      1
0  42252     73
1    418  14297
---- Validation: 
scalar performance:
{'acc': 0.96136653, 'precision': 0.69124734, 'recall': 0.63497347, 'specificity': 0.63497347, 'f1': 0.657635, 'auroc': 0.89860547, 'binary_precision': 0.4075724, 'binary_recall': 0.28460342, 'binary_specificity': 0.9853435, 'binary_f1_score': 0.33516484}
confusion matrix:
       0    1
0  17883  266
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9534995, 'precision': 0.688351, 'recall': 0.6202651, 'specificity': 0.6202651, 'f1': 0.6456133, 'auroc': 0.8695355, 'binary_precision': 0.40853658, 'binary_recall': 0.256705, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.31529412}
confusion matrix:
      0   1
0  5900  97
1   194  67
early stop counter: 8
val acc:0.9613665342330933, best validation acc: 0.9630693793296814, corresponding to test acc:                         0.9651646018028259 / 0.9672419428825378
after epoch: 25,now: 2024-07-10 12:58:39.094505,epoch time: 0:26:28.348129,used: 10:39:13.349238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9921283, 'precision': 0.99260324, 'recall': 0.9868072, 'specificity': 0.9868072, 'f1': 0.98966044, 'auroc': 0.9986764, 'binary_precision': 0.9935662, 'binary_recall': 0.97581196, 'binary_specificity': 0.99780256, 'binary_f1_score': 0.984609}
confusion matrix:
       0      1
0  42229     93
1    356  14362
---- Validation: 
scalar performance:
{'acc': 0.9593976, 'precision': 0.6976838, 'recall': 0.71571016, 'specificity': 0.71571016, 'f1': 0.7062502, 'auroc': 0.91241217, 'binary_precision': 0.41477272, 'binary_recall': 0.4541213, 'binary_specificity': 0.97729903, 'binary_f1_score': 0.43355608}
confusion matrix:
       0    1
0  17737  412
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7471776, 'recall': 0.68206805, 'specificity': 0.68206805, 'f1': 0.7090273, 'auroc': 0.88137764, 'binary_precision': 0.52105266, 'binary_recall': 0.37931034, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.4390244}
confusion matrix:
      0   1
0  5906  91
1   162  99
early stop counter: 9
val acc:0.9593976140022278, best validation acc: 0.9630693793296814, corresponding to test acc:                         0.9651646018028259 / 0.9672419428825378
after epoch: 26,now: 2024-07-10 13:24:58.765242,epoch time: 0:26:19.670737,used: 11:05:33.019975,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9922861, 'precision': 0.9918597, 'recall': 0.98795426, 'specificity': 0.98795426, 'f1': 0.9898866, 'auroc': 0.9988558, 'binary_precision': 0.99098974, 'binary_recall': 0.97900385, 'binary_specificity': 0.99690473, 'binary_f1_score': 0.9849603}
confusion matrix:
       0      1
0  42192    131
1    309  14408
---- Validation: 
scalar performance:
{'acc': 0.95764154, 'precision': 0.68953407, 'recall': 0.7200514, 'specificity': 0.7200514, 'f1': 0.7034932, 'auroc': 0.91137636, 'binary_precision': 0.3981358, 'binary_recall': 0.46500778, 'binary_specificity': 0.97509503, 'binary_f1_score': 0.42898133}
confusion matrix:
       0    1
0  17697  452
1    344  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7350105, 'recall': 0.67398834, 'specificity': 0.67398834, 'f1': 0.69931823, 'auroc': 0.8769364, 'binary_precision': 0.4973822, 'binary_recall': 0.36398467, 'binary_specificity': 0.983992, 'binary_f1_score': 0.42035398}
confusion matrix:
      0   1
0  5901  96
1   166  95
early stop counter: 10
val acc:0.9576415419578552, best validation acc: 0.9630693793296814, corresponding to test acc:                         0.9651646018028259 / 0.9672419428825378
after epoch: 27,now: 2024-07-10 13:51:14.524324,epoch time: 0:26:15.759082,used: 11:31:48.779057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99207574, 'precision': 0.9915825, 'recall': 0.9876789, 'specificity': 0.9876789, 'f1': 0.98961025, 'auroc': 0.99879396, 'binary_precision': 0.99057645, 'binary_recall': 0.9785947, 'binary_specificity': 0.99676305, 'binary_f1_score': 0.9845491}
confusion matrix:
       0      1
0  42187    137
1    315  14401
---- Validation: 
scalar performance:
{'acc': 0.9579076, 'precision': 0.6773331, 'recall': 0.66693527, 'specificity': 0.66693527, 'f1': 0.67195463, 'auroc': 0.9080787, 'binary_precision': 0.37748346, 'binary_recall': 0.35458788, 'binary_specificity': 0.9792826, 'binary_f1_score': 0.36567765}
confusion matrix:
       0    1
0  17773  376
1    415  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590924, 'precision': 0.7432953, 'recall': 0.6433389, 'specificity': 0.6433389, 'f1': 0.6787454, 'auroc': 0.875024, 'binary_precision': 0.51655626, 'binary_recall': 0.29885057, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.37864077}
confusion matrix:
      0   1
0  5924  73
1   183  78
early stop counter: 11
val acc:0.9579076170921326, best validation acc: 0.9630693793296814, corresponding to test acc:                         0.9651646018028259 / 0.9672419428825378
after epoch: 28,now: 2024-07-10 14:18:47.606280,epoch time: 0:27:33.081956,used: 11:59:21.861013,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99209327, 'precision': 0.9914179, 'recall': 0.98789084, 'specificity': 0.98789084, 'f1': 0.9896377, 'auroc': 0.99876285, 'binary_precision': 0.99003845, 'binary_recall': 0.9792077, 'binary_specificity': 0.996574, 'binary_f1_score': 0.9845933}
confusion matrix:
       0      1
0  42178    145
1    306  14411
---- Validation: 
scalar performance:
{'acc': 0.9492337, 'precision': 0.65899247, 'recall': 0.73069966, 'specificity': 0.73069966, 'f1': 0.6871239, 'auroc': 0.90289617, 'binary_precision': 0.3361433, 'binary_recall': 0.496112, 'binary_specificity': 0.9652873, 'binary_f1_score': 0.40075377}
confusion matrix:
       0    1
0  17519  630
1    324  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9483861, 'precision': 0.6779412, 'recall': 0.6798965, 'specificity': 0.6798965, 'f1': 0.6789125, 'auroc': 0.8677676, 'binary_precision': 0.38257575, 'binary_recall': 0.38697317, 'binary_specificity': 0.97281975, 'binary_f1_score': 0.38476193}
confusion matrix:
      0    1
0  5834  163
1   160  101
early stop counter: 12
val acc:0.9492337107658386, best validation acc: 0.9630693793296814, corresponding to test acc:                         0.9651646018028259 / 0.9672419428825378
after epoch: 29,now: 2024-07-10 14:43:51.732998,epoch time: 0:25:04.126718,used: 12:24:25.987731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99253154, 'precision': 0.99267364, 'recall': 0.9877866, 'specificity': 0.9877866, 'f1': 0.99019825, 'auroc': 0.9989022, 'binary_precision': 0.9929626, 'binary_recall': 0.9779832, 'binary_specificity': 0.99759, 'binary_f1_score': 0.98541594}
confusion matrix:
       0      1
0  42222    102
1    324  14392
---- Validation: 
scalar performance:
{'acc': 0.96168584, 'precision': 0.70169824, 'recall': 0.665141, 'specificity': 0.665141, 'f1': 0.6813669, 'auroc': 0.8994777, 'binary_precision': 0.42638624, 'binary_recall': 0.34681183, 'binary_specificity': 0.98347014, 'binary_f1_score': 0.38250428}
confusion matrix:
       0    1
0  17849  300
1    420  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95317996, 'precision': 0.6831376, 'recall': 0.612769, 'specificity': 0.612769, 'f1': 0.63824755, 'auroc': 0.86367, 'binary_precision': 0.39873418, 'binary_recall': 0.2413793, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.300716}
confusion matrix:
      0   1
0  5902  95
1   198  63
early stop counter: 13
val acc:0.961685836315155, best validation acc: 0.9630693793296814, corresponding to test acc:                         0.9651646018028259 / 0.9672419428825378
after epoch: 30,now: 2024-07-10 15:09:10.863125,epoch time: 0:25:19.130127,used: 12:49:45.117858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_02_19_25_seed_0_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:49:45.117858 at 2024-07-10 15:09:10.863125
persisted model performance metric: 

scalar performance:
{'acc': 0.9651646, 'precision': 0.8155842, 'recall': 0.6666628, 'specificity': 0.6666628, 'f1': 0.71575403, 'auroc': 0.8823037, 'binary_precision': 0.65925926, 'binary_recall': 0.34099618, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.44949496}
confusion matrix:
      0   1
0  5951  46
1   172  89
oracle model performance metric: 

scalar performance:
{'acc': 0.96724194, 'precision': 0.8424302, 'recall': 0.6769084, 'specificity': 0.6769084, 'f1': 0.7307308, 'auroc': 0.88336694, 'binary_precision': 0.7121212, 'binary_recall': 0.36015326, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.4783715}
confusion matrix:
      0   1
0  5959  38
1   167  94
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197608 KiB |   1195 MiB |    959 TiB |    959 TiB |
|       from large pool | 180117 KiB |   1178 MiB |    946 TiB |    946 TiB |
|       from small pool |  17491 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197608 KiB |   1195 MiB |    959 TiB |    959 TiB |
|       from large pool | 180117 KiB |   1178 MiB |    946 TiB |    946 TiB |
|       from small pool |  17491 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   1193 MiB |    959 TiB |    959 TiB |
|       from large pool | 178979 KiB |   1176 MiB |    946 TiB |    946 TiB |
|       from small pool |  16482 KiB |     36 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1352 MiB |   1352 MiB |   1352 MiB |      0 B   |
|       from large pool |   1310 MiB |   1310 MiB |   1310 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  52248 KiB | 147638 KiB | 544637 GiB | 544637 GiB |
|       from large pool |  45163 KiB | 146066 KiB | 531292 GiB | 531292 GiB |
|       from small pool |   7085 KiB |   9982 KiB |  13344 GiB |  13344 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7605    |  167694 K  |  167691 K  |
|       from large pool |      79    |     167    |   90492 K  |   90492 K  |
|       from small pool |    2899    |    7525    |   77201 K  |   77198 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7605    |  167694 K  |  167691 K  |
|       from large pool |      79    |     167    |   90492 K  |   90492 K  |
|       from small pool |    2899    |    7525    |   77201 K  |   77198 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      76    |      76    |      76    |       0    |
|       from large pool |      55    |      55    |      55    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3585    |  106788 K  |  106788 K  |
|       from large pool |      11    |      57    |   68910 K  |   68910 K  |
|       from small pool |      20    |    3574    |   37877 K  |   37877 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB |    959 TiB |    959 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB |    959 TiB |    959 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |    959 TiB |    959 TiB |
|       from large pool |  16640 KiB |   1176 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     36 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB |   1352 MiB |   1352 MiB |   1108 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   1310 MiB |   1090 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 147638 KiB | 544637 GiB | 544637 GiB |
|       from large pool |  24320 KiB | 146066 KiB | 531292 GiB | 531292 GiB |
|       from small pool |      0 KiB |  18291 KiB |  13344 GiB |  13344 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |  167694 K  |  167694 K  |
|       from large pool |       2    |     167    |   90492 K  |   90492 K  |
|       from small pool |       0    |    7525    |   77201 K  |   77201 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |  167694 K  |  167694 K  |
|       from large pool |       2    |     167    |   90492 K  |   90492 K  |
|       from small pool |       0    |    7525    |   77201 K  |   77201 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      76    |      76    |      53    |
|       from large pool |      11    |      55    |      55    |      44    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3585    |  106789 K  |  106789 K  |
|       from large pool |       4    |      57    |   68910 K  |   68910 K  |
|       from small pool |       0    |    3574    |   37878 K  |   37878 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB |    959 TiB |    959 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB |    959 TiB |    959 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |    959 TiB |    959 TiB |
|       from large pool |  16640 KiB |   1176 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     36 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB |   1352 MiB |   1352 MiB |   1108 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   1310 MiB |   1090 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 147638 KiB | 544637 GiB | 544637 GiB |
|       from large pool |  24320 KiB | 146066 KiB | 531292 GiB | 531292 GiB |
|       from small pool |      0 KiB |  18291 KiB |  13344 GiB |  13344 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |  167694 K  |  167694 K  |
|       from large pool |       2    |     167    |   90492 K  |   90492 K  |
|       from small pool |       0    |    7525    |   77201 K  |   77201 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |  167694 K  |  167694 K  |
|       from large pool |       2    |     167    |   90492 K  |   90492 K  |
|       from small pool |       0    |    7525    |   77201 K  |   77201 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      76    |      76    |      53    |
|       from large pool |      11    |      55    |      55    |      44    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3585    |  106789 K  |  106789 K  |
|       from large pool |       4    |      57    |   68910 K  |   68910 K  |
|       from small pool |       0    |    3574    |   37878 K  |   37878 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617

 Experiment start at: 2024-07-10 15:28:25.038573
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96521324, 'precision': 0.96723145, 'recall': 0.9402106, 'specificity': 0.9402106, 'f1': 0.95273054, 'auroc': 0.9852718, 'binary_precision': 0.9710024, 'binary_recall': 0.88945144, 'binary_specificity': 0.9909698, 'binary_f1_score': 0.9284396}
confusion matrix:
       0      1
0  42030    383
1   1594  12825
---- Validation: 
scalar performance:
{'acc': 0.9546425, 'precision': 0.6260592, 'recall': 0.5773573, 'specificity': 0.5773573, 'f1': 0.59480566, 'auroc': 0.8646012, 'binary_precision': 0.28255528, 'binary_recall': 0.17087667, 'binary_specificity': 0.98383796, 'binary_f1_score': 0.21296296}
confusion matrix:
       0    1
0  17775  292
1    558  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9513374, 'precision': 0.6668446, 'recall': 0.60312945, 'specificity': 0.60312945, 'f1': 0.62616634, 'auroc': 0.890893, 'binary_precision': 0.36708862, 'binary_recall': 0.22307692, 'binary_specificity': 0.98318195, 'binary_f1_score': 0.27751195}
confusion matrix:
      0    1
0  5846  100
1   202   58
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 15:53:53.117684,epoch time: 0:25:28.079111,used: 0:25:28.079111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9729554, 'precision': 0.972208, 'recall': 0.9558599, 'specificity': 0.9558599, 'f1': 0.9636723, 'auroc': 0.9916378, 'binary_precision': 0.97076666, 'binary_recall': 0.92115116, 'binary_specificity': 0.9905687, 'binary_f1_score': 0.9453083}
confusion matrix:
       0      1
0  42012    400
1   1137  13283
---- Validation: 
scalar performance:
{'acc': 0.95720387, 'precision': 0.6868603, 'recall': 0.6745315, 'specificity': 0.6745315, 'f1': 0.68045497, 'auroc': 0.8936349, 'binary_precision': 0.39712918, 'binary_recall': 0.36998513, 'binary_specificity': 0.9790779, 'binary_f1_score': 0.3830769}
confusion matrix:
       0    1
0  17689  378
1    424  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.78991854, 'recall': 0.75020826, 'specificity': 0.75020826, 'f1': 0.76842105, 'auroc': 0.91712725, 'binary_precision': 0.60089684, 'binary_recall': 0.5153846, 'binary_specificity': 0.98503196, 'binary_f1_score': 0.55486536}
confusion matrix:
      0    1
0  5857   89
1   126  134
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-10 16:18:37.260665,epoch time: 0:24:44.142981,used: 0:50:12.222092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97744226, 'precision': 0.9785726, 'recall': 0.9615618, 'specificity': 0.9615618, 'f1': 0.9696827, 'auroc': 0.994435, 'binary_precision': 0.98074955, 'binary_recall': 0.92932445, 'binary_specificity': 0.9937992, 'binary_f1_score': 0.95434475}
confusion matrix:
       0      1
0  42151    263
1   1019  13399
---- Validation: 
scalar performance:
{'acc': 0.958698, 'precision': 0.7027214, 'recall': 0.70677817, 'specificity': 0.70677817, 'f1': 0.7047269, 'auroc': 0.9010129, 'binary_precision': 0.426492, 'binary_recall': 0.43536404, 'binary_specificity': 0.97819227, 'binary_f1_score': 0.43088236}
confusion matrix:
       0    1
0  17673  394
1    380  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692233, 'precision': 0.81277543, 'recall': 0.79084516, 'specificity': 0.79084516, 'f1': 0.80136347, 'auroc': 0.9216888, 'binary_precision': 0.64315355, 'binary_recall': 0.59615386, 'binary_specificity': 0.9855365, 'binary_f1_score': 0.6187625}
confusion matrix:
      0    1
0  5860   86
1   105  155
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-10 16:44:54.187820,epoch time: 0:26:16.927155,used: 1:16:29.149247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97955376, 'precision': 0.97919273, 'recall': 0.96652645, 'specificity': 0.96652645, 'f1': 0.9726457, 'auroc': 0.99508375, 'binary_precision': 0.9784884, 'binary_recall': 0.94007903, 'binary_specificity': 0.99297386, 'binary_f1_score': 0.95889926}
confusion matrix:
       0      1
0  42115    298
1    864  13555
---- Validation: 
scalar performance:
{'acc': 0.96093917, 'precision': 0.71876436, 'recall': 0.72439164, 'specificity': 0.72439164, 'f1': 0.7215376, 'auroc': 0.90618014, 'binary_precision': 0.45730826, 'binary_recall': 0.46953937, 'binary_specificity': 0.97924393, 'binary_f1_score': 0.46334314}
confusion matrix:
       0    1
0  17692  375
1    357  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97147924, 'precision': 0.82725745, 'recall': 0.8067343, 'specificity': 0.8067343, 'f1': 0.8166243, 'auroc': 0.9218426, 'binary_precision': 0.6707819, 'binary_recall': 0.6269231, 'binary_specificity': 0.98654556, 'binary_f1_score': 0.64811134}
confusion matrix:
      0    1
0  5866   80
1    97  163
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-10 17:10:39.505930,epoch time: 0:25:45.318110,used: 1:42:14.467357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98083824, 'precision': 0.97766805, 'recall': 0.97150683, 'specificity': 0.97150683, 'f1': 0.9745362, 'auroc': 0.9957875, 'binary_precision': 0.9713578, 'binary_recall': 0.9525626, 'binary_specificity': 0.99045104, 'binary_f1_score': 0.96186835}
confusion matrix:
       0      1
0  42008    405
1    684  13735
---- Validation: 
scalar performance:
{'acc': 0.9602455, 'precision': 0.71760833, 'recall': 0.7476357, 'specificity': 0.7476357, 'f1': 0.73152065, 'auroc': 0.9046299, 'binary_precision': 0.45324674, 'binary_recall': 0.5185735, 'binary_specificity': 0.97669786, 'binary_f1_score': 0.48371446}
confusion matrix:
       0    1
0  17646  421
1    324  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.8049017, 'recall': 0.8071438, 'specificity': 0.8071438, 'f1': 0.8060181, 'auroc': 0.91678, 'binary_precision': 0.6259542, 'binary_recall': 0.63076925, 'binary_specificity': 0.9835183, 'binary_f1_score': 0.6283525}
confusion matrix:
      0    1
0  5848   98
1    96  164
early stop counter: 1
val acc:0.9602454900741577, best validation acc: 0.9609391689300537, corresponding to test acc:                         0.9714792370796204 / 0.9714792370796204
after epoch: 5,now: 2024-07-10 17:37:09.561706,epoch time: 0:26:30.055776,used: 2:08:44.523133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98300254, 'precision': 0.9808653, 'recall': 0.9740569, 'specificity': 0.9740569, 'f1': 0.9773991, 'auroc': 0.9965167, 'binary_precision': 0.97661895, 'binary_recall': 0.9558946, 'binary_specificity': 0.9922192, 'binary_f1_score': 0.96614563}
confusion matrix:
       0      1
0  42082    330
1    636  13784
---- Validation: 
scalar performance:
{'acc': 0.9572572, 'precision': 0.7062944, 'recall': 0.77183557, 'specificity': 0.77183557, 'f1': 0.73391366, 'auroc': 0.9052105, 'binary_precision': 0.42873052, 'binary_recall': 0.57206535, 'binary_specificity': 0.9716057, 'binary_f1_score': 0.49013367}
confusion matrix:
       0    1
0  17554  513
1    288  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.7719343, 'recall': 0.83228993, 'specificity': 0.83228993, 'f1': 0.7986651, 'auroc': 0.9177475, 'binary_precision': 0.5576324, 'binary_recall': 0.68846154, 'binary_specificity': 0.9761184, 'binary_f1_score': 0.616179}
confusion matrix:
      0    1
0  5804  142
1    81  179
early stop counter: 2
val acc:0.9572572112083435, best validation acc: 0.9609391689300537, corresponding to test acc:                         0.9714792370796204 / 0.9714792370796204
after epoch: 6,now: 2024-07-10 18:03:29.143956,epoch time: 0:26:19.582250,used: 2:35:04.105383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9830905, 'precision': 0.9831964, 'recall': 0.97196126, 'specificity': 0.97196126, 'f1': 0.97741205, 'auroc': 0.9968373, 'binary_precision': 0.983404, 'binary_recall': 0.94936883, 'binary_specificity': 0.9945537, 'binary_f1_score': 0.9660867}
confusion matrix:
       0      1
0  42183    231
1    730  13688
---- Validation: 
scalar performance:
{'acc': 0.9629136, 'precision': 0.7323375, 'recall': 0.73399884, 'specificity': 0.73399884, 'f1': 0.7331648, 'auroc': 0.90472746, 'binary_precision': 0.48377582, 'binary_recall': 0.48736998, 'binary_specificity': 0.98062766, 'binary_f1_score': 0.48556623}
confusion matrix:
       0    1
0  17717  350
1    345  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9738962, 'precision': 0.85200477, 'recall': 0.80247873, 'specificity': 0.80247873, 'f1': 0.8251606, 'auroc': 0.9141574, 'binary_precision': 0.7207207, 'binary_recall': 0.61538464, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.66390043}
confusion matrix:
      0    1
0  5884   62
1   100  160
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-10 18:30:09.417847,epoch time: 0:26:40.273891,used: 3:01:44.379274,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9847269, 'precision': 0.9855866, 'recall': 0.9739503, 'specificity': 0.9739503, 'f1': 0.97959083, 'auroc': 0.9969386, 'binary_precision': 0.9872699, 'binary_recall': 0.9520738, 'binary_specificity': 0.99582684, 'binary_f1_score': 0.9693525}
confusion matrix:
       0      1
0  42237    177
1    691  13727
---- Validation: 
scalar performance:
{'acc': 0.95912486, 'precision': 0.712379, 'recall': 0.7527766, 'specificity': 0.7527766, 'f1': 0.7305773, 'auroc': 0.9079287, 'binary_precision': 0.44237918, 'binary_recall': 0.5304606, 'binary_specificity': 0.9750927, 'binary_f1_score': 0.48243243}
confusion matrix:
       0    1
0  17617  450
1    316  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97196263, 'precision': 0.8265054, 'recall': 0.8216985, 'specificity': 0.8216985, 'f1': 0.82408196, 'auroc': 0.9181751, 'binary_precision': 0.66796875, 'binary_recall': 0.6576923, 'binary_specificity': 0.98570466, 'binary_f1_score': 0.6627907}
confusion matrix:
      0    1
0  5861   85
1    89  171
early stop counter: 1
val acc:0.9591248631477356, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 8,now: 2024-07-10 18:55:30.383310,epoch time: 0:25:20.965463,used: 3:27:05.344737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9851668, 'precision': 0.98574245, 'recall': 0.9749531, 'specificity': 0.9749531, 'f1': 0.98019505, 'auroc': 0.99711186, 'binary_precision': 0.9868723, 'binary_recall': 0.9542207, 'binary_specificity': 0.9956855, 'binary_f1_score': 0.97027194}
confusion matrix:
       0      1
0  42232    183
1    660  13757
---- Validation: 
scalar performance:
{'acc': 0.9585912, 'precision': 0.7124444, 'recall': 0.7725274, 'specificity': 0.7725274, 'f1': 0.7382322, 'auroc': 0.9114744, 'binary_precision': 0.44100803, 'binary_recall': 0.57206535, 'binary_specificity': 0.97298944, 'binary_f1_score': 0.49805948}
confusion matrix:
       0    1
0  17579  488
1    288  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703513, 'precision': 0.8130422, 'recall': 0.82453555, 'specificity': 0.82453555, 'f1': 0.8186723, 'auroc': 0.9224212, 'binary_precision': 0.64074075, 'binary_recall': 0.6653846, 'binary_specificity': 0.9836865, 'binary_f1_score': 0.6528302}
confusion matrix:
      0    1
0  5849   97
1    87  173
early stop counter: 2
val acc:0.9585912227630615, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 9,now: 2024-07-10 19:20:29.281965,epoch time: 0:24:58.898655,used: 3:52:04.243392,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98602897, 'precision': 0.9860716, 'recall': 0.9769071, 'specificity': 0.9769071, 'f1': 0.98137903, 'auroc': 0.997399, 'binary_precision': 0.9861557, 'binary_recall': 0.9583882, 'binary_specificity': 0.99542594, 'binary_f1_score': 0.97207373}
confusion matrix:
       0      1
0  42219    194
1    600  13819
---- Validation: 
scalar performance:
{'acc': 0.9585912, 'precision': 0.7095625, 'recall': 0.7517847, 'specificity': 0.7517847, 'f1': 0.7284671, 'auroc': 0.90766513, 'binary_precision': 0.4368098, 'binary_recall': 0.5289747, 'binary_specificity': 0.9745946, 'binary_f1_score': 0.47849458}
confusion matrix:
       0    1
0  17608  459
1    317  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703513, 'precision': 0.8158257, 'recall': 0.81350166, 'specificity': 0.81350166, 'f1': 0.8146589, 'auroc': 0.9156123, 'binary_precision': 0.64728683, 'binary_recall': 0.6423077, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.64478767}
confusion matrix:
      0    1
0  5855   91
1    93  167
early stop counter: 3
val acc:0.9585912227630615, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 10,now: 2024-07-10 19:45:17.890957,epoch time: 0:24:48.608992,used: 4:16:52.852384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98622257, 'precision': 0.9844192, 'recall': 0.97907495, 'specificity': 0.97907495, 'f1': 0.9817092, 'auroc': 0.9972567, 'binary_precision': 0.9808194, 'binary_recall': 0.96456313, 'binary_specificity': 0.9935867, 'binary_f1_score': 0.9726233}
confusion matrix:
       0      1
0  42140    272
1    511  13909
---- Validation: 
scalar performance:
{'acc': 0.95715046, 'precision': 0.70738953, 'recall': 0.7825092, 'specificity': 0.7825092, 'f1': 0.7383411, 'auroc': 0.91047025, 'binary_precision': 0.43010753, 'binary_recall': 0.5943536, 'binary_specificity': 0.97066474, 'binary_f1_score': 0.49906427}
confusion matrix:
       0    1
0  17537  530
1    273  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.78184056, 'recall': 0.833215, 'specificity': 0.833215, 'f1': 0.8050839, 'auroc': 0.9208291, 'binary_precision': 0.57741934, 'binary_recall': 0.68846154, 'binary_specificity': 0.9779684, 'binary_f1_score': 0.6280702}
confusion matrix:
      0    1
0  5815  131
1    81  179
early stop counter: 4
val acc:0.9571504592895508, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 11,now: 2024-07-10 20:10:16.585886,epoch time: 0:24:58.694929,used: 4:41:51.547313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9860642, 'precision': 0.985608, 'recall': 0.97745705, 'specificity': 0.97745705, 'f1': 0.98144495, 'auroc': 0.9974548, 'binary_precision': 0.98470515, 'binary_recall': 0.95998335, 'binary_specificity': 0.9949308, 'binary_f1_score': 0.97218704}
confusion matrix:
       0      1
0  42198    215
1    577  13842
---- Validation: 
scalar performance:
{'acc': 0.9578442, 'precision': 0.709361, 'recall': 0.77500105, 'specificity': 0.77500105, 'f1': 0.73708767, 'auroc': 0.9116397, 'binary_precision': 0.43463686, 'binary_recall': 0.5780089, 'binary_specificity': 0.97199315, 'binary_f1_score': 0.4961735}
confusion matrix:
       0    1
0  17561  506
1    284  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671286, 'precision': 0.7930875, 'recall': 0.8081418, 'specificity': 0.8081418, 'f1': 0.80040145, 'auroc': 0.9167011, 'binary_precision': 0.6021898, 'binary_recall': 0.63461536, 'binary_specificity': 0.98166835, 'binary_f1_score': 0.6179775}
confusion matrix:
      0    1
0  5837  109
1    95  165
early stop counter: 5
val acc:0.9578441977500916, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 12,now: 2024-07-10 20:35:14.177598,epoch time: 0:24:57.591712,used: 5:06:49.139025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9880525, 'precision': 0.98734117, 'recall': 0.98101044, 'specificity': 0.98101044, 'f1': 0.9841231, 'auroc': 0.9979878, 'binary_precision': 0.98592544, 'binary_recall': 0.9667129, 'binary_specificity': 0.9953079, 'binary_f1_score': 0.9762246}
confusion matrix:
       0      1
0  42213    199
1    480  13940
---- Validation: 
scalar performance:
{'acc': 0.9566702, 'precision': 0.70221746, 'recall': 0.76223266, 'specificity': 0.76223266, 'f1': 0.72777295, 'auroc': 0.9101105, 'binary_precision': 0.42129105, 'binary_recall': 0.55274886, 'binary_specificity': 0.9717164, 'binary_f1_score': 0.4781491}
confusion matrix:
       0    1
0  17556  511
1    301  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.784317, 'recall': 0.8093082, 'specificity': 0.8093082, 'f1': 0.79621553, 'auroc': 0.9198867, 'binary_precision': 0.58450705, 'binary_recall': 0.63846153, 'binary_specificity': 0.98015475, 'binary_f1_score': 0.61029416}
confusion matrix:
      0    1
0  5828  118
1    94  166
early stop counter: 6
val acc:0.9566702246665955, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 13,now: 2024-07-10 20:59:56.938968,epoch time: 0:24:42.761370,used: 5:31:31.900395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9878881, 'recall': 0.9810699, 'specificity': 0.9810699, 'f1': 0.98441803, 'auroc': 0.9980272, 'binary_precision': 0.9871068, 'binary_recall': 0.96643084, 'binary_specificity': 0.99570894, 'binary_f1_score': 0.97665936}
confusion matrix:
       0      1
0  42232    182
1    484  13934
---- Validation: 
scalar performance:
{'acc': 0.95731056, 'precision': 0.6995828, 'recall': 0.7296624, 'specificity': 0.7296624, 'f1': 0.71341544, 'auroc': 0.9073064, 'binary_precision': 0.41848522, 'binary_recall': 0.48439822, 'binary_specificity': 0.97492665, 'binary_f1_score': 0.4490358}
confusion matrix:
       0    1
0  17614  453
1    347  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.8045511, 'recall': 0.78657854, 'specificity': 0.78657854, 'f1': 0.7952577, 'auroc': 0.9174356, 'binary_precision': 0.6270492, 'binary_recall': 0.5884615, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.60714287}
confusion matrix:
      0    1
0  5855   91
1   107  153
early stop counter: 7
val acc:0.9573105573654175, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 14,now: 2024-07-10 21:25:43.582155,epoch time: 0:25:46.643187,used: 5:57:18.543582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98708475, 'precision': 0.9843119, 'recall': 0.9815063, 'specificity': 0.9815063, 'f1': 0.9828986, 'auroc': 0.99794185, 'binary_precision': 0.97873235, 'binary_recall': 0.97018033, 'binary_specificity': 0.99283224, 'binary_f1_score': 0.9744376}
confusion matrix:
       0      1
0  42108    304
1    430  13990
---- Validation: 
scalar performance:
{'acc': 0.95128065, 'precision': 0.6876708, 'recall': 0.7959161, 'specificity': 0.7959161, 'f1': 0.72769797, 'auroc': 0.9096917, 'binary_precision': 0.38950276, 'binary_recall': 0.62852895, 'binary_specificity': 0.96330327, 'binary_f1_score': 0.4809551}
confusion matrix:
       0    1
0  17404  663
1    250  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95230424, 'precision': 0.721942, 'recall': 0.84270227, 'specificity': 0.84270227, 'f1': 0.76715547, 'auroc': 0.92452264, 'binary_precision': 0.4563107, 'binary_recall': 0.72307694, 'binary_specificity': 0.9623276, 'binary_f1_score': 0.5595239}
confusion matrix:
      0    1
0  5722  224
1    72  188
early stop counter: 8
val acc:0.9512806534767151, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 15,now: 2024-07-10 21:50:22.320519,epoch time: 0:24:38.738364,used: 6:21:57.281946,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9884572, 'precision': 0.9882396, 'recall': 0.9811889, 'specificity': 0.9811889, 'f1': 0.9846492, 'auroc': 0.99802864, 'binary_precision': 0.98780745, 'binary_recall': 0.96643317, 'binary_specificity': 0.9959446, 'binary_f1_score': 0.97700346}
confusion matrix:
       0      1
0  42241    172
1    484  13935
---- Validation: 
scalar performance:
{'acc': 0.9587513, 'precision': 0.709537, 'recall': 0.7461455, 'specificity': 0.7461455, 'f1': 0.726163, 'auroc': 0.9066276, 'binary_precision': 0.43718594, 'binary_recall': 0.51708764, 'binary_specificity': 0.9752034, 'binary_f1_score': 0.4737917}
confusion matrix:
       0    1
0  17619  448
1    325  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.8125812, 'recall': 0.7964462, 'specificity': 0.7964462, 'f1': 0.8042737, 'auroc': 0.9148964, 'binary_precision': 0.6422764, 'binary_recall': 0.6076923, 'binary_specificity': 0.9852001, 'binary_f1_score': 0.6245059}
confusion matrix:
      0    1
0  5858   88
1   102  158
early stop counter: 9
val acc:0.9587513208389282, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 16,now: 2024-07-10 22:14:55.584061,epoch time: 0:24:33.263542,used: 6:46:30.545488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9893722, 'precision': 0.9903096, 'recall': 0.9815719, 'specificity': 0.9815719, 'f1': 0.9858415, 'auroc': 0.99843174, 'binary_precision': 0.99216187, 'binary_recall': 0.9657373, 'binary_specificity': 0.99740654, 'binary_f1_score': 0.9787713}
confusion matrix:
       0      1
0  42304    110
1    494  13924
---- Validation: 
scalar performance:
{'acc': 0.9603522, 'precision': 0.7192948, 'recall': 0.7569895, 'specificity': 0.7569895, 'f1': 0.7364464, 'auroc': 0.91138184, 'binary_precision': 0.45591938, 'binary_recall': 0.53789, 'binary_specificity': 0.976089, 'binary_f1_score': 0.4935242}
confusion matrix:
       0    1
0  17635  432
1    311  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9727683, 'precision': 0.84511226, 'recall': 0.79269516, 'specificity': 0.79269516, 'f1': 0.8165096, 'auroc': 0.91732305, 'binary_precision': 0.70776254, 'binary_recall': 0.59615386, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.64718163}
confusion matrix:
      0    1
0  5882   64
1   105  155
early stop counter: 10
val acc:0.9603521823883057, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 17,now: 2024-07-10 22:39:32.643715,epoch time: 0:24:37.059654,used: 7:11:07.605142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98953056, 'precision': 0.98837966, 'recall': 0.98389924, 'specificity': 0.98389924, 'f1': 0.9861131, 'auroc': 0.99836355, 'binary_precision': 0.98607594, 'binary_recall': 0.9724669, 'binary_specificity': 0.99533165, 'binary_f1_score': 0.97922415}
confusion matrix:
       0      1
0  42215    198
1    397  14022
---- Validation: 
scalar performance:
{'acc': 0.9584312, 'precision': 0.71080977, 'recall': 0.76600695, 'specificity': 0.76600695, 'f1': 0.7347563, 'auroc': 0.911029, 'binary_precision': 0.43822843, 'binary_recall': 0.5586924, 'binary_specificity': 0.9733215, 'binary_f1_score': 0.4911822}
confusion matrix:
       0    1
0  17585  482
1    297  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.7887076, 'recall': 0.80036545, 'specificity': 0.80036545, 'f1': 0.79440594, 'auroc': 0.91641116, 'binary_precision': 0.59409595, 'binary_recall': 0.61923075, 'binary_specificity': 0.98150015, 'binary_f1_score': 0.60640305}
confusion matrix:
      0    1
0  5836  110
1    99  161
early stop counter: 11
val acc:0.9584311842918396, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 18,now: 2024-07-10 23:04:06.381382,epoch time: 0:24:33.737667,used: 7:35:41.342809,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.989161, 'precision': 0.9883536, 'recall': 0.9829432, 'specificity': 0.9829432, 'f1': 0.98561, 'auroc': 0.99795115, 'binary_precision': 0.9867419, 'binary_recall': 0.970319, 'binary_specificity': 0.9955673, 'binary_f1_score': 0.97846156}
confusion matrix:
       0      1
0  42224    188
1    428  13992
---- Validation: 
scalar performance:
{'acc': 0.9590715, 'precision': 0.7116059, 'recall': 0.7491726, 'specificity': 0.7491726, 'f1': 0.7286429, 'auroc': 0.9084053, 'binary_precision': 0.44110274, 'binary_recall': 0.5230312, 'binary_specificity': 0.9753141, 'binary_f1_score': 0.478586}
confusion matrix:
       0    1
0  17621  446
1    321  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97131807, 'precision': 0.8333183, 'recall': 0.7864214, 'specificity': 0.7864214, 'f1': 0.80789256, 'auroc': 0.91415316, 'binary_precision': 0.6846847, 'binary_recall': 0.5846154, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.6307054}
confusion matrix:
      0    1
0  5876   70
1   108  152
early stop counter: 12
val acc:0.9590715169906616, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 19,now: 2024-07-10 23:28:59.987723,epoch time: 0:24:53.606341,used: 8:00:34.949150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98942494, 'precision': 0.9876088, 'recall': 0.98440075, 'specificity': 0.98440075, 'f1': 0.98599124, 'auroc': 0.9984753, 'binary_precision': 0.9839591, 'binary_recall': 0.9742007, 'binary_specificity': 0.9946007, 'binary_f1_score': 0.9790556}
confusion matrix:
       0      1
0  42184    229
1    372  14047
---- Validation: 
scalar performance:
{'acc': 0.95720387, 'precision': 0.7024412, 'recall': 0.74891925, 'specificity': 0.74891925, 'f1': 0.72293735, 'auroc': 0.90630114, 'binary_precision': 0.4227545, 'binary_recall': 0.52451706, 'binary_specificity': 0.9733215, 'binary_f1_score': 0.46816975}
confusion matrix:
       0    1
0  17585  482
1    320  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.78461313, 'recall': 0.7814711, 'specificity': 0.7814711, 'f1': 0.78303224, 'auroc': 0.90713394, 'binary_precision': 0.5875486, 'binary_recall': 0.58076924, 'binary_specificity': 0.9821729, 'binary_f1_score': 0.5841393}
confusion matrix:
      0    1
0  5840  106
1   109  151
early stop counter: 13
val acc:0.9572038650512695, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 20,now: 2024-07-10 23:53:46.834692,epoch time: 0:24:46.846969,used: 8:25:21.796119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9896361, 'precision': 0.9889536, 'recall': 0.9836047, 'specificity': 0.9836047, 'f1': 0.9862417, 'auroc': 0.9986378, 'binary_precision': 0.9875908, 'binary_recall': 0.97135925, 'binary_specificity': 0.9958502, 'binary_f1_score': 0.9794078}
confusion matrix:
       0      1
0  42236    176
1    413  14007
---- Validation: 
scalar performance:
{'acc': 0.95805764, 'precision': 0.7062434, 'recall': 0.7472163, 'specificity': 0.7472163, 'f1': 0.72461313, 'auroc': 0.9079726, 'binary_precision': 0.4305043, 'binary_recall': 0.5200594, 'binary_specificity': 0.97437316, 'binary_f1_score': 0.47106323}
confusion matrix:
       0    1
0  17604  463
1    323  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.81821215, 'recall': 0.7686932, 'specificity': 0.7686932, 'f1': 0.791119, 'auroc': 0.9075403, 'binary_precision': 0.6559633, 'binary_recall': 0.55, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.5983263}
confusion matrix:
      0    1
0  5871   75
1   117  143
early stop counter: 14
val acc:0.9580576419830322, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 21,now: 2024-07-11 00:18:32.269412,epoch time: 0:24:45.434720,used: 8:50:07.230839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.989513, 'precision': 0.9910463, 'recall': 0.98123133, 'specificity': 0.98123133, 'f1': 0.986014, 'auroc': 0.9983418, 'binary_precision': 0.99406636, 'binary_recall': 0.9644195, 'binary_specificity': 0.9980431, 'binary_f1_score': 0.9790185}
confusion matrix:
       0      1
0  42331     83
1    513  13905
---- Validation: 
scalar performance:
{'acc': 0.96109927, 'precision': 0.71788275, 'recall': 0.70945406, 'specificity': 0.70945406, 'f1': 0.71357435, 'auroc': 0.907244, 'binary_precision': 0.45665634, 'binary_recall': 0.4383358, 'binary_specificity': 0.98057234, 'binary_f1_score': 0.44730857}
confusion matrix:
       0    1
0  17716  351
1    378  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.861091, 'recall': 0.72732157, 'specificity': 0.72732157, 'f1': 0.77748835, 'auroc': 0.9080948, 'binary_precision': 0.7453416, 'binary_recall': 0.46153846, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.5700713}
confusion matrix:
      0    1
0  5905   41
1   140  120
early stop counter: 15
val acc:0.9610992670059204, best validation acc: 0.9629135727882385, corresponding to test acc:                         0.9738962054252625 / 0.9738962054252625
after epoch: 22,now: 2024-07-11 00:43:03.509921,epoch time: 0:24:31.240509,used: 9:14:38.471348,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9900056, 'precision': 0.990783, 'recall': 0.9827756, 'specificity': 0.9827756, 'f1': 0.986696, 'auroc': 0.99859905, 'binary_precision': 0.99232244, 'binary_recall': 0.9680976, 'binary_specificity': 0.99745363, 'binary_f1_score': 0.98006034}
confusion matrix:
       0      1
0  42305    108
1    460  13959
---- Validation: 
scalar performance:
{'acc': 0.9632871, 'precision': 0.73132956, 'recall': 0.6812628, 'specificity': 0.6812628, 'f1': 0.70289385, 'auroc': 0.9046078, 'binary_precision': 0.48565966, 'binary_recall': 0.37741455, 'binary_specificity': 0.985111, 'binary_f1_score': 0.4247492}
confusion matrix:
       0    1
0  17798  269
1    419  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.865744, 'recall': 0.69530195, 'specificity': 0.69530195, 'f1': 0.7521949, 'auroc': 0.9040531, 'binary_precision': 0.75735295, 'binary_recall': 0.39615384, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.520202}
confusion matrix:
      0    1
0  5913   33
1   157  103
better model found
persisted
after epoch: 23,now: 2024-07-11 01:07:32.910463,epoch time: 0:24:29.400542,used: 9:39:07.871890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98982966, 'precision': 0.99057055, 'recall': 0.98252153, 'specificity': 0.98252153, 'f1': 0.98646176, 'auroc': 0.99850655, 'binary_precision': 0.99203753, 'binary_recall': 0.9676838, 'binary_specificity': 0.9973592, 'binary_f1_score': 0.9797093}
confusion matrix:
       0      1
0  42300    112
1    466  13954
---- Validation: 
scalar performance:
{'acc': 0.9572572, 'precision': 0.7016067, 'recall': 0.7425096, 'specificity': 0.7425096, 'f1': 0.7198998, 'auroc': 0.9093343, 'binary_precision': 0.42156863, 'binary_recall': 0.5111441, 'binary_specificity': 0.97387505, 'binary_f1_score': 0.46205506}
confusion matrix:
       0    1
0  17595  472
1    329  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.7911903, 'recall': 0.77077353, 'specificity': 0.77077353, 'f1': 0.78056383, 'auroc': 0.90332186, 'binary_precision': 0.6016598, 'binary_recall': 0.5576923, 'binary_specificity': 0.9838547, 'binary_f1_score': 0.5788423}
confusion matrix:
      0    1
0  5850   96
1   115  145
early stop counter: 1
val acc:0.9572572112083435, best validation acc: 0.9632871150970459, corresponding to test acc:                         0.969384491443634 / 0.9738962054252625
after epoch: 24,now: 2024-07-11 01:32:07.015618,epoch time: 0:24:34.105155,used: 10:03:41.977045,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9912725, 'precision': 0.9921526, 'recall': 0.98476976, 'specificity': 0.98476976, 'f1': 0.9883905, 'auroc': 0.9987079, 'binary_precision': 0.993899, 'binary_recall': 0.9715673, 'binary_specificity': 0.99797225, 'binary_f1_score': 0.98260623}
confusion matrix:
       0      1
0  42326     86
1    410  14010
---- Validation: 
scalar performance:
{'acc': 0.96109927, 'precision': 0.7188881, 'recall': 0.717322, 'specificity': 0.717322, 'f1': 0.71810186, 'auroc': 0.9120543, 'binary_precision': 0.45808384, 'binary_recall': 0.45468053, 'binary_specificity': 0.9799635, 'binary_f1_score': 0.45637584}
confusion matrix:
       0    1
0  17705  362
1    367  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9722849, 'precision': 0.86438644, 'recall': 0.7501462, 'specificity': 0.7501462, 'f1': 0.7955713, 'auroc': 0.911989, 'binary_precision': 0.75, 'binary_recall': 0.50769234, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.60550463}
confusion matrix:
      0    1
0  5902   44
1   128  132
early stop counter: 2
val acc:0.9610992670059204, best validation acc: 0.9632871150970459, corresponding to test acc:                         0.969384491443634 / 0.9738962054252625
after epoch: 25,now: 2024-07-11 01:56:51.562825,epoch time: 0:24:44.547207,used: 10:28:26.524252,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98956573, 'precision': 0.98717415, 'recall': 0.9852282, 'specificity': 0.9852282, 'f1': 0.98619616, 'auroc': 0.9985481, 'binary_precision': 0.98234844, 'binary_recall': 0.97642165, 'binary_specificity': 0.9940347, 'binary_f1_score': 0.97937614}
confusion matrix:
       0      1
0  42159    253
1    340  14080
---- Validation: 
scalar performance:
{'acc': 0.96163285, 'precision': 0.7258126, 'recall': 0.7512163, 'specificity': 0.7512163, 'f1': 0.7377484, 'auroc': 0.9113199, 'binary_precision': 0.4694149, 'binary_recall': 0.52451706, 'binary_specificity': 0.9779155, 'binary_f1_score': 0.49543858}
confusion matrix:
       0    1
0  17668  399
1    320  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97454077, 'precision': 0.8774622, 'recall': 0.7733913, 'specificity': 0.7733913, 'f1': 0.81626797, 'auroc': 0.9170575, 'binary_precision': 0.7741935, 'binary_recall': 0.5538462, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.64574}
confusion matrix:
      0    1
0  5904   42
1   116  144
new oracle model saved
early stop counter: 3
val acc:0.9616328477859497, best validation acc: 0.9632871150970459, corresponding to test acc:                         0.969384491443634 / 0.9745407700538635
after epoch: 26,now: 2024-07-11 02:21:34.886889,epoch time: 0:24:43.324064,used: 10:53:09.848316,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9898649, 'precision': 0.9864241, 'recall': 0.9868246, 'specificity': 0.9868246, 'f1': 0.9866241, 'auroc': 0.9987786, 'binary_precision': 0.9794293, 'binary_recall': 0.98065186, 'binary_specificity': 0.9929973, 'binary_f1_score': 0.9800402}
confusion matrix:
       0      1
0  42115    297
1    279  14141
---- Validation: 
scalar performance:
{'acc': 0.9536286, 'precision': 0.6885805, 'recall': 0.7563636, 'specificity': 0.7563636, 'f1': 0.71649694, 'auroc': 0.9108401, 'binary_precision': 0.39439654, 'binary_recall': 0.54383355, 'binary_specificity': 0.9688936, 'binary_f1_score': 0.45721424}
confusion matrix:
       0    1
0  17505  562
1    307  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.77087855, 'recall': 0.774861, 'specificity': 0.774861, 'f1': 0.77285326, 'auroc': 0.9148301, 'binary_precision': 0.56060606, 'binary_recall': 0.5692308, 'binary_specificity': 0.9804911, 'binary_f1_score': 0.56488556}
confusion matrix:
      0    1
0  5830  116
1   112  148
early stop counter: 4
val acc:0.9536285996437073, best validation acc: 0.9632871150970459, corresponding to test acc:                         0.969384491443634 / 0.9745407700538635
after epoch: 27,now: 2024-07-11 02:46:01.357255,epoch time: 0:24:26.470366,used: 11:17:36.318682,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9906391, 'precision': 0.9912566, 'recall': 0.9839792, 'specificity': 0.9839792, 'f1': 0.98754907, 'auroc': 0.99874806, 'binary_precision': 0.99248224, 'binary_recall': 0.9704577, 'binary_specificity': 0.9975007, 'binary_f1_score': 0.98134637}
confusion matrix:
       0      1
0  42306    106
1    426  13994
---- Validation: 
scalar performance:
{'acc': 0.9627535, 'precision': 0.72999454, 'recall': 0.7174646, 'specificity': 0.7174646, 'f1': 0.7235321, 'auroc': 0.9062145, 'binary_precision': 0.48031497, 'binary_recall': 0.45319465, 'binary_specificity': 0.98173463, 'binary_f1_score': 0.4663609}
confusion matrix:
       0    1
0  17737  330
1    368  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.8639573, 'recall': 0.69714093, 'specificity': 0.69714093, 'f1': 0.7533991, 'auroc': 0.9163591, 'binary_precision': 0.7536232, 'binary_recall': 0.4, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.52261305}
confusion matrix:
      0    1
0  5912   34
1   156  104
early stop counter: 5
val acc:0.9627534747123718, best validation acc: 0.9632871150970459, corresponding to test acc:                         0.969384491443634 / 0.9745407700538635
after epoch: 28,now: 2024-07-11 03:10:29.879613,epoch time: 0:24:28.522358,used: 11:42:04.841040,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9914309, 'precision': 0.99258935, 'recall': 0.98476046, 'specificity': 0.98476046, 'f1': 0.9885956, 'auroc': 0.9986174, 'binary_precision': 0.9948849, 'binary_recall': 0.9712185, 'binary_specificity': 0.9983024, 'binary_f1_score': 0.98290926}
confusion matrix:
       0      1
0  42341     72
1    415  14004
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.73785686, 'recall': 0.6637962, 'specificity': 0.6637962, 'f1': 0.69321823, 'auroc': 0.9004029, 'binary_precision': 0.5, 'binary_recall': 0.34026745, 'binary_specificity': 0.98732495, 'binary_f1_score': 0.40495136}
confusion matrix:
       0    1
0  17838  229
1    444  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.8834276, 'recall': 0.63502485, 'specificity': 0.63502485, 'f1': 0.69485843, 'auroc': 0.90828496, 'binary_precision': 0.7977528, 'binary_recall': 0.27307692, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.40687677}
confusion matrix:
      0   1
0  5928  18
1   189  71
better model found
persisted
after epoch: 29,now: 2024-07-11 03:35:14.072180,epoch time: 0:24:44.192567,used: 12:06:49.033607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9916772, 'precision': 0.9920962, 'recall': 0.9858859, 'specificity': 0.9858859, 'f1': 0.988941, 'auroc': 0.99889064, 'binary_precision': 0.99293035, 'binary_recall': 0.97412956, 'binary_specificity': 0.9976423, 'binary_f1_score': 0.9834401}
confusion matrix:
       0      1
0  42314    100
1    373  14045
---- Validation: 
scalar performance:
{'acc': 0.9572572, 'precision': 0.69944566, 'recall': 0.73035, 'specificity': 0.73035, 'f1': 0.713625, 'auroc': 0.9073949, 'binary_precision': 0.41815856, 'binary_recall': 0.4858841, 'binary_specificity': 0.97481596, 'binary_f1_score': 0.44948456}
confusion matrix:
       0    1
0  17612  455
1    346  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96841764, 'precision': 0.82157934, 'recall': 0.74261105, 'specificity': 0.74261105, 'f1': 0.7759456, 'auroc': 0.9119971, 'binary_precision': 0.66494846, 'binary_recall': 0.49615383, 'binary_specificity': 0.98906827, 'binary_f1_score': 0.5682819}
confusion matrix:
      0    1
0  5881   65
1   131  129
early stop counter: 1
val acc:0.9572572112083435, best validation acc: 0.9640874862670898, corresponding to test acc:                         0.9666451811790466 / 0.9745407700538635
after epoch: 30,now: 2024-07-11 03:59:58.514208,epoch time: 0:24:44.442028,used: 12:31:33.475635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_15_28_24_seed_1_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:31:33.475635 at 2024-07-11 03:59:58.514208
persisted model performance metric: 

scalar performance:
{'acc': 0.9666452, 'precision': 0.8834276, 'recall': 0.63502485, 'specificity': 0.63502485, 'f1': 0.69485843, 'auroc': 0.90828496, 'binary_precision': 0.7977528, 'binary_recall': 0.27307692, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.40687677}
confusion matrix:
      0   1
0  5928  18
1   189  71
oracle model performance metric: 

scalar performance:
{'acc': 0.97454077, 'precision': 0.8774622, 'recall': 0.7733913, 'specificity': 0.7733913, 'f1': 0.81626797, 'auroc': 0.9170575, 'binary_precision': 0.7741935, 'binary_recall': 0.5538462, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.64574}
confusion matrix:
      0    1
0  5904   42
1   116  144
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197647 KiB |   1195 MiB |   1915 TiB |   1915 TiB |
|       from large pool | 180168 KiB |   1178 MiB |   1889 TiB |   1889 TiB |
|       from small pool |  17479 KiB |     37 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197647 KiB |   1195 MiB |   1915 TiB |   1915 TiB |
|       from large pool | 180168 KiB |   1178 MiB |   1889 TiB |   1889 TiB |
|       from small pool |  17479 KiB |     37 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   1193 MiB |   1915 TiB |   1915 TiB |
|       from large pool | 178979 KiB |   1176 MiB |   1889 TiB |   1889 TiB |
|       from small pool |  16480 KiB |     36 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1330 MiB |   1352 MiB |   2438 MiB |   1108 MiB |
|       from large pool |   1292 MiB |   1310 MiB |   2382 MiB |   1090 MiB |
|       from small pool |     38 MiB |     42 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  54256 KiB | 153640 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  45111 KiB | 150341 KiB |   1014 TiB |   1014 TiB |
|       from small pool |   9145 KiB |  18291 KiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7605    |  334749 K  |  334746 K  |
|       from large pool |      79    |     167    |  180649 K  |  180649 K  |
|       from small pool |    2875    |    7525    |  154099 K  |  154096 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7605    |  334749 K  |  334746 K  |
|       from large pool |      79    |     167    |  180649 K  |  180649 K  |
|       from small pool |    2875    |    7525    |  154099 K  |  154096 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      76    |     127    |      53    |
|       from large pool |      55    |      55    |      99    |      44    |
|       from small pool |      19    |      21    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3585    |  203683 K  |  203683 K  |
|       from large pool |      12    |      57    |  128474 K  |  128474 K  |
|       from small pool |      21    |    3574    |   75209 K  |   75209 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB |   1915 TiB |   1915 TiB |
|       from large pool |  16640 KiB |   1178 MiB |   1889 TiB |   1889 TiB |
|       from small pool |      0 KiB |     37 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB |   1915 TiB |   1915 TiB |
|       from large pool |  16640 KiB |   1178 MiB |   1889 TiB |   1889 TiB |
|       from small pool |      0 KiB |     37 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |   1915 TiB |   1915 TiB |
|       from large pool |  16640 KiB |   1176 MiB |   1889 TiB |   1889 TiB |
|       from small pool |      0 KiB |     36 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 251904 KiB |   1352 MiB |   2438 MiB |   2192 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   2382 MiB |   2162 MiB |
|       from small pool |  26624 KiB |     42 MiB |     56 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 153640 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  24320 KiB | 150341 KiB |   1014 TiB |   1014 TiB |
|       from small pool |      0 KiB |  20351 KiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |  334749 K  |  334749 K  |
|       from large pool |       2    |     167    |  180649 K  |  180649 K  |
|       from small pool |       0    |    7525    |  154099 K  |  154099 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |  334749 K  |  334749 K  |
|       from large pool |       2    |     167    |  180649 K  |  180649 K  |
|       from small pool |       0    |    7525    |  154099 K  |  154099 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      76    |     127    |     103    |
|       from large pool |      11    |      55    |      99    |      88    |
|       from small pool |      13    |      21    |      28    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3585    |  203684 K  |  203684 K  |
|       from large pool |       4    |      57    |  128474 K  |  128474 K  |
|       from small pool |       0    |    3574    |   75210 K  |   75210 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB |   1915 TiB |   1915 TiB |
|       from large pool |  16640 KiB |   1178 MiB |   1889 TiB |   1889 TiB |
|       from small pool |      0 KiB |     37 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB |   1915 TiB |   1915 TiB |
|       from large pool |  16640 KiB |   1178 MiB |   1889 TiB |   1889 TiB |
|       from small pool |      0 KiB |     37 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |   1915 TiB |   1915 TiB |
|       from large pool |  16640 KiB |   1176 MiB |   1889 TiB |   1889 TiB |
|       from small pool |      0 KiB |     36 MiB |     25 TiB |     25 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 251904 KiB |   1352 MiB |   2438 MiB |   2192 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   2382 MiB |   2162 MiB |
|       from small pool |  26624 KiB |     42 MiB |     56 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 153640 KiB |   1040 TiB |   1040 TiB |
|       from large pool |  24320 KiB | 150341 KiB |   1014 TiB |   1014 TiB |
|       from small pool |      0 KiB |  20351 KiB |     26 TiB |     26 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |  334749 K  |  334749 K  |
|       from large pool |       2    |     167    |  180649 K  |  180649 K  |
|       from small pool |       0    |    7525    |  154099 K  |  154099 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |  334749 K  |  334749 K  |
|       from large pool |       2    |     167    |  180649 K  |  180649 K  |
|       from small pool |       0    |    7525    |  154099 K  |  154099 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      76    |     127    |     103    |
|       from large pool |      11    |      55    |      99    |      88    |
|       from small pool |      13    |      21    |      28    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3585    |  203684 K  |  203684 K  |
|       from large pool |       4    |      57    |  128474 K  |  128474 K  |
|       from small pool |       0    |    3574    |   75210 K  |   75210 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617

 Experiment start at: 2024-07-11 04:18:59.657057
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96666086, 'precision': 0.965047, 'recall': 0.9483007, 'specificity': 0.9483007, 'f1': 0.9562627, 'auroc': 0.9869226, 'binary_precision': 0.9618315, 'binary_recall': 0.90950555, 'binary_specificity': 0.98709583, 'binary_f1_score': 0.93493694}
confusion matrix:
       0      1
0  41766    546
1   1369  13759
---- Validation: 
scalar performance:
{'acc': 0.9627657, 'precision': 0.6861824, 'recall': 0.6442888, 'specificity': 0.6442888, 'f1': 0.66225064, 'auroc': 0.84874386, 'binary_precision': 0.39524838, 'binary_recall': 0.3039867, 'binary_specificity': 0.9845908, 'binary_f1_score': 0.34366196}
confusion matrix:
       0    1
0  17891  280
1    419  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94422185, 'precision': 0.6229692, 'recall': 0.6200404, 'specificity': 0.6200404, 'f1': 0.62148327, 'auroc': 0.8124937, 'binary_precision': 0.27542374, 'binary_recall': 0.26859504, 'binary_specificity': 0.97148573, 'binary_f1_score': 0.27196655}
confusion matrix:
      0    1
0  5826  171
1   177   65
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 04:44:43.615135,epoch time: 0:25:43.958078,used: 0:25:43.958078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97369426, 'precision': 0.97480816, 'recall': 0.95702934, 'specificity': 0.95702934, 'f1': 0.9654683, 'auroc': 0.9923265, 'binary_precision': 0.97702277, 'binary_recall': 0.921811, 'binary_specificity': 0.9922477, 'binary_f1_score': 0.9486142}
confusion matrix:
       0      1
0  41982    328
1   1183  13947
---- Validation: 
scalar performance:
{'acc': 0.96500295, 'precision': 0.70480984, 'recall': 0.6406262, 'specificity': 0.6406262, 'f1': 0.6660828, 'auroc': 0.86566764, 'binary_precision': 0.43276283, 'binary_recall': 0.29401994, 'binary_specificity': 0.9872324, 'binary_f1_score': 0.35014835}
confusion matrix:
       0    1
0  17939  232
1    425  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94053537, 'precision': 0.6312862, 'recall': 0.6637258, 'specificity': 0.6637258, 'f1': 0.6453298, 'auroc': 0.86414766, 'binary_precision': 0.2885246, 'binary_recall': 0.36363637, 'binary_specificity': 0.9638152, 'binary_f1_score': 0.32175502}
confusion matrix:
      0    1
0  5780  217
1   154   88
better model found
persisted
after epoch: 2,now: 2024-07-11 05:09:46.792093,epoch time: 0:25:03.176958,used: 0:50:47.135036,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97764623, 'precision': 0.9765245, 'recall': 0.96554995, 'specificity': 0.96554995, 'f1': 0.9708648, 'auroc': 0.9944419, 'binary_precision': 0.97424304, 'binary_recall': 0.93998677, 'binary_specificity': 0.9911132, 'binary_f1_score': 0.9568084}
confusion matrix:
       0      1
0  41934    376
1    908  14222
---- Validation: 
scalar performance:
{'acc': 0.9638843, 'precision': 0.7041941, 'recall': 0.68180686, 'specificity': 0.68180686, 'f1': 0.6922739, 'auroc': 0.87726676, 'binary_precision': 0.42883894, 'binary_recall': 0.38039866, 'binary_specificity': 0.98321503, 'binary_f1_score': 0.403169}
confusion matrix:
       0    1
0  17866  305
1    373  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.930117, 'precision': 0.62086916, 'recall': 0.699944, 'specificity': 0.699944, 'f1': 0.6482296, 'auroc': 0.87134814, 'binary_precision': 0.2645631, 'binary_recall': 0.45041323, 'binary_specificity': 0.94947475, 'binary_f1_score': 0.33333334}
confusion matrix:
      0    1
0  5694  303
1   133  109
early stop counter: 1
val acc:0.9638842940330505, best validation acc: 0.9650029540061951, corresponding to test acc:                         0.9405353665351868 / 0.9442218542098999
after epoch: 3,now: 2024-07-11 05:34:51.904697,epoch time: 0:25:05.112604,used: 1:15:52.247640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9800662, 'precision': 0.9810631, 'recall': 0.96736056, 'specificity': 0.96736056, 'f1': 0.9739473, 'auroc': 0.9955299, 'binary_precision': 0.9830731, 'binary_recall': 0.9405116, 'binary_specificity': 0.9942095, 'binary_f1_score': 0.9613215}
confusion matrix:
       0      1
0  42066    245
1    900  14229
---- Validation: 
scalar performance:
{'acc': 0.9655356, 'precision': 0.71865255, 'recall': 0.6914934, 'specificity': 0.6914934, 'f1': 0.704072, 'auroc': 0.88617396, 'binary_precision': 0.45714286, 'binary_recall': 0.3986711, 'binary_specificity': 0.9843157, 'binary_f1_score': 0.42590946}
confusion matrix:
       0    1
0  17886  285
1    362  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9381311, 'precision': 0.64468116, 'recall': 0.7219574, 'specificity': 0.7219574, 'f1': 0.67343193, 'auroc': 0.877017, 'binary_precision': 0.3105263, 'binary_recall': 0.4876033, 'binary_specificity': 0.95631146, 'binary_f1_score': 0.3794212}
confusion matrix:
      0    1
0  5735  262
1   124  118
better model found
persisted
after epoch: 4,now: 2024-07-11 05:59:55.187692,epoch time: 0:25:03.282995,used: 1:40:55.530635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9818071, 'precision': 0.98022556, 'recall': 0.9726825, 'specificity': 0.9726825, 'f1': 0.97637296, 'auroc': 0.9961314, 'binary_precision': 0.97697103, 'binary_recall': 0.95340073, 'binary_specificity': 0.9919643, 'binary_f1_score': 0.965042}
confusion matrix:
       0      1
0  41971    340
1    705  14424
---- Validation: 
scalar performance:
{'acc': 0.95648, 'precision': 0.6727172, 'recall': 0.7229528, 'specificity': 0.7229528, 'f1': 0.69418216, 'auroc': 0.8857287, 'binary_precision': 0.36305732, 'binary_recall': 0.47342193, 'binary_specificity': 0.97248363, 'binary_f1_score': 0.4109589}
confusion matrix:
       0    1
0  17671  500
1    317  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9014265, 'precision': 0.5943367, 'recall': 0.73260564, 'specificity': 0.73260564, 'f1': 0.6244493, 'auroc': 0.8707062, 'binary_precision': 0.20813772, 'binary_recall': 0.5495868, 'binary_specificity': 0.9156245, 'binary_f1_score': 0.30192962}
confusion matrix:
      0    1
0  5491  506
1   109  133
early stop counter: 1
val acc:0.9564800262451172, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9442218542098999
after epoch: 5,now: 2024-07-11 06:24:49.647915,epoch time: 0:24:54.460223,used: 2:05:49.990858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.983078, 'precision': 0.97973573, 'recall': 0.97653997, 'specificity': 0.97653997, 'f1': 0.97812325, 'auroc': 0.99643254, 'binary_precision': 0.97275275, 'binary_recall': 0.9627231, 'binary_specificity': 0.99035686, 'binary_f1_score': 0.967712}
confusion matrix:
       0      1
0  41902    408
1    564  14566
---- Validation: 
scalar performance:
{'acc': 0.95413625, 'precision': 0.67281985, 'recall': 0.76189446, 'specificity': 0.76189446, 'f1': 0.70685786, 'auroc': 0.8978038, 'binary_precision': 0.3606028, 'binary_recall': 0.5564784, 'binary_specificity': 0.96731055, 'binary_f1_score': 0.43762246}
confusion matrix:
       0    1
0  17577  594
1    267  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9014265, 'precision': 0.60065347, 'recall': 0.7563985, 'specificity': 0.7563985, 'f1': 0.63365054, 'auroc': 0.8718519, 'binary_precision': 0.21870287, 'binary_recall': 0.59917355, 'binary_specificity': 0.91362345, 'binary_f1_score': 0.320442}
confusion matrix:
      0    1
0  5479  518
1    97  145
early stop counter: 2
val acc:0.9541362524032593, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9442218542098999
after epoch: 6,now: 2024-07-11 06:49:48.945886,epoch time: 0:24:59.297971,used: 2:30:49.288829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9858113, 'precision': 0.98519003, 'recall': 0.9781194, 'specificity': 0.9781194, 'f1': 0.9815844, 'auroc': 0.99727976, 'binary_precision': 0.98390913, 'binary_recall': 0.9618639, 'binary_specificity': 0.9943749, 'binary_f1_score': 0.97276163}
confusion matrix:
       0      1
0  42072    238
1    577  14553
---- Validation: 
scalar performance:
{'acc': 0.9586108, 'precision': 0.68798834, 'recall': 0.749751, 'specificity': 0.749751, 'f1': 0.713912, 'auroc': 0.89703083, 'binary_precision': 0.39184177, 'binary_recall': 0.52657807, 'binary_specificity': 0.9729239, 'binary_f1_score': 0.4493267}
confusion matrix:
       0    1
0  17679  492
1    285  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9180958, 'precision': 0.6158459, 'recall': 0.7452421, 'specificity': 0.7452421, 'f1': 0.6510121, 'auroc': 0.87387013, 'binary_precision': 0.2504638, 'binary_recall': 0.55785125, 'binary_specificity': 0.932633, 'binary_f1_score': 0.34571064}
confusion matrix:
      0    1
0  5593  404
1   107  135
early stop counter: 3
val acc:0.9586107730865479, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9442218542098999
after epoch: 7,now: 2024-07-11 07:15:01.597061,epoch time: 0:25:12.651175,used: 2:56:01.940004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9862465, 'precision': 0.98702586, 'recall': 0.9774382, 'specificity': 0.9774382, 'f1': 0.9821038, 'auroc': 0.99753356, 'binary_precision': 0.9886193, 'binary_recall': 0.9588235, 'binary_specificity': 0.9960529, 'binary_f1_score': 0.9734935}
confusion matrix:
       0      1
0  42143    167
1    623  14507
---- Validation: 
scalar performance:
{'acc': 0.9569062, 'precision': 0.6846493, 'recall': 0.76894665, 'specificity': 0.76894665, 'f1': 0.7178494, 'auroc': 0.90097404, 'binary_precision': 0.3838384, 'binary_recall': 0.5681063, 'binary_specificity': 0.969787, 'binary_f1_score': 0.45813796}
confusion matrix:
       0    1
0  17622  549
1    260  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91184485, 'precision': 0.61002266, 'recall': 0.7519042, 'specificity': 0.7519042, 'f1': 0.6450655, 'auroc': 0.8691612, 'binary_precision': 0.23809524, 'binary_recall': 0.5785124, 'binary_specificity': 0.925296, 'binary_f1_score': 0.3373494}
confusion matrix:
      0    1
0  5549  448
1   102  140
early stop counter: 4
val acc:0.9569061994552612, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9442218542098999
after epoch: 8,now: 2024-07-11 07:40:23.086609,epoch time: 0:25:21.489548,used: 3:21:23.429552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98631614, 'precision': 0.9858391, 'recall': 0.9787793, 'specificity': 0.9787793, 'f1': 0.98223925, 'auroc': 0.99752116, 'binary_precision': 0.98485565, 'binary_recall': 0.9628528, 'binary_specificity': 0.99470586, 'binary_f1_score': 0.97372997}
confusion matrix:
       0      1
0  42087    224
1    562  14567
---- Validation: 
scalar performance:
{'acc': 0.95344377, 'precision': 0.6753045, 'recall': 0.7848252, 'specificity': 0.7848252, 'f1': 0.71505815, 'auroc': 0.90284765, 'binary_precision': 0.364, 'binary_recall': 0.60465115, 'binary_specificity': 0.9649992, 'binary_f1_score': 0.45443192}
confusion matrix:
       0    1
0  17535  636
1    238  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8979003, 'precision': 0.59811777, 'recall': 0.7585298, 'specificity': 0.7585298, 'f1': 0.63031185, 'auroc': 0.8675605, 'binary_precision': 0.21335268, 'binary_recall': 0.607438, 'binary_specificity': 0.9096215, 'binary_f1_score': 0.31578946}
confusion matrix:
      0    1
0  5455  542
1    95  147
early stop counter: 5
val acc:0.9534437656402588, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9442218542098999
after epoch: 9,now: 2024-07-11 08:05:51.046160,epoch time: 0:25:27.959551,used: 3:46:51.389103,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98807454, 'precision': 0.98893225, 'recall': 0.98027015, 'specificity': 0.98027015, 'f1': 0.98449695, 'auroc': 0.99802464, 'binary_precision': 0.99069166, 'binary_recall': 0.9637782, 'binary_specificity': 0.9967621, 'binary_f1_score': 0.9770496}
confusion matrix:
       0      1
0  42174    137
1    548  14581
---- Validation: 
scalar performance:
{'acc': 0.96084803, 'precision': 0.69915247, 'recall': 0.7533158, 'specificity': 0.7533158, 'f1': 0.7225672, 'auroc': 0.90266585, 'binary_precision': 0.41397154, 'binary_recall': 0.53156143, 'binary_specificity': 0.9750702, 'binary_f1_score': 0.46545452}
confusion matrix:
       0    1
0  17718  453
1    282  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93604743, 'precision': 0.6395217, 'recall': 0.72087353, 'specificity': 0.72087353, 'f1': 0.66898143, 'auroc': 0.8680111, 'binary_precision': 0.30025446, 'binary_recall': 0.4876033, 'binary_specificity': 0.95414376, 'binary_f1_score': 0.37165356}
confusion matrix:
      0    1
0  5722  275
1   124  118
early stop counter: 6
val acc:0.9608480334281921, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9442218542098999
after epoch: 10,now: 2024-07-11 08:31:28.053477,epoch time: 0:25:37.007317,used: 4:12:28.396420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98784816, 'precision': 0.98950887, 'recall': 0.9791411, 'specificity': 0.9791411, 'f1': 0.9841762, 'auroc': 0.9978503, 'binary_precision': 0.9928962, 'binary_recall': 0.96074027, 'binary_specificity': 0.99754196, 'binary_f1_score': 0.9765536}
confusion matrix:
       0      1
0  42206    104
1    594  14536
---- Validation: 
scalar performance:
{'acc': 0.95999575, 'precision': 0.694948, 'recall': 0.75287557, 'specificity': 0.75287557, 'f1': 0.71966445, 'auroc': 0.90349495, 'binary_precision': 0.40557668, 'binary_recall': 0.53156143, 'binary_specificity': 0.97418964, 'binary_f1_score': 0.46010062}
confusion matrix:
       0    1
0  17702  469
1    282  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9253085, 'precision': 0.6187476, 'recall': 0.7192529, 'specificity': 0.7192529, 'f1': 0.65017897, 'auroc': 0.8610132, 'binary_precision': 0.25862068, 'binary_recall': 0.49586776, 'binary_specificity': 0.942638, 'binary_f1_score': 0.33994332}
confusion matrix:
      0    1
0  5653  344
1   122  120
early stop counter: 7
val acc:0.9599957466125488, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9442218542098999
after epoch: 11,now: 2024-07-11 08:56:56.366992,epoch time: 0:25:28.313515,used: 4:37:56.709935,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98800486, 'precision': 0.98990524, 'recall': 0.97916126, 'specificity': 0.97916126, 'f1': 0.9843738, 'auroc': 0.9983282, 'binary_precision': 0.9937765, 'binary_recall': 0.96047324, 'binary_specificity': 0.9978493, 'binary_f1_score': 0.9768411}
confusion matrix:
       0      1
0  42220     91
1    598  14531
---- Validation: 
scalar performance:
{'acc': 0.96463007, 'precision': 0.71443444, 'recall': 0.7102988, 'specificity': 0.7102988, 'f1': 0.7123441, 'auroc': 0.89969844, 'binary_precision': 0.44745764, 'binary_recall': 0.4385382, 'binary_specificity': 0.9820593, 'binary_f1_score': 0.44295302}
confusion matrix:
       0    1
0  17845  326
1    338  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94374096, 'precision': 0.6478524, 'recall': 0.68323797, 'specificity': 0.68323797, 'f1': 0.6632746, 'auroc': 0.86350304, 'binary_precision': 0.32013202, 'binary_recall': 0.40082645, 'binary_specificity': 0.9656495, 'binary_f1_score': 0.35596332}
confusion matrix:
      0    1
0  5791  206
1   145   97
early stop counter: 8
val acc:0.9646300673484802, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9442218542098999
after epoch: 12,now: 2024-07-11 09:22:13.717711,epoch time: 0:25:17.350719,used: 5:03:14.060654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9884575, 'precision': 0.98954475, 'recall': 0.98065746, 'specificity': 0.98065746, 'f1': 0.98499167, 'auroc': 0.99788463, 'binary_precision': 0.9917732, 'binary_recall': 0.96417475, 'binary_specificity': 0.9971402, 'binary_f1_score': 0.9777793}
confusion matrix:
       0      1
0  42190    121
1    542  14587
---- Validation: 
scalar performance:
{'acc': 0.9636712, 'precision': 0.7103634, 'recall': 0.7258644, 'specificity': 0.7258644, 'f1': 0.717805, 'auroc': 0.9029668, 'binary_precision': 0.4382716, 'binary_recall': 0.4717608, 'binary_specificity': 0.9799681, 'binary_f1_score': 0.4544}
confusion matrix:
       0    1
0  17807  364
1    318  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94967145, 'precision': 0.6767527, 'recall': 0.71011573, 'specificity': 0.71011573, 'f1': 0.69174474, 'auroc': 0.87066936, 'binary_precision': 0.37586206, 'binary_recall': 0.45041323, 'binary_specificity': 0.96981823, 'binary_f1_score': 0.40977442}
confusion matrix:
      0    1
0  5816  181
1   133  109
new oracle model saved
early stop counter: 9
val acc:0.9636712074279785, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9496714472770691
after epoch: 13,now: 2024-07-11 09:47:23.194395,epoch time: 0:25:09.476684,used: 5:28:23.537338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98906684, 'precision': 0.9884702, 'recall': 0.9832792, 'specificity': 0.9832792, 'f1': 0.98583704, 'auroc': 0.9980997, 'binary_precision': 0.987232, 'binary_recall': 0.97104895, 'binary_specificity': 0.99550945, 'binary_f1_score': 0.97907364}
confusion matrix:
       0      1
0  42121    190
1    438  14691
---- Validation: 
scalar performance:
{'acc': 0.9582912, 'precision': 0.68384373, 'recall': 0.73673713, 'specificity': 0.73673713, 'f1': 0.70650196, 'auroc': 0.8980575, 'binary_precision': 0.3844189, 'binary_recall': 0.5, 'binary_specificity': 0.9734742, 'binary_f1_score': 0.43465704}
confusion matrix:
       0    1
0  17689  482
1    301  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9326815, 'precision': 0.63306135, 'recall': 0.72308815, 'specificity': 0.72308815, 'f1': 0.6640487, 'auroc': 0.8593312, 'binary_precision': 0.28708133, 'binary_recall': 0.49586776, 'binary_specificity': 0.9503085, 'binary_f1_score': 0.36363634}
confusion matrix:
      0    1
0  5699  298
1   122  120
early stop counter: 10
val acc:0.9582911729812622, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9496714472770691
after epoch: 14,now: 2024-07-11 10:13:20.539721,epoch time: 0:25:57.345326,used: 5:54:20.882664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99054664, 'precision': 0.9902589, 'recall': 0.98532486, 'specificity': 0.98532486, 'f1': 0.987758, 'auroc': 0.9982116, 'binary_precision': 0.989661, 'binary_recall': 0.9742895, 'binary_specificity': 0.9963602, 'binary_f1_score': 0.9819151}
confusion matrix:
       0      1
0  42156    154
1    389  14741
---- Validation: 
scalar performance:
{'acc': 0.96031535, 'precision': 0.69777316, 'recall': 0.7602681, 'specificity': 0.7602681, 'f1': 0.72419125, 'auroc': 0.9015088, 'binary_precision': 0.4107366, 'binary_recall': 0.54651165, 'binary_specificity': 0.97402453, 'binary_f1_score': 0.46899503}
confusion matrix:
       0    1
0  17699  472
1    273  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9440616, 'precision': 0.6651244, 'recall': 0.7389214, 'specificity': 0.7389214, 'f1': 0.6939913, 'auroc': 0.8664427, 'binary_precision': 0.35014006, 'binary_recall': 0.5165289, 'binary_specificity': 0.96131396, 'binary_f1_score': 0.41736227}
confusion matrix:
      0    1
0  5765  232
1   117  125
early stop counter: 11
val acc:0.9603153467178345, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9496714472770691
after epoch: 15,now: 2024-07-11 10:39:05.844205,epoch time: 0:25:45.304484,used: 6:20:06.187148,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9901114, 'precision': 0.9893633, 'recall': 0.9850923, 'specificity': 0.9850923, 'f1': 0.9872023, 'auroc': 0.99827063, 'binary_precision': 0.9878057, 'binary_recall': 0.9744861, 'binary_specificity': 0.9956985, 'binary_f1_score': 0.98110074}
confusion matrix:
       0      1
0  42129    182
1    386  14743
---- Validation: 
scalar performance:
{'acc': 0.9637778, 'precision': 0.71461844, 'recall': 0.751617, 'specificity': 0.751617, 'f1': 0.73147017, 'auroc': 0.90649176, 'binary_precision': 0.44507042, 'binary_recall': 0.52491695, 'binary_specificity': 0.9783171, 'binary_f1_score': 0.4817073}
confusion matrix:
       0    1
0  17777  394
1    286  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95335793, 'precision': 0.6981003, 'recall': 0.73780894, 'specificity': 0.73780894, 'f1': 0.7158545, 'auroc': 0.8730712, 'binary_precision': 0.41638225, 'binary_recall': 0.5041322, 'binary_specificity': 0.97148573, 'binary_f1_score': 0.45607474}
confusion matrix:
      0    1
0  5826  171
1   120  122
new oracle model saved
early stop counter: 12
val acc:0.9637777805328369, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9533579349517822
after epoch: 16,now: 2024-07-11 11:04:37.407926,epoch time: 0:25:31.563721,used: 6:45:37.750869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98976326, 'precision': 0.9886582, 'recall': 0.98489845, 'specificity': 0.98489845, 'f1': 0.9867585, 'auroc': 0.9979282, 'binary_precision': 0.9863536, 'binary_recall': 0.97461826, 'binary_specificity': 0.9951786, 'binary_f1_score': 0.9804508}
confusion matrix:
       0      1
0  42107    204
1    384  14745
---- Validation: 
scalar performance:
{'acc': 0.96196663, 'precision': 0.7007657, 'recall': 0.72899914, 'specificity': 0.72899914, 'f1': 0.713837, 'auroc': 0.90360534, 'binary_precision': 0.4188406, 'binary_recall': 0.48006645, 'binary_specificity': 0.97793186, 'binary_f1_score': 0.4473684}
confusion matrix:
       0    1
0  17770  401
1    313  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94486296, 'precision': 0.657313, 'recall': 0.70166624, 'specificity': 0.70166624, 'f1': 0.67622036, 'auroc': 0.86171603, 'binary_precision': 0.3375796, 'binary_recall': 0.43801653, 'binary_specificity': 0.965316, 'binary_f1_score': 0.38129494}
confusion matrix:
      0    1
0  5789  208
1   136  106
early stop counter: 13
val acc:0.9619666337966919, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9533579349517822
after epoch: 17,now: 2024-07-11 11:30:34.510013,epoch time: 0:25:57.102087,used: 7:11:34.852956,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99038994, 'precision': 0.9913848, 'recall': 0.9838164, 'specificity': 0.9838164, 'f1': 0.98752135, 'auroc': 0.99857163, 'binary_precision': 0.99343306, 'binary_recall': 0.9699253, 'binary_specificity': 0.9977074, 'binary_f1_score': 0.98153836}
confusion matrix:
       0      1
0  42214     97
1    455  14674
---- Validation: 
scalar performance:
{'acc': 0.9642039, 'precision': 0.7104211, 'recall': 0.7036542, 'specificity': 0.7036542, 'f1': 0.7069758, 'auroc': 0.90410936, 'binary_precision': 0.43986255, 'binary_recall': 0.42524916, 'binary_specificity': 0.9820593, 'binary_f1_score': 0.4324324}
confusion matrix:
       0    1
0  17845  326
1    346  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9458246, 'precision': 0.6530664, 'recall': 0.67837363, 'specificity': 0.67837363, 'f1': 0.6645673, 'auroc': 0.85818875, 'binary_precision': 0.3309859, 'binary_recall': 0.38842976, 'binary_specificity': 0.9683175, 'binary_f1_score': 0.35741445}
confusion matrix:
      0    1
0  5807  190
1   148   94
early stop counter: 14
val acc:0.9642038941383362, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9533579349517822
after epoch: 18,now: 2024-07-11 11:55:59.910647,epoch time: 0:25:25.400634,used: 7:37:00.253590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.990007, 'precision': 0.9903177, 'recall': 0.9838749, 'specificity': 0.9838749, 'f1': 0.9870387, 'auroc': 0.9982058, 'binary_precision': 0.99096, 'binary_recall': 0.9709168, 'binary_specificity': 0.99683297, 'binary_f1_score': 0.980836}
confusion matrix:
       0      1
0  42177    134
1    440  14689
---- Validation: 
scalar performance:
{'acc': 0.9631385, 'precision': 0.7049959, 'recall': 0.71354353, 'specificity': 0.71354353, 'f1': 0.7091717, 'auroc': 0.9032577, 'binary_precision': 0.42834395, 'binary_recall': 0.44684386, 'binary_specificity': 0.98024327, 'binary_f1_score': 0.43739837}
confusion matrix:
       0    1
0  17812  359
1    333  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94245875, 'precision': 0.6450733, 'recall': 0.68653643, 'specificity': 0.68653643, 'f1': 0.6626804, 'auroc': 0.8550615, 'binary_precision': 0.31428573, 'binary_recall': 0.4090909, 'binary_specificity': 0.963982, 'binary_f1_score': 0.35547578}
confusion matrix:
      0    1
0  5781  216
1   143   99
early stop counter: 15
val acc:0.9631385207176208, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9533579349517822
after epoch: 19,now: 2024-07-11 12:25:06.280204,epoch time: 0:29:06.369557,used: 8:06:06.623147,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9904248, 'precision': 0.99051774, 'recall': 0.984753, 'specificity': 0.984753, 'f1': 0.9875891, 'auroc': 0.9984308, 'binary_precision': 0.9907102, 'binary_recall': 0.97276753, 'binary_specificity': 0.99673843, 'binary_f1_score': 0.98165685}
confusion matrix:
       0      1
0  42173    138
1    412  14717
---- Validation: 
scalar performance:
{'acc': 0.9581314, 'precision': 0.68549854, 'recall': 0.74789727, 'specificity': 0.74789727, 'f1': 0.7115803, 'auroc': 0.90338707, 'binary_precision': 0.38697788, 'binary_recall': 0.5232558, 'binary_specificity': 0.97253865, 'binary_f1_score': 0.44491526}
confusion matrix:
       0    1
0  17672  499
1    287  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93877226, 'precision': 0.64458585, 'recall': 0.7163427, 'specificity': 0.7163427, 'f1': 0.67181206, 'auroc': 0.8602077, 'binary_precision': 0.3108108, 'binary_recall': 0.4752066, 'binary_specificity': 0.95747876, 'binary_f1_score': 0.375817}
confusion matrix:
      0    1
0  5742  255
1   127  115
early stop counter: 16
val acc:0.9581313729286194, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9533579349517822
after epoch: 20,now: 2024-07-11 12:51:14.659074,epoch time: 0:26:08.378870,used: 8:32:15.002017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9909993, 'precision': 0.99052835, 'recall': 0.98622656, 'specificity': 0.98622656, 'f1': 0.98835164, 'auroc': 0.99873066, 'binary_precision': 0.9895477, 'binary_recall': 0.97614014, 'binary_specificity': 0.9963129, 'binary_f1_score': 0.9827982}
confusion matrix:
       0      1
0  42154    156
1    361  14769
---- Validation: 
scalar performance:
{'acc': 0.96063495, 'precision': 0.69794446, 'recall': 0.75240266, 'specificity': 0.75240266, 'f1': 0.7214471, 'auroc': 0.90882814, 'binary_precision': 0.4116129, 'binary_recall': 0.5299003, 'binary_specificity': 0.9749051, 'binary_f1_score': 0.4633261}
confusion matrix:
       0    1
0  17715  456
1    283  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9397339, 'precision': 0.6505853, 'recall': 0.7287394, 'specificity': 0.7287394, 'f1': 0.6799413, 'auroc': 0.8627263, 'binary_precision': 0.32180852, 'binary_recall': 0.5, 'binary_specificity': 0.95747876, 'binary_f1_score': 0.39158577}
confusion matrix:
      0    1
0  5742  255
1   121  121
early stop counter: 17
val acc:0.9606349468231201, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9533579349517822
after epoch: 21,now: 2024-07-11 13:19:48.019447,epoch time: 0:28:33.360373,used: 9:00:48.362390,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9902507, 'precision': 0.9914664, 'recall': 0.9833832, 'specificity': 0.9833832, 'f1': 0.9873345, 'auroc': 0.99860024, 'binary_precision': 0.99396527, 'binary_recall': 0.9688698, 'binary_specificity': 0.9978965, 'binary_f1_score': 0.98125714}
confusion matrix:
       0      1
0  42221     89
1    471  14659
---- Validation: 
scalar performance:
{'acc': 0.9635114, 'precision': 0.7064574, 'recall': 0.70811486, 'specificity': 0.70811486, 'f1': 0.70728236, 'auroc': 0.9015243, 'binary_precision': 0.43163097, 'binary_recall': 0.43521595, 'binary_specificity': 0.9810137, 'binary_f1_score': 0.43341604}
confusion matrix:
       0    1
0  17826  345
1    340  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9471069, 'precision': 0.65586984, 'recall': 0.67309237, 'specificity': 0.67309237, 'f1': 0.6639453, 'auroc': 0.8532701, 'binary_precision': 0.33703703, 'binary_recall': 0.37603307, 'binary_specificity': 0.9701517, 'binary_f1_score': 0.35546878}
confusion matrix:
      0    1
0  5818  179
1   151   91
early stop counter: 18
val acc:0.9635114073753357, best validation acc: 0.965535581111908, corresponding to test acc:                         0.9381310939788818 / 0.9533579349517822
after epoch: 22,now: 2024-07-11 13:51:06.466968,epoch time: 0:31:18.447521,used: 9:32:06.809911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9914694, 'precision': 0.99185807, 'recall': 0.9861202, 'specificity': 0.9861202, 'f1': 0.9889436, 'auroc': 0.9987996, 'binary_precision': 0.9926634, 'binary_recall': 0.97481656, 'binary_specificity': 0.9974238, 'binary_f1_score': 0.983659}
confusion matrix:
       0      1
0  42202    109
1    381  14748
---- Validation: 
scalar performance:
{'acc': 0.96612155, 'precision': 0.7266838, 'recall': 0.7223119, 'specificity': 0.7223119, 'f1': 0.7244742, 'auroc': 0.90503025, 'binary_precision': 0.47118643, 'binary_recall': 0.46179402, 'binary_specificity': 0.9828298, 'binary_f1_score': 0.46644297}
confusion matrix:
       0    1
0  17859  312
1    324  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9530373, 'precision': 0.68586373, 'recall': 0.68807375, 'specificity': 0.68807375, 'f1': 0.6869612, 'auroc': 0.8614512, 'binary_precision': 0.39591837, 'binary_recall': 0.40082645, 'binary_specificity': 0.975321, 'binary_f1_score': 0.39835727}
confusion matrix:
      0    1
0  5849  148
1   145   97
better model found
persisted
after epoch: 23,now: 2024-07-11 14:19:02.031664,epoch time: 0:27:55.564696,used: 10:00:02.374607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9914171, 'precision': 0.99154216, 'recall': 0.98629785, 'specificity': 0.98629785, 'f1': 0.9888818, 'auroc': 0.99878013, 'binary_precision': 0.9918016, 'binary_recall': 0.9754792, 'binary_specificity': 0.9971165, 'binary_f1_score': 0.98357266}
confusion matrix:
       0      1
0  42188    122
1    371  14759
---- Validation: 
scalar performance:
{'acc': 0.9636712, 'precision': 0.71291286, 'recall': 0.7435315, 'specificity': 0.7435315, 'f1': 0.7270697, 'auroc': 0.9059533, 'binary_precision': 0.44219652, 'binary_recall': 0.50830567, 'binary_specificity': 0.9787574, 'binary_f1_score': 0.4729521}
confusion matrix:
       0    1
0  17785  386
1    296  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9506331, 'precision': 0.68073434, 'recall': 0.710616, 'specificity': 0.710616, 'f1': 0.69433945, 'auroc': 0.86270493, 'binary_precision': 0.38380283, 'binary_recall': 0.45041323, 'binary_specificity': 0.97081876, 'binary_f1_score': 0.41444868}
confusion matrix:
      0    1
0  5822  175
1   133  109
early stop counter: 1
val acc:0.9636712074279785, best validation acc: 0.9661215543746948, corresponding to test acc:                         0.9530373215675354 / 0.9533579349517822
after epoch: 24,now: 2024-07-11 15:05:06.222061,epoch time: 0:46:04.190397,used: 10:46:06.565004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9902159, 'precision': 0.9918635, 'recall': 0.98291266, 'specificity': 0.98291266, 'f1': 0.9872777, 'auroc': 0.9986525, 'binary_precision': 0.9952404, 'binary_recall': 0.96747965, 'binary_specificity': 0.9983456, 'binary_f1_score': 0.9811637}
confusion matrix:
       0      1
0  42241     70
1    492  14637
---- Validation: 
scalar performance:
{'acc': 0.9630853, 'precision': 0.6959256, 'recall': 0.67095447, 'specificity': 0.67095447, 'f1': 0.68248624, 'auroc': 0.8975564, 'binary_precision': 0.41300192, 'binary_recall': 0.358804, 'binary_specificity': 0.98310494, 'binary_f1_score': 0.38400003}
confusion matrix:
       0    1
0  17864  307
1    386  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94069564, 'precision': 0.6285989, 'recall': 0.6558782, 'specificity': 0.6558782, 'f1': 0.64063966, 'auroc': 0.83573073, 'binary_precision': 0.2837838, 'binary_recall': 0.34710744, 'binary_specificity': 0.96464896, 'binary_f1_score': 0.31226766}
confusion matrix:
      0    1
0  5785  212
1   158   84
early stop counter: 2
val acc:0.9630852937698364, best validation acc: 0.9661215543746948, corresponding to test acc:                         0.9530373215675354 / 0.9533579349517822
after epoch: 25,now: 2024-07-11 15:58:55.958339,epoch time: 0:53:49.736278,used: 11:39:56.301282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9912082, 'precision': 0.99150693, 'recall': 0.98579514, 'specificity': 0.98579514, 'f1': 0.98860586, 'auroc': 0.9986763, 'binary_precision': 0.992126, 'binary_recall': 0.9743556, 'binary_specificity': 0.9972347, 'binary_f1_score': 0.9831605}
confusion matrix:
       0      1
0  42193    117
1    388  14742
---- Validation: 
scalar performance:
{'acc': 0.9640441, 'precision': 0.715487, 'recall': 0.74613327, 'specificity': 0.74613327, 'f1': 0.7296696, 'auroc': 0.91042113, 'binary_precision': 0.447178, 'binary_recall': 0.51328903, 'binary_specificity': 0.9789775, 'binary_f1_score': 0.47795823}
confusion matrix:
       0    1
0  17789  382
1    293  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95399904, 'precision': 0.69268775, 'recall': 0.69650495, 'specificity': 0.69650495, 'f1': 0.69457465, 'auroc': 0.8690078, 'binary_precision': 0.40890688, 'binary_recall': 0.41735536, 'binary_specificity': 0.9756545, 'binary_f1_score': 0.41308793}
confusion matrix:
      0    1
0  5851  146
1   141  101
new oracle model saved
early stop counter: 3
val acc:0.9640440940856934, best validation acc: 0.9661215543746948, corresponding to test acc:                         0.9530373215675354 / 0.9539990425109863
after epoch: 26,now: 2024-07-11 16:53:26.942779,epoch time: 0:54:30.984440,used: 12:34:27.285722,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9914345, 'precision': 0.99121094, 'recall': 0.98666906, 'specificity': 0.98666906, 'f1': 0.98891133, 'auroc': 0.9984724, 'binary_precision': 0.9907457, 'binary_recall': 0.9765997, 'binary_specificity': 0.9967385, 'binary_f1_score': 0.98362184}
confusion matrix:
       0      1
0  42174    138
1    354  14774
---- Validation: 
scalar performance:
{'acc': 0.96542907, 'precision': 0.7199837, 'recall': 0.7083024, 'specificity': 0.7083024, 'f1': 0.7139655, 'auroc': 0.90525675, 'binary_precision': 0.45869946, 'binary_recall': 0.43355483, 'binary_specificity': 0.9830499, 'binary_f1_score': 0.44577286}
confusion matrix:
       0    1
0  17863  308
1    341  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535182, 'precision': 0.6788771, 'recall': 0.65461725, 'specificity': 0.65461725, 'f1': 0.6657226, 'auroc': 0.8618533, 'binary_precision': 0.3846154, 'binary_recall': 0.3305785, 'binary_specificity': 0.978656, 'binary_f1_score': 0.3555556}
confusion matrix:
      0    1
0  5869  128
1   162   80
early stop counter: 4
val acc:0.9654290676116943, best validation acc: 0.9661215543746948, corresponding to test acc:                         0.9530373215675354 / 0.9539990425109863
after epoch: 27,now: 2024-07-11 17:41:59.356737,epoch time: 0:48:32.413958,used: 13:22:59.699680,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9912256, 'precision': 0.9914324, 'recall': 0.9859123, 'specificity': 0.9859123, 'f1': 0.9886301, 'auroc': 0.99888545, 'binary_precision': 0.99186116, 'binary_recall': 0.97468436, 'binary_specificity': 0.9971402, 'binary_f1_score': 0.98319775}
confusion matrix:
       0      1
0  42190    121
1    383  14746
---- Validation: 
scalar performance:
{'acc': 0.9630853, 'precision': 0.71026766, 'recall': 0.74885017, 'specificity': 0.74885017, 'f1': 0.7277363, 'auroc': 0.90990484, 'binary_precision': 0.43654114, 'binary_recall': 0.5199336, 'binary_specificity': 0.97776675, 'binary_f1_score': 0.47460198}
confusion matrix:
       0    1
0  17767  404
1    289  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9536785, 'precision': 0.68867016, 'recall': 0.6864245, 'specificity': 0.6864245, 'f1': 0.6875395, 'auroc': 0.8613017, 'binary_precision': 0.40167364, 'binary_recall': 0.3966942, 'binary_specificity': 0.97615474, 'binary_f1_score': 0.39916837}
confusion matrix:
      0    1
0  5854  143
1   146   96
early stop counter: 5
val acc:0.9630852937698364, best validation acc: 0.9661215543746948, corresponding to test acc:                         0.9530373215675354 / 0.9539990425109863
after epoch: 28,now: 2024-07-11 18:28:22.112878,epoch time: 0:46:22.756141,used: 14:09:22.455821,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9920961, 'precision': 0.9928491, 'recall': 0.986758, 'specificity': 0.986758, 'f1': 0.98975235, 'auroc': 0.99880195, 'binary_precision': 0.99440736, 'binary_recall': 0.9754776, 'binary_specificity': 0.99803835, 'binary_f1_score': 0.98485154}
confusion matrix:
       0      1
0  42228     83
1    371  14758
---- Validation: 
scalar performance:
{'acc': 0.96617484, 'precision': 0.72400576, 'recall': 0.6918236, 'specificity': 0.6918236, 'f1': 0.7065315, 'auroc': 0.9046793, 'binary_precision': 0.46783626, 'binary_recall': 0.3986711, 'binary_specificity': 0.98497605, 'binary_f1_score': 0.4304933}
confusion matrix:
       0    1
0  17898  273
1    362  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9559224, 'precision': 0.68875754, 'recall': 0.6380232, 'specificity': 0.6380232, 'f1': 0.6588634, 'auroc': 0.8533449, 'binary_precision': 0.40571427, 'binary_recall': 0.29338843, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.34052756}
confusion matrix:
      0    1
0  5893  104
1   171   71
new oracle model saved
better model found
persisted
after epoch: 29,now: 2024-07-11 19:17:09.161849,epoch time: 0:48:47.048971,used: 14:58:09.504792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9915216, 'precision': 0.99133503, 'recall': 0.9867714, 'specificity': 0.9867714, 'f1': 0.9890243, 'auroc': 0.99893653, 'binary_precision': 0.9909469, 'binary_recall': 0.97673345, 'binary_specificity': 0.99680936, 'binary_f1_score': 0.98378885}
confusion matrix:
       0      1
0  42176    135
1    352  14777
---- Validation: 
scalar performance:
{'acc': 0.9646833, 'precision': 0.7126537, 'recall': 0.6958714, 'specificity': 0.6958714, 'f1': 0.7038776, 'auroc': 0.90025043, 'binary_precision': 0.4448463, 'binary_recall': 0.40863788, 'binary_specificity': 0.98310494, 'binary_f1_score': 0.42597407}
confusion matrix:
       0    1
0  17864  307
1    356  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94213814, 'precision': 0.62806904, 'recall': 0.6447322, 'specificity': 0.6447322, 'f1': 0.63577974, 'auroc': 0.83981264, 'binary_precision': 0.28363636, 'binary_recall': 0.32231405, 'binary_specificity': 0.9671503, 'binary_f1_score': 0.30174083}
confusion matrix:
      0    1
0  5800  197
1   164   78
early stop counter: 1
val acc:0.9646832942962646, best validation acc: 0.966174840927124, corresponding to test acc:                         0.9559224247932434 / 0.9559224247932434
after epoch: 30,now: 2024-07-11 20:05:55.974900,epoch time: 0:48:46.813051,used: 15:46:56.317843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_04_18_59_seed_2_21806617
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:46:56.317843 at 2024-07-11 20:05:55.974900
persisted model performance metric: 

scalar performance:
{'acc': 0.9559224, 'precision': 0.68875754, 'recall': 0.6380232, 'specificity': 0.6380232, 'f1': 0.6588634, 'auroc': 0.8533449, 'binary_precision': 0.40571427, 'binary_recall': 0.29338843, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.34052756}
confusion matrix:
      0    1
0  5893  104
1   171   71
oracle model performance metric: 

scalar performance:
{'acc': 0.9559224, 'precision': 0.68875754, 'recall': 0.6380232, 'specificity': 0.6380232, 'f1': 0.6588634, 'auroc': 0.8533449, 'binary_precision': 0.40571427, 'binary_recall': 0.29338843, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.34052756}
confusion matrix:
      0    1
0  5893  104
1   171   71
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197653 KiB |   1195 MiB |   2880 TiB |   2880 TiB |
|       from large pool | 180168 KiB |   1178 MiB |   2841 TiB |   2841 TiB |
|       from small pool |  17485 KiB |     37 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197653 KiB |   1195 MiB |   2880 TiB |   2880 TiB |
|       from large pool | 180168 KiB |   1178 MiB |   2841 TiB |   2841 TiB |
|       from small pool |  17485 KiB |     37 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   1193 MiB |   2880 TiB |   2880 TiB |
|       from large pool | 178979 KiB |   1176 MiB |   2841 TiB |   2841 TiB |
|       from small pool |  16481 KiB |     36 MiB |     38 TiB |     38 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1330 MiB |   1352 MiB |   3522 MiB |   2192 MiB |
|       from large pool |   1292 MiB |   1310 MiB |   3454 MiB |   2162 MiB |
|       from small pool |     38 MiB |     42 MiB |     68 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  54250 KiB | 153640 KiB |   1554 TiB |   1554 TiB |
|       from large pool |  45111 KiB | 150341 KiB |   1514 TiB |   1514 TiB |
|       from small pool |   9139 KiB |  20351 KiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7655    |  503342 K  |  503339 K  |
|       from large pool |      79    |     167    |  271678 K  |  271678 K  |
|       from small pool |    2887    |    7575    |  231664 K  |  231661 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7655    |  503342 K  |  503339 K  |
|       from large pool |      79    |     167    |  271678 K  |  271678 K  |
|       from small pool |    2887    |    7575    |  231664 K  |  231661 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      76    |     177    |     103    |
|       from large pool |      55    |      55    |     143    |      88    |
|       from small pool |      19    |      21    |      34    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3611    |  309069 K  |  309069 K  |
|       from large pool |      12    |      57    |  190539 K  |  190539 K  |
|       from small pool |      21    |    3599    |  118529 K  |  118529 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB |   2880 TiB |   2880 TiB |
|       from large pool |  16640 KiB |   1178 MiB |   2841 TiB |   2841 TiB |
|       from small pool |      0 KiB |     37 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB |   2880 TiB |   2880 TiB |
|       from large pool |  16640 KiB |   1178 MiB |   2841 TiB |   2841 TiB |
|       from small pool |      0 KiB |     37 MiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |   2880 TiB |   2880 TiB |
|       from large pool |  16640 KiB |   1176 MiB |   2841 TiB |   2841 TiB |
|       from small pool |      0 KiB |     36 MiB |     38 TiB |     38 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 251904 KiB |   1352 MiB |   3522 MiB |   3276 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   3454 MiB |   3234 MiB |
|       from small pool |  26624 KiB |     42 MiB |     68 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 153640 KiB |   1554 TiB |   1554 TiB |
|       from large pool |  24320 KiB | 150341 KiB |   1514 TiB |   1514 TiB |
|       from small pool |      0 KiB |  21230 KiB |     39 TiB |     39 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7655    |  503342 K  |  503342 K  |
|       from large pool |       2    |     167    |  271678 K  |  271678 K  |
|       from small pool |       0    |    7575    |  231664 K  |  231664 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7655    |  503342 K  |  503342 K  |
|       from large pool |       2    |     167    |  271678 K  |  271678 K  |
|       from small pool |       0    |    7575    |  231664 K  |  231664 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |      76    |     177    |     153    |
|       from large pool |      11    |      55    |     143    |     132    |
|       from small pool |      13    |      21    |      34    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3611    |  309070 K  |  309070 K  |
|       from large pool |       4    |      57    |  190539 K  |  190539 K  |
|       from small pool |       0    |    3599    |  118530 K  |  118530 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Jul 11 20:31:32 2024]
Finished job 0.
1 of 1 steps (100%) done
