Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 10 05:51:02 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620

 Experiment start at: 2024-07-10 05:58:28.143011
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9411641, 'precision': 0.95808244, 'recall': 0.8894097, 'specificity': 0.8894097, 'f1': 0.9172709, 'auroc': 0.9648788, 'binary_precision': 0.98671806, 'binary_recall': 0.7824817, 'binary_specificity': 0.9963378, 'binary_f1_score': 0.8728113}
confusion matrix:
       0      1
0  42169    155
1   3201  11515
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.94864833, 'precision': 0.53736544, 'recall': 0.5241314, 'specificity': 0.5241314, 'f1': 0.5285774, 'auroc': 0.7915131, 'binary_precision': 0.107317075, 'binary_recall': 0.06842924, 'binary_specificity': 0.9798336, 'binary_f1_score': 0.08357075}
confusion matrix:
       0    1
0  17783  366
1    599   44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9474273, 'precision': 0.57593596, 'recall': 0.5328095, 'specificity': 0.5328095, 'f1': 0.5430591, 'auroc': 0.82498765, 'binary_precision': 0.19090909, 'binary_recall': 0.08045977, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.11320755}
confusion matrix:
      0   1
0  5908  89
1   240  21
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 06:20:23.409481,epoch time: 0:21:55.266470,used: 0:21:55.266470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9550491, 'precision': 0.9658648, 'recall': 0.9170117, 'specificity': 0.9170117, 'f1': 0.93817717, 'auroc': 0.98178196, 'binary_precision': 0.9851497, 'binary_recall': 0.8384181, 'binary_specificity': 0.99560523, 'binary_f1_score': 0.9058806}
confusion matrix:
       0      1
0  42137    186
1   2378  12339
---- Validation: 
scalar performance:
{'acc': 0.9547148, 'precision': 0.6278233, 'recall': 0.5962772, 'specificity': 0.5962772, 'f1': 0.6094342, 'auroc': 0.85609293, 'binary_precision': 0.28333333, 'binary_recall': 0.21150856, 'binary_specificity': 0.9810458, 'binary_f1_score': 0.24220838}
confusion matrix:
       0    1
0  17805  344
1    507  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9544583, 'precision': 0.6955601, 'recall': 0.618933, 'specificity': 0.618933, 'f1': 0.6464955, 'auroc': 0.88044596, 'binary_precision': 0.42307693, 'binary_recall': 0.25287357, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.31654677}
confusion matrix:
      0   1
0  5907  90
1   195  66
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-10 06:41:39.911081,epoch time: 0:21:16.501600,used: 0:43:11.768070,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96211433, 'precision': 0.96752375, 'recall': 0.9331146, 'specificity': 0.9331146, 'f1': 0.9486861, 'auroc': 0.98576033, 'binary_precision': 0.977558, 'binary_recall': 0.8731992, 'binary_specificity': 0.99302995, 'binary_f1_score': 0.92243636}
confusion matrix:
       0      1
0  42029    295
1   1866  12850
---- Validation: 
scalar performance:
{'acc': 0.9537569, 'precision': 0.6564992, 'recall': 0.66703653, 'specificity': 0.66703653, 'f1': 0.6615685, 'auroc': 0.8784157, 'binary_precision': 0.33575583, 'binary_recall': 0.3592535, 'binary_specificity': 0.97481954, 'binary_f1_score': 0.3471074}
confusion matrix:
       0    1
0  17692  457
1    412  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.75031525, 'recall': 0.7207972, 'specificity': 0.7207972, 'f1': 0.73450387, 'auroc': 0.8966681, 'binary_precision': 0.52401745, 'binary_recall': 0.4597701, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.48979592}
confusion matrix:
      0    1
0  5888  109
1   141  120
new oracle model saved
early stop counter: 1
val acc:0.9537569284439087, best validation acc: 0.9547147750854492, corresponding to test acc:                         0.9544582962989807 / 0.9600511193275452
after epoch: 3,now: 2024-07-10 07:02:57.328412,epoch time: 0:21:17.417331,used: 1:04:29.185401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96647966, 'precision': 0.96683, 'recall': 0.9448992, 'specificity': 0.9448992, 'f1': 0.9551908, 'auroc': 0.9877409, 'binary_precision': 0.967504, 'binary_recall': 0.9003126, 'binary_specificity': 0.98948586, 'binary_f1_score': 0.93269974}
confusion matrix:
       0      1
0  41879    445
1   1467  13249
---- Validation: 
scalar performance:
{'acc': 0.95258623, 'precision': 0.66424656, 'recall': 0.70693344, 'specificity': 0.70693344, 'f1': 0.682739, 'auroc': 0.8887251, 'binary_precision': 0.34841076, 'binary_recall': 0.44323483, 'binary_specificity': 0.970632, 'binary_f1_score': 0.39014372}
confusion matrix:
       0    1
0  17616  533
1    358  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.74874306, 'recall': 0.79392374, 'specificity': 0.79392374, 'f1': 0.76917106, 'auroc': 0.9055548, 'binary_precision': 0.51446944, 'binary_recall': 0.6130268, 'binary_specificity': 0.97482073, 'binary_f1_score': 0.55944055}
confusion matrix:
      0    1
0  5846  151
1   101  160
early stop counter: 2
val acc:0.9525862336158752, best validation acc: 0.9547147750854492, corresponding to test acc:                         0.9544582962989807 / 0.9600511193275452
after epoch: 4,now: 2024-07-10 07:24:11.726840,epoch time: 0:21:14.398428,used: 1:25:43.583829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9697405, 'precision': 0.9712996, 'recall': 0.9491639, 'specificity': 0.9491639, 'f1': 0.95955366, 'auroc': 0.9893848, 'binary_precision': 0.9742991, 'binary_recall': 0.90664494, 'binary_specificity': 0.9916828, 'binary_f1_score': 0.9392553}
confusion matrix:
       0      1
0  41970    352
1   1374  13344
---- Validation: 
scalar performance:
{'acc': 0.9544487, 'precision': 0.6736282, 'recall': 0.7138981, 'specificity': 0.7138981, 'f1': 0.69134784, 'auroc': 0.89370394, 'binary_precision': 0.3667084, 'binary_recall': 0.45567653, 'binary_specificity': 0.9721197, 'binary_f1_score': 0.40638003}
confusion matrix:
       0    1
0  17643  506
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.7687919, 'recall': 0.80500305, 'specificity': 0.80500305, 'f1': 0.785594, 'auroc': 0.9080843, 'binary_precision': 0.55369127, 'binary_recall': 0.6321839, 'binary_specificity': 0.97782224, 'binary_f1_score': 0.5903399}
confusion matrix:
      0    1
0  5864  133
1    96  165
new oracle model saved
early stop counter: 3
val acc:0.9544486999511719, best validation acc: 0.9547147750854492, corresponding to test acc:                         0.9544582962989807 / 0.9634068608283997
after epoch: 5,now: 2024-07-10 07:45:27.541769,epoch time: 0:21:15.814929,used: 1:46:59.398758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9717391, 'precision': 0.9700763, 'recall': 0.95556015, 'specificity': 0.95556015, 'f1': 0.962523, 'auroc': 0.9906863, 'binary_precision': 0.966802, 'binary_recall': 0.9221309, 'binary_specificity': 0.9889894, 'binary_f1_score': 0.9439382}
confusion matrix:
       0      1
0  41857    466
1   1146  13571
---- Validation: 
scalar performance:
{'acc': 0.95604515, 'precision': 0.68222344, 'recall': 0.72072506, 'specificity': 0.72072506, 'f1': 0.6993616, 'auroc': 0.8966641, 'binary_precision': 0.38343948, 'binary_recall': 0.4681182, 'binary_specificity': 0.97333187, 'binary_f1_score': 0.4215686}
confusion matrix:
       0    1
0  17665  484
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.7692082, 'recall': 0.7976737, 'specificity': 0.7976737, 'f1': 0.7826264, 'auroc': 0.91015655, 'binary_precision': 0.55517244, 'binary_recall': 0.61685824, 'binary_specificity': 0.9784892, 'binary_f1_score': 0.584392}
confusion matrix:
      0    1
0  5868  129
1   100  161
better model found
persisted
after epoch: 6,now: 2024-07-10 08:06:27.923479,epoch time: 0:21:00.381710,used: 2:07:59.780468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.973913, 'precision': 0.97442013, 'recall': 0.9570123, 'specificity': 0.9570123, 'f1': 0.96529835, 'auroc': 0.9915273, 'binary_precision': 0.97540987, 'binary_recall': 0.9221044, 'binary_specificity': 0.99192023, 'binary_f1_score': 0.94800836}
confusion matrix:
       0      1
0  41986    342
1   1146  13566
---- Validation: 
scalar performance:
{'acc': 0.9555662, 'precision': 0.6846189, 'recall': 0.7407286, 'specificity': 0.7407286, 'f1': 0.7084192, 'auroc': 0.8989867, 'binary_precision': 0.38679245, 'binary_recall': 0.5101089, 'binary_specificity': 0.9713483, 'binary_f1_score': 0.43997315}
confusion matrix:
       0    1
0  17629  520
1    315  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.75305057, 'recall': 0.81083167, 'specificity': 0.81083167, 'f1': 0.7785377, 'auroc': 0.91231567, 'binary_precision': 0.52160496, 'binary_recall': 0.6475096, 'binary_specificity': 0.97415376, 'binary_f1_score': 0.57777774}
confusion matrix:
      0    1
0  5842  155
1    92  169
early stop counter: 1
val acc:0.9555662274360657, best validation acc: 0.9560451507568359, corresponding to test acc:                         0.9634068608283997 / 0.9634068608283997
after epoch: 7,now: 2024-07-10 08:27:33.517381,epoch time: 0:21:05.593902,used: 2:29:05.374370,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9759116, 'precision': 0.97664213, 'recall': 0.9601004, 'specificity': 0.9601004, 'f1': 0.96799564, 'auroc': 0.99232423, 'binary_precision': 0.9780724, 'binary_recall': 0.92743087, 'binary_specificity': 0.9927699, 'binary_f1_score': 0.9520787}
confusion matrix:
       0      1
0  42017    306
1   1068  13649
---- Validation: 
scalar performance:
{'acc': 0.9553533, 'precision': 0.68338394, 'recall': 0.7391182, 'specificity': 0.7391182, 'f1': 0.7070224, 'auroc': 0.8994902, 'binary_precision': 0.38443395, 'binary_recall': 0.5069984, 'binary_specificity': 0.9712381, 'binary_f1_score': 0.4372904}
confusion matrix:
       0    1
0  17627  522
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7423116, 'recall': 0.81149673, 'specificity': 0.81149673, 'f1': 0.77190936, 'auroc': 0.91394436, 'binary_precision': 0.5, 'binary_recall': 0.651341, 'binary_specificity': 0.9716525, 'binary_f1_score': 0.56572384}
confusion matrix:
      0    1
0  5827  170
1    91  170
early stop counter: 2
val acc:0.955353319644928, best validation acc: 0.9560451507568359, corresponding to test acc:                         0.9634068608283997 / 0.9634068608283997
after epoch: 8,now: 2024-07-10 08:49:11.415597,epoch time: 0:21:37.898216,used: 2:50:43.272586,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9771213, 'precision': 0.9782673, 'recall': 0.96169347, 'specificity': 0.96169347, 'f1': 0.96960485, 'auroc': 0.9933771, 'binary_precision': 0.98051155, 'binary_recall': 0.92981386, 'binary_specificity': 0.99357307, 'binary_f1_score': 0.95448995}
confusion matrix:
       0      1
0  42050    272
1   1033  13685
---- Validation: 
scalar performance:
{'acc': 0.9554598, 'precision': 0.6823514, 'recall': 0.7324229, 'specificity': 0.7324229, 'f1': 0.703911, 'auroc': 0.899396, 'binary_precision': 0.38285023, 'binary_recall': 0.49300155, 'binary_specificity': 0.9718442, 'binary_f1_score': 0.4309993}
confusion matrix:
       0    1
0  17638  511
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549377, 'precision': 0.7275781, 'recall': 0.80791354, 'specificity': 0.80791354, 'f1': 0.7607279, 'auroc': 0.91352046, 'binary_precision': 0.4707521, 'binary_recall': 0.6475096, 'binary_specificity': 0.9683175, 'binary_f1_score': 0.54516125}
confusion matrix:
      0    1
0  5807  190
1    92  169
early stop counter: 3
val acc:0.9554597735404968, best validation acc: 0.9560451507568359, corresponding to test acc:                         0.9634068608283997 / 0.9634068608283997
after epoch: 9,now: 2024-07-10 09:10:23.492711,epoch time: 0:21:12.077114,used: 3:11:55.349700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9780505, 'precision': 0.97764367, 'recall': 0.96470857, 'specificity': 0.96470857, 'f1': 0.9709461, 'auroc': 0.99366736, 'binary_precision': 0.97683805, 'binary_recall': 0.93714327, 'binary_specificity': 0.99227387, 'binary_f1_score': 0.956579}
confusion matrix:
       0      1
0  41997    327
1    925  13791
---- Validation: 
scalar performance:
{'acc': 0.9539698, 'precision': 0.68065065, 'recall': 0.75190294, 'specificity': 0.75190294, 'f1': 0.70950323, 'auroc': 0.902455, 'binary_precision': 0.378022, 'binary_recall': 0.5349922, 'binary_specificity': 0.9688137, 'binary_f1_score': 0.44301352}
confusion matrix:
       0    1
0  17583  566
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495046, 'precision': 0.70870274, 'recall': 0.8160728, 'specificity': 0.8160728, 'f1': 0.7494294, 'auroc': 0.9155363, 'binary_precision': 0.43209878, 'binary_recall': 0.6704981, 'binary_specificity': 0.9616475, 'binary_f1_score': 0.5255255}
confusion matrix:
      0    1
0  5767  230
1    86  175
early stop counter: 4
val acc:0.9539697766304016, best validation acc: 0.9560451507568359, corresponding to test acc:                         0.9634068608283997 / 0.9634068608283997
after epoch: 10,now: 2024-07-10 09:31:32.032900,epoch time: 0:21:08.540189,used: 3:33:03.889889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97936535, 'precision': 0.9788083, 'recall': 0.967013, 'specificity': 0.967013, 'f1': 0.97271967, 'auroc': 0.9939624, 'binary_precision': 0.97770095, 'binary_recall': 0.94149226, 'binary_specificity': 0.9925338, 'binary_f1_score': 0.95925504}
confusion matrix:
       0      1
0  42008    316
1    861  13855
---- Validation: 
scalar performance:
{'acc': 0.9514687, 'precision': 0.6730557, 'recall': 0.7581087, 'specificity': 0.7581087, 'f1': 0.70583916, 'auroc': 0.90422857, 'binary_precision': 0.3623337, 'binary_recall': 0.5505443, 'binary_specificity': 0.965673, 'binary_f1_score': 0.43703705}
confusion matrix:
       0    1
0  17526  623
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94646853, 'precision': 0.6998559, 'recall': 0.8199856, 'specificity': 0.8199856, 'f1': 0.74343276, 'auroc': 0.91487765, 'binary_precision': 0.41395348, 'binary_recall': 0.68199235, 'binary_specificity': 0.95797896, 'binary_f1_score': 0.51519537}
confusion matrix:
      0    1
0  5745  252
1    83  178
early stop counter: 5
val acc:0.9514687061309814, best validation acc: 0.9560451507568359, corresponding to test acc:                         0.9634068608283997 / 0.9634068608283997
after epoch: 11,now: 2024-07-10 09:52:46.796995,epoch time: 0:21:14.764095,used: 3:54:18.653984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9789446, 'precision': 0.9778658, 'recall': 0.9668441, 'specificity': 0.9668441, 'f1': 0.9721875, 'auroc': 0.9943409, 'binary_precision': 0.9757162, 'binary_recall': 0.94183993, 'binary_specificity': 0.99184823, 'binary_f1_score': 0.9584788}
confusion matrix:
       0      1
0  41977    345
1    856  13862
---- Validation: 
scalar performance:
{'acc': 0.94737124, 'precision': 0.6641859, 'recall': 0.7747387, 'specificity': 0.7747387, 'f1': 0.7031448, 'auroc': 0.9047544, 'binary_precision': 0.3432971, 'binary_recall': 0.58942455, 'binary_specificity': 0.9600529, 'binary_f1_score': 0.43388668}
confusion matrix:
       0    1
0  17424  725
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9395973, 'precision': 0.6843381, 'recall': 0.8347239, 'specificity': 0.8347239, 'f1': 0.7332682, 'auroc': 0.9146574, 'binary_precision': 0.38133875, 'binary_recall': 0.7203065, 'binary_specificity': 0.94914126, 'binary_f1_score': 0.49867377}
confusion matrix:
      0    1
0  5692  305
1    73  188
early stop counter: 6
val acc:0.947371244430542, best validation acc: 0.9560451507568359, corresponding to test acc:                         0.9634068608283997 / 0.9634068608283997
after epoch: 12,now: 2024-07-10 10:14:01.158115,epoch time: 0:21:14.361120,used: 4:15:33.015104,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9795582, 'precision': 0.9806347, 'recall': 0.9657426, 'specificity': 0.9657426, 'f1': 0.9728869, 'auroc': 0.9946742, 'binary_precision': 0.9827537, 'binary_recall': 0.9372027, 'binary_specificity': 0.9942825, 'binary_f1_score': 0.9594378}
confusion matrix:
       0      1
0  42084    242
1    924  13790
---- Validation: 
scalar performance:
{'acc': 0.9549276, 'precision': 0.68091404, 'recall': 0.73589766, 'specificity': 0.73589766, 'f1': 0.7042289, 'auroc': 0.904039, 'binary_precision': 0.379717, 'binary_recall': 0.5007776, 'binary_specificity': 0.97101766, 'binary_f1_score': 0.43192488}
confusion matrix:
       0    1
0  17623  526
1    321  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95142215, 'precision': 0.7132592, 'recall': 0.8005823, 'specificity': 0.8005823, 'f1': 0.7482117, 'auroc': 0.9148067, 'binary_precision': 0.44266668, 'binary_recall': 0.6360153, 'binary_specificity': 0.9651492, 'binary_f1_score': 0.5220126}
confusion matrix:
      0    1
0  5788  209
1    95  166
early stop counter: 7
val acc:0.9549276232719421, best validation acc: 0.9560451507568359, corresponding to test acc:                         0.9634068608283997 / 0.9634068608283997
after epoch: 13,now: 2024-07-10 10:38:35.689508,epoch time: 0:24:34.531393,used: 4:40:07.546497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98062766, 'precision': 0.98139036, 'recall': 0.9677952, 'specificity': 0.9677952, 'f1': 0.9743415, 'auroc': 0.9954065, 'binary_precision': 0.9828981, 'binary_recall': 0.9412844, 'binary_specificity': 0.99430597, 'binary_f1_score': 0.9616413}
confusion matrix:
       0      1
0  42084    241
1    864  13851
---- Validation: 
scalar performance:
{'acc': 0.94864833, 'precision': 0.66547066, 'recall': 0.76414907, 'specificity': 0.76414907, 'f1': 0.7015594, 'auroc': 0.90530777, 'binary_precision': 0.34666666, 'binary_recall': 0.5660964, 'binary_specificity': 0.9622018, 'binary_f1_score': 0.43000588}
confusion matrix:
       0    1
0  17463  686
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.935922, 'precision': 0.6733296, 'recall': 0.8199799, 'specificity': 0.8199799, 'f1': 0.720162, 'auroc': 0.9137008, 'binary_precision': 0.36055776, 'binary_recall': 0.6934866, 'binary_specificity': 0.94647324, 'binary_f1_score': 0.47444296}
confusion matrix:
      0    1
0  5676  321
1    80  181
early stop counter: 8
val acc:0.9486483335494995, best validation acc: 0.9560451507568359, corresponding to test acc:                         0.9634068608283997 / 0.9634068608283997
after epoch: 14,now: 2024-07-10 11:04:54.800194,epoch time: 0:26:19.110686,used: 5:06:26.657183,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98125875, 'precision': 0.9814112, 'recall': 0.96941745, 'specificity': 0.96941745, 'f1': 0.97521836, 'auroc': 0.99578786, 'binary_precision': 0.9817142, 'binary_recall': 0.94495416, 'binary_specificity': 0.9938807, 'binary_f1_score': 0.9629834}
confusion matrix:
       0      1
0  42066    259
1    810  13905
---- Validation: 
scalar performance:
{'acc': 0.946573, 'precision': 0.6559211, 'recall': 0.74957365, 'specificity': 0.74957365, 'f1': 0.69002146, 'auroc': 0.9004917, 'binary_precision': 0.328585, 'binary_recall': 0.5381026, 'binary_specificity': 0.96104467, 'binary_f1_score': 0.40801886}
confusion matrix:
       0    1
0  17442  707
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9340045, 'precision': 0.6687329, 'recall': 0.8171471, 'specificity': 0.8171471, 'f1': 0.71527404, 'auroc': 0.90983355, 'binary_precision': 0.3515625, 'binary_recall': 0.6896552, 'binary_specificity': 0.94463897, 'binary_f1_score': 0.46571797}
confusion matrix:
      0    1
0  5665  332
1    81  180
early stop counter: 9
val acc:0.94657301902771, best validation acc: 0.9560451507568359, corresponding to test acc:                         0.9634068608283997 / 0.9634068608283997
after epoch: 15,now: 2024-07-10 11:29:18.931923,epoch time: 0:24:24.131729,used: 5:30:50.788912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9828892, 'precision': 0.9836992, 'recall': 0.97145045, 'specificity': 0.97145045, 'f1': 0.9773717, 'auroc': 0.9957778, 'binary_precision': 0.98530763, 'binary_recall': 0.9478155, 'binary_specificity': 0.9950854, 'binary_f1_score': 0.96619797}
confusion matrix:
       0      1
0  42115    208
1    768  13949
---- Validation: 
scalar performance:
{'acc': 0.94678587, 'precision': 0.65730244, 'recall': 0.7526841, 'specificity': 0.7526841, 'f1': 0.69194853, 'auroc': 0.8998673, 'binary_precision': 0.33112583, 'binary_recall': 0.5443235, 'binary_specificity': 0.96104467, 'binary_f1_score': 0.41176474}
confusion matrix:
       0    1
0  17442  707
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92665386, 'precision': 0.65418506, 'recall': 0.8133118, 'specificity': 0.8133118, 'f1': 0.7001598, 'auroc': 0.9092963, 'binary_precision': 0.32258064, 'binary_recall': 0.6896552, 'binary_specificity': 0.9369685, 'binary_f1_score': 0.4395604}
confusion matrix:
      0    1
0  5619  378
1    81  180
early stop counter: 10
val acc:0.9467858672142029, best validation acc: 0.9560451507568359, corresponding to test acc:                         0.9634068608283997 / 0.9634068608283997
after epoch: 16,now: 2024-07-10 11:51:11.038938,epoch time: 0:21:52.107015,used: 5:52:42.895927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98373073, 'precision': 0.9859024, 'recall': 0.9715246, 'specificity': 0.9715246, 'f1': 0.9784361, 'auroc': 0.9963604, 'binary_precision': 0.99018633, 'binary_recall': 0.9463096, 'binary_specificity': 0.99673957, 'binary_f1_score': 0.9677509}
confusion matrix:
       0      1
0  42188    138
1    790  13924
---- Validation: 
scalar performance:
{'acc': 0.9548744, 'precision': 0.67861176, 'recall': 0.72686946, 'specificity': 0.72686946, 'f1': 0.6994317, 'auroc': 0.89937854, 'binary_precision': 0.37575758, 'binary_recall': 0.4821151, 'binary_specificity': 0.9716238, 'binary_f1_score': 0.4223433}
confusion matrix:
       0    1
0  17634  515
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9475871, 'precision': 0.6993227, 'recall': 0.7949166, 'specificity': 0.7949166, 'f1': 0.736172, 'auroc': 0.9061948, 'binary_precision': 0.41518986, 'binary_recall': 0.62835246, 'binary_specificity': 0.96148074, 'binary_f1_score': 0.49999994}
confusion matrix:
      0    1
0  5766  231
1    97  164
early stop counter: 11
val acc:0.9548743963241577, best validation acc: 0.9560451507568359, corresponding to test acc:                         0.9634068608283997 / 0.9634068608283997
after epoch: 17,now: 2024-07-10 12:14:09.251661,epoch time: 0:22:58.212723,used: 6:15:41.108650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9847475, 'precision': 0.98375845, 'recall': 0.97624433, 'specificity': 0.97624433, 'f1': 0.9799245, 'auroc': 0.99642193, 'binary_precision': 0.98176503, 'binary_recall': 0.9586788, 'binary_specificity': 0.99380994, 'binary_f1_score': 0.97008455}
confusion matrix:
       0      1
0  42064    262
1    608  14106
---- Validation: 
scalar performance:
{'acc': 0.95258623, 'precision': 0.6765539, 'recall': 0.75643706, 'specificity': 0.75643706, 'f1': 0.7079609, 'auroc': 0.90657127, 'binary_precision': 0.3694737, 'binary_recall': 0.5458787, 'binary_specificity': 0.9669954, 'binary_f1_score': 0.440678}
confusion matrix:
       0    1
0  17550  599
1    292  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94534993, 'precision': 0.6928419, 'recall': 0.797414, 'specificity': 0.797414, 'f1': 0.7318506, 'auroc': 0.91029614, 'binary_precision': 0.40193704, 'binary_recall': 0.6360153, 'binary_specificity': 0.9588127, 'binary_f1_score': 0.49258158}
confusion matrix:
      0    1
0  5750  247
1    95  166
early stop counter: 12
val acc:0.9525862336158752, best validation acc: 0.9560451507568359, corresponding to test acc:                         0.9634068608283997 / 0.9634068608283997
after epoch: 18,now: 2024-07-10 12:37:31.116471,epoch time: 0:23:21.864810,used: 6:39:02.973460,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9840463, 'precision': 0.98625624, 'recall': 0.972005, 'specificity': 0.972005, 'f1': 0.97885823, 'auroc': 0.996717, 'binary_precision': 0.9906177, 'binary_recall': 0.9471288, 'binary_specificity': 0.99688125, 'binary_f1_score': 0.96838516}
confusion matrix:
       0      1
0  42193    132
1    778  13937
---- Validation: 
scalar performance:
{'acc': 0.9575883, 'precision': 0.6860386, 'recall': 0.7057728, 'specificity': 0.7057728, 'f1': 0.6953374, 'auroc': 0.89975655, 'binary_precision': 0.39215687, 'binary_recall': 0.43545878, 'binary_specificity': 0.97608685, 'binary_f1_score': 0.41267505}
confusion matrix:
       0    1
0  17715  434
1    363  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95317996, 'precision': 0.71743035, 'recall': 0.7795114, 'specificity': 0.7795114, 'f1': 0.74394417, 'auroc': 0.9058883, 'binary_precision': 0.45294118, 'binary_recall': 0.5900383, 'binary_specificity': 0.9689845, 'binary_f1_score': 0.51247925}
confusion matrix:
      0    1
0  5811  186
1   107  154
better model found
persisted
after epoch: 19,now: 2024-07-10 13:05:21.310716,epoch time: 0:27:50.194245,used: 7:06:53.167705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98478264, 'precision': 0.9854044, 'recall': 0.97471774, 'specificity': 0.97471774, 'f1': 0.9799069, 'auroc': 0.99679816, 'binary_precision': 0.9866451, 'binary_recall': 0.9539246, 'binary_specificity': 0.99551094, 'binary_f1_score': 0.970009}
confusion matrix:
       0      1
0  42135    190
1    678  14037
---- Validation: 
scalar performance:
{'acc': 0.95604515, 'precision': 0.68169445, 'recall': 0.71847486, 'specificity': 0.71847486, 'f1': 0.6981432, 'auroc': 0.9018903, 'binary_precision': 0.38254172, 'binary_recall': 0.46345258, 'binary_specificity': 0.97349715, 'binary_f1_score': 0.419128}
confusion matrix:
       0    1
0  17668  481
1    345  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949984, 'precision': 0.7050992, 'recall': 0.7796762, 'specificity': 0.7796762, 'f1': 0.7356371, 'auroc': 0.904871, 'binary_precision': 0.4281768, 'binary_recall': 0.59386975, 'binary_specificity': 0.9654827, 'binary_f1_score': 0.4975923}
confusion matrix:
      0    1
0  5790  207
1   106  155
early stop counter: 1
val acc:0.9560451507568359, best validation acc: 0.9575883150100708, corresponding to test acc:                         0.9531799554824829 / 0.9634068608283997
after epoch: 20,now: 2024-07-10 13:36:42.849292,epoch time: 0:31:21.538576,used: 7:38:14.706281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.985554, 'precision': 0.9850297, 'recall': 0.97710073, 'specificity': 0.97710073, 'f1': 0.98098, 'auroc': 0.9970603, 'binary_precision': 0.98397434, 'binary_recall': 0.9596358, 'binary_specificity': 0.9945657, 'binary_f1_score': 0.9716527}
confusion matrix:
       0      1
0  42094    230
1    594  14122
---- Validation: 
scalar performance:
{'acc': 0.9531183, 'precision': 0.6742923, 'recall': 0.7379612, 'specificity': 0.7379612, 'f1': 0.7004361, 'auroc': 0.90517277, 'binary_precision': 0.36629215, 'binary_recall': 0.5069984, 'binary_specificity': 0.9689239, 'binary_f1_score': 0.42530987}
confusion matrix:
       0    1
0  17585  564
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9448706, 'precision': 0.6897318, 'recall': 0.78800225, 'specificity': 0.78800225, 'f1': 0.7268211, 'auroc': 0.9051838, 'binary_precision': 0.39655173, 'binary_recall': 0.61685824, 'binary_specificity': 0.95914626, 'binary_f1_score': 0.4827586}
confusion matrix:
      0    1
0  5752  245
1   100  161
early stop counter: 2
val acc:0.9531183242797852, best validation acc: 0.9575883150100708, corresponding to test acc:                         0.9531799554824829 / 0.9634068608283997
after epoch: 21,now: 2024-07-10 14:02:18.812148,epoch time: 0:25:35.962856,used: 8:03:50.669137,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9860449, 'precision': 0.9863813, 'recall': 0.97705746, 'specificity': 0.97705746, 'f1': 0.98160213, 'auroc': 0.9974687, 'binary_precision': 0.9870557, 'binary_recall': 0.9584862, 'binary_specificity': 0.9956288, 'binary_f1_score': 0.97256124}
confusion matrix:
       0      1
0  42137    185
1    611  14107
---- Validation: 
scalar performance:
{'acc': 0.96019584, 'precision': 0.70065844, 'recall': 0.7078728, 'specificity': 0.7078728, 'f1': 0.7041934, 'auroc': 0.9034618, 'binary_precision': 0.42128935, 'binary_recall': 0.43701398, 'binary_specificity': 0.97873163, 'binary_f1_score': 0.42900765}
confusion matrix:
       0    1
0  17763  386
1    362  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550975, 'precision': 0.72448695, 'recall': 0.7676856, 'specificity': 0.7676856, 'f1': 0.743886, 'auroc': 0.9062571, 'binary_precision': 0.46815288, 'binary_recall': 0.5632184, 'binary_specificity': 0.97215277, 'binary_f1_score': 0.5113043}
confusion matrix:
      0    1
0  5830  167
1   114  147
better model found
persisted
after epoch: 22,now: 2024-07-10 14:25:34.888102,epoch time: 0:23:16.075954,used: 8:27:06.745091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9852209, 'precision': 0.9832155, 'recall': 0.9780533, 'specificity': 0.9780533, 'f1': 0.980598, 'auroc': 0.99678135, 'binary_precision': 0.9791422, 'binary_recall': 0.9632423, 'binary_specificity': 0.99286425, 'binary_f1_score': 0.97112715}
confusion matrix:
       0      1
0  42020    302
1    541  14177
---- Validation: 
scalar performance:
{'acc': 0.9551937, 'precision': 0.6772804, 'recall': 0.7157839, 'specificity': 0.7157839, 'f1': 0.69436026, 'auroc': 0.89852744, 'binary_precision': 0.373891, 'binary_recall': 0.45878693, 'binary_specificity': 0.9727809, 'binary_f1_score': 0.41201115}
confusion matrix:
       0    1
0  17655  494
1    348  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501438, 'precision': 0.70456684, 'recall': 0.7724303, 'specificity': 0.7724303, 'f1': 0.7328213, 'auroc': 0.9033425, 'binary_precision': 0.42776203, 'binary_recall': 0.5785441, 'binary_specificity': 0.9663165, 'binary_f1_score': 0.49185663}
confusion matrix:
      0    1
0  5795  202
1   110  151
early stop counter: 1
val acc:0.9551936984062195, best validation acc: 0.9601958394050598, corresponding to test acc:                         0.955097496509552 / 0.9634068608283997
after epoch: 23,now: 2024-07-10 14:50:19.415479,epoch time: 0:24:44.527377,used: 8:51:51.272468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98618513, 'precision': 0.9867964, 'recall': 0.9770218, 'specificity': 0.9770218, 'f1': 0.9817804, 'auroc': 0.9967364, 'binary_precision': 0.9880202, 'binary_recall': 0.9580842, 'binary_specificity': 0.99595934, 'binary_f1_score': 0.972822}
confusion matrix:
       0      1
0  42149    171
1    617  14103
---- Validation: 
scalar performance:
{'acc': 0.9571626, 'precision': 0.68440354, 'recall': 0.7078026, 'specificity': 0.7078026, 'f1': 0.69530386, 'auroc': 0.90250623, 'binary_precision': 0.38873628, 'binary_recall': 0.44012442, 'binary_specificity': 0.97548074, 'binary_f1_score': 0.41283736}
confusion matrix:
       0    1
0  17704  445
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.73330456, 'recall': 0.7613567, 'specificity': 0.7613567, 'f1': 0.74641275, 'auroc': 0.901315, 'binary_precision': 0.48639455, 'binary_recall': 0.54789275, 'binary_specificity': 0.97482073, 'binary_f1_score': 0.5153153}
confusion matrix:
      0    1
0  5846  151
1   118  143
early stop counter: 2
val acc:0.957162618637085, best validation acc: 0.9601958394050598, corresponding to test acc:                         0.955097496509552 / 0.9634068608283997
after epoch: 24,now: 2024-07-10 15:15:45.808915,epoch time: 0:25:26.393436,used: 9:17:17.665904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9872896, 'precision': 0.9870306, 'recall': 0.9796666, 'specificity': 0.9796666, 'f1': 0.9832754, 'auroc': 0.9971039, 'binary_precision': 0.98650813, 'binary_recall': 0.96391684, 'binary_specificity': 0.9954163, 'binary_f1_score': 0.9750817}
confusion matrix:
       0      1
0  42130    194
1    531  14185
---- Validation: 
scalar performance:
{'acc': 0.9549276, 'precision': 0.6662264, 'recall': 0.6803936, 'specificity': 0.6803936, 'f1': 0.67297554, 'auroc': 0.8939047, 'binary_precision': 0.35428572, 'binary_recall': 0.38569206, 'binary_specificity': 0.97509503, 'binary_f1_score': 0.3693224}
confusion matrix:
       0    1
0  17697  452
1    395  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547779, 'precision': 0.7203944, 'recall': 0.7436985, 'specificity': 0.7436985, 'f1': 0.73136806, 'auroc': 0.89753175, 'binary_precision': 0.46206897, 'binary_recall': 0.51341, 'binary_specificity': 0.973987, 'binary_f1_score': 0.48638842}
confusion matrix:
      0    1
0  5841  156
1   127  134
early stop counter: 3
val acc:0.9549276232719421, best validation acc: 0.9601958394050598, corresponding to test acc:                         0.955097496509552 / 0.9634068608283997
after epoch: 25,now: 2024-07-10 15:42:24.002569,epoch time: 0:26:38.193654,used: 9:43:55.859558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98704416, 'precision': 0.9876773, 'recall': 0.97839427, 'specificity': 0.97839427, 'f1': 0.98291993, 'auroc': 0.9975977, 'binary_precision': 0.98894644, 'binary_recall': 0.9605218, 'binary_specificity': 0.9962668, 'binary_f1_score': 0.9745269}
confusion matrix:
       0      1
0  42165    158
1    581  14136
---- Validation: 
scalar performance:
{'acc': 0.957003, 'precision': 0.680006, 'recall': 0.69346887, 'specificity': 0.69346887, 'f1': 0.68645936, 'auroc': 0.90144396, 'binary_precision': 0.3809524, 'binary_recall': 0.41057542, 'binary_specificity': 0.97636235, 'binary_f1_score': 0.39520958}
confusion matrix:
       0    1
0  17720  429
1    379  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.74808997, 'recall': 0.74445075, 'specificity': 0.74445075, 'f1': 0.74625504, 'auroc': 0.90249944, 'binary_precision': 0.5175097, 'binary_recall': 0.5095785, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.51351357}
confusion matrix:
      0    1
0  5873  124
1   128  133
early stop counter: 4
val acc:0.9570029973983765, best validation acc: 0.9601958394050598, corresponding to test acc:                         0.955097496509552 / 0.9634068608283997
after epoch: 26,now: 2024-07-10 16:04:29.456269,epoch time: 0:22:05.453700,used: 10:06:01.313258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98771036, 'precision': 0.98911726, 'recall': 0.9787351, 'specificity': 0.9787351, 'f1': 0.98378193, 'auroc': 0.9975581, 'binary_precision': 0.9919287, 'binary_recall': 0.9601875, 'binary_specificity': 0.9972827, 'binary_f1_score': 0.9758}
confusion matrix:
       0      1
0  42206    115
1    586  14133
---- Validation: 
scalar performance:
{'acc': 0.9613133, 'precision': 0.69725025, 'recall': 0.65819764, 'specificity': 0.65819764, 'f1': 0.6753031, 'auroc': 0.90301335, 'binary_precision': 0.41796875, 'binary_recall': 0.33281493, 'binary_specificity': 0.98358035, 'binary_f1_score': 0.3705628}
confusion matrix:
       0    1
0  17851  298
1    429  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.7939105, 'recall': 0.71980053, 'specificity': 0.71980053, 'f1': 0.75087523, 'auroc': 0.9005948, 'binary_precision': 0.61139894, 'binary_recall': 0.45210728, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.5198238}
confusion matrix:
      0    1
0  5922   75
1   143  118
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-10 16:26:44.454957,epoch time: 0:22:14.998688,used: 10:28:16.311946,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9865007, 'precision': 0.9874221, 'recall': 0.97722757, 'specificity': 0.97722757, 'f1': 0.98218524, 'auroc': 0.9976146, 'binary_precision': 0.9892639, 'binary_recall': 0.95807, 'binary_specificity': 0.9963851, 'binary_f1_score': 0.97341716}
confusion matrix:
       0      1
0  42172    153
1    617  14098
---- Validation: 
scalar performance:
{'acc': 0.95977014, 'precision': 0.684229, 'recall': 0.65139824, 'specificity': 0.65139824, 'f1': 0.6659898, 'auroc': 0.8995452, 'binary_precision': 0.39238095, 'binary_recall': 0.32037324, 'binary_specificity': 0.98242325, 'binary_f1_score': 0.35273972}
confusion matrix:
       0    1
0  17830  319
1    437  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.76482743, 'recall': 0.7217977, 'specificity': 0.7217977, 'f1': 0.74116063, 'auroc': 0.89475185, 'binary_precision': 0.5529954, 'binary_recall': 0.4597701, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.50209206}
confusion matrix:
      0    1
0  5900   97
1   141  120
early stop counter: 1
val acc:0.959770143032074, best validation acc: 0.9613133072853088, corresponding to test acc:                         0.9651646018028259 / 0.9651646018028259
after epoch: 28,now: 2024-07-10 16:48:54.914928,epoch time: 0:22:10.459971,used: 10:50:26.771917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9874825, 'precision': 0.9882493, 'recall': 0.97897774, 'specificity': 0.97897774, 'f1': 0.9834981, 'auroc': 0.9976052, 'binary_precision': 0.9897866, 'binary_recall': 0.96140516, 'binary_specificity': 0.9965503, 'binary_f1_score': 0.9753895}
confusion matrix:
       0      1
0  42177    146
1    568  14149
---- Validation: 
scalar performance:
{'acc': 0.95780116, 'precision': 0.67851084, 'recall': 0.6728806, 'specificity': 0.6728806, 'f1': 0.67564416, 'auroc': 0.90058625, 'binary_precision': 0.37942123, 'binary_recall': 0.36702955, 'binary_specificity': 0.97873163, 'binary_f1_score': 0.37312254}
confusion matrix:
       0    1
0  17763  386
1    407  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.7892411, 'recall': 0.73254347, 'specificity': 0.73254347, 'f1': 0.7574351, 'auroc': 0.8989083, 'binary_precision': 0.60096157, 'binary_recall': 0.4789272, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.533049}
confusion matrix:
      0    1
0  5914   83
1   136  125
early stop counter: 2
val acc:0.9578011631965637, best validation acc: 0.9613133072853088, corresponding to test acc:                         0.9651646018028259 / 0.9651646018028259
after epoch: 29,now: 2024-07-10 17:10:42.155879,epoch time: 0:21:47.240951,used: 11:12:14.012868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98723704, 'precision': 0.9881284, 'recall': 0.9784565, 'specificity': 0.9784565, 'f1': 0.98316693, 'auroc': 0.9977226, 'binary_precision': 0.98991317, 'binary_recall': 0.9603153, 'binary_specificity': 0.99659765, 'binary_f1_score': 0.97488964}
confusion matrix:
       0      1
0  42180    144
1    584  14132
---- Validation: 
scalar performance:
{'acc': 0.9578544, 'precision': 0.67366594, 'recall': 0.6564069, 'specificity': 0.6564069, 'f1': 0.66451997, 'auroc': 0.8979691, 'binary_precision': 0.37088388, 'binary_recall': 0.33281493, 'binary_specificity': 0.9799989, 'binary_f1_score': 0.35081968}
confusion matrix:
       0    1
0  17786  363
1    429  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.78061485, 'recall': 0.7172178, 'specificity': 0.7172178, 'f1': 0.7443809, 'auroc': 0.89559436, 'binary_precision': 0.585, 'binary_recall': 0.44827586, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.50759214}
confusion matrix:
      0    1
0  5914   83
1   144  117
early stop counter: 3
val acc:0.9578543901443481, best validation acc: 0.9613133072853088, corresponding to test acc:                         0.9651646018028259 / 0.9651646018028259
after epoch: 30,now: 2024-07-10 17:32:40.543057,epoch time: 0:21:58.387178,used: 11:34:12.400046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_05_58_28_seed_0_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:34:12.400046 at 2024-07-10 17:32:40.543057
persisted model performance metric: 

scalar performance:
{'acc': 0.9651646, 'precision': 0.7939105, 'recall': 0.71980053, 'specificity': 0.71980053, 'f1': 0.75087523, 'auroc': 0.9005948, 'binary_precision': 0.61139894, 'binary_recall': 0.45210728, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.5198238}
confusion matrix:
      0    1
0  5922   75
1   143  118
oracle model performance metric: 

scalar performance:
{'acc': 0.9651646, 'precision': 0.7939105, 'recall': 0.71980053, 'specificity': 0.71980053, 'f1': 0.75087523, 'auroc': 0.9005948, 'binary_precision': 0.61139894, 'binary_recall': 0.45210728, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.5198238}
confusion matrix:
      0    1
0  5922   75
1   143  118
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  16482 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59895 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |   9133 KiB |  11093 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7625    |  195064 K  |  195061 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84572 K  |   84569 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7625    |  195064 K  |  195061 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84572 K  |   84569 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3589    |  120671 K  |  120671 K  |
|       from large pool |      10    |     350    |   85092 K  |   85092 K  |
|       from small pool |      27    |    3579    |   35578 K  |   35578 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84572 K  |   84572 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84572 K  |   84572 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  120672 K  |  120672 K  |
|       from large pool |       3    |     350    |   85092 K  |   85092 K  |
|       from small pool |       0    |    3579    |   35580 K  |   35580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84572 K  |   84572 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84572 K  |   84572 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  120672 K  |  120672 K  |
|       from large pool |       3    |     350    |   85092 K  |   85092 K  |
|       from small pool |       0    |    3579    |   35580 K  |   35580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620

 Experiment start at: 2024-07-10 17:51:41.434421
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92655545, 'precision': 0.93198895, 'recall': 0.87089264, 'specificity': 0.87089264, 'f1': 0.8960083, 'auroc': 0.9410088, 'binary_precision': 0.9411765, 'binary_recall': 0.7578889, 'binary_specificity': 0.98389643, 'binary_f1_score': 0.8396465}
confusion matrix:
       0      1
0  41730    683
1   3491  10928
---- Validation: 
scalar performance:
{'acc': 0.9384205, 'precision': 0.51090485, 'recall': 0.5088617, 'specificity': 0.5088617, 'f1': 0.50958234, 'auroc': 0.7449362, 'binary_precision': 0.057090238, 'binary_recall': 0.046062406, 'binary_specificity': 0.97166103, 'binary_f1_score': 0.050986838}
confusion matrix:
       0    1
0  17555  512
1    642   31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9311956, 'precision': 0.4902049, 'recall': 0.4933129, 'specificity': 0.4933129, 'f1': 0.4913696, 'auroc': 0.70478475, 'binary_precision': 0.022857143, 'binary_recall': 0.015384615, 'binary_specificity': 0.9712412, 'binary_f1_score': 0.018390805}
confusion matrix:
      0    1
0  5775  171
1   256    4
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 18:13:54.286096,epoch time: 0:22:12.851675,used: 0:22:12.851675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95215726, 'precision': 0.95817477, 'recall': 0.9146006, 'specificity': 0.9146006, 'f1': 0.93378687, 'auroc': 0.9696082, 'binary_precision': 0.96890277, 'binary_recall': 0.8383495, 'binary_specificity': 0.99085164, 'binary_f1_score': 0.89891064}
confusion matrix:
       0      1
0  42024    388
1   2331  12089
---- Validation: 
scalar performance:
{'acc': 0.944984, 'precision': 0.5530031, 'recall': 0.5394459, 'specificity': 0.5394459, 'f1': 0.54482794, 'auroc': 0.8143877, 'binary_precision': 0.1391129, 'binary_recall': 0.102526, 'binary_specificity': 0.97636575, 'binary_f1_score': 0.11804962}
confusion matrix:
       0    1
0  17640  427
1    604   69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93329036, 'precision': 0.4970458, 'recall': 0.49808404, 'specificity': 0.49808404, 'f1': 0.49681437, 'auroc': 0.78857994, 'binary_precision': 0.036144577, 'binary_recall': 0.023076924, 'binary_specificity': 0.9730911, 'binary_f1_score': 0.028169015}
confusion matrix:
      0    1
0  5786  160
1   254    6
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-10 18:38:08.823011,epoch time: 0:24:14.536915,used: 0:46:27.388590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9616413, 'precision': 0.96542037, 'recall': 0.93259907, 'specificity': 0.93259907, 'f1': 0.9475494, 'auroc': 0.979934, 'binary_precision': 0.97236586, 'binary_recall': 0.8736389, 'binary_specificity': 0.9915592, 'binary_f1_score': 0.9203624}
confusion matrix:
       0      1
0  42055    358
1   1822  12597
---- Validation: 
scalar performance:
{'acc': 0.94962645, 'precision': 0.60492235, 'recall': 0.5819085, 'specificity': 0.5819085, 'f1': 0.5916824, 'auroc': 0.8486647, 'binary_precision': 0.23992322, 'binary_recall': 0.18573551, 'binary_specificity': 0.9780816, 'binary_f1_score': 0.20938022}
confusion matrix:
       0    1
0  17671  396
1    548  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9361908, 'precision': 0.52741367, 'recall': 0.51798755, 'specificity': 0.51798755, 'f1': 0.52086115, 'auroc': 0.84231865, 'binary_precision': 0.0952381, 'binary_recall': 0.06153846, 'binary_specificity': 0.9744366, 'binary_f1_score': 0.07476635}
confusion matrix:
      0    1
0  5794  152
1   244   16
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-10 19:07:18.480496,epoch time: 0:29:09.657485,used: 1:15:37.046075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9658115, 'precision': 0.9708532, 'recall': 0.93852866, 'specificity': 0.93852866, 'f1': 0.95329463, 'auroc': 0.98415995, 'binary_precision': 0.98014164, 'binary_recall': 0.8831403, 'binary_specificity': 0.993917, 'binary_f1_score': 0.9291161}
confusion matrix:
       0      1
0  42155    258
1   1685  12734
---- Validation: 
scalar performance:
{'acc': 0.9566169, 'precision': 0.6374622, 'recall': 0.5748049, 'specificity': 0.5748049, 'f1': 0.59533274, 'auroc': 0.86438876, 'binary_precision': 0.30555555, 'binary_recall': 0.16344725, 'binary_specificity': 0.9861626, 'binary_f1_score': 0.21297193}
confusion matrix:
       0    1
0  17817  250
1    563  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9479536, 'precision': 0.57109576, 'recall': 0.5278041, 'specificity': 0.5278041, 'f1': 0.5367402, 'auroc': 0.86883616, 'binary_precision': 0.18181819, 'binary_recall': 0.06923077, 'binary_specificity': 0.9863774, 'binary_f1_score': 0.10027856}
confusion matrix:
      0   1
0  5865  81
1   242  18
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-10 19:35:00.818293,epoch time: 0:27:42.337797,used: 1:43:19.383872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96978813, 'precision': 0.97328424, 'recall': 0.9465749, 'specificity': 0.9465749, 'f1': 0.9589773, 'auroc': 0.9882767, 'binary_precision': 0.97982925, 'binary_recall': 0.89944524, 'binary_specificity': 0.9937046, 'binary_f1_score': 0.93791807}
confusion matrix:
       0      1
0  42145    267
1   1450  12970
---- Validation: 
scalar performance:
{'acc': 0.95789754, 'precision': 0.6681266, 'recall': 0.60837144, 'specificity': 0.60837144, 'f1': 0.6308452, 'auroc': 0.87288463, 'binary_precision': 0.36448598, 'binary_recall': 0.23179792, 'binary_specificity': 0.98494494, 'binary_f1_score': 0.28337872}
confusion matrix:
       0    1
0  17795  272
1    517  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9513374, 'precision': 0.64585423, 'recall': 0.5700277, 'specificity': 0.5700277, 'f1': 0.5921601, 'auroc': 0.8854684, 'binary_precision': 0.32786885, 'binary_recall': 0.15384616, 'binary_specificity': 0.9862092, 'binary_f1_score': 0.20942408}
confusion matrix:
      0   1
0  5864  82
1   220  40
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-10 20:02:37.755754,epoch time: 0:27:36.937461,used: 2:10:56.321333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9699289, 'precision': 0.9747481, 'recall': 0.94563586, 'specificity': 0.94563586, 'f1': 0.9590678, 'auroc': 0.9895035, 'binary_precision': 0.98371136, 'binary_recall': 0.89631736, 'binary_specificity': 0.99495435, 'binary_f1_score': 0.9379831}
confusion matrix:
       0      1
0  42199    214
1   1495  12924
---- Validation: 
scalar performance:
{'acc': 0.96109927, 'precision': 0.6946606, 'recall': 0.6007334, 'specificity': 0.6007334, 'f1': 0.63089085, 'auroc': 0.87750304, 'binary_precision': 0.41812867, 'binary_recall': 0.21248142, 'binary_specificity': 0.9889854, 'binary_f1_score': 0.2817734}
confusion matrix:
       0    1
0  17868  199
1    530  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.7080592, 'recall': 0.5692088, 'specificity': 0.5692088, 'f1': 0.5993614, 'auroc': 0.89487886, 'binary_precision': 0.45238096, 'binary_recall': 0.14615385, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.22093023}
confusion matrix:
      0   1
0  5900  46
1   222  38
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-10 20:30:09.293886,epoch time: 0:27:31.538132,used: 2:38:27.859465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9743806, 'precision': 0.97713566, 'recall': 0.95493543, 'specificity': 0.95493543, 'f1': 0.96538156, 'auroc': 0.9915019, 'binary_precision': 0.98236215, 'binary_recall': 0.9154588, 'binary_specificity': 0.99441206, 'binary_f1_score': 0.9477312}
confusion matrix:
       0      1
0  42176    237
1   1219  13200
---- Validation: 
scalar performance:
{'acc': 0.9608858, 'precision': 0.7002354, 'recall': 0.6249418, 'specificity': 0.6249418, 'f1': 0.6527629, 'auroc': 0.88278496, 'binary_precision': 0.42753622, 'binary_recall': 0.26300147, 'binary_specificity': 0.98688215, 'binary_f1_score': 0.32566696}
confusion matrix:
       0    1
0  17830  237
1    496  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.74852383, 'recall': 0.6164448, 'specificity': 0.6164448, 'f1': 0.65571415, 'auroc': 0.90259, 'binary_precision': 0.5294118, 'binary_recall': 0.2423077, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.33245385}
confusion matrix:
      0   1
0  5890  56
1   197  63
new oracle model saved
early stop counter: 1
val acc:0.9608858227729797, best validation acc: 0.9610992670059204, corresponding to test acc:                         0.9568159580230713 / 0.9592329859733582
after epoch: 7,now: 2024-07-10 20:53:17.991990,epoch time: 0:23:08.698104,used: 3:01:36.557569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97645694, 'precision': 0.9783166, 'recall': 0.9592358, 'specificity': 0.9592358, 'f1': 0.96829295, 'auroc': 0.9927828, 'binary_precision': 0.9818771, 'binary_recall': 0.9242718, 'binary_specificity': 0.99419975, 'binary_f1_score': 0.952204}
confusion matrix:
       0      1
0  42166    246
1   1092  13328
---- Validation: 
scalar performance:
{'acc': 0.96125937, 'precision': 0.70718837, 'recall': 0.63872564, 'specificity': 0.63872564, 'f1': 0.6653302, 'auroc': 0.8870541, 'binary_precision': 0.44044945, 'binary_recall': 0.29123327, 'binary_specificity': 0.986218, 'binary_f1_score': 0.3506261}
confusion matrix:
       0    1
0  17818  249
1    477  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.8036946, 'recall': 0.63877594, 'specificity': 0.63877594, 'f1': 0.6873369, 'auroc': 0.9067997, 'binary_precision': 0.63793105, 'binary_recall': 0.2846154, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.39361703}
confusion matrix:
      0   1
0  5904  42
1   186  74
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-10 21:16:05.187943,epoch time: 0:22:47.195953,used: 3:24:23.753522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9753484, 'precision': 0.9774911, 'recall': 0.9571173, 'specificity': 0.9571173, 'f1': 0.9667528, 'auroc': 0.99344075, 'binary_precision': 0.9815774, 'binary_recall': 0.9201054, 'binary_specificity': 0.9941292, 'binary_f1_score': 0.9498478}
confusion matrix:
       0      1
0  42164    249
1   1152  13267
---- Validation: 
scalar performance:
{'acc': 0.96211314, 'precision': 0.71161157, 'recall': 0.6198562, 'specificity': 0.6198562, 'f1': 0.65151536, 'auroc': 0.8853096, 'binary_precision': 0.45066667, 'binary_recall': 0.2511144, 'binary_specificity': 0.988598, 'binary_f1_score': 0.3225191}
confusion matrix:
       0    1
0  17861  206
1    504  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.8174499, 'recall': 0.62414813, 'specificity': 0.62414813, 'f1': 0.6744273, 'auroc': 0.90675175, 'binary_precision': 0.6666667, 'binary_recall': 0.25384617, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.36768806}
confusion matrix:
      0   1
0  5913  33
1   194  66
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-10 21:38:39.748341,epoch time: 0:22:34.560398,used: 3:46:58.313920,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9772487, 'precision': 0.97991294, 'recall': 0.95981205, 'specificity': 0.95981205, 'f1': 0.9693291, 'auroc': 0.9940362, 'binary_precision': 0.98499966, 'binary_recall': 0.9244105, 'binary_specificity': 0.9952136, 'binary_f1_score': 0.95374376}
confusion matrix:
       0      1
0  42209    203
1   1090  13330
---- Validation: 
scalar performance:
{'acc': 0.96227324, 'precision': 0.714015, 'recall': 0.6228003, 'specificity': 0.6228003, 'f1': 0.65458816, 'auroc': 0.88528603, 'binary_precision': 0.45526317, 'binary_recall': 0.25705793, 'binary_specificity': 0.9885427, 'binary_f1_score': 0.328585}
confusion matrix:
       0    1
0  17860  207
1    500  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.8211839, 'recall': 0.6430425, 'specificity': 0.6430425, 'f1': 0.6945749, 'auroc': 0.90920204, 'binary_precision': 0.67256635, 'binary_recall': 0.2923077, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.4075067}
confusion matrix:
      0   1
0  5909  37
1   184  76
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-10 22:01:23.643587,epoch time: 0:22:43.895246,used: 4:09:42.209166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97877955, 'precision': 0.97917795, 'recall': 0.96449935, 'specificity': 0.96449935, 'f1': 0.971552, 'auroc': 0.994472, 'binary_precision': 0.9799506, 'binary_recall': 0.9355062, 'binary_specificity': 0.9934924, 'binary_f1_score': 0.9572128}
confusion matrix:
       0      1
0  42136    276
1    930  13490
---- Validation: 
scalar performance:
{'acc': 0.96163285, 'precision': 0.71441656, 'recall': 0.6589468, 'specificity': 0.6589468, 'f1': 0.6820451, 'auroc': 0.88843566, 'binary_precision': 0.4534413, 'binary_recall': 0.33283803, 'binary_specificity': 0.9850556, 'binary_f1_score': 0.3838903}
confusion matrix:
       0    1
0  17797  270
1    449  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.788751, 'recall': 0.63083136, 'specificity': 0.63083136, 'f1': 0.6769051, 'auroc': 0.90655434, 'binary_precision': 0.6086956, 'binary_recall': 0.26923078, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.37333333}
confusion matrix:
      0   1
0  5901  45
1   190  70
early stop counter: 1
val acc:0.9616328477859497, best validation acc: 0.9622732400894165, corresponding to test acc:                         0.9643893241882324 / 0.9643893241882324
after epoch: 11,now: 2024-07-10 22:24:16.594580,epoch time: 0:22:52.950993,used: 4:32:35.160159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9802048, 'precision': 0.9801574, 'recall': 0.967304, 'specificity': 0.967304, 'f1': 0.9735111, 'auroc': 0.99525833, 'binary_precision': 0.980065, 'binary_recall': 0.94111526, 'binary_specificity': 0.9934927, 'binary_f1_score': 0.9601953}
confusion matrix:
       0      1
0  42138    276
1    849  13569
---- Validation: 
scalar performance:
{'acc': 0.9618463, 'precision': 0.71473116, 'recall': 0.64975905, 'specificity': 0.64975905, 'f1': 0.6757392, 'auroc': 0.8904428, 'binary_precision': 0.4547414, 'binary_recall': 0.31352153, 'binary_specificity': 0.98599654, 'binary_f1_score': 0.37115213}
confusion matrix:
       0    1
0  17814  253
1    462  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.8448131, 'recall': 0.6682107, 'specificity': 0.6682107, 'f1': 0.7232075, 'auroc': 0.91407156, 'binary_precision': 0.7177419, 'binary_recall': 0.3423077, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.4635417}
confusion matrix:
      0   1
0  5911  35
1   171  89
new oracle model saved
early stop counter: 2
val acc:0.9618462920188904, best validation acc: 0.9622732400894165, corresponding to test acc:                         0.9643893241882324 / 0.9668062925338745
after epoch: 12,now: 2024-07-10 22:46:56.478547,epoch time: 0:22:39.883967,used: 4:55:15.044126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9806623, 'precision': 0.9813476, 'recall': 0.9673627, 'specificity': 0.9673627, 'f1': 0.9740963, 'auroc': 0.9955509, 'binary_precision': 0.9826799, 'binary_recall': 0.9403606, 'binary_specificity': 0.9943648, 'binary_f1_score': 0.9610546}
confusion matrix:
       0      1
0  42173    239
1    860  13560
---- Validation: 
scalar performance:
{'acc': 0.9617396, 'precision': 0.7164737, 'recall': 0.66615486, 'specificity': 0.66615486, 'f1': 0.68759096, 'auroc': 0.89136314, 'binary_precision': 0.45703125, 'binary_recall': 0.34769687, 'binary_specificity': 0.9846128, 'binary_f1_score': 0.39493668}
confusion matrix:
       0    1
0  17789  278
1    439  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.8403481, 'recall': 0.6699656, 'specificity': 0.6699656, 'f1': 0.7239511, 'auroc': 0.9115087, 'binary_precision': 0.70866144, 'binary_recall': 0.34615386, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.4651163}
confusion matrix:
      0   1
0  5909  37
1   170  90
early stop counter: 3
val acc:0.9617395997047424, best validation acc: 0.9622732400894165, corresponding to test acc:                         0.9643893241882324 / 0.9668062925338745
after epoch: 13,now: 2024-07-10 23:09:32.223772,epoch time: 0:22:35.745225,used: 5:17:50.789351,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98161244, 'precision': 0.98117554, 'recall': 0.9700343, 'specificity': 0.9700343, 'f1': 0.97544, 'auroc': 0.9961325, 'binary_precision': 0.9803189, 'binary_recall': 0.9465289, 'binary_specificity': 0.9935397, 'binary_f1_score': 0.9631276}
confusion matrix:
       0      1
0  42139    274
1    771  13648
---- Validation: 
scalar performance:
{'acc': 0.9625934, 'precision': 0.72587514, 'recall': 0.6851946, 'specificity': 0.6851946, 'f1': 0.70327365, 'auroc': 0.8970086, 'binary_precision': 0.47445256, 'binary_recall': 0.38632986, 'binary_specificity': 0.98405933, 'binary_f1_score': 0.42588043}
confusion matrix:
       0    1
0  17779  288
1    413  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970029, 'precision': 0.85518384, 'recall': 0.7195451, 'specificity': 0.7195451, 'f1': 0.7697581, 'auroc': 0.9172949, 'binary_precision': 0.73417723, 'binary_recall': 0.44615385, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.5550239}
confusion matrix:
      0    1
0  5904   42
1   144  116
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-10 23:32:04.481307,epoch time: 0:22:32.257535,used: 5:40:23.046886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98166525, 'precision': 0.97999334, 'recall': 0.9713481, 'specificity': 0.9713481, 'f1': 0.9755709, 'auroc': 0.9952214, 'binary_precision': 0.9766911, 'binary_recall': 0.9504058, 'binary_specificity': 0.99229044, 'binary_f1_score': 0.9633692}
confusion matrix:
       0      1
0  42088    327
1    715  13702
---- Validation: 
scalar performance:
{'acc': 0.96168625, 'precision': 0.713652, 'recall': 0.65182185, 'specificity': 0.65182185, 'f1': 0.6768559, 'auroc': 0.8891214, 'binary_precision': 0.4524313, 'binary_recall': 0.3179792, 'binary_specificity': 0.9856645, 'binary_f1_score': 0.37347296}
confusion matrix:
       0    1
0  17808  259
1    459  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.7891468, 'recall': 0.6588366, 'specificity': 0.6588366, 'f1': 0.7029262, 'auroc': 0.906374, 'binary_precision': 0.60714287, 'binary_recall': 0.32692307, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.42499998}
confusion matrix:
      0   1
0  5891  55
1   175  85
early stop counter: 1
val acc:0.9616862535476685, best validation acc: 0.9625933766365051, corresponding to test acc:                         0.9700289964675903 / 0.9700289964675903
after epoch: 15,now: 2024-07-10 23:54:14.375081,epoch time: 0:22:09.893774,used: 6:02:32.940660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9830905, 'precision': 0.9840251, 'recall': 0.9711619, 'specificity': 0.9711619, 'f1': 0.97737586, 'auroc': 0.9960448, 'binary_precision': 0.98584837, 'binary_recall': 0.946945, 'binary_specificity': 0.9953788, 'binary_f1_score': 0.9660052}
confusion matrix:
       0      1
0  42217    196
1    765  13654
---- Validation: 
scalar performance:
{'acc': 0.96254003, 'precision': 0.7221449, 'recall': 0.65655625, 'specificity': 0.65655625, 'f1': 0.6829852, 'auroc': 0.8906567, 'binary_precision': 0.46908316, 'binary_recall': 0.3268945, 'binary_specificity': 0.986218, 'binary_f1_score': 0.38528895}
confusion matrix:
       0    1
0  17818  249
1    453  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.8174465, 'recall': 0.6560836, 'specificity': 0.6560836, 'f1': 0.7064799, 'auroc': 0.9099989, 'binary_precision': 0.664, 'binary_recall': 0.31923077, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.43116885}
confusion matrix:
      0   1
0  5904  42
1   177  83
early stop counter: 2
val acc:0.9625400304794312, best validation acc: 0.9625933766365051, corresponding to test acc:                         0.9700289964675903 / 0.9700289964675903
after epoch: 16,now: 2024-07-11 00:15:38.184322,epoch time: 0:21:23.809241,used: 6:23:56.749901,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98206997, 'precision': 0.98364717, 'recall': 0.9688531, 'specificity': 0.9688531, 'f1': 0.9759624, 'auroc': 0.99583507, 'binary_precision': 0.9867064, 'binary_recall': 0.94202095, 'binary_specificity': 0.9956853, 'binary_f1_score': 0.96384597}
confusion matrix:
       0      1
0  42230    183
1    836  13583
---- Validation: 
scalar performance:
{'acc': 0.9632871, 'precision': 0.72905594, 'recall': 0.65336734, 'specificity': 0.65336734, 'f1': 0.68284726, 'auroc': 0.8945354, 'binary_precision': 0.48314607, 'binary_recall': 0.31946507, 'binary_specificity': 0.9872696, 'binary_f1_score': 0.3846154}
confusion matrix:
       0    1
0  17837  230
1    458  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.85906196, 'recall': 0.6723932, 'specificity': 0.6723932, 'f1': 0.72990733, 'auroc': 0.9138116, 'binary_precision': 0.74590164, 'binary_recall': 0.35, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.4764398}
confusion matrix:
      0   1
0  5915  31
1   169  91
better model found
persisted
after epoch: 17,now: 2024-07-11 00:37:21.529829,epoch time: 0:21:43.345507,used: 6:45:40.095408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98145413, 'precision': 0.9846363, 'recall': 0.9663327, 'specificity': 0.9663327, 'f1': 0.975047, 'auroc': 0.996584, 'binary_precision': 0.9907462, 'binary_recall': 0.935636, 'binary_specificity': 0.9970293, 'binary_f1_score': 0.9624028}
confusion matrix:
       0      1
0  42288    126
1    928  13490
---- Validation: 
scalar performance:
{'acc': 0.964461, 'precision': 0.74154496, 'recall': 0.637525, 'specificity': 0.637525, 'f1': 0.67371637, 'auroc': 0.8934994, 'binary_precision': 0.50928384, 'binary_recall': 0.28528973, 'binary_specificity': 0.98976034, 'binary_f1_score': 0.36571428}
confusion matrix:
       0    1
0  17882  185
1    481  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.88417083, 'recall': 0.65024126, 'specificity': 0.65024126, 'f1': 0.7117175, 'auroc': 0.91422904, 'binary_precision': 0.7979798, 'binary_recall': 0.30384615, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.4401114}
confusion matrix:
      0   1
0  5926  20
1   181  79
better model found
persisted
after epoch: 18,now: 2024-07-11 00:59:07.563674,epoch time: 0:21:46.033845,used: 7:07:26.129253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9840055, 'precision': 0.98208416, 'recall': 0.9755056, 'specificity': 0.9755056, 'f1': 0.97873724, 'auroc': 0.99653316, 'binary_precision': 0.978264, 'binary_recall': 0.9582495, 'binary_specificity': 0.9927617, 'binary_f1_score': 0.96815336}
confusion matrix:
       0      1
0  42106    307
1    602  13817
---- Validation: 
scalar performance:
{'acc': 0.95971185, 'precision': 0.7056542, 'recall': 0.6894223, 'specificity': 0.6894223, 'f1': 0.69715965, 'auroc': 0.8967166, 'binary_precision': 0.43365696, 'binary_recall': 0.39821693, 'binary_specificity': 0.98062766, 'binary_f1_score': 0.41518202}
confusion matrix:
       0    1
0  17717  350
1    405  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.80672914, 'recall': 0.717527, 'specificity': 0.717527, 'f1': 0.7536715, 'auroc': 0.9136834, 'binary_precision': 0.63736266, 'binary_recall': 0.44615385, 'binary_specificity': 0.9889001, 'binary_f1_score': 0.5248869}
confusion matrix:
      0    1
0  5880   66
1   144  116
early stop counter: 1
val acc:0.9597118496894836, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9676119685173035 / 0.9700289964675903
after epoch: 19,now: 2024-07-11 01:20:51.466314,epoch time: 0:21:43.902640,used: 7:29:10.031893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9847973, 'precision': 0.98333585, 'recall': 0.9763552, 'specificity': 0.9763552, 'f1': 0.9797809, 'auroc': 0.9965343, 'binary_precision': 0.9804339, 'binary_recall': 0.95921767, 'binary_specificity': 0.9934927, 'binary_f1_score': 0.96970975}
confusion matrix:
       0      1
0  42138    276
1    588  13830
---- Validation: 
scalar performance:
{'acc': 0.9607791, 'precision': 0.71391296, 'recall': 0.6964132, 'specificity': 0.6964132, 'f1': 0.7047408, 'auroc': 0.8996011, 'binary_precision': 0.44967532, 'binary_recall': 0.4115899, 'binary_specificity': 0.9812365, 'binary_f1_score': 0.42979053}
confusion matrix:
       0    1
0  17728  339
1    396  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.8362714, 'recall': 0.7244735, 'specificity': 0.7244735, 'f1': 0.7680477, 'auroc': 0.91957164, 'binary_precision': 0.69590646, 'binary_recall': 0.4576923, 'binary_specificity': 0.9912546, 'binary_f1_score': 0.5522042}
confusion matrix:
      0    1
0  5894   52
1   141  119
early stop counter: 2
val acc:0.960779070854187, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9676119685173035 / 0.9700289964675903
after epoch: 20,now: 2024-07-11 01:42:49.203156,epoch time: 0:21:57.736842,used: 7:51:07.768735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98418146, 'precision': 0.98231965, 'recall': 0.9757379, 'specificity': 0.9757379, 'f1': 0.9789711, 'auroc': 0.9964905, 'binary_precision': 0.97861797, 'binary_recall': 0.9585963, 'binary_specificity': 0.99287957, 'binary_f1_score': 0.96850365}
confusion matrix:
       0      1
0  42111    302
1    597  13822
---- Validation: 
scalar performance:
{'acc': 0.9617396, 'precision': 0.7169087, 'recall': 0.66901594, 'specificity': 0.66901594, 'f1': 0.6896175, 'auroc': 0.89824426, 'binary_precision': 0.4576923, 'binary_recall': 0.3536404, 'binary_specificity': 0.98439145, 'binary_f1_score': 0.39899412}
confusion matrix:
       0    1
0  17785  282
1    435  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96809536, 'precision': 0.8419367, 'recall': 0.69830716, 'specificity': 0.69830716, 'f1': 0.7491057, 'auroc': 0.9146497, 'binary_precision': 0.7094595, 'binary_recall': 0.40384614, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.5147059}
confusion matrix:
      0    1
0  5903   43
1   155  105
early stop counter: 3
val acc:0.9617395997047424, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9676119685173035 / 0.9700289964675903
after epoch: 21,now: 2024-07-11 02:04:25.355158,epoch time: 0:21:36.152002,used: 8:12:43.920737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9845158, 'precision': 0.9827559, 'recall': 0.9761908, 'specificity': 0.9761908, 'f1': 0.979416, 'auroc': 0.99696875, 'binary_precision': 0.97925663, 'binary_recall': 0.95928985, 'binary_specificity': 0.99309176, 'binary_f1_score': 0.96917045}
confusion matrix:
       0      1
0  42120    293
1    587  13832
---- Validation: 
scalar performance:
{'acc': 0.960619, 'precision': 0.71806633, 'recall': 0.73423934, 'specificity': 0.73423934, 'f1': 0.72582483, 'auroc': 0.9039333, 'binary_precision': 0.45517242, 'binary_recall': 0.49034175, 'binary_specificity': 0.97813696, 'binary_f1_score': 0.472103}
confusion matrix:
       0    1
0  17672  395
1    343  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.84402704, 'recall': 0.7530674, 'specificity': 0.7530674, 'f1': 0.79087603, 'auroc': 0.9197689, 'binary_precision': 0.7089947, 'binary_recall': 0.5153846, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.596882}
confusion matrix:
      0    1
0  5891   55
1   126  134
new oracle model saved
early stop counter: 4
val acc:0.9606189727783203, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9676119685173035 / 0.9708346724510193
after epoch: 22,now: 2024-07-11 02:26:00.278645,epoch time: 0:21:34.923487,used: 8:34:18.844224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98504364, 'precision': 0.985259, 'recall': 0.97510254, 'specificity': 0.97510254, 'f1': 0.9800451, 'auroc': 0.9972895, 'binary_precision': 0.9856826, 'binary_recall': 0.9549206, 'binary_specificity': 0.99528444, 'binary_f1_score': 0.9700577}
confusion matrix:
       0      1
0  42213    200
1    650  13769
---- Validation: 
scalar performance:
{'acc': 0.96195304, 'precision': 0.72208667, 'recall': 0.6955915, 'specificity': 0.6955915, 'f1': 0.70789206, 'auroc': 0.90274954, 'binary_precision': 0.4661017, 'binary_recall': 0.40861812, 'binary_specificity': 0.9825649, 'binary_f1_score': 0.43547106}
confusion matrix:
       0    1
0  17752  315
1    398  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703513, 'precision': 0.8556195, 'recall': 0.7252303, 'specificity': 0.7252303, 'f1': 0.77431744, 'auroc': 0.92240614, 'binary_precision': 0.7345679, 'binary_recall': 0.4576923, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.563981}
confusion matrix:
      0    1
0  5903   43
1   141  119
early stop counter: 5
val acc:0.9619530439376831, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9676119685173035 / 0.9708346724510193
after epoch: 23,now: 2024-07-11 02:47:33.291314,epoch time: 0:21:33.012669,used: 8:55:51.856893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98421663, 'precision': 0.9846486, 'recall': 0.9735201, 'specificity': 0.9735201, 'f1': 0.9789213, 'auroc': 0.9975153, 'binary_precision': 0.9854958, 'binary_recall': 0.951803, 'binary_specificity': 0.9952372, 'binary_f1_score': 0.96835643}
confusion matrix:
       0      1
0  42210    202
1    695  13725
---- Validation: 
scalar performance:
{'acc': 0.9625934, 'precision': 0.72727, 'recall': 0.69949996, 'specificity': 0.69949996, 'f1': 0.7123688, 'auroc': 0.9054117, 'binary_precision': 0.47619048, 'binary_recall': 0.41604754, 'binary_specificity': 0.98295236, 'binary_f1_score': 0.444092}
confusion matrix:
       0    1
0  17759  308
1    393  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9703513, 'precision': 0.85700667, 'recall': 0.7233913, 'specificity': 0.7233913, 'f1': 0.7732806, 'auroc': 0.9211493, 'binary_precision': 0.7375, 'binary_recall': 0.45384616, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.5619048}
confusion matrix:
      0    1
0  5904   42
1   142  118
early stop counter: 6
val acc:0.9625933766365051, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9676119685173035 / 0.9708346724510193
after epoch: 24,now: 2024-07-11 03:09:10.184128,epoch time: 0:21:36.892814,used: 9:17:28.749707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98574746, 'precision': 0.9852061, 'recall': 0.97701734, 'specificity': 0.97701734, 'f1': 0.9810233, 'auroc': 0.99698603, 'binary_precision': 0.9841349, 'binary_recall': 0.95929265, 'binary_specificity': 0.99474204, 'binary_f1_score': 0.971555}
confusion matrix:
       0      1
0  42189    223
1    587  13833
---- Validation: 
scalar performance:
{'acc': 0.96221983, 'precision': 0.72605866, 'recall': 0.7150421, 'specificity': 0.7150421, 'f1': 0.7203952, 'auroc': 0.90474254, 'binary_precision': 0.47261345, 'binary_recall': 0.448737, 'binary_specificity': 0.9813472, 'binary_f1_score': 0.46036583}
confusion matrix:
       0    1
0  17730  337
1    371  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9708347, 'precision': 0.85692054, 'recall': 0.7328385, 'specificity': 0.7328385, 'f1': 0.78050506, 'auroc': 0.917969, 'binary_precision': 0.73652697, 'binary_recall': 0.4730769, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.5761124}
confusion matrix:
      0    1
0  5902   44
1   137  123
early stop counter: 7
val acc:0.9622198343276978, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9676119685173035 / 0.9708346724510193
after epoch: 25,now: 2024-07-11 03:30:46.621010,epoch time: 0:21:36.436882,used: 9:39:05.186589,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98553634, 'precision': 0.98550147, 'recall': 0.9761636, 'specificity': 0.9761636, 'f1': 0.9807178, 'auroc': 0.9974365, 'binary_precision': 0.98543274, 'binary_recall': 0.9571369, 'binary_specificity': 0.99519026, 'binary_f1_score': 0.97107875}
confusion matrix:
       0      1
0  42210    204
1    618  13800
---- Validation: 
scalar performance:
{'acc': 0.9611526, 'precision': 0.71670157, 'recall': 0.69803745, 'specificity': 0.69803745, 'f1': 0.7068949, 'auroc': 0.90018034, 'binary_precision': 0.45513865, 'binary_recall': 0.41456166, 'binary_specificity': 0.98151326, 'binary_f1_score': 0.43390357}
confusion matrix:
       0    1
0  17733  334
1    394  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.81495965, 'recall': 0.7066612, 'specificity': 0.7066612, 'f1': 0.74833107, 'auroc': 0.9120424, 'binary_precision': 0.6547619, 'binary_recall': 0.42307693, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.51401865}
confusion matrix:
      0    1
0  5888   58
1   150  110
early stop counter: 8
val acc:0.9611526131629944, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9676119685173035 / 0.9708346724510193
after epoch: 26,now: 2024-07-11 03:52:35.799699,epoch time: 0:21:49.178689,used: 10:00:54.365278,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98574746, 'precision': 0.98625505, 'recall': 0.9759846, 'specificity': 0.9759846, 'f1': 0.98098147, 'auroc': 0.9973453, 'binary_precision': 0.98725295, 'binary_recall': 0.9561659, 'binary_specificity': 0.9958033, 'binary_f1_score': 0.97146076}
confusion matrix:
       0      1
0  42236    178
1    632  13786
---- Validation: 
scalar performance:
{'acc': 0.9629136, 'precision': 0.72744936, 'recall': 0.67391634, 'specificity': 0.67391634, 'f1': 0.6966815, 'auroc': 0.89877546, 'binary_precision': 0.47843137, 'binary_recall': 0.3625557, 'binary_specificity': 0.985277, 'binary_f1_score': 0.41251054}
confusion matrix:
       0    1
0  17801  266
1    429  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.8470518, 'recall': 0.66260964, 'specificity': 0.66260964, 'f1': 0.7183116, 'auroc': 0.91313034, 'binary_precision': 0.7226891, 'binary_recall': 0.33076924, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.45382586}
confusion matrix:
      0   1
0  5913  33
1   174  86
early stop counter: 9
val acc:0.9629135727882385, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9676119685173035 / 0.9708346724510193
after epoch: 27,now: 2024-07-11 04:14:25.341683,epoch time: 0:21:49.541984,used: 10:22:43.907262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98668003, 'precision': 0.98804927, 'recall': 0.9767039, 'specificity': 0.9767039, 'f1': 0.9822087, 'auroc': 0.9974215, 'binary_precision': 0.99073344, 'binary_recall': 0.9564494, 'binary_specificity': 0.99695843, 'binary_f1_score': 0.9732896}
confusion matrix:
       0      1
0  42283    129
1    628  13792
---- Validation: 
scalar performance:
{'acc': 0.9644077, 'precision': 0.74121404, 'recall': 0.6661081, 'specificity': 0.6661081, 'f1': 0.69595325, 'auroc': 0.9033752, 'binary_precision': 0.5065502, 'binary_recall': 0.3447251, 'binary_specificity': 0.987491, 'binary_f1_score': 0.4102564}
confusion matrix:
       0    1
0  17841  226
1    441  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9692233, 'precision': 0.86851066, 'recall': 0.6897009, 'specificity': 0.6897009, 'f1': 0.7478101, 'auroc': 0.9161782, 'binary_precision': 0.7633588, 'binary_recall': 0.3846154, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.511509}
confusion matrix:
      0    1
0  5915   31
1   160  100
early stop counter: 10
val acc:0.9644076824188232, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9676119685173035 / 0.9708346724510193
after epoch: 28,now: 2024-07-11 04:36:09.274951,epoch time: 0:21:43.933268,used: 10:44:27.840530,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9863985, 'precision': 0.98644006, 'recall': 0.9775195, 'specificity': 0.9775195, 'f1': 0.9818753, 'auroc': 0.9975562, 'binary_precision': 0.98652214, 'binary_recall': 0.95949507, 'binary_specificity': 0.9955439, 'binary_f1_score': 0.9728209}
confusion matrix:
       0      1
0  42225    189
1    584  13834
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.73651975, 'recall': 0.68085194, 'specificity': 0.68085194, 'f1': 0.7045372, 'auroc': 0.9045619, 'binary_precision': 0.49607843, 'binary_recall': 0.37592867, 'binary_specificity': 0.9857752, 'binary_f1_score': 0.4277261}
confusion matrix:
       0    1
0  17810  257
1    420  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693845, 'precision': 0.86222386, 'recall': 0.6989799, 'specificity': 0.6989799, 'f1': 0.7545912, 'auroc': 0.9176324, 'binary_precision': 0.75, 'binary_recall': 0.40384614, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.525}
confusion matrix:
      0    1
0  5911   35
1   155  105
early stop counter: 11
val acc:0.9638740420341492, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9676119685173035 / 0.9708346724510193
after epoch: 29,now: 2024-07-11 04:57:58.450279,epoch time: 0:21:49.175328,used: 11:06:17.015858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9871903, 'precision': 0.98775184, 'recall': 0.97832465, 'specificity': 0.97832465, 'f1': 0.9829221, 'auroc': 0.9981427, 'binary_precision': 0.98885876, 'binary_recall': 0.9603274, 'binary_specificity': 0.996322, 'binary_f1_score': 0.9743843}
confusion matrix:
       0      1
0  42258    156
1    572  13846
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.7327779, 'recall': 0.67493606, 'specificity': 0.67493606, 'f1': 0.6992683, 'auroc': 0.90580815, 'binary_precision': 0.48902196, 'binary_recall': 0.3640416, 'binary_specificity': 0.98583055, 'binary_f1_score': 0.4173765}
confusion matrix:
       0    1
0  17811  256
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9697067, 'precision': 0.8676629, 'recall': 0.69914806, 'specificity': 0.69914806, 'f1': 0.7559949, 'auroc': 0.9185087, 'binary_precision': 0.76086956, 'binary_recall': 0.40384614, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.5276382}
confusion matrix:
      0    1
0  5913   33
1   155  105
early stop counter: 12
val acc:0.9635005593299866, best validation acc: 0.9644610285758972, corresponding to test acc:                         0.9676119685173035 / 0.9708346724510193
after epoch: 30,now: 2024-07-11 05:19:42.843303,epoch time: 0:21:44.393024,used: 11:28:01.408882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_17_51_41_seed_1_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:28:01.408882 at 2024-07-11 05:19:42.843303
persisted model performance metric: 

scalar performance:
{'acc': 0.96761197, 'precision': 0.88417083, 'recall': 0.65024126, 'specificity': 0.65024126, 'f1': 0.7117175, 'auroc': 0.91422904, 'binary_precision': 0.7979798, 'binary_recall': 0.30384615, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.4401114}
confusion matrix:
      0   1
0  5926  20
1   181  79
oracle model performance metric: 

scalar performance:
{'acc': 0.9708347, 'precision': 0.84402704, 'recall': 0.7530674, 'specificity': 0.7530674, 'f1': 0.79087603, 'auroc': 0.9197689, 'binary_precision': 0.7089947, 'binary_recall': 0.5153846, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.596882}
confusion matrix:
      0    1
0  5891   55
1   126  134
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |  17479 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |  17479 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   7827 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   2320 TiB |   2320 TiB |
|       from small pool |  16480 KiB |     36 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  16790 MiB |   8278 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  16734 MiB |   8260 MiB |
|       from small pool |     38 MiB |     44 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38830 KiB | 732464 KiB |   1304 TiB |   1304 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1274 TiB |   1274 TiB |
|       from small pool |   7097 KiB |  23272 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7625    |  388811 K  |  388808 K  |
|       from large pool |      79    |     762    |  220130 K  |  220130 K  |
|       from small pool |    2875    |    7544    |  168680 K  |  168677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7625    |  388811 K  |  388808 K  |
|       from large pool |      79    |     762    |  220130 K  |  220130 K  |
|       from small pool |    2875    |    7544    |  168680 K  |  168677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |     715    |     347    |
|       from large pool |     349    |     349    |     687    |     338    |
|       from small pool |      19    |      22    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3589    |  230766 K  |  230766 K  |
|       from large pool |      11    |     352    |  159260 K  |  159260 K  |
|       from small pool |      25    |    3579    |   71506 K  |   71506 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     36 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16790 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     44 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1304 TiB |   1304 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1274 TiB |   1274 TiB |
|       from small pool |      0 KiB |  23272 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  388811 K  |  388811 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168680 K  |  168680 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  388811 K  |  388811 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168680 K  |  168680 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     715    |     693    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      22    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  230767 K  |  230767 K  |
|       from large pool |       3    |     352    |  159260 K  |  159260 K  |
|       from small pool |       0    |    3579    |   71507 K  |   71507 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     36 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16790 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     44 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1304 TiB |   1304 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1274 TiB |   1274 TiB |
|       from small pool |      0 KiB |  23272 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  388811 K  |  388811 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168680 K  |  168680 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  388811 K  |  388811 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168680 K  |  168680 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     715    |     693    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      22    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  230767 K  |  230767 K  |
|       from large pool |       3    |     352    |  159260 K  |  159260 K  |
|       from small pool |       0    |    3579    |   71507 K  |   71507 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620

 Experiment start at: 2024-07-11 05:38:38.238687
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9450557, 'precision': 0.9502263, 'recall': 0.9068437, 'specificity': 0.9068437, 'f1': 0.9257523, 'auroc': 0.9694885, 'binary_precision': 0.9596867, 'binary_recall': 0.8260956, 'binary_specificity': 0.98759186, 'binary_f1_score': 0.8878942}
confusion matrix:
       0      1
0  41786    525
1   2631  12498
---- Validation: 
scalar performance:
{'acc': 0.9560006, 'precision': 0.6144887, 'recall': 0.587793, 'specificity': 0.587793, 'f1': 0.5990579, 'auroc': 0.78829503, 'binary_precision': 0.2554585, 'binary_recall': 0.19435216, 'binary_specificity': 0.98123384, 'binary_f1_score': 0.22075471}
confusion matrix:
       0    1
0  17830  341
1    485  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93043756, 'precision': 0.524625, 'recall': 0.5236468, 'specificity': 0.5236468, 'f1': 0.52411675, 'auroc': 0.6536037, 'binary_precision': 0.0862069, 'binary_recall': 0.08264463, 'binary_specificity': 0.96464896, 'binary_f1_score': 0.08438818}
confusion matrix:
      0    1
0  5785  212
1   222   20
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 06:01:11.784617,epoch time: 0:22:33.545930,used: 0:22:33.545930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95934886, 'precision': 0.9652208, 'recall': 0.9296076, 'specificity': 0.9296076, 'f1': 0.9455997, 'auroc': 0.9815835, 'binary_precision': 0.9762525, 'binary_recall': 0.8667548, 'binary_specificity': 0.9924604, 'binary_f1_score': 0.9182508}
confusion matrix:
       0      1
0  41991    319
1   2016  13114
---- Validation: 
scalar performance:
{'acc': 0.9637245, 'precision': 0.65738535, 'recall': 0.5668884, 'specificity': 0.5668884, 'f1': 0.59154093, 'auroc': 0.81892073, 'binary_precision': 0.3426295, 'binary_recall': 0.14285715, 'binary_specificity': 0.9909196, 'binary_f1_score': 0.20164129}
confusion matrix:
       0    1
0  18006  165
1    516   86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9469466, 'precision': 0.55935246, 'recall': 0.53223443, 'specificity': 0.53223443, 'f1': 0.5402386, 'auroc': 0.74507844, 'binary_precision': 0.15503876, 'binary_recall': 0.08264463, 'binary_specificity': 0.9818242, 'binary_f1_score': 0.10781671}
confusion matrix:
      0    1
0  5888  109
1   222   20
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-11 06:23:11.128602,epoch time: 0:21:59.343985,used: 0:44:32.889915,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9643454, 'precision': 0.96916103, 'recall': 0.93860376, 'specificity': 0.93860376, 'f1': 0.9525529, 'auroc': 0.9861764, 'binary_precision': 0.9783531, 'binary_recall': 0.88420355, 'binary_specificity': 0.993004, 'binary_f1_score': 0.9288987}
confusion matrix:
       0      1
0  42014    296
1   1752  13378
---- Validation: 
scalar performance:
{'acc': 0.96590847, 'precision': 0.69827926, 'recall': 0.5832745, 'specificity': 0.5832745, 'f1': 0.61480916, 'auroc': 0.84087014, 'binary_precision': 0.4233871, 'binary_recall': 0.1744186, 'binary_specificity': 0.99213034, 'binary_f1_score': 0.24705881}
confusion matrix:
       0    1
0  18028  143
1    497  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501523, 'precision': 0.5944992, 'recall': 0.54976386, 'specificity': 0.54976386, 'f1': 0.5634547, 'auroc': 0.80260944, 'binary_precision': 0.224, 'binary_recall': 0.11570248, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.15258856}
confusion matrix:
      0   1
0  5900  97
1   214  28
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-11 06:45:13.172966,epoch time: 0:22:02.044364,used: 1:06:34.934279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9688022, 'precision': 0.97129196, 'recall': 0.9478674, 'specificity': 0.9478674, 'f1': 0.9587961, 'auroc': 0.98886096, 'binary_precision': 0.97615135, 'binary_recall': 0.90362877, 'binary_specificity': 0.9921061, 'binary_f1_score': 0.9384911}
confusion matrix:
       0      1
0  41977    334
1   1458  13671
---- Validation: 
scalar performance:
{'acc': 0.96548235, 'precision': 0.7049298, 'recall': 0.6207976, 'specificity': 0.6207976, 'f1': 0.6508099, 'auroc': 0.855685, 'binary_precision': 0.4342857, 'binary_recall': 0.25249168, 'binary_specificity': 0.9891035, 'binary_f1_score': 0.3193277}
confusion matrix:
       0    1
0  17973  198
1    450  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949992, 'precision': 0.64784527, 'recall': 0.62304187, 'specificity': 0.62304187, 'f1': 0.6340977, 'auroc': 0.8368578, 'binary_precision': 0.325, 'binary_recall': 0.26859504, 'binary_specificity': 0.97748876, 'binary_f1_score': 0.29411766}
confusion matrix:
      0    1
0  5862  135
1   177   65
early stop counter: 1
val acc:0.9654823541641235, best validation acc: 0.9659084677696228, corresponding to test acc:                         0.9501522779464722 / 0.9501522779464722
after epoch: 4,now: 2024-07-11 07:07:09.023846,epoch time: 0:21:55.850880,used: 1:28:30.785159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97233635, 'precision': 0.97272354, 'recall': 0.95553434, 'specificity': 0.95553434, 'f1': 0.96370506, 'auroc': 0.9906298, 'binary_precision': 0.97349465, 'binary_recall': 0.9200264, 'binary_specificity': 0.9910423, 'binary_f1_score': 0.94600564}
confusion matrix:
       0      1
0  41931    379
1   1210  13920
---- Validation: 
scalar performance:
{'acc': 0.96532255, 'precision': 0.7035229, 'recall': 0.6223211, 'specificity': 0.6223211, 'f1': 0.6516874, 'auroc': 0.8626797, 'binary_precision': 0.43137255, 'binary_recall': 0.25581396, 'binary_specificity': 0.98882836, 'binary_f1_score': 0.32116792}
confusion matrix:
       0    1
0  17968  203
1    448  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9475877, 'precision': 0.6465088, 'recall': 0.6436014, 'specificity': 0.6436014, 'f1': 0.6450377, 'auroc': 0.8547025, 'binary_precision': 0.3206751, 'binary_recall': 0.3140496, 'binary_specificity': 0.97315323, 'binary_f1_score': 0.31732777}
confusion matrix:
      0    1
0  5836  161
1   166   76
early stop counter: 2
val acc:0.9653225541114807, best validation acc: 0.9659084677696228, corresponding to test acc:                         0.9501522779464722 / 0.9501522779464722
after epoch: 5,now: 2024-07-11 07:29:06.518563,epoch time: 0:21:57.494717,used: 1:50:28.279876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9733461, 'precision': 0.9733867, 'recall': 0.95749116, 'specificity': 0.95749116, 'f1': 0.96507657, 'auroc': 0.9914396, 'binary_precision': 0.97346795, 'binary_recall': 0.92398703, 'binary_specificity': 0.9909952, 'binary_f1_score': 0.9480823}
confusion matrix:
       0      1
0  41930    381
1   1150  13979
---- Validation: 
scalar performance:
{'acc': 0.96526927, 'precision': 0.70155394, 'recall': 0.61747533, 'specificity': 0.61747533, 'f1': 0.64721054, 'auroc': 0.86399674, 'binary_precision': 0.42774567, 'binary_recall': 0.24584718, 'binary_specificity': 0.9891035, 'binary_f1_score': 0.31223628}
confusion matrix:
       0    1
0  17973  198
1    454  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9464658, 'precision': 0.6498244, 'recall': 0.6628452, 'specificity': 0.6628452, 'f1': 0.6560112, 'auroc': 0.86125845, 'binary_precision': 0.32575756, 'binary_recall': 0.3553719, 'binary_specificity': 0.9703185, 'binary_f1_score': 0.33992094}
confusion matrix:
      0    1
0  5819  178
1   156   86
early stop counter: 3
val acc:0.9652692675590515, best validation acc: 0.9659084677696228, corresponding to test acc:                         0.9501522779464722 / 0.9501522779464722
after epoch: 6,now: 2024-07-11 07:51:03.976739,epoch time: 0:21:57.458176,used: 2:12:25.738052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9745299, 'precision': 0.97518754, 'recall': 0.95880663, 'specificity': 0.95880663, 'f1': 0.9666143, 'auroc': 0.9924522, 'binary_precision': 0.9765009, 'binary_recall': 0.9255783, 'binary_specificity': 0.992035, 'binary_f1_score': 0.950358}
confusion matrix:
       0      1
0  41973    337
1   1126  14004
---- Validation: 
scalar performance:
{'acc': 0.96628135, 'precision': 0.7198065, 'recall': 0.65092313, 'specificity': 0.65092313, 'f1': 0.6782807, 'auroc': 0.8695299, 'binary_precision': 0.46210268, 'binary_recall': 0.3139535, 'binary_specificity': 0.9878928, 'binary_f1_score': 0.37388724}
confusion matrix:
       0    1
0  17951  220
1    413  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9435807, 'precision': 0.6499642, 'recall': 0.6910856, 'specificity': 0.6910856, 'f1': 0.6675503, 'auroc': 0.8693236, 'binary_precision': 0.32371795, 'binary_recall': 0.41735536, 'binary_specificity': 0.96481574, 'binary_f1_score': 0.36462092}
confusion matrix:
      0    1
0  5786  211
1   141  101
better model found
persisted
after epoch: 7,now: 2024-07-11 08:12:52.892213,epoch time: 0:21:48.915474,used: 2:34:14.653526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97820336, 'precision': 0.98030573, 'recall': 0.96333814, 'specificity': 0.96333814, 'f1': 0.9714173, 'auroc': 0.9933984, 'binary_precision': 0.9844994, 'binary_recall': 0.93192333, 'binary_specificity': 0.994753, 'binary_f1_score': 0.95749015}
confusion matrix:
       0      1
0  42088    222
1   1030  14100
---- Validation: 
scalar performance:
{'acc': 0.96708035, 'precision': 0.7267655, 'recall': 0.63366884, 'specificity': 0.63366884, 'f1': 0.66697615, 'auroc': 0.8725611, 'binary_precision': 0.47714287, 'binary_recall': 0.27740863, 'binary_specificity': 0.989929, 'binary_f1_score': 0.3508403}
confusion matrix:
       0    1
0  17988  183
1    435  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9472672, 'precision': 0.6476276, 'recall': 0.6493829, 'specificity': 0.6493829, 'f1': 0.6484991, 'auroc': 0.8705468, 'binary_precision': 0.32244897, 'binary_recall': 0.3264463, 'binary_specificity': 0.9723195, 'binary_f1_score': 0.32443532}
confusion matrix:
      0    1
0  5831  166
1   163   79
better model found
persisted
after epoch: 8,now: 2024-07-11 08:34:45.187428,epoch time: 0:21:52.295215,used: 2:56:06.948741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9784123, 'precision': 0.97999483, 'recall': 0.9641572, 'specificity': 0.9641572, 'f1': 0.97172266, 'auroc': 0.99447274, 'binary_precision': 0.9831629, 'binary_recall': 0.934034, 'binary_specificity': 0.99428046, 'binary_f1_score': 0.95796895}
confusion matrix:
       0      1
0  42069    242
1    998  14131
---- Validation: 
scalar performance:
{'acc': 0.9665477, 'precision': 0.7230856, 'recall': 0.6542729, 'specificity': 0.6542729, 'f1': 0.6817401, 'auroc': 0.8759219, 'binary_precision': 0.4684466, 'binary_recall': 0.320598, 'binary_specificity': 0.9879478, 'binary_f1_score': 0.3806706}
confusion matrix:
       0    1
0  17952  219
1    409  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94566435, 'precision': 0.6576467, 'recall': 0.6941522, 'specificity': 0.6941522, 'f1': 0.6736434, 'auroc': 0.87296474, 'binary_precision': 0.33887044, 'binary_recall': 0.4214876, 'binary_specificity': 0.9668167, 'binary_f1_score': 0.3756906}
confusion matrix:
      0    1
0  5798  199
1   140  102
early stop counter: 1
val acc:0.9665477275848389, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9472671747207642 / 0.9501522779464722
after epoch: 9,now: 2024-07-11 08:56:43.586752,epoch time: 0:21:58.399324,used: 3:18:05.348065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97836006, 'precision': 0.98016244, 'recall': 0.96386695, 'specificity': 0.96386695, 'f1': 0.97164106, 'auroc': 0.9946743, 'binary_precision': 0.9837653, 'binary_recall': 0.9332408, 'binary_specificity': 0.9944932, 'binary_f1_score': 0.9578372}
confusion matrix:
       0      1
0  42078    233
1   1010  14119
---- Validation: 
scalar performance:
{'acc': 0.9655356, 'precision': 0.71510077, 'recall': 0.6674019, 'specificity': 0.6674019, 'f1': 0.6879453, 'auroc': 0.8783424, 'binary_precision': 0.4516129, 'binary_recall': 0.3488372, 'binary_specificity': 0.9859666, 'binary_f1_score': 0.39362696}
confusion matrix:
       0    1
0  17916  255
1    392  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9397339, 'precision': 0.6494639, 'recall': 0.7247739, 'specificity': 0.7247739, 'f1': 0.67796487, 'auroc': 0.87376195, 'binary_precision': 0.31989247, 'binary_recall': 0.49173555, 'binary_specificity': 0.95781225, 'binary_f1_score': 0.38762218}
confusion matrix:
      0    1
0  5744  253
1   123  119
early stop counter: 2
val acc:0.965535581111908, best validation acc: 0.9670803546905518, corresponding to test acc:                         0.9472671747207642 / 0.9501522779464722
after epoch: 10,now: 2024-07-11 09:18:49.548946,epoch time: 0:22:05.962194,used: 3:40:11.310259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97914344, 'precision': 0.98202163, 'recall': 0.9641249, 'specificity': 0.9641249, 'f1': 0.97262573, 'auroc': 0.99479896, 'binary_precision': 0.98774683, 'binary_recall': 0.932386, 'binary_specificity': 0.99586385, 'binary_f1_score': 0.95926833}
confusion matrix:
       0      1
0  42135    175
1   1023  14107
---- Validation: 
scalar performance:
{'acc': 0.9675598, 'precision': 0.7340241, 'recall': 0.64837134, 'specificity': 0.64837134, 'f1': 0.6806412, 'auroc': 0.882409, 'binary_precision': 0.4907162, 'binary_recall': 0.30730897, 'binary_specificity': 0.9894337, 'binary_f1_score': 0.37793672}
confusion matrix:
       0    1
0  17979  192
1    417  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95095366, 'precision': 0.67529875, 'recall': 0.6850071, 'specificity': 0.6850071, 'f1': 0.6799998, 'auroc': 0.8771955, 'binary_precision': 0.375, 'binary_recall': 0.3966942, 'binary_specificity': 0.97332, 'binary_f1_score': 0.38554218}
confusion matrix:
      0    1
0  5837  160
1   146   96
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-11 09:41:09.852587,epoch time: 0:22:20.303641,used: 4:02:31.613900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9813893, 'precision': 0.98153645, 'recall': 0.97029525, 'specificity': 0.97029525, 'f1': 0.97573745, 'auroc': 0.9957466, 'binary_precision': 0.9818356, 'binary_recall': 0.9468535, 'binary_specificity': 0.993737, 'binary_f1_score': 0.9640273}
confusion matrix:
       0      1
0  42047    265
1    804  14324
---- Validation: 
scalar performance:
{'acc': 0.96548235, 'precision': 0.71788627, 'recall': 0.6890567, 'specificity': 0.6890567, 'f1': 0.7023347, 'auroc': 0.8829143, 'binary_precision': 0.45576924, 'binary_recall': 0.3936877, 'binary_specificity': 0.9844257, 'binary_f1_score': 0.4224599}
confusion matrix:
       0    1
0  17888  283
1    365  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93781054, 'precision': 0.6478163, 'recall': 0.73566985, 'specificity': 0.73566985, 'f1': 0.6795396, 'auroc': 0.8739275, 'binary_precision': 0.31565657, 'binary_recall': 0.5165289, 'binary_specificity': 0.95481074, 'binary_f1_score': 0.39184952}
confusion matrix:
      0    1
0  5726  271
1   117  125
early stop counter: 1
val acc:0.9654823541641235, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 12,now: 2024-07-11 10:03:27.659922,epoch time: 0:22:17.807335,used: 4:24:49.421235,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98172003, 'precision': 0.9812265, 'recall': 0.97145724, 'specificity': 0.97145724, 'f1': 0.9762067, 'auroc': 0.9955301, 'binary_precision': 0.9802183, 'binary_recall': 0.94976866, 'binary_specificity': 0.9931458, 'binary_f1_score': 0.96475327}
confusion matrix:
       0      1
0  42020    290
1    760  14370
---- Validation: 
scalar performance:
{'acc': 0.9620199, 'precision': 0.6980552, 'recall': 0.7129657, 'specificity': 0.7129657, 'f1': 0.7052057, 'auroc': 0.88825357, 'binary_precision': 0.41448382, 'binary_recall': 0.44684386, 'binary_specificity': 0.97908753, 'binary_f1_score': 0.43005595}
confusion matrix:
       0    1
0  17791  380
1    333  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9265908, 'precision': 0.6306639, 'recall': 0.75362647, 'specificity': 0.75362647, 'f1': 0.66766244, 'auroc': 0.875765, 'binary_precision': 0.27959183, 'binary_recall': 0.5661157, 'binary_specificity': 0.94113725, 'binary_f1_score': 0.3743169}
confusion matrix:
      0    1
0  5644  353
1   105  137
early stop counter: 2
val acc:0.9620199203491211, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 13,now: 2024-07-11 10:25:36.180682,epoch time: 0:22:08.520760,used: 4:46:57.941995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98227715, 'precision': 0.9828509, 'recall': 0.97130305, 'specificity': 0.97130305, 'f1': 0.9768894, 'auroc': 0.99598813, 'binary_precision': 0.98401594, 'binary_recall': 0.9481129, 'binary_specificity': 0.9944932, 'binary_f1_score': 0.9657308}
confusion matrix:
       0      1
0  42078    233
1    785  14344
---- Validation: 
scalar performance:
{'acc': 0.96692055, 'precision': 0.7297803, 'recall': 0.68257225, 'specificity': 0.68257225, 'f1': 0.7031851, 'auroc': 0.88637793, 'binary_precision': 0.48, 'binary_recall': 0.37873754, 'binary_specificity': 0.9864069, 'binary_f1_score': 0.42339832}
confusion matrix:
       0    1
0  17924  247
1    374  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9429396, 'precision': 0.65637934, 'recall': 0.7185104, 'specificity': 0.7185104, 'f1': 0.6812777, 'auroc': 0.8730433, 'binary_precision': 0.33430234, 'binary_recall': 0.4752066, 'binary_specificity': 0.9618142, 'binary_f1_score': 0.3924915}
confusion matrix:
      0    1
0  5768  229
1   127  115
early stop counter: 3
val acc:0.9669205546379089, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 14,now: 2024-07-11 10:47:39.963140,epoch time: 0:22:03.782458,used: 5:09:01.724453,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9825035, 'precision': 0.9830731, 'recall': 0.9716706, 'specificity': 0.9716706, 'f1': 0.977189, 'auroc': 0.9965582, 'binary_precision': 0.9842304, 'binary_recall': 0.94877726, 'binary_specificity': 0.99456394, 'binary_f1_score': 0.96617866}
confusion matrix:
       0      1
0  42080    230
1    775  14355
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.72542936, 'recall': 0.6879184, 'specificity': 0.6879184, 'f1': 0.70478547, 'auroc': 0.88905776, 'binary_precision': 0.47094187, 'binary_recall': 0.39036545, 'binary_specificity': 0.98547137, 'binary_f1_score': 0.42688465}
confusion matrix:
       0    1
0  17907  264
1    367  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9398942, 'precision': 0.64700663, 'recall': 0.7149435, 'specificity': 0.7149435, 'f1': 0.6732652, 'auroc': 0.8701066, 'binary_precision': 0.31578946, 'binary_recall': 0.47107437, 'binary_specificity': 0.9588127, 'binary_f1_score': 0.37810946}
confusion matrix:
      0    1
0  5750  247
1   128  114
early stop counter: 4
val acc:0.9663878679275513, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 15,now: 2024-07-11 11:10:04.933640,epoch time: 0:22:24.970500,used: 5:31:26.694953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9827472, 'precision': 0.9827831, 'recall': 0.9725791, 'specificity': 0.9725791, 'f1': 0.97753435, 'auroc': 0.99666035, 'binary_precision': 0.98285633, 'binary_recall': 0.9510906, 'binary_specificity': 0.9940676, 'binary_f1_score': 0.9667126}
confusion matrix:
       0      1
0  42059    251
1    740  14390
---- Validation: 
scalar performance:
{'acc': 0.96665424, 'precision': 0.7289752, 'recall': 0.7009048, 'specificity': 0.7009048, 'f1': 0.71392304, 'auroc': 0.8926561, 'binary_precision': 0.47718632, 'binary_recall': 0.41694352, 'binary_specificity': 0.984866, 'binary_f1_score': 0.44503543}
confusion matrix:
       0    1
0  17896  275
1    351  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9397339, 'precision': 0.6488955, 'recall': 0.72279114, 'specificity': 0.72279114, 'f1': 0.67696685, 'auroc': 0.87305355, 'binary_precision': 0.3189189, 'binary_recall': 0.4876033, 'binary_specificity': 0.95797896, 'binary_f1_score': 0.3856209}
confusion matrix:
      0    1
0  5745  252
1   124  118
early stop counter: 5
val acc:0.9666542410850525, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 16,now: 2024-07-11 11:32:22.228051,epoch time: 0:22:17.294411,used: 5:53:43.989364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9838266, 'precision': 0.98368293, 'recall': 0.9744793, 'specificity': 0.9744793, 'f1': 0.9789618, 'auroc': 0.9966668, 'binary_precision': 0.9833889, 'binary_recall': 0.9547257, 'binary_specificity': 0.994233, 'binary_f1_score': 0.9688453}
confusion matrix:
       0      1
0  42066    244
1    685  14445
---- Validation: 
scalar performance:
{'acc': 0.9615938, 'precision': 0.6961788, 'recall': 0.71595776, 'specificity': 0.71595776, 'f1': 0.7055327, 'auroc': 0.8927069, 'binary_precision': 0.4105263, 'binary_recall': 0.45348838, 'binary_specificity': 0.9784272, 'binary_f1_score': 0.43093923}
confusion matrix:
       0    1
0  17779  392
1    329  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9203398, 'precision': 0.61699307, 'recall': 0.7384784, 'specificity': 0.7384784, 'f1': 0.6513907, 'auroc': 0.8717823, 'binary_precision': 0.25338492, 'binary_recall': 0.5413223, 'binary_specificity': 0.9356345, 'binary_f1_score': 0.34519106}
confusion matrix:
      0    1
0  5611  386
1   111  131
early stop counter: 6
val acc:0.9615938067436218, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 17,now: 2024-07-11 11:54:36.637712,epoch time: 0:22:14.409661,used: 6:15:58.399025,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9847319, 'precision': 0.9851328, 'recall': 0.9753897, 'specificity': 0.9753897, 'f1': 0.98012817, 'auroc': 0.9972948, 'binary_precision': 0.985952, 'binary_recall': 0.95564806, 'binary_specificity': 0.9951313, 'binary_f1_score': 0.97056353}
confusion matrix:
       0      1
0  42105    206
1    671  14458
---- Validation: 
scalar performance:
{'acc': 0.9632451, 'precision': 0.7054021, 'recall': 0.7119925, 'specificity': 0.7119925, 'f1': 0.7086389, 'auroc': 0.89336056, 'binary_precision': 0.42926046, 'binary_recall': 0.4435216, 'binary_specificity': 0.9804634, 'binary_f1_score': 0.4362745}
confusion matrix:
       0    1
0  17816  355
1    335  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9294759, 'precision': 0.6327876, 'recall': 0.74323076, 'specificity': 0.74323076, 'f1': 0.6679276, 'auroc': 0.8710058, 'binary_precision': 0.28478262, 'binary_recall': 0.5413223, 'binary_specificity': 0.9451392, 'binary_f1_score': 0.37321937}
confusion matrix:
      0    1
0  5668  329
1   111  131
early stop counter: 7
val acc:0.9632450938224792, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 18,now: 2024-07-11 12:16:56.098024,epoch time: 0:22:19.460312,used: 6:38:17.859337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9843141, 'precision': 0.98667467, 'recall': 0.9728571, 'specificity': 0.9728571, 'f1': 0.979501, 'auroc': 0.9966618, 'binary_precision': 0.9914347, 'binary_recall': 0.94864506, 'binary_specificity': 0.99706924, 'binary_f1_score': 0.969568}
confusion matrix:
       0      1
0  42186    124
1    777  14353
---- Validation: 
scalar performance:
{'acc': 0.9646833, 'precision': 0.7144689, 'recall': 0.70791715, 'specificity': 0.70791715, 'f1': 0.7111362, 'auroc': 0.8959688, 'binary_precision': 0.44768438, 'binary_recall': 0.43355483, 'binary_specificity': 0.9822795, 'binary_f1_score': 0.44050634}
confusion matrix:
       0    1
0  17849  322
1    341  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9368489, 'precision': 0.64320254, 'recall': 0.72723866, 'specificity': 0.72723866, 'f1': 0.6736159, 'auroc': 0.8719146, 'binary_precision': 0.30710658, 'binary_recall': 0.5, 'binary_specificity': 0.95447725, 'binary_f1_score': 0.38050312}
confusion matrix:
      0    1
0  5724  273
1   121  121
early stop counter: 8
val acc:0.9646832942962646, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 19,now: 2024-07-11 12:39:14.854697,epoch time: 0:22:18.756673,used: 7:00:36.616010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98464483, 'precision': 0.9826903, 'recall': 0.9776024, 'specificity': 0.9776024, 'f1': 0.9801096, 'auroc': 0.99699295, 'binary_precision': 0.97863334, 'binary_recall': 0.96272063, 'binary_specificity': 0.9924842, 'binary_f1_score': 0.97061175}
confusion matrix:
       0      1
0  41993    318
1    564  14565
---- Validation: 
scalar performance:
{'acc': 0.963831, 'precision': 0.7076658, 'recall': 0.7026586, 'specificity': 0.7026586, 'f1': 0.70512795, 'auroc': 0.8953124, 'binary_precision': 0.43441227, 'binary_recall': 0.42358804, 'binary_specificity': 0.98172915, 'binary_f1_score': 0.4289319}
confusion matrix:
       0    1
0  17839  332
1    347  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9342843, 'precision': 0.6365975, 'recall': 0.7239219, 'specificity': 0.7239219, 'f1': 0.66728365, 'auroc': 0.87013614, 'binary_precision': 0.29411766, 'binary_recall': 0.49586776, 'binary_specificity': 0.951976, 'binary_f1_score': 0.36923078}
confusion matrix:
      0    1
0  5709  288
1   122  120
early stop counter: 9
val acc:0.9638310074806213, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 20,now: 2024-07-11 13:01:24.956730,epoch time: 0:22:10.102033,used: 7:22:46.718043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98537606, 'precision': 0.98705363, 'recall': 0.97519, 'specificity': 0.97519, 'f1': 0.98092616, 'auroc': 0.9969919, 'binary_precision': 0.9904579, 'binary_recall': 0.95366514, 'binary_specificity': 0.99671483, 'binary_f1_score': 0.97171336}
confusion matrix:
       0      1
0  42172    139
1    701  14428
---- Validation: 
scalar performance:
{'acc': 0.96660095, 'precision': 0.7274114, 'recall': 0.6888315, 'specificity': 0.6888315, 'f1': 0.70613915, 'auroc': 0.89848053, 'binary_precision': 0.4748491, 'binary_recall': 0.39202657, 'binary_specificity': 0.9856365, 'binary_f1_score': 0.42948136}
confusion matrix:
       0    1
0  17910  261
1    366  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9483892, 'precision': 0.6716925, 'recall': 0.7094487, 'specificity': 0.7094487, 'f1': 0.6883655, 'auroc': 0.8740198, 'binary_precision': 0.3657718, 'binary_recall': 0.45041323, 'binary_specificity': 0.9684842, 'binary_f1_score': 0.40370372}
confusion matrix:
      0    1
0  5808  189
1   133  109
early stop counter: 10
val acc:0.9666009545326233, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 21,now: 2024-07-11 13:25:18.844787,epoch time: 0:23:53.888057,used: 7:46:40.606100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9861943, 'precision': 0.9867929, 'recall': 0.9775302, 'specificity': 0.9775302, 'f1': 0.9820417, 'auroc': 0.9973743, 'binary_precision': 0.9880183, 'binary_recall': 0.9592201, 'binary_specificity': 0.99584025, 'binary_f1_score': 0.97340626}
confusion matrix:
       0      1
0  42134    176
1    617  14513
---- Validation: 
scalar performance:
{'acc': 0.9637778, 'precision': 0.71116257, 'recall': 0.7267225, 'specificity': 0.7267225, 'f1': 0.7186326, 'auroc': 0.9011265, 'binary_precision': 0.4398148, 'binary_recall': 0.47342193, 'binary_specificity': 0.9800231, 'binary_f1_score': 0.456}
confusion matrix:
       0    1
0  17808  363
1    317  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93412405, 'precision': 0.6418766, 'recall': 0.74366593, 'specificity': 0.74366593, 'f1': 0.67633575, 'auroc': 0.87288946, 'binary_precision': 0.3030303, 'binary_recall': 0.5371901, 'binary_specificity': 0.9501417, 'binary_f1_score': 0.38748136}
confusion matrix:
      0    1
0  5698  299
1   112  130
early stop counter: 11
val acc:0.9637777805328369, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 22,now: 2024-07-11 13:49:37.191820,epoch time: 0:24:18.347033,used: 8:10:58.953133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9858113, 'precision': 0.9873266, 'recall': 0.9760389, 'specificity': 0.9760389, 'f1': 0.98150563, 'auroc': 0.99747634, 'binary_precision': 0.99040765, 'binary_recall': 0.95538664, 'binary_specificity': 0.9966911, 'binary_f1_score': 0.972582}
confusion matrix:
       0      1
0  42170    140
1    675  14455
---- Validation: 
scalar performance:
{'acc': 0.9625526, 'precision': 0.7044348, 'recall': 0.7309079, 'specificity': 0.7309079, 'f1': 0.7167655, 'auroc': 0.9004946, 'binary_precision': 0.42606148, 'binary_recall': 0.4833887, 'binary_specificity': 0.9784272, 'binary_f1_score': 0.45291826}
confusion matrix:
       0    1
0  17779  392
1    311  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9291553, 'precision': 0.6321678, 'recall': 0.74306405, 'specificity': 0.74306405, 'f1': 0.66730934, 'auroc': 0.87278694, 'binary_precision': 0.2835498, 'binary_recall': 0.5413223, 'binary_specificity': 0.94480574, 'binary_f1_score': 0.3721591}
confusion matrix:
      0    1
0  5666  331
1   111  131
early stop counter: 12
val acc:0.9625526070594788, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 23,now: 2024-07-11 14:16:27.412013,epoch time: 0:26:50.220193,used: 8:37:49.173326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9858461, 'precision': 0.98655427, 'recall': 0.9768692, 'specificity': 0.9768692, 'f1': 0.98158073, 'auroc': 0.99735177, 'binary_precision': 0.9880019, 'binary_recall': 0.9578982, 'binary_specificity': 0.99584025, 'binary_f1_score': 0.97271717}
confusion matrix:
       0      1
0  42134    176
1    637  14493
---- Validation: 
scalar performance:
{'acc': 0.9642039, 'precision': 0.7136901, 'recall': 0.72533655, 'specificity': 0.72533655, 'f1': 0.7193403, 'auroc': 0.90329057, 'binary_precision': 0.44496855, 'binary_recall': 0.47009966, 'binary_specificity': 0.9805734, 'binary_f1_score': 0.45718902}
confusion matrix:
       0    1
0  17818  353
1    319  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9403751, 'precision': 0.6560645, 'recall': 0.74295205, 'specificity': 0.74295205, 'f1': 0.68812543, 'auroc': 0.87328446, 'binary_precision': 0.3316062, 'binary_recall': 0.5289256, 'binary_specificity': 0.9569785, 'binary_f1_score': 0.4076433}
confusion matrix:
      0    1
0  5739  258
1   114  128
early stop counter: 13
val acc:0.9642038941383362, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 24,now: 2024-07-11 14:41:46.311193,epoch time: 0:25:18.899180,used: 9:03:08.072506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98664695, 'precision': 0.9878279, 'recall': 0.9776888, 'specificity': 0.9776888, 'f1': 0.98261535, 'auroc': 0.99746317, 'binary_precision': 0.99023825, 'binary_recall': 0.95875746, 'binary_specificity': 0.9966202, 'binary_f1_score': 0.9742436}
confusion matrix:
       0      1
0  42167    143
1    624  14506
---- Validation: 
scalar performance:
{'acc': 0.963831, 'precision': 0.71102405, 'recall': 0.72353786, 'specificity': 0.72353786, 'f1': 0.717079, 'auroc': 0.90349436, 'binary_precision': 0.4397496, 'binary_recall': 0.4667774, 'binary_specificity': 0.9802983, 'binary_f1_score': 0.45286056}
confusion matrix:
       0    1
0  17813  358
1    321  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9379708, 'precision': 0.649302, 'recall': 0.7397187, 'specificity': 0.7397187, 'f1': 0.6817808, 'auroc': 0.8727181, 'binary_precision': 0.31829575, 'binary_recall': 0.5247934, 'binary_specificity': 0.95464396, 'binary_f1_score': 0.39625585}
confusion matrix:
      0    1
0  5725  272
1   115  127
early stop counter: 14
val acc:0.9638310074806213, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 25,now: 2024-07-11 15:06:24.336155,epoch time: 0:24:38.024962,used: 9:27:46.097468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.985968, 'precision': 0.98707795, 'recall': 0.976676, 'specificity': 0.976676, 'f1': 0.9817262, 'auroc': 0.9973576, 'binary_precision': 0.9893414, 'binary_recall': 0.957039, 'binary_specificity': 0.9963129, 'binary_f1_score': 0.97292215}
confusion matrix:
       0      1
0  42154    156
1    650  14480
---- Validation: 
scalar performance:
{'acc': 0.9626059, 'precision': 0.7080405, 'recall': 0.7518147, 'specificity': 0.7518147, 'f1': 0.727582, 'auroc': 0.906188, 'binary_precision': 0.43188012, 'binary_recall': 0.52657807, 'binary_specificity': 0.9770513, 'binary_f1_score': 0.4745509}
confusion matrix:
       0    1
0  17754  417
1    285  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9346049, 'precision': 0.6455971, 'recall': 0.7538297, 'specificity': 0.7538297, 'f1': 0.6818269, 'auroc': 0.8743614, 'binary_precision': 0.30963302, 'binary_recall': 0.55785125, 'binary_specificity': 0.94980824, 'binary_f1_score': 0.39823008}
confusion matrix:
      0    1
0  5696  301
1   107  135
early stop counter: 15
val acc:0.962605893611908, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 26,now: 2024-07-11 15:30:16.419521,epoch time: 0:23:52.083366,used: 9:51:38.180834,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98643804, 'precision': 0.9873545, 'recall': 0.9776107, 'specificity': 0.9776107, 'f1': 0.98235035, 'auroc': 0.9975567, 'binary_precision': 0.98922753, 'binary_recall': 0.9589557, 'binary_specificity': 0.99626565, 'binary_f1_score': 0.9738564}
confusion matrix:
       0      1
0  42152    158
1    621  14509
---- Validation: 
scalar performance:
{'acc': 0.9624993, 'precision': 0.70932674, 'recall': 0.76460844, 'specificity': 0.76460844, 'f1': 0.7333355, 'auroc': 0.90934813, 'binary_precision': 0.43359375, 'binary_recall': 0.55315614, 'binary_specificity': 0.97606075, 'binary_f1_score': 0.48613137}
confusion matrix:
       0    1
0  17736  435
1    269  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93781054, 'precision': 0.6545678, 'recall': 0.76144546, 'specificity': 0.76144546, 'f1': 0.69141006, 'auroc': 0.87708664, 'binary_precision': 0.3270142, 'binary_recall': 0.57024795, 'binary_specificity': 0.952643, 'binary_f1_score': 0.41566265}
confusion matrix:
      0    1
0  5713  284
1   104  138
early stop counter: 16
val acc:0.9624993205070496, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 27,now: 2024-07-11 15:53:30.278937,epoch time: 0:23:13.859416,used: 10:14:52.040250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9882138, 'precision': 0.98722196, 'recall': 0.982318, 'specificity': 0.982318, 'f1': 0.9847362, 'auroc': 0.9976661, 'binary_precision': 0.9851618, 'binary_recall': 0.9698592, 'binary_specificity': 0.9947768, 'binary_f1_score': 0.9774506}
confusion matrix:
       0      1
0  42090    221
1    456  14673
---- Validation: 
scalar performance:
{'acc': 0.9547222, 'precision': 0.6788342, 'recall': 0.78066725, 'specificity': 0.78066725, 'f1': 0.7167958, 'auroc': 0.90549165, 'binary_precision': 0.3713693, 'binary_recall': 0.59468436, 'binary_specificity': 0.9666501, 'binary_f1_score': 0.45721585}
confusion matrix:
       0    1
0  17565  606
1    244  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9086392, 'precision': 0.6117293, 'recall': 0.7720468, 'specificity': 0.7720468, 'f1': 0.6486089, 'auroc': 0.8729385, 'binary_precision': 0.23968254, 'binary_recall': 0.62396693, 'binary_specificity': 0.92012674, 'binary_f1_score': 0.34633029}
confusion matrix:
      0    1
0  5518  479
1    91  151
early stop counter: 17
val acc:0.9547222256660461, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 28,now: 2024-07-11 16:19:17.174217,epoch time: 0:25:46.895280,used: 10:40:38.935530,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9872737, 'precision': 0.98642, 'recall': 0.98068297, 'specificity': 0.98068297, 'f1': 0.98350525, 'auroc': 0.9976214, 'binary_precision': 0.9846516, 'binary_recall': 0.9667548, 'binary_specificity': 0.9946112, 'binary_f1_score': 0.9756211}
confusion matrix:
       0      1
0  42082    228
1    503  14627
---- Validation: 
scalar performance:
{'acc': 0.9567997, 'precision': 0.6822773, 'recall': 0.75925505, 'specificity': 0.75925505, 'f1': 0.7130967, 'auroc': 0.9052836, 'binary_precision': 0.37974682, 'binary_recall': 0.5481728, 'binary_specificity': 0.97033733, 'binary_f1_score': 0.44867435}
confusion matrix:
       0    1
0  17632  539
1    272  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91440934, 'precision': 0.61390793, 'recall': 0.75522095, 'specificity': 0.75522095, 'f1': 0.64989924, 'auroc': 0.8657731, 'binary_precision': 0.2456446, 'binary_recall': 0.58264464, 'binary_specificity': 0.92779726, 'binary_f1_score': 0.3455882}
confusion matrix:
      0    1
0  5564  433
1   101  141
early stop counter: 18
val acc:0.9567996859550476, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 29,now: 2024-07-11 17:05:06.114501,epoch time: 0:45:48.940284,used: 11:26:27.875814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98763925, 'precision': 0.9883504, 'recall': 0.9797199, 'specificity': 0.9797199, 'f1': 0.98393154, 'auroc': 0.99754083, 'binary_precision': 0.9898091, 'binary_recall': 0.962985, 'binary_specificity': 0.99645483, 'binary_f1_score': 0.9762128}
confusion matrix:
       0      1
0  42161    150
1    560  14569
---- Validation: 
scalar performance:
{'acc': 0.9624461, 'precision': 0.70514554, 'recall': 0.7388834, 'specificity': 0.7388834, 'f1': 0.7205713, 'auroc': 0.9086745, 'binary_precision': 0.42695037, 'binary_recall': 0.5, 'binary_specificity': 0.97776675, 'binary_f1_score': 0.4605968}
confusion matrix:
       0    1
0  17767  404
1    301  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9379708, 'precision': 0.6519352, 'recall': 0.74963236, 'specificity': 0.74963236, 'f1': 0.6864041, 'auroc': 0.87231857, 'binary_precision': 0.32273838, 'binary_recall': 0.54545456, 'binary_specificity': 0.9538102, 'binary_f1_score': 0.40552995}
confusion matrix:
      0    1
0  5720  277
1   110  132
early stop counter: 19
val acc:0.9624460935592651, best validation acc: 0.967559814453125, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 30,now: 2024-07-11 17:55:55.653139,epoch time: 0:50:49.538638,used: 12:17:17.414452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_38_38_seed_2_21806620
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:17:17.414452 at 2024-07-11 17:55:55.653139
persisted model performance metric: 

scalar performance:
{'acc': 0.95095366, 'precision': 0.67529875, 'recall': 0.6850071, 'specificity': 0.6850071, 'f1': 0.6799998, 'auroc': 0.8771955, 'binary_precision': 0.375, 'binary_recall': 0.3966942, 'binary_specificity': 0.97332, 'binary_f1_score': 0.38554218}
confusion matrix:
      0    1
0  5837  160
1   146   96
oracle model performance metric: 

scalar performance:
{'acc': 0.95095366, 'precision': 0.67529875, 'recall': 0.6850071, 'specificity': 0.6850071, 'f1': 0.6799998, 'auroc': 0.8771955, 'binary_precision': 0.375, 'binary_recall': 0.3966942, 'binary_specificity': 0.97332, 'binary_f1_score': 0.38554218}
confusion matrix:
      0    1
0  5837  160
1   146   96
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |  17485 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |  17485 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   7827 MiB |   3528 TiB |   3528 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   3483 TiB |   3483 TiB |
|       from small pool |  16481 KiB |     36 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  25072 MiB |  16560 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25002 MiB |  16528 MiB |
|       from small pool |     38 MiB |     44 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38824 KiB | 732464 KiB |   1951 TiB |   1951 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1906 TiB |   1906 TiB |
|       from small pool |   7091 KiB |  23272 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7675    |  583985 K  |  583982 K  |
|       from large pool |      79    |     762    |  330548 K  |  330548 K  |
|       from small pool |    2887    |    7594    |  253437 K  |  253434 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7675    |  583985 K  |  583982 K  |
|       from large pool |      79    |     762    |  330548 K  |  330548 K  |
|       from small pool |    2887    |    7594    |  253437 K  |  253434 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |    1061    |     693    |
|       from large pool |     349    |     349    |    1026    |     677    |
|       from small pool |      19    |      22    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3612    |  341895 K  |  341895 K  |
|       from large pool |      11    |     352    |  233946 K  |  233946 K  |
|       from small pool |      22    |    3602    |  107949 K  |  107949 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |      0 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |      0 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   3528 TiB |   3528 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   3483 TiB |   3483 TiB |
|       from small pool |      0 KiB |     36 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  25072 MiB |  24842 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25002 MiB |  24796 MiB |
|       from small pool |  24576 KiB |     44 MiB |     70 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1951 TiB |   1951 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1906 TiB |   1906 TiB |
|       from small pool |      0 KiB |  23272 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7675    |  583985 K  |  583985 K  |
|       from large pool |       2    |     762    |  330548 K  |  330548 K  |
|       from small pool |       0    |    7594    |  253437 K  |  253437 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7675    |  583985 K  |  583985 K  |
|       from large pool |       2    |     762    |  330548 K  |  330548 K  |
|       from small pool |       0    |    7594    |  253437 K  |  253437 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |    1061    |    1039    |
|       from large pool |      10    |     349    |    1026    |    1016    |
|       from small pool |      12    |      22    |      35    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |  341897 K  |  341897 K  |
|       from large pool |       3    |     352    |  233946 K  |  233946 K  |
|       from small pool |       0    |    3602    |  107951 K  |  107951 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Jul 11 18:28:46 2024]
Finished job 0.
1 of 1 steps (100%) done
