Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 10 01:35:44 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614

 Experiment start at: 2024-07-10 01:41:32.509756
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9383415, 'precision': 0.95858574, 'recall': 0.88247037, 'specificity': 0.88247037, 'f1': 0.9126253, 'auroc': 0.96502817, 'binary_precision': 0.9922651, 'binary_recall': 0.76702, 'binary_specificity': 0.9979207, 'binary_f1_score': 0.8652232}
confusion matrix:
       0      1
0  42234     88
1   3429  11289
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9520541, 'precision': 0.5305789, 'recall': 0.5153938, 'specificity': 0.5153938, 'f1': 0.5189164, 'auroc': 0.7826695, 'binary_precision': 0.094339624, 'binary_recall': 0.0466563, 'binary_specificity': 0.98413134, 'binary_f1_score': 0.062434964}
confusion matrix:
       0    1
0  17861  288
1    613   30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9496644, 'precision': 0.56536907, 'recall': 0.5211504, 'specificity': 0.5211504, 'f1': 0.5278778, 'auroc': 0.8207097, 'binary_precision': 0.17073171, 'binary_recall': 0.053639848, 'binary_specificity': 0.988661, 'binary_f1_score': 0.08163265}
confusion matrix:
      0   1
0  5929  68
1   247  14
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 02:03:28.157682,epoch time: 0:21:55.647926,used: 0:21:55.647926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.953068, 'precision': 0.9655081, 'recall': 0.9124856, 'specificity': 0.9124856, 'f1': 0.9351659, 'auroc': 0.9793829, 'binary_precision': 0.9874494, 'binary_recall': 0.82863355, 'binary_specificity': 0.9963377, 'binary_f1_score': 0.9010973}
confusion matrix:
       0      1
0  42168    155
1   2522  12195
---- Validation: 
scalar performance:
{'acc': 0.9551405, 'precision': 0.6158514, 'recall': 0.5762461, 'specificity': 0.5762461, 'f1': 0.5911926, 'auroc': 0.8490213, 'binary_precision': 0.26076555, 'binary_recall': 0.16951789, 'binary_specificity': 0.9829743, 'binary_f1_score': 0.20546655}
confusion matrix:
       0    1
0  17840  309
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95573664, 'precision': 0.7025859, 'recall': 0.603109, 'specificity': 0.603109, 'f1': 0.63435745, 'auroc': 0.87970686, 'binary_precision': 0.43846154, 'binary_recall': 0.21839081, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.2915601}
confusion matrix:
      0   1
0  5924  73
1   204  57
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-10 02:24:43.236870,epoch time: 0:21:15.079188,used: 0:43:10.727114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9625351, 'precision': 0.9666569, 'recall': 0.93493545, 'specificity': 0.93493545, 'f1': 0.9494008, 'auroc': 0.98555696, 'binary_precision': 0.9743609, 'binary_recall': 0.8779046, 'binary_specificity': 0.99196637, 'binary_f1_score': 0.9236213}
confusion matrix:
       0      1
0  41982    340
1   1797  12921
---- Validation: 
scalar performance:
{'acc': 0.95349085, 'precision': 0.6591388, 'recall': 0.6781496, 'specificity': 0.6781496, 'f1': 0.66802204, 'auroc': 0.87528986, 'binary_precision': 0.34024897, 'binary_recall': 0.38258165, 'binary_specificity': 0.9737176, 'binary_f1_score': 0.3601757}
confusion matrix:
       0    1
0  17672  477
1    397  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7420606, 'recall': 0.7402859, 'specificity': 0.7402859, 'f1': 0.7411695, 'auroc': 0.89792776, 'binary_precision': 0.5057915, 'binary_recall': 0.5019157, 'binary_specificity': 0.978656, 'binary_f1_score': 0.50384617}
confusion matrix:
      0    1
0  5869  128
1   130  131
new oracle model saved
early stop counter: 1
val acc:0.9534908533096313, best validation acc: 0.9551404714584351, corresponding to test acc:                         0.9557366371154785 / 0.9587727785110474
after epoch: 3,now: 2024-07-10 02:45:41.764557,epoch time: 0:20:58.527687,used: 1:04:09.254801,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9648843, 'precision': 0.97082627, 'recall': 0.9372418, 'specificity': 0.9372418, 'f1': 0.952491, 'auroc': 0.9881227, 'binary_precision': 0.98188156, 'binary_recall': 0.88013047, 'binary_specificity': 0.99435306, 'binary_f1_score': 0.92822593}
confusion matrix:
       0      1
0  42085    239
1   1764  12952
---- Validation: 
scalar performance:
{'acc': 0.95705616, 'precision': 0.668434, 'recall': 0.6544936, 'specificity': 0.6544936, 'f1': 0.6611182, 'auroc': 0.88255787, 'binary_precision': 0.3605442, 'binary_recall': 0.32970452, 'binary_specificity': 0.9792826, 'binary_f1_score': 0.34443542}
confusion matrix:
       0    1
0  17773  376
1    431  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.7896972, 'recall': 0.7437042, 'specificity': 0.7437042, 'f1': 0.7644726, 'auroc': 0.9044529, 'binary_precision': 0.60091746, 'binary_recall': 0.5019157, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.5469729}
confusion matrix:
      0    1
0  5910   87
1   130  131
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-10 03:07:12.003355,epoch time: 0:21:30.238798,used: 1:25:39.493599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96902174, 'precision': 0.973709, 'recall': 0.9451529, 'specificity': 0.9451529, 'f1': 0.958318, 'auroc': 0.9895443, 'binary_precision': 0.98256075, 'binary_recall': 0.89583474, 'binary_specificity': 0.9944711, 'binary_f1_score': 0.93719566}
confusion matrix:
       0      1
0  42089    234
1   1533  13184
---- Validation: 
scalar performance:
{'acc': 0.9586526, 'precision': 0.6839446, 'recall': 0.6748215, 'specificity': 0.6748215, 'f1': 0.6792508, 'auroc': 0.89217293, 'binary_precision': 0.39016393, 'binary_recall': 0.37013996, 'binary_specificity': 0.979503, 'binary_f1_score': 0.37988827}
confusion matrix:
       0    1
0  17777  372
1    405  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.79930335, 'recall': 0.7684417, 'specificity': 0.7684417, 'f1': 0.78293025, 'auroc': 0.9093589, 'binary_precision': 0.6180258, 'binary_recall': 0.55172414, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.5829959}
confusion matrix:
      0    1
0  5908   89
1   117  144
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-10 03:28:05.571956,epoch time: 0:20:53.568601,used: 1:46:33.062200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97158134, 'precision': 0.97376025, 'recall': 0.95161414, 'specificity': 0.95161414, 'f1': 0.96201324, 'auroc': 0.99046934, 'binary_precision': 0.97795296, 'binary_recall': 0.91036355, 'binary_specificity': 0.9928647, 'binary_f1_score': 0.9429486}
confusion matrix:
       0      1
0  42023    302
1   1319  13396
---- Validation: 
scalar performance:
{'acc': 0.95317155, 'precision': 0.673606, 'recall': 0.73423845, 'specificity': 0.73423845, 'f1': 0.6987055, 'auroc': 0.8984715, 'binary_precision': 0.3651877, 'binary_recall': 0.4992224, 'binary_specificity': 0.9692545, 'binary_f1_score': 0.4218134}
confusion matrix:
       0    1
0  17591  558
1    322  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.75550056, 'recall': 0.8202435, 'specificity': 0.8202435, 'f1': 0.7836875, 'auroc': 0.91431034, 'binary_precision': 0.52567977, 'binary_recall': 0.6666667, 'binary_specificity': 0.97382027, 'binary_f1_score': 0.5878379}
confusion matrix:
      0    1
0  5840  157
1    87  174
early stop counter: 1
val acc:0.9531715512275696, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 6,now: 2024-07-10 03:49:10.486158,epoch time: 0:21:04.914202,used: 2:07:37.976402,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97308904, 'precision': 0.9737804, 'recall': 0.95548946, 'specificity': 0.95548946, 'f1': 0.9641731, 'auroc': 0.9919408, 'binary_precision': 0.97512615, 'binary_recall': 0.91913015, 'binary_specificity': 0.99184877, 'binary_f1_score': 0.94630045}
confusion matrix:
       0      1
0  41980    345
1   1190  13525
---- Validation: 
scalar performance:
{'acc': 0.9554598, 'precision': 0.6826867, 'recall': 0.73392296, 'specificity': 0.73392296, 'f1': 0.70468134, 'auroc': 0.90157944, 'binary_precision': 0.38341346, 'binary_recall': 0.496112, 'binary_specificity': 0.971734, 'binary_f1_score': 0.4325424}
confusion matrix:
       0    1
0  17636  513
1    324  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.76136935, 'recall': 0.8116654, 'specificity': 0.8116654, 'f1': 0.78398925, 'auroc': 0.9167013, 'binary_precision': 0.53821653, 'binary_recall': 0.6475096, 'binary_specificity': 0.97582126, 'binary_f1_score': 0.5878261}
confusion matrix:
      0    1
0  5852  145
1    92  169
early stop counter: 2
val acc:0.9554597735404968, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 7,now: 2024-07-10 04:09:52.050200,epoch time: 0:20:41.564042,used: 2:28:19.540444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9740884, 'precision': 0.9764323, 'recall': 0.95558923, 'specificity': 0.95558923, 'f1': 0.96541715, 'auroc': 0.9922439, 'binary_precision': 0.9809621, 'binary_recall': 0.9173688, 'binary_specificity': 0.99380964, 'binary_f1_score': 0.9481003}
confusion matrix:
       0      1
0  42062    262
1   1216  13500
---- Validation: 
scalar performance:
{'acc': 0.9581737, 'precision': 0.69253814, 'recall': 0.72182703, 'specificity': 0.72182703, 'f1': 0.7060012, 'auroc': 0.90183073, 'binary_precision': 0.40402684, 'binary_recall': 0.4681182, 'binary_specificity': 0.97553587, 'binary_f1_score': 0.43371758}
confusion matrix:
       0    1
0  17705  444
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964845, 'precision': 0.7769477, 'recall': 0.81125045, 'specificity': 0.81125045, 'f1': 0.792961, 'auroc': 0.9185934, 'binary_precision': 0.5694915, 'binary_recall': 0.6436782, 'binary_specificity': 0.97882277, 'binary_f1_score': 0.60431653}
confusion matrix:
      0    1
0  5870  127
1    93  168
early stop counter: 3
val acc:0.9581736922264099, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 8,now: 2024-07-10 04:31:08.113994,epoch time: 0:21:16.063794,used: 2:49:35.604238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9767532, 'precision': 0.97759277, 'recall': 0.96136963, 'specificity': 0.96136963, 'f1': 0.96912086, 'auroc': 0.9930724, 'binary_precision': 0.9792383, 'binary_recall': 0.9295909, 'binary_specificity': 0.99314845, 'binary_f1_score': 0.9537689}
confusion matrix:
       0      1
0  42036    290
1   1036  13678
---- Validation: 
scalar performance:
{'acc': 0.9550341, 'precision': 0.6836529, 'recall': 0.7464535, 'specificity': 0.7464535, 'f1': 0.70977545, 'auroc': 0.90453446, 'binary_precision': 0.38443935, 'binary_recall': 0.5225505, 'binary_specificity': 0.97035646, 'binary_f1_score': 0.44297954}
confusion matrix:
       0    1
0  17611  538
1    307  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7472037, 'recall': 0.8248233, 'specificity': 0.8248233, 'f1': 0.7799324, 'auroc': 0.9179761, 'binary_precision': 0.5086207, 'binary_recall': 0.6781609, 'binary_specificity': 0.97148573, 'binary_f1_score': 0.58128077}
confusion matrix:
      0    1
0  5826  171
1    84  177
early stop counter: 4
val acc:0.955034077167511, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 9,now: 2024-07-10 04:52:07.660616,epoch time: 0:20:59.546622,used: 3:10:35.150860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9776297, 'precision': 0.97826815, 'recall': 0.963011, 'specificity': 0.963011, 'f1': 0.9703209, 'auroc': 0.99346054, 'binary_precision': 0.9795234, 'binary_recall': 0.9328034, 'binary_specificity': 0.99321866, 'binary_f1_score': 0.9555927}
confusion matrix:
       0      1
0  42035    287
1    989  13729
---- Validation: 
scalar performance:
{'acc': 0.95093656, 'precision': 0.6718925, 'recall': 0.7608334, 'specificity': 0.7608334, 'f1': 0.70573443, 'auroc': 0.9063447, 'binary_precision': 0.359799, 'binary_recall': 0.55676514, 'binary_specificity': 0.9649016, 'binary_f1_score': 0.43711844}
confusion matrix:
       0    1
0  17512  637
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95126235, 'precision': 0.7167153, 'recall': 0.83348095, 'specificity': 0.83348095, 'f1': 0.7605259, 'auroc': 0.91959834, 'binary_precision': 0.44660193, 'binary_recall': 0.70498085, 'binary_specificity': 0.961981, 'binary_f1_score': 0.5468054}
confusion matrix:
      0    1
0  5769  228
1    77  184
early stop counter: 5
val acc:0.9509365558624268, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 10,now: 2024-07-10 05:13:16.954854,epoch time: 0:21:09.294238,used: 3:31:44.445098,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9780505, 'precision': 0.9767914, 'recall': 0.9655508, 'specificity': 0.9655508, 'f1': 0.97099656, 'auroc': 0.99408746, 'binary_precision': 0.9742849, 'binary_recall': 0.93972546, 'binary_specificity': 0.99137604, 'binary_f1_score': 0.9566932}
confusion matrix:
       0      1
0  41959    365
1    887  13829
---- Validation: 
scalar performance:
{'acc': 0.95184124, 'precision': 0.6746979, 'recall': 0.7598016, 'specificity': 0.7598016, 'f1': 0.7075798, 'auroc': 0.9045673, 'binary_precision': 0.36550307, 'binary_recall': 0.55365473, 'binary_specificity': 0.9659485, 'binary_f1_score': 0.44032156}
confusion matrix:
       0    1
0  17531  618
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95206136, 'precision': 0.71986383, 'recall': 0.83756244, 'specificity': 0.83756244, 'f1': 0.76412106, 'auroc': 0.91658986, 'binary_precision': 0.45255473, 'binary_recall': 0.7126437, 'binary_specificity': 0.96248126, 'binary_f1_score': 0.5535714}
confusion matrix:
      0    1
0  5772  225
1    75  186
early stop counter: 6
val acc:0.9518412351608276, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 11,now: 2024-07-10 05:34:25.232872,epoch time: 0:21:08.278018,used: 3:52:52.723116,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9799965, 'precision': 0.9820379, 'recall': 0.9655587, 'specificity': 0.9655587, 'f1': 0.9734309, 'auroc': 0.99495816, 'binary_precision': 0.9860385, 'binary_recall': 0.935725, 'binary_specificity': 0.99539244, 'binary_f1_score': 0.96022314}
confusion matrix:
       0      1
0  42127    195
1    946  13772
---- Validation: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.696162, 'recall': 0.73616076, 'specificity': 0.73616076, 'f1': 0.7140505, 'auroc': 0.9068824, 'binary_precision': 0.41025642, 'binary_recall': 0.4976672, 'binary_specificity': 0.97465426, 'binary_f1_score': 0.4497541}
confusion matrix:
       0    1
0  17689  460
1    323  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.7367835, 'recall': 0.81449443, 'specificity': 0.81449443, 'f1': 0.7692876, 'auroc': 0.917469, 'binary_precision': 0.48863637, 'binary_recall': 0.65900385, 'binary_specificity': 0.969985, 'binary_f1_score': 0.5611746}
confusion matrix:
      0    1
0  5817  180
1    89  172
early stop counter: 7
val acc:0.9583333134651184, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 12,now: 2024-07-10 05:55:18.105300,epoch time: 0:20:52.872428,used: 4:13:45.595544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9813289, 'precision': 0.98212564, 'recall': 0.9689161, 'specificity': 0.9689161, 'f1': 0.97528386, 'auroc': 0.995294, 'binary_precision': 0.98370296, 'binary_recall': 0.94326675, 'binary_specificity': 0.9945655, 'binary_f1_score': 0.96306056}
confusion matrix:
       0      1
0  42092    230
1    835  13883
---- Validation: 
scalar performance:
{'acc': 0.95498085, 'precision': 0.68406606, 'recall': 0.7494262, 'specificity': 0.7494262, 'f1': 0.71107364, 'auroc': 0.9066678, 'binary_precision': 0.38505095, 'binary_recall': 0.5287714, 'binary_specificity': 0.970081, 'binary_f1_score': 0.44560945}
confusion matrix:
       0    1
0  17606  543
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95190156, 'precision': 0.71808636, 'recall': 0.8264851, 'specificity': 0.8264851, 'f1': 0.7596196, 'auroc': 0.91730857, 'binary_precision': 0.45, 'binary_recall': 0.6896552, 'binary_specificity': 0.963315, 'binary_f1_score': 0.54462934}
confusion matrix:
      0    1
0  5777  220
1    81  180
early stop counter: 8
val acc:0.9549808502197266, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 13,now: 2024-07-10 06:16:31.906840,epoch time: 0:21:13.801540,used: 4:34:59.397084,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9806627, 'precision': 0.9794694, 'recall': 0.9697728, 'specificity': 0.9697728, 'f1': 0.97449195, 'auroc': 0.99558353, 'binary_precision': 0.9770816, 'binary_recall': 0.9472719, 'binary_specificity': 0.9922737, 'binary_f1_score': 0.96194583}
confusion matrix:
       0      1
0  41996    327
1    776  13941
---- Validation: 
scalar performance:
{'acc': 0.95210725, 'precision': 0.6761327, 'recall': 0.7621895, 'specificity': 0.7621895, 'f1': 0.70936704, 'auroc': 0.9090943, 'binary_precision': 0.36820513, 'binary_recall': 0.55832034, 'binary_specificity': 0.96605873, 'binary_f1_score': 0.44375774}
confusion matrix:
       0    1
0  17533  616
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9477469, 'precision': 0.70588547, 'recall': 0.8353113, 'specificity': 0.8353113, 'f1': 0.7522584, 'auroc': 0.9181534, 'binary_precision': 0.42465752, 'binary_recall': 0.7126437, 'binary_specificity': 0.95797896, 'binary_f1_score': 0.53218883}
confusion matrix:
      0    1
0  5745  252
1    75  186
early stop counter: 9
val acc:0.9521072506904602, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 14,now: 2024-07-10 06:37:26.273994,epoch time: 0:20:54.367154,used: 4:55:53.764238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9820827, 'precision': 0.9831711, 'recall': 0.96985817, 'specificity': 0.96985817, 'f1': 0.9762747, 'auroc': 0.99550027, 'binary_precision': 0.9853244, 'binary_recall': 0.9446068, 'binary_specificity': 0.9951095, 'binary_f1_score': 0.9645361}
confusion matrix:
       0      1
0  42120    207
1    815  13898
---- Validation: 
scalar performance:
{'acc': 0.9514687, 'precision': 0.6750323, 'recall': 0.76710933, 'specificity': 0.76710933, 'f1': 0.7099399, 'auroc': 0.9098697, 'binary_precision': 0.36563435, 'binary_recall': 0.56920683, 'binary_specificity': 0.96501184, 'binary_f1_score': 0.44525546}
confusion matrix:
       0    1
0  17514  635
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.944551, 'precision': 0.69571644, 'recall': 0.8281468, 'specificity': 0.8281468, 'f1': 0.7419623, 'auroc': 0.9170479, 'binary_precision': 0.40486726, 'binary_recall': 0.7011494, 'binary_specificity': 0.9551442, 'binary_f1_score': 0.51332396}
confusion matrix:
      0    1
0  5728  269
1    78  183
early stop counter: 10
val acc:0.9514687061309814, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 15,now: 2024-07-10 06:58:36.898649,epoch time: 0:21:10.624655,used: 5:17:04.388893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98174965, 'precision': 0.9834124, 'recall': 0.9687748, 'specificity': 0.9687748, 'f1': 0.9758042, 'auroc': 0.99566114, 'binary_precision': 0.98668945, 'binary_recall': 0.9419679, 'binary_specificity': 0.9955817, 'binary_f1_score': 0.9638102}
confusion matrix:
       0      1
0  42137    187
1    854  13862
---- Validation: 
scalar performance:
{'acc': 0.9574287, 'precision': 0.68557334, 'recall': 0.7071903, 'specificity': 0.7071903, 'f1': 0.69570124, 'auroc': 0.9027219, 'binary_precision': 0.39112344, 'binary_recall': 0.43856922, 'binary_specificity': 0.97581136, 'binary_f1_score': 0.41348973}
confusion matrix:
       0    1
0  17710  439
1    361  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.7318934, 'recall': 0.78484356, 'specificity': 0.78484356, 'f1': 0.7552259, 'auroc': 0.9095026, 'binary_precision': 0.4814815, 'binary_recall': 0.59770113, 'binary_specificity': 0.971986, 'binary_f1_score': 0.53333336}
confusion matrix:
      0    1
0  5829  168
1   105  156
early stop counter: 11
val acc:0.9574286937713623, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 16,now: 2024-07-10 07:19:46.217703,epoch time: 0:21:09.319054,used: 5:38:13.707947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9829243, 'precision': 0.9836765, 'recall': 0.9715593, 'specificity': 0.9715593, 'f1': 0.97741914, 'auroc': 0.9962939, 'binary_precision': 0.98517054, 'binary_recall': 0.9480802, 'binary_specificity': 0.9950384, 'binary_f1_score': 0.96626955}
confusion matrix:
       0      1
0  42115    210
1    764  13951
---- Validation: 
scalar performance:
{'acc': 0.95391655, 'precision': 0.6779541, 'recall': 0.7406246, 'specificity': 0.7406246, 'f1': 0.70387155, 'auroc': 0.9060243, 'binary_precision': 0.37343928, 'binary_recall': 0.5116641, 'binary_specificity': 0.9695851, 'binary_f1_score': 0.43175855}
confusion matrix:
       0    1
0  17597  552
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94566953, 'precision': 0.6941381, 'recall': 0.7994131, 'specificity': 0.7994131, 'f1': 0.7334188, 'auroc': 0.91092163, 'binary_precision': 0.40435836, 'binary_recall': 0.63984674, 'binary_specificity': 0.9589795, 'binary_f1_score': 0.49554896}
confusion matrix:
      0    1
0  5751  246
1    94  167
early stop counter: 12
val acc:0.9539165496826172, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 17,now: 2024-07-10 07:40:52.587511,epoch time: 0:21:06.369808,used: 5:59:20.077755,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98346776, 'precision': 0.9849969, 'recall': 0.97170556, 'specificity': 0.97170556, 'f1': 0.97811323, 'auroc': 0.99649715, 'binary_precision': 0.9880235, 'binary_recall': 0.9474042, 'binary_specificity': 0.99600697, 'binary_f1_score': 0.96728766}
confusion matrix:
       0      1
0  42155    169
1    774  13942
---- Validation: 
scalar performance:
{'acc': 0.9548744, 'precision': 0.6831538, 'recall': 0.7471209, 'specificity': 0.7471209, 'f1': 0.70966166, 'auroc': 0.9065795, 'binary_precision': 0.38339022, 'binary_recall': 0.5241057, 'binary_specificity': 0.9701361, 'binary_f1_score': 0.44283834}
confusion matrix:
       0    1
0  17607  542
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9475871, 'precision': 0.70049477, 'recall': 0.802246, 'specificity': 0.802246, 'f1': 0.7391747, 'auroc': 0.9118173, 'binary_precision': 0.41687346, 'binary_recall': 0.6436782, 'binary_specificity': 0.96081376, 'binary_f1_score': 0.5060241}
confusion matrix:
      0    1
0  5762  235
1    93  168
early stop counter: 13
val acc:0.9548743963241577, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 18,now: 2024-07-10 08:02:01.667974,epoch time: 0:21:09.080463,used: 6:20:29.158218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98353785, 'precision': 0.98434854, 'recall': 0.97250473, 'specificity': 0.97250473, 'f1': 0.978237, 'auroc': 0.99623775, 'binary_precision': 0.9859602, 'binary_recall': 0.9497112, 'binary_specificity': 0.99529827, 'binary_f1_score': 0.9674963}
confusion matrix:
       0      1
0  42126    199
1    740  13975
---- Validation: 
scalar performance:
{'acc': 0.95120263, 'precision': 0.6741215, 'recall': 0.7669716, 'specificity': 0.7669716, 'f1': 0.7091936, 'auroc': 0.9087735, 'binary_precision': 0.3638171, 'binary_recall': 0.56920683, 'binary_specificity': 0.96473634, 'binary_f1_score': 0.44390538}
confusion matrix:
       0    1
0  17509  640
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93720037, 'precision': 0.6740907, 'recall': 0.8096529, 'specificity': 0.8096529, 'f1': 0.71884096, 'auroc': 0.9119119, 'binary_precision': 0.36307055, 'binary_recall': 0.6704981, 'binary_specificity': 0.9488077, 'binary_f1_score': 0.4710633}
confusion matrix:
      0    1
0  5690  307
1    86  175
early stop counter: 14
val acc:0.9512026309967041, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 19,now: 2024-07-10 08:23:14.906214,epoch time: 0:21:13.238240,used: 6:41:42.396458,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98334503, 'precision': 0.98371303, 'recall': 0.97262186, 'specificity': 0.97262186, 'f1': 0.97800064, 'auroc': 0.9958831, 'binary_precision': 0.98444647, 'binary_recall': 0.95046544, 'binary_specificity': 0.9947783, 'binary_f1_score': 0.96715754}
confusion matrix:
       0      1
0  42102    221
1    729  13988
---- Validation: 
scalar performance:
{'acc': 0.9526926, 'precision': 0.67595035, 'recall': 0.7519918, 'specificity': 0.7519918, 'f1': 0.7061472, 'auroc': 0.9053471, 'binary_precision': 0.36858973, 'binary_recall': 0.5365474, 'binary_specificity': 0.9674362, 'binary_f1_score': 0.4369854}
confusion matrix:
       0    1
0  17558  591
1    298  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94119525, 'precision': 0.68197435, 'recall': 0.8007433, 'specificity': 0.8007433, 'f1': 0.7237967, 'auroc': 0.9090061, 'binary_precision': 0.3797753, 'binary_recall': 0.6475096, 'binary_specificity': 0.953977, 'binary_f1_score': 0.47875357}
confusion matrix:
      0    1
0  5721  276
1    92  169
early stop counter: 15
val acc:0.9526926279067993, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 20,now: 2024-07-10 08:45:10.745545,epoch time: 0:21:55.839331,used: 7:03:38.235789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98487025, 'precision': 0.98449135, 'recall': 0.975845, 'specificity': 0.975845, 'f1': 0.98006666, 'auroc': 0.99703085, 'binary_precision': 0.9837302, 'binary_recall': 0.9571953, 'binary_specificity': 0.9944946, 'binary_f1_score': 0.97028136}
confusion matrix:
       0      1
0  42089    233
1    630  14088
---- Validation: 
scalar performance:
{'acc': 0.95152193, 'precision': 0.6752156, 'recall': 0.76713693, 'specificity': 0.76713693, 'f1': 0.7100897, 'auroc': 0.9113951, 'binary_precision': 0.366, 'binary_recall': 0.56920683, 'binary_specificity': 0.96506697, 'binary_f1_score': 0.44552645}
confusion matrix:
       0    1
0  17515  634
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9394375, 'precision': 0.6798912, 'recall': 0.81265247, 'specificity': 0.81265247, 'f1': 0.7246863, 'auroc': 0.9116255, 'binary_precision': 0.3744681, 'binary_recall': 0.6743295, 'binary_specificity': 0.9509755, 'binary_f1_score': 0.4815322}
confusion matrix:
      0    1
0  5703  294
1    85  176
early stop counter: 16
val acc:0.9515219330787659, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 21,now: 2024-07-10 09:06:17.430844,epoch time: 0:21:06.685299,used: 7:24:44.921088,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.984432, 'precision': 0.98604584, 'recall': 0.9731992, 'specificity': 0.9731992, 'f1': 0.97940063, 'auroc': 0.9968673, 'binary_precision': 0.98924506, 'binary_recall': 0.9499898, 'binary_specificity': 0.9964086, 'binary_f1_score': 0.9692201}
confusion matrix:
       0      1
0  42171    152
1    736  13981
---- Validation: 
scalar performance:
{'acc': 0.95828015, 'precision': 0.69589883, 'recall': 0.73613316, 'specificity': 0.73613316, 'f1': 0.7138784, 'auroc': 0.9099064, 'binary_precision': 0.40973112, 'binary_recall': 0.4976672, 'binary_specificity': 0.9745991, 'binary_f1_score': 0.4494382}
confusion matrix:
       0    1
0  17688  461
1    323  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95286036, 'precision': 0.7176519, 'recall': 0.792171, 'specificity': 0.792171, 'f1': 0.7485441, 'auroc': 0.91010463, 'binary_precision': 0.4522472, 'binary_recall': 0.61685824, 'binary_specificity': 0.96748376, 'binary_f1_score': 0.5218801}
confusion matrix:
      0    1
0  5802  195
1   100  161
early stop counter: 17
val acc:0.9582801461219788, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 22,now: 2024-07-10 09:27:20.604479,epoch time: 0:21:03.173635,used: 7:45:48.094723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98525596, 'precision': 0.98534167, 'recall': 0.9760134, 'specificity': 0.9760134, 'f1': 0.9805598, 'auroc': 0.99661875, 'binary_precision': 0.9855133, 'binary_recall': 0.95691764, 'binary_specificity': 0.99510914, 'binary_f1_score': 0.971005}
confusion matrix:
       0      1
0  42117    207
1    634  14082
---- Validation: 
scalar performance:
{'acc': 0.954768, 'precision': 0.67761874, 'recall': 0.72456414, 'specificity': 0.72456414, 'f1': 0.69793314, 'auroc': 0.90388453, 'binary_precision': 0.37393424, 'binary_recall': 0.47744945, 'binary_specificity': 0.97167885, 'binary_f1_score': 0.41939893}
confusion matrix:
       0    1
0  17635  514
1    336  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9487057, 'precision': 0.701644, 'recall': 0.78633857, 'specificity': 0.78633857, 'f1': 0.7353128, 'auroc': 0.9060757, 'binary_precision': 0.42063493, 'binary_recall': 0.6091954, 'binary_specificity': 0.9634817, 'binary_f1_score': 0.4976526}
confusion matrix:
      0    1
0  5778  219
1   102  159
early stop counter: 18
val acc:0.9547680020332336, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 23,now: 2024-07-10 09:48:36.827777,epoch time: 0:21:16.223298,used: 8:07:04.318021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9865007, 'precision': 0.98597294, 'recall': 0.97864616, 'specificity': 0.97864616, 'f1': 0.98223686, 'auroc': 0.9973899, 'binary_precision': 0.9849085, 'binary_recall': 0.9624193, 'binary_specificity': 0.994873, 'binary_f1_score': 0.973534}
confusion matrix:
       0      1
0  42108    217
1    553  14162
---- Validation: 
scalar performance:
{'acc': 0.95083016, 'precision': 0.66858155, 'recall': 0.7480274, 'specificity': 0.7480274, 'f1': 0.69948757, 'auroc': 0.90677726, 'binary_precision': 0.35410178, 'binary_recall': 0.5303266, 'binary_specificity': 0.96572816, 'binary_f1_score': 0.42465752}
confusion matrix:
       0    1
0  17527  622
1    302  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93736017, 'precision': 0.67222446, 'recall': 0.7987423, 'specificity': 0.7987423, 'f1': 0.71487695, 'auroc': 0.90909755, 'binary_precision': 0.36034116, 'binary_recall': 0.6475096, 'binary_specificity': 0.949975, 'binary_f1_score': 0.46301368}
confusion matrix:
      0    1
0  5697  300
1    92  169
early stop counter: 19
val acc:0.9508301615715027, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 24,now: 2024-07-10 10:11:19.093004,epoch time: 0:22:42.265227,used: 8:29:46.583248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9858871, 'precision': 0.98696065, 'recall': 0.976087, 'specificity': 0.976087, 'f1': 0.98136485, 'auroc': 0.9968684, 'binary_precision': 0.9891022, 'binary_recall': 0.9558364, 'binary_specificity': 0.9963376, 'binary_f1_score': 0.9721848}
confusion matrix:
       0      1
0  42167    155
1    650  14068
---- Validation: 
scalar performance:
{'acc': 0.9545019, 'precision': 0.678444, 'recall': 0.73267704, 'specificity': 0.73267704, 'f1': 0.7014353, 'auroc': 0.9065857, 'binary_precision': 0.375, 'binary_recall': 0.49455675, 'binary_specificity': 0.9707973, 'binary_f1_score': 0.42655933}
confusion matrix:
       0    1
0  17619  530
1    325  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94534993, 'precision': 0.6902056, 'recall': 0.7827554, 'specificity': 0.7827554, 'f1': 0.7257009, 'auroc': 0.9076978, 'binary_precision': 0.3979849, 'binary_recall': 0.60536397, 'binary_specificity': 0.9601467, 'binary_f1_score': 0.48024318}
confusion matrix:
      0    1
0  5758  239
1   103  158
early stop counter: 20
val acc:0.9545019268989563, best validation acc: 0.9586526155471802, corresponding to test acc:                         0.967082142829895 / 0.967082142829895
after epoch: 25,now: 2024-07-10 10:38:35.456766,epoch time: 0:27:16.363762,used: 8:57:02.947010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98497546, 'precision': 0.98723376, 'recall': 0.9734751, 'specificity': 0.9734751, 'f1': 0.980101, 'auroc': 0.9968705, 'binary_precision': 0.991698, 'binary_recall': 0.9497146, 'binary_specificity': 0.9972356, 'binary_f1_score': 0.97025234}
confusion matrix:
       0      1
0  42207    117
1    740  13976
---- Validation: 
scalar performance:
{'acc': 0.9589719, 'precision': 0.69394463, 'recall': 0.7087393, 'specificity': 0.7087393, 'f1': 0.7010326, 'auroc': 0.9059639, 'binary_precision': 0.40778098, 'binary_recall': 0.44012442, 'binary_specificity': 0.9773541, 'binary_f1_score': 0.42333582}
confusion matrix:
       0    1
0  17738  411
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.7258167, 'recall': 0.76601994, 'specificity': 0.76601994, 'f1': 0.74401325, 'auroc': 0.9040438, 'binary_precision': 0.47096774, 'binary_recall': 0.55938697, 'binary_specificity': 0.972653, 'binary_f1_score': 0.51138353}
confusion matrix:
      0    1
0  5833  164
1   115  146
better model found
persisted
after epoch: 26,now: 2024-07-10 11:04:54.806625,epoch time: 0:26:19.349859,used: 9:23:22.296869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98667604, 'precision': 0.98670006, 'recall': 0.9783913, 'specificity': 0.9783913, 'f1': 0.9824525, 'auroc': 0.9970224, 'binary_precision': 0.9867485, 'binary_recall': 0.96127194, 'binary_specificity': 0.99551064, 'binary_f1_score': 0.97384363}
confusion matrix:
       0      1
0  42132    190
1    570  14148
---- Validation: 
scalar performance:
{'acc': 0.94822264, 'precision': 0.66017354, 'recall': 0.74742746, 'specificity': 0.74742746, 'f1': 0.6928558, 'auroc': 0.9047515, 'binary_precision': 0.3372781, 'binary_recall': 0.5318818, 'binary_specificity': 0.9629732, 'binary_f1_score': 0.41279417}
confusion matrix:
       0    1
0  17477  672
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.935123, 'precision': 0.66456884, 'recall': 0.78658104, 'specificity': 0.78658104, 'f1': 0.7054509, 'auroc': 0.901767, 'binary_precision': 0.3460722, 'binary_recall': 0.6245211, 'binary_specificity': 0.948641, 'binary_f1_score': 0.4453552}
confusion matrix:
      0    1
0  5689  308
1    98  163
early stop counter: 1
val acc:0.9482226371765137, best validation acc: 0.9589719176292419, corresponding to test acc:                         0.9554170370101929 / 0.967082142829895
after epoch: 27,now: 2024-07-10 11:29:18.875465,epoch time: 0:24:24.068840,used: 9:47:46.365709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9872896, 'precision': 0.98721045, 'recall': 0.97949046, 'specificity': 0.97949046, 'f1': 0.98327005, 'auroc': 0.9974288, 'binary_precision': 0.98705095, 'binary_recall': 0.9633757, 'binary_specificity': 0.99560523, 'binary_f1_score': 0.9750697}
confusion matrix:
       0      1
0  42137    186
1    539  14178
---- Validation: 
scalar performance:
{'acc': 0.9559919, 'precision': 0.68267554, 'recall': 0.7236977, 'specificity': 0.7236977, 'f1': 0.7008083, 'auroc': 0.90644395, 'binary_precision': 0.38413098, 'binary_recall': 0.47433904, 'binary_specificity': 0.9730564, 'binary_f1_score': 0.42449546}
confusion matrix:
       0    1
0  17660  489
1    338  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95270056, 'precision': 0.7140323, 'recall': 0.7682673, 'specificity': 0.7682673, 'f1': 0.73758805, 'auroc': 0.9018457, 'binary_precision': 0.4471299, 'binary_recall': 0.5670498, 'binary_specificity': 0.96948475, 'binary_f1_score': 0.5}
confusion matrix:
      0    1
0  5814  183
1   113  148
early stop counter: 2
val acc:0.9559919238090515, best validation acc: 0.9589719176292419, corresponding to test acc:                         0.9554170370101929 / 0.967082142829895
after epoch: 28,now: 2024-07-10 11:50:53.139130,epoch time: 0:21:34.263665,used: 10:09:20.629374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98629034, 'precision': 0.98652554, 'recall': 0.9775512, 'specificity': 0.9775512, 'f1': 0.9819298, 'auroc': 0.9969032, 'binary_precision': 0.98699754, 'binary_recall': 0.9594971, 'binary_specificity': 0.9956054, 'binary_f1_score': 0.9730531}
confusion matrix:
       0      1
0  42139    186
1    596  14119
---- Validation: 
scalar performance:
{'acc': 0.956258, 'precision': 0.6817956, 'recall': 0.7148348, 'specificity': 0.7148348, 'f1': 0.6967355, 'auroc': 0.9034969, 'binary_precision': 0.38300654, 'binary_recall': 0.45567653, 'binary_specificity': 0.97399306, 'binary_f1_score': 0.4161932}
confusion matrix:
       0    1
0  17677  472
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95222116, 'precision': 0.7112558, 'recall': 0.7625202, 'specificity': 0.7625202, 'f1': 0.7336454, 'auroc': 0.90008414, 'binary_precision': 0.44207317, 'binary_recall': 0.5555556, 'binary_specificity': 0.96948475, 'binary_f1_score': 0.49235994}
confusion matrix:
      0    1
0  5814  183
1   116  145
early stop counter: 3
val acc:0.9562579989433289, best validation acc: 0.9589719176292419, corresponding to test acc:                         0.9554170370101929 / 0.967082142829895
after epoch: 29,now: 2024-07-10 12:12:20.005800,epoch time: 0:21:26.866670,used: 10:30:47.496044,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9874825, 'precision': 0.987975, 'recall': 0.9792412, 'specificity': 0.9792412, 'f1': 0.9835056, 'auroc': 0.9977007, 'binary_precision': 0.98896414, 'binary_recall': 0.9622154, 'binary_specificity': 0.99626696, 'binary_f1_score': 0.97540647}
confusion matrix:
       0      1
0  42167    158
1    556  14159
---- Validation: 
scalar performance:
{'acc': 0.95407623, 'precision': 0.67561305, 'recall': 0.7279563, 'specificity': 0.7279563, 'f1': 0.69786453, 'auroc': 0.9041461, 'binary_precision': 0.36966825, 'binary_recall': 0.4852255, 'binary_specificity': 0.9706871, 'binary_f1_score': 0.41963685}
confusion matrix:
       0    1
0  17617  532
1    331  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501438, 'precision': 0.70513475, 'recall': 0.7760949, 'specificity': 0.7760949, 'f1': 0.73446137, 'auroc': 0.89909637, 'binary_precision': 0.42857143, 'binary_recall': 0.5862069, 'binary_specificity': 0.965983, 'binary_f1_score': 0.49514565}
confusion matrix:
      0    1
0  5793  204
1   108  153
early stop counter: 4
val acc:0.9540762305259705, best validation acc: 0.9589719176292419, corresponding to test acc:                         0.9554170370101929 / 0.967082142829895
after epoch: 30,now: 2024-07-10 12:34:25.049507,epoch time: 0:22:05.043707,used: 10:52:52.539751,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_01_41_32_seed_0_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:52:52.539751 at 2024-07-10 12:34:25.049507
persisted model performance metric: 

scalar performance:
{'acc': 0.95541704, 'precision': 0.7258167, 'recall': 0.76601994, 'specificity': 0.76601994, 'f1': 0.74401325, 'auroc': 0.9040438, 'binary_precision': 0.47096774, 'binary_recall': 0.55938697, 'binary_specificity': 0.972653, 'binary_f1_score': 0.51138353}
confusion matrix:
      0    1
0  5833  164
1   115  146
oracle model performance metric: 

scalar performance:
{'acc': 0.96708214, 'precision': 0.79930335, 'recall': 0.7684417, 'specificity': 0.7684417, 'f1': 0.78293025, 'auroc': 0.9093589, 'binary_precision': 0.6180258, 'binary_recall': 0.55172414, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.5829959}
confusion matrix:
      0    1
0  5908   89
1   117  144
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  16482 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59895 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |   9133 KiB |  11093 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7625    |  195064 K  |  195061 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84572 K  |   84569 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7625    |  195064 K  |  195061 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84572 K  |   84569 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3589    |  120672 K  |  120672 K  |
|       from large pool |      10    |     350    |   85092 K  |   85092 K  |
|       from small pool |      26    |    3579    |   35580 K  |   35580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84572 K  |   84572 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84572 K  |   84572 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  120673 K  |  120673 K  |
|       from large pool |       3    |     350    |   85092 K  |   85092 K  |
|       from small pool |       0    |    3579    |   35581 K  |   35581 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84572 K  |   84572 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84572 K  |   84572 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  120673 K  |  120673 K  |
|       from large pool |       3    |     350    |   85092 K  |   85092 K  |
|       from small pool |       0    |    3579    |   35581 K  |   35581 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614

 Experiment start at: 2024-07-10 13:02:15.193632
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9272769, 'precision': 0.93519425, 'recall': 0.8702171, 'specificity': 0.8702171, 'f1': 0.8966353, 'auroc': 0.9442948, 'binary_precision': 0.9484698, 'binary_recall': 0.75436896, 'binary_specificity': 0.98606527, 'binary_f1_score': 0.84035695}
confusion matrix:
       0      1
0  41821    591
1   3542  10878
---- Validation: 
scalar performance:
{'acc': 0.94919956, 'precision': 0.50789833, 'recall': 0.503723, 'specificity': 0.503723, 'f1': 0.50321764, 'auroc': 0.7426086, 'binary_precision': 0.051446944, 'binary_recall': 0.023774145, 'binary_specificity': 0.9836719, 'binary_f1_score': 0.032520324}
confusion matrix:
       0    1
0  17772  295
1    657   16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94263613, 'precision': 0.48887324, 'recall': 0.49560532, 'specificity': 0.49560532, 'f1': 0.49078622, 'auroc': 0.6974739, 'binary_precision': 0.02, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9835183, 'binary_f1_score': 0.011111111}
confusion matrix:
      0   1
0  5848  98
1   258   2
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 13:32:35.052334,epoch time: 0:30:19.858702,used: 0:30:19.858702,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9509959, 'precision': 0.96086967, 'recall': 0.9095142, 'specificity': 0.9095142, 'f1': 0.93162966, 'auroc': 0.97093475, 'binary_precision': 0.97813576, 'binary_recall': 0.8253, 'binary_specificity': 0.99372834, 'binary_f1_score': 0.8952417}
confusion matrix:
       0      1
0  42147    266
1   2519  11900
---- Validation: 
scalar performance:
{'acc': 0.9524546, 'precision': 0.5350969, 'recall': 0.51470965, 'specificity': 0.51470965, 'f1': 0.51836336, 'auroc': 0.7977928, 'binary_precision': 0.10507246, 'binary_recall': 0.043090638, 'binary_specificity': 0.98632866, 'binary_f1_score': 0.061116964}
confusion matrix:
       0    1
0  17820  247
1    644   29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94553655, 'precision': 0.49113044, 'recall': 0.49711895, 'specificity': 0.49711895, 'f1': 0.4918463, 'auroc': 0.7696415, 'binary_precision': 0.024390243, 'binary_recall': 0.0076923077, 'binary_specificity': 0.98654556, 'binary_f1_score': 0.0116959065}
confusion matrix:
      0   1
0  5866  80
1   258   2
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-10 13:55:39.425088,epoch time: 0:23:04.372754,used: 0:53:24.231456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9612894, 'precision': 0.9682349, 'recall': 0.929301, 'specificity': 0.929301, 'f1': 0.94674003, 'auroc': 0.9818182, 'binary_precision': 0.9807995, 'binary_recall': 0.8643551, 'binary_specificity': 0.9942469, 'binary_f1_score': 0.918903}
confusion matrix:
       0      1
0  42168    244
1   1956  12464
---- Validation: 
scalar performance:
{'acc': 0.9557097, 'precision': 0.60678184, 'recall': 0.5500154, 'specificity': 0.5500154, 'f1': 0.5660226, 'auroc': 0.8324579, 'binary_precision': 0.24595469, 'binary_recall': 0.11292719, 'binary_specificity': 0.9871036, 'binary_f1_score': 0.15478615}
confusion matrix:
       0    1
0  17834  233
1    597   76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94924265, 'precision': 0.53580016, 'recall': 0.51008695, 'specificity': 0.51008695, 'f1': 0.5111322, 'auroc': 0.8327041, 'binary_precision': 0.112676054, 'binary_recall': 0.03076923, 'binary_specificity': 0.9894046, 'binary_f1_score': 0.048338372}
confusion matrix:
      0   1
0  5883  63
1   252   8
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-10 14:17:37.641157,epoch time: 0:21:58.216069,used: 1:15:22.447525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9675711, 'precision': 0.97079015, 'recall': 0.94309485, 'specificity': 0.94309485, 'f1': 0.9559128, 'auroc': 0.98605144, 'binary_precision': 0.9767971, 'binary_recall': 0.89340454, 'binary_specificity': 0.9927852, 'binary_f1_score': 0.9332416}
confusion matrix:
       0      1
0  42107    306
1   1537  12882
---- Validation: 
scalar performance:
{'acc': 0.957524, 'precision': 0.6549228, 'recall': 0.5895807, 'specificity': 0.5895807, 'f1': 0.61217916, 'auroc': 0.84825605, 'binary_precision': 0.3394256, 'binary_recall': 0.19316493, 'binary_specificity': 0.98599654, 'binary_f1_score': 0.24621214}
confusion matrix:
       0    1
0  17814  253
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95246536, 'precision': 0.6168662, 'recall': 0.5356756, 'specificity': 0.5356756, 'f1': 0.55009925, 'auroc': 0.85546327, 'binary_precision': 0.27272728, 'binary_recall': 0.08076923, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.12462908}
confusion matrix:
      0   1
0  5890  56
1   239  21
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-10 14:40:57.930348,epoch time: 0:23:20.289191,used: 1:38:42.736716,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97024566, 'precision': 0.9723594, 'recall': 0.9485978, 'specificity': 0.9485978, 'f1': 0.95972073, 'auroc': 0.98911035, 'binary_precision': 0.97634906, 'binary_recall': 0.90464634, 'binary_specificity': 0.9925493, 'binary_f1_score': 0.9391311}
confusion matrix:
       0      1
0  42096    316
1   1375  13045
---- Validation: 
scalar performance:
{'acc': 0.9591782, 'precision': 0.67437214, 'recall': 0.59902185, 'specificity': 0.59902185, 'f1': 0.6248677, 'auroc': 0.86629647, 'binary_precision': 0.3776596, 'binary_recall': 0.21099554, 'binary_specificity': 0.9870482, 'binary_f1_score': 0.27073404}
confusion matrix:
       0    1
0  17833  234
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.70928687, 'recall': 0.5565041, 'specificity': 0.5565041, 'f1': 0.58350587, 'auroc': 0.88750255, 'binary_precision': 0.45588234, 'binary_recall': 0.11923077, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.18902439}
confusion matrix:
      0   1
0  5909  37
1   229  31
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-10 15:05:08.593417,epoch time: 0:24:10.663069,used: 2:02:53.399785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9729554, 'precision': 0.9730573, 'recall': 0.9550307, 'specificity': 0.9550307, 'f1': 0.96360606, 'auroc': 0.99056554, 'binary_precision': 0.973253, 'binary_recall': 0.91864336, 'binary_specificity': 0.99141794, 'binary_f1_score': 0.94516003}
confusion matrix:
       0      1
0  42050    364
1   1173  13245
---- Validation: 
scalar performance:
{'acc': 0.9604055, 'precision': 0.6958983, 'recall': 0.625408, 'specificity': 0.625408, 'f1': 0.65191555, 'auroc': 0.8693813, 'binary_precision': 0.41882354, 'binary_recall': 0.26448736, 'binary_specificity': 0.98632866, 'binary_f1_score': 0.32422587}
confusion matrix:
       0    1
0  17820  247
1    495  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.744707, 'recall': 0.5775738, 'specificity': 0.5775738, 'f1': 0.6129264, 'auroc': 0.8899538, 'binary_precision': 0.525, 'binary_recall': 0.16153847, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.24705882}
confusion matrix:
      0   1
0  5908  38
1   218  42
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-10 15:28:48.152321,epoch time: 0:23:39.558904,used: 2:26:32.958689,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97519004, 'precision': 0.97570467, 'recall': 0.9583844, 'specificity': 0.9583844, 'f1': 0.96664286, 'auroc': 0.9923891, 'binary_precision': 0.97669476, 'binary_recall': 0.9242666, 'binary_specificity': 0.9925023, 'binary_f1_score': 0.9497577}
confusion matrix:
       0      1
0  42095    318
1   1092  13327
---- Validation: 
scalar performance:
{'acc': 0.9609925, 'precision': 0.70127463, 'recall': 0.62499714, 'specificity': 0.62499714, 'f1': 0.6530911, 'auroc': 0.87666607, 'binary_precision': 0.42961165, 'binary_recall': 0.26300147, 'binary_specificity': 0.98699284, 'binary_f1_score': 0.32626727}
confusion matrix:
       0    1
0  17832  235
1    496  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.8230786, 'recall': 0.5922967, 'specificity': 0.5922967, 'f1': 0.63790494, 'auroc': 0.9022911, 'binary_precision': 0.6805556, 'binary_recall': 0.18846154, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.29518074}
confusion matrix:
      0   1
0  5923  23
1   211  49
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-10 15:51:48.650559,epoch time: 0:23:00.498238,used: 2:49:33.456927,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9764217, 'precision': 0.97703254, 'recall': 0.9603565, 'specificity': 0.9603565, 'f1': 0.9683232, 'auroc': 0.99321216, 'binary_precision': 0.97821003, 'binary_recall': 0.92773926, 'binary_specificity': 0.9929737, 'binary_f1_score': 0.9523064}
confusion matrix:
       0      1
0  42114    298
1   1042  13378
---- Validation: 
scalar performance:
{'acc': 0.96195304, 'precision': 0.709821, 'recall': 0.61977315, 'specificity': 0.61977315, 'f1': 0.651013, 'auroc': 0.8764303, 'binary_precision': 0.44708994, 'binary_recall': 0.2511144, 'binary_specificity': 0.98843193, 'binary_f1_score': 0.32159847}
confusion matrix:
       0    1
0  17858  209
1    504  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.827018, 'recall': 0.60366696, 'specificity': 0.60366696, 'f1': 0.6522386, 'auroc': 0.90153944, 'binary_precision': 0.6875, 'binary_recall': 0.21153846, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.32352942}
confusion matrix:
      0   1
0  5921  25
1   205  55
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-10 16:15:16.833476,epoch time: 0:23:28.182917,used: 3:13:01.639844,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9782693, 'precision': 0.98008263, 'recall': 0.9623014, 'specificity': 0.9623014, 'f1': 0.9707739, 'auroc': 0.99321824, 'binary_precision': 0.9835681, 'binary_recall': 0.9298842, 'binary_specificity': 0.9947186, 'binary_f1_score': 0.9559731}
confusion matrix:
       0      1
0  42189    224
1   1011  13408
---- Validation: 
scalar performance:
{'acc': 0.96179295, 'precision': 0.7111075, 'recall': 0.6332802, 'specificity': 0.6332802, 'f1': 0.66232276, 'auroc': 0.8825438, 'binary_precision': 0.44868734, 'binary_recall': 0.2793462, 'binary_specificity': 0.98721427, 'binary_f1_score': 0.34432232}
confusion matrix:
       0    1
0  17836  231
1    485  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.8373139, 'recall': 0.62272954, 'specificity': 0.62272954, 'f1': 0.6754551, 'auroc': 0.9082699, 'binary_precision': 0.70652175, 'binary_recall': 0.25, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.3693182}
confusion matrix:
      0   1
0  5919  27
1   195  65
new oracle model saved
early stop counter: 1
val acc:0.9617929458618164, best validation acc: 0.9619530439376831, corresponding to test acc:                         0.9629390835762024 / 0.9642281532287598
after epoch: 9,now: 2024-07-10 16:37:18.115872,epoch time: 0:22:01.282396,used: 3:35:02.922240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9788851, 'precision': 0.9786365, 'recall': 0.9653003, 'specificity': 0.9653003, 'f1': 0.97173107, 'auroc': 0.9945086, 'binary_precision': 0.97815233, 'binary_recall': 0.9377211, 'binary_specificity': 0.99287957, 'binary_f1_score': 0.9575101}
confusion matrix:
       0      1
0  42111    302
1    898  13521
---- Validation: 
scalar performance:
{'acc': 0.96125937, 'precision': 0.71137536, 'recall': 0.65946835, 'specificity': 0.65946835, 'f1': 0.68132764, 'auroc': 0.8883809, 'binary_precision': 0.4473161, 'binary_recall': 0.3343239, 'binary_specificity': 0.9846128, 'binary_f1_score': 0.38265303}
confusion matrix:
       0    1
0  17789  278
1    448  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.8320329, 'recall': 0.6734754, 'specificity': 0.6734754, 'f1': 0.7254021, 'auroc': 0.9111607, 'binary_precision': 0.6917293, 'binary_recall': 0.35384616, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.46819338}
confusion matrix:
      0   1
0  5905  41
1   168  92
new oracle model saved
early stop counter: 2
val acc:0.9612593650817871, best validation acc: 0.9619530439376831, corresponding to test acc:                         0.9629390835762024 / 0.9663228988647461
after epoch: 10,now: 2024-07-10 16:58:07.938331,epoch time: 0:20:49.822459,used: 3:55:52.744699,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9790435, 'precision': 0.981637, 'recall': 0.9628611, 'specificity': 0.9628611, 'f1': 0.9717853, 'auroc': 0.99458945, 'binary_precision': 0.9866078, 'binary_recall': 0.9300132, 'binary_specificity': 0.99570906, 'binary_f1_score': 0.95747495}
confusion matrix:
       0      1
0  42233    182
1   1009  13408
---- Validation: 
scalar performance:
{'acc': 0.9630736, 'precision': 0.72338086, 'recall': 0.62321544, 'specificity': 0.62321544, 'f1': 0.65717214, 'auroc': 0.8856964, 'binary_precision': 0.4739726, 'binary_recall': 0.25705793, 'binary_specificity': 0.9893729, 'binary_f1_score': 0.3333333}
confusion matrix:
       0    1
0  17875  192
1    500  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.8853162, 'recall': 0.62365454, 'specificity': 0.62365454, 'f1': 0.6818758, 'auroc': 0.9114047, 'binary_precision': 0.80246913, 'binary_recall': 0.25, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.38123167}
confusion matrix:
      0   1
0  5930  16
1   195  65
better model found
persisted
after epoch: 11,now: 2024-07-10 17:19:31.516823,epoch time: 0:21:23.578492,used: 4:17:16.323191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.980979, 'precision': 0.98050517, 'recall': 0.9690148, 'specificity': 0.9690148, 'f1': 0.97458434, 'auroc': 0.99582565, 'binary_precision': 0.9795772, 'binary_recall': 0.9447257, 'binary_specificity': 0.99330395, 'binary_f1_score': 0.96183586}
confusion matrix:
       0      1
0  42129    284
1    797  13622
---- Validation: 
scalar performance:
{'acc': 0.96125937, 'precision': 0.71084535, 'recall': 0.65660733, 'specificity': 0.65660733, 'f1': 0.6792156, 'auroc': 0.8874563, 'binary_precision': 0.44646466, 'binary_recall': 0.32838038, 'binary_specificity': 0.98483425, 'binary_f1_score': 0.37842467}
confusion matrix:
       0    1
0  17793  274
1    452  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9671286, 'precision': 0.8472131, 'recall': 0.67205685, 'specificity': 0.67205685, 'f1': 0.72726965, 'auroc': 0.90892667, 'binary_precision': 0.7222222, 'binary_recall': 0.35, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.47150254}
confusion matrix:
      0   1
0  5911  35
1   169  91
new oracle model saved
early stop counter: 1
val acc:0.9612593650817871, best validation acc: 0.9630736112594604, corresponding to test acc:                         0.9660006165504456 / 0.967128574848175
after epoch: 12,now: 2024-07-10 17:40:35.557338,epoch time: 0:21:04.040515,used: 4:38:20.363706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9808559, 'precision': 0.98140806, 'recall': 0.9678108, 'specificity': 0.9678108, 'f1': 0.97436464, 'auroc': 0.9960823, 'binary_precision': 0.9824828, 'binary_recall': 0.9413274, 'binary_specificity': 0.9942942, 'binary_f1_score': 0.9614648}
confusion matrix:
       0      1
0  42171    242
1    846  13573
---- Validation: 
scalar performance:
{'acc': 0.9617396, 'precision': 0.71486586, 'recall': 0.6561411, 'specificity': 0.6561411, 'f1': 0.68027717, 'auroc': 0.8875096, 'binary_precision': 0.45454547, 'binary_recall': 0.3268945, 'binary_specificity': 0.98538774, 'binary_f1_score': 0.38029385}
confusion matrix:
       0    1
0  17803  264
1    453  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.8501362, 'recall': 0.6815882, 'specificity': 0.6815882, 'f1': 0.7365785, 'auroc': 0.905025, 'binary_precision': 0.72727275, 'binary_recall': 0.36923078, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.48979592}
confusion matrix:
      0   1
0  5910  36
1   164  96
new oracle model saved
early stop counter: 2
val acc:0.9617395997047424, best validation acc: 0.9630736112594604, corresponding to test acc:                         0.9660006165504456 / 0.9677731394767761
after epoch: 13,now: 2024-07-10 18:01:44.319386,epoch time: 0:21:08.762048,used: 4:59:29.125754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9815773, 'precision': 0.9812449, 'recall': 0.9698752, 'specificity': 0.9698752, 'f1': 0.9753884, 'auroc': 0.9956284, 'binary_precision': 0.9805937, 'binary_recall': 0.9461165, 'binary_specificity': 0.99363387, 'binary_f1_score': 0.96304667}
confusion matrix:
       0      1
0  42142    270
1    777  13643
---- Validation: 
scalar performance:
{'acc': 0.96179295, 'precision': 0.7160329, 'recall': 0.6604604, 'specificity': 0.6604604, 'f1': 0.68363416, 'auroc': 0.8904651, 'binary_precision': 0.45656565, 'binary_recall': 0.3358098, 'binary_specificity': 0.985111, 'binary_f1_score': 0.38698632}
confusion matrix:
       0    1
0  17798  269
1    447  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.8384758, 'recall': 0.6963, 'specificity': 0.6963, 'f1': 0.7465714, 'auroc': 0.90666914, 'binary_precision': 0.7027027, 'binary_recall': 0.4, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.5098039}
confusion matrix:
      0    1
0  5902   44
1   156  104
early stop counter: 3
val acc:0.9617929458618164, best validation acc: 0.9630736112594604, corresponding to test acc:                         0.9660006165504456 / 0.9677731394767761
after epoch: 14,now: 2024-07-10 18:22:33.943774,epoch time: 0:20:49.624388,used: 5:20:18.750142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98166525, 'precision': 0.98188984, 'recall': 0.9694691, 'specificity': 0.9694691, 'f1': 0.97547525, 'auroc': 0.99557436, 'binary_precision': 0.98232836, 'binary_recall': 0.9447142, 'binary_specificity': 0.9942239, 'binary_f1_score': 0.9631542}
confusion matrix:
       0      1
0  42171    245
1    797  13619
---- Validation: 
scalar performance:
{'acc': 0.9623266, 'precision': 0.7162221, 'recall': 0.6314112, 'specificity': 0.6314112, 'f1': 0.66223633, 'auroc': 0.88901216, 'binary_precision': 0.45905706, 'binary_recall': 0.27488855, 'binary_specificity': 0.9879338, 'binary_f1_score': 0.34386617}
confusion matrix:
       0    1
0  17849  218
1    488  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.8341123, 'recall': 0.6358547, 'specificity': 0.6358547, 'f1': 0.6892592, 'auroc': 0.905473, 'binary_precision': 0.69902915, 'binary_recall': 0.2769231, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.3966942}
confusion matrix:
      0   1
0  5915  31
1   188  72
early stop counter: 4
val acc:0.9623265862464905, best validation acc: 0.9630736112594604, corresponding to test acc:                         0.9660006165504456 / 0.9677731394767761
after epoch: 15,now: 2024-07-10 18:44:51.937875,epoch time: 0:22:17.994101,used: 5:42:36.744243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98333687, 'precision': 0.9847673, 'recall': 0.97109985, 'specificity': 0.97109985, 'f1': 0.9776885, 'auroc': 0.9962479, 'binary_precision': 0.98755157, 'binary_recall': 0.9462552, 'binary_specificity': 0.99594456, 'binary_f1_score': 0.9664625}
confusion matrix:
       0      1
0  42240    172
1    775  13645
---- Validation: 
scalar performance:
{'acc': 0.9636606, 'precision': 0.7309243, 'recall': 0.62566566, 'specificity': 0.62566566, 'f1': 0.6610352, 'auroc': 0.8880974, 'binary_precision': 0.4888889, 'binary_recall': 0.2615156, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.34075508}
confusion matrix:
       0    1
0  17883  184
1    497  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.84988713, 'recall': 0.628667, 'specificity': 0.628667, 'f1': 0.68363714, 'auroc': 0.90450335, 'binary_precision': 0.7311828, 'binary_recall': 0.26153848, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.38526914}
confusion matrix:
      0   1
0  5921  25
1   192  68
better model found
persisted
after epoch: 16,now: 2024-07-10 19:07:18.232767,epoch time: 0:22:26.294892,used: 6:05:03.039135,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9831257, 'precision': 0.98245203, 'recall': 0.972786, 'specificity': 0.972786, 'f1': 0.9774952, 'auroc': 0.996456, 'binary_precision': 0.98112535, 'binary_recall': 0.95179635, 'binary_specificity': 0.99377567, 'binary_f1_score': 0.9662384}
confusion matrix:
       0      1
0  42150    264
1    695  13723
---- Validation: 
scalar performance:
{'acc': 0.9614194, 'precision': 0.7159694, 'recall': 0.6795789, 'specificity': 0.6795789, 'f1': 0.69588625, 'auroc': 0.8956148, 'binary_precision': 0.45503598, 'binary_recall': 0.37592867, 'binary_specificity': 0.9832291, 'binary_f1_score': 0.41171682}
confusion matrix:
       0    1
0  17764  303
1    420  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96777314, 'precision': 0.83476216, 'recall': 0.701817, 'specificity': 0.701817, 'f1': 0.75011945, 'auroc': 0.9091672, 'binary_precision': 0.6948052, 'binary_recall': 0.41153845, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.5169082}
confusion matrix:
      0    1
0  5899   47
1   153  107
early stop counter: 1
val acc:0.961419403553009, best validation acc: 0.9636605978012085, corresponding to test acc:                         0.9650338292121887 / 0.9677731394767761
after epoch: 17,now: 2024-07-10 19:35:00.051623,epoch time: 0:27:41.818856,used: 6:32:44.857991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98340726, 'precision': 0.9815304, 'recall': 0.97446394, 'specificity': 0.97446394, 'f1': 0.97793055, 'auroc': 0.9965323, 'binary_precision': 0.97780454, 'binary_recall': 0.95630765, 'binary_specificity': 0.99262017, 'binary_f1_score': 0.96693665}
confusion matrix:
       0      1
0  42100    313
1    630  13789
---- Validation: 
scalar performance:
{'acc': 0.9615795, 'precision': 0.7116281, 'recall': 0.6460443, 'specificity': 0.6460443, 'f1': 0.67207456, 'auroc': 0.8865159, 'binary_precision': 0.44880176, 'binary_recall': 0.3060921, 'binary_specificity': 0.98599654, 'binary_f1_score': 0.36395758}
confusion matrix:
       0    1
0  17814  253
1    467  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.8084974, 'recall': 0.64454514, 'specificity': 0.64454514, 'f1': 0.69381696, 'auroc': 0.898934, 'binary_precision': 0.64705884, 'binary_recall': 0.29615384, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.40633246}
confusion matrix:
      0   1
0  5904  42
1   183  77
early stop counter: 2
val acc:0.9615795016288757, best validation acc: 0.9636605978012085, corresponding to test acc:                         0.9650338292121887 / 0.9677731394767761
after epoch: 18,now: 2024-07-10 20:02:37.192674,epoch time: 0:27:37.141051,used: 7:00:21.999042,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98405826, 'precision': 0.9839765, 'recall': 0.97375417, 'specificity': 0.97375417, 'f1': 0.97872746, 'auroc': 0.99682397, 'binary_precision': 0.98381555, 'binary_recall': 0.95283675, 'binary_specificity': 0.9946716, 'binary_f1_score': 0.9680784}
confusion matrix:
       0      1
0  42188    226
1    680  13738
---- Validation: 
scalar performance:
{'acc': 0.96286017, 'precision': 0.7241978, 'recall': 0.64813906, 'specificity': 0.64813906, 'f1': 0.6774815, 'auroc': 0.89278704, 'binary_precision': 0.4738041, 'binary_recall': 0.30906388, 'binary_specificity': 0.98721427, 'binary_f1_score': 0.3741007}
confusion matrix:
       0    1
0  17836  231
1    465  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.8405857, 'recall': 0.68317485, 'specificity': 0.68317485, 'f1': 0.7358847, 'auroc': 0.9051256, 'binary_precision': 0.7080292, 'binary_recall': 0.37307692, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.48866498}
confusion matrix:
      0   1
0  5906  40
1   163  97
early stop counter: 3
val acc:0.9628601670265198, best validation acc: 0.9636605978012085, corresponding to test acc:                         0.9650338292121887 / 0.9677731394767761
after epoch: 19,now: 2024-07-10 20:30:09.021298,epoch time: 0:27:31.828624,used: 7:27:53.827666,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9849381, 'precision': 0.9850464, 'recall': 0.9750318, 'specificity': 0.9750318, 'f1': 0.97990704, 'auroc': 0.9969622, 'binary_precision': 0.9852594, 'binary_recall': 0.9549206, 'binary_specificity': 0.995143, 'binary_f1_score': 0.96985275}
confusion matrix:
       0      1
0  42207    206
1    650  13769
---- Validation: 
scalar performance:
{'acc': 0.96286017, 'precision': 0.7251884, 'recall': 0.6567223, 'specificity': 0.6567223, 'f1': 0.68408686, 'auroc': 0.8947809, 'binary_precision': 0.475162, 'binary_recall': 0.3268945, 'binary_specificity': 0.9865501, 'binary_f1_score': 0.38732395}
confusion matrix:
       0    1
0  17824  243
1    453  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.8405857, 'recall': 0.68317485, 'specificity': 0.68317485, 'f1': 0.7358847, 'auroc': 0.9048921, 'binary_precision': 0.7080292, 'binary_recall': 0.37307692, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.48866498}
confusion matrix:
      0   1
0  5906  40
1   163  97
early stop counter: 4
val acc:0.9628601670265198, best validation acc: 0.9636605978012085, corresponding to test acc:                         0.9650338292121887 / 0.9677731394767761
after epoch: 20,now: 2024-07-10 20:52:19.647213,epoch time: 0:22:10.625915,used: 7:50:04.453581,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98419905, 'precision': 0.9860234, 'recall': 0.97215813, 'specificity': 0.97215813, 'f1': 0.9788394, 'auroc': 0.99692, 'binary_precision': 0.98957276, 'binary_recall': 0.9477115, 'binary_specificity': 0.99660474, 'binary_f1_score': 0.9681899}
confusion matrix:
       0      1
0  42268    144
1    754  13666
---- Validation: 
scalar performance:
{'acc': 0.96344715, 'precision': 0.72734493, 'recall': 0.61697173, 'specificity': 0.61697173, 'f1': 0.65250325, 'auroc': 0.88441867, 'binary_precision': 0.48235294, 'binary_recall': 0.24368499, 'binary_specificity': 0.99025846, 'binary_f1_score': 0.32379073}
confusion matrix:
       0    1
0  17891  176
1    509  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7959626, 'recall': 0.5880301, 'specificity': 0.5880301, 'f1': 0.6303209, 'auroc': 0.8931235, 'binary_precision': 0.62666667, 'binary_recall': 0.18076923, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.28059703}
confusion matrix:
      0   1
0  5918  28
1   213  47
early stop counter: 5
val acc:0.9634471535682678, best validation acc: 0.9636605978012085, corresponding to test acc:                         0.9650338292121887 / 0.9677731394767761
after epoch: 21,now: 2024-07-10 21:14:27.649771,epoch time: 0:22:08.002558,used: 8:12:12.456139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9840935, 'precision': 0.9863174, 'recall': 0.9716013, 'specificity': 0.9716013, 'f1': 0.9786767, 'auroc': 0.9970479, 'binary_precision': 0.9906325, 'binary_recall': 0.946244, 'binary_specificity': 0.9969586, 'binary_f1_score': 0.96792954}
confusion matrix:
       0      1
0  42286    129
1    775  13642
---- Validation: 
scalar performance:
{'acc': 0.9632871, 'precision': 0.72711813, 'recall': 0.6333399, 'specificity': 0.6333399, 'f1': 0.666637, 'auroc': 0.8898425, 'binary_precision': 0.4807198, 'binary_recall': 0.2778603, 'binary_specificity': 0.9888194, 'binary_f1_score': 0.35216573}
confusion matrix:
       0    1
0  17865  202
1    486  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.83255756, 'recall': 0.63393164, 'specificity': 0.63393164, 'f1': 0.68700397, 'auroc': 0.89647985, 'binary_precision': 0.6960784, 'binary_recall': 0.27307692, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.3922652}
confusion matrix:
      0   1
0  5915  31
1   189  71
early stop counter: 6
val acc:0.9632871150970459, best validation acc: 0.9636605978012085, corresponding to test acc:                         0.9650338292121887 / 0.9677731394767761
after epoch: 22,now: 2024-07-10 21:35:46.819917,epoch time: 0:21:19.170146,used: 8:33:31.626285,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98495567, 'precision': 0.9839021, 'recall': 0.9762122, 'specificity': 0.9762122, 'f1': 0.9799789, 'auroc': 0.99710166, 'binary_precision': 0.9818143, 'binary_recall': 0.95846045, 'binary_specificity': 0.99396396, 'binary_f1_score': 0.96999687}
confusion matrix:
       0      1
0  42156    256
1    599  13821
---- Validation: 
scalar performance:
{'acc': 0.9618997, 'precision': 0.7213484, 'recall': 0.6927028, 'specificity': 0.6927028, 'f1': 0.705909, 'auroc': 0.9008814, 'binary_precision': 0.46483704, 'binary_recall': 0.4026746, 'binary_specificity': 0.9827309, 'binary_f1_score': 0.43152866}
confusion matrix:
       0    1
0  17755  312
1    402  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96793425, 'precision': 0.82105553, 'recall': 0.73132485, 'specificity': 0.73132485, 'f1': 0.76808995, 'auroc': 0.90741205, 'binary_precision': 0.66486484, 'binary_recall': 0.4730769, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.55280894}
confusion matrix:
      0    1
0  5884   62
1   137  123
new oracle model saved
early stop counter: 7
val acc:0.9618996977806091, best validation acc: 0.9636605978012085, corresponding to test acc:                         0.9650338292121887 / 0.967934250831604
after epoch: 23,now: 2024-07-10 21:57:57.073053,epoch time: 0:22:10.253136,used: 8:55:41.879421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98574746, 'precision': 0.9862555, 'recall': 0.97598755, 'specificity': 0.97598755, 'f1': 0.98098326, 'auroc': 0.9975221, 'binary_precision': 0.98725474, 'binary_recall': 0.956172, 'binary_specificity': 0.99580306, 'binary_f1_score': 0.9714648}
confusion matrix:
       0      1
0  42234    178
1    632  13788
---- Validation: 
scalar performance:
{'acc': 0.9625934, 'precision': 0.7214292, 'recall': 0.6472854, 'specificity': 0.6472854, 'f1': 0.6760118, 'auroc': 0.89203584, 'binary_precision': 0.4683258, 'binary_recall': 0.307578, 'binary_specificity': 0.98699284, 'binary_f1_score': 0.37130043}
confusion matrix:
       0    1
0  17832  235
1    466  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.8188597, 'recall': 0.65800667, 'specificity': 0.65800667, 'f1': 0.7085529, 'auroc': 0.8954941, 'binary_precision': 0.6666667, 'binary_recall': 0.32307693, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.4352332}
confusion matrix:
      0   1
0  5904  42
1   176  84
early stop counter: 8
val acc:0.9625933766365051, best validation acc: 0.9636605978012085, corresponding to test acc:                         0.9650338292121887 / 0.967934250831604
after epoch: 24,now: 2024-07-10 22:19:28.747812,epoch time: 0:21:31.674759,used: 9:17:13.554180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9860642, 'precision': 0.98647046, 'recall': 0.97661024, 'specificity': 0.97661024, 'f1': 0.98141277, 'auroc': 0.9971298, 'binary_precision': 0.98727024, 'binary_recall': 0.9574173, 'binary_specificity': 0.9958032, 'binary_f1_score': 0.97211456}
confusion matrix:
       0      1
0  42235    178
1    614  13805
---- Validation: 
scalar performance:
{'acc': 0.9628068, 'precision': 0.7265854, 'recall': 0.6745763, 'specificity': 0.6745763, 'f1': 0.6968003, 'auroc': 0.90074265, 'binary_precision': 0.4766537, 'binary_recall': 0.3640416, 'binary_specificity': 0.985111, 'binary_f1_score': 0.4128054}
confusion matrix:
       0    1
0  17798  269
1    428  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.8119307, 'recall': 0.7365055, 'specificity': 0.7365055, 'f1': 0.76843435, 'auroc': 0.9029149, 'binary_precision': 0.64615387, 'binary_recall': 0.4846154, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.5538462}
confusion matrix:
      0    1
0  5877   69
1   134  126
early stop counter: 9
val acc:0.9628068208694458, best validation acc: 0.9636605978012085, corresponding to test acc:                         0.9650338292121887 / 0.967934250831604
after epoch: 25,now: 2024-07-10 22:40:49.008343,epoch time: 0:21:20.260531,used: 9:38:33.814711,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98625773, 'precision': 0.98627436, 'recall': 0.9773121, 'specificity': 0.9773121, 'f1': 0.98168766, 'auroc': 0.9975378, 'binary_precision': 0.9863072, 'binary_recall': 0.95915115, 'binary_specificity': 0.9954731, 'binary_f1_score': 0.9725396}
confusion matrix:
       0      1
0  42221    192
1    589  13830
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.7320621, 'recall': 0.6492418, 'specificity': 0.6492418, 'f1': 0.6806267, 'auroc': 0.8992661, 'binary_precision': 0.48946136, 'binary_recall': 0.31054977, 'binary_specificity': 0.9879338, 'binary_f1_score': 0.37999997}
confusion matrix:
       0    1
0  17849  218
1    464  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.8431626, 'recall': 0.67004967, 'specificity': 0.67004967, 'f1': 0.72459584, 'auroc': 0.904145, 'binary_precision': 0.71428573, 'binary_recall': 0.34615386, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.46632126}
confusion matrix:
      0   1
0  5910  36
1   170  90
early stop counter: 10
val acc:0.9636072516441345, best validation acc: 0.9636605978012085, corresponding to test acc:                         0.9650338292121887 / 0.967934250831604
after epoch: 26,now: 2024-07-10 23:02:05.098783,epoch time: 0:21:16.090440,used: 9:59:49.905151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9875246, 'precision': 0.9862931, 'recall': 0.98065567, 'specificity': 0.98065567, 'f1': 0.9834324, 'auroc': 0.9977114, 'binary_precision': 0.9838368, 'binary_recall': 0.96671057, 'binary_specificity': 0.9946007, 'binary_f1_score': 0.97519845}
confusion matrix:
       0      1
0  42184    229
1    480  13939
---- Validation: 
scalar performance:
{'acc': 0.96093917, 'precision': 0.71280897, 'recall': 0.6821909, 'specificity': 0.6821909, 'f1': 0.696159, 'auroc': 0.8971005, 'binary_precision': 0.44851658, 'binary_recall': 0.3818722, 'binary_specificity': 0.98250955, 'binary_f1_score': 0.41252005}
confusion matrix:
       0    1
0  17751  316
1    416  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.80018944, 'recall': 0.7003875, 'specificity': 0.7003875, 'f1': 0.7392038, 'auroc': 0.90216756, 'binary_precision': 0.625731, 'binary_recall': 0.41153845, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.49651968}
confusion matrix:
      0    1
0  5882   64
1   153  107
early stop counter: 11
val acc:0.9609391689300537, best validation acc: 0.9636605978012085, corresponding to test acc:                         0.9650338292121887 / 0.967934250831604
after epoch: 27,now: 2024-07-10 23:25:43.548777,epoch time: 0:23:38.449994,used: 10:23:28.355145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98652166, 'precision': 0.9867109, 'recall': 0.9775791, 'specificity': 0.9775791, 'f1': 0.98203564, 'auroc': 0.99750936, 'binary_precision': 0.9870843, 'binary_recall': 0.95942575, 'binary_specificity': 0.99573255, 'binary_f1_score': 0.9730585}
confusion matrix:
       0      1
0  42233    181
1    585  13833
---- Validation: 
scalar performance:
{'acc': 0.9625934, 'precision': 0.72450566, 'recall': 0.67231977, 'specificity': 0.67231977, 'f1': 0.69456244, 'auroc': 0.89977217, 'binary_precision': 0.47265625, 'binary_recall': 0.35958394, 'binary_specificity': 0.9850556, 'binary_f1_score': 0.4084388}
confusion matrix:
       0    1
0  17797  270
1    431  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.8222501, 'recall': 0.68442523, 'specificity': 0.68442523, 'f1': 0.73263365, 'auroc': 0.90250427, 'binary_precision': 0.6712329, 'binary_recall': 0.37692308, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.4827586}
confusion matrix:
      0   1
0  5898  48
1   162  98
early stop counter: 12
val acc:0.9625933766365051, best validation acc: 0.9636605978012085, corresponding to test acc:                         0.9650338292121887 / 0.967934250831604
after epoch: 28,now: 2024-07-10 23:48:01.752367,epoch time: 0:22:18.203590,used: 10:45:46.558735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9880525, 'precision': 0.98824275, 'recall': 0.98011553, 'specificity': 0.98011553, 'f1': 0.9840927, 'auroc': 0.9980141, 'binary_precision': 0.9886194, 'binary_recall': 0.9640033, 'binary_specificity': 0.9962277, 'binary_f1_score': 0.97615623}
confusion matrix:
       0      1
0  42254    160
1    519  13899
---- Validation: 
scalar performance:
{'acc': 0.96195304, 'precision': 0.7115594, 'recall': 0.62764114, 'specificity': 0.62764114, 'f1': 0.65796185, 'auroc': 0.89051235, 'binary_precision': 0.45, 'binary_recall': 0.26745912, 'binary_specificity': 0.9878231, 'binary_f1_score': 0.33550793}
confusion matrix:
       0    1
0  17847  220
1    493  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.81231755, 'recall': 0.62214094, 'specificity': 0.62214094, 'f1': 0.6715588, 'auroc': 0.8958707, 'binary_precision': 0.65656567, 'binary_recall': 0.25, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.362117}
confusion matrix:
      0   1
0  5912  34
1   195  65
early stop counter: 13
val acc:0.9619530439376831, best validation acc: 0.9636605978012085, corresponding to test acc:                         0.9650338292121887 / 0.967934250831604
after epoch: 29,now: 2024-07-11 00:10:39.613358,epoch time: 0:22:37.860991,used: 11:08:24.419726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9871199, 'precision': 0.9864247, 'recall': 0.9794449, 'specificity': 0.9794449, 'f1': 0.9828707, 'auroc': 0.9979527, 'binary_precision': 0.98504394, 'binary_recall': 0.9638646, 'binary_specificity': 0.9950252, 'binary_f1_score': 0.9743392}
confusion matrix:
       0      1
0  42203    211
1    521  13897
---- Validation: 
scalar performance:
{'acc': 0.9621665, 'precision': 0.7172608, 'recall': 0.64706403, 'specificity': 0.64706403, 'f1': 0.6745771, 'auroc': 0.90109587, 'binary_precision': 0.46, 'binary_recall': 0.307578, 'binary_specificity': 0.9865501, 'binary_f1_score': 0.36865538}
confusion matrix:
       0    1
0  17824  243
1    466  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.8141451, 'recall': 0.695375, 'specificity': 0.695375, 'f1': 0.7394132, 'auroc': 0.9057716, 'binary_precision': 0.6540881, 'binary_recall': 0.4, 'binary_specificity': 0.9907501, 'binary_f1_score': 0.49642006}
confusion matrix:
      0    1
0  5891   55
1   156  104
early stop counter: 14
val acc:0.9621664881706238, best validation acc: 0.9636605978012085, corresponding to test acc:                         0.9650338292121887 / 0.967934250831604
after epoch: 30,now: 2024-07-11 00:32:00.403110,epoch time: 0:21:20.789752,used: 11:29:45.209478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_13_02_15_seed_1_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:29:45.209478 at 2024-07-11 00:32:00.403110
persisted model performance metric: 

scalar performance:
{'acc': 0.9650338, 'precision': 0.84988713, 'recall': 0.628667, 'specificity': 0.628667, 'f1': 0.68363714, 'auroc': 0.90450335, 'binary_precision': 0.7311828, 'binary_recall': 0.26153848, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.38526914}
confusion matrix:
      0   1
0  5921  25
1   192  68
oracle model performance metric: 

scalar performance:
{'acc': 0.96793425, 'precision': 0.82105553, 'recall': 0.73132485, 'specificity': 0.73132485, 'f1': 0.76808995, 'auroc': 0.90741205, 'binary_precision': 0.66486484, 'binary_recall': 0.4730769, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.55280894}
confusion matrix:
      0    1
0  5884   62
1   137  123
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |  17479 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |  17479 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   7827 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   2320 TiB |   2320 TiB |
|       from small pool |  16480 KiB |     36 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8530 MiB |  16792 MiB |   8278 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  16734 MiB |   8260 MiB |
|       from small pool |     40 MiB |     44 MiB |     58 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40878 KiB | 732464 KiB |   1304 TiB |   1304 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1274 TiB |   1274 TiB |
|       from small pool |   9145 KiB |  23272 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7625    |  388810 K  |  388807 K  |
|       from large pool |      79    |     762    |  220130 K  |  220130 K  |
|       from small pool |    2875    |    7544    |  168679 K  |  168676 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7625    |  388810 K  |  388807 K  |
|       from large pool |      79    |     762    |  220130 K  |  220130 K  |
|       from small pool |    2875    |    7544    |  168679 K  |  168676 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     371    |     716    |     347    |
|       from large pool |     349    |     349    |     687    |     338    |
|       from small pool |      20    |      22    |      29    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3589    |  230719 K  |  230719 K  |
|       from large pool |      11    |     352    |  159260 K  |  159260 K  |
|       from small pool |      26    |    3579    |   71459 K  |   71459 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     36 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  16792 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  26624 KiB |     44 MiB |     58 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1304 TiB |   1304 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1274 TiB |   1274 TiB |
|       from small pool |      0 KiB |  23284 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  388810 K  |  388810 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168679 K  |  168679 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  388810 K  |  388810 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168679 K  |  168679 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     716    |     693    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      13    |      22    |      29    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  230721 K  |  230721 K  |
|       from large pool |       3    |     352    |  159260 K  |  159260 K  |
|       from small pool |       0    |    3579    |   71460 K  |   71460 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     36 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  16792 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  26624 KiB |     44 MiB |     58 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1304 TiB |   1304 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1274 TiB |   1274 TiB |
|       from small pool |      0 KiB |  23284 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  388810 K  |  388810 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168679 K  |  168679 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  388810 K  |  388810 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168679 K  |  168679 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     716    |     693    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      13    |      22    |      29    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  230721 K  |  230721 K  |
|       from large pool |       3    |     352    |  159260 K  |  159260 K  |
|       from small pool |       0    |    3579    |   71460 K  |   71460 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614

 Experiment start at: 2024-07-11 00:50:57.579096
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94381964, 'precision': 0.9470103, 'recall': 0.90649307, 'specificity': 0.90649307, 'f1': 0.92429405, 'auroc': 0.9692353, 'binary_precision': 0.95289195, 'binary_recall': 0.82761586, 'binary_specificity': 0.9853702, 'binary_f1_score': 0.8858467}
confusion matrix:
       0      1
0  41692    619
1   2608  12521
---- Validation: 
scalar performance:
{'acc': 0.9553614, 'precision': 0.6206166, 'recall': 0.6019177, 'specificity': 0.6019177, 'f1': 0.61034214, 'auroc': 0.78999925, 'binary_precision': 0.2667984, 'binary_recall': 0.22425249, 'binary_specificity': 0.97958285, 'binary_f1_score': 0.24368231}
confusion matrix:
       0    1
0  17800  371
1    467  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9241866, 'precision': 0.51663923, 'recall': 0.5184125, 'specificity': 0.5184125, 'f1': 0.51741934, 'auroc': 0.65058076, 'binary_precision': 0.07063197, 'binary_recall': 0.0785124, 'binary_specificity': 0.9583125, 'binary_f1_score': 0.07436399}
confusion matrix:
      0    1
0  5747  250
1   223   19
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 01:12:59.709746,epoch time: 0:22:02.130650,used: 0:22:02.130650,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95980155, 'precision': 0.96314925, 'recall': 0.93252605, 'specificity': 0.93252605, 'f1': 0.94648015, 'auroc': 0.98058724, 'binary_precision': 0.9695305, 'binary_recall': 0.8748843, 'binary_specificity': 0.9901678, 'binary_f1_score': 0.919779}
confusion matrix:
       0      1
0  41894    416
1   1893  13237
---- Validation: 
scalar performance:
{'acc': 0.963032, 'precision': 0.6714485, 'recall': 0.60106176, 'specificity': 0.60106176, 'f1': 0.6260218, 'auroc': 0.8197221, 'binary_precision': 0.36857143, 'binary_recall': 0.21428572, 'binary_specificity': 0.9878378, 'binary_f1_score': 0.27100843}
confusion matrix:
       0    1
0  17950  221
1    473  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9390928, 'precision': 0.54227877, 'recall': 0.53211457, 'specificity': 0.53211457, 'f1': 0.53612435, 'auroc': 0.73492396, 'binary_precision': 0.12087912, 'binary_recall': 0.09090909, 'binary_specificity': 0.97332, 'binary_f1_score': 0.10377359}
confusion matrix:
      0    1
0  5837  160
1   220   22
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-11 01:34:36.813888,epoch time: 0:21:37.104142,used: 0:43:39.234792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9631441, 'precision': 0.9679079, 'recall': 0.9367057, 'specificity': 0.9367057, 'f1': 0.95091695, 'auroc': 0.98547727, 'binary_precision': 0.97698116, 'binary_recall': 0.8808328, 'binary_specificity': 0.99257857, 'binary_f1_score': 0.92641896}
confusion matrix:
       0      1
0  41996    314
1   1803  13327
---- Validation: 
scalar performance:
{'acc': 0.9650562, 'precision': 0.6929945, 'recall': 0.59969825, 'specificity': 0.59969825, 'f1': 0.6298141, 'auroc': 0.8413024, 'binary_precision': 0.4117647, 'binary_recall': 0.20930232, 'binary_specificity': 0.9900941, 'binary_f1_score': 0.27753302}
confusion matrix:
       0    1
0  17991  180
1    476  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9472672, 'precision': 0.59444755, 'recall': 0.5621423, 'specificity': 0.5621423, 'f1': 0.5741006, 'auroc': 0.79432213, 'binary_precision': 0.22292994, 'binary_recall': 0.1446281, 'binary_specificity': 0.9796565, 'binary_f1_score': 0.1754386}
confusion matrix:
      0    1
0  5875  122
1   207   35
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-11 01:56:09.821106,epoch time: 0:21:33.007218,used: 1:05:12.242010,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9674791, 'precision': 0.96876514, 'recall': 0.94684505, 'specificity': 0.94684505, 'f1': 0.95711267, 'auroc': 0.98775536, 'binary_precision': 0.9712864, 'binary_recall': 0.9032386, 'binary_specificity': 0.99045146, 'binary_f1_score': 0.93602735}
confusion matrix:
       0      1
0  41906    404
1   1464  13666
---- Validation: 
scalar performance:
{'acc': 0.96681404, 'precision': 0.7163164, 'recall': 0.59337884, 'specificity': 0.59337884, 'f1': 0.6280325, 'auroc': 0.8520471, 'binary_precision': 0.45882353, 'binary_recall': 0.19435216, 'binary_specificity': 0.9924055, 'binary_f1_score': 0.2730455}
confusion matrix:
       0    1
0  18033  138
1    485  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95095366, 'precision': 0.6269924, 'recall': 0.57992184, 'specificity': 0.57992184, 'f1': 0.5970346, 'auroc': 0.8266798, 'binary_precision': 0.28666666, 'binary_recall': 0.17768595, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.21938774}
confusion matrix:
      0    1
0  5890  107
1   199   43
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-11 02:17:54.759022,epoch time: 0:21:44.937916,used: 1:26:57.179926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97082174, 'precision': 0.9742186, 'recall': 0.9502968, 'specificity': 0.9502968, 'f1': 0.9614476, 'auroc': 0.9908924, 'binary_precision': 0.98084074, 'binary_recall': 0.9069275, 'binary_specificity': 0.9936661, 'binary_f1_score': 0.9424371}
confusion matrix:
       0      1
0  42044    268
1   1408  13720
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.70979667, 'recall': 0.59476477, 'specificity': 0.59476477, 'f1': 0.6283369, 'auroc': 0.8574598, 'binary_precision': 0.4456929, 'binary_recall': 0.19767442, 'binary_specificity': 0.99185514, 'binary_f1_score': 0.27387804}
confusion matrix:
       0    1
0  18023  148
1    483  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94967145, 'precision': 0.63205844, 'recall': 0.5970995, 'specificity': 0.5970995, 'f1': 0.6113836, 'auroc': 0.8469393, 'binary_precision': 0.29545453, 'binary_recall': 0.21487603, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.24880384}
confusion matrix:
      0    1
0  5873  124
1   190   52
early stop counter: 1
val acc:0.9663878679275513, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 5,now: 2024-07-11 02:39:06.101900,epoch time: 0:21:11.342878,used: 1:48:08.522804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9718489, 'precision': 0.97494066, 'recall': 0.95223135, 'specificity': 0.95223135, 'f1': 0.96285605, 'auroc': 0.9913988, 'binary_precision': 0.9809924, 'binary_recall': 0.9107733, 'binary_specificity': 0.9936894, 'binary_f1_score': 0.94457966}
confusion matrix:
       0      1
0  42043    267
1   1350  13780
---- Validation: 
scalar performance:
{'acc': 0.96558887, 'precision': 0.70658994, 'recall': 0.6224587, 'specificity': 0.6224587, 'f1': 0.6525985, 'auroc': 0.86615074, 'binary_precision': 0.4375, 'binary_recall': 0.25581396, 'binary_specificity': 0.9891035, 'binary_f1_score': 0.32285115}
confusion matrix:
       0    1
0  17973  198
1    448  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9458246, 'precision': 0.63303125, 'recall': 0.6288051, 'specificity': 0.6288051, 'f1': 0.630877, 'auroc': 0.8609036, 'binary_precision': 0.2948718, 'binary_recall': 0.28512397, 'binary_specificity': 0.97248626, 'binary_f1_score': 0.28991598}
confusion matrix:
      0    1
0  5832  165
1   173   69
early stop counter: 2
val acc:0.9655888676643372, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 6,now: 2024-07-11 03:00:25.868313,epoch time: 0:21:19.766413,used: 2:09:28.289217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9760097, 'precision': 0.97648346, 'recall': 0.96136093, 'specificity': 0.96136093, 'f1': 0.9685965, 'auroc': 0.99224675, 'binary_precision': 0.9774337, 'binary_recall': 0.9304032, 'binary_specificity': 0.99231863, 'binary_f1_score': 0.9533387}
confusion matrix:
       0      1
0  41985    325
1   1053  14077
---- Validation: 
scalar performance:
{'acc': 0.9650562, 'precision': 0.70608103, 'recall': 0.6438659, 'specificity': 0.6438659, 'f1': 0.6688202, 'auroc': 0.8701319, 'binary_precision': 0.43509614, 'binary_recall': 0.30066445, 'binary_specificity': 0.9870673, 'binary_f1_score': 0.35559925}
confusion matrix:
       0    1
0  17936  235
1    421  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9400545, 'precision': 0.6306457, 'recall': 0.66545844, 'specificity': 0.66545844, 'f1': 0.64555186, 'auroc': 0.8676673, 'binary_precision': 0.28709677, 'binary_recall': 0.3677686, 'binary_specificity': 0.96314824, 'binary_f1_score': 0.32246375}
confusion matrix:
      0    1
0  5776  221
1   153   89
early stop counter: 3
val acc:0.9650561809539795, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 7,now: 2024-07-11 03:21:49.702686,epoch time: 0:21:23.834373,used: 2:30:52.123590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97660166, 'precision': 0.9782568, 'recall': 0.9611895, 'specificity': 0.9611895, 'f1': 0.96931154, 'auroc': 0.99347687, 'binary_precision': 0.98155653, 'binary_recall': 0.9286186, 'binary_specificity': 0.99376035, 'binary_f1_score': 0.9543541}
confusion matrix:
       0      1
0  42046    264
1   1080  14050
---- Validation: 
scalar performance:
{'acc': 0.9667075, 'precision': 0.7192513, 'recall': 0.61580914, 'specificity': 0.61580914, 'f1': 0.64993894, 'auroc': 0.86900365, 'binary_precision': 0.46325877, 'binary_recall': 0.24086379, 'binary_specificity': 0.9907545, 'binary_f1_score': 0.3169399}
confusion matrix:
       0    1
0  18003  168
1    457  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9483892, 'precision': 0.6438905, 'recall': 0.6301391, 'specificity': 0.6301391, 'f1': 0.6366034, 'auroc': 0.86971104, 'binary_precision': 0.31651375, 'binary_recall': 0.28512397, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.29999998}
confusion matrix:
      0    1
0  5848  149
1   173   69
early stop counter: 4
val acc:0.9667075276374817, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 8,now: 2024-07-11 03:43:07.197501,epoch time: 0:21:17.494815,used: 2:52:09.618405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9774547, 'precision': 0.9779072, 'recall': 0.9636983, 'specificity': 0.9636983, 'f1': 0.9705161, 'auroc': 0.993501, 'binary_precision': 0.97881764, 'binary_recall': 0.93462884, 'binary_specificity': 0.9927678, 'binary_f1_score': 0.95621306}
confusion matrix:
       0      1
0  42005    306
1    989  14140
---- Validation: 
scalar performance:
{'acc': 0.96526927, 'precision': 0.7104907, 'recall': 0.6552186, 'specificity': 0.6552186, 'f1': 0.6782096, 'auroc': 0.8732722, 'binary_precision': 0.4431818, 'binary_recall': 0.32392028, 'binary_specificity': 0.98651695, 'binary_f1_score': 0.37428024}
confusion matrix:
       0    1
0  17926  245
1    407  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93893254, 'precision': 0.63681555, 'recall': 0.6906504, 'specificity': 0.6906504, 'f1': 0.6583411, 'auroc': 0.871814, 'binary_precision': 0.2973761, 'binary_recall': 0.4214876, 'binary_specificity': 0.95981324, 'binary_f1_score': 0.34871796}
confusion matrix:
      0    1
0  5756  241
1   140  102
early stop counter: 5
val acc:0.9652692675590515, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 9,now: 2024-07-11 04:04:14.728701,epoch time: 0:21:07.531200,used: 3:13:17.149605,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97926533, 'precision': 0.97910273, 'recall': 0.967201, 'specificity': 0.967201, 'f1': 0.9729507, 'auroc': 0.99488854, 'binary_precision': 0.9787731, 'binary_recall': 0.9417052, 'binary_specificity': 0.99269676, 'binary_f1_score': 0.9598814}
confusion matrix:
       0      1
0  42001    309
1    882  14248
---- Validation: 
scalar performance:
{'acc': 0.96542907, 'precision': 0.71372664, 'recall': 0.66493773, 'specificity': 0.66493773, 'f1': 0.6858374, 'auroc': 0.8778584, 'binary_precision': 0.44902387, 'binary_recall': 0.34385383, 'binary_specificity': 0.9860217, 'binary_f1_score': 0.3894638}
confusion matrix:
       0    1
0  17917  254
1    395  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.941497, 'precision': 0.6503514, 'recall': 0.71181184, 'specificity': 0.71181184, 'f1': 0.6748025, 'auroc': 0.8757755, 'binary_precision': 0.32276657, 'binary_recall': 0.46280992, 'binary_specificity': 0.96081376, 'binary_f1_score': 0.38030562}
confusion matrix:
      0    1
0  5762  235
1   130  112
early stop counter: 6
val acc:0.9654290676116943, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 10,now: 2024-07-11 04:25:18.913341,epoch time: 0:21:04.184640,used: 3:34:21.334245,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9798224, 'precision': 0.9817494, 'recall': 0.96609306, 'specificity': 0.96609306, 'f1': 0.9735774, 'auroc': 0.9947643, 'binary_precision': 0.98561, 'binary_recall': 0.93707865, 'binary_specificity': 0.99510753, 'binary_f1_score': 0.9607318}
confusion matrix:
       0      1
0  42103    207
1    952  14178
---- Validation: 
scalar performance:
{'acc': 0.96644115, 'precision': 0.7196252, 'recall': 0.6381569, 'specificity': 0.6381569, 'f1': 0.66864043, 'auroc': 0.87844056, 'binary_precision': 0.46256685, 'binary_recall': 0.28737542, 'binary_specificity': 0.9889384, 'binary_f1_score': 0.35450816}
confusion matrix:
       0    1
0  17970  201
1    429  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94662607, 'precision': 0.6634619, 'recall': 0.70258343, 'specificity': 0.70258343, 'f1': 0.6805425, 'auroc': 0.8780451, 'binary_precision': 0.34983498, 'binary_recall': 0.43801653, 'binary_specificity': 0.9671503, 'binary_f1_score': 0.38899082}
confusion matrix:
      0    1
0  5800  197
1   136  106
early stop counter: 7
val acc:0.9664411544799805, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 11,now: 2024-07-11 04:46:21.477300,epoch time: 0:21:02.563959,used: 3:55:23.898204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9799443, 'precision': 0.98279226, 'recall': 0.9654307, 'specificity': 0.9654307, 'f1': 0.97369087, 'auroc': 0.9951833, 'binary_precision': 0.98846716, 'binary_recall': 0.93476105, 'binary_specificity': 0.9961003, 'binary_f1_score': 0.9608642}
confusion matrix:
       0      1
0  42146    165
1    987  14142
---- Validation: 
scalar performance:
{'acc': 0.96665424, 'precision': 0.7214292, 'recall': 0.63344866, 'specificity': 0.63344866, 'f1': 0.6654031, 'auroc': 0.88067937, 'binary_precision': 0.46648043, 'binary_recall': 0.27740863, 'binary_specificity': 0.9894887, 'binary_f1_score': 0.34791663}
confusion matrix:
       0    1
0  17980  191
1    435  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9463055, 'precision': 0.65744936, 'recall': 0.6865547, 'specificity': 0.6865547, 'f1': 0.67053723, 'auroc': 0.876842, 'binary_precision': 0.33910036, 'binary_recall': 0.40495867, 'binary_specificity': 0.96815073, 'binary_f1_score': 0.3691149}
confusion matrix:
      0    1
0  5806  191
1   144   98
early stop counter: 8
val acc:0.9666542410850525, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 12,now: 2024-07-11 05:07:30.199319,epoch time: 0:21:08.722019,used: 4:16:32.620223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9810759, 'precision': 0.98294175, 'recall': 0.96815217, 'specificity': 0.96815217, 'f1': 0.9752408, 'auroc': 0.99525726, 'binary_precision': 0.9866907, 'binary_recall': 0.9408421, 'binary_specificity': 0.9954622, 'binary_f1_score': 0.96322113}
confusion matrix:
       0      1
0  42119    192
1    895  14234
---- Validation: 
scalar performance:
{'acc': 0.9653758, 'precision': 0.71365154, 'recall': 0.6673194, 'specificity': 0.6673194, 'f1': 0.6873517, 'auroc': 0.88523924, 'binary_precision': 0.44871795, 'binary_recall': 0.3488372, 'binary_specificity': 0.9858016, 'binary_f1_score': 0.39252338}
confusion matrix:
       0    1
0  17913  258
1    392  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93781054, 'precision': 0.6461521, 'recall': 0.7297216, 'specificity': 0.7297216, 'f1': 0.67666113, 'auroc': 0.8782394, 'binary_precision': 0.31282052, 'binary_recall': 0.5041322, 'binary_specificity': 0.955311, 'binary_f1_score': 0.38607597}
confusion matrix:
      0    1
0  5729  268
1   120  122
early stop counter: 9
val acc:0.9653757810592651, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 13,now: 2024-07-11 05:28:40.350329,epoch time: 0:21:10.151010,used: 4:37:42.771233,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9814241, 'precision': 0.98228586, 'recall': 0.96966416, 'specificity': 0.96966416, 'f1': 0.9757509, 'auroc': 0.99576247, 'binary_precision': 0.9840297, 'binary_recall': 0.94481164, 'binary_specificity': 0.9945167, 'binary_f1_score': 0.964022}
confusion matrix:
       0      1
0  42078    232
1    835  14295
---- Validation: 
scalar performance:
{'acc': 0.96500295, 'precision': 0.7107807, 'recall': 0.66953593, 'specificity': 0.66953593, 'f1': 0.6876668, 'auroc': 0.88458747, 'binary_precision': 0.44282743, 'binary_recall': 0.3538206, 'binary_specificity': 0.98525125, 'binary_f1_score': 0.3933518}
confusion matrix:
       0    1
0  17903  268
1    389  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9339638, 'precision': 0.6334854, 'recall': 0.7158242, 'specificity': 0.7158242, 'f1': 0.66271675, 'auroc': 0.87387705, 'binary_precision': 0.2885572, 'binary_recall': 0.47933885, 'binary_specificity': 0.9523095, 'binary_f1_score': 0.36024845}
confusion matrix:
      0    1
0  5711  286
1   126  116
early stop counter: 10
val acc:0.9650029540061951, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 14,now: 2024-07-11 05:49:43.762547,epoch time: 0:21:03.412218,used: 4:58:46.183451,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9830084, 'precision': 0.98302877, 'recall': 0.9730096, 'specificity': 0.9730096, 'f1': 0.97787774, 'auroc': 0.9965031, 'binary_precision': 0.9830705, 'binary_recall': 0.9518805, 'binary_specificity': 0.99413866, 'binary_f1_score': 0.96722406}
confusion matrix:
       0      1
0  42063    248
1    728  14401
---- Validation: 
scalar performance:
{'acc': 0.9637245, 'precision': 0.7063598, 'recall': 0.69939137, 'specificity': 0.69939137, 'f1': 0.70280856, 'auroc': 0.8896441, 'binary_precision': 0.43201378, 'binary_recall': 0.41694352, 'binary_specificity': 0.9818392, 'binary_f1_score': 0.42434487}
confusion matrix:
       0    1
0  17841  330
1    351  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9246674, 'precision': 0.62457615, 'recall': 0.74271226, 'specificity': 0.74271226, 'f1': 0.6598263, 'auroc': 0.87679356, 'binary_precision': 0.2682927, 'binary_recall': 0.54545456, 'binary_specificity': 0.93996996, 'binary_f1_score': 0.35967302}
confusion matrix:
      0    1
0  5637  360
1   110  132
early stop counter: 11
val acc:0.9637244939804077, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 15,now: 2024-07-11 06:10:50.388850,epoch time: 0:21:06.626303,used: 5:19:52.809754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9828169, 'precision': 0.98291826, 'recall': 0.9726263, 'specificity': 0.9726263, 'f1': 0.97762305, 'auroc': 0.9966259, 'binary_precision': 0.983125, 'binary_recall': 0.9510906, 'binary_specificity': 0.99416214, 'binary_f1_score': 0.9668425}
confusion matrix:
       0      1
0  42063    247
1    740  14390
---- Validation: 
scalar performance:
{'acc': 0.96484315, 'precision': 0.7111364, 'recall': 0.6790899, 'specificity': 0.6790899, 'f1': 0.6936457, 'auroc': 0.8892617, 'binary_precision': 0.44291338, 'binary_recall': 0.37375414, 'binary_specificity': 0.9844257, 'binary_f1_score': 0.40540537}
confusion matrix:
       0    1
0  17888  283
1    377  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9294759, 'precision': 0.6258699, 'recall': 0.7194379, 'specificity': 0.7194379, 'f1': 0.65687215, 'auroc': 0.8721117, 'binary_precision': 0.27293578, 'binary_recall': 0.49173555, 'binary_specificity': 0.9471402, 'binary_f1_score': 0.35103247}
confusion matrix:
      0    1
0  5680  317
1   123  119
early stop counter: 12
val acc:0.9648431539535522, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 16,now: 2024-07-11 06:32:15.817208,epoch time: 0:21:25.428358,used: 5:41:18.238112,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98365253, 'precision': 0.9833462, 'recall': 0.97435975, 'specificity': 0.97435975, 'f1': 0.97873914, 'auroc': 0.9964571, 'binary_precision': 0.98271877, 'binary_recall': 0.9547227, 'binary_specificity': 0.99399686, 'binary_f1_score': 0.96851844}
confusion matrix:
       0      1
0  42057    254
1    685  14444
---- Validation: 
scalar performance:
{'acc': 0.9615405, 'precision': 0.6940389, 'recall': 0.7070967, 'specificity': 0.7070967, 'f1': 0.700328, 'auroc': 0.8914311, 'binary_precision': 0.4068323, 'binary_recall': 0.43521595, 'binary_specificity': 0.9789775, 'binary_f1_score': 0.42054573}
confusion matrix:
       0    1
0  17789  382
1    340  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9169739, 'precision': 0.61422884, 'recall': 0.74465847, 'specificity': 0.74465847, 'f1': 0.64916414, 'auroc': 0.8711289, 'binary_precision': 0.24725275, 'binary_recall': 0.55785125, 'binary_specificity': 0.93146574, 'binary_f1_score': 0.3426396}
confusion matrix:
      0    1
0  5586  411
1   107  135
early stop counter: 13
val acc:0.9615405201911926, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 17,now: 2024-07-11 06:53:29.935379,epoch time: 0:21:14.118171,used: 6:02:32.356283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9838092, 'precision': 0.98579025, 'recall': 0.9724083, 'specificity': 0.9724083, 'f1': 0.97885, 'auroc': 0.99663824, 'binary_precision': 0.98979026, 'binary_recall': 0.9483146, 'binary_specificity': 0.996502, 'binary_f1_score': 0.9686086}
confusion matrix:
       0      1
0  42162    148
1    782  14348
---- Validation: 
scalar performance:
{'acc': 0.96415067, 'precision': 0.7077091, 'recall': 0.6899749, 'specificity': 0.6899749, 'f1': 0.6983997, 'auroc': 0.8919684, 'binary_precision': 0.43533698, 'binary_recall': 0.39700997, 'binary_specificity': 0.98293984, 'binary_f1_score': 0.41529104}
confusion matrix:
       0    1
0  17861  310
1    363  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9272319, 'precision': 0.62573254, 'recall': 0.73214984, 'specificity': 0.73214984, 'f1': 0.65918726, 'auroc': 0.87049866, 'binary_precision': 0.27155173, 'binary_recall': 0.5206612, 'binary_specificity': 0.9436385, 'binary_f1_score': 0.35694054}
confusion matrix:
      0    1
0  5659  338
1   116  126
early stop counter: 14
val acc:0.9641506671905518, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 18,now: 2024-07-11 07:14:39.987816,epoch time: 0:21:10.052437,used: 6:23:42.408720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9847841, 'precision': 0.986027, 'recall': 0.97466075, 'specificity': 0.97466075, 'f1': 0.98016375, 'auroc': 0.99684477, 'binary_precision': 0.98855305, 'binary_recall': 0.9532685, 'binary_specificity': 0.99605304, 'binary_f1_score': 0.97059023}
confusion matrix:
       0      1
0  42144    167
1    707  14422
---- Validation: 
scalar performance:
{'acc': 0.9629255, 'precision': 0.7012312, 'recall': 0.7005847, 'specificity': 0.7005847, 'f1': 0.70090735, 'auroc': 0.8953193, 'binary_precision': 0.42166665, 'binary_recall': 0.4202658, 'binary_specificity': 0.9809036, 'binary_f1_score': 0.42096508}
confusion matrix:
       0    1
0  17824  347
1    349  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92434686, 'precision': 0.62347287, 'recall': 0.7405628, 'specificity': 0.7405628, 'f1': 0.6583787, 'auroc': 0.86929965, 'binary_precision': 0.26626018, 'binary_recall': 0.5413223, 'binary_specificity': 0.93980324, 'binary_f1_score': 0.35694823}
confusion matrix:
      0    1
0  5636  361
1   111  131
early stop counter: 15
val acc:0.9629254937171936, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 19,now: 2024-07-11 07:36:00.048973,epoch time: 0:21:20.061157,used: 6:45:02.469877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9844011, 'precision': 0.98603404, 'recall': 0.97367895, 'specificity': 0.97367895, 'f1': 0.9796438, 'auroc': 0.9968115, 'binary_precision': 0.989342, 'binary_recall': 0.9510212, 'binary_specificity': 0.99633664, 'binary_f1_score': 0.96980315}
confusion matrix:
       0      1
0  42156    155
1    741  14388
---- Validation: 
scalar performance:
{'acc': 0.95983595, 'precision': 0.68627465, 'recall': 0.71424663, 'specificity': 0.71424663, 'f1': 0.6991526, 'auroc': 0.8941524, 'binary_precision': 0.3908046, 'binary_recall': 0.45182723, 'binary_specificity': 0.9766661, 'binary_f1_score': 0.4191063}
confusion matrix:
       0    1
0  17747  424
1    330  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9163327, 'precision': 0.6138689, 'recall': 0.74630773, 'specificity': 0.74630773, 'f1': 0.64894634, 'auroc': 0.8647995, 'binary_precision': 0.24637681, 'binary_recall': 0.56198347, 'binary_specificity': 0.930632, 'binary_f1_score': 0.34256926}
confusion matrix:
      0    1
0  5581  416
1   106  136
early stop counter: 16
val acc:0.959835946559906, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 20,now: 2024-07-11 07:57:07.972218,epoch time: 0:21:07.923245,used: 7:06:10.393122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9841574, 'precision': 0.9861387, 'recall': 0.9729631, 'specificity': 0.9729631, 'f1': 0.97930944, 'auroc': 0.9970647, 'binary_precision': 0.990142, 'binary_recall': 0.949306, 'binary_specificity': 0.9966202, 'binary_f1_score': 0.9692941}
confusion matrix:
       0      1
0  42167    143
1    767  14363
---- Validation: 
scalar performance:
{'acc': 0.96095455, 'precision': 0.686231, 'recall': 0.6883239, 'specificity': 0.6883239, 'f1': 0.6872709, 'auroc': 0.89476085, 'binary_precision': 0.39244664, 'binary_recall': 0.39700997, 'binary_specificity': 0.97963786, 'binary_f1_score': 0.39471513}
confusion matrix:
       0    1
0  17801  370
1    363  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9230646, 'precision': 0.6218872, 'recall': 0.7418785, 'specificity': 0.7418785, 'f1': 0.656966, 'auroc': 0.86679375, 'binary_precision': 0.26294822, 'binary_recall': 0.54545456, 'binary_specificity': 0.93830246, 'binary_f1_score': 0.3548387}
confusion matrix:
      0    1
0  5627  370
1   110  132
early stop counter: 17
val acc:0.9609545469284058, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 21,now: 2024-07-11 08:19:16.921668,epoch time: 0:22:08.949450,used: 7:28:19.342572,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.986055, 'precision': 0.9861101, 'recall': 0.977839, 'specificity': 0.977839, 'f1': 0.9818787, 'auroc': 0.9973145, 'binary_precision': 0.9862233, 'binary_recall': 0.96047586, 'binary_specificity': 0.99520206, 'binary_f1_score': 0.9731793}
confusion matrix:
       0      1
0  42107    203
1    598  14532
---- Validation: 
scalar performance:
{'acc': 0.9626059, 'precision': 0.6996244, 'recall': 0.70282876, 'specificity': 0.70282876, 'f1': 0.7012122, 'auroc': 0.8975855, 'binary_precision': 0.41830066, 'binary_recall': 0.42524916, 'binary_specificity': 0.9804084, 'binary_f1_score': 0.42174628}
confusion matrix:
       0    1
0  17815  356
1    346  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9259497, 'precision': 0.6262517, 'recall': 0.74139655, 'specificity': 0.74139655, 'f1': 0.66128635, 'auroc': 0.86502874, 'binary_precision': 0.27178425, 'binary_recall': 0.5413223, 'binary_specificity': 0.94147074, 'binary_f1_score': 0.36187848}
confusion matrix:
      0    1
0  5646  351
1   111  131
early stop counter: 18
val acc:0.962605893611908, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 22,now: 2024-07-11 08:41:09.206525,epoch time: 0:21:52.284857,used: 7:50:11.627429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9856546, 'precision': 0.98673165, 'recall': 0.97620845, 'specificity': 0.97620845, 'f1': 0.9813157, 'auroc': 0.9974954, 'binary_precision': 0.9889269, 'binary_recall': 0.95624584, 'binary_specificity': 0.9961711, 'binary_f1_score': 0.9723118}
confusion matrix:
       0      1
0  42148    162
1    662  14468
---- Validation: 
scalar performance:
{'acc': 0.96127415, 'precision': 0.69030195, 'recall': 0.69732255, 'specificity': 0.69732255, 'f1': 0.6937405, 'auroc': 0.89674854, 'binary_precision': 0.4, 'binary_recall': 0.4152824, 'binary_specificity': 0.9793627, 'binary_f1_score': 0.40749797}
confusion matrix:
       0    1
0  17796  375
1    352  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9272319, 'precision': 0.6302067, 'recall': 0.7480117, 'specificity': 0.7480117, 'f1': 0.6662863, 'auroc': 0.865904, 'binary_precision': 0.27916667, 'binary_recall': 0.553719, 'binary_specificity': 0.9423045, 'binary_f1_score': 0.37119114}
confusion matrix:
      0    1
0  5651  346
1   108  134
early stop counter: 19
val acc:0.9612741470336914, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 23,now: 2024-07-11 09:03:18.891359,epoch time: 0:22:09.684834,used: 8:12:21.312263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98647285, 'precision': 0.9855654, 'recall': 0.9794589, 'specificity': 0.9794589, 'f1': 0.98245966, 'auroc': 0.9975008, 'binary_precision': 0.98368835, 'binary_recall': 0.96463746, 'binary_specificity': 0.99428046, 'binary_f1_score': 0.9740697}
confusion matrix:
       0      1
0  42069    242
1    535  14594
---- Validation: 
scalar performance:
{'acc': 0.9564268, 'precision': 0.68109155, 'recall': 0.7606685, 'specificity': 0.7606685, 'f1': 0.71268064, 'auroc': 0.90480083, 'binary_precision': 0.37727273, 'binary_recall': 0.551495, 'binary_specificity': 0.9698421, 'binary_f1_score': 0.4480432}
confusion matrix:
       0    1
0  17623  548
1    270  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9060747, 'precision': 0.60973024, 'recall': 0.77467835, 'specificity': 0.77467835, 'f1': 0.6462355, 'auroc': 0.87064743, 'binary_precision': 0.23538461, 'binary_recall': 0.6322314, 'binary_specificity': 0.9171252, 'binary_f1_score': 0.34304932}
confusion matrix:
      0    1
0  5500  497
1    89  153
early stop counter: 20
val acc:0.9564267992973328, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 24,now: 2024-07-11 09:24:48.417660,epoch time: 0:21:29.526301,used: 8:33:50.838564,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98537606, 'precision': 0.9855118, 'recall': 0.97667754, 'specificity': 0.97667754, 'f1': 0.9809853, 'auroc': 0.99732625, 'binary_precision': 0.9857901, 'binary_recall': 0.95829475, 'binary_specificity': 0.99506027, 'binary_f1_score': 0.97184795}
confusion matrix:
       0      1
0  42101    209
1    631  14499
---- Validation: 
scalar performance:
{'acc': 0.9565333, 'precision': 0.6808534, 'recall': 0.7575114, 'specificity': 0.7575114, 'f1': 0.71151596, 'auroc': 0.9037248, 'binary_precision': 0.3770115, 'binary_recall': 0.54485047, 'binary_specificity': 0.9701722, 'binary_f1_score': 0.44565216}
confusion matrix:
       0    1
0  17629  542
1    274  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90992147, 'precision': 0.6122776, 'recall': 0.76874834, 'specificity': 0.76874834, 'f1': 0.6490692, 'auroc': 0.86749506, 'binary_precision': 0.24110033, 'binary_recall': 0.61570245, 'binary_specificity': 0.92179424, 'binary_f1_score': 0.34651166}
confusion matrix:
      0    1
0  5528  469
1    93  149
early stop counter: 21
val acc:0.9565333127975464, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 25,now: 2024-07-11 09:46:25.231389,epoch time: 0:21:36.813729,used: 8:55:27.652293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98649025, 'precision': 0.98647463, 'recall': 0.9785991, 'specificity': 0.9785991, 'f1': 0.98245, 'auroc': 0.9977759, 'binary_precision': 0.9864425, 'binary_recall': 0.9619249, 'binary_specificity': 0.99527323, 'binary_f1_score': 0.9740294}
confusion matrix:
       0      1
0  42112    200
1    576  14552
---- Validation: 
scalar performance:
{'acc': 0.9573856, 'precision': 0.6839007, 'recall': 0.7555425, 'specificity': 0.7555425, 'f1': 0.7130564, 'auroc': 0.9039924, 'binary_precision': 0.3832547, 'binary_recall': 0.5398671, 'binary_specificity': 0.9712179, 'binary_f1_score': 0.44827583}
confusion matrix:
       0    1
0  17648  523
1    277  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9180958, 'precision': 0.6226901, 'recall': 0.77101773, 'specificity': 0.77101773, 'f1': 0.66150343, 'auroc': 0.8680327, 'binary_precision': 0.26194692, 'binary_recall': 0.61157024, 'binary_specificity': 0.9304652, 'binary_f1_score': 0.3667906}
confusion matrix:
      0    1
0  5580  417
1    94  148
early stop counter: 22
val acc:0.9573855996131897, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 26,now: 2024-07-11 10:08:19.696701,epoch time: 0:21:54.465312,used: 9:17:22.117605,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9873433, 'precision': 0.9884564, 'recall': 0.97886205, 'specificity': 0.97886205, 'f1': 0.98353136, 'auroc': 0.99770856, 'binary_precision': 0.99073255, 'binary_recall': 0.9609385, 'binary_specificity': 0.99678564, 'binary_f1_score': 0.97560805}
confusion matrix:
       0      1
0  42174    136
1    591  14539
---- Validation: 
scalar performance:
{'acc': 0.9629787, 'precision': 0.7069634, 'recall': 0.73112804, 'specificity': 0.73112804, 'f1': 0.71829665, 'auroc': 0.90605766, 'binary_precision': 0.4311111, 'binary_recall': 0.4833887, 'binary_specificity': 0.9788674, 'binary_f1_score': 0.45575568}
confusion matrix:
       0    1
0  17787  384
1    311  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93604743, 'precision': 0.6467885, 'recall': 0.74664915, 'specificity': 0.74664915, 'f1': 0.68130213, 'auroc': 0.8713286, 'binary_precision': 0.31264916, 'binary_recall': 0.5413223, 'binary_specificity': 0.951976, 'binary_f1_score': 0.39636913}
confusion matrix:
      0    1
0  5709  288
1   111  131
early stop counter: 23
val acc:0.962978720664978, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 27,now: 2024-07-11 10:30:11.970391,epoch time: 0:21:52.273690,used: 9:39:14.391295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9867862, 'precision': 0.984844, 'recall': 0.98100924, 'specificity': 0.98100924, 'f1': 0.9829058, 'auroc': 0.99768853, 'binary_precision': 0.98079497, 'binary_recall': 0.9688016, 'binary_specificity': 0.9932169, 'binary_f1_score': 0.97476137}
confusion matrix:
       0      1
0  42024    287
1    472  14657
---- Validation: 
scalar performance:
{'acc': 0.95925, 'precision': 0.69435453, 'recall': 0.7685513, 'specificity': 0.7685513, 'f1': 0.72469884, 'auroc': 0.90810645, 'binary_precision': 0.40332147, 'binary_recall': 0.56478405, 'binary_specificity': 0.97231853, 'binary_f1_score': 0.47058824}
confusion matrix:
       0    1
0  17668  503
1    262  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9230646, 'precision': 0.63133645, 'recall': 0.77756786, 'specificity': 0.77756786, 'f1': 0.6717914, 'auroc': 0.87209785, 'binary_precision': 0.2788104, 'binary_recall': 0.6198347, 'binary_specificity': 0.935301, 'binary_f1_score': 0.3846154}
confusion matrix:
      0    1
0  5609  388
1    92  150
early stop counter: 24
val acc:0.9592499732971191, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 28,now: 2024-07-11 10:52:03.194422,epoch time: 0:21:51.224031,used: 10:01:05.615326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.986734, 'precision': 0.9856421, 'recall': 0.9800608, 'specificity': 0.9800608, 'f1': 0.98280764, 'auroc': 0.9978186, 'binary_precision': 0.9833793, 'binary_recall': 0.9659594, 'binary_specificity': 0.99416226, 'binary_f1_score': 0.97459155}
confusion matrix:
       0      1
0  42064    247
1    515  14614
---- Validation: 
scalar performance:
{'acc': 0.95967615, 'precision': 0.6934149, 'recall': 0.75271046, 'specificity': 0.75271046, 'f1': 0.7185917, 'auroc': 0.90667975, 'binary_precision': 0.4025157, 'binary_recall': 0.53156143, 'binary_specificity': 0.9738594, 'binary_f1_score': 0.45812452}
confusion matrix:
       0    1
0  17696  475
1    282  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.924988, 'precision': 0.63048816, 'recall': 0.7627064, 'specificity': 0.7627064, 'f1': 0.66887414, 'auroc': 0.8696635, 'binary_precision': 0.2784314, 'binary_recall': 0.58677685, 'binary_specificity': 0.938636, 'binary_f1_score': 0.37765956}
confusion matrix:
      0    1
0  5629  368
1   100  142
early stop counter: 25
val acc:0.9596761465072632, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 29,now: 2024-07-11 11:13:57.239604,epoch time: 0:21:54.045182,used: 10:22:59.660508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98682106, 'precision': 0.98700583, 'recall': 0.97893214, 'specificity': 0.97893214, 'f1': 0.98287785, 'auroc': 0.9977988, 'binary_precision': 0.9873856, 'binary_recall': 0.9622604, 'binary_specificity': 0.99560386, 'binary_f1_score': 0.9746611}
confusion matrix:
       0      1
0  42124    186
1    571  14559
---- Validation: 
scalar performance:
{'acc': 0.9626059, 'precision': 0.70434225, 'recall': 0.7285263, 'specificity': 0.7285263, 'f1': 0.71567416, 'auroc': 0.90476453, 'binary_precision': 0.4260355, 'binary_recall': 0.47840533, 'binary_specificity': 0.9786473, 'binary_f1_score': 0.45070422}
confusion matrix:
       0    1
0  17783  388
1    314  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9318801, 'precision': 0.63815516, 'recall': 0.74646413, 'specificity': 0.74646413, 'f1': 0.6735567, 'auroc': 0.86616313, 'binary_precision': 0.295302, 'binary_recall': 0.54545456, 'binary_specificity': 0.94747376, 'binary_f1_score': 0.383164}
confusion matrix:
      0    1
0  5682  315
1   110  132
early stop counter: 26
val acc:0.962605893611908, best validation acc: 0.9668140411376953, corresponding to test acc:                         0.9509536623954773 / 0.9509536623954773
after epoch: 30,now: 2024-07-11 11:35:46.838899,epoch time: 0:21:49.599295,used: 10:44:49.259803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_00_50_57_seed_2_21806614
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:44:49.259803 at 2024-07-11 11:35:46.838899
persisted model performance metric: 

scalar performance:
{'acc': 0.95095366, 'precision': 0.6269924, 'recall': 0.57992184, 'specificity': 0.57992184, 'f1': 0.5970346, 'auroc': 0.8266798, 'binary_precision': 0.28666666, 'binary_recall': 0.17768595, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.21938774}
confusion matrix:
      0    1
0  5890  107
1   199   43
oracle model performance metric: 

scalar performance:
{'acc': 0.95095366, 'precision': 0.6269924, 'recall': 0.57992184, 'specificity': 0.57992184, 'f1': 0.5970346, 'auroc': 0.8266798, 'binary_precision': 0.28666666, 'binary_recall': 0.17768595, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.21938774}
confusion matrix:
      0    1
0  5890  107
1   199   43
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |  17485 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |  17485 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   7827 MiB |   3528 TiB |   3528 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   3483 TiB |   3483 TiB |
|       from small pool |  16481 KiB |     36 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  25072 MiB |  16560 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25002 MiB |  16528 MiB |
|       from small pool |     38 MiB |     44 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38824 KiB | 732464 KiB |   1951 TiB |   1951 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1906 TiB |   1906 TiB |
|       from small pool |   7091 KiB |  23284 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7675    |  583984 K  |  583981 K  |
|       from large pool |      79    |     762    |  330548 K  |  330548 K  |
|       from small pool |    2887    |    7594    |  253435 K  |  253433 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7675    |  583984 K  |  583981 K  |
|       from large pool |      79    |     762    |  330548 K  |  330548 K  |
|       from small pool |    2887    |    7594    |  253435 K  |  253433 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |    1061    |     693    |
|       from large pool |     349    |     349    |    1026    |     677    |
|       from small pool |      19    |      22    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3612    |  341848 K  |  341848 K  |
|       from large pool |      11    |     352    |  233945 K  |  233945 K  |
|       from small pool |      22    |    3602    |  107902 K  |  107902 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |      0 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |      0 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   3528 TiB |   3528 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   3483 TiB |   3483 TiB |
|       from small pool |      0 KiB |     36 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  25072 MiB |  24842 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25002 MiB |  24796 MiB |
|       from small pool |  24576 KiB |     44 MiB |     70 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1951 TiB |   1951 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1906 TiB |   1906 TiB |
|       from small pool |      0 KiB |  23284 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7675    |  583984 K  |  583984 K  |
|       from large pool |       2    |     762    |  330548 K  |  330548 K  |
|       from small pool |       0    |    7594    |  253435 K  |  253435 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7675    |  583984 K  |  583984 K  |
|       from large pool |       2    |     762    |  330548 K  |  330548 K  |
|       from small pool |       0    |    7594    |  253435 K  |  253435 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |    1061    |    1039    |
|       from large pool |      10    |     349    |    1026    |    1016    |
|       from small pool |      12    |      22    |      35    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |  341850 K  |  341850 K  |
|       from large pool |       3    |     352    |  233945 K  |  233945 K  |
|       from small pool |       0    |    3602    |  107904 K  |  107904 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Jul 11 11:48:38 2024]
Finished job 0.
1 of 1 steps (100%) done
