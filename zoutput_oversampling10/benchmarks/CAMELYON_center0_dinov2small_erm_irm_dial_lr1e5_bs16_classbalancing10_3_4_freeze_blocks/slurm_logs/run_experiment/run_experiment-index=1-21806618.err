Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 10 04:24:48 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618

 Experiment start at: 2024-07-10 04:30:43.000448
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93886745, 'precision': 0.95890087, 'recall': 0.8834739, 'specificity': 0.8834739, 'f1': 0.91343117, 'auroc': 0.9657903, 'binary_precision': 0.99228406, 'binary_recall': 0.76902694, 'binary_specificity': 0.9979208, 'binary_f1_score': 0.86650586}
confusion matrix:
       0      1
0  42236     88
1   3399  11317
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.95157516, 'precision': 0.5424187, 'recall': 0.5233965, 'specificity': 0.5233965, 'f1': 0.5288963, 'auroc': 0.79424894, 'binary_precision': 0.11747851, 'binary_recall': 0.06376361, 'binary_specificity': 0.98302937, 'binary_f1_score': 0.08266129}
confusion matrix:
       0    1
0  17841  308
1    602   41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501438, 'precision': 0.601972, 'recall': 0.5397239, 'specificity': 0.5397239, 'f1': 0.5538335, 'auroc': 0.82806647, 'binary_precision': 0.24242425, 'binary_recall': 0.09195402, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.13333334}
confusion matrix:
      0   1
0  5922  75
1   237  24
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 04:52:39.355589,epoch time: 0:21:56.355141,used: 0:21:56.355141,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9568198, 'precision': 0.9653239, 'recall': 0.9217727, 'specificity': 0.9217727, 'f1': 0.94094, 'auroc': 0.9809339, 'binary_precision': 0.98069984, 'binary_recall': 0.8493579, 'binary_specificity': 0.99418753, 'binary_f1_score': 0.9103157}
confusion matrix:
       0      1
0  42077    246
1   2217  12500
---- Validation: 
scalar performance:
{'acc': 0.95152193, 'precision': 0.63272434, 'recall': 0.6321269, 'specificity': 0.6321269, 'f1': 0.63242483, 'auroc': 0.86208504, 'binary_precision': 0.290625, 'binary_recall': 0.28926906, 'binary_specificity': 0.9749848, 'binary_f1_score': 0.28994545}
confusion matrix:
       0    1
0  17695  454
1    457  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.72004515, 'recall': 0.6711555, 'specificity': 0.6711555, 'f1': 0.69209766, 'auroc': 0.88827044, 'binary_precision': 0.46766168, 'binary_recall': 0.36015326, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.40692642}
confusion matrix:
      0    1
0  5890  107
1   167   94
new oracle model saved
early stop counter: 1
val acc:0.9515219330787659, best validation acc: 0.9515751600265503, corresponding to test acc:                         0.9501438140869141 / 0.956216037273407
after epoch: 2,now: 2024-07-10 05:13:54.932191,epoch time: 0:21:15.576602,used: 0:43:11.931743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9616585, 'precision': 0.9692826, 'recall': 0.930498, 'specificity': 0.930498, 'f1': 0.94783485, 'auroc': 0.9864472, 'binary_precision': 0.9832588, 'binary_recall': 0.866123, 'binary_specificity': 0.994873, 'binary_f1_score': 0.92098135}
confusion matrix:
       0      1
0  42108    217
1   1970  12745
---- Validation: 
scalar performance:
{'acc': 0.9551937, 'precision': 0.6643789, 'recall': 0.6707806, 'specificity': 0.6707806, 'f1': 0.66750914, 'auroc': 0.8802197, 'binary_precision': 0.35127056, 'binary_recall': 0.36547434, 'binary_specificity': 0.97608685, 'binary_f1_score': 0.3582317}
confusion matrix:
       0    1
0  17715  434
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7690015, 'recall': 0.73129284, 'specificity': 0.73129284, 'f1': 0.7485404, 'auroc': 0.9051997, 'binary_precision': 0.5605381, 'binary_recall': 0.4789272, 'binary_specificity': 0.9836585, 'binary_f1_score': 0.5165289}
confusion matrix:
      0    1
0  5899   98
1   136  125
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-10 05:35:05.002941,epoch time: 0:21:10.070750,used: 1:04:22.002493,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9667076, 'precision': 0.97087014, 'recall': 0.9418094, 'specificity': 0.9418094, 'f1': 0.9551785, 'auroc': 0.98845243, 'binary_precision': 0.978717, 'binary_recall': 0.89035326, 'binary_specificity': 0.99326557, 'binary_f1_score': 0.93244636}
confusion matrix:
       0      1
0  42035    285
1   1614  13106
---- Validation: 
scalar performance:
{'acc': 0.95423585, 'precision': 0.6738678, 'recall': 0.71828824, 'specificity': 0.71828824, 'f1': 0.6931727, 'auroc': 0.8941644, 'binary_precision': 0.36687118, 'binary_recall': 0.46500778, 'binary_specificity': 0.9715687, 'binary_f1_score': 0.41015092}
confusion matrix:
       0    1
0  17633  516
1    344  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.765193, 'recall': 0.80283725, 'specificity': 0.80283725, 'f1': 0.78259027, 'auroc': 0.91327846, 'binary_precision': 0.5466667, 'binary_recall': 0.62835246, 'binary_specificity': 0.977322, 'binary_f1_score': 0.58467025}
confusion matrix:
      0    1
0  5861  136
1    97  164
new oracle model saved
early stop counter: 1
val acc:0.954235851764679, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 4,now: 2024-07-10 05:56:15.021483,epoch time: 0:21:10.018542,used: 1:25:32.021035,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97030157, 'precision': 0.9720433, 'recall': 0.94991255, 'specificity': 0.94991255, 'f1': 0.96030164, 'auroc': 0.9901751, 'binary_precision': 0.97539425, 'binary_recall': 0.90778744, 'binary_specificity': 0.9920376, 'binary_f1_score': 0.9403773}
confusion matrix:
       0      1
0  41987    337
1   1357  13359
---- Validation: 
scalar performance:
{'acc': 0.95242655, 'precision': 0.6741172, 'recall': 0.7481038, 'specificity': 0.7481038, 'f1': 0.70359695, 'auroc': 0.9004179, 'binary_precision': 0.3651987, 'binary_recall': 0.5287714, 'binary_specificity': 0.9674362, 'binary_f1_score': 0.4320203}
confusion matrix:
       0    1
0  17558  591
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7420945, 'recall': 0.82240736, 'specificity': 0.82240736, 'f1': 0.7756384, 'auroc': 0.9161011, 'binary_precision': 0.49858356, 'binary_recall': 0.6743295, 'binary_specificity': 0.97048527, 'binary_f1_score': 0.5732899}
confusion matrix:
      0    1
0  5820  177
1    85  176
early stop counter: 2
val acc:0.952426552772522, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 5,now: 2024-07-10 06:17:27.030735,epoch time: 0:21:12.009252,used: 1:46:44.030287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9725631, 'precision': 0.97244436, 'recall': 0.9554089, 'specificity': 0.9554089, 'f1': 0.96352386, 'auroc': 0.9913012, 'binary_precision': 0.97221226, 'binary_recall': 0.9199619, 'binary_specificity': 0.9908558, 'binary_f1_score': 0.94536567}
confusion matrix:
       0      1
0  41935    387
1   1178  13540
---- Validation: 
scalar performance:
{'acc': 0.95184124, 'precision': 0.67502725, 'recall': 0.76130176, 'specificity': 0.76130176, 'f1': 0.70826894, 'auroc': 0.9079004, 'binary_precision': 0.36605316, 'binary_recall': 0.55676514, 'binary_specificity': 0.9658383, 'binary_f1_score': 0.44170263}
confusion matrix:
       0    1
0  17529  620
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.7336557, 'recall': 0.83589876, 'specificity': 0.83589876, 'f1': 0.7740903, 'auroc': 0.91782355, 'binary_precision': 0.48041776, 'binary_recall': 0.70498085, 'binary_specificity': 0.9668167, 'binary_f1_score': 0.5714286}
confusion matrix:
      0    1
0  5798  199
1    77  184
early stop counter: 3
val acc:0.9518412351608276, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 6,now: 2024-07-10 06:38:27.472959,epoch time: 0:21:00.442224,used: 2:07:44.472511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9728612, 'precision': 0.9760132, 'recall': 0.9528341, 'specificity': 0.9528341, 'f1': 0.96369064, 'auroc': 0.9918463, 'binary_precision': 0.9820618, 'binary_recall': 0.91145694, 'binary_specificity': 0.9942113, 'binary_f1_score': 0.94544303}
confusion matrix:
       0      1
0  42079    245
1   1303  13413
---- Validation: 
scalar performance:
{'acc': 0.9548744, 'precision': 0.68185735, 'recall': 0.74112046, 'specificity': 0.74112046, 'f1': 0.7067072, 'auroc': 0.9076792, 'binary_precision': 0.38122827, 'binary_recall': 0.5116641, 'binary_specificity': 0.9705769, 'binary_f1_score': 0.436919}
confusion matrix:
       0    1
0  17615  534
1    314  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7563007, 'recall': 0.8258238, 'specificity': 0.8258238, 'f1': 0.7862886, 'auroc': 0.9174894, 'binary_precision': 0.52678573, 'binary_recall': 0.6781609, 'binary_specificity': 0.9734867, 'binary_f1_score': 0.5929648}
confusion matrix:
      0    1
0  5838  159
1    84  177
early stop counter: 4
val acc:0.9548743963241577, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 7,now: 2024-07-10 06:59:33.061911,epoch time: 0:21:05.588952,used: 2:28:50.061463,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97480714, 'precision': 0.97497565, 'recall': 0.95882666, 'specificity': 0.95882666, 'f1': 0.9665413, 'auroc': 0.9930164, 'binary_precision': 0.975306, 'binary_recall': 0.92580515, 'binary_specificity': 0.99184823, 'binary_f1_score': 0.9499111}
confusion matrix:
       0      1
0  41977    345
1   1092  13626
---- Validation: 
scalar performance:
{'acc': 0.94827586, 'precision': 0.6668775, 'recall': 0.77520704, 'specificity': 0.77520704, 'f1': 0.70552015, 'auroc': 0.91170716, 'binary_precision': 0.34866604, 'binary_recall': 0.58942455, 'binary_specificity': 0.9609896, 'binary_f1_score': 0.4381503}
confusion matrix:
       0    1
0  17441  708
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480665, 'precision': 0.7071129, 'recall': 0.83731043, 'specificity': 0.83731043, 'f1': 0.75377357, 'auroc': 0.91870713, 'binary_precision': 0.42694065, 'binary_recall': 0.71647507, 'binary_specificity': 0.95814574, 'binary_f1_score': 0.53505003}
confusion matrix:
      0    1
0  5746  251
1    74  187
early stop counter: 5
val acc:0.9482758641242981, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 8,now: 2024-07-10 07:20:40.297885,epoch time: 0:21:07.235974,used: 2:49:57.297437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9778752, 'precision': 0.97651184, 'recall': 0.9653642, 'specificity': 0.9653642, 'f1': 0.97076625, 'auroc': 0.9934561, 'binary_precision': 0.97379726, 'binary_recall': 0.9395175, 'binary_specificity': 0.9912109, 'binary_f1_score': 0.95635027}
confusion matrix:
       0      1
0  41953    372
1    890  13825
---- Validation: 
scalar performance:
{'acc': 0.9513091, 'precision': 0.6738319, 'recall': 0.7640265, 'specificity': 0.7640265, 'f1': 0.7081386, 'auroc': 0.91004145, 'binary_precision': 0.3634538, 'binary_recall': 0.562986, 'binary_specificity': 0.96506697, 'binary_f1_score': 0.44173276}
confusion matrix:
       0    1
0  17515  634
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9483861, 'precision': 0.7078468, 'recall': 0.83564484, 'specificity': 0.83564484, 'f1': 0.7539638, 'auroc': 0.9187691, 'binary_precision': 0.42857143, 'binary_recall': 0.7126437, 'binary_specificity': 0.958646, 'binary_f1_score': 0.53525186}
confusion matrix:
      0    1
0  5749  248
1    75  186
early stop counter: 6
val acc:0.951309084892273, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 9,now: 2024-07-10 07:41:46.810898,epoch time: 0:21:06.513013,used: 3:11:03.810450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9788394, 'precision': 0.9790329, 'recall': 0.9654155, 'specificity': 0.9654155, 'f1': 0.9719704, 'auroc': 0.9943993, 'binary_precision': 0.9794151, 'binary_recall': 0.9376826, 'binary_specificity': 0.99314827, 'binary_f1_score': 0.95809466}
confusion matrix:
       0      1
0  42035    290
1    917  13798
---- Validation: 
scalar performance:
{'acc': 0.95157516, 'precision': 0.674751, 'recall': 0.7641642, 'specificity': 0.7641642, 'f1': 0.7088858, 'auroc': 0.9105506, 'binary_precision': 0.3652876, 'binary_recall': 0.562986, 'binary_specificity': 0.96534246, 'binary_f1_score': 0.44308445}
confusion matrix:
       0    1
0  17520  629
1    281  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480665, 'precision': 0.7063547, 'recall': 0.83181345, 'specificity': 0.83181345, 'f1': 0.7517679, 'auroc': 0.9189812, 'binary_precision': 0.42592594, 'binary_recall': 0.70498085, 'binary_specificity': 0.958646, 'binary_f1_score': 0.5310245}
confusion matrix:
      0    1
0  5749  248
1    77  184
early stop counter: 7
val acc:0.9515751600265503, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 10,now: 2024-07-10 08:02:53.266170,epoch time: 0:21:06.455272,used: 3:32:10.265722,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.981101, 'precision': 0.9812113, 'recall': 0.96920025, 'specificity': 0.96920025, 'f1': 0.97500914, 'auroc': 0.9952582, 'binary_precision': 0.9814305, 'binary_recall': 0.94461435, 'binary_specificity': 0.99378616, 'binary_f1_score': 0.96267056}
confusion matrix:
       0      1
0  42062    263
1    815  13900
---- Validation: 
scalar performance:
{'acc': 0.94705194, 'precision': 0.6618768, 'recall': 0.76857305, 'specificity': 0.76857305, 'f1': 0.6997082, 'auroc': 0.907671, 'binary_precision': 0.33912247, 'binary_recall': 0.5769829, 'binary_specificity': 0.9601631, 'binary_f1_score': 0.4271733}
confusion matrix:
       0    1
0  17426  723
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94183445, 'precision': 0.69023407, 'recall': 0.83772343, 'specificity': 0.83772343, 'f1': 0.7392592, 'auroc': 0.9176874, 'binary_precision': 0.3929314, 'binary_recall': 0.7241379, 'binary_specificity': 0.95130897, 'binary_f1_score': 0.509434}
confusion matrix:
      0    1
0  5705  292
1    72  189
early stop counter: 8
val acc:0.9470519423484802, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 11,now: 2024-07-10 08:24:02.278854,epoch time: 0:21:09.012684,used: 3:53:19.278406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9799088, 'precision': 0.9798863, 'recall': 0.9673754, 'specificity': 0.9673754, 'f1': 0.97341686, 'auroc': 0.99501747, 'binary_precision': 0.9798416, 'binary_recall': 0.9414843, 'binary_specificity': 0.9932665, 'binary_f1_score': 0.96028}
confusion matrix:
       0      1
0  42041    285
1    861  13853
---- Validation: 
scalar performance:
{'acc': 0.94753087, 'precision': 0.6648235, 'recall': 0.77557147, 'specificity': 0.77557147, 'f1': 0.70388395, 'auroc': 0.9112676, 'binary_precision': 0.34451497, 'binary_recall': 0.59097975, 'binary_specificity': 0.9601631, 'binary_f1_score': 0.43528065}
confusion matrix:
       0    1
0  17426  723
1    263  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9407159, 'precision': 0.6880356, 'recall': 0.8408045, 'specificity': 0.8408045, 'f1': 0.73788226, 'auroc': 0.918679, 'binary_precision': 0.38821137, 'binary_recall': 0.7318008, 'binary_specificity': 0.94980824, 'binary_f1_score': 0.5073041}
confusion matrix:
      0    1
0  5696  301
1    70  191
early stop counter: 9
val acc:0.9475308656692505, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 12,now: 2024-07-10 08:45:32.687067,epoch time: 0:21:30.408213,used: 4:14:49.686619,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9812062, 'precision': 0.98098946, 'recall': 0.969694, 'specificity': 0.969694, 'f1': 0.9751676, 'auroc': 0.9958351, 'binary_precision': 0.9805579, 'binary_recall': 0.9459092, 'binary_specificity': 0.9934789, 'binary_f1_score': 0.962922}
confusion matrix:
       0      1
0  42048    276
1    796  13920
---- Validation: 
scalar performance:
{'acc': 0.94705194, 'precision': 0.6615268, 'recall': 0.76707286, 'specificity': 0.76707286, 'f1': 0.69904864, 'auroc': 0.9092677, 'binary_precision': 0.33853212, 'binary_recall': 0.57387245, 'binary_specificity': 0.96027327, 'binary_f1_score': 0.42585117}
confusion matrix:
       0    1
0  17428  721
1    274  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93720037, 'precision': 0.6783501, 'recall': 0.8316409, 'specificity': 0.8316409, 'f1': 0.72708225, 'auroc': 0.9149965, 'binary_precision': 0.36956522, 'binary_recall': 0.71647507, 'binary_specificity': 0.9468067, 'binary_f1_score': 0.4876141}
confusion matrix:
      0    1
0  5678  319
1    74  187
early stop counter: 10
val acc:0.9470519423484802, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 13,now: 2024-07-10 09:06:18.100437,epoch time: 0:20:45.413370,used: 4:35:35.099989,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98203015, 'precision': 0.984572, 'recall': 0.9684098, 'specificity': 0.9684098, 'f1': 0.97613966, 'auroc': 0.9960594, 'binary_precision': 0.98955876, 'binary_recall': 0.9402691, 'binary_specificity': 0.99655044, 'binary_f1_score': 0.9642844}
confusion matrix:
       0      1
0  42178    146
1    879  13837
---- Validation: 
scalar performance:
{'acc': 0.9548744, 'precision': 0.67825556, 'recall': 0.72536933, 'specificity': 0.72536933, 'f1': 0.69864386, 'auroc': 0.904315, 'binary_precision': 0.37515226, 'binary_recall': 0.47900465, 'binary_specificity': 0.971734, 'binary_f1_score': 0.420765}
confusion matrix:
       0    1
0  17636  513
1    335  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95158195, 'precision': 0.71566385, 'recall': 0.8153243, 'specificity': 0.8153243, 'f1': 0.7545124, 'auroc': 0.91191316, 'binary_precision': 0.44615385, 'binary_recall': 0.6666667, 'binary_specificity': 0.963982, 'binary_f1_score': 0.53456223}
confusion matrix:
      0    1
0  5781  216
1    87  174
early stop counter: 11
val acc:0.9548743963241577, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 14,now: 2024-07-10 09:27:18.375111,epoch time: 0:21:00.274674,used: 4:56:35.374663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9831171, 'precision': 0.98303425, 'recall': 0.9726915, 'specificity': 0.9726915, 'f1': 0.9777174, 'auroc': 0.9964423, 'binary_precision': 0.9828688, 'binary_recall': 0.9511483, 'binary_specificity': 0.9942347, 'binary_f1_score': 0.9667484}
confusion matrix:
       0      1
0  42078    244
1    719  13999
---- Validation: 
scalar performance:
{'acc': 0.94449764, 'precision': 0.6538182, 'recall': 0.76350033, 'specificity': 0.76350033, 'f1': 0.6916338, 'auroc': 0.9060189, 'binary_precision': 0.32332155, 'binary_recall': 0.56920683, 'binary_specificity': 0.95779383, 'binary_f1_score': 0.41239434}
confusion matrix:
       0    1
0  17383  766
1    277  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93208694, 'precision': 0.6673233, 'recall': 0.82897294, 'specificity': 0.82897294, 'f1': 0.7159065, 'auroc': 0.91231585, 'binary_precision': 0.34758365, 'binary_recall': 0.71647507, 'binary_specificity': 0.94147074, 'binary_f1_score': 0.46808508}
confusion matrix:
      0    1
0  5646  351
1    74  187
early stop counter: 12
val acc:0.9444976449012756, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 15,now: 2024-07-10 09:48:36.827773,epoch time: 0:21:18.452662,used: 5:17:53.827325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9834151, 'precision': 0.9846577, 'recall': 0.97188663, 'specificity': 0.97188663, 'f1': 0.97805214, 'auroc': 0.996279, 'binary_precision': 0.9871205, 'binary_recall': 0.94807315, 'binary_specificity': 0.9957001, 'binary_f1_score': 0.96720284}
confusion matrix:
       0      1
0  42145    182
1    764  13949
---- Validation: 
scalar performance:
{'acc': 0.94598764, 'precision': 0.65440863, 'recall': 0.7500206, 'specificity': 0.7500206, 'f1': 0.68889636, 'auroc': 0.9025788, 'binary_precision': 0.32551596, 'binary_recall': 0.53965783, 'binary_specificity': 0.9603835, 'binary_f1_score': 0.40608543}
confusion matrix:
       0    1
0  17430  719
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93799937, 'precision': 0.67778707, 'recall': 0.81923145, 'specificity': 0.81923145, 'f1': 0.7241563, 'auroc': 0.9102118, 'binary_precision': 0.36960986, 'binary_recall': 0.6896552, 'binary_specificity': 0.9488077, 'binary_f1_score': 0.48128343}
confusion matrix:
      0    1
0  5690  307
1    81  180
early stop counter: 13
val acc:0.9459876418113708, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 16,now: 2024-07-10 10:11:21.937652,epoch time: 0:22:45.109879,used: 5:40:38.937204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98409885, 'precision': 0.9843664, 'recall': 0.97394824, 'specificity': 0.97394824, 'f1': 0.97901034, 'auroc': 0.99647665, 'binary_precision': 0.98490065, 'binary_recall': 0.95297635, 'binary_specificity': 0.99492013, 'binary_f1_score': 0.96867555}
confusion matrix:
       0      1
0  42109    215
1    692  14024
---- Validation: 
scalar performance:
{'acc': 0.9432737, 'precision': 0.6511443, 'recall': 0.7651168, 'specificity': 0.7651168, 'f1': 0.68964887, 'auroc': 0.9040191, 'binary_precision': 0.31782946, 'binary_recall': 0.57387245, 'binary_specificity': 0.95636123, 'binary_f1_score': 0.40909088}
confusion matrix:
       0    1
0  17357  792
1    274  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9338447, 'precision': 0.6706018, 'recall': 0.8280577, 'specificity': 0.8280577, 'f1': 0.71899414, 'auroc': 0.9118079, 'binary_precision': 0.35428572, 'binary_recall': 0.7126437, 'binary_specificity': 0.9434717, 'binary_f1_score': 0.47328246}
confusion matrix:
      0    1
0  5658  339
1    75  186
early stop counter: 14
val acc:0.9432737231254578, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 17,now: 2024-07-10 10:38:35.456762,epoch time: 0:27:13.519110,used: 6:07:52.456314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98572934, 'precision': 0.9858706, 'recall': 0.97673404, 'specificity': 0.97673404, 'f1': 0.9811895, 'auroc': 0.99672294, 'binary_precision': 0.98615384, 'binary_recall': 0.9581465, 'binary_specificity': 0.9953216, 'binary_f1_score': 0.97194844}
confusion matrix:
       0      1
0  42124    198
1    616  14102
---- Validation: 
scalar performance:
{'acc': 0.948063, 'precision': 0.6565812, 'recall': 0.73534393, 'specificity': 0.73534393, 'f1': 0.6866735, 'auroc': 0.90298665, 'binary_precision': 0.33096448, 'binary_recall': 0.5069984, 'binary_specificity': 0.96368945, 'binary_f1_score': 0.4004914}
confusion matrix:
       0    1
0  17490  659
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94662833, 'precision': 0.6997727, 'recall': 0.81640434, 'specificity': 0.81640434, 'f1': 0.7424431, 'auroc': 0.9100617, 'binary_precision': 0.41411763, 'binary_recall': 0.6743295, 'binary_specificity': 0.9584792, 'binary_f1_score': 0.5131196}
confusion matrix:
      0    1
0  5748  249
1    85  176
early stop counter: 15
val acc:0.9480630159378052, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 18,now: 2024-07-10 11:04:54.611449,epoch time: 0:26:19.154687,used: 6:34:11.611001,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98513323, 'precision': 0.9844278, 'recall': 0.9765996, 'specificity': 0.9765996, 'f1': 0.9804304, 'auroc': 0.9969386, 'binary_precision': 0.9830072, 'binary_recall': 0.9589646, 'binary_specificity': 0.99423456, 'binary_f1_score': 0.97083706}
confusion matrix:
       0      1
0  42077    244
1    604  14115
---- Validation: 
scalar performance:
{'acc': 0.9434866, 'precision': 0.6507689, 'recall': 0.76147676, 'specificity': 0.76147676, 'f1': 0.6885171, 'auroc': 0.9050976, 'binary_precision': 0.3173496, 'binary_recall': 0.5660964, 'binary_specificity': 0.95685714, 'binary_f1_score': 0.40670392}
confusion matrix:
       0    1
0  17366  783
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9364014, 'precision': 0.6744171, 'recall': 0.82023, 'specificity': 0.82023, 'f1': 0.7212304, 'auroc': 0.90843534, 'binary_precision': 0.36272544, 'binary_recall': 0.6934866, 'binary_specificity': 0.9469735, 'binary_f1_score': 0.4763158}
confusion matrix:
      0    1
0  5679  318
1    80  181
early stop counter: 16
val acc:0.9434865713119507, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 19,now: 2024-07-10 11:29:18.912432,epoch time: 0:24:24.300983,used: 6:58:35.911984,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98534364, 'precision': 0.9860402, 'recall': 0.9755686, 'specificity': 0.9755686, 'f1': 0.9806565, 'auroc': 0.9968624, 'binary_precision': 0.9874315, 'binary_recall': 0.95536685, 'binary_specificity': 0.99577034, 'binary_f1_score': 0.9711346}
confusion matrix:
       0      1
0  42141    179
1    657  14063
---- Validation: 
scalar performance:
{'acc': 0.9481694, 'precision': 0.6553097, 'recall': 0.7293986, 'specificity': 0.7293986, 'f1': 0.68397796, 'auroc': 0.9007591, 'binary_precision': 0.32885212, 'binary_recall': 0.49455675, 'binary_specificity': 0.96424043, 'binary_f1_score': 0.39503106}
confusion matrix:
       0    1
0  17500  649
1    325  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480665, 'precision': 0.7023438, 'recall': 0.80432844, 'specificity': 0.80432844, 'f1': 0.74119234, 'auroc': 0.90296936, 'binary_precision': 0.420398, 'binary_recall': 0.6475096, 'binary_specificity': 0.96114725, 'binary_f1_score': 0.5098039}
confusion matrix:
      0    1
0  5764  233
1    92  169
early stop counter: 17
val acc:0.9481694102287292, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 20,now: 2024-07-10 11:50:53.125638,epoch time: 0:21:34.213206,used: 7:20:10.125190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98546636, 'precision': 0.98261565, 'recall': 0.97932446, 'specificity': 0.97932446, 'f1': 0.9809552, 'auroc': 0.9969008, 'binary_precision': 0.9767905, 'binary_recall': 0.9666349, 'binary_specificity': 0.992014, 'binary_f1_score': 0.9716862}
confusion matrix:
       0      1
0  41986    338
1    491  14225
---- Validation: 
scalar performance:
{'acc': 0.9355045, 'precision': 0.6350558, 'recall': 0.7678451, 'specificity': 0.7678451, 'f1': 0.67505836, 'auroc': 0.9023491, 'binary_precision': 0.28528303, 'binary_recall': 0.58786935, 'binary_specificity': 0.94782084, 'binary_f1_score': 0.38414633}
confusion matrix:
       0    1
0  17202  947
1    265  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9332055, 'precision': 0.66702676, 'recall': 0.8167302, 'specificity': 0.8167302, 'f1': 0.713557, 'auroc': 0.9049367, 'binary_precision': 0.34816247, 'binary_recall': 0.6896552, 'binary_specificity': 0.9438052, 'binary_f1_score': 0.4627249}
confusion matrix:
      0    1
0  5660  337
1    81  180
early stop counter: 18
val acc:0.9355044960975647, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 21,now: 2024-07-10 12:12:25.204548,epoch time: 0:21:32.078910,used: 7:41:42.204100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98697406, 'precision': 0.9882498, 'recall': 0.9776573, 'specificity': 0.9776573, 'f1': 0.9828032, 'auroc': 0.99732816, 'binary_precision': 0.9907967, 'binary_recall': 0.9584098, 'binary_specificity': 0.9969049, 'binary_f1_score': 0.9743342}
confusion matrix:
       0      1
0  42194    131
1    612  14103
---- Validation: 
scalar performance:
{'acc': 0.9508833, 'precision': 0.6598315, 'recall': 0.71355236, 'specificity': 0.71355236, 'f1': 0.6821826, 'auroc': 0.8992222, 'binary_precision': 0.33908045, 'binary_recall': 0.45878693, 'binary_specificity': 0.9683178, 'binary_f1_score': 0.3899537}
confusion matrix:
       0    1
0  17574  575
1    348  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.728156, 'recall': 0.79167265, 'specificity': 0.79167265, 'f1': 0.7554059, 'auroc': 0.90239835, 'binary_precision': 0.4733728, 'binary_recall': 0.6130268, 'binary_specificity': 0.9703185, 'binary_f1_score': 0.5342237}
confusion matrix:
      0    1
0  5819  178
1   101  160
early stop counter: 19
val acc:0.9508833289146423, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 22,now: 2024-07-10 12:34:47.753679,epoch time: 0:22:22.549131,used: 8:04:04.753231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98702663, 'precision': 0.9862697, 'recall': 0.97973317, 'specificity': 0.97973317, 'f1': 0.9829436, 'auroc': 0.99719644, 'binary_precision': 0.9847392, 'binary_recall': 0.96466434, 'binary_specificity': 0.994802, 'binary_f1_score': 0.9745984}
confusion matrix:
       0      1
0  42104    220
1    520  14196
---- Validation: 
scalar performance:
{'acc': 0.9472648, 'precision': 0.6542922, 'recall': 0.7356808, 'specificity': 0.7356808, 'f1': 0.68499696, 'auroc': 0.90077055, 'binary_precision': 0.3263473, 'binary_recall': 0.5085537, 'binary_specificity': 0.9628079, 'binary_f1_score': 0.39756837}
confusion matrix:
       0    1
0  17474  675
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9504634, 'precision': 0.7102642, 'recall': 0.8037467, 'specificity': 0.8037467, 'f1': 0.7470038, 'auroc': 0.90330106, 'binary_precision': 0.43636364, 'binary_recall': 0.6436782, 'binary_specificity': 0.9638152, 'binary_f1_score': 0.52012384}
confusion matrix:
      0    1
0  5780  217
1    93  168
early stop counter: 20
val acc:0.9472647905349731, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 23,now: 2024-07-10 13:02:57.434607,epoch time: 0:28:09.680928,used: 8:32:14.434159,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98753506, 'precision': 0.9877392, 'recall': 0.9796115, 'specificity': 0.9796115, 'f1': 0.98358643, 'auroc': 0.99748063, 'binary_precision': 0.98815, 'binary_recall': 0.9632398, 'binary_specificity': 0.99598324, 'binary_f1_score': 0.97553587}
confusion matrix:
       0      1
0  42153    170
1    541  14176
---- Validation: 
scalar performance:
{'acc': 0.9511494, 'precision': 0.66287875, 'recall': 0.7211907, 'specificity': 0.7211907, 'f1': 0.68687713, 'auroc': 0.9016545, 'binary_precision': 0.34463277, 'binary_recall': 0.47433904, 'binary_specificity': 0.9680423, 'binary_f1_score': 0.39921466}
confusion matrix:
       0    1
0  17569  580
1    338  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.731996, 'recall': 0.7957542, 'specificity': 0.7957542, 'f1': 0.7594078, 'auroc': 0.9036654, 'binary_precision': 0.48071218, 'binary_recall': 0.62068963, 'binary_specificity': 0.97081876, 'binary_f1_score': 0.54180604}
confusion matrix:
      0    1
0  5822  175
1    99  162
early stop counter: 21
val acc:0.9511494040489197, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 24,now: 2024-07-10 13:32:49.028358,epoch time: 0:29:51.593751,used: 9:02:06.027910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98735976, 'precision': 0.9859716, 'recall': 0.9809096, 'specificity': 0.9809096, 'f1': 0.9834058, 'auroc': 0.99761295, 'binary_precision': 0.9831515, 'binary_recall': 0.9675841, 'binary_specificity': 0.9942351, 'binary_f1_score': 0.9753057}
confusion matrix:
       0      1
0  42081    244
1    477  14238
---- Validation: 
scalar performance:
{'acc': 0.947318, 'precision': 0.655841, 'recall': 0.7409587, 'specificity': 0.7409587, 'f1': 0.68766916, 'auroc': 0.90309334, 'binary_precision': 0.32906404, 'binary_recall': 0.5194401, 'binary_specificity': 0.96247727, 'binary_f1_score': 0.40289503}
confusion matrix:
       0    1
0  17468  681
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.7326827, 'recall': 0.8049159, 'specificity': 0.8049159, 'f1': 0.7631662, 'auroc': 0.9059006, 'binary_precision': 0.48126802, 'binary_recall': 0.63984674, 'binary_specificity': 0.969985, 'binary_f1_score': 0.5493421}
confusion matrix:
      0    1
0  5817  180
1    94  167
early stop counter: 22
val acc:0.9473180174827576, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 25,now: 2024-07-10 13:55:19.336747,epoch time: 0:22:30.308389,used: 9:24:36.336299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98807853, 'precision': 0.98820114, 'recall': 0.98057723, 'specificity': 0.98057723, 'f1': 0.984311, 'auroc': 0.9974905, 'binary_precision': 0.98844814, 'binary_recall': 0.9650768, 'binary_specificity': 0.9960777, 'binary_f1_score': 0.97662264}
confusion matrix:
       0      1
0  42156    166
1    514  14204
---- Validation: 
scalar performance:
{'acc': 0.94902086, 'precision': 0.65192527, 'recall': 0.7080878, 'specificity': 0.7080878, 'f1': 0.6748632, 'auroc': 0.89835083, 'binary_precision': 0.32362822, 'binary_recall': 0.44945568, 'binary_specificity': 0.9667199, 'binary_f1_score': 0.37630206}
confusion matrix:
       0    1
0  17545  604
1    354  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.73351693, 'recall': 0.7759321, 'specificity': 0.7759321, 'f1': 0.7526833, 'auroc': 0.90080285, 'binary_precision': 0.48553056, 'binary_recall': 0.5785441, 'binary_specificity': 0.97332, 'binary_f1_score': 0.52797204}
confusion matrix:
      0    1
0  5837  160
1   110  151
early stop counter: 23
val acc:0.9490208625793457, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9627676606178284
after epoch: 26,now: 2024-07-10 14:16:59.275121,epoch time: 0:21:39.938374,used: 9:46:16.274673,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98835903, 'precision': 0.988936, 'recall': 0.98058903, 'specificity': 0.98058903, 'f1': 0.98466897, 'auroc': 0.9978968, 'binary_precision': 0.9900963, 'binary_recall': 0.9645332, 'binary_specificity': 0.9966448, 'binary_f1_score': 0.9771476}
confusion matrix:
       0      1
0  42180    142
1    522  14196
---- Validation: 
scalar performance:
{'acc': 0.9526926, 'precision': 0.66467464, 'recall': 0.7069885, 'specificity': 0.7069885, 'f1': 0.6830348, 'auroc': 0.89709723, 'binary_precision': 0.3492647, 'binary_recall': 0.44323483, 'binary_specificity': 0.97074217, 'binary_f1_score': 0.39067855}
confusion matrix:
       0    1
0  17618  531
1    358  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.79074466, 'recall': 0.758613, 'specificity': 0.758613, 'f1': 0.77362144, 'auroc': 0.9007882, 'binary_precision': 0.6017316, 'binary_recall': 0.532567, 'binary_specificity': 0.984659, 'binary_f1_score': 0.56504065}
confusion matrix:
      0    1
0  5905   92
1   122  139
new oracle model saved
early stop counter: 24
val acc:0.9526926279067993, best validation acc: 0.9551936984062195, corresponding to test acc:                         0.9626078605651855 / 0.9658037424087524
after epoch: 27,now: 2024-07-10 14:39:43.928525,epoch time: 0:22:44.653404,used: 10:09:00.928077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9882363, 'precision': 0.9888756, 'recall': 0.9803302, 'specificity': 0.9803302, 'f1': 0.98450494, 'auroc': 0.9974984, 'binary_precision': 0.9901605, 'binary_recall': 0.9639921, 'binary_specificity': 0.99666834, 'binary_f1_score': 0.9769011}
confusion matrix:
       0      1
0  42180    141
1    530  14189
---- Validation: 
scalar performance:
{'acc': 0.9552469, 'precision': 0.67542076, 'recall': 0.70756084, 'specificity': 0.70756084, 'f1': 0.68993735, 'auroc': 0.89847106, 'binary_precision': 0.3707572, 'binary_recall': 0.44167963, 'binary_specificity': 0.9734421, 'binary_f1_score': 0.40312278}
confusion matrix:
       0    1
0  17667  482
1    359  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.77544343, 'recall': 0.7612772, 'specificity': 0.7612772, 'f1': 0.76814866, 'auroc': 0.90289176, 'binary_precision': 0.5708502, 'binary_recall': 0.54022986, 'binary_specificity': 0.9823245, 'binary_f1_score': 0.5551181}
confusion matrix:
      0    1
0  5891  106
1   120  141
better model found
persisted
after epoch: 28,now: 2024-07-10 15:03:00.523820,epoch time: 0:23:16.595295,used: 10:32:17.523372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98884994, 'precision': 0.98897564, 'recall': 0.9818272, 'specificity': 0.9818272, 'f1': 0.9853327, 'auroc': 0.99802196, 'binary_precision': 0.9892294, 'binary_recall': 0.9673167, 'binary_specificity': 0.9963377, 'binary_f1_score': 0.9781503}
confusion matrix:
       0      1
0  42168    155
1    481  14236
---- Validation: 
scalar performance:
{'acc': 0.95780116, 'precision': 0.6849796, 'recall': 0.69688237, 'specificity': 0.69688237, 'f1': 0.69071895, 'auroc': 0.89889544, 'binary_precision': 0.39067057, 'binary_recall': 0.41679627, 'binary_specificity': 0.9769684, 'binary_f1_score': 0.40331078}
confusion matrix:
       0    1
0  17731  418
1    375  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.78049487, 'recall': 0.7338756, 'specificity': 0.7338756, 'f1': 0.75480634, 'auroc': 0.9002076, 'binary_precision': 0.5833333, 'binary_recall': 0.4827586, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.5283019}
confusion matrix:
      0    1
0  5907   90
1   135  126
better model found
persisted
after epoch: 29,now: 2024-07-10 15:25:20.306774,epoch time: 0:22:19.782954,used: 10:54:37.306326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9876052, 'precision': 0.9870022, 'recall': 0.9805219, 'specificity': 0.9805219, 'f1': 0.9837053, 'auroc': 0.99760354, 'binary_precision': 0.9857826, 'binary_recall': 0.9658875, 'binary_specificity': 0.9951564, 'binary_f1_score': 0.97573364}
confusion matrix:
       0      1
0  42119    205
1    502  14214
---- Validation: 
scalar performance:
{'acc': 0.9484887, 'precision': 0.656945, 'recall': 0.7318141, 'specificity': 0.7318141, 'f1': 0.68592477, 'auroc': 0.90112436, 'binary_precision': 0.3319545, 'binary_recall': 0.4992224, 'binary_specificity': 0.9644058, 'binary_f1_score': 0.3987578}
confusion matrix:
       0    1
0  17503  646
1    322  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.7243318, 'recall': 0.75860727, 'specificity': 0.75860727, 'f1': 0.7400595, 'auroc': 0.89964205, 'binary_precision': 0.46864685, 'binary_recall': 0.5440613, 'binary_specificity': 0.97315323, 'binary_f1_score': 0.50354606}
confusion matrix:
      0    1
0  5836  161
1   119  142
early stop counter: 1
val acc:0.948488712310791, best validation acc: 0.9578011631965637, corresponding to test acc:                         0.9640460014343262 / 0.9658037424087524
after epoch: 30,now: 2024-07-10 15:49:49.947110,epoch time: 0:24:29.640336,used: 11:19:06.946662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_04_30_42_seed_0_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:19:06.946662 at 2024-07-10 15:49:49.947110
persisted model performance metric: 

scalar performance:
{'acc': 0.964046, 'precision': 0.78049487, 'recall': 0.7338756, 'specificity': 0.7338756, 'f1': 0.75480634, 'auroc': 0.9002076, 'binary_precision': 0.5833333, 'binary_recall': 0.4827586, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.5283019}
confusion matrix:
      0    1
0  5907   90
1   135  126
oracle model performance metric: 

scalar performance:
{'acc': 0.96580374, 'precision': 0.79074466, 'recall': 0.758613, 'specificity': 0.758613, 'f1': 0.77362144, 'auroc': 0.9007882, 'binary_precision': 0.6017316, 'binary_recall': 0.532567, 'binary_specificity': 0.984659, 'binary_f1_score': 0.56504065}
confusion matrix:
      0    1
0  5905   92
1   122  139
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  16482 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  57847 KiB | 732464 KiB | 678844 GiB | 678843 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |   7085 KiB |  11093 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7625    |  195064 K  |  195061 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84571 K  |   84568 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7625    |  195064 K  |  195061 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84571 K  |   84568 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3589    |  120666 K  |  120666 K  |
|       from large pool |      10    |     350    |   85092 K  |   85092 K  |
|       from small pool |      23    |    3579    |   35574 K  |   35574 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8530 MiB |   8530 MiB |   8280 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     44 MiB |     44 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |      0 KiB |  21224 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84571 K  |   84571 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84571 K  |   84571 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     371    |     348    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      22    |      22    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  120667 K  |  120667 K  |
|       from large pool |       3    |     350    |   85092 K  |   85092 K  |
|       from small pool |       0    |    3579    |   35575 K  |   35575 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8530 MiB |   8530 MiB |   8280 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     44 MiB |     44 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |      0 KiB |  21224 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84571 K  |   84571 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84571 K  |   84571 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     371    |     348    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      22    |      22    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  120667 K  |  120667 K  |
|       from large pool |       3    |     350    |   85092 K  |   85092 K  |
|       from small pool |       0    |    3579    |   35575 K  |   35575 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618

 Experiment start at: 2024-07-10 16:09:24.763823
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9255349, 'precision': 0.9345088, 'recall': 0.8663552, 'specificity': 0.8663552, 'f1': 0.8937563, 'auroc': 0.9432384, 'binary_precision': 0.94943523, 'binary_recall': 0.74622, 'binary_specificity': 0.9864903, 'binary_f1_score': 0.8356505}
confusion matrix:
       0      1
0  41841    573
1   3659  10759
---- Validation: 
scalar performance:
{'acc': 0.9487193, 'precision': 0.50426763, 'recall': 0.50204337, 'specificity': 0.50204337, 'f1': 0.50098807, 'auroc': 0.7431221, 'binary_precision': 0.044303797, 'binary_recall': 0.020802377, 'binary_specificity': 0.9832844, 'binary_f1_score': 0.028311426}
confusion matrix:
       0    1
0  17765  302
1    659   14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94215274, 'precision': 0.48857158, 'recall': 0.49535307, 'specificity': 0.49535307, 'f1': 0.49061215, 'auroc': 0.7201823, 'binary_precision': 0.019417476, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9830138, 'binary_f1_score': 0.011019284}
confusion matrix:
      0    1
0  5845  101
1   258    2
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 16:32:17.913880,epoch time: 0:22:53.150057,used: 0:22:53.150057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95173496, 'precision': 0.9610603, 'recall': 0.9112053, 'specificity': 0.9112053, 'f1': 0.932773, 'auroc': 0.9713654, 'binary_precision': 0.9774307, 'binary_recall': 0.82891816, 'binary_specificity': 0.9934924, 'binary_f1_score': 0.89706933}
confusion matrix:
       0      1
0  42136    276
1   2467  11953
---- Validation: 
scalar performance:
{'acc': 0.9533084, 'precision': 0.53681415, 'recall': 0.51443714, 'specificity': 0.51443714, 'f1': 0.518105, 'auroc': 0.799318, 'binary_precision': 0.10852713, 'binary_recall': 0.041604754, 'binary_specificity': 0.9872696, 'binary_f1_score': 0.060150377}
confusion matrix:
       0    1
0  17837  230
1    645   28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9442475, 'precision': 0.4900189, 'recall': 0.49644622, 'specificity': 0.49644622, 'f1': 0.49137172, 'auroc': 0.7894169, 'binary_precision': 0.022222223, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9852001, 'binary_f1_score': 0.011428571}
confusion matrix:
      0   1
0  5858  88
1   258   2
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-10 16:54:12.232562,epoch time: 0:21:54.318682,used: 0:44:47.468739,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9621516, 'precision': 0.9685573, 'recall': 0.93120146, 'specificity': 0.93120146, 'f1': 0.94801176, 'auroc': 0.9809936, 'binary_precision': 0.98019415, 'binary_recall': 0.86836815, 'binary_specificity': 0.9940348, 'binary_f1_score': 0.92089885}
confusion matrix:
       0      1
0  42160    253
1   1898  12521
---- Validation: 
scalar performance:
{'acc': 0.95549625, 'precision': 0.60770154, 'recall': 0.5520505, 'specificity': 0.5520505, 'f1': 0.5682087, 'auroc': 0.8319179, 'binary_precision': 0.24764891, 'binary_recall': 0.11738484, 'binary_specificity': 0.9867161, 'binary_f1_score': 0.15927419}
confusion matrix:
       0    1
0  17827  240
1    594   79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94827586, 'precision': 0.54132026, 'recall': 0.51326036, 'specificity': 0.51326036, 'f1': 0.5160292, 'auroc': 0.83716786, 'binary_precision': 0.12345679, 'binary_recall': 0.03846154, 'binary_specificity': 0.9880592, 'binary_f1_score': 0.05865103}
confusion matrix:
      0   1
0  5875  71
1   250  10
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-10 17:16:05.394398,epoch time: 0:21:53.161836,used: 1:06:40.630575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96725434, 'precision': 0.97197354, 'recall': 0.94123477, 'specificity': 0.94123477, 'f1': 0.9553435, 'auroc': 0.98698485, 'binary_precision': 0.9807074, 'binary_recall': 0.8884111, 'binary_specificity': 0.99405843, 'binary_f1_score': 0.93228054}
confusion matrix:
       0      1
0  42161    252
1   1609  12810
---- Validation: 
scalar performance:
{'acc': 0.95832443, 'precision': 0.6437252, 'recall': 0.5649615, 'specificity': 0.5649615, 'f1': 0.58714134, 'auroc': 0.84935755, 'binary_precision': 0.31879196, 'binary_recall': 0.14115898, 'binary_specificity': 0.98876405, 'binary_f1_score': 0.19567457}
confusion matrix:
       0    1
0  17864  203
1    578   95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95391554, 'precision': 0.6218977, 'recall': 0.5290764, 'specificity': 0.5290764, 'f1': 0.541299, 'auroc': 0.86784065, 'binary_precision': 0.28333333, 'binary_recall': 0.06538462, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.10625}
confusion matrix:
      0   1
0  5903  43
1   243  17
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-10 17:38:01.207764,epoch time: 0:21:55.813366,used: 1:28:36.443941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9701577, 'precision': 0.97495186, 'recall': 0.9460374, 'specificity': 0.9460374, 'f1': 0.9593862, 'auroc': 0.9890577, 'binary_precision': 0.9838734, 'binary_recall': 0.8970731, 'binary_specificity': 0.9950017, 'binary_f1_score': 0.9384705}
confusion matrix:
       0      1
0  42202    212
1   1484  12934
---- Validation: 
scalar performance:
{'acc': 0.95997864, 'precision': 0.66850924, 'recall': 0.57440263, 'specificity': 0.57440263, 'f1': 0.6007264, 'auroc': 0.8563359, 'binary_precision': 0.3676976, 'binary_recall': 0.1589896, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.22199169}
confusion matrix:
       0    1
0  17883  184
1    566  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.6728082, 'recall': 0.53577065, 'specificity': 0.53577065, 'f1': 0.5528629, 'auroc': 0.8823398, 'binary_precision': 0.3846154, 'binary_recall': 0.07692308, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.12820514}
confusion matrix:
      0   1
0  5914  32
1   240  20
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-10 17:59:36.535261,epoch time: 0:21:35.327497,used: 1:50:11.771438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9744686, 'precision': 0.97354954, 'recall': 0.9585649, 'specificity': 0.9585649, 'f1': 0.965754, 'auroc': 0.9911766, 'binary_precision': 0.9717695, 'binary_recall': 0.9262778, 'binary_specificity': 0.9908519, 'binary_f1_score': 0.9484785}
confusion matrix:
       0      1
0  42025    388
1   1063  13356
---- Validation: 
scalar performance:
{'acc': 0.9601921, 'precision': 0.69208825, 'recall': 0.6195752, 'specificity': 0.6195752, 'f1': 0.64628875, 'auroc': 0.867561, 'binary_precision': 0.4116223, 'binary_recall': 0.25260028, 'binary_specificity': 0.9865501, 'binary_f1_score': 0.31307548}
confusion matrix:
       0    1
0  17824  243
1    503  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.73234713, 'recall': 0.58091545, 'specificity': 0.58091545, 'f1': 0.6156609, 'auroc': 0.89533436, 'binary_precision': 0.5, 'binary_recall': 0.16923077, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.25287357}
confusion matrix:
      0   1
0  5902  44
1   216  44
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-10 18:21:20.462902,epoch time: 0:21:43.927641,used: 2:11:55.699079,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9753836, 'precision': 0.97836095, 'recall': 0.95640564, 'specificity': 0.95640564, 'f1': 0.9667457, 'auroc': 0.9925356, 'binary_precision': 0.9840137, 'binary_recall': 0.9178804, 'binary_specificity': 0.9949309, 'binary_f1_score': 0.9497973}
confusion matrix:
       0      1
0  42199    215
1   1184  13234
---- Validation: 
scalar performance:
{'acc': 0.96163285, 'precision': 0.7078965, 'recall': 0.6260445, 'specificity': 0.6260445, 'f1': 0.6557064, 'auroc': 0.87112963, 'binary_precision': 0.44278607, 'binary_recall': 0.26448736, 'binary_specificity': 0.9876017, 'binary_f1_score': 0.33116278}
confusion matrix:
       0    1
0  17843  224
1    495  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.7643678, 'recall': 0.59103537, 'specificity': 0.59103537, 'f1': 0.63089126, 'auroc': 0.90070117, 'binary_precision': 0.5632184, 'binary_recall': 0.18846154, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.28242075}
confusion matrix:
      0   1
0  5908  38
1   211  49
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-10 18:45:00.348995,epoch time: 0:23:39.886093,used: 2:35:35.585172,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97633374, 'precision': 0.975392, 'recall': 0.9617164, 'specificity': 0.9617164, 'f1': 0.9683025, 'auroc': 0.993009, 'binary_precision': 0.97356033, 'binary_recall': 0.93203884, 'binary_specificity': 0.9913939, 'binary_f1_score': 0.9523472}
confusion matrix:
       0      1
0  42047    365
1    980  13440
---- Validation: 
scalar performance:
{'acc': 0.96168625, 'precision': 0.7117921, 'recall': 0.6418081, 'specificity': 0.6418081, 'f1': 0.6690179, 'auroc': 0.87212944, 'binary_precision': 0.4494382, 'binary_recall': 0.2971768, 'binary_specificity': 0.98643935, 'binary_f1_score': 0.3577817}
confusion matrix:
       0    1
0  17822  245
1    473  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.78292763, 'recall': 0.5952179, 'specificity': 0.5952179, 'f1': 0.6377573, 'auroc': 0.90010285, 'binary_precision': 0.6, 'binary_recall': 0.19615385, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.29565218}
confusion matrix:
      0   1
0  5912  34
1   209  51
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-10 19:07:18.325164,epoch time: 0:22:17.976169,used: 2:57:53.561341,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9774247, 'precision': 0.97868234, 'recall': 0.9614175, 'specificity': 0.9614175, 'f1': 0.96965396, 'auroc': 0.99419653, 'binary_precision': 0.98110306, 'binary_recall': 0.9289182, 'binary_specificity': 0.9939168, 'binary_f1_score': 0.9542977}
confusion matrix:
       0      1
0  42154    258
1   1025  13395
---- Validation: 
scalar performance:
{'acc': 0.96195304, 'precision': 0.711408, 'recall': 0.6269258, 'specificity': 0.6269258, 'f1': 0.65734196, 'auroc': 0.87910473, 'binary_precision': 0.44974875, 'binary_recall': 0.26597324, 'binary_specificity': 0.98787844, 'binary_f1_score': 0.33426705}
confusion matrix:
       0    1
0  17848  219
1    494  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.79574686, 'recall': 0.6179584, 'specificity': 0.6179584, 'f1': 0.664765, 'auroc': 0.9092603, 'binary_precision': 0.62376237, 'binary_recall': 0.2423077, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.34903046}
confusion matrix:
      0   1
0  5908  38
1   197  63
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-10 19:35:00.349402,epoch time: 0:27:42.024238,used: 3:25:35.585579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97758305, 'precision': 0.97675174, 'recall': 0.9636955, 'specificity': 0.9636955, 'f1': 0.96999496, 'auroc': 0.9939035, 'binary_precision': 0.9751319, 'binary_recall': 0.93550175, 'binary_specificity': 0.9918893, 'binary_f1_score': 0.95490587}
confusion matrix:
       0      1
0  42069    344
1    930  13489
---- Validation: 
scalar performance:
{'acc': 0.9618997, 'precision': 0.71261114, 'recall': 0.63548136, 'specificity': 0.63548136, 'f1': 0.66445804, 'auroc': 0.87505597, 'binary_precision': 0.45153666, 'binary_recall': 0.28380385, 'binary_specificity': 0.9871589, 'binary_f1_score': 0.34854016}
confusion matrix:
       0    1
0  17835  232
1    482  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9618111, 'precision': 0.7907145, 'recall': 0.61595124, 'specificity': 0.61595124, 'f1': 0.66191196, 'auroc': 0.9013442, 'binary_precision': 0.6138614, 'binary_recall': 0.23846154, 'binary_specificity': 0.993441, 'binary_f1_score': 0.3434903}
confusion matrix:
      0   1
0  5907  39
1   198  62
early stop counter: 1
val acc:0.9618996977806091, best validation acc: 0.9619530439376831, corresponding to test acc:                         0.9621334075927734 / 0.9621334075927734
after epoch: 10,now: 2024-07-10 20:02:37.192622,epoch time: 0:27:36.843220,used: 3:53:12.428799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.979589, 'precision': 0.9810737, 'recall': 0.9648106, 'specificity': 0.9648106, 'f1': 0.9725927, 'auroc': 0.99492896, 'binary_precision': 0.9839404, 'binary_recall': 0.93480825, 'binary_specificity': 0.9948129, 'binary_f1_score': 0.9587453}
confusion matrix:
       0      1
0  42193    220
1    940  13479
---- Validation: 
scalar performance:
{'acc': 0.9621665, 'precision': 0.71205974, 'recall': 0.6191686, 'specificity': 0.6191686, 'f1': 0.65103585, 'auroc': 0.87510836, 'binary_precision': 0.4516129, 'binary_recall': 0.24962853, 'binary_specificity': 0.9887087, 'binary_f1_score': 0.3215311}
confusion matrix:
       0    1
0  17863  204
1    505  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614889, 'precision': 0.793512, 'recall': 0.6010712, 'specificity': 0.6010712, 'f1': 0.6457149, 'auroc': 0.9004226, 'binary_precision': 0.62068963, 'binary_recall': 0.20769231, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.31123918}
confusion matrix:
      0   1
0  5913  33
1   206  54
better model found
persisted
after epoch: 11,now: 2024-07-10 20:30:09.121566,epoch time: 0:27:31.928944,used: 4:20:44.357743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98045117, 'precision': 0.9819726, 'recall': 0.96621215, 'specificity': 0.96621215, 'f1': 0.9737648, 'auroc': 0.9948696, 'binary_precision': 0.9849147, 'binary_recall': 0.937305, 'binary_specificity': 0.9951194, 'binary_f1_score': 0.9605202}
confusion matrix:
       0      1
0  42206    207
1    904  13515
---- Validation: 
scalar performance:
{'acc': 0.9626467, 'precision': 0.7196954, 'recall': 0.6315772, 'specificity': 0.6315772, 'f1': 0.6632844, 'auroc': 0.88090646, 'binary_precision': 0.46599495, 'binary_recall': 0.27488855, 'binary_specificity': 0.9882659, 'binary_f1_score': 0.34579438}
confusion matrix:
       0    1
0  17855  212
1    488  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.81485784, 'recall': 0.6353502, 'specificity': 0.6353502, 'f1': 0.6857804, 'auroc': 0.90655065, 'binary_precision': 0.6605505, 'binary_recall': 0.2769231, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.39024392}
confusion matrix:
      0   1
0  5909  37
1   188  72
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-10 20:52:20.025280,epoch time: 0:22:10.903714,used: 4:42:55.261457,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9806447, 'precision': 0.98133564, 'recall': 0.9673281, 'specificity': 0.9673281, 'f1': 0.9740721, 'auroc': 0.9956095, 'binary_precision': 0.98267865, 'binary_recall': 0.9402913, 'binary_specificity': 0.9943648, 'binary_f1_score': 0.96101785}
confusion matrix:
       0      1
0  42173    239
1    861  13559
---- Validation: 
scalar performance:
{'acc': 0.9618463, 'precision': 0.71164495, 'recall': 0.6333079, 'specificity': 0.6333079, 'f1': 0.66249454, 'auroc': 0.87977135, 'binary_precision': 0.44976076, 'binary_recall': 0.2793462, 'binary_specificity': 0.9872696, 'binary_f1_score': 0.34463793}
confusion matrix:
       0    1
0  17837  230
1    485  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.79972875, 'recall': 0.6311677, 'specificity': 0.6311677, 'f1': 0.67908704, 'auroc': 0.9042026, 'binary_precision': 0.6306306, 'binary_recall': 0.26923078, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.3773585}
confusion matrix:
      0   1
0  5905  41
1   190  70
early stop counter: 1
val acc:0.9618462920188904, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 13,now: 2024-07-10 21:14:27.649778,epoch time: 0:22:07.624498,used: 5:05:02.885955,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9808559, 'precision': 0.9799102, 'recall': 0.9692756, 'specificity': 0.9692756, 'f1': 0.974442, 'auroc': 0.99560326, 'binary_precision': 0.9780535, 'binary_recall': 0.94576603, 'binary_specificity': 0.9927852, 'binary_f1_score': 0.9616388}
confusion matrix:
       0      1
0  42107    306
1    782  13637
---- Validation: 
scalar performance:
{'acc': 0.9625934, 'precision': 0.7193359, 'recall': 0.6329801, 'specificity': 0.6329801, 'f1': 0.6643257, 'auroc': 0.8825991, 'binary_precision': 0.46517414, 'binary_recall': 0.2778603, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.34790695}
confusion matrix:
       0    1
0  17852  215
1    486  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.80890185, 'recall': 0.635182, 'specificity': 0.635182, 'f1': 0.684644, 'auroc': 0.9101012, 'binary_precision': 0.6486486, 'binary_recall': 0.2769231, 'binary_specificity': 0.993441, 'binary_f1_score': 0.38814017}
confusion matrix:
      0   1
0  5907  39
1   188  72
early stop counter: 2
val acc:0.9625933766365051, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 14,now: 2024-07-10 21:36:16.978640,epoch time: 0:21:49.328862,used: 5:26:52.214817,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.97769344, 'recall': 0.97224474, 'specificity': 0.97224474, 'f1': 0.97492903, 'auroc': 0.9958272, 'binary_precision': 0.97085804, 'binary_recall': 0.9542271, 'binary_specificity': 0.99026245, 'binary_f1_score': 0.9624707}
confusion matrix:
       0      1
0  42000    413
1    660  13759
---- Validation: 
scalar performance:
{'acc': 0.96125937, 'precision': 0.70750546, 'recall': 0.64015615, 'specificity': 0.64015615, 'f1': 0.6664865, 'auroc': 0.88081086, 'binary_precision': 0.44097996, 'binary_recall': 0.29420504, 'binary_specificity': 0.9861073, 'binary_f1_score': 0.35294116}
confusion matrix:
       0    1
0  17816  251
1    475  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.8153305, 'recall': 0.64287436, 'specificity': 0.64287436, 'f1': 0.69340354, 'auroc': 0.90236807, 'binary_precision': 0.66086954, 'binary_recall': 0.2923077, 'binary_specificity': 0.993441, 'binary_f1_score': 0.40533334}
confusion matrix:
      0   1
0  5907  39
1   184  76
new oracle model saved
early stop counter: 3
val acc:0.9612593650817871, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9640670418739319
after epoch: 15,now: 2024-07-10 21:58:12.350241,epoch time: 0:21:55.371601,used: 5:48:47.586418,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9822459, 'precision': 0.9801761, 'recall': 0.97272456, 'specificity': 0.97272456, 'f1': 0.97637606, 'auroc': 0.9963968, 'binary_precision': 0.97607213, 'binary_recall': 0.95339483, 'binary_specificity': 0.99205434, 'binary_f1_score': 0.9646002}
confusion matrix:
       0      1
0  42076    337
1    672  13747
---- Validation: 
scalar performance:
{'acc': 0.9607257, 'precision': 0.71013665, 'recall': 0.6756428, 'specificity': 0.6756428, 'f1': 0.69114643, 'auroc': 0.89129865, 'binary_precision': 0.44364938, 'binary_recall': 0.36849925, 'binary_specificity': 0.9827863, 'binary_f1_score': 0.40259743}
confusion matrix:
       0    1
0  17756  311
1    425  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.805056, 'recall': 0.7024787, 'specificity': 0.7024787, 'f1': 0.7422328, 'auroc': 0.9136166, 'binary_precision': 0.63529414, 'binary_recall': 0.41538462, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.50232565}
confusion matrix:
      0    1
0  5884   62
1   152  108
new oracle model saved
early stop counter: 4
val acc:0.960725724697113, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9655172228813171
after epoch: 16,now: 2024-07-10 22:20:05.264986,epoch time: 0:21:52.914745,used: 6:10:40.501163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9836712, 'precision': 0.98292214, 'recall': 0.9737725, 'specificity': 0.9737725, 'f1': 0.9782364, 'auroc': 0.9963734, 'binary_precision': 0.9814445, 'binary_recall': 0.95367545, 'binary_specificity': 0.99386966, 'binary_f1_score': 0.96736073}
confusion matrix:
       0      1
0  42152    260
1    668  13752
---- Validation: 
scalar performance:
{'acc': 0.96125937, 'precision': 0.7122713, 'recall': 0.66447526, 'specificity': 0.66447526, 'f1': 0.68495524, 'auroc': 0.8866351, 'binary_precision': 0.44874275, 'binary_recall': 0.3447251, 'binary_specificity': 0.9842254, 'binary_f1_score': 0.38991594}
confusion matrix:
       0    1
0  17782  285
1    441  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.79540575, 'recall': 0.6870941, 'specificity': 0.6870941, 'f1': 0.7277091, 'auroc': 0.91124994, 'binary_precision': 0.61728394, 'binary_recall': 0.3846154, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.47393364}
confusion matrix:
      0    1
0  5884   62
1   160  100
early stop counter: 5
val acc:0.9612593650817871, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9655172228813171
after epoch: 17,now: 2024-07-10 22:41:50.588839,epoch time: 0:21:45.323853,used: 6:32:25.825016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98370636, 'precision': 0.9833858, 'recall': 0.9734055, 'specificity': 0.9734055, 'f1': 0.978264, 'auroc': 0.99653006, 'binary_precision': 0.98275495, 'binary_recall': 0.95249325, 'binary_specificity': 0.99431777, 'binary_f1_score': 0.96738756}
confusion matrix:
       0      1
0  42172    241
1    685  13734
---- Validation: 
scalar performance:
{'acc': 0.9618997, 'precision': 0.71261114, 'recall': 0.63548136, 'specificity': 0.63548136, 'f1': 0.66445804, 'auroc': 0.8847988, 'binary_precision': 0.45153666, 'binary_recall': 0.28380385, 'binary_specificity': 0.9871589, 'binary_f1_score': 0.34854016}
confusion matrix:
       0    1
0  17835  232
1    482  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.82561094, 'recall': 0.66009796, 'specificity': 0.66009796, 'f1': 0.711841, 'auroc': 0.90725243, 'binary_precision': 0.68, 'binary_recall': 0.32692307, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.44155845}
confusion matrix:
      0   1
0  5906  40
1   175  85
early stop counter: 6
val acc:0.9618996977806091, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9655172228813171
after epoch: 18,now: 2024-07-10 23:03:37.163536,epoch time: 0:21:46.574697,used: 6:54:12.399713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98375916, 'precision': 0.9852446, 'recall': 0.97174895, 'specificity': 0.97174895, 'f1': 0.978258, 'auroc': 0.9967227, 'binary_precision': 0.9881374, 'binary_recall': 0.94736475, 'binary_specificity': 0.99613315, 'binary_f1_score': 0.96732163}
confusion matrix:
       0      1
0  42248    164
1    759  13661
---- Validation: 
scalar performance:
{'acc': 0.9604055, 'precision': 0.7053773, 'recall': 0.6633172, 'specificity': 0.6633172, 'f1': 0.6816333, 'auroc': 0.89040935, 'binary_precision': 0.43502825, 'binary_recall': 0.34323922, 'binary_specificity': 0.98339516, 'binary_f1_score': 0.3837209}
confusion matrix:
       0    1
0  17767  300
1    442  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.80491316, 'recall': 0.6931156, 'specificity': 0.6931156, 'f1': 0.7350683, 'auroc': 0.9137235, 'binary_precision': 0.63580245, 'binary_recall': 0.39615384, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.48815164}
confusion matrix:
      0    1
0  5887   59
1   157  103
early stop counter: 7
val acc:0.9604055285453796, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9655172228813171
after epoch: 19,now: 2024-07-10 23:25:43.548772,epoch time: 0:22:06.385236,used: 7:16:18.784949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98426944, 'precision': 0.9847075, 'recall': 0.973598, 'specificity': 0.973598, 'f1': 0.9789903, 'auroc': 0.9972813, 'binary_precision': 0.98556656, 'binary_recall': 0.95193505, 'binary_specificity': 0.995261, 'binary_f1_score': 0.9684589}
confusion matrix:
       0      1
0  42213    201
1    693  13725
---- Validation: 
scalar performance:
{'acc': 0.96136606, 'precision': 0.7118828, 'recall': 0.6573779, 'specificity': 0.6573779, 'f1': 0.6800993, 'auroc': 0.89265656, 'binary_precision': 0.44848484, 'binary_recall': 0.32986626, 'binary_specificity': 0.98488957, 'binary_f1_score': 0.38013697}
confusion matrix:
       0    1
0  17794  273
1    451  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.81269705, 'recall': 0.6765647, 'specificity': 0.6765647, 'f1': 0.72367924, 'auroc': 0.91130364, 'binary_precision': 0.6527778, 'binary_recall': 0.36153847, 'binary_specificity': 0.991591, 'binary_f1_score': 0.46534652}
confusion matrix:
      0   1
0  5896  50
1   166  94
early stop counter: 8
val acc:0.9613660573959351, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9655172228813171
after epoch: 20,now: 2024-07-10 23:48:01.752363,epoch time: 0:22:18.203591,used: 7:38:36.988540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9847093, 'precision': 0.9845392, 'recall': 0.97492284, 'specificity': 0.97492284, 'f1': 0.9796091, 'auroc': 0.99710387, 'binary_precision': 0.9842041, 'binary_recall': 0.9550562, 'binary_specificity': 0.9947895, 'binary_f1_score': 0.96941113}
confusion matrix:
       0      1
0  42193    221
1    648  13770
---- Validation: 
scalar performance:
{'acc': 0.9611526, 'precision': 0.7099457, 'recall': 0.65655196, 'specificity': 0.65655196, 'f1': 0.6788641, 'auroc': 0.89308596, 'binary_precision': 0.444668, 'binary_recall': 0.32838038, 'binary_specificity': 0.9847235, 'binary_f1_score': 0.37777776}
confusion matrix:
       0    1
0  17791  276
1    452  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.8035291, 'recall': 0.68182945, 'specificity': 0.68182945, 'f1': 0.7257411, 'auroc': 0.90967846, 'binary_precision': 0.63398695, 'binary_recall': 0.37307692, 'binary_specificity': 0.9905819, 'binary_f1_score': 0.46973366}
confusion matrix:
      0   1
0  5890  56
1   163  97
early stop counter: 9
val acc:0.9611526131629944, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9655172228813171
after epoch: 21,now: 2024-07-11 00:10:39.613367,epoch time: 0:22:37.861004,used: 8:01:14.849544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9856595, 'precision': 0.9859133, 'recall': 0.97608733, 'specificity': 0.97608733, 'f1': 0.98087347, 'auroc': 0.9969793, 'binary_precision': 0.98641306, 'binary_recall': 0.9566544, 'binary_specificity': 0.99552023, 'binary_f1_score': 0.97130585}
confusion matrix:
       0      1
0  42223    190
1    625  13794
---- Validation: 
scalar performance:
{'acc': 0.96195304, 'precision': 0.7173179, 'recall': 0.6598281, 'specificity': 0.6598281, 'f1': 0.6836488, 'auroc': 0.89853007, 'binary_precision': 0.45918366, 'binary_recall': 0.3343239, 'binary_specificity': 0.98533237, 'binary_f1_score': 0.38693035}
confusion matrix:
       0    1
0  17802  265
1    448  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.83378685, 'recall': 0.6961319, 'specificity': 0.6961319, 'f1': 0.7452433, 'auroc': 0.9126085, 'binary_precision': 0.6933333, 'binary_recall': 0.4, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.50731707}
confusion matrix:
      0    1
0  5900   46
1   156  104
new oracle model saved
early stop counter: 10
val acc:0.9619530439376831, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9674508571624756
after epoch: 22,now: 2024-07-11 00:32:31.437365,epoch time: 0:21:51.823998,used: 8:23:06.673542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98377675, 'precision': 0.982719, 'recall': 0.9742538, 'specificity': 0.9742538, 'f1': 0.9783913, 'auroc': 0.9964837, 'binary_precision': 0.98062813, 'binary_recall': 0.9549206, 'binary_specificity': 0.9935869, 'binary_f1_score': 0.9676036}
confusion matrix:
       0      1
0  42141    272
1    650  13769
---- Validation: 
scalar performance:
{'acc': 0.9621665, 'precision': 0.7164371, 'recall': 0.6420572, 'specificity': 0.6420572, 'f1': 0.6705959, 'auroc': 0.89639026, 'binary_precision': 0.4587156, 'binary_recall': 0.2971768, 'binary_specificity': 0.9869375, 'binary_f1_score': 0.3606853}
confusion matrix:
       0    1
0  17831  236
1    473  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.8295197, 'recall': 0.6696292, 'specificity': 0.6696292, 'f1': 0.72140276, 'auroc': 0.9121792, 'binary_precision': 0.6870229, 'binary_recall': 0.34615386, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.46035808}
confusion matrix:
      0   1
0  5905  41
1   170  90
early stop counter: 11
val acc:0.9621664881706238, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9674508571624756
after epoch: 23,now: 2024-07-11 00:54:04.731431,epoch time: 0:21:33.294066,used: 8:44:39.967608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98587066, 'precision': 0.98657525, 'recall': 0.9760014, 'specificity': 0.9760014, 'f1': 0.9811418, 'auroc': 0.99733377, 'binary_precision': 0.98795956, 'binary_recall': 0.9559639, 'binary_specificity': 0.99603885, 'binary_f1_score': 0.97169846}
confusion matrix:
       0      1
0  42244    168
1    635  13785
---- Validation: 
scalar performance:
{'acc': 0.96136606, 'precision': 0.70894897, 'recall': 0.6423573, 'specificity': 0.6423573, 'f1': 0.6685503, 'auroc': 0.89519113, 'binary_precision': 0.4437086, 'binary_recall': 0.2986627, 'binary_specificity': 0.9860519, 'binary_f1_score': 0.35701594}
confusion matrix:
       0    1
0  17815  252
1    472  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.7930524, 'recall': 0.63843954, 'specificity': 0.63843954, 'f1': 0.6850959, 'auroc': 0.9103056, 'binary_precision': 0.6166667, 'binary_recall': 0.2846154, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.3894737}
confusion matrix:
      0   1
0  5900  46
1   186  74
early stop counter: 12
val acc:0.9613660573959351, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9674508571624756
after epoch: 24,now: 2024-07-11 01:15:42.183431,epoch time: 0:21:37.452000,used: 9:06:17.419608,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98583543, 'precision': 0.9844651, 'recall': 0.9779892, 'specificity': 0.9779892, 'f1': 0.98117167, 'auroc': 0.9971682, 'binary_precision': 0.9817397, 'binary_recall': 0.9620613, 'binary_specificity': 0.9939171, 'binary_f1_score': 0.9718009}
confusion matrix:
       0      1
0  42156    258
1    547  13871
---- Validation: 
scalar performance:
{'acc': 0.96093917, 'precision': 0.71073955, 'recall': 0.6700313, 'specificity': 0.6700313, 'f1': 0.68792826, 'auroc': 0.8951124, 'binary_precision': 0.44526902, 'binary_recall': 0.35661218, 'binary_specificity': 0.9834505, 'binary_f1_score': 0.3960396}
confusion matrix:
       0    1
0  17768  299
1    433  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96326137, 'precision': 0.78938025, 'recall': 0.6700387, 'specificity': 0.6700387, 'f1': 0.7124528, 'auroc': 0.90812266, 'binary_precision': 0.6066667, 'binary_recall': 0.35, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.44390243}
confusion matrix:
      0   1
0  5887  59
1   169  91
early stop counter: 13
val acc:0.9609391689300537, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9674508571624756
after epoch: 25,now: 2024-07-11 01:37:27.511435,epoch time: 0:21:45.328004,used: 9:28:02.747612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9854307, 'precision': 0.9850807, 'recall': 0.9763003, 'specificity': 0.9763003, 'f1': 0.9805889, 'auroc': 0.9969877, 'binary_precision': 0.9843895, 'binary_recall': 0.9577641, 'binary_specificity': 0.9948365, 'binary_f1_score': 0.9708943}
confusion matrix:
       0      1
0  42194    219
1    609  13810
---- Validation: 
scalar performance:
{'acc': 0.96237993, 'precision': 0.7171639, 'recall': 0.6335847, 'specificity': 0.6335847, 'f1': 0.6642287, 'auroc': 0.8996681, 'binary_precision': 0.46078432, 'binary_recall': 0.2793462, 'binary_specificity': 0.9878231, 'binary_f1_score': 0.34782606}
confusion matrix:
       0    1
0  17847  220
1    485  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.81838834, 'recall': 0.6467205, 'specificity': 0.6467205, 'f1': 0.697715, 'auroc': 0.9115993, 'binary_precision': 0.6666667, 'binary_recall': 0.3, 'binary_specificity': 0.993441, 'binary_f1_score': 0.41379312}
confusion matrix:
      0   1
0  5907  39
1   182  78
early stop counter: 14
val acc:0.9623799324035645, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9674508571624756
after epoch: 26,now: 2024-07-11 01:59:06.866712,epoch time: 0:21:39.355277,used: 9:49:42.102889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9864865, 'precision': 0.9873227, 'recall': 0.9768903, 'specificity': 0.9768903, 'f1': 0.98196423, 'auroc': 0.99744856, 'binary_precision': 0.9889661, 'binary_recall': 0.9574114, 'binary_specificity': 0.9963692, 'binary_f1_score': 0.972933}
confusion matrix:
       0      1
0  42261    154
1    614  13803
---- Validation: 
scalar performance:
{'acc': 0.9607791, 'precision': 0.70484185, 'recall': 0.64705974, 'specificity': 0.64705974, 'f1': 0.6705965, 'auroc': 0.9006324, 'binary_precision': 0.43514645, 'binary_recall': 0.30906388, 'binary_specificity': 0.9850556, 'binary_f1_score': 0.3614248}
confusion matrix:
       0    1
0  17797  270
1    465  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.7928175, 'recall': 0.6776469, 'specificity': 0.6776469, 'f1': 0.7195383, 'auroc': 0.91267127, 'binary_precision': 0.61290324, 'binary_recall': 0.3653846, 'binary_specificity': 0.9899092, 'binary_f1_score': 0.45783132}
confusion matrix:
      0   1
0  5886  60
1   165  95
early stop counter: 15
val acc:0.960779070854187, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9674508571624756
after epoch: 27,now: 2024-07-11 02:20:52.077253,epoch time: 0:21:45.210541,used: 10:11:27.313430,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98629296, 'precision': 0.98807824, 'recall': 0.97566485, 'specificity': 0.97566485, 'f1': 0.98167086, 'auroc': 0.99755466, 'binary_precision': 0.99156696, 'binary_recall': 0.95408833, 'binary_specificity': 0.99724144, 'binary_f1_score': 0.97246665}
confusion matrix:
       0      1
0  42296    117
1    662  13757
---- Validation: 
scalar performance:
{'acc': 0.9617396, 'precision': 0.70338076, 'recall': 0.60464185, 'specificity': 0.60464185, 'f1': 0.6362699, 'auroc': 0.8909879, 'binary_precision': 0.43529412, 'binary_recall': 0.21991085, 'binary_specificity': 0.9893729, 'binary_f1_score': 0.2922014}
confusion matrix:
       0    1
0  17875  192
1    525  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589107, 'precision': 0.74542296, 'recall': 0.59788674, 'specificity': 0.59788674, 'f1': 0.6362344, 'auroc': 0.8995677, 'binary_precision': 0.5247525, 'binary_recall': 0.20384616, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.2936288}
confusion matrix:
      0   1
0  5898  48
1   207  53
early stop counter: 16
val acc:0.9617395997047424, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9674508571624756
after epoch: 28,now: 2024-07-11 02:42:32.917844,epoch time: 0:21:40.840591,used: 10:33:08.154021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.986768, 'precision': 0.98520327, 'recall': 0.97973675, 'specificity': 0.97973675, 'f1': 0.98243046, 'auroc': 0.99776906, 'binary_precision': 0.9820811, 'binary_recall': 0.9654622, 'binary_specificity': 0.9940113, 'binary_f1_score': 0.9737007}
confusion matrix:
       0      1
0  42159    254
1    498  13921
---- Validation: 
scalar performance:
{'acc': 0.9614194, 'precision': 0.7079012, 'recall': 0.6352323, 'specificity': 0.6352323, 'f1': 0.6629125, 'auroc': 0.90293914, 'binary_precision': 0.44212964, 'binary_recall': 0.28380385, 'binary_specificity': 0.9866608, 'binary_f1_score': 0.34570134}
confusion matrix:
       0    1
0  17826  241
1    482  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.8064754, 'recall': 0.6894376, 'specificity': 0.6894376, 'f1': 0.73262227, 'auroc': 0.91366017, 'binary_precision': 0.6392405, 'binary_recall': 0.38846153, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.48325354}
confusion matrix:
      0    1
0  5889   57
1   159  101
early stop counter: 17
val acc:0.961419403553009, best validation acc: 0.9626467227935791, corresponding to test acc:                         0.9637447595596313 / 0.9674508571624756
after epoch: 29,now: 2024-07-11 03:04:06.444223,epoch time: 0:21:33.526379,used: 10:54:41.680400,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.987683, 'precision': 0.9895375, 'recall': 0.9779008, 'specificity': 0.9779008, 'f1': 0.9835433, 'auroc': 0.9975437, 'binary_precision': 0.9931699, 'binary_recall': 0.9580415, 'binary_specificity': 0.9977601, 'binary_f1_score': 0.97528946}
confusion matrix:
       0      1
0  42318     95
1    605  13814
---- Validation: 
scalar performance:
{'acc': 0.9627535, 'precision': 0.7110366, 'recall': 0.58370966, 'specificity': 0.58370966, 'f1': 0.61678874, 'auroc': 0.89327127, 'binary_precision': 0.45210728, 'binary_recall': 0.17533432, 'binary_specificity': 0.99208504, 'binary_f1_score': 0.25267667}
confusion matrix:
       0    1
0  17924  143
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8322761, 'recall': 0.59622693, 'specificity': 0.59622693, 'f1': 0.64359105, 'auroc': 0.90442836, 'binary_precision': 0.69863015, 'binary_recall': 0.19615385, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.3063063}
confusion matrix:
      0   1
0  5924  22
1   209  51
better model found
persisted
after epoch: 30,now: 2024-07-11 03:25:52.402114,epoch time: 0:21:45.957891,used: 11:16:27.638291,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_16_09_24_seed_1_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:16:27.638291 at 2024-07-11 03:25:52.402114
persisted model performance metric: 

scalar performance:
{'acc': 0.962778, 'precision': 0.8322761, 'recall': 0.59622693, 'specificity': 0.59622693, 'f1': 0.64359105, 'auroc': 0.90442836, 'binary_precision': 0.69863015, 'binary_recall': 0.19615385, 'binary_specificity': 0.99630004, 'binary_f1_score': 0.3063063}
confusion matrix:
      0   1
0  5924  22
1   209  51
oracle model performance metric: 

scalar performance:
{'acc': 0.96745086, 'precision': 0.83378685, 'recall': 0.6961319, 'specificity': 0.6961319, 'f1': 0.7452433, 'auroc': 0.9126085, 'binary_precision': 0.6933333, 'binary_recall': 0.4, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.50731707}
confusion matrix:
      0    1
0  5900   46
1   156  104
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |  17479 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |  17479 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   7827 MiB |   2350 TiB |   2350 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   2320 TiB |   2320 TiB |
|       from small pool |  16480 KiB |     36 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  16792 MiB |   8280 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  16734 MiB |   8260 MiB |
|       from small pool |     38 MiB |     44 MiB |     58 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40878 KiB | 732464 KiB |   1304 TiB |   1304 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1274 TiB |   1274 TiB |
|       from small pool |   9145 KiB |  21224 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7625    |  388810 K  |  388807 K  |
|       from large pool |      79    |     762    |  220130 K  |  220130 K  |
|       from small pool |    2875    |    7544    |  168680 K  |  168677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7625    |  388810 K  |  388807 K  |
|       from large pool |      79    |     762    |  220130 K  |  220130 K  |
|       from small pool |    2875    |    7544    |  168680 K  |  168677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |     716    |     348    |
|       from large pool |     349    |     349    |     687    |     338    |
|       from small pool |      19    |      22    |      29    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3589    |  230577 K  |  230577 K  |
|       from large pool |      11    |     352    |  159260 K  |  159260 K  |
|       from small pool |      24    |    3579    |   71316 K  |   71316 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     36 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  16792 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  26624 KiB |     44 MiB |     58 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1304 TiB |   1304 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1274 TiB |   1274 TiB |
|       from small pool |      0 KiB |  21236 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  388810 K  |  388810 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168680 K  |  168680 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  388810 K  |  388810 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168680 K  |  168680 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     716    |     693    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      13    |      22    |      29    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  230578 K  |  230578 K  |
|       from large pool |       3    |     352    |  159260 K  |  159260 K  |
|       from small pool |       0    |    3579    |   71318 K  |   71318 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     37 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   2350 TiB |   2350 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   2320 TiB |   2320 TiB |
|       from small pool |      0 KiB |     36 MiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  16792 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  26624 KiB |     44 MiB |     58 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1304 TiB |   1304 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1274 TiB |   1274 TiB |
|       from small pool |      0 KiB |  21236 KiB |     29 TiB |     29 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  388810 K  |  388810 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168680 K  |  168680 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  388810 K  |  388810 K  |
|       from large pool |       2    |     762    |  220130 K  |  220130 K  |
|       from small pool |       0    |    7544    |  168680 K  |  168680 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     716    |     693    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      13    |      22    |      29    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  230578 K  |  230578 K  |
|       from large pool |       3    |     352    |  159260 K  |  159260 K  |
|       from small pool |       0    |    3579    |   71318 K  |   71318 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618

 Experiment start at: 2024-07-11 03:44:40.734149
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9443419, 'precision': 0.9477515, 'recall': 0.9071715, 'specificity': 0.9071715, 'f1': 0.92500144, 'auroc': 0.970303, 'binary_precision': 0.954037, 'binary_recall': 0.82861865, 'binary_specificity': 0.9857244, 'binary_f1_score': 0.88691586}
confusion matrix:
       0      1
0  41706    604
1   2593  12537
---- Validation: 
scalar performance:
{'acc': 0.9559474, 'precision': 0.62455153, 'recall': 0.60382646, 'specificity': 0.60382646, 'f1': 0.61308646, 'auroc': 0.79044914, 'binary_precision': 0.2745491, 'binary_recall': 0.22757475, 'binary_specificity': 0.98007816, 'binary_f1_score': 0.24886468}
confusion matrix:
       0    1
0  17809  362
1    465  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9272319, 'precision': 0.52114236, 'recall': 0.5219793, 'specificity': 0.5219793, 'f1': 0.52154386, 'auroc': 0.65739137, 'binary_precision': 0.07936508, 'binary_recall': 0.08264463, 'binary_specificity': 0.96131396, 'binary_f1_score': 0.08097166}
confusion matrix:
      0    1
0  5765  232
1   222   20
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 04:06:51.940752,epoch time: 0:22:11.206603,used: 0:22:11.206603,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9584958, 'precision': 0.96263504, 'recall': 0.92970365, 'specificity': 0.92970365, 'f1': 0.9446019, 'auroc': 0.98168546, 'binary_precision': 0.9704688, 'binary_recall': 0.86886114, 'binary_specificity': 0.99054617, 'binary_f1_score': 0.9168585}
confusion matrix:
       0      1
0  41911    400
1   1984  13145
---- Validation: 
scalar performance:
{'acc': 0.96228623, 'precision': 0.6630534, 'recall': 0.5982674, 'specificity': 0.5982674, 'f1': 0.62157416, 'auroc': 0.8180629, 'binary_precision': 0.3519553, 'binary_recall': 0.20930232, 'binary_specificity': 0.9872324, 'binary_f1_score': 0.2625}
confusion matrix:
       0    1
0  17939  232
1    476  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9382914, 'precision': 0.5427474, 'recall': 0.5336804, 'specificity': 0.5336804, 'f1': 0.53738517, 'auroc': 0.74746287, 'binary_precision': 0.12169312, 'binary_recall': 0.09504132, 'binary_specificity': 0.9723195, 'binary_f1_score': 0.10672853}
confusion matrix:
      0    1
0  5831  166
1   219   23
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-11 04:28:32.310459,epoch time: 0:21:40.369707,used: 0:43:51.576310,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9646239, 'precision': 0.9693736, 'recall': 0.9391113, 'specificity': 0.9391113, 'f1': 0.9529388, 'auroc': 0.9870081, 'binary_precision': 0.9784483, 'binary_recall': 0.88519496, 'binary_specificity': 0.9930276, 'binary_f1_score': 0.92948854}
confusion matrix:
       0      1
0  42015    295
1   1737  13393
---- Validation: 
scalar performance:
{'acc': 0.96447027, 'precision': 0.6813358, 'recall': 0.58975893, 'specificity': 0.58975893, 'f1': 0.6182749, 'auroc': 0.83805424, 'binary_precision': 0.3890785, 'binary_recall': 0.18936877, 'binary_specificity': 0.99014914, 'binary_f1_score': 0.25474858}
confusion matrix:
       0    1
0  17992  179
1    488  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94566435, 'precision': 0.58774495, 'recall': 0.56130856, 'specificity': 0.56130856, 'f1': 0.57153034, 'auroc': 0.8035147, 'binary_precision': 0.20958084, 'binary_recall': 0.1446281, 'binary_specificity': 0.977989, 'binary_f1_score': 0.17114913}
confusion matrix:
      0    1
0  5865  132
1   207   35
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-11 04:50:02.392689,epoch time: 0:21:30.082230,used: 1:05:21.658540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9700557, 'precision': 0.97240937, 'recall': 0.9500134, 'specificity': 0.9500134, 'f1': 0.9604963, 'auroc': 0.98895496, 'binary_precision': 0.97701883, 'binary_recall': 0.9076608, 'binary_specificity': 0.9923661, 'binary_f1_score': 0.9410636}
confusion matrix:
       0      1
0  41988    323
1   1397  13732
---- Validation: 
scalar performance:
{'acc': 0.96649444, 'precision': 0.70644057, 'recall': 0.57875884, 'specificity': 0.57875884, 'f1': 0.6111448, 'auroc': 0.84852076, 'binary_precision': 0.44, 'binary_recall': 0.16445182, 'binary_specificity': 0.9930659, 'binary_f1_score': 0.23941958}
confusion matrix:
       0    1
0  18045  126
1    503   99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95047283, 'precision': 0.6143969, 'recall': 0.56777525, 'specificity': 0.56777525, 'f1': 0.58383185, 'auroc': 0.83110976, 'binary_precision': 0.26241136, 'binary_recall': 0.15289256, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.19321148}
confusion matrix:
      0    1
0  5893  104
1   205   37
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-11 05:11:47.363901,epoch time: 0:21:44.971212,used: 1:27:06.629752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9716052, 'precision': 0.97354555, 'recall': 0.95289385, 'specificity': 0.95289385, 'f1': 0.96261215, 'auroc': 0.9907901, 'binary_precision': 0.9773676, 'binary_recall': 0.91335094, 'binary_specificity': 0.99243677, 'binary_f1_score': 0.9442755}
confusion matrix:
       0      1
0  41990    320
1   1311  13819
---- Validation: 
scalar performance:
{'acc': 0.96660095, 'precision': 0.71437943, 'recall': 0.5996932, 'specificity': 0.5996932, 'f1': 0.6339819, 'auroc': 0.8577473, 'binary_precision': 0.45454547, 'binary_recall': 0.2076412, 'binary_specificity': 0.9917451, 'binary_f1_score': 0.28506273}
confusion matrix:
       0    1
0  18021  150
1    477  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94887, 'precision': 0.630419, 'recall': 0.6006481, 'specificity': 0.6006481, 'f1': 0.6132283, 'auroc': 0.8505361, 'binary_precision': 0.2918919, 'binary_recall': 0.2231405, 'binary_specificity': 0.97815573, 'binary_f1_score': 0.2529274}
confusion matrix:
      0    1
0  5866  131
1   188   54
better model found
persisted
after epoch: 5,now: 2024-07-11 05:33:26.028715,epoch time: 0:21:38.664814,used: 1:48:45.294566,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9742862, 'precision': 0.97548795, 'recall': 0.95789814, 'specificity': 0.95789814, 'f1': 0.9662528, 'auroc': 0.9919847, 'binary_precision': 0.97787887, 'binary_recall': 0.92326504, 'binary_specificity': 0.9925313, 'binary_f1_score': 0.94978756}
confusion matrix:
       0      1
0  41994    316
1   1161  13969
---- Validation: 
scalar performance:
{'acc': 0.9670271, 'precision': 0.72203314, 'recall': 0.60473156, 'specificity': 0.60473156, 'f1': 0.64025337, 'auroc': 0.86175823, 'binary_precision': 0.46953404, 'binary_recall': 0.21760798, 'binary_specificity': 0.99185514, 'binary_f1_score': 0.29738933}
confusion matrix:
       0    1
0  18023  148
1    471  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94967145, 'precision': 0.64120126, 'recall': 0.6129615, 'specificity': 0.6129615, 'f1': 0.6252134, 'auroc': 0.86255383, 'binary_precision': 0.3125, 'binary_recall': 0.24793388, 'binary_specificity': 0.977989, 'binary_f1_score': 0.27649772}
confusion matrix:
      0    1
0  5865  132
1   182   60
better model found
persisted
after epoch: 6,now: 2024-07-11 05:55:16.949214,epoch time: 0:21:50.920499,used: 2:10:36.215065,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9746518, 'precision': 0.9764868, 'recall': 0.9578916, 'specificity': 0.9578916, 'f1': 0.9666991, 'auroc': 0.9929848, 'binary_precision': 0.9801264, 'binary_recall': 0.9224719, 'binary_specificity': 0.9933113, 'binary_f1_score': 0.95042557}
confusion matrix:
       0      1
0  42027    283
1   1173  13957
---- Validation: 
scalar performance:
{'acc': 0.96660095, 'precision': 0.71731675, 'recall': 0.61334497, 'specificity': 0.61334497, 'f1': 0.6473153, 'auroc': 0.8672769, 'binary_precision': 0.45954692, 'binary_recall': 0.2358804, 'binary_specificity': 0.99080956, 'binary_f1_score': 0.31174538}
confusion matrix:
       0    1
0  18004  167
1    460  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9475877, 'precision': 0.6393895, 'recall': 0.6277395, 'specificity': 0.6277395, 'f1': 0.63326025, 'auroc': 0.86794984, 'binary_precision': 0.30769232, 'binary_recall': 0.28099173, 'binary_specificity': 0.97448725, 'binary_f1_score': 0.2937365}
confusion matrix:
      0    1
0  5844  153
1   174   68
early stop counter: 1
val acc:0.9666009545326233, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 7,now: 2024-07-11 06:17:06.363265,epoch time: 0:21:49.414051,used: 2:32:25.629116,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97788996, 'precision': 0.9791646, 'recall': 0.96361375, 'specificity': 0.96361375, 'f1': 0.9710475, 'auroc': 0.9940375, 'binary_precision': 0.98171836, 'binary_recall': 0.9334435, 'binary_specificity': 0.99378395, 'binary_f1_score': 0.9569725}
confusion matrix:
       0      1
0  42047    263
1   1007  14123
---- Validation: 
scalar performance:
{'acc': 0.9668673, 'precision': 0.72341657, 'recall': 0.62874043, 'specificity': 0.62874043, 'f1': 0.66205406, 'auroc': 0.87224805, 'binary_precision': 0.47076023, 'binary_recall': 0.26744187, 'binary_specificity': 0.99003905, 'binary_f1_score': 0.3411017}
confusion matrix:
       0    1
0  17990  181
1    441  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9469466, 'precision': 0.6421228, 'recall': 0.63930243, 'specificity': 0.63930243, 'f1': 0.6406957, 'auroc': 0.8724045, 'binary_precision': 0.31223628, 'binary_recall': 0.30578512, 'binary_specificity': 0.97281975, 'binary_f1_score': 0.30897704}
confusion matrix:
      0    1
0  5834  163
1   168   74
early stop counter: 2
val acc:0.9668673276901245, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 8,now: 2024-07-11 06:39:39.359410,epoch time: 0:22:32.996145,used: 2:54:58.625261,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9785167, 'precision': 0.97805905, 'recall': 0.9662876, 'specificity': 0.9662876, 'f1': 0.971976, 'auroc': 0.9941819, 'binary_precision': 0.9771307, 'binary_recall': 0.9404455, 'binary_specificity': 0.9921297, 'binary_f1_score': 0.9584372}
confusion matrix:
       0      1
0  41978    333
1    901  14228
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.72071433, 'recall': 0.6493721, 'specificity': 0.6493721, 'f1': 0.6774355, 'auroc': 0.87520146, 'binary_precision': 0.46401986, 'binary_recall': 0.31063122, 'binary_specificity': 0.9881129, 'binary_f1_score': 0.3721393}
confusion matrix:
       0    1
0  17955  216
1    415  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94021475, 'precision': 0.62797606, 'recall': 0.65761083, 'specificity': 0.65761083, 'f1': 0.64091146, 'auroc': 0.87357104, 'binary_precision': 0.28239202, 'binary_recall': 0.35123968, 'binary_specificity': 0.963982, 'binary_f1_score': 0.3130755}
confusion matrix:
      0    1
0  5781  216
1   157   85
early stop counter: 3
val acc:0.9663878679275513, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 9,now: 2024-07-11 07:01:35.398653,epoch time: 0:21:56.039243,used: 3:16:54.664504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9798921, 'precision': 0.97945404, 'recall': 0.9684756, 'specificity': 0.9684756, 'f1': 0.9737936, 'auroc': 0.99494064, 'binary_precision': 0.97856313, 'binary_recall': 0.944349, 'binary_specificity': 0.9926022, 'binary_f1_score': 0.96115166}
confusion matrix:
       0      1
0  41997    313
1    842  14288
---- Validation: 
scalar performance:
{'acc': 0.9653758, 'precision': 0.71431875, 'recall': 0.6713346, 'specificity': 0.6713346, 'f1': 0.6901617, 'auroc': 0.8781632, 'binary_precision': 0.4497908, 'binary_recall': 0.35714287, 'binary_specificity': 0.9855264, 'binary_f1_score': 0.39814818}
confusion matrix:
       0    1
0  17908  263
1    387  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9342843, 'precision': 0.6237762, 'recall': 0.68426704, 'specificity': 0.68426704, 'f1': 0.6466611, 'auroc': 0.8752214, 'binary_precision': 0.27173913, 'binary_recall': 0.41322315, 'binary_specificity': 0.955311, 'binary_f1_score': 0.32786885}
confusion matrix:
      0    1
0  5729  268
1   142  100
early stop counter: 4
val acc:0.9653757810592651, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 10,now: 2024-07-11 07:23:39.073518,epoch time: 0:22:03.674865,used: 3:38:58.339369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9800662, 'precision': 0.9812856, 'recall': 0.96714634, 'specificity': 0.96714634, 'f1': 0.97393465, 'auroc': 0.995276, 'binary_precision': 0.9837404, 'binary_recall': 0.93984663, 'binary_specificity': 0.99444604, 'binary_f1_score': 0.9612927}
confusion matrix:
       0      1
0  42077    235
1    910  14218
---- Validation: 
scalar performance:
{'acc': 0.96548235, 'precision': 0.71366835, 'recall': 0.66175306, 'specificity': 0.66175306, 'f1': 0.68372095, 'auroc': 0.87928355, 'binary_precision': 0.44911504, 'binary_recall': 0.3372093, 'binary_specificity': 0.98629683, 'binary_f1_score': 0.38519925}
confusion matrix:
       0    1
0  17922  249
1    399  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9350858, 'precision': 0.62280476, 'recall': 0.676753, 'specificity': 0.676753, 'f1': 0.64375997, 'auroc': 0.8740238, 'binary_precision': 0.27042255, 'binary_recall': 0.3966942, 'binary_specificity': 0.9568117, 'binary_f1_score': 0.32160807}
confusion matrix:
      0    1
0  5738  259
1   146   96
early stop counter: 5
val acc:0.9654823541641235, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 11,now: 2024-07-11 07:45:43.329830,epoch time: 0:22:04.256312,used: 4:01:02.595681,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9816504, 'precision': 0.98396695, 'recall': 0.96865016, 'specificity': 0.96865016, 'f1': 0.9759813, 'auroc': 0.99573934, 'binary_precision': 0.98861426, 'binary_recall': 0.9411765, 'binary_specificity': 0.99612385, 'binary_f1_score': 0.9643123}
confusion matrix:
       0      1
0  42146    164
1    890  14240
---- Validation: 
scalar performance:
{'acc': 0.9639376, 'precision': 0.69895816, 'recall': 0.6561368, 'specificity': 0.6561368, 'f1': 0.6746599, 'auroc': 0.87473714, 'binary_precision': 0.42004263, 'binary_recall': 0.32724252, 'binary_specificity': 0.98503107, 'binary_f1_score': 0.3678805}
confusion matrix:
       0    1
0  17899  272
1    405  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9291553, 'precision': 0.61763906, 'recall': 0.69547826, 'specificity': 0.69547826, 'f1': 0.6444158, 'auroc': 0.8709934, 'binary_precision': 0.2584541, 'binary_recall': 0.44214877, 'binary_specificity': 0.9488077, 'binary_f1_score': 0.32621953}
confusion matrix:
      0    1
0  5690  307
1   135  107
early stop counter: 6
val acc:0.9639375805854797, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 12,now: 2024-07-11 08:07:51.758677,epoch time: 0:22:08.428847,used: 4:23:11.024528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98203343, 'precision': 0.98231065, 'recall': 0.9712029, 'specificity': 0.9712029, 'f1': 0.9765829, 'auroc': 0.9958534, 'binary_precision': 0.9828744, 'binary_recall': 0.9483146, 'binary_specificity': 0.9940912, 'binary_f1_score': 0.96528524}
confusion matrix:
       0      1
0  42060    250
1    782  14348
---- Validation: 
scalar performance:
{'acc': 0.96516275, 'precision': 0.711021, 'recall': 0.66319406, 'specificity': 0.66319406, 'f1': 0.68370587, 'auroc': 0.8804332, 'binary_precision': 0.44372293, 'binary_recall': 0.34053156, 'binary_specificity': 0.9858566, 'binary_f1_score': 0.38533834}
confusion matrix:
       0    1
0  17914  257
1    397  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93171984, 'precision': 0.6208521, 'recall': 0.690864, 'specificity': 0.690864, 'f1': 0.646054, 'auroc': 0.8730942, 'binary_precision': 0.26530612, 'binary_recall': 0.42975205, 'binary_specificity': 0.951976, 'binary_f1_score': 0.3280757}
confusion matrix:
      0    1
0  5709  288
1   138  104
early stop counter: 7
val acc:0.9651627540588379, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 13,now: 2024-07-11 08:30:33.676027,epoch time: 0:22:41.917350,used: 4:45:52.941878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9827298, 'precision': 0.9842032, 'recall': 0.97116613, 'specificity': 0.97116613, 'f1': 0.97744703, 'auroc': 0.9961691, 'binary_precision': 0.98718125, 'binary_recall': 0.94672835, 'binary_specificity': 0.99560386, 'binary_f1_score': 0.9665317}
confusion matrix:
       0      1
0  42124    186
1    806  14324
---- Validation: 
scalar performance:
{'acc': 0.9631385, 'precision': 0.7018719, 'recall': 0.69667953, 'specificity': 0.69667953, 'f1': 0.6992377, 'auroc': 0.8869212, 'binary_precision': 0.42320818, 'binary_recall': 0.41196012, 'binary_specificity': 0.98139894, 'binary_f1_score': 0.41750842}
confusion matrix:
       0    1
0  17833  338
1    354  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92434686, 'precision': 0.61828434, 'recall': 0.7227181, 'specificity': 0.7227181, 'f1': 0.65032643, 'auroc': 0.87790656, 'binary_precision': 0.25738397, 'binary_recall': 0.5041322, 'binary_specificity': 0.94130397, 'binary_f1_score': 0.34078214}
confusion matrix:
      0    1
0  5645  352
1   120  122
early stop counter: 8
val acc:0.9631385207176208, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 14,now: 2024-07-11 08:52:55.554144,epoch time: 0:22:21.878117,used: 5:08:14.819995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9823468, 'precision': 0.9811113, 'recall': 0.97319746, 'specificity': 0.97319746, 'f1': 0.97706544, 'auroc': 0.9962733, 'binary_precision': 0.9785719, 'binary_recall': 0.95386344, 'binary_specificity': 0.9925315, 'binary_f1_score': 0.96605974}
confusion matrix:
       0      1
0  41995    316
1    698  14431
---- Validation: 
scalar performance:
{'acc': 0.9615405, 'precision': 0.69117916, 'recall': 0.69424796, 'specificity': 0.69424796, 'f1': 0.6926998, 'auroc': 0.88442343, 'binary_precision': 0.4019608, 'binary_recall': 0.40863788, 'binary_specificity': 0.97985804, 'binary_f1_score': 0.40527186}
confusion matrix:
       0    1
0  17805  366
1    356  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92082065, 'precision': 0.61717486, 'recall': 0.7367458, 'specificity': 0.7367458, 'f1': 0.65134597, 'auroc': 0.87527514, 'binary_precision': 0.25390625, 'binary_recall': 0.5371901, 'binary_specificity': 0.93630147, 'binary_f1_score': 0.3448276}
confusion matrix:
      0    1
0  5615  382
1   112  130
early stop counter: 9
val acc:0.9615405201911926, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 15,now: 2024-07-11 09:14:55.789875,epoch time: 0:22:00.235731,used: 5:30:15.055726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98349583, 'precision': 0.9843495, 'recall': 0.9729811, 'specificity': 0.9729811, 'f1': 0.9784842, 'auroc': 0.99635553, 'binary_precision': 0.98608446, 'binary_recall': 0.95076007, 'binary_specificity': 0.99520206, 'binary_f1_score': 0.96810013}
confusion matrix:
       0      1
0  42107    203
1    745  14385
---- Validation: 
scalar performance:
{'acc': 0.9628189, 'precision': 0.699887, 'recall': 0.6973175, 'specificity': 0.6973175, 'f1': 0.69859284, 'auroc': 0.8893552, 'binary_precision': 0.41919193, 'binary_recall': 0.41362128, 'binary_specificity': 0.9810137, 'binary_f1_score': 0.41638795}
confusion matrix:
       0    1
0  17826  345
1    353  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9294759, 'precision': 0.6221627, 'recall': 0.70754147, 'specificity': 0.70754147, 'f1': 0.65104455, 'auroc': 0.876581, 'binary_precision': 0.26650944, 'binary_recall': 0.46694216, 'binary_specificity': 0.94814074, 'binary_f1_score': 0.33933935}
confusion matrix:
      0    1
0  5686  311
1   129  113
early stop counter: 10
val acc:0.9628189206123352, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 16,now: 2024-07-11 09:36:46.616018,epoch time: 0:21:50.826143,used: 5:52:05.881869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9843489, 'precision': 0.98539764, 'recall': 0.9741546, 'specificity': 0.9741546, 'f1': 0.9795995, 'auroc': 0.9967027, 'binary_precision': 0.98753, 'binary_recall': 0.95261073, 'binary_specificity': 0.9956984, 'binary_f1_score': 0.96975607}
confusion matrix:
       0      1
0  42128    182
1    717  14413
---- Validation: 
scalar performance:
{'acc': 0.962233, 'precision': 0.6974212, 'recall': 0.7034392, 'specificity': 0.7034392, 'f1': 0.7003794, 'auroc': 0.89119923, 'binary_precision': 0.41384864, 'binary_recall': 0.4269103, 'binary_specificity': 0.9799681, 'binary_f1_score': 0.420278}
confusion matrix:
       0    1
0  17807  364
1    345  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9291553, 'precision': 0.6252431, 'recall': 0.7192711, 'specificity': 0.7192711, 'f1': 0.656268, 'auroc': 0.8767919, 'binary_precision': 0.2716895, 'binary_recall': 0.49173555, 'binary_specificity': 0.9468067, 'binary_f1_score': 0.35}
confusion matrix:
      0    1
0  5678  319
1   123  119
early stop counter: 11
val acc:0.9622330069541931, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 17,now: 2024-07-11 09:59:03.801271,epoch time: 0:22:17.185253,used: 6:14:23.067122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98386145, 'precision': 0.982095, 'recall': 0.97615767, 'specificity': 0.97615767, 'f1': 0.97907627, 'auroc': 0.99656624, 'binary_precision': 0.97843957, 'binary_recall': 0.9598784, 'binary_specificity': 0.99243695, 'binary_f1_score': 0.9690701}
confusion matrix:
       0      1
0  41991    320
1    607  14522
---- Validation: 
scalar performance:
{'acc': 0.957652, 'precision': 0.68039465, 'recall': 0.73399776, 'specificity': 0.73399776, 'f1': 0.70324004, 'auroc': 0.8945761, 'binary_precision': 0.3776933, 'binary_recall': 0.4950166, 'binary_specificity': 0.97297895, 'binary_f1_score': 0.42846873}
confusion matrix:
       0    1
0  17680  491
1    304  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91360795, 'precision': 0.6144105, 'recall': 0.7607523, 'specificity': 0.7607523, 'f1': 0.6509923, 'auroc': 0.8758553, 'binary_precision': 0.24615385, 'binary_recall': 0.59504133, 'binary_specificity': 0.92646325, 'binary_f1_score': 0.34824666}
confusion matrix:
      0    1
0  5556  441
1    98  144
early stop counter: 12
val acc:0.9576519727706909, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 18,now: 2024-07-11 10:21:32.628659,epoch time: 0:22:28.827388,used: 6:36:51.894510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98466223, 'precision': 0.9870454, 'recall': 0.9733907, 'specificity': 0.9733907, 'f1': 0.9799595, 'auroc': 0.99675214, 'binary_precision': 0.99185365, 'binary_recall': 0.9495704, 'binary_specificity': 0.99721104, 'binary_f1_score': 0.9702515}
confusion matrix:
       0      1
0  42192    118
1    763  14367
---- Validation: 
scalar performance:
{'acc': 0.96127415, 'precision': 0.690488, 'recall': 0.6981256, 'specificity': 0.6981256, 'f1': 0.694222, 'auroc': 0.89114976, 'binary_precision': 0.40031898, 'binary_recall': 0.41694352, 'binary_specificity': 0.9793077, 'binary_f1_score': 0.40846217}
confusion matrix:
       0    1
0  17795  376
1    351  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9283539, 'precision': 0.62370074, 'recall': 0.71885425, 'specificity': 0.71885425, 'f1': 0.65477073, 'auroc': 0.8732348, 'binary_precision': 0.26862302, 'binary_recall': 0.49173555, 'binary_specificity': 0.945973, 'binary_f1_score': 0.34744525}
confusion matrix:
      0    1
0  5673  324
1   123  119
early stop counter: 13
val acc:0.9612741470336914, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 19,now: 2024-07-11 10:43:47.809436,epoch time: 0:22:15.180777,used: 6:59:07.075287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98539346, 'precision': 0.98635435, 'recall': 0.97590244, 'specificity': 0.97590244, 'f1': 0.980976, 'auroc': 0.99693227, 'binary_precision': 0.98831326, 'binary_recall': 0.95584637, 'binary_specificity': 0.9959585, 'binary_f1_score': 0.97180873}
confusion matrix:
       0      1
0  42140    171
1    668  14461
---- Validation: 
scalar performance:
{'acc': 0.95930326, 'precision': 0.68443644, 'recall': 0.71798676, 'specificity': 0.71798676, 'f1': 0.6996226, 'auroc': 0.8939754, 'binary_precision': 0.38687152, 'binary_recall': 0.4601329, 'binary_specificity': 0.9758406, 'binary_f1_score': 0.42033383}
confusion matrix:
       0    1
0  17732  439
1    325  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9201795, 'precision': 0.6178617, 'recall': 0.7423605, 'specificity': 0.7423605, 'f1': 0.65282714, 'auroc': 0.8753426, 'binary_precision': 0.25478926, 'binary_recall': 0.5495868, 'binary_specificity': 0.93513423, 'binary_f1_score': 0.34816754}
confusion matrix:
      0    1
0  5608  389
1   109  133
early stop counter: 14
val acc:0.9593032598495483, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 20,now: 2024-07-11 11:06:14.440512,epoch time: 0:22:26.631076,used: 7:21:33.706363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9857939, 'precision': 0.9857786, 'recall': 0.97749186, 'specificity': 0.97749186, 'f1': 0.981539, 'auroc': 0.99712074, 'binary_precision': 0.9857473, 'binary_recall': 0.9599471, 'binary_specificity': 0.99503666, 'binary_f1_score': 0.9726761}
confusion matrix:
       0      1
0  42100    210
1    606  14524
---- Validation: 
scalar performance:
{'acc': 0.96111435, 'precision': 0.69522727, 'recall': 0.7245437, 'specificity': 0.7245437, 'f1': 0.7087287, 'auroc': 0.89620095, 'binary_precision': 0.40804598, 'binary_recall': 0.4717608, 'binary_specificity': 0.9773265, 'binary_f1_score': 0.43759632}
confusion matrix:
       0    1
0  17759  412
1    318  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9283539, 'precision': 0.6272485, 'recall': 0.7307507, 'specificity': 0.7307507, 'f1': 0.6603688, 'auroc': 0.8743034, 'binary_precision': 0.2747253, 'binary_recall': 0.5165289, 'binary_specificity': 0.9449725, 'binary_f1_score': 0.35868007}
confusion matrix:
      0    1
0  5667  330
1   117  125
early stop counter: 15
val acc:0.9611143469810486, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 21,now: 2024-07-11 11:28:27.198575,epoch time: 0:22:12.758063,used: 7:43:46.464426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9856546, 'precision': 0.9861383, 'recall': 0.9767803, 'specificity': 0.9767803, 'f1': 0.98133683, 'auroc': 0.99746156, 'binary_precision': 0.98712796, 'binary_recall': 0.9580276, 'binary_specificity': 0.99553305, 'binary_f1_score': 0.9723601}
confusion matrix:
       0      1
0  42122    189
1    635  14494
---- Validation: 
scalar performance:
{'acc': 0.9582912, 'precision': 0.681139, 'recall': 0.7246914, 'specificity': 0.7246914, 'f1': 0.70025253, 'auroc': 0.8953506, 'binary_precision': 0.3798141, 'binary_recall': 0.47508305, 'binary_specificity': 0.9742997, 'binary_f1_score': 0.42214024}
confusion matrix:
       0    1
0  17704  467
1    316  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9213015, 'precision': 0.6217904, 'recall': 0.7508751, 'specificity': 0.7508751, 'f1': 0.6581254, 'auroc': 0.8743924, 'binary_precision': 0.26195028, 'binary_recall': 0.5661157, 'binary_specificity': 0.9356345, 'binary_f1_score': 0.3581699}
confusion matrix:
      0    1
0  5611  386
1   105  137
early stop counter: 16
val acc:0.9582911729812622, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 22,now: 2024-07-11 11:50:20.844872,epoch time: 0:21:53.646297,used: 8:05:40.110723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98666435, 'precision': 0.9867033, 'recall': 0.9788258, 'specificity': 0.9788258, 'f1': 0.98267764, 'auroc': 0.9976686, 'binary_precision': 0.98678327, 'binary_recall': 0.9622604, 'binary_specificity': 0.9953912, 'binary_f1_score': 0.9743675}
confusion matrix:
       0      1
0  42115    195
1    571  14559
---- Validation: 
scalar performance:
{'acc': 0.9573323, 'precision': 0.6841669, 'recall': 0.7579241, 'specificity': 0.7579241, 'f1': 0.7140225, 'auroc': 0.90129614, 'binary_precision': 0.38362575, 'binary_recall': 0.54485047, 'binary_specificity': 0.97099775, 'binary_f1_score': 0.4502402}
confusion matrix:
       0    1
0  17644  527
1    274  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9211412, 'precision': 0.6226111, 'recall': 0.75475717, 'specificity': 0.75475717, 'f1': 0.65950817, 'auroc': 0.87686133, 'binary_precision': 0.26325756, 'binary_recall': 0.57438016, 'binary_specificity': 0.93513423, 'binary_f1_score': 0.36103895}
confusion matrix:
      0    1
0  5608  389
1   103  139
early stop counter: 17
val acc:0.9573323130607605, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 23,now: 2024-07-11 12:13:20.507093,epoch time: 0:22:59.662221,used: 8:28:39.772944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98614204, 'precision': 0.9846401, 'recall': 0.97953165, 'specificity': 0.97953165, 'f1': 0.982049, 'auroc': 0.9975382, 'binary_precision': 0.98152256, 'binary_recall': 0.9655628, 'binary_specificity': 0.99350053, 'binary_f1_score': 0.9734773}
confusion matrix:
       0      1
0  42036    275
1    521  14608
---- Validation: 
scalar performance:
{'acc': 0.9552016, 'precision': 0.6776464, 'recall': 0.76646006, 'specificity': 0.76646006, 'f1': 0.71186465, 'auroc': 0.90072066, 'binary_precision': 0.36996734, 'binary_recall': 0.56478405, 'binary_specificity': 0.968136, 'binary_f1_score': 0.44707426}
confusion matrix:
       0    1
0  17592  579
1    262  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9120051, 'precision': 0.6112827, 'recall': 0.7559531, 'specificity': 0.7559531, 'f1': 0.6468958, 'auroc': 0.87283385, 'binary_precision': 0.24027073, 'binary_recall': 0.58677685, 'binary_specificity': 0.92512923, 'binary_f1_score': 0.3409364}
confusion matrix:
      0    1
0  5548  449
1   100  142
early stop counter: 18
val acc:0.9552016258239746, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 24,now: 2024-07-11 12:36:19.396515,epoch time: 0:22:58.889422,used: 8:51:38.662366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98758703, 'precision': 0.98649025, 'recall': 0.98142546, 'specificity': 0.98142546, 'f1': 0.9839218, 'auroc': 0.99749583, 'binary_precision': 0.98421335, 'binary_recall': 0.96840507, 'binary_specificity': 0.99444586, 'binary_f1_score': 0.9762452}
confusion matrix:
       0      1
0  42076    235
1    478  14651
---- Validation: 
scalar performance:
{'acc': 0.9583977, 'precision': 0.6893865, 'recall': 0.7616867, 'specificity': 0.7616867, 'f1': 0.7189409, 'auroc': 0.9023049, 'binary_precision': 0.39383155, 'binary_recall': 0.551495, 'binary_specificity': 0.9718783, 'binary_f1_score': 0.45951557}
confusion matrix:
       0    1
0  17660  511
1    270  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92610997, 'precision': 0.63295144, 'recall': 0.76527274, 'specificity': 0.76527274, 'f1': 0.67178357, 'auroc': 0.8769977, 'binary_precision': 0.28316832, 'binary_recall': 0.59090906, 'binary_specificity': 0.93963647, 'binary_f1_score': 0.38286477}
confusion matrix:
      0    1
0  5635  362
1    99  143
early stop counter: 19
val acc:0.9583976864814758, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 25,now: 2024-07-11 13:00:08.177298,epoch time: 0:23:48.780783,used: 9:15:27.443149,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98683846, 'precision': 0.9858626, 'recall': 0.9801105, 'specificity': 0.9801105, 'f1': 0.9829401, 'auroc': 0.9974747, 'binary_precision': 0.98384166, 'binary_recall': 0.9658933, 'binary_specificity': 0.9943277, 'binary_f1_score': 0.9747849}
confusion matrix:
       0      1
0  42071    240
1    516  14613
---- Validation: 
scalar performance:
{'acc': 0.9562137, 'precision': 0.67782223, 'recall': 0.7493158, 'specificity': 0.7493158, 'f1': 0.7067182, 'auroc': 0.9003384, 'binary_precision': 0.37149534, 'binary_recall': 0.5282392, 'binary_specificity': 0.9703924, 'binary_f1_score': 0.436214}
confusion matrix:
       0    1
0  17633  538
1    284  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91985893, 'precision': 0.6200987, 'recall': 0.7521075, 'specificity': 0.7521075, 'f1': 0.6564712, 'auroc': 0.8742381, 'binary_precision': 0.25842696, 'binary_recall': 0.57024795, 'binary_specificity': 0.933967, 'binary_f1_score': 0.3556701}
confusion matrix:
      0    1
0  5601  396
1   104  138
early stop counter: 20
val acc:0.9562137126922607, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 26,now: 2024-07-11 13:25:18.866443,epoch time: 0:25:10.689145,used: 9:40:38.132294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9867514, 'precision': 0.9858446, 'recall': 0.97990394, 'specificity': 0.97990394, 'f1': 0.9828246, 'auroc': 0.9974681, 'binary_precision': 0.98396766, 'binary_recall': 0.96543294, 'binary_specificity': 0.9943749, 'binary_f1_score': 0.9746122}
confusion matrix:
       0      1
0  42072    238
1    523  14607
---- Validation: 
scalar performance:
{'acc': 0.9550418, 'precision': 0.6782152, 'recall': 0.7719989, 'specificity': 0.7719989, 'f1': 0.7138981, 'auroc': 0.90126526, 'binary_precision': 0.3707265, 'binary_recall': 0.57641196, 'binary_specificity': 0.96758574, 'binary_f1_score': 0.45123538}
confusion matrix:
       0    1
0  17582  589
1    255  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9123257, 'precision': 0.6137704, 'recall': 0.7640507, 'specificity': 0.7640507, 'f1': 0.65051806, 'auroc': 0.8731687, 'binary_precision': 0.24455611, 'binary_recall': 0.60330576, 'binary_specificity': 0.92479575, 'binary_f1_score': 0.34803334}
confusion matrix:
      0    1
0  5546  451
1    96  146
early stop counter: 21
val acc:0.9550418257713318, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 27,now: 2024-07-11 13:49:37.213869,epoch time: 0:24:18.347426,used: 10:04:56.479720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9874652, 'precision': 0.9884951, 'recall': 0.9791347, 'specificity': 0.9791347, 'f1': 0.9836931, 'auroc': 0.9974993, 'binary_precision': 0.9906027, 'binary_recall': 0.96153086, 'binary_specificity': 0.99673843, 'binary_f1_score': 0.9758503}
confusion matrix:
       0      1
0  42173    138
1    582  14547
---- Validation: 
scalar performance:
{'acc': 0.9564268, 'precision': 0.68272644, 'recall': 0.76869905, 'specificity': 0.76869905, 'f1': 0.7163492, 'auroc': 0.9037746, 'binary_precision': 0.38, 'binary_recall': 0.5681063, 'binary_specificity': 0.96929175, 'binary_f1_score': 0.4553928}
confusion matrix:
       0    1
0  17613  558
1    260  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9168136, 'precision': 0.6177538, 'recall': 0.7584543, 'specificity': 0.7584543, 'f1': 0.65460986, 'auroc': 0.87762344, 'binary_precision': 0.25311944, 'binary_recall': 0.58677685, 'binary_specificity': 0.93013173, 'binary_f1_score': 0.35367373}
confusion matrix:
      0    1
0  5578  419
1   100  142
early stop counter: 22
val acc:0.9564267992973328, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 28,now: 2024-07-11 14:16:27.380941,epoch time: 0:26:50.167072,used: 10:31:46.646792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9869603, 'precision': 0.98797506, 'recall': 0.97834736, 'specificity': 0.97834736, 'f1': 0.9830322, 'auroc': 0.9978002, 'binary_precision': 0.9900498, 'binary_recall': 0.9601454, 'binary_specificity': 0.9965493, 'binary_f1_score': 0.9748683}
confusion matrix:
       0      1
0  42164    146
1    603  14527
---- Validation: 
scalar performance:
{'acc': 0.9550418, 'precision': 0.6775491, 'recall': 0.76878667, 'specificity': 0.76878667, 'f1': 0.712466, 'auroc': 0.901338, 'binary_precision': 0.36961207, 'binary_recall': 0.5697674, 'binary_specificity': 0.96780586, 'binary_f1_score': 0.44836602}
confusion matrix:
       0    1
0  17586  585
1    259  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91424906, 'precision': 0.6147432, 'recall': 0.75910306, 'specificity': 0.75910306, 'f1': 0.6512303, 'auroc': 0.8743862, 'binary_precision': 0.24697755, 'binary_recall': 0.59090906, 'binary_specificity': 0.927297, 'binary_f1_score': 0.34835565}
confusion matrix:
      0    1
0  5561  436
1    99  143
early stop counter: 23
val acc:0.9550418257713318, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 29,now: 2024-07-11 14:41:46.281284,epoch time: 0:25:18.900343,used: 10:57:05.547135,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9867514, 'precision': 0.98745894, 'recall': 0.97831166, 'specificity': 0.97831166, 'f1': 0.98276865, 'auroc': 0.9977261, 'binary_precision': 0.9889078, 'binary_recall': 0.96047586, 'binary_specificity': 0.99614745, 'binary_f1_score': 0.97448444}
confusion matrix:
       0      1
0  42147    163
1    598  14532
---- Validation: 
scalar performance:
{'acc': 0.955681, 'precision': 0.68158853, 'recall': 0.7771473, 'specificity': 0.7771473, 'f1': 0.71796584, 'auroc': 0.90351784, 'binary_precision': 0.37713677, 'binary_recall': 0.58637875, 'binary_specificity': 0.9679159, 'binary_f1_score': 0.45903772}
confusion matrix:
       0    1
0  17588  583
1    249  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9156916, 'precision': 0.6187719, 'recall': 0.76778436, 'specificity': 0.76778436, 'f1': 0.65670866, 'auroc': 0.87761086, 'binary_precision': 0.25432527, 'binary_recall': 0.607438, 'binary_specificity': 0.92813075, 'binary_f1_score': 0.35853657}
confusion matrix:
      0    1
0  5566  431
1    95  147
early stop counter: 24
val acc:0.9556810259819031, best validation acc: 0.9670271277427673, corresponding to test acc:                         0.9496714472770691 / 0.9504728317260742
after epoch: 30,now: 2024-07-11 15:06:24.116293,epoch time: 0:24:37.835009,used: 11:21:43.382144,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_03_44_40_seed_2_21806618
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:21:43.382144 at 2024-07-11 15:06:24.116293
persisted model performance metric: 

scalar performance:
{'acc': 0.94967145, 'precision': 0.64120126, 'recall': 0.6129615, 'specificity': 0.6129615, 'f1': 0.6252134, 'auroc': 0.86255383, 'binary_precision': 0.3125, 'binary_recall': 0.24793388, 'binary_specificity': 0.977989, 'binary_f1_score': 0.27649772}
confusion matrix:
      0    1
0  5865  132
1   182   60
oracle model performance metric: 

scalar performance:
{'acc': 0.95047283, 'precision': 0.6143969, 'recall': 0.56777525, 'specificity': 0.56777525, 'f1': 0.58383185, 'auroc': 0.83110976, 'binary_precision': 0.26241136, 'binary_recall': 0.15289256, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.19321148}
confusion matrix:
      0    1
0  5893  104
1   205   37
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_3_4_freeze_blocks/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |  17485 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |  17485 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   7827 MiB |   3528 TiB |   3528 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   3483 TiB |   3483 TiB |
|       from small pool |  16481 KiB |     36 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  25072 MiB |  16560 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25002 MiB |  16528 MiB |
|       from small pool |     38 MiB |     44 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38824 KiB | 732464 KiB |   1951 TiB |   1951 TiB |
|       from large pool |  31733 KiB | 730714 KiB |   1906 TiB |   1906 TiB |
|       from small pool |   7091 KiB |  21236 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7675    |  583985 K  |  583982 K  |
|       from large pool |      79    |     762    |  330548 K  |  330548 K  |
|       from small pool |    2887    |    7594    |  253436 K  |  253433 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7675    |  583985 K  |  583982 K  |
|       from large pool |      79    |     762    |  330548 K  |  330548 K  |
|       from small pool |    2887    |    7594    |  253436 K  |  253433 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |    1061    |     693    |
|       from large pool |     349    |     349    |    1026    |     677    |
|       from small pool |      19    |      22    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3612    |  341706 K  |  341706 K  |
|       from large pool |      11    |     352    |  233946 K  |  233945 K  |
|       from small pool |      22    |    3602    |  107760 K  |  107760 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |      0 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   3529 TiB |   3529 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   3484 TiB |   3484 TiB |
|       from small pool |      0 KiB |     37 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   3528 TiB |   3528 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   3483 TiB |   3483 TiB |
|       from small pool |      0 KiB |     36 MiB |     44 TiB |     44 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  25072 MiB |  24842 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25002 MiB |  24796 MiB |
|       from small pool |  24576 KiB |     44 MiB |     70 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |   1951 TiB |   1951 TiB |
|       from large pool |  30464 KiB | 730714 KiB |   1906 TiB |   1906 TiB |
|       from small pool |      0 KiB |  21236 KiB |     45 TiB |     45 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7675    |  583985 K  |  583985 K  |
|       from large pool |       2    |     762    |  330548 K  |  330548 K  |
|       from small pool |       0    |    7594    |  253436 K  |  253436 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7675    |  583985 K  |  583985 K  |
|       from large pool |       2    |     762    |  330548 K  |  330548 K  |
|       from small pool |       0    |    7594    |  253436 K  |  253436 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |    1061    |    1039    |
|       from large pool |      10    |     349    |    1026    |    1016    |
|       from small pool |      12    |      22    |      35    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |  341707 K  |  341707 K  |
|       from large pool |       3    |     352    |  233946 K  |  233946 K  |
|       from small pool |       0    |    3602    |  107761 K  |  107761 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Jul 11 15:21:09 2024]
Finished job 0.
1 of 1 steps (100%) done
