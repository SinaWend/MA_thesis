Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun 26 00:42:18 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_dann_lr1e5_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_dann_lr1e5_bs16_classbalancing10/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802

 Experiment start at: 2024-06-26 00:50:37.418175
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8942321, 'precision': 0.9014144, 'recall': 0.8153194, 'specificity': 0.8153194, 'f1': 0.8464851, 'auroc': 0.94475675, 'binary_precision': 0.91279125, 'binary_recall': 0.65230393, 'binary_specificity': 0.97833484, 'binary_f1_score': 0.7608704}
confusion matrix:
       0     1
0  41409   917
1   5116  9598
---- Validation: 
scalar performance:
{'acc': 0.9505641, 'precision': 0.60498977, 'recall': 0.589628, 'specificity': 0.589628, 'f1': 0.5965728, 'auroc': 0.7731364, 'binary_precision': 0.23809524, 'binary_recall': 0.2021773, 'binary_specificity': 0.9770786, 'binary_f1_score': 0.21867116}
confusion matrix:
       0    1
0  17733  416
1    513  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.950783, 'precision': 0.6438582, 'recall': 0.5748717, 'specificity': 0.5748717, 'f1': 0.59643286, 'auroc': 0.8358049, 'binary_precision': 0.32330826, 'binary_recall': 0.16475096, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.21827412}
confusion matrix:
      0   1
0  5907  90
1   218  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-26 01:15:45.713345,epoch time: 0:25:08.295170,used: 0:25:08.295170,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9221423, 'precision': 0.92487526, 'recall': 0.86775494, 'specificity': 0.86775494, 'f1': 0.89134127, 'auroc': 0.9598366, 'binary_precision': 0.929581, 'binary_recall': 0.75540304, 'binary_specificity': 0.9801068, 'binary_f1_score': 0.8334896}
confusion matrix:
       0      1
0  41484    842
1   3599  11115
---- Validation: 
scalar performance:
{'acc': 0.95769477, 'precision': 0.66675234, 'recall': 0.6398231, 'specificity': 0.6398231, 'f1': 0.65193105, 'auroc': 0.8202199, 'binary_precision': 0.35820895, 'binary_recall': 0.29860032, 'binary_specificity': 0.9810458, 'binary_f1_score': 0.32569975}
confusion matrix:
       0    1
0  17805  344
1    451  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.7582286, 'recall': 0.6550833, 'specificity': 0.6550833, 'f1': 0.6922039, 'auroc': 0.8753071, 'binary_precision': 0.54545456, 'binary_recall': 0.3218391, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.40481928}
confusion matrix:
      0   1
0  5927  70
1   177  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-26 01:39:14.645368,epoch time: 0:23:28.932023,used: 0:48:37.227193,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9316971, 'precision': 0.93629736, 'recall': 0.882668, 'specificity': 0.882668, 'f1': 0.9052293, 'auroc': 0.9671277, 'binary_precision': 0.9443258, 'binary_recall': 0.78135616, 'binary_specificity': 0.98397994, 'binary_f1_score': 0.8551457}
confusion matrix:
       0      1
0  41644    678
1   3218  11500
---- Validation: 
scalar performance:
{'acc': 0.9600894, 'precision': 0.6803566, 'recall': 0.63281214, 'specificity': 0.63281214, 'f1': 0.65248793, 'auroc': 0.8392813, 'binary_precision': 0.3859275, 'binary_recall': 0.281493, 'binary_specificity': 0.98413134, 'binary_f1_score': 0.3255396}
confusion matrix:
       0    1
0  17861  288
1    462  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.83362687, 'recall': 0.66724646, 'specificity': 0.66724646, 'f1': 0.7200922, 'auroc': 0.8883273, 'binary_precision': 0.6953125, 'binary_recall': 0.34099618, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.45758358}
confusion matrix:
      0   1
0  5958  39
1   172  89
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-26 02:03:05.125905,epoch time: 0:23:50.480537,used: 1:12:27.707730,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93679875, 'precision': 0.9398202, 'recall': 0.8926803, 'specificity': 0.8926803, 'f1': 0.912978, 'auroc': 0.9711981, 'binary_precision': 0.94519234, 'binary_recall': 0.8015221, 'binary_specificity': 0.98383856, 'binary_f1_score': 0.8674486}
confusion matrix:
       0      1
0  41639    684
1   2921  11796
---- Validation: 
scalar performance:
{'acc': 0.959983, 'precision': 0.6857379, 'recall': 0.65150845, 'specificity': 0.65150845, 'f1': 0.66665196, 'auroc': 0.85309446, 'binary_precision': 0.39539346, 'binary_recall': 0.32037324, 'binary_specificity': 0.98264366, 'binary_f1_score': 0.3539519}
confusion matrix:
       0    1
0  17834  315
1    437  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.84169614, 'recall': 0.70131236, 'specificity': 0.70131236, 'f1': 0.75152963, 'auroc': 0.8982953, 'binary_precision': 0.7086093, 'binary_recall': 0.4099617, 'binary_specificity': 0.992663, 'binary_f1_score': 0.51941746}
confusion matrix:
      0    1
0  5953   44
1   154  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_4.png
new oracle model saved
early stop counter: 1
val acc:0.9599829912185669, best validation acc: 0.960089385509491, corresponding to test acc:                         0.9662831425666809 / 0.9683604836463928
after epoch: 4,now: 2024-06-26 02:26:33.671677,epoch time: 0:23:28.545772,used: 1:35:56.253502,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9435834, 'precision': 0.94313544, 'recall': 0.9073019, 'specificity': 0.9073019, 'f1': 0.9233239, 'auroc': 0.9744551, 'binary_precision': 0.9423121, 'binary_recall': 0.8323256, 'binary_specificity': 0.9822783, 'binary_f1_score': 0.88391054}
confusion matrix:
       0      1
0  41571    750
1   2468  12251
---- Validation: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.6858425, 'recall': 0.68890727, 'specificity': 0.68890727, 'f1': 0.6873606, 'auroc': 0.8636148, 'binary_precision': 0.39296636, 'binary_recall': 0.39968896, 'binary_specificity': 0.9781255, 'binary_f1_score': 0.39629915}
confusion matrix:
       0    1
0  17752  397
1    386  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.80416006, 'recall': 0.74453795, 'specificity': 0.74453795, 'f1': 0.7707263, 'auroc': 0.9065906, 'binary_precision': 0.6298077, 'binary_recall': 0.5019157, 'binary_specificity': 0.98716027, 'binary_f1_score': 0.5586354}
confusion matrix:
      0    1
0  5920   77
1   130  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_5.png
early stop counter: 2
val acc:0.9583333134651184, best validation acc: 0.960089385509491, corresponding to test acc:                         0.9662831425666809 / 0.9683604836463928
after epoch: 5,now: 2024-06-26 02:50:09.590309,epoch time: 0:23:35.918632,used: 1:59:32.172134,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9447756, 'precision': 0.944389, 'recall': 0.9092305, 'specificity': 0.9092305, 'f1': 0.92499197, 'auroc': 0.97633994, 'binary_precision': 0.9436771, 'binary_recall': 0.8358026, 'binary_specificity': 0.9826584, 'binary_f1_score': 0.88647014}
confusion matrix:
       0      1
0  41592    734
1   2416  12298
---- Validation: 
scalar performance:
{'acc': 0.95918477, 'precision': 0.6885641, 'recall': 0.6803474, 'specificity': 0.6803474, 'f1': 0.6843516, 'auroc': 0.86972386, 'binary_precision': 0.3990228, 'binary_recall': 0.38102645, 'binary_specificity': 0.9796683, 'binary_f1_score': 0.38981703}
confusion matrix:
       0    1
0  17780  369
1    398  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96756154, 'precision': 0.80913305, 'recall': 0.7485361, 'specificity': 0.7485361, 'f1': 0.77515674, 'auroc': 0.91118675, 'binary_precision': 0.6394231, 'binary_recall': 0.5095785, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.5671642}
confusion matrix:
      0    1
0  5922   75
1   128  133
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_6.png
early stop counter: 3
val acc:0.9591847658157349, best validation acc: 0.960089385509491, corresponding to test acc:                         0.9662831425666809 / 0.9683604836463928
after epoch: 6,now: 2024-06-26 03:13:46.492210,epoch time: 0:23:36.901901,used: 2:23:09.074035,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94817674, 'precision': 0.9491432, 'recall': 0.9137546, 'specificity': 0.9137546, 'f1': 0.9296321, 'auroc': 0.9782711, 'binary_precision': 0.950924, 'binary_recall': 0.842631, 'binary_specificity': 0.9848782, 'binary_f1_score': 0.89350814}
confusion matrix:
       0      1
0  41683    640
1   2316  12401
---- Validation: 
scalar performance:
{'acc': 0.95913154, 'precision': 0.6812656, 'recall': 0.655568, 'specificity': 0.655568, 'f1': 0.6673006, 'auroc': 0.8729441, 'binary_precision': 0.38615665, 'binary_recall': 0.32970452, 'binary_specificity': 0.9814315, 'binary_f1_score': 0.3557047}
confusion matrix:
       0    1
0  17812  337
1    431  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.8257799, 'recall': 0.73629344, 'specificity': 0.73629344, 'f1': 0.77312934, 'auroc': 0.914093, 'binary_precision': 0.6737968, 'binary_recall': 0.4827586, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.5625}
confusion matrix:
      0    1
0  5936   61
1   135  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_7.png
new oracle model saved
early stop counter: 4
val acc:0.9591315388679504, best validation acc: 0.960089385509491, corresponding to test acc:                         0.9662831425666809 / 0.9686800837516785
after epoch: 7,now: 2024-06-26 03:39:37.445039,epoch time: 0:25:50.952829,used: 2:49:00.026864,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94921106, 'precision': 0.9499357, 'recall': 0.91570467, 'specificity': 0.91570467, 'f1': 0.9311224, 'auroc': 0.9796511, 'binary_precision': 0.9512754, 'binary_recall': 0.8464832, 'binary_specificity': 0.98492616, 'binary_f1_score': 0.8958251}
confusion matrix:
       0      1
0  41687    638
1   2259  12456
---- Validation: 
scalar performance:
{'acc': 0.9586526, 'precision': 0.67862517, 'recall': 0.6568202, 'specificity': 0.6568202, 'f1': 0.6669141, 'auroc': 0.87707233, 'binary_precision': 0.38078293, 'binary_recall': 0.33281493, 'binary_specificity': 0.98082536, 'binary_f1_score': 0.35518673}
confusion matrix:
       0    1
0  17801  348
1    429  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9680409, 'precision': 0.8158228, 'recall': 0.74328923, 'specificity': 0.74328923, 'f1': 0.77431405, 'auroc': 0.91718817, 'binary_precision': 0.6532663, 'binary_recall': 0.49808428, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.5652173}
confusion matrix:
      0    1
0  5928   69
1   131  130
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_8.png
early stop counter: 5
val acc:0.9586526155471802, best validation acc: 0.960089385509491, corresponding to test acc:                         0.9662831425666809 / 0.9686800837516785
after epoch: 8,now: 2024-06-26 04:03:15.728026,epoch time: 0:23:38.282987,used: 3:12:38.309851,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9511746, 'precision': 0.9501973, 'recall': 0.92060107, 'specificity': 0.92060107, 'f1': 0.93412435, 'auroc': 0.9820162, 'binary_precision': 0.9483653, 'binary_recall': 0.8574341, 'binary_specificity': 0.98376805, 'binary_f1_score': 0.90061027}
confusion matrix:
       0      1
0  41637    687
1   2098  12618
---- Validation: 
scalar performance:
{'acc': 0.9585994, 'precision': 0.6770717, 'recall': 0.6530423, 'specificity': 0.6530423, 'f1': 0.6640588, 'auroc': 0.8796598, 'binary_precision': 0.3779385, 'binary_recall': 0.32503888, 'binary_specificity': 0.9810458, 'binary_f1_score': 0.3494983}
confusion matrix:
       0    1
0  17805  344
1    434  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.80818117, 'recall': 0.7466204, 'specificity': 0.7466204, 'f1': 0.7735852, 'auroc': 0.91758746, 'binary_precision': 0.6376812, 'binary_recall': 0.50574714, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.5641026}
confusion matrix:
      0    1
0  5922   75
1   129  132
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_9.png
early stop counter: 6
val acc:0.9585993885993958, best validation acc: 0.960089385509491, corresponding to test acc:                         0.9662831425666809 / 0.9686800837516785
after epoch: 9,now: 2024-06-26 04:27:35.471952,epoch time: 0:24:19.743926,used: 3:36:58.053777,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9506837, 'precision': 0.955456, 'recall': 0.91461873, 'specificity': 0.91461873, 'f1': 0.9326745, 'auroc': 0.9828585, 'binary_precision': 0.96412694, 'binary_recall': 0.840106, 'binary_specificity': 0.98913145, 'binary_f1_score': 0.8978539}
confusion matrix:
       0      1
0  41864    460
1   2353  12363
---- Validation: 
scalar performance:
{'acc': 0.96126014, 'precision': 0.6886517, 'recall': 0.629668, 'specificity': 0.629668, 'f1': 0.6529915, 'auroc': 0.8822344, 'binary_precision': 0.402746, 'binary_recall': 0.27371696, 'binary_specificity': 0.98561907, 'binary_f1_score': 0.32592595}
confusion matrix:
       0    1
0  17888  261
1    467  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9686801, 'precision': 0.8284247, 'recall': 0.73079646, 'specificity': 0.73079646, 'f1': 0.77016395, 'auroc': 0.9193249, 'binary_precision': 0.67955804, 'binary_recall': 0.47126436, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.5565611}
confusion matrix:
      0    1
0  5939   58
1   138  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_10.png
better model found
persisted
after epoch: 10,now: 2024-06-26 04:51:53.846266,epoch time: 0:24:18.374314,used: 4:01:16.428091,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95368165, 'precision': 0.95471925, 'recall': 0.9229285, 'specificity': 0.9229285, 'f1': 0.93737555, 'auroc': 0.9834037, 'binary_precision': 0.9566533, 'binary_recall': 0.85939515, 'binary_specificity': 0.9864619, 'binary_f1_score': 0.90541995}
confusion matrix:
       0      1
0  41752    573
1   2069  12646
---- Validation: 
scalar performance:
{'acc': 0.95950407, 'precision': 0.6799317, 'recall': 0.64375997, 'specificity': 0.64375997, 'f1': 0.6595469, 'auroc': 0.8830829, 'binary_precision': 0.38431373, 'binary_recall': 0.30482116, 'binary_specificity': 0.9826988, 'binary_f1_score': 0.33998266}
confusion matrix:
       0    1
0  17835  314
1    447  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.80779195, 'recall': 0.75778115, 'specificity': 0.75778115, 'f1': 0.78031284, 'auroc': 0.91947603, 'binary_precision': 0.6359447, 'binary_recall': 0.52873564, 'binary_specificity': 0.9868267, 'binary_f1_score': 0.57740587}
confusion matrix:
      0    1
0  5918   79
1   123  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_11.png
early stop counter: 1
val acc:0.9595040678977966, best validation acc: 0.9612601399421692, corresponding to test acc:                         0.9686800837516785 / 0.9686800837516785
after epoch: 11,now: 2024-06-26 05:16:40.530304,epoch time: 0:24:46.684038,used: 4:26:03.112129,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9562237, 'precision': 0.95501715, 'recall': 0.9293045, 'specificity': 0.9293045, 'f1': 0.9412074, 'auroc': 0.9848566, 'binary_precision': 0.9527267, 'binary_recall': 0.8736835, 'binary_specificity': 0.98492545, 'binary_f1_score': 0.9114947}
confusion matrix:
       0      1
0  41685    638
1   1859  12858
---- Validation: 
scalar performance:
{'acc': 0.95929116, 'precision': 0.6832395, 'recall': 0.6586509, 'specificity': 0.6586509, 'f1': 0.66993916, 'auroc': 0.8833984, 'binary_precision': 0.38989168, 'binary_recall': 0.33592534, 'binary_specificity': 0.9813764, 'binary_f1_score': 0.36090225}
confusion matrix:
       0    1
0  17811  338
1    427  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.7947085, 'recall': 0.7588631, 'specificity': 0.7588631, 'f1': 0.77548164, 'auroc': 0.919047, 'binary_precision': 0.6096491, 'binary_recall': 0.532567, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.56850713}
confusion matrix:
      0    1
0  5908   89
1   122  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_12.png
early stop counter: 2
val acc:0.9592911601066589, best validation acc: 0.9612601399421692, corresponding to test acc:                         0.9686800837516785 / 0.9686800837516785
after epoch: 12,now: 2024-06-26 05:41:58.339486,epoch time: 0:25:17.809182,used: 4:51:20.921311,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9561185, 'precision': 0.95766693, 'recall': 0.9265566, 'specificity': 0.9265566, 'f1': 0.94073474, 'auroc': 0.9849715, 'binary_precision': 0.96056104, 'binary_recall': 0.8654708, 'binary_specificity': 0.98764235, 'binary_f1_score': 0.91054004}
confusion matrix:
       0      1
0  41799    523
1   1980  12738
---- Validation: 
scalar performance:
{'acc': 0.95977014, 'precision': 0.6815892, 'recall': 0.64314765, 'specificity': 0.64314765, 'f1': 0.65978324, 'auroc': 0.88449544, 'binary_precision': 0.38767394, 'binary_recall': 0.30326593, 'binary_specificity': 0.98302937, 'binary_f1_score': 0.34031412}
confusion matrix:
       0    1
0  17841  308
1    448  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.79784346, 'recall': 0.75719756, 'specificity': 0.75719756, 'f1': 0.7758502, 'auroc': 0.9195751, 'binary_precision': 0.6160714, 'binary_recall': 0.52873564, 'binary_specificity': 0.9856595, 'binary_f1_score': 0.5690721}
confusion matrix:
      0    1
0  5911   86
1   123  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_13.png
early stop counter: 3
val acc:0.959770143032074, best validation acc: 0.9612601399421692, corresponding to test acc:                         0.9686800837516785 / 0.9686800837516785
after epoch: 13,now: 2024-06-26 06:07:12.616041,epoch time: 0:25:14.276555,used: 5:16:35.197866,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9549264, 'precision': 0.958775, 'recall': 0.9225134, 'specificity': 0.9225134, 'f1': 0.9387896, 'auroc': 0.98542243, 'binary_precision': 0.96586376, 'binary_recall': 0.8555412, 'binary_specificity': 0.9894856, 'binary_f1_score': 0.9073614}
confusion matrix:
       0      1
0  41878    445
1   2126  12591
---- Validation: 
scalar performance:
{'acc': 0.96024907, 'precision': 0.6831572, 'recall': 0.63739514, 'specificity': 0.63739514, 'f1': 0.6565721, 'auroc': 0.8860026, 'binary_precision': 0.3912134, 'binary_recall': 0.29082426, 'binary_specificity': 0.98396605, 'binary_f1_score': 0.33363068}
confusion matrix:
       0    1
0  17858  291
1    456  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.8025188, 'recall': 0.75561535, 'specificity': 0.75561535, 'f1': 0.776859, 'auroc': 0.9203117, 'binary_precision': 0.6255708, 'binary_recall': 0.5249042, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.5708333}
confusion matrix:
      0    1
0  5915   82
1   124  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_14.png
early stop counter: 4
val acc:0.9602490663528442, best validation acc: 0.9612601399421692, corresponding to test acc:                         0.9686800837516785 / 0.9686800837516785
after epoch: 14,now: 2024-06-26 06:31:58.970917,epoch time: 0:24:46.354876,used: 5:41:21.552742,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.95753855, 'precision': 0.9602078, 'recall': 0.9278904, 'specificity': 0.9278904, 'f1': 0.9425764, 'auroc': 0.98643345, 'binary_precision': 0.9651805, 'binary_recall': 0.86664855, 'binary_specificity': 0.9891322, 'binary_f1_score': 0.9132646}
confusion matrix:
       0      1
0  41867    460
1   1962  12751
---- Validation: 
scalar performance:
{'acc': 0.9593444, 'precision': 0.678806, 'recall': 0.6436773, 'specificity': 0.6436773, 'f1': 0.65906376, 'auroc': 0.8853569, 'binary_precision': 0.38206628, 'binary_recall': 0.30482116, 'binary_specificity': 0.98253345, 'binary_f1_score': 0.33910036}
confusion matrix:
       0    1
0  17832  317
1    447  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965644, 'precision': 0.7884356, 'recall': 0.76402664, 'specificity': 0.76402664, 'f1': 0.77562344, 'auroc': 0.9200814, 'binary_precision': 0.5966387, 'binary_recall': 0.5440613, 'binary_specificity': 0.983992, 'binary_f1_score': 0.5691383}
confusion matrix:
      0    1
0  5901   96
1   119  142
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_15.png
early stop counter: 5
val acc:0.9593443870544434, best validation acc: 0.9612601399421692, corresponding to test acc:                         0.9686800837516785 / 0.9686800837516785
after epoch: 15,now: 2024-06-26 06:55:33.643973,epoch time: 0:23:34.673056,used: 6:04:56.225798,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.955838, 'precision': 0.9609714, 'recall': 0.92292833, 'specificity': 0.92292833, 'f1': 0.9399247, 'auroc': 0.98611623, 'binary_precision': 0.97038406, 'binary_recall': 0.8549297, 'binary_specificity': 0.9909269, 'binary_f1_score': 0.9090055}
confusion matrix:
       0      1
0  41939    384
1   2135  12582
---- Validation: 
scalar performance:
{'acc': 0.96136653, 'precision': 0.6814929, 'recall': 0.6079715, 'specificity': 0.6079715, 'f1': 0.63418984, 'auroc': 0.8859752, 'binary_precision': 0.3899204, 'binary_recall': 0.22861587, 'binary_specificity': 0.9873271, 'binary_f1_score': 0.2882353}
confusion matrix:
       0    1
0  17919  230
1    496  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.80957866, 'recall': 0.7187185, 'specificity': 0.7187185, 'f1': 0.75545263, 'auroc': 0.91981244, 'binary_precision': 0.64285713, 'binary_recall': 0.44827586, 'binary_specificity': 0.98916125, 'binary_f1_score': 0.5282167}
confusion matrix:
      0    1
0  5932   65
1   144  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_16.png
better model found
persisted
after epoch: 16,now: 2024-06-26 07:18:53.916026,epoch time: 0:23:20.272053,used: 6:28:16.497851,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.95792425, 'precision': 0.9630902, 'recall': 0.9263683, 'specificity': 0.9263683, 'f1': 0.94285107, 'auroc': 0.9869063, 'binary_precision': 0.9726017, 'binary_recall': 0.86117154, 'binary_specificity': 0.99156505, 'binary_f1_score': 0.9135011}
confusion matrix:
       0      1
0  41967    357
1   2043  12673
---- Validation: 
scalar performance:
{'acc': 0.960728, 'precision': 0.67712873, 'recall': 0.6113912, 'specificity': 0.6113912, 'f1': 0.6357753, 'auroc': 0.8862628, 'binary_precision': 0.3809524, 'binary_recall': 0.23639192, 'binary_specificity': 0.9863904, 'binary_f1_score': 0.29174665}
confusion matrix:
       0    1
0  17902  247
1    491  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.7960644, 'recall': 0.7236319, 'specificity': 0.7236319, 'f1': 0.7542027, 'auroc': 0.9192189, 'binary_precision': 0.61538464, 'binary_recall': 0.4597701, 'binary_specificity': 0.98749375, 'binary_f1_score': 0.5263158}
confusion matrix:
      0    1
0  5922   75
1   141  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_17.png
early stop counter: 1
val acc:0.9607279896736145, best validation acc: 0.9613665342330933, corresponding to test acc:                         0.9666027426719666 / 0.9686800837516785
after epoch: 17,now: 2024-06-26 07:42:14.777985,epoch time: 0:23:20.861959,used: 6:51:37.359810,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9567672, 'precision': 0.9639008, 'recall': 0.9228108, 'specificity': 0.9228108, 'f1': 0.94101894, 'auroc': 0.987164, 'binary_precision': 0.97688174, 'binary_recall': 0.85263944, 'binary_specificity': 0.9929822, 'binary_f1_score': 0.91054195}
confusion matrix:
       0      1
0  42024    297
1   2169  12550
---- Validation: 
scalar performance:
{'acc': 0.9611537, 'precision': 0.66755414, 'recall': 0.58460957, 'specificity': 0.58460957, 'f1': 0.61061543, 'auroc': 0.88733995, 'binary_precision': 0.36363637, 'binary_recall': 0.18040435, 'binary_specificity': 0.98881483, 'binary_f1_score': 0.24116425}
confusion matrix:
       0    1
0  17946  203
1    527  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.80854344, 'recall': 0.68881756, 'specificity': 0.68881756, 'f1': 0.73269975, 'auroc': 0.9196699, 'binary_precision': 0.6433121, 'binary_recall': 0.38697317, 'binary_specificity': 0.990662, 'binary_f1_score': 0.4832536}
confusion matrix:
      0    1
0  5941   56
1   160  101
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_18.png
early stop counter: 2
val acc:0.9611536860466003, best validation acc: 0.9613665342330933, corresponding to test acc:                         0.9666027426719666 / 0.9686800837516785
after epoch: 18,now: 2024-06-26 08:06:50.606364,epoch time: 0:24:35.828379,used: 7:16:13.188189,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96039623, 'precision': 0.96129197, 'recall': 0.93429184, 'specificity': 0.93429184, 'f1': 0.94676054, 'auroc': 0.98773897, 'binary_precision': 0.9629877, 'binary_recall': 0.8803506, 'binary_specificity': 0.9882331, 'binary_f1_score': 0.91981685}
confusion matrix:
       0      1
0  41824    498
1   1761  12957
---- Validation: 
scalar performance:
{'acc': 0.9571094, 'precision': 0.6725103, 'recall': 0.66577196, 'specificity': 0.66577196, 'f1': 0.6690641, 'auroc': 0.8877617, 'binary_precision': 0.36790925, 'binary_recall': 0.35303265, 'binary_specificity': 0.9785112, 'binary_f1_score': 0.36031744}
confusion matrix:
       0    1
0  17759  390
1    416  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.7662517, 'recall': 0.7808492, 'specificity': 0.7808492, 'f1': 0.77332866, 'auroc': 0.9195926, 'binary_precision': 0.5507246, 'binary_recall': 0.58237547, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.56610805}
confusion matrix:
      0    1
0  5873  124
1   109  152
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_19.png
early stop counter: 3
val acc:0.9571093916893005, best validation acc: 0.9613665342330933, corresponding to test acc:                         0.9666027426719666 / 0.9686800837516785
after epoch: 19,now: 2024-06-26 08:30:17.852615,epoch time: 0:23:27.246251,used: 7:39:40.434440,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9588885, 'precision': 0.96310484, 'recall': 0.9287999, 'specificity': 0.9287999, 'f1': 0.9443089, 'auroc': 0.9878639, 'binary_precision': 0.9709218, 'binary_recall': 0.8666259, 'binary_specificity': 0.99097395, 'binary_f1_score': 0.91581404}
confusion matrix:
       0      1
0  41940    382
1   1963  12755
---- Validation: 
scalar performance:
{'acc': 0.95945084, 'precision': 0.68247926, 'recall': 0.6527331, 'specificity': 0.6527331, 'f1': 0.66610515, 'auroc': 0.88917613, 'binary_precision': 0.38878503, 'binary_recall': 0.32348368, 'binary_specificity': 0.98198247, 'binary_f1_score': 0.3531409}
confusion matrix:
       0    1
0  17822  327
1    435  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.7832223, 'recall': 0.76552546, 'specificity': 0.76552546, 'f1': 0.77405167, 'auroc': 0.9203094, 'binary_precision': 0.5860656, 'binary_recall': 0.54789275, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.5663367}
confusion matrix:
      0    1
0  5896  101
1   118  143
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_20.png
early stop counter: 4
val acc:0.9594508409500122, best validation acc: 0.9613665342330933, corresponding to test acc:                         0.9666027426719666 / 0.9686800837516785
after epoch: 20,now: 2024-06-26 08:54:03.215049,epoch time: 0:23:45.362434,used: 8:03:25.796874,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9585028, 'precision': 0.96374124, 'recall': 0.9272634, 'specificity': 0.9272634, 'f1': 0.943652, 'auroc': 0.9879619, 'binary_precision': 0.9733937, 'binary_recall': 0.86272514, 'binary_specificity': 0.99180156, 'binary_f1_score': 0.91472423}
confusion matrix:
       0      1
0  41978    347
1   2020  12695
---- Validation: 
scalar performance:
{'acc': 0.95977014, 'precision': 0.682814, 'recall': 0.6468979, 'specificity': 0.6468979, 'f1': 0.6626337, 'auroc': 0.88984704, 'binary_precision': 0.38986355, 'binary_recall': 0.31104198, 'binary_specificity': 0.9827539, 'binary_f1_score': 0.34602073}
confusion matrix:
       0    1
0  17836  313
1    443  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.7911093, 'recall': 0.7567807, 'specificity': 0.7567807, 'f1': 0.77273524, 'auroc': 0.92046714, 'binary_precision': 0.60262007, 'binary_recall': 0.52873564, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.56326526}
confusion matrix:
      0    1
0  5906   91
1   123  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_21.png
early stop counter: 5
val acc:0.959770143032074, best validation acc: 0.9613665342330933, corresponding to test acc:                         0.9666027426719666 / 0.9686800837516785
after epoch: 21,now: 2024-06-26 09:26:23.205908,epoch time: 0:32:19.990859,used: 8:35:45.787733,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96125525, 'precision': 0.9647248, 'recall': 0.9333779, 'specificity': 0.9333779, 'f1': 0.9476811, 'auroc': 0.9886254, 'binary_precision': 0.9712133, 'binary_recall': 0.8757815, 'binary_specificity': 0.99097437, 'binary_f1_score': 0.92103195}
confusion matrix:
       0      1
0  41942    382
1   1828  12888
---- Validation: 
scalar performance:
{'acc': 0.95764154, 'precision': 0.67578036, 'recall': 0.6667975, 'specificity': 0.6667975, 'f1': 0.6711541, 'auroc': 0.8897033, 'binary_precision': 0.37438422, 'binary_recall': 0.35458788, 'binary_specificity': 0.9790071, 'binary_f1_score': 0.36421725}
confusion matrix:
       0    1
0  17768  381
1    415  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.76525605, 'recall': 0.7807659, 'specificity': 0.7807659, 'f1': 0.77276003, 'auroc': 0.9197242, 'binary_precision': 0.54873645, 'binary_recall': 0.58237547, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.5650558}
confusion matrix:
      0    1
0  5872  125
1   109  152
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_22.png
early stop counter: 6
val acc:0.9576415419578552, best validation acc: 0.9613665342330933, corresponding to test acc:                         0.9666027426719666 / 0.9686800837516785
after epoch: 22,now: 2024-06-26 09:52:16.764349,epoch time: 0:25:53.558441,used: 9:01:39.346174,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.960554, 'precision': 0.9673772, 'recall': 0.9293462, 'specificity': 0.9293462, 'f1': 0.946373, 'auroc': 0.9889144, 'binary_precision': 0.97990763, 'binary_recall': 0.86485934, 'binary_specificity': 0.993833, 'binary_f1_score': 0.918796}
confusion matrix:
       0      1
0  42061    261
1   1989  12729
---- Validation: 
scalar performance:
{'acc': 0.96035546, 'precision': 0.6757972, 'recall': 0.61569864, 'specificity': 0.61569864, 'f1': 0.63871706, 'auroc': 0.8899716, 'binary_precision': 0.37799042, 'binary_recall': 0.24572317, 'binary_specificity': 0.98567414, 'binary_f1_score': 0.29783222}
confusion matrix:
       0    1
0  17889  260
1    485  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8052161, 'recall': 0.72596455, 'specificity': 0.72596455, 'f1': 0.75899553, 'auroc': 0.9193958, 'binary_precision': 0.63350785, 'binary_recall': 0.46360153, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.53539824}
confusion matrix:
      0    1
0  5927   70
1   140  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_23.png
early stop counter: 7
val acc:0.9603554606437683, best validation acc: 0.9613665342330933, corresponding to test acc:                         0.9666027426719666 / 0.9686800837516785
after epoch: 23,now: 2024-06-26 10:26:22.635351,epoch time: 0:34:05.871002,used: 9:35:45.217176,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.95918655, 'precision': 0.96545833, 'recall': 0.9275199, 'specificity': 0.9275199, 'f1': 0.9445002, 'auroc': 0.9889869, 'binary_precision': 0.9769717, 'binary_recall': 0.8621041, 'binary_specificity': 0.9929358, 'binary_f1_score': 0.9159506}
confusion matrix:
       0      1
0  42027    299
1   2029  12685
---- Validation: 
scalar performance:
{'acc': 0.96067476, 'precision': 0.6806488, 'recall': 0.6211144, 'specificity': 0.6211144, 'f1': 0.6442307, 'auroc': 0.890816, 'binary_precision': 0.38732395, 'binary_recall': 0.25660965, 'binary_specificity': 0.98561907, 'binary_f1_score': 0.30869973}
confusion matrix:
       0    1
0  17888  261
1    478  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.80929726, 'recall': 0.7336273, 'specificity': 0.7336273, 'f1': 0.7655822, 'auroc': 0.9197786, 'binary_precision': 0.64102566, 'binary_recall': 0.4789272, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.5482456}
confusion matrix:
      0    1
0  5927   70
1   136  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_24.png
early stop counter: 8
val acc:0.9606747627258301, best validation acc: 0.9613665342330933, corresponding to test acc:                         0.9666027426719666 / 0.9686800837516785
after epoch: 24,now: 2024-06-26 11:06:11.105156,epoch time: 0:39:48.469805,used: 10:15:33.686981,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9603787, 'precision': 0.9659437, 'recall': 0.9301144, 'specificity': 0.9301144, 'f1': 0.94625306, 'auroc': 0.98954296, 'binary_precision': 0.97622323, 'binary_recall': 0.86757714, 'binary_specificity': 0.9926516, 'binary_f1_score': 0.91869926}
confusion matrix:
       0      1
0  42011    311
1   1949  12769
---- Validation: 
scalar performance:
{'acc': 0.9604619, 'precision': 0.68000966, 'recall': 0.62400436, 'specificity': 0.62400436, 'f1': 0.6461595, 'auroc': 0.8901174, 'binary_precision': 0.38584474, 'binary_recall': 0.2628305, 'binary_specificity': 0.98517823, 'binary_f1_score': 0.31267348}
confusion matrix:
       0    1
0  17880  269
1    474  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.80502665, 'recall': 0.7315449, 'specificity': 0.7315449, 'f1': 0.762669, 'auroc': 0.9193326, 'binary_precision': 0.63265306, 'binary_recall': 0.47509578, 'binary_specificity': 0.987994, 'binary_f1_score': 0.54266953}
confusion matrix:
      0    1
0  5925   72
1   137  124
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_25.png
early stop counter: 9
val acc:0.9604619145393372, best validation acc: 0.9613665342330933, corresponding to test acc:                         0.9666027426719666 / 0.9686800837516785
after epoch: 25,now: 2024-06-26 11:44:55.281970,epoch time: 0:38:44.176814,used: 10:54:17.863795,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96079946, 'precision': 0.9684772, 'recall': 0.9290417, 'specificity': 0.9290417, 'f1': 0.9466307, 'auroc': 0.99017084, 'binary_precision': 0.98252535, 'binary_recall': 0.8634232, 'binary_specificity': 0.99466014, 'binary_f1_score': 0.919132}
confusion matrix:
       0      1
0  42097    226
1   2010  12707
---- Validation: 
scalar performance:
{'acc': 0.960728, 'precision': 0.6793268, 'recall': 0.6166415, 'specificity': 0.6166415, 'f1': 0.64046633, 'auroc': 0.8905072, 'binary_precision': 0.3849879, 'binary_recall': 0.24727838, 'binary_specificity': 0.9860047, 'binary_f1_score': 0.30113634}
confusion matrix:
       0    1
0  17895  254
1    484  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96628314, 'precision': 0.80239314, 'recall': 0.72954583, 'specificity': 0.72954583, 'f1': 0.7603979, 'auroc': 0.9192661, 'binary_precision': 0.627551, 'binary_recall': 0.47126436, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.5382932}
confusion matrix:
      0    1
0  5924   73
1   138  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_26.png
early stop counter: 10
val acc:0.9607279896736145, best validation acc: 0.9613665342330933, corresponding to test acc:                         0.9666027426719666 / 0.9686800837516785
after epoch: 26,now: 2024-06-26 12:17:51.952002,epoch time: 0:32:56.670032,used: 11:27:14.533827,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9618864, 'precision': 0.9669564, 'recall': 0.9330191, 'specificity': 0.9330191, 'f1': 0.94839627, 'auroc': 0.9905951, 'binary_precision': 0.97637135, 'binary_recall': 0.8733859, 'binary_specificity': 0.9926523, 'binary_f1_score': 0.9220118}
confusion matrix:
       0      1
0  42015    311
1   1863  12851
---- Validation: 
scalar performance:
{'acc': 0.959983, 'precision': 0.68112886, 'recall': 0.6372574, 'specificity': 0.6372574, 'f1': 0.65576136, 'auroc': 0.89019644, 'binary_precision': 0.38716355, 'binary_recall': 0.29082426, 'binary_specificity': 0.98369056, 'binary_f1_score': 0.3321492}
confusion matrix:
       0    1
0  17853  296
1    456  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.7788598, 'recall': 0.73562455, 'specificity': 0.73562455, 'f1': 0.75519484, 'auroc': 0.91750795, 'binary_precision': 0.57990867, 'binary_recall': 0.48659003, 'binary_specificity': 0.984659, 'binary_f1_score': 0.52916664}
confusion matrix:
      0    1
0  5905   92
1   134  127
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_27.png
early stop counter: 11
val acc:0.9599829912185669, best validation acc: 0.9613665342330933, corresponding to test acc:                         0.9666027426719666 / 0.9686800837516785
after epoch: 27,now: 2024-06-26 12:55:55.106047,epoch time: 0:38:03.154045,used: 12:05:17.687872,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96079946, 'precision': 0.9666159, 'recall': 0.9305797, 'specificity': 0.9305797, 'f1': 0.9468056, 'auroc': 0.98953557, 'binary_precision': 0.97735274, 'binary_recall': 0.8681528, 'binary_specificity': 0.99300665, 'binary_f1_score': 0.91952205}
confusion matrix:
       0      1
0  42030    296
1   1940  12774
---- Validation: 
scalar performance:
{'acc': 0.95992976, 'precision': 0.68020284, 'recall': 0.63572973, 'specificity': 0.63572973, 'f1': 0.6544112, 'auroc': 0.89090014, 'binary_precision': 0.38541666, 'binary_recall': 0.28771386, 'binary_specificity': 0.98374563, 'binary_f1_score': 0.32947463}
confusion matrix:
       0    1
0  17854  295
1    458  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.7786819, 'recall': 0.72821176, 'specificity': 0.72821176, 'f1': 0.7506177, 'auroc': 0.91720736, 'binary_precision': 0.5801887, 'binary_recall': 0.47126436, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.5200845}
confusion matrix:
      0    1
0  5908   89
1   138  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_28.png
early stop counter: 12
val acc:0.9599297642707825, best validation acc: 0.9613665342330933, corresponding to test acc:                         0.9666027426719666 / 0.9686800837516785
after epoch: 28,now: 2024-06-26 13:27:29.590656,epoch time: 0:31:34.484609,used: 12:36:52.172481,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96209675, 'precision': 0.9678248, 'recall': 0.9328275, 'specificity': 0.9328275, 'f1': 0.9486387, 'auroc': 0.99047375, 'binary_precision': 0.9784348, 'binary_recall': 0.8723419, 'binary_specificity': 0.993313, 'binary_f1_score': 0.9223475}
confusion matrix:
       0      1
0  42038    283
1   1879  12840
---- Validation: 
scalar performance:
{'acc': 0.95992976, 'precision': 0.6788543, 'recall': 0.63197947, 'specificity': 0.63197947, 'f1': 0.6514018, 'auroc': 0.89068043, 'binary_precision': 0.38297874, 'binary_recall': 0.2799378, 'binary_specificity': 0.9840212, 'binary_f1_score': 0.32345015}
confusion matrix:
       0    1
0  17859  290
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.78005856, 'recall': 0.7282952, 'specificity': 0.7282952, 'f1': 0.7512109, 'auroc': 0.916963, 'binary_precision': 0.5829384, 'binary_recall': 0.47126436, 'binary_specificity': 0.985326, 'binary_f1_score': 0.5211864}
confusion matrix:
      0    1
0  5909   88
1   138  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_29.png
early stop counter: 13
val acc:0.9599297642707825, best validation acc: 0.9613665342330933, corresponding to test acc:                         0.9666027426719666 / 0.9686800837516785
after epoch: 29,now: 2024-06-26 13:53:12.102795,epoch time: 0:25:42.512139,used: 13:02:34.684620,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.95946705, 'precision': 0.9673599, 'recall': 0.9266638, 'specificity': 0.9266638, 'f1': 0.94474053, 'auroc': 0.98965037, 'binary_precision': 0.981749, 'binary_recall': 0.8588803, 'binary_specificity': 0.99444735, 'binary_f1_score': 0.91621363}
confusion matrix:
       0      1
0  42087    235
1   2077  12641
---- Validation: 
scalar performance:
{'acc': 0.95950407, 'precision': 0.6714415, 'recall': 0.6212583, 'specificity': 0.6212583, 'f1': 0.6414483, 'auroc': 0.8903942, 'binary_precision': 0.36888888, 'binary_recall': 0.25816485, 'binary_specificity': 0.98435175, 'binary_f1_score': 0.30375114}
confusion matrix:
       0    1
0  17865  284
1    477  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.7759669, 'recall': 0.72804505, 'specificity': 0.72804505, 'f1': 0.74943817, 'auroc': 0.9167112, 'binary_precision': 0.57476634, 'binary_recall': 0.47126436, 'binary_specificity': 0.98482573, 'binary_f1_score': 0.5178947}
confusion matrix:
      0    1
0  5906   91
1   138  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_30.png
early stop counter: 14
val acc:0.9595040678977966, best validation acc: 0.9613665342330933, corresponding to test acc:                         0.9666027426719666 / 0.9686800837516785
after epoch: 30,now: 2024-06-26 14:24:40.124293,epoch time: 0:31:28.021498,used: 13:34:02.706118,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:34:02.706118 at 2024-06-26 14:24:40.124293
[Errno 2] No such file or directory: 'zoutput/saved_models/dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_00_50_37_seed_0_21581802.model'
this error can occur if model selection criteria                            is worsening, model never get persisted,                            no performance metric is reported
failed to remove model
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/exp/exp_main.py:128: UserWarning: failed to remove model
  warnings.warn("failed to remove model")
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191019 KiB | 290140 KiB |    894 TiB |    894 TiB |
|       from large pool | 174400 KiB | 270353 KiB |    875 TiB |    875 TiB |
|       from small pool |  16619 KiB |  24700 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 191019 KiB | 290140 KiB |    894 TiB |    894 TiB |
|       from large pool | 174400 KiB | 270353 KiB |    875 TiB |    875 TiB |
|       from small pool |  16619 KiB |  24700 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189086 KiB | 285832 KiB |    894 TiB |    894 TiB |
|       from large pool | 172814 KiB | 268766 KiB |    875 TiB |    875 TiB |
|       from small pool |  16272 KiB |  24349 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 354304 KiB | 354304 KiB | 354304 KiB |      0 B   |
|       from large pool | 325632 KiB | 325632 KiB | 325632 KiB |      0 B   |
|       from small pool |  28672 KiB |  28672 KiB |  28672 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  34260 KiB |  63802 KiB | 513385 GiB | 513385 GiB |
|       from large pool |  30400 KiB |  55760 KiB | 494203 GiB | 494203 GiB |
|       from small pool |   3860 KiB |   9057 KiB |  19181 GiB |  19181 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1250    |    7613    |  180566 K  |  180564 K  |
|       from large pool |      76    |     113    |   88335 K  |   88335 K  |
|       from small pool |    1174    |    7536    |   92230 K  |   92229 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1250    |    7613    |  180566 K  |  180564 K  |
|       from large pool |      76    |     113    |   88335 K  |   88335 K  |
|       from small pool |    1174    |    7536    |   92230 K  |   92229 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      29    |      29    |      29    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      25    |    3580    |   96500 K  |   96500 K  |
|       from large pool |       9    |      13    |   58726 K  |   58726 K  |
|       from small pool |      16    |    3571    |   37774 K  |   37774 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 290140 KiB |    894 TiB |    894 TiB |
|       from large pool |  17088 KiB | 270353 KiB |    875 TiB |    875 TiB |
|       from small pool |      0 KiB |  24700 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 290140 KiB |    894 TiB |    894 TiB |
|       from large pool |  17088 KiB | 270353 KiB |    875 TiB |    875 TiB |
|       from small pool |      0 KiB |  24700 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 285832 KiB |    894 TiB |    894 TiB |
|       from large pool |  16640 KiB | 268766 KiB |    875 TiB |    875 TiB |
|       from small pool |      0 KiB |  24349 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 225280 KiB | 354304 KiB | 354304 KiB | 129024 KiB |
|       from large pool | 204800 KiB | 325632 KiB | 325632 KiB | 120832 KiB |
|       from small pool |  20480 KiB |  28672 KiB |  28672 KiB |   8192 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  75978 KiB | 513385 GiB | 513385 GiB |
|       from large pool |  23872 KiB |  66105 KiB | 494204 GiB | 494203 GiB |
|       from small pool |      0 KiB |  13898 KiB |  19181 GiB |  19181 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  180566 K  |  180566 K  |
|       from large pool |       2    |     113    |   88335 K  |   88335 K  |
|       from small pool |       0    |    7536    |   92230 K  |   92230 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  180566 K  |  180566 K  |
|       from large pool |       2    |     113    |   88335 K  |   88335 K  |
|       from small pool |       0    |    7536    |   92230 K  |   92230 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      29    |      29    |       9    |
|       from large pool |      10    |      15    |      15    |       5    |
|       from small pool |      10    |      14    |      14    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3580    |   96501 K  |   96501 K  |
|       from large pool |       3    |      13    |   58726 K  |   58726 K  |
|       from small pool |       0    |    3571    |   37774 K  |   37774 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 290140 KiB |    894 TiB |    894 TiB |
|       from large pool |  17088 KiB | 270353 KiB |    875 TiB |    875 TiB |
|       from small pool |      0 KiB |  24700 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 290140 KiB |    894 TiB |    894 TiB |
|       from large pool |  17088 KiB | 270353 KiB |    875 TiB |    875 TiB |
|       from small pool |      0 KiB |  24700 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 285832 KiB |    894 TiB |    894 TiB |
|       from large pool |  16640 KiB | 268766 KiB |    875 TiB |    875 TiB |
|       from small pool |      0 KiB |  24349 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 225280 KiB | 354304 KiB | 354304 KiB | 129024 KiB |
|       from large pool | 204800 KiB | 325632 KiB | 325632 KiB | 120832 KiB |
|       from small pool |  20480 KiB |  28672 KiB |  28672 KiB |   8192 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  75978 KiB | 513385 GiB | 513385 GiB |
|       from large pool |  23872 KiB |  66105 KiB | 494204 GiB | 494203 GiB |
|       from small pool |      0 KiB |  13898 KiB |  19181 GiB |  19181 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  180566 K  |  180566 K  |
|       from large pool |       2    |     113    |   88335 K  |   88335 K  |
|       from small pool |       0    |    7536    |   92230 K  |   92230 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  180566 K  |  180566 K  |
|       from large pool |       2    |     113    |   88335 K  |   88335 K  |
|       from small pool |       0    |    7536    |   92230 K  |   92230 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      29    |      29    |       9    |
|       from large pool |      10    |      15    |      15    |       5    |
|       from small pool |      10    |      14    |      14    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3580    |   96501 K  |   96501 K  |
|       from large pool |       3    |      13    |   58726 K  |   58726 K  |
|       from small pool |       0    |    3571    |   37774 K  |   37774 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802

 Experiment start at: 2024-06-26 14:32:01.417962
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9022382, 'precision': 0.8941135, 'recall': 0.8392333, 'specificity': 0.8392333, 'f1': 0.8617188, 'auroc': 0.9476813, 'binary_precision': 0.8803433, 'binary_recall': 0.71133304, 'binary_specificity': 0.9671335, 'binary_f1_score': 0.7868651}
confusion matrix:
       0      1
0  41020   1394
1   4162  10256
---- Validation: 
scalar performance:
{'acc': 0.94781214, 'precision': 0.63829046, 'recall': 0.6567859, 'specificity': 0.6567859, 'f1': 0.6468484, 'auroc': 0.8290318, 'binary_precision': 0.3011734, 'binary_recall': 0.34323922, 'binary_specificity': 0.9703326, 'binary_f1_score': 0.3208333}
confusion matrix:
       0    1
0  17531  536
1    442  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95278764, 'precision': 0.69478357, 'recall': 0.65353894, 'specificity': 0.65353894, 'f1': 0.67132485, 'auroc': 0.8850465, 'binary_precision': 0.4187192, 'binary_recall': 0.32692307, 'binary_specificity': 0.98015475, 'binary_f1_score': 0.3671706}
confusion matrix:
      0    1
0  5828  118
1   175   85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-26 15:05:28.474001,epoch time: 0:33:27.056039,used: 0:33:27.056039,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9288957, 'precision': 0.9308493, 'recall': 0.87785447, 'specificity': 0.87785447, 'f1': 0.90022504, 'auroc': 0.9663665, 'binary_precision': 0.93422043, 'binary_recall': 0.77424055, 'binary_specificity': 0.9814684, 'binary_f1_score': 0.84674025}
confusion matrix:
       0      1
0  41628    786
1   3255  11163
---- Validation: 
scalar performance:
{'acc': 0.95848453, 'precision': 0.7037182, 'recall': 0.718827, 'specificity': 0.718827, 'f1': 0.7109643, 'auroc': 0.862401, 'binary_precision': 0.4275862, 'binary_recall': 0.46062407, 'binary_specificity': 0.9770299, 'binary_f1_score': 0.44349068}
confusion matrix:
       0    1
0  17652  415
1    363  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7585005, 'recall': 0.74802196, 'specificity': 0.74802196, 'f1': 0.75313777, 'auroc': 0.909189, 'binary_precision': 0.53815264, 'binary_recall': 0.5153846, 'binary_specificity': 0.98065925, 'binary_f1_score': 0.5265226}
confusion matrix:
      0    1
0  5831  115
1   126  134
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-26 15:42:30.724536,epoch time: 0:37:02.250535,used: 1:10:29.306574,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93688416, 'precision': 0.93771136, 'recall': 0.892768, 'specificity': 0.892768, 'f1': 0.9123111, 'auroc': 0.97274923, 'binary_precision': 0.93917274, 'binary_recall': 0.8032184, 'binary_specificity': 0.98231757, 'binary_f1_score': 0.8658915}
confusion matrix:
       0      1
0  41665    750
1   2837  11580
---- Validation: 
scalar performance:
{'acc': 0.95928496, 'precision': 0.7084741, 'recall': 0.72067267, 'specificity': 0.72067267, 'f1': 0.714376, 'auroc': 0.8731562, 'binary_precision': 0.4369748, 'binary_recall': 0.46359584, 'binary_specificity': 0.97774947, 'binary_f1_score': 0.44989184}
confusion matrix:
       0    1
0  17665  402
1    361  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.76539063, 'recall': 0.76148343, 'specificity': 0.76148343, 'f1': 0.7634206, 'auroc': 0.9144137, 'binary_precision': 0.55078125, 'binary_recall': 0.5423077, 'binary_specificity': 0.98065925, 'binary_f1_score': 0.54651165}
confusion matrix:
      0    1
0  5831  115
1   119  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-26 16:10:23.001260,epoch time: 0:27:52.276724,used: 1:38:21.583298,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9424092, 'precision': 0.94366515, 'recall': 0.9019699, 'specificity': 0.9019699, 'f1': 0.9203327, 'auroc': 0.97720337, 'binary_precision': 0.945907, 'binary_recall': 0.8198779, 'binary_specificity': 0.98406184, 'binary_f1_score': 0.8783949}
confusion matrix:
       0      1
0  41738    676
1   2597  11821
---- Validation: 
scalar performance:
{'acc': 0.960619, 'precision': 0.71622473, 'recall': 0.719934, 'specificity': 0.719934, 'f1': 0.7180615, 'auroc': 0.8810245, 'binary_precision': 0.45255473, 'binary_recall': 0.46062407, 'binary_specificity': 0.97924393, 'binary_f1_score': 0.45655376}
confusion matrix:
       0    1
0  17692  375
1    363  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.780835, 'recall': 0.7663387, 'specificity': 0.7663387, 'f1': 0.77336967, 'auroc': 0.9180516, 'binary_precision': 0.5813008, 'binary_recall': 0.55, 'binary_specificity': 0.98267746, 'binary_f1_score': 0.5652174}
confusion matrix:
      0    1
0  5843  103
1   117  143
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-26 16:36:42.723136,epoch time: 0:26:19.721876,used: 2:04:41.305174,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94543564, 'precision': 0.9457916, 'recall': 0.90800893, 'specificity': 0.90800893, 'f1': 0.9248648, 'auroc': 0.9796994, 'binary_precision': 0.9464342, 'binary_recall': 0.8320272, 'binary_specificity': 0.9839907, 'binary_f1_score': 0.88555086}
confusion matrix:
       0      1
0  41734    679
1   2422  11997
---- Validation: 
scalar performance:
{'acc': 0.9614194, 'precision': 0.71904063, 'recall': 0.7017522, 'specificity': 0.7017522, 'f1': 0.70999527, 'auroc': 0.88331014, 'binary_precision': 0.45954692, 'binary_recall': 0.42199108, 'binary_specificity': 0.98151326, 'binary_f1_score': 0.43996897}
confusion matrix:
       0    1
0  17733  334
1    389  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.8072464, 'recall': 0.7605805, 'specificity': 0.7605805, 'f1': 0.7817659, 'auroc': 0.9181628, 'binary_precision': 0.6347032, 'binary_recall': 0.5346154, 'binary_specificity': 0.98654556, 'binary_f1_score': 0.5803758}
confusion matrix:
      0    1
0  5866   80
1   121  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-26 17:04:37.895768,epoch time: 0:27:55.172632,used: 2:32:36.477806,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94893724, 'precision': 0.9484432, 'recall': 0.91481805, 'specificity': 0.91481805, 'f1': 0.93002427, 'auroc': 0.98203593, 'binary_precision': 0.9475402, 'binary_recall': 0.845551, 'binary_specificity': 0.9840851, 'binary_f1_score': 0.89364505}
confusion matrix:
       0      1
0  41738    675
1   2227  12192
---- Validation: 
scalar performance:
{'acc': 0.9589114, 'precision': 0.70729244, 'recall': 0.72620106, 'specificity': 0.72620106, 'f1': 0.7162767, 'auroc': 0.8868399, 'binary_precision': 0.4341927, 'binary_recall': 0.4754829, 'binary_specificity': 0.97691923, 'binary_f1_score': 0.45390072}
confusion matrix:
       0    1
0  17650  417
1    353  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.75857604, 'recall': 0.77752984, 'specificity': 0.77752984, 'f1': 0.76767, 'auroc': 0.91868746, 'binary_precision': 0.53571427, 'binary_recall': 0.5769231, 'binary_specificity': 0.97813654, 'binary_f1_score': 0.5555555}
confusion matrix:
      0    1
0  5816  130
1   110  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_6.png
early stop counter: 1
val acc:0.9589114189147949, best validation acc: 0.961419403553009, corresponding to test acc:                         0.9676119685173035 / 0.9676119685173035
after epoch: 6,now: 2024-06-26 17:29:24.558550,epoch time: 0:24:46.662782,used: 2:57:23.140588,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9494651, 'precision': 0.949667, 'recall': 0.9150802, 'specificity': 0.9150802, 'f1': 0.9306816, 'auroc': 0.9833708, 'binary_precision': 0.9500351, 'binary_recall': 0.8452736, 'binary_specificity': 0.9848867, 'binary_f1_score': 0.8945978}
confusion matrix:
       0      1
0  41772    641
1   2231  12188
---- Validation: 
scalar performance:
{'acc': 0.9602455, 'precision': 0.7116941, 'recall': 0.70471966, 'specificity': 0.70471966, 'f1': 0.7081406, 'auroc': 0.8879199, 'binary_precision': 0.4446154, 'binary_recall': 0.4294205, 'binary_specificity': 0.9800188, 'binary_f1_score': 0.43688586}
confusion matrix:
       0    1
0  17706  361
1    384  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.77823925, 'recall': 0.75873053, 'specificity': 0.75873053, 'f1': 0.76808405, 'auroc': 0.9175819, 'binary_precision': 0.5767635, 'binary_recall': 0.5346154, 'binary_specificity': 0.9828456, 'binary_f1_score': 0.5548903}
confusion matrix:
      0    1
0  5844  102
1   121  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_7.png
early stop counter: 2
val acc:0.9602454900741577, best validation acc: 0.961419403553009, corresponding to test acc:                         0.9676119685173035 / 0.9676119685173035
after epoch: 7,now: 2024-06-26 17:54:29.608019,epoch time: 0:25:05.049469,used: 3:22:28.190057,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95182294, 'precision': 0.9531877, 'recall': 0.9180408, 'specificity': 0.9180408, 'f1': 0.93388593, 'auroc': 0.9844068, 'binary_precision': 0.95567346, 'binary_recall': 0.8494728, 'binary_specificity': 0.9866088, 'binary_f1_score': 0.8994491}
confusion matrix:
       0      1
0  41848    568
1   2170  12246
---- Validation: 
scalar performance:
{'acc': 0.960619, 'precision': 0.7115641, 'recall': 0.68846226, 'specificity': 0.68846226, 'f1': 0.6992582, 'auroc': 0.8894963, 'binary_precision': 0.44556114, 'binary_recall': 0.39524516, 'binary_specificity': 0.9816793, 'binary_f1_score': 0.41889763}
confusion matrix:
       0    1
0  17736  331
1    407  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.78857553, 'recall': 0.7501242, 'specificity': 0.7501242, 'f1': 0.76780516, 'auroc': 0.9173672, 'binary_precision': 0.59821427, 'binary_recall': 0.5153846, 'binary_specificity': 0.98486376, 'binary_f1_score': 0.553719}
confusion matrix:
      0    1
0  5856   90
1   126  134
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_8.png
early stop counter: 3
val acc:0.9606189727783203, best validation acc: 0.961419403553009, corresponding to test acc:                         0.9676119685173035 / 0.9676119685173035
after epoch: 8,now: 2024-06-26 18:19:36.496290,epoch time: 0:25:06.888271,used: 3:47:35.078328,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9527907, 'precision': 0.95293534, 'recall': 0.92083776, 'specificity': 0.92083776, 'f1': 0.93543917, 'auroc': 0.9853528, 'binary_precision': 0.953201, 'binary_recall': 0.85596395, 'binary_specificity': 0.9857116, 'binary_f1_score': 0.9019694}
confusion matrix:
       0      1
0  41806    606
1   2077  12343
---- Validation: 
scalar performance:
{'acc': 0.96003205, 'precision': 0.7090299, 'recall': 0.69674104, 'specificity': 0.69674104, 'f1': 0.7026744, 'auroc': 0.89132726, 'binary_precision': 0.43987343, 'binary_recall': 0.41307577, 'binary_specificity': 0.9804063, 'binary_f1_score': 0.42605367}
confusion matrix:
       0    1
0  17713  354
1    395  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.7772754, 'recall': 0.75680745, 'specificity': 0.75680745, 'f1': 0.7665977, 'auroc': 0.91696227, 'binary_precision': 0.575, 'binary_recall': 0.5307692, 'binary_specificity': 0.9828456, 'binary_f1_score': 0.552}
confusion matrix:
      0    1
0  5844  102
1   122  138
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_9.png
early stop counter: 4
val acc:0.960032045841217, best validation acc: 0.961419403553009, corresponding to test acc:                         0.9676119685173035 / 0.9676119685173035
after epoch: 9,now: 2024-06-26 18:43:11.102989,epoch time: 0:23:34.606699,used: 4:11:09.685027,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9494123, 'precision': 0.9555929, 'recall': 0.90978646, 'specificity': 0.90978646, 'f1': 0.9298004, 'auroc': 0.9860239, 'binary_precision': 0.96654004, 'binary_recall': 0.82933426, 'binary_specificity': 0.9902386, 'binary_f1_score': 0.89269584}
confusion matrix:
       0      1
0  41998    414
1   2461  11959
---- Validation: 
scalar performance:
{'acc': 0.96211314, 'precision': 0.7168666, 'recall': 0.6477516, 'specificity': 0.6477516, 'f1': 0.6749596, 'auroc': 0.8915113, 'binary_precision': 0.45916116, 'binary_recall': 0.30906388, 'binary_specificity': 0.98643935, 'binary_f1_score': 0.36944938}
confusion matrix:
       0    1
0  17822  245
1    465  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96455044, 'precision': 0.79421455, 'recall': 0.70197415, 'specificity': 0.70197415, 'f1': 0.73852134, 'auroc': 0.9165354, 'binary_precision': 0.6136364, 'binary_recall': 0.41538462, 'binary_specificity': 0.9885637, 'binary_f1_score': 0.49541286}
confusion matrix:
      0    1
0  5878   68
1   152  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_10.png
better model found
persisted
after epoch: 10,now: 2024-06-26 19:07:37.266586,epoch time: 0:24:26.163597,used: 4:35:35.848624,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9544799, 'precision': 0.9570061, 'recall': 0.9215478, 'specificity': 0.9215478, 'f1': 0.9375368, 'auroc': 0.9871942, 'binary_precision': 0.9616075, 'binary_recall': 0.8546955, 'binary_specificity': 0.98840004, 'binary_f1_score': 0.9050049}
confusion matrix:
       0      1
0  41922    492
1   2095  12323
---- Validation: 
scalar performance:
{'acc': 0.9617396, 'precision': 0.7185539, 'recall': 0.6804602, 'specificity': 0.6804602, 'f1': 0.6974586, 'auroc': 0.8931382, 'binary_precision': 0.46014494, 'binary_recall': 0.37741455, 'binary_specificity': 0.98350585, 'binary_f1_score': 0.41469386}
confusion matrix:
       0    1
0  17769  298
1    419  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.7853708, 'recall': 0.72387385, 'specificity': 0.72387385, 'f1': 0.75045156, 'auroc': 0.9163633, 'binary_precision': 0.5940594, 'binary_recall': 0.46153846, 'binary_specificity': 0.9862092, 'binary_f1_score': 0.5194805}
confusion matrix:
      0    1
0  5864   82
1   140  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_11.png
early stop counter: 1
val acc:0.9617395997047424, best validation acc: 0.9621131420135498, corresponding to test acc:                         0.9645504355430603 / 0.9676119685173035
after epoch: 11,now: 2024-06-26 19:34:13.812247,epoch time: 0:26:36.545661,used: 5:02:12.394285,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95358247, 'precision': 0.95803684, 'recall': 0.9183475, 'specificity': 0.9183475, 'f1': 0.9360262, 'auroc': 0.9874592, 'binary_precision': 0.9660601, 'binary_recall': 0.84681, 'binary_specificity': 0.9898849, 'binary_f1_score': 0.90251297}
confusion matrix:
       0      1
0  41983    429
1   2209  12211
---- Validation: 
scalar performance:
{'acc': 0.96211314, 'precision': 0.71603394, 'recall': 0.6427448, 'specificity': 0.6427448, 'f1': 0.67099404, 'auroc': 0.89254034, 'binary_precision': 0.45785877, 'binary_recall': 0.2986627, 'binary_specificity': 0.98682684, 'binary_f1_score': 0.36151078}
confusion matrix:
       0    1
0  17829  238
1    472  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.7991267, 'recall': 0.69286335, 'specificity': 0.69286335, 'f1': 0.7332181, 'auroc': 0.91528046, 'binary_precision': 0.6242424, 'binary_recall': 0.39615384, 'binary_specificity': 0.9895728, 'binary_f1_score': 0.4847059}
confusion matrix:
      0    1
0  5884   62
1   157  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_12.png
early stop counter: 2
val acc:0.9621131420135498, best validation acc: 0.9621131420135498, corresponding to test acc:                         0.9645504355430603 / 0.9676119685173035
after epoch: 12,now: 2024-06-26 19:58:57.267804,epoch time: 0:24:43.455557,used: 5:26:55.849842,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9531954, 'precision': 0.95855105, 'recall': 0.9169103, 'specificity': 0.9169103, 'f1': 0.93535453, 'auroc': 0.9870492, 'binary_precision': 0.9681478, 'binary_recall': 0.84325147, 'binary_specificity': 0.9905692, 'binary_f1_score': 0.90139383}
confusion matrix:
       0      1
0  42014    400
1   2260  12158
---- Validation: 
scalar performance:
{'acc': 0.96120596, 'precision': 0.7095636, 'recall': 0.652288, 'specificity': 0.652288, 'f1': 0.67581797, 'auroc': 0.8913057, 'binary_precision': 0.44421488, 'binary_recall': 0.31946507, 'binary_specificity': 0.985111, 'binary_f1_score': 0.3716508}
confusion matrix:
       0    1
0  17798  269
1    458  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.79432535, 'recall': 0.71317625, 'specificity': 0.71317625, 'f1': 0.7464962, 'auroc': 0.91463006, 'binary_precision': 0.61290324, 'binary_recall': 0.43846154, 'binary_specificity': 0.987891, 'binary_f1_score': 0.51121074}
confusion matrix:
      0    1
0  5874   72
1   146  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_13.png
early stop counter: 3
val acc:0.9612059593200684, best validation acc: 0.9621131420135498, corresponding to test acc:                         0.9645504355430603 / 0.9676119685173035
after epoch: 13,now: 2024-06-26 20:23:27.184701,epoch time: 0:24:29.916897,used: 5:51:25.766739,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9576119, 'precision': 0.9595579, 'recall': 0.9274092, 'specificity': 0.9274092, 'f1': 0.94205844, 'auroc': 0.98801684, 'binary_precision': 0.9631372, 'binary_recall': 0.86608875, 'binary_specificity': 0.9887296, 'binary_f1_score': 0.9120385}
confusion matrix:
       0      1
0  41934    478
1   1931  12489
---- Validation: 
scalar performance:
{'acc': 0.96003205, 'precision': 0.7055104, 'recall': 0.6774288, 'specificity': 0.6774288, 'f1': 0.69030243, 'auroc': 0.8922498, 'binary_precision': 0.43425605, 'binary_recall': 0.3729569, 'binary_specificity': 0.9819007, 'binary_f1_score': 0.40127894}
confusion matrix:
       0    1
0  17740  327
1    422  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.766492, 'recall': 0.73197556, 'specificity': 0.73197556, 'f1': 0.7478804, 'auroc': 0.9140463, 'binary_precision': 0.5555556, 'binary_recall': 0.48076922, 'binary_specificity': 0.98318195, 'binary_f1_score': 0.51546395}
confusion matrix:
      0    1
0  5846  100
1   135  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_14.png
early stop counter: 4
val acc:0.960032045841217, best validation acc: 0.9621131420135498, corresponding to test acc:                         0.9645504355430603 / 0.9676119685173035
after epoch: 14,now: 2024-06-26 20:46:43.551314,epoch time: 0:23:16.366613,used: 6:14:42.133352,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.95400476, 'precision': 0.96082824, 'recall': 0.91706884, 'specificity': 0.91706884, 'f1': 0.9363455, 'auroc': 0.98870724, 'binary_precision': 0.9729946, 'binary_recall': 0.84208333, 'binary_specificity': 0.99205434, 'binary_f1_score': 0.902818}
confusion matrix:
       0      1
0  42076    337
1   2277  12142
---- Validation: 
scalar performance:
{'acc': 0.9605123, 'precision': 0.7035828, 'recall': 0.651213, 'specificity': 0.651213, 'f1': 0.6730297, 'auroc': 0.89343214, 'binary_precision': 0.43232325, 'binary_recall': 0.3179792, 'binary_specificity': 0.98444676, 'binary_f1_score': 0.36643836}
confusion matrix:
       0    1
0  17786  281
1    459  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96422815, 'precision': 0.7849891, 'recall': 0.7257128, 'specificity': 0.7257128, 'f1': 0.7514856, 'auroc': 0.91333413, 'binary_precision': 0.59313726, 'binary_recall': 0.4653846, 'binary_specificity': 0.986041, 'binary_f1_score': 0.5215517}
confusion matrix:
      0    1
0  5863   83
1   139  121
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_15.png
early stop counter: 5
val acc:0.9605122804641724, best validation acc: 0.9621131420135498, corresponding to test acc:                         0.9645504355430603 / 0.9676119685173035
after epoch: 15,now: 2024-06-26 21:13:31.722005,epoch time: 0:26:48.170691,used: 6:41:30.304043,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.95689046, 'precision': 0.9616571, 'recall': 0.92367953, 'specificity': 0.92367953, 'f1': 0.9407028, 'auroc': 0.98903, 'binary_precision': 0.9702877, 'binary_recall': 0.8562708, 'binary_specificity': 0.9910883, 'binary_f1_score': 0.9097207}
confusion matrix:
       0      1
0  42038    378
1   2072  12344
---- Validation: 
scalar performance:
{'acc': 0.9606724, 'precision': 0.70568097, 'recall': 0.65487236, 'specificity': 0.65487236, 'f1': 0.6762329, 'auroc': 0.892889, 'binary_precision': 0.43625498, 'binary_recall': 0.3254086, 'binary_specificity': 0.9843361, 'binary_f1_score': 0.37276596}
confusion matrix:
       0    1
0  17784  283
1    454  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.7913792, 'recall': 0.7242102, 'specificity': 0.7242102, 'f1': 0.7528904, 'auroc': 0.91347766, 'binary_precision': 0.6060606, 'binary_recall': 0.46153846, 'binary_specificity': 0.9868819, 'binary_f1_score': 0.52401745}
confusion matrix:
      0    1
0  5868   78
1   140  120
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_16.png
early stop counter: 6
val acc:0.9606723785400391, best validation acc: 0.9621131420135498, corresponding to test acc:                         0.9645504355430603 / 0.9676119685173035
after epoch: 16,now: 2024-06-26 21:38:11.484995,epoch time: 0:24:39.762990,used: 7:06:10.067033,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9575591, 'precision': 0.96137536, 'recall': 0.92565274, 'specificity': 0.92565274, 'f1': 0.9417695, 'auroc': 0.98886704, 'binary_precision': 0.96832824, 'binary_recall': 0.860878, 'binary_specificity': 0.99042743, 'binary_f1_score': 0.91144717}
confusion matrix:
       0      1
0  42007    406
1   2006  12413
---- Validation: 
scalar performance:
{'acc': 0.95997864, 'precision': 0.70117354, 'recall': 0.6588042, 'specificity': 0.6588042, 'f1': 0.6771637, 'auroc': 0.8939662, 'binary_precision': 0.42694497, 'binary_recall': 0.3343239, 'binary_specificity': 0.9832844, 'binary_f1_score': 0.375}
confusion matrix:
       0    1
0  17765  302
1    448  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9629391, 'precision': 0.7735314, 'recall': 0.7268791, 'specificity': 0.7268791, 'f1': 0.7477508, 'auroc': 0.9123645, 'binary_precision': 0.57009345, 'binary_recall': 0.46923077, 'binary_specificity': 0.9845274, 'binary_f1_score': 0.5147679}
confusion matrix:
      0    1
0  5854   92
1   138  122
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_17.png
early stop counter: 7
val acc:0.9599786400794983, best validation acc: 0.9621131420135498, corresponding to test acc:                         0.9645504355430603 / 0.9676119685173035
after epoch: 17,now: 2024-06-26 22:02:54.969202,epoch time: 0:24:43.484207,used: 7:30:53.551240,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9575591, 'precision': 0.9629973, 'recall': 0.92425656, 'specificity': 0.92425656, 'f1': 0.94158995, 'auroc': 0.9895447, 'binary_precision': 0.9728282, 'binary_recall': 0.8566475, 'binary_specificity': 0.9918657, 'binary_f1_score': 0.9110489}
confusion matrix:
       0      1
0  42068    345
1   2067  12352
---- Validation: 
scalar performance:
{'acc': 0.95987195, 'precision': 0.6996875, 'recall': 0.6558878, 'specificity': 0.6558878, 'f1': 0.67472994, 'auroc': 0.893232, 'binary_precision': 0.42418426, 'binary_recall': 0.32838038, 'binary_specificity': 0.98339516, 'binary_f1_score': 0.37018424}
confusion matrix:
       0    1
0  17767  300
1    452  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.77674776, 'recall': 0.7326483, 'specificity': 0.7326483, 'f1': 0.75254464, 'auroc': 0.9116093, 'binary_precision': 0.5760369, 'binary_recall': 0.48076922, 'binary_specificity': 0.9845274, 'binary_f1_score': 0.524109}
confusion matrix:
      0    1
0  5854   92
1   135  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_18.png
early stop counter: 8
val acc:0.9598719477653503, best validation acc: 0.9621131420135498, corresponding to test acc:                         0.9645504355430603 / 0.9676119685173035
after epoch: 18,now: 2024-06-26 22:27:43.303031,epoch time: 0:24:48.333829,used: 7:55:41.885069,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9571896, 'precision': 0.9638402, 'recall': 0.9226129, 'specificity': 0.9226129, 'f1': 0.94093007, 'auroc': 0.9891801, 'binary_precision': 0.975786, 'binary_recall': 0.85241693, 'binary_specificity': 0.9928088, 'binary_f1_score': 0.90993893}
confusion matrix:
       0      1
0  42108    305
1   2128  12291
---- Validation: 
scalar performance:
{'acc': 0.9611526, 'precision': 0.70396554, 'recall': 0.6293718, 'specificity': 0.6293718, 'f1': 0.6572722, 'auroc': 0.8934511, 'binary_precision': 0.43467933, 'binary_recall': 0.27191678, 'binary_specificity': 0.98682684, 'binary_f1_score': 0.33455208}
confusion matrix:
       0    1
0  17829  238
1    490  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.7861898, 'recall': 0.6997147, 'specificity': 0.6997147, 'f1': 0.7343396, 'auroc': 0.91154367, 'binary_precision': 0.5977654, 'binary_recall': 0.41153845, 'binary_specificity': 0.987891, 'binary_f1_score': 0.48747155}
confusion matrix:
      0    1
0  5874   72
1   153  107
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_19.png
early stop counter: 9
val acc:0.9611526131629944, best validation acc: 0.9621131420135498, corresponding to test acc:                         0.9645504355430603 / 0.9676119685173035
after epoch: 19,now: 2024-06-26 22:53:15.568654,epoch time: 0:25:32.265623,used: 8:21:14.150692,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96074396, 'precision': 0.9653615, 'recall': 0.9303455, 'specificity': 0.9303455, 'f1': 0.94619465, 'auroc': 0.9895793, 'binary_precision': 0.9737967, 'binary_recall': 0.8686364, 'binary_specificity': 0.9920545, 'binary_f1_score': 0.91821545}
confusion matrix:
       0      1
0  42077    337
1   1894  12524
---- Validation: 
scalar performance:
{'acc': 0.9594984, 'precision': 0.6974067, 'recall': 0.65783983, 'specificity': 0.65783983, 'f1': 0.6751217, 'auroc': 0.8941122, 'binary_precision': 0.41947564, 'binary_recall': 0.33283803, 'binary_specificity': 0.9828417, 'binary_f1_score': 0.37116817}
confusion matrix:
       0    1
0  17757  310
1    449  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.7773024, 'recall': 0.72897035, 'specificity': 0.72897035, 'f1': 0.7505356, 'auroc': 0.910367, 'binary_precision': 0.57746476, 'binary_recall': 0.4730769, 'binary_specificity': 0.98486376, 'binary_f1_score': 0.52008456}
confusion matrix:
      0    1
0  5856   90
1   137  123
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_20.png
early stop counter: 10
val acc:0.959498405456543, best validation acc: 0.9621131420135498, corresponding to test acc:                         0.9645504355430603 / 0.9676119685173035
after epoch: 20,now: 2024-06-26 23:16:15.154202,epoch time: 0:22:59.585548,used: 8:44:13.736240,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9591603, 'precision': 0.96397215, 'recall': 0.9275037, 'specificity': 0.9275037, 'f1': 0.94393396, 'auroc': 0.9907013, 'binary_precision': 0.97272587, 'binary_recall': 0.863236, 'binary_specificity': 0.9917714, 'binary_f1_score': 0.9147162}
confusion matrix:
       0      1
0  42064    349
1   1972  12447
---- Validation: 
scalar performance:
{'acc': 0.9592316, 'precision': 0.69490427, 'recall': 0.65555567, 'specificity': 0.65555567, 'f1': 0.6727195, 'auroc': 0.8946109, 'binary_precision': 0.41463414, 'binary_recall': 0.32838038, 'binary_specificity': 0.9827309, 'binary_f1_score': 0.36650082}
confusion matrix:
       0    1
0  17755  312
1    452  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96406704, 'precision': 0.7821641, 'recall': 0.73298466, 'specificity': 0.73298466, 'f1': 0.75493145, 'auroc': 0.91043496, 'binary_precision': 0.58685446, 'binary_recall': 0.48076922, 'binary_specificity': 0.9852001, 'binary_f1_score': 0.52854127}
confusion matrix:
      0    1
0  5858   88
1   135  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_21.png
early stop counter: 11
val acc:0.9592316150665283, best validation acc: 0.9621131420135498, corresponding to test acc:                         0.9645504355430603 / 0.9676119685173035
after epoch: 21,now: 2024-06-26 23:39:02.513910,epoch time: 0:22:47.359708,used: 9:07:01.095948,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96048003, 'precision': 0.9645506, 'recall': 0.9303746, 'specificity': 0.9303746, 'f1': 0.9458777, 'auroc': 0.98972255, 'binary_precision': 0.9720025, 'binary_recall': 0.86926067, 'binary_specificity': 0.99148864, 'binary_f1_score': 0.91776514}
confusion matrix:
       0      1
0  42053    361
1   1885  12533
---- Validation: 
scalar performance:
{'acc': 0.958111, 'precision': 0.69495165, 'recall': 0.685731, 'specificity': 0.685731, 'f1': 0.69021386, 'auroc': 0.8927772, 'binary_precision': 0.4125, 'binary_recall': 0.3922734, 'binary_specificity': 0.97918856, 'binary_f1_score': 0.4021325}
confusion matrix:
       0    1
0  17691  376
1    409  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95987755, 'precision': 0.75010794, 'recall': 0.75286615, 'specificity': 0.75286615, 'f1': 0.75147843, 'auroc': 0.90911984, 'binary_precision': 0.5209125, 'binary_recall': 0.52692306, 'binary_specificity': 0.9788093, 'binary_f1_score': 0.52390057}
confusion matrix:
      0    1
0  5820  126
1   123  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_22.png
early stop counter: 12
val acc:0.9581109881401062, best validation acc: 0.9621131420135498, corresponding to test acc:                         0.9645504355430603 / 0.9676119685173035
after epoch: 22,now: 2024-06-27 00:02:17.029847,epoch time: 0:23:14.515937,used: 9:30:15.611885,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.959829, 'precision': 0.9656286, 'recall': 0.92778677, 'specificity': 0.92778677, 'f1': 0.9447768, 'auroc': 0.99101657, 'binary_precision': 0.9761438, 'binary_recall': 0.862741, 'binary_specificity': 0.99283254, 'binary_f1_score': 0.91594565}
confusion matrix:
       0      1
0  42110    304
1   1979  12439
---- Validation: 
scalar performance:
{'acc': 0.96093917, 'precision': 0.7054205, 'recall': 0.6435664, 'specificity': 0.6435664, 'f1': 0.6683121, 'auroc': 0.8929182, 'binary_precision': 0.43655914, 'binary_recall': 0.30163446, 'binary_specificity': 0.9854984, 'binary_f1_score': 0.35676622}
confusion matrix:
       0    1
0  17805  262
1    470  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.7840871, 'recall': 0.70146966, 'specificity': 0.70146966, 'f1': 0.7349037, 'auroc': 0.9079417, 'binary_precision': 0.5934066, 'binary_recall': 0.41538462, 'binary_specificity': 0.98755467, 'binary_f1_score': 0.4886878}
confusion matrix:
      0    1
0  5872   74
1   152  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581802_23.png
early stop counter: 13
val acc:0.9609391689300537, best validation acc: 0.9621131420135498, corresponding to test acc:                         0.9645504355430603 / 0.9676119685173035
after epoch: 23,now: 2024-06-27 00:25:12.362545,epoch time: 0:22:55.332698,used: 9:53:10.944583,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_32_01_seed_1_21581802
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
slurmstepd: error: *** JOB 21581802 ON gpusrv39 CANCELLED AT 2024-06-27T00:42:38 ***
