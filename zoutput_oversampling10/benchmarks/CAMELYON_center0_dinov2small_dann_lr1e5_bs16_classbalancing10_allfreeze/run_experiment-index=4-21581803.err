Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun 26 03:10:46 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_dann_lr1e5_bs16_classbalancing10/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_dann_lr1e5_bs16_classbalancing10/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803

 Experiment start at: 2024-06-26 03:20:49.527521
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8488955, 'precision': 0.8998898, 'recall': 0.71207565, 'specificity': 0.71207565, 'f1': 0.7508397, 'auroc': 0.9416121, 'binary_precision': 0.9660602, 'binary_recall': 0.42939657, 'binary_specificity': 0.99475473, 'binary_f1_score': 0.59453356}
confusion matrix:
       0     1
0  42102   222
1   8397  6319
---- Validation: 
scalar performance:
{'acc': 0.96141976, 'precision': 0.5565164, 'recall': 0.51049185, 'specificity': 0.51049185, 'f1': 0.51255405, 'auroc': 0.74056196, 'binary_precision': 0.14655173, 'binary_recall': 0.02643857, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.044795785}
confusion matrix:
       0   1
0  18050  99
1    626  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9534995, 'precision': 0.5319724, 'recall': 0.5048281, 'specificity': 0.5048281, 'f1': 0.50146824, 'auroc': 0.8251096, 'binary_precision': 0.10526316, 'binary_recall': 0.01532567, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.026755853}
confusion matrix:
      0   1
0  5963  34
1   257   4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-26 03:40:29.908757,epoch time: 0:19:40.381236,used: 0:19:40.381236,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90047336, 'precision': 0.92800426, 'recall': 0.8136208, 'specificity': 0.8136208, 'f1': 0.8517643, 'auroc': 0.95908904, 'binary_precision': 0.9695616, 'binary_recall': 0.6341646, 'binary_specificity': 0.99307704, 'binary_f1_score': 0.7667913}
confusion matrix:
       0     1
0  42030   293
1   5384  9333
---- Validation: 
scalar performance:
{'acc': 0.9623776, 'precision': 0.65285325, 'recall': 0.54774046, 'specificity': 0.54774046, 'f1': 0.5690447, 'auroc': 0.7596829, 'binary_precision': 0.33673468, 'binary_recall': 0.102643855, 'binary_specificity': 0.9928371, 'binary_f1_score': 0.15733016}
confusion matrix:
       0    1
0  18019  130
1    577   66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.80192614, 'recall': 0.533649, 'specificity': 0.533649, 'f1': 0.55193776, 'auroc': 0.8544978, 'binary_precision': 0.64285713, 'binary_recall': 0.06896552, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.12456748}
confusion matrix:
      0   1
0  5987  10
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-26 03:59:53.385454,epoch time: 0:19:23.476697,used: 0:39:03.857933,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92473704, 'precision': 0.9379709, 'recall': 0.86418283, 'specificity': 0.86418283, 'f1': 0.8931968, 'auroc': 0.96132994, 'binary_precision': 0.95992583, 'binary_recall': 0.739092, 'binary_specificity': 0.9892737, 'binary_f1_score': 0.8351572}
confusion matrix:
       0      1
0  41872    454
1   3839  10875
---- Validation: 
scalar performance:
{'acc': 0.9616326, 'precision': 0.6822157, 'recall': 0.6036089, 'specificity': 0.6036089, 'f1': 0.6307235, 'auroc': 0.7706655, 'binary_precision': 0.39166668, 'binary_recall': 0.21928461, 'binary_specificity': 0.9879332, 'binary_f1_score': 0.28115654}
confusion matrix:
       0    1
0  17930  219
1    502  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96692234, 'precision': 0.88467896, 'recall': 0.63643026, 'specificity': 0.63643026, 'f1': 0.69662017, 'auroc': 0.8681803, 'binary_precision': 0.8, 'binary_recall': 0.27586207, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.41025642}
confusion matrix:
      0   1
0  5979  18
1   189  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_3.png
new oracle model saved
early stop counter: 1
val acc:0.9616326093673706, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9669223427772522
after epoch: 3,now: 2024-06-26 04:20:36.943314,epoch time: 0:20:43.557860,used: 0:59:47.415793,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9355014, 'precision': 0.9418889, 'recall': 0.8876702, 'specificity': 0.8876702, 'f1': 0.9105056, 'auroc': 0.9648638, 'binary_precision': 0.95303774, 'binary_recall': 0.7888549, 'binary_specificity': 0.98648554, 'binary_f1_score': 0.8632088}
confusion matrix:
       0      1
0  41753    572
1   3107  11608
---- Validation: 
scalar performance:
{'acc': 0.9601426, 'precision': 0.6768041, 'recall': 0.62233895, 'specificity': 0.62233895, 'f1': 0.64394134, 'auroc': 0.7752353, 'binary_precision': 0.37954545, 'binary_recall': 0.25972006, 'binary_specificity': 0.9849579, 'binary_f1_score': 0.30840257}
confusion matrix:
       0    1
0  17876  273
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96772134, 'precision': 0.8640984, 'recall': 0.66433215, 'specificity': 0.66433215, 'f1': 0.7230634, 'auroc': 0.8692188, 'binary_precision': 0.75652176, 'binary_recall': 0.33333334, 'binary_specificity': 0.995331, 'binary_f1_score': 0.462766}
confusion matrix:
      0   1
0  5969  28
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_4.png
new oracle model saved
early stop counter: 2
val acc:0.9601426124572754, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9677213430404663
after epoch: 4,now: 2024-06-26 04:40:01.581666,epoch time: 0:19:24.638352,used: 1:19:12.054145,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.937763, 'precision': 0.9426147, 'recall': 0.8927628, 'specificity': 0.8927628, 'f1': 0.91406864, 'auroc': 0.965335, 'binary_precision': 0.95118403, 'binary_recall': 0.7997961, 'binary_specificity': 0.98572946, 'binary_f1_score': 0.86894566}
confusion matrix:
       0      1
0  41721    604
1   2946  11769
---- Validation: 
scalar performance:
{'acc': 0.9593444, 'precision': 0.67696965, 'recall': 0.6384269, 'specificity': 0.6384269, 'f1': 0.65501666, 'auroc': 0.7800158, 'binary_precision': 0.3787575, 'binary_recall': 0.29393467, 'binary_specificity': 0.98291916, 'binary_f1_score': 0.33099824}
confusion matrix:
       0    1
0  17839  310
1    454  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9678811, 'precision': 0.8425534, 'recall': 0.6900682, 'specificity': 0.6900682, 'f1': 0.74232346, 'auroc': 0.8710358, 'binary_precision': 0.7112676, 'binary_recall': 0.38697317, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.5012407}
confusion matrix:
      0    1
0  5956   41
1   160  101
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_5.png
new oracle model saved
early stop counter: 3
val acc:0.9593443870544434, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 5,now: 2024-06-26 04:58:53.105034,epoch time: 0:18:51.523368,used: 1:38:03.577513,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94123423, 'precision': 0.94321156, 'recall': 0.90113264, 'specificity': 0.90113264, 'f1': 0.9195769, 'auroc': 0.9670628, 'binary_precision': 0.9467809, 'binary_recall': 0.8182621, 'binary_specificity': 0.9840032, 'binary_f1_score': 0.87784255}
confusion matrix:
       0      1
0  41644    677
1   2675  12044
---- Validation: 
scalar performance:
{'acc': 0.9590783, 'precision': 0.676168, 'recall': 0.64128935, 'specificity': 0.64128935, 'f1': 0.6565448, 'auroc': 0.7724607, 'binary_precision': 0.37695312, 'binary_recall': 0.30015552, 'binary_specificity': 0.98242325, 'binary_f1_score': 0.33419913}
confusion matrix:
       0    1
0  17830  319
1    450  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.83158314, 'recall': 0.69156706, 'specificity': 0.69156706, 'f1': 0.7409226, 'auroc': 0.8700446, 'binary_precision': 0.6891892, 'binary_recall': 0.3908046, 'binary_specificity': 0.9923295, 'binary_f1_score': 0.49877754}
confusion matrix:
      0    1
0  5951   46
1   159  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_6.png
early stop counter: 4
val acc:0.959078311920166, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 6,now: 2024-06-26 05:17:31.481276,epoch time: 0:18:38.376242,used: 1:56:41.953755,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94389904, 'precision': 0.9420018, 'recall': 0.9091984, 'specificity': 0.9091984, 'f1': 0.9240017, 'auroc': 0.96731055, 'binary_precision': 0.93848497, 'binary_recall': 0.83748895, 'binary_specificity': 0.9809078, 'binary_f1_score': 0.88511527}
confusion matrix:
       0      1
0  41513    808
1   2392  12327
---- Validation: 
scalar performance:
{'acc': 0.9580141, 'precision': 0.6772723, 'recall': 0.6647402, 'specificity': 0.6647402, 'f1': 0.6707437, 'auroc': 0.78197014, 'binary_precision': 0.37751678, 'binary_recall': 0.34992224, 'binary_specificity': 0.9795581, 'binary_f1_score': 0.36319613}
confusion matrix:
       0    1
0  17778  371
1    418  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.7938247, 'recall': 0.71422017, 'specificity': 0.71422017, 'f1': 0.7470504, 'auroc': 0.8734025, 'binary_precision': 0.61170214, 'binary_recall': 0.44061303, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.51224947}
confusion matrix:
      0    1
0  5924   73
1   146  115
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_7.png
early stop counter: 5
val acc:0.9580140709877014, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 7,now: 2024-06-26 05:38:33.964007,epoch time: 0:21:02.482731,used: 2:17:44.436486,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94463533, 'precision': 0.94136363, 'recall': 0.91177213, 'specificity': 0.91177213, 'f1': 0.9252602, 'auroc': 0.96715033, 'binary_precision': 0.935241, 'binary_recall': 0.8438647, 'binary_specificity': 0.9796796, 'binary_f1_score': 0.88720626}
confusion matrix:
       0      1
0  41462    860
1   2298  12420
---- Validation: 
scalar performance:
{'acc': 0.9566837, 'precision': 0.6706382, 'recall': 0.6670517, 'specificity': 0.6670517, 'f1': 0.668823, 'auroc': 0.77793115, 'binary_precision': 0.36406994, 'binary_recall': 0.3561431, 'binary_specificity': 0.9779602, 'binary_f1_score': 0.36006287}
confusion matrix:
       0    1
0  17749  400
1    414  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.78096557, 'recall': 0.7153855, 'specificity': 0.7153855, 'f1': 0.74330974, 'auroc': 0.8731824, 'binary_precision': 0.5858586, 'binary_recall': 0.44444445, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.5054467}
confusion matrix:
      0    1
0  5915   82
1   145  116
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_8.png
early stop counter: 6
val acc:0.9566836953163147, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 8,now: 2024-06-26 05:58:22.123803,epoch time: 0:19:48.159796,used: 2:37:32.596282,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94524896, 'precision': 0.9405676, 'recall': 0.914229, 'specificity': 0.914229, 'f1': 0.92635584, 'auroc': 0.9671867, 'binary_precision': 0.93172, 'binary_recall': 0.8501257, 'binary_specificity': 0.9783323, 'binary_f1_score': 0.88905466}
confusion matrix:
       0      1
0  41404    917
1   2206  12513
---- Validation: 
scalar performance:
{'acc': 0.9567369, 'precision': 0.6706862, 'recall': 0.66632915, 'specificity': 0.66632915, 'f1': 0.66847533, 'auroc': 0.7777041, 'binary_precision': 0.36421725, 'binary_recall': 0.35458788, 'binary_specificity': 0.97807044, 'binary_f1_score': 0.35933807}
confusion matrix:
       0    1
0  17751  398
1    415  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9638862, 'precision': 0.7824545, 'recall': 0.7154688, 'specificity': 0.7154688, 'f1': 0.74390376, 'auroc': 0.8738977, 'binary_precision': 0.5888325, 'binary_recall': 0.44444445, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.50655025}
confusion matrix:
      0    1
0  5916   81
1   145  116
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_9.png
early stop counter: 7
val acc:0.9567369222640991, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 9,now: 2024-06-26 06:20:34.734194,epoch time: 0:22:12.610391,used: 2:59:45.206673,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94402176, 'precision': 0.9365562, 'recall': 0.9150276, 'specificity': 0.9150276, 'f1': 0.9250831, 'auroc': 0.96719205, 'binary_precision': 0.9222426, 'binary_recall': 0.8551237, 'binary_specificity': 0.9749315, 'binary_f1_score': 0.8874158}
confusion matrix:
       0      1
0  41263   1061
1   2132  12584
---- Validation: 
scalar performance:
{'acc': 0.95455515, 'precision': 0.6642302, 'recall': 0.67945063, 'specificity': 0.67945063, 'f1': 0.67145056, 'auroc': 0.78001857, 'binary_precision': 0.3503546, 'binary_recall': 0.38413686, 'binary_specificity': 0.97476447, 'binary_f1_score': 0.36646882}
confusion matrix:
       0    1
0  17691  458
1    396  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.7575667, 'recall': 0.7176328, 'specificity': 0.7176328, 'f1': 0.73569703, 'auroc': 0.8760357, 'binary_precision': 0.53881276, 'binary_recall': 0.45210728, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.49166664}
confusion matrix:
      0    1
0  5896  101
1   143  118
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_10.png
early stop counter: 8
val acc:0.9545551538467407, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 10,now: 2024-06-26 06:39:15.737434,epoch time: 0:18:41.003240,used: 3:18:26.209913,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9438815, 'precision': 0.94189584, 'recall': 0.90925306, 'specificity': 0.90925306, 'f1': 0.92399096, 'auroc': 0.9694141, 'binary_precision': 0.93821335, 'binary_recall': 0.8376928, 'binary_specificity': 0.9808133, 'binary_f1_score': 0.88510823}
confusion matrix:
       0      1
0  41509    812
1   2389  12330
---- Validation: 
scalar performance:
{'acc': 0.9562048, 'precision': 0.6647269, 'recall': 0.657053, 'specificity': 0.657053, 'f1': 0.6607845, 'auroc': 0.77655196, 'binary_precision': 0.3529412, 'binary_recall': 0.33592534, 'binary_specificity': 0.9781806, 'binary_f1_score': 0.3442231}
confusion matrix:
       0    1
0  17753  396
1    427  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.79600537, 'recall': 0.7124712, 'specificity': 0.7124712, 'f1': 0.74657476, 'auroc': 0.87589514, 'binary_precision': 0.61621624, 'binary_recall': 0.43678162, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.5112108}
confusion matrix:
      0    1
0  5926   71
1   147  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_11.png
early stop counter: 9
val acc:0.9562047719955444, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 11,now: 2024-06-26 06:57:40.825327,epoch time: 0:18:25.087893,used: 3:36:51.297806,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.94456524, 'precision': 0.9435456, 'recall': 0.9094709, 'specificity': 0.9094709, 'f1': 0.92479444, 'auroc': 0.9694484, 'binary_precision': 0.9416622, 'binary_recall': 0.8369691, 'binary_specificity': 0.9819728, 'binary_f1_score': 0.88623446}
confusion matrix:
       0      1
0  41562    763
1   2399  12316
---- Validation: 
scalar performance:
{'acc': 0.9557791, 'precision': 0.66134894, 'recall': 0.6538324, 'specificity': 0.6538324, 'f1': 0.65748715, 'auroc': 0.7757206, 'binary_precision': 0.34640524, 'binary_recall': 0.32970452, 'binary_specificity': 0.9779602, 'binary_f1_score': 0.3378486}
confusion matrix:
       0    1
0  17749  400
1    431  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9651646, 'precision': 0.7965621, 'recall': 0.7106389, 'specificity': 0.7106389, 'f1': 0.74547535, 'auroc': 0.8764392, 'binary_precision': 0.61748636, 'binary_recall': 0.4329502, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.50900906}
confusion matrix:
      0    1
0  5927   70
1   148  113
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_12.png
early stop counter: 10
val acc:0.9557790756225586, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 12,now: 2024-06-26 07:16:05.664196,epoch time: 0:18:24.838869,used: 3:55:16.136675,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.94519633, 'precision': 0.9437985, 'recall': 0.91088325, 'specificity': 0.91088325, 'f1': 0.9257412, 'auroc': 0.9690878, 'binary_precision': 0.9412078, 'binary_recall': 0.84000546, 'binary_specificity': 0.98176104, 'binary_f1_score': 0.8877317}
confusion matrix:
       0      1
0  41555    772
1   2354  12359
---- Validation: 
scalar performance:
{'acc': 0.95423585, 'precision': 0.6517221, 'recall': 0.6485331, 'specificity': 0.6485331, 'f1': 0.65010786, 'auroc': 0.7784518, 'binary_precision': 0.32750398, 'binary_recall': 0.32037324, 'binary_specificity': 0.9766929, 'binary_f1_score': 0.32389936}
confusion matrix:
       0    1
0  17726  423
1    437  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.7987904, 'recall': 0.71447027, 'specificity': 0.71447027, 'f1': 0.7488997, 'auroc': 0.879686, 'binary_precision': 0.6216216, 'binary_recall': 0.44061303, 'binary_specificity': 0.9883275, 'binary_f1_score': 0.51569504}
confusion matrix:
      0    1
0  5927   70
1   146  115
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_13.png
early stop counter: 11
val acc:0.954235851764679, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 13,now: 2024-06-26 07:34:24.559739,epoch time: 0:18:18.895543,used: 4:13:35.032218,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.94303995, 'precision': 0.9434561, 'recall': 0.9055673, 'specificity': 0.9055673, 'f1': 0.92240065, 'auroc': 0.96798015, 'binary_precision': 0.9442163, 'binary_recall': 0.8281462, 'binary_specificity': 0.98298836, 'binary_f1_score': 0.88238066}
confusion matrix:
       0      1
0  41604    720
1   2529  12187
---- Validation: 
scalar performance:
{'acc': 0.95455515, 'precision': 0.63901246, 'recall': 0.6171961, 'specificity': 0.6171961, 'f1': 0.62701774, 'auroc': 0.7688011, 'binary_precision': 0.30426717, 'binary_recall': 0.25505444, 'binary_specificity': 0.9793377, 'binary_f1_score': 0.27749577}
confusion matrix:
       0    1
0  17774  375
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.8258307, 'recall': 0.6894846, 'specificity': 0.6894846, 'f1': 0.73775065, 'auroc': 0.88233197, 'binary_precision': 0.67785233, 'binary_recall': 0.38697317, 'binary_specificity': 0.991996, 'binary_f1_score': 0.49268287}
confusion matrix:
      0    1
0  5949   48
1   160  101
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_14.png
early stop counter: 12
val acc:0.9545551538467407, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 14,now: 2024-06-26 07:52:39.817178,epoch time: 0:18:15.257439,used: 4:31:50.289657,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9389902, 'precision': 0.9465908, 'recall': 0.8926145, 'specificity': 0.8926145, 'f1': 0.91542244, 'auroc': 0.9666154, 'binary_precision': 0.95988536, 'binary_recall': 0.796806, 'binary_specificity': 0.98842293, 'binary_f1_score': 0.87077606}
confusion matrix:
       0      1
0  41835    490
1   2990  11725
---- Validation: 
scalar performance:
{'acc': 0.9560983, 'precision': 0.63056916, 'recall': 0.58874285, 'specificity': 0.58874285, 'f1': 0.60498047, 'auroc': 0.7545786, 'binary_precision': 0.28935185, 'binary_recall': 0.19440125, 'binary_specificity': 0.98308444, 'binary_f1_score': 0.23255815}
confusion matrix:
       0    1
0  17842  307
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96612334, 'precision': 0.8369004, 'recall': 0.6598337, 'specificity': 0.6598337, 'f1': 0.7137773, 'auroc': 0.88600844, 'binary_precision': 0.70247936, 'binary_recall': 0.3256705, 'binary_specificity': 0.993997, 'binary_f1_score': 0.44502622}
confusion matrix:
      0   1
0  5961  36
1   176  85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_15.png
early stop counter: 13
val acc:0.9560983180999756, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 15,now: 2024-06-26 08:10:58.000701,epoch time: 0:18:18.183523,used: 4:50:08.473180,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9320126, 'precision': 0.94817233, 'recall': 0.8745494, 'specificity': 0.8745494, 'f1': 0.90373707, 'auroc': 0.96570265, 'binary_precision': 0.97510517, 'binary_recall': 0.7558092, 'binary_specificity': 0.99328953, 'binary_f1_score': 0.8515655}
confusion matrix:
       0      1
0  42038    284
1   3594  11124
---- Validation: 
scalar performance:
{'acc': 0.95796084, 'precision': 0.6158648, 'recall': 0.55670464, 'specificity': 0.55670464, 'f1': 0.5743011, 'auroc': 0.7279305, 'binary_precision': 0.26213592, 'binary_recall': 0.125972, 'binary_specificity': 0.9874373, 'binary_f1_score': 0.17016807}
confusion matrix:
       0    1
0  17921  228
1    562   81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.85649586, 'recall': 0.62643486, 'specificity': 0.62643486, 'f1': 0.68196416, 'auroc': 0.89421463, 'binary_precision': 0.74444443, 'binary_recall': 0.256705, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.38176638}
confusion matrix:
      0   1
0  5974  23
1   194  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_16.png
early stop counter: 14
val acc:0.957960844039917, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 16,now: 2024-06-26 08:29:04.978804,epoch time: 0:18:06.978103,used: 5:08:15.451283,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9162693, 'precision': 0.9468677, 'recall': 0.8390244, 'specificity': 0.8390244, 'f1': 0.87686193, 'auroc': 0.96232224, 'binary_precision': 0.9941334, 'binary_recall': 0.67944276, 'binary_specificity': 0.998606, 'binary_f1_score': 0.80720174}
confusion matrix:
       0     1
0  42266    59
1   4717  9998
---- Validation: 
scalar performance:
{'acc': 0.96099406, 'precision': 0.52851313, 'recall': 0.50502104, 'specificity': 0.50502104, 'f1': 0.50332934, 'auroc': 0.6907095, 'binary_precision': 0.09090909, 'binary_recall': 0.0155521, 'binary_specificity': 0.99449, 'binary_f1_score': 0.026560424}
confusion matrix:
       0    1
0  18049  100
1    633   10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.93740547, 'recall': 0.55913687, 'specificity': 0.55913687, 'f1': 0.59555197, 'auroc': 0.90051186, 'binary_precision': 0.9117647, 'binary_recall': 0.118773945, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.21016948}
confusion matrix:
      0   1
0  5994   3
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_17.png
early stop counter: 15
val acc:0.9609940648078918, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 17,now: 2024-06-26 08:47:13.041903,epoch time: 0:18:08.063099,used: 5:26:23.514382,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.905277, 'precision': 0.9419492, 'recall': 0.81714594, 'specificity': 0.81714594, 'f1': 0.8578596, 'auroc': 0.95550954, 'binary_precision': 0.99658775, 'binary_recall': 0.6350479, 'binary_specificity': 0.9992439, 'binary_f1_score': 0.7757626}
confusion matrix:
       0     1
0  42291    32
1   5371  9346
---- Validation: 
scalar performance:
{'acc': 0.9604087, 'precision': 0.5012475, 'recall': 0.5002177, 'specificity': 0.5002177, 'f1': 0.49521923, 'auroc': 0.6347319, 'binary_precision': 0.036697246, 'binary_recall': 0.00622084, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.0106382985}
confusion matrix:
       0    1
0  18044  105
1    639    4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.9416025, 'recall': 0.5229051, 'specificity': 0.5229051, 'f1': 0.5335849, 'auroc': 0.89956, 'binary_precision': 0.9230769, 'binary_recall': 0.04597701, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.08759124}
confusion matrix:
      0   1
0  5996   1
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_18.png
early stop counter: 16
val acc:0.9604086875915527, best validation acc: 0.9623776078224182, corresponding to test acc:                         0.9595717191696167 / 0.9678810834884644
after epoch: 18,now: 2024-06-26 09:06:05.346159,epoch time: 0:18:52.304256,used: 5:45:15.818638,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.87070477, 'precision': 0.9256189, 'recall': 0.7495059, 'specificity': 0.7495059, 'f1': 0.79280514, 'auroc': 0.94810724, 'binary_precision': 0.9995917, 'binary_recall': 0.49908268, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.6657603}
confusion matrix:
       0     1
0  42320     3
1   7372  7345
---- Validation: 
scalar performance:
{'acc': 0.96471906, 'precision': 0.5056255, 'recall': 0.5001991, 'specificity': 0.5001991, 'f1': 0.49252462, 'auroc': 0.5748385, 'binary_precision': 0.045454547, 'binary_recall': 0.00155521, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.0030075186}
confusion matrix:
       0   1
0  18128  21
1    642   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.89836586, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_19.png
better model found
persisted
after epoch: 19,now: 2024-06-26 09:28:49.365805,epoch time: 0:22:44.019646,used: 6:07:59.838284,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.86879385, 'precision': 0.9242523, 'recall': 0.74594057, 'specificity': 0.74594057, 'f1': 0.78903687, 'auroc': 0.9346168, 'binary_precision': 0.99862105, 'binary_recall': 0.49211743, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.6593227}
confusion matrix:
       0     1
0  42314    10
1   7474  7242
---- Validation: 
scalar performance:
{'acc': 0.96301615, 'precision': 0.500751, 'recall': 0.50006753, 'specificity': 0.50006753, 'f1': 0.49344006, 'auroc': 0.49181825, 'binary_precision': 0.035714287, 'binary_recall': 0.00311042, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.005722461}
confusion matrix:
       0   1
0  18095  54
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.88247347, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_20.png
early stop counter: 1
val acc:0.963016152381897, best validation acc: 0.9647190570831299, corresponding to test acc:                         0.9586129784584045 / 0.9678810834884644
after epoch: 20,now: 2024-06-26 09:51:58.099158,epoch time: 0:23:08.733353,used: 6:31:08.571637,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8545231, 'precision': 0.9177518, 'recall': 0.7181889, 'specificity': 0.7181889, 'f1': 0.75914806, 'auroc': 0.91253376, 'binary_precision': 0.9993777, 'binary_recall': 0.43647236, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.6075853}
confusion matrix:
       0     1
0  42318     4
1   8294  6424
---- Validation: 
scalar performance:
{'acc': 0.9631226, 'precision': 0.50141424, 'recall': 0.5001226, 'specificity': 0.5001226, 'f1': 0.49347585, 'auroc': 0.39461148, 'binary_precision': 0.037037037, 'binary_recall': 0.00311042, 'binary_specificity': 0.9971348, 'binary_f1_score': 0.005738881}
confusion matrix:
       0   1
0  18097  52
1    641   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.9793765, 'recall': 0.50574714, 'specificity': 0.50574714, 'f1': 0.50083476, 'auroc': 0.86311066, 'binary_precision': 1.0, 'binary_recall': 0.011494253, 'binary_specificity': 1.0, 'binary_f1_score': 0.022727272}
confusion matrix:
      0  1
0  5997  0
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_21.png
early stop counter: 2
val acc:0.9631226062774658, best validation acc: 0.9647190570831299, corresponding to test acc:                         0.9586129784584045 / 0.9678810834884644
after epoch: 21,now: 2024-06-26 10:18:13.584579,epoch time: 0:26:15.485421,used: 6:57:24.057058,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.8629558, 'precision': 0.9205519, 'recall': 0.7349145, 'specificity': 0.7349145, 'f1': 0.77726936, 'auroc': 0.8996571, 'binary_precision': 0.99668825, 'binary_recall': 0.47037238, 'binary_specificity': 0.9994566, 'binary_f1_score': 0.639121}
confusion matrix:
       0     1
0  42301    23
1   7794  6922
---- Validation: 
scalar performance:
{'acc': 0.958493, 'precision': 0.49665898, 'recall': 0.49922588, 'specificity': 0.49922588, 'f1': 0.49447715, 'auroc': 0.36339366, 'binary_precision': 0.027586207, 'binary_recall': 0.00622084, 'binary_specificity': 0.99223095, 'binary_f1_score': 0.010152285}
confusion matrix:
       0    1
0  18008  141
1    639    4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.9416025, 'recall': 0.5229051, 'specificity': 0.5229051, 'f1': 0.5335849, 'auroc': 0.8496765, 'binary_precision': 0.9230769, 'binary_recall': 0.04597701, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.08759124}
confusion matrix:
      0   1
0  5996   1
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_22.png
early stop counter: 3
val acc:0.9584929943084717, best validation acc: 0.9647190570831299, corresponding to test acc:                         0.9586129784584045 / 0.9678810834884644
after epoch: 22,now: 2024-06-26 10:45:53.637058,epoch time: 0:27:40.052479,used: 7:25:04.109537,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.85890603, 'precision': 0.91782296, 'recall': 0.7272727, 'specificity': 0.7272727, 'f1': 0.7689427, 'auroc': 0.8878384, 'binary_precision': 0.994951, 'binary_recall': 0.45534864, 'binary_specificity': 0.9991967, 'binary_f1_score': 0.6247669}
confusion matrix:
       0     1
0  42292    34
1   8014  6700
---- Validation: 
scalar performance:
{'acc': 0.95498085, 'precision': 0.49680862, 'recall': 0.49890774, 'specificity': 0.49890774, 'f1': 0.49547526, 'auroc': 0.3726809, 'binary_precision': 0.027906977, 'binary_recall': 0.00933126, 'binary_specificity': 0.9884842, 'binary_f1_score': 0.013986014}
confusion matrix:
       0    1
0  17940  209
1    637    6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.93522215, 'recall': 0.53814745, 'specificity': 0.53814745, 'f1': 0.5607392, 'auroc': 0.8526629, 'binary_precision': 0.90909094, 'binary_recall': 0.07662835, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.14134276}
confusion matrix:
      0   1
0  5995   2
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_23.png
early stop counter: 4
val acc:0.9549808502197266, best validation acc: 0.9647190570831299, corresponding to test acc:                         0.9586129784584045 / 0.9678810834884644
after epoch: 23,now: 2024-06-26 11:17:10.000428,epoch time: 0:31:16.363370,used: 7:56:20.472907,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.868075, 'precision': 0.9204191, 'recall': 0.7458108, 'specificity': 0.7458108, 'f1': 0.788416, 'auroc': 0.8837372, 'binary_precision': 0.99085325, 'binary_recall': 0.49320468, 'binary_specificity': 0.99841696, 'binary_f1_score': 0.65859085}
confusion matrix:
       0     1
0  42257    67
1   7458  7258
---- Validation: 
scalar performance:
{'acc': 0.94151765, 'precision': 0.4921883, 'recall': 0.49418783, 'specificity': 0.49418783, 'f1': 0.49298888, 'auroc': 0.37629074, 'binary_precision': 0.01898734, 'binary_recall': 0.01399689, 'binary_specificity': 0.97437876, 'binary_f1_score': 0.016114593}
confusion matrix:
       0    1
0  17684  465
1    634    9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9204087, 'recall': 0.5932861, 'specificity': 0.5932861, 'f1': 0.64559793, 'auroc': 0.8571981, 'binary_precision': 0.875, 'binary_recall': 0.18773946, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.30914825}
confusion matrix:
      0   1
0  5990   7
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_24.png
early stop counter: 5
val acc:0.9415176510810852, best validation acc: 0.9647190570831299, corresponding to test acc:                         0.9586129784584045 / 0.9678810834884644
after epoch: 24,now: 2024-06-26 11:44:48.925054,epoch time: 0:27:38.924626,used: 8:23:59.397533,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.8600105, 'precision': 0.9167344, 'recall': 0.73000425, 'specificity': 0.73000425, 'f1': 0.7717069, 'auroc': 0.8811605, 'binary_precision': 0.9913856, 'binary_recall': 0.46140257, 'binary_specificity': 0.99860597, 'binary_f1_score': 0.62972414}
confusion matrix:
       0     1
0  42265    59
1   7926  6790
---- Validation: 
scalar performance:
{'acc': 0.9434334, 'precision': 0.49187753, 'recall': 0.49442956, 'specificity': 0.49442956, 'f1': 0.49285462, 'auroc': 0.38619, 'binary_precision': 0.018348623, 'binary_recall': 0.01244168, 'binary_specificity': 0.9764174, 'binary_f1_score': 0.014828545}
confusion matrix:
       0    1
0  17721  428
1    635    8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650048, 'precision': 0.9204087, 'recall': 0.5932861, 'specificity': 0.5932861, 'f1': 0.64559793, 'auroc': 0.8645121, 'binary_precision': 0.875, 'binary_recall': 0.18773946, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.30914825}
confusion matrix:
      0   1
0  5990   7
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_25.png
early stop counter: 6
val acc:0.943433403968811, best validation acc: 0.9647190570831299, corresponding to test acc:                         0.9586129784584045 / 0.9678810834884644
after epoch: 25,now: 2024-06-26 12:12:31.926764,epoch time: 0:27:43.001710,used: 8:51:42.399243,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.858047, 'precision': 0.9148043, 'recall': 0.7264907, 'specificity': 0.7264907, 'f1': 0.7677938, 'auroc': 0.8766111, 'binary_precision': 0.98920757, 'binary_recall': 0.45470607, 'binary_specificity': 0.9982753, 'binary_f1_score': 0.6230271}
confusion matrix:
       0     1
0  42252    73
1   8024  6691
---- Validation: 
scalar performance:
{'acc': 0.93954873, 'precision': 0.49146584, 'recall': 0.49316847, 'specificity': 0.49316847, 'f1': 0.4922074, 'auroc': 0.40221137, 'binary_precision': 0.017612524, 'binary_recall': 0.01399689, 'binary_specificity': 0.97234005, 'binary_f1_score': 0.015597919}
confusion matrix:
       0    1
0  17647  502
1    634    9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96740174, 'precision': 0.90622115, 'recall': 0.63301575, 'specificity': 0.63301575, 'f1': 0.6951085, 'auroc': 0.86718524, 'binary_precision': 0.8433735, 'binary_recall': 0.26819924, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.40697673}
confusion matrix:
      0   1
0  5984  13
1   191  70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_26.png
early stop counter: 7
val acc:0.9395487308502197, best validation acc: 0.9647190570831299, corresponding to test acc:                         0.9586129784584045 / 0.9678810834884644
after epoch: 26,now: 2024-06-26 12:40:52.563508,epoch time: 0:28:20.636744,used: 9:20:03.035987,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9142707, 'precision': 0.90606594, 'recall': 0.8640624, 'specificity': 0.8640624, 'f1': 0.8821702, 'auroc': 0.94757354, 'binary_precision': 0.8914117, 'binary_recall': 0.7603289, 'binary_specificity': 0.967796, 'binary_f1_score': 0.82066894}
confusion matrix:
       0      1
0  40961   1363
1   3527  11189
---- Validation: 
scalar performance:
{'acc': 0.84386975, 'precision': 0.49953097, 'recall': 0.4983881, 'specificity': 0.4983881, 'f1': 0.4839297, 'auroc': 0.58253956, 'binary_precision': 0.03340122, 'binary_recall': 0.12752722, 'binary_specificity': 0.869249, 'binary_f1_score': 0.052937377}
confusion matrix:
       0     1
0  15776  2373
1    561    82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7632233, 'recall': 0.8430652, 'specificity': 0.8430652, 'f1': 0.79710704, 'auroc': 0.91164196, 'binary_precision': 0.53913045, 'binary_recall': 0.7126437, 'binary_specificity': 0.9734867, 'binary_f1_score': 0.61386144}
confusion matrix:
      0    1
0  5838  159
1    75  186
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_27.png
early stop counter: 8
val acc:0.8438697457313538, best validation acc: 0.9647190570831299, corresponding to test acc:                         0.9586129784584045 / 0.9678810834884644
after epoch: 27,now: 2024-06-26 13:04:34.031827,epoch time: 0:23:41.468319,used: 9:43:44.504306,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9249825, 'precision': 0.9203894, 'recall': 0.87930244, 'specificity': 0.87930244, 'f1': 0.89719486, 'auroc': 0.95704037, 'binary_precision': 0.91212696, 'binary_recall': 0.7849039, 'binary_specificity': 0.973701, 'binary_f1_score': 0.84374666}
confusion matrix:
       0      1
0  41208   1113
1   3166  11553
---- Validation: 
scalar performance:
{'acc': 0.8992124, 'precision': 0.49964485, 'recall': 0.49928778, 'specificity': 0.49928778, 'f1': 0.4960803, 'auroc': 0.6389218, 'binary_precision': 0.033557046, 'binary_recall': 0.06998445, 'binary_specificity': 0.92859113, 'binary_f1_score': 0.045362905}
confusion matrix:
       0     1
0  16853  1296
1    598    45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9747523, 'precision': 0.85109293, 'recall': 0.8200844, 'specificity': 0.8200844, 'f1': 0.834792, 'auroc': 0.91736996, 'binary_precision': 0.7172996, 'binary_recall': 0.651341, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.6827309}
confusion matrix:
      0    1
0  5930   67
1    91  170
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_28.png
new oracle model saved
early stop counter: 9
val acc:0.8992124199867249, best validation acc: 0.9647190570831299, corresponding to test acc:                         0.9586129784584045 / 0.9747523069381714
after epoch: 28,now: 2024-06-26 13:27:25.033573,epoch time: 0:22:51.001746,used: 10:06:35.506052,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.92768234, 'precision': 0.9233196, 'recall': 0.88373816, 'specificity': 0.88373816, 'f1': 0.9010872, 'auroc': 0.9602009, 'binary_precision': 0.9154311, 'binary_recall': 0.79294646, 'binary_specificity': 0.9745298, 'binary_f1_score': 0.8497979}
confusion matrix:
       0      1
0  41246   1078
1   3047  11669
---- Validation: 
scalar performance:
{'acc': 0.9167731, 'precision': 0.5035181, 'recall': 0.50537896, 'specificity': 0.50537896, 'f1': 0.50314915, 'auroc': 0.6681762, 'binary_precision': 0.04087737, 'binary_recall': 0.06376361, 'binary_specificity': 0.9469943, 'binary_f1_score': 0.04981774}
confusion matrix:
       0    1
0  17187  962
1    602   41
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97666985, 'precision': 0.87462556, 'recall': 0.8137555, 'specificity': 0.8137555, 'f1': 0.8412162, 'auroc': 0.9228445, 'binary_precision': 0.764977, 'binary_recall': 0.6360153, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.69456065}
confusion matrix:
      0    1
0  5946   51
1    95  166
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_29.png
new oracle model saved
early stop counter: 10
val acc:0.9167730808258057, best validation acc: 0.9647190570831299, corresponding to test acc:                         0.9586129784584045 / 0.9766698479652405
after epoch: 29,now: 2024-06-26 13:48:21.222933,epoch time: 0:20:56.189360,used: 10:27:31.695412,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.92322934, 'precision': 0.9378864, 'recall': 0.8606086, 'specificity': 0.8606086, 'f1': 0.8906245, 'auroc': 0.95931745, 'binary_precision': 0.9619993, 'binary_recall': 0.7312581, 'binary_specificity': 0.9899591, 'binary_f1_score': 0.8309071}
confusion matrix:
       0      1
0  41902    425
1   3954  10759
---- Validation: 
scalar performance:
{'acc': 0.94779694, 'precision': 0.4981337, 'recall': 0.4989388, 'specificity': 0.4989388, 'f1': 0.4975585, 'auroc': 0.66892266, 'binary_precision': 0.030555556, 'binary_recall': 0.01710731, 'binary_specificity': 0.9807703, 'binary_f1_score': 0.021934198}
confusion matrix:
       0    1
0  17800  349
1    632   11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9742729, 'precision': 0.9248102, 'recall': 0.72272056, 'specificity': 0.72272056, 'f1': 0.78956115, 'auroc': 0.9264258, 'binary_precision': 0.8731343, 'binary_recall': 0.44827586, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.5924051}
confusion matrix:
      0    1
0  5980   17
1   144  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_30.png
early stop counter: 11
val acc:0.9477969408035278, best validation acc: 0.9647190570831299, corresponding to test acc:                         0.9586129784584045 / 0.9766698479652405
after epoch: 30,now: 2024-06-26 14:13:06.286551,epoch time: 0:24:45.063618,used: 10:52:16.759030,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:52:16.759030 at 2024-06-26 14:13:06.286551
[Errno 2] No such file or directory: 'zoutput/saved_models/dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_03_20_49_seed_0_21581803.model'
this error can occur if model selection criteria                            is worsening, model never get persisted,                            no performance metric is reported
failed to remove model
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/exp/exp_main.py:128: UserWarning: failed to remove model
  warnings.warn("failed to remove model")
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 191019 KiB | 290140 KiB |    894 TiB |    894 TiB |
|       from large pool | 174400 KiB | 270353 KiB |    875 TiB |    875 TiB |
|       from small pool |  16619 KiB |  24700 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 191019 KiB | 290140 KiB |    894 TiB |    894 TiB |
|       from large pool | 174400 KiB | 270353 KiB |    875 TiB |    875 TiB |
|       from small pool |  16619 KiB |  24700 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189086 KiB | 285832 KiB |    894 TiB |    894 TiB |
|       from large pool | 172814 KiB | 268766 KiB |    875 TiB |    875 TiB |
|       from small pool |  16272 KiB |  24349 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 354304 KiB | 354304 KiB | 354304 KiB |      0 B   |
|       from large pool | 325632 KiB | 325632 KiB | 325632 KiB |      0 B   |
|       from small pool |  28672 KiB |  28672 KiB |  28672 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  34260 KiB |  63802 KiB | 513387 GiB | 513387 GiB |
|       from large pool |  30400 KiB |  55760 KiB | 494205 GiB | 494205 GiB |
|       from small pool |   3860 KiB |   9057 KiB |  19181 GiB |  19181 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1250    |    7613    |  180566 K  |  180564 K  |
|       from large pool |      76    |     113    |   88335 K  |   88335 K  |
|       from small pool |    1174    |    7536    |   92230 K  |   92229 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1250    |    7613    |  180566 K  |  180564 K  |
|       from large pool |      76    |     113    |   88335 K  |   88335 K  |
|       from small pool |    1174    |    7536    |   92230 K  |   92229 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      29    |      29    |      29    |       0    |
|       from large pool |      15    |      15    |      15    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      24    |    3580    |   96820 K  |   96820 K  |
|       from large pool |       9    |      13    |   58726 K  |   58726 K  |
|       from small pool |      15    |    3571    |   38094 K  |   38094 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 290140 KiB |    894 TiB |    894 TiB |
|       from large pool |  17088 KiB | 270353 KiB |    875 TiB |    875 TiB |
|       from small pool |      0 KiB |  24700 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 290140 KiB |    894 TiB |    894 TiB |
|       from large pool |  17088 KiB | 270353 KiB |    875 TiB |    875 TiB |
|       from small pool |      0 KiB |  24700 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 285832 KiB |    894 TiB |    894 TiB |
|       from large pool |  16640 KiB | 268766 KiB |    875 TiB |    875 TiB |
|       from small pool |      0 KiB |  24349 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 225280 KiB | 354304 KiB | 354304 KiB | 129024 KiB |
|       from large pool | 204800 KiB | 325632 KiB | 325632 KiB | 120832 KiB |
|       from small pool |  20480 KiB |  28672 KiB |  28672 KiB |   8192 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  75654 KiB | 513387 GiB | 513387 GiB |
|       from large pool |  23872 KiB |  66105 KiB | 494205 GiB | 494205 GiB |
|       from small pool |      0 KiB |  13898 KiB |  19181 GiB |  19181 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  180566 K  |  180566 K  |
|       from large pool |       2    |     113    |   88335 K  |   88335 K  |
|       from small pool |       0    |    7536    |   92230 K  |   92230 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  180566 K  |  180566 K  |
|       from large pool |       2    |     113    |   88335 K  |   88335 K  |
|       from small pool |       0    |    7536    |   92230 K  |   92230 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      29    |      29    |       9    |
|       from large pool |      10    |      15    |      15    |       5    |
|       from small pool |      10    |      14    |      14    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3580    |   96821 K  |   96821 K  |
|       from large pool |       3    |      13    |   58726 K  |   58726 K  |
|       from small pool |       0    |    3571    |   38094 K  |   38094 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 290140 KiB |    894 TiB |    894 TiB |
|       from large pool |  17088 KiB | 270353 KiB |    875 TiB |    875 TiB |
|       from small pool |      0 KiB |  24700 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 290140 KiB |    894 TiB |    894 TiB |
|       from large pool |  17088 KiB | 270353 KiB |    875 TiB |    875 TiB |
|       from small pool |      0 KiB |  24700 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 285832 KiB |    894 TiB |    894 TiB |
|       from large pool |  16640 KiB | 268766 KiB |    875 TiB |    875 TiB |
|       from small pool |      0 KiB |  24349 KiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 225280 KiB | 354304 KiB | 354304 KiB | 129024 KiB |
|       from large pool | 204800 KiB | 325632 KiB | 325632 KiB | 120832 KiB |
|       from small pool |  20480 KiB |  28672 KiB |  28672 KiB |   8192 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  75654 KiB | 513387 GiB | 513387 GiB |
|       from large pool |  23872 KiB |  66105 KiB | 494205 GiB | 494205 GiB |
|       from small pool |      0 KiB |  13898 KiB |  19181 GiB |  19181 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  180566 K  |  180566 K  |
|       from large pool |       2    |     113    |   88335 K  |   88335 K  |
|       from small pool |       0    |    7536    |   92230 K  |   92230 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  180566 K  |  180566 K  |
|       from large pool |       2    |     113    |   88335 K  |   88335 K  |
|       from small pool |       0    |    7536    |   92230 K  |   92230 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      29    |      29    |       9    |
|       from large pool |      10    |      15    |      15    |       5    |
|       from small pool |      10    |      14    |      14    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3580    |   96821 K  |   96821 K  |
|       from large pool |       3    |      13    |   58726 K  |   58726 K  |
|       from small pool |       0    |    3571    |   38094 K  |   38094 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803

 Experiment start at: 2024-06-26 14:23:05.638074
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.89866626, 'precision': 0.8931658, 'recall': 0.8301916, 'specificity': 0.8301916, 'f1': 0.85517836, 'auroc': 0.9458455, 'binary_precision': 0.884049, 'binary_recall': 0.6911979, 'binary_specificity': 0.9691854, 'binary_f1_score': 0.7758185}
confusion matrix:
       0     1
0  41108  1307
1   4452  9965
---- Validation: 
scalar performance:
{'acc': 0.9485059, 'precision': 0.63431567, 'recall': 0.6414098, 'specificity': 0.6414098, 'f1': 0.63775396, 'auroc': 0.8267883, 'binary_precision': 0.2943662, 'binary_recall': 0.31054977, 'binary_specificity': 0.9722699, 'binary_f1_score': 0.3022415}
confusion matrix:
       0    1
0  17566  501
1    464  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9531099, 'precision': 0.6889368, 'recall': 0.6261223, 'specificity': 0.6261223, 'f1': 0.6502688, 'auroc': 0.88359416, 'binary_precision': 0.4093567, 'binary_recall': 0.26923078, 'binary_specificity': 0.9830138, 'binary_f1_score': 0.324826}
confusion matrix:
      0    1
0  5845  101
1   190   70
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-26 14:47:05.148747,epoch time: 0:23:59.510673,used: 0:23:59.510673,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9252534, 'precision': 0.9312185, 'recall': 0.8681809, 'specificity': 0.8681809, 'f1': 0.8939122, 'auroc': 0.9653942, 'binary_precision': 0.94125307, 'binary_recall': 0.7523235, 'binary_specificity': 0.9840383, 'binary_f1_score': 0.83625007}
confusion matrix:
       0      1
0  41737    677
1   3571  10847
---- Validation: 
scalar performance:
{'acc': 0.9604055, 'precision': 0.70958644, 'recall': 0.6854905, 'specificity': 0.6854905, 'f1': 0.69670635, 'auroc': 0.856727, 'binary_precision': 0.44182125, 'binary_recall': 0.38930163, 'binary_specificity': 0.9816793, 'binary_f1_score': 0.41390204}
confusion matrix:
       0    1
0  17736  331
1    411  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.7959702, 'recall': 0.7076593, 'specificity': 0.7076593, 'f1': 0.7431682, 'auroc': 0.9074795, 'binary_precision': 0.6166667, 'binary_recall': 0.42692307, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.50454545}
confusion matrix:
      0    1
0  5877   69
1   149  111
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-26 15:17:04.409010,epoch time: 0:29:59.260263,used: 0:53:58.770936,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.931711, 'precision': 0.9372638, 'recall': 0.87980175, 'specificity': 0.87980175, 'f1': 0.9037874, 'auroc': 0.9708512, 'binary_precision': 0.9467571, 'binary_recall': 0.77441055, 'binary_specificity': 0.9851929, 'binary_f1_score': 0.851955}
confusion matrix:
       0      1
0  41784    628
1   3253  11167
---- Validation: 
scalar performance:
{'acc': 0.9614194, 'precision': 0.7186698, 'recall': 0.6988911, 'specificity': 0.6988911, 'f1': 0.70825154, 'auroc': 0.86785954, 'binary_precision': 0.45901638, 'binary_recall': 0.41604754, 'binary_specificity': 0.98173463, 'binary_f1_score': 0.43647704}
confusion matrix:
       0    1
0  17737  330
1    393  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661618, 'precision': 0.8047745, 'recall': 0.7230439, 'specificity': 0.7230439, 'f1': 0.7568487, 'auroc': 0.9129286, 'binary_precision': 0.63297874, 'binary_recall': 0.4576923, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.53124994}
confusion matrix:
      0    1
0  5877   69
1   141  119
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-26 15:48:32.528952,epoch time: 0:31:28.119942,used: 1:25:26.890878,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9358284, 'precision': 0.9402045, 'recall': 0.8879155, 'specificity': 0.8879155, 'f1': 0.9101479, 'auroc': 0.97268724, 'binary_precision': 0.9477928, 'binary_recall': 0.790638, 'binary_specificity': 0.9851929, 'binary_f1_score': 0.862112}
confusion matrix:
       0      1
0  41784    628
1   3019  11401
---- Validation: 
scalar performance:
{'acc': 0.9607791, 'precision': 0.7145521, 'recall': 0.7007048, 'specificity': 0.7007048, 'f1': 0.7073671, 'auroc': 0.86991626, 'binary_precision': 0.45063695, 'binary_recall': 0.4205052, 'binary_specificity': 0.9809044, 'binary_f1_score': 0.43504995}
confusion matrix:
       0    1
0  17722  345
1    390  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.79289055, 'recall': 0.74293643, 'specificity': 0.74293643, 'f1': 0.7652986, 'auroc': 0.91362643, 'binary_precision': 0.60747665, 'binary_recall': 0.5, 'binary_specificity': 0.98587286, 'binary_f1_score': 0.5485232}
confusion matrix:
      0    1
0  5862   84
1   130  130
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_4.png
early stop counter: 1
val acc:0.960779070854187, best validation acc: 0.961419403553009, corresponding to test acc:                         0.9661617875099182 / 0.9661617875099182
after epoch: 4,now: 2024-06-26 16:10:15.856352,epoch time: 0:21:43.327400,used: 1:47:10.218278,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93523014, 'precision': 0.9398323, 'recall': 0.88669074, 'specificity': 0.88669074, 'f1': 0.9092193, 'auroc': 0.97286975, 'binary_precision': 0.9477942, 'binary_recall': 0.7881415, 'binary_specificity': 0.98524004, 'binary_f1_score': 0.8606263}
confusion matrix:
       0      1
0  41786    626
1   3055  11365
---- Validation: 
scalar performance:
{'acc': 0.95939165, 'precision': 0.70696515, 'recall': 0.7078532, 'specificity': 0.7078532, 'f1': 0.70740813, 'auroc': 0.8694179, 'binary_precision': 0.43491125, 'binary_recall': 0.43684992, 'binary_specificity': 0.9788565, 'binary_f1_score': 0.43587843}
confusion matrix:
       0    1
0  17685  382
1    379  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.7836951, 'recall': 0.75538886, 'specificity': 0.75538886, 'f1': 0.76870346, 'auroc': 0.9121419, 'binary_precision': 0.58798283, 'binary_recall': 0.52692306, 'binary_specificity': 0.9838547, 'binary_f1_score': 0.55578095}
confusion matrix:
      0    1
0  5850   96
1   123  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_5.png
early stop counter: 2
val acc:0.9593916535377502, best validation acc: 0.961419403553009, corresponding to test acc:                         0.9661617875099182 / 0.9661617875099182
after epoch: 5,now: 2024-06-26 16:34:04.079490,epoch time: 0:23:48.223138,used: 2:10:58.441416,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9223677, 'precision': 0.9358082, 'recall': 0.8576138, 'specificity': 0.8576138, 'f1': 0.8880119, 'auroc': 0.9675969, 'binary_precision': 0.957655, 'binary_recall': 0.72614425, 'binary_specificity': 0.9890833, 'binary_f1_score': 0.8259841}
confusion matrix:
       0      1
0  41949    463
1   3949  10471
---- Validation: 
scalar performance:
{'acc': 0.9614194, 'precision': 0.7133399, 'recall': 0.6631277, 'specificity': 0.6631277, 'f1': 0.6844615, 'auroc': 0.8569734, 'binary_precision': 0.4509804, 'binary_recall': 0.34175333, 'binary_specificity': 0.98450214, 'binary_f1_score': 0.38884193}
confusion matrix:
       0    1
0  17787  280
1    443  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9666452, 'precision': 0.81692207, 'recall': 0.7067453, 'specificity': 0.7067453, 'f1': 0.7489754, 'auroc': 0.9043901, 'binary_precision': 0.65868264, 'binary_recall': 0.42307693, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.5152225}
confusion matrix:
      0    1
0  5889   57
1   150  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_6.png
new oracle model saved
early stop counter: 3
val acc:0.961419403553009, best validation acc: 0.961419403553009, corresponding to test acc:                         0.9661617875099182 / 0.9666451811790466
after epoch: 6,now: 2024-06-26 16:54:42.087967,epoch time: 0:20:38.008477,used: 2:31:36.449893,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.90888935, 'precision': 0.93087673, 'recall': 0.8284788, 'specificity': 0.8284788, 'f1': 0.86473644, 'auroc': 0.96346116, 'binary_precision': 0.9646988, 'binary_recall': 0.6652334, 'binary_specificity': 0.99172425, 'binary_f1_score': 0.7874559}
confusion matrix:
       0     1
0  42062   351
1   4827  9592
---- Validation: 
scalar performance:
{'acc': 0.96109927, 'precision': 0.69902116, 'recall': 0.61360824, 'specificity': 0.61360824, 'f1': 0.6431817, 'auroc': 0.8454553, 'binary_precision': 0.42592594, 'binary_recall': 0.23922734, 'binary_specificity': 0.9879891, 'binary_f1_score': 0.30637488}
confusion matrix:
       0    1
0  17850  217
1    512  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.7949097, 'recall': 0.6347616, 'specificity': 0.6347616, 'f1': 0.6818516, 'auroc': 0.8961868, 'binary_precision': 0.62068963, 'binary_recall': 0.2769231, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.38297874}
confusion matrix:
      0   1
0  5902  44
1   188  72
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_7.png
early stop counter: 4
val acc:0.9610992670059204, best validation acc: 0.961419403553009, corresponding to test acc:                         0.9661617875099182 / 0.9666451811790466
after epoch: 7,now: 2024-06-26 17:19:02.893987,epoch time: 0:24:20.806020,used: 2:55:57.255913,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8928245, 'precision': 0.92555046, 'recall': 0.7942469, 'specificity': 0.7942469, 'f1': 0.8351951, 'auroc': 0.9599198, 'binary_precision': 0.9729699, 'binary_recall': 0.5941054, 'binary_specificity': 0.9943884, 'binary_f1_score': 0.7377395}
confusion matrix:
       0     1
0  42174   238
1   5853  8567
---- Validation: 
scalar performance:
{'acc': 0.9615795, 'precision': 0.68774563, 'recall': 0.5716565, 'specificity': 0.5716565, 'f1': 0.6005417, 'auroc': 0.8377803, 'binary_precision': 0.4063745, 'binary_recall': 0.15156017, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.22077921}
confusion matrix:
       0    1
0  17918  149
1    571  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96100545, 'precision': 0.7966847, 'recall': 0.58242905, 'specificity': 0.58242905, 'f1': 0.62331843, 'auroc': 0.8891483, 'binary_precision': 0.62857145, 'binary_recall': 0.16923077, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.26666668}
confusion matrix:
      0   1
0  5920  26
1   216  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_8.png
better model found
persisted
after epoch: 8,now: 2024-06-26 17:39:56.553041,epoch time: 0:20:53.659054,used: 3:16:50.914967,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8737331, 'precision': 0.92187977, 'recall': 0.75335884, 'specificity': 0.75335884, 'f1': 0.79673874, 'auroc': 0.9580004, 'binary_precision': 0.9870881, 'binary_recall': 0.5089812, 'binary_specificity': 0.9977365, 'binary_f1_score': 0.671639}
confusion matrix:
       0     1
0  42317    96
1   7080  7339
---- Validation: 
scalar performance:
{'acc': 0.9627535, 'precision': 0.64699996, 'recall': 0.51647455, 'specificity': 0.51647455, 'f1': 0.52267087, 'auroc': 0.82640743, 'binary_precision': 0.32876712, 'binary_recall': 0.035661217, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.06434316}
confusion matrix:
       0   1
0  18018  49
1    649  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7417754, 'recall': 0.52031296, 'specificity': 0.52031296, 'f1': 0.52847075, 'auroc': 0.88089097, 'binary_precision': 0.52380955, 'binary_recall': 0.042307694, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.07829182}
confusion matrix:
      0   1
0  5936  10
1   249  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_9.png
better model found
persisted
after epoch: 9,now: 2024-06-26 18:00:16.346008,epoch time: 0:20:19.792967,used: 3:37:10.707934,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.85743946, 'precision': 0.91772664, 'recall': 0.719715, 'specificity': 0.719715, 'f1': 0.761564, 'auroc': 0.95954657, 'binary_precision': 0.995451, 'binary_recall': 0.44011375, 'binary_specificity': 0.9993163, 'binary_f1_score': 0.6103684}
confusion matrix:
       0     1
0  42384    29
1   8073  6346
---- Validation: 
scalar performance:
{'acc': 0.9635539, 'precision': 0.61854655, 'recall': 0.50401485, 'specificity': 0.50401485, 'f1': 0.49934942, 'auroc': 0.82514775, 'binary_precision': 0.27272728, 'binary_recall': 0.008915304, 'binary_specificity': 0.9991144, 'binary_f1_score': 0.017266186}
confusion matrix:
       0   1
0  18051  16
1    667   6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.7066916, 'recall': 0.5091108, 'specificity': 0.5091108, 'f1': 0.50770146, 'auroc': 0.880622, 'binary_precision': 0.45454547, 'binary_recall': 0.01923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.03690037}
confusion matrix:
      0  1
0  5940  6
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_10.png
better model found
persisted
after epoch: 10,now: 2024-06-26 18:19:28.491113,epoch time: 0:19:12.145105,used: 3:56:22.853039,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.87642527, 'precision': 0.9268195, 'recall': 0.75729114, 'specificity': 0.75729114, 'f1': 0.8013011, 'auroc': 0.96559983, 'binary_precision': 0.9951794, 'binary_recall': 0.51543105, 'binary_specificity': 0.99915123, 'binary_f1_score': 0.6791246}
confusion matrix:
       0     1
0  42377    36
1   6987  7432
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.59978133, 'recall': 0.502612, 'specificity': 0.502612, 'f1': 0.49652827, 'auroc': 0.8288419, 'binary_precision': 0.23529412, 'binary_recall': 0.0059435363, 'binary_specificity': 0.99928045, 'binary_f1_score': 0.011594202}
confusion matrix:
       0   1
0  18054  13
1    669   4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7522269, 'recall': 0.511118, 'specificity': 0.511118, 'f1': 0.5114739, 'auroc': 0.88535225, 'binary_precision': 0.54545456, 'binary_recall': 0.023076924, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.04428044}
confusion matrix:
      0  1
0  5941  5
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_11.png
better model found
persisted
after epoch: 11,now: 2024-06-26 18:40:40.169012,epoch time: 0:21:11.677899,used: 4:17:34.530938,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.93676096, 'precision': 0.9430185, 'recall': 0.88798386, 'specificity': 0.88798386, 'f1': 0.9112123, 'auroc': 0.9718641, 'binary_precision': 0.9538023, 'binary_recall': 0.788959, 'binary_specificity': 0.9870087, 'binary_f1_score': 0.8635846}
confusion matrix:
       0      1
0  41862    551
1   3043  11376
---- Validation: 
scalar performance:
{'acc': 0.96093917, 'precision': 0.69953024, 'recall': 0.6206779, 'specificity': 0.6206779, 'f1': 0.64916456, 'auroc': 0.8385285, 'binary_precision': 0.42643392, 'binary_recall': 0.25408617, 'binary_specificity': 0.9872696, 'binary_f1_score': 0.31843576}
confusion matrix:
       0    1
0  17837  230
1    502  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96745086, 'precision': 0.829206, 'recall': 0.7034878, 'specificity': 0.7034878, 'f1': 0.7499523, 'auroc': 0.89580584, 'binary_precision': 0.6835443, 'binary_recall': 0.41538462, 'binary_specificity': 0.991591, 'binary_f1_score': 0.5167464}
confusion matrix:
      0    1
0  5896   50
1   152  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_12.png
new oracle model saved
early stop counter: 1
val acc:0.9609391689300537, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 12,now: 2024-06-26 19:01:31.647523,epoch time: 0:20:51.478511,used: 4:38:26.009449,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.945682, 'precision': 0.93833846, 'recall': 0.9160292, 'specificity': 0.9160292, 'f1': 0.92644686, 'auroc': 0.97073996, 'binary_precision': 0.9244887, 'binary_recall': 0.85582525, 'binary_specificity': 0.9762331, 'binary_f1_score': 0.8888329}
confusion matrix:
       0      1
0  41404   1008
1   2079  12341
---- Validation: 
scalar performance:
{'acc': 0.9565635, 'precision': 0.6804421, 'recall': 0.66490096, 'specificity': 0.66490096, 'f1': 0.6722698, 'auroc': 0.80470026, 'binary_precision': 0.38499185, 'binary_recall': 0.35066864, 'binary_specificity': 0.97913325, 'binary_f1_score': 0.36702955}
confusion matrix:
       0    1
0  17690  377
1    437  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.78627235, 'recall': 0.7704371, 'specificity': 0.7704371, 'f1': 0.77810043, 'auroc': 0.88866043, 'binary_precision': 0.59183675, 'binary_recall': 0.5576923, 'binary_specificity': 0.98318195, 'binary_f1_score': 0.5742575}
confusion matrix:
      0    1
0  5846  100
1   115  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_13.png
early stop counter: 2
val acc:0.9565634727478027, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 13,now: 2024-06-26 19:20:10.630237,epoch time: 0:18:38.982714,used: 4:57:04.992163,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9466498, 'precision': 0.94199, 'recall': 0.91490555, 'specificity': 0.91490555, 'f1': 0.927379, 'auroc': 0.97184646, 'binary_precision': 0.9333232, 'binary_recall': 0.8504647, 'binary_specificity': 0.97934645, 'binary_f1_score': 0.8899695}
confusion matrix:
       0      1
0  41538    876
1   2156  12262
---- Validation: 
scalar performance:
{'acc': 0.95715046, 'precision': 0.6730271, 'recall': 0.63230306, 'specificity': 0.63230306, 'f1': 0.6495471, 'auroc': 0.7954806, 'binary_precision': 0.37254903, 'binary_recall': 0.28231797, 'binary_specificity': 0.9822881, 'binary_f1_score': 0.32121724}
confusion matrix:
       0    1
0  17747  320
1    483  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9663229, 'precision': 0.7956383, 'recall': 0.76174676, 'specificity': 0.76174676, 'f1': 0.777534, 'auroc': 0.8864385, 'binary_precision': 0.6113537, 'binary_recall': 0.53846157, 'binary_specificity': 0.98503196, 'binary_f1_score': 0.5725971}
confusion matrix:
      0    1
0  5857   89
1   120  140
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_14.png
early stop counter: 3
val acc:0.9571504592895508, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 14,now: 2024-06-26 19:39:01.158225,epoch time: 0:18:50.527988,used: 5:15:55.520151,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.94307786, 'precision': 0.9387849, 'recall': 0.90835184, 'specificity': 0.90835184, 'f1': 0.92221075, 'auroc': 0.9689795, 'binary_precision': 0.93088305, 'binary_recall': 0.83785284, 'binary_specificity': 0.97885084, 'binary_f1_score': 0.88192135}
confusion matrix:
       0      1
0  41516    897
1   2338  12081
---- Validation: 
scalar performance:
{'acc': 0.95624334, 'precision': 0.65763056, 'recall': 0.6110898, 'specificity': 0.6110898, 'f1': 0.6296978, 'auroc': 0.77885866, 'binary_precision': 0.3432836, 'binary_recall': 0.23922734, 'binary_specificity': 0.98295236, 'binary_f1_score': 0.28196147}
confusion matrix:
       0    1
0  17759  308
1    512  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.7953104, 'recall': 0.7449436, 'specificity': 0.7449436, 'f1': 0.76749206, 'auroc': 0.8833035, 'binary_precision': 0.61214954, 'binary_recall': 0.50384617, 'binary_specificity': 0.986041, 'binary_f1_score': 0.55274266}
confusion matrix:
      0    1
0  5863   83
1   129  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_15.png
early stop counter: 4
val acc:0.9562433362007141, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 15,now: 2024-06-26 19:58:53.546927,epoch time: 0:19:52.388702,used: 5:35:47.908853,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.94388723, 'precision': 0.9375447, 'recall': 0.91185164, 'specificity': 0.91185164, 'f1': 0.923722, 'auroc': 0.9689648, 'binary_precision': 0.9257069, 'binary_recall': 0.84681, 'binary_specificity': 0.9768933, 'binary_f1_score': 0.88450253}
confusion matrix:
       0      1
0  41432    980
1   2209  12211
---- Validation: 
scalar performance:
{'acc': 0.95506936, 'precision': 0.651406, 'recall': 0.61334205, 'specificity': 0.61334205, 'f1': 0.6291898, 'auroc': 0.7774352, 'binary_precision': 0.33066133, 'binary_recall': 0.24517088, 'binary_specificity': 0.98151326, 'binary_f1_score': 0.28157}
confusion matrix:
       0    1
0  17733  334
1    508  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9656784, 'precision': 0.79185605, 'recall': 0.7540544, 'specificity': 0.7540544, 'f1': 0.77148306, 'auroc': 0.88327384, 'binary_precision': 0.60444444, 'binary_recall': 0.52307695, 'binary_specificity': 0.98503196, 'binary_f1_score': 0.56082475}
confusion matrix:
      0    1
0  5857   89
1   124  136
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_16.png
early stop counter: 5
val acc:0.955069363117218, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 16,now: 2024-06-26 20:21:40.289554,epoch time: 0:22:46.742627,used: 5:58:34.651480,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9425852, 'precision': 0.936286, 'recall': 0.9095323, 'specificity': 0.9095323, 'f1': 0.92184806, 'auroc': 0.9687011, 'binary_precision': 0.92456996, 'binary_recall': 0.8424301, 'binary_specificity': 0.9766345, 'binary_f1_score': 0.8815909}
confusion matrix:
       0      1
0  41422    991
1   2272  12147
---- Validation: 
scalar performance:
{'acc': 0.9545357, 'precision': 0.6446943, 'recall': 0.6066279, 'specificity': 0.6066279, 'f1': 0.62229025, 'auroc': 0.7722379, 'binary_precision': 0.31771895, 'binary_recall': 0.23179792, 'binary_specificity': 0.9814579, 'binary_f1_score': 0.26804125}
confusion matrix:
       0    1
0  17732  335
1    517  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.7855976, 'recall': 0.751795, 'specificity': 0.751795, 'f1': 0.76749814, 'auroc': 0.88190347, 'binary_precision': 0.59210527, 'binary_recall': 0.5192308, 'binary_specificity': 0.9843592, 'binary_f1_score': 0.55327874}
confusion matrix:
      0    1
0  5853   93
1   125  135
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_17.png
early stop counter: 6
val acc:0.954535722732544, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 17,now: 2024-06-26 20:40:07.107960,epoch time: 0:18:26.818406,used: 6:17:01.469886,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.94307786, 'precision': 0.9385761, 'recall': 0.90855247, 'specificity': 0.90855247, 'f1': 0.92224175, 'auroc': 0.9679477, 'binary_precision': 0.93028086, 'binary_recall': 0.8384658, 'binary_specificity': 0.9786391, 'binary_f1_score': 0.8819903}
confusion matrix:
       0      1
0  41508    906
1   2329  12089
---- Validation: 
scalar performance:
{'acc': 0.95384204, 'precision': 0.64098895, 'recall': 0.6069834, 'specificity': 0.6069834, 'f1': 0.62124944, 'auroc': 0.77210176, 'binary_precision': 0.3102767, 'binary_recall': 0.2332838, 'binary_specificity': 0.980683, 'binary_f1_score': 0.26632738}
confusion matrix:
       0    1
0  17718  349
1    516  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.78118956, 'recall': 0.75522065, 'specificity': 0.75522065, 'f1': 0.76749516, 'auroc': 0.8819219, 'binary_precision': 0.5829787, 'binary_recall': 0.52692306, 'binary_specificity': 0.9835183, 'binary_f1_score': 0.55353534}
confusion matrix:
      0    1
0  5848   98
1   123  137
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_18.png
early stop counter: 7
val acc:0.953842043876648, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 18,now: 2024-06-26 20:58:21.938484,epoch time: 0:18:14.830524,used: 6:35:16.300410,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.94140625, 'precision': 0.94374883, 'recall': 0.89929616, 'specificity': 0.89929616, 'f1': 0.9187052, 'auroc': 0.9670012, 'binary_precision': 0.9478998, 'binary_recall': 0.8138003, 'binary_specificity': 0.98479205, 'binary_f1_score': 0.8757462}
confusion matrix:
       0      1
0  41767    645
1   2685  11735
---- Validation: 
scalar performance:
{'acc': 0.95688367, 'precision': 0.639054, 'recall': 0.57422805, 'specificity': 0.57422805, 'f1': 0.59515536, 'auroc': 0.7534293, 'binary_precision': 0.30878186, 'binary_recall': 0.16196136, 'binary_specificity': 0.9864947, 'binary_f1_score': 0.21247561}
confusion matrix:
       0    1
0  17823  244
1    564  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.79194236, 'recall': 0.70372903, 'specificity': 0.70372903, 'f1': 0.7390624, 'auroc': 0.87877536, 'binary_precision': 0.6089386, 'binary_recall': 0.41923076, 'binary_specificity': 0.98822737, 'binary_f1_score': 0.4965831}
confusion matrix:
      0    1
0  5876   70
1   151  109
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_19.png
early stop counter: 8
val acc:0.9568836688995361, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 19,now: 2024-06-26 21:16:31.460794,epoch time: 0:18:09.522310,used: 6:53:25.822720,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.94175816, 'precision': 0.9435843, 'recall': 0.9003558, 'specificity': 0.9003558, 'f1': 0.9193016, 'auroc': 0.96675766, 'binary_precision': 0.94683075, 'binary_recall': 0.8162968, 'binary_specificity': 0.9844148, 'binary_f1_score': 0.8767317}
confusion matrix:
       0      1
0  41751    661
1   2649  11771
---- Validation: 
scalar performance:
{'acc': 0.9567236, 'precision': 0.63887835, 'recall': 0.57557553, 'specificity': 0.57557553, 'f1': 0.59632826, 'auroc': 0.75773454, 'binary_precision': 0.30833334, 'binary_recall': 0.16493313, 'binary_specificity': 0.986218, 'binary_f1_score': 0.21490802}
confusion matrix:
       0    1
0  17818  249
1    562  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.79432535, 'recall': 0.71317625, 'specificity': 0.71317625, 'f1': 0.7464962, 'auroc': 0.87907875, 'binary_precision': 0.61290324, 'binary_recall': 0.43846154, 'binary_specificity': 0.987891, 'binary_f1_score': 0.51121074}
confusion matrix:
      0    1
0  5874   72
1   146  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_20.png
early stop counter: 9
val acc:0.9567235708236694, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 20,now: 2024-06-26 21:38:06.895467,epoch time: 0:21:35.434673,used: 7:15:01.257393,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.94126546, 'precision': 0.9439098, 'recall': 0.89878356, 'specificity': 0.89878356, 'f1': 0.9184468, 'auroc': 0.96681666, 'binary_precision': 0.9485872, 'binary_recall': 0.812539, 'binary_specificity': 0.98502815, 'binary_f1_score': 0.87530816}
confusion matrix:
       0      1
0  41778    635
1   2703  11716
---- Validation: 
scalar performance:
{'acc': 0.9576841, 'precision': 0.6388285, 'recall': 0.56605995, 'specificity': 0.56605995, 'f1': 0.5874125, 'auroc': 0.7385453, 'binary_precision': 0.3089172, 'binary_recall': 0.14413075, 'binary_specificity': 0.9879891, 'binary_f1_score': 0.19655523}
confusion matrix:
       0    1
0  17850  217
1    576   97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.8104266, 'recall': 0.6989689, 'specificity': 0.6989689, 'f1': 0.7411578, 'auroc': 0.8756113, 'binary_precision': 0.64634144, 'binary_recall': 0.4076923, 'binary_specificity': 0.9902455, 'binary_f1_score': 0.5}
confusion matrix:
      0    1
0  5888   58
1   154  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_21.png
early stop counter: 10
val acc:0.9576840996742249, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 21,now: 2024-06-26 21:57:41.721124,epoch time: 0:19:34.825657,used: 7:34:36.083050,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9377111, 'precision': 0.9461633, 'recall': 0.88789535, 'specificity': 0.88789535, 'f1': 0.91227615, 'auroc': 0.96266294, 'binary_precision': 0.9606266, 'binary_recall': 0.7867545, 'binary_specificity': 0.98903614, 'binary_f1_score': 0.86504006}
confusion matrix:
       0      1
0  41947    465
1   3075  11345
---- Validation: 
scalar performance:
{'acc': 0.95971185, 'precision': 0.6387354, 'recall': 0.5456536, 'specificity': 0.5456536, 'f1': 0.5650488, 'auroc': 0.715165, 'binary_precision': 0.3101852, 'binary_recall': 0.09955423, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.15073116}
confusion matrix:
       0    1
0  17918  149
1    606   67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.8164506, 'recall': 0.66168463, 'specificity': 0.66168463, 'f1': 0.7114461, 'auroc': 0.87169784, 'binary_precision': 0.6615385, 'binary_recall': 0.33076924, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.44102564}
confusion matrix:
      0   1
0  5902  44
1   174  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_22.png
early stop counter: 11
val acc:0.9597118496894836, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 22,now: 2024-06-26 22:17:07.955015,epoch time: 0:19:26.233891,used: 7:54:02.316941,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9383974, 'precision': 0.94895756, 'recall': 0.8874552, 'specificity': 0.8874552, 'f1': 0.91296566, 'auroc': 0.9628355, 'binary_precision': 0.96690047, 'binary_recall': 0.78403497, 'binary_specificity': 0.9908754, 'binary_f1_score': 0.8659186}
confusion matrix:
       0      1
0  42026    387
1   3114  11305
---- Validation: 
scalar performance:
{'acc': 0.9593383, 'precision': 0.6356695, 'recall': 0.5468904, 'specificity': 0.5468904, 'f1': 0.56625116, 'auroc': 0.71999764, 'binary_precision': 0.30396476, 'binary_recall': 0.102526, 'binary_specificity': 0.99125475, 'binary_f1_score': 0.15333334}
confusion matrix:
       0    1
0  17909  158
1    604   69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.81687903, 'recall': 0.66920877, 'specificity': 0.66920877, 'f1': 0.71828467, 'auroc': 0.8728635, 'binary_precision': 0.6617647, 'binary_recall': 0.34615386, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.4545454}
confusion matrix:
      0   1
0  5900  46
1   170  90
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_23.png
early stop counter: 12
val acc:0.9593383073806763, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 23,now: 2024-06-26 22:35:17.927461,epoch time: 0:18:09.972446,used: 8:12:12.289387,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.93866134, 'precision': 0.950482, 'recall': 0.88696826, 'specificity': 0.88696826, 'f1': 0.913168, 'auroc': 0.9622205, 'binary_precision': 0.97047937, 'binary_recall': 0.7820237, 'binary_specificity': 0.99191284, 'binary_f1_score': 0.8661187}
confusion matrix:
       0      1
0  42070    343
1   3143  11276
---- Validation: 
scalar performance:
{'acc': 0.9593383, 'precision': 0.6407425, 'recall': 0.551182, 'specificity': 0.551182, 'f1': 0.5718179, 'auroc': 0.7264775, 'binary_precision': 0.31380752, 'binary_recall': 0.11144131, 'binary_specificity': 0.9909227, 'binary_f1_score': 0.16447367}
confusion matrix:
       0    1
0  17903  164
1    598   75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.81729853, 'recall': 0.6767329, 'specificity': 0.6767329, 'f1': 0.72492164, 'auroc': 0.87327003, 'binary_precision': 0.6619718, 'binary_recall': 0.36153847, 'binary_specificity': 0.9919273, 'binary_f1_score': 0.46766174}
confusion matrix:
      0   1
0  5898  48
1   166  94
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_24.png
early stop counter: 13
val acc:0.9593383073806763, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 24,now: 2024-06-26 22:53:38.686026,epoch time: 0:18:20.758565,used: 8:30:33.047952,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.94006896, 'precision': 0.9504032, 'recall': 0.89049053, 'specificity': 0.89049053, 'f1': 0.9154885, 'auroc': 0.9638922, 'binary_precision': 0.9680381, 'binary_recall': 0.789846, 'binary_specificity': 0.991135, 'binary_f1_score': 0.8699106}
confusion matrix:
       0      1
0  42038    376
1   3030  11388
---- Validation: 
scalar performance:
{'acc': 0.9586446, 'precision': 0.6457419, 'recall': 0.56369704, 'specificity': 0.56369704, 'f1': 0.5861633, 'auroc': 0.7421206, 'binary_precision': 0.32291666, 'binary_recall': 0.13818721, 'binary_specificity': 0.98920685, 'binary_f1_score': 0.19354838}
confusion matrix:
       0    1
0  17872  195
1    580   93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9655172, 'precision': 0.8065288, 'recall': 0.69880074, 'specificity': 0.69880074, 'f1': 0.7398992, 'auroc': 0.87428975, 'binary_precision': 0.6385542, 'binary_recall': 0.4076923, 'binary_specificity': 0.9899092, 'binary_f1_score': 0.49765262}
confusion matrix:
      0    1
0  5886   60
1   154  106
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_25.png
early stop counter: 14
val acc:0.9586446285247803, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 25,now: 2024-06-26 23:11:46.995670,epoch time: 0:18:08.309644,used: 8:48:41.357596,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9354413, 'precision': 0.9517838, 'recall': 0.87821114, 'specificity': 0.87821114, 'f1': 0.9076184, 'auroc': 0.96321285, 'binary_precision': 0.9787973, 'binary_recall': 0.7620336, 'binary_specificity': 0.99438864, 'binary_f1_score': 0.85692}
confusion matrix:
       0      1
0  42176    238
1   3431  10987
---- Validation: 
scalar performance:
{'acc': 0.9605656, 'precision': 0.6494229, 'recall': 0.5446658, 'specificity': 0.5446658, 'f1': 0.56470597, 'auroc': 0.7337112, 'binary_precision': 0.33163264, 'binary_recall': 0.096582465, 'binary_specificity': 0.9927492, 'binary_f1_score': 0.14959723}
confusion matrix:
       0    1
0  17936  131
1    608   65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.821437, 'recall': 0.6543287, 'specificity': 0.6543287, 'f1': 0.705599, 'auroc': 0.87254196, 'binary_precision': 0.6721311, 'binary_recall': 0.31538463, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.42931938}
confusion matrix:
      0   1
0  5906  40
1   178  82
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_26.png
early stop counter: 15
val acc:0.9605656266212463, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 26,now: 2024-06-26 23:29:41.867928,epoch time: 0:17:54.872258,used: 9:06:36.229854,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.93823904, 'precision': 0.95361495, 'recall': 0.8836793, 'specificity': 0.8836793, 'f1': 0.91199785, 'auroc': 0.96446145, 'binary_precision': 0.9792619, 'binary_recall': 0.77292275, 'binary_specificity': 0.9944358, 'binary_f1_score': 0.863943}
confusion matrix:
       0      1
0  42178    236
1   3274  11144
---- Validation: 
scalar performance:
{'acc': 0.96045893, 'precision': 0.65200007, 'recall': 0.54818684, 'specificity': 0.54818684, 'f1': 0.56933194, 'auroc': 0.74542284, 'binary_precision': 0.33653846, 'binary_recall': 0.104011886, 'binary_specificity': 0.9923618, 'binary_f1_score': 0.15891033}
confusion matrix:
       0    1
0  17929  138
1    603   70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.8164506, 'recall': 0.66168463, 'specificity': 0.66168463, 'f1': 0.7114461, 'auroc': 0.87255526, 'binary_precision': 0.6615385, 'binary_recall': 0.33076924, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.44102564}
confusion matrix:
      0   1
0  5902  44
1   174  86
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_27.png
early stop counter: 16
val acc:0.9604589343070984, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 27,now: 2024-06-26 23:47:28.788436,epoch time: 0:17:46.920508,used: 9:24:23.150362,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9396819, 'precision': 0.9527397, 'recall': 0.8878048, 'specificity': 0.8878048, 'f1': 0.9145065, 'auroc': 0.96551645, 'binary_precision': 0.974771, 'binary_recall': 0.7824941, 'binary_specificity': 0.9931155, 'binary_f1_score': 0.8681133}
confusion matrix:
       0      1
0  42122    292
1   3136  11282
---- Validation: 
scalar performance:
{'acc': 0.9600854, 'precision': 0.649745, 'recall': 0.55085415, 'specificity': 0.55085415, 'f1': 0.57236624, 'auroc': 0.7421118, 'binary_precision': 0.33183858, 'binary_recall': 0.10995542, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.16517858}
confusion matrix:
       0    1
0  17918  149
1    599   74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653561, 'precision': 0.81819355, 'recall': 0.67113185, 'specificity': 0.67113185, 'f1': 0.720272, 'auroc': 0.87231684, 'binary_precision': 0.66423357, 'binary_recall': 0.35, 'binary_specificity': 0.99226373, 'binary_f1_score': 0.45843828}
confusion matrix:
      0   1
0  5900  46
1   169  91
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_28.png
early stop counter: 17
val acc:0.960085391998291, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 28,now: 2024-06-27 00:05:21.670793,epoch time: 0:17:52.882357,used: 9:42:16.032719,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.93966424, 'precision': 0.9546462, 'recall': 0.8864043, 'specificity': 0.8864043, 'f1': 0.9142047, 'auroc': 0.96543735, 'binary_precision': 0.9797451, 'binary_recall': 0.77827865, 'binary_specificity': 0.99452996, 'binary_f1_score': 0.86746806}
confusion matrix:
       0      1
0  42181    232
1   3197  11222
---- Validation: 
scalar performance:
{'acc': 0.9605123, 'precision': 0.65116894, 'recall': 0.546784, 'specificity': 0.546784, 'f1': 0.5675174, 'auroc': 0.7475312, 'binary_precision': 0.33497536, 'binary_recall': 0.10104012, 'binary_specificity': 0.99252784, 'binary_f1_score': 0.15525113}
confusion matrix:
       0    1
0  17932  135
1    605   68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.8202518, 'recall': 0.65992975, 'specificity': 0.65992975, 'f1': 0.7106154, 'auroc': 0.87228715, 'binary_precision': 0.6692913, 'binary_recall': 0.32692307, 'binary_specificity': 0.99293643, 'binary_f1_score': 0.4392765}
confusion matrix:
      0   1
0  5904  42
1   175  85
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_29.png
early stop counter: 18
val acc:0.9605122804641724, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 29,now: 2024-06-27 00:23:22.264491,epoch time: 0:18:00.593698,used: 10:00:16.626417,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9368666, 'precision': 0.9545213, 'recall': 0.87976927, 'specificity': 0.87976927, 'f1': 0.90959036, 'auroc': 0.96577734, 'binary_precision': 0.98365635, 'binary_recall': 0.76385325, 'binary_specificity': 0.9956853, 'binary_f1_score': 0.85993135}
confusion matrix:
       0      1
0  42230    183
1   3405  11014
---- Validation: 
scalar performance:
{'acc': 0.9613127, 'precision': 0.6465501, 'recall': 0.533609, 'specificity': 0.533609, 'f1': 0.5496493, 'auroc': 0.73853326, 'binary_precision': 0.32666665, 'binary_recall': 0.07280832, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.119076535}
confusion matrix:
       0    1
0  17966  101
1    624   49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.82427776, 'recall': 0.62807834, 'specificity': 0.62807834, 'f1': 0.6795958, 'auroc': 0.8703275, 'binary_precision': 0.68, 'binary_recall': 0.26153848, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.3777778}
confusion matrix:
      0   1
0  5914  32
1   192  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21581803_30.png
early stop counter: 19
val acc:0.9613127112388611, best validation acc: 0.9636072516441345, corresponding to test acc:                         0.9582661986351013 / 0.9674508571624756
after epoch: 30,now: 2024-06-27 00:41:32.912593,epoch time: 0:18:10.648102,used: 10:18:27.274519,model: dset_te_center0_dann_b44271c83_not_commited_2024md_06md_26_14_23_05_seed_1_21581803
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:18:27.274519 at 2024-06-27 00:41:32.912593
persisted model performance metric: 

scalar performance:
{'acc': 0.9582662, 'precision': 0.7522269, 'recall': 0.511118, 'specificity': 0.511118, 'f1': 0.5114739, 'auroc': 0.88535225, 'binary_precision': 0.54545456, 'binary_recall': 0.023076924, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.04428044}
confusion matrix:
      0  1
0  5941  5
1   254  6
oracle model performance metric: 

scalar performance:
{'acc': 0.96745086, 'precision': 0.829206, 'recall': 0.7034878, 'specificity': 0.7034878, 'f1': 0.7499523, 'auroc': 0.89580584, 'binary_precision': 0.6835443, 'binary_recall': 0.41538462, 'binary_specificity': 0.991591, 'binary_f1_score': 0.5167464}
confusion matrix:
      0    1
0  5896   50
1   152  108
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_dann_lr1e5_bs16_classbalancing10/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_dann_lr1e5_bs16_classbalancing10/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_dann_lr1e5_bs16_classbalancing10/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190969 KiB | 459954 KiB |   1786 TiB |   1786 TiB |
|       from large pool | 173494 KiB | 426325 KiB |   1749 TiB |   1749 TiB |
|       from small pool |  17475 KiB |  34702 KiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 190969 KiB | 459954 KiB |   1786 TiB |   1786 TiB |
|       from large pool | 173494 KiB | 426325 KiB |   1749 TiB |   1749 TiB |
|       from small pool |  17475 KiB |  34702 KiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189281 KiB | 457562 KiB |   1786 TiB |   1786 TiB |
|       from large pool | 172814 KiB | 424940 KiB |   1749 TiB |   1749 TiB |
|       from small pool |  16467 KiB |  33694 KiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB | 655360 KiB | 129024 KiB |
|       from large pool | 487424 KiB | 487424 KiB | 608256 KiB | 120832 KiB |
|       from small pool |  38912 KiB |  38912 KiB |  47104 KiB |   8192 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40454 KiB |  83509 KiB |   1063 TiB |   1063 TiB |
|       from large pool |  31306 KiB |  79555 KiB |   1026 TiB |   1026 TiB |
|       from small pool |   9148 KiB |  13898 KiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2962    |    7613    |  360917 K  |  360914 K  |
|       from large pool |      76    |     158    |  176513 K  |  176513 K  |
|       from small pool |    2886    |    7536    |  184403 K  |  184400 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2962    |    7613    |  360917 K  |  360914 K  |
|       from large pool |      76    |     158    |  176513 K  |  176513 K  |
|       from small pool |    2886    |    7536    |  184403 K  |  184400 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      50    |       9    |
|       from large pool |      22    |      22    |      27    |       5    |
|       from small pool |      19    |      19    |      23    |       4    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    3580    |  192808 K  |  192808 K  |
|       from large pool |      10    |      22    |  116309 K  |  116309 K  |
|       from small pool |      29    |    3571    |   76499 K  |   76499 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 459954 KiB |   1786 TiB |   1786 TiB |
|       from large pool |  17088 KiB | 426325 KiB |   1749 TiB |   1749 TiB |
|       from small pool |      0 KiB |  34702 KiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 459954 KiB |   1786 TiB |   1786 TiB |
|       from large pool |  17088 KiB | 426325 KiB |   1749 TiB |   1749 TiB |
|       from small pool |      0 KiB |  34702 KiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457562 KiB |   1786 TiB |   1786 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1749 TiB |   1749 TiB |
|       from small pool |      0 KiB |  33694 KiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB | 655360 KiB | 423936 KiB |
|       from large pool | 204800 KiB | 487424 KiB | 608256 KiB | 403456 KiB |
|       from small pool |  26624 KiB |  38912 KiB |  47104 KiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  83509 KiB |   1063 TiB |   1063 TiB |
|       from large pool |  23872 KiB |  79555 KiB |   1026 TiB |   1026 TiB |
|       from small pool |      0 KiB |  19186 KiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  360917 K  |  360917 K  |
|       from large pool |       2    |     158    |  176513 K  |  176513 K  |
|       from small pool |       0    |    7536    |  184403 K  |  184403 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  360917 K  |  360917 K  |
|       from large pool |       2    |     158    |  176513 K  |  176513 K  |
|       from small pool |       0    |    7536    |  184403 K  |  184403 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      41    |      50    |      27    |
|       from large pool |      10    |      22    |      27    |      17    |
|       from small pool |      13    |      19    |      23    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3580    |  192809 K  |  192809 K  |
|       from large pool |       3    |      22    |  116309 K  |  116309 K  |
|       from small pool |       0    |    3571    |   76500 K  |   76500 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 459954 KiB |   1786 TiB |   1786 TiB |
|       from large pool |  17088 KiB | 426325 KiB |   1749 TiB |   1749 TiB |
|       from small pool |      0 KiB |  34702 KiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 459954 KiB |   1786 TiB |   1786 TiB |
|       from large pool |  17088 KiB | 426325 KiB |   1749 TiB |   1749 TiB |
|       from small pool |      0 KiB |  34702 KiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457562 KiB |   1786 TiB |   1786 TiB |
|       from large pool |  16640 KiB | 424940 KiB |   1749 TiB |   1749 TiB |
|       from small pool |      0 KiB |  33694 KiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 231424 KiB | 526336 KiB | 655360 KiB | 423936 KiB |
|       from large pool | 204800 KiB | 487424 KiB | 608256 KiB | 403456 KiB |
|       from small pool |  26624 KiB |  38912 KiB |  47104 KiB |  20480 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  83509 KiB |   1063 TiB |   1063 TiB |
|       from large pool |  23872 KiB |  79555 KiB |   1026 TiB |   1026 TiB |
|       from small pool |      0 KiB |  19186 KiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7613    |  360917 K  |  360917 K  |
|       from large pool |       2    |     158    |  176513 K  |  176513 K  |
|       from small pool |       0    |    7536    |  184403 K  |  184403 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7613    |  360917 K  |  360917 K  |
|       from large pool |       2    |     158    |  176513 K  |  176513 K  |
|       from small pool |       0    |    7536    |  184403 K  |  184403 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      41    |      50    |      27    |
|       from large pool |      10    |      22    |      27    |      17    |
|       from small pool |      13    |      19    |      23    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3580    |  192809 K  |  192809 K  |
|       from large pool |       3    |      22    |  116309 K  |  116309 K  |
|       from small pool |       0    |    3571    |   76500 K  |   76500 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
slurmstepd: error: *** JOB 21581803 ON gpusrv77 CANCELLED AT 2024-06-27T00:42:45 ***
