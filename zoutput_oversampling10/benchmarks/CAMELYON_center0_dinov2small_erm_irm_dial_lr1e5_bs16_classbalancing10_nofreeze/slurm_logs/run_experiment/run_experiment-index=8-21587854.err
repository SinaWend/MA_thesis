Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jun 27 12:23:30 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854

 Experiment start at: 2024-06-27 12:31:11.354757
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99491584, 'precision': 0.99496275, 'recall': 0.99174297, 'specificity': 0.99174297, 'f1': 0.99333906, 'auroc': 0.9995351, 'binary_precision': 0.99505866, 'binary_recall': 0.9851872, 'binary_specificity': 0.9982988, 'binary_f1_score': 0.9900983}
confusion matrix:
       0      1
0  42251     72
1    218  14499
---- Validation: 
scalar performance:
{'acc': 0.963708, 'precision': 0.7203827, 'recall': 0.68043894, 'specificity': 0.68043894, 'f1': 0.69818366, 'auroc': 0.93360424, 'binary_precision': 0.46271512, 'binary_recall': 0.3763608, 'binary_specificity': 0.98451704, 'binary_f1_score': 0.41509435}
confusion matrix:
       0    1
0  17868  281
1    401  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.75194323, 'recall': 0.57562596, 'specificity': 0.57562596, 'f1': 0.6111929, 'auroc': 0.91996, 'binary_precision': 0.5394737, 'binary_recall': 0.15708812, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.24332345}
confusion matrix:
      0   1
0  5962  35
1   220  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-27 13:44:33.914236,epoch time: 1:13:22.559479,used: 1:13:22.559479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98430926, 'precision': 0.9747294, 'recall': 0.98503876, 'specificity': 0.98503876, 'f1': 0.9797318, 'auroc': 0.99871147, 'binary_precision': 0.95419294, 'binary_recall': 0.98654616, 'binary_specificity': 0.9835314, 'binary_f1_score': 0.9700998}
confusion matrix:
       0      1
0  41626    697
1    198  14519
---- Validation: 
scalar performance:
{'acc': 0.95945084, 'precision': 0.69440687, 'recall': 0.69848645, 'specificity': 0.69848645, 'f1': 0.6964226, 'auroc': 0.9325547, 'binary_precision': 0.40943682, 'binary_recall': 0.41835147, 'binary_specificity': 0.9786214, 'binary_f1_score': 0.41384614}
confusion matrix:
       0    1
0  17761  388
1    374  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95653564, 'precision': 0.5459235, 'recall': 0.50274754, 'specificity': 0.50274754, 'f1': 0.49613526, 'auroc': 0.9416567, 'binary_precision': 0.13333334, 'binary_recall': 0.007662835, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.014492754}
confusion matrix:
      0   1
0  5984  13
1   259   2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_2.png
early stop counter: 1
val acc:0.9594508409500122, best validation acc: 0.9637079834938049, corresponding to test acc:                         0.9592521786689758 / 0.9592521786689758
after epoch: 2,now: 2024-06-27 16:34:11.754912,epoch time: 2:49:37.840676,used: 4:03:00.400155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9961255, 'precision': 0.99529946, 'recall': 0.99457395, 'specificity': 0.99457395, 'f1': 0.994936, 'auroc': 0.99967635, 'binary_precision': 0.99359715, 'binary_recall': 0.9913688, 'binary_specificity': 0.99777913, 'binary_f1_score': 0.9924817}
confusion matrix:
       0      1
0  42232     94
1    127  14587
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.7561859, 'recall': 0.79059577, 'specificity': 0.79059577, 'f1': 0.7721826, 'auroc': 0.96091276, 'binary_precision': 0.526603, 'binary_recall': 0.60031104, 'binary_specificity': 0.9808805, 'binary_f1_score': 0.5610465}
confusion matrix:
       0    1
0  17802  347
1    257  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.74453187, 'recall': 0.5552201, 'specificity': 0.5552201, 'f1': 0.58376414, 'auroc': 0.92501795, 'binary_precision': 0.5263158, 'binary_recall': 0.11494253, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.18867923}
confusion matrix:
      0   1
0  5970  27
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_3.png
better model found
persisted
after epoch: 3,now: 2024-06-27 18:15:50.759829,epoch time: 1:41:39.004917,used: 5:44:39.405072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99617815, 'precision': 0.9957094, 'recall': 0.99430025, 'specificity': 0.99430025, 'f1': 0.9950022, 'auroc': 0.99966156, 'binary_precision': 0.99474543, 'binary_recall': 0.99041986, 'binary_specificity': 0.9981806, 'binary_f1_score': 0.9925779}
confusion matrix:
       0      1
0  42245     77
1    141  14577
---- Validation: 
scalar performance:
{'acc': 0.9616326, 'precision': 0.72558427, 'recall': 0.84587675, 'specificity': 0.84587675, 'f1': 0.7713506, 'auroc': 0.9575783, 'binary_precision': 0.4612326, 'binary_recall': 0.7216174, 'binary_specificity': 0.9701361, 'binary_f1_score': 0.5627653}
confusion matrix:
       0    1
0  17607  542
1    179  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9741131, 'precision': 0.8948389, 'recall': 0.7446252, 'specificity': 0.7446252, 'f1': 0.8004464, 'auroc': 0.94460654, 'binary_precision': 0.8113208, 'binary_recall': 0.49425286, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.61428565}
confusion matrix:
      0    1
0  5967   30
1   132  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_4.png
new oracle model saved
early stop counter: 1
val acc:0.9616326093673706, best validation acc: 0.9678586721420288, corresponding to test acc:                         0.9587727785110474 / 0.9741131067276001
after epoch: 4,now: 2024-06-27 19:36:10.401716,epoch time: 1:20:19.641887,used: 7:04:59.046959,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9960905, 'precision': 0.9973337, 'recall': 0.99246705, 'specificity': 0.99246705, 'f1': 0.9948691, 'auroc': 0.99963737, 'binary_precision': 0.999862, 'binary_recall': 0.9849813, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9923659}
confusion matrix:
       0      1
0  42323      2
1    221  14494
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.7826763, 'recall': 0.6334974, 'specificity': 0.6334974, 'f1': 0.67899805, 'auroc': 0.93786204, 'binary_precision': 0.590604, 'binary_recall': 0.27371696, 'binary_specificity': 0.99327785, 'binary_f1_score': 0.37407014}
confusion matrix:
       0    1
0  18027  122
1    467  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9533397, 'precision': 0.4790429, 'recall': 0.49741536, 'specificity': 0.49741536, 'f1': 0.48805627, 'auroc': 0.90463364, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5966  31
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_5.png
better model found
persisted
after epoch: 5,now: 2024-06-27 20:47:48.708162,epoch time: 1:11:38.306446,used: 8:16:37.353405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9957223, 'precision': 0.9942403, 'recall': 0.99459064, 'specificity': 0.99459064, 'f1': 0.9944153, 'auroc': 0.999676, 'binary_precision': 0.99117506, 'binary_recall': 0.9922528, 'binary_specificity': 0.9969285, 'binary_f1_score': 0.99171364}
confusion matrix:
       0      1
0  42195    130
1    114  14601
---- Validation: 
scalar performance:
{'acc': 0.9537569, 'precision': 0.69329584, 'recall': 0.8245481, 'specificity': 0.8245481, 'f1': 0.73973036, 'auroc': 0.952374, 'binary_precision': 0.39801443, 'binary_recall': 0.6858476, 'binary_specificity': 0.96324867, 'binary_f1_score': 0.5037121}
confusion matrix:
       0    1
0  17482  667
1    202  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.7392842, 'recall': 0.86571634, 'specificity': 0.86571634, 'f1': 0.7871112, 'auroc': 0.9398606, 'binary_precision': 0.48899755, 'binary_recall': 0.7662835, 'binary_specificity': 0.9651492, 'binary_f1_score': 0.5970149}
confusion matrix:
      0    1
0  5788  209
1    61  200
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_6.png
early stop counter: 1
val acc:0.9537569284439087, best validation acc: 0.9686568975448608, corresponding to test acc:                         0.953339695930481 / 0.9741131067276001
after epoch: 6,now: 2024-06-27 21:58:18.564413,epoch time: 1:10:29.856251,used: 9:27:07.209656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9968969, 'precision': 0.99780416, 'recall': 0.99409735, 'specificity': 0.99409735, 'f1': 0.9959327, 'auroc': 0.9997927, 'binary_precision': 0.9996564, 'binary_recall': 0.98831284, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9939523}
confusion matrix:
       0      1
0  42318      5
1    172  14545
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.8652091, 'recall': 0.52230257, 'specificity': 0.52230257, 'f1': 0.5341433, 'auroc': 0.94965285, 'binary_precision': 0.7631579, 'binary_recall': 0.045101088, 'binary_specificity': 0.9995041, 'binary_f1_score': 0.08516886}
confusion matrix:
       0   1
0  18140   9
1    614  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.57921, 'recall': 0.5015822, 'specificity': 0.5015822, 'f1': 0.49298388, 'auroc': 0.95332193, 'binary_precision': 0.2, 'binary_recall': 0.0038314175, 'binary_specificity': 0.999333, 'binary_f1_score': 0.007518797}
confusion matrix:
      0  1
0  5993  4
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_7.png
early stop counter: 2
val acc:0.9668475985527039, best validation acc: 0.9686568975448608, corresponding to test acc:                         0.953339695930481 / 0.9741131067276001
after epoch: 7,now: 2024-06-27 23:08:32.492234,epoch time: 1:10:13.927821,used: 10:37:21.137477,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9970021, 'precision': 0.9974011, 'recall': 0.9947653, 'specificity': 0.9947653, 'f1': 0.996074, 'auroc': 0.9997016, 'binary_precision': 0.9982184, 'binary_recall': 0.9901448, 'binary_specificity': 0.9993857, 'binary_f1_score': 0.9941652}
confusion matrix:
       0      1
0  42301     26
1    145  14568
---- Validation: 
scalar performance:
{'acc': 0.9722222, 'precision': 0.84011894, 'recall': 0.66009504, 'specificity': 0.66009504, 'f1': 0.7152178, 'auroc': 0.9424428, 'binary_precision': 0.7037037, 'binary_recall': 0.32503888, 'binary_specificity': 0.9951512, 'binary_f1_score': 0.44468087}
confusion matrix:
       0    1
0  18061   88
1    434  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7293666, 'recall': 0.505497, 'specificity': 0.505497, 'f1': 0.50058204, 'auroc': 0.94622564, 'binary_precision': 0.5, 'binary_recall': 0.011494253, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.022471908}
confusion matrix:
      0  1
0  5994  3
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_8.png
better model found
persisted
after epoch: 8,now: 2024-06-28 00:19:05.585873,epoch time: 1:10:33.093639,used: 11:47:54.231116,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9986501, 'precision': 0.99893546, 'recall': 0.9975386, 'specificity': 0.9975386, 'f1': 0.9982345, 'auroc': 0.99985206, 'binary_precision': 0.9995222, 'binary_recall': 0.99524266, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.9973779}
confusion matrix:
       0      1
0  42319      7
1     70  14644
---- Validation: 
scalar performance:
{'acc': 0.9744572, 'precision': 0.8519491, 'recall': 0.7017551, 'specificity': 0.7017551, 'f1': 0.75487006, 'auroc': 0.9552082, 'binary_precision': 0.7245179, 'binary_recall': 0.40902022, 'binary_specificity': 0.99449, 'binary_f1_score': 0.5228628}
confusion matrix:
       0    1
0  18049  100
1    380  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.87211984, 'recall': 0.5737955, 'specificity': 0.5737955, 'f1': 0.61585665, 'auroc': 0.9437696, 'binary_precision': 0.78, 'binary_recall': 0.14942528, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.25080386}
confusion matrix:
      0   1
0  5986  11
1   222  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_9.png
better model found
persisted
after epoch: 9,now: 2024-06-28 01:29:09.677832,epoch time: 1:10:04.091959,used: 12:57:58.323075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9985098, 'precision': 0.9989754, 'recall': 0.99713415, 'specificity': 0.99713415, 'f1': 0.99805033, 'auroc': 0.9997875, 'binary_precision': 0.99993163, 'binary_recall': 0.9942919, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9971038}
confusion matrix:
       0      1
0  42323      1
1     84  14632
---- Validation: 
scalar performance:
{'acc': 0.970679, 'precision': 0.8473128, 'recall': 0.61504287, 'specificity': 0.61504287, 'f1': 0.66876316, 'auroc': 0.9410325, 'binary_precision': 0.72115386, 'binary_recall': 0.2332815, 'binary_specificity': 0.99680424, 'binary_f1_score': 0.35252643}
confusion matrix:
       0    1
0  18091   58
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.70407003, 'recall': 0.53081614, 'specificity': 0.53081614, 'f1': 0.5460107, 'auroc': 0.91872567, 'binary_precision': 0.4473684, 'binary_recall': 0.0651341, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.113712385}
confusion matrix:
      0   1
0  5976  21
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_10.png
early stop counter: 1
val acc:0.970678985118866, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 10,now: 2024-06-28 02:38:16.556155,epoch time: 1:09:06.878323,used: 14:07:05.201398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99835205, 'precision': 0.99886954, 'recall': 0.99682856, 'specificity': 0.99682856, 'f1': 0.9978435, 'auroc': 0.9998366, 'binary_precision': 0.99993163, 'binary_recall': 0.9936808, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99679637}
confusion matrix:
       0      1
0  42322      1
1     93  14624
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.7676091, 'recall': 0.51891667, 'specificity': 0.51891667, 'f1': 0.527758, 'auroc': 0.9501299, 'binary_precision': 0.5681818, 'binary_recall': 0.038880248, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.07278021}
confusion matrix:
       0   1
0  18130  19
1    618  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550975, 'precision': 0.47907984, 'recall': 0.4983325, 'specificity': 0.4983325, 'f1': 0.48851657, 'auroc': 0.9350245, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.996665, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5977  20
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_11.png
early stop counter: 2
val acc:0.9661026000976562, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 11,now: 2024-06-28 03:47:40.703966,epoch time: 1:09:24.147811,used: 15:16:29.349209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9980891, 'precision': 0.99855834, 'recall': 0.9964517, 'specificity': 0.9964517, 'f1': 0.99749917, 'auroc': 0.9999442, 'binary_precision': 0.99952126, 'binary_recall': 0.99306875, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.9962846}
confusion matrix:
       0      1
0  42317      7
1    102  14614
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.7664498, 'recall': 0.5363057, 'specificity': 0.5363057, 'f1': 0.5573602, 'auroc': 0.9558762, 'binary_precision': 0.5647059, 'binary_recall': 0.07465008, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.13186812}
confusion matrix:
       0   1
0  18112  37
1    595  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.47910663, 'recall': 0.4989995, 'specificity': 0.4989995, 'f1': 0.48885077, 'auroc': 0.9371742, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.997999, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5985  12
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_12.png
early stop counter: 3
val acc:0.9663686752319336, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 12,now: 2024-06-28 04:57:53.333099,epoch time: 1:10:12.629133,used: 16:26:41.978342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.996967, 'precision': 0.9978965, 'recall': 0.99418855, 'specificity': 0.99418855, 'f1': 0.99602437, 'auroc': 0.9998534, 'binary_precision': 0.9997938, 'binary_recall': 0.98844796, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.99408853}
confusion matrix:
       0      1
0  42321      3
1    170  14546
---- Validation: 
scalar performance:
{'acc': 0.9692422, 'precision': 0.90599674, 'recall': 0.5617952, 'specificity': 0.5617952, 'f1': 0.6005576, 'auroc': 0.9469755, 'binary_precision': 0.84210527, 'binary_recall': 0.1244168, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.21680216}
confusion matrix:
       0   1
0  18134  15
1    563  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9382626, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_13.png
early stop counter: 4
val acc:0.9692422151565552, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 13,now: 2024-06-28 06:07:24.762989,epoch time: 1:09:31.429890,used: 17:36:13.408232,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9981767, 'precision': 0.9987294, 'recall': 0.9965112, 'specificity': 0.9965112, 'f1': 0.99761385, 'auroc': 0.9999134, 'binary_precision': 0.9998632, 'binary_recall': 0.9930697, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9964549}
confusion matrix:
       0      1
0  42320      2
1    102  14616
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.8526648, 'recall': 0.58673984, 'specificity': 0.58673984, 'f1': 0.6340208, 'auroc': 0.9546677, 'binary_precision': 0.73376626, 'binary_recall': 0.17573872, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.28356335}
confusion matrix:
       0    1
0  18108   41
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.9499309, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_14.png
early stop counter: 5
val acc:0.9696147441864014, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 14,now: 2024-06-28 07:17:21.640673,epoch time: 1:09:56.877684,used: 18:46:10.285916,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9983345, 'precision': 0.99870086, 'recall': 0.99694914, 'specificity': 0.99694914, 'f1': 0.997821, 'auroc': 0.9998183, 'binary_precision': 0.99945337, 'binary_recall': 0.9940873, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9967631}
confusion matrix:
       0      1
0  42318      8
1     87  14627
---- Validation: 
scalar performance:
{'acc': 0.9732333, 'precision': 0.9088992, 'recall': 0.6328665, 'specificity': 0.6328665, 'f1': 0.69622374, 'auroc': 0.95975256, 'binary_precision': 0.84313726, 'binary_recall': 0.2674961, 'binary_specificity': 0.99823684, 'binary_f1_score': 0.4061393}
confusion matrix:
       0    1
0  18117   32
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.47913337, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48918456, 'auroc': 0.9442507, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_15.png
early stop counter: 6
val acc:0.9732332825660706, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 15,now: 2024-06-28 08:27:23.984322,epoch time: 1:10:02.343649,used: 19:56:12.629565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9985799, 'precision': 0.9983328, 'recall': 0.997957, 'specificity': 0.997957, 'f1': 0.99814475, 'auroc': 0.99992657, 'binary_precision': 0.9978228, 'binary_recall': 0.99667007, 'binary_specificity': 0.999244, 'binary_f1_score': 0.99724615}
confusion matrix:
       0      1
0  42293     32
1     49  14666
---- Validation: 
scalar performance:
{'acc': 0.9713708, 'precision': 0.8420419, 'recall': 0.63640255, 'specificity': 0.63640255, 'f1': 0.6917734, 'auroc': 0.9564032, 'binary_precision': 0.70916337, 'binary_recall': 0.27682737, 'binary_specificity': 0.99597776, 'binary_f1_score': 0.39821026}
confusion matrix:
       0    1
0  18076   73
1    465  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.87514126, 'recall': 0.64759105, 'specificity': 0.64759105, 'f1': 0.70763373, 'auroc': 0.94329596, 'binary_precision': 0.78, 'binary_recall': 0.29885057, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.43213296}
confusion matrix:
      0   1
0  5975  22
1   183  78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_16.png
early stop counter: 7
val acc:0.9713708162307739, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 16,now: 2024-06-28 09:38:12.736565,epoch time: 1:10:48.752243,used: 21:07:01.381808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99843967, 'precision': 0.9988164, 'recall': 0.99710906, 'specificity': 0.99710906, 'f1': 0.9979589, 'auroc': 0.9999436, 'binary_precision': 0.99959016, 'binary_recall': 0.99435985, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.99696815}
confusion matrix:
       0      1
0  42318      6
1     83  14633
---- Validation: 
scalar performance:
{'acc': 0.96828437, 'precision': 0.81126547, 'recall': 0.57705045, 'specificity': 0.57705045, 'f1': 0.61846554, 'auroc': 0.9542645, 'binary_precision': 0.6516129, 'binary_recall': 0.15707621, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.25313282}
confusion matrix:
       0    1
0  18095   54
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94231385, 'precision': 0.5313655, 'recall': 0.51548284, 'specificity': 0.51548284, 'f1': 0.51871, 'auroc': 0.89762855, 'binary_precision': 0.103174604, 'binary_recall': 0.049808428, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.06718346}
confusion matrix:
      0    1
0  5884  113
1   248   13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_17.png
early stop counter: 8
val acc:0.9682843685150146, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 17,now: 2024-06-28 10:48:29.687227,epoch time: 1:10:16.950662,used: 22:17:18.332470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99586254, 'precision': 0.99361074, 'recall': 0.99561644, 'specificity': 0.99561644, 'f1': 0.99460816, 'auroc': 0.9997691, 'binary_precision': 0.9889264, 'binary_recall': 0.995108, 'binary_specificity': 0.9961249, 'binary_f1_score': 0.9920076}
confusion matrix:
       0      1
0  42158    164
1     72  14646
---- Validation: 
scalar performance:
{'acc': 0.96062154, 'precision': 0.6906191, 'recall': 0.65258914, 'specificity': 0.65258914, 'f1': 0.6692196, 'auroc': 0.9008437, 'binary_precision': 0.40508807, 'binary_recall': 0.32192847, 'binary_specificity': 0.9832498, 'binary_f1_score': 0.35875213}
confusion matrix:
       0    1
0  17845  304
1    436  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.8536699, 'recall': 0.5603855, 'specificity': 0.5603855, 'f1': 0.59543675, 'auroc': 0.9361303, 'binary_precision': 0.74418604, 'binary_recall': 0.12260536, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.2105263}
confusion matrix:
      0   1
0  5986  11
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_18.png
early stop counter: 9
val acc:0.9606215357780457, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 18,now: 2024-06-28 11:59:02.290155,epoch time: 1:10:32.602928,used: 23:27:50.935398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99673915, 'precision': 0.99668777, 'recall': 0.9947885, 'specificity': 0.9947885, 'f1': 0.9957334, 'auroc': 0.99982035, 'binary_precision': 0.9965824, 'binary_recall': 0.99075836, 'binary_specificity': 0.99881864, 'binary_f1_score': 0.9936619}
confusion matrix:
       0      1
0  42274     50
1    136  14580
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.741751, 'recall': 0.6149238, 'specificity': 0.6149238, 'f1': 0.6535557, 'auroc': 0.9493675, 'binary_precision': 0.51, 'binary_recall': 0.23794712, 'binary_specificity': 0.9919004, 'binary_f1_score': 0.3244963}
confusion matrix:
       0    1
0  18002  147
1    490  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.7718597, 'recall': 0.6279318, 'specificity': 0.6279318, 'f1': 0.67109, 'auroc': 0.9260267, 'binary_precision': 0.575, 'binary_recall': 0.26436782, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.36220473}
confusion matrix:
      0   1
0  5946  51
1   192  69
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_19.png
early stop counter: 10
val acc:0.9661026000976562, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 19,now: 2024-06-28 13:10:07.191979,epoch time: 1:11:04.901824,used: 1 day, 0:38:55.837222,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99843967, 'precision': 0.9984596, 'recall': 0.9974637, 'specificity': 0.9974637, 'f1': 0.9979603, 'auroc': 0.9999373, 'binary_precision': 0.99850047, 'binary_recall': 0.99544716, 'binary_specificity': 0.9994802, 'binary_f1_score': 0.9969715}
confusion matrix:
       0      1
0  42302     22
1     67  14649
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.9108489, 'recall': 0.5448256, 'specificity': 0.5448256, 'f1': 0.573507, 'auroc': 0.9396684, 'binary_precision': 0.85294116, 'binary_recall': 0.090202175, 'binary_specificity': 0.999449, 'binary_f1_score': 0.16315049}
confusion matrix:
       0   1
0  18139  10
1    585  58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.4791367, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.48922622, 'auroc': 0.93794537, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_20.png
early stop counter: 11
val acc:0.9683375954627991, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 20,now: 2024-06-28 14:20:24.931710,epoch time: 1:10:17.739731,used: 1 day, 1:49:13.576953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9989306, 'precision': 0.99912417, 'recall': 0.9980824, 'specificity': 0.9980824, 'f1': 0.9986019, 'auroc': 0.999923, 'binary_precision': 0.99952275, 'binary_recall': 0.99633026, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.997924}
confusion matrix:
       0      1
0  42318      7
1     54  14661
---- Validation: 
scalar performance:
{'acc': 0.97302043, 'precision': 0.84074426, 'recall': 0.6800097, 'specificity': 0.6800097, 'f1': 0.7336073, 'auroc': 0.9534103, 'binary_precision': 0.70359284, 'binary_recall': 0.36547434, 'binary_specificity': 0.99454516, 'binary_f1_score': 0.48106447}
confusion matrix:
       0    1
0  18050   99
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96580374, 'precision': 0.96331465, 'recall': 0.593703, 'specificity': 0.593703, 'f1': 0.64828366, 'auroc': 0.926065, 'binary_precision': 0.9607843, 'binary_recall': 0.18773946, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.31410256}
confusion matrix:
      0   1
0  5995   2
1   212  49
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_21.png
early stop counter: 12
val acc:0.9730204343795776, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 21,now: 2024-06-28 15:30:55.675356,epoch time: 1:10:30.743646,used: 1 day, 2:59:44.320599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9978962, 'precision': 0.9982047, 'recall': 0.9962998, 'specificity': 0.9962998, 'f1': 0.9972474, 'auroc': 0.99969935, 'binary_precision': 0.99883807, 'binary_recall': 0.9930013, 'binary_specificity': 0.9995983, 'binary_f1_score': 0.99591106}
confusion matrix:
       0      1
0  42306     17
1    103  14614
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.76236206, 'recall': 0.6230855, 'specificity': 0.6230855, 'f1': 0.6652249, 'auroc': 0.9289179, 'binary_precision': 0.5506757, 'binary_recall': 0.2534992, 'binary_specificity': 0.9926718, 'binary_f1_score': 0.34717783}
confusion matrix:
       0    1
0  18016  133
1    480  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9400767, 'precision': 0.47875977, 'recall': 0.49049523, 'specificity': 0.49049523, 'f1': 0.48455647, 'auroc': 0.80262685, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.0}
confusion matrix:
      0    1
0  5883  114
1   261    0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_22.png
early stop counter: 13
val acc:0.9673797488212585, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 22,now: 2024-06-28 16:41:23.724651,epoch time: 1:10:28.049295,used: 1 day, 4:10:12.369894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9985624, 'precision': 0.9981225, 'recall': 0.9981225, 'specificity': 0.9981225, 'f1': 0.9981225, 'auroc': 0.9999176, 'binary_precision': 0.9972137, 'binary_recall': 0.9972137, 'binary_specificity': 0.9990313, 'binary_f1_score': 0.9972137}
confusion matrix:
       0      1
0  42284     41
1     41  14674
---- Validation: 
scalar performance:
{'acc': 0.9673265, 'precision': 0.7725509, 'recall': 0.5855552, 'specificity': 0.5855552, 'f1': 0.62616867, 'auroc': 0.94220185, 'binary_precision': 0.57360405, 'binary_recall': 0.17573872, 'binary_specificity': 0.99537164, 'binary_f1_score': 0.2690476}
confusion matrix:
       0    1
0  18065   84
1    530  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.5793369, 'recall': 0.5047466, 'specificity': 0.5047466, 'f1': 0.49984017, 'auroc': 0.91380477, 'binary_precision': 0.2, 'binary_recall': 0.011494253, 'binary_specificity': 0.997999, 'binary_f1_score': 0.02173913}
confusion matrix:
      0   1
0  5985  12
1   258   3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_23.png
early stop counter: 14
val acc:0.9673265218734741, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 23,now: 2024-06-28 17:51:56.199174,epoch time: 1:10:32.474523,used: 1 day, 5:20:44.844417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9978436, 'precision': 0.99855113, 'recall': 0.9958209, 'specificity': 0.9958209, 'f1': 0.9971762, 'auroc': 0.9999577, 'binary_precision': 1.0, 'binary_recall': 0.99164176, 'binary_specificity': 1.0, 'binary_f1_score': 0.99580336}
confusion matrix:
       0      1
0  42324      0
1    123  14593
---- Validation: 
scalar performance:
{'acc': 0.96674114, 'precision': 0.84079623, 'recall': 0.52299756, 'specificity': 0.52299756, 'f1': 0.5353266, 'auroc': 0.9518349, 'binary_precision': 0.71428573, 'binary_recall': 0.0466563, 'binary_specificity': 0.9993388, 'binary_f1_score': 0.08759124}
confusion matrix:
       0   1
0  18137  12
1    613  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.4791133, 'recall': 0.49916625, 'specificity': 0.49916625, 'f1': 0.48893425, 'auroc': 0.9089465, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5987  10
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_24.png
early stop counter: 15
val acc:0.966741144657135, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 24,now: 2024-06-28 19:05:36.567967,epoch time: 1:13:40.368793,used: 1 day, 6:34:25.213210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9983345, 'precision': 0.9987456, 'recall': 0.9969052, 'specificity': 0.9969052, 'f1': 0.997821, 'auroc': 0.99996173, 'binary_precision': 0.99959, 'binary_recall': 0.99395216, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.9967631}
confusion matrix:
       0      1
0  42318      6
1     89  14627
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.8142166, 'recall': 0.5618289, 'specificity': 0.5618289, 'f1': 0.59754163, 'auroc': 0.9302287, 'binary_precision': 0.6585366, 'binary_recall': 0.125972, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.21148826}
confusion matrix:
       0   1
0  18107  42
1    562  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9546181, 'precision': 0.47906977, 'recall': 0.49808237, 'specificity': 0.49808237, 'f1': 0.48839113, 'auroc': 0.92296195, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5974  23
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_25.png
early stop counter: 16
val acc:0.9678586721420288, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 25,now: 2024-06-28 20:22:13.714240,epoch time: 1:16:37.146273,used: 1 day, 7:51:02.359483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9987728, 'precision': 0.99910736, 'recall': 0.9976878, 'specificity': 0.9976878, 'f1': 0.99839497, 'auroc': 0.9999221, 'binary_precision': 0.9997952, 'binary_recall': 0.9954465, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9976162}
confusion matrix:
       0      1
0  42323      3
1     67  14647
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.8095601, 'recall': 0.5411917, 'specificity': 0.5411917, 'f1': 0.56599665, 'auroc': 0.9453896, 'binary_precision': 0.6506024, 'binary_recall': 0.083981335, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.14876032}
confusion matrix:
       0   1
0  18120  29
1    589  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.47911665, 'recall': 0.49924964, 'specificity': 0.49924964, 'f1': 0.48897603, 'auroc': 0.78913534, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5988  9
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_26.png
early stop counter: 17
val acc:0.9671136736869812, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 26,now: 2024-06-28 21:35:15.873197,epoch time: 1:13:02.158957,used: 1 day, 9:04:04.518440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99898314, 'precision': 0.9991596, 'recall': 0.99818474, 'specificity': 0.99818474, 'f1': 0.99867094, 'auroc': 0.9999579, 'binary_precision': 0.999523, 'binary_recall': 0.9965349, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.9980267}
confusion matrix:
       0      1
0  42315      7
1     51  14667
---- Validation: 
scalar performance:
{'acc': 0.96897614, 'precision': 0.7900927, 'recall': 0.63066244, 'specificity': 0.63066244, 'f1': 0.67759264, 'auroc': 0.94601375, 'binary_precision': 0.6056338, 'binary_recall': 0.2674961, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.37108952}
confusion matrix:
       0    1
0  18037  112
1    471  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.53475225, 'recall': 0.5012487, 'specificity': 0.5012487, 'f1': 0.49276134, 'auroc': 0.91962904, 'binary_precision': 0.11111111, 'binary_recall': 0.0038314175, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0074074073}
confusion matrix:
      0  1
0  5989  8
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_27.png
early stop counter: 18
val acc:0.9689761400222778, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 27,now: 2024-06-28 22:44:51.872547,epoch time: 1:09:35.999350,used: 1 day, 10:13:40.517790,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9982118, 'precision': 0.99826133, 'recall': 0.9970665, 'specificity': 0.9970665, 'f1': 0.99766207, 'auroc': 0.9999263, 'binary_precision': 0.99836326, 'binary_recall': 0.9947, 'binary_specificity': 0.9994329, 'binary_f1_score': 0.9965283}
confusion matrix:
       0      1
0  42299     24
1     78  14639
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.69349664, 'recall': 0.5325341, 'specificity': 0.5325341, 'f1': 0.54986495, 'auroc': 0.941348, 'binary_precision': 0.41904762, 'binary_recall': 0.06842924, 'binary_specificity': 0.99663895, 'binary_f1_score': 0.11764706}
confusion matrix:
       0   1
0  18088  61
1    599  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.4791367, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.48922622, 'auroc': 0.9250585, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_28.png
early stop counter: 19
val acc:0.9648786783218384, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 28,now: 2024-06-28 23:54:34.442623,epoch time: 1:09:42.570076,used: 1 day, 11:23:23.087866,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99852735, 'precision': 0.9989872, 'recall': 0.99716794, 'specificity': 0.99716794, 'f1': 0.9980732, 'auroc': 0.99996126, 'binary_precision': 0.99993163, 'binary_recall': 0.9943595, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9971378}
confusion matrix:
       0      1
0  42324      1
1     83  14632
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.835806, 'recall': 0.5612717, 'specificity': 0.5612717, 'f1': 0.59757483, 'auroc': 0.95527947, 'binary_precision': 0.7017544, 'binary_recall': 0.1244168, 'binary_specificity': 0.9981266, 'binary_f1_score': 0.21136063}
confusion matrix:
       0   1
0  18115  34
1    563  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.52464455, 'recall': 0.50108194, 'specificity': 0.50108194, 'f1': 0.4926507, 'auroc': 0.9299171, 'binary_precision': 0.09090909, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0073529407}
confusion matrix:
      0   1
0  5987  10
1   260   1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_29.png
early stop counter: 20
val acc:0.9682311415672302, best validation acc: 0.9744572043418884, corresponding to test acc:                         0.9627676606178284 / 0.9741131067276001
after epoch: 29,now: 2024-06-29 01:04:31.254134,epoch time: 1:09:56.811511,used: 1 day, 12:33:19.899377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_12_31_11_seed_0_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 29 with time: 1 day, 12:33:19.899377 at 2024-06-29 01:04:31.254134
persisted model performance metric: 

scalar performance:
{'acc': 0.96276766, 'precision': 0.87211984, 'recall': 0.5737955, 'specificity': 0.5737955, 'f1': 0.61585665, 'auroc': 0.9437696, 'binary_precision': 0.78, 'binary_recall': 0.14942528, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.25080386}
confusion matrix:
      0   1
0  5986  11
1   222  39
oracle model performance metric: 

scalar performance:
{'acc': 0.9741131, 'precision': 0.8948389, 'recall': 0.7446252, 'specificity': 0.7446252, 'f1': 0.8004464, 'auroc': 0.94460654, 'binary_precision': 0.8113208, 'binary_recall': 0.49425286, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.61428565}
confusion matrix:
      0    1
0  5967   30
1   132  129
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458317 KiB |   8394 MiB |   4631 TiB |   4631 TiB |
|       from large pool | 416629 KiB |   8356 MiB |   4580 TiB |   4580 TiB |
|       from small pool |  41687 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 458317 KiB |   8394 MiB |   4631 TiB |   4631 TiB |
|       from large pool | 416629 KiB |   8356 MiB |   4580 TiB |   4580 TiB |
|       from small pool |  41687 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   8387 MiB |   4629 TiB |   4629 TiB |
|       from large pool | 407075 KiB |   8350 MiB |   4578 TiB |   4578 TiB |
|       from small pool |  40679 KiB |     60 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9166 MiB |   9166 MiB |   9166 MiB |      0 B   |
|       from large pool |   9098 MiB |   9098 MiB |   9098 MiB |      0 B   |
|       from small pool |     68 MiB |     68 MiB |     68 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 324019 KiB |    806 MiB |   2736 TiB |   2736 TiB |
|       from large pool | 314506 KiB |    802 MiB |   2685 TiB |   2685 TiB |
|       from small pool |   9512 KiB |     11 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8115    |  652578 K  |  652574 K  |
|       from large pool |     187    |     940    |  429316 K  |  429316 K  |
|       from small pool |    3301    |    7927    |  223261 K  |  223258 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8115    |  652578 K  |  652574 K  |
|       from large pool |     187    |     940    |  429316 K  |  429316 K  |
|       from small pool |    3301    |    7927    |  223261 K  |  223258 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     414    |     414    |     414    |       0    |
|       from large pool |     380    |     380    |     380    |       0    |
|       from small pool |      34    |      34    |      34    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      60    |    3606    |  386492 K  |  386492 K  |
|       from large pool |      27    |     383    |  286257 K  |  286257 K  |
|       from small pool |      33    |    3579    |  100235 K  |  100235 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8394 MiB |   4631 TiB |   4631 TiB |
|       from large pool |  16640 KiB |   8356 MiB |   4580 TiB |   4580 TiB |
|       from small pool |      0 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8394 MiB |   4631 TiB |   4631 TiB |
|       from large pool |  16640 KiB |   8356 MiB |   4580 TiB |   4580 TiB |
|       from small pool |      0 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8387 MiB |   4629 TiB |   4629 TiB |
|       from large pool |  16640 KiB |   8350 MiB |   4578 TiB |   4578 TiB |
|       from small pool |      0 KiB |     60 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 782336 KiB |   9166 MiB |   9166 MiB |   8402 MiB |
|       from large pool | 731136 KiB |   9098 MiB |   9098 MiB |   8384 MiB |
|       from small pool |  51200 KiB |     68 MiB |     68 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    806 MiB |   2736 TiB |   2736 TiB |
|       from large pool |  24320 KiB |    802 MiB |   2685 TiB |   2685 TiB |
|       from small pool |      0 KiB |     27 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |  652578 K  |  652578 K  |
|       from large pool |       2    |     940    |  429316 K  |  429316 K  |
|       from small pool |       0    |    7927    |  223261 K  |  223261 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |  652578 K  |  652578 K  |
|       from large pool |       2    |     940    |  429316 K  |  429316 K  |
|       from small pool |       0    |    7927    |  223261 K  |  223261 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     414    |     414    |     356    |
|       from large pool |      33    |     380    |     380    |     347    |
|       from small pool |      25    |      34    |      34    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3606    |  386494 K  |  386494 K  |
|       from large pool |       3    |     383    |  286257 K  |  286257 K  |
|       from small pool |       0    |    3579    |  100236 K  |  100236 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8394 MiB |   4631 TiB |   4631 TiB |
|       from large pool |  16640 KiB |   8356 MiB |   4580 TiB |   4580 TiB |
|       from small pool |      0 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8394 MiB |   4631 TiB |   4631 TiB |
|       from large pool |  16640 KiB |   8356 MiB |   4580 TiB |   4580 TiB |
|       from small pool |      0 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8387 MiB |   4629 TiB |   4629 TiB |
|       from large pool |  16640 KiB |   8350 MiB |   4578 TiB |   4578 TiB |
|       from small pool |      0 KiB |     60 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 782336 KiB |   9166 MiB |   9166 MiB |   8402 MiB |
|       from large pool | 731136 KiB |   9098 MiB |   9098 MiB |   8384 MiB |
|       from small pool |  51200 KiB |     68 MiB |     68 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |    806 MiB |   2736 TiB |   2736 TiB |
|       from large pool |  24320 KiB |    802 MiB |   2685 TiB |   2685 TiB |
|       from small pool |      0 KiB |     27 MiB |     51 TiB |     51 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |  652578 K  |  652578 K  |
|       from large pool |       2    |     940    |  429316 K  |  429316 K  |
|       from small pool |       0    |    7927    |  223261 K  |  223261 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |  652578 K  |  652578 K  |
|       from large pool |       2    |     940    |  429316 K  |  429316 K  |
|       from small pool |       0    |    7927    |  223261 K  |  223261 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     414    |     414    |     356    |
|       from large pool |      33    |     380    |     380    |     347    |
|       from small pool |      25    |      34    |      34    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3606    |  386494 K  |  386494 K  |
|       from large pool |       3    |     383    |  286257 K  |  286257 K  |
|       from small pool |       0    |    3579    |  100236 K  |  100236 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_01_11_36_seed_1_21587854

 Experiment start at: 2024-06-29 01:11:36.320299
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9892138, 'precision': 0.99228156, 'recall': 0.9792912, 'specificity': 0.9792912, 'f1': 0.98556924, 'auroc': 0.99814427, 'binary_precision': 0.99826753, 'binary_recall': 0.9591483, 'binary_specificity': 0.9994342, 'binary_f1_score': 0.97831696}
confusion matrix:
       0      1
0  42390     24
1    589  13829
---- Validation: 
scalar performance:
{'acc': 0.96168625, 'precision': 0.721596, 'recall': 0.7076127, 'specificity': 0.7076127, 'f1': 0.7143472, 'auroc': 0.90848124, 'binary_precision': 0.46422893, 'binary_recall': 0.43387815, 'binary_specificity': 0.9813472, 'binary_f1_score': 0.44854072}
confusion matrix:
       0    1
0  17730  337
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9465034, 'precision': 0.6756744, 'recall': 0.69623405, 'specificity': 0.69623405, 'f1': 0.6852787, 'auroc': 0.86257094, 'binary_precision': 0.37671232, 'binary_recall': 0.42307693, 'binary_specificity': 0.96939117, 'binary_f1_score': 0.39855072}
confusion matrix:
      0    1
0  5764  182
1   150  110
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-29 02:21:57.302391,epoch time: 1:10:20.982092,used: 1:10:20.982092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_01_11_36_seed_1_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9938239, 'precision': 0.9958482, 'recall': 0.98787266, 'specificity': 0.98787266, 'f1': 0.99177885, 'auroc': 0.9992381, 'binary_precision': 0.99985784, 'binary_recall': 0.97579247, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9876786}
confusion matrix:
       0      1
0  42413      2
1    349  14068
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.77201486, 'recall': 0.5433588, 'specificity': 0.5433588, 'f1': 0.56826985, 'auroc': 0.918759, 'binary_precision': 0.5769231, 'binary_recall': 0.089153044, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.15444015}
confusion matrix:
       0   1
0  18023  44
1    613  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.6292608, 'recall': 0.5051806, 'specificity': 0.5051806, 'f1': 0.50023973, 'auroc': 0.90890193, 'binary_precision': 0.3, 'binary_recall': 0.011538462, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.02222222}
confusion matrix:
      0  1
0  5939  7
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-29 03:32:00.285896,epoch time: 1:10:02.983505,used: 2:20:23.965597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_01_11_36_seed_1_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99561864, 'precision': 0.99691606, 'recall': 0.99152637, 'specificity': 0.99152637, 'f1': 0.994184, 'auroc': 0.99967873, 'binary_precision': 0.99950653, 'binary_recall': 0.9832178, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.9912953}
confusion matrix:
       0      1
0  42405      7
1    242  14178
---- Validation: 
scalar performance:
{'acc': 0.96707577, 'precision': 0.80961794, 'recall': 0.5888124, 'specificity': 0.5888124, 'f1': 0.6332711, 'auroc': 0.9480621, 'binary_precision': 0.64893615, 'binary_recall': 0.18127786, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.2833914}
confusion matrix:
       0    1
0  18001   66
1    551  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.5416062, 'recall': 0.5013344, 'specificity': 0.5013344, 'f1': 0.49277943, 'auroc': 0.9211056, 'binary_precision': 0.125, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0074626864}
confusion matrix:
      0  1
0  5939  7
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_3.png
better model found
persisted
after epoch: 3,now: 2024-06-29 04:41:18.220218,epoch time: 1:09:17.934322,used: 3:29:41.899919,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_01_11_36_seed_1_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99581224, 'precision': 0.99718624, 'recall': 0.9917699, 'specificity': 0.9917699, 'f1': 0.99444044, 'auroc': 0.99971306, 'binary_precision': 0.9999295, 'binary_recall': 0.98356336, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9916789}
confusion matrix:
       0      1
0  42412      1
1    237  14182
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.7273085, 'recall': 0.5528191, 'specificity': 0.5528191, 'f1': 0.5804622, 'auroc': 0.9305488, 'binary_precision': 0.4868421, 'binary_recall': 0.10995542, 'binary_specificity': 0.9956827, 'binary_f1_score': 0.17939393}
confusion matrix:
       0   1
0  17989  78
1    599  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.479039, 'recall': 0.49966365, 'specificity': 0.49966365, 'f1': 0.489134, 'auroc': 0.9341128, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5942  4
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_4.png
early stop counter: 1
val acc:0.9638740420341492, best validation acc: 0.967075765132904, corresponding to test acc:                         0.9571382403373718 / 0.9574605226516724
after epoch: 4,now: 2024-06-29 05:50:39.853142,epoch time: 1:09:21.632924,used: 4:39:03.532843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_01_11_36_seed_1_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9963401, 'precision': 0.99746567, 'recall': 0.99287933, 'specificity': 0.99287933, 'f1': 0.99514556, 'auroc': 0.99975634, 'binary_precision': 0.9997187, 'binary_recall': 0.98585296, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9927375}
confusion matrix:
       0      1
0  42408      4
1    204  14216
---- Validation: 
scalar performance:
{'acc': 0.96905017, 'precision': 0.87460357, 'recall': 0.59555846, 'specificity': 0.59555846, 'f1': 0.64684707, 'auroc': 0.9351659, 'binary_precision': 0.7784431, 'binary_recall': 0.19316493, 'binary_specificity': 0.99795204, 'binary_f1_score': 0.3095238}
confusion matrix:
       0    1
0  18030   37
1    543  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.47903225, 'recall': 0.49949545, 'specificity': 0.49949545, 'f1': 0.4890499, 'auroc': 0.9046749, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5940  6
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_5.png
better model found
persisted
after epoch: 5,now: 2024-06-29 06:59:54.562898,epoch time: 1:09:14.709756,used: 5:48:18.242599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_01_11_36_seed_1_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9975366, 'precision': 0.9981221, 'recall': 0.99537385, 'specificity': 0.99537385, 'f1': 0.9967383, 'auroc': 0.99980795, 'binary_precision': 0.9993006, 'binary_recall': 0.9909835, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.9951247}
confusion matrix:
       0      1
0  42404     10
1    130  14288
---- Validation: 
scalar performance:
{'acc': 0.9667022, 'precision': 0.7689859, 'recall': 0.6587149, 'specificity': 0.6587149, 'f1': 0.6981993, 'auroc': 0.94944406, 'binary_precision': 0.56265986, 'binary_recall': 0.3268945, 'binary_specificity': 0.99053526, 'binary_f1_score': 0.41353384}
confusion matrix:
       0    1
0  17896  171
1    453  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9555269, 'precision': 0.52914643, 'recall': 0.5023325, 'specificity': 0.5023325, 'f1': 0.49576798, 'auroc': 0.9390403, 'binary_precision': 0.1, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99697274, 'binary_f1_score': 0.014285714}
confusion matrix:
      0   1
0  5928  18
1   258   2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_6.png
early stop counter: 1
val acc:0.9667022228240967, best validation acc: 0.9690501689910889, corresponding to test acc:                         0.9571382403373718 / 0.9574605226516724
after epoch: 6,now: 2024-06-29 08:09:07.683148,epoch time: 1:09:13.120250,used: 6:57:31.362849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_01_11_36_seed_1_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9965512, 'precision': 0.99758255, 'recall': 0.99331737, 'specificity': 0.99331737, 'f1': 0.99542665, 'auroc': 0.9996948, 'binary_precision': 0.9996487, 'binary_recall': 0.9867527, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.9931589}
confusion matrix:
       0      1
0  42409      5
1    191  14227
---- Validation: 
scalar performance:
{'acc': 0.96451443, 'precision': 0.77277154, 'recall': 0.52096415, 'specificity': 0.52096415, 'f1': 0.53106475, 'auroc': 0.93745214, 'binary_precision': 0.58, 'binary_recall': 0.043090638, 'binary_specificity': 0.99883765, 'binary_f1_score': 0.080221295}
confusion matrix:
       0   1
0  18046  21
1    644  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95681596, 'precision': 0.47902548, 'recall': 0.49932727, 'specificity': 0.49932727, 'f1': 0.48896572, 'auroc': 0.9211443, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5938  8
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_7.png
early stop counter: 2
val acc:0.964514434337616, best validation acc: 0.9690501689910889, corresponding to test acc:                         0.9571382403373718 / 0.9574605226516724
after epoch: 7,now: 2024-06-29 09:18:23.781004,epoch time: 1:09:16.097856,used: 8:06:47.460705,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_01_11_36_seed_1_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99785334, 'precision': 0.9980332, 'recall': 0.9962959, 'specificity': 0.9962959, 'f1': 0.9971607, 'auroc': 0.99981034, 'binary_precision': 0.99839646, 'binary_recall': 0.9931341, 'binary_specificity': 0.9994577, 'binary_f1_score': 0.99575835}
confusion matrix:
       0      1
0  42390     23
1     99  14320
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.747139, 'recall': 0.7372239, 'specificity': 0.7372239, 'f1': 0.7420678, 'auroc': 0.9350604, 'binary_precision': 0.5131783, 'binary_recall': 0.49182764, 'binary_specificity': 0.98262024, 'binary_f1_score': 0.5022762}
confusion matrix:
       0    1
0  17753  314
1    342  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535933, 'precision': 0.66584754, 'recall': 0.569366, 'specificity': 0.569366, 'f1': 0.5946032, 'auroc': 0.9165116, 'binary_precision': 0.36792454, 'binary_recall': 0.15, 'binary_specificity': 0.9887319, 'binary_f1_score': 0.21311475}
confusion matrix:
      0   1
0  5879  67
1   221  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_8.png
early stop counter: 3
val acc:0.9649946689605713, best validation acc: 0.9690501689910889, corresponding to test acc:                         0.9571382403373718 / 0.9574605226516724
after epoch: 8,now: 2024-06-29 10:27:44.679612,epoch time: 1:09:20.898608,used: 9:16:08.359313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_01_11_36_seed_1_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99700874, 'precision': 0.9979571, 'recall': 0.9941504, 'specificity': 0.9941504, 'f1': 0.9960351, 'auroc': 0.9997581, 'binary_precision': 0.9998597, 'binary_recall': 0.9883479, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9940704}
confusion matrix:
       0      1
0  42412      2
1    168  14250
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.7706912, 'recall': 0.55056685, 'specificity': 0.55056685, 'f1': 0.57912296, 'auroc': 0.94332546, 'binary_precision': 0.57377046, 'binary_recall': 0.104011886, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.17610063}
confusion matrix:
       0   1
0  18015  52
1    603  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547212, 'precision': 0.4789814, 'recall': 0.4982341, 'specificity': 0.4982341, 'f1': 0.48841807, 'auroc': 0.9079116, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5925  21
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587854_9.png
early stop counter: 4
val acc:0.9650480151176453, best validation acc: 0.9690501689910889, corresponding to test acc:                         0.9571382403373718 / 0.9574605226516724
after epoch: 9,now: 2024-06-29 11:36:59.766367,epoch time: 1:09:15.086755,used: 10:25:23.446068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_29_01_11_36_seed_1_21587854
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21587854 ON gpusrv39 CANCELLED AT 2024-06-29T12:23:18 DUE TO TIME LIMIT ***
