Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jun 27 00:43:49 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851

 Experiment start at: 2024-06-27 00:54:01.027890
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99186534, 'precision': 0.99387324, 'recall': 0.9849007, 'specificity': 0.9849007, 'f1': 0.98928046, 'auroc': 0.99936223, 'binary_precision': 0.997904, 'binary_recall': 0.9705103, 'binary_specificity': 0.9992912, 'binary_f1_score': 0.98401654}
confusion matrix:
       0      1
0  42293     30
1    434  14283
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9661026, 'precision': 0.7422296, 'recall': 0.68392885, 'specificity': 0.68392885, 'f1': 0.708655, 'auroc': 0.9233099, 'binary_precision': 0.50619835, 'binary_recall': 0.38102645, 'binary_specificity': 0.98683125, 'binary_f1_score': 0.4347826}
confusion matrix:
       0    1
0  17910  239
1    398  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.75674194, 'recall': 0.6881487, 'specificity': 0.6881487, 'f1': 0.71647274, 'auroc': 0.881913, 'binary_precision': 0.53968257, 'binary_recall': 0.3908046, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.45333335}
confusion matrix:
      0    1
0  5910   87
1   159  102
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-27 01:20:58.387104,epoch time: 0:26:57.359214,used: 0:26:57.359214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9904278, 'precision': 0.9935601, 'recall': 0.9815165, 'specificity': 0.9815165, 'f1': 0.98734695, 'auroc': 0.9994969, 'binary_precision': 0.9997884, 'binary_recall': 0.9631039, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.98110336}
confusion matrix:
       0      1
0  42320      3
1    543  14174
---- Validation: 
scalar performance:
{'acc': 0.9665283, 'precision': 0.7652022, 'recall': 0.5483892, 'specificity': 0.5483892, 'f1': 0.5760043, 'auroc': 0.9353713, 'binary_precision': 0.5614035, 'binary_recall': 0.09953344, 'binary_specificity': 0.997245, 'binary_f1_score': 0.16908851}
confusion matrix:
       0   1
0  18099  50
1    579  64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.6517979, 'recall': 0.5193219, 'specificity': 0.5193219, 'f1': 0.526457, 'auroc': 0.914209, 'binary_precision': 0.34375, 'binary_recall': 0.042145595, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.07508532}
confusion matrix:
      0   1
0  5976  21
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_2.png
better model found
persisted
after epoch: 2,now: 2024-06-27 01:46:52.585132,epoch time: 0:25:54.198028,used: 0:52:51.557242,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9917426, 'precision': 0.9944969, 'recall': 0.98399806, 'specificity': 0.98399806, 'f1': 0.9891021, 'auroc': 0.9995363, 'binary_precision': 1.0, 'binary_recall': 0.9679962, 'binary_specificity': 1.0, 'binary_f1_score': 0.9837379}
confusion matrix:
       0      1
0  42323      0
1    471  14246
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.8581203, 'recall': 0.5069158, 'specificity': 0.5069158, 'f1': 0.5051158, 'auroc': 0.9483759, 'binary_precision': 0.75, 'binary_recall': 0.01399689, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.027480915}
confusion matrix:
       0  1
0  18146  3
1    634  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9531747, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_3.png
early stop counter: 1
val acc:0.9661026000976562, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.9566954374313354 / 0.9606903195381165
after epoch: 3,now: 2024-06-27 02:12:24.485867,epoch time: 0:25:31.900735,used: 1:18:23.457977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9924439, 'precision': 0.9908723, 'recall': 0.989367, 'specificity': 0.989367, 'f1': 0.99011666, 'auroc': 0.9989805, 'binary_precision': 0.9876417, 'binary_recall': 0.98301053, 'binary_specificity': 0.99572355, 'binary_f1_score': 0.9853207}
confusion matrix:
       0      1
0  42144    181
1    250  14465
---- Validation: 
scalar performance:
{'acc': 0.96482545, 'precision': 0.6938685, 'recall': 0.5347567, 'specificity': 0.5347567, 'f1': 0.55327773, 'auroc': 0.9415976, 'binary_precision': 0.41964287, 'binary_recall': 0.07309487, 'binary_specificity': 0.99641854, 'binary_f1_score': 0.124503314}
confusion matrix:
       0   1
0  18084  65
1    596  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9393822, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_4.png
early stop counter: 2
val acc:0.964825451374054, best validation acc: 0.9665282964706421, corresponding to test acc:                         0.9566954374313354 / 0.9606903195381165
after epoch: 4,now: 2024-06-27 02:37:57.421618,epoch time: 0:25:32.935751,used: 1:43:56.393728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9950561, 'precision': 0.9960036, 'recall': 0.9910835, 'specificity': 0.9910835, 'f1': 0.99351156, 'auroc': 0.9997, 'binary_precision': 0.99793017, 'binary_recall': 0.98287576, 'binary_specificity': 0.9992912, 'binary_f1_score': 0.99034584}
confusion matrix:
       0      1
0  42294     30
1    252  14464
---- Validation: 
scalar performance:
{'acc': 0.9698808, 'precision': 0.8078772, 'recall': 0.633381, 'specificity': 0.633381, 'f1': 0.6833301, 'auroc': 0.9591187, 'binary_precision': 0.64102566, 'binary_recall': 0.27216175, 'binary_specificity': 0.99460024, 'binary_f1_score': 0.38209608}
confusion matrix:
       0    1
0  18051   98
1    468  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.97922325, 'recall': 0.5019157, 'specificity': 0.5019157, 'f1': 0.49320802, 'auroc': 0.95420766, 'binary_precision': 1.0, 'binary_recall': 0.0038314175, 'binary_specificity': 1.0, 'binary_f1_score': 0.007633588}
confusion matrix:
      0  1
0  5997  0
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_5.png
better model found
persisted
after epoch: 5,now: 2024-06-27 03:03:32.167921,epoch time: 0:25:34.746303,used: 2:09:31.140031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99375874, 'precision': 0.99543476, 'recall': 0.9882827, 'specificity': 0.9882827, 'f1': 0.9917911, 'auroc': 0.9993706, 'binary_precision': 0.9988191, 'binary_recall': 0.976967, 'binary_specificity': 0.9995983, 'binary_f1_score': 0.98777217}
confusion matrix:
       0      1
0  42305     17
1    339  14379
---- Validation: 
scalar performance:
{'acc': 0.961473, 'precision': 0.5812108, 'recall': 0.5172699, 'specificity': 0.5172699, 'f1': 0.5236704, 'auroc': 0.93053615, 'binary_precision': 0.19548872, 'binary_recall': 0.04043546, 'binary_specificity': 0.9941044, 'binary_f1_score': 0.06701031}
confusion matrix:
       0    1
0  18042  107
1    617   26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.47910663, 'recall': 0.4989995, 'specificity': 0.4989995, 'f1': 0.48885077, 'auroc': 0.91938174, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.997999, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5985  12
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_6.png
early stop counter: 1
val acc:0.9614729881286621, best validation acc: 0.9698808193206787, corresponding to test acc:                         0.9584531784057617 / 0.9606903195381165
after epoch: 6,now: 2024-06-27 03:29:13.664274,epoch time: 0:25:41.496353,used: 2:35:12.636384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9962833, 'precision': 0.99698555, 'recall': 0.9933076, 'specificity': 0.9933076, 'f1': 0.99512875, 'auroc': 0.99965286, 'binary_precision': 0.99841946, 'binary_recall': 0.9871586, 'binary_specificity': 0.9994565, 'binary_f1_score': 0.99275714}
confusion matrix:
       0      1
0  42299     23
1    189  14529
---- Validation: 
scalar performance:
{'acc': 0.9691358, 'precision': 0.800608, 'recall': 0.6179942, 'specificity': 0.6179942, 'f1': 0.6662541, 'auroc': 0.9447478, 'binary_precision': 0.62753034, 'binary_recall': 0.24105754, 'binary_specificity': 0.99493086, 'binary_f1_score': 0.3483146}
confusion matrix:
       0    1
0  18057   92
1    488  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.47911665, 'recall': 0.49924964, 'specificity': 0.49924964, 'f1': 0.48897603, 'auroc': 0.931532, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5988  9
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_7.png
early stop counter: 2
val acc:0.9691358208656311, best validation acc: 0.9698808193206787, corresponding to test acc:                         0.9584531784057617 / 0.9606903195381165
after epoch: 7,now: 2024-06-27 03:54:55.518996,epoch time: 0:25:41.854722,used: 3:00:54.491106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99586254, 'precision': 0.99466205, 'recall': 0.9945305, 'specificity': 0.9945305, 'f1': 0.99459624, 'auroc': 0.9996296, 'binary_precision': 0.99218273, 'binary_recall': 0.9917782, 'binary_specificity': 0.9972828, 'binary_f1_score': 0.99198043}
confusion matrix:
       0      1
0  42208    115
1    121  14596
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.7579375, 'recall': 0.6990064, 'specificity': 0.6990064, 'f1': 0.7242724, 'auroc': 0.95681465, 'binary_precision': 0.5365854, 'binary_recall': 0.41057542, 'binary_specificity': 0.9874373, 'binary_f1_score': 0.46519822}
confusion matrix:
       0    1
0  17921  228
1    379  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.6458833, 'recall': 0.501749, 'specificity': 0.501749, 'f1': 0.49309576, 'auroc': 0.9558975, 'binary_precision': 0.33333334, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5995  2
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_8.png
early stop counter: 3
val acc:0.9676989912986755, best validation acc: 0.9698808193206787, corresponding to test acc:                         0.9584531784057617 / 0.9606903195381165
after epoch: 8,now: 2024-06-27 04:21:03.369684,epoch time: 0:26:07.850688,used: 3:27:02.341794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99551195, 'precision': 0.9944002, 'recall': 0.9938741, 'specificity': 0.9938741, 'f1': 0.99413675, 'auroc': 0.99971163, 'binary_precision': 0.9921067, 'binary_recall': 0.9904891, 'binary_specificity': 0.99725896, 'binary_f1_score': 0.99129725}
confusion matrix:
       0      1
0  42204    116
1    140  14580
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.7580235, 'recall': 0.8627939, 'specificity': 0.8627939, 'f1': 0.80049, 'auroc': 0.96391934, 'binary_precision': 0.52505445, 'binary_recall': 0.7496112, 'binary_specificity': 0.97597665, 'binary_f1_score': 0.6175529}
confusion matrix:
       0    1
0  17713  436
1    161  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.87542844, 'recall': 0.7382944, 'specificity': 0.7382944, 'f1': 0.7900577, 'auroc': 0.9614855, 'binary_precision': 0.77300614, 'binary_recall': 0.4827586, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.59433967}
confusion matrix:
      0    1
0  5960   37
1   135  126
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_9.png
new oracle model saved
early stop counter: 4
val acc:0.9682311415672302, best validation acc: 0.9698808193206787, corresponding to test acc:                         0.9584531784057617 / 0.9725151658058167
after epoch: 9,now: 2024-06-27 04:47:13.786962,epoch time: 0:26:10.417278,used: 3:53:12.759072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99663395, 'precision': 0.99744684, 'recall': 0.99376583, 'specificity': 0.99376583, 'f1': 0.9955884, 'auroc': 0.9996614, 'binary_precision': 0.9991067, 'binary_recall': 0.98783886, 'binary_specificity': 0.9996928, 'binary_f1_score': 0.9934408}
confusion matrix:
       0      1
0  42308     13
1    179  14540
---- Validation: 
scalar performance:
{'acc': 0.97190297, 'precision': 0.84100103, 'recall': 0.6509291, 'specificity': 0.6509291, 'f1': 0.706465, 'auroc': 0.961373, 'binary_precision': 0.7060932, 'binary_recall': 0.30637637, 'binary_specificity': 0.99548185, 'binary_f1_score': 0.42733192}
confusion matrix:
       0    1
0  18067   82
1    446  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292932, 'recall': 0.5036647, 'specificity': 0.5036647, 'f1': 0.496895, 'auroc': 0.95194626, 'binary_precision': 0.5, 'binary_recall': 0.007662835, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.015094339}
confusion matrix:
      0  1
0  5995  2
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_10.png
better model found
persisted
after epoch: 10,now: 2024-06-27 05:13:23.637859,epoch time: 0:26:09.850897,used: 4:19:22.609969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9956346, 'precision': 0.9970527, 'recall': 0.9915614, 'specificity': 0.9915614, 'f1': 0.99426734, 'auroc': 0.9998386, 'binary_precision': 0.99993086, 'binary_recall': 0.9831464, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99146765}
confusion matrix:
       0      1
0  42324      1
1    248  14467
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.86929536, 'recall': 0.5538538, 'specificity': 0.5538538, 'f1': 0.5873081, 'auroc': 0.96354526, 'binary_precision': 0.7692308, 'binary_recall': 0.108864695, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.19073568}
confusion matrix:
       0   1
0  18128  21
1    573  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.47910663, 'recall': 0.4989995, 'specificity': 0.4989995, 'f1': 0.48885077, 'auroc': 0.9624287, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.997999, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5985  12
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_11.png
early stop counter: 1
val acc:0.9683908224105835, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9582933783531189 / 0.9725151658058167
after epoch: 11,now: 2024-06-27 05:39:40.987625,epoch time: 0:26:17.349766,used: 4:45:39.959735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9985975, 'precision': 0.9987885, 'recall': 0.9975483, 'specificity': 0.9975483, 'f1': 0.9981664, 'auroc': 0.9999311, 'binary_precision': 0.9991816, 'binary_recall': 0.9953801, 'binary_specificity': 0.99971646, 'binary_f1_score': 0.99727726}
confusion matrix:
       0      1
0  42309     12
1     68  14651
---- Validation: 
scalar performance:
{'acc': 0.9737122, 'precision': 0.80128074, 'recall': 0.8003768, 'specificity': 0.8003768, 'f1': 0.800828, 'auroc': 0.96254003, 'binary_precision': 0.61622465, 'binary_recall': 0.61430794, 'binary_specificity': 0.98644555, 'binary_f1_score': 0.6152648}
confusion matrix:
       0    1
0  17903  246
1    248  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96596354, 'precision': 0.8840563, 'recall': 0.6212714, 'specificity': 0.6212714, 'f1': 0.6789359, 'auroc': 0.96280897, 'binary_precision': 0.8, 'binary_recall': 0.24521072, 'binary_specificity': 0.997332, 'binary_f1_score': 0.37536657}
confusion matrix:
      0   1
0  5981  16
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_12.png
better model found
persisted
after epoch: 12,now: 2024-06-27 06:05:20.645443,epoch time: 0:25:39.657818,used: 5:11:19.617553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99765074, 'precision': 0.9982641, 'recall': 0.99560285, 'specificity': 0.99560285, 'f1': 0.9969241, 'auroc': 0.9998486, 'binary_precision': 0.9995205, 'binary_recall': 0.9913711, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.9954291}
confusion matrix:
       0      1
0  42315      7
1    127  14591
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.8414335, 'recall': 0.5421622, 'specificity': 0.5421622, 'f1': 0.56811523, 'auroc': 0.9441147, 'binary_precision': 0.71428573, 'binary_recall': 0.08553655, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.15277778}
confusion matrix:
       0   1
0  18127  22
1    588  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.6612483, 'recall': 0.50707924, 'specificity': 0.50707924, 'f1': 0.5039251, 'auroc': 0.92175096, 'binary_precision': 0.36363637, 'binary_recall': 0.01532567, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.029411763}
confusion matrix:
      0  1
0  5990  7
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_13.png
early stop counter: 1
val acc:0.967539370059967, best validation acc: 0.9737122058868408, corresponding to test acc:                         0.9659635424613953 / 0.9725151658058167
after epoch: 13,now: 2024-06-27 06:30:57.532208,epoch time: 0:25:36.886765,used: 5:36:56.504318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9962132, 'precision': 0.9972559, 'recall': 0.992861, 'specificity': 0.992861, 'f1': 0.99503297, 'auroc': 0.9997943, 'binary_precision': 0.9993801, 'binary_recall': 0.9859346, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.9926118}
confusion matrix:
       0      1
0  42314      9
1    207  14510
---- Validation: 
scalar performance:
{'acc': 0.968444, 'precision': 0.8598063, 'recall': 0.5576316, 'specificity': 0.5576316, 'f1': 0.592894, 'auroc': 0.9520967, 'binary_precision': 0.75, 'binary_recall': 0.11664075, 'binary_specificity': 0.99862254, 'binary_f1_score': 0.20188425}
confusion matrix:
       0   1
0  18124  25
1    568  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.5417, 'recall': 0.5013321, 'specificity': 0.5013321, 'f1': 0.4928169, 'auroc': 0.9392757, 'binary_precision': 0.125, 'binary_recall': 0.0038314175, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.007434944}
confusion matrix:
      0  1
0  5990  7
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_14.png
early stop counter: 2
val acc:0.9684439897537231, best validation acc: 0.9737122058868408, corresponding to test acc:                         0.9659635424613953 / 0.9725151658058167
after epoch: 14,now: 2024-06-27 06:56:15.897397,epoch time: 0:25:18.365189,used: 6:02:14.869507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99275947, 'precision': 0.98960376, 'recall': 0.9915297, 'specificity': 0.9915297, 'f1': 0.99056166, 'auroc': 0.9988938, 'binary_precision': 0.98304284, 'binary_recall': 0.98898935, 'binary_specificity': 0.99407, 'binary_f1_score': 0.9860071}
confusion matrix:
       0      1
0  42076    251
1    162  14551
---- Validation: 
scalar performance:
{'acc': 0.95226693, 'precision': 0.6798289, 'recall': 0.7772733, 'specificity': 0.7772733, 'f1': 0.7165201, 'auroc': 0.9417394, 'binary_precision': 0.37450594, 'binary_recall': 0.58942455, 'binary_specificity': 0.96512204, 'binary_f1_score': 0.45800605}
confusion matrix:
       0    1
0  17516  633
1    264  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9006072, 'precision': 0.6040461, 'recall': 0.74658406, 'specificity': 0.74658406, 'f1': 0.6365911, 'auroc': 0.8704327, 'binary_precision': 0.22775264, 'binary_recall': 0.5785441, 'binary_specificity': 0.914624, 'binary_f1_score': 0.32683986}
confusion matrix:
      0    1
0  5485  512
1   110  151
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_15.png
early stop counter: 3
val acc:0.9522669315338135, best validation acc: 0.9737122058868408, corresponding to test acc:                         0.9659635424613953 / 0.9725151658058167
after epoch: 15,now: 2024-06-27 07:22:09.287204,epoch time: 0:25:53.389807,used: 6:28:08.259314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9950561, 'precision': 0.9964375, 'recall': 0.99066365, 'specificity': 0.99066365, 'f1': 0.99350655, 'auroc': 0.99975014, 'binary_precision': 0.99923915, 'binary_recall': 0.9815872, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.99033445}
confusion matrix:
       0      1
0  42311     11
1    271  14447
---- Validation: 
scalar performance:
{'acc': 0.96929544, 'precision': 0.8774631, 'recall': 0.5700733, 'specificity': 0.5700733, 'f1': 0.61206025, 'auroc': 0.95934874, 'binary_precision': 0.7844828, 'binary_recall': 0.1415241, 'binary_specificity': 0.99862254, 'binary_f1_score': 0.23978919}
confusion matrix:
       0   1
0  18124  25
1    552  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.927814, 'recall': 0.5324003, 'specificity': 0.5324003, 'f1': 0.550662, 'auroc': 0.9576025, 'binary_precision': 0.8947368, 'binary_recall': 0.0651341, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.12142857}
confusion matrix:
      0   1
0  5995   2
1   244  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_16.png
early stop counter: 4
val acc:0.9692954421043396, best validation acc: 0.9737122058868408, corresponding to test acc:                         0.9659635424613953 / 0.9725151658058167
after epoch: 16,now: 2024-06-27 07:47:30.811062,epoch time: 0:25:21.523858,used: 6:53:29.783172,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99645865, 'precision': 0.9973521, 'recall': 0.99340177, 'specificity': 0.99340177, 'f1': 0.9953564, 'auroc': 0.99983287, 'binary_precision': 0.9991745, 'binary_recall': 0.98708713, 'binary_specificity': 0.99971646, 'binary_f1_score': 0.993094}
confusion matrix:
       0      1
0  42314     12
1    190  14524
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.7418856, 'recall': 0.5112784, 'specificity': 0.5112784, 'f1': 0.513625, 'auroc': 0.9575808, 'binary_precision': 0.51724136, 'binary_recall': 0.02332815, 'binary_specificity': 0.9992286, 'binary_f1_score': 0.044642862}
confusion matrix:
       0   1
0  18135  14
1    628  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.93449694, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_17.png
early stop counter: 5
val acc:0.9658365249633789, best validation acc: 0.9737122058868408, corresponding to test acc:                         0.9659635424613953 / 0.9725151658058167
after epoch: 17,now: 2024-06-27 08:13:50.818435,epoch time: 0:26:20.007373,used: 7:19:49.790545,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9973177, 'precision': 0.9980859, 'recall': 0.9949124, 'specificity': 0.9949124, 'f1': 0.9964858, 'auroc': 0.99992853, 'binary_precision': 0.9996569, 'binary_recall': 0.9899429, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.9947762}
confusion matrix:
       0      1
0  42319      5
1    148  14568
---- Validation: 
scalar performance:
{'acc': 0.97184974, 'precision': 0.8690784, 'recall': 0.6268998, 'specificity': 0.6268998, 'f1': 0.6848816, 'auroc': 0.9619328, 'binary_precision': 0.7638889, 'binary_recall': 0.25660965, 'binary_specificity': 0.99718994, 'binary_f1_score': 0.38416764}
confusion matrix:
       0    1
0  18098   51
1    478  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.69386613, 'recall': 0.51082724, 'specificity': 0.51082724, 'f1': 0.51107556, 'auroc': 0.9411732, 'binary_precision': 0.42857143, 'binary_recall': 0.022988506, 'binary_specificity': 0.998666, 'binary_f1_score': 0.043636363}
confusion matrix:
      0  1
0  5989  8
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_18.png
early stop counter: 6
val acc:0.9718497395515442, best validation acc: 0.9737122058868408, corresponding to test acc:                         0.9659635424613953 / 0.9725151658058167
after epoch: 18,now: 2024-06-27 08:39:41.586437,epoch time: 0:25:50.768002,used: 7:45:40.558547,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9979137, 'precision': 0.99817175, 'recall': 0.9963777, 'specificity': 0.9963777, 'f1': 0.99727046, 'auroc': 0.99992263, 'binary_precision': 0.99870163, 'binary_recall': 0.99320424, 'binary_specificity': 0.9995511, 'binary_f1_score': 0.99594533}
confusion matrix:
       0      1
0  42306     19
1    100  14615
---- Validation: 
scalar performance:
{'acc': 0.97110474, 'precision': 0.79552394, 'recall': 0.70902014, 'specificity': 0.70902014, 'f1': 0.7441609, 'auroc': 0.96477306, 'binary_precision': 0.6111111, 'binary_recall': 0.42768273, 'binary_specificity': 0.9903576, 'binary_f1_score': 0.5032022}
confusion matrix:
       0    1
0  17974  175
1    368  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.9581425, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_19.png
early stop counter: 7
val acc:0.9711047410964966, best validation acc: 0.9737122058868408, corresponding to test acc:                         0.9659635424613953 / 0.9725151658058167
after epoch: 19,now: 2024-06-27 09:06:15.830684,epoch time: 0:26:34.244247,used: 8:12:14.802794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9977209, 'precision': 0.998469, 'recall': 0.9955827, 'specificity': 0.9955827, 'f1': 0.9970149, 'auroc': 0.99992305, 'binary_precision': 1.0, 'binary_recall': 0.99116546, 'binary_specificity': 1.0, 'binary_f1_score': 0.99556315}
confusion matrix:
       0      1
0  42325      0
1    130  14585
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.8929025, 'recall': 0.5277734, 'specificity': 0.5277734, 'f1': 0.54406774, 'auroc': 0.961084, 'binary_precision': 0.8181818, 'binary_recall': 0.05598756, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.104803495}
confusion matrix:
       0   1
0  18141   8
1    607  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.47913003, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.48914286, 'auroc': 0.92186147, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_20.png
early stop counter: 8
val acc:0.9672732949256897, best validation acc: 0.9737122058868408, corresponding to test acc:                         0.9659635424613953 / 0.9725151658058167
after epoch: 20,now: 2024-06-27 09:31:38.601224,epoch time: 0:25:22.770540,used: 8:37:37.573334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9982994, 'precision': 0.9983427, 'recall': 0.9972142, 'specificity': 0.9972142, 'f1': 0.99777675, 'auroc': 0.99988914, 'binary_precision': 0.99843174, 'binary_recall': 0.9949718, 'binary_specificity': 0.9994566, 'binary_f1_score': 0.99669874}
confusion matrix:
       0      1
0  42300     23
1     74  14643
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.79774094, 'recall': 0.60424525, 'specificity': 0.60424525, 'f1': 0.6507286, 'auroc': 0.9578514, 'binary_precision': 0.6227273, 'binary_recall': 0.21306376, 'binary_specificity': 0.9954268, 'binary_f1_score': 0.31749707}
confusion matrix:
       0    1
0  18066   83
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.47910663, 'recall': 0.4989995, 'specificity': 0.4989995, 'f1': 0.48885077, 'auroc': 0.94721293, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.997999, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5985  12
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_21.png
early stop counter: 9
val acc:0.9686568975448608, best validation acc: 0.9737122058868408, corresponding to test acc:                         0.9659635424613953 / 0.9725151658058167
after epoch: 21,now: 2024-06-27 09:58:19.402792,epoch time: 0:26:40.801568,used: 9:04:18.374902,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9970021, 'precision': 0.9978745, 'recall': 0.99430156, 'specificity': 0.99430156, 'f1': 0.9960712, 'auroc': 0.99976945, 'binary_precision': 0.9996565, 'binary_recall': 0.9887213, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99415886}
confusion matrix:
       0      1
0  42317      5
1    166  14552
---- Validation: 
scalar performance:
{'acc': 0.9702533, 'precision': 0.8516823, 'recall': 0.6020715, 'specificity': 0.6020715, 'f1': 0.65360856, 'auroc': 0.96414316, 'binary_precision': 0.7307692, 'binary_recall': 0.20684293, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.32242423}
confusion matrix:
       0    1
0  18100   49
1    510  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.78634953, 'recall': 0.5409784, 'specificity': 0.5409784, 'f1': 0.56372136, 'auroc': 0.95934963, 'binary_precision': 0.6111111, 'binary_recall': 0.08429119, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.14814816}
confusion matrix:
      0   1
0  5983  14
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_22.png
early stop counter: 10
val acc:0.9702532887458801, best validation acc: 0.9737122058868408, corresponding to test acc:                         0.9659635424613953 / 0.9725151658058167
after epoch: 22,now: 2024-06-27 10:23:43.332229,epoch time: 0:25:23.929437,used: 9:29:42.304339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99803644, 'precision': 0.9980985, 'recall': 0.99677086, 'specificity': 0.99677086, 'f1': 0.99743235, 'auroc': 0.9998615, 'binary_precision': 0.998226, 'binary_recall': 0.994156, 'binary_specificity': 0.9993857, 'binary_f1_score': 0.9961868}
confusion matrix:
       0      1
0  42298     26
1     86  14630
---- Validation: 
scalar performance:
{'acc': 0.971424, 'precision': 0.8062647, 'recall': 0.69118416, 'specificity': 0.69118416, 'f1': 0.73423135, 'auroc': 0.9582895, 'binary_precision': 0.63383836, 'binary_recall': 0.3903577, 'binary_specificity': 0.9920106, 'binary_f1_score': 0.4831569}
confusion matrix:
       0    1
0  18004  145
1    392  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608501, 'precision': 0.79867697, 'recall': 0.57096267, 'specificity': 0.57096267, 'f1': 0.60833496, 'auroc': 0.95861435, 'binary_precision': 0.6333333, 'binary_recall': 0.14559387, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.23676012}
confusion matrix:
      0   1
0  5975  22
1   223  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_23.png
early stop counter: 11
val acc:0.9714239835739136, best validation acc: 0.9737122058868408, corresponding to test acc:                         0.9659635424613953 / 0.9725151658058167
after epoch: 23,now: 2024-06-27 10:49:12.119894,epoch time: 0:25:28.787665,used: 9:55:11.092004,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9975105, 'precision': 0.9976768, 'recall': 0.99581856, 'specificity': 0.99581856, 'f1': 0.9967431, 'auroc': 0.9998621, 'binary_precision': 0.9980183, 'binary_recall': 0.9923223, 'binary_specificity': 0.9993148, 'binary_f1_score': 0.9951621}
confusion matrix:
       0      1
0  42293     29
1    113  14605
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.76576436, 'recall': 0.64658517, 'specificity': 0.64658517, 'f1': 0.6873113, 'auroc': 0.9196763, 'binary_precision': 0.55587393, 'binary_recall': 0.30171072, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.39112902}
confusion matrix:
       0    1
0  17994  155
1    449  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.83474874, 'recall': 0.6485063, 'specificity': 0.6485063, 'f1': 0.70233524, 'auroc': 0.96398056, 'binary_precision': 0.69911504, 'binary_recall': 0.30268198, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.4224599}
confusion matrix:
      0   1
0  5963  34
1   182  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_24.png
early stop counter: 12
val acc:0.9678586721420288, best validation acc: 0.9737122058868408, corresponding to test acc:                         0.9659635424613953 / 0.9725151658058167
after epoch: 24,now: 2024-06-27 11:15:12.458965,epoch time: 0:26:00.339071,used: 10:21:11.431075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9980014, 'precision': 0.9985444, 'recall': 0.9962372, 'specificity': 0.9962372, 'f1': 0.99738383, 'auroc': 0.99993104, 'binary_precision': 0.9996578, 'binary_recall': 0.9925926, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99611264}
confusion matrix:
       0      1
0  42320      5
1    109  14606
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.7976726, 'recall': 0.56849676, 'specificity': 0.56849676, 'f1': 0.60611033, 'auroc': 0.93418735, 'binary_precision': 0.625, 'binary_recall': 0.1399689, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.22871666}
confusion matrix:
       0   1
0  18095  54
1    553  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.47913337, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48918456, 'auroc': 0.9497049, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_25.png
early stop counter: 13
val acc:0.9676989912986755, best validation acc: 0.9737122058868408, corresponding to test acc:                         0.9659635424613953 / 0.9725151658058167
after epoch: 25,now: 2024-06-27 11:40:21.689208,epoch time: 0:25:09.230243,used: 10:46:20.661318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99549437, 'precision': 0.99242735, 'recall': 0.9958779, 'specificity': 0.9958779, 'f1': 0.9941366, 'auroc': 0.9998995, 'binary_precision': 0.9860168, 'binary_recall': 0.9966703, 'binary_specificity': 0.99508554, 'binary_f1_score': 0.99131495}
confusion matrix:
       0      1
0  42116    208
1     49  14667
---- Validation: 
scalar performance:
{'acc': 0.966688, 'precision': 0.74807596, 'recall': 0.7577373, 'specificity': 0.7577373, 'f1': 0.7528037, 'auroc': 0.95392287, 'binary_precision': 0.5127055, 'binary_recall': 0.533437, 'binary_specificity': 0.9820376, 'binary_f1_score': 0.52286583}
confusion matrix:
       0    1
0  17823  326
1    300  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.8555101, 'recall': 0.5339825, 'specificity': 0.5339825, 'f1': 0.5529788, 'auroc': 0.9351481, 'binary_precision': 0.75, 'binary_recall': 0.06896552, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.12631579}
confusion matrix:
      0   1
0  5991   6
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_26.png
early stop counter: 14
val acc:0.9666879773139954, best validation acc: 0.9737122058868408, corresponding to test acc:                         0.9659635424613953 / 0.9725151658058167
after epoch: 26,now: 2024-06-27 12:06:01.591813,epoch time: 0:25:39.902605,used: 11:12:00.563923,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9984923, 'precision': 0.9981853, 'recall': 0.997876, 'specificity': 0.997876, 'f1': 0.99803054, 'auroc': 0.9999199, 'binary_precision': 0.9975515, 'binary_recall': 0.9966026, 'binary_specificity': 0.9991494, 'binary_f1_score': 0.99707687}
confusion matrix:
       0      1
0  42287     36
1     50  14667
---- Validation: 
scalar performance:
{'acc': 0.97498935, 'precision': 0.8406248, 'recall': 0.73203284, 'specificity': 0.73203284, 'f1': 0.77516156, 'auroc': 0.9660133, 'binary_precision': 0.6997691, 'binary_recall': 0.47122863, 'binary_specificity': 0.9928371, 'binary_f1_score': 0.563197}
confusion matrix:
       0    1
0  18019  130
1    340  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.73560524, 'recall': 0.5550534, 'specificity': 0.5550534, 'f1': 0.5830907, 'auroc': 0.9562744, 'binary_precision': 0.5084746, 'binary_recall': 0.11494253, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.18749999}
confusion matrix:
      0   1
0  5968  29
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_27.png
better model found
persisted
after epoch: 27,now: 2024-06-27 12:32:41.766123,epoch time: 0:26:40.174310,used: 11:38:40.738233,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9965989, 'precision': 0.99733293, 'recall': 0.99378526, 'specificity': 0.99378526, 'f1': 0.99554247, 'auroc': 0.9995881, 'binary_precision': 0.9988321, 'binary_recall': 0.98797226, 'binary_specificity': 0.9995983, 'binary_f1_score': 0.9933725}
confusion matrix:
       0      1
0  42307     17
1    177  14539
---- Validation: 
scalar performance:
{'acc': 0.97121114, 'precision': 0.9262295, 'recall': 0.5913166, 'specificity': 0.5913166, 'f1': 0.644517, 'auroc': 0.96380043, 'binary_precision': 0.880597, 'binary_recall': 0.18351477, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.3037323}
confusion matrix:
       0    1
0  18133   16
1    525  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.95361936, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_28.png
early stop counter: 1
val acc:0.9712111353874207, best validation acc: 0.9749893546104431, corresponding to test acc:                         0.9584531784057617 / 0.9725151658058167
after epoch: 28,now: 2024-06-27 12:58:38.492043,epoch time: 0:25:56.725920,used: 12:04:37.464153,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9985975, 'precision': 0.9984108, 'recall': 0.99792415, 'specificity': 0.99792415, 'f1': 0.9981672, 'auroc': 0.9998827, 'binary_precision': 0.9980259, 'binary_recall': 0.99653345, 'binary_specificity': 0.99931484, 'binary_f1_score': 0.99727917}
confusion matrix:
       0      1
0  42299     29
1     51  14661
---- Validation: 
scalar performance:
{'acc': 0.9705726, 'precision': 0.79022825, 'recall': 0.7034943, 'specificity': 0.7034943, 'f1': 0.738521, 'auroc': 0.9245442, 'binary_precision': 0.60089684, 'binary_recall': 0.41679627, 'binary_specificity': 0.9901923, 'binary_f1_score': 0.4921947}
confusion matrix:
       0    1
0  17971  178
1    375  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9485459, 'precision': 0.664577, 'recall': 0.63783616, 'specificity': 0.63783616, 'f1': 0.6498056, 'auroc': 0.8903372, 'binary_precision': 0.359447, 'binary_recall': 0.29885057, 'binary_specificity': 0.9768217, 'binary_f1_score': 0.32635984}
confusion matrix:
      0    1
0  5858  139
1   183   78
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_29.png
early stop counter: 2
val acc:0.9705725908279419, best validation acc: 0.9749893546104431, corresponding to test acc:                         0.9584531784057617 / 0.9725151658058167
after epoch: 29,now: 2024-06-27 13:24:22.932546,epoch time: 0:25:44.440503,used: 12:30:21.904656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99873775, 'precision': 0.99870515, 'recall': 0.99799705, 'specificity': 0.99799705, 'f1': 0.9983505, 'auroc': 0.9998811, 'binary_precision': 0.9986381, 'binary_recall': 0.9964667, 'binary_specificity': 0.99952745, 'binary_f1_score': 0.9975512}
confusion matrix:
       0      1
0  42303     20
1     52  14665
---- Validation: 
scalar performance:
{'acc': 0.97318006, 'precision': 0.8055135, 'recall': 0.7603483, 'specificity': 0.7603483, 'f1': 0.78095496, 'auroc': 0.9642148, 'binary_precision': 0.62752295, 'binary_recall': 0.5318818, 'binary_specificity': 0.98881483, 'binary_f1_score': 0.57575756}
confusion matrix:
       0    1
0  17946  203
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.65978503, 'recall': 0.51590735, 'specificity': 0.51590735, 'f1': 0.52051187, 'auroc': 0.9299134, 'binary_precision': 0.36, 'binary_recall': 0.03448276, 'binary_specificity': 0.997332, 'binary_f1_score': 0.062937066}
confusion matrix:
      0   1
0  5981  16
1   252   9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_30.png
early stop counter: 3
val acc:0.9731800556182861, best validation acc: 0.9749893546104431, corresponding to test acc:                         0.9584531784057617 / 0.9725151658058167
after epoch: 30,now: 2024-06-27 13:50:10.176400,epoch time: 0:25:47.243854,used: 12:56:09.148510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_54_00_seed_0_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:56:09.148510 at 2024-06-27 13:50:10.176400
persisted model performance metric: 

scalar performance:
{'acc': 0.9584532, 'precision': 0.73560524, 'recall': 0.5550534, 'specificity': 0.5550534, 'f1': 0.5830907, 'auroc': 0.9562744, 'binary_precision': 0.5084746, 'binary_recall': 0.11494253, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.18749999}
confusion matrix:
      0   1
0  5968  29
1   231  30
oracle model performance metric: 

scalar performance:
{'acc': 0.97251517, 'precision': 0.87542844, 'recall': 0.7382944, 'specificity': 0.7382944, 'f1': 0.7900577, 'auroc': 0.9614855, 'binary_precision': 0.77300614, 'binary_recall': 0.4827586, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.59433967}
confusion matrix:
      0    1
0  5960   37
1   135  126
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |  41687 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |  41687 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1459 TiB |   1459 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1442 TiB |   1442 TiB |
|       from small pool |  40679 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446619 KiB |   1251 MiB |   1031 TiB |   1031 TiB |
|       from large pool | 435058 KiB |   1243 MiB |   1015 TiB |   1015 TiB |
|       from small pool |  11560 KiB |     17 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8135    |  253134 K  |  253130 K  |
|       from large pool |     187    |    1413    |  133138 K  |  133138 K  |
|       from small pool |    3301    |    7946    |  119995 K  |  119992 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8135    |  253134 K  |  253130 K  |
|       from large pool |     187    |    1413    |  133138 K  |  133138 K  |
|       from small pool |    3301    |    7946    |  119995 K  |  119992 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |     636    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    3628    |  165644 K  |  165644 K  |
|       from large pool |      37    |     600    |   99849 K  |   99849 K  |
|       from small pool |      43    |    3590    |   65795 K  |   65795 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1459 TiB |   1459 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1442 TiB |   1442 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  14484 MiB |  13602 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1031 TiB |   1031 TiB |
|       from large pool |  24320 KiB |   1243 MiB |   1015 TiB |   1015 TiB |
|       from small pool |      0 KiB |     44 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133138 K  |  133138 K  |
|       from small pool |       0    |    7946    |  119995 K  |  119995 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133138 K  |  133138 K  |
|       from small pool |       0    |    7946    |  119995 K  |  119995 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |     636    |     573    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3628    |  165646 K  |  165646 K  |
|       from large pool |       4    |     600    |   99849 K  |   99849 K  |
|       from small pool |       0    |    3590    |   65796 K  |   65796 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1459 TiB |   1459 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1442 TiB |   1442 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  14484 MiB |  13602 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1031 TiB |   1031 TiB |
|       from large pool |  24320 KiB |   1243 MiB |   1015 TiB |   1015 TiB |
|       from small pool |      0 KiB |     44 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133138 K  |  133138 K  |
|       from small pool |       0    |    7946    |  119995 K  |  119995 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133138 K  |  133138 K  |
|       from small pool |       0    |    7946    |  119995 K  |  119995 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |     636    |     573    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3628    |  165646 K  |  165646 K  |
|       from large pool |       4    |     600    |   99849 K  |   99849 K  |
|       from small pool |       0    |    3590    |   65796 K  |   65796 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851

 Experiment start at: 2024-06-27 13:58:24.828494
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.991818, 'precision': 0.99349, 'recall': 0.9849064, 'specificity': 0.9849064, 'f1': 0.9891032, 'auroc': 0.998971, 'binary_precision': 0.996796, 'binary_recall': 0.9708738, 'binary_specificity': 0.998939, 'binary_f1_score': 0.9836642}
confusion matrix:
       0      1
0  42367     45
1    420  14000
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.74518764, 'recall': 0.7385161, 'specificity': 0.7385161, 'f1': 0.7418003, 'auroc': 0.9366864, 'binary_precision': 0.5091743, 'binary_recall': 0.4947994, 'binary_specificity': 0.9822328, 'binary_f1_score': 0.5018839}
confusion matrix:
       0    1
0  17746  321
1    340  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96471155, 'precision': 0.85732543, 'recall': 0.61746484, 'specificity': 0.61746484, 'f1': 0.67168516, 'auroc': 0.93257767, 'binary_precision': 0.74698794, 'binary_recall': 0.23846154, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.36151603}
confusion matrix:
      0   1
0  5925  21
1   198  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-27 14:24:13.313643,epoch time: 0:25:48.485149,used: 0:25:48.485149,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9928737, 'precision': 0.99339193, 'recall': 0.9877641, 'specificity': 0.9877641, 'f1': 0.99053705, 'auroc': 0.9990664, 'binary_precision': 0.99442565, 'binary_recall': 0.97739094, 'binary_specificity': 0.99813735, 'binary_f1_score': 0.9858347}
confusion matrix:
       0      1
0  42334     79
1    326  14093
---- Validation: 
scalar performance:
{'acc': 0.9685699, 'precision': 0.80524236, 'recall': 0.6425171, 'specificity': 0.6425171, 'f1': 0.6917274, 'auroc': 0.9345238, 'binary_precision': 0.6363636, 'binary_recall': 0.29123327, 'binary_specificity': 0.9938009, 'binary_f1_score': 0.39959222}
confusion matrix:
       0    1
0  17955  112
1    477  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.8099879, 'recall': 0.7420224, 'specificity': 0.7420224, 'f1': 0.7713334, 'auroc': 0.9051229, 'binary_precision': 0.64179105, 'binary_recall': 0.49615383, 'binary_specificity': 0.987891, 'binary_f1_score': 0.55965286}
confusion matrix:
      0    1
0  5874   72
1   131  129
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-27 16:15:19.340343,epoch time: 1:51:06.026700,used: 2:16:54.511849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99477404, 'precision': 0.99600077, 'recall': 0.990204, 'specificity': 0.990204, 'f1': 0.9930592, 'auroc': 0.9996532, 'binary_precision': 0.9984469, 'binary_recall': 0.98092663, 'binary_specificity': 0.9994813, 'binary_f1_score': 0.98960924}
confusion matrix:
       0      1
0  42392     22
1    275  14143
---- Validation: 
scalar performance:
{'acc': 0.96179295, 'precision': 0.7225794, 'recall': 0.70981383, 'specificity': 0.70981383, 'f1': 0.7159839, 'auroc': 0.92862916, 'binary_precision': 0.46603477, 'binary_recall': 0.4383358, 'binary_specificity': 0.98129183, 'binary_f1_score': 0.4517611}
confusion matrix:
       0    1
0  17729  338
1    378  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962778, 'precision': 0.8297037, 'recall': 0.5980659, 'specificity': 0.5980659, 'f1': 0.6456603, 'auroc': 0.9253408, 'binary_precision': 0.6933333, 'binary_recall': 0.2, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.31044778}
confusion matrix:
      0   1
0  5923  23
1   208  52
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_3.png
early stop counter: 1
val acc:0.9617929458618164, best validation acc: 0.9685698747634888, corresponding to test acc:                         0.9672897458076477 / 0.9672897458076477
after epoch: 3,now: 2024-06-27 17:34:02.633621,epoch time: 1:18:43.293278,used: 3:35:37.805127,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9958474, 'precision': 0.99718595, 'recall': 0.9918621, 'specificity': 0.9918621, 'f1': 0.99448764, 'auroc': 0.9997971, 'binary_precision': 0.99985904, 'binary_recall': 0.9837714, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.99174994}
confusion matrix:
       0      1
0  42411      2
1    234  14185
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.91611934, 'recall': 0.54727155, 'specificity': 0.54727155, 'f1': 0.57725036, 'auroc': 0.9533018, 'binary_precision': 0.8648649, 'binary_recall': 0.09509658, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.17135207}
confusion matrix:
       0   1
0  18057  10
1    609  64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.931555, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_4.png
early stop counter: 2
val acc:0.9669690728187561, best validation acc: 0.9685698747634888, corresponding to test acc:                         0.9672897458076477 / 0.9672897458076477
after epoch: 4,now: 2024-06-27 18:09:12.654945,epoch time: 0:35:10.021324,used: 4:10:47.826451,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9964809, 'precision': 0.9975357, 'recall': 0.99317914, 'specificity': 0.99317914, 'f1': 0.9953331, 'auroc': 0.9996815, 'binary_precision': 0.99964863, 'binary_recall': 0.9864762, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.99301875}
confusion matrix:
       0      1
0  42408      5
1    195  14224
---- Validation: 
scalar performance:
{'acc': 0.9716115, 'precision': 0.84847724, 'recall': 0.66841364, 'specificity': 0.66841364, 'f1': 0.7245648, 'auroc': 0.94107676, 'binary_precision': 0.7210031, 'binary_recall': 0.34175333, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.46370968}
confusion matrix:
       0    1
0  17978   89
1    443  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.9792842, 'recall': 0.50576925, 'specificity': 0.50576925, 'f1': 0.5008299, 'auroc': 0.9115622, 'binary_precision': 1.0, 'binary_recall': 0.011538462, 'binary_specificity': 1.0, 'binary_f1_score': 0.022813687}
confusion matrix:
      0  1
0  5946  0
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_5.png
better model found
persisted
after epoch: 5,now: 2024-06-27 18:41:47.262922,epoch time: 0:32:34.607977,used: 4:43:22.434428,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9961993, 'precision': 0.9961624, 'recall': 0.9937916, 'specificity': 0.9937916, 'f1': 0.9949697, 'auroc': 0.999732, 'binary_precision': 0.996088, 'binary_recall': 0.9889035, 'binary_specificity': 0.99867964, 'binary_f1_score': 0.9924828}
confusion matrix:
       0      1
0  42357     56
1    160  14259
---- Validation: 
scalar performance:
{'acc': 0.96334046, 'precision': 0.72651535, 'recall': 0.62192327, 'specificity': 0.62192327, 'f1': 0.6567571, 'auroc': 0.9367231, 'binary_precision': 0.48033708, 'binary_recall': 0.25408617, 'binary_specificity': 0.98976034, 'binary_f1_score': 0.3323615}
confusion matrix:
       0    1
0  17882  185
1    502  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.8773676, 'recall': 0.5437262, 'specificity': 0.5437262, 'f1': 0.5695625, 'auroc': 0.93953824, 'binary_precision': 0.79310346, 'binary_recall': 0.08846154, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.15916955}
confusion matrix:
      0   1
0  5940   6
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_6.png
early stop counter: 1
val acc:0.9633404612541199, best validation acc: 0.971611499786377, corresponding to test acc:                         0.9585884809494019 / 0.9672897458076477
after epoch: 6,now: 2024-06-27 19:13:22.944960,epoch time: 0:31:35.682038,used: 5:14:58.116466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99723744, 'precision': 0.9969538, 'recall': 0.9957457, 'specificity': 0.9957457, 'f1': 0.9963479, 'auroc': 0.9998069, 'binary_precision': 0.9963801, 'binary_recall': 0.99271744, 'binary_specificity': 0.998774, 'binary_f1_score': 0.99454534}
confusion matrix:
       0      1
0  42362     52
1    105  14313
---- Validation: 
scalar performance:
{'acc': 0.9699573, 'precision': 0.7858559, 'recall': 0.76411676, 'specificity': 0.76411676, 'f1': 0.7745102, 'auroc': 0.95212555, 'binary_precision': 0.58870965, 'binary_recall': 0.54234767, 'binary_specificity': 0.98588586, 'binary_f1_score': 0.5645785}
confusion matrix:
       0    1
0  17812  255
1    308  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.8142085, 'recall': 0.5451448, 'specificity': 0.5451448, 'f1': 0.5708467, 'auroc': 0.9291775, 'binary_precision': 0.6666667, 'binary_recall': 0.092307694, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.16216217}
confusion matrix:
      0   1
0  5934  12
1   236  24
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_7.png
early stop counter: 2
val acc:0.9699572920799255, best validation acc: 0.971611499786377, corresponding to test acc:                         0.9585884809494019 / 0.9672897458076477
after epoch: 7,now: 2024-06-27 19:42:02.251510,epoch time: 0:28:39.306550,used: 5:43:37.423016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9965512, 'precision': 0.9973483, 'recall': 0.9935467, 'specificity': 0.9935467, 'f1': 0.995429, 'auroc': 0.99984646, 'binary_precision': 0.99894756, 'binary_recall': 0.98744714, 'binary_specificity': 0.9996463, 'binary_f1_score': 0.9931641}
confusion matrix:
       0      1
0  42398     15
1    181  14238
---- Validation: 
scalar performance:
{'acc': 0.9665422, 'precision': 0.9316556, 'recall': 0.53846693, 'specificity': 0.53846693, 'f1': 0.56260455, 'auroc': 0.95798326, 'binary_precision': 0.8965517, 'binary_recall': 0.07726597, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.14227086}
confusion matrix:
       0   1
0  18061   6
1    621  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.9507965, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_8.png
early stop counter: 3
val acc:0.9665421843528748, best validation acc: 0.971611499786377, corresponding to test acc:                         0.9585884809494019 / 0.9672897458076477
after epoch: 8,now: 2024-06-27 20:08:19.067293,epoch time: 0:26:16.815783,used: 6:09:54.238799,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9962697, 'precision': 0.99456114, 'recall': 0.99560094, 'specificity': 0.99560094, 'f1': 0.99507964, 'auroc': 0.999701, 'binary_precision': 0.9910813, 'binary_recall': 0.9942433, 'binary_specificity': 0.99695855, 'binary_f1_score': 0.99265975}
confusion matrix:
       0      1
0  42285    129
1     83  14335
---- Validation: 
scalar performance:
{'acc': 0.9707044, 'precision': 0.7826625, 'recall': 0.83603096, 'specificity': 0.83603096, 'f1': 0.8067768, 'auroc': 0.9563978, 'binary_precision': 0.5769231, 'binary_recall': 0.6909361, 'binary_specificity': 0.98112583, 'binary_f1_score': 0.6288032}
confusion matrix:
       0    1
0  17726  341
1    208  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.8482076, 'recall': 0.64563835, 'specificity': 0.64563835, 'f1': 0.7015829, 'auroc': 0.94251955, 'binary_precision': 0.7264151, 'binary_recall': 0.29615384, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.42076504}
confusion matrix:
      0   1
0  5917  29
1   183  77
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_9.png
early stop counter: 4
val acc:0.9707043766975403, best validation acc: 0.971611499786377, corresponding to test acc:                         0.9585884809494019 / 0.9672897458076477
after epoch: 9,now: 2024-06-27 20:33:43.005561,epoch time: 0:25:23.938268,used: 6:35:18.177067,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9969032, 'precision': 0.99781656, 'recall': 0.9940114, 'specificity': 0.9940114, 'f1': 0.9958954, 'auroc': 0.99979436, 'binary_precision': 0.99964917, 'binary_recall': 0.98814064, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.99386156}
confusion matrix:
       0      1
0  42408      5
1    171  14248
---- Validation: 
scalar performance:
{'acc': 0.96782285, 'precision': 0.9423599, 'recall': 0.5570128, 'specificity': 0.5570128, 'f1': 0.59350723, 'auroc': 0.95735496, 'binary_precision': 0.9166667, 'binary_recall': 0.114413075, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.20343462}
confusion matrix:
       0   1
0  18060   7
1    596  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.8793582, 'recall': 0.50760823, 'specificity': 0.50760823, 'f1': 0.50451565, 'auroc': 0.9479231, 'binary_precision': 0.8, 'binary_recall': 0.015384615, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.03018868}
confusion matrix:
      0  1
0  5945  1
1   256  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_10.png
early stop counter: 5
val acc:0.9678228497505188, best validation acc: 0.971611499786377, corresponding to test acc:                         0.9585884809494019 / 0.9672897458076477
after epoch: 10,now: 2024-06-27 20:58:57.253142,epoch time: 0:25:14.247581,used: 7:00:32.424648,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9980293, 'precision': 0.99794453, 'recall': 0.99684846, 'specificity': 0.99684846, 'f1': 0.997395, 'auroc': 0.9997835, 'binary_precision': 0.9977731, 'binary_recall': 0.9944514, 'binary_specificity': 0.9992455, 'binary_f1_score': 0.9961095}
confusion matrix:
       0      1
0  42382     32
1     80  14338
---- Validation: 
scalar performance:
{'acc': 0.9726788, 'precision': 0.81924295, 'recall': 0.7455007, 'specificity': 0.7455007, 'f1': 0.7770949, 'auroc': 0.9517269, 'binary_precision': 0.6569201, 'binary_recall': 0.5007429, 'binary_specificity': 0.99025846, 'binary_f1_score': 0.5682968}
confusion matrix:
       0    1
0  17891  176
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7601003, 'recall': 0.52599806, 'specificity': 0.52599806, 'f1': 0.5385266, 'auroc': 0.9310129, 'binary_precision': 0.56, 'binary_recall': 0.053846154, 'binary_specificity': 0.99815, 'binary_f1_score': 0.09824561}
confusion matrix:
      0   1
0  5935  11
1   246  14
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_11.png
better model found
persisted
after epoch: 11,now: 2024-06-27 21:23:42.689065,epoch time: 0:24:45.435923,used: 7:25:17.860571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9959882, 'precision': 0.9972557, 'recall': 0.9921624, 'specificity': 0.9921624, 'f1': 0.99467576, 'auroc': 0.9997767, 'binary_precision': 0.9997887, 'binary_recall': 0.98439556, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9920324}
confusion matrix:
       0      1
0  42410      3
1    225  14194
---- Validation: 
scalar performance:
{'acc': 0.96734256, 'precision': 0.830762, 'recall': 0.58036757, 'specificity': 0.58036757, 'f1': 0.62386185, 'auroc': 0.9356407, 'binary_precision': 0.6918239, 'binary_recall': 0.16344725, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.26442307}
confusion matrix:
       0    1
0  18018   49
1    563  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95391554, 'precision': 0.4789644, 'recall': 0.49781364, 'specificity': 0.49781364, 'f1': 0.48820713, 'auroc': 0.88725066, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9956273, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5920  26
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_12.png
early stop counter: 1
val acc:0.9673425555229187, best validation acc: 0.9726787805557251, corresponding to test acc:                         0.9585884809494019 / 0.9672897458076477
after epoch: 12,now: 2024-06-27 21:48:28.860475,epoch time: 0:24:46.171410,used: 7:50:04.031981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99750143, 'precision': 0.99692714, 'recall': 0.99647176, 'specificity': 0.99647176, 'f1': 0.99669915, 'auroc': 0.99978626, 'binary_precision': 0.995763, 'binary_recall': 0.9943816, 'binary_specificity': 0.99856186, 'binary_f1_score': 0.9950718}
confusion matrix:
       0      1
0  42354     61
1     81  14336
---- Validation: 
scalar performance:
{'acc': 0.97113127, 'precision': 0.8512728, 'recall': 0.65457445, 'specificity': 0.65457445, 'f1': 0.7116995, 'auroc': 0.95684016, 'binary_precision': 0.7275862, 'binary_recall': 0.31352153, 'binary_specificity': 0.9956274, 'binary_f1_score': 0.4382139}
confusion matrix:
       0    1
0  17988   79
1    462  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.5346584, 'recall': 0.5012503, 'specificity': 0.5012503, 'f1': 0.4927235, 'auroc': 0.9516713, 'binary_precision': 0.11111111, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.007434944}
confusion matrix:
      0  1
0  5938  8
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_13.png
early stop counter: 2
val acc:0.9711312651634216, best validation acc: 0.9726787805557251, corresponding to test acc:                         0.9585884809494019 / 0.9672897458076477
after epoch: 13,now: 2024-06-27 22:13:15.043475,epoch time: 0:24:46.183000,used: 8:14:50.214981,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99656886, 'precision': 0.99771166, 'recall': 0.9932381, 'specificity': 0.9932381, 'f1': 0.9954493, 'auroc': 0.99986684, 'binary_precision': 1.0, 'binary_recall': 0.9864762, 'binary_specificity': 1.0, 'binary_f1_score': 0.9931921}
confusion matrix:
       0      1
0  42413      0
1    195  14224
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.8425007, 'recall': 0.51317924, 'specificity': 0.51317924, 'f1': 0.51678896, 'auroc': 0.9569435, 'binary_precision': 0.72, 'binary_recall': 0.026745914, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.051575933}
confusion matrix:
       0   1
0  18060   7
1    655  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.95239526, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_14.png
early stop counter: 3
val acc:0.9646744728088379, best validation acc: 0.9726787805557251, corresponding to test acc:                         0.9585884809494019 / 0.9672897458076477
after epoch: 14,now: 2024-06-27 22:38:02.862362,epoch time: 0:24:47.818887,used: 8:39:38.033868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9964281, 'precision': 0.9975476, 'recall': 0.99302983, 'specificity': 0.99302983, 'f1': 0.9952625, 'auroc': 0.9997817, 'binary_precision': 0.99978906, 'binary_recall': 0.98613036, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.9929127}
confusion matrix:
       0      1
0  42409      3
1    200  14220
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.732814, 'recall': 0.5221733, 'specificity': 0.5221733, 'f1': 0.5330191, 'auroc': 0.9525771, 'binary_precision': 0.5, 'binary_recall': 0.046062406, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.08435374}
confusion matrix:
       0   1
0  18036  31
1    642  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.6791969, 'recall': 0.50359386, 'specificity': 0.50359386, 'f1': 0.49680376, 'auroc': 0.9405861, 'binary_precision': 0.4, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.01509434}
confusion matrix:
      0  1
0  5943  3
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_15.png
early stop counter: 4
val acc:0.9640874862670898, best validation acc: 0.9726787805557251, corresponding to test acc:                         0.9585884809494019 / 0.9672897458076477
after epoch: 15,now: 2024-06-27 23:02:53.634418,epoch time: 0:24:50.772056,used: 9:04:28.805924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9979589, 'precision': 0.9978973, 'recall': 0.9967102, 'specificity': 0.9967102, 'f1': 0.99730194, 'auroc': 0.9997687, 'binary_precision': 0.9977728, 'binary_recall': 0.9941748, 'binary_specificity': 0.9992455, 'binary_f1_score': 0.99597055}
confusion matrix:
       0      1
0  42380     32
1     84  14336
---- Validation: 
scalar performance:
{'acc': 0.9745998, 'precision': 0.86321056, 'recall': 0.7186016, 'specificity': 0.7186016, 'f1': 0.771448, 'auroc': 0.94844043, 'binary_precision': 0.7468672, 'binary_recall': 0.44279346, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.55597013}
confusion matrix:
       0    1
0  17966  101
1    375  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.8301774, 'recall': 0.55659914, 'specificity': 0.55659914, 'f1': 0.588976, 'auroc': 0.9267734, 'binary_precision': 0.6976744, 'binary_recall': 0.115384616, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.1980198}
confusion matrix:
      0   1
0  5933  13
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_16.png
better model found
persisted
after epoch: 16,now: 2024-06-27 23:27:32.594825,epoch time: 0:24:38.960407,used: 9:29:07.766331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9958474, 'precision': 0.995444, 'recall': 0.9935791, 'specificity': 0.9935791, 'f1': 0.994507, 'auroc': 0.99958134, 'binary_precision': 0.9946297, 'binary_recall': 0.9889737, 'binary_specificity': 0.9981845, 'binary_f1_score': 0.9917936}
confusion matrix:
       0      1
0  42335     77
1    159  14261
---- Validation: 
scalar performance:
{'acc': 0.9719317, 'precision': 0.85991776, 'recall': 0.66428804, 'specificity': 0.66428804, 'f1': 0.72277516, 'auroc': 0.9607186, 'binary_precision': 0.74418604, 'binary_recall': 0.33283803, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.4599589}
confusion matrix:
       0    1
0  17990   77
1    449  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6458602, 'recall': 0.5035098, 'specificity': 0.5035098, 'f1': 0.49673337, 'auroc': 0.9462908, 'binary_precision': 0.33333334, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.015037594}
confusion matrix:
      0  1
0  5942  4
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_17.png
early stop counter: 1
val acc:0.9719316959381104, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9608443379402161 / 0.9672897458076477
after epoch: 17,now: 2024-06-27 23:52:15.702264,epoch time: 0:24:43.107439,used: 9:53:50.873770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99611133, 'precision': 0.99736106, 'recall': 0.9923812, 'specificity': 0.9923812, 'f1': 0.99483943, 'auroc': 0.99983823, 'binary_precision': 0.99985915, 'binary_recall': 0.9848096, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9922773}
confusion matrix:
       0      1
0  42413      2
1    219  14198
---- Validation: 
scalar performance:
{'acc': 0.9715048, 'precision': 0.8437009, 'recall': 0.67121935, 'specificity': 0.67121935, 'f1': 0.72621346, 'auroc': 0.9509127, 'binary_precision': 0.7112462, 'binary_recall': 0.34769687, 'binary_specificity': 0.9947418, 'binary_f1_score': 0.46706587}
confusion matrix:
       0    1
0  17972   95
1    439  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.9357865, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_18.png
early stop counter: 2
val acc:0.971504807472229, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9608443379402161 / 0.9672897458076477
after epoch: 18,now: 2024-06-28 00:16:52.578210,epoch time: 0:24:36.875946,used: 10:18:27.749716,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99736065, 'precision': 0.99687755, 'recall': 0.99614894, 'specificity': 0.99614894, 'f1': 0.99651253, 'auroc': 0.99984324, 'binary_precision': 0.9958991, 'binary_recall': 0.9936889, 'binary_specificity': 0.99860895, 'binary_f1_score': 0.9947927}
confusion matrix:
       0      1
0  42354     59
1     91  14328
---- Validation: 
scalar performance:
{'acc': 0.9704376, 'precision': 0.8035544, 'recall': 0.71215135, 'specificity': 0.71215135, 'f1': 0.7489685, 'auroc': 0.9553199, 'binary_precision': 0.627957, 'binary_recall': 0.43387815, 'binary_specificity': 0.9904245, 'binary_f1_score': 0.51318103}
confusion matrix:
       0    1
0  17894  173
1    381  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96019983, 'precision': 0.90133387, 'recall': 0.530517, 'specificity': 0.530517, 'f1': 0.5471688, 'auroc': 0.9446978, 'binary_precision': 0.84210527, 'binary_recall': 0.06153846, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.11469534}
confusion matrix:
      0   1
0  5943   3
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_19.png
early stop counter: 3
val acc:0.9704375863075256, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9608443379402161 / 0.9672897458076477
after epoch: 19,now: 2024-06-28 00:41:31.057467,epoch time: 0:24:38.479257,used: 10:43:06.228973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9974486, 'precision': 0.9979241, 'recall': 0.99533844, 'specificity': 0.99533844, 'f1': 0.9966227, 'auroc': 0.9997803, 'binary_precision': 0.99888164, 'binary_recall': 0.9910541, 'binary_specificity': 0.99962276, 'binary_f1_score': 0.9949525}
confusion matrix:
       0      1
0  42396     16
1    129  14291
---- Validation: 
scalar performance:
{'acc': 0.9727321, 'precision': 0.87754136, 'recall': 0.6661337, 'specificity': 0.6661337, 'f1': 0.7276865, 'auroc': 0.9520185, 'binary_precision': 0.77931035, 'binary_recall': 0.3358098, 'binary_specificity': 0.99645764, 'binary_f1_score': 0.46936652}
confusion matrix:
       0    1
0  18003   64
1    447  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.948437, 'precision': 0.59929764, 'recall': 0.5446072, 'specificity': 0.5446072, 'f1': 0.5589013, 'auroc': 0.9047278, 'binary_precision': 0.23684211, 'binary_recall': 0.103846155, 'binary_specificity': 0.9853683, 'binary_f1_score': 0.14438504}
confusion matrix:
      0   1
0  5859  87
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_20.png
early stop counter: 4
val acc:0.9727321267127991, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9608443379402161 / 0.9672897458076477
after epoch: 20,now: 2024-06-28 01:06:17.702276,epoch time: 0:24:46.644809,used: 11:07:52.873782,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9962169, 'precision': 0.99745464, 'recall': 0.99256694, 'specificity': 0.99256694, 'f1': 0.9949802, 'auroc': 0.99992067, 'binary_precision': 0.9999296, 'binary_recall': 0.98515743, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99248856}
confusion matrix:
       0      1
0  42413      1
1    214  14204
---- Validation: 
scalar performance:
{'acc': 0.9638207, 'precision': 0.5534923, 'recall': 0.50057685, 'specificity': 0.50057685, 'f1': 0.49225864, 'auroc': 0.96251297, 'binary_precision': 0.14285715, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.0029411765}
confusion matrix:
       0  1
0  18061  6
1    672  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.9527323, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_21.png
early stop counter: 5
val acc:0.9638206958770752, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9608443379402161 / 0.9672897458076477
after epoch: 21,now: 2024-06-28 01:31:09.864581,epoch time: 0:24:52.162305,used: 11:32:45.036087,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.998258, 'precision': 0.99869657, 'recall': 0.9967046, 'specificity': 0.9967046, 'f1': 0.99769545, 'auroc': 0.9998562, 'binary_precision': 0.9995814, 'binary_recall': 0.9935506, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.9965569}
confusion matrix:
       0      1
0  42406      6
1     93  14327
---- Validation: 
scalar performance:
{'acc': 0.97203845, 'precision': 0.8701564, 'recall': 0.657906, 'specificity': 0.657906, 'f1': 0.7181939, 'auroc': 0.9542844, 'binary_precision': 0.76512456, 'binary_recall': 0.31946507, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.45073375}
confusion matrix:
       0    1
0  18001   66
1    458  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6793415, 'recall': 0.5071878, 'specificity': 0.5071878, 'f1': 0.5040258, 'auroc': 0.9544736, 'binary_precision': 0.4, 'binary_recall': 0.015384615, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.02962963}
confusion matrix:
      0  1
0  5940  6
1   256  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_22.png
early stop counter: 6
val acc:0.9720384478569031, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9608443379402161 / 0.9672897458076477
after epoch: 22,now: 2024-06-28 01:55:48.305416,epoch time: 0:24:38.440835,used: 11:57:23.476922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.995777, 'precision': 0.99718654, 'recall': 0.99167824, 'specificity': 0.99167824, 'f1': 0.99439347, 'auroc': 0.9998916, 'binary_precision': 1.0, 'binary_recall': 0.9833565, 'binary_specificity': 1.0, 'binary_f1_score': 0.9916084}
confusion matrix:
       0      1
0  42412      0
1    240  14180
---- Validation: 
scalar performance:
{'acc': 0.96419424, 'precision': 0.7821944, 'recall': 0.50434697, 'specificity': 0.50434697, 'f1': 0.49966717, 'auroc': 0.961252, 'binary_precision': 0.6, 'binary_recall': 0.008915304, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.017569544}
confusion matrix:
       0  1
0  18063  4
1    667  6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.4790424, 'recall': 0.49974772, 'specificity': 0.49974772, 'f1': 0.48917606, 'auroc': 0.9391669, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5943  3
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_23.png
early stop counter: 7
val acc:0.9641942381858826, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9608443379402161 / 0.9672897458076477
after epoch: 23,now: 2024-06-28 02:20:27.834187,epoch time: 0:24:39.528771,used: 12:22:03.005693,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.996692, 'precision': 0.99640286, 'recall': 0.99485373, 'specificity': 0.99485373, 'f1': 0.99562526, 'auroc': 0.99978006, 'binary_precision': 0.9958188, 'binary_recall': 0.9911222, 'binary_specificity': 0.99858534, 'binary_f1_score': 0.99346495}
confusion matrix:
       0      1
0  42354     60
1    128  14290
---- Validation: 
scalar performance:
{'acc': 0.9738527, 'precision': 0.83292556, 'recall': 0.7482554, 'specificity': 0.7482554, 'f1': 0.78385085, 'auroc': 0.96325266, 'binary_precision': 0.6841046, 'binary_recall': 0.50520056, 'binary_specificity': 0.9913101, 'binary_f1_score': 0.5811966}
confusion matrix:
       0    1
0  17910  157
1    333  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.86025167, 'recall': 0.69513375, 'specificity': 0.69513375, 'f1': 0.7508033, 'auroc': 0.9613378, 'binary_precision': 0.7463768, 'binary_recall': 0.39615384, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.51758796}
confusion matrix:
      0    1
0  5911   35
1   157  103
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_24.png
new oracle model saved
early stop counter: 8
val acc:0.9738526940345764, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9608443379402161 / 0.9690622091293335
after epoch: 24,now: 2024-06-28 02:45:09.539248,epoch time: 0:24:41.705061,used: 12:46:44.710754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.997519, 'precision': 0.99815685, 'recall': 0.99529403, 'specificity': 0.99529403, 'f1': 0.99671495, 'auroc': 0.99979997, 'binary_precision': 0.9994404, 'binary_recall': 0.9907767, 'binary_specificity': 0.99981135, 'binary_f1_score': 0.9950897}
confusion matrix:
       0      1
0  42404      8
1    133  14287
---- Validation: 
scalar performance:
{'acc': 0.973746, 'precision': 0.87951016, 'recall': 0.6845412, 'specificity': 0.6845412, 'f1': 0.7457727, 'auroc': 0.9653739, 'binary_precision': 0.78193146, 'binary_recall': 0.3729569, 'binary_specificity': 0.9961255, 'binary_f1_score': 0.50503016}
confusion matrix:
       0    1
0  17997   70
1    422  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.5791163, 'recall': 0.50158674, 'specificity': 0.50158674, 'f1': 0.49294788, 'auroc': 0.9459132, 'binary_precision': 0.2, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.00754717}
confusion matrix:
      0  1
0  5942  4
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_25.png
early stop counter: 9
val acc:0.9737460017204285, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9608443379402161 / 0.9690622091293335
after epoch: 25,now: 2024-06-28 03:09:49.742927,epoch time: 0:24:40.203679,used: 13:11:24.914433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99695593, 'precision': 0.99764156, 'recall': 0.9943218, 'specificity': 0.9943218, 'f1': 0.9959675, 'auroc': 0.9998187, 'binary_precision': 0.99901927, 'binary_recall': 0.9889737, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.99397105}
confusion matrix:
       0      1
0  42398     14
1    159  14261
---- Validation: 
scalar performance:
{'acc': 0.9708111, 'precision': 0.89531136, 'recall': 0.6193603, 'specificity': 0.6193603, 'f1': 0.6785223, 'auroc': 0.9584527, 'binary_precision': 0.8181818, 'binary_recall': 0.24071322, 'binary_specificity': 0.9980074, 'binary_f1_score': 0.37198624}
confusion matrix:
       0    1
0  18031   36
1    511  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.9574449, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_26.png
early stop counter: 10
val acc:0.970811128616333, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9608443379402161 / 0.9690622091293335
after epoch: 26,now: 2024-06-28 03:34:18.769408,epoch time: 0:24:29.026481,used: 13:35:53.940914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9987507, 'precision': 0.9989798, 'recall': 0.9977212, 'specificity': 0.9977212, 'f1': 0.9983485, 'auroc': 0.9999515, 'binary_precision': 0.9994431, 'binary_recall': 0.99563104, 'binary_specificity': 0.99981135, 'binary_f1_score': 0.99753344}
confusion matrix:
       0      1
0  42404      8
1     63  14357
---- Validation: 
scalar performance:
{'acc': 0.97326577, 'precision': 0.9308413, 'recall': 0.64566773, 'specificity': 0.64566773, 'f1': 0.71326464, 'auroc': 0.9679172, 'binary_precision': 0.8873874, 'binary_recall': 0.29271916, 'binary_specificity': 0.9986163, 'binary_f1_score': 0.44022346}
confusion matrix:
       0    1
0  18042   25
1    476  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6458602, 'recall': 0.5035098, 'specificity': 0.5035098, 'f1': 0.49673337, 'auroc': 0.95535815, 'binary_precision': 0.33333334, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.015037594}
confusion matrix:
      0  1
0  5942  4
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_27.png
early stop counter: 11
val acc:0.9732657670974731, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9608443379402161 / 0.9690622091293335
after epoch: 27,now: 2024-06-28 03:58:58.584964,epoch time: 0:24:39.815556,used: 14:00:33.756470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9971671, 'precision': 0.99629354, 'recall': 0.99622536, 'specificity': 0.99622536, 'f1': 0.99625945, 'auroc': 0.99975705, 'binary_precision': 0.99452037, 'binary_recall': 0.9943135, 'binary_specificity': 0.9981373, 'binary_f1_score': 0.9944169}
confusion matrix:
       0      1
0  42333     79
1     82  14338
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.7570259, 'recall': 0.75150585, 'specificity': 0.75150585, 'f1': 0.7542324, 'auroc': 0.9508437, 'binary_precision': 0.5319149, 'binary_recall': 0.5200594, 'binary_specificity': 0.98295236, 'binary_f1_score': 0.52592033}
confusion matrix:
       0    1
0  17759  308
1    323  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97260714, 'precision': 0.84892, 'recall': 0.7815771, 'specificity': 0.7815771, 'f1': 0.8112595, 'auroc': 0.9494162, 'binary_precision': 0.71634614, 'binary_recall': 0.5730769, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.6367521}
confusion matrix:
      0    1
0  5887   59
1   111  149
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_28.png
new oracle model saved
early stop counter: 12
val acc:0.9663286805152893, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9608443379402161 / 0.9726071357727051
after epoch: 28,now: 2024-06-28 04:23:30.591431,epoch time: 0:24:32.006467,used: 14:25:05.762937,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99820524, 'precision': 0.9986613, 'recall': 0.99660057, 'specificity': 0.99660057, 'f1': 0.99762547, 'auroc': 0.9998775, 'binary_precision': 0.9995813, 'binary_recall': 0.9933426, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.99645215}
confusion matrix:
       0      1
0  42406      6
1     96  14324
---- Validation: 
scalar performance:
{'acc': 0.973746, 'precision': 0.91378844, 'recall': 0.6616527, 'specificity': 0.6616527, 'f1': 0.7287534, 'auroc': 0.97283196, 'binary_precision': 0.85214007, 'binary_recall': 0.3254086, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.47096774}
confusion matrix:
       0    1
0  18029   38
1    454  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7488045, 'recall': 0.512957, 'specificity': 0.512957, 'f1': 0.514973, 'auroc': 0.9570037, 'binary_precision': 0.53846157, 'binary_recall': 0.026923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.051282056}
confusion matrix:
      0  1
0  5940  6
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_29.png
early stop counter: 13
val acc:0.9737460017204285, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9608443379402161 / 0.9726071357727051
after epoch: 29,now: 2024-06-28 04:48:00.360305,epoch time: 0:24:29.768874,used: 14:49:35.531811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9975366, 'precision': 0.996657, 'recall': 0.9968388, 'specificity': 0.9968388, 'f1': 0.99674785, 'auroc': 0.9998408, 'binary_precision': 0.99487036, 'binary_recall': 0.99542236, 'binary_specificity': 0.9982553, 'binary_f1_score': 0.9951463}
confusion matrix:
       0      1
0  42340     74
1     66  14352
---- Validation: 
scalar performance:
{'acc': 0.96798295, 'precision': 0.7876463, 'recall': 0.6586638, 'specificity': 0.6586638, 'f1': 0.7027504, 'auroc': 0.94773114, 'binary_precision': 0.6, 'binary_recall': 0.3254086, 'binary_specificity': 0.991919, 'binary_f1_score': 0.42196533}
confusion matrix:
       0    1
0  17921  146
1    454  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7934439, 'recall': 0.5468156, 'specificity': 0.5468156, 'f1': 0.57301295, 'auroc': 0.93841267, 'binary_precision': 0.625, 'binary_recall': 0.09615385, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.16666667}
confusion matrix:
      0   1
0  5931  15
1   235  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_30.png
early stop counter: 14
val acc:0.9679829478263855, best validation acc: 0.9745997786521912, corresponding to test acc:                         0.9608443379402161 / 0.9726071357727051
after epoch: 30,now: 2024-06-28 05:12:43.207383,epoch time: 0:24:42.847078,used: 15:14:18.378889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_13_58_24_seed_1_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:14:18.378889 at 2024-06-28 05:12:43.207383
persisted model performance metric: 

scalar performance:
{'acc': 0.96084434, 'precision': 0.8301774, 'recall': 0.55659914, 'specificity': 0.55659914, 'f1': 0.588976, 'auroc': 0.9267734, 'binary_precision': 0.6976744, 'binary_recall': 0.115384616, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.1980198}
confusion matrix:
      0   1
0  5933  13
1   230  30
oracle model performance metric: 

scalar performance:
{'acc': 0.97260714, 'precision': 0.84892, 'recall': 0.7815771, 'specificity': 0.7815771, 'f1': 0.8112595, 'auroc': 0.9494162, 'binary_precision': 0.71634614, 'binary_recall': 0.5730769, 'binary_specificity': 0.9900774, 'binary_f1_score': 0.6367521}
confusion matrix:
      0    1
0  5887   59
1   111  149
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456207 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |  41675 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456207 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |  41675 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   2905 TiB |   2905 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2872 TiB |   2872 TiB |
|       from small pool |  40676 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14484 MiB |  28076 MiB |  13602 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     70 MiB |     84 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446961 KiB |   1251 MiB |   2054 TiB |   2054 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   2020 TiB |   2020 TiB |
|       from small pool |  11572 KiB |     44 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8135    |  504366 K  |  504363 K  |
|       from large pool |     187    |    1413    |  265197 K  |  265197 K  |
|       from small pool |    3277    |    7946    |  239168 K  |  239165 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8135    |  504366 K  |  504363 K  |
|       from large pool |     187    |    1413    |  265197 K  |  265197 K  |
|       from small pool |    3277    |    7946    |  239168 K  |  239165 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    1207    |     573    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      35    |      42    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      84    |    3628    |  321981 K  |  321981 K  |
|       from large pool |      40    |     604    |  193287 K  |  193287 K  |
|       from small pool |      44    |    3590    |  128694 K  |  128694 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2905 TiB |   2905 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2872 TiB |   2872 TiB |
|       from small pool |      0 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  28076 MiB |  27194 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   2054 TiB |   2054 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   2020 TiB |   2020 TiB |
|       from small pool |      0 KiB |     44 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  504366 K  |  504366 K  |
|       from large pool |       2    |    1413    |  265197 K  |  265197 K  |
|       from small pool |       0    |    7946    |  239168 K  |  239168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  504366 K  |  504366 K  |
|       from large pool |       2    |    1413    |  265197 K  |  265197 K  |
|       from small pool |       0    |    7946    |  239168 K  |  239168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1207    |    1144    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3628    |  321983 K  |  321983 K  |
|       from large pool |       4    |     604    |  193287 K  |  193287 K  |
|       from small pool |       0    |    3590    |  128695 K  |  128695 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2905 TiB |   2905 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2872 TiB |   2872 TiB |
|       from small pool |      0 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  28076 MiB |  27194 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   2054 TiB |   2054 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   2020 TiB |   2020 TiB |
|       from small pool |      0 KiB |     44 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  504366 K  |  504366 K  |
|       from large pool |       2    |    1413    |  265197 K  |  265197 K  |
|       from small pool |       0    |    7946    |  239168 K  |  239168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  504366 K  |  504366 K  |
|       from large pool |       2    |    1413    |  265197 K  |  265197 K  |
|       from small pool |       0    |    7946    |  239168 K  |  239168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1207    |    1144    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3628    |  321983 K  |  321983 K  |
|       from large pool |       4    |     604    |  193287 K  |  193287 K  |
|       from small pool |       0    |    3590    |  128695 K  |  128695 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851

 Experiment start at: 2024-06-28 05:20:49.539961
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98781335, 'precision': 0.9917223, 'recall': 0.976993, 'specificity': 0.976993, 'f1': 0.984061, 'auroc': 0.9990064, 'binary_precision': 0.9995845, 'binary_recall': 0.95412785, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.97632736}
confusion matrix:
       0      1
0  42305      6
1    694  14435
---- Validation: 
scalar performance:
{'acc': 0.9702765, 'precision': 0.8014016, 'recall': 0.58713686, 'specificity': 0.58713686, 'f1': 0.63101417, 'auroc': 0.9349804, 'binary_precision': 0.62941176, 'binary_recall': 0.17774086, 'binary_specificity': 0.9965329, 'binary_f1_score': 0.27720207}
confusion matrix:
       0    1
0  18108   63
1    495  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9644174, 'precision': 0.94063425, 'recall': 0.5452878, 'specificity': 0.5452878, 'f1': 0.57361734, 'auroc': 0.9168929, 'binary_precision': 0.9166667, 'binary_recall': 0.09090909, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.16541354}
confusion matrix:
      0   1
0  5995   2
1   220  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-28 05:46:31.819127,epoch time: 0:25:42.279166,used: 0:25:42.279166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9884227, 'precision': 0.98235005, 'recall': 0.9880862, 'specificity': 0.9880862, 'f1': 0.9851705, 'auroc': 0.9993434, 'binary_precision': 0.9692447, 'binary_recall': 0.98737526, 'binary_specificity': 0.98879725, 'binary_f1_score': 0.97822595}
confusion matrix:
       0      1
0  41837    474
1    191  14938
---- Validation: 
scalar performance:
{'acc': 0.9637778, 'precision': 0.7234396, 'recall': 0.8327249, 'specificity': 0.8327249, 'f1': 0.7659933, 'auroc': 0.94936967, 'binary_precision': 0.45723686, 'binary_recall': 0.692691, 'binary_specificity': 0.97275877, 'binary_f1_score': 0.5508587}
confusion matrix:
       0    1
0  17676  495
1    185  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.7957605, 'recall': 0.57056314, 'specificity': 0.57056314, 'f1': 0.60809004, 'auroc': 0.9116096, 'binary_precision': 0.625, 'binary_recall': 0.1446281, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.23489933}
confusion matrix:
      0   1
0  5976  21
1   207  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_2.png
early stop counter: 1
val acc:0.9637777805328369, best validation acc: 0.9702764749526978, corresponding to test acc:                         0.9644173979759216 / 0.9644173979759216
after epoch: 2,now: 2024-06-28 06:11:41.735483,epoch time: 0:25:09.916356,used: 0:50:52.195522,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9939241, 'precision': 0.9902109, 'recall': 0.9942409, 'specificity': 0.9942409, 'f1': 0.992203, 'auroc': 0.99976206, 'binary_precision': 0.9822501, 'binary_recall': 0.9949104, 'binary_specificity': 0.9935714, 'binary_f1_score': 0.98853976}
confusion matrix:
       0      1
0  42039    272
1     77  15052
---- Validation: 
scalar performance:
{'acc': 0.9236137, 'precision': 0.63096833, 'recall': 0.8657818, 'specificity': 0.8657818, 'f1': 0.6810969, 'auroc': 0.9395356, 'binary_precision': 0.2688889, 'binary_recall': 0.8039867, 'binary_specificity': 0.9275769, 'binary_f1_score': 0.4029975}
confusion matrix:
       0     1
0  16855  1316
1    118   484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9429396, 'precision': 0.67803615, 'recall': 0.8116993, 'specificity': 0.8116993, 'f1': 0.723148, 'auroc': 0.8990356, 'binary_precision': 0.369863, 'binary_recall': 0.6694215, 'binary_specificity': 0.953977, 'binary_f1_score': 0.4764706}
confusion matrix:
      0    1
0  5721  276
1    80  162
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_3.png
early stop counter: 2
val acc:0.9236137270927429, best validation acc: 0.9702764749526978, corresponding to test acc:                         0.9644173979759216 / 0.9644173979759216
after epoch: 3,now: 2024-06-28 06:36:49.343210,epoch time: 0:25:07.607727,used: 1:15:59.803249,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9961177, 'precision': 0.9968339, 'recall': 0.9931604, 'specificity': 0.9931604, 'f1': 0.99497867, 'auroc': 0.999779, 'binary_precision': 0.9983283, 'binary_recall': 0.9869117, 'binary_specificity': 0.99940914, 'binary_f1_score': 0.9925872}
confusion matrix:
       0      1
0  42287     25
1    198  14930
---- Validation: 
scalar performance:
{'acc': 0.9743781, 'precision': 0.87058294, 'recall': 0.64386296, 'specificity': 0.64386296, 'f1': 0.7040392, 'auroc': 0.95166206, 'binary_precision': 0.76419216, 'binary_recall': 0.29069766, 'binary_specificity': 0.99702823, 'binary_f1_score': 0.42117932}
confusion matrix:
       0    1
0  18117   54
1    427  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.6473434, 'recall': 0.50189936, 'specificity': 0.50189936, 'f1': 0.49414948, 'auroc': 0.92478955, 'binary_precision': 0.33333334, 'binary_recall': 0.004132231, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.008163265}
confusion matrix:
      0  1
0  5995  2
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_4.png
better model found
persisted
after epoch: 4,now: 2024-06-28 07:02:03.226833,epoch time: 0:25:13.883623,used: 1:41:13.686872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.991539, 'precision': 0.9871335, 'recall': 0.99119943, 'specificity': 0.99119943, 'f1': 0.989143, 'auroc': 0.99935067, 'binary_precision': 0.97768646, 'binary_recall': 0.99048185, 'binary_specificity': 0.991917, 'binary_f1_score': 0.9840426}
confusion matrix:
       0      1
0  41969    342
1    144  14985
---- Validation: 
scalar performance:
{'acc': 0.9390614, 'precision': 0.65429544, 'recall': 0.86010975, 'specificity': 0.86010975, 'f1': 0.7086081, 'auroc': 0.93598974, 'binary_precision': 0.31639567, 'binary_recall': 0.77574754, 'binary_specificity': 0.94447196, 'binary_f1_score': 0.44947067}
confusion matrix:
       0     1
0  17162  1009
1    135   467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95656353, 'precision': 0.7220632, 'recall': 0.8128379, 'specificity': 0.8128379, 'f1': 0.75855196, 'auroc': 0.92806387, 'binary_precision': 0.45821327, 'binary_recall': 0.6570248, 'binary_specificity': 0.968651, 'binary_f1_score': 0.53989816}
confusion matrix:
      0    1
0  5809  188
1    83  159
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_5.png
early stop counter: 1
val acc:0.9390614032745361, best validation acc: 0.9743781089782715, corresponding to test acc:                         0.9610514640808105 / 0.9644173979759216
after epoch: 5,now: 2024-06-28 07:27:35.663519,epoch time: 0:25:32.436686,used: 2:06:46.123558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9966748, 'precision': 0.9967176, 'recall': 0.99470705, 'specificity': 0.99470705, 'f1': 0.9957068, 'auroc': 0.99978423, 'binary_precision': 0.99680746, 'binary_recall': 0.99054855, 'binary_specificity': 0.99886554, 'binary_f1_score': 0.99366814}
confusion matrix:
       0      1
0  42262     48
1    143  14987
---- Validation: 
scalar performance:
{'acc': 0.9696373, 'precision': 0.75522995, 'recall': 0.76668954, 'specificity': 0.76668954, 'f1': 0.7608206, 'auroc': 0.94598114, 'binary_precision': 0.5253968, 'binary_recall': 0.5498339, 'binary_specificity': 0.9835452, 'binary_f1_score': 0.53733766}
confusion matrix:
       0    1
0  17872  299
1    271  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9559224, 'precision': 0.6786937, 'recall': 0.61026484, 'specificity': 0.61026484, 'f1': 0.63515556, 'auroc': 0.89226556, 'binary_precision': 0.3877551, 'binary_recall': 0.23553719, 'binary_specificity': 0.9849925, 'binary_f1_score': 0.29305914}
confusion matrix:
      0   1
0  5907  90
1   185  57
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_6.png
early stop counter: 2
val acc:0.9696372747421265, best validation acc: 0.9743781089782715, corresponding to test acc:                         0.9610514640808105 / 0.9644173979759216
after epoch: 6,now: 2024-06-28 07:52:46.437918,epoch time: 0:25:10.774399,used: 2:31:56.897957,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9970056, 'precision': 0.9978453, 'recall': 0.99444294, 'specificity': 0.99444294, 'f1': 0.9961283, 'auroc': 0.9997307, 'binary_precision': 0.99959916, 'binary_recall': 0.9890277, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99428535}
confusion matrix:
       0      1
0  42305      6
1    166  14963
---- Validation: 
scalar performance:
{'acc': 0.97427154, 'precision': 0.81775564, 'recall': 0.70564264, 'specificity': 0.70564264, 'f1': 0.7487134, 'auroc': 0.94855714, 'binary_precision': 0.6545454, 'binary_recall': 0.41860464, 'binary_specificity': 0.99268067, 'binary_f1_score': 0.5106383}
confusion matrix:
       0    1
0  18038  133
1    350  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.7062671, 'recall': 0.5176779, 'specificity': 0.5176779, 'f1': 0.52436423, 'auroc': 0.89886385, 'binary_precision': 0.45, 'binary_recall': 0.037190083, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.06870229}
confusion matrix:
      0   1
0  5986  11
1   233   9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_7.png
early stop counter: 3
val acc:0.9742715358734131, best validation acc: 0.9743781089782715, corresponding to test acc:                         0.9610514640808105 / 0.9644173979759216
after epoch: 7,now: 2024-06-28 08:18:16.045816,epoch time: 0:25:29.607898,used: 2:57:26.505855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9955084, 'precision': 0.9969256, 'recall': 0.99151576, 'specificity': 0.99151576, 'f1': 0.9941807, 'auroc': 0.99977386, 'binary_precision': 0.99986553, 'binary_recall': 0.98307884, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99140114}
confusion matrix:
       0      1
0  42309      2
1    256  14873
---- Validation: 
scalar performance:
{'acc': 0.97283334, 'precision': 0.94951534, 'recall': 0.5828364, 'specificity': 0.5828364, 'f1': 0.6339225, 'auroc': 0.9515568, 'binary_precision': 0.9259259, 'binary_recall': 0.16611296, 'binary_specificity': 0.99955976, 'binary_f1_score': 0.28169015}
confusion matrix:
       0    1
0  18163    8
1    502  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.9297221, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_8.png
early stop counter: 4
val acc:0.9728333353996277, best validation acc: 0.9743781089782715, corresponding to test acc:                         0.9610514640808105 / 0.9644173979759216
after epoch: 8,now: 2024-06-28 08:43:33.099633,epoch time: 0:25:17.053817,used: 3:22:43.559672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9969882, 'precision': 0.99718714, 'recall': 0.99504685, 'specificity': 0.99504685, 'f1': 0.9961107, 'auroc': 0.9997246, 'binary_precision': 0.9976045, 'binary_recall': 0.99094456, 'binary_specificity': 0.99914914, 'binary_f1_score': 0.9942634}
confusion matrix:
       0      1
0  42275     36
1    137  14992
---- Validation: 
scalar performance:
{'acc': 0.97427154, 'precision': 0.83401537, 'recall': 0.67753595, 'specificity': 0.67753595, 'f1': 0.73004806, 'auroc': 0.95604765, 'binary_precision': 0.6888889, 'binary_recall': 0.3604651, 'binary_specificity': 0.9946068, 'binary_f1_score': 0.47328243}
confusion matrix:
       0    1
0  18073   98
1    385  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.6056736, 'recall': 0.501816, 'specificity': 0.501816, 'f1': 0.49409118, 'auroc': 0.9488188, 'binary_precision': 0.25, 'binary_recall': 0.004132231, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.008130081}
confusion matrix:
      0  1
0  5994  3
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_9.png
early stop counter: 5
val acc:0.9742715358734131, best validation acc: 0.9743781089782715, corresponding to test acc:                         0.9610514640808105 / 0.9644173979759216
after epoch: 9,now: 2024-06-28 09:09:12.861283,epoch time: 0:25:39.761650,used: 3:48:23.321322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99766713, 'precision': 0.9976915, 'recall': 0.9962933, 'specificity': 0.9962933, 'f1': 0.9969897, 'auroc': 0.99976194, 'binary_precision': 0.99774283, 'binary_recall': 0.9933902, 'binary_specificity': 0.9991964, 'binary_f1_score': 0.9955618}
confusion matrix:
       0      1
0  42277     34
1    100  15029
---- Validation: 
scalar performance:
{'acc': 0.97299314, 'precision': 0.78432393, 'recall': 0.76922613, 'specificity': 0.76922613, 'f1': 0.77654934, 'auroc': 0.95202553, 'binary_precision': 0.58347976, 'binary_recall': 0.551495, 'binary_specificity': 0.98695725, 'binary_f1_score': 0.56703675}
confusion matrix:
       0    1
0  17934  237
1    270  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.8562912, 'recall': 0.51834494, 'specificity': 0.51834494, 'f1': 0.5257799, 'auroc': 0.9361235, 'binary_precision': 0.75, 'binary_recall': 0.037190083, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.070866145}
confusion matrix:
      0  1
0  5994  3
1   233  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_10.png
early stop counter: 6
val acc:0.9729931354522705, best validation acc: 0.9743781089782715, corresponding to test acc:                         0.9610514640808105 / 0.9644173979759216
after epoch: 10,now: 2024-06-28 09:35:00.901424,epoch time: 0:25:48.040141,used: 4:14:11.361463,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9970752, 'precision': 0.9960226, 'recall': 0.9964435, 'specificity': 0.9964435, 'f1': 0.9962328, 'auroc': 0.9998669, 'binary_precision': 0.993795, 'binary_recall': 0.9951087, 'binary_specificity': 0.99777836, 'binary_f1_score': 0.9944514}
confusion matrix:
       0      1
0  42217     94
1     74  15055
---- Validation: 
scalar performance:
{'acc': 0.97144836, 'precision': 0.7658285, 'recall': 0.8527483, 'specificity': 0.8527483, 'f1': 0.80251265, 'auroc': 0.96764344, 'binary_precision': 0.5408416, 'binary_recall': 0.72591364, 'binary_specificity': 0.97958285, 'binary_f1_score': 0.6198582}
confusion matrix:
       0    1
0  17800  371
1    165  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9735535, 'precision': 0.87561965, 'recall': 0.7225386, 'specificity': 0.7225386, 'f1': 0.77777433, 'auroc': 0.9552287, 'binary_precision': 0.77304965, 'binary_recall': 0.45041323, 'binary_specificity': 0.994664, 'binary_f1_score': 0.5691906}
confusion matrix:
      0    1
0  5965   32
1   133  109
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_11.png
new oracle model saved
early stop counter: 7
val acc:0.9714483618736267, best validation acc: 0.9743781089782715, corresponding to test acc:                         0.9610514640808105 / 0.973553478717804
after epoch: 11,now: 2024-06-28 10:00:33.931226,epoch time: 0:25:33.029802,used: 4:39:44.391265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9777333, 'precision': 0.96256196, 'recall': 0.98255014, 'specificity': 0.98255014, 'f1': 0.971928, 'auroc': 0.999074, 'binary_precision': 0.92779046, 'binary_recall': 0.99272966, 'binary_specificity': 0.9723706, 'binary_f1_score': 0.9591622}
confusion matrix:
       0      1
0  41141   1169
1    110  15020
---- Validation: 
scalar performance:
{'acc': 0.9425771, 'precision': 0.66171527, 'recall': 0.86192584, 'specificity': 0.86192584, 'f1': 0.71693885, 'auroc': 0.9446487, 'binary_precision': 0.33120567, 'binary_recall': 0.77574754, 'binary_specificity': 0.94810414, 'binary_f1_score': 0.46421474}
confusion matrix:
       0    1
0  17228  943
1    135  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96666133, 'precision': 0.772833, 'recall': 0.82007325, 'specificity': 0.82007325, 'f1': 0.7943274, 'auroc': 0.9343599, 'binary_precision': 0.55944055, 'binary_recall': 0.661157, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.6060606}
confusion matrix:
      0    1
0  5871  126
1    82  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_12.png
early stop counter: 8
val acc:0.9425771236419678, best validation acc: 0.9743781089782715, corresponding to test acc:                         0.9610514640808105 / 0.973553478717804
after epoch: 12,now: 2024-06-28 10:26:33.049299,epoch time: 0:25:59.118073,used: 5:05:43.509338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9956302, 'precision': 0.9954723, 'recall': 0.9932546, 'specificity': 0.9932546, 'f1': 0.99435663, 'auroc': 0.9997568, 'binary_precision': 0.9951411, 'binary_recall': 0.9882345, 'binary_specificity': 0.9982747, 'binary_f1_score': 0.9916758}
confusion matrix:
       0      1
0  42238     73
1    178  14951
---- Validation: 
scalar performance:
{'acc': 0.96612155, 'precision': 0.71119124, 'recall': 0.6147034, 'specificity': 0.6147034, 'f1': 0.6471609, 'auroc': 0.9241431, 'binary_precision': 0.44720498, 'binary_recall': 0.23920266, 'binary_specificity': 0.99020416, 'binary_f1_score': 0.31168833}
confusion matrix:
       0    1
0  17993  178
1    458  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.4805903, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.4899027, 'auroc': 0.9397996, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_13.png
early stop counter: 9
val acc:0.9661215543746948, best validation acc: 0.9743781089782715, corresponding to test acc:                         0.9610514640808105 / 0.973553478717804
after epoch: 13,now: 2024-06-28 10:52:05.224781,epoch time: 0:25:32.175482,used: 5:31:15.684820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99655294, 'precision': 0.99450755, 'recall': 0.9966411, 'specificity': 0.9966411, 'f1': 0.99556804, 'auroc': 0.9998886, 'binary_precision': 0.9901523, 'binary_recall': 0.9968275, 'binary_specificity': 0.9964547, 'binary_f1_score': 0.9934787}
confusion matrix:
       0      1
0  42160    150
1     48  15082
---- Validation: 
scalar performance:
{'acc': 0.9501944, 'precision': 0.6791031, 'recall': 0.85783017, 'specificity': 0.85783017, 'f1': 0.73406434, 'auroc': 0.9503919, 'binary_precision': 0.36647955, 'binary_recall': 0.7591362, 'binary_specificity': 0.95652413, 'binary_f1_score': 0.4943213}
confusion matrix:
       0    1
0  17381  790
1    145  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95399904, 'precision': 0.6630529, 'recall': 0.60728157, 'specificity': 0.60728157, 'f1': 0.6284708, 'auroc': 0.91131103, 'binary_precision': 0.3566879, 'binary_recall': 0.23140496, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.28070176}
confusion matrix:
      0    1
0  5896  101
1   186   56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_14.png
early stop counter: 10
val acc:0.9501944184303284, best validation acc: 0.9743781089782715, corresponding to test acc:                         0.9610514640808105 / 0.973553478717804
after epoch: 14,now: 2024-06-28 11:18:11.916434,epoch time: 0:26:06.691653,used: 5:57:22.376473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.998172, 'precision': 0.99816275, 'recall': 0.9971243, 'specificity': 0.9971243, 'f1': 0.99764204, 'auroc': 0.9999116, 'binary_precision': 0.99814326, 'binary_recall': 0.9949104, 'binary_specificity': 0.9993382, 'binary_f1_score': 0.9965242}
confusion matrix:
       0      1
0  42283     28
1     77  15052
---- Validation: 
scalar performance:
{'acc': 0.97933203, 'precision': 0.86678624, 'recall': 0.7644701, 'specificity': 0.7644701, 'f1': 0.8067025, 'auroc': 0.96152574, 'binary_precision': 0.74883723, 'binary_recall': 0.53488374, 'binary_specificity': 0.99405646, 'binary_f1_score': 0.624031}
confusion matrix:
       0    1
0  18063  108
1    280  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9620131, 'precision': 0.81469584, 'recall': 0.5202443, 'specificity': 0.5202443, 'f1': 0.529214, 'auroc': 0.9245535, 'binary_precision': 0.6666667, 'binary_recall': 0.041322313, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.07782101}
confusion matrix:
      0   1
0  5992   5
1   232  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_15.png
better model found
persisted
after epoch: 15,now: 2024-06-28 11:44:11.503398,epoch time: 0:25:59.586964,used: 6:23:21.963437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9976149, 'precision': 0.9964781, 'recall': 0.9973831, 'specificity': 0.9973831, 'f1': 0.99692947, 'auroc': 0.9998932, 'binary_precision': 0.994068, 'binary_recall': 0.9968934, 'binary_specificity': 0.9978729, 'binary_f1_score': 0.9954787}
confusion matrix:
       0      1
0  42221     90
1     47  15082
---- Validation: 
scalar performance:
{'acc': 0.97198105, 'precision': 0.76959485, 'recall': 0.8441899, 'specificity': 0.8441899, 'f1': 0.801872, 'auroc': 0.96446633, 'binary_precision': 0.5489691, 'binary_recall': 0.7076412, 'binary_specificity': 0.9807385, 'binary_f1_score': 0.6182874}
confusion matrix:
       0    1
0  17821  350
1    176  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.84470046, 'recall': 0.5793279, 'specificity': 0.5793279, 'f1': 0.6228091, 'auroc': 0.9373987, 'binary_precision': 0.7222222, 'binary_recall': 0.16115703, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.2635135}
confusion matrix:
      0   1
0  5982  15
1   203  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_16.png
early stop counter: 1
val acc:0.9719810485839844, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.973553478717804
after epoch: 16,now: 2024-06-28 12:09:45.413444,epoch time: 0:25:33.910046,used: 6:48:55.873483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9975975, 'precision': 0.9970724, 'recall': 0.9967345, 'specificity': 0.9967345, 'f1': 0.9969033, 'auroc': 0.9997548, 'binary_precision': 0.995964, 'binary_recall': 0.9949108, 'binary_specificity': 0.9985583, 'binary_f1_score': 0.99543715}
confusion matrix:
       0      1
0  42249     61
1     77  15053
---- Validation: 
scalar performance:
{'acc': 0.9586108, 'precision': 0.69774294, 'recall': 0.80516136, 'specificity': 0.80516136, 'f1': 0.73840046, 'auroc': 0.937207, 'binary_precision': 0.40760297, 'binary_recall': 0.641196, 'binary_specificity': 0.96912664, 'binary_f1_score': 0.49838606}
confusion matrix:
       0    1
0  17610  561
1    216  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9523962, 'precision': 0.6999887, 'recall': 0.7710153, 'specificity': 0.7710153, 'f1': 0.7292633, 'auroc': 0.90221834, 'binary_precision': 0.4174174, 'binary_recall': 0.57438016, 'binary_specificity': 0.9676505, 'binary_f1_score': 0.48347825}
confusion matrix:
      0    1
0  5803  194
1   103  139
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_17.png
early stop counter: 2
val acc:0.9586107730865479, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.973553478717804
after epoch: 17,now: 2024-06-28 12:35:17.445078,epoch time: 0:25:32.031634,used: 7:14:27.905117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9945334, 'precision': 0.9963168, 'recall': 0.9896219, 'specificity': 0.9896219, 'f1': 0.9929081, 'auroc': 0.9997735, 'binary_precision': 1.0, 'binary_recall': 0.9792438, 'binary_specificity': 1.0, 'binary_f1_score': 0.9895131}
confusion matrix:
       0      1
0  42312      0
1    314  14814
---- Validation: 
scalar performance:
{'acc': 0.97166145, 'precision': 0.92627275, 'recall': 0.5669731, 'specificity': 0.5669731, 'f1': 0.6094966, 'auroc': 0.9374166, 'binary_precision': 0.8804348, 'binary_recall': 0.1345515, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.2334294}
confusion matrix:
       0   1
0  18160  11
1    521  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.88959306, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_18.png
early stop counter: 3
val acc:0.9716614484786987, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.973553478717804
after epoch: 18,now: 2024-06-28 13:01:25.913019,epoch time: 0:26:08.467941,used: 7:40:36.373058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99820685, 'precision': 0.9981014, 'recall': 0.99727523, 'specificity': 0.99727523, 'f1': 0.99768734, 'auroc': 0.99993026, 'binary_precision': 0.99787927, 'binary_recall': 0.99530673, 'binary_specificity': 0.99924374, 'binary_f1_score': 0.9965913}
confusion matrix:
       0      1
0  42280     32
1     71  15057
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.7573363, 'recall': 0.7257891, 'specificity': 0.7257891, 'f1': 0.74042857, 'auroc': 0.9517088, 'binary_precision': 0.53231937, 'binary_recall': 0.4651163, 'binary_specificity': 0.98646194, 'binary_f1_score': 0.49645388}
confusion matrix:
       0    1
0  17925  246
1    322  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9530373, 'precision': 0.65647304, 'recall': 0.60678136, 'specificity': 0.60678136, 'f1': 0.62613714, 'auroc': 0.91147256, 'binary_precision': 0.34355828, 'binary_recall': 0.23140496, 'binary_specificity': 0.98215777, 'binary_f1_score': 0.27654323}
confusion matrix:
      0    1
0  5890  107
1   186   56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_19.png
early stop counter: 4
val acc:0.9697437882423401, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.973553478717804
after epoch: 19,now: 2024-06-28 13:26:59.201629,epoch time: 0:25:33.288610,used: 8:06:09.661668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.994046, 'precision': 0.9905933, 'recall': 0.9941538, 'specificity': 0.9941538, 'f1': 0.9923557, 'auroc': 0.99967563, 'binary_precision': 0.9832037, 'binary_recall': 0.99438167, 'binary_specificity': 0.9939259, 'binary_f1_score': 0.9887611}
confusion matrix:
       0      1
0  42054    257
1     85  15044
---- Validation: 
scalar performance:
{'acc': 0.9425771, 'precision': 0.6499146, 'recall': 0.80330324, 'specificity': 0.80330324, 'f1': 0.6960404, 'auroc': 0.92699015, 'binary_precision': 0.31170887, 'binary_recall': 0.65448505, 'binary_specificity': 0.9521215, 'binary_f1_score': 0.42229366}
confusion matrix:
       0    1
0  17301  870
1    208  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86969066, 'precision': 0.59040797, 'recall': 0.8073034, 'specificity': 0.8073034, 'f1': 0.6169096, 'auroc': 0.8778136, 'binary_precision': 0.1926803, 'binary_recall': 0.73966944, 'binary_specificity': 0.8749375, 'binary_f1_score': 0.3057216}
confusion matrix:
      0    1
0  5247  750
1    63  179
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_20.png
early stop counter: 5
val acc:0.9425771236419678, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.973553478717804
after epoch: 20,now: 2024-06-28 13:52:29.291998,epoch time: 0:25:30.090369,used: 8:31:39.752037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99810237, 'precision': 0.9981793, 'recall': 0.99692845, 'specificity': 0.99692845, 'f1': 0.9975518, 'auroc': 0.9998877, 'binary_precision': 0.9983411, 'binary_recall': 0.99444777, 'binary_specificity': 0.99940914, 'binary_f1_score': 0.9963907}
confusion matrix:
       0      1
0  42286     25
1     84  15045
---- Validation: 
scalar performance:
{'acc': 0.9730464, 'precision': 0.8054961, 'recall': 0.68814576, 'specificity': 0.68814576, 'f1': 0.7317196, 'auroc': 0.94589674, 'binary_precision': 0.63114756, 'binary_recall': 0.38372093, 'binary_specificity': 0.9925706, 'binary_f1_score': 0.47727275}
confusion matrix:
       0    1
0  18036  135
1    371  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95928836, 'precision': 0.5641242, 'recall': 0.5049477, 'specificity': 0.5049477, 'f1': 0.501144, 'auroc': 0.9459432, 'binary_precision': 0.16666667, 'binary_recall': 0.012396694, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.023076924}
confusion matrix:
      0   1
0  5982  15
1   239   3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_21.png
early stop counter: 6
val acc:0.9730464220046997, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.973553478717804
after epoch: 21,now: 2024-06-28 14:18:00.294878,epoch time: 0:25:31.002880,used: 8:57:10.754917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9976497, 'precision': 0.99840975, 'recall': 0.99553835, 'specificity': 0.99553835, 'f1': 0.99696285, 'auroc': 0.9998952, 'binary_precision': 1.0, 'binary_recall': 0.99107677, 'binary_specificity': 1.0, 'binary_f1_score': 0.99551845}
confusion matrix:
       0      1
0  42311      0
1    135  14994
---- Validation: 
scalar performance:
{'acc': 0.97192776, 'precision': 0.891448, 'recall': 0.58076245, 'specificity': 0.58076245, 'f1': 0.62839043, 'auroc': 0.9563367, 'binary_precision': 0.80991733, 'binary_recall': 0.1627907, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.27109265}
confusion matrix:
       0   1
0  18148  23
1    504  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.9198504, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_22.png
early stop counter: 7
val acc:0.9719277620315552, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.973553478717804
after epoch: 22,now: 2024-06-28 14:44:07.264124,epoch time: 0:26:06.969246,used: 9:23:17.724163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9952124, 'precision': 0.99674916, 'recall': 0.9909327, 'specificity': 0.9909327, 'f1': 0.99379474, 'auroc': 0.9999176, 'binary_precision': 0.9999327, 'binary_recall': 0.98188907, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9908287}
confusion matrix:
       0      1
0  42310      1
1    274  14855
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.8565018, 'recall': 0.5238112, 'specificity': 0.5238112, 'f1': 0.53734314, 'auroc': 0.9546007, 'binary_precision': 0.74358976, 'binary_recall': 0.048172757, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.09048361}
confusion matrix:
       0   1
0  18161  10
1    573  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9588075, 'precision': 0.48055914, 'recall': 0.49874938, 'specificity': 0.49874938, 'f1': 0.48948535, 'auroc': 0.91104525, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5982  15
1   242   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_23.png
early stop counter: 8
val acc:0.968944787979126, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.973553478717804
after epoch: 23,now: 2024-06-28 15:10:01.817364,epoch time: 0:25:54.553240,used: 9:49:12.277403,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.997023, 'precision': 0.9979004, 'recall': 0.9944339, 'specificity': 0.9944339, 'f1': 0.99615073, 'auroc': 0.9998051, 'binary_precision': 0.99973273, 'binary_recall': 0.98896235, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9943183}
confusion matrix:
       0      1
0  42306      4
1    167  14963
---- Validation: 
scalar performance:
{'acc': 0.9720343, 'precision': 0.95240325, 'recall': 0.5687718, 'specificity': 0.5687718, 'f1': 0.61299324, 'auroc': 0.9516802, 'binary_precision': 0.9325843, 'binary_recall': 0.13787375, 'binary_specificity': 0.9996698, 'binary_f1_score': 0.24023156}
confusion matrix:
       0   1
0  18165   6
1    519  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.48058408, 'recall': 0.49941638, 'specificity': 0.49941638, 'f1': 0.48981926, 'auroc': 0.9269101, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5990  7
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_24.png
early stop counter: 9
val acc:0.9720342755317688, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.973553478717804
after epoch: 24,now: 2024-06-28 15:36:04.094045,epoch time: 0:26:02.276681,used: 10:15:14.554084,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9981198, 'precision': 0.99872696, 'recall': 0.99643093, 'specificity': 0.99643093, 'f1': 0.99757177, 'auroc': 0.9999104, 'binary_precision': 1.0, 'binary_recall': 0.99286187, 'binary_specificity': 1.0, 'binary_f1_score': 0.9964182}
confusion matrix:
       0      1
0  42310      0
1    108  15022
---- Validation: 
scalar performance:
{'acc': 0.9692644, 'precision': 0.9362997, 'recall': 0.5231733, 'specificity': 0.5231733, 'f1': 0.53641814, 'auroc': 0.9584044, 'binary_precision': 0.9032258, 'binary_recall': 0.046511628, 'binary_specificity': 0.9998349, 'binary_f1_score': 0.08846761}
confusion matrix:
       0   1
0  18168   3
1    574  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.9353852, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_25.png
early stop counter: 10
val acc:0.9692643880844116, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.973553478717804
after epoch: 25,now: 2024-06-28 16:04:04.641796,epoch time: 0:28:00.547751,used: 10:43:15.101835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99899024, 'precision': 0.9991446, 'recall': 0.998253, 'specificity': 0.998253, 'f1': 0.99869776, 'auroc': 0.99996394, 'binary_precision': 0.99946976, 'binary_recall': 0.9966951, 'binary_specificity': 0.99981093, 'binary_f1_score': 0.9980805}
confusion matrix:
       0      1
0  42303      8
1     50  15079
---- Validation: 
scalar performance:
{'acc': 0.9748575, 'precision': 0.8931259, 'recall': 0.64009535, 'specificity': 0.64009535, 'f1': 0.702935, 'auroc': 0.9638754, 'binary_precision': 0.8095238, 'binary_recall': 0.28239202, 'binary_specificity': 0.9977987, 'binary_f1_score': 0.4187192}
confusion matrix:
       0    1
0  18131   40
1    432  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.8812169, 'recall': 0.5163622, 'specificity': 0.5163622, 'f1': 0.5220945, 'auroc': 0.95803463, 'binary_precision': 0.8, 'binary_recall': 0.03305785, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.06349206}
confusion matrix:
      0  1
0  5995  2
1   234  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_26.png
early stop counter: 11
val acc:0.9748575091362, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.973553478717804
after epoch: 26,now: 2024-06-28 16:30:05.330588,epoch time: 0:26:00.688792,used: 11:09:15.790627,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9965007, 'precision': 0.99694216, 'recall': 0.9940369, 'specificity': 0.9940369, 'f1': 0.995478, 'auroc': 0.99963105, 'binary_precision': 0.9978657, 'binary_recall': 0.98883015, 'binary_specificity': 0.9992437, 'binary_f1_score': 0.9933274}
confusion matrix:
       0      1
0  42278     32
1    169  14961
---- Validation: 
scalar performance:
{'acc': 0.9694774, 'precision': 0.80471826, 'recall': 0.5546022, 'specificity': 0.5546022, 'f1': 0.5869895, 'auroc': 0.9372022, 'binary_precision': 0.63809526, 'binary_recall': 0.11129568, 'binary_specificity': 0.9979088, 'binary_f1_score': 0.18953322}
confusion matrix:
       0   1
0  18133  38
1    535  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.6810411, 'recall': 0.51164633, 'specificity': 0.51164633, 'f1': 0.5133226, 'auroc': 0.9124197, 'binary_precision': 0.4, 'binary_recall': 0.024793388, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.046692606}
confusion matrix:
      0  1
0  5988  9
1   236  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_27.png
early stop counter: 12
val acc:0.9694774150848389, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.973553478717804
after epoch: 27,now: 2024-06-28 16:55:39.650909,epoch time: 0:25:34.320321,used: 11:34:50.110948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9981198, 'precision': 0.9986839, 'recall': 0.9964732, 'specificity': 0.9964732, 'f1': 0.9975718, 'auroc': 0.999882, 'binary_precision': 0.9998669, 'binary_recall': 0.9929936, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99641836}
confusion matrix:
       0      1
0  42309      2
1    106  15023
---- Validation: 
scalar performance:
{'acc': 0.974751, 'precision': 0.83108336, 'recall': 0.6962537, 'specificity': 0.6962537, 'f1': 0.7450955, 'auroc': 0.951676, 'binary_precision': 0.6818182, 'binary_recall': 0.3986711, 'binary_specificity': 0.99383634, 'binary_f1_score': 0.5031447}
confusion matrix:
       0    1
0  18059  112
1    362  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9753166, 'precision': 0.9109112, 'recall': 0.721473, 'specificity': 0.721473, 'f1': 0.7855325, 'auroc': 0.9274957, 'binary_precision': 0.84375, 'binary_recall': 0.446281, 'binary_specificity': 0.996665, 'binary_f1_score': 0.5837838}
confusion matrix:
      0    1
0  5977   20
1   134  108
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_28.png
new oracle model saved
early stop counter: 13
val acc:0.9747509956359863, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.97531658411026
after epoch: 28,now: 2024-06-28 17:21:33.310872,epoch time: 0:25:53.659963,used: 12:00:43.770911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9986072, 'precision': 0.9983955, 'recall': 0.99801433, 'specificity': 0.99801433, 'f1': 0.9982047, 'auroc': 0.9999068, 'binary_precision': 0.99794865, 'binary_recall': 0.9967614, 'binary_specificity': 0.99926734, 'binary_f1_score': 0.9973547}
confusion matrix:
       0      1
0  42279     31
1     49  15081
---- Validation: 
scalar performance:
{'acc': 0.9762425, 'precision': 0.829232, 'recall': 0.7460101, 'specificity': 0.7460101, 'f1': 0.7811038, 'auroc': 0.9661104, 'binary_precision': 0.6748879, 'binary_recall': 0.5, 'binary_specificity': 0.99202025, 'binary_f1_score': 0.5744275}
confusion matrix:
       0    1
0  18026  145
1    301  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9632954, 'precision': 0.87328637, 'recall': 0.5367732, 'specificity': 0.5367732, 'f1': 0.5585493, 'auroc': 0.93924356, 'binary_precision': 0.7826087, 'binary_recall': 0.07438017, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.13584906}
confusion matrix:
      0   1
0  5992   5
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_29.png
early stop counter: 14
val acc:0.9762424826622009, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.97531658411026
after epoch: 29,now: 2024-06-28 17:47:15.170702,epoch time: 0:25:41.859830,used: 12:26:25.630741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9985724, 'precision': 0.99903286, 'recall': 0.99729013, 'specificity': 0.99729013, 'f1': 0.9981573, 'auroc': 0.9998884, 'binary_precision': 1.0, 'binary_recall': 0.9945803, 'binary_specificity': 1.0, 'binary_f1_score': 0.9972828}
confusion matrix:
       0      1
0  42310      0
1     82  15048
---- Validation: 
scalar performance:
{'acc': 0.9688382, 'precision': 0.8291999, 'recall': 0.52536225, 'specificity': 0.52536225, 'f1': 0.53998643, 'auroc': 0.95213544, 'binary_precision': 0.6888889, 'binary_recall': 0.051495016, 'binary_specificity': 0.99922955, 'binary_f1_score': 0.095826894}
confusion matrix:
       0   1
0  18157  14
1    571  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.4805934, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48994443, 'auroc': 0.91210896, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587851_30.png
early stop counter: 15
val acc:0.9688382148742676, best validation acc: 0.9793320298194885, corresponding to test acc:                         0.9620131254196167 / 0.97531658411026
after epoch: 30,now: 2024-06-28 18:13:12.969002,epoch time: 0:25:57.798300,used: 12:52:23.429041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_20_49_seed_2_21587851
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:52:23.429041 at 2024-06-28 18:13:12.969002
persisted model performance metric: 

scalar performance:
{'acc': 0.9620131, 'precision': 0.81469584, 'recall': 0.5202443, 'specificity': 0.5202443, 'f1': 0.529214, 'auroc': 0.9245535, 'binary_precision': 0.6666667, 'binary_recall': 0.041322313, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.07782101}
confusion matrix:
      0   1
0  5992   5
1   232  10
oracle model performance metric: 

scalar performance:
{'acc': 0.9753166, 'precision': 0.9109112, 'recall': 0.721473, 'specificity': 0.721473, 'f1': 0.7855325, 'auroc': 0.9274957, 'binary_precision': 0.84375, 'binary_recall': 0.446281, 'binary_specificity': 0.996665, 'binary_f1_score': 0.5837838}
confusion matrix:
      0    1
0  5977   20
1   134  108
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456213 KiB |  13219 MiB |   4373 TiB |   4373 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   4323 TiB |   4323 TiB |
|       from small pool |  41681 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456213 KiB |  13219 MiB |   4373 TiB |   4373 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   4323 TiB |   4323 TiB |
|       from small pool |  41681 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   4363 TiB |   4363 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   4313 TiB |   4313 TiB |
|       from small pool |  40678 KiB |     60 MiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14484 MiB |  41668 MiB |  27194 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     70 MiB |     98 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 444907 KiB |   1251 MiB |   3083 TiB |   3083 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   3033 TiB |   3033 TiB |
|       from small pool |   9518 KiB |     44 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8185    |     757 M  |     757 M  |
|       from large pool |     187    |    1413    |     398 M  |     398 M  |
|       from small pool |    3289    |    7996    |     359 M  |     359 M  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8185    |     757 M  |     757 M  |
|       from large pool |     187    |    1413    |     398 M  |     398 M  |
|       from small pool |    3289    |    7996    |     359 M  |     359 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    1778    |    1144    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      35    |      49    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    3656    |  479880 K  |  479880 K  |
|       from large pool |      40    |     604    |  287366 K  |  287366 K  |
|       from small pool |      40    |    3614    |  192514 K  |  192514 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   4373 TiB |   4373 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   4323 TiB |   4323 TiB |
|       from small pool |      0 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   4373 TiB |   4373 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   4323 TiB |   4323 TiB |
|       from small pool |      0 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   4363 TiB |   4363 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   4313 TiB |   4313 TiB |
|       from small pool |      0 KiB |     60 MiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14484 MiB |  41668 MiB |  40788 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     50 MiB |     70 MiB |     98 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   3083 TiB |   3083 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   3033 TiB |   3033 TiB |
|       from small pool |      0 KiB |     44 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8185    |     757 M  |     757 M  |
|       from large pool |       2    |    1413    |     398 M  |     398 M  |
|       from small pool |       0    |    7996    |     359 M  |     359 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8185    |     757 M  |     757 M  |
|       from large pool |       2    |    1413    |     398 M  |     398 M  |
|       from small pool |       0    |    7996    |     359 M  |     359 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    1778    |    1716    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      25    |      35    |      49    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3656    |  479882 K  |  479882 K  |
|       from large pool |       4    |     604    |  287366 K  |  287366 K  |
|       from small pool |       0    |    3614    |  192515 K  |  192515 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jun 28 18:14:34 2024]
Finished job 0.
1 of 1 steps (100%) done
