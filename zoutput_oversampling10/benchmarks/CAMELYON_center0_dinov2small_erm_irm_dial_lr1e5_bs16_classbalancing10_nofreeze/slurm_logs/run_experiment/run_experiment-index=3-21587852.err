Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jun 27 01:32:47 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852

 Experiment start at: 2024-06-27 01:40:43.212709
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98986673, 'precision': 0.99309576, 'recall': 0.9805167, 'specificity': 0.9805167, 'f1': 0.98659736, 'auroc': 0.9994681, 'binary_precision': 0.99950534, 'binary_recall': 0.9611987, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.9799778}
confusion matrix:
       0      1
0  42317      7
1    571  14145
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96695405, 'precision': 0.77219754, 'recall': 0.5643608, 'specificity': 0.5643608, 'f1': 0.5990198, 'auroc': 0.92144156, 'binary_precision': 0.5743243, 'binary_recall': 0.13219285, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.21491782}
confusion matrix:
       0   1
0  18086  63
1    558  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.8728379, 'recall': 0.52082264, 'specificity': 0.52082264, 'f1': 0.5296659, 'auroc': 0.92366743, 'binary_precision': 0.78571427, 'binary_recall': 0.042145595, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.080000006}
confusion matrix:
      0   1
0  5994   3
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-27 02:06:03.236340,epoch time: 0:25:20.023631,used: 0:25:20.023631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9954593, 'precision': 0.9964558, 'recall': 0.99168706, 'specificity': 0.99168706, 'f1': 0.9940414, 'auroc': 0.9997288, 'binary_precision': 0.99848276, 'binary_recall': 0.983894, 'binary_specificity': 0.9994802, 'binary_f1_score': 0.99113464}
confusion matrix:
       0      1
0  42303     22
1    237  14478
---- Validation: 
scalar performance:
{'acc': 0.9647722, 'precision': 0.73797095, 'recall': 0.8092494, 'specificity': 0.8092494, 'f1': 0.76838374, 'auroc': 0.9529669, 'binary_precision': 0.4887574, 'binary_recall': 0.64230174, 'binary_specificity': 0.97619706, 'binary_f1_score': 0.55510753}
confusion matrix:
       0    1
0  17717  432
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.8564249, 'recall': 0.5566375, 'specificity': 0.5566375, 'f1': 0.5898028, 'auroc': 0.9360453, 'binary_precision': 0.75, 'binary_recall': 0.11494253, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.19933555}
confusion matrix:
      0   1
0  5987  10
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_2.png
new oracle model saved
early stop counter: 1
val acc:0.9647722244262695, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9595717191696167 / 0.9614893198013306
after epoch: 2,now: 2024-06-27 02:30:41.767329,epoch time: 0:24:38.530989,used: 0:49:58.554620,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.993075, 'precision': 0.9953532, 'recall': 0.9866023, 'specificity': 0.9866023, 'f1': 0.9908768, 'auroc': 0.99977386, 'binary_precision': 0.9999302, 'binary_recall': 0.9732282, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9863985}
confusion matrix:
       0      1
0  42322      1
1    394  14323
---- Validation: 
scalar performance:
{'acc': 0.96588975, 'precision': 0.75112295, 'recall': 0.5113059, 'specificity': 0.5113059, 'f1': 0.5136721, 'auroc': 0.95019865, 'binary_precision': 0.53571427, 'binary_recall': 0.02332815, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.044709392}
confusion matrix:
       0   1
0  18136  13
1    628  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.6460234, 'recall': 0.5052469, 'specificity': 0.5052469, 'f1': 0.5003321, 'auroc': 0.9336606, 'binary_precision': 0.33333334, 'binary_recall': 0.011494253, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.022222223}
confusion matrix:
      0  1
0  5991  6
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_3.png
early stop counter: 2
val acc:0.9658897519111633, best validation acc: 0.9669540524482727, corresponding to test acc:                         0.9595717191696167 / 0.9614893198013306
after epoch: 3,now: 2024-06-27 02:55:17.621856,epoch time: 0:24:35.854527,used: 1:14:34.409147,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99652874, 'precision': 0.9975126, 'recall': 0.9934269, 'specificity': 0.9934269, 'f1': 0.9954477, 'auroc': 0.99985874, 'binary_precision': 0.9995182, 'binary_recall': 0.9870192, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.9932293}
confusion matrix:
       0      1
0  42319      7
1    191  14523
---- Validation: 
scalar performance:
{'acc': 0.97121114, 'precision': 0.7921922, 'recall': 0.7263266, 'specificity': 0.7263266, 'f1': 0.7546716, 'auroc': 0.96021336, 'binary_precision': 0.6032389, 'binary_recall': 0.46345258, 'binary_specificity': 0.98920053, 'binary_f1_score': 0.5241865}
confusion matrix:
       0    1
0  17953  196
1    345  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.6573455, 'recall': 0.5194053, 'specificity': 0.5194053, 'f1': 0.52662736, 'auroc': 0.9347768, 'binary_precision': 0.3548387, 'binary_recall': 0.042145595, 'binary_specificity': 0.996665, 'binary_f1_score': 0.07534247}
confusion matrix:
      0   1
0  5977  20
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_4.png
better model found
persisted
after epoch: 4,now: 2024-06-27 03:19:42.725213,epoch time: 0:24:25.103357,used: 1:38:59.512504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9963008, 'precision': 0.9972238, 'recall': 0.99311817, 'specificity': 0.99311817, 'f1': 0.9951487, 'auroc': 0.9997981, 'binary_precision': 0.9991052, 'binary_recall': 0.9865434, 'binary_specificity': 0.99969286, 'binary_f1_score': 0.99278456}
confusion matrix:
       0      1
0  42313     13
1    198  14516
---- Validation: 
scalar performance:
{'acc': 0.9671137, 'precision': 0.7512232, 'recall': 0.748207, 'specificity': 0.748207, 'f1': 0.74970496, 'auroc': 0.9480223, 'binary_precision': 0.51968503, 'binary_recall': 0.5132193, 'binary_specificity': 0.98319465, 'binary_f1_score': 0.5164319}
confusion matrix:
       0    1
0  17844  305
1    313  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.78527087, 'recall': 0.56329983, 'specificity': 0.56329983, 'f1': 0.5970498, 'auroc': 0.9353542, 'binary_precision': 0.60714287, 'binary_recall': 0.1302682, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.21451104}
confusion matrix:
      0   1
0  5975  22
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_5.png
early stop counter: 1
val acc:0.9671136736869812, best validation acc: 0.9712111353874207, corresponding to test acc:                         0.9568552374839783 / 0.9614893198013306
after epoch: 5,now: 2024-06-27 03:44:29.409212,epoch time: 0:24:46.683999,used: 2:03:46.196503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99779105, 'precision': 0.9981115, 'recall': 0.9961176, 'specificity': 0.9961176, 'f1': 0.9971093, 'auroc': 0.99981, 'binary_precision': 0.9987692, 'binary_recall': 0.9926605, 'binary_specificity': 0.9995747, 'binary_f1_score': 0.9957055}
confusion matrix:
       0      1
0  42307     18
1    108  14607
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.78136563, 'recall': 0.64558095, 'specificity': 0.64558095, 'f1': 0.6899357, 'auroc': 0.95130646, 'binary_precision': 0.58715594, 'binary_recall': 0.29860032, 'binary_specificity': 0.9925616, 'binary_f1_score': 0.3958763}
confusion matrix:
       0    1
0  18014  135
1    451  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.72980773, 'recall': 0.516491, 'specificity': 0.516491, 'f1': 0.5215937, 'auroc': 0.9427048, 'binary_precision': 0.5, 'binary_recall': 0.03448276, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.06451613}
confusion matrix:
      0  1
0  5988  9
1   252  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_6.png
early stop counter: 2
val acc:0.9688165187835693, best validation acc: 0.9712111353874207, corresponding to test acc:                         0.9568552374839783 / 0.9614893198013306
after epoch: 6,now: 2024-06-27 04:08:56.141984,epoch time: 0:24:26.732772,used: 2:28:12.929275,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99579245, 'precision': 0.9967697, 'recall': 0.99224555, 'specificity': 0.99224555, 'f1': 0.9944806, 'auroc': 0.9997356, 'binary_precision': 0.9987598, 'binary_recall': 0.98491645, 'binary_specificity': 0.99957466, 'binary_f1_score': 0.9917899}
confusion matrix:
       0      1
0  42304     18
1    222  14496
---- Validation: 
scalar performance:
{'acc': 0.96514475, 'precision': 0.7212366, 'recall': 0.5746749, 'specificity': 0.5746749, 'f1': 0.60804236, 'auroc': 0.9399328, 'binary_precision': 0.4716981, 'binary_recall': 0.15552099, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.23391812}
confusion matrix:
       0    1
0  18037  112
1    543  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95174176, 'precision': 0.567124, 'recall': 0.5167373, 'specificity': 0.5167373, 'f1': 0.52156544, 'auroc': 0.9075904, 'binary_precision': 0.17460318, 'binary_recall': 0.042145595, 'binary_specificity': 0.991329, 'binary_f1_score': 0.06790124}
confusion matrix:
      0   1
0  5945  52
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_7.png
early stop counter: 3
val acc:0.9651447534561157, best validation acc: 0.9712111353874207, corresponding to test acc:                         0.9568552374839783 / 0.9614893198013306
after epoch: 7,now: 2024-06-27 04:33:35.025816,epoch time: 0:24:38.883832,used: 2:52:51.813107,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.996967, 'precision': 0.997288, 'recall': 0.9947873, 'specificity': 0.9947873, 'f1': 0.9960294, 'auroc': 0.99970496, 'binary_precision': 0.9979458, 'binary_recall': 0.99028337, 'binary_specificity': 0.9992912, 'binary_f1_score': 0.9940998}
confusion matrix:
       0      1
0  42293     30
1    143  14574
---- Validation: 
scalar performance:
{'acc': 0.96828437, 'precision': 0.76667213, 'recall': 0.6775578, 'specificity': 0.6775578, 'f1': 0.7122899, 'auroc': 0.94128203, 'binary_precision': 0.5555556, 'binary_recall': 0.36547434, 'binary_specificity': 0.9896413, 'binary_f1_score': 0.4409006}
confusion matrix:
       0    1
0  17961  188
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94646853, 'precision': 0.5142259, 'recall': 0.5048243, 'specificity': 0.5048243, 'f1': 0.50352657, 'auroc': 0.8804156, 'binary_precision': 0.069767445, 'binary_recall': 0.022988506, 'binary_specificity': 0.98666, 'binary_f1_score': 0.034582134}
confusion matrix:
      0   1
0  5917  80
1   255   6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_8.png
early stop counter: 4
val acc:0.9682843685150146, best validation acc: 0.9712111353874207, corresponding to test acc:                         0.9568552374839783 / 0.9614893198013306
after epoch: 8,now: 2024-06-27 04:58:37.830794,epoch time: 0:25:02.804978,used: 3:17:54.618085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.996406, 'precision': 0.99756706, 'recall': 0.9930574, 'specificity': 0.9930574, 'f1': 0.9952854, 'auroc': 0.9997781, 'binary_precision': 0.9999311, 'binary_recall': 0.98613846, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99298686}
confusion matrix:
       0      1
0  42322      1
1    204  14513
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.81810397, 'recall': 0.55652344, 'specificity': 0.55652344, 'f1': 0.5899163, 'auroc': 0.9631761, 'binary_precision': 0.6666667, 'binary_recall': 0.115085535, 'binary_specificity': 0.99796134, 'binary_f1_score': 0.19628647}
confusion matrix:
       0   1
0  18112  37
1    569  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.5506319, 'recall': 0.50141543, 'specificity': 0.50141543, 'f1': 0.49287242, 'auroc': 0.95504713, 'binary_precision': 0.14285715, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.0074626864}
confusion matrix:
      0  1
0  5991  6
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_9.png
early stop counter: 5
val acc:0.96775221824646, best validation acc: 0.9712111353874207, corresponding to test acc:                         0.9568552374839783 / 0.9614893198013306
after epoch: 9,now: 2024-06-27 05:23:39.316900,epoch time: 0:25:01.486106,used: 3:42:56.104191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9965989, 'precision': 0.9969951, 'recall': 0.9941174, 'specificity': 0.9941174, 'f1': 0.99554527, 'auroc': 0.99976563, 'binary_precision': 0.99780595, 'binary_recall': 0.98899084, 'binary_specificity': 0.999244, 'binary_f1_score': 0.9933788}
confusion matrix:
       0      1
0  42293     32
1    162  14553
---- Validation: 
scalar performance:
{'acc': 0.9722222, 'precision': 0.81019163, 'recall': 0.7103488, 'specificity': 0.7103488, 'f1': 0.74983454, 'auroc': 0.95492876, 'binary_precision': 0.6403712, 'binary_recall': 0.42923796, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.51396644}
confusion matrix:
       0    1
0  17994  155
1    367  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552573, 'precision': 0.65276694, 'recall': 0.5368949, 'specificity': 0.5368949, 'f1': 0.5537363, 'auroc': 0.902744, 'binary_precision': 0.3442623, 'binary_recall': 0.08045977, 'binary_specificity': 0.99333, 'binary_f1_score': 0.1304348}
confusion matrix:
      0   1
0  5957  40
1   240  21
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_10.png
better model found
persisted
after epoch: 10,now: 2024-06-27 05:48:41.330285,epoch time: 0:25:02.013385,used: 4:07:58.117576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99730015, 'precision': 0.9974233, 'recall': 0.99552166, 'specificity': 0.99552166, 'f1': 0.9964677, 'auroc': 0.9998777, 'binary_precision': 0.9976763, 'binary_recall': 0.99184674, 'binary_specificity': 0.99919665, 'binary_f1_score': 0.994753}
confusion matrix:
       0      1
0  42288     34
1    120  14598
---- Validation: 
scalar performance:
{'acc': 0.97184974, 'precision': 0.7864382, 'recall': 0.7911619, 'specificity': 0.7911619, 'f1': 0.78877866, 'auroc': 0.95818937, 'binary_precision': 0.58715594, 'binary_recall': 0.59720063, 'binary_specificity': 0.98512316, 'binary_f1_score': 0.59213567}
confusion matrix:
       0    1
0  17879  270
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.83185136, 'recall': 0.62027085, 'specificity': 0.62027085, 'f1': 0.6720538, 'auroc': 0.9591132, 'binary_precision': 0.6956522, 'binary_recall': 0.24521072, 'binary_specificity': 0.995331, 'binary_f1_score': 0.36260623}
confusion matrix:
      0   1
0  5969  28
1   197  64
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_11.png
new oracle model saved
early stop counter: 1
val acc:0.9718497395515442, best validation acc: 0.9722222089767456, corresponding to test acc:                         0.9552572965621948 / 0.9640460014343262
after epoch: 11,now: 2024-06-27 06:13:59.060029,epoch time: 0:25:17.729744,used: 4:33:15.847320,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99775594, 'precision': 0.9982673, 'recall': 0.99587286, 'specificity': 0.99587286, 'f1': 0.9970625, 'auroc': 0.9998828, 'binary_precision': 0.9993155, 'binary_recall': 0.99198204, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.9956353}
confusion matrix:
       0      1
0  42313     10
1    118  14599
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.8263166, 'recall': 0.53977424, 'specificity': 0.53977424, 'f1': 0.5639814, 'auroc': 0.954542, 'binary_precision': 0.68421054, 'binary_recall': 0.08087092, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.14464535}
confusion matrix:
       0   1
0  18125  24
1    591  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.4791033, 'recall': 0.49891612, 'specificity': 0.49891612, 'f1': 0.48880902, 'auroc': 0.9282109, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5984  13
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_12.png
early stop counter: 2
val acc:0.9672732949256897, best validation acc: 0.9722222089767456, corresponding to test acc:                         0.9552572965621948 / 0.9640460014343262
after epoch: 12,now: 2024-06-27 06:38:45.033229,epoch time: 0:24:45.973200,used: 4:58:01.820520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9977384, 'precision': 0.9982555, 'recall': 0.9958389, 'specificity': 0.9958389, 'f1': 0.9970395, 'auroc': 0.999885, 'binary_precision': 0.99931544, 'binary_recall': 0.9919141, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.995601}
confusion matrix:
       0      1
0  42313     10
1    119  14598
---- Validation: 
scalar performance:
{'acc': 0.97158366, 'precision': 0.8100225, 'recall': 0.6882666, 'specificity': 0.6882666, 'f1': 0.7329685, 'auroc': 0.94313294, 'binary_precision': 0.64155847, 'binary_recall': 0.38413686, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.48054475}
confusion matrix:
       0    1
0  18011  138
1    396  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.7203114, 'recall': 0.55838454, 'specificity': 0.55838454, 'f1': 0.5867307, 'auroc': 0.90261894, 'binary_precision': 0.47761193, 'binary_recall': 0.12260536, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.19512194}
confusion matrix:
      0   1
0  5962  35
1   229  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_13.png
early stop counter: 3
val acc:0.9715836644172668, best validation acc: 0.9722222089767456, corresponding to test acc:                         0.9552572965621948 / 0.9640460014343262
after epoch: 13,now: 2024-06-27 07:03:23.487864,epoch time: 0:24:38.454635,used: 5:22:40.275155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9975105, 'precision': 0.9982828, 'recall': 0.99521995, 'specificity': 0.99521995, 'f1': 0.99673903, 'auroc': 0.99986184, 'binary_precision': 0.9998628, 'binary_recall': 0.9904872, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99515295}
confusion matrix:
       0      1
0  42321      2
1    140  14577
---- Validation: 
scalar performance:
{'acc': 0.97051936, 'precision': 0.8742972, 'recall': 0.5962088, 'specificity': 0.5962088, 'f1': 0.64794135, 'auroc': 0.9492949, 'binary_precision': 0.7763975, 'binary_recall': 0.19440125, 'binary_specificity': 0.9980164, 'binary_f1_score': 0.3109453}
confusion matrix:
       0    1
0  18113   36
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7580378, 'recall': 0.5277351, 'specificity': 0.5277351, 'f1': 0.54153377, 'auroc': 0.91867137, 'binary_precision': 0.5555556, 'binary_recall': 0.057471264, 'binary_specificity': 0.997999, 'binary_f1_score': 0.10416667}
confusion matrix:
      0   1
0  5985  12
1   246  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_14.png
early stop counter: 4
val acc:0.9705193638801575, best validation acc: 0.9722222089767456, corresponding to test acc:                         0.9552572965621948 / 0.9640460014343262
after epoch: 14,now: 2024-06-27 07:28:35.521307,epoch time: 0:25:12.033443,used: 5:47:52.308598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99586254, 'precision': 0.9972273, 'recall': 0.9919826, 'specificity': 0.9919826, 'f1': 0.9945687, 'auroc': 0.9998312, 'binary_precision': 1.0, 'binary_recall': 0.9839652, 'binary_specificity': 1.0, 'binary_f1_score': 0.99191785}
confusion matrix:
       0      1
0  42322      0
1    236  14482
---- Validation: 
scalar performance:
{'acc': 0.96823114, 'precision': 0.9259182, 'recall': 0.5410202, 'specificity': 0.5410202, 'f1': 0.5672976, 'auroc': 0.9582665, 'binary_precision': 0.8833333, 'binary_recall': 0.08242613, 'binary_specificity': 0.9996143, 'binary_f1_score': 0.15078236}
confusion matrix:
       0   1
0  18142   7
1    590  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.47913337, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48918456, 'auroc': 0.9381407, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_15.png
early stop counter: 5
val acc:0.9682311415672302, best validation acc: 0.9722222089767456, corresponding to test acc:                         0.9552572965621948 / 0.9640460014343262
after epoch: 15,now: 2024-06-27 07:53:06.306106,epoch time: 0:24:30.784799,used: 6:12:23.093397,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99749297, 'precision': 0.99818087, 'recall': 0.9952743, 'specificity': 0.9952743, 'f1': 0.99671644, 'auroc': 0.9999089, 'binary_precision': 0.9995886, 'binary_recall': 0.9906904, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.99511963}
confusion matrix:
       0      1
0  42318      6
1    137  14579
---- Validation: 
scalar performance:
{'acc': 0.9672733, 'precision': 0.8217614, 'recall': 0.54127437, 'specificity': 0.54127437, 'f1': 0.56634665, 'auroc': 0.9358196, 'binary_precision': 0.675, 'binary_recall': 0.083981335, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.1493776}
confusion matrix:
       0   1
0  18123  26
1    589  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.7099235, 'recall': 0.53997785, 'specificity': 0.53997785, 'f1': 0.56034297, 'auroc': 0.9218147, 'binary_precision': 0.45833334, 'binary_recall': 0.08429119, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.14239483}
confusion matrix:
      0   1
0  5971  26
1   239  22
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_16.png
early stop counter: 6
val acc:0.9672732949256897, best validation acc: 0.9722222089767456, corresponding to test acc:                         0.9552572965621948 / 0.9640460014343262
after epoch: 16,now: 2024-06-27 08:18:01.677725,epoch time: 0:24:55.371619,used: 6:37:18.465016,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99777347, 'precision': 0.99825656, 'recall': 0.99592924, 'specificity': 0.99592924, 'f1': 0.9970858, 'auroc': 0.9998796, 'binary_precision': 0.99924725, 'binary_recall': 0.9921185, 'binary_specificity': 0.99974006, 'binary_f1_score': 0.99567014}
confusion matrix:
       0      1
0  42311     11
1    116  14602
---- Validation: 
scalar performance:
{'acc': 0.968923, 'precision': 0.81330115, 'recall': 0.59538233, 'specificity': 0.59538233, 'f1': 0.6419345, 'auroc': 0.9521347, 'binary_precision': 0.65445024, 'binary_recall': 0.19440125, 'binary_specificity': 0.99636346, 'binary_f1_score': 0.2997602}
confusion matrix:
       0    1
0  18083   66
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7380816, 'recall': 0.5862864, 'specificity': 0.5862864, 'f1': 0.62249744, 'auroc': 0.93655765, 'binary_precision': 0.51086956, 'binary_recall': 0.18007663, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.26628894}
confusion matrix:
      0   1
0  5952  45
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_17.png
early stop counter: 7
val acc:0.9689229726791382, best validation acc: 0.9722222089767456, corresponding to test acc:                         0.9552572965621948 / 0.9640460014343262
after epoch: 17,now: 2024-06-27 08:42:33.164505,epoch time: 0:24:31.486780,used: 7:01:49.951796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9983696, 'precision': 0.99874675, 'recall': 0.9969959, 'specificity': 0.9969959, 'f1': 0.99786735, 'auroc': 0.9999329, 'binary_precision': 0.99952185, 'binary_recall': 0.9941572, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.9968323}
confusion matrix:
       0      1
0  42314      7
1     86  14633
---- Validation: 
scalar performance:
{'acc': 0.9716369, 'precision': 0.8928207, 'recall': 0.6102884, 'specificity': 0.6102884, 'f1': 0.6673544, 'auroc': 0.96328163, 'binary_precision': 0.8125, 'binary_recall': 0.22239502, 'binary_specificity': 0.9981817, 'binary_f1_score': 0.34920633}
confusion matrix:
       0    1
0  18116   33
1    500  143
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.4791267, 'recall': 0.49949974, 'specificity': 0.49949974, 'f1': 0.48910117, 'auroc': 0.94992864, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5991  6
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_18.png
early stop counter: 8
val acc:0.9716368913650513, best validation acc: 0.9722222089767456, corresponding to test acc:                         0.9552572965621948 / 0.9640460014343262
after epoch: 18,now: 2024-06-27 09:07:31.246827,epoch time: 0:24:58.082322,used: 7:26:48.034118,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9980891, 'precision': 0.9985584, 'recall': 0.9964512, 'specificity': 0.9964512, 'f1': 0.997499, 'auroc': 0.9998672, 'binary_precision': 0.9995212, 'binary_recall': 0.9930678, 'binary_specificity': 0.9998346, 'binary_f1_score': 0.99628407}
confusion matrix:
       0      1
0  42319      7
1    102  14612
---- Validation: 
scalar performance:
{'acc': 0.9731269, 'precision': 0.8269016, 'recall': 0.70406663, 'specificity': 0.70406663, 'f1': 0.75006855, 'auroc': 0.9536842, 'binary_precision': 0.67424244, 'binary_recall': 0.41524106, 'binary_specificity': 0.99289215, 'binary_f1_score': 0.5139557}
confusion matrix:
       0    1
0  18020  129
1    376  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7523175, 'recall': 0.5110774, 'specificity': 0.5110774, 'f1': 0.5114414, 'auroc': 0.9507987, 'binary_precision': 0.54545456, 'binary_recall': 0.022988506, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.04411765}
confusion matrix:
      0  1
0  5992  5
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_19.png
better model found
persisted
after epoch: 19,now: 2024-06-27 09:32:02.326641,epoch time: 0:24:31.079814,used: 7:51:19.113932,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98774546, 'precision': 0.99182725, 'recall': 0.97629786, 'specificity': 0.97629786, 'f1': 0.98374426, 'auroc': 0.9995733, 'binary_precision': 0.99985737, 'binary_recall': 0.95264304, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.97567934}
confusion matrix:
       0      1
0  42320      2
1    697  14021
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.89926803, 'recall': 0.5524914, 'specificity': 0.5524914, 'f1': 0.5858032, 'auroc': 0.9389782, 'binary_precision': 0.8292683, 'binary_recall': 0.10575428, 'binary_specificity': 0.9992286, 'binary_f1_score': 0.18758622}
confusion matrix:
       0   1
0  18135  14
1    575  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.4791367, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.48922622, 'auroc': 0.8926499, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_20.png
early stop counter: 1
val acc:0.9686568975448608, best validation acc: 0.9731268882751465, corresponding to test acc:                         0.9584531784057617 / 0.9640460014343262
after epoch: 20,now: 2024-06-27 09:58:16.854259,epoch time: 0:26:14.527618,used: 8:17:33.641550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99730015, 'precision': 0.9978262, 'recall': 0.9951228, 'specificity': 0.9951228, 'f1': 0.9964649, 'auroc': 0.9998858, 'binary_precision': 0.9989038, 'binary_recall': 0.9906237, 'binary_specificity': 0.9996219, 'binary_f1_score': 0.9947465}
confusion matrix:
       0      1
0  42306     16
1    138  14580
---- Validation: 
scalar performance:
{'acc': 0.9647722, 'precision': 0.71228313, 'recall': 0.56998175, 'specificity': 0.56998175, 'f1': 0.6015775, 'auroc': 0.94787705, 'binary_precision': 0.45410627, 'binary_recall': 0.14618973, 'binary_specificity': 0.99377376, 'binary_f1_score': 0.22117645}
confusion matrix:
       0    1
0  18036  113
1    549   94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9534995, 'precision': 0.47904626, 'recall': 0.49749875, 'specificity': 0.49749875, 'f1': 0.48809817, 'auroc': 0.9458668, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5967  30
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_21.png
early stop counter: 2
val acc:0.9647722244262695, best validation acc: 0.9731268882751465, corresponding to test acc:                         0.9584531784057617 / 0.9640460014343262
after epoch: 21,now: 2024-06-27 10:23:14.400642,epoch time: 0:24:57.546383,used: 8:42:31.187933,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99765074, 'precision': 0.99649644, 'recall': 0.99737537, 'specificity': 0.99737537, 'f1': 0.9969349, 'auroc': 0.99989814, 'binary_precision': 0.9941045, 'binary_recall': 0.99680644, 'binary_specificity': 0.99794436, 'binary_f1_score': 0.9954536}
confusion matrix:
       0      1
0  42236     87
1     47  14670
---- Validation: 
scalar performance:
{'acc': 0.9698276, 'precision': 0.76900005, 'recall': 0.8111165, 'specificity': 0.8111165, 'f1': 0.7883568, 'auroc': 0.9560095, 'binary_precision': 0.5508021, 'binary_recall': 0.6407465, 'binary_specificity': 0.98148656, 'binary_f1_score': 0.59237957}
confusion matrix:
       0    1
0  17813  336
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95317996, 'precision': 0.65321255, 'recall': 0.5614637, 'specificity': 0.5614637, 'f1': 0.5843641, 'auroc': 0.9061289, 'binary_precision': 0.34313726, 'binary_recall': 0.13409962, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.19283748}
confusion matrix:
      0   1
0  5930  67
1   226  35
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_22.png
early stop counter: 3
val acc:0.9698275923728943, best validation acc: 0.9731268882751465, corresponding to test acc:                         0.9584531784057617 / 0.9640460014343262
after epoch: 22,now: 2024-06-27 10:48:27.483653,epoch time: 0:25:13.083011,used: 9:07:44.270944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9962307, 'precision': 0.9947199, 'recall': 0.99544287, 'specificity': 0.99544287, 'f1': 0.9950807, 'auroc': 0.9997239, 'binary_precision': 0.9915915, 'binary_recall': 0.9938154, 'binary_specificity': 0.9970704, 'binary_f1_score': 0.99270225}
confusion matrix:
       0      1
0  42202    124
1     91  14623
---- Validation: 
scalar performance:
{'acc': 0.9634951, 'precision': 0.73214185, 'recall': 0.82133913, 'specificity': 0.82133913, 'f1': 0.7686194, 'auroc': 0.95570815, 'binary_precision': 0.47619048, 'binary_recall': 0.6687403, 'binary_specificity': 0.9739379, 'binary_f1_score': 0.55627424}
confusion matrix:
       0    1
0  17676  473
1    213  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9483861, 'precision': 0.615958, 'recall': 0.5607948, 'specificity': 0.5607948, 'f1': 0.57781523, 'auroc': 0.91307515, 'binary_precision': 0.26865673, 'binary_recall': 0.13793103, 'binary_specificity': 0.9836585, 'binary_f1_score': 0.18227847}
confusion matrix:
      0   1
0  5899  98
1   225  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_23.png
early stop counter: 4
val acc:0.9634950757026672, best validation acc: 0.9731268882751465, corresponding to test acc:                         0.9584531784057617 / 0.9640460014343262
after epoch: 23,now: 2024-06-27 11:14:32.018759,epoch time: 0:26:04.535106,used: 9:33:48.806050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99747545, 'precision': 0.9958799, 'recall': 0.99754536, 'specificity': 0.99754536, 'f1': 0.9967089, 'auroc': 0.99995714, 'binary_precision': 0.99256456, 'binary_recall': 0.9976899, 'binary_specificity': 0.9974009, 'binary_f1_score': 0.99512064}
confusion matrix:
       0      1
0  42212    110
1     34  14684
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.75017333, 'recall': 0.84629893, 'specificity': 0.84629893, 'f1': 0.78953135, 'auroc': 0.96064115, 'binary_precision': 0.51052046, 'binary_recall': 0.7169518, 'binary_specificity': 0.975646, 'binary_f1_score': 0.59637773}
confusion matrix:
       0    1
0  17707  442
1    182  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.971876, 'precision': 0.8479687, 'recall': 0.76544595, 'specificity': 0.76544595, 'f1': 0.80056214, 'auroc': 0.95946074, 'binary_precision': 0.71573603, 'binary_recall': 0.54022986, 'binary_specificity': 0.990662, 'binary_f1_score': 0.61572045}
confusion matrix:
      0    1
0  5941   56
1   120  141
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_24.png
new oracle model saved
early stop counter: 5
val acc:0.9667943716049194, best validation acc: 0.9731268882751465, corresponding to test acc:                         0.9584531784057617 / 0.9718760251998901
after epoch: 24,now: 2024-06-27 11:39:32.459892,epoch time: 0:25:00.441133,used: 9:58:49.247183,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99446005, 'precision': 0.99107504, 'recall': 0.99453807, 'specificity': 0.99453807, 'f1': 0.99279034, 'auroc': 0.9997231, 'binary_precision': 0.984, 'binary_recall': 0.9946993, 'binary_specificity': 0.99437684, 'binary_f1_score': 0.98932076}
confusion matrix:
       0      1
0  42087    238
1     78  14637
---- Validation: 
scalar performance:
{'acc': 0.97115797, 'precision': 0.777182, 'recall': 0.82755643, 'specificity': 0.82755643, 'f1': 0.80003726, 'auroc': 0.96057403, 'binary_precision': 0.5660131, 'binary_recall': 0.6734059, 'binary_specificity': 0.981707, 'binary_f1_score': 0.6150569}
confusion matrix:
       0    1
0  17817  332
1    210  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.83865654, 'recall': 0.6410935, 'specificity': 0.6410935, 'f1': 0.69542885, 'auroc': 0.95353997, 'binary_precision': 0.7075472, 'binary_recall': 0.28735632, 'binary_specificity': 0.9948307, 'binary_f1_score': 0.40871933}
confusion matrix:
      0   1
0  5966  31
1   186  75
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_25.png
early stop counter: 6
val acc:0.971157968044281, best validation acc: 0.9731268882751465, corresponding to test acc:                         0.9584531784057617 / 0.9718760251998901
after epoch: 25,now: 2024-06-27 12:05:06.931476,epoch time: 0:25:34.471584,used: 10:24:23.718767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9985975, 'precision': 0.9990119, 'recall': 0.99732673, 'specificity': 0.99732673, 'f1': 0.99816555, 'auroc': 0.99991024, 'binary_precision': 0.99986345, 'binary_recall': 0.99470073, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9972754}
confusion matrix:
       0      1
0  42319      2
1     78  14641
---- Validation: 
scalar performance:
{'acc': 0.9756811, 'precision': 0.89519894, 'recall': 0.68663764, 'specificity': 0.68663764, 'f1': 0.75093734, 'auroc': 0.9644346, 'binary_precision': 0.81208056, 'binary_recall': 0.3763608, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.5143464}
confusion matrix:
       0    1
0  18093   56
1    401  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.6458833, 'recall': 0.501749, 'specificity': 0.501749, 'f1': 0.49309576, 'auroc': 0.9578771, 'binary_precision': 0.33333334, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5995  2
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_26.png
better model found
persisted
after epoch: 26,now: 2024-06-27 12:31:51.236033,epoch time: 0:26:44.304557,used: 10:51:08.023324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9978436, 'precision': 0.99830365, 'recall': 0.9960649, 'specificity': 0.9960649, 'f1': 0.9971777, 'auroc': 0.9999161, 'binary_precision': 0.9992474, 'binary_recall': 0.99238974, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.99580675}
confusion matrix:
       0      1
0  42312     11
1    112  14605
---- Validation: 
scalar performance:
{'acc': 0.9702533, 'precision': 0.7815791, 'recall': 0.7258307, 'specificity': 0.7258307, 'f1': 0.7503362, 'auroc': 0.9605198, 'binary_precision': 0.58203125, 'binary_recall': 0.46345258, 'binary_specificity': 0.9882087, 'binary_f1_score': 0.5160173}
confusion matrix:
       0    1
0  17935  214
1    345  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.67986524, 'recall': 0.5179065, 'specificity': 0.5179065, 'f1': 0.5240901, 'auroc': 0.95278144, 'binary_precision': 0.4, 'binary_recall': 0.038314175, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.06993007}
confusion matrix:
      0   1
0  5982  15
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_27.png
early stop counter: 1
val acc:0.9702532887458801, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9581335783004761 / 0.9718760251998901
after epoch: 27,now: 2024-06-27 12:58:22.509197,epoch time: 0:26:31.273164,used: 11:17:39.296488,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99691445, 'precision': 0.9953642, 'recall': 0.99659115, 'specificity': 0.99659115, 'f1': 0.9959756, 'auroc': 0.9998747, 'binary_precision': 0.99214786, 'binary_recall': 0.9959231, 'binary_specificity': 0.9972592, 'binary_f1_score': 0.9940319}
confusion matrix:
       0      1
0  42207    116
1     60  14657
---- Validation: 
scalar performance:
{'acc': 0.9308748, 'precision': 0.60329723, 'recall': 0.68744254, 'specificity': 0.68744254, 'f1': 0.6301742, 'auroc': 0.8890839, 'binary_precision': 0.22757475, 'binary_recall': 0.42612752, 'binary_specificity': 0.9487575, 'binary_f1_score': 0.29669735}
confusion matrix:
       0    1
0  17219  930
1    369  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9335251, 'precision': 0.6680809, 'recall': 0.8187293, 'specificity': 0.8187293, 'f1': 0.71492755, 'auroc': 0.937238, 'binary_precision': 0.3500967, 'binary_recall': 0.6934866, 'binary_specificity': 0.943972, 'binary_f1_score': 0.4652956}
confusion matrix:
      0    1
0  5661  336
1    80  181
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_28.png
early stop counter: 2
val acc:0.9308748245239258, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9581335783004761 / 0.9718760251998901
after epoch: 28,now: 2024-06-27 13:24:24.541996,epoch time: 0:26:02.032799,used: 11:43:41.329287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9975631, 'precision': 0.9983406, 'recall': 0.99529976, 'specificity': 0.99529976, 'f1': 0.996808, 'auroc': 0.99994695, 'binary_precision': 0.9999314, 'binary_recall': 0.9906231, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9952555}
confusion matrix:
       0      1
0  42322      1
1    138  14579
---- Validation: 
scalar performance:
{'acc': 0.9676458, 'precision': 0.8286039, 'recall': 0.5489678, 'specificity': 0.5489678, 'f1': 0.5787064, 'auroc': 0.9464979, 'binary_precision': 0.68817204, 'binary_recall': 0.09953344, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.17391305}
confusion matrix:
       0   1
0  18120  29
1    579  64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.4790966, 'recall': 0.49874938, 'specificity': 0.49874938, 'f1': 0.48872548, 'auroc': 0.92503965, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5982  15
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_29.png
early stop counter: 3
val acc:0.9676458239555359, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9581335783004761 / 0.9718760251998901
after epoch: 29,now: 2024-06-27 13:49:32.742803,epoch time: 0:25:08.200807,used: 12:08:49.530094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9957398, 'precision': 0.9970541, 'recall': 0.9918318, 'specificity': 0.9918318, 'f1': 0.99440694, 'auroc': 0.9997932, 'binary_precision': 0.99972373, 'binary_recall': 0.9837581, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9916766}
confusion matrix:
       0      1
0  42321      4
1    239  14476
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.75661314, 'recall': 0.6846452, 'specificity': 0.6846452, 'f1': 0.71415114, 'auroc': 0.94262964, 'binary_precision': 0.5349345, 'binary_recall': 0.38102645, 'binary_specificity': 0.98826385, 'binary_f1_score': 0.44504994}
confusion matrix:
       0    1
0  17936  213
1    398  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.47912335, 'recall': 0.49941638, 'specificity': 0.49941638, 'f1': 0.48905948, 'auroc': 0.9266477, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5990  7
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_30.png
early stop counter: 4
val acc:0.9674861431121826, best validation acc: 0.9756811261177063, corresponding to test acc:                         0.9581335783004761 / 0.9718760251998901
after epoch: 30,now: 2024-06-27 14:15:06.640736,epoch time: 0:25:33.897933,used: 12:34:23.428027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_01_40_43_seed_0_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:34:23.428027 at 2024-06-27 14:15:06.640736
persisted model performance metric: 

scalar performance:
{'acc': 0.9581336, 'precision': 0.6458833, 'recall': 0.501749, 'specificity': 0.501749, 'f1': 0.49309576, 'auroc': 0.9578771, 'binary_precision': 0.33333334, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5995  2
1   260  1
oracle model performance metric: 

scalar performance:
{'acc': 0.971876, 'precision': 0.8479687, 'recall': 0.76544595, 'specificity': 0.76544595, 'f1': 0.80056214, 'auroc': 0.95946074, 'binary_precision': 0.71573603, 'binary_recall': 0.54022986, 'binary_specificity': 0.990662, 'binary_f1_score': 0.61572045}
confusion matrix:
      0    1
0  5941   56
1   120  141
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |  41687 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |  41687 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1459 TiB |   1459 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1442 TiB |   1442 TiB |
|       from small pool |  40679 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 444571 KiB |   1251 MiB |   1031 TiB |   1031 TiB |
|       from large pool | 435058 KiB |   1243 MiB |   1015 TiB |   1015 TiB |
|       from small pool |   9512 KiB |     17 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8135    |  253134 K  |  253130 K  |
|       from large pool |     187    |    1413    |  133138 K  |  133138 K  |
|       from small pool |    3301    |    7946    |  119995 K  |  119992 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8135    |  253134 K  |  253130 K  |
|       from large pool |     187    |    1413    |  133138 K  |  133138 K  |
|       from small pool |    3301    |    7946    |  119995 K  |  119992 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |     636    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      78    |    3626    |  164784 K  |  164784 K  |
|       from large pool |      37    |     600    |   99849 K  |   99849 K  |
|       from small pool |      41    |    3588    |   64935 K  |   64935 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1459 TiB |   1459 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1442 TiB |   1442 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14484 MiB |  14484 MiB |  13604 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1031 TiB |   1031 TiB |
|       from large pool |  24320 KiB |   1243 MiB |   1015 TiB |   1015 TiB |
|       from small pool |      0 KiB |     43 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133138 K  |  133138 K  |
|       from small pool |       0    |    7946    |  119995 K  |  119995 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133138 K  |  133138 K  |
|       from small pool |       0    |    7946    |  119995 K  |  119995 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |     636    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3626    |  164785 K  |  164785 K  |
|       from large pool |       4    |     600    |   99849 K  |   99849 K  |
|       from small pool |       0    |    3588    |   64936 K  |   64936 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1459 TiB |   1459 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1442 TiB |   1442 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14484 MiB |  14484 MiB |  13604 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1031 TiB |   1031 TiB |
|       from large pool |  24320 KiB |   1243 MiB |   1015 TiB |   1015 TiB |
|       from small pool |      0 KiB |     43 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133138 K  |  133138 K  |
|       from small pool |       0    |    7946    |  119995 K  |  119995 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133138 K  |  133138 K  |
|       from small pool |       0    |    7946    |  119995 K  |  119995 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |     636    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3626    |  164785 K  |  164785 K  |
|       from large pool |       4    |     600    |   99849 K  |   99849 K  |
|       from small pool |       0    |    3588    |   64936 K  |   64936 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852

 Experiment start at: 2024-06-27 14:22:43.046509
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9912549, 'precision': 0.99088347, 'recall': 0.9859684, 'specificity': 0.9859684, 'f1': 0.98839444, 'auroc': 0.9991636, 'binary_precision': 0.99014086, 'binary_recall': 0.97523755, 'binary_specificity': 0.9966993, 'binary_f1_score': 0.9826327}
confusion matrix:
       0      1
0  42275    140
1    357  14060
---- Validation: 
scalar performance:
{'acc': 0.96195304, 'precision': 0.7316065, 'recall': 0.8000205, 'specificity': 0.8000205, 'f1': 0.7608161, 'auroc': 0.93173337, 'binary_precision': 0.47732428, 'binary_recall': 0.6255572, 'binary_specificity': 0.97448385, 'binary_f1_score': 0.5414791}
confusion matrix:
       0    1
0  17606  461
1    252  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.84057176, 'recall': 0.6529943, 'specificity': 0.6529943, 'f1': 0.7077721, 'auroc': 0.905282, 'binary_precision': 0.7105263, 'binary_recall': 0.31153846, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.4331551}
confusion matrix:
      0   1
0  5913  33
1   179  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-27 16:15:19.303711,epoch time: 1:52:36.257202,used: 1:52:36.257202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99011123, 'precision': 0.985957, 'recall': 0.9879966, 'specificity': 0.9879966, 'f1': 0.9869712, 'auroc': 0.9990244, 'binary_precision': 0.97746694, 'binary_recall': 0.9837032, 'binary_specificity': 0.9922899, 'binary_f1_score': 0.98057514}
confusion matrix:
       0      1
0  42085    327
1    235  14185
---- Validation: 
scalar performance:
{'acc': 0.9663287, 'precision': 0.7561459, 'recall': 0.797283, 'specificity': 0.797283, 'f1': 0.77499723, 'auroc': 0.9462707, 'binary_precision': 0.52671754, 'binary_recall': 0.615156, 'binary_specificity': 0.97941, 'binary_f1_score': 0.5675119}
confusion matrix:
       0    1
0  17695  372
1    259  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.79935676, 'recall': 0.5525007, 'specificity': 0.5525007, 'f1': 0.5818641, 'auroc': 0.94206, 'binary_precision': 0.6363636, 'binary_recall': 0.10769231, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.18421052}
confusion matrix:
      0   1
0  5930  16
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_2.png
better model found
persisted
after epoch: 2,now: 2024-06-27 17:33:57.985528,epoch time: 1:18:38.681817,used: 3:11:14.939019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.994862, 'precision': 0.9931935, 'recall': 0.9932387, 'specificity': 0.9932387, 'f1': 0.99321604, 'auroc': 0.9996141, 'binary_precision': 0.9898058, 'binary_recall': 0.98994315, 'binary_specificity': 0.99653417, 'binary_f1_score': 0.9898745}
confusion matrix:
       0      1
0  42267    147
1    145  14273
---- Validation: 
scalar performance:
{'acc': 0.9566169, 'precision': 0.7010326, 'recall': 0.75648284, 'specificity': 0.75648284, 'f1': 0.7248994, 'auroc': 0.94006586, 'binary_precision': 0.41935483, 'binary_recall': 0.5408618, 'binary_specificity': 0.97210383, 'binary_f1_score': 0.47242048}
confusion matrix:
       0    1
0  17563  504
1    309  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7293482, 'recall': 0.507356, 'specificity': 0.507356, 'f1': 0.5042205, 'auroc': 0.9277344, 'binary_precision': 0.5, 'binary_recall': 0.015384615, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.029850746}
confusion matrix:
      0  1
0  5942  4
1   256  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_3.png
early stop counter: 1
val acc:0.9566168785095215, best validation acc: 0.9663286805152893, corresponding to test acc:                         0.9600386619567871 / 0.9658395051956177
after epoch: 3,now: 2024-06-27 18:09:12.654950,epoch time: 0:35:14.669422,used: 3:46:29.608441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99477404, 'precision': 0.99291146, 'recall': 0.9932947, 'specificity': 0.9932947, 'f1': 0.9931029, 'auroc': 0.9994346, 'binary_precision': 0.9891252, 'binary_recall': 0.99029124, 'binary_specificity': 0.9962982, 'binary_f1_score': 0.9897079}
confusion matrix:
       0      1
0  42255    157
1    140  14280
---- Validation: 
scalar performance:
{'acc': 0.9599253, 'precision': 0.7285111, 'recall': 0.8733567, 'specificity': 0.8733567, 'f1': 0.78098035, 'auroc': 0.94639885, 'binary_precision': 0.46542552, 'binary_recall': 0.78008914, 'binary_specificity': 0.96662426, 'binary_f1_score': 0.5830095}
confusion matrix:
       0    1
0  17464  603
1    148  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9394135, 'precision': 0.6763542, 'recall': 0.79183936, 'specificity': 0.79183936, 'f1': 0.7168972, 'auroc': 0.89464927, 'binary_precision': 0.36936936, 'binary_recall': 0.63076925, 'binary_specificity': 0.9529095, 'binary_f1_score': 0.4659091}
confusion matrix:
      0    1
0  5666  280
1    96  164
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_4.png
early stop counter: 2
val acc:0.9599252939224243, best validation acc: 0.9663286805152893, corresponding to test acc:                         0.9600386619567871 / 0.9658395051956177
after epoch: 4,now: 2024-06-27 18:41:45.050722,epoch time: 0:32:32.395772,used: 4:19:02.004213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9929793, 'precision': 0.98761255, 'recall': 0.9940832, 'specificity': 0.9940832, 'f1': 0.99079204, 'auroc': 0.9996903, 'binary_precision': 0.9764834, 'binary_recall': 0.99632454, 'binary_specificity': 0.9918419, 'binary_f1_score': 0.9863042}
confusion matrix:
       0      1
0  42066    346
1     53  14367
---- Validation: 
scalar performance:
{'acc': 0.9627535, 'precision': 0.73866177, 'recall': 0.8505044, 'specificity': 0.8505044, 'f1': 0.7825133, 'auroc': 0.95243734, 'binary_precision': 0.4875869, 'binary_recall': 0.7295691, 'binary_specificity': 0.97143966, 'binary_f1_score': 0.58452386}
confusion matrix:
       0    1
0  17551  516
1    182  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.7398137, 'recall': 0.8196473, 'specificity': 0.8196473, 'f1': 0.7731273, 'auroc': 0.9106742, 'binary_precision': 0.4943182, 'binary_recall': 0.66923076, 'binary_specificity': 0.9700639, 'binary_f1_score': 0.5686274}
confusion matrix:
      0    1
0  5768  178
1    86  174
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_5.png
early stop counter: 3
val acc:0.9627534747123718, best validation acc: 0.9663286805152893, corresponding to test acc:                         0.9600386619567871 / 0.9658395051956177
after epoch: 5,now: 2024-06-27 19:13:20.078844,epoch time: 0:31:35.028122,used: 4:50:37.032335,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9942462, 'precision': 0.9918847, 'recall': 0.992941, 'specificity': 0.992941, 'f1': 0.9924114, 'auroc': 0.9996344, 'binary_precision': 0.987074, 'binary_recall': 0.99029124, 'binary_specificity': 0.99559087, 'binary_f1_score': 0.98868}
confusion matrix:
       0      1
0  42225    187
1    140  14280
---- Validation: 
scalar performance:
{'acc': 0.95128065, 'precision': 0.6831912, 'recall': 0.7723123, 'specificity': 0.7723123, 'f1': 0.7176043, 'auroc': 0.9173533, 'binary_precision': 0.38235295, 'binary_recall': 0.5794948, 'binary_specificity': 0.9651298, 'binary_f1_score': 0.4607206}
confusion matrix:
       0    1
0  17437  630
1    283  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94021916, 'precision': 0.6729908, 'recall': 0.766514, 'specificity': 0.766514, 'f1': 0.7077476, 'auroc': 0.8860338, 'binary_precision': 0.3649635, 'binary_recall': 0.5769231, 'binary_specificity': 0.95610493, 'binary_f1_score': 0.4470939}
confusion matrix:
      0    1
0  5685  261
1   110  150
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_6.png
early stop counter: 4
val acc:0.9512806534767151, best validation acc: 0.9663286805152893, corresponding to test acc:                         0.9600386619567871 / 0.9658395051956177
after epoch: 6,now: 2024-06-27 19:42:00.483575,epoch time: 0:28:40.404731,used: 5:19:17.437066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99292654, 'precision': 0.99516034, 'recall': 0.9861974, 'specificity': 0.9861974, 'f1': 0.9905758, 'auroc': 0.9996524, 'binary_precision': 0.99957234, 'binary_recall': 0.97253627, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.985869}
confusion matrix:
       0      1
0  42407      6
1    396  14023
---- Validation: 
scalar performance:
{'acc': 0.9728922, 'precision': 0.87690604, 'recall': 0.66979307, 'specificity': 0.66979307, 'f1': 0.73118734, 'auroc': 0.9579034, 'binary_precision': 0.7777778, 'binary_recall': 0.34323922, 'binary_specificity': 0.99634695, 'binary_f1_score': 0.47628868}
confusion matrix:
       0    1
0  18001   66
1    442  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.97936153, 'recall': 0.50769234, 'specificity': 0.50769234, 'f1': 0.5046148, 'auroc': 0.94355994, 'binary_precision': 1.0, 'binary_recall': 0.015384615, 'binary_specificity': 1.0, 'binary_f1_score': 0.03030303}
confusion matrix:
      0  1
0  5946  0
1   256  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_7.png
better model found
persisted
after epoch: 7,now: 2024-06-27 20:07:45.932577,epoch time: 0:25:45.449002,used: 5:45:02.886068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99581224, 'precision': 0.99718624, 'recall': 0.9917699, 'specificity': 0.9917699, 'f1': 0.99444044, 'auroc': 0.9998687, 'binary_precision': 0.9999295, 'binary_recall': 0.98356336, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9916789}
confusion matrix:
       0      1
0  42412      1
1    237  14182
---- Validation: 
scalar performance:
{'acc': 0.97422624, 'precision': 0.8638052, 'recall': 0.7098246, 'specificity': 0.7098246, 'f1': 0.76445997, 'auroc': 0.96167827, 'binary_precision': 0.7486911, 'binary_recall': 0.42496285, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.54218006}
confusion matrix:
       0    1
0  17971   96
1    387  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.94068587, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_8.png
better model found
persisted
after epoch: 8,now: 2024-06-27 20:33:12.430009,epoch time: 0:25:26.497432,used: 6:10:29.383500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9979765, 'precision': 0.9985318, 'recall': 0.99612665, 'specificity': 0.99612665, 'f1': 0.99732184, 'auroc': 0.9999355, 'binary_precision': 0.9996507, 'binary_recall': 0.9923712, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.99599767}
confusion matrix:
       0      1
0  42408      5
1    110  14309
---- Validation: 
scalar performance:
{'acc': 0.97182494, 'precision': 0.8191483, 'recall': 0.7193083, 'specificity': 0.7193083, 'f1': 0.7591089, 'auroc': 0.9555359, 'binary_precision': 0.6586433, 'binary_recall': 0.4472511, 'binary_specificity': 0.9913655, 'binary_f1_score': 0.53274333}
confusion matrix:
       0    1
0  17911  156
1    372  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9521431, 'precision': 0.5140335, 'recall': 0.50240564, 'specificity': 0.50240564, 'f1': 0.49763736, 'auroc': 0.90892696, 'binary_precision': 0.069767445, 'binary_recall': 0.011538462, 'binary_specificity': 0.9932728, 'binary_f1_score': 0.01980198}
confusion matrix:
      0   1
0  5906  40
1   257   3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_9.png
early stop counter: 1
val acc:0.9718249440193176, best validation acc: 0.9742262363433838, corresponding to test acc:                         0.9577828049659729 / 0.9658395051956177
after epoch: 9,now: 2024-06-27 20:58:12.648784,epoch time: 0:25:00.218775,used: 6:35:29.602275,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9973255, 'precision': 0.9965365, 'recall': 0.9964001, 'specificity': 0.9964001, 'f1': 0.99646837, 'auroc': 0.9998274, 'binary_precision': 0.99493545, 'binary_recall': 0.9945215, 'binary_specificity': 0.9982788, 'binary_f1_score': 0.9947285}
confusion matrix:
       0      1
0  42339     73
1     79  14341
---- Validation: 
scalar performance:
{'acc': 0.96824974, 'precision': 0.76824427, 'recall': 0.808293, 'specificity': 0.808293, 'f1': 0.78671175, 'auroc': 0.9514917, 'binary_precision': 0.5501285, 'binary_recall': 0.6359584, 'binary_specificity': 0.98062766, 'binary_f1_score': 0.589938}
confusion matrix:
       0    1
0  17717  350
1    245  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.954399, 'precision': 0.6125946, 'recall': 0.5219728, 'specificity': 0.5219728, 'f1': 0.5303799, 'auroc': 0.9372757, 'binary_precision': 0.26530612, 'binary_recall': 0.05, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.084142394}
confusion matrix:
      0   1
0  5910  36
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_10.png
early stop counter: 2
val acc:0.9682497382164001, best validation acc: 0.9742262363433838, corresponding to test acc:                         0.9577828049659729 / 0.9658395051956177
after epoch: 10,now: 2024-06-27 21:22:37.581249,epoch time: 0:24:24.932465,used: 6:59:54.534740,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9972727, 'precision': 0.9971148, 'recall': 0.99567795, 'specificity': 0.99567795, 'f1': 0.9963937, 'auroc': 0.999792, 'binary_precision': 0.9967958, 'binary_recall': 0.9924405, 'binary_specificity': 0.99891543, 'binary_f1_score': 0.99461335}
confusion matrix:
       0      1
0  42367     46
1    109  14310
---- Validation: 
scalar performance:
{'acc': 0.9709178, 'precision': 0.8327193, 'recall': 0.67019963, 'specificity': 0.67019963, 'f1': 0.7229928, 'auroc': 0.95606315, 'binary_precision': 0.6893491, 'binary_recall': 0.346211, 'binary_specificity': 0.9941883, 'binary_f1_score': 0.46092975}
confusion matrix:
       0    1
0  17962  105
1    440  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.47903225, 'recall': 0.49949545, 'specificity': 0.49949545, 'f1': 0.4890499, 'auroc': 0.950114, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5940  6
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_11.png
early stop counter: 3
val acc:0.970917820930481, best validation acc: 0.9742262363433838, corresponding to test acc:                         0.9577828049659729 / 0.9658395051956177
after epoch: 11,now: 2024-06-27 21:47:05.170090,epoch time: 0:24:27.588841,used: 7:24:22.123581,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99646324, 'precision': 0.99728966, 'recall': 0.99337333, 'specificity': 0.99337333, 'f1': 0.99531186, 'auroc': 0.9996245, 'binary_precision': 0.9989472, 'binary_recall': 0.98710036, 'binary_specificity': 0.9996463, 'binary_f1_score': 0.99298847}
confusion matrix:
       0      1
0  42398     15
1    186  14233
---- Validation: 
scalar performance:
{'acc': 0.9694237, 'precision': 0.8073933, 'recall': 0.66727895, 'specificity': 0.66727895, 'f1': 0.7147918, 'auroc': 0.9431559, 'binary_precision': 0.6388889, 'binary_recall': 0.34175333, 'binary_specificity': 0.9928046, 'binary_f1_score': 0.44530493}
confusion matrix:
       0    1
0  17937  130
1    443  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.8929932, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_12.png
early stop counter: 4
val acc:0.9694237112998962, best validation acc: 0.9742262363433838, corresponding to test acc:                         0.9577828049659729 / 0.9658395051956177
after epoch: 12,now: 2024-06-27 22:11:28.581011,epoch time: 0:24:23.410921,used: 7:48:45.534502,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9976774, 'precision': 0.9981233, 'recall': 0.99574286, 'specificity': 0.99574286, 'f1': 0.99692583, 'auroc': 0.9998925, 'binary_precision': 0.99902195, 'binary_recall': 0.9918158, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.9954058}
confusion matrix:
       0      1
0  42400     14
1    118  14300
---- Validation: 
scalar performance:
{'acc': 0.96515477, 'precision': 0.7754744, 'recall': 0.55062217, 'specificity': 0.55062217, 'f1': 0.57937276, 'auroc': 0.95767415, 'binary_precision': 0.5833333, 'binary_recall': 0.104011886, 'binary_specificity': 0.9972325, 'binary_f1_score': 0.17654476}
confusion matrix:
       0   1
0  18017  50
1    603  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.47900516, 'recall': 0.49882275, 'specificity': 0.49882275, 'f1': 0.48871315, 'auroc': 0.95813006, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5932  14
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_13.png
early stop counter: 5
val acc:0.965154767036438, best validation acc: 0.9742262363433838, corresponding to test acc:                         0.9577828049659729 / 0.9658395051956177
after epoch: 13,now: 2024-06-27 22:35:58.018302,epoch time: 0:24:29.437291,used: 8:13:14.971793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99649847, 'precision': 0.997477, 'recall': 0.9932829, 'specificity': 0.9932829, 'f1': 0.9953574, 'auroc': 0.99986446, 'binary_precision': 0.9994381, 'binary_recall': 0.98675454, 'binary_specificity': 0.99981135, 'binary_f1_score': 0.9930558}
confusion matrix:
       0      1
0  42404      8
1    191  14229
---- Validation: 
scalar performance:
{'acc': 0.96979725, 'precision': 0.8902708, 'recall': 0.60309863, 'specificity': 0.60309863, 'f1': 0.65775955, 'auroc': 0.94997126, 'binary_precision': 0.80924857, 'binary_recall': 0.20802377, 'binary_specificity': 0.9981735, 'binary_f1_score': 0.33096924}
confusion matrix:
       0    1
0  18034   33
1    533  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.93899643, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_14.png
early stop counter: 6
val acc:0.9697972536087036, best validation acc: 0.9742262363433838, corresponding to test acc:                         0.9577828049659729 / 0.9658395051956177
after epoch: 14,now: 2024-06-27 23:00:43.951092,epoch time: 0:24:45.932790,used: 8:38:00.904583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.993296, 'precision': 0.9955245, 'recall': 0.9868093, 'specificity': 0.9868093, 'f1': 0.9910695, 'auroc': 0.99965996, 'binary_precision': 0.9999288, 'binary_recall': 0.97364223, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.98661035}
confusion matrix:
       0      1
0  42414      1
1    380  14037
---- Validation: 
scalar performance:
{'acc': 0.96931696, 'precision': 0.86741084, 'recall': 0.60428005, 'specificity': 0.60428005, 'f1': 0.65745777, 'auroc': 0.95552087, 'binary_precision': 0.76344085, 'binary_recall': 0.21099554, 'binary_specificity': 0.9975646, 'binary_f1_score': 0.33061698}
confusion matrix:
       0    1
0  18023   44
1    531  142
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6458602, 'recall': 0.5035098, 'specificity': 0.5035098, 'f1': 0.49673337, 'auroc': 0.94971156, 'binary_precision': 0.33333334, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.015037594}
confusion matrix:
      0  1
0  5942  4
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_15.png
early stop counter: 7
val acc:0.9693169593811035, best validation acc: 0.9742262363433838, corresponding to test acc:                         0.9577828049659729 / 0.9658395051956177
after epoch: 15,now: 2024-06-27 23:25:19.476217,epoch time: 0:24:35.525125,used: 9:02:36.429708,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99741346, 'precision': 0.99778473, 'recall': 0.9953832, 'specificity': 0.9953832, 'f1': 0.99657655, 'auroc': 0.9998054, 'binary_precision': 0.9985329, 'binary_recall': 0.99126154, 'binary_specificity': 0.99950486, 'binary_f1_score': 0.9948839}
confusion matrix:
       0      1
0  42392     21
1    126  14293
---- Validation: 
scalar performance:
{'acc': 0.972572, 'precision': 0.8211204, 'recall': 0.73757744, 'specificity': 0.73757744, 'f1': 0.77251124, 'auroc': 0.95923674, 'binary_precision': 0.6612576, 'binary_recall': 0.48439822, 'binary_specificity': 0.99075663, 'binary_f1_score': 0.5591767}
confusion matrix:
       0    1
0  17900  167
1    347  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72912633, 'recall': 0.501839, 'specificity': 0.501839, 'f1': 0.49311718, 'auroc': 0.95349896, 'binary_precision': 0.5, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0076335873}
confusion matrix:
      0  1
0  5945  1
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_16.png
early stop counter: 8
val acc:0.9725720286369324, best validation acc: 0.9742262363433838, corresponding to test acc:                         0.9577828049659729 / 0.9658395051956177
after epoch: 16,now: 2024-06-27 23:49:56.629053,epoch time: 0:24:37.152836,used: 9:27:13.582544,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99776536, 'precision': 0.9965432, 'recall': 0.99756444, 'specificity': 0.99756444, 'f1': 0.9970525, 'auroc': 0.9999199, 'binary_precision': 0.9940542, 'binary_recall': 0.9971565, 'binary_specificity': 0.9979723, 'binary_f1_score': 0.99560297}
confusion matrix:
       0      1
0  42327     86
1     41  14378
---- Validation: 
scalar performance:
{'acc': 0.9776414, 'precision': 0.8587979, 'recall': 0.7931363, 'specificity': 0.7931363, 'f1': 0.8223603, 'auroc': 0.96465147, 'binary_precision': 0.73260075, 'binary_recall': 0.5943536, 'binary_specificity': 0.991919, 'binary_f1_score': 0.65627563}
confusion matrix:
       0    1
0  17921  146
1    273  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7923061, 'recall': 0.5187262, 'specificity': 0.5187262, 'f1': 0.5256848, 'auroc': 0.93468314, 'binary_precision': 0.625, 'binary_recall': 0.03846154, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.072463766}
confusion matrix:
      0   1
0  5940   6
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_17.png
better model found
persisted
after epoch: 17,now: 2024-06-28 00:14:28.047672,epoch time: 0:24:31.418619,used: 9:51:45.001163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99813485, 'precision': 0.99781, 'recall': 0.99726254, 'specificity': 0.99726254, 'f1': 0.9975359, 'auroc': 0.9999281, 'binary_precision': 0.9971516, 'binary_recall': 0.99549174, 'binary_specificity': 0.99903333, 'binary_f1_score': 0.99632096}
confusion matrix:
       0      1
0  42373     41
1     65  14353
---- Validation: 
scalar performance:
{'acc': 0.96915686, 'precision': 0.7798455, 'recall': 0.756549, 'specificity': 0.756549, 'f1': 0.76763594, 'auroc': 0.9563277, 'binary_precision': 0.57723576, 'binary_recall': 0.5274888, 'binary_specificity': 0.9856091, 'binary_f1_score': 0.5512422}
confusion matrix:
       0    1
0  17807  260
1    318  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.8595747, 'recall': 0.5530894, 'specificity': 0.5530894, 'f1': 0.5843297, 'auroc': 0.94326353, 'binary_precision': 0.7567568, 'binary_recall': 0.10769231, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.1885522}
confusion matrix:
      0   1
0  5937   9
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_18.png
early stop counter: 1
val acc:0.9691568613052368, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9587495923042297 / 0.9658395051956177
after epoch: 18,now: 2024-06-28 00:38:59.847248,epoch time: 0:24:31.799576,used: 10:16:16.800739,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9984692, 'precision': 0.9985841, 'recall': 0.9973721, 'specificity': 0.9973721, 'f1': 0.9979762, 'auroc': 0.99990237, 'binary_precision': 0.99881655, 'binary_recall': 0.99514496, 'binary_specificity': 0.9995992, 'binary_f1_score': 0.9969773}
confusion matrix:
       0      1
0  42397     17
1     70  14348
---- Validation: 
scalar performance:
{'acc': 0.9739061, 'precision': 0.84249014, 'recall': 0.7318319, 'specificity': 0.7318319, 'f1': 0.77555466, 'auroc': 0.96182716, 'binary_precision': 0.70444447, 'binary_recall': 0.47102526, 'binary_specificity': 0.9926385, 'binary_f1_score': 0.5645592}
confusion matrix:
       0    1
0  17934  133
1    356  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9537544, 'precision': 0.5648468, 'recall': 0.5106025, 'specificity': 0.5106025, 'f1': 0.5114071, 'auroc': 0.91314685, 'binary_precision': 0.17073171, 'binary_recall': 0.026923077, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.04651163}
confusion matrix:
      0   1
0  5912  34
1   253   7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_19.png
early stop counter: 2
val acc:0.9739060997962952, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9587495923042297 / 0.9658395051956177
after epoch: 19,now: 2024-06-28 01:03:33.172796,epoch time: 0:24:33.325548,used: 10:40:50.126287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9982404, 'precision': 0.99845386, 'recall': 0.99689853, 'specificity': 0.99689853, 'f1': 0.99767315, 'auroc': 0.99988854, 'binary_precision': 0.9988851, 'binary_recall': 0.99417436, 'binary_specificity': 0.99962276, 'binary_f1_score': 0.9965242}
confusion matrix:
       0      1
0  42397     16
1     84  14335
---- Validation: 
scalar performance:
{'acc': 0.96947706, 'precision': 0.8299892, 'recall': 0.6358349, 'specificity': 0.6358349, 'f1': 0.689206, 'auroc': 0.9606518, 'binary_precision': 0.6863469, 'binary_recall': 0.27637443, 'binary_specificity': 0.9952953, 'binary_f1_score': 0.39406776}
confusion matrix:
       0    1
0  17982   85
1    487  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.5245506, 'recall': 0.5010822, 'specificity': 0.5010822, 'f1': 0.49261189, 'auroc': 0.9448058, 'binary_precision': 0.09090909, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.007380074}
confusion matrix:
      0   1
0  5936  10
1   259   1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_20.png
early stop counter: 3
val acc:0.9694770574569702, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9587495923042297 / 0.9658395051956177
after epoch: 20,now: 2024-06-28 01:28:15.740747,epoch time: 0:24:42.567951,used: 11:05:32.694238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99848676, 'precision': 0.9982296, 'recall': 0.99777323, 'specificity': 0.99777323, 'f1': 0.99800116, 'auroc': 0.9999323, 'binary_precision': 0.9977083, 'binary_recall': 0.99632454, 'binary_specificity': 0.9992219, 'binary_f1_score': 0.99701595}
confusion matrix:
       0      1
0  42379     33
1     53  14367
---- Validation: 
scalar performance:
{'acc': 0.974333, 'precision': 0.81194425, 'recall': 0.82575333, 'specificity': 0.82575333, 'f1': 0.81868345, 'auroc': 0.96340543, 'binary_precision': 0.6363636, 'binary_recall': 0.66567606, 'binary_specificity': 0.98583055, 'binary_f1_score': 0.6506899}
confusion matrix:
       0    1
0  17811  256
1    225  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626168, 'precision': 0.7939639, 'recall': 0.63660055, 'specificity': 0.63660055, 'f1': 0.68348235, 'auroc': 0.9587017, 'binary_precision': 0.61864406, 'binary_recall': 0.28076923, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.3862434}
confusion matrix:
      0   1
0  5901  45
1   187  73
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_21.png
early stop counter: 4
val acc:0.9743329882621765, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9587495923042297 / 0.9658395051956177
after epoch: 21,now: 2024-06-28 01:52:50.225974,epoch time: 0:24:34.485227,used: 11:30:07.179465,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9983108, 'precision': 0.99880123, 'recall': 0.99673975, 'specificity': 0.99673975, 'f1': 0.99776506, 'auroc': 0.9999151, 'binary_precision': 0.9997906, 'binary_recall': 0.9935502, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.99666065}
confusion matrix:
       0      1
0  42410      3
1     93  14326
---- Validation: 
scalar performance:
{'acc': 0.9725187, 'precision': 0.9148866, 'recall': 0.6402734, 'specificity': 0.6402734, 'f1': 0.70525205, 'auroc': 0.96946806, 'binary_precision': 0.8558559, 'binary_recall': 0.28231797, 'binary_specificity': 0.9982288, 'binary_f1_score': 0.424581}
confusion matrix:
       0    1
0  18035   32
1    483  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.7799548, 'recall': 0.5224042, 'specificity': 0.5224042, 'f1': 0.53230655, 'auroc': 0.9630356, 'binary_precision': 0.6, 'binary_recall': 0.046153847, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.08571429}
confusion matrix:
      0   1
0  5938   8
1   248  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_22.png
early stop counter: 5
val acc:0.9725186824798584, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9587495923042297 / 0.9658395051956177
after epoch: 22,now: 2024-06-28 02:17:23.279064,epoch time: 0:24:33.053090,used: 11:54:40.232555,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99818766, 'precision': 0.9981886, 'recall': 0.9970236, 'specificity': 0.9970236, 'f1': 0.9976043, 'auroc': 0.9999027, 'binary_precision': 0.9981905, 'binary_recall': 0.9946602, 'binary_specificity': 0.99938697, 'binary_f1_score': 0.9964222}
confusion matrix:
       0      1
0  42386     26
1     77  14343
---- Validation: 
scalar performance:
{'acc': 0.96873, 'precision': 0.81468576, 'recall': 0.6333016, 'specificity': 0.6333016, 'f1': 0.68420565, 'auroc': 0.954913, 'binary_precision': 0.65591395, 'binary_recall': 0.27191678, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.38445377}
confusion matrix:
       0    1
0  17971   96
1    490  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96084434, 'precision': 0.80906427, 'recall': 0.5676331, 'specificity': 0.5676331, 'f1': 0.6042419, 'auroc': 0.9351891, 'binary_precision': 0.6545454, 'binary_recall': 0.13846155, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.22857143}
confusion matrix:
      0   1
0  5927  19
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_23.png
early stop counter: 6
val acc:0.9687299728393555, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9587495923042297 / 0.9658395051956177
after epoch: 23,now: 2024-06-28 02:41:53.696409,epoch time: 0:24:30.417345,used: 12:19:10.649900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99841636, 'precision': 0.99820495, 'recall': 0.9976114, 'specificity': 0.9976114, 'f1': 0.9979077, 'auroc': 0.99988955, 'binary_precision': 0.99777657, 'binary_recall': 0.9959772, 'binary_specificity': 0.9992455, 'binary_f1_score': 0.99687606}
confusion matrix:
       0      1
0  42382     32
1     58  14360
---- Validation: 
scalar performance:
{'acc': 0.9744931, 'precision': 0.871472, 'recall': 0.70710194, 'specificity': 0.70710194, 'f1': 0.7640743, 'auroc': 0.9591036, 'binary_precision': 0.7642276, 'binary_recall': 0.4190193, 'binary_specificity': 0.9951846, 'binary_f1_score': 0.5412668}
confusion matrix:
       0    1
0  17980   87
1    391  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.77927756, 'recall': 0.50560105, 'specificity': 0.50560105, 'f1': 0.5006597, 'auroc': 0.9600489, 'binary_precision': 0.6, 'binary_recall': 0.011538462, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.02264151}
confusion matrix:
      0  1
0  5944  2
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_24.png
early stop counter: 7
val acc:0.9744930863380432, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9587495923042297 / 0.9658395051956177
after epoch: 24,now: 2024-06-28 03:06:31.929781,epoch time: 0:24:38.233372,used: 12:43:48.883272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9982404, 'precision': 0.9983388, 'recall': 0.997013, 'specificity': 0.997013, 'f1': 0.99767363, 'auroc': 0.9999081, 'binary_precision': 0.9985377, 'binary_recall': 0.99452114, 'binary_specificity': 0.99950486, 'binary_f1_score': 0.99652535}
confusion matrix:
       0      1
0  42392     21
1     79  14340
---- Validation: 
scalar performance:
{'acc': 0.96755606, 'precision': 0.9297302, 'recall': 0.5547286, 'specificity': 0.5547286, 'f1': 0.5896056, 'auroc': 0.9429438, 'binary_precision': 0.8915663, 'binary_recall': 0.10995542, 'binary_specificity': 0.9995019, 'binary_f1_score': 0.1957672}
confusion matrix:
       0   1
0  18058   9
1    599  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.4790424, 'recall': 0.49974772, 'specificity': 0.49974772, 'f1': 0.48917606, 'auroc': 0.94998133, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5943  3
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_25.png
early stop counter: 8
val acc:0.9675560593605042, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9587495923042297 / 0.9658395051956177
after epoch: 25,now: 2024-06-28 03:30:57.636154,epoch time: 0:24:25.706373,used: 13:08:14.589645,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9987507, 'precision': 0.9989568, 'recall': 0.9977441, 'specificity': 0.9977441, 'f1': 0.99834853, 'auroc': 0.9999676, 'binary_precision': 0.99937356, 'binary_recall': 0.9957004, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.99753356}
confusion matrix:
       0      1
0  42403      9
1     62  14358
---- Validation: 
scalar performance:
{'acc': 0.96921027, 'precision': 0.88350713, 'recall': 0.59492624, 'specificity': 0.59492624, 'f1': 0.6466181, 'auroc': 0.9541588, 'binary_precision': 0.7962963, 'binary_recall': 0.19167905, 'binary_specificity': 0.9981735, 'binary_f1_score': 0.308982}
confusion matrix:
       0    1
0  18034   33
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.60411966, 'recall': 0.5016708, 'specificity': 0.5016708, 'f1': 0.4930042, 'auroc': 0.9314397, 'binary_precision': 0.25, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0075757573}
confusion matrix:
      0  1
0  5943  3
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_26.png
early stop counter: 9
val acc:0.9692102670669556, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9587495923042297 / 0.9658395051956177
after epoch: 26,now: 2024-06-28 03:55:28.371206,epoch time: 0:24:30.735052,used: 13:32:45.324697,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99811727, 'precision': 0.9987418, 'recall': 0.9962894, 'specificity': 0.9962894, 'f1': 0.99750787, 'auroc': 0.99995613, 'binary_precision': 1.0, 'binary_recall': 0.99257874, 'binary_specificity': 1.0, 'binary_f1_score': 0.99627554}
confusion matrix:
       0      1
0  42414      0
1    107  14311
---- Validation: 
scalar performance:
{'acc': 0.96755606, 'precision': 0.870954, 'recall': 0.56760347, 'specificity': 0.56760347, 'f1': 0.6078755, 'auroc': 0.9569451, 'binary_precision': 0.77310926, 'binary_recall': 0.13670133, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.23232321}
confusion matrix:
       0   1
0  18040  27
1    581  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.7294222, 'recall': 0.5091949, 'specificity': 0.5091949, 'f1': 0.5078119, 'auroc': 0.94094193, 'binary_precision': 0.5, 'binary_recall': 0.01923077, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.037037037}
confusion matrix:
      0  1
0  5941  5
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_27.png
early stop counter: 10
val acc:0.9675560593605042, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9587495923042297 / 0.9658395051956177
after epoch: 27,now: 2024-06-28 04:19:58.593141,epoch time: 0:24:30.221935,used: 13:57:15.546632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99665684, 'precision': 0.9977231, 'recall': 0.9934577, 'specificity': 0.9934577, 'f1': 0.9955671, 'auroc': 0.999835, 'binary_precision': 0.9998595, 'binary_recall': 0.98696256, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.99336916}
confusion matrix:
       0      1
0  42410      2
1    188  14232
---- Validation: 
scalar performance:
{'acc': 0.96221983, 'precision': 0.62718534, 'recall': 0.5161978, 'specificity': 0.5161978, 'f1': 0.5221065, 'auroc': 0.95136875, 'binary_precision': 0.28915662, 'binary_recall': 0.035661217, 'binary_specificity': 0.9967344, 'binary_f1_score': 0.06349206}
confusion matrix:
       0   1
0  18008  59
1    649  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.47901872, 'recall': 0.4991591, 'specificity': 0.4991591, 'f1': 0.4888816, 'auroc': 0.91706693, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5936  10
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_28.png
early stop counter: 11
val acc:0.9622198343276978, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9587495923042297 / 0.9658395051956177
after epoch: 28,now: 2024-06-28 04:44:23.417573,epoch time: 0:24:24.824432,used: 14:21:40.371064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9971847, 'precision': 0.99574447, 'recall': 0.996832, 'specificity': 0.996832, 'f1': 0.99628663, 'auroc': 0.9998989, 'binary_precision': 0.9928107, 'binary_recall': 0.996116, 'binary_specificity': 0.997548, 'binary_f1_score': 0.9944606}
confusion matrix:
       0      1
0  42310    104
1     56  14362
---- Validation: 
scalar performance:
{'acc': 0.9704376, 'precision': 0.8038045, 'recall': 0.7114361, 'specificity': 0.7114361, 'f1': 0.74854034, 'auroc': 0.9532176, 'binary_precision': 0.6285097, 'binary_recall': 0.43239227, 'binary_specificity': 0.9904799, 'binary_f1_score': 0.5123239}
confusion matrix:
       0    1
0  17895  172
1    382  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96165, 'precision': 0.8209688, 'recall': 0.57908744, 'specificity': 0.57908744, 'f1': 0.6205919, 'auroc': 0.9497417, 'binary_precision': 0.67741936, 'binary_recall': 0.16153847, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.26086956}
confusion matrix:
      0   1
0  5926  20
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_29.png
early stop counter: 12
val acc:0.9704375863075256, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9587495923042297 / 0.9658395051956177
after epoch: 29,now: 2024-06-28 05:08:47.473763,epoch time: 0:24:24.056190,used: 14:46:04.427254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9984516, 'precision': 0.9989647, 'recall': 0.9969485, 'specificity': 0.9969485, 'f1': 0.9979514, 'auroc': 0.9999653, 'binary_precision': 1.0, 'binary_recall': 0.99389696, 'binary_specificity': 1.0, 'binary_f1_score': 0.9969391}
confusion matrix:
       0      1
0  42413      0
1     88  14331
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.91371846, 'recall': 0.51846284, 'specificity': 0.51846284, 'f1': 0.5267486, 'auroc': 0.95085984, 'binary_precision': 0.86206895, 'binary_recall': 0.0371471, 'binary_specificity': 0.9997786, 'binary_f1_score': 0.07122507}
confusion matrix:
       0   1
0  18063   4
1    648  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.94498444, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_30.png
early stop counter: 13
val acc:0.965208113193512, best validation acc: 0.9776414036750793, corresponding to test acc:                         0.9587495923042297 / 0.9658395051956177
after epoch: 30,now: 2024-06-28 05:33:13.106971,epoch time: 0:24:25.633208,used: 15:10:30.060462,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_14_22_43_seed_1_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 15:10:30.060462 at 2024-06-28 05:33:13.106971
persisted model performance metric: 

scalar performance:
{'acc': 0.9587496, 'precision': 0.7923061, 'recall': 0.5187262, 'specificity': 0.5187262, 'f1': 0.5256848, 'auroc': 0.93468314, 'binary_precision': 0.625, 'binary_recall': 0.03846154, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.072463766}
confusion matrix:
      0   1
0  5940   6
1   250  10
oracle model performance metric: 

scalar performance:
{'acc': 0.9658395, 'precision': 0.84057176, 'recall': 0.6529943, 'specificity': 0.6529943, 'f1': 0.7077721, 'auroc': 0.905282, 'binary_precision': 0.7105263, 'binary_recall': 0.31153846, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.4331551}
confusion matrix:
      0   1
0  5913  33
1   179  81
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456207 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |  41675 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456207 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |  41675 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   2905 TiB |   2905 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2872 TiB |   2872 TiB |
|       from small pool |  40676 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14484 MiB |  28078 MiB |  13604 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     70 MiB |     86 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446961 KiB |   1252 MiB |   2054 TiB |   2054 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   2020 TiB |   2020 TiB |
|       from small pool |  11572 KiB |     43 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8135    |  504365 K  |  504362 K  |
|       from large pool |     187    |    1413    |  265197 K  |  265197 K  |
|       from small pool |    3277    |    7946    |  239168 K  |  239164 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8135    |  504365 K  |  504362 K  |
|       from large pool |     187    |    1413    |  265197 K  |  265197 K  |
|       from small pool |    3277    |    7946    |  239168 K  |  239164 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    1208    |     574    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      35    |      43    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      87    |    3626    |  321511 K  |  321511 K  |
|       from large pool |      40    |     604    |  193287 K  |  193287 K  |
|       from small pool |      47    |    3588    |  128223 K  |  128223 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2905 TiB |   2905 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2872 TiB |   2872 TiB |
|       from small pool |      0 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  28078 MiB |  27196 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |   2054 TiB |   2054 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   2020 TiB |   2020 TiB |
|       from small pool |      0 KiB |     43 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  504365 K  |  504365 K  |
|       from large pool |       2    |    1413    |  265197 K  |  265197 K  |
|       from small pool |       0    |    7946    |  239168 K  |  239168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  504365 K  |  504365 K  |
|       from large pool |       2    |    1413    |  265197 K  |  265197 K  |
|       from small pool |       0    |    7946    |  239168 K  |  239168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1208    |    1145    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3626    |  321512 K  |  321512 K  |
|       from large pool |       4    |     604    |  193287 K  |  193287 K  |
|       from small pool |       0    |    3588    |  128225 K  |  128225 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2905 TiB |   2905 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2872 TiB |   2872 TiB |
|       from small pool |      0 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  28078 MiB |  27196 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |   2054 TiB |   2054 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   2020 TiB |   2020 TiB |
|       from small pool |      0 KiB |     43 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  504365 K  |  504365 K  |
|       from large pool |       2    |    1413    |  265197 K  |  265197 K  |
|       from small pool |       0    |    7946    |  239168 K  |  239168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  504365 K  |  504365 K  |
|       from large pool |       2    |    1413    |  265197 K  |  265197 K  |
|       from small pool |       0    |    7946    |  239168 K  |  239168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1208    |    1145    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3626    |  321512 K  |  321512 K  |
|       from large pool |       4    |     604    |  193287 K  |  193287 K  |
|       from small pool |       0    |    3588    |  128225 K  |  128225 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852

 Experiment start at: 2024-06-28 05:40:39.505551
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9792479, 'precision': 0.9855789, 'recall': 0.9612237, 'specificity': 0.9612237, 'f1': 0.9725871, 'auroc': 0.9959307, 'binary_precision': 0.99792796, 'binary_recall': 0.92313284, 'binary_specificity': 0.9993146, 'binary_f1_score': 0.9590743}
confusion matrix:
       0      1
0  42281     29
1   1163  13967
---- Validation: 
scalar performance:
{'acc': 0.9500346, 'precision': 0.6545689, 'recall': 0.7421087, 'specificity': 0.7421087, 'f1': 0.68709356, 'auroc': 0.86639416, 'binary_precision': 0.3253638, 'binary_recall': 0.5199336, 'binary_specificity': 0.96428376, 'binary_f1_score': 0.40025577}
confusion matrix:
       0    1
0  17522  649
1    289  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89774, 'precision': 0.5969511, 'recall': 0.7544809, 'specificity': 0.7544809, 'f1': 0.628631, 'auroc': 0.85815084, 'binary_precision': 0.21137026, 'binary_recall': 0.59917355, 'binary_specificity': 0.90978825, 'binary_f1_score': 0.31250003}
confusion matrix:
      0    1
0  5456  541
1    97  145
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-28 06:05:58.051746,epoch time: 0:25:18.546195,used: 0:25:18.546195,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9952298, 'precision': 0.9964529, 'recall': 0.99126357, 'specificity': 0.99126357, 'f1': 0.9938214, 'auroc': 0.99948347, 'binary_precision': 0.9989923, 'binary_recall': 0.98288167, 'binary_specificity': 0.9996455, 'binary_f1_score': 0.9908715}
confusion matrix:
       0      1
0  42295     15
1    259  14871
---- Validation: 
scalar performance:
{'acc': 0.97267354, 'precision': 0.79759467, 'recall': 0.6935745, 'specificity': 0.6935745, 'f1': 0.73363066, 'auroc': 0.9406773, 'binary_precision': 0.6149871, 'binary_recall': 0.39534885, 'binary_specificity': 0.9918001, 'binary_f1_score': 0.4812942}
confusion matrix:
       0    1
0  18022  149
1    364  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96281457, 'precision': 0.8567495, 'recall': 0.53057486, 'specificity': 0.53057486, 'f1': 0.5477562, 'auroc': 0.9226316, 'binary_precision': 0.75, 'binary_recall': 0.06198347, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.114503816}
confusion matrix:
      0   1
0  5992   5
1   227  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-28 06:30:40.763076,epoch time: 0:24:42.711330,used: 0:50:01.257525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9817026, 'precision': 0.96842384, 'recall': 0.986306, 'specificity': 0.986306, 'f1': 0.976873, 'auroc': 0.99950194, 'binary_precision': 0.93829775, 'binary_recall': 0.9960344, 'binary_specificity': 0.97657764, 'binary_f1_score': 0.96630436}
confusion matrix:
       0      1
0  41319    991
1     60  15070
---- Validation: 
scalar performance:
{'acc': 0.8888297, 'precision': 0.6033505, 'recall': 0.89278436, 'specificity': 0.89278436, 'f1': 0.64015555, 'auroc': 0.94815814, 'binary_precision': 0.21052632, 'binary_recall': 0.89700997, 'binary_specificity': 0.8885587, 'binary_f1_score': 0.34101674}
confusion matrix:
       0     1
0  16146  2025
1     62   540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8105466, 'precision': 0.57070196, 'recall': 0.82015836, 'specificity': 0.82015836, 'f1': 0.5726439, 'auroc': 0.8853406, 'binary_precision': 0.14977646, 'binary_recall': 0.8305785, 'binary_specificity': 0.8097382, 'binary_f1_score': 0.25378788}
confusion matrix:
      0     1
0  4856  1141
1    41   201
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_3.png
early stop counter: 1
val acc:0.8888297080993652, best validation acc: 0.9726735353469849, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 3,now: 2024-06-28 06:55:28.329442,epoch time: 0:24:47.566366,used: 1:14:48.823891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99479455, 'precision': 0.9952456, 'recall': 0.9913291, 'specificity': 0.9913291, 'f1': 0.9932662, 'auroc': 0.9995618, 'binary_precision': 0.996186, 'binary_recall': 0.9840053, 'binary_specificity': 0.9986528, 'binary_f1_score': 0.9900582}
confusion matrix:
       0      1
0  42253     57
1    242  14888
---- Validation: 
scalar performance:
{'acc': 0.97080916, 'precision': 0.76650524, 'recall': 0.74159735, 'specificity': 0.74159735, 'f1': 0.75338006, 'auroc': 0.9430753, 'binary_precision': 0.5496324, 'binary_recall': 0.49667773, 'binary_specificity': 0.98651695, 'binary_f1_score': 0.52181506}
confusion matrix:
       0    1
0  17926  245
1    303  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9541593, 'precision': 0.6490972, 'recall': 0.58158934, 'specificity': 0.58158934, 'f1': 0.6037791, 'auroc': 0.87603444, 'binary_precision': 0.33076924, 'binary_recall': 0.17768595, 'binary_specificity': 0.98549277, 'binary_f1_score': 0.2311828}
confusion matrix:
      0   1
0  5910  87
1   199  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_4.png
early stop counter: 2
val acc:0.9708091616630554, best validation acc: 0.9726735353469849, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 4,now: 2024-06-28 07:20:19.754910,epoch time: 0:24:51.425468,used: 1:39:40.249359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9961525, 'precision': 0.99599934, 'recall': 0.99407655, 'specificity': 0.99407655, 'f1': 0.9950329, 'auroc': 0.9997562, 'binary_precision': 0.9956779, 'binary_recall': 0.98968935, 'binary_specificity': 0.99846375, 'binary_f1_score': 0.9926746}
confusion matrix:
       0      1
0  42245     65
1    156  14974
---- Validation: 
scalar performance:
{'acc': 0.971182, 'precision': 0.7654361, 'recall': 0.8124582, 'specificity': 0.8124582, 'f1': 0.78683054, 'auroc': 0.9583319, 'binary_precision': 0.542777, 'binary_recall': 0.64285713, 'binary_specificity': 0.9820593, 'binary_f1_score': 0.5885931}
confusion matrix:
       0    1
0  17845  326
1    215  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94887, 'precision': 0.65752304, 'recall': 0.6581476, 'specificity': 0.6581476, 'f1': 0.6578346, 'auroc': 0.9012345, 'binary_precision': 0.3415638, 'binary_recall': 0.3429752, 'binary_specificity': 0.97332, 'binary_f1_score': 0.34226805}
confusion matrix:
      0    1
0  5837  160
1   159   83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_5.png
early stop counter: 3
val acc:0.9711819887161255, best validation acc: 0.9726735353469849, corresponding to test acc:                         0.9628145694732666 / 0.9628145694732666
after epoch: 5,now: 2024-06-28 07:45:02.182214,epoch time: 0:24:42.427304,used: 2:04:22.676663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9966574, 'precision': 0.9976759, 'recall': 0.99371827, 'specificity': 0.99371827, 'f1': 0.9956757, 'auroc': 0.99987257, 'binary_precision': 0.99979925, 'binary_recall': 0.98750746, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9936153}
confusion matrix:
       0      1
0  42308      3
1    189  14940
---- Validation: 
scalar performance:
{'acc': 0.9757631, 'precision': 0.8225533, 'recall': 0.74576247, 'specificity': 0.74576247, 'f1': 0.77853346, 'auroc': 0.9611433, 'binary_precision': 0.6615385, 'binary_recall': 0.5, 'binary_specificity': 0.99152493, 'binary_f1_score': 0.56953645}
confusion matrix:
       0    1
0  18017  154
1    301  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668216, 'precision': 0.89909047, 'recall': 0.5901587, 'specificity': 0.5901587, 'f1': 0.6406571, 'auroc': 0.9281264, 'binary_precision': 0.8301887, 'binary_recall': 0.18181819, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2983051}
confusion matrix:
      0   1
0  5988   9
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-28 08:10:10.353993,epoch time: 0:25:08.171779,used: 2:29:30.848442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97836006, 'precision': 0.96854824, 'recall': 0.97633076, 'specificity': 0.97633076, 'f1': 0.9723481, 'auroc': 0.99726534, 'binary_precision': 0.9471888, 'binary_recall': 0.9720423, 'binary_specificity': 0.98061925, 'binary_f1_score': 0.9594546}
confusion matrix:
       0      1
0  41490    820
1    423  14707
---- Validation: 
scalar performance:
{'acc': 0.9544026, 'precision': 0.6921167, 'recall': 0.8640192, 'specificity': 0.8640192, 'f1': 0.7475839, 'auroc': 0.9504965, 'binary_precision': 0.39219016, 'binary_recall': 0.76744187, 'binary_specificity': 0.96059656, 'binary_f1_score': 0.5191012}
confusion matrix:
       0    1
0  17455  716
1    140  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589678, 'precision': 0.7254548, 'recall': 0.7308134, 'specificity': 0.7308134, 'f1': 0.72809815, 'auroc': 0.8910662, 'binary_precision': 0.4717742, 'binary_recall': 0.48347107, 'binary_specificity': 0.97815573, 'binary_f1_score': 0.477551}
confusion matrix:
      0    1
0  5866  131
1   125  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_7.png
early stop counter: 1
val acc:0.9544026255607605, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9668216109275818
after epoch: 7,now: 2024-06-28 08:35:11.462475,epoch time: 0:25:01.108482,used: 2:54:31.956924,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9969359, 'precision': 0.99753857, 'recall': 0.9945652, 'specificity': 0.9945652, 'f1': 0.9960398, 'auroc': 0.9998196, 'binary_precision': 0.998799, 'binary_recall': 0.9895558, 'binary_specificity': 0.9995746, 'binary_f1_score': 0.9941559}
confusion matrix:
       0      1
0  42294     18
1    158  14970
---- Validation: 
scalar performance:
{'acc': 0.97128856, 'precision': 0.7713012, 'recall': 0.7402389, 'specificity': 0.7402389, 'f1': 0.75473475, 'auroc': 0.95598567, 'binary_precision': 0.55932206, 'binary_recall': 0.49335548, 'binary_specificity': 0.98712236, 'binary_f1_score': 0.52427185}
confusion matrix:
       0    1
0  17937  234
1    305  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96906555, 'precision': 0.886863, 'recall': 0.63296354, 'specificity': 0.63296354, 'f1': 0.6932993, 'auroc': 0.95204425, 'binary_precision': 0.80246913, 'binary_recall': 0.26859504, 'binary_specificity': 0.997332, 'binary_f1_score': 0.40247676}
confusion matrix:
      0   1
0  5981  16
1   177  65
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_8.png
new oracle model saved
early stop counter: 2
val acc:0.9712885618209839, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 8,now: 2024-06-28 09:00:08.946279,epoch time: 0:24:57.483804,used: 3:19:29.440728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99232244, 'precision': 0.987623, 'recall': 0.9927716, 'specificity': 0.9927716, 'f1': 0.99015963, 'auroc': 0.9995676, 'binary_precision': 0.97750473, 'binary_recall': 0.99372107, 'binary_specificity': 0.99182224, 'binary_f1_score': 0.98554623}
confusion matrix:
       0      1
0  41964    346
1     95  15035
---- Validation: 
scalar performance:
{'acc': 0.95530814, 'precision': 0.6918747, 'recall': 0.8436077, 'specificity': 0.8436077, 'f1': 0.7431153, 'auroc': 0.9453515, 'binary_precision': 0.393147, 'binary_recall': 0.72425246, 'binary_specificity': 0.962963, 'binary_f1_score': 0.5096435}
confusion matrix:
       0    1
0  17498  673
1    166  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9325212, 'precision': 0.6108573, 'recall': 0.65955704, 'specificity': 0.65955704, 'f1': 0.6296863, 'auroc': 0.9029356, 'binary_precision': 0.24788733, 'binary_recall': 0.36363637, 'binary_specificity': 0.9554777, 'binary_f1_score': 0.29480737}
confusion matrix:
      0    1
0  5730  267
1   154   88
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_9.png
early stop counter: 3
val acc:0.9553081393241882, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 9,now: 2024-06-28 09:25:03.432844,epoch time: 0:24:54.486565,used: 3:44:23.927293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99505574, 'precision': 0.9966662, 'recall': 0.99061465, 'specificity': 0.99061465, 'f1': 0.9935904, 'auroc': 0.9997164, 'binary_precision': 1.0, 'binary_recall': 0.98122936, 'binary_specificity': 1.0, 'binary_f1_score': 0.9905258}
confusion matrix:
       0      1
0  42310      0
1    284  14846
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.9840179, 'recall': 0.5016611, 'specificity': 0.5016611, 'f1': 0.4951904, 'auroc': 0.94970596, 'binary_precision': 1.0, 'binary_recall': 0.003322259, 'binary_specificity': 1.0, 'binary_f1_score': 0.0066225166}
confusion matrix:
       0  1
0  18171  0
1    600  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.94585204, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_10.png
early stop counter: 4
val acc:0.9680392146110535, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 10,now: 2024-06-28 09:49:52.551858,epoch time: 0:24:49.119014,used: 4:09:13.046307,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9969882, 'precision': 0.9971658, 'recall': 0.9950684, 'specificity': 0.9950684, 'f1': 0.99611104, 'auroc': 0.99976647, 'binary_precision': 0.99753845, 'binary_recall': 0.99101126, 'binary_specificity': 0.9991255, 'binary_f1_score': 0.9942641}
confusion matrix:
       0      1
0  42273     37
1    136  14994
---- Validation: 
scalar performance:
{'acc': 0.97256696, 'precision': 0.7764664, 'recall': 0.8043401, 'specificity': 0.8043401, 'f1': 0.78966624, 'auroc': 0.95466304, 'binary_precision': 0.56541353, 'binary_recall': 0.62458473, 'binary_specificity': 0.9840955, 'binary_f1_score': 0.59352803}
confusion matrix:
       0    1
0  17882  289
1    226  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9674627, 'precision': 0.8186158, 'recall': 0.65988815, 'specificity': 0.65988815, 'f1': 0.71045995, 'auroc': 0.93554986, 'binary_precision': 0.66386557, 'binary_recall': 0.3264463, 'binary_specificity': 0.99333, 'binary_f1_score': 0.43767315}
confusion matrix:
      0   1
0  5957  40
1   163  79
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_11.png
early stop counter: 5
val acc:0.9725669622421265, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 11,now: 2024-06-28 10:14:50.685944,epoch time: 0:24:58.134086,used: 4:34:11.180393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9953517, 'precision': 0.99241364, 'recall': 0.9956771, 'specificity': 0.9956771, 'f1': 0.9940305, 'auroc': 0.9998114, 'binary_precision': 0.986132, 'binary_recall': 0.99636483, 'binary_specificity': 0.99498934, 'binary_f1_score': 0.991222}
confusion matrix:
       0      1
0  42098    212
1     55  15075
---- Validation: 
scalar performance:
{'acc': 0.9643637, 'precision': 0.7285367, 'recall': 0.8611343, 'specificity': 0.8611343, 'f1': 0.7780504, 'auroc': 0.95592654, 'binary_precision': 0.4654995, 'binary_recall': 0.7508306, 'binary_specificity': 0.971438, 'binary_f1_score': 0.5746981}
confusion matrix:
       0    1
0  17652  519
1    150  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95752525, 'precision': 0.7117842, 'recall': 0.6923909, 'specificity': 0.6923909, 'f1': 0.70155525, 'auroc': 0.93127656, 'binary_precision': 0.44748858, 'binary_recall': 0.40495867, 'binary_specificity': 0.97982323, 'binary_f1_score': 0.42516267}
confusion matrix:
      0    1
0  5876  121
1   144   98
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_12.png
early stop counter: 6
val acc:0.964363694190979, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 12,now: 2024-06-28 10:40:01.439716,epoch time: 0:25:10.753772,used: 4:59:21.934165,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9971971, 'precision': 0.9968828, 'recall': 0.99588954, 'specificity': 0.99588954, 'f1': 0.9963848, 'auroc': 0.99985003, 'binary_precision': 0.9962209, 'binary_recall': 0.9931262, 'binary_specificity': 0.9986528, 'binary_f1_score': 0.99467117}
confusion matrix:
       0      1
0  42253     57
1    104  15026
---- Validation: 
scalar performance:
{'acc': 0.9684121, 'precision': 0.7466858, 'recall': 0.79898167, 'specificity': 0.79898167, 'f1': 0.77004623, 'auroc': 0.9562943, 'binary_precision': 0.50612247, 'binary_recall': 0.6179402, 'binary_specificity': 0.9800231, 'binary_f1_score': 0.5564697}
confusion matrix:
       0    1
0  17808  363
1    230  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9578458, 'precision': 0.5363186, 'recall': 0.50419736, 'specificity': 0.50419736, 'f1': 0.5003817, 'auroc': 0.9179411, 'binary_precision': 0.11111111, 'binary_recall': 0.012396694, 'binary_specificity': 0.995998, 'binary_f1_score': 0.022304833}
confusion matrix:
      0   1
0  5973  24
1   239   3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_13.png
early stop counter: 7
val acc:0.9684121012687683, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 13,now: 2024-06-28 11:05:15.136700,epoch time: 0:25:13.696984,used: 5:24:35.631149,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9979805, 'precision': 0.9971465, 'recall': 0.99765265, 'specificity': 0.99765265, 'f1': 0.9973992, 'auroc': 0.99988496, 'binary_precision': 0.99538076, 'binary_recall': 0.9969597, 'binary_specificity': 0.99834555, 'binary_f1_score': 0.9961696}
confusion matrix:
       0      1
0  42240     70
1     46  15084
---- Validation: 
scalar performance:
{'acc': 0.9746444, 'precision': 0.80720663, 'recall': 0.74759376, 'specificity': 0.74759376, 'f1': 0.77391547, 'auroc': 0.9537496, 'binary_precision': 0.6307054, 'binary_recall': 0.50498337, 'binary_specificity': 0.99020416, 'binary_f1_score': 0.5608856}
confusion matrix:
       0    1
0  17993  178
1    298  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.79101384, 'recall': 0.58659184, 'specificity': 0.58659184, 'f1': 0.62853235, 'auroc': 0.92701066, 'binary_precision': 0.6142857, 'binary_recall': 0.17768595, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.27564102}
confusion matrix:
      0   1
0  5970  27
1   199  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_14.png
early stop counter: 8
val acc:0.9746444225311279, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 14,now: 2024-06-28 11:31:12.514753,epoch time: 0:25:57.378053,used: 5:50:33.009202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9916434, 'precision': 0.98962027, 'recall': 0.98882914, 'specificity': 0.98882914, 'f1': 0.98922384, 'auroc': 0.99889493, 'binary_precision': 0.9853565, 'binary_recall': 0.98288167, 'binary_specificity': 0.99477667, 'binary_f1_score': 0.98411757}
confusion matrix:
       0      1
0  42089    221
1    259  14871
---- Validation: 
scalar performance:
{'acc': 0.96580195, 'precision': 0.66954964, 'recall': 0.5438701, 'specificity': 0.5438701, 'f1': 0.56554586, 'auroc': 0.9165727, 'binary_precision': 0.36842105, 'binary_recall': 0.093023255, 'binary_specificity': 0.9947169, 'binary_f1_score': 0.14854111}
confusion matrix:
       0   1
0  18075  96
1    546  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9554416, 'precision': 0.4804933, 'recall': 0.4969985, 'specificity': 0.4969985, 'f1': 0.48860654, 'auroc': 0.8013804, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.993997, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5961  36
1   242   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_15.png
early stop counter: 9
val acc:0.9658019542694092, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 15,now: 2024-06-28 11:56:15.403327,epoch time: 0:25:02.888574,used: 6:15:35.897776,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9958565, 'precision': 0.9932103, 'recall': 0.9961684, 'specificity': 0.9961684, 'f1': 0.9946772, 'auroc': 0.9998903, 'binary_precision': 0.98755896, 'binary_recall': 0.9968275, 'binary_specificity': 0.9955093, 'binary_f1_score': 0.9921716}
confusion matrix:
       0      1
0  42120    190
1     48  15082
---- Validation: 
scalar performance:
{'acc': 0.9700634, 'precision': 0.75738466, 'recall': 0.8608663, 'specificity': 0.8608663, 'f1': 0.7994837, 'auroc': 0.95966995, 'binary_precision': 0.5233645, 'binary_recall': 0.74418604, 'binary_specificity': 0.97754663, 'binary_f1_score': 0.61454046}
confusion matrix:
       0    1
0  17763  408
1    154  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552813, 'precision': 0.64130926, 'recall': 0.5603628, 'specificity': 0.5603628, 'f1': 0.58179873, 'auroc': 0.9239108, 'binary_precision': 0.31683168, 'binary_recall': 0.1322314, 'binary_specificity': 0.9884942, 'binary_f1_score': 0.18658891}
confusion matrix:
      0   1
0  5928  69
1   210  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_16.png
early stop counter: 10
val acc:0.9700633883476257, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 16,now: 2024-06-28 12:21:15.776163,epoch time: 0:25:00.372836,used: 6:40:36.270612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99711, 'precision': 0.99795914, 'recall': 0.99459875, 'specificity': 0.99459875, 'f1': 0.9962635, 'auroc': 0.9998365, 'binary_precision': 0.9997328, 'binary_recall': 0.9892921, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.994485}
confusion matrix:
       0      1
0  42307      4
1    162  14967
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7405893, 'recall': 0.51689154, 'specificity': 0.51689154, 'f1': 0.52451646, 'auroc': 0.9396267, 'binary_precision': 0.5121951, 'binary_recall': 0.034883723, 'binary_specificity': 0.99889934, 'binary_f1_score': 0.06531882}
confusion matrix:
       0   1
0  18151  20
1    581  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.7537806, 'recall': 0.5119798, 'specificity': 0.5119798, 'f1': 0.51385856, 'auroc': 0.90069467, 'binary_precision': 0.54545456, 'binary_recall': 0.024793388, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.047430832}
confusion matrix:
      0  1
0  5992  5
1   236  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_17.png
early stop counter: 11
val acc:0.9679859280586243, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 17,now: 2024-06-28 12:46:23.541152,epoch time: 0:25:07.764989,used: 7:05:44.035601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9983461, 'precision': 0.99885833, 'recall': 0.99688154, 'specificity': 0.99688154, 'f1': 0.9978646, 'auroc': 0.9999205, 'binary_precision': 0.9999335, 'binary_recall': 0.99378675, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9968506}
confusion matrix:
       0      1
0  42310      1
1     94  15035
---- Validation: 
scalar performance:
{'acc': 0.9700101, 'precision': 0.8451532, 'recall': 0.55246824, 'specificity': 0.55246824, 'f1': 0.5849814, 'auroc': 0.9574437, 'binary_precision': 0.71910113, 'binary_recall': 0.10631229, 'binary_specificity': 0.9986242, 'binary_f1_score': 0.1852388}
confusion matrix:
       0   1
0  18146  25
1    538  64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.6056736, 'recall': 0.501816, 'specificity': 0.501816, 'f1': 0.49409118, 'auroc': 0.9530552, 'binary_precision': 0.25, 'binary_recall': 0.004132231, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.008130081}
confusion matrix:
      0  1
0  5994  3
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_18.png
early stop counter: 12
val acc:0.9700101017951965, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 18,now: 2024-06-28 13:11:32.678175,epoch time: 0:25:09.137023,used: 7:30:53.172624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9958217, 'precision': 0.99717987, 'recall': 0.9920682, 'specificity': 0.9920682, 'f1': 0.9945884, 'auroc': 0.99979806, 'binary_precision': 1.0, 'binary_recall': 0.9841364, 'binary_specificity': 1.0, 'binary_f1_score': 0.9920048}
confusion matrix:
       0      1
0  42311      0
1    240  14889
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.74243116, 'recall': 0.51287633, 'specificity': 0.51287633, 'f1': 0.5171357, 'auroc': 0.9500874, 'binary_precision': 0.516129, 'binary_recall': 0.026578072, 'binary_specificity': 0.99917454, 'binary_f1_score': 0.050552923}
confusion matrix:
       0   1
0  18156  15
1    586  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.91584516, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_19.png
early stop counter: 13
val acc:0.9679859280586243, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 19,now: 2024-06-28 13:36:28.466288,epoch time: 0:24:55.788113,used: 7:55:48.960737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99775416, 'precision': 0.9975172, 'recall': 0.9966921, 'specificity': 0.9966921, 'f1': 0.9971037, 'auroc': 0.99985707, 'binary_precision': 0.9970179, 'binary_recall': 0.99444777, 'binary_specificity': 0.9989365, 'binary_f1_score': 0.9957312}
confusion matrix:
       0      1
0  42266     45
1     84  15045
---- Validation: 
scalar performance:
{'acc': 0.9720343, 'precision': 0.7846426, 'recall': 0.70850223, 'specificity': 0.70850223, 'f1': 0.74016285, 'auroc': 0.9565116, 'binary_precision': 0.5881007, 'binary_recall': 0.4269103, 'binary_specificity': 0.9900941, 'binary_f1_score': 0.49470645}
confusion matrix:
       0    1
0  17991  180
1    345  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634557, 'precision': 0.8910758, 'recall': 0.5368566, 'specificity': 0.5368566, 'f1': 0.55884826, 'auroc': 0.9513629, 'binary_precision': 0.8181818, 'binary_recall': 0.07438017, 'binary_specificity': 0.999333, 'binary_f1_score': 0.13636364}
confusion matrix:
      0   1
0  5993   4
1   224  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_20.png
early stop counter: 14
val acc:0.9720342755317688, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 20,now: 2024-06-28 14:01:15.572281,epoch time: 0:24:47.105993,used: 8:20:36.066730,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9968141, 'precision': 0.9971547, 'recall': 0.99463177, 'specificity': 0.99463177, 'f1': 0.9958845, 'auroc': 0.999612, 'binary_precision': 0.99786824, 'binary_recall': 0.99001986, 'binary_specificity': 0.9992437, 'binary_f1_score': 0.99392855}
confusion matrix:
       0      1
0  42278     32
1    151  14979
---- Validation: 
scalar performance:
{'acc': 0.9738987, 'precision': 0.8190792, 'recall': 0.6901921, 'specificity': 0.6901921, 'f1': 0.737028, 'auroc': 0.9438531, 'binary_precision': 0.6581921, 'binary_recall': 0.38704318, 'binary_specificity': 0.993341, 'binary_f1_score': 0.48744768}
confusion matrix:
       0    1
0  18050  121
1    369  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.925431, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_21.png
early stop counter: 15
val acc:0.973898708820343, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 21,now: 2024-06-28 14:26:12.936862,epoch time: 0:24:57.364581,used: 8:45:33.431311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99784124, 'precision': 0.998431, 'recall': 0.99600804, 'specificity': 0.99600804, 'f1': 0.9972116, 'auroc': 0.9998954, 'binary_precision': 0.999667, 'binary_recall': 0.99213433, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.99588645}
confusion matrix:
       0      1
0  42306      5
1    119  15010
---- Validation: 
scalar performance:
{'acc': 0.974751, 'precision': 0.8921575, 'recall': 0.63843423, 'specificity': 0.63843423, 'f1': 0.700956, 'auroc': 0.94680226, 'binary_precision': 0.8076923, 'binary_recall': 0.27906978, 'binary_specificity': 0.9977987, 'binary_f1_score': 0.41481483}
confusion matrix:
       0    1
0  18131   40
1    434  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.9168539, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_22.png
early stop counter: 16
val acc:0.9747509956359863, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 22,now: 2024-06-28 14:51:13.922311,epoch time: 0:25:00.985449,used: 9:10:34.416760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9979631, 'precision': 0.9970926, 'recall': 0.99766195, 'specificity': 0.99766195, 'f1': 0.9973768, 'auroc': 0.99979305, 'binary_precision': 0.9952494, 'binary_recall': 0.9970256, 'binary_specificity': 0.9982983, 'binary_f1_score': 0.9961367}
confusion matrix:
       0      1
0  42239     72
1     45  15084
---- Validation: 
scalar performance:
{'acc': 0.96761304, 'precision': 0.74362206, 'recall': 0.8491609, 'specificity': 0.8491609, 'f1': 0.7858881, 'auroc': 0.9579092, 'binary_precision': 0.49657536, 'binary_recall': 0.72259134, 'binary_specificity': 0.97573054, 'binary_f1_score': 0.5886333}
confusion matrix:
       0    1
0  17730  441
1    167  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.7949652, 'recall': 0.57659477, 'specificity': 0.57659477, 'f1': 0.6160902, 'auroc': 0.9342109, 'binary_precision': 0.6229508, 'binary_recall': 0.1570248, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.25082508}
confusion matrix:
      0   1
0  5974  23
1   204  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_23.png
early stop counter: 17
val acc:0.9676130414009094, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 23,now: 2024-06-28 15:16:22.467613,epoch time: 0:25:08.545302,used: 9:35:42.962062,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99794567, 'precision': 0.997648, 'recall': 0.99705577, 'specificity': 0.99705577, 'f1': 0.9973514, 'auroc': 0.9998436, 'binary_precision': 0.99702024, 'binary_recall': 0.9951751, 'binary_specificity': 0.9989364, 'binary_f1_score': 0.9960968}
confusion matrix:
       0      1
0  42265     45
1     73  15057
---- Validation: 
scalar performance:
{'acc': 0.9653758, 'precision': 0.7008909, 'recall': 0.611106, 'specificity': 0.611106, 'f1': 0.64166176, 'auroc': 0.9297202, 'binary_precision': 0.42682928, 'binary_recall': 0.23255815, 'binary_specificity': 0.9896538, 'binary_f1_score': 0.30107528}
confusion matrix:
       0    1
0  17983  188
1    462  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9554416, 'precision': 0.51643074, 'recall': 0.50294673, 'specificity': 0.50294673, 'f1': 0.49916434, 'auroc': 0.903835, 'binary_precision': 0.071428575, 'binary_recall': 0.012396694, 'binary_specificity': 0.9934968, 'binary_f1_score': 0.021126762}
confusion matrix:
      0   1
0  5958  39
1   239   3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_24.png
early stop counter: 18
val acc:0.9653757810592651, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 24,now: 2024-06-28 15:41:19.686791,epoch time: 0:24:57.219178,used: 10:00:40.181240,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9986769, 'precision': 0.9987827, 'recall': 0.9978069, 'specificity': 0.9978069, 'f1': 0.99829346, 'auroc': 0.99991906, 'binary_precision': 0.99900556, 'binary_recall': 0.9959683, 'binary_specificity': 0.9996455, 'binary_f1_score': 0.99748456}
confusion matrix:
       0      1
0  42295     15
1     61  15069
---- Validation: 
scalar performance:
{'acc': 0.9748575, 'precision': 0.8301109, 'recall': 0.70112705, 'specificity': 0.70112705, 'f1': 0.7487355, 'auroc': 0.9482337, 'binary_precision': 0.67955804, 'binary_recall': 0.40863788, 'binary_specificity': 0.9936162, 'binary_f1_score': 0.5103735}
confusion matrix:
       0    1
0  18055  116
1    356  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.6844021, 'recall': 0.5291575, 'specificity': 0.5291575, 'f1': 0.5435577, 'auroc': 0.914829, 'binary_precision': 0.4054054, 'binary_recall': 0.06198347, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.10752688}
confusion matrix:
      0   1
0  5975  22
1   227  15
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_25.png
early stop counter: 19
val acc:0.9748575091362, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 25,now: 2024-06-28 16:05:55.137121,epoch time: 0:24:35.450330,used: 10:25:15.631570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9985202, 'precision': 0.99865496, 'recall': 0.9975306, 'specificity': 0.9975306, 'f1': 0.998091, 'auroc': 0.9999466, 'binary_precision': 0.99893874, 'binary_recall': 0.99543923, 'binary_specificity': 0.99962187, 'binary_f1_score': 0.9971859}
confusion matrix:
       0      1
0  42295     16
1     69  15060
---- Validation: 
scalar performance:
{'acc': 0.97325945, 'precision': 0.82407564, 'recall': 0.66095215, 'specificity': 0.66095215, 'f1': 0.71301746, 'auroc': 0.9489527, 'binary_precision': 0.670068, 'binary_recall': 0.32724252, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.43973213}
confusion matrix:
       0    1
0  18074   97
1    405  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639365, 'precision': 0.86130476, 'recall': 0.5509859, 'specificity': 0.5509859, 'f1': 0.58169, 'auroc': 0.9231487, 'binary_precision': 0.75757575, 'binary_recall': 0.10330579, 'binary_specificity': 0.998666, 'binary_f1_score': 0.18181817}
confusion matrix:
      0   1
0  5989   8
1   217  25
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_26.png
early stop counter: 20
val acc:0.973259449005127, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 26,now: 2024-06-28 16:30:47.438876,epoch time: 0:24:52.301755,used: 10:50:07.933325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9983461, 'precision': 0.9986652, 'recall': 0.9970728, 'specificity': 0.9970728, 'f1': 0.99786556, 'auroc': 0.9999536, 'binary_precision': 0.99933577, 'binary_recall': 0.994382, 'binary_specificity': 0.99976367, 'binary_f1_score': 0.99685276}
confusion matrix:
       0      1
0  42300     10
1     85  15045
---- Validation: 
scalar performance:
{'acc': 0.9707026, 'precision': 0.86854327, 'recall': 0.56165946, 'specificity': 0.56165946, 'f1': 0.59967935, 'auroc': 0.9481687, 'binary_precision': 0.7653061, 'binary_recall': 0.12458472, 'binary_specificity': 0.99873424, 'binary_f1_score': 0.2142857}
confusion matrix:
       0   1
0  18148  23
1    527  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.5191072, 'recall': 0.5010656, 'specificity': 0.5010656, 'f1': 0.4935722, 'auroc': 0.899982, 'binary_precision': 0.07692308, 'binary_recall': 0.004132231, 'binary_specificity': 0.997999, 'binary_f1_score': 0.007843137}
confusion matrix:
      0   1
0  5985  12
1   241   1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_27.png
early stop counter: 21
val acc:0.970702588558197, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 27,now: 2024-06-28 16:56:10.061005,epoch time: 0:25:22.622129,used: 11:15:30.555454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9957173, 'precision': 0.9937202, 'recall': 0.99526715, 'specificity': 0.99526715, 'f1': 0.9944903, 'auroc': 0.99980855, 'binary_precision': 0.98947644, 'binary_recall': 0.9943159, 'binary_specificity': 0.9962184, 'binary_f1_score': 0.9918903}
confusion matrix:
       0      1
0  42150    160
1     86  15044
---- Validation: 
scalar performance:
{'acc': 0.96042186, 'precision': 0.70567805, 'recall': 0.808506, 'specificity': 0.808506, 'f1': 0.7454405, 'auroc': 0.9472241, 'binary_precision': 0.42328617, 'binary_recall': 0.6461794, 'binary_specificity': 0.97083265, 'binary_f1_score': 0.5115056}
confusion matrix:
       0    1
0  17641  530
1    213  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95656353, 'precision': 0.6656905, 'recall': 0.57490903, 'specificity': 0.57490903, 'f1': 0.6005763, 'auroc': 0.9268534, 'binary_precision': 0.36448598, 'binary_recall': 0.16115703, 'binary_specificity': 0.988661, 'binary_f1_score': 0.2234957}
confusion matrix:
      0   1
0  5929  68
1   203  39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_28.png
early stop counter: 22
val acc:0.9604218602180481, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 28,now: 2024-06-28 17:21:54.783031,epoch time: 0:25:44.722026,used: 11:41:15.277480,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9979805, 'precision': 0.9984176, 'recall': 0.99637866, 'specificity': 0.99637866, 'f1': 0.9973924, 'auroc': 0.99982, 'binary_precision': 0.9993348, 'binary_recall': 0.9929936, 'binary_specificity': 0.99976367, 'binary_f1_score': 0.9961541}
confusion matrix:
       0      1
0  42301     10
1    106  15023
---- Validation: 
scalar performance:
{'acc': 0.974165, 'precision': 0.8730713, 'recall': 0.6373285, 'specificity': 0.6373285, 'f1': 0.6973044, 'auroc': 0.9424327, 'binary_precision': 0.76958525, 'binary_recall': 0.27740863, 'binary_specificity': 0.99724835, 'binary_f1_score': 0.4078144}
confusion matrix:
       0    1
0  18121   50
1    435  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.5362137, 'recall': 0.5013991, 'specificity': 0.5013991, 'f1': 0.4938017, 'auroc': 0.93338245, 'binary_precision': 0.11111111, 'binary_recall': 0.004132231, 'binary_specificity': 0.998666, 'binary_f1_score': 0.007968127}
confusion matrix:
      0  1
0  5989  8
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_29.png
early stop counter: 23
val acc:0.9741650223731995, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 29,now: 2024-06-28 17:47:25.762257,epoch time: 0:25:30.979226,used: 12:06:46.256706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9986246, 'precision': 0.9989395, 'recall': 0.9975165, 'specificity': 0.9975165, 'f1': 0.9982252, 'auroc': 0.99997663, 'binary_precision': 0.99960166, 'binary_recall': 0.9951748, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9973833}
confusion matrix:
       0      1
0  42305      6
1     73  15056
---- Validation: 
scalar performance:
{'acc': 0.9752836, 'precision': 0.9385659, 'recall': 0.6282698, 'specificity': 0.6282698, 'f1': 0.6939492, 'auroc': 0.9650265, 'binary_precision': 0.9011628, 'binary_recall': 0.25747508, 'binary_specificity': 0.99906445, 'binary_f1_score': 0.4005168}
confusion matrix:
       0    1
0  18154   17
1    447  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.94351995, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587852_30.png
early stop counter: 24
val acc:0.9752836227416992, best validation acc: 0.9757630825042725, corresponding to test acc:                         0.9668216109275818 / 0.9690655469894409
after epoch: 30,now: 2024-06-28 18:13:10.415682,epoch time: 0:25:44.653425,used: 12:32:30.910131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_05_40_39_seed_2_21587852
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:32:30.910131 at 2024-06-28 18:13:10.415682
persisted model performance metric: 

scalar performance:
{'acc': 0.9668216, 'precision': 0.89909047, 'recall': 0.5901587, 'specificity': 0.5901587, 'f1': 0.6406571, 'auroc': 0.9281264, 'binary_precision': 0.8301887, 'binary_recall': 0.18181819, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.2983051}
confusion matrix:
      0   1
0  5988   9
1   198  44
oracle model performance metric: 

scalar performance:
{'acc': 0.96906555, 'precision': 0.886863, 'recall': 0.63296354, 'specificity': 0.63296354, 'f1': 0.6932993, 'auroc': 0.95204425, 'binary_precision': 0.80246913, 'binary_recall': 0.26859504, 'binary_specificity': 0.997332, 'binary_f1_score': 0.40247676}
confusion matrix:
      0   1
0  5981  16
1   177  65
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456213 KiB |  13219 MiB |   4373 TiB |   4373 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   4323 TiB |   4323 TiB |
|       from small pool |  41681 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456213 KiB |  13219 MiB |   4373 TiB |   4373 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   4323 TiB |   4323 TiB |
|       from small pool |  41681 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   4363 TiB |   4363 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   4313 TiB |   4313 TiB |
|       from small pool |  40678 KiB |     60 MiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14484 MiB |  41670 MiB |  27196 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     70 MiB |    100 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446955 KiB |   1252 MiB |   3083 TiB |   3083 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   3033 TiB |   3033 TiB |
|       from small pool |  11566 KiB |     43 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8185    |     757 M  |     757 M  |
|       from large pool |     187    |    1413    |     398 M  |     398 M  |
|       from small pool |    3289    |    7996    |     359 M  |     359 M  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8185    |     757 M  |     757 M  |
|       from large pool |     187    |    1413    |     398 M  |     398 M  |
|       from small pool |    3289    |    7996    |     359 M  |     359 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    1779    |    1145    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      35    |      50    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      85    |    3655    |  479352 K  |  479352 K  |
|       from large pool |      40    |     604    |  287366 K  |  287366 K  |
|       from small pool |      45    |    3613    |  191985 K  |  191985 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   4373 TiB |   4373 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   4323 TiB |   4323 TiB |
|       from small pool |      0 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   4373 TiB |   4373 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   4323 TiB |   4323 TiB |
|       from small pool |      0 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   4363 TiB |   4363 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   4313 TiB |   4313 TiB |
|       from small pool |      0 KiB |     60 MiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  41670 MiB |  40788 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     52 MiB |     70 MiB |    100 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |   3083 TiB |   3083 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   3033 TiB |   3033 TiB |
|       from small pool |      0 KiB |     43 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8185    |     757 M  |     757 M  |
|       from large pool |       2    |    1413    |     398 M  |     398 M  |
|       from small pool |       0    |    7996    |     359 M  |     359 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8185    |     757 M  |     757 M  |
|       from large pool |       2    |    1413    |     398 M  |     398 M  |
|       from small pool |       0    |    7996    |     359 M  |     359 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1779    |    1716    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      26    |      35    |      50    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3655    |  479353 K  |  479353 K  |
|       from large pool |       4    |     604    |  287366 K  |  287366 K  |
|       from small pool |       0    |    3613    |  191986 K  |  191986 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jun 28 18:14:32 2024]
Finished job 0.
1 of 1 steps (100%) done
