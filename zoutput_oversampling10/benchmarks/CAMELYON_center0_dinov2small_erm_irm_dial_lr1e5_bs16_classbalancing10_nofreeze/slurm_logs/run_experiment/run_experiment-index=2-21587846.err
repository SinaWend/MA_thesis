Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jun 26 23:02:59 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846

 Experiment start at: 2024-06-26 23:09:50.370910
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9919355, 'precision': 0.98946774, 'recall': 0.98946774, 'specificity': 0.98946774, 'f1': 0.98946774, 'auroc': 0.999429, 'binary_precision': 0.9843697, 'binary_recall': 0.9843697, 'binary_specificity': 0.99456584, 'binary_f1_score': 0.9843697}
confusion matrix:
       0      1
0  42095    230
1    230  14485
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96647507, 'precision': 0.7459388, 'recall': 0.687872, 'specificity': 0.687872, 'f1': 0.7125979, 'auroc': 0.9305353, 'binary_precision': 0.513347, 'binary_recall': 0.3888025, 'binary_specificity': 0.98694146, 'binary_f1_score': 0.44247788}
confusion matrix:
       0    1
0  17912  237
1    393  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9689997, 'precision': 0.9014677, 'recall': 0.65950215, 'specificity': 0.65950215, 'f1': 0.7240633, 'auroc': 0.91200197, 'binary_precision': 0.83168316, 'binary_recall': 0.3218391, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.4640884}
confusion matrix:
      0   1
0  5980  17
1   177  84
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-26 23:35:34.671902,epoch time: 0:25:44.300992,used: 0:25:44.300992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9912167, 'precision': 0.9940556, 'recall': 0.9830663, 'specificity': 0.9830663, 'f1': 0.98840165, 'auroc': 0.9993818, 'binary_precision': 0.9997188, 'binary_recall': 0.96622723, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9826877}
confusion matrix:
       0      1
0  42320      4
1    497  14219
---- Validation: 
scalar performance:
{'acc': 0.9686569, 'precision': 0.8049498, 'recall': 0.5952446, 'specificity': 0.5952446, 'f1': 0.6409722, 'auroc': 0.9255909, 'binary_precision': 0.6377551, 'binary_recall': 0.19440125, 'binary_specificity': 0.99608797, 'binary_f1_score': 0.29797378}
confusion matrix:
       0    1
0  18078   71
1    518  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.5701791, 'recall': 0.5030811, 'specificity': 0.5030811, 'f1': 0.49640882, 'auroc': 0.86622036, 'binary_precision': 0.18181819, 'binary_recall': 0.007662835, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.0147058815}
confusion matrix:
      0  1
0  5988  9
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_2.png
better model found
persisted
after epoch: 2,now: 2024-06-27 00:00:12.302886,epoch time: 0:24:37.630984,used: 0:50:21.931976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99447757, 'precision': 0.9934932, 'recall': 0.9920682, 'specificity': 0.9920682, 'f1': 0.99277794, 'auroc': 0.9995354, 'binary_precision': 0.9914687, 'binary_recall': 0.98708975, 'binary_specificity': 0.99704653, 'binary_f1_score': 0.9892744}
confusion matrix:
       0      1
0  42198    125
1    190  14527
---- Validation: 
scalar performance:
{'acc': 0.96695405, 'precision': 0.7504178, 'recall': 0.8081287, 'specificity': 0.8081287, 'f1': 0.77593374, 'auroc': 0.95313984, 'binary_precision': 0.51378447, 'binary_recall': 0.63763607, 'binary_specificity': 0.9786214, 'binary_f1_score': 0.56904924}
confusion matrix:
       0    1
0  17761  388
1    233  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97395337, 'precision': 0.888724, 'recall': 0.7482065, 'specificity': 0.7482065, 'f1': 0.8014947, 'auroc': 0.954767, 'binary_precision': 0.7987805, 'binary_recall': 0.5019157, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.61647063}
confusion matrix:
      0    1
0  5964   33
1   130  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_3.png
new oracle model saved
early stop counter: 1
val acc:0.9669540524482727, best validation acc: 0.9686568975448608, corresponding to test acc:                         0.9571748375892639 / 0.973953366279602
after epoch: 3,now: 2024-06-27 00:25:03.660968,epoch time: 0:24:51.358082,used: 1:15:13.290058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9963008, 'precision': 0.99733734, 'recall': 0.99300873, 'specificity': 0.99300873, 'f1': 0.9951483, 'auroc': 0.9995568, 'binary_precision': 0.99944913, 'binary_recall': 0.9862064, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9927836}
confusion matrix:
       0      1
0  42315      8
1    203  14514
---- Validation: 
scalar performance:
{'acc': 0.9680715, 'precision': 0.8125416, 'recall': 0.56943965, 'specificity': 0.56943965, 'f1': 0.6082165, 'auroc': 0.9454423, 'binary_precision': 0.65467626, 'binary_recall': 0.1415241, 'binary_specificity': 0.9973552, 'binary_f1_score': 0.23273656}
confusion matrix:
       0   1
0  18101  48
1    552  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.67928994, 'recall': 0.5035813, 'specificity': 0.5035813, 'f1': 0.49682495, 'auroc': 0.9368008, 'binary_precision': 0.4, 'binary_recall': 0.007662835, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.015037594}
confusion matrix:
      0  1
0  5994  3
1   259  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_4.png
early stop counter: 2
val acc:0.9680715203285217, best validation acc: 0.9686568975448608, corresponding to test acc:                         0.9571748375892639 / 0.973953366279602
after epoch: 4,now: 2024-06-27 00:49:47.768648,epoch time: 0:24:44.107680,used: 1:39:57.397738,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9910589, 'precision': 0.993809, 'recall': 0.98289704, 'specificity': 0.98289704, 'f1': 0.9881958, 'auroc': 0.9993248, 'binary_precision': 0.9992972, 'binary_recall': 0.9660303, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.98238224}
confusion matrix:
       0      1
0  42311     10
1    500  14219
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.82924354, 'recall': 0.54591244, 'specificity': 0.54591244, 'f1': 0.5739159, 'auroc': 0.9600588, 'binary_precision': 0.6896552, 'binary_recall': 0.0933126, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.16438356}
confusion matrix:
       0   1
0  18122  27
1    583  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.93203866, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_5.png
early stop counter: 3
val acc:0.967539370059967, best validation acc: 0.9686568975448608, corresponding to test acc:                         0.9571748375892639 / 0.973953366279602
after epoch: 5,now: 2024-06-27 01:15:19.504765,epoch time: 0:25:31.736117,used: 2:05:29.133855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9951087, 'precision': 0.9966335, 'recall': 0.9906085, 'specificity': 0.9906085, 'f1': 0.9935732, 'auroc': 0.999716, 'binary_precision': 0.9997231, 'binary_recall': 0.98131156, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9904318}
confusion matrix:
       0      1
0  42321      4
1    275  14440
---- Validation: 
scalar performance:
{'acc': 0.96748614, 'precision': 0.7859286, 'recall': 0.5721368, 'specificity': 0.5721368, 'f1': 0.61029625, 'auroc': 0.9350846, 'binary_precision': 0.60126585, 'binary_recall': 0.14774494, 'binary_specificity': 0.99652874, 'binary_f1_score': 0.2372035}
confusion matrix:
       0   1
0  18086  63
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.63382685, 'recall': 0.5207374, 'specificity': 0.5207374, 'f1': 0.52870333, 'auroc': 0.91934264, 'binary_precision': 0.30769232, 'binary_recall': 0.04597701, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.08}
confusion matrix:
      0   1
0  5970  27
1   249  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_6.png
early stop counter: 4
val acc:0.9674861431121826, best validation acc: 0.9686568975448608, corresponding to test acc:                         0.9571748375892639 / 0.973953366279602
after epoch: 6,now: 2024-06-27 01:39:47.330097,epoch time: 0:24:27.825332,used: 2:29:56.959187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99624825, 'precision': 0.9969169, 'recall': 0.9932835, 'specificity': 0.9932835, 'f1': 0.99508274, 'auroc': 0.99967974, 'binary_precision': 0.99828213, 'binary_recall': 0.9871577, 'binary_specificity': 0.9994093, 'binary_f1_score': 0.9926888}
confusion matrix:
       0      1
0  42298     25
1    189  14528
---- Validation: 
scalar performance:
{'acc': 0.96599615, 'precision': 0.7405873, 'recall': 0.57286555, 'specificity': 0.57286555, 'f1': 0.6077529, 'auroc': 0.94303095, 'binary_precision': 0.5105263, 'binary_recall': 0.15085536, 'binary_specificity': 0.9948757, 'binary_f1_score': 0.23289315}
confusion matrix:
       0   1
0  18056  93
1    546  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95573664, 'precision': 0.60468197, 'recall': 0.5133247, 'specificity': 0.5133247, 'f1': 0.5159726, 'auroc': 0.8955047, 'binary_precision': 0.25, 'binary_recall': 0.03065134, 'binary_specificity': 0.995998, 'binary_f1_score': 0.05460751}
confusion matrix:
      0   1
0  5973  24
1   253   8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_7.png
early stop counter: 5
val acc:0.9659961462020874, best validation acc: 0.9686568975448608, corresponding to test acc:                         0.9571748375892639 / 0.973953366279602
after epoch: 7,now: 2024-06-27 02:04:03.723644,epoch time: 0:24:16.393547,used: 2:54:13.352734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99598527, 'precision': 0.99698985, 'recall': 0.99252963, 'specificity': 0.99252963, 'f1': 0.99473345, 'auroc': 0.99975836, 'binary_precision': 0.9990355, 'binary_recall': 0.98539007, 'binary_specificity': 0.9996692, 'binary_f1_score': 0.9921658}
confusion matrix:
       0      1
0  42310     14
1    215  14501
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.8154243, 'recall': 0.62974095, 'specificity': 0.62974095, 'f1': 0.6808096, 'auroc': 0.94085914, 'binary_precision': 0.65637064, 'binary_recall': 0.2643857, 'binary_specificity': 0.99509615, 'binary_f1_score': 0.37694013}
confusion matrix:
       0    1
0  18060   89
1    473  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96180886, 'precision': 0.8761677, 'recall': 0.55680424, 'specificity': 0.55680424, 'f1': 0.590553, 'auroc': 0.9578656, 'binary_precision': 0.7894737, 'binary_recall': 0.11494253, 'binary_specificity': 0.998666, 'binary_f1_score': 0.2006689}
confusion matrix:
      0   1
0  5989   8
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_8.png
better model found
persisted
after epoch: 8,now: 2024-06-27 02:28:27.454208,epoch time: 0:24:23.730564,used: 3:18:37.083298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99426717, 'precision': 0.9961203, 'recall': 0.9889332, 'specificity': 0.9889332, 'f1': 0.9924586, 'auroc': 0.99976945, 'binary_precision': 0.99986106, 'binary_recall': 0.9779137, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.98876554}
confusion matrix:
       0      1
0  42323      2
1    325  14390
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.87575805, 'recall': 0.5361893, 'specificity': 0.5361893, 'f1': 0.55860007, 'auroc': 0.9647976, 'binary_precision': 0.78333336, 'binary_recall': 0.07309487, 'binary_specificity': 0.99928373, 'binary_f1_score': 0.13371266}
confusion matrix:
       0   1
0  18136  13
1    596  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7874361, 'recall': 0.5149088, 'specificity': 0.5149088, 'f1': 0.5186596, 'auroc': 0.93513745, 'binary_precision': 0.61538464, 'binary_recall': 0.03065134, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.058394164}
confusion matrix:
      0  1
0  5992  5
1   253  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_9.png
early stop counter: 1
val acc:0.9675925970077515, best validation acc: 0.9700936675071716, corresponding to test acc:                         0.9618088603019714 / 0.973953366279602
after epoch: 9,now: 2024-06-27 02:52:48.019319,epoch time: 0:24:20.565111,used: 3:42:57.648409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9935484, 'precision': 0.9956666, 'recall': 0.9875196, 'specificity': 0.9875196, 'f1': 0.9915056, 'auroc': 0.9994874, 'binary_precision': 0.9999303, 'binary_recall': 0.97506285, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.98734}
confusion matrix:
       0      1
0  42322      1
1    367  14350
---- Validation: 
scalar performance:
{'acc': 0.96897614, 'precision': 0.8601917, 'recall': 0.56915796, 'specificity': 0.56915796, 'f1': 0.61003876, 'auroc': 0.95501316, 'binary_precision': 0.75, 'binary_recall': 0.1399689, 'binary_specificity': 0.99834704, 'binary_f1_score': 0.23591089}
confusion matrix:
       0   1
0  18119  30
1    553  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.4791133, 'recall': 0.49916625, 'specificity': 0.49916625, 'f1': 0.48893425, 'auroc': 0.9516984, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5987  10
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_10.png
early stop counter: 2
val acc:0.9689761400222778, best validation acc: 0.9700936675071716, corresponding to test acc:                         0.9618088603019714 / 0.973953366279602
after epoch: 10,now: 2024-06-27 03:17:07.625311,epoch time: 0:24:19.605992,used: 4:07:17.254401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9969495, 'precision': 0.997681, 'recall': 0.99435365, 'specificity': 0.99435365, 'f1': 0.9960027, 'auroc': 0.99979264, 'binary_precision': 0.9991761, 'binary_recall': 0.98899084, 'binary_specificity': 0.99971646, 'binary_f1_score': 0.99405736}
confusion matrix:
       0      1
0  42313     12
1    162  14553
---- Validation: 
scalar performance:
{'acc': 0.9702533, 'precision': 0.91051304, 'recall': 0.5788198, 'specificity': 0.5788198, 'f1': 0.6260921, 'auroc': 0.9510131, 'binary_precision': 0.85, 'binary_recall': 0.15863141, 'binary_specificity': 0.99900824, 'binary_f1_score': 0.26736563}
confusion matrix:
       0    1
0  18131   18
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.77133363, 'recall': 0.5129931, 'specificity': 0.5129931, 'f1': 0.5150635, 'auroc': 0.89305204, 'binary_precision': 0.5833333, 'binary_recall': 0.026819924, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.05128205}
confusion matrix:
      0  1
0  5992  5
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_11.png
better model found
persisted
after epoch: 11,now: 2024-06-27 03:41:37.251502,epoch time: 0:24:29.626191,used: 4:31:46.880592,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9972651, 'precision': 0.9978027, 'recall': 0.9950546, 'specificity': 0.9950546, 'f1': 0.9964186, 'auroc': 0.999837, 'binary_precision': 0.9989036, 'binary_recall': 0.9904872, 'binary_specificity': 0.9996219, 'binary_f1_score': 0.99467754}
confusion matrix:
       0      1
0  42307     16
1    140  14577
---- Validation: 
scalar performance:
{'acc': 0.97307366, 'precision': 0.82858455, 'recall': 0.6995387, 'specificity': 0.6995387, 'f1': 0.7469702, 'auroc': 0.94249403, 'binary_precision': 0.67792207, 'binary_recall': 0.4059098, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.5077821}
confusion matrix:
       0    1
0  18025  124
1    382  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8868393, 'recall': 0.5568876, 'specificity': 0.5568876, 'f1': 0.5909314, 'auroc': 0.9264492, 'binary_precision': 0.8108108, 'binary_recall': 0.11494253, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.20134228}
confusion matrix:
      0   1
0  5990   7
1   231  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_12.png
better model found
persisted
after epoch: 12,now: 2024-06-27 04:05:38.890750,epoch time: 0:24:01.639248,used: 4:55:48.519840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9693899, 'precision': 0.9478898, 'recall': 0.97766626, 'specificity': 0.97766626, 'f1': 0.9613527, 'auroc': 0.9992473, 'binary_precision': 0.89767015, 'binary_recall': 0.9947683, 'binary_specificity': 0.96056426, 'binary_f1_score': 0.94372827}
confusion matrix:
       0      1
0  40653   1669
1     77  14641
---- Validation: 
scalar performance:
{'acc': 0.80784374, 'precision': 0.5701482, 'recall': 0.86601543, 'specificity': 0.86601543, 'f1': 0.5691646, 'auroc': 0.9402647, 'binary_precision': 0.14344065, 'binary_recall': 0.92846036, 'binary_specificity': 0.80357045, 'binary_f1_score': 0.24849115}
confusion matrix:
       0     1
0  14584  3565
1     46   597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8076063, 'precision': 0.56239295, 'recall': 0.7585268, 'specificity': 0.7585268, 'f1': 0.56204104, 'auroc': 0.85190296, 'binary_precision': 0.14035088, 'binary_recall': 0.70498085, 'binary_specificity': 0.8120727, 'binary_f1_score': 0.23409669}
confusion matrix:
      0     1
0  4870  1127
1    77   184
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_13.png
early stop counter: 1
val acc:0.8078437447547913, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.973953366279602
after epoch: 13,now: 2024-06-27 04:29:48.079890,epoch time: 0:24:09.189140,used: 5:19:57.708980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99768585, 'precision': 0.9982426, 'recall': 0.9957148, 'specificity': 0.9957148, 'f1': 0.9969703, 'auroc': 0.99983954, 'binary_precision': 0.9993837, 'binary_recall': 0.9916423, 'binary_specificity': 0.99978733, 'binary_f1_score': 0.99549794}
confusion matrix:
       0      1
0  42314      9
1    123  14594
---- Validation: 
scalar performance:
{'acc': 0.9724883, 'precision': 0.8780227, 'recall': 0.63473094, 'specificity': 0.63473094, 'f1': 0.69480515, 'auroc': 0.96076566, 'binary_precision': 0.78125, 'binary_recall': 0.27216175, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.4036909}
confusion matrix:
       0    1
0  18100   49
1    468  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.77936995, 'recall': 0.50558037, 'specificity': 0.50558037, 'f1': 0.50066596, 'auroc': 0.93179095, 'binary_precision': 0.6, 'binary_recall': 0.011494253, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.02255639}
confusion matrix:
      0  1
0  5995  2
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_14.png
early stop counter: 2
val acc:0.972488284111023, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.973953366279602
after epoch: 14,now: 2024-06-27 04:53:55.414041,epoch time: 0:24:07.334151,used: 5:44:05.043131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9973527, 'precision': 0.99721444, 'recall': 0.9958676, 'specificity': 0.9958676, 'f1': 0.99653864, 'auroc': 0.9997754, 'binary_precision': 0.99693, 'binary_recall': 0.99279845, 'binary_specificity': 0.9989367, 'binary_f1_score': 0.99485993}
confusion matrix:
       0      1
0  42276     45
1    106  14613
---- Validation: 
scalar performance:
{'acc': 0.9701469, 'precision': 0.77090657, 'recall': 0.81653225, 'specificity': 0.81653225, 'f1': 0.7917478, 'auroc': 0.9673983, 'binary_precision': 0.5542328, 'binary_recall': 0.65163296, 'binary_specificity': 0.9814315, 'binary_f1_score': 0.59899926}
confusion matrix:
       0    1
0  17812  337
1    224  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9753915, 'precision': 0.87181437, 'recall': 0.79476523, 'specificity': 0.79476523, 'f1': 0.8283739, 'auroc': 0.95046914, 'binary_precision': 0.7609756, 'binary_recall': 0.59770113, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.6695279}
confusion matrix:
      0    1
0  5948   49
1   105  156
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_15.png
new oracle model saved
early stop counter: 3
val acc:0.970146894454956, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 15,now: 2024-06-27 05:17:59.349297,epoch time: 0:24:03.935256,used: 6:08:08.978387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9978086, 'precision': 0.9983475, 'recall': 0.9959302, 'specificity': 0.9959302, 'f1': 0.99713117, 'auroc': 0.9998717, 'binary_precision': 0.9994523, 'binary_recall': 0.99204946, 'binary_specificity': 0.999811, 'binary_f1_score': 0.9957371}
confusion matrix:
       0      1
0  42316      8
1    117  14599
---- Validation: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.8185873, 'recall': 0.62904596, 'specificity': 0.62904596, 'f1': 0.6805637, 'auroc': 0.9639605, 'binary_precision': 0.6627451, 'binary_recall': 0.2628305, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.376392}
confusion matrix:
       0    1
0  18063   86
1    474  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95557684, 'precision': 0.5054791, 'recall': 0.50041497, 'specificity': 0.50041497, 'f1': 0.49221152, 'auroc': 0.93500113, 'binary_precision': 0.05263158, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.007142857}
confusion matrix:
      0   1
0  5979  18
1   260   1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_16.png
early stop counter: 4
val acc:0.9702000617980957, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 16,now: 2024-06-27 05:42:05.247137,epoch time: 0:24:05.897840,used: 6:32:14.876227,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9974579, 'precision': 0.99829286, 'recall': 0.9950734, 'specificity': 0.9950734, 'f1': 0.9966695, 'auroc': 0.9998029, 'binary_precision': 1.0, 'binary_recall': 0.99014676, 'binary_specificity': 1.0, 'binary_f1_score': 0.995049}
confusion matrix:
       0      1
0  42324      0
1    145  14571
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.82229316, 'recall': 0.53516376, 'specificity': 0.53516376, 'f1': 0.5563039, 'auroc': 0.95405066, 'binary_precision': 0.6764706, 'binary_recall': 0.071539655, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.12939522}
confusion matrix:
       0   1
0  18127  22
1    597  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.8127799, 'recall': 0.5074961, 'specificity': 0.5074961, 'f1': 0.504409, 'auroc': 0.9408472, 'binary_precision': 0.6666667, 'binary_recall': 0.01532567, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.029962545}
confusion matrix:
      0  1
0  5995  2
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_17.png
early stop counter: 5
val acc:0.9670604467391968, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 17,now: 2024-06-27 06:06:12.938407,epoch time: 0:24:07.691270,used: 6:56:22.567497,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9975631, 'precision': 0.9983407, 'recall': 0.9952991, 'specificity': 0.9952991, 'f1': 0.9968077, 'auroc': 0.99982476, 'binary_precision': 0.9999314, 'binary_recall': 0.9906218, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.9952549}
confusion matrix:
       0      1
0  42324      1
1    138  14577
---- Validation: 
scalar performance:
{'acc': 0.97009367, 'precision': 0.9211141, 'recall': 0.57348675, 'specificity': 0.57348675, 'f1': 0.61870056, 'auroc': 0.9591521, 'binary_precision': 0.8715596, 'binary_recall': 0.14774494, 'binary_specificity': 0.9992286, 'binary_f1_score': 0.25265956}
confusion matrix:
       0   1
0  18135  14
1    548  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7016589, 'recall': 0.50724596, 'specificity': 0.50724596, 'f1': 0.5041174, 'auroc': 0.9323961, 'binary_precision': 0.44444445, 'binary_recall': 0.01532567, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.02962963}
confusion matrix:
      0  1
0  5992  5
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_18.png
early stop counter: 6
val acc:0.9700936675071716, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 18,now: 2024-06-27 06:30:18.510985,epoch time: 0:24:05.572578,used: 7:20:28.140075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9977384, 'precision': 0.99845815, 'recall': 0.9956392, 'specificity': 0.9956392, 'f1': 0.9970382, 'auroc': 0.9998659, 'binary_precision': 0.99993145, 'binary_recall': 0.991302, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.995598}
confusion matrix:
       0      1
0  42323      1
1    128  14588
---- Validation: 
scalar performance:
{'acc': 0.971424, 'precision': 0.8733438, 'recall': 0.61542857, 'specificity': 0.61542857, 'f1': 0.67190474, 'auroc': 0.96046966, 'binary_precision': 0.77319586, 'binary_recall': 0.2332815, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.35842294}
confusion matrix:
       0    1
0  18105   44
1    493  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.4791267, 'recall': 0.49949974, 'specificity': 0.49949974, 'f1': 0.48910117, 'auroc': 0.9419478, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5991  6
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_19.png
early stop counter: 7
val acc:0.9714239835739136, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 19,now: 2024-06-27 06:54:24.010366,epoch time: 0:24:05.499381,used: 7:44:33.639456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99803644, 'precision': 0.9985679, 'recall': 0.9963057, 'specificity': 0.9963057, 'f1': 0.9974301, 'auroc': 0.99993944, 'binary_precision': 0.99965787, 'binary_recall': 0.9927295, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99618167}
confusion matrix:
       0      1
0  42318      5
1    107  14610
---- Validation: 
scalar performance:
{'acc': 0.96812475, 'precision': 0.85167205, 'recall': 0.552966, 'specificity': 0.552966, 'f1': 0.5854946, 'auroc': 0.9479956, 'binary_precision': 0.7340425, 'binary_recall': 0.10730949, 'binary_specificity': 0.99862254, 'binary_f1_score': 0.18724559}
confusion matrix:
       0   1
0  18124  25
1    574  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.9504347, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_20.png
early stop counter: 8
val acc:0.9681247472763062, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 20,now: 2024-06-27 07:18:38.357253,epoch time: 0:24:14.346887,used: 8:08:47.986343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9982644, 'precision': 0.99878824, 'recall': 0.99668133, 'specificity': 0.99668133, 'f1': 0.99772894, 'auroc': 0.99986184, 'binary_precision': 0.99986327, 'binary_recall': 0.9934099, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99662614}
confusion matrix:
       0      1
0  42319      2
1     97  14622
---- Validation: 
scalar performance:
{'acc': 0.96828437, 'precision': 0.81636727, 'recall': 0.5733001, 'specificity': 0.5733001, 'f1': 0.6137287, 'auroc': 0.961941, 'binary_precision': 0.66206896, 'binary_recall': 0.14930016, 'binary_specificity': 0.99730015, 'binary_f1_score': 0.24365483}
confusion matrix:
       0   1
0  18100  49
1    547  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501438, 'precision': 0.47897536, 'recall': 0.49574786, 'specificity': 0.49574786, 'f1': 0.4872173, 'auroc': 0.9028813, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5946  51
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_21.png
early stop counter: 9
val acc:0.9682843685150146, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 21,now: 2024-06-27 07:42:48.538923,epoch time: 0:24:10.181670,used: 8:32:58.168013,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99777347, 'precision': 0.997921, 'recall': 0.99626124, 'specificity': 0.99626124, 'f1': 0.9970874, 'auroc': 0.9998795, 'binary_precision': 0.99822414, 'binary_recall': 0.9931367, 'binary_specificity': 0.9993857, 'binary_f1_score': 0.99567384}
confusion matrix:
       0      1
0  42298     26
1    101  14615
---- Validation: 
scalar performance:
{'acc': 0.9728608, 'precision': 0.8038938, 'recall': 0.7534325, 'specificity': 0.7534325, 'f1': 0.7761593, 'auroc': 0.9575525, 'binary_precision': 0.62476546, 'binary_recall': 0.5178849, 'binary_specificity': 0.9889801, 'binary_f1_score': 0.5663265}
confusion matrix:
       0    1
0  17949  200
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9637264, 'precision': 0.884372, 'recall': 0.5852898, 'specificity': 0.5852898, 'f1': 0.6326518, 'auroc': 0.9552236, 'binary_precision': 0.8035714, 'binary_recall': 0.1724138, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.28391168}
confusion matrix:
      0   1
0  5986  11
1   216  45
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_22.png
early stop counter: 10
val acc:0.9728608131408691, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 22,now: 2024-06-27 08:07:45.668857,epoch time: 0:24:57.129934,used: 8:57:55.297947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9983345, 'precision': 0.99870086, 'recall': 0.9969499, 'specificity': 0.9969499, 'f1': 0.99782133, 'auroc': 0.99992216, 'binary_precision': 0.9994535, 'binary_recall': 0.9940889, 'binary_specificity': 0.999811, 'binary_f1_score': 0.99676394}
confusion matrix:
       0      1
0  42314      8
1     87  14631
---- Validation: 
scalar performance:
{'acc': 0.9694019, 'precision': 0.8138385, 'recall': 0.60988134, 'specificity': 0.60988134, 'f1': 0.65903044, 'auroc': 0.964635, 'binary_precision': 0.6545454, 'binary_recall': 0.22395024, 'binary_specificity': 0.9958124, 'binary_f1_score': 0.33371955}
confusion matrix:
       0    1
0  18073   76
1    499  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.94877005, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_23.png
early stop counter: 11
val acc:0.9694018959999084, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 23,now: 2024-06-27 08:33:10.162779,epoch time: 0:25:24.493922,used: 9:23:19.791869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99758065, 'precision': 0.9983072, 'recall': 0.9953784, 'specificity': 0.9953784, 'f1': 0.99683154, 'auroc': 0.9998945, 'binary_precision': 0.9997943, 'binary_recall': 0.99082756, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9952908}
confusion matrix:
       0      1
0  42319      3
1    135  14583
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.8449941, 'recall': 0.52991337, 'specificity': 0.52991337, 'f1': 0.5475636, 'auroc': 0.9425638, 'binary_precision': 0.7222222, 'binary_recall': 0.060653187, 'binary_specificity': 0.9991735, 'binary_f1_score': 0.11190817}
confusion matrix:
       0   1
0  18134  15
1    604  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.4790966, 'recall': 0.49874938, 'specificity': 0.49874938, 'f1': 0.48872548, 'auroc': 0.8898758, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5982  15
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_24.png
early stop counter: 12
val acc:0.9670604467391968, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 24,now: 2024-06-27 08:58:13.358308,epoch time: 0:25:03.195529,used: 9:48:22.987398,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99065566, 'precision': 0.9871164, 'recall': 0.9885167, 'specificity': 0.9885167, 'f1': 0.9878139, 'auroc': 0.9992021, 'binary_precision': 0.97976995, 'binary_recall': 0.98409784, 'binary_specificity': 0.9929356, 'binary_f1_score': 0.9819291}
confusion matrix:
       0      1
0  42026    299
1    234  14481
---- Validation: 
scalar performance:
{'acc': 0.9713176, 'precision': 0.85629094, 'recall': 0.6236241, 'specificity': 0.6236241, 'f1': 0.6796531, 'auroc': 0.93298554, 'binary_precision': 0.7385321, 'binary_recall': 0.2503888, 'binary_specificity': 0.9968593, 'binary_f1_score': 0.37398374}
confusion matrix:
       0    1
0  18092   57
1    482  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9097978, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_25.png
early stop counter: 13
val acc:0.9713175892829895, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 25,now: 2024-06-27 09:22:37.409570,epoch time: 0:24:24.051262,used: 10:12:47.038660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9970722, 'precision': 0.9980348, 'recall': 0.9943267, 'specificity': 0.9943267, 'f1': 0.9961626, 'auroc': 0.9999443, 'binary_precision': 1.0, 'binary_recall': 0.98865336, 'binary_specificity': 1.0, 'binary_f1_score': 0.9942943}
confusion matrix:
       0      1
0  42322      0
1    167  14551
---- Validation: 
scalar performance:
{'acc': 0.9661026, 'precision': 0.7648181, 'recall': 0.5204168, 'specificity': 0.5204168, 'f1': 0.5304407, 'auroc': 0.9408916, 'binary_precision': 0.5625, 'binary_recall': 0.041990668, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.07814761}
confusion matrix:
       0   1
0  18128  21
1    616  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.47913003, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.48914286, 'auroc': 0.91814154, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_26.png
early stop counter: 14
val acc:0.9661026000976562, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 26,now: 2024-06-27 09:46:58.065831,epoch time: 0:24:20.656261,used: 10:37:07.694921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99796635, 'precision': 0.9971255, 'recall': 0.99756587, 'specificity': 0.99756587, 'f1': 0.99734545, 'auroc': 0.99991417, 'binary_precision': 0.99538577, 'binary_recall': 0.9967385, 'binary_specificity': 0.9983933, 'binary_f1_score': 0.9960616}
confusion matrix:
       0      1
0  42255     68
1     48  14669
---- Validation: 
scalar performance:
{'acc': 0.95769477, 'precision': 0.7092947, 'recall': 0.8400878, 'specificity': 0.8400878, 'f1': 0.75686955, 'auroc': 0.94550514, 'binary_precision': 0.42897198, 'binary_recall': 0.7138414, 'binary_specificity': 0.9663342, 'binary_f1_score': 0.53590196}
confusion matrix:
       0    1
0  17538  611
1    184  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95589644, 'precision': 0.72828263, 'recall': 0.76810247, 'specificity': 0.76810247, 'f1': 0.7463428, 'auroc': 0.9132347, 'binary_precision': 0.47572815, 'binary_recall': 0.5632184, 'binary_specificity': 0.9729865, 'binary_f1_score': 0.51578945}
confusion matrix:
      0    1
0  5835  162
1   114  147
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_27.png
early stop counter: 15
val acc:0.9576947689056396, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 27,now: 2024-06-27 10:11:33.036764,epoch time: 0:24:34.970933,used: 11:01:42.665854,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99386394, 'precision': 0.98924315, 'recall': 0.99491227, 'specificity': 0.99491227, 'f1': 0.9920338, 'auroc': 0.9998716, 'binary_precision': 0.97950876, 'binary_recall': 0.9970784, 'binary_specificity': 0.9927461, 'binary_f1_score': 0.9882155}
confusion matrix:
       0      1
0  42015    307
1     43  14675
---- Validation: 
scalar performance:
{'acc': 0.9633887, 'precision': 0.72553337, 'recall': 0.7477786, 'specificity': 0.7477786, 'f1': 0.7360678, 'auroc': 0.94194186, 'binary_precision': 0.46826518, 'binary_recall': 0.5163297, 'binary_specificity': 0.9792275, 'binary_f1_score': 0.49112427}
confusion matrix:
       0    1
0  17772  377
1    311  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96196866, 'precision': 0.8209418, 'recall': 0.5825403, 'specificity': 0.5825403, 'f1': 0.62520725, 'auroc': 0.9474852, 'binary_precision': 0.6769231, 'binary_recall': 0.16858238, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.26993868}
confusion matrix:
      0   1
0  5976  21
1   217  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_28.png
early stop counter: 16
val acc:0.9633886814117432, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 28,now: 2024-06-27 10:36:03.229846,epoch time: 0:24:30.193082,used: 11:26:12.858936,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99803644, 'precision': 0.9985904, 'recall': 0.996283, 'specificity': 0.996283, 'f1': 0.9974297, 'auroc': 0.99991333, 'binary_precision': 0.99972624, 'binary_recall': 0.9926605, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99618083}
confusion matrix:
       0      1
0  42321      4
1    108  14607
---- Validation: 
scalar performance:
{'acc': 0.9713708, 'precision': 0.9123355, 'recall': 0.5981497, 'specificity': 0.5981497, 'f1': 0.6530422, 'auroc': 0.96209013, 'binary_precision': 0.852349, 'binary_recall': 0.19751166, 'binary_specificity': 0.9987878, 'binary_f1_score': 0.32070708}
confusion matrix:
       0    1
0  18127   22
1    516  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611697, 'precision': 0.93522215, 'recall': 0.53814745, 'specificity': 0.53814745, 'f1': 0.5607392, 'auroc': 0.9375772, 'binary_precision': 0.90909094, 'binary_recall': 0.07662835, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.14134276}
confusion matrix:
      0   1
0  5995   2
1   241  20
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_29.png
early stop counter: 17
val acc:0.9713708162307739, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 29,now: 2024-06-27 11:00:43.361929,epoch time: 0:24:40.132083,used: 11:50:52.991019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9965112, 'precision': 0.99766016, 'recall': 0.99323773, 'specificity': 0.99323773, 'f1': 0.9954232, 'auroc': 0.9998596, 'binary_precision': 1.0, 'binary_recall': 0.98647547, 'binary_specificity': 1.0, 'binary_f1_score': 0.9931917}
confusion matrix:
       0      1
0  42326      0
1    199  14515
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.90476274, 'recall': 0.52471805, 'specificity': 0.52471805, 'f1': 0.53863, 'auroc': 0.9502177, 'binary_precision': 0.84210527, 'binary_recall': 0.04976672, 'binary_specificity': 0.99966943, 'binary_f1_score': 0.09397944}
confusion matrix:
       0   1
0  18143   6
1    611  32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.97945315, 'recall': 0.50766283, 'specificity': 0.50766283, 'f1': 0.5046054, 'auroc': 0.94420964, 'binary_precision': 1.0, 'binary_recall': 0.01532567, 'binary_specificity': 1.0, 'binary_f1_score': 0.030188678}
confusion matrix:
      0  1
0  5997  0
1   257  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_30.png
early stop counter: 18
val acc:0.9671669006347656, best validation acc: 0.9730736613273621, corresponding to test acc:                         0.9619686603546143 / 0.9753915071487427
after epoch: 30,now: 2024-06-27 11:24:48.482087,epoch time: 0:24:05.120158,used: 12:14:58.111177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_26_23_09_50_seed_0_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:14:58.111177 at 2024-06-27 11:24:48.482087
persisted model performance metric: 

scalar performance:
{'acc': 0.96196866, 'precision': 0.8868393, 'recall': 0.5568876, 'specificity': 0.5568876, 'f1': 0.5909314, 'auroc': 0.9264492, 'binary_precision': 0.8108108, 'binary_recall': 0.11494253, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.20134228}
confusion matrix:
      0   1
0  5990   7
1   231  30
oracle model performance metric: 

scalar performance:
{'acc': 0.9753915, 'precision': 0.87181437, 'recall': 0.79476523, 'specificity': 0.79476523, 'f1': 0.8283739, 'auroc': 0.95046914, 'binary_precision': 0.7609756, 'binary_recall': 0.59770113, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.6695279}
confusion matrix:
      0    1
0  5948   49
1   105  156
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |  41687 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |  41687 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1459 TiB |   1459 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1442 TiB |   1442 TiB |
|       from small pool |  40679 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 444571 KiB |   1251 MiB |   1031 TiB |   1031 TiB |
|       from large pool | 435058 KiB |   1243 MiB |   1015 TiB |   1015 TiB |
|       from small pool |   9512 KiB |     17 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8135    |  253134 K  |  253130 K  |
|       from large pool |     187    |    1413    |  133138 K  |  133138 K  |
|       from small pool |    3301    |    7946    |  119995 K  |  119992 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8135    |  253134 K  |  253130 K  |
|       from large pool |     187    |    1413    |  133138 K  |  133138 K  |
|       from small pool |    3301    |    7946    |  119995 K  |  119992 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |     636    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    3628    |  165223 K  |  165223 K  |
|       from large pool |      37    |     600    |   99849 K  |   99849 K  |
|       from small pool |      43    |    3590    |   65374 K  |   65374 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1459 TiB |   1459 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1442 TiB |   1442 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14484 MiB |  14484 MiB |  13604 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1031 TiB |   1031 TiB |
|       from large pool |  24320 KiB |   1243 MiB |   1015 TiB |   1015 TiB |
|       from small pool |      0 KiB |     43 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133138 K  |  133138 K  |
|       from small pool |       0    |    7946    |  119995 K  |  119995 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133138 K  |  133138 K  |
|       from small pool |       0    |    7946    |  119995 K  |  119995 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |     636    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3628    |  165224 K  |  165224 K  |
|       from large pool |       4    |     600    |   99849 K  |   99849 K  |
|       from small pool |       0    |    3590    |   65375 K  |   65375 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1467 TiB |   1467 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1451 TiB |   1451 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1459 TiB |   1459 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1442 TiB |   1442 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14484 MiB |  14484 MiB |  13604 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1031 TiB |   1031 TiB |
|       from large pool |  24320 KiB |   1243 MiB |   1015 TiB |   1015 TiB |
|       from small pool |      0 KiB |     43 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133138 K  |  133138 K  |
|       from small pool |       0    |    7946    |  119995 K  |  119995 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133138 K  |  133138 K  |
|       from small pool |       0    |    7946    |  119995 K  |  119995 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |     636    |     574    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3628    |  165224 K  |  165224 K  |
|       from large pool |       4    |     600    |   99849 K  |   99849 K  |
|       from small pool |       0    |    3590    |   65375 K  |   65375 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846

 Experiment start at: 2024-06-27 11:32:15.224767
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99361277, 'precision': 0.9941217, 'recall': 0.988991, 'specificity': 0.988991, 'f1': 0.9915223, 'auroc': 0.9993036, 'binary_precision': 0.99513847, 'binary_recall': 0.97960883, 'binary_specificity': 0.99837315, 'binary_f1_score': 0.98731256}
confusion matrix:
       0      1
0  42345     69
1    294  14124
---- Validation: 
scalar performance:
{'acc': 0.9560299, 'precision': 0.7074896, 'recall': 0.81554556, 'specificity': 0.81554556, 'f1': 0.7486657, 'auroc': 0.93666947, 'binary_precision': 0.42775118, 'binary_recall': 0.6641902, 'binary_specificity': 0.966901, 'binary_f1_score': 0.5203725}
confusion matrix:
       0    1
0  17469  598
1    226  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9128263, 'precision': 0.6208024, 'recall': 0.7577356, 'specificity': 0.7577356, 'f1': 0.657248, 'auroc': 0.8815881, 'binary_precision': 0.26064736, 'binary_recall': 0.5884615, 'binary_specificity': 0.92700976, 'binary_f1_score': 0.3612751}
confusion matrix:
      0    1
0  5512  434
1   107  153
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-27 11:56:58.675827,epoch time: 0:24:43.451060,used: 0:24:43.451060,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9900056, 'precision': 0.9932933, 'recall': 0.9803967, 'specificity': 0.9803967, 'f1': 0.9866314, 'auroc': 0.99945617, 'binary_precision': 0.9997114, 'binary_recall': 0.9608877, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.97991514}
confusion matrix:
       0      1
0  42408      4
1    564  13856
---- Validation: 
scalar performance:
{'acc': 0.965048, 'precision': 0.8105912, 'recall': 0.5276783, 'specificity': 0.5276783, 'f1': 0.54307175, 'auroc': 0.9494004, 'binary_precision': 0.6551724, 'binary_recall': 0.056463595, 'binary_specificity': 0.998893, 'binary_f1_score': 0.10396716}
confusion matrix:
       0   1
0  18047  20
1    635  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.47903225, 'recall': 0.49949545, 'specificity': 0.49949545, 'f1': 0.4890499, 'auroc': 0.91593474, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5940  6
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-27 12:21:18.697029,epoch time: 0:24:20.021202,used: 0:49:03.472262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9958298, 'precision': 0.99633026, 'recall': 0.9926505, 'specificity': 0.9926505, 'f1': 0.9944729, 'auroc': 0.9997177, 'binary_precision': 0.9973345, 'binary_recall': 0.9861969, 'binary_specificity': 0.9991041, 'binary_f1_score': 0.9917344}
confusion matrix:
       0      1
0  42377     38
1    199  14218
---- Validation: 
scalar performance:
{'acc': 0.96558166, 'precision': 0.75144005, 'recall': 0.7790139, 'specificity': 0.7790139, 'f1': 0.76442194, 'auroc': 0.9513626, 'binary_precision': 0.5186667, 'binary_recall': 0.5780089, 'binary_specificity': 0.9800188, 'binary_f1_score': 0.54673225}
confusion matrix:
       0    1
0  17706  361
1    284  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9658395, 'precision': 0.92686546, 'recall': 0.6051806, 'specificity': 0.6051806, 'f1': 0.6620399, 'auroc': 0.933268, 'binary_precision': 0.88709676, 'binary_recall': 0.21153846, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.34161493}
confusion matrix:
      0   1
0  5939   7
1   205  55
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-27 12:45:39.246176,epoch time: 0:24:20.549147,used: 1:13:24.021409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99686795, 'precision': 0.99649906, 'recall': 0.99522376, 'specificity': 0.99522376, 'f1': 0.99585927, 'auroc': 0.99970675, 'binary_precision': 0.995753, 'binary_recall': 0.9918857, 'binary_specificity': 0.99856174, 'binary_f1_score': 0.9938156}
confusion matrix:
       0      1
0  42352     61
1    117  14302
---- Validation: 
scalar performance:
{'acc': 0.97145146, 'precision': 0.7979963, 'recall': 0.7727596, 'specificity': 0.7727596, 'f1': 0.7847613, 'auroc': 0.95540416, 'binary_precision': 0.6123778, 'binary_recall': 0.5586924, 'binary_specificity': 0.98682684, 'binary_f1_score': 0.5843046}
confusion matrix:
       0    1
0  17829  238
1    297  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96310025, 'precision': 0.8902974, 'recall': 0.5761663, 'specificity': 0.5761663, 'f1': 0.6199894, 'auroc': 0.950762, 'binary_precision': 0.81632656, 'binary_recall': 0.15384616, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.2588997}
confusion matrix:
      0   1
0  5937   9
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_4.png
better model found
persisted
after epoch: 4,now: 2024-06-27 13:09:52.902753,epoch time: 0:24:13.656577,used: 1:37:37.677986,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9975366, 'precision': 0.99763656, 'recall': 0.9958551, 'specificity': 0.9958551, 'f1': 0.9967417, 'auroc': 0.99985325, 'binary_precision': 0.9978385, 'binary_recall': 0.99244106, 'binary_specificity': 0.99926907, 'binary_f1_score': 0.99513245}
confusion matrix:
       0      1
0  42381     31
1    109  14311
---- Validation: 
scalar performance:
{'acc': 0.97454643, 'precision': 0.8326724, 'recall': 0.76792735, 'specificity': 0.76792735, 'f1': 0.79647946, 'auroc': 0.9615096, 'binary_precision': 0.68215615, 'binary_recall': 0.54531944, 'binary_specificity': 0.99053526, 'binary_f1_score': 0.60611063}
confusion matrix:
       0    1
0  17896  171
1    306  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9660006, 'precision': 0.9062353, 'recall': 0.61445963, 'specificity': 0.61445963, 'f1': 0.67253613, 'auroc': 0.94358313, 'binary_precision': 0.8450704, 'binary_recall': 0.23076923, 'binary_specificity': 0.99815, 'binary_f1_score': 0.36253777}
confusion matrix:
      0   1
0  5935  11
1   200  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-27 13:34:43.826590,epoch time: 0:24:50.923837,used: 2:02:28.601823,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99412304, 'precision': 0.99015915, 'recall': 0.9944375, 'specificity': 0.9944375, 'f1': 0.99227417, 'auroc': 0.99972373, 'binary_precision': 0.9819999, 'binary_recall': 0.99507594, 'binary_specificity': 0.9937991, 'binary_f1_score': 0.9884947}
confusion matrix:
       0      1
0  42150    263
1     71  14348
---- Validation: 
scalar performance:
{'acc': 0.9645678, 'precision': 0.7482177, 'recall': 0.88291705, 'specificity': 0.88291705, 'f1': 0.7992474, 'auroc': 0.97068375, 'binary_precision': 0.5042413, 'binary_recall': 0.794948, 'binary_specificity': 0.9708862, 'binary_f1_score': 0.6170703}
confusion matrix:
       0    1
0  17541  526
1    138  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.965195, 'precision': 0.85386354, 'recall': 0.6287511, 'specificity': 0.6287511, 'f1': 0.68422663, 'auroc': 0.9606643, 'binary_precision': 0.73913044, 'binary_recall': 0.26153848, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.38636366}
confusion matrix:
      0   1
0  5922  24
1   192  68
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_6.png
early stop counter: 1
val acc:0.9645677804946899, best validation acc: 0.9745464324951172, corresponding to test acc:                         0.9660006165504456 / 0.9660006165504456
after epoch: 6,now: 2024-06-27 13:59:16.920670,epoch time: 0:24:33.094080,used: 2:27:01.695903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9927506, 'precision': 0.9897942, 'recall': 0.9910919, 'specificity': 0.9910919, 'f1': 0.99044085, 'auroc': 0.999403, 'binary_precision': 0.98376733, 'binary_recall': 0.98772454, 'binary_specificity': 0.9944593, 'binary_f1_score': 0.985742}
confusion matrix:
       0      1
0  42178    235
1    177  14242
---- Validation: 
scalar performance:
{'acc': 0.95912486, 'precision': 0.7240923, 'recall': 0.85792094, 'specificity': 0.85792094, 'f1': 0.7733773, 'auroc': 0.95408577, 'binary_precision': 0.45776567, 'binary_recall': 0.7488856, 'binary_specificity': 0.9669563, 'binary_f1_score': 0.5682075}
confusion matrix:
       0    1
0  17470  597
1    169  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96648407, 'precision': 0.85561144, 'recall': 0.65149164, 'specificity': 0.65149164, 'f1': 0.70875627, 'auroc': 0.93152523, 'binary_precision': 0.7407407, 'binary_recall': 0.30769232, 'binary_specificity': 0.99529094, 'binary_f1_score': 0.43478262}
confusion matrix:
      0   1
0  5918  28
1   180  80
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_7.png
new oracle model saved
early stop counter: 2
val acc:0.9591248631477356, best validation acc: 0.9745464324951172, corresponding to test acc:                         0.9660006165504456 / 0.9664840698242188
after epoch: 7,now: 2024-06-27 14:23:30.049065,epoch time: 0:24:13.128395,used: 2:51:14.824298,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99681515, 'precision': 0.9959412, 'recall': 0.9956459, 'specificity': 0.9956459, 'f1': 0.99579346, 'auroc': 0.9997629, 'binary_precision': 0.9941687, 'binary_recall': 0.9932723, 'binary_specificity': 0.9980195, 'binary_f1_score': 0.99372023}
confusion matrix:
       0      1
0  42330     84
1     97  14321
---- Validation: 
scalar performance:
{'acc': 0.96824974, 'precision': 0.76943254, 'recall': 0.7882655, 'specificity': 0.7882655, 'f1': 0.7784939, 'auroc': 0.95854473, 'binary_precision': 0.55401665, 'binary_recall': 0.5943536, 'binary_specificity': 0.98217744, 'binary_f1_score': 0.57347673}
confusion matrix:
       0    1
0  17745  322
1    273  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.744428, 'recall': 0.51663494, 'specificity': 0.51663494, 'f1': 0.52181935, 'auroc': 0.9359062, 'binary_precision': 0.5294118, 'binary_recall': 0.034615386, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.06498195}
confusion matrix:
      0  1
0  5938  8
1   251  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_8.png
early stop counter: 3
val acc:0.9682497382164001, best validation acc: 0.9745464324951172, corresponding to test acc:                         0.9660006165504456 / 0.9664840698242188
after epoch: 8,now: 2024-06-27 15:03:14.781849,epoch time: 0:39:44.732784,used: 3:30:59.557082,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9953371, 'precision': 0.99210113, 'recall': 0.99566287, 'specificity': 0.99566287, 'f1': 0.9938654, 'auroc': 0.99983466, 'binary_precision': 0.9854565, 'binary_recall': 0.99632406, 'binary_specificity': 0.9950017, 'binary_f1_score': 0.9908605}
confusion matrix:
       0      1
0  42202    212
1     53  14365
---- Validation: 
scalar performance:
{'acc': 0.9677695, 'precision': 0.76435804, 'recall': 0.829502, 'specificity': 0.829502, 'f1': 0.79291755, 'auroc': 0.95204663, 'binary_precision': 0.54073197, 'binary_recall': 0.6805349, 'binary_specificity': 0.978469, 'binary_f1_score': 0.60263157}
confusion matrix:
       0    1
0  17678  389
1    215  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7452984, 'recall': 0.5517439, 'specificity': 0.5517439, 'f1': 0.57883614, 'auroc': 0.9296639, 'binary_precision': 0.5283019, 'binary_recall': 0.10769231, 'binary_specificity': 0.9957955, 'binary_f1_score': 0.17891374}
confusion matrix:
      0   1
0  5921  25
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_9.png
early stop counter: 4
val acc:0.9677695035934448, best validation acc: 0.9745464324951172, corresponding to test acc:                         0.9660006165504456 / 0.9664840698242188
after epoch: 9,now: 2024-06-27 16:05:41.336166,epoch time: 1:02:26.554317,used: 4:33:26.111399,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99567145, 'precision': 0.9967625, 'recall': 0.9918134, 'specificity': 0.9918134, 'f1': 0.9942565, 'auroc': 0.9997238, 'binary_precision': 0.998944, 'binary_recall': 0.9839806, 'binary_specificity': 0.9996463, 'binary_f1_score': 0.99140584}
confusion matrix:
       0      1
0  42397     15
1    231  14189
---- Validation: 
scalar performance:
{'acc': 0.9688367, 'precision': 0.8193414, 'recall': 0.6304959, 'specificity': 0.6304959, 'f1': 0.68202955, 'auroc': 0.9553843, 'binary_precision': 0.6654275, 'binary_recall': 0.26597324, 'binary_specificity': 0.99501854, 'binary_f1_score': 0.38004243}
confusion matrix:
       0    1
0  17977   90
1    494  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.7457782, 'recall': 0.54990494, 'specificity': 0.54990494, 'f1': 0.57619774, 'auroc': 0.9371174, 'binary_precision': 0.5294118, 'binary_recall': 0.103846155, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.17363346}
confusion matrix:
      0   1
0  5922  24
1   233  27
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_10.png
early stop counter: 5
val acc:0.9688367247581482, best validation acc: 0.9745464324951172, corresponding to test acc:                         0.9660006165504456 / 0.9664840698242188
after epoch: 10,now: 2024-06-27 17:21:42.575105,epoch time: 1:16:01.238939,used: 5:49:27.350338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9975366, 'precision': 0.99736124, 'recall': 0.9961295, 'specificity': 0.9961295, 'f1': 0.9967434, 'auroc': 0.9998467, 'binary_precision': 0.9970066, 'binary_recall': 0.9932728, 'binary_specificity': 0.9989862, 'binary_f1_score': 0.99513614}
confusion matrix:
       0      1
0  42370     43
1     97  14322
---- Validation: 
scalar performance:
{'acc': 0.9705976, 'precision': 0.80359507, 'recall': 0.7179565, 'specificity': 0.7179565, 'f1': 0.75305945, 'auroc': 0.95972234, 'binary_precision': 0.62761503, 'binary_recall': 0.44576523, 'binary_specificity': 0.99014777, 'binary_f1_score': 0.52128583}
confusion matrix:
       0    1
0  17889  178
1    373  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.7522269, 'recall': 0.511118, 'specificity': 0.511118, 'f1': 0.5114739, 'auroc': 0.93327415, 'binary_precision': 0.54545456, 'binary_recall': 0.023076924, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.04428044}
confusion matrix:
      0  1
0  5941  5
1   254  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_11.png
early stop counter: 6
val acc:0.9705976247787476, best validation acc: 0.9745464324951172, corresponding to test acc:                         0.9660006165504456 / 0.9664840698242188
after epoch: 11,now: 2024-06-27 17:52:16.468859,epoch time: 0:30:33.893754,used: 6:20:01.244092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9973255, 'precision': 0.9971275, 'recall': 0.9958049, 'specificity': 0.9958049, 'f1': 0.9964639, 'auroc': 0.9998038, 'binary_precision': 0.9967272, 'binary_recall': 0.9927179, 'binary_specificity': 0.99889183, 'binary_f1_score': 0.9947185}
confusion matrix:
       0      1
0  42366     47
1    105  14314
---- Validation: 
scalar performance:
{'acc': 0.97577375, 'precision': 0.87796, 'recall': 0.7263631, 'specificity': 0.7263631, 'f1': 0.7816159, 'auroc': 0.968904, 'binary_precision': 0.77581865, 'binary_recall': 0.4576523, 'binary_specificity': 0.9950739, 'binary_f1_score': 0.57570094}
confusion matrix:
       0    1
0  17978   89
1    365  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.47901532, 'recall': 0.499075, 'specificity': 0.499075, 'f1': 0.48883948, 'auroc': 0.95722413, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99815, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5935  11
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_12.png
better model found
persisted
after epoch: 12,now: 2024-06-27 18:17:27.430671,epoch time: 0:25:10.961812,used: 6:45:12.205904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99729025, 'precision': 0.9980277, 'recall': 0.99481964, 'specificity': 0.99481964, 'f1': 0.9964105, 'auroc': 0.99964285, 'binary_precision': 0.99950975, 'binary_recall': 0.9898044, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.99463344}
confusion matrix:
       0      1
0  42407      7
1    147  14271
---- Validation: 
scalar performance:
{'acc': 0.97203845, 'precision': 0.82828593, 'recall': 0.7072595, 'specificity': 0.7072595, 'f1': 0.7528731, 'auroc': 0.94090855, 'binary_precision': 0.6778043, 'binary_recall': 0.42199108, 'binary_specificity': 0.99252784, 'binary_f1_score': 0.52014655}
confusion matrix:
       0    1
0  17932  135
1    389  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94118595, 'precision': 0.5795356, 'recall': 0.5536961, 'specificity': 0.5536961, 'f1': 0.56328696, 'auroc': 0.8679628, 'binary_precision': 0.19653179, 'binary_recall': 0.13076924, 'binary_specificity': 0.97662294, 'binary_f1_score': 0.15704389}
confusion matrix:
      0    1
0  5807  139
1   226   34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_13.png
early stop counter: 1
val acc:0.9720384478569031, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9664840698242188
after epoch: 13,now: 2024-06-27 18:43:07.296294,epoch time: 0:25:39.865623,used: 7:10:52.071527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99651605, 'precision': 0.9960332, 'recall': 0.9947591, 'specificity': 0.9947591, 'f1': 0.995394, 'auroc': 0.9995562, 'binary_precision': 0.99505675, 'binary_recall': 0.99119216, 'binary_specificity': 0.998326, 'binary_f1_score': 0.9931206}
confusion matrix:
       0      1
0  42342     71
1    127  14292
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.7492411, 'recall': 0.79384077, 'specificity': 0.79384077, 'f1': 0.76947904, 'auroc': 0.9386706, 'binary_precision': 0.51314145, 'binary_recall': 0.60921246, 'binary_specificity': 0.978469, 'binary_f1_score': 0.55706525}
confusion matrix:
       0    1
0  17678  389
1    263  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96890104, 'precision': 0.8078064, 'recall': 0.7998719, 'specificity': 0.7998719, 'f1': 0.8037809, 'auroc': 0.93341696, 'binary_precision': 0.63241106, 'binary_recall': 0.61538464, 'binary_specificity': 0.9843592, 'binary_f1_score': 0.6237817}
confusion matrix:
      0    1
0  5853   93
1   100  160
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_14.png
new oracle model saved
early stop counter: 2
val acc:0.965208113193512, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 14,now: 2024-06-27 19:11:33.232859,epoch time: 0:28:25.936565,used: 7:39:18.008092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99771255, 'precision': 0.99803114, 'recall': 0.9959266, 'specificity': 0.9959266, 'f1': 0.9969733, 'auroc': 0.99986637, 'binary_precision': 0.99867374, 'binary_recall': 0.9923013, 'binary_specificity': 0.999552, 'binary_f1_score': 0.9954773}
confusion matrix:
       0      1
0  42395     19
1    111  14307
---- Validation: 
scalar performance:
{'acc': 0.9713447, 'precision': 0.79074013, 'recall': 0.8077524, 'specificity': 0.8077524, 'f1': 0.7989776, 'auroc': 0.95422816, 'binary_precision': 0.5952381, 'binary_recall': 0.6315007, 'binary_specificity': 0.98400396, 'binary_f1_score': 0.61283344}
confusion matrix:
       0    1
0  17778  289
1    248  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9668063, 'precision': 0.83299303, 'recall': 0.6829226, 'specificity': 0.6829226, 'f1': 0.7339252, 'auroc': 0.9491817, 'binary_precision': 0.69285715, 'binary_recall': 0.37307692, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.485}
confusion matrix:
      0   1
0  5903  43
1   163  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_15.png
early stop counter: 3
val acc:0.9713447093963623, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 15,now: 2024-06-27 19:38:01.461662,epoch time: 0:26:28.228803,used: 8:05:46.236895,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.998522, 'precision': 0.9984132, 'recall': 0.9976824, 'specificity': 0.9976824, 'f1': 0.9980471, 'auroc': 0.9999174, 'binary_precision': 0.99819297, 'binary_recall': 0.9959778, 'binary_specificity': 0.99938697, 'binary_f1_score': 0.99708414}
confusion matrix:
       0      1
0  42386     26
1     58  14362
---- Validation: 
scalar performance:
{'acc': 0.9745998, 'precision': 0.85152745, 'recall': 0.73433745, 'specificity': 0.73433745, 'f1': 0.78019345, 'auroc': 0.9681163, 'binary_precision': 0.7223476, 'binary_recall': 0.4754829, 'binary_specificity': 0.993192, 'binary_f1_score': 0.5734767}
confusion matrix:
       0    1
0  17944  123
1    353  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.5700859, 'recall': 0.50308937, 'specificity': 0.50308937, 'f1': 0.4963843, 'auroc': 0.95140946, 'binary_precision': 0.18181819, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.014760148}
confusion matrix:
      0  1
0  5937  9
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_16.png
early stop counter: 4
val acc:0.9745997786521912, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 16,now: 2024-06-27 20:03:18.340036,epoch time: 0:25:16.878374,used: 8:31:03.115269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99646324, 'precision': 0.99747705, 'recall': 0.9931907, 'specificity': 0.9931907, 'f1': 0.9953103, 'auroc': 0.9998053, 'binary_precision': 0.9995082, 'binary_recall': 0.98654646, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.992985}
confusion matrix:
       0      1
0  42405      7
1    194  14226
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.78881896, 'recall': 0.57323825, 'specificity': 0.57323825, 'f1': 0.611689, 'auroc': 0.944071, 'binary_precision': 0.6084337, 'binary_recall': 0.15007429, 'binary_specificity': 0.99640226, 'binary_f1_score': 0.24076279}
confusion matrix:
       0    1
0  18002   65
1    572  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542378, 'precision': 0.4789712, 'recall': 0.49798185, 'specificity': 0.49798185, 'f1': 0.4882916, 'auroc': 0.8792108, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5922  24
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_17.png
early stop counter: 5
val acc:0.9660085439682007, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 17,now: 2024-06-27 20:27:31.511484,epoch time: 0:24:13.171448,used: 8:55:16.286717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99231064, 'precision': 0.99473083, 'recall': 0.9850066, 'specificity': 0.9850066, 'f1': 0.9897473, 'auroc': 0.9996102, 'binary_precision': 0.99949986, 'binary_recall': 0.97017825, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.98462075}
confusion matrix:
       0      1
0  42406      7
1    430  13989
---- Validation: 
scalar performance:
{'acc': 0.9667556, 'precision': 0.7650362, 'recall': 0.689499, 'specificity': 0.689499, 'f1': 0.72032076, 'auroc': 0.9479906, 'binary_precision': 0.552521, 'binary_recall': 0.3907875, 'binary_specificity': 0.98821056, 'binary_f1_score': 0.4577894}
confusion matrix:
       0    1
0  17854  213
1    410  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.4790424, 'recall': 0.49974772, 'specificity': 0.49974772, 'f1': 0.48917606, 'auroc': 0.9263799, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5943  3
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_18.png
early stop counter: 6
val acc:0.9667556285858154, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 18,now: 2024-06-27 20:51:43.116975,epoch time: 0:24:11.605491,used: 9:19:27.892208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99707913, 'precision': 0.9968243, 'recall': 0.995457, 'specificity': 0.995457, 'f1': 0.9961382, 'auroc': 0.9998485, 'binary_precision': 0.9963092, 'binary_recall': 0.99216366, 'binary_specificity': 0.9987503, 'binary_f1_score': 0.99423206}
confusion matrix:
       0      1
0  42359     53
1    113  14307
---- Validation: 
scalar performance:
{'acc': 0.97113127, 'precision': 0.82421404, 'recall': 0.68890727, 'specificity': 0.68890727, 'f1': 0.7371433, 'auroc': 0.96183026, 'binary_precision': 0.67098445, 'binary_recall': 0.38484398, 'binary_specificity': 0.9929706, 'binary_f1_score': 0.48914066}
confusion matrix:
       0    1
0  17940  127
1    414  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621334, 'precision': 0.84184134, 'recall': 0.5775007, 'specificity': 0.5775007, 'f1': 0.6196228, 'auroc': 0.9399929, 'binary_precision': 0.71929824, 'binary_recall': 0.15769231, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.2586751}
confusion matrix:
      0   1
0  5930  16
1   219  41
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_19.png
early stop counter: 7
val acc:0.9711312651634216, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 19,now: 2024-06-27 21:15:51.547463,epoch time: 0:24:08.430488,used: 9:43:36.322696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99769497, 'precision': 0.99820465, 'recall': 0.9957086, 'specificity': 0.9957086, 'f1': 0.9969486, 'auroc': 0.99990505, 'binary_precision': 0.9992312, 'binary_recall': 0.9916765, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.9954395}
confusion matrix:
       0      1
0  42404     11
1    120  14297
---- Validation: 
scalar performance:
{'acc': 0.9677161, 'precision': 0.7774906, 'recall': 0.68212926, 'specificity': 0.68212926, 'f1': 0.71891475, 'auroc': 0.9494947, 'binary_precision': 0.57798165, 'binary_recall': 0.3744428, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.45446348}
confusion matrix:
       0    1
0  17883  184
1    421  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96036094, 'precision': 0.7584079, 'recall': 0.6538132, 'specificity': 0.6538132, 'f1': 0.69120634, 'auroc': 0.94442046, 'binary_precision': 0.54605263, 'binary_recall': 0.31923077, 'binary_specificity': 0.9883956, 'binary_f1_score': 0.40291262}
confusion matrix:
      0   1
0  5877  69
1   177  83
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_20.png
early stop counter: 8
val acc:0.9677160978317261, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 20,now: 2024-06-27 21:39:49.567615,epoch time: 0:23:58.020152,used: 10:07:34.342848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9970263, 'precision': 0.99692595, 'recall': 0.9952154, 'specificity': 0.9952154, 'f1': 0.9960669, 'auroc': 0.99981976, 'binary_precision': 0.99672335, 'binary_recall': 0.99153894, 'binary_specificity': 0.99889183, 'binary_f1_score': 0.99412435}
confusion matrix:
       0      1
0  42366     47
1    122  14297
---- Validation: 
scalar performance:
{'acc': 0.9726254, 'precision': 0.83742934, 'recall': 0.7075639, 'specificity': 0.7075639, 'f1': 0.7556728, 'auroc': 0.96906745, 'binary_precision': 0.6960784, 'binary_recall': 0.42199108, 'binary_specificity': 0.99313664, 'binary_f1_score': 0.5254394}
confusion matrix:
       0    1
0  17943  124
1    389  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.91979945, 'recall': 0.5802647, 'specificity': 0.5802647, 'f1': 0.6271105, 'auroc': 0.9592093, 'binary_precision': 0.875, 'binary_recall': 0.16153847, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.27272728}
confusion matrix:
      0   1
0  5940   6
1   218  42
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_21.png
early stop counter: 9
val acc:0.9726253747940063, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 21,now: 2024-06-27 22:03:27.663252,epoch time: 0:23:38.095637,used: 10:31:12.438485,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9983108, 'precision': 0.9987781, 'recall': 0.99676263, 'specificity': 0.99676263, 'f1': 0.9977652, 'auroc': 0.9999388, 'binary_precision': 0.9997209, 'binary_recall': 0.9936195, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9966608}
confusion matrix:
       0      1
0  42409      4
1     92  14327
---- Validation: 
scalar performance:
{'acc': 0.9689968, 'precision': 0.89053345, 'recall': 0.58837813, 'specificity': 0.58837813, 'f1': 0.63823885, 'auroc': 0.963081, 'binary_precision': 0.8108108, 'binary_recall': 0.17830609, 'binary_specificity': 0.9984502, 'binary_f1_score': 0.29232642}
confusion matrix:
       0    1
0  18039   28
1    553  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.95406485, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_22.png
early stop counter: 10
val acc:0.9689968228340149, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 22,now: 2024-06-27 22:27:02.581642,epoch time: 0:23:34.918390,used: 10:54:47.356875,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9984516, 'precision': 0.9983201, 'recall': 0.99758935, 'specificity': 0.99758935, 'f1': 0.997954, 'auroc': 0.9999369, 'binary_precision': 0.9980538, 'binary_recall': 0.9958388, 'binary_specificity': 0.9993398, 'binary_f1_score': 0.996945}
confusion matrix:
       0      1
0  42385     28
1     60  14359
---- Validation: 
scalar performance:
{'acc': 0.97454643, 'precision': 0.876843, 'recall': 0.702838, 'specificity': 0.702838, 'f1': 0.7616786, 'auroc': 0.9508254, 'binary_precision': 0.7752809, 'binary_recall': 0.410104, 'binary_specificity': 0.99557203, 'binary_f1_score': 0.5364432}
confusion matrix:
       0    1
0  17987   80
1    397  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.60452414, 'recall': 0.5116956, 'specificity': 0.5116956, 'f1': 0.5130057, 'auroc': 0.89595866, 'binary_precision': 0.25, 'binary_recall': 0.026923077, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.04861111}
confusion matrix:
      0   1
0  5925  21
1   253   7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_23.png
early stop counter: 11
val acc:0.9745464324951172, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 23,now: 2024-06-27 22:50:41.544200,epoch time: 0:23:38.962558,used: 11:18:26.319433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9985923, 'precision': 0.9988508, 'recall': 0.9974319, 'specificity': 0.9974319, 'f1': 0.9981388, 'auroc': 0.9998456, 'binary_precision': 0.99937314, 'binary_recall': 0.99507594, 'binary_specificity': 0.9997878, 'binary_f1_score': 0.9972199}
confusion matrix:
       0      1
0  42404      9
1     71  14348
---- Validation: 
scalar performance:
{'acc': 0.9688367, 'precision': 0.9216963, 'recall': 0.57685083, 'specificity': 0.57685083, 'f1': 0.62335414, 'auroc': 0.9644324, 'binary_precision': 0.8739496, 'binary_recall': 0.15453194, 'binary_specificity': 0.99916977, 'binary_f1_score': 0.26262626}
confusion matrix:
       0    1
0  18052   15
1    569  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9619723, 'precision': 0.91871154, 'recall': 0.55350983, 'specificity': 0.55350983, 'f1': 0.58615446, 'auroc': 0.94262725, 'binary_precision': 0.875, 'binary_recall': 0.10769231, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.19178082}
confusion matrix:
      0   1
0  5942   4
1   232  28
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_24.png
early stop counter: 12
val acc:0.9688367247581482, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 24,now: 2024-06-27 23:14:30.147567,epoch time: 0:23:48.603367,used: 11:42:14.922800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9967624, 'precision': 0.9955906, 'recall': 0.9958627, 'specificity': 0.9958627, 'f1': 0.9957266, 'auroc': 0.9998435, 'binary_precision': 0.99320954, 'binary_recall': 0.9940361, 'binary_specificity': 0.9976893, 'binary_f1_score': 0.99362266}
confusion matrix:
       0      1
0  42314     98
1     86  14334
---- Validation: 
scalar performance:
{'acc': 0.96627533, 'precision': 0.7560891, 'recall': 0.775082, 'specificity': 0.775082, 'f1': 0.7652049, 'auroc': 0.95568794, 'binary_precision': 0.52827585, 'binary_recall': 0.5690936, 'binary_specificity': 0.98107046, 'binary_f1_score': 0.5479256}
confusion matrix:
       0    1
0  17725  342
1    290  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72927415, 'recall': 0.50551695, 'specificity': 0.50551695, 'f1': 0.50057507, 'auroc': 0.9384737, 'binary_precision': 0.5, 'binary_recall': 0.011538462, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.022556392}
confusion matrix:
      0  1
0  5943  3
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_25.png
early stop counter: 13
val acc:0.9662753343582153, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 25,now: 2024-06-27 23:38:04.025270,epoch time: 0:23:33.877703,used: 12:05:48.800503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9983108, 'precision': 0.99850106, 'recall': 0.9970375, 'specificity': 0.9970375, 'f1': 0.9977666, 'auroc': 0.9999324, 'binary_precision': 0.9988855, 'binary_recall': 0.9944522, 'binary_specificity': 0.99962276, 'binary_f1_score': 0.996664}
confusion matrix:
       0      1
0  42396     16
1     80  14340
---- Validation: 
scalar performance:
{'acc': 0.96766275, 'precision': 0.8643971, 'recall': 0.5719504, 'specificity': 0.5719504, 'f1': 0.61393344, 'auroc': 0.95607936, 'binary_precision': 0.7596899, 'binary_recall': 0.14561664, 'binary_specificity': 0.99828416, 'binary_f1_score': 0.24438903}
confusion matrix:
       0   1
0  18036  31
1    575  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.4790424, 'recall': 0.49974772, 'specificity': 0.49974772, 'f1': 0.48917606, 'auroc': 0.9375044, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5943  3
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_26.png
early stop counter: 14
val acc:0.9676627516746521, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 26,now: 2024-06-28 00:01:48.400423,epoch time: 0:23:44.375153,used: 12:29:33.175656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9980469, 'precision': 0.9986949, 'recall': 0.9961506, 'specificity': 0.9961506, 'f1': 0.99741447, 'auroc': 0.999931, 'binary_precision': 1.0, 'binary_recall': 0.9923013, 'binary_specificity': 1.0, 'binary_f1_score': 0.9961358}
confusion matrix:
       0      1
0  42414      0
1    111  14307
---- Validation: 
scalar performance:
{'acc': 0.97033083, 'precision': 0.926704, 'recall': 0.59979904, 'specificity': 0.59979904, 'f1': 0.65585387, 'auroc': 0.96111417, 'binary_precision': 0.88235295, 'binary_recall': 0.20059435, 'binary_specificity': 0.9990037, 'binary_f1_score': 0.32687655}
confusion matrix:
       0    1
0  18049   18
1    538  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9585885, 'precision': 0.79776216, 'recall': 0.5131252, 'specificity': 0.5131252, 'f1': 0.5152463, 'auroc': 0.9370082, 'binary_precision': 0.6363636, 'binary_recall': 0.026923077, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.05166052}
confusion matrix:
      0  1
0  5942  4
1   253  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_27.png
early stop counter: 15
val acc:0.9703308343887329, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 27,now: 2024-06-28 00:25:25.924149,epoch time: 0:23:37.523726,used: 12:53:10.699382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9987331, 'precision': 0.998922, 'recall': 0.99773216, 'specificity': 0.99773216, 'f1': 0.9983252, 'auroc': 0.9999327, 'binary_precision': 0.99930394, 'binary_recall': 0.9957001, 'binary_specificity': 0.9997642, 'binary_f1_score': 0.99749875}
confusion matrix:
       0      1
0  42403     10
1     62  14357
---- Validation: 
scalar performance:
{'acc': 0.96990395, 'precision': 0.8641166, 'recall': 0.61817455, 'specificity': 0.61817455, 'f1': 0.6740094, 'auroc': 0.95996, 'binary_precision': 0.75586855, 'binary_recall': 0.23922734, 'binary_specificity': 0.9971218, 'binary_f1_score': 0.36343116}
confusion matrix:
       0    1
0  18015   52
1    512  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96132773, 'precision': 0.9231329, 'recall': 0.5439785, 'specificity': 0.5439785, 'f1': 0.5705235, 'auroc': 0.96271896, 'binary_precision': 0.88461536, 'binary_recall': 0.08846154, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.16083917}
confusion matrix:
      0   1
0  5943   3
1   237  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_28.png
early stop counter: 16
val acc:0.9699039459228516, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9689010381698608
after epoch: 28,now: 2024-06-28 00:49:09.543019,epoch time: 0:23:43.618870,used: 13:16:54.318252,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99855715, 'precision': 0.9979588, 'recall': 0.9982322, 'specificity': 0.9982322, 'f1': 0.9980954, 'auroc': 0.9999305, 'binary_precision': 0.9967429, 'binary_recall': 0.9975725, 'binary_specificity': 0.9988919, 'binary_f1_score': 0.9971575}
confusion matrix:
       0      1
0  42367     47
1     35  14383
---- Validation: 
scalar performance:
{'acc': 0.973746, 'precision': 0.8023523, 'recall': 0.8504832, 'specificity': 0.8504832, 'f1': 0.82444656, 'auroc': 0.9629709, 'binary_precision': 0.61528665, 'binary_recall': 0.717682, 'binary_specificity': 0.9832844, 'binary_f1_score': 0.6625514}
confusion matrix:
       0    1
0  17765  302
1    190  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9776023, 'precision': 0.9400916, 'recall': 0.76027715, 'specificity': 0.76027715, 'f1': 0.82510906, 'auroc': 0.9531835, 'binary_precision': 0.90066224, 'binary_recall': 0.52307695, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.6618005}
confusion matrix:
      0    1
0  5931   15
1   124  136
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_29.png
new oracle model saved
early stop counter: 17
val acc:0.9737460017204285, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9776023030281067
after epoch: 29,now: 2024-06-28 01:12:55.440594,epoch time: 0:23:45.897575,used: 13:40:40.215827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9968504, 'precision': 0.9950712, 'recall': 0.996631, 'specificity': 0.996631, 'f1': 0.99584794, 'auroc': 0.9998139, 'binary_precision': 0.9914412, 'binary_recall': 0.9961856, 'binary_specificity': 0.9970764, 'binary_f1_score': 0.99380773}
confusion matrix:
       0      1
0  42289    124
1     55  14364
---- Validation: 
scalar performance:
{'acc': 0.96990395, 'precision': 0.79018044, 'recall': 0.7383395, 'specificity': 0.7383395, 'f1': 0.76145315, 'auroc': 0.9542248, 'binary_precision': 0.5992714, 'binary_recall': 0.48885587, 'binary_specificity': 0.9878231, 'binary_f1_score': 0.5384615}
confusion matrix:
       0    1
0  17847  220
1    344  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.5346584, 'recall': 0.5012503, 'specificity': 0.5012503, 'f1': 0.4927235, 'auroc': 0.9113866, 'binary_precision': 0.11111111, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99865454, 'binary_f1_score': 0.007434944}
confusion matrix:
      0  1
0  5938  8
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_30.png
early stop counter: 18
val acc:0.9699039459228516, best validation acc: 0.9757737517356873, corresponding to test acc:                         0.9563325643539429 / 0.9776023030281067
after epoch: 30,now: 2024-06-28 01:36:23.691249,epoch time: 0:23:28.250655,used: 14:04:08.466482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_11_32_15_seed_1_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 14:04:08.466482 at 2024-06-28 01:36:23.691249
persisted model performance metric: 

scalar performance:
{'acc': 0.95633256, 'precision': 0.47901532, 'recall': 0.499075, 'specificity': 0.499075, 'f1': 0.48883948, 'auroc': 0.95722413, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99815, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5935  11
1   260   0
oracle model performance metric: 

scalar performance:
{'acc': 0.9776023, 'precision': 0.9400916, 'recall': 0.76027715, 'specificity': 0.76027715, 'f1': 0.82510906, 'auroc': 0.9531835, 'binary_precision': 0.90066224, 'binary_recall': 0.52307695, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.6618005}
confusion matrix:
      0    1
0  5931   15
1   124  136
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456207 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |  41675 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456207 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |  41675 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   2905 TiB |   2905 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2872 TiB |   2872 TiB |
|       from small pool |  40676 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14484 MiB |  28078 MiB |  13604 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     70 MiB |     86 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446961 KiB |   1251 MiB |   2054 TiB |   2054 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   2020 TiB |   2020 TiB |
|       from small pool |  11572 KiB |     43 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8135    |  504368 K  |  504364 K  |
|       from large pool |     187    |    1413    |  265198 K  |  265197 K  |
|       from small pool |    3277    |    7946    |  239170 K  |  239166 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8135    |  504368 K  |  504364 K  |
|       from large pool |     187    |    1413    |  265198 K  |  265197 K  |
|       from small pool |    3277    |    7946    |  239170 K  |  239166 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    1208    |     574    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      35    |      43    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      87    |    3628    |  320853 K  |  320853 K  |
|       from large pool |      40    |     604    |  193287 K  |  193287 K  |
|       from small pool |      47    |    3590    |  127566 K  |  127566 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2905 TiB |   2905 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2872 TiB |   2872 TiB |
|       from small pool |      0 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  28078 MiB |  27196 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   2054 TiB |   2054 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   2020 TiB |   2020 TiB |
|       from small pool |      0 KiB |     44 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  504368 K  |  504368 K  |
|       from large pool |       2    |    1413    |  265198 K  |  265198 K  |
|       from small pool |       0    |    7946    |  239170 K  |  239170 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  504368 K  |  504368 K  |
|       from large pool |       2    |    1413    |  265198 K  |  265198 K  |
|       from small pool |       0    |    7946    |  239170 K  |  239170 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1208    |    1145    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3628    |  320855 K  |  320855 K  |
|       from large pool |       4    |     604    |  193287 K  |  193287 K  |
|       from small pool |       0    |    3590    |  127567 K  |  127567 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2915 TiB |   2915 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2882 TiB |   2882 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2905 TiB |   2905 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2872 TiB |   2872 TiB |
|       from small pool |      0 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  28078 MiB |  27196 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   2054 TiB |   2054 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   2020 TiB |   2020 TiB |
|       from small pool |      0 KiB |     44 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  504368 K  |  504368 K  |
|       from large pool |       2    |    1413    |  265198 K  |  265198 K  |
|       from small pool |       0    |    7946    |  239170 K  |  239170 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  504368 K  |  504368 K  |
|       from large pool |       2    |    1413    |  265198 K  |  265198 K  |
|       from small pool |       0    |    7946    |  239170 K  |  239170 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1208    |    1145    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3628    |  320855 K  |  320855 K  |
|       from large pool |       4    |     604    |  193287 K  |  193287 K  |
|       from small pool |       0    |    3590    |  127567 K  |  127567 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846

 Experiment start at: 2024-06-28 01:43:52.660345
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98934543, 'precision': 0.98357284, 'recall': 0.9892224, 'specificity': 0.9892224, 'f1': 0.9863516, 'auroc': 0.99901146, 'binary_precision': 0.9711189, 'binary_recall': 0.98896235, 'binary_specificity': 0.9894824, 'binary_f1_score': 0.97995937}
confusion matrix:
       0      1
0  41865    445
1    167  14963
---- Validation: 
scalar performance:
{'acc': 0.8553774, 'precision': 0.5762061, 'recall': 0.8385638, 'specificity': 0.8385638, 'f1': 0.59329367, 'auroc': 0.9064799, 'binary_precision': 0.15930346, 'binary_recall': 0.820598, 'binary_specificity': 0.85652965, 'binary_f1_score': 0.26681072}
confusion matrix:
       0     1
0  15564  2607
1    108   494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8371534, 'precision': 0.56432015, 'recall': 0.7487408, 'specificity': 0.7487408, 'f1': 0.57304174, 'auroc': 0.83917785, 'binary_precision': 0.14495413, 'binary_recall': 0.6528926, 'binary_specificity': 0.84458894, 'binary_f1_score': 0.23723724}
confusion matrix:
      0    1
0  5065  932
1    84  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-28 02:08:26.835112,epoch time: 0:24:34.174767,used: 0:24:34.174767,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9927403, 'precision': 0.99177384, 'recall': 0.9894887, 'specificity': 0.9894887, 'f1': 0.99062407, 'auroc': 0.9989833, 'binary_precision': 0.9897477, 'binary_recall': 0.9826173, 'binary_specificity': 0.9963602, 'binary_f1_score': 0.98616964}
confusion matrix:
       0      1
0  42156    154
1    263  14867
---- Validation: 
scalar performance:
{'acc': 0.9529111, 'precision': 0.6777832, 'recall': 0.80623233, 'specificity': 0.80623233, 'f1': 0.72237504, 'auroc': 0.9326627, 'binary_precision': 0.3674812, 'binary_recall': 0.6495017, 'binary_specificity': 0.962963, 'binary_f1_score': 0.46938774}
confusion matrix:
       0    1
0  17498  673
1    211  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95095366, 'precision': 0.653805, 'recall': 0.6255249, 'specificity': 0.6255249, 'f1': 0.6379773, 'auroc': 0.9035162, 'binary_precision': 0.33673468, 'binary_recall': 0.27272728, 'binary_specificity': 0.9783225, 'binary_f1_score': 0.30136988}
confusion matrix:
      0    1
0  5867  130
1   176   66
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_2.png
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-06-28 02:32:21.945658,epoch time: 0:23:55.110546,used: 0:48:29.285313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99371517, 'precision': 0.9942963, 'recall': 0.9894924, 'specificity': 0.9894924, 'f1': 0.9918626, 'auroc': 0.999019, 'binary_precision': 0.99550426, 'binary_recall': 0.9805684, 'binary_specificity': 0.9984164, 'binary_f1_score': 0.9879799}
confusion matrix:
       0      1
0  42243     67
1    294  14836
---- Validation: 
scalar performance:
{'acc': 0.96132743, 'precision': 0.6845461, 'recall': 0.6732586, 'specificity': 0.6732586, 'f1': 0.6787012, 'auroc': 0.8970505, 'binary_precision': 0.39007092, 'binary_recall': 0.3654485, 'binary_specificity': 0.98106873, 'binary_f1_score': 0.3773585}
confusion matrix:
       0    1
0  17827  344
1    382  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9067158, 'precision': 0.5890666, 'recall': 0.69768494, 'specificity': 0.69768494, 'f1': 0.61580074, 'auroc': 0.8443557, 'binary_precision': 0.20070423, 'binary_recall': 0.47107437, 'binary_specificity': 0.9242955, 'binary_f1_score': 0.2814815}
confusion matrix:
      0    1
0  5543  454
1   128  114
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_3.png
better model found
persisted
after epoch: 3,now: 2024-06-28 02:56:20.644584,epoch time: 0:23:58.698926,used: 1:12:27.984239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9953517, 'precision': 0.9937726, 'recall': 0.99425447, 'specificity': 0.99425447, 'f1': 0.9940133, 'auroc': 0.999629, 'binary_precision': 0.9904303, 'binary_recall': 0.991936, 'binary_specificity': 0.996573, 'binary_f1_score': 0.9911826}
confusion matrix:
       0      1
0  42166    145
1    122  15007
---- Validation: 
scalar performance:
{'acc': 0.9634582, 'precision': 0.719859, 'recall': 0.81168056, 'specificity': 0.81168056, 'f1': 0.7568416, 'auroc': 0.9445145, 'binary_precision': 0.45150116, 'binary_recall': 0.6495017, 'binary_specificity': 0.9738594, 'binary_f1_score': 0.53269756}
confusion matrix:
       0    1
0  17696  475
1    211  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.7166761, 'recall': 0.6319265, 'specificity': 0.6319265, 'f1': 0.6626643, 'auroc': 0.9129518, 'binary_precision': 0.46206897, 'binary_recall': 0.2768595, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.34625325}
confusion matrix:
      0   1
0  5919  78
1   175  67
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_4.png
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-06-28 03:20:19.160893,epoch time: 0:23:58.516309,used: 1:36:26.500548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.997023, 'precision': 0.9976406, 'recall': 0.99468863, 'specificity': 0.99468863, 'f1': 0.99615264, 'auroc': 0.9997386, 'binary_precision': 0.9989327, 'binary_recall': 0.98975545, 'binary_specificity': 0.99962187, 'binary_f1_score': 0.99432284}
confusion matrix:
       0      1
0  42294     16
1    155  14975
---- Validation: 
scalar performance:
{'acc': 0.96713364, 'precision': 0.73718774, 'recall': 0.76941156, 'specificity': 0.76941156, 'f1': 0.7521585, 'auroc': 0.94562244, 'binary_precision': 0.48908296, 'binary_recall': 0.55813956, 'binary_specificity': 0.9806835, 'binary_f1_score': 0.5213344}
confusion matrix:
       0    1
0  17820  351
1    266  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96377623, 'precision': 0.8656976, 'recall': 0.54693705, 'specificity': 0.54693705, 'f1': 0.5753011, 'auroc': 0.9239968, 'binary_precision': 0.76666665, 'binary_recall': 0.09504132, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.16911764}
confusion matrix:
      0   1
0  5990   7
1   219  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-28 03:44:17.722915,epoch time: 0:23:58.562022,used: 2:00:25.062570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9922876, 'precision': 0.99392366, 'recall': 0.9862094, 'specificity': 0.9862094, 'f1': 0.98998487, 'auroc': 0.9991076, 'binary_precision': 0.99729127, 'binary_recall': 0.9733642, 'binary_specificity': 0.9990546, 'binary_f1_score': 0.98518246}
confusion matrix:
       0      1
0  42270     40
1    403  14727
---- Validation: 
scalar performance:
{'acc': 0.97267354, 'precision': 0.78694165, 'recall': 0.73453, 'specificity': 0.73453, 'f1': 0.7578585, 'auroc': 0.9492781, 'binary_precision': 0.59100205, 'binary_recall': 0.48006645, 'binary_specificity': 0.98899347, 'binary_f1_score': 0.52978915}
confusion matrix:
       0    1
0  17971  200
1    313  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9711492, 'precision': 0.8555526, 'recall': 0.6974951, 'specificity': 0.6974951, 'f1': 0.7519227, 'auroc': 0.91128385, 'binary_precision': 0.7348485, 'binary_recall': 0.40082645, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.5187166}
confusion matrix:
      0   1
0  5962  35
1   145  97
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_6.png
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-06-28 04:08:16.198084,epoch time: 0:23:58.475169,used: 2:24:23.537739,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99514276, 'precision': 0.9948838, 'recall': 0.992584, 'specificity': 0.992584, 'f1': 0.9937266, 'auroc': 0.9994664, 'binary_precision': 0.9943409, 'binary_recall': 0.98717695, 'binary_specificity': 0.9979911, 'binary_f1_score': 0.99074596}
confusion matrix:
       0      1
0  42226     85
1    194  14935
---- Validation: 
scalar performance:
{'acc': 0.974751, 'precision': 0.8264568, 'recall': 0.7042842, 'specificity': 0.7042842, 'f1': 0.7501931, 'auroc': 0.94980574, 'binary_precision': 0.672043, 'binary_recall': 0.4152824, 'binary_specificity': 0.993286, 'binary_f1_score': 0.513347}
confusion matrix:
       0    1
0  18049  122
1    352  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7309761, 'recall': 0.5099137, 'specificity': 0.5099137, 'f1': 0.5099443, 'auroc': 0.92814916, 'binary_precision': 0.5, 'binary_recall': 0.020661157, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.039682537}
confusion matrix:
      0  1
0  5992  5
1   237  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_7.png
better model found
persisted
after epoch: 7,now: 2024-06-28 04:32:16.539884,epoch time: 0:24:00.341800,used: 2:48:23.879539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99505574, 'precision': 0.9934434, 'recall': 0.9938203, 'specificity': 0.9938203, 'f1': 0.9936316, 'auroc': 0.9996619, 'binary_precision': 0.99003166, 'binary_recall': 0.9912095, 'binary_specificity': 0.9964311, 'binary_f1_score': 0.9906202}
confusion matrix:
       0      1
0  42159    151
1    133  14997
---- Validation: 
scalar performance:
{'acc': 0.9704363, 'precision': 0.7672671, 'recall': 0.6940249, 'specificity': 0.6940249, 'f1': 0.7242836, 'auroc': 0.94102365, 'binary_precision': 0.55427253, 'binary_recall': 0.3986711, 'binary_specificity': 0.9893787, 'binary_f1_score': 0.46376812}
confusion matrix:
       0    1
0  17978  193
1    362  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.7031211, 'recall': 0.5078476, 'specificity': 0.5078476, 'f1': 0.5059992, 'auroc': 0.95696795, 'binary_precision': 0.44444445, 'binary_recall': 0.016528925, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.031872507}
confusion matrix:
      0  1
0  5992  5
1   238  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_8.png
early stop counter: 1
val acc:0.9704362750053406, best validation acc: 0.9747509956359863, corresponding to test acc:                         0.9612117409706116 / 0.971149206161499
after epoch: 8,now: 2024-06-28 04:56:09.265279,epoch time: 0:23:52.725395,used: 3:12:16.604934,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99087745, 'precision': 0.98533523, 'recall': 0.9914087, 'specificity': 0.9914087, 'f1': 0.988319, 'auroc': 0.99959147, 'binary_precision': 0.9733601, 'binary_recall': 0.9925314, 'binary_specificity': 0.990286, 'binary_f1_score': 0.9828523}
confusion matrix:
       0      1
0  41899    411
1    113  15017
---- Validation: 
scalar performance:
{'acc': 0.95014113, 'precision': 0.6790911, 'recall': 0.8586057, 'specificity': 0.8586057, 'f1': 0.7341888, 'auroc': 0.943226, 'binary_precision': 0.3664, 'binary_recall': 0.7607973, 'binary_specificity': 0.95641404, 'binary_f1_score': 0.49460045}
confusion matrix:
       0    1
0  17379  792
1    144  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480686, 'precision': 0.68099225, 'recall': 0.75290227, 'specificity': 0.75290227, 'f1': 0.70992684, 'auroc': 0.91958654, 'binary_precision': 0.38081396, 'binary_recall': 0.5413223, 'binary_specificity': 0.96448225, 'binary_f1_score': 0.44709897}
confusion matrix:
      0    1
0  5784  213
1   111  131
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_9.png
early stop counter: 2
val acc:0.9501411318778992, best validation acc: 0.9747509956359863, corresponding to test acc:                         0.9612117409706116 / 0.971149206161499
after epoch: 9,now: 2024-06-28 05:20:00.921395,epoch time: 0:23:51.656116,used: 3:36:08.261050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99401116, 'precision': 0.9959231, 'recall': 0.98867357, 'specificity': 0.98867357, 'f1': 0.9922265, 'auroc': 0.9997658, 'binary_precision': 0.99986476, 'binary_recall': 0.9773944, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9885019}
confusion matrix:
       0      1
0  42309      2
1    342  14787
---- Validation: 
scalar performance:
{'acc': 0.9684653, 'precision': 0.8003638, 'recall': 0.51954836, 'specificity': 0.51954836, 'f1': 0.5294796, 'auroc': 0.9404568, 'binary_precision': 0.6315789, 'binary_recall': 0.03986711, 'binary_specificity': 0.99922955, 'binary_f1_score': 0.075}
confusion matrix:
       0   1
0  18157  14
1    578  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9623337, 'precision': 0.98114574, 'recall': 0.5144628, 'specificity': 0.5144628, 'f1': 0.51850414, 'auroc': 0.92556214, 'binary_precision': 1.0, 'binary_recall': 0.02892562, 'binary_specificity': 1.0, 'binary_f1_score': 0.056224898}
confusion matrix:
      0  1
0  5997  0
1   235  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_10.png
early stop counter: 3
val acc:0.9684653282165527, best validation acc: 0.9747509956359863, corresponding to test acc:                         0.9612117409706116 / 0.971149206161499
after epoch: 10,now: 2024-06-28 05:43:51.425651,epoch time: 0:23:50.504256,used: 3:59:58.765306,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99510795, 'precision': 0.99663496, 'recall': 0.9907775, 'specificity': 0.9907775, 'f1': 0.9936594, 'auroc': 0.9997469, 'binary_precision': 0.99979806, 'binary_recall': 0.9816259, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.99062866}
confusion matrix:
       0      1
0  42307      3
1    278  14852
---- Validation: 
scalar performance:
{'acc': 0.969584, 'precision': 0.9239166, 'recall': 0.52976274, 'specificity': 0.52976274, 'f1': 0.54825103, 'auroc': 0.9428525, 'binary_precision': 0.8780488, 'binary_recall': 0.059800666, 'binary_specificity': 0.99972486, 'binary_f1_score': 0.11197511}
confusion matrix:
       0   1
0  18166   5
1    566  36
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.90184283, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_11.png
early stop counter: 4
val acc:0.9695839881896973, best validation acc: 0.9747509956359863, corresponding to test acc:                         0.9612117409706116 / 0.971149206161499
after epoch: 11,now: 2024-06-28 06:07:39.491481,epoch time: 0:23:48.065830,used: 4:23:46.831136,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9959958, 'precision': 0.99727476, 'recall': 0.99242043, 'specificity': 0.99242043, 'f1': 0.99481535, 'auroc': 0.99988234, 'binary_precision': 0.9999329, 'binary_recall': 0.98486453, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.99234146}
confusion matrix:
       0      1
0  42309      1
1    229  14901
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.73755527, 'recall': 0.5498165, 'specificity': 0.5498165, 'f1': 0.57735616, 'auroc': 0.93621373, 'binary_precision': 0.50406504, 'binary_recall': 0.10299003, 'binary_specificity': 0.996643, 'binary_f1_score': 0.17103449}
confusion matrix:
       0   1
0  18110  61
1    540  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.4805903, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.4899027, 'auroc': 0.88392305, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_12.png
early stop counter: 5
val acc:0.9679859280586243, best validation acc: 0.9747509956359863, corresponding to test acc:                         0.9612117409706116 / 0.971149206161499
after epoch: 12,now: 2024-06-28 06:31:25.784657,epoch time: 0:23:46.293176,used: 4:47:33.124312,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9969011, 'precision': 0.9978183, 'recall': 0.99420255, 'specificity': 0.99420255, 'f1': 0.99599254, 'auroc': 0.99987805, 'binary_precision': 0.9997326, 'binary_recall': 0.98849964, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9940844}
confusion matrix:
       0      1
0  42306      4
1    174  14956
---- Validation: 
scalar performance:
{'acc': 0.9748042, 'precision': 0.875906, 'recall': 0.6497044, 'specificity': 0.6497044, 'f1': 0.7110007, 'auroc': 0.9567888, 'binary_precision': 0.77446806, 'binary_recall': 0.30232558, 'binary_specificity': 0.99708325, 'binary_f1_score': 0.43488646}
confusion matrix:
       0    1
0  18118   53
1    420  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.5640007, 'recall': 0.50164926, 'specificity': 0.50164926, 'f1': 0.493975, 'auroc': 0.9204483, 'binary_precision': 0.16666667, 'binary_recall': 0.004132231, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.008064516}
confusion matrix:
      0  1
0  5992  5
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_13.png
better model found
persisted
after epoch: 13,now: 2024-06-28 06:55:13.811409,epoch time: 0:23:48.026752,used: 5:11:21.151064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9952298, 'precision': 0.99678284, 'recall': 0.9909451, 'specificity': 0.9909451, 'f1': 0.99381745, 'auroc': 0.9998394, 'binary_precision': 1.0, 'binary_recall': 0.98189026, 'binary_specificity': 1.0, 'binary_f1_score': 0.9908624}
confusion matrix:
       0      1
0  42310      0
1    274  14856
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.7908479, 'recall': 0.5243941, 'specificity': 0.5243941, 'f1': 0.5380738, 'auroc': 0.9212204, 'binary_precision': 0.6122449, 'binary_recall': 0.049833886, 'binary_specificity': 0.99895436, 'binary_f1_score': 0.092165895}
confusion matrix:
       0   1
0  18152  19
1    572  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.530655, 'recall': 0.5013158, 'specificity': 0.5013158, 'f1': 0.49374413, 'auroc': 0.9213052, 'binary_precision': 0.1, 'binary_recall': 0.004132231, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.007936507}
confusion matrix:
      0  1
0  5988  9
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_14.png
early stop counter: 1
val acc:0.9685186147689819, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 14,now: 2024-06-28 07:18:59.715639,epoch time: 0:23:45.904230,used: 5:35:07.055294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99768454, 'precision': 0.9981313, 'recall': 0.99590194, 'specificity': 0.99590194, 'f1': 0.9970099, 'auroc': 0.99987113, 'binary_precision': 0.9990682, 'binary_recall': 0.9921348, 'binary_specificity': 0.99966913, 'binary_f1_score': 0.99558944}
confusion matrix:
       0      1
0  42296     14
1    119  15011
---- Validation: 
scalar performance:
{'acc': 0.97272676, 'precision': 0.805318, 'recall': 0.6759349, 'specificity': 0.6759349, 'f1': 0.7218194, 'auroc': 0.95658296, 'binary_precision': 0.6315789, 'binary_recall': 0.358804, 'binary_specificity': 0.9930659, 'binary_f1_score': 0.4576271}
confusion matrix:
       0    1
0  18045  126
1    386  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650585, 'precision': 0.8534384, 'recall': 0.5753624, 'specificity': 0.5753624, 'f1': 0.61776763, 'auroc': 0.9374201, 'binary_precision': 0.74, 'binary_recall': 0.15289256, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.25342464}
confusion matrix:
      0   1
0  5984  13
1   205  37
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_15.png
early stop counter: 2
val acc:0.9727267622947693, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 15,now: 2024-06-28 07:42:58.617181,epoch time: 0:23:58.901542,used: 5:59:05.956836,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99711, 'precision': 0.9978291, 'recall': 0.99472654, 'specificity': 0.99472654, 'f1': 0.99626464, 'auroc': 0.99989986, 'binary_precision': 0.9993326, 'binary_recall': 0.98968935, 'binary_specificity': 0.99976367, 'binary_f1_score': 0.9944875}
confusion matrix:
       0      1
0  42300     10
1    156  14974
---- Validation: 
scalar performance:
{'acc': 0.9694242, 'precision': 0.7739438, 'recall': 0.5874997, 'specificity': 0.5874997, 'f1': 0.6289006, 'auroc': 0.95311177, 'binary_precision': 0.5744681, 'binary_recall': 0.179402, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.2734177}
confusion matrix:
       0    1
0  18091   80
1    494  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.530655, 'recall': 0.5013158, 'specificity': 0.5013158, 'f1': 0.49374413, 'auroc': 0.946943, 'binary_precision': 0.1, 'binary_recall': 0.004132231, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.007936507}
confusion matrix:
      0  1
0  5988  9
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_16.png
early stop counter: 3
val acc:0.9694241881370544, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 16,now: 2024-06-28 08:06:59.908002,epoch time: 0:24:01.290821,used: 6:23:07.247657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99766713, 'precision': 0.99842155, 'recall': 0.99557114, 'specificity': 0.99557114, 'f1': 0.9969852, 'auroc': 0.9998744, 'binary_precision': 1.0, 'binary_recall': 0.9911423, 'binary_specificity': 1.0, 'binary_f1_score': 0.9955514}
confusion matrix:
       0      1
0  42312      0
1    134  14994
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.80964315, 'recall': 0.5481228, 'specificity': 0.5481228, 'f1': 0.57733583, 'auroc': 0.9398724, 'binary_precision': 0.64835167, 'binary_recall': 0.09800664, 'binary_specificity': 0.998239, 'binary_f1_score': 0.17027415}
confusion matrix:
       0   1
0  18139  32
1    543  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584869, 'precision': 0.48055288, 'recall': 0.49858263, 'specificity': 0.49858263, 'f1': 0.48940176, 'auroc': 0.9104718, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5980  17
1   242   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_17.png
early stop counter: 4
val acc:0.9693709015846252, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 17,now: 2024-06-28 08:30:56.663721,epoch time: 0:23:56.755719,used: 6:47:04.003376,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99766713, 'precision': 0.9983998, 'recall': 0.99559295, 'specificity': 0.99559295, 'f1': 0.9969856, 'auroc': 0.99993145, 'binary_precision': 0.9999333, 'binary_recall': 0.9912095, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.99555236}
confusion matrix:
       0      1
0  42309      1
1    133  14997
---- Validation: 
scalar performance:
{'acc': 0.97293985, 'precision': 0.8529983, 'recall': 0.6222408, 'specificity': 0.6222408, 'f1': 0.6779501, 'auroc': 0.95373976, 'binary_precision': 0.73039216, 'binary_recall': 0.2475083, 'binary_specificity': 0.9969732, 'binary_f1_score': 0.36972705}
confusion matrix:
       0    1
0  18116   55
1    453  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.8560624, 'recall': 0.51223, 'specificity': 0.51223, 'f1': 0.5142683, 'auroc': 0.9549397, 'binary_precision': 0.75, 'binary_recall': 0.024793388, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.048}
confusion matrix:
      0  1
0  5995  2
1   236  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_18.png
early stop counter: 5
val acc:0.9729398488998413, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 18,now: 2024-06-28 08:55:00.757722,epoch time: 0:24:04.094001,used: 7:11:08.097377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9972667, 'precision': 0.9972912, 'recall': 0.9956608, 'specificity': 0.9956608, 'f1': 0.99647236, 'auroc': 0.9997859, 'binary_precision': 0.9973427, 'binary_recall': 0.992267, 'binary_specificity': 0.9990546, 'binary_f1_score': 0.9947984}
confusion matrix:
       0      1
0  42270     40
1    117  15013
---- Validation: 
scalar performance:
{'acc': 0.9738454, 'precision': 0.8135147, 'recall': 0.69980115, 'specificity': 0.69980115, 'f1': 0.7430311, 'auroc': 0.95444626, 'binary_precision': 0.646438, 'binary_recall': 0.40697673, 'binary_specificity': 0.9926256, 'binary_f1_score': 0.49949032}
confusion matrix:
       0    1
0  18037  134
1    357  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.68837804, 'recall': 0.52337605, 'specificity': 0.52337605, 'f1': 0.5341633, 'auroc': 0.9484149, 'binary_precision': 0.41379312, 'binary_recall': 0.049586777, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.08856089}
confusion matrix:
      0   1
0  5980  17
1   230  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_19.png
early stop counter: 6
val acc:0.9738454222679138, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 19,now: 2024-06-28 09:19:06.517618,epoch time: 0:24:05.759896,used: 7:35:13.857273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9972841, 'precision': 0.9967523, 'recall': 0.9962456, 'specificity': 0.9962456, 'f1': 0.9964986, 'auroc': 0.9998127, 'binary_precision': 0.99563056, 'binary_recall': 0.99405116, 'binary_specificity': 0.99844015, 'binary_f1_score': 0.9948402}
confusion matrix:
       0      1
0  42245     66
1     90  15039
---- Validation: 
scalar performance:
{'acc': 0.9655356, 'precision': 0.71648157, 'recall': 0.67623544, 'specificity': 0.67623544, 'f1': 0.694065, 'auroc': 0.9350822, 'binary_precision': 0.45379877, 'binary_recall': 0.36710963, 'binary_specificity': 0.9853613, 'binary_f1_score': 0.40587693}
confusion matrix:
       0    1
0  17905  266
1    381  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96361595, 'precision': 0.7561071, 'recall': 0.7530587, 'specificity': 0.7530587, 'f1': 0.75457263, 'auroc': 0.9277278, 'binary_precision': 0.5313808, 'binary_recall': 0.5247934, 'binary_specificity': 0.981324, 'binary_f1_score': 0.5280666}
confusion matrix:
      0    1
0  5885  112
1   115  127
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_20.png
early stop counter: 7
val acc:0.965535581111908, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 20,now: 2024-06-28 09:43:13.922659,epoch time: 0:24:07.405041,used: 7:59:21.262314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99735373, 'precision': 0.9981885, 'recall': 0.9949981, 'specificity': 0.9949981, 'f1': 0.9965794, 'auroc': 0.9999102, 'binary_precision': 0.99993324, 'binary_recall': 0.99001986, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9949519}
confusion matrix:
       0      1
0  42309      1
1    151  14979
---- Validation: 
scalar performance:
{'acc': 0.9697438, 'precision': 0.9373257, 'recall': 0.5314514, 'specificity': 0.5314514, 'f1': 0.5513101, 'auroc': 0.95159566, 'binary_precision': 0.9047619, 'binary_recall': 0.06312292, 'binary_specificity': 0.9997799, 'binary_f1_score': 0.11801242}
confusion matrix:
       0   1
0  18167   4
1    564  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.48059964, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.49002782, 'auroc': 0.9240404, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_21.png
early stop counter: 8
val acc:0.9697437882423401, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 21,now: 2024-06-28 10:07:12.021839,epoch time: 0:23:58.099180,used: 8:23:19.361494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99801534, 'precision': 0.9985917, 'recall': 0.9962963, 'specificity': 0.9962963, 'f1': 0.9974368, 'auroc': 0.99991655, 'binary_precision': 0.99980026, 'binary_recall': 0.99266356, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.99621916}
confusion matrix:
       0      1
0  42307      3
1    111  15019
---- Validation: 
scalar performance:
{'acc': 0.97096896, 'precision': 0.89595586, 'recall': 0.560191, 'specificity': 0.560191, 'f1': 0.59825015, 'auroc': 0.94796014, 'binary_precision': 0.8202247, 'binary_recall': 0.12126246, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.21128798}
confusion matrix:
       0   1
0  18155  16
1    529  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.93222296, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_22.png
early stop counter: 9
val acc:0.9709689617156982, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 22,now: 2024-06-28 10:31:20.568398,epoch time: 0:24:08.546559,used: 8:47:27.908053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9911734, 'precision': 0.9940568, 'recall': 0.9832653, 'specificity': 0.9832653, 'f1': 0.9885019, 'auroc': 0.99978065, 'binary_precision': 0.99993163, 'binary_recall': 0.9665543, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9829596}
confusion matrix:
       0      1
0  42310      1
1    506  14623
---- Validation: 
scalar performance:
{'acc': 0.9680392, 'precision': 0.9840179, 'recall': 0.5016611, 'specificity': 0.5016611, 'f1': 0.4951904, 'auroc': 0.95058125, 'binary_precision': 1.0, 'binary_recall': 0.003322259, 'binary_specificity': 1.0, 'binary_f1_score': 0.0066225166}
confusion matrix:
       0  1
0  18171  0
1    600  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.92298985, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_23.png
early stop counter: 10
val acc:0.9680392146110535, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 23,now: 2024-06-28 10:55:22.412155,epoch time: 0:24:01.843757,used: 9:11:29.751810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9981198, 'precision': 0.9987054, 'recall': 0.99645215, 'specificity': 0.99645215, 'f1': 0.9975718, 'auroc': 0.9998565, 'binary_precision': 0.9999334, 'binary_recall': 0.99292797, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9964184}
confusion matrix:
       0      1
0  42309      1
1    107  15023
---- Validation: 
scalar performance:
{'acc': 0.9685186, 'precision': 0.81785846, 'recall': 0.5179697, 'specificity': 0.5179697, 'f1': 0.52663994, 'auroc': 0.92308384, 'binary_precision': 0.6666667, 'binary_recall': 0.036544852, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.06929134}
confusion matrix:
       0   1
0  18160  11
1    580  22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.48060587, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49011117, 'auroc': 0.9500089, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_24.png
early stop counter: 11
val acc:0.9685186147689819, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 24,now: 2024-06-28 11:19:21.524955,epoch time: 0:23:59.112800,used: 9:35:28.864610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99792826, 'precision': 0.997615, 'recall': 0.99704397, 'specificity': 0.99704397, 'f1': 0.99732906, 'auroc': 0.9998423, 'binary_precision': 0.99695426, 'binary_recall': 0.9951751, 'binary_specificity': 0.9989128, 'binary_f1_score': 0.99606395}
confusion matrix:
       0      1
0  42264     46
1     73  15057
---- Validation: 
scalar performance:
{'acc': 0.97267354, 'precision': 0.7902747, 'recall': 0.719272, 'specificity': 0.719272, 'f1': 0.7493815, 'auroc': 0.95865583, 'binary_precision': 0.59866965, 'binary_recall': 0.44850498, 'binary_specificity': 0.99003905, 'binary_f1_score': 0.5128205}
confusion matrix:
       0    1
0  17990  181
1    332  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9556019, 'precision': 0.5660728, 'recall': 0.51492655, 'specificity': 0.51492655, 'f1': 0.5191402, 'auroc': 0.92780685, 'binary_precision': 0.16981132, 'binary_recall': 0.037190083, 'binary_specificity': 0.992663, 'binary_f1_score': 0.061016954}
confusion matrix:
      0   1
0  5953  44
1   233   9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_25.png
early stop counter: 12
val acc:0.9726735353469849, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 25,now: 2024-06-28 11:43:48.774077,epoch time: 0:24:27.249122,used: 9:59:56.113732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9990947, 'precision': 0.99923676, 'recall': 0.99843013, 'specificity': 0.99843013, 'f1': 0.9988326, 'auroc': 0.99994683, 'binary_precision': 0.99953616, 'binary_recall': 0.9970258, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.99827933}
confusion matrix:
       0      1
0  42303      7
1     45  15085
---- Validation: 
scalar performance:
{'acc': 0.97357905, 'precision': 0.8298503, 'recall': 0.66272336, 'specificity': 0.66272336, 'f1': 0.7158288, 'auroc': 0.9526934, 'binary_precision': 0.6815069, 'binary_recall': 0.3305648, 'binary_specificity': 0.9948819, 'binary_f1_score': 0.4451902}
confusion matrix:
       0    1
0  18078   93
1    403  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.8812169, 'recall': 0.5163622, 'specificity': 0.5163622, 'f1': 0.5220945, 'auroc': 0.95182884, 'binary_precision': 0.8, 'binary_recall': 0.03305785, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.06349206}
confusion matrix:
      0  1
0  5995  2
1   234  8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_26.png
early stop counter: 13
val acc:0.9735790491104126, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 26,now: 2024-06-28 12:07:54.475051,epoch time: 0:24:05.700974,used: 10:24:01.814706,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9983809, 'precision': 0.9987531, 'recall': 0.9970752, 'specificity': 0.9970752, 'f1': 0.99791026, 'auroc': 0.9999465, 'binary_precision': 0.9995349, 'binary_recall': 0.9943159, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.99691856}
confusion matrix:
       0      1
0  42303      7
1     86  15044
---- Validation: 
scalar performance:
{'acc': 0.970383, 'precision': 0.8580998, 'recall': 0.55747914, 'specificity': 0.55747914, 'f1': 0.59303063, 'auroc': 0.9567287, 'binary_precision': 0.7446808, 'binary_recall': 0.11627907, 'binary_specificity': 0.9986792, 'binary_f1_score': 0.20114943}
confusion matrix:
       0   1
0  18147  24
1    532  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.63892365, 'recall': 0.51131284, 'specificity': 0.51131284, 'f1': 0.5127978, 'auroc': 0.9365285, 'binary_precision': 0.31578946, 'binary_recall': 0.024793388, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.045977015}
confusion matrix:
      0   1
0  5984  13
1   236   6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_27.png
early stop counter: 14
val acc:0.9703829884529114, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 27,now: 2024-06-28 12:32:06.866855,epoch time: 0:24:12.391804,used: 10:48:14.206510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9982939, 'precision': 0.9988015, 'recall': 0.99680364, 'specificity': 0.99680364, 'f1': 0.99779713, 'auroc': 0.999884, 'binary_precision': 0.99986696, 'binary_recall': 0.99365455, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99675107}
confusion matrix:
       0      1
0  42309      2
1     96  15033
---- Validation: 
scalar performance:
{'acc': 0.9740585, 'precision': 0.888442, 'recall': 0.6260308, 'specificity': 0.6260308, 'f1': 0.6863129, 'auroc': 0.95941126, 'binary_precision': 0.80104715, 'binary_recall': 0.25415283, 'binary_specificity': 0.9979088, 'binary_f1_score': 0.38587642}
confusion matrix:
       0    1
0  18133   38
1    449  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9661805, 'precision': 0.85351974, 'recall': 0.5977562, 'specificity': 0.5977562, 'f1': 0.6476836, 'auroc': 0.94321316, 'binary_precision': 0.73846155, 'binary_recall': 0.1983471, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.31270358}
confusion matrix:
      0   1
0  5980  17
1   194  48
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_28.png
early stop counter: 15
val acc:0.9740585088729858, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 28,now: 2024-06-28 12:56:19.620139,epoch time: 0:24:12.753284,used: 11:12:26.959794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9976149, 'precision': 0.99838626, 'recall': 0.99547255, 'specificity': 0.99547255, 'f1': 0.99691784, 'auroc': 0.9999399, 'binary_precision': 1.0, 'binary_recall': 0.99094516, 'binary_specificity': 1.0, 'binary_f1_score': 0.99545205}
confusion matrix:
       0      1
0  42310      0
1    137  14993
---- Validation: 
scalar performance:
{'acc': 0.9690513, 'precision': 0.88468355, 'recall': 0.5230632, 'specificity': 0.5230632, 'f1': 0.53608537, 'auroc': 0.9589321, 'binary_precision': 0.8, 'binary_recall': 0.046511628, 'binary_specificity': 0.9996148, 'binary_f1_score': 0.08791208}
confusion matrix:
       0   1
0  18164   7
1    574  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.94711405, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_29.png
early stop counter: 16
val acc:0.9690513014793396, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 29,now: 2024-06-28 13:20:23.840055,epoch time: 0:24:04.219916,used: 11:36:31.179710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99810237, 'precision': 0.9986937, 'recall': 0.99641883, 'specificity': 0.99641883, 'f1': 0.9975492, 'auroc': 0.9998869, 'binary_precision': 0.9999334, 'binary_recall': 0.9928614, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.99638486}
confusion matrix:
       0      1
0  42310      1
1    108  15021
---- Validation: 
scalar performance:
{'acc': 0.9688915, 'precision': 0.89527017, 'recall': 0.5189654, 'specificity': 0.5189654, 'f1': 0.5285981, 'auroc': 0.9485178, 'binary_precision': 0.8214286, 'binary_recall': 0.03820598, 'binary_specificity': 0.99972486, 'binary_f1_score': 0.073015876}
confusion matrix:
       0   1
0  18166   5
1    579  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.48060277, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.49006948, 'auroc': 0.9353437, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587846_30.png
early stop counter: 17
val acc:0.9688915014266968, best validation acc: 0.9748042225837708, corresponding to test acc:                         0.9605706334114075 / 0.971149206161499
after epoch: 30,now: 2024-06-28 13:44:35.246787,epoch time: 0:24:11.406732,used: 12:00:42.586442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_01_43_52_seed_2_21587846
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:00:42.586442 at 2024-06-28 13:44:35.246787
persisted model performance metric: 

scalar performance:
{'acc': 0.96057063, 'precision': 0.5640007, 'recall': 0.50164926, 'specificity': 0.50164926, 'f1': 0.493975, 'auroc': 0.9204483, 'binary_precision': 0.16666667, 'binary_recall': 0.004132231, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.008064516}
confusion matrix:
      0  1
0  5992  5
1   241  1
oracle model performance metric: 

scalar performance:
{'acc': 0.9711492, 'precision': 0.8555526, 'recall': 0.6974951, 'specificity': 0.6974951, 'f1': 0.7519227, 'auroc': 0.91128385, 'binary_precision': 0.7348485, 'binary_recall': 0.40082645, 'binary_specificity': 0.99416375, 'binary_f1_score': 0.5187166}
confusion matrix:
      0   1
0  5962  35
1   145  97
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456213 KiB |  13219 MiB |   4373 TiB |   4373 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   4323 TiB |   4323 TiB |
|       from small pool |  41681 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456213 KiB |  13219 MiB |   4373 TiB |   4373 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   4323 TiB |   4323 TiB |
|       from small pool |  41681 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   4363 TiB |   4363 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   4313 TiB |   4313 TiB |
|       from small pool |  40678 KiB |     60 MiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14484 MiB |  41670 MiB |  27196 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     70 MiB |    100 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446955 KiB |   1251 MiB |   3083 TiB |   3083 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   3033 TiB |   3033 TiB |
|       from small pool |  11566 KiB |     44 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8185    |     757 M  |     757 M  |
|       from large pool |     187    |    1413    |     398 M  |     398 M  |
|       from small pool |    3289    |    7996    |     359 M  |     359 M  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8185    |     757 M  |     757 M  |
|       from large pool |     187    |    1413    |     398 M  |     398 M  |
|       from small pool |    3289    |    7996    |     359 M  |     359 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    1779    |    1145    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      35    |      50    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      81    |    3656    |  478407 K  |  478406 K  |
|       from large pool |      40    |     604    |  287366 K  |  287366 K  |
|       from small pool |      41    |    3614    |  191040 K  |  191040 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   4373 TiB |   4373 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   4323 TiB |   4323 TiB |
|       from small pool |      0 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   4373 TiB |   4373 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   4323 TiB |   4323 TiB |
|       from small pool |      0 KiB |     61 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   4363 TiB |   4363 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   4313 TiB |   4313 TiB |
|       from small pool |      0 KiB |     60 MiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  41670 MiB |  40788 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     52 MiB |     70 MiB |    100 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   3083 TiB |   3083 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   3033 TiB |   3033 TiB |
|       from small pool |      0 KiB |     44 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8185    |     757 M  |     757 M  |
|       from large pool |       2    |    1413    |     398 M  |     398 M  |
|       from small pool |       0    |    7996    |     359 M  |     359 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8185    |     757 M  |     757 M  |
|       from large pool |       2    |    1413    |     398 M  |     398 M  |
|       from small pool |       0    |    7996    |     359 M  |     359 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1779    |    1716    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      26    |      35    |      50    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3656    |  478408 K  |  478408 K  |
|       from large pool |       4    |     604    |  287366 K  |  287366 K  |
|       from small pool |       0    |    3614    |  191041 K  |  191041 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jun 28 13:45:54 2024]
Finished job 0.
1 of 1 steps (100%) done
