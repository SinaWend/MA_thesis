Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jun 27 00:43:49 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849

 Experiment start at: 2024-06-27 00:52:27.177664
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9835028, 'precision': 0.987118, 'recall': 0.96982324, 'specificity': 0.96982324, 'f1': 0.9780718, 'auroc': 0.99633276, 'binary_precision': 0.99418813, 'binary_recall': 0.9415602, 'binary_specificity': 0.9980862, 'binary_f1_score': 0.96715873}
confusion matrix:
       0      1
0  42243     81
1    860  13856
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96647507, 'precision': 0.7471663, 'recall': 0.6271175, 'specificity': 0.6271175, 'f1': 0.665984, 'auroc': 0.8932338, 'binary_precision': 0.52, 'binary_recall': 0.2628305, 'binary_specificity': 0.9914045, 'binary_f1_score': 0.34917358}
confusion matrix:
       0    1
0  17993  156
1    474  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.8880793, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-27 01:55:16.893665,epoch time: 1:02:49.716001,used: 1:02:49.716001,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9951438, 'precision': 0.99592626, 'recall': 0.99138796, 'specificity': 0.99138796, 'f1': 0.9936298, 'auroc': 0.9996076, 'binary_precision': 0.9975196, 'binary_recall': 0.9836266, 'binary_specificity': 0.9991494, 'binary_f1_score': 0.99052435}
confusion matrix:
       0      1
0  42285     36
1    241  14478
---- Validation: 
scalar performance:
{'acc': 0.9535441, 'precision': 0.66755295, 'recall': 0.70517915, 'specificity': 0.70517915, 'f1': 0.6841665, 'auroc': 0.9327874, 'binary_precision': 0.35516372, 'binary_recall': 0.43856922, 'binary_specificity': 0.97178906, 'binary_f1_score': 0.39248434}
confusion matrix:
       0    1
0  17637  512
1    361  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9232982, 'precision': 0.63385123, 'recall': 0.75292623, 'specificity': 0.75292623, 'f1': 0.6702787, 'auroc': 0.8795236, 'binary_precision': 0.28737864, 'binary_recall': 0.5670498, 'binary_specificity': 0.9388027, 'binary_f1_score': 0.3814433}
confusion matrix:
      0    1
0  5630  367
1   113  148
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_2.png
early stop counter: 1
val acc:0.9535440802574158, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 2,now: 2024-06-27 02:57:09.384008,epoch time: 1:01:52.490343,used: 2:04:42.206344,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.996406, 'precision': 0.99601865, 'recall': 0.9945862, 'specificity': 0.9945862, 'f1': 0.9952997, 'auroc': 0.9995858, 'binary_precision': 0.99522215, 'binary_recall': 0.9908263, 'binary_specificity': 0.9983461, 'binary_f1_score': 0.99301934}
confusion matrix:
       0      1
0  42254     70
1    135  14581
---- Validation: 
scalar performance:
{'acc': 0.965198, 'precision': 0.7389911, 'recall': 0.7817177, 'specificity': 0.7817177, 'f1': 0.75838673, 'auroc': 0.94652784, 'binary_precision': 0.49279162, 'binary_recall': 0.58475894, 'binary_specificity': 0.9786765, 'binary_f1_score': 0.53485066}
confusion matrix:
       0    1
0  17762  387
1    267  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.7274684, 'recall': 0.556719, 'specificity': 0.556719, 'f1': 0.58493423, 'auroc': 0.9302058, 'binary_precision': 0.4920635, 'binary_recall': 0.118773945, 'binary_specificity': 0.994664, 'binary_f1_score': 0.19135801}
confusion matrix:
      0   1
0  5965  32
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_3.png
early stop counter: 2
val acc:0.9651979804039001, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 3,now: 2024-06-27 03:59:31.475216,epoch time: 1:02:22.091208,used: 3:07:04.297552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9936185, 'precision': 0.99444723, 'recall': 0.98887503, 'specificity': 0.98887503, 'f1': 0.9916199, 'auroc': 0.99949753, 'binary_precision': 0.99612886, 'binary_recall': 0.9790732, 'binary_specificity': 0.99867684, 'binary_f1_score': 0.9875274}
confusion matrix:
       0      1
0  42266     56
1    308  14410
---- Validation: 
scalar performance:
{'acc': 0.94705194, 'precision': 0.55164367, 'recall': 0.5390561, 'specificity': 0.5390561, 'f1': 0.54413235, 'auroc': 0.8956653, 'binary_precision': 0.13485478, 'binary_recall': 0.10108865, 'binary_specificity': 0.97702354, 'binary_f1_score': 0.115555555}
confusion matrix:
       0    1
0  17732  417
1    578   65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9239374, 'precision': 0.5367291, 'recall': 0.5388767, 'specificity': 0.5388767, 'f1': 0.537751, 'auroc': 0.88004524, 'binary_precision': 0.11191336, 'binary_recall': 0.118773945, 'binary_specificity': 0.9589795, 'binary_f1_score': 0.11524163}
confusion matrix:
      0    1
0  5751  246
1   230   31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_4.png
early stop counter: 3
val acc:0.9470519423484802, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9582933783531189 / 0.9582933783531189
after epoch: 4,now: 2024-06-27 05:01:35.010989,epoch time: 1:02:03.535773,used: 4:09:07.833325,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99747545, 'precision': 0.9961163, 'recall': 0.99730146, 'specificity': 0.99730146, 'f1': 0.99670696, 'auroc': 0.99985516, 'binary_precision': 0.9932972, 'binary_recall': 0.9969421, 'binary_specificity': 0.9976609, 'binary_f1_score': 0.9951163}
confusion matrix:
       0      1
0  42225     99
1     45  14671
---- Validation: 
scalar performance:
{'acc': 0.9736058, 'precision': 0.82870495, 'recall': 0.7148153, 'specificity': 0.7148153, 'f1': 0.75880575, 'auroc': 0.9595252, 'binary_precision': 0.6771084, 'binary_recall': 0.43701398, 'binary_specificity': 0.99261665, 'binary_f1_score': 0.5311909}
confusion matrix:
       0    1
0  18015  134
1    362  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7523175, 'recall': 0.5110774, 'specificity': 0.5110774, 'f1': 0.5114414, 'auroc': 0.93375754, 'binary_precision': 0.54545456, 'binary_recall': 0.022988506, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.04411765}
confusion matrix:
      0  1
0  5992  5
1   255  6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-27 06:05:05.102330,epoch time: 1:03:30.091341,used: 5:12:37.924666,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99135697, 'precision': 0.99330175, 'recall': 0.98413813, 'specificity': 0.98413813, 'f1': 0.9886087, 'auroc': 0.9990252, 'binary_precision': 0.99720377, 'binary_recall': 0.96922135, 'binary_specificity': 0.99905485, 'binary_f1_score': 0.98301345}
confusion matrix:
       0      1
0  42282     40
1    453  14265
---- Validation: 
scalar performance:
{'acc': 0.9572691, 'precision': 0.6959882, 'recall': 0.7618617, 'specificity': 0.7618617, 'f1': 0.72350234, 'auroc': 0.9321773, 'binary_precision': 0.40804598, 'binary_recall': 0.5520995, 'binary_specificity': 0.9716238, 'binary_f1_score': 0.46926636}
confusion matrix:
       0    1
0  17634  515
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9362416, 'precision': 0.5779179, 'recall': 0.5672846, 'specificity': 0.5672846, 'f1': 0.57207763, 'auroc': 0.89916384, 'binary_precision': 0.19196428, 'binary_recall': 0.16475096, 'binary_specificity': 0.96981823, 'binary_f1_score': 0.17731957}
confusion matrix:
      0    1
0  5816  181
1   218   43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_6.png
early stop counter: 1
val acc:0.9572690725326538, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 6,now: 2024-06-27 07:07:21.849171,epoch time: 1:02:16.746841,used: 6:14:54.671507,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9970021, 'precision': 0.9979653, 'recall': 0.99421257, 'specificity': 0.99421257, 'f1': 0.9960704, 'auroc': 0.9998436, 'binary_precision': 0.9999313, 'binary_recall': 0.98844874, 'binary_specificity': 0.9999764, 'binary_f1_score': 0.99415684}
confusion matrix:
       0      1
0  42322      1
1    170  14547
---- Validation: 
scalar performance:
{'acc': 0.9701469, 'precision': 0.84316874, 'recall': 0.60501665, 'specificity': 0.60501665, 'f1': 0.656439, 'auroc': 0.94245327, 'binary_precision': 0.7135417, 'binary_recall': 0.21306376, 'binary_specificity': 0.9969695, 'binary_f1_score': 0.3281437}
confusion matrix:
       0    1
0  18094   55
1    506  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95605624, 'precision': 0.5104233, 'recall': 0.50066507, 'specificity': 0.50066507, 'f1': 0.49237555, 'auroc': 0.9176253, 'binary_precision': 0.0625, 'binary_recall': 0.0038314175, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.0072202166}
confusion matrix:
      0   1
0  5982  15
1   260   1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_7.png
early stop counter: 2
val acc:0.970146894454956, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 7,now: 2024-06-27 08:09:28.418487,epoch time: 1:02:06.569316,used: 7:17:01.240823,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9970722, 'precision': 0.99789894, 'recall': 0.9944589, 'specificity': 0.9944589, 'f1': 0.9961633, 'auroc': 0.9998418, 'binary_precision': 0.99958795, 'binary_recall': 0.9890595, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.9942959}
confusion matrix:
       0      1
0  42318      6
1    161  14555
---- Validation: 
scalar performance:
{'acc': 0.971424, 'precision': 0.8081999, 'recall': 0.6866838, 'specificity': 0.6866838, 'f1': 0.7312142, 'auroc': 0.939963, 'binary_precision': 0.6380208, 'binary_recall': 0.38102645, 'binary_specificity': 0.99234116, 'binary_f1_score': 0.4771178}
confusion matrix:
       0    1
0  18010  139
1    398  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9533397, 'precision': 0.57154363, 'recall': 0.51390636, 'specificity': 0.51390636, 'f1': 0.51707095, 'auroc': 0.9037039, 'binary_precision': 0.18367347, 'binary_recall': 0.03448276, 'binary_specificity': 0.99333, 'binary_f1_score': 0.058064517}
confusion matrix:
      0   1
0  5957  40
1   252   9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_8.png
early stop counter: 3
val acc:0.9714239835739136, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 8,now: 2024-06-27 09:12:36.221073,epoch time: 1:03:07.802586,used: 8:20:09.043409,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9959502, 'precision': 0.99717146, 'recall': 0.9922627, 'specificity': 0.9922627, 'f1': 0.9946853, 'auroc': 0.9994729, 'binary_precision': 0.99965507, 'binary_recall': 0.98464364, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99209255}
confusion matrix:
       0      1
0  42318      5
1    226  14491
---- Validation: 
scalar performance:
{'acc': 0.97041297, 'precision': 0.856491, 'recall': 0.6029042, 'specificity': 0.6029042, 'f1': 0.6550588, 'auroc': 0.9325136, 'binary_precision': 0.7403315, 'binary_recall': 0.20839813, 'binary_specificity': 0.9974103, 'binary_f1_score': 0.32524273}
confusion matrix:
       0    1
0  18102   47
1    509  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.47913337, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48918456, 'auroc': 0.9241474, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_9.png
early stop counter: 4
val acc:0.9704129695892334, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 9,now: 2024-06-27 10:14:59.893243,epoch time: 1:02:23.672170,used: 9:22:32.715579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9980891, 'precision': 0.99871564, 'recall': 0.9962965, 'specificity': 0.9962965, 'f1': 0.9974984, 'auroc': 0.99988174, 'binary_precision': 1.0, 'binary_recall': 0.9925931, 'binary_specificity': 1.0, 'binary_f1_score': 0.9962828}
confusion matrix:
       0      1
0  42324      0
1    109  14607
---- Validation: 
scalar performance:
{'acc': 0.97302043, 'precision': 0.8771327, 'recall': 0.6462573, 'specificity': 0.6462573, 'f1': 0.70729727, 'auroc': 0.94430923, 'binary_precision': 0.77868855, 'binary_recall': 0.29548988, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.42841035}
confusion matrix:
       0    1
0  18095   54
1    453  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.4791267, 'recall': 0.49949974, 'specificity': 0.49949974, 'f1': 0.48910117, 'auroc': 0.91676426, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5991  6
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_10.png
early stop counter: 5
val acc:0.9730204343795776, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 10,now: 2024-06-27 11:18:26.810595,epoch time: 1:03:26.917352,used: 10:25:59.632931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99475807, 'precision': 0.9964925, 'recall': 0.989841, 'specificity': 0.989841, 'f1': 0.99310845, 'auroc': 0.9997524, 'binary_precision': 1.0, 'binary_recall': 0.97968197, 'binary_specificity': 1.0, 'binary_f1_score': 0.98973674}
confusion matrix:
       0      1
0  42324      0
1    299  14417
---- Validation: 
scalar performance:
{'acc': 0.967699, 'precision': 0.88926554, 'recall': 0.5362444, 'specificity': 0.5362444, 'f1': 0.55881834, 'auroc': 0.9333908, 'binary_precision': 0.8103448, 'binary_recall': 0.07309487, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.13409415}
confusion matrix:
       0   1
0  18138  11
1    596  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.4791267, 'recall': 0.49949974, 'specificity': 0.49949974, 'f1': 0.48910117, 'auroc': 0.8790895, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5991  6
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_11.png
early stop counter: 6
val acc:0.9676989912986755, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 11,now: 2024-06-27 12:21:49.414251,epoch time: 1:03:22.603656,used: 11:29:22.236587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99558204, 'precision': 0.99694884, 'recall': 0.99152654, 'specificity': 0.99152654, 'f1': 0.9941989, 'auroc': 0.99972403, 'binary_precision': 0.9997236, 'binary_recall': 0.9831476, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99136627}
confusion matrix:
       0      1
0  42320      4
1    248  14468
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.7179648, 'recall': 0.5522284, 'specificity': 0.5522284, 'f1': 0.5793979, 'auroc': 0.924953, 'binary_precision': 0.46666667, 'binary_recall': 0.108864695, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.17654476}
confusion matrix:
       0   1
0  18069  80
1    573  70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.5417, 'recall': 0.5013321, 'specificity': 0.5013321, 'f1': 0.4928169, 'auroc': 0.88675976, 'binary_precision': 0.125, 'binary_recall': 0.0038314175, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.007434944}
confusion matrix:
      0  1
0  5990  7
1   260  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_12.png
early stop counter: 7
val acc:0.9652511477470398, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 12,now: 2024-06-27 13:25:26.942827,epoch time: 1:03:37.528576,used: 12:32:59.765163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9974579, 'precision': 0.99799967, 'recall': 0.99536216, 'specificity': 0.99536216, 'f1': 0.9966717, 'auroc': 0.99980634, 'binary_precision': 0.9991095, 'binary_recall': 0.9910314, 'binary_specificity': 0.99969286, 'binary_f1_score': 0.99505407}
confusion matrix:
       0      1
0  42309     13
1    132  14586
---- Validation: 
scalar performance:
{'acc': 0.97126436, 'precision': 0.80909157, 'recall': 0.67910063, 'specificity': 0.67910063, 'f1': 0.725291, 'auroc': 0.95112646, 'binary_precision': 0.640327, 'binary_recall': 0.36547434, 'binary_specificity': 0.99272686, 'binary_f1_score': 0.46534654}
confusion matrix:
       0    1
0  18017  132
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9541387, 'precision': 0.4790597, 'recall': 0.49783224, 'specificity': 0.49783224, 'f1': 0.48826557, 'auroc': 0.8841286, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5971  26
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_13.png
early stop counter: 8
val acc:0.9712643623352051, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 13,now: 2024-06-27 14:31:10.987540,epoch time: 1:05:44.044713,used: 13:38:43.809876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.996669, 'precision': 0.995411, 'recall': 0.9958937, 'specificity': 0.9958937, 'f1': 0.99565196, 'auroc': 0.9997288, 'binary_precision': 0.9928077, 'binary_recall': 0.9942919, 'binary_specificity': 0.99749553, 'binary_f1_score': 0.9935492}
confusion matrix:
       0      1
0  42218    106
1     84  14632
---- Validation: 
scalar performance:
{'acc': 0.9642933, 'precision': 0.7176161, 'recall': 0.62373775, 'specificity': 0.62373775, 'f1': 0.656332, 'auroc': 0.9254947, 'binary_precision': 0.4611111, 'binary_recall': 0.25816485, 'binary_specificity': 0.9893107, 'binary_f1_score': 0.33100697}
confusion matrix:
       0    1
0  17955  194
1    477  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9149888, 'precision': 0.52583015, 'recall': 0.5323754, 'specificity': 0.5323754, 'f1': 0.5283677, 'auroc': 0.8658929, 'binary_precision': 0.09063444, 'binary_recall': 0.11494253, 'binary_specificity': 0.94980824, 'binary_f1_score': 0.10135135}
confusion matrix:
      0    1
0  5696  301
1   231   30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_14.png
early stop counter: 9
val acc:0.9642933011054993, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 14,now: 2024-06-27 16:36:08.421687,epoch time: 2:04:57.434147,used: 15:43:41.244023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9978787, 'precision': 0.99832726, 'recall': 0.9961326, 'specificity': 0.9961326, 'f1': 0.99722356, 'auroc': 0.99975383, 'binary_precision': 0.99924743, 'binary_recall': 0.99252516, 'binary_specificity': 0.9997401, 'binary_f1_score': 0.9958749}
confusion matrix:
       0      1
0  42313     11
1    110  14606
---- Validation: 
scalar performance:
{'acc': 0.9656237, 'precision': 0.72087324, 'recall': 0.5209189, 'specificity': 0.5209189, 'f1': 0.53112835, 'auroc': 0.92603356, 'binary_precision': 0.47457626, 'binary_recall': 0.04354588, 'binary_specificity': 0.9982919, 'binary_f1_score': 0.079772085}
confusion matrix:
       0   1
0  18118  31
1    615  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.47911665, 'recall': 0.49924964, 'specificity': 0.49924964, 'f1': 0.48897603, 'auroc': 0.9086331, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5988  9
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_15.png
early stop counter: 10
val acc:0.965623676776886, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 15,now: 2024-06-27 18:00:57.410540,epoch time: 1:24:48.988853,used: 17:08:30.232876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9946704, 'precision': 0.9916393, 'recall': 0.99450254, 'specificity': 0.99450254, 'f1': 0.9930598, 'auroc': 0.999652, 'binary_precision': 0.9853169, 'binary_recall': 0.99415565, 'binary_specificity': 0.9948494, 'binary_f1_score': 0.98971653}
confusion matrix:
       0      1
0  42107    218
1     86  14629
---- Validation: 
scalar performance:
{'acc': 0.9568433, 'precision': 0.5710768, 'recall': 0.52912414, 'specificity': 0.52912414, 'f1': 0.53889036, 'auroc': 0.9260112, 'binary_precision': 0.1744186, 'binary_recall': 0.06998445, 'binary_specificity': 0.98826385, 'binary_f1_score': 0.09988902}
confusion matrix:
       0    1
0  17936  213
1    598   45
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9485459, 'precision': 0.4789414, 'recall': 0.4949141, 'specificity': 0.4949141, 'f1': 0.48679677, 'auroc': 0.90731126, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9898282, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5936  61
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_16.png
early stop counter: 11
val acc:0.9568433165550232, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 16,now: 2024-06-27 19:11:01.592570,epoch time: 1:10:04.182030,used: 18:18:34.414906,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9969495, 'precision': 0.9976133, 'recall': 0.9944209, 'specificity': 0.9944209, 'f1': 0.9960036, 'auroc': 0.99956805, 'binary_precision': 0.9989707, 'binary_recall': 0.9891962, 'binary_specificity': 0.9996456, 'binary_f1_score': 0.99405944}
confusion matrix:
       0      1
0  42308     15
1    159  14558
---- Validation: 
scalar performance:
{'acc': 0.969934, 'precision': 0.79720163, 'recall': 0.6551602, 'specificity': 0.6551602, 'f1': 0.7019446, 'auroc': 0.9219619, 'binary_precision': 0.6181818, 'binary_recall': 0.31726283, 'binary_specificity': 0.9930575, 'binary_f1_score': 0.4193217}
confusion matrix:
       0    1
0  18023  126
1    439  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.60434675, 'recall': 0.5049968, 'specificity': 0.5049968, 'f1': 0.5000848, 'auroc': 0.90969974, 'binary_precision': 0.25, 'binary_recall': 0.011494253, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.021978023}
confusion matrix:
      0  1
0  5988  9
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_17.png
early stop counter: 12
val acc:0.9699339866638184, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 17,now: 2024-06-27 20:16:32.341226,epoch time: 1:05:30.748656,used: 19:24:05.163562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9982118, 'precision': 0.99857354, 'recall': 0.9967562, 'specificity': 0.9967562, 'f1': 0.99766064, 'auroc': 0.9999397, 'binary_precision': 0.9993167, 'binary_recall': 0.9937487, 'binary_specificity': 0.9997637, 'binary_f1_score': 0.996525}
confusion matrix:
       0      1
0  42313     10
1     92  14625
---- Validation: 
scalar performance:
{'acc': 0.9683376, 'precision': 0.8133819, 'recall': 0.577078, 'specificity': 0.577078, 'f1': 0.61863816, 'auroc': 0.94531566, 'binary_precision': 0.65584415, 'binary_recall': 0.15707621, 'binary_specificity': 0.99707973, 'binary_f1_score': 0.25345045}
confusion matrix:
       0    1
0  18096   53
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.5626603, 'recall': 0.5044965, 'specificity': 0.5044965, 'f1': 0.49959797, 'auroc': 0.88388455, 'binary_precision': 0.16666667, 'binary_recall': 0.011494253, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.021505376}
confusion matrix:
      0   1
0  5982  15
1   258   3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_18.png
early stop counter: 13
val acc:0.9683375954627991, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 18,now: 2024-06-27 21:20:27.456831,epoch time: 1:03:55.115605,used: 20:28:00.279167,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9977209, 'precision': 0.99840117, 'recall': 0.9956504, 'specificity': 0.9956504, 'f1': 0.99701583, 'auroc': 0.9998694, 'binary_precision': 0.9997944, 'binary_recall': 0.9913717, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.99556524}
confusion matrix:
       0      1
0  42318      3
1    127  14592
---- Validation: 
scalar performance:
{'acc': 0.9660494, 'precision': 0.76129514, 'recall': 0.5188891, 'specificity': 0.5188891, 'f1': 0.52769125, 'auroc': 0.9574003, 'binary_precision': 0.5555556, 'binary_recall': 0.038880248, 'binary_specificity': 0.998898, 'binary_f1_score': 0.072674416}
confusion matrix:
       0   1
0  18129  20
1    618  25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95605624, 'precision': 0.47909993, 'recall': 0.49883276, 'specificity': 0.49883276, 'f1': 0.48876727, 'auroc': 0.92490256, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5983  14
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_19.png
early stop counter: 14
val acc:0.9660493731498718, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 19,now: 2024-06-27 22:23:31.875483,epoch time: 1:03:04.418652,used: 21:31:04.697819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99777347, 'precision': 0.99850416, 'recall': 0.995685, 'specificity': 0.995685, 'f1': 0.9970841, 'auroc': 0.99990463, 'binary_precision': 1.0, 'binary_recall': 0.99136996, 'binary_specificity': 1.0, 'binary_f1_score': 0.99566627}
confusion matrix:
       0      1
0  42324      0
1    127  14589
---- Validation: 
scalar performance:
{'acc': 0.9665815, 'precision': 0.8964203, 'recall': 0.5146643, 'specificity': 0.5146643, 'f1': 0.52002317, 'auroc': 0.9417769, 'binary_precision': 0.82608694, 'binary_recall': 0.02954899, 'binary_specificity': 0.9997796, 'binary_f1_score': 0.057057057}
confusion matrix:
       0   1
0  18145   4
1    624  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.47912, 'recall': 0.499333, 'specificity': 0.499333, 'f1': 0.48901772, 'auroc': 0.9074745, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5989  8
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_20.png
early stop counter: 15
val acc:0.9665815234184265, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 20,now: 2024-06-27 23:26:24.996797,epoch time: 1:02:53.121314,used: 22:33:57.819133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9985975, 'precision': 0.9990567, 'recall': 0.9972815, 'specificity': 0.9972815, 'f1': 0.998165, 'auroc': 0.9999461, 'binary_precision': 1.0, 'binary_recall': 0.994563, 'binary_specificity': 1.0, 'binary_f1_score': 0.9972741}
confusion matrix:
       0      1
0  42326      0
1     80  14634
---- Validation: 
scalar performance:
{'acc': 0.9716369, 'precision': 0.8785522, 'recall': 0.6170389, 'specificity': 0.6170389, 'f1': 0.67434865, 'auroc': 0.9592413, 'binary_precision': 0.78350514, 'binary_recall': 0.23639192, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.3632019}
confusion matrix:
       0    1
0  18107   42
1    491  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.47912, 'recall': 0.499333, 'specificity': 0.499333, 'f1': 0.48901772, 'auroc': 0.9395133, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5989  8
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_21.png
early stop counter: 16
val acc:0.9716368913650513, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 21,now: 2024-06-28 00:29:13.715379,epoch time: 1:02:48.718582,used: 23:36:46.537715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9985975, 'precision': 0.99892235, 'recall': 0.9974153, 'specificity': 0.9974153, 'f1': 0.99816585, 'auroc': 0.99990577, 'binary_precision': 0.99959046, 'binary_recall': 0.99497247, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9972762}
confusion matrix:
       0      1
0  42315      6
1     74  14645
---- Validation: 
scalar performance:
{'acc': 0.9717965, 'precision': 0.8802792, 'recall': 0.6193717, 'specificity': 0.6193717, 'f1': 0.6773118, 'auroc': 0.9358022, 'binary_precision': 0.78680205, 'binary_recall': 0.24105754, 'binary_specificity': 0.99768585, 'binary_f1_score': 0.36904764}
confusion matrix:
       0    1
0  18107   42
1    488  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550975, 'precision': 0.5018806, 'recall': 0.5001648, 'specificity': 0.5001648, 'f1': 0.4920482, 'auroc': 0.8821122, 'binary_precision': 0.045454547, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.0070671374}
confusion matrix:
      0   1
0  5976  21
1   260   1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_22.png
early stop counter: 17
val acc:0.9717965126037598, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 22,now: 2024-06-28 01:32:14.158384,epoch time: 1:03:00.443005,used: 1 day, 0:39:46.980720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99898314, 'precision': 0.99924874, 'recall': 0.998096, 'specificity': 0.998096, 'f1': 0.99867064, 'auroc': 0.99991935, 'binary_precision': 0.99979544, 'binary_recall': 0.99626285, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9980261}
confusion matrix:
       0      1
0  42320      3
1     55  14662
---- Validation: 
scalar performance:
{'acc': 0.9668476, 'precision': 0.85272765, 'recall': 0.5238027, 'specificity': 0.5238027, 'f1': 0.5368135, 'auroc': 0.9571305, 'binary_precision': 0.7380952, 'binary_recall': 0.048211507, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.09051095}
confusion matrix:
       0   1
0  18138  11
1    612  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547779, 'precision': 0.47907314, 'recall': 0.49816576, 'specificity': 0.49816576, 'f1': 0.48843294, 'auroc': 0.92802674, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5975  22
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_23.png
early stop counter: 18
val acc:0.9668475985527039, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 23,now: 2024-06-28 02:34:59.926873,epoch time: 1:02:45.768489,used: 1 day, 1:42:32.749209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99898314, 'precision': 0.99924874, 'recall': 0.99809587, 'specificity': 0.99809587, 'f1': 0.9986706, 'auroc': 0.99991846, 'binary_precision': 0.99979544, 'binary_recall': 0.99626255, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.9980259}
confusion matrix:
       0      1
0  42321      3
1     55  14661
---- Validation: 
scalar performance:
{'acc': 0.967433, 'precision': 0.8571047, 'recall': 0.53610665, 'specificity': 0.53610665, 'f1': 0.55827457, 'auroc': 0.9513545, 'binary_precision': 0.74603176, 'binary_recall': 0.07309487, 'binary_specificity': 0.9991184, 'binary_f1_score': 0.13314448}
confusion matrix:
       0   1
0  18133  16
1    596  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.66686, 'recall': 0.50533026, 'specificity': 0.50533026, 'f1': 0.5004151, 'auroc': 0.93350065, 'binary_precision': 0.375, 'binary_recall': 0.011494253, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.022304833}
confusion matrix:
      0  1
0  5992  5
1   258  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_24.png
early stop counter: 19
val acc:0.967432975769043, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 24,now: 2024-06-28 03:37:52.777750,epoch time: 1:02:52.850877,used: 1 day, 2:45:25.600086,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99447757, 'precision': 0.9912332, 'recall': 0.994417, 'specificity': 0.994417, 'f1': 0.9928113, 'auroc': 0.99976957, 'binary_precision': 0.984458, 'binary_recall': 0.9942919, 'binary_specificity': 0.9945421, 'binary_f1_score': 0.9893505}
confusion matrix:
       0      1
0  42093    231
1     84  14632
---- Validation: 
scalar performance:
{'acc': 0.9623776, 'precision': 0.716542, 'recall': 0.72400343, 'specificity': 0.72400343, 'f1': 0.7202015, 'auroc': 0.9187212, 'binary_precision': 0.45195195, 'binary_recall': 0.4681182, 'binary_specificity': 0.9798887, 'binary_f1_score': 0.45989302}
confusion matrix:
       0    1
0  17784  365
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.935123, 'precision': 0.47865206, 'recall': 0.48791063, 'specificity': 0.48791063, 'f1': 0.483237, 'auroc': 0.8349179, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.97582126, 'binary_f1_score': 0.0}
confusion matrix:
      0    1
0  5852  145
1   261    0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_25.png
early stop counter: 20
val acc:0.9623776078224182, best validation acc: 0.9736058115959167, corresponding to test acc:                         0.9584531784057617 / 0.9584531784057617
after epoch: 25,now: 2024-06-28 04:41:02.364881,epoch time: 1:03:09.587131,used: 1 day, 3:48:35.187217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_00_52_27_seed_0_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 25 with time: 1 day, 3:48:35.187217 at 2024-06-28 04:41:02.364881
persisted model performance metric: 

scalar performance:
{'acc': 0.9584532, 'precision': 0.7523175, 'recall': 0.5110774, 'specificity': 0.5110774, 'f1': 0.5114414, 'auroc': 0.93375754, 'binary_precision': 0.54545456, 'binary_recall': 0.022988506, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.04411765}
confusion matrix:
      0  1
0  5992  5
1   255  6
oracle model performance metric: 

scalar performance:
{'acc': 0.9584532, 'precision': 0.7523175, 'recall': 0.5110774, 'specificity': 0.5110774, 'f1': 0.5114414, 'auroc': 0.93375754, 'binary_precision': 0.54545456, 'binary_recall': 0.022988506, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.04411765}
confusion matrix:
      0  1
0  5992  5
1   255  6
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457949 KiB |   8402 MiB |   5450 TiB |   5450 TiB |
|       from large pool | 416262 KiB |   8365 MiB |   5393 TiB |   5393 TiB |
|       from small pool |  41687 KiB |     61 MiB |     56 TiB |     56 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457949 KiB |   8402 MiB |   5450 TiB |   5450 TiB |
|       from large pool | 416262 KiB |   8365 MiB |   5393 TiB |   5393 TiB |
|       from small pool |  41687 KiB |     61 MiB |     56 TiB |     56 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   8396 MiB |   5448 TiB |   5448 TiB |
|       from large pool | 407075 KiB |   8359 MiB |   5391 TiB |   5391 TiB |
|       from small pool |  40679 KiB |     60 MiB |     56 TiB |     56 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9142 MiB |   9142 MiB |   9142 MiB |      0 B   |
|       from large pool |   9074 MiB |   9074 MiB |   9074 MiB |      0 B   |
|       from small pool |     68 MiB |     68 MiB |     68 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 318242 KiB |   1213 MiB |   5086 TiB |   5086 TiB |
|       from large pool | 308730 KiB |   1209 MiB |   5028 TiB |   5028 TiB |
|       from small pool |   9512 KiB |     11 MiB |     57 TiB |     57 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8115    |  701956 K  |  701952 K  |
|       from large pool |     187    |     941    |  479227 K  |  479226 K  |
|       from small pool |    3301    |    7927    |  222729 K  |  222725 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8115    |  701956 K  |  701952 K  |
|       from large pool |     187    |     941    |  479227 K  |  479226 K  |
|       from small pool |    3301    |    7927    |  222729 K  |  222725 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     393    |     393    |     393    |       0    |
|       from large pool |     359    |     359    |     359    |       0    |
|       from small pool |      34    |      34    |      34    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      65    |    3611    |  431680 K  |  431680 K  |
|       from large pool |      32    |     358    |  337402 K  |  337402 K  |
|       from small pool |      33    |    3579    |   94278 K  |   94278 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8402 MiB |   5450 TiB |   5450 TiB |
|       from large pool |  16640 KiB |   8365 MiB |   5393 TiB |   5393 TiB |
|       from small pool |      0 KiB |     61 MiB |     56 TiB |     56 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8402 MiB |   5450 TiB |   5450 TiB |
|       from large pool |  16640 KiB |   8365 MiB |   5393 TiB |   5393 TiB |
|       from small pool |      0 KiB |     61 MiB |     56 TiB |     56 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8396 MiB |   5448 TiB |   5448 TiB |
|       from large pool |  16640 KiB |   8359 MiB |   5391 TiB |   5391 TiB |
|       from small pool |      0 KiB |     60 MiB |     56 TiB |     56 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 776192 KiB |   9142 MiB |   9142 MiB |   8384 MiB |
|       from large pool | 724992 KiB |   9074 MiB |   9074 MiB |   8366 MiB |
|       from small pool |  51200 KiB |     68 MiB |     68 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1213 MiB |   5086 TiB |   5086 TiB |
|       from large pool |  24320 KiB |   1209 MiB |   5028 TiB |   5028 TiB |
|       from small pool |      0 KiB |     27 MiB |     57 TiB |     57 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |  701956 K  |  701956 K  |
|       from large pool |       2    |     941    |  479227 K  |  479227 K  |
|       from small pool |       0    |    7927    |  222729 K  |  222729 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |  701956 K  |  701956 K  |
|       from large pool |       2    |     941    |  479227 K  |  479227 K  |
|       from small pool |       0    |    7927    |  222729 K  |  222729 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     393    |     393    |     335    |
|       from large pool |      33    |     359    |     359    |     326    |
|       from small pool |      25    |      34    |      34    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3611    |  431682 K  |  431682 K  |
|       from large pool |       3    |     358    |  337402 K  |  337402 K  |
|       from small pool |       0    |    3579    |   94279 K  |   94279 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8402 MiB |   5450 TiB |   5450 TiB |
|       from large pool |  16640 KiB |   8365 MiB |   5393 TiB |   5393 TiB |
|       from small pool |      0 KiB |     61 MiB |     56 TiB |     56 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8402 MiB |   5450 TiB |   5450 TiB |
|       from large pool |  16640 KiB |   8365 MiB |   5393 TiB |   5393 TiB |
|       from small pool |      0 KiB |     61 MiB |     56 TiB |     56 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8396 MiB |   5448 TiB |   5448 TiB |
|       from large pool |  16640 KiB |   8359 MiB |   5391 TiB |   5391 TiB |
|       from small pool |      0 KiB |     60 MiB |     56 TiB |     56 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 776192 KiB |   9142 MiB |   9142 MiB |   8384 MiB |
|       from large pool | 724992 KiB |   9074 MiB |   9074 MiB |   8366 MiB |
|       from small pool |  51200 KiB |     68 MiB |     68 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1213 MiB |   5086 TiB |   5086 TiB |
|       from large pool |  24320 KiB |   1209 MiB |   5028 TiB |   5028 TiB |
|       from small pool |      0 KiB |     27 MiB |     57 TiB |     57 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |  701956 K  |  701956 K  |
|       from large pool |       2    |     941    |  479227 K  |  479227 K  |
|       from small pool |       0    |    7927    |  222729 K  |  222729 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |  701956 K  |  701956 K  |
|       from large pool |       2    |     941    |  479227 K  |  479227 K  |
|       from small pool |       0    |    7927    |  222729 K  |  222729 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     393    |     393    |     335    |
|       from large pool |      33    |     359    |     359    |     326    |
|       from small pool |      25    |      34    |      34    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3611    |  431682 K  |  431682 K  |
|       from large pool |       3    |     358    |  337402 K  |  337402 K  |
|       from small pool |       0    |    3579    |   94279 K  |   94279 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849

 Experiment start at: 2024-06-28 04:48:22.887605
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9860466, 'precision': 0.99054253, 'recall': 0.9727552, 'specificity': 0.9727552, 'f1': 0.9812418, 'auroc': 0.9992064, 'binary_precision': 0.9991941, 'binary_recall': 0.9457698, 'binary_specificity': 0.99974066, 'binary_f1_score': 0.9717482}
confusion matrix:
       0      1
0  42401     11
1    782  13638
---- Validation: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.70231366, 'recall': 0.5077849, 'specificity': 0.5077849, 'f1': 0.50657004, 'auroc': 0.9269873, 'binary_precision': 0.44, 'binary_recall': 0.016344724, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.031518623}
confusion matrix:
       0   1
0  18053  14
1    662  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95713824, 'precision': 0.5416062, 'recall': 0.5013344, 'specificity': 0.5013344, 'f1': 0.49277943, 'auroc': 0.8796686, 'binary_precision': 0.125, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0074626864}
confusion matrix:
      0  1
0  5939  7
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-28 05:51:32.394221,epoch time: 1:03:09.506616,used: 1:03:09.506616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98425186, 'precision': 0.9721165, 'recall': 0.98766375, 'specificity': 0.98766375, 'f1': 0.97954905, 'auroc': 0.9992576, 'binary_precision': 0.94610465, 'binary_recall': 0.9945908, 'binary_specificity': 0.9807366, 'binary_f1_score': 0.969742}
confusion matrix:
       0      1
0  41595    817
1     78  14342
---- Validation: 
scalar performance:
{'acc': 0.92102456, 'precision': 0.63856643, 'recall': 0.8610497, 'specificity': 0.8610497, 'f1': 0.6888449, 'auroc': 0.92877007, 'binary_precision': 0.2852581, 'binary_recall': 0.79643387, 'binary_specificity': 0.92566556, 'binary_f1_score': 0.4200627}
confusion matrix:
       0     1
0  16724  1343
1    137   536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9360297, 'precision': 0.6769123, 'recall': 0.8342092, 'specificity': 0.8342092, 'f1': 0.72615355, 'auroc': 0.9252128, 'binary_precision': 0.36647174, 'binary_recall': 0.72307694, 'binary_specificity': 0.9453414, 'binary_f1_score': 0.48641655}
confusion matrix:
      0    1
0  5621  325
1    72  188
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_2.png
early stop counter: 1
val acc:0.9210245609283447, best validation acc: 0.9639274477958679, corresponding to test acc:                         0.9571382403373718 / 0.9571382403373718
after epoch: 2,now: 2024-06-28 06:54:14.561544,epoch time: 1:02:42.167323,used: 2:05:51.673939,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9952843, 'precision': 0.99591863, 'recall': 0.9916222, 'specificity': 0.9916222, 'f1': 0.9937467, 'auroc': 0.999377, 'binary_precision': 0.9971892, 'binary_recall': 0.98418754, 'binary_specificity': 0.9990569, 'binary_f1_score': 0.99064577}
confusion matrix:
       0      1
0  42373     40
1    228  14191
---- Validation: 
scalar performance:
{'acc': 0.96616864, 'precision': 0.7650496, 'recall': 0.6391259, 'specificity': 0.6391259, 'f1': 0.68052125, 'auroc': 0.9277468, 'binary_precision': 0.556196, 'binary_recall': 0.28677562, 'binary_specificity': 0.9914762, 'binary_f1_score': 0.37843138}
confusion matrix:
       0    1
0  17913  154
1    480  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9634225, 'precision': 0.8880267, 'recall': 0.5818514, 'specificity': 0.5818514, 'f1': 0.62799925, 'auroc': 0.8974097, 'binary_precision': 0.8113208, 'binary_recall': 0.16538462, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.2747604}
confusion matrix:
      0   1
0  5936  10
1   217  43
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-28 07:57:07.348049,epoch time: 1:02:52.786505,used: 3:08:44.460444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9964281, 'precision': 0.9966619, 'recall': 0.9938991, 'specificity': 0.9938991, 'f1': 0.99527067, 'auroc': 0.9997549, 'binary_precision': 0.9971325, 'binary_recall': 0.9887648, 'binary_specificity': 0.99903333, 'binary_f1_score': 0.99293107}
confusion matrix:
       0      1
0  42372     41
1    162  14257
---- Validation: 
scalar performance:
{'acc': 0.9647279, 'precision': 0.744889, 'recall': 0.64123976, 'specificity': 0.64123976, 'f1': 0.6776564, 'auroc': 0.9284612, 'binary_precision': 0.5157068, 'binary_recall': 0.29271916, 'binary_specificity': 0.98976034, 'binary_f1_score': 0.37345973}
confusion matrix:
       0    1
0  17882  185
1    476  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9434418, 'precision': 0.4787408, 'recall': 0.4923478, 'specificity': 0.4923478, 'f1': 0.48544896, 'auroc': 0.88193196, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9846956, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5855  91
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_4.png
early stop counter: 1
val acc:0.9647278785705566, best validation acc: 0.9661686420440674, corresponding to test acc:                         0.9634224772453308 / 0.9634224772453308
after epoch: 4,now: 2024-06-28 08:59:59.936010,epoch time: 1:02:52.587961,used: 4:11:37.048405,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99503803, 'precision': 0.9965785, 'recall': 0.9903363, 'specificity': 0.9903363, 'f1': 0.9934075, 'auroc': 0.99966383, 'binary_precision': 0.9996466, 'binary_recall': 0.98079056, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.9901288}
confusion matrix:
       0      1
0  42407      5
1    277  14143
---- Validation: 
scalar performance:
{'acc': 0.966809, 'precision': 0.7662507, 'recall': 0.6845198, 'specificity': 0.6845198, 'f1': 0.7171929, 'auroc': 0.93814266, 'binary_precision': 0.55531454, 'binary_recall': 0.38038632, 'binary_specificity': 0.98865336, 'binary_f1_score': 0.4514991}
confusion matrix:
       0    1
0  17862  205
1    417  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.84699416, 'recall': 0.6059264, 'specificity': 0.6059264, 'f1': 0.65685534, 'auroc': 0.9130449, 'binary_precision': 0.72727275, 'binary_recall': 0.21538462, 'binary_specificity': 0.9964682, 'binary_f1_score': 0.33234423}
confusion matrix:
      0   1
0  5925  21
1   204  56
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_5.png
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-06-28 10:03:08.101974,epoch time: 1:03:08.165964,used: 5:14:45.214369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99602336, 'precision': 0.9969263, 'recall': 0.9925751, 'specificity': 0.9925751, 'f1': 0.9947264, 'auroc': 0.9997474, 'binary_precision': 0.99873495, 'binary_recall': 0.9855746, 'binary_specificity': 0.9995756, 'binary_f1_score': 0.99211115}
confusion matrix:
       0      1
0  42395     18
1    208  14211
---- Validation: 
scalar performance:
{'acc': 0.96542156, 'precision': 0.7646443, 'recall': 0.5850934, 'specificity': 0.5850934, 'f1': 0.6246307, 'auroc': 0.92897075, 'binary_precision': 0.5592417, 'binary_recall': 0.17533432, 'binary_specificity': 0.9948525, 'binary_f1_score': 0.2669683}
confusion matrix:
       0    1
0  17974   93
1    555  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95391554, 'precision': 0.49689567, 'recall': 0.49965265, 'specificity': 0.49965265, 'f1': 0.49167743, 'auroc': 0.89377326, 'binary_precision': 0.035714287, 'binary_recall': 0.0038461538, 'binary_specificity': 0.99545914, 'binary_f1_score': 0.0069444445}
confusion matrix:
      0   1
0  5919  27
1   259   1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_6.png
early stop counter: 1
val acc:0.9654215574264526, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 6,now: 2024-06-28 11:06:29.750288,epoch time: 1:03:21.648314,used: 6:18:06.862683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9970439, 'precision': 0.9979571, 'recall': 0.99424183, 'specificity': 0.99424183, 'f1': 0.9960818, 'auroc': 0.9998401, 'binary_precision': 0.99978954, 'binary_recall': 0.98855436, 'binary_specificity': 0.99992925, 'binary_f1_score': 0.99414015}
confusion matrix:
       0      1
0  42413      3
1    165  14251
---- Validation: 
scalar performance:
{'acc': 0.96318036, 'precision': 0.6605152, 'recall': 0.51455015, 'specificity': 0.51455015, 'f1': 0.5193003, 'auroc': 0.9430258, 'binary_precision': 0.3559322, 'binary_recall': 0.031203566, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.057377048}
confusion matrix:
       0   1
0  18029  38
1    652  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.47900516, 'recall': 0.49882275, 'specificity': 0.49882275, 'f1': 0.48871315, 'auroc': 0.8944476, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9976455, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5932  14
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_7.png
early stop counter: 2
val acc:0.9631803631782532, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 7,now: 2024-06-28 12:09:32.602086,epoch time: 1:03:02.851798,used: 7:21:09.714481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9973255, 'precision': 0.99701333, 'recall': 0.9959196, 'specificity': 0.9959196, 'f1': 0.9964649, 'auroc': 0.9997114, 'binary_precision': 0.9963819, 'binary_recall': 0.9930652, 'binary_specificity': 0.99877393, 'binary_f1_score': 0.99472076}
confusion matrix:
       0      1
0  42360     52
1    100  14320
---- Validation: 
scalar performance:
{'acc': 0.9659018, 'precision': 0.75404537, 'recall': 0.7398402, 'specificity': 0.7398402, 'f1': 0.7467145, 'auroc': 0.9371703, 'binary_precision': 0.52681386, 'binary_recall': 0.4962853, 'binary_specificity': 0.98339516, 'binary_f1_score': 0.5110941}
confusion matrix:
       0    1
0  17767  300
1    339  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597164, 'precision': 0.7563231, 'recall': 0.6111801, 'specificity': 0.6111801, 'f1': 0.65178186, 'auroc': 0.9210272, 'binary_precision': 0.54545456, 'binary_recall': 0.23076923, 'binary_specificity': 0.991591, 'binary_f1_score': 0.32432434}
confusion matrix:
      0   1
0  5896  50
1   200  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_8.png
early stop counter: 3
val acc:0.965901792049408, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 8,now: 2024-06-28 13:12:40.242056,epoch time: 1:03:07.639970,used: 8:24:17.354451,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99736065, 'precision': 0.9977494, 'recall': 0.9952792, 'specificity': 0.9952792, 'f1': 0.99650645, 'auroc': 0.9998264, 'binary_precision': 0.9985326, 'binary_recall': 0.99105346, 'binary_specificity': 0.99950486, 'binary_f1_score': 0.99477893}
confusion matrix:
       0      1
0  42392     21
1    129  14290
---- Validation: 
scalar performance:
{'acc': 0.966222, 'precision': 0.76803863, 'recall': 0.62913984, 'specificity': 0.62913984, 'f1': 0.6719518, 'auroc': 0.9394624, 'binary_precision': 0.5628931, 'binary_recall': 0.26597324, 'binary_specificity': 0.9923064, 'binary_f1_score': 0.36125124}
confusion matrix:
       0    1
0  17928  139
1    494  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6877489, 'recall': 0.50902677, 'specificity': 0.50902677, 'f1': 0.5075916, 'auroc': 0.9147639, 'binary_precision': 0.41666666, 'binary_recall': 0.01923077, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.036764707}
confusion matrix:
      0  1
0  5939  7
1   255  5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_9.png
early stop counter: 4
val acc:0.9662219882011414, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 9,now: 2024-06-28 14:15:38.013053,epoch time: 1:02:57.770997,used: 9:27:15.125448,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99783576, 'precision': 0.9981599, 'recall': 0.9961239, 'specificity': 0.9961239, 'f1': 0.9971366, 'auroc': 0.99981344, 'binary_precision': 0.9988137, 'binary_recall': 0.9926486, 'binary_specificity': 0.99959916, 'binary_f1_score': 0.99572164}
confusion matrix:
       0      1
0  42396     17
1    106  14313
---- Validation: 
scalar performance:
{'acc': 0.9652081, 'precision': 0.7487534, 'recall': 0.7423415, 'specificity': 0.7423415, 'f1': 0.74550056, 'auroc': 0.9392656, 'binary_precision': 0.51603055, 'binary_recall': 0.5022288, 'binary_specificity': 0.9824542, 'binary_f1_score': 0.5090362}
confusion matrix:
       0    1
0  17750  317
1    335  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95601034, 'precision': 0.6611238, 'recall': 0.5301696, 'specificity': 0.5301696, 'f1': 0.54409826, 'auroc': 0.9106819, 'binary_precision': 0.3617021, 'binary_recall': 0.06538462, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.110749185}
confusion matrix:
      0   1
0  5916  30
1   243  17
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_10.png
early stop counter: 5
val acc:0.965208113193512, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9637447595596313 / 0.9637447595596313
after epoch: 10,now: 2024-06-28 15:19:06.196731,epoch time: 1:03:28.183678,used: 10:30:43.309126,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9954075, 'precision': 0.9927988, 'recall': 0.99511456, 'specificity': 0.99511456, 'f1': 0.99394965, 'auroc': 0.9996458, 'binary_precision': 0.9874647, 'binary_recall': 0.99451995, 'binary_specificity': 0.9957092, 'binary_f1_score': 0.9909798}
confusion matrix:
       0      1
0  42234    182
1     79  14337
---- Validation: 
scalar performance:
{'acc': 0.96499467, 'precision': 0.7470132, 'recall': 0.7086133, 'specificity': 0.7086133, 'f1': 0.72600627, 'auroc': 0.9190047, 'binary_precision': 0.5150443, 'binary_recall': 0.43239227, 'binary_specificity': 0.98483425, 'binary_f1_score': 0.47011307}
confusion matrix:
       0    1
0  17793  274
1    382  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96761197, 'precision': 0.8524059, 'recall': 0.6759871, 'specificity': 0.6759871, 'f1': 0.7319525, 'auroc': 0.89856076, 'binary_precision': 0.7322835, 'binary_recall': 0.3576923, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.48062015}
confusion matrix:
      0   1
0  5912  34
1   167  93
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_11.png
new oracle model saved
early stop counter: 6
val acc:0.9649946689605713, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9637447595596313 / 0.9676119685173035
after epoch: 11,now: 2024-06-28 16:24:19.775494,epoch time: 1:05:13.578763,used: 11:35:56.887889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.997607, 'precision': 0.9979143, 'recall': 0.9957646, 'specificity': 0.9957646, 'f1': 0.9968335, 'auroc': 0.9997583, 'binary_precision': 0.998534, 'binary_recall': 0.9920244, 'binary_specificity': 0.99950486, 'binary_f1_score': 0.9952686}
confusion matrix:
       0      1
0  42392     21
1    115  14304
---- Validation: 
scalar performance:
{'acc': 0.96195304, 'precision': 0.6008739, 'recall': 0.5117678, 'specificity': 0.5117678, 'f1': 0.51432633, 'auroc': 0.93327475, 'binary_precision': 0.23684211, 'binary_recall': 0.026745914, 'binary_specificity': 0.99678975, 'binary_f1_score': 0.048064087}
confusion matrix:
       0   1
0  18009  58
1    655  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95278764, 'precision': 0.47894055, 'recall': 0.49722502, 'specificity': 0.49722502, 'f1': 0.48791155, 'auroc': 0.930303, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5913  33
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_12.png
early stop counter: 7
val acc:0.9619530439376831, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9637447595596313 / 0.9676119685173035
after epoch: 12,now: 2024-06-28 17:29:59.307533,epoch time: 1:05:39.532039,used: 12:41:36.419928,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99595296, 'precision': 0.9973032, 'recall': 0.9920244, 'specificity': 0.9920244, 'f1': 0.9946281, 'auroc': 0.99982655, 'binary_precision': 1.0, 'binary_recall': 0.98404884, 'binary_specificity': 1.0, 'binary_f1_score': 0.9919603}
confusion matrix:
       0      1
0  42413      0
1    230  14189
---- Validation: 
scalar performance:
{'acc': 0.96403414, 'precision': 0.70943946, 'recall': 0.5035486, 'specificity': 0.5035486, 'f1': 0.49815136, 'auroc': 0.93788695, 'binary_precision': 0.45454547, 'binary_recall': 0.0074294205, 'binary_specificity': 0.9996679, 'binary_f1_score': 0.014619883}
confusion matrix:
       0  1
0  18061  6
1    668  5
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.47903565, 'recall': 0.49957955, 'specificity': 0.49957955, 'f1': 0.489092, 'auroc': 0.8650415, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5941  5
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_13.png
early stop counter: 8
val acc:0.9640341401100159, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9637447595596313 / 0.9676119685173035
after epoch: 13,now: 2024-06-28 18:34:16.845519,epoch time: 1:04:17.537986,used: 13:45:53.957914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99609375, 'precision': 0.99730206, 'recall': 0.9923939, 'specificity': 0.9923939, 'f1': 0.9948171, 'auroc': 0.99976313, 'binary_precision': 0.9997184, 'binary_recall': 0.9848821, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.9922448}
confusion matrix:
       0      1
0  42408      4
1    218  14202
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.62518144, 'recall': 0.5080851, 'specificity': 0.5080851, 'f1': 0.50738573, 'auroc': 0.9227283, 'binary_precision': 0.2857143, 'binary_recall': 0.017830608, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.03356643}
confusion matrix:
       0   1
0  18037  30
1    661  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.47902888, 'recall': 0.49941137, 'specificity': 0.49941137, 'f1': 0.4890078, 'auroc': 0.86768967, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5939  7
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_14.png
early stop counter: 9
val acc:0.9631270170211792, best validation acc: 0.9668089747428894, corresponding to test acc:                         0.9637447595596313 / 0.9676119685173035
after epoch: 14,now: 2024-06-28 19:40:47.180602,epoch time: 1:06:30.335083,used: 14:52:24.292997,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9984692, 'precision': 0.99897647, 'recall': 0.9969832, 'specificity': 0.9969832, 'f1': 0.9979747, 'auroc': 0.9998964, 'binary_precision': 1.0, 'binary_recall': 0.9939663, 'binary_specificity': 1.0, 'binary_f1_score': 0.996974}
confusion matrix:
       0      1
0  42413      0
1     87  14332
---- Validation: 
scalar performance:
{'acc': 0.9689434, 'precision': 0.89414227, 'recall': 0.58620465, 'specificity': 0.58620465, 'f1': 0.6354454, 'auroc': 0.9513961, 'binary_precision': 0.8181818, 'binary_recall': 0.17384844, 'binary_specificity': 0.9985609, 'binary_f1_score': 0.2867647}
confusion matrix:
       0    1
0  18041   26
1    556  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.6667675, 'recall': 0.5053488, 'specificity': 0.5053488, 'f1': 0.50040686, 'auroc': 0.905314, 'binary_precision': 0.375, 'binary_recall': 0.011538462, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.02238806}
confusion matrix:
      0  1
0  5941  5
1   257  3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_15.png
better model found
persisted
after epoch: 15,now: 2024-06-28 20:58:39.528074,epoch time: 1:17:52.347472,used: 16:10:16.640469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99808204, 'precision': 0.9985327, 'recall': 0.9964036, 'specificity': 0.9964036, 'f1': 0.9974624, 'auroc': 0.9998051, 'binary_precision': 0.9994416, 'binary_recall': 0.99299586, 'binary_specificity': 0.99981135, 'binary_f1_score': 0.9962083}
confusion matrix:
       0      1
0  42404      8
1    101  14319
---- Validation: 
scalar performance:
{'acc': 0.9646211, 'precision': 0.7485829, 'recall': 0.5667966, 'specificity': 0.5667966, 'f1': 0.6004909, 'auroc': 0.9336505, 'binary_precision': 0.52840906, 'binary_recall': 0.13818721, 'binary_specificity': 0.995406, 'binary_f1_score': 0.21908125}
confusion matrix:
       0   1
0  17984  83
1    580  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95601034, 'precision': 0.6867284, 'recall': 0.55407643, 'specificity': 0.55407643, 'f1': 0.5787895, 'auroc': 0.9169382, 'binary_precision': 0.41095892, 'binary_recall': 0.115384616, 'binary_specificity': 0.9927682, 'binary_f1_score': 0.18018019}
confusion matrix:
      0   1
0  5903  43
1   230  30
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_16.png
early stop counter: 1
val acc:0.9646211266517639, best validation acc: 0.9689434170722961, corresponding to test acc:                         0.9577828049659729 / 0.9676119685173035
after epoch: 16,now: 2024-06-28 22:02:15.861688,epoch time: 1:03:36.333614,used: 17:13:52.974083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9980997, 'precision': 0.9976951, 'recall': 0.99728477, 'specificity': 0.99728477, 'f1': 0.9974897, 'auroc': 0.9998569, 'binary_precision': 0.996875, 'binary_recall': 0.99563044, 'binary_specificity': 0.99893904, 'binary_f1_score': 0.9962523}
confusion matrix:
       0      1
0  42369     45
1     63  14355
---- Validation: 
scalar performance:
{'acc': 0.96873, 'precision': 0.7753161, 'recall': 0.76348025, 'specificity': 0.76348025, 'f1': 0.7692536, 'auroc': 0.95544994, 'binary_precision': 0.5676516, 'binary_recall': 0.54234767, 'binary_specificity': 0.9846128, 'binary_f1_score': 0.5547112}
confusion matrix:
       0    1
0  17789  278
1    308  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.81253695, 'recall': 0.50376207, 'specificity': 0.50376207, 'f1': 0.49694523, 'auroc': 0.9134764, 'binary_precision': 0.6666667, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5945  1
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_17.png
early stop counter: 2
val acc:0.9687299728393555, best validation acc: 0.9689434170722961, corresponding to test acc:                         0.9577828049659729 / 0.9676119685173035
after epoch: 17,now: 2024-06-28 23:05:55.854285,epoch time: 1:03:39.992597,used: 18:17:32.966680,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9984516, 'precision': 0.99877965, 'recall': 0.9971314, 'specificity': 0.9971314, 'f1': 0.9979521, 'auroc': 0.99993587, 'binary_precision': 0.99944234, 'binary_recall': 0.9944514, 'binary_specificity': 0.9998114, 'binary_f1_score': 0.9969406}
confusion matrix:
       0      1
0  42406      8
1     80  14338
---- Validation: 
scalar performance:
{'acc': 0.9668623, 'precision': 0.79843104, 'recall': 0.5937086, 'specificity': 0.5937086, 'f1': 0.6382743, 'auroc': 0.9484128, 'binary_precision': 0.6262136, 'binary_recall': 0.19167905, 'binary_specificity': 0.9957381, 'binary_f1_score': 0.29351535}
confusion matrix:
       0    1
0  17990   77
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9555269, 'precision': 0.4789984, 'recall': 0.49865454, 'specificity': 0.49865454, 'f1': 0.48862886, 'auroc': 0.9094638, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5930  16
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587849_18.png
early stop counter: 3
val acc:0.9668623208999634, best validation acc: 0.9689434170722961, corresponding to test acc:                         0.9577828049659729 / 0.9676119685173035
after epoch: 18,now: 2024-06-29 00:09:40.052074,epoch time: 1:03:44.197789,used: 19:21:17.164469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_04_48_22_seed_1_21587849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 21587849 ON supergpu03 CANCELLED AT 2024-06-29T00:42:51 DUE TO TIME LIMIT ***
