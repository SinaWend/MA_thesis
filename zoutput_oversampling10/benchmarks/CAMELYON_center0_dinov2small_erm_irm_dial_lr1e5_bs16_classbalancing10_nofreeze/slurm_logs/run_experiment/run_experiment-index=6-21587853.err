Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jun 27 10:10:40 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853

 Experiment start at: 2024-06-27 10:17:43.385724
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9873773, 'precision': 0.98133665, 'recall': 0.9859091, 'specificity': 0.9859091, 'f1': 0.9835937, 'auroc': 0.9983409, 'binary_precision': 0.9686579, 'binary_recall': 0.98287576, 'binary_specificity': 0.98894244, 'binary_f1_score': 0.97571504}
confusion matrix:
       0      1
0  41856    468
1    252  14464
---- Validation: 
scalar performance:
{'acc': 0.9463602, 'precision': 0.6759355, 'recall': 0.8469707, 'specificity': 0.8469707, 'f1': 0.72870934, 'auroc': 0.9338795, 'binary_precision': 0.3614275, 'binary_recall': 0.7402799, 'binary_specificity': 0.9536614, 'binary_f1_score': 0.48571426}
confusion matrix:
       0    1
0  17308  841
1    167  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9472675, 'precision': 0.70622885, 'recall': 0.8478875, 'specificity': 0.8478875, 'f1': 0.75557, 'auroc': 0.93376315, 'binary_precision': 0.42417583, 'binary_recall': 0.7394636, 'binary_specificity': 0.95631146, 'binary_f1_score': 0.53910613}
confusion matrix:
      0    1
0  5735  262
1    68  193
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-27 10:38:48.941688,epoch time: 0:21:05.555964,used: 0:21:05.555964,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99046284, 'precision': 0.9847729, 'recall': 0.99055946, 'specificity': 0.99055946, 'f1': 0.9876199, 'auroc': 0.9994465, 'binary_precision': 0.97278005, 'binary_recall': 0.990759, 'binary_specificity': 0.99035984, 'binary_f1_score': 0.9816872}
confusion matrix:
       0      1
0  41915    408
1    136  14581
---- Validation: 
scalar performance:
{'acc': 0.9347063, 'precision': 0.65776044, 'recall': 0.8806902, 'specificity': 0.8806902, 'f1': 0.71412975, 'auroc': 0.9459224, 'binary_precision': 0.32216808, 'binary_recall': 0.82270604, 'binary_specificity': 0.93867433, 'binary_f1_score': 0.4630197}
confusion matrix:
       0     1
0  17036  1113
1    114   529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9645254, 'precision': 0.7733423, 'recall': 0.8367364, 'specificity': 0.8367364, 'f1': 0.80127597, 'auroc': 0.9414287, 'binary_precision': 0.56, 'binary_recall': 0.697318, 'binary_specificity': 0.97615474, 'binary_f1_score': 0.62116045}
confusion matrix:
      0    1
0  5854  143
1    79  182
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_2.png
new oracle model saved
early stop counter: 1
val acc:0.9347062706947327, best validation acc: 0.946360170841217, corresponding to test acc:                         0.947267472743988 / 0.9645254015922546
after epoch: 2,now: 2024-06-27 11:00:23.915712,epoch time: 0:21:34.974024,used: 0:42:40.529988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9950736, 'precision': 0.9944054, 'recall': 0.9927132, 'specificity': 0.9927132, 'f1': 0.9935554, 'auroc': 0.9996388, 'binary_precision': 0.99303234, 'binary_recall': 0.98783636, 'binary_specificity': 0.99759, 'binary_f1_score': 0.99042755}
confusion matrix:
       0      1
0  42222    102
1    179  14537
---- Validation: 
scalar performance:
{'acc': 0.9687633, 'precision': 0.7617029, 'recall': 0.81506586, 'specificity': 0.81506586, 'f1': 0.78562915, 'auroc': 0.9587444, 'binary_precision': 0.53589743, 'binary_recall': 0.65007776, 'binary_specificity': 0.980054, 'binary_f1_score': 0.5874912}
confusion matrix:
       0    1
0  17787  362
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9682007, 'precision': 0.8742373, 'recall': 0.6645823, 'specificity': 0.6645823, 'f1': 0.72505, 'auroc': 0.95487034, 'binary_precision': 0.77678573, 'binary_recall': 0.33333334, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.46648794}
confusion matrix:
      0   1
0  5972  25
1   174  87
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_3.png
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-06-27 11:20:31.261974,epoch time: 0:20:07.346262,used: 1:02:47.876250,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9952314, 'precision': 0.9939023, 'recall': 0.9936396, 'specificity': 0.9936396, 'f1': 0.99377084, 'auroc': 0.9994816, 'binary_precision': 0.99115884, 'binary_recall': 0.99035066, 'binary_specificity': 0.99692845, 'binary_f1_score': 0.9907546}
confusion matrix:
       0      1
0  42194    130
1    142  14574
---- Validation: 
scalar performance:
{'acc': 0.9680715, 'precision': 0.75923395, 'recall': 0.73895216, 'specificity': 0.73895216, 'f1': 0.7486351, 'auroc': 0.95478714, 'binary_precision': 0.53637904, 'binary_recall': 0.49300155, 'binary_specificity': 0.98490274, 'binary_f1_score': 0.51377636}
confusion matrix:
       0    1
0  17875  274
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97251517, 'precision': 0.8916701, 'recall': 0.7218034, 'specificity': 0.7218034, 'f1': 0.7810757, 'auroc': 0.9472164, 'binary_precision': 0.80689657, 'binary_recall': 0.44827586, 'binary_specificity': 0.995331, 'binary_f1_score': 0.5763546}
confusion matrix:
      0    1
0  5969   28
1   144  117
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_4.png
new oracle model saved
early stop counter: 1
val acc:0.9680715203285217, best validation acc: 0.9687632918357849, corresponding to test acc:                         0.96820068359375 / 0.9725151658058167
after epoch: 4,now: 2024-06-27 11:40:03.533229,epoch time: 0:19:32.271255,used: 1:22:20.147505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99225104, 'precision': 0.9931856, 'recall': 0.9865576, 'specificity': 0.9865576, 'f1': 0.9898132, 'auroc': 0.9988736, 'binary_precision': 0.9950756, 'binary_recall': 0.9747928, 'binary_specificity': 0.99832237, 'binary_f1_score': 0.9848298}
confusion matrix:
       0      1
0  42251     71
1    371  14347
---- Validation: 
scalar performance:
{'acc': 0.97078544, 'precision': 0.8258499, 'recall': 0.6375996, 'specificity': 0.6375996, 'f1': 0.6905352, 'auroc': 0.9373065, 'binary_precision': 0.6766917, 'binary_recall': 0.2799378, 'binary_specificity': 0.99526143, 'binary_f1_score': 0.3960396}
confusion matrix:
       0    1
0  18063   86
1    463  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.96747553, 'recall': 0.5650507, 'specificity': 0.5650507, 'f1': 0.6055359, 'auroc': 0.9363936, 'binary_precision': 0.9714286, 'binary_recall': 0.1302682, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.22972974}
confusion matrix:
      0   1
0  5996   1
1   227  34
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_5.png
better model found
persisted
after epoch: 5,now: 2024-06-27 11:59:44.294150,epoch time: 0:19:40.760921,used: 1:42:00.908426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9946704, 'precision': 0.9959967, 'recall': 0.99009156, 'specificity': 0.99009156, 'f1': 0.99299806, 'auroc': 0.9995069, 'binary_precision': 0.998685, 'binary_recall': 0.980632, 'binary_specificity': 0.9995511, 'binary_f1_score': 0.98957616}
confusion matrix:
       0      1
0  42306     19
1    285  14430
---- Validation: 
scalar performance:
{'acc': 0.96333545, 'precision': 0.69202876, 'recall': 0.58048874, 'specificity': 0.58048874, 'f1': 0.6107836, 'auroc': 0.9427172, 'binary_precision': 0.41287878, 'binary_recall': 0.16951789, 'binary_specificity': 0.9914596, 'binary_f1_score': 0.2403528}
confusion matrix:
       0    1
0  17994  155
1    534  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501438, 'precision': 0.5270379, 'recall': 0.5067419, 'specificity': 0.5067419, 'f1': 0.50572324, 'auroc': 0.906711, 'binary_precision': 0.0952381, 'binary_recall': 0.022988506, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.037037037}
confusion matrix:
      0   1
0  5940  57
1   255   6
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_6.png
early stop counter: 1
val acc:0.9633354544639587, best validation acc: 0.9707854390144348, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 6,now: 2024-06-27 12:20:58.128203,epoch time: 0:21:13.834053,used: 2:03:14.742479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99007714, 'precision': 0.9934011, 'recall': 0.98077446, 'specificity': 0.98077446, 'f1': 0.98687744, 'auroc': 0.9998059, 'binary_precision': 1.0, 'binary_recall': 0.9615489, 'binary_specificity': 1.0, 'binary_f1_score': 0.9803976}
confusion matrix:
       0      1
0  42320      0
1    566  14154
---- Validation: 
scalar performance:
{'acc': 0.9658365, 'precision': 0.8162755, 'recall': 0.50152767, 'specificity': 0.50152767, 'f1': 0.49440578, 'auroc': 0.94794333, 'binary_precision': 0.6666667, 'binary_recall': 0.00311042, 'binary_specificity': 0.9999449, 'binary_f1_score': 0.0061919508}
confusion matrix:
       0  1
0  18148  1
1    641  2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.953545, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_7.png
early stop counter: 2
val acc:0.9658365249633789, best validation acc: 0.9707854390144348, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 7,now: 2024-06-27 12:41:07.556535,epoch time: 0:20:09.428332,used: 2:23:24.170811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.996967, 'precision': 0.99585414, 'recall': 0.9962275, 'specificity': 0.9962275, 'f1': 0.9960406, 'auroc': 0.99978787, 'binary_precision': 0.9935519, 'binary_recall': 0.99469966, 'binary_specificity': 0.9977554, 'binary_f1_score': 0.9941254}
confusion matrix:
       0      1
0  42229     95
1     78  14638
---- Validation: 
scalar performance:
{'acc': 0.97302043, 'precision': 0.7929225, 'recall': 0.8135196, 'specificity': 0.8135196, 'f1': 0.8028345, 'auroc': 0.96578276, 'binary_precision': 0.59855074, 'binary_recall': 0.64230174, 'binary_specificity': 0.98473746, 'binary_f1_score': 0.6196549}
confusion matrix:
       0    1
0  17872  277
1    230  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.8170396, 'recall': 0.6124413, 'specificity': 0.6124413, 'f1': 0.66144574, 'auroc': 0.94166994, 'binary_precision': 0.6666667, 'binary_recall': 0.22988506, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.34188035}
confusion matrix:
      0   1
0  5967  30
1   201  60
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_8.png
better model found
persisted
after epoch: 8,now: 2024-06-27 13:00:53.635264,epoch time: 0:19:46.078729,used: 2:43:10.249540,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9970021, 'precision': 0.9972445, 'recall': 0.9949211, 'specificity': 0.9949211, 'f1': 0.99607563, 'auroc': 0.99983215, 'binary_precision': 0.9977413, 'binary_recall': 0.9906218, 'binary_specificity': 0.9992203, 'binary_f1_score': 0.9941688}
confusion matrix:
       0      1
0  42292     33
1    138  14577
---- Validation: 
scalar performance:
{'acc': 0.9771711, 'precision': 0.85165477, 'recall': 0.76916504, 'specificity': 0.76916504, 'f1': 0.8044605, 'auroc': 0.96061945, 'binary_precision': 0.7192623, 'binary_recall': 0.5458787, 'binary_specificity': 0.99245137, 'binary_f1_score': 0.6206897}
confusion matrix:
       0    1
0  18012  137
1    292  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96356666, 'precision': 0.90774095, 'recall': 0.57604474, 'specificity': 0.57604474, 'f1': 0.62053204, 'auroc': 0.95914954, 'binary_precision': 0.85106385, 'binary_recall': 0.1532567, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.25974026}
confusion matrix:
      0   1
0  5990   7
1   221  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_9.png
better model found
persisted
after epoch: 9,now: 2024-06-27 13:24:10.177387,epoch time: 0:23:16.542123,used: 3:06:26.791663,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9965814, 'precision': 0.9970957, 'recall': 0.9939734, 'specificity': 0.9939734, 'f1': 0.99552166, 'auroc': 0.99971616, 'binary_precision': 0.99814767, 'binary_recall': 0.98858464, 'binary_specificity': 0.99936205, 'binary_f1_score': 0.9933432}
confusion matrix:
       0      1
0  42296     27
1    168  14549
---- Validation: 
scalar performance:
{'acc': 0.96216476, 'precision': 0.70103765, 'recall': 0.6458875, 'specificity': 0.6458875, 'f1': 0.66853523, 'auroc': 0.9361255, 'binary_precision': 0.42640692, 'binary_recall': 0.30637637, 'binary_specificity': 0.98539865, 'binary_f1_score': 0.35656106}
confusion matrix:
       0    1
0  17884  265
1    446  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9504634, 'precision': 0.5217244, 'recall': 0.5050763, 'specificity': 0.5050763, 'f1': 0.5029159, 'auroc': 0.90084726, 'binary_precision': 0.084745765, 'binary_recall': 0.019157087, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.031249998}
confusion matrix:
      0   1
0  5943  54
1   256   5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_10.png
early stop counter: 1
val acc:0.9621647596359253, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 10,now: 2024-06-27 13:44:19.322716,epoch time: 0:20:09.145329,used: 3:26:35.936992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9967567, 'precision': 0.9976877, 'recall': 0.9938473, 'specificity': 0.9938473, 'f1': 0.99574804, 'auroc': 0.99963975, 'binary_precision': 0.9995874, 'binary_recall': 0.98783636, 'binary_specificity': 0.99985826, 'binary_f1_score': 0.99367714}
confusion matrix:
       0      1
0  42318      6
1    179  14537
---- Validation: 
scalar performance:
{'acc': 0.9683908, 'precision': 0.8722953, 'recall': 0.55310374, 'specificity': 0.55310374, 'f1': 0.586203, 'auroc': 0.9510827, 'binary_precision': 0.7752809, 'binary_recall': 0.10730949, 'binary_specificity': 0.998898, 'binary_f1_score': 0.1885246}
confusion matrix:
       0   1
0  18129  20
1    574  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7694384, 'recall': 0.52040577, 'specificity': 0.52040577, 'f1': 0.528743, 'auroc': 0.9583358, 'binary_precision': 0.57894737, 'binary_recall': 0.042145595, 'binary_specificity': 0.998666, 'binary_f1_score': 0.07857143}
confusion matrix:
      0   1
0  5989   8
1   250  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_11.png
early stop counter: 2
val acc:0.9683908224105835, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 11,now: 2024-06-27 14:03:58.064471,epoch time: 0:19:38.741755,used: 3:46:14.678747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9970372, 'precision': 0.9976947, 'recall': 0.99456894, 'specificity': 0.99456894, 'f1': 0.9961189, 'auroc': 0.9996824, 'binary_precision': 0.9990396, 'binary_recall': 0.9894687, 'binary_specificity': 0.9996692, 'binary_f1_score': 0.99423116}
confusion matrix:
       0      1
0  42308     14
1    155  14563
---- Validation: 
scalar performance:
{'acc': 0.9656769, 'precision': 0.7208618, 'recall': 0.5141959, 'specificity': 0.5141959, 'f1': 0.51907885, 'auroc': 0.9344359, 'binary_precision': 0.475, 'binary_recall': 0.02954899, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.055636898}
confusion matrix:
       0   1
0  18128  21
1    624  19
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.4791267, 'recall': 0.49949974, 'specificity': 0.49949974, 'f1': 0.48910117, 'auroc': 0.92533594, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5991  6
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_12.png
early stop counter: 3
val acc:0.9656769037246704, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 12,now: 2024-06-27 14:23:53.864098,epoch time: 0:19:55.799627,used: 4:06:10.478374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99815917, 'precision': 0.99862784, 'recall': 0.99656606, 'specificity': 0.99656606, 'f1': 0.9975914, 'auroc': 0.99984026, 'binary_precision': 0.9995898, 'binary_recall': 0.993274, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.9964219}
confusion matrix:
       0      1
0  42315      6
1     99  14620
---- Validation: 
scalar performance:
{'acc': 0.972914, 'precision': 0.83864903, 'recall': 0.67995465, 'specificity': 0.67995465, 'f1': 0.73308825, 'auroc': 0.9526572, 'binary_precision': 0.6994048, 'binary_recall': 0.36547434, 'binary_specificity': 0.99443495, 'binary_f1_score': 0.48008168}
confusion matrix:
       0    1
0  18048  101
1    408  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.6397048, 'recall': 0.5139083, 'specificity': 0.5139083, 'f1': 0.51693356, 'auroc': 0.9218613, 'binary_precision': 0.32, 'binary_recall': 0.03065134, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.055944055}
confusion matrix:
      0   1
0  5980  17
1   253   8
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_13.png
early stop counter: 4
val acc:0.9729139804840088, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 13,now: 2024-06-27 16:16:40.713995,epoch time: 1:52:46.849897,used: 5:58:57.328271,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9932679, 'precision': 0.99550426, 'recall': 0.98695385, 'specificity': 0.98695385, 'f1': 0.9911327, 'auroc': 0.9997426, 'binary_precision': 1.0, 'binary_recall': 0.9739077, 'binary_specificity': 1.0, 'binary_f1_score': 0.9867814}
confusion matrix:
       0      1
0  42323      0
1    384  14333
---- Validation: 
scalar performance:
{'acc': 0.9653576, 'precision': 0.59010166, 'recall': 0.5020298, 'specificity': 0.5020298, 'f1': 0.49575153, 'auroc': 0.9428816, 'binary_precision': 0.21428572, 'binary_recall': 0.00466563, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.00913242}
confusion matrix:
       0   1
0  18138  11
1    640   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.47913337, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48918456, 'auroc': 0.90398425, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_14.png
early stop counter: 5
val acc:0.9653576016426086, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 14,now: 2024-06-27 17:33:39.842355,epoch time: 1:16:59.128360,used: 7:15:56.456631,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99577487, 'precision': 0.9968491, 'recall': 0.99212086, 'specificity': 0.99212086, 'f1': 0.9944555, 'auroc': 0.99967754, 'binary_precision': 0.9990345, 'binary_recall': 0.9845725, 'binary_specificity': 0.99966925, 'binary_f1_score': 0.99175084}
confusion matrix:
       0      1
0  42312     14
1    227  14487
---- Validation: 
scalar performance:
{'acc': 0.9709983, 'precision': 0.9038374, 'recall': 0.59420663, 'specificity': 0.59420663, 'f1': 0.6472202, 'auroc': 0.9405565, 'binary_precision': 0.8356164, 'binary_recall': 0.18973562, 'binary_specificity': 0.9986776, 'binary_f1_score': 0.30925223}
confusion matrix:
       0    1
0  18125   24
1    521  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.81842273, 'recall': 0.5881207, 'specificity': 0.5881207, 'f1': 0.63226885, 'auroc': 0.92484987, 'binary_precision': 0.67142856, 'binary_recall': 0.18007663, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.2839879}
confusion matrix:
      0   1
0  5974  23
1   214  47
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_15.png
early stop counter: 6
val acc:0.9709982872009277, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 15,now: 2024-06-27 18:07:46.919041,epoch time: 0:34:07.076686,used: 7:50:03.533317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99691445, 'precision': 0.99577504, 'recall': 0.9961702, 'specificity': 0.9961702, 'f1': 0.9959724, 'auroc': 0.9998251, 'binary_precision': 0.9934175, 'binary_recall': 0.9946324, 'binary_specificity': 0.997708, 'binary_f1_score': 0.9940246}
confusion matrix:
       0      1
0  42225     97
1     79  14639
---- Validation: 
scalar performance:
{'acc': 0.97376543, 'precision': 0.8246781, 'recall': 0.727649, 'specificity': 0.727649, 'f1': 0.76689124, 'auroc': 0.96033, 'binary_precision': 0.66816145, 'binary_recall': 0.46345258, 'binary_specificity': 0.9918453, 'binary_f1_score': 0.54729116}
confusion matrix:
       0    1
0  18001  148
1    345  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7488945, 'recall': 0.5129097, 'specificity': 0.5129097, 'f1': 0.5149283, 'auroc': 0.9658817, 'binary_precision': 0.53846157, 'binary_recall': 0.026819924, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.05109489}
confusion matrix:
      0  1
0  5991  6
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_16.png
early stop counter: 7
val acc:0.9737654328346252, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 16,now: 2024-06-27 18:41:02.638991,epoch time: 0:33:15.719950,used: 8:23:19.253267,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9971424, 'precision': 0.9958229, 'recall': 0.9967226, 'specificity': 0.9967226, 'f1': 0.99627167, 'auroc': 0.9998687, 'binary_precision': 0.9930885, 'binary_recall': 0.99585515, 'binary_specificity': 0.99758995, 'binary_f1_score': 0.99446994}
confusion matrix:
       0      1
0  42221    102
1     61  14656
---- Validation: 
scalar performance:
{'acc': 0.97169006, 'precision': 0.78988606, 'recall': 0.76107705, 'specificity': 0.76107705, 'f1': 0.7746523, 'auroc': 0.9539984, 'binary_precision': 0.5961872, 'binary_recall': 0.5349922, 'binary_specificity': 0.9871618, 'binary_f1_score': 0.56393445}
confusion matrix:
       0    1
0  17916  233
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7582433, 'recall': 0.5573026, 'specificity': 0.5573026, 'f1': 0.5873401, 'auroc': 0.9393067, 'binary_precision': 0.5535714, 'binary_recall': 0.118773945, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.1955836}
confusion matrix:
      0   1
0  5972  25
1   230  31
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_17.png
early stop counter: 8
val acc:0.9716900587081909, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 17,now: 2024-06-27 19:10:43.857632,epoch time: 0:29:41.218641,used: 8:53:00.471908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99747545, 'precision': 0.99736404, 'recall': 0.9960387, 'specificity': 0.9960387, 'f1': 0.99669904, 'auroc': 0.99981415, 'binary_precision': 0.9971347, 'binary_recall': 0.9930697, 'binary_specificity': 0.9990076, 'binary_f1_score': 0.99509805}
confusion matrix:
       0      1
0  42280     42
1    102  14616
---- Validation: 
scalar performance:
{'acc': 0.9743508, 'precision': 0.8279036, 'recall': 0.73845273, 'specificity': 0.73845273, 'f1': 0.7754909, 'auroc': 0.96725255, 'binary_precision': 0.6738661, 'binary_recall': 0.4852255, 'binary_specificity': 0.99167997, 'binary_f1_score': 0.5641953}
confusion matrix:
       0    1
0  17998  151
1    331  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7740087, 'recall': 0.51857346, 'specificity': 0.51857346, 'f1': 0.5254303, 'auroc': 0.9628135, 'binary_precision': 0.5882353, 'binary_recall': 0.038314175, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.07194245}
confusion matrix:
      0   1
0  5990   7
1   251  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_18.png
early stop counter: 9
val acc:0.9743508100509644, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 18,now: 2024-06-27 19:36:00.588127,epoch time: 0:25:16.730495,used: 9:18:17.202403,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9972475, 'precision': 0.997701, 'recall': 0.9951086, 'specificity': 0.9951086, 'f1': 0.99639595, 'auroc': 0.99985397, 'binary_precision': 0.9986299, 'binary_recall': 0.99068975, 'binary_specificity': 0.99952745, 'binary_f1_score': 0.994644}
confusion matrix:
       0      1
0  42305     20
1    137  14578
---- Validation: 
scalar performance:
{'acc': 0.9724883, 'precision': 0.8370689, 'recall': 0.6707336, 'specificity': 0.6707336, 'f1': 0.7245092, 'auroc': 0.9545868, 'binary_precision': 0.696875, 'binary_recall': 0.34681183, 'binary_specificity': 0.9946554, 'binary_f1_score': 0.463136}
confusion matrix:
       0    1
0  18052   97
1    420  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.47911665, 'recall': 0.49924964, 'specificity': 0.49924964, 'f1': 0.48897603, 'auroc': 0.9305732, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5988  9
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_19.png
early stop counter: 10
val acc:0.972488284111023, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 19,now: 2024-06-27 19:58:48.535830,epoch time: 0:22:47.947703,used: 9:41:05.150106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9979488, 'precision': 0.99857664, 'recall': 0.9960688, 'specificity': 0.9960688, 'f1': 0.99731445, 'auroc': 0.9999331, 'binary_precision': 0.999863, 'binary_recall': 0.9921848, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9960092}
confusion matrix:
       0      1
0  42323      2
1    115  14600
---- Validation: 
scalar performance:
{'acc': 0.9688165, 'precision': 0.8817695, 'recall': 0.5593246, 'specificity': 0.5593246, 'f1': 0.59610164, 'auroc': 0.9575892, 'binary_precision': 0.7938144, 'binary_recall': 0.11975116, 'binary_specificity': 0.998898, 'binary_f1_score': 0.2081081}
confusion matrix:
       0   1
0  18129  20
1    566  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.47912, 'recall': 0.499333, 'specificity': 0.499333, 'f1': 0.48901772, 'auroc': 0.9287632, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5989  8
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_20.png
early stop counter: 11
val acc:0.9688165187835693, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 20,now: 2024-06-27 20:18:46.006893,epoch time: 0:19:57.471063,used: 10:01:02.621169,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9978086, 'precision': 0.998415, 'recall': 0.99586403, 'specificity': 0.99586403, 'f1': 0.99713093, 'auroc': 0.9999443, 'binary_precision': 0.9996576, 'binary_recall': 0.99184614, 'binary_specificity': 0.99988186, 'binary_f1_score': 0.99573654}
confusion matrix:
       0      1
0  42318      5
1    120  14597
---- Validation: 
scalar performance:
{'acc': 0.97451043, 'precision': 0.8338913, 'recall': 0.7310349, 'specificity': 0.7310349, 'f1': 0.77229357, 'auroc': 0.96507335, 'binary_precision': 0.68636364, 'binary_recall': 0.4696734, 'binary_specificity': 0.9923963, 'binary_f1_score': 0.55771005}
confusion matrix:
       0    1
0  18011  138
1    341  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.7757369, 'recall': 0.5427273, 'specificity': 0.5427273, 'f1': 0.5662705, 'auroc': 0.9617547, 'binary_precision': 0.5897436, 'binary_recall': 0.08812261, 'binary_specificity': 0.997332, 'binary_f1_score': 0.15333334}
confusion matrix:
      0   1
0  5981  16
1   238  23
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_21.png
early stop counter: 12
val acc:0.9745104312896729, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 21,now: 2024-06-27 20:39:33.322992,epoch time: 0:20:47.316099,used: 10:21:49.937268,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9979839, 'precision': 0.9986451, 'recall': 0.9960927, 'specificity': 0.9960927, 'f1': 0.99736035, 'auroc': 0.99994326, 'binary_precision': 1.0, 'binary_recall': 0.99218535, 'binary_specificity': 1.0, 'binary_f1_score': 0.99607736}
confusion matrix:
       0      1
0  42324      0
1    115  14601
---- Validation: 
scalar performance:
{'acc': 0.9690826, 'precision': 0.9498932, 'recall': 0.5519618, 'specificity': 0.5519618, 'f1': 0.58582705, 'auroc': 0.94864583, 'binary_precision': 0.9305556, 'binary_recall': 0.10419907, 'binary_specificity': 0.9997245, 'binary_f1_score': 0.18741259}
confusion matrix:
       0   1
0  18144   5
1    576  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.93743587, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_22.png
early stop counter: 13
val acc:0.9690825939178467, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 22,now: 2024-06-27 20:59:53.411477,epoch time: 0:20:20.088485,used: 10:42:10.025753,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9978086, 'precision': 0.9985275, 'recall': 0.99575377, 'specificity': 0.99575377, 'f1': 0.9971305, 'auroc': 0.99989724, 'binary_precision': 1.0, 'binary_recall': 0.9915076, 'binary_specificity': 1.0, 'binary_f1_score': 0.9957357}
confusion matrix:
       0      1
0  42321      0
1    125  14594
---- Validation: 
scalar performance:
{'acc': 0.9677522, 'precision': 0.95950395, 'recall': 0.5302715, 'specificity': 0.5302715, 'f1': 0.5488062, 'auroc': 0.9621902, 'binary_precision': 0.9512195, 'binary_recall': 0.060653187, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.11403509}
confusion matrix:
       0   1
0  18147   2
1    604  39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.9308704, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_23.png
early stop counter: 14
val acc:0.96775221824646, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 23,now: 2024-06-27 21:20:07.861416,epoch time: 0:20:14.449939,used: 11:02:24.475692,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9977034, 'precision': 0.998412, 'recall': 0.99559397, 'specificity': 0.99559397, 'f1': 0.99699247, 'auroc': 0.9999436, 'binary_precision': 0.9998629, 'binary_recall': 0.9912352, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9955303}
confusion matrix:
       0      1
0  42320      2
1    129  14589
---- Validation: 
scalar performance:
{'acc': 0.9645594, 'precision': 0.63586056, 'recall': 0.51286733, 'specificity': 0.51286733, 'f1': 0.51661223, 'auroc': 0.9361187, 'binary_precision': 0.30508474, 'binary_recall': 0.02799378, 'binary_specificity': 0.9977409, 'binary_f1_score': 0.051282052}
confusion matrix:
       0   1
0  18108  41
1    625  18
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95557684, 'precision': 0.4790899, 'recall': 0.49858263, 'specificity': 0.49858263, 'f1': 0.48864195, 'auroc': 0.89850724, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5980  17
1   261   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_24.png
early stop counter: 15
val acc:0.9645593762397766, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 24,now: 2024-06-27 21:40:05.950693,epoch time: 0:19:58.089277,used: 11:22:22.564969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9980189, 'precision': 0.99866855, 'recall': 0.99616086, 'specificity': 0.99616086, 'f1': 0.9974065, 'auroc': 0.9998701, 'binary_precision': 1.0, 'binary_recall': 0.9923218, 'binary_specificity': 1.0, 'binary_f1_score': 0.99614614}
confusion matrix:
       0      1
0  42323      0
1    113  14604
---- Validation: 
scalar performance:
{'acc': 0.96871006, 'precision': 0.96740997, 'recall': 0.54426837, 'specificity': 0.54426837, 'f1': 0.5732252, 'auroc': 0.9657303, 'binary_precision': 0.9661017, 'binary_recall': 0.08864697, 'binary_specificity': 0.9998898, 'binary_f1_score': 0.16239317}
confusion matrix:
       0   1
0  18147   2
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.95658815, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_25.png
early stop counter: 16
val acc:0.9687100648880005, best validation acc: 0.9771711230278015, corresponding to test acc:                         0.9635666608810425 / 0.9725151658058167
after epoch: 25,now: 2024-06-27 21:59:33.772531,epoch time: 0:19:27.821838,used: 11:41:50.386807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99863255, 'precision': 0.9986785, 'recall': 0.9977485, 'specificity': 0.9977485, 'f1': 0.99821234, 'auroc': 0.999893, 'binary_precision': 0.99877316, 'binary_recall': 0.99592227, 'binary_specificity': 0.9995747, 'binary_f1_score': 0.9973457}
confusion matrix:
       0      1
0  42308     18
1     60  14654
---- Validation: 
scalar performance:
{'acc': 0.9783418, 'precision': 0.9159236, 'recall': 0.72101754, 'specificity': 0.72101754, 'f1': 0.78657544, 'auroc': 0.9725613, 'binary_precision': 0.85119045, 'binary_recall': 0.44479004, 'binary_specificity': 0.997245, 'binary_f1_score': 0.58426964}
confusion matrix:
       0    1
0  18099   50
1    357  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96244806, 'precision': 0.8941661, 'recall': 0.56263477, 'specificity': 0.56263477, 'f1': 0.6000152, 'auroc': 0.96469337, 'binary_precision': 0.825, 'binary_recall': 0.12643678, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.21926911}
confusion matrix:
      0   1
0  5990   7
1   228  33
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_26.png
better model found
persisted
after epoch: 26,now: 2024-06-27 22:19:26.301805,epoch time: 0:19:52.529274,used: 12:01:42.916081,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9978787, 'precision': 0.9978585, 'recall': 0.996598, 'specificity': 0.996598, 'f1': 0.9972262, 'auroc': 0.99982107, 'binary_precision': 0.99781704, 'binary_recall': 0.99395216, 'binary_specificity': 0.9992439, 'binary_f1_score': 0.99588084}
confusion matrix:
       0      1
0  42292     32
1     89  14627
---- Validation: 
scalar performance:
{'acc': 0.97195613, 'precision': 0.7875606, 'recall': 0.78971684, 'specificity': 0.78971684, 'f1': 0.7886343, 'auroc': 0.9653605, 'binary_precision': 0.58950615, 'binary_recall': 0.5940902, 'binary_specificity': 0.9853435, 'binary_f1_score': 0.5917893}
confusion matrix:
       0    1
0  17883  266
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9600511, 'precision': 0.84050703, 'recall': 0.5338991, 'specificity': 0.5338991, 'f1': 0.5527163, 'auroc': 0.95346636, 'binary_precision': 0.72, 'binary_recall': 0.06896552, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.12587413}
confusion matrix:
      0   1
0  5990   7
1   243  18
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_27.png
early stop counter: 1
val acc:0.9719561338424683, best validation acc: 0.978341817855835, corresponding to test acc:                         0.9624480605125427 / 0.9725151658058167
after epoch: 27,now: 2024-06-27 22:39:09.762935,epoch time: 0:19:43.461130,used: 12:21:26.377211,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99803644, 'precision': 0.99868035, 'recall': 0.99619484, 'specificity': 0.99619484, 'f1': 0.9974295, 'auroc': 0.9998536, 'binary_precision': 1.0, 'binary_recall': 0.99238974, 'binary_specificity': 1.0, 'binary_f1_score': 0.99618036}
confusion matrix:
       0      1
0  42323      0
1    112  14605
---- Validation: 
scalar performance:
{'acc': 0.9678587, 'precision': 0.91136837, 'recall': 0.53632706, 'specificity': 0.53632706, 'f1': 0.55914783, 'auroc': 0.96157646, 'binary_precision': 0.8545455, 'binary_recall': 0.07309487, 'binary_specificity': 0.9995592, 'binary_f1_score': 0.1346705}
confusion matrix:
       0   1
0  18141   8
1    596  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.47914, 'recall': 0.49983326, 'specificity': 0.49983326, 'f1': 0.48926792, 'auroc': 0.9586383, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5995  2
1   261  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_28.png
early stop counter: 2
val acc:0.9678586721420288, best validation acc: 0.978341817855835, corresponding to test acc:                         0.9624480605125427 / 0.9725151658058167
after epoch: 28,now: 2024-06-27 22:58:32.389081,epoch time: 0:19:22.626146,used: 12:40:49.003357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99815917, 'precision': 0.99747545, 'recall': 0.9977179, 'specificity': 0.9977179, 'f1': 0.9975966, 'auroc': 0.9998704, 'binary_precision': 0.9960617, 'binary_recall': 0.9968062, 'binary_specificity': 0.9986296, 'binary_f1_score': 0.9964338}
confusion matrix:
       0      1
0  42266     58
1     47  14669
---- Validation: 
scalar performance:
{'acc': 0.96961474, 'precision': 0.7813558, 'recall': 0.6894974, 'specificity': 0.6894974, 'f1': 0.7256076, 'auroc': 0.94742143, 'binary_precision': 0.58411217, 'binary_recall': 0.3888025, 'binary_specificity': 0.9901923, 'binary_f1_score': 0.4668534}
confusion matrix:
       0    1
0  17971  178
1    393  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9506232, 'precision': 0.54783297, 'recall': 0.512489, 'specificity': 0.512489, 'f1': 0.5148476, 'auroc': 0.8921637, 'binary_precision': 0.13636364, 'binary_recall': 0.03448276, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.055045873}
confusion matrix:
      0   1
0  5940  57
1   252   9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_29.png
early stop counter: 3
val acc:0.9696147441864014, best validation acc: 0.978341817855835, corresponding to test acc:                         0.9624480605125427 / 0.9725151658058167
after epoch: 29,now: 2024-06-27 23:17:58.094337,epoch time: 0:19:25.705256,used: 13:00:14.708613,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99796635, 'precision': 0.99863327, 'recall': 0.99605924, 'specificity': 0.99605924, 'f1': 0.9973376, 'auroc': 0.9999108, 'binary_precision': 1.0, 'binary_recall': 0.9921185, 'binary_specificity': 1.0, 'binary_f1_score': 0.9960436}
confusion matrix:
       0      1
0  42322      0
1    116  14602
---- Validation: 
scalar performance:
{'acc': 0.97020006, 'precision': 0.9069999, 'recall': 0.5787923, 'specificity': 0.5787923, 'f1': 0.6259033, 'auroc': 0.96744406, 'binary_precision': 0.8429752, 'binary_recall': 0.15863141, 'binary_specificity': 0.9989531, 'binary_f1_score': 0.26701573}
confusion matrix:
       0    1
0  18130   19
1    541  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.8296735, 'recall': 0.5131598, 'specificity': 0.5131598, 'f1': 0.51533616, 'auroc': 0.9543731, 'binary_precision': 0.7, 'binary_recall': 0.026819924, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.05166052}
confusion matrix:
      0  1
0  5994  3
1   254  7
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_30.png
early stop counter: 4
val acc:0.9702000617980957, best validation acc: 0.978341817855835, corresponding to test acc:                         0.9624480605125427 / 0.9725151658058167
after epoch: 30,now: 2024-06-27 23:37:29.012623,epoch time: 0:19:30.918286,used: 13:19:45.626899,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_10_17_43_seed_0_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:19:45.626899 at 2024-06-27 23:37:29.012623
persisted model performance metric: 

scalar performance:
{'acc': 0.96244806, 'precision': 0.8941661, 'recall': 0.56263477, 'specificity': 0.56263477, 'f1': 0.6000152, 'auroc': 0.96469337, 'binary_precision': 0.825, 'binary_recall': 0.12643678, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.21926911}
confusion matrix:
      0   1
0  5990   7
1   228  33
oracle model performance metric: 

scalar performance:
{'acc': 0.97251517, 'precision': 0.8916701, 'recall': 0.7218034, 'specificity': 0.7218034, 'f1': 0.7810757, 'auroc': 0.9472164, 'binary_precision': 0.80689657, 'binary_recall': 0.44827586, 'binary_specificity': 0.995331, 'binary_f1_score': 0.5763546}
confusion matrix:
      0    1
0  5969   28
1   144  117
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456549 KiB |  13219 MiB |   1470 TiB |   1470 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1454 TiB |   1454 TiB |
|       from small pool |  41687 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456549 KiB |  13219 MiB |   1470 TiB |   1470 TiB |
|       from large pool | 414861 KiB |  13181 MiB |   1454 TiB |   1454 TiB |
|       from small pool |  41687 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |  13213 MiB |   1462 TiB |   1462 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1445 TiB |   1445 TiB |
|       from small pool |  40679 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14484 MiB |  14484 MiB |  14484 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446619 KiB |   1251 MiB |   1033 TiB |   1033 TiB |
|       from large pool | 435058 KiB |   1243 MiB |   1017 TiB |   1017 TiB |
|       from small pool |  11560 KiB |     17 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8135    |  253134 K  |  253131 K  |
|       from large pool |     187    |    1413    |  133286 K  |  133286 K  |
|       from small pool |    3301    |    7946    |  119848 K  |  119845 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8135    |  253134 K  |  253131 K  |
|       from large pool |     187    |    1413    |  133286 K  |  133286 K  |
|       from small pool |    3301    |    7946    |  119848 K  |  119845 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |     636    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      82    |    3626    |  166099 K  |  166099 K  |
|       from large pool |      37    |     600    |   99904 K  |   99904 K  |
|       from small pool |      45    |    3588    |   66194 K  |   66194 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1470 TiB |   1470 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1470 TiB |   1470 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1462 TiB |   1462 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  14484 MiB |  13602 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1033 TiB |   1033 TiB |
|       from large pool |  24320 KiB |   1243 MiB |   1017 TiB |   1017 TiB |
|       from small pool |      0 KiB |     44 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133286 K  |  133286 K  |
|       from small pool |       0    |    7946    |  119848 K  |  119848 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133286 K  |  133286 K  |
|       from small pool |       0    |    7946    |  119848 K  |  119848 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |     636    |     573    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3626    |  166100 K  |  166100 K  |
|       from large pool |       4    |     600    |   99904 K  |   99904 K  |
|       from small pool |       0    |    3588    |   66195 K  |   66195 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1470 TiB |   1470 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1470 TiB |   1470 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1454 TiB |   1454 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1462 TiB |   1462 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1445 TiB |   1445 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  14484 MiB |  13602 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     70 MiB |     70 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   1033 TiB |   1033 TiB |
|       from large pool |  24320 KiB |   1243 MiB |   1017 TiB |   1017 TiB |
|       from small pool |      0 KiB |     44 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133286 K  |  133286 K  |
|       from small pool |       0    |    7946    |  119848 K  |  119848 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  253134 K  |  253134 K  |
|       from large pool |       2    |    1413    |  133286 K  |  133286 K  |
|       from small pool |       0    |    7946    |  119848 K  |  119848 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |     636    |     573    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      35    |      35    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3626    |  166100 K  |  166100 K  |
|       from large pool |       4    |     600    |   99904 K  |   99904 K  |
|       from small pool |       0    |    3588    |   66195 K  |   66195 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853

 Experiment start at: 2024-06-27 23:43:32.224683
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98453337, 'precision': 0.9886715, 'recall': 0.9705742, 'specificity': 0.9705742, 'f1': 0.9791995, 'auroc': 0.9986241, 'binary_precision': 0.99662584, 'binary_recall': 0.942233, 'binary_specificity': 0.9989154, 'binary_f1_score': 0.96866643}
confusion matrix:
       0      1
0  42366     46
1    833  13587
---- Validation: 
scalar performance:
{'acc': 0.9669691, 'precision': 0.7703711, 'recall': 0.6702975, 'specificity': 0.6702975, 'f1': 0.70781, 'auroc': 0.9412511, 'binary_precision': 0.5645933, 'binary_recall': 0.35066864, 'binary_specificity': 0.9899264, 'binary_f1_score': 0.4326306}
confusion matrix:
       0    1
0  17885  182
1    437  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96728975, 'precision': 0.9530282, 'recall': 0.6169714, 'specificity': 0.6169714, 'f1': 0.6792949, 'auroc': 0.933125, 'binary_precision': 0.93846154, 'binary_recall': 0.23461539, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.37538463}
confusion matrix:
      0   1
0  5942   4
1   199  61
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-28 00:03:04.971126,epoch time: 0:19:32.746443,used: 0:19:32.746443,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98984724, 'precision': 0.9833502, 'recall': 0.990154, 'specificity': 0.990154, 'f1': 0.9866896, 'auroc': 0.99929976, 'binary_precision': 0.9698595, 'binary_recall': 0.9907767, 'binary_specificity': 0.9895313, 'binary_f1_score': 0.98020655}
confusion matrix:
       0      1
0  41968    444
1    133  14287
---- Validation: 
scalar performance:
{'acc': 0.9533084, 'precision': 0.692414, 'recall': 0.78337765, 'specificity': 0.78337765, 'f1': 0.7278258, 'auroc': 0.9238068, 'binary_precision': 0.4, 'binary_recall': 0.60029715, 'binary_specificity': 0.9664582, 'binary_f1_score': 0.48009503}
confusion matrix:
       0    1
0  17461  606
1    269  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96374476, 'precision': 0.77943075, 'recall': 0.73281646, 'specificity': 0.73281646, 'f1': 0.7537334, 'auroc': 0.91281796, 'binary_precision': 0.5813953, 'binary_recall': 0.48076922, 'binary_specificity': 0.98486376, 'binary_f1_score': 0.52631575}
confusion matrix:
      0    1
0  5856   90
1   135  125
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_2.png
early stop counter: 1
val acc:0.9533084034919739, best validation acc: 0.9669690728187561, corresponding to test acc:                         0.9672897458076477 / 0.9672897458076477
after epoch: 2,now: 2024-06-28 00:22:21.960307,epoch time: 0:19:16.989181,used: 0:38:49.735624,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99560106, 'precision': 0.9969516, 'recall': 0.9914459, 'specificity': 0.9914459, 'f1': 0.9941598, 'auroc': 0.99974275, 'binary_precision': 0.9996474, 'binary_recall': 0.9830097, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.99125874}
confusion matrix:
       0      1
0  42407      5
1    245  14175
---- Validation: 
scalar performance:
{'acc': 0.96921027, 'precision': 0.81023407, 'recall': 0.65500873, 'specificity': 0.65500873, 'f1': 0.7044538, 'auroc': 0.9547075, 'binary_precision': 0.6454545, 'binary_recall': 0.3164933, 'binary_specificity': 0.99352413, 'binary_f1_score': 0.4247258}
confusion matrix:
       0    1
0  17950  117
1    460  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.72912633, 'recall': 0.501839, 'specificity': 0.501839, 'f1': 0.49311718, 'auroc': 0.9341991, 'binary_precision': 0.5, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0076335873}
confusion matrix:
      0  1
0  5945  1
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_3.png
better model found
persisted
after epoch: 3,now: 2024-06-28 00:41:30.917295,epoch time: 0:19:08.956988,used: 0:57:58.692612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9964809, 'precision': 0.9975122, 'recall': 0.99320203, 'specificity': 0.99320203, 'f1': 0.9953333, 'auroc': 0.9997941, 'binary_precision': 0.99957836, 'binary_recall': 0.9865455, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.99301916}
confusion matrix:
       0      1
0  42407      6
1    194  14225
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.8849105, 'recall': 0.54196024, 'specificity': 0.54196024, 'f1': 0.5680382, 'auroc': 0.94690615, 'binary_precision': 0.8028169, 'binary_recall': 0.08469539, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.1532258}
confusion matrix:
       0   1
0  18053  14
1    616  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.9792069, 'recall': 0.50384617, 'specificity': 0.50384617, 'f1': 0.4970163, 'auroc': 0.94283926, 'binary_precision': 1.0, 'binary_recall': 0.0076923077, 'binary_specificity': 1.0, 'binary_f1_score': 0.015267175}
confusion matrix:
      0  1
0  5946  0
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_4.png
early stop counter: 1
val acc:0.9663820862770081, best validation acc: 0.9692102670669556, corresponding to test acc:                         0.9581050872802734 / 0.9672897458076477
after epoch: 4,now: 2024-06-28 01:00:58.194891,epoch time: 0:19:27.277596,used: 1:17:25.970208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9931729, 'precision': 0.9952265, 'recall': 0.9867726, 'specificity': 0.9867726, 'f1': 0.9909078, 'auroc': 0.99947155, 'binary_precision': 0.9992882, 'binary_recall': 0.97378093, 'binary_specificity': 0.99976426, 'binary_f1_score': 0.98636967}
confusion matrix:
       0      1
0  42405     10
1    378  14039
---- Validation: 
scalar performance:
{'acc': 0.9640875, 'precision': 0.7322917, 'recall': 0.5071527, 'specificity': 0.5071527, 'f1': 0.50528276, 'auroc': 0.9448745, 'binary_precision': 0.5, 'binary_recall': 0.014858841, 'binary_specificity': 0.9994465, 'binary_f1_score': 0.028860029}
confusion matrix:
       0   1
0  18057  10
1    663  10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.479039, 'recall': 0.49966365, 'specificity': 0.49966365, 'f1': 0.489134, 'auroc': 0.9396619, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5942  4
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_5.png
early stop counter: 2
val acc:0.9640874862670898, best validation acc: 0.9692102670669556, corresponding to test acc:                         0.9581050872802734 / 0.9672897458076477
after epoch: 5,now: 2024-06-28 01:20:28.803726,epoch time: 0:19:30.608835,used: 1:36:56.579043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9937183, 'precision': 0.99147415, 'recall': 0.9919463, 'specificity': 0.9919463, 'f1': 0.99170995, 'auroc': 0.99948573, 'binary_precision': 0.98691136, 'binary_recall': 0.9883487, 'binary_specificity': 0.99554384, 'binary_f1_score': 0.9876296}
confusion matrix:
       0      1
0  42224    189
1    168  14251
---- Validation: 
scalar performance:
{'acc': 0.9578442, 'precision': 0.716747, 'recall': 0.8343682, 'specificity': 0.8343682, 'f1': 0.76115286, 'auroc': 0.9526582, 'binary_precision': 0.44486335, 'binary_recall': 0.7013373, 'binary_specificity': 0.9673991, 'binary_f1_score': 0.544406}
confusion matrix:
       0    1
0  17478  589
1    201  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9590719, 'precision': 0.7523316, 'recall': 0.574064, 'specificity': 0.574064, 'f1': 0.60924554, 'auroc': 0.90933996, 'binary_precision': 0.5405405, 'binary_recall': 0.15384616, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.23952097}
confusion matrix:
      0   1
0  5912  34
1   220  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_6.png
early stop counter: 3
val acc:0.9578441977500916, best validation acc: 0.9692102670669556, corresponding to test acc:                         0.9581050872802734 / 0.9672897458076477
after epoch: 6,now: 2024-06-28 01:39:48.909841,epoch time: 0:19:20.106115,used: 1:56:16.685158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9965512, 'precision': 0.9954464, 'recall': 0.9954464, 'specificity': 0.9954464, 'f1': 0.9954464, 'auroc': 0.99971354, 'binary_precision': 0.9932034, 'binary_recall': 0.9932034, 'binary_specificity': 0.99768937, 'binary_f1_score': 0.9932034}
confusion matrix:
       0      1
0  42315     98
1     98  14321
---- Validation: 
scalar performance:
{'acc': 0.93991464, 'precision': 0.6629942, 'recall': 0.8243542, 'specificity': 0.8243542, 'f1': 0.7118577, 'auroc': 0.9382839, 'binary_precision': 0.3376344, 'binary_recall': 0.6998514, 'binary_specificity': 0.948857, 'binary_f1_score': 0.45551255}
confusion matrix:
       0    1
0  17143  924
1    202  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9087979, 'precision': 0.50706017, 'recall': 0.50920916, 'specificity': 0.50920916, 'f1': 0.50749016, 'auroc': 0.8170536, 'binary_precision': 0.05523256, 'binary_recall': 0.073076926, 'binary_specificity': 0.9453414, 'binary_f1_score': 0.0629139}
confusion matrix:
      0    1
0  5621  325
1   241   19
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_7.png
early stop counter: 4
val acc:0.9399146437644958, best validation acc: 0.9692102670669556, corresponding to test acc:                         0.9581050872802734 / 0.9672897458076477
after epoch: 7,now: 2024-06-28 01:58:52.614278,epoch time: 0:19:03.704437,used: 2:15:20.389595,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9969735, 'precision': 0.995355, 'recall': 0.9966676, 'specificity': 0.9966676, 'f1': 0.9960091, 'auroc': 0.9998053, 'binary_precision': 0.99205583, 'binary_recall': 0.9960466, 'binary_specificity': 0.99728864, 'binary_f1_score': 0.9940472}
confusion matrix:
       0      1
0  42299    115
1     57  14361
---- Validation: 
scalar performance:
{'acc': 0.97065103, 'precision': 0.78178203, 'recall': 0.8417254, 'specificity': 0.8417254, 'f1': 0.80853415, 'auroc': 0.9607332, 'binary_precision': 0.5747266, 'binary_recall': 0.70282316, 'binary_specificity': 0.98062766, 'binary_f1_score': 0.6323529}
confusion matrix:
       0    1
0  17717  350
1    200  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9518208, 'precision': 0.5644107, 'recall': 0.5151104, 'specificity': 0.5151104, 'f1': 0.51898545, 'auroc': 0.92069393, 'binary_precision': 0.16949153, 'binary_recall': 0.03846154, 'binary_specificity': 0.9917592, 'binary_f1_score': 0.06269593}
confusion matrix:
      0   1
0  5897  49
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_8.png
better model found
persisted
after epoch: 8,now: 2024-06-28 02:17:59.186563,epoch time: 0:19:06.572285,used: 2:34:26.961880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9971143, 'precision': 0.9975846, 'recall': 0.99479365, 'specificity': 0.99479365, 'f1': 0.99617916, 'auroc': 0.99975944, 'binary_precision': 0.99853116, 'binary_recall': 0.9900825, 'binary_specificity': 0.99950486, 'binary_f1_score': 0.99428886}
confusion matrix:
       0      1
0  42392     21
1    143  14276
---- Validation: 
scalar performance:
{'acc': 0.96921027, 'precision': 0.88912916, 'recall': 0.5927805, 'specificity': 0.5927805, 'f1': 0.6441188, 'auroc': 0.9490257, 'binary_precision': 0.8076923, 'binary_recall': 0.1872214, 'binary_specificity': 0.99833953, 'binary_f1_score': 0.3039807}
confusion matrix:
       0    1
0  18037   30
1    547  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.56244624, 'recall': 0.50150263, 'specificity': 0.50150263, 'f1': 0.4928916, 'auroc': 0.9044204, 'binary_precision': 0.16666667, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.007518797}
confusion matrix:
      0  1
0  5941  5
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_9.png
early stop counter: 1
val acc:0.9692102670669556, best validation acc: 0.9706510305404663, corresponding to test acc:                         0.9518207907676697 / 0.9672897458076477
after epoch: 9,now: 2024-06-28 02:37:08.910802,epoch time: 0:19:09.724239,used: 2:53:36.686119,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9924514, 'precision': 0.98835987, 'recall': 0.9918065, 'specificity': 0.9918065, 'f1': 0.9900674, 'auroc': 0.9994671, 'binary_precision': 0.9799616, 'binary_recall': 0.99049735, 'binary_specificity': 0.99311566, 'binary_f1_score': 0.9852013}
confusion matrix:
       0      1
0  42123    292
1    137  14280
---- Validation: 
scalar performance:
{'acc': 0.9596051, 'precision': 0.7276399, 'recall': 0.87748224, 'specificity': 0.87748224, 'f1': 0.7813048, 'auroc': 0.95848036, 'binary_precision': 0.46335077, 'binary_recall': 0.78900445, 'binary_specificity': 0.96596, 'binary_f1_score': 0.5838373}
confusion matrix:
       0    1
0  17452  615
1    142  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643893, 'precision': 0.77713203, 'recall': 0.78832245, 'specificity': 0.78832245, 'f1': 0.7826015, 'auroc': 0.9183148, 'binary_precision': 0.57195574, 'binary_recall': 0.59615386, 'binary_specificity': 0.9804911, 'binary_f1_score': 0.58380413}
confusion matrix:
      0    1
0  5830  116
1   105  155
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_10.png
early stop counter: 2
val acc:0.9596050977706909, best validation acc: 0.9706510305404663, corresponding to test acc:                         0.9518207907676697 / 0.9672897458076477
after epoch: 10,now: 2024-06-28 02:56:16.322734,epoch time: 0:19:07.411932,used: 3:12:44.098051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9964809, 'precision': 0.99730146, 'recall': 0.99340796, 'specificity': 0.99340796, 'f1': 0.9953353, 'auroc': 0.99961936, 'binary_precision': 0.9989473, 'binary_recall': 0.9871697, 'binary_specificity': 0.9996463, 'binary_f1_score': 0.99302363}
confusion matrix:
       0      1
0  42398     15
1    185  14234
---- Validation: 
scalar performance:
{'acc': 0.9763074, 'precision': 0.84307563, 'recall': 0.79172915, 'specificity': 0.79172915, 'f1': 0.8151299, 'auroc': 0.9610876, 'binary_precision': 0.7012302, 'binary_recall': 0.59286773, 'binary_specificity': 0.9905906, 'binary_f1_score': 0.6425121}
confusion matrix:
       0    1
0  17897  170
1    274  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.9443406, 'recall': 0.5249159, 'specificity': 0.5249159, 'f1': 0.5372294, 'auroc': 0.95091593, 'binary_precision': 0.9285714, 'binary_recall': 0.05, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.09489051}
confusion matrix:
      0   1
0  5945   1
1   247  13
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_11.png
better model found
persisted
after epoch: 11,now: 2024-06-28 03:15:28.446623,epoch time: 0:19:12.123889,used: 3:31:56.221940,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9972551, 'precision': 0.99726355, 'recall': 0.9954831, 'specificity': 0.9954831, 'f1': 0.99636924, 'auroc': 0.9998176, 'binary_precision': 0.99728054, 'binary_recall': 0.9918857, 'binary_specificity': 0.9990805, 'binary_f1_score': 0.9945758}
confusion matrix:
       0      1
0  42374     39
1    117  14302
---- Validation: 
scalar performance:
{'acc': 0.9649413, 'precision': 0.7466792, 'recall': 0.6792596, 'specificity': 0.6792596, 'f1': 0.7070322, 'auroc': 0.9421279, 'binary_precision': 0.5165289, 'binary_recall': 0.37147102, 'binary_specificity': 0.9870482, 'binary_f1_score': 0.43215212}
confusion matrix:
       0    1
0  17833  234
1    423  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92893976, 'precision': 0.5567088, 'recall': 0.5565002, 'specificity': 0.5565002, 'f1': 0.5566042, 'auroc': 0.8940923, 'binary_precision': 0.15057915, 'binary_recall': 0.15, 'binary_specificity': 0.96300036, 'binary_f1_score': 0.15028903}
confusion matrix:
      0    1
0  5726  220
1   221   39
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_12.png
early stop counter: 1
val acc:0.9649413228034973, best validation acc: 0.9763073921203613, corresponding to test acc:                         0.9600386619567871 / 0.9672897458076477
after epoch: 12,now: 2024-06-28 03:34:36.539257,epoch time: 0:19:08.092634,used: 3:51:04.314574,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99736065, 'precision': 0.99733454, 'recall': 0.9956914, 'specificity': 0.9956914, 'f1': 0.9965095, 'auroc': 0.9998504, 'binary_precision': 0.99728185, 'binary_recall': 0.99230236, 'binary_specificity': 0.9990804, 'binary_f1_score': 0.99478585}
confusion matrix:
       0      1
0  42373     39
1    111  14309
---- Validation: 
scalar performance:
{'acc': 0.97620064, 'precision': 0.86359715, 'recall': 0.7530494, 'specificity': 0.7530494, 'f1': 0.79756135, 'auroc': 0.96300006, 'binary_precision': 0.7451404, 'binary_recall': 0.51263, 'binary_specificity': 0.99346876, 'binary_f1_score': 0.6073944}
confusion matrix:
       0    1
0  17949  118
1    328  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.73189235, 'recall': 0.5698815, 'specificity': 0.5698815, 'f1': 0.6023301, 'auroc': 0.9371666, 'binary_precision': 0.5, 'binary_recall': 0.14615385, 'binary_specificity': 0.99360913, 'binary_f1_score': 0.22619048}
confusion matrix:
      0   1
0  5908  38
1   222  38
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_13.png
early stop counter: 2
val acc:0.9762006402015686, best validation acc: 0.9763073921203613, corresponding to test acc:                         0.9600386619567871 / 0.9672897458076477
after epoch: 13,now: 2024-06-28 03:53:50.418425,epoch time: 0:19:13.879168,used: 4:10:18.193742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9940878, 'precision': 0.99533165, 'recall': 0.9890582, 'specificity': 0.9890582, 'f1': 0.9921443, 'auroc': 0.9994582, 'binary_precision': 0.9978084, 'binary_recall': 0.9788473, 'binary_specificity': 0.99926907, 'binary_f1_score': 0.9882369}
confusion matrix:
       0      1
0  42382     31
1    305  14114
---- Validation: 
scalar performance:
{'acc': 0.9700107, 'precision': 0.86187696, 'recall': 0.62180626, 'specificity': 0.62180626, 'f1': 0.67800176, 'auroc': 0.9671678, 'binary_precision': 0.75113124, 'binary_recall': 0.24665676, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.37136462}
confusion matrix:
       0    1
0  18012   55
1    507  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.955526, 'recall': 0.5690626, 'specificity': 0.5690626, 'f1': 0.6114774, 'auroc': 0.94365084, 'binary_precision': 0.94736844, 'binary_recall': 0.13846155, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.24161077}
confusion matrix:
      0   1
0  5944   2
1   224  36
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_14.png
early stop counter: 3
val acc:0.9700106978416443, best validation acc: 0.9763073921203613, corresponding to test acc:                         0.9600386619567871 / 0.9672897458076477
after epoch: 14,now: 2024-06-28 04:12:58.495158,epoch time: 0:19:08.076733,used: 4:29:26.270475,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99158925, 'precision': 0.9942812, 'recall': 0.983562, 'specificity': 0.983562, 'f1': 0.98877406, 'auroc': 0.9994508, 'binary_precision': 0.99957, 'binary_recall': 0.9672654, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.9831524}
confusion matrix:
       0      1
0  42407      6
1    472  13947
---- Validation: 
scalar performance:
{'acc': 0.9696905, 'precision': 0.9324815, 'recall': 0.58802265, 'specificity': 0.58802265, 'f1': 0.6398988, 'auroc': 0.95562637, 'binary_precision': 0.8947368, 'binary_recall': 0.1768202, 'binary_specificity': 0.9992251, 'binary_f1_score': 0.29528534}
confusion matrix:
       0    1
0  18053   14
1    554  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581051, 'precision': 0.47905254, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4893022, 'auroc': 0.94234097, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5946  0
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_15.png
early stop counter: 4
val acc:0.9696905016899109, best validation acc: 0.9763073921203613, corresponding to test acc:                         0.9600386619567871 / 0.9672897458076477
after epoch: 15,now: 2024-06-28 04:31:58.224001,epoch time: 0:18:59.728843,used: 4:48:25.999318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9976246, 'precision': 0.99822724, 'recall': 0.99550176, 'specificity': 0.99550176, 'f1': 0.996855, 'auroc': 0.9999174, 'binary_precision': 0.99944055, 'binary_recall': 0.99119216, 'binary_specificity': 0.99981135, 'binary_f1_score': 0.9952993}
confusion matrix:
       0      1
0  42405      8
1    127  14292
---- Validation: 
scalar performance:
{'acc': 0.9767876, 'precision': 0.88697934, 'recall': 0.73690265, 'specificity': 0.73690265, 'f1': 0.79244936, 'auroc': 0.9656625, 'binary_precision': 0.79310346, 'binary_recall': 0.47845468, 'binary_specificity': 0.99535066, 'binary_f1_score': 0.5968489}
confusion matrix:
       0    1
0  17983   84
1    351  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.95707166, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_16.png
better model found
persisted
after epoch: 16,now: 2024-06-28 04:51:04.676203,epoch time: 0:19:06.452202,used: 5:07:32.451520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99602336, 'precision': 0.99412614, 'recall': 0.9953903, 'specificity': 0.9953903, 'f1': 0.9947561, 'auroc': 0.99982977, 'binary_precision': 0.99025905, 'binary_recall': 0.994105, 'binary_specificity': 0.99667555, 'binary_f1_score': 0.99217826}
confusion matrix:
       0      1
0  42272    141
1     85  14334
---- Validation: 
scalar performance:
{'acc': 0.96526146, 'precision': 0.74926496, 'recall': 0.7666882, 'specificity': 0.7666882, 'f1': 0.7576463, 'auroc': 0.95060384, 'binary_precision': 0.5152355, 'binary_recall': 0.55274886, 'binary_specificity': 0.98062766, 'binary_f1_score': 0.5333333}
confusion matrix:
       0    1
0  17717  350
1    301  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9648727, 'precision': 0.86188287, 'recall': 0.61754894, 'specificity': 0.61754894, 'f1': 0.67225593, 'auroc': 0.9538755, 'binary_precision': 0.75609756, 'binary_recall': 0.23846154, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.36257312}
confusion matrix:
      0   1
0  5926  20
1   198  62
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_17.png
early stop counter: 1
val acc:0.9652614593505859, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9582661986351013 / 0.9672897458076477
after epoch: 17,now: 2024-06-28 05:10:09.034261,epoch time: 0:19:04.358058,used: 5:26:36.809578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99707913, 'precision': 0.9975147, 'recall': 0.9947701, 'specificity': 0.9947701, 'f1': 0.99613273, 'auroc': 0.9998143, 'binary_precision': 0.9983915, 'binary_recall': 0.9900825, 'binary_specificity': 0.9994577, 'binary_f1_score': 0.99421966}
confusion matrix:
       0      1
0  42390     23
1    143  14276
---- Validation: 
scalar performance:
{'acc': 0.96755606, 'precision': 0.787593, 'recall': 0.63984543, 'specificity': 0.63984543, 'f1': 0.68583304, 'auroc': 0.9413287, 'binary_precision': 0.6012461, 'binary_recall': 0.28677562, 'binary_specificity': 0.9929153, 'binary_f1_score': 0.38832998}
confusion matrix:
       0    1
0  17939  128
1    480  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.60418683, 'recall': 0.5033416, 'specificity': 0.5033416, 'f1': 0.49659312, 'auroc': 0.9453112, 'binary_precision': 0.25, 'binary_recall': 0.0076923077, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.014925373}
confusion matrix:
      0  1
0  5940  6
1   258  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_18.png
early stop counter: 2
val acc:0.9675560593605042, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9582661986351013 / 0.9672897458076477
after epoch: 18,now: 2024-06-28 05:29:11.191803,epoch time: 0:19:02.157542,used: 5:45:38.967120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9979413, 'precision': 0.9976797, 'recall': 0.99688137, 'specificity': 0.99688137, 'f1': 0.9972797, 'auroc': 0.99990654, 'binary_precision': 0.9971498, 'binary_recall': 0.9947295, 'binary_specificity': 0.9990333, 'binary_f1_score': 0.9959382}
confusion matrix:
       0      1
0  42371     41
1     76  14344
---- Validation: 
scalar performance:
{'acc': 0.93927425, 'precision': 0.6635576, 'recall': 0.8340359, 'specificity': 0.8340359, 'f1': 0.71398973, 'auroc': 0.9203862, 'binary_precision': 0.3379791, 'binary_recall': 0.7206538, 'binary_specificity': 0.9474179, 'binary_f1_score': 0.46015182}
confusion matrix:
       0    1
0  17117  950
1    188  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94875926, 'precision': 0.56894124, 'recall': 0.52454656, 'specificity': 0.52454656, 'f1': 0.5325324, 'auroc': 0.8934366, 'binary_precision': 0.17777778, 'binary_recall': 0.06153846, 'binary_specificity': 0.98755467, 'binary_f1_score': 0.09142857}
confusion matrix:
      0   1
0  5872  74
1   244  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_19.png
early stop counter: 3
val acc:0.939274251461029, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9582661986351013 / 0.9672897458076477
after epoch: 19,now: 2024-06-28 05:48:12.958620,epoch time: 0:19:01.766817,used: 6:04:40.733937,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9965512, 'precision': 0.9977, 'recall': 0.9932034, 'specificity': 0.9932034, 'f1': 0.9954258, 'auroc': 0.9998868, 'binary_precision': 1.0, 'binary_recall': 0.9864068, 'binary_specificity': 1.0, 'binary_f1_score': 0.9931569}
confusion matrix:
       0      1
0  42413      0
1    196  14223
---- Validation: 
scalar performance:
{'acc': 0.9653148, 'precision': 0.9826361, 'recall': 0.51708764, 'specificity': 0.51708764, 'f1': 0.5242106, 'auroc': 0.9670564, 'binary_precision': 1.0, 'binary_recall': 0.034175333, 'binary_specificity': 1.0, 'binary_f1_score': 0.066091955}
confusion matrix:
       0   1
0  18067   0
1    650  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.94332695, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_20.png
early stop counter: 4
val acc:0.9653148055076599, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9582661986351013 / 0.9672897458076477
after epoch: 20,now: 2024-06-28 06:07:16.021891,epoch time: 0:19:03.063271,used: 6:23:43.797208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9980117, 'precision': 0.9982315, 'recall': 0.9965162, 'specificity': 0.9965162, 'f1': 0.99737, 'auroc': 0.9998913, 'binary_precision': 0.9986753, 'binary_recall': 0.9934804, 'binary_specificity': 0.999552, 'binary_f1_score': 0.99607104}
confusion matrix:
       0      1
0  42395     19
1     94  14324
---- Validation: 
scalar performance:
{'acc': 0.97113127, 'precision': 0.80669343, 'recall': 0.728247, 'specificity': 0.728247, 'f1': 0.76115614, 'auroc': 0.9532212, 'binary_precision': 0.6330645, 'binary_recall': 0.4665676, 'binary_specificity': 0.9899264, 'binary_f1_score': 0.5372113}
confusion matrix:
       0    1
0  17885  182
1    359  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9622946, 'precision': 0.9025701, 'recall': 0.5610339, 'specificity': 0.5610339, 'f1': 0.5977243, 'auroc': 0.92222226, 'binary_precision': 0.84210527, 'binary_recall': 0.12307692, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.2147651}
confusion matrix:
      0   1
0  5940   6
1   228  32
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_21.png
early stop counter: 5
val acc:0.9711312651634216, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9582661986351013 / 0.9672897458076477
after epoch: 21,now: 2024-06-28 06:26:14.857103,epoch time: 0:18:58.835212,used: 6:42:42.632420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9979589, 'precision': 0.99773705, 'recall': 0.9968699, 'specificity': 0.9968699, 'f1': 0.99730253, 'auroc': 0.9998876, 'binary_precision': 0.9972879, 'binary_recall': 0.9946594, 'binary_specificity': 0.9990805, 'binary_f1_score': 0.9959719}
confusion matrix:
       0      1
0  42375     39
1     77  14341
---- Validation: 
scalar performance:
{'acc': 0.96600854, 'precision': 0.843302, 'recall': 0.54319704, 'specificity': 0.54319704, 'f1': 0.56947315, 'auroc': 0.95432687, 'binary_precision': 0.7195122, 'binary_recall': 0.08766716, 'binary_specificity': 0.99872696, 'binary_f1_score': 0.15629138}
confusion matrix:
       0   1
0  18044  23
1    614  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.4790424, 'recall': 0.49974772, 'specificity': 0.49974772, 'f1': 0.48917606, 'auroc': 0.911798, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949545, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5943  3
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_22.png
early stop counter: 6
val acc:0.9660085439682007, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9582661986351013 / 0.9672897458076477
after epoch: 22,now: 2024-06-28 06:45:27.930955,epoch time: 0:19:13.073852,used: 7:01:55.706272,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.997607, 'precision': 0.9966374, 'recall': 0.99704635, 'specificity': 0.99704635, 'f1': 0.99684167, 'auroc': 0.9998174, 'binary_precision': 0.99466646, 'binary_recall': 0.9959082, 'binary_specificity': 0.9981845, 'binary_f1_score': 0.99528694}
confusion matrix:
       0      1
0  42336     77
1     59  14360
---- Validation: 
scalar performance:
{'acc': 0.9728922, 'precision': 0.81956786, 'recall': 0.75133353, 'specificity': 0.75133353, 'f1': 0.7809793, 'auroc': 0.9557727, 'binary_precision': 0.6571429, 'binary_recall': 0.51263, 'binary_specificity': 0.9900371, 'binary_f1_score': 0.5759599}
confusion matrix:
       0    1
0  17887  180
1    328  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95262647, 'precision': 0.53612685, 'recall': 0.50633585, 'specificity': 0.50633585, 'f1': 0.5043067, 'auroc': 0.92208433, 'binary_precision': 0.11363637, 'binary_recall': 0.01923077, 'binary_specificity': 0.993441, 'binary_f1_score': 0.032894738}
confusion matrix:
      0   1
0  5907  39
1   255   5
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_23.png
early stop counter: 7
val acc:0.9728922247886658, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9582661986351013 / 0.9672897458076477
after epoch: 23,now: 2024-06-28 07:04:34.132563,epoch time: 0:19:06.201608,used: 7:21:01.907880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9969735, 'precision': 0.9979806, 'recall': 0.99403524, 'specificity': 0.99403524, 'f1': 0.99598795, 'auroc': 0.9998697, 'binary_precision': 1.0, 'binary_recall': 0.9880705, 'binary_specificity': 1.0, 'binary_f1_score': 0.9939995}
confusion matrix:
       0      1
0  42414      0
1    172  14246
---- Validation: 
scalar performance:
{'acc': 0.9678762, 'precision': 0.9428761, 'recall': 0.55775577, 'specificity': 0.55775577, 'f1': 0.5947057, 'auroc': 0.9622091, 'binary_precision': 0.91764706, 'binary_recall': 0.11589896, 'binary_specificity': 0.99961257, 'binary_f1_score': 0.20580477}
confusion matrix:
       0   1
0  18060   7
1    595  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579439, 'precision': 0.47904915, 'recall': 0.4999159, 'specificity': 0.4999159, 'f1': 0.48926014, 'auroc': 0.92344856, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5945  1
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_24.png
early stop counter: 8
val acc:0.9678761959075928, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9582661986351013 / 0.9672897458076477
after epoch: 24,now: 2024-06-28 07:23:44.185750,epoch time: 0:19:10.053187,used: 7:40:11.961067,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9974662, 'precision': 0.9981449, 'recall': 0.99516714, 'specificity': 0.99516714, 'f1': 0.9966446, 'auroc': 0.99979043, 'binary_precision': 0.99951017, 'binary_recall': 0.9904993, 'binary_specificity': 0.99983495, 'binary_f1_score': 0.9949843}
confusion matrix:
       0      1
0  42405      7
1    137  14283
---- Validation: 
scalar performance:
{'acc': 0.9709178, 'precision': 0.8258392, 'recall': 0.6802134, 'specificity': 0.6802134, 'f1': 0.7302507, 'auroc': 0.94925743, 'binary_precision': 0.6748634, 'binary_recall': 0.36701337, 'binary_specificity': 0.9934134, 'binary_f1_score': 0.47545713}
confusion matrix:
       0    1
0  17948  119
1    426  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9639059, 'precision': 0.8067082, 'recall': 0.65198517, 'specificity': 0.65198517, 'f1': 0.70053136, 'auroc': 0.93611395, 'binary_precision': 0.64285713, 'binary_recall': 0.31153846, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.41968912}
confusion matrix:
      0   1
0  5901  45
1   179  81
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_25.png
early stop counter: 9
val acc:0.970917820930481, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9582661986351013 / 0.9672897458076477
after epoch: 25,now: 2024-06-28 07:42:51.650865,epoch time: 0:19:07.465115,used: 7:59:19.426182,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99686795, 'precision': 0.99781656, 'recall': 0.99391913, 'specificity': 0.99391913, 'f1': 0.9958484, 'auroc': 0.99980104, 'binary_precision': 0.99971926, 'binary_recall': 0.98793256, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.993791}
confusion matrix:
       0      1
0  42409      4
1    174  14245
---- Validation: 
scalar performance:
{'acc': 0.9663821, 'precision': 0.80479366, 'recall': 0.5712862, 'specificity': 0.5712862, 'f1': 0.6100502, 'auroc': 0.95604014, 'binary_precision': 0.6405229, 'binary_recall': 0.14561664, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.23728812}
confusion matrix:
       0   1
0  18012  55
1    575  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548824, 'precision': 0.4789848, 'recall': 0.4983182, 'specificity': 0.4983182, 'f1': 0.48846027, 'auroc': 0.9317128, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9966364, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5926  20
1   260   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_26.png
early stop counter: 10
val acc:0.9663820862770081, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9582661986351013 / 0.9672897458076477
after epoch: 26,now: 2024-06-28 08:01:58.848889,epoch time: 0:19:07.198024,used: 8:18:26.624206,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99723744, 'precision': 0.9968172, 'recall': 0.9958835, 'specificity': 0.9958835, 'f1': 0.9963493, 'auroc': 0.9997067, 'binary_precision': 0.9959663, 'binary_recall': 0.99313456, 'binary_specificity': 0.9986325, 'binary_f1_score': 0.99454844}
confusion matrix:
       0      1
0  42354     58
1     99  14321
---- Validation: 
scalar performance:
{'acc': 0.9670224, 'precision': 0.8064433, 'recall': 0.59021527, 'specificity': 0.59021527, 'f1': 0.6347477, 'auroc': 0.9498531, 'binary_precision': 0.64248705, 'binary_recall': 0.18424962, 'binary_specificity': 0.9961809, 'binary_f1_score': 0.28637412}
confusion matrix:
       0    1
0  17998   69
1    549  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.47902888, 'recall': 0.49941137, 'specificity': 0.49941137, 'f1': 0.4890078, 'auroc': 0.9376551, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5939  7
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_27.png
early stop counter: 11
val acc:0.9670224189758301, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9582661986351013 / 0.9672897458076477
after epoch: 27,now: 2024-06-28 08:21:28.587043,epoch time: 0:19:29.738154,used: 8:37:56.362360,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9983284, 'precision': 0.99883616, 'recall': 0.99675155, 'specificity': 0.99675155, 'f1': 0.9977883, 'auroc': 0.9998975, 'binary_precision': 0.9998604, 'binary_recall': 0.9935502, 'binary_specificity': 0.99995285, 'binary_f1_score': 0.9966953}
confusion matrix:
       0      1
0  42411      2
1     93  14326
---- Validation: 
scalar performance:
{'acc': 0.96931696, 'precision': 0.8964435, 'recall': 0.5921205, 'specificity': 0.5921205, 'f1': 0.64367175, 'auroc': 0.958101, 'binary_precision': 0.82236844, 'binary_recall': 0.18573551, 'binary_specificity': 0.9985056, 'binary_f1_score': 0.3030303}
confusion matrix:
       0    1
0  18040   27
1    548  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.5505381, 'recall': 0.50141853, 'specificity': 0.50141853, 'f1': 0.49283546, 'auroc': 0.9373549, 'binary_precision': 0.14285715, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9989909, 'binary_f1_score': 0.007490637}
confusion matrix:
      0  1
0  5940  6
1   259  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_28.png
early stop counter: 12
val acc:0.9693169593811035, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9582661986351013 / 0.9672897458076477
after epoch: 28,now: 2024-06-28 08:40:50.270398,epoch time: 0:19:21.683355,used: 8:57:18.045715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99785334, 'precision': 0.9984264, 'recall': 0.99590683, 'specificity': 0.99590683, 'f1': 0.9971584, 'auroc': 0.99988866, 'binary_precision': 0.9995807, 'binary_recall': 0.99195504, 'binary_specificity': 0.99985856, 'binary_f1_score': 0.9957533}
confusion matrix:
       0      1
0  42407      6
1    116  14303
---- Validation: 
scalar performance:
{'acc': 0.96659553, 'precision': 0.826778, 'recall': 0.56352895, 'specificity': 0.56352895, 'f1': 0.60021675, 'auroc': 0.9601769, 'binary_precision': 0.68503934, 'binary_recall': 0.12927191, 'binary_specificity': 0.99778605, 'binary_f1_score': 0.21749999}
confusion matrix:
       0   1
0  18027  40
1    586  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9577828, 'precision': 0.47904578, 'recall': 0.49983183, 'specificity': 0.49983183, 'f1': 0.4892181, 'auroc': 0.93845767, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99966365, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5944  2
1   260  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_29.png
early stop counter: 13
val acc:0.9665955305099487, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9582661986351013 / 0.9672897458076477
after epoch: 29,now: 2024-06-28 09:00:12.532007,epoch time: 0:19:22.261609,used: 9:16:40.307324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99808204, 'precision': 0.9981866, 'recall': 0.9967465, 'specificity': 0.9967465, 'f1': 0.9974638, 'auroc': 0.9998814, 'binary_precision': 0.99839777, 'binary_recall': 0.99403524, 'binary_specificity': 0.9994577, 'binary_f1_score': 0.9962117}
confusion matrix:
       0      1
0  42391     23
1     86  14332
---- Validation: 
scalar performance:
{'acc': 0.9689434, 'precision': 0.8715826, 'recall': 0.5947879, 'specificity': 0.5947879, 'f1': 0.6456293, 'auroc': 0.95517707, 'binary_precision': 0.7724551, 'binary_recall': 0.19167905, 'binary_specificity': 0.99789673, 'binary_f1_score': 0.30714285}
confusion matrix:
       0    1
0  18029   38
1    544  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.6268061, 'recall': 0.5172126, 'specificity': 0.5172126, 'f1': 0.5227081, 'auroc': 0.9095532, 'binary_precision': 0.29411766, 'binary_recall': 0.03846154, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.06802721}
confusion matrix:
      0   1
0  5922  24
1   250  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_30.png
early stop counter: 14
val acc:0.9689434170722961, best validation acc: 0.9767876267433167, corresponding to test acc:                         0.9582661986351013 / 0.9672897458076477
after epoch: 30,now: 2024-06-28 09:19:47.519038,epoch time: 0:19:34.987031,used: 9:36:15.294355,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_27_23_43_32_seed_1_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 9:36:15.294355 at 2024-06-28 09:19:47.519038
persisted model performance metric: 

scalar performance:
{'acc': 0.9582662, 'precision': 0.97912973, 'recall': 0.5019231, 'specificity': 0.5019231, 'f1': 0.49317387, 'auroc': 0.95707166, 'binary_precision': 1.0, 'binary_recall': 0.0038461538, 'binary_specificity': 1.0, 'binary_f1_score': 0.007662835}
confusion matrix:
      0  1
0  5946  0
1   259  1
oracle model performance metric: 

scalar performance:
{'acc': 0.96728975, 'precision': 0.9530282, 'recall': 0.6169714, 'specificity': 0.6169714, 'f1': 0.6792949, 'auroc': 0.933125, 'binary_precision': 0.93846154, 'binary_recall': 0.23461539, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.37538463}
confusion matrix:
      0   1
0  5942   4
1   199  61
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456207 KiB |  13219 MiB |   2921 TiB |   2921 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2888 TiB |   2888 TiB |
|       from small pool |  41675 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456207 KiB |  13219 MiB |   2921 TiB |   2921 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   2888 TiB |   2888 TiB |
|       from small pool |  41675 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |  13213 MiB |   2912 TiB |   2912 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   2878 TiB |   2878 TiB |
|       from small pool |  40676 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14484 MiB |  28076 MiB |  13602 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     70 MiB |     84 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446961 KiB |   1251 MiB |   2058 TiB |   2058 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   2024 TiB |   2024 TiB |
|       from small pool |  11572 KiB |     44 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8135    |  504366 K  |  504362 K  |
|       from large pool |     187    |    1413    |  265491 K  |  265491 K  |
|       from small pool |    3277    |    7946    |  238874 K  |  238871 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8135    |  504366 K  |  504362 K  |
|       from large pool |     187    |    1413    |  265491 K  |  265491 K  |
|       from small pool |    3277    |    7946    |  238874 K  |  238871 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    1207    |     573    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      35    |      42    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      84    |    3626    |  321958 K  |  321958 K  |
|       from large pool |      40    |     604    |  193397 K  |  193397 K  |
|       from small pool |      44    |    3588    |  128561 K  |  128561 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2921 TiB |   2921 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2888 TiB |   2888 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2921 TiB |   2921 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2888 TiB |   2888 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2912 TiB |   2912 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2878 TiB |   2878 TiB |
|       from small pool |      0 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  28076 MiB |  27194 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   2058 TiB |   2058 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   2024 TiB |   2024 TiB |
|       from small pool |      0 KiB |     44 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  504366 K  |  504366 K  |
|       from large pool |       2    |    1413    |  265491 K  |  265491 K  |
|       from small pool |       0    |    7946    |  238874 K  |  238874 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  504366 K  |  504366 K  |
|       from large pool |       2    |    1413    |  265491 K  |  265491 K  |
|       from small pool |       0    |    7946    |  238874 K  |  238874 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1207    |    1144    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3626    |  321960 K  |  321960 K  |
|       from large pool |       4    |     604    |  193397 K  |  193397 K  |
|       from small pool |       0    |    3588    |  128562 K  |  128562 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   2921 TiB |   2921 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2888 TiB |   2888 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   2921 TiB |   2921 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   2888 TiB |   2888 TiB |
|       from small pool |      0 KiB |     61 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   2912 TiB |   2912 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   2878 TiB |   2878 TiB |
|       from small pool |      0 KiB |     60 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  28076 MiB |  27194 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     70 MiB |     84 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   2058 TiB |   2058 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   2024 TiB |   2024 TiB |
|       from small pool |      0 KiB |     44 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8135    |  504366 K  |  504366 K  |
|       from large pool |       2    |    1413    |  265491 K  |  265491 K  |
|       from small pool |       0    |    7946    |  238874 K  |  238874 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8135    |  504366 K  |  504366 K  |
|       from large pool |       2    |    1413    |  265491 K  |  265491 K  |
|       from small pool |       0    |    7946    |  238874 K  |  238874 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1207    |    1144    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      35    |      42    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3626    |  321960 K  |  321960 K  |
|       from large pool |       4    |     604    |  193397 K  |  193397 K  |
|       from small pool |       0    |    3588    |  128562 K  |  128562 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853

 Experiment start at: 2024-06-28 09:26:05.992440
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9939763, 'precision': 0.9953903, 'recall': 0.9890958, 'specificity': 0.9890958, 'f1': 0.99218875, 'auroc': 0.9991762, 'binary_precision': 0.99831456, 'binary_recall': 0.9787825, 'binary_specificity': 0.99940914, 'binary_f1_score': 0.988452}
confusion matrix:
       0      1
0  42286     25
1    321  14808
---- Validation: 
scalar performance:
{'acc': 0.9720343, 'precision': 0.79518825, 'recall': 0.67156196, 'specificity': 0.67156196, 'f1': 0.71563655, 'auroc': 0.9099855, 'binary_precision': 0.6115942, 'binary_recall': 0.35049835, 'binary_specificity': 0.9926256, 'binary_f1_score': 0.44561777}
confusion matrix:
       0    1
0  18037  134
1    391  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957365, 'precision': 0.68027055, 'recall': 0.5852396, 'specificity': 0.5852396, 'f1': 0.6133238, 'auroc': 0.88927156, 'binary_precision': 0.39285713, 'binary_recall': 0.18181819, 'binary_specificity': 0.988661, 'binary_f1_score': 0.24858758}
confusion matrix:
      0   1
0  5929  68
1   198  44
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_1.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-06-28 09:46:27.973682,epoch time: 0:20:21.981242,used: 0:20:21.981242,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99350625, 'precision': 0.9935721, 'recall': 0.9896679, 'specificity': 0.9896679, 'f1': 0.99159896, 'auroc': 0.9994328, 'binary_precision': 0.99370944, 'binary_recall': 0.98155737, 'binary_specificity': 0.9977784, 'binary_f1_score': 0.987596}
confusion matrix:
       0      1
0  42218     94
1    279  14849
---- Validation: 
scalar performance:
{'acc': 0.96692055, 'precision': 0.7369072, 'recall': 0.7893777, 'specificity': 0.7893777, 'f1': 0.7602246, 'auroc': 0.93924236, 'binary_precision': 0.4871795, 'binary_recall': 0.5996678, 'binary_specificity': 0.97908753, 'binary_f1_score': 0.53760237}
confusion matrix:
       0    1
0  17791  380
1    241  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642571, 'precision': 0.8115205, 'recall': 0.58089375, 'specificity': 0.58089375, 'f1': 0.62285507, 'auroc': 0.9308779, 'binary_precision': 0.6557377, 'binary_recall': 0.16528925, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.2640264}
confusion matrix:
      0   1
0  5976  21
1   202  40
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_2.png
new oracle model saved
early stop counter: 1
val acc:0.9669205546379089, best validation acc: 0.9720342755317688, corresponding to test acc:                         0.9573649764060974 / 0.9642571210861206
after epoch: 2,now: 2024-06-28 10:06:15.378616,epoch time: 0:19:47.404934,used: 0:40:09.386176,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9943767, 'precision': 0.9959681, 'recall': 0.98955935, 'specificity': 0.98955935, 'f1': 0.9927075, 'auroc': 0.9994907, 'binary_precision': 0.9992582, 'binary_recall': 0.9793787, 'binary_specificity': 0.99974, 'binary_f1_score': 0.9892186}
confusion matrix:
       0      1
0  42299     11
1    312  14818
---- Validation: 
scalar performance:
{'acc': 0.97357905, 'precision': 0.9030263, 'recall': 0.6097222, 'specificity': 0.6097222, 'f1': 0.66779864, 'auroc': 0.9395179, 'binary_precision': 0.83125, 'binary_recall': 0.22093023, 'binary_specificity': 0.9985141, 'binary_f1_score': 0.34908134}
confusion matrix:
       0    1
0  18144   27
1    469  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9621734, 'precision': 0.83850837, 'recall': 0.5203277, 'specificity': 0.5203277, 'f1': 0.52940774, 'auroc': 0.92068195, 'binary_precision': 0.71428573, 'binary_recall': 0.041322313, 'binary_specificity': 0.999333, 'binary_f1_score': 0.078125}
confusion matrix:
      0   1
0  5993   4
1   232  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_3.png
better model found
persisted
after epoch: 3,now: 2024-06-28 10:26:26.121582,epoch time: 0:20:10.742966,used: 1:00:20.129142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9952298, 'precision': 0.99667263, 'recall': 0.9910513, 'specificity': 0.9910513, 'f1': 0.99381876, 'auroc': 0.9997078, 'binary_precision': 0.99966365, 'binary_recall': 0.98222077, 'binary_specificity': 0.9998818, 'binary_f1_score': 0.9908654}
confusion matrix:
       0      1
0  42305      5
1    269  14861
---- Validation: 
scalar performance:
{'acc': 0.9744846, 'precision': 0.8662616, 'recall': 0.64953935, 'specificity': 0.64953935, 'f1': 0.70937026, 'auroc': 0.9457287, 'binary_precision': 0.75518674, 'binary_recall': 0.30232558, 'binary_specificity': 0.9967531, 'binary_f1_score': 0.43179125}
confusion matrix:
       0    1
0  18112   59
1    420  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9586472, 'precision': 0.5489603, 'recall': 0.50461423, 'specificity': 0.50461423, 'f1': 0.500802, 'auroc': 0.9185474, 'binary_precision': 0.13636364, 'binary_recall': 0.012396694, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.022727273}
confusion matrix:
      0   1
0  5978  19
1   239   3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_4.png
better model found
persisted
after epoch: 4,now: 2024-06-28 10:46:11.225940,epoch time: 0:19:45.104358,used: 1:20:05.233500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99651814, 'precision': 0.99576443, 'recall': 0.9952588, 'specificity': 0.9952588, 'f1': 0.9955112, 'auroc': 0.9997251, 'binary_precision': 0.9941745, 'binary_recall': 0.99259746, 'binary_specificity': 0.9979201, 'binary_f1_score': 0.9933853}
confusion matrix:
       0      1
0  42222     88
1    112  15018
---- Validation: 
scalar performance:
{'acc': 0.9533905, 'precision': 0.68912286, 'recall': 0.8642994, 'specificity': 0.8642994, 'f1': 0.7448399, 'auroc': 0.9480541, 'binary_precision': 0.38615513, 'binary_recall': 0.769103, 'binary_specificity': 0.9594959, 'binary_f1_score': 0.5141588}
confusion matrix:
       0    1
0  17435  736
1    139  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9706684, 'precision': 0.8026966, 'recall': 0.80629575, 'specificity': 0.80629575, 'f1': 0.8044843, 'auroc': 0.9317738, 'binary_precision': 0.6204082, 'binary_recall': 0.6280992, 'binary_specificity': 0.98449224, 'binary_f1_score': 0.62423}
confusion matrix:
      0    1
0  5904   93
1    90  152
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_5.png
new oracle model saved
early stop counter: 1
val acc:0.9533904790878296, best validation acc: 0.9744846224784851, corresponding to test acc:                         0.9586471915245056 / 0.970668375492096
after epoch: 5,now: 2024-06-28 11:06:02.961669,epoch time: 0:19:51.735729,used: 1:39:56.969229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99399376, 'precision': 0.9958892, 'recall': 0.98866177, 'specificity': 0.98866177, 'f1': 0.99220407, 'auroc': 0.9994701, 'binary_precision': 0.99979717, 'binary_recall': 0.9773944, 'binary_specificity': 0.9999291, 'binary_f1_score': 0.9884689}
confusion matrix:
       0      1
0  42308      3
1    342  14787
---- Validation: 
scalar performance:
{'acc': 0.9699036, 'precision': 0.7953536, 'recall': 0.5789138, 'specificity': 0.5789138, 'f1': 0.6201204, 'auroc': 0.9431823, 'binary_precision': 0.6178344, 'binary_recall': 0.16112956, 'binary_specificity': 0.996698, 'binary_f1_score': 0.25559947}
confusion matrix:
       0   1
0  18111  60
1    505  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9616926, 'precision': 0.7672196, 'recall': 0.524043, 'specificity': 0.524043, 'f1': 0.5358443, 'auroc': 0.9273586, 'binary_precision': 0.5714286, 'binary_recall': 0.049586777, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.091254756}
confusion matrix:
      0   1
0  5988   9
1   230  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_6.png
early stop counter: 2
val acc:0.9699035882949829, best validation acc: 0.9744846224784851, corresponding to test acc:                         0.9586471915245056 / 0.970668375492096
after epoch: 6,now: 2024-06-28 11:26:18.877489,epoch time: 0:20:15.915820,used: 2:00:12.885049,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99735373, 'precision': 0.9976281, 'recall': 0.9955498, 'specificity': 0.9955498, 'f1': 0.99658304, 'auroc': 0.99982864, 'binary_precision': 0.9982037, 'binary_recall': 0.9917377, 'binary_specificity': 0.9993619, 'binary_f1_score': 0.99496025}
confusion matrix:
       0      1
0  42284     27
1    125  15004
---- Validation: 
scalar performance:
{'acc': 0.9686784, 'precision': 0.7913803, 'recall': 0.5309011, 'specificity': 0.5309011, 'f1': 0.5492575, 'auroc': 0.957024, 'binary_precision': 0.61290324, 'binary_recall': 0.06312292, 'binary_specificity': 0.9986792, 'binary_f1_score': 0.11445782}
confusion matrix:
       0   1
0  18147  24
1    564  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.530655, 'recall': 0.5013158, 'specificity': 0.5013158, 'f1': 0.49374413, 'auroc': 0.8936955, 'binary_precision': 0.1, 'binary_recall': 0.004132231, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.007936507}
confusion matrix:
      0  1
0  5988  9
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_7.png
early stop counter: 3
val acc:0.9686784148216248, best validation acc: 0.9744846224784851, corresponding to test acc:                         0.9586471915245056 / 0.970668375492096
after epoch: 7,now: 2024-06-28 11:46:59.119976,epoch time: 0:20:40.242487,used: 2:20:53.127536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9940982, 'precision': 0.9959812, 'recall': 0.98883957, 'specificity': 0.98883957, 'f1': 0.9923407, 'auroc': 0.99980974, 'binary_precision': 0.9998648, 'binary_recall': 0.9777264, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9886717}
confusion matrix:
       0      1
0  42308      2
1    337  14793
---- Validation: 
scalar performance:
{'acc': 0.9683588, 'precision': 0.7969725, 'recall': 0.51628107, 'specificity': 0.51628107, 'f1': 0.5234996, 'auroc': 0.9526143, 'binary_precision': 0.625, 'binary_recall': 0.03322259, 'binary_specificity': 0.9993396, 'binary_f1_score': 0.06309148}
confusion matrix:
       0   1
0  18159  12
1    582  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.5961909, 'recall': 0.5053646, 'specificity': 0.5053646, 'f1': 0.501579, 'auroc': 0.9069497, 'binary_precision': 0.23076923, 'binary_recall': 0.012396694, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.023529412}
confusion matrix:
      0   1
0  5987  10
1   239   3
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_8.png
early stop counter: 4
val acc:0.9683588147163391, best validation acc: 0.9744846224784851, corresponding to test acc:                         0.9586471915245056 / 0.970668375492096
after epoch: 8,now: 2024-06-28 12:06:49.019582,epoch time: 0:19:49.899606,used: 2:40:43.027142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9973189, 'precision': 0.9978408, 'recall': 0.99525017, 'specificity': 0.99525017, 'f1': 0.9965363, 'auroc': 0.9997016, 'binary_precision': 0.99893385, 'binary_recall': 0.99087846, 'binary_specificity': 0.99962187, 'binary_f1_score': 0.9948898}
confusion matrix:
       0      1
0  42295     16
1    138  14991
---- Validation: 
scalar performance:
{'acc': 0.9773611, 'precision': 0.8454538, 'recall': 0.747391, 'specificity': 0.747391, 'f1': 0.7876696, 'auroc': 0.95608824, 'binary_precision': 0.70725995, 'binary_recall': 0.5016611, 'binary_specificity': 0.9931209, 'binary_f1_score': 0.5869776}
confusion matrix:
       0    1
0  18046  125
1    300  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.6528922, 'recall': 0.5228758, 'specificity': 0.5228758, 'f1': 0.53295326, 'auroc': 0.93180937, 'binary_precision': 0.34285715, 'binary_recall': 0.049586777, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.0866426}
confusion matrix:
      0   1
0  5974  23
1   230  12
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_9.png
better model found
persisted
after epoch: 9,now: 2024-06-28 12:26:51.726532,epoch time: 0:20:02.706950,used: 3:00:45.734092,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99655294, 'precision': 0.99674153, 'recall': 0.99436957, 'specificity': 0.99436957, 'f1': 0.9955478, 'auroc': 0.9998342, 'binary_precision': 0.9971368, 'binary_recall': 0.98975545, 'binary_specificity': 0.9989837, 'binary_f1_score': 0.9934324}
confusion matrix:
       0      1
0  42267     43
1    155  14975
---- Validation: 
scalar performance:
{'acc': 0.96745324, 'precision': 0.72645116, 'recall': 0.58487546, 'specificity': 0.58487546, 'f1': 0.62047803, 'auroc': 0.94588816, 'binary_precision': 0.479638, 'binary_recall': 0.17607974, 'binary_specificity': 0.99367124, 'binary_f1_score': 0.25759417}
confusion matrix:
       0    1
0  18056  115
1    496  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584869, 'precision': 0.48055288, 'recall': 0.49858263, 'specificity': 0.49858263, 'f1': 0.48940176, 'auroc': 0.9517509, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5980  17
1   242   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_10.png
early stop counter: 1
val acc:0.9674532413482666, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 10,now: 2024-06-28 12:46:28.986842,epoch time: 0:19:37.260310,used: 3:20:22.994402,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99502087, 'precision': 0.9966208, 'recall': 0.99056983, 'specificity': 0.99056983, 'f1': 0.9935453, 'auroc': 0.9997315, 'binary_precision': 0.99993265, 'binary_recall': 0.98116326, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.990459}
confusion matrix:
       0      1
0  42309      1
1    285  14845
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.71923244, 'recall': 0.51838756, 'specificity': 0.51838756, 'f1': 0.5271313, 'auroc': 0.9364493, 'binary_precision': 0.46938777, 'binary_recall': 0.03820598, 'binary_specificity': 0.99856913, 'binary_f1_score': 0.070660524}
confusion matrix:
       0   1
0  18145  26
1    579  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.4805934, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48994443, 'auroc': 0.9340574, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_11.png
early stop counter: 2
val acc:0.9677728414535522, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 11,now: 2024-06-28 13:06:11.386033,epoch time: 0:19:42.399191,used: 3:40:05.393593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99641365, 'precision': 0.9943085, 'recall': 0.9964829, 'specificity': 0.9964829, 'f1': 0.9953891, 'auroc': 0.9998926, 'binary_precision': 0.98982537, 'binary_recall': 0.99662924, 'binary_specificity': 0.9963366, 'binary_f1_score': 0.9932156}
confusion matrix:
       0      1
0  42155    155
1     51  15079
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.74892235, 'recall': 0.7847194, 'specificity': 0.7847194, 'f1': 0.765488, 'auroc': 0.9477928, 'binary_precision': 0.5115607, 'binary_recall': 0.5880399, 'binary_specificity': 0.98139894, 'binary_f1_score': 0.54714066}
confusion matrix:
       0    1
0  17833  338
1    248  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572047, 'precision': 0.622072, 'recall': 0.5296395, 'specificity': 0.5296395, 'f1': 0.5425502, 'auroc': 0.9117124, 'binary_precision': 0.28070176, 'binary_recall': 0.0661157, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.1070234}
confusion matrix:
      0   1
0  5956  41
1   226  16
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_12.png
early stop counter: 3
val acc:0.9687849283218384, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 12,now: 2024-06-28 13:26:15.079878,epoch time: 0:20:03.693845,used: 4:00:09.087438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9971448, 'precision': 0.9969106, 'recall': 0.99572647, 'specificity': 0.99572647, 'f1': 0.99631655, 'auroc': 0.9998692, 'binary_precision': 0.99641746, 'binary_recall': 0.9927292, 'binary_specificity': 0.99872375, 'binary_f1_score': 0.9945699}
confusion matrix:
       0      1
0  42257     54
1    110  15019
---- Validation: 
scalar performance:
{'acc': 0.96095455, 'precision': 0.68540955, 'recall': 0.68511176, 'specificity': 0.68511176, 'f1': 0.6852605, 'auroc': 0.9350903, 'binary_precision': 0.39101496, 'binary_recall': 0.39036545, 'binary_specificity': 0.97985804, 'binary_f1_score': 0.39068994}
confusion matrix:
       0    1
0  17805  366
1    367  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95576215, 'precision': 0.57953405, 'recall': 0.5189754, 'specificity': 0.5189754, 'f1': 0.5255827, 'auroc': 0.9234865, 'binary_precision': 0.19642857, 'binary_recall': 0.045454547, 'binary_specificity': 0.99249625, 'binary_f1_score': 0.07382551}
confusion matrix:
      0   1
0  5952  45
1   231  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_13.png
early stop counter: 4
val acc:0.9609545469284058, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 13,now: 2024-06-28 13:45:57.645234,epoch time: 0:19:42.565356,used: 4:19:51.652794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9940808, 'precision': 0.99508774, 'recall': 0.9896557, 'specificity': 0.9896557, 'f1': 0.99233115, 'auroc': 0.99940753, 'binary_precision': 0.9971763, 'binary_recall': 0.980304, 'binary_specificity': 0.99900734, 'binary_f1_score': 0.98866814}
confusion matrix:
       0      1
0  42268     42
1    298  14832
---- Validation: 
scalar performance:
{'acc': 0.9708624, 'precision': 0.8288584, 'recall': 0.5834243, 'specificity': 0.5834243, 'f1': 0.62838584, 'auroc': 0.94557583, 'binary_precision': 0.68456376, 'binary_recall': 0.16943522, 'binary_specificity': 0.99741346, 'binary_f1_score': 0.27163783}
confusion matrix:
       0    1
0  18124   47
1    500  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.9189214, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_14.png
early stop counter: 5
val acc:0.9708623886108398, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 14,now: 2024-06-28 14:05:28.703005,epoch time: 0:19:31.057771,used: 4:39:22.710565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9983635, 'precision': 0.9982294, 'recall': 0.99755156, 'specificity': 0.99755156, 'f1': 0.9978898, 'auroc': 0.9999342, 'binary_precision': 0.9979466, 'binary_recall': 0.99583584, 'binary_specificity': 0.99926734, 'binary_f1_score': 0.99689007}
confusion matrix:
       0      1
0  42280     31
1     63  15066
---- Validation: 
scalar performance:
{'acc': 0.9696373, 'precision': 0.7554645, 'recall': 0.7546438, 'specificity': 0.7546438, 'f1': 0.7550534, 'auroc': 0.9480933, 'binary_precision': 0.52666664, 'binary_recall': 0.52491695, 'binary_specificity': 0.9843707, 'binary_f1_score': 0.52579033}
confusion matrix:
       0    1
0  17887  284
1    286  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95992947, 'precision': 0.6058774, 'recall': 0.50726396, 'specificity': 0.50726396, 'f1': 0.5052748, 'auroc': 0.925394, 'binary_precision': 0.25, 'binary_recall': 0.016528925, 'binary_specificity': 0.997999, 'binary_f1_score': 0.03100775}
confusion matrix:
      0   1
0  5985  12
1   238   4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_15.png
early stop counter: 6
val acc:0.9696372747421265, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 15,now: 2024-06-28 14:24:53.817404,epoch time: 0:19:25.114399,used: 4:58:47.824964,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9970926, 'precision': 0.99794734, 'recall': 0.9945661, 'specificity': 0.9945661, 'f1': 0.9962411, 'auroc': 0.99984944, 'binary_precision': 0.9997328, 'binary_recall': 0.9892267, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99445194}
confusion matrix:
       0      1
0  42306      4
1    163  14967
---- Validation: 
scalar performance:
{'acc': 0.9695307, 'precision': 0.82911885, 'recall': 0.54499316, 'specificity': 0.54499316, 'f1': 0.5728869, 'auroc': 0.9575719, 'binary_precision': 0.6875, 'binary_recall': 0.091362126, 'binary_specificity': 0.9986242, 'binary_f1_score': 0.16129033}
confusion matrix:
       0   1
0  18146  25
1    547  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.7306798, 'recall': 0.50198275, 'specificity': 0.50198275, 'f1': 0.4942079, 'auroc': 0.9501297, 'binary_precision': 0.5, 'binary_recall': 0.004132231, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.008196721}
confusion matrix:
      0  1
0  5996  1
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_16.png
early stop counter: 7
val acc:0.9695307016372681, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 16,now: 2024-06-28 14:44:29.847597,epoch time: 0:19:36.030193,used: 5:18:23.855157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99766713, 'precision': 0.9983783, 'recall': 0.9956139, 'specificity': 0.9956139, 'f1': 0.99698555, 'auroc': 0.99988747, 'binary_precision': 0.99986666, 'binary_recall': 0.991275, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.9955523}
confusion matrix:
       0      1
0  42309      2
1    132  14997
---- Validation: 
scalar performance:
{'acc': 0.9737389, 'precision': 0.92265, 'recall': 0.6057895, 'specificity': 0.6057895, 'f1': 0.6641956, 'auroc': 0.9624293, 'binary_precision': 0.8707483, 'binary_recall': 0.21262458, 'binary_specificity': 0.99895436, 'binary_f1_score': 0.34178907}
confusion matrix:
       0    1
0  18152   19
1    474  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.6473434, 'recall': 0.50189936, 'specificity': 0.50189936, 'f1': 0.49414948, 'auroc': 0.92830247, 'binary_precision': 0.33333334, 'binary_recall': 0.004132231, 'binary_specificity': 0.9996665, 'binary_f1_score': 0.008163265}
confusion matrix:
      0  1
0  5995  2
1   241  1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_17.png
early stop counter: 8
val acc:0.9737389087677002, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 17,now: 2024-06-28 15:06:19.891264,epoch time: 0:21:50.043667,used: 5:40:13.898824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.997493, 'precision': 0.99649817, 'recall': 0.99704576, 'specificity': 0.99704576, 'f1': 0.9967716, 'auroc': 0.9998934, 'binary_precision': 0.9943917, 'binary_recall': 0.9961005, 'binary_specificity': 0.997991, 'binary_f1_score': 0.9952454}
confusion matrix:
       0      1
0  42225     85
1     59  15071
---- Validation: 
scalar performance:
{'acc': 0.9441219, 'precision': 0.6605214, 'recall': 0.83782923, 'specificity': 0.83782923, 'f1': 0.7122423, 'auroc': 0.9477866, 'binary_precision': 0.33055344, 'binary_recall': 0.72425246, 'binary_specificity': 0.95140606, 'binary_f1_score': 0.45393023}
confusion matrix:
       0    1
0  17288  883
1    166  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9213015, 'precision': 0.63242084, 'recall': 0.79251266, 'specificity': 0.79251266, 'f1': 0.6747518, 'auroc': 0.9090275, 'binary_precision': 0.279646, 'binary_recall': 0.6528926, 'binary_specificity': 0.9321327, 'binary_f1_score': 0.3915737}
confusion matrix:
      0    1
0  5590  407
1    84  158
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_18.png
early stop counter: 9
val acc:0.9441218972206116, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 18,now: 2024-06-28 15:26:09.543203,epoch time: 0:19:49.651939,used: 6:00:03.550763,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99782383, 'precision': 0.9985056, 'recall': 0.9958904, 'specificity': 0.9958904, 'f1': 0.9971886, 'auroc': 0.9998942, 'binary_precision': 0.99993336, 'binary_recall': 0.99180436, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9958523}
confusion matrix:
       0      1
0  42309      1
1    124  15006
---- Validation: 
scalar performance:
{'acc': 0.9710222, 'precision': 0.8097664, 'recall': 0.6051892, 'specificity': 0.6051892, 'f1': 0.6534453, 'auroc': 0.9453317, 'binary_precision': 0.645, 'binary_recall': 0.21428572, 'binary_specificity': 0.9960927, 'binary_f1_score': 0.32169577}
confusion matrix:
       0    1
0  18100   71
1    473  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9586472, 'precision': 0.6261108, 'recall': 0.52047616, 'specificity': 0.52047616, 'f1': 0.5287102, 'auroc': 0.8779092, 'binary_precision': 0.28947368, 'binary_recall': 0.045454547, 'binary_specificity': 0.99549776, 'binary_f1_score': 0.07857143}
confusion matrix:
      0   1
0  5970  27
1   231  11
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_19.png
early stop counter: 10
val acc:0.9710221886634827, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 19,now: 2024-06-28 15:46:01.195155,epoch time: 0:19:51.651952,used: 6:19:55.202715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99777156, 'precision': 0.9984703, 'recall': 0.9957912, 'specificity': 0.9957912, 'f1': 0.997121, 'auroc': 0.99989396, 'binary_precision': 0.99993336, 'binary_recall': 0.99160606, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9957523}
confusion matrix:
       0      1
0  42309      1
1    127  15003
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.84947145, 'recall': 0.535274, 'specificity': 0.535274, 'f1': 0.5572584, 'auroc': 0.94501483, 'binary_precision': 0.7288136, 'binary_recall': 0.071428575, 'binary_specificity': 0.99911946, 'binary_f1_score': 0.1301059}
confusion matrix:
       0   1
0  18155  16
1    559  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96008974, 'precision': 0.48058408, 'recall': 0.49941638, 'specificity': 0.49941638, 'f1': 0.48981926, 'auroc': 0.88511264, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5990  7
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_20.png
early stop counter: 11
val acc:0.9693709015846252, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 20,now: 2024-06-28 16:06:04.099114,epoch time: 0:20:02.903959,used: 6:39:58.106674,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99787605, 'precision': 0.9976852, 'recall': 0.9968387, 'specificity': 0.9968387, 'f1': 0.9972609, 'auroc': 0.99993086, 'binary_precision': 0.997283, 'binary_recall': 0.9946464, 'binary_specificity': 0.99903095, 'binary_f1_score': 0.995963}
confusion matrix:
       0      1
0  42269     41
1     81  15049
---- Validation: 
scalar performance:
{'acc': 0.97267354, 'precision': 0.80775577, 'recall': 0.66867995, 'specificity': 0.66867995, 'f1': 0.71629643, 'auroc': 0.9622867, 'binary_precision': 0.6369231, 'binary_recall': 0.34385383, 'binary_specificity': 0.99350613, 'binary_f1_score': 0.44660196}
confusion matrix:
       0    1
0  18053  118
1    395  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.6627109, 'recall': 0.50768083, 'specificity': 0.50768083, 'f1': 0.5057898, 'auroc': 0.9423393, 'binary_precision': 0.36363637, 'binary_recall': 0.016528925, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.03162055}
confusion matrix:
      0  1
0  5990  7
1   238  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_21.png
early stop counter: 12
val acc:0.9726735353469849, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 21,now: 2024-06-28 16:25:56.220497,epoch time: 0:19:52.121383,used: 6:59:50.228057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9982765, 'precision': 0.9984255, 'recall': 0.9971315, 'specificity': 0.9971315, 'f1': 0.99777627, 'auroc': 0.99991155, 'binary_precision': 0.99873906, 'binary_recall': 0.9947121, 'binary_specificity': 0.99955094, 'binary_f1_score': 0.99672157}
confusion matrix:
       0      1
0  42292     19
1     80  15049
---- Validation: 
scalar performance:
{'acc': 0.97357905, 'precision': 0.7984551, 'recall': 0.73178554, 'specificity': 0.73178554, 'f1': 0.76055634, 'auroc': 0.96009934, 'binary_precision': 0.61422414, 'binary_recall': 0.47342193, 'binary_specificity': 0.99014914, 'binary_f1_score': 0.5347093}
confusion matrix:
       0    1
0  17992  179
1    317  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.81409025, 'recall': 0.5040488, 'specificity': 0.5040488, 'f1': 0.49831286, 'auroc': 0.95193374, 'binary_precision': 0.6666667, 'binary_recall': 0.008264462, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.01632653}
confusion matrix:
      0  1
0  5996  1
1   240  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_22.png
early stop counter: 13
val acc:0.9735790491104126, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 22,now: 2024-06-28 16:46:17.860173,epoch time: 0:20:21.639676,used: 7:20:11.867733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9986421, 'precision': 0.9984404, 'recall': 0.9980592, 'specificity': 0.9980592, 'f1': 0.9982496, 'auroc': 0.99994934, 'binary_precision': 0.9980148, 'binary_recall': 0.9968275, 'binary_specificity': 0.99929094, 'binary_f1_score': 0.9974208}
confusion matrix:
       0      1
0  42280     30
1     48  15082
---- Validation: 
scalar performance:
{'acc': 0.97645557, 'precision': 0.8786644, 'recall': 0.68428546, 'specificity': 0.68428546, 'f1': 0.7456563, 'auroc': 0.9646909, 'binary_precision': 0.7777778, 'binary_recall': 0.37209302, 'binary_specificity': 0.9964779, 'binary_f1_score': 0.50337076}
confusion matrix:
       0    1
0  18107   64
1    378  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96185285, 'precision': 0.7938595, 'recall': 0.5201609, 'specificity': 0.5201609, 'f1': 0.52902156, 'auroc': 0.92911434, 'binary_precision': 0.625, 'binary_recall': 0.041322313, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.07751939}
confusion matrix:
      0   1
0  5991   6
1   232  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_23.png
early stop counter: 14
val acc:0.976455569267273, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 23,now: 2024-06-28 17:05:58.039328,epoch time: 0:19:40.179155,used: 7:39:52.046888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99754524, 'precision': 0.99825275, 'recall': 0.99542534, 'specificity': 0.99542534, 'f1': 0.9968281, 'auroc': 0.99991965, 'binary_precision': 0.99973327, 'binary_recall': 0.99094516, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.99531984}
confusion matrix:
       0      1
0  42306      4
1    137  14993
---- Validation: 
scalar performance:
{'acc': 0.9709157, 'precision': 0.91517854, 'recall': 0.5553452, 'specificity': 0.5553452, 'f1': 0.59112424, 'auroc': 0.95545554, 'binary_precision': 0.85897434, 'binary_recall': 0.11129568, 'binary_specificity': 0.99939466, 'binary_f1_score': 0.19705881}
confusion matrix:
       0   1
0  18160  11
1    535  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.4805934, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48994443, 'auroc': 0.93811774, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   242  0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_24.png
early stop counter: 15
val acc:0.970915675163269, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 24,now: 2024-06-28 17:25:28.036530,epoch time: 0:19:29.997202,used: 7:59:22.044090,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9983113, 'precision': 0.9988563, 'recall': 0.99679446, 'specificity': 0.99679446, 'f1': 0.99781954, 'auroc': 0.9999591, 'binary_precision': 1.0, 'binary_recall': 0.9935889, 'binary_specificity': 1.0, 'binary_f1_score': 0.99678415}
confusion matrix:
       0      1
0  42310      0
1     97  15033
---- Validation: 
scalar performance:
{'acc': 0.9692111, 'precision': 0.87119997, 'recall': 0.52796406, 'specificity': 0.52796406, 'f1': 0.54479957, 'auroc': 0.95868355, 'binary_precision': 0.77272725, 'binary_recall': 0.056478404, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.10526316}
confusion matrix:
       0   1
0  18161  10
1    568  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9626543, 'precision': 0.9359199, 'recall': 0.5205778, 'specificity': 0.5205778, 'f1': 0.52999604, 'auroc': 0.9174005, 'binary_precision': 0.90909094, 'binary_recall': 0.041322313, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.07905138}
confusion matrix:
      0   1
0  5996   1
1   232  10
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_25.png
early stop counter: 16
val acc:0.9692111015319824, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 25,now: 2024-06-28 17:45:55.551157,epoch time: 0:20:27.514627,used: 8:19:49.558717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.998468, 'precision': 0.99872637, 'recall': 0.9973252, 'specificity': 0.9973252, 'f1': 0.9980231, 'auroc': 0.99991614, 'binary_precision': 0.9992697, 'binary_recall': 0.9949104, 'binary_specificity': 0.99974, 'binary_f1_score': 0.9970853}
confusion matrix:
       0      1
0  42300     11
1     77  15052
---- Validation: 
scalar performance:
{'acc': 0.9758163, 'precision': 0.89068353, 'recall': 0.66146994, 'specificity': 0.66146994, 'f1': 0.7254932, 'auroc': 0.95948255, 'binary_precision': 0.8032787, 'binary_recall': 0.3255814, 'binary_specificity': 0.99735844, 'binary_f1_score': 0.46335697}
confusion matrix:
       0    1
0  18123   48
1    406  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9552813, 'precision': 0.49338502, 'recall': 0.49889785, 'specificity': 0.49889785, 'f1': 0.49212146, 'auroc': 0.875297, 'binary_precision': 0.025641026, 'binary_recall': 0.004132231, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.007117437}
confusion matrix:
      0   1
0  5959  38
1   241   1
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_26.png
early stop counter: 17
val acc:0.9758163094520569, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 26,now: 2024-06-28 18:08:25.995493,epoch time: 0:22:30.444336,used: 8:42:20.003053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9963266, 'precision': 0.9969104, 'recall': 0.9936215, 'specificity': 0.9936215, 'f1': 0.9952511, 'auroc': 0.9998545, 'binary_precision': 0.9981302, 'binary_recall': 0.98790485, 'binary_specificity': 0.9993382, 'binary_f1_score': 0.99299115}
confusion matrix:
       0      1
0  42282     28
1    183  14947
---- Validation: 
scalar performance:
{'acc': 0.9615938, 'precision': 0.6087317, 'recall': 0.54330236, 'specificity': 0.54330236, 'f1': 0.5594746, 'auroc': 0.91937214, 'binary_precision': 0.24680851, 'binary_recall': 0.096345514, 'binary_specificity': 0.99025923, 'binary_f1_score': 0.1385902}
confusion matrix:
       0    1
0  17994  177
1    544   58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95944864, 'precision': 0.4805716, 'recall': 0.49908286, 'specificity': 0.49908286, 'f1': 0.48965237, 'auroc': 0.9389371, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9981657, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5986  11
1   242   0
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_27.png
early stop counter: 18
val acc:0.9615938067436218, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 27,now: 2024-06-28 18:28:16.115727,epoch time: 0:19:50.120234,used: 9:02:10.123287,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9987987, 'precision': 0.9990575, 'recall': 0.997847, 'specificity': 0.997847, 'f1': 0.9984503, 'auroc': 0.9999826, 'binary_precision': 0.9996019, 'binary_recall': 0.99583584, 'binary_specificity': 0.9998582, 'binary_f1_score': 0.99771535}
confusion matrix:
       0      1
0  42305      6
1     63  15066
---- Validation: 
scalar performance:
{'acc': 0.9768284, 'precision': 0.9153705, 'recall': 0.666811, 'specificity': 0.666811, 'f1': 0.7348375, 'auroc': 0.96644354, 'binary_precision': 0.8523207, 'binary_recall': 0.33554816, 'binary_specificity': 0.9980739, 'binary_f1_score': 0.48152563}
confusion matrix:
       0    1
0  18136   35
1    400  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96105146, 'precision': 0.7031211, 'recall': 0.5078476, 'specificity': 0.5078476, 'f1': 0.5059992, 'auroc': 0.9247141, 'binary_precision': 0.44444445, 'binary_recall': 0.016528925, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.031872507}
confusion matrix:
      0  1
0  5992  5
1   238  4
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_28.png
early stop counter: 19
val acc:0.976828396320343, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 28,now: 2024-06-28 18:50:41.682459,epoch time: 0:22:25.566732,used: 9:24:35.690019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9981372, 'precision': 0.9987172, 'recall': 0.996485, 'specificity': 0.996485, 'f1': 0.99759424, 'auroc': 0.99980795, 'binary_precision': 0.9999334, 'binary_recall': 0.9929936, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.9964514}
confusion matrix:
       0      1
0  42310      1
1    106  15023
---- Validation: 
scalar performance:
{'acc': 0.9693709, 'precision': 0.8785311, 'recall': 0.5304557, 'specificity': 0.5304557, 'f1': 0.54921883, 'auroc': 0.9478465, 'binary_precision': 0.78723407, 'binary_recall': 0.061461795, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.11402157}
confusion matrix:
       0   1
0  18161  10
1    565  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96057063, 'precision': 0.60574144, 'recall': 0.50363195, 'specificity': 0.50363195, 'f1': 0.4979411, 'auroc': 0.93504536, 'binary_precision': 0.25, 'binary_recall': 0.008264462, 'binary_specificity': 0.9989995, 'binary_f1_score': 0.016}
confusion matrix:
      0  1
0  5991  6
1   240  2
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_29.png
early stop counter: 20
val acc:0.9693709015846252, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 29,now: 2024-06-28 19:11:41.675785,epoch time: 0:20:59.993326,used: 9:45:35.683345,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9981372, 'precision': 0.9987387, 'recall': 0.996464, 'specificity': 0.996464, 'f1': 0.99759424, 'auroc': 0.99989676, 'binary_precision': 1.0, 'binary_recall': 0.99292797, 'binary_specificity': 1.0, 'binary_f1_score': 0.9964514}
confusion matrix:
       0      1
0  42310      0
1    107  15023
---- Validation: 
scalar performance:
{'acc': 0.97214085, 'precision': 0.9357593, 'recall': 0.5736451, 'specificity': 0.5736451, 'f1': 0.6198642, 'auroc': 0.96704584, 'binary_precision': 0.8989899, 'binary_recall': 0.14784053, 'binary_specificity': 0.9994497, 'binary_f1_score': 0.253923}
confusion matrix:
       0   1
0  18161  10
1    513  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.962494, 'precision': 0.9312972, 'recall': 0.51851165, 'specificity': 0.51851165, 'f1': 0.5261445, 'auroc': 0.94944143, 'binary_precision': 0.9, 'binary_recall': 0.037190083, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.071428575}
confusion matrix:
      0  1
0  5996  1
1   233  9
t-SNE plot saved as /localscratch/sina.wendrich/tsne/t-SNE_Test_center0_21587853_30.png
early stop counter: 21
val acc:0.9721408486366272, best validation acc: 0.9773610830307007, corresponding to test acc:                         0.9594486355781555 / 0.970668375492096
after epoch: 30,now: 2024-06-28 19:36:05.127291,epoch time: 0:24:23.451506,used: 10:09:59.134851,model: dset_te_center0_erm_b44271c83_not_commited_2024md_06md_28_09_26_05_seed_2_21587853
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 10:09:59.134851 at 2024-06-28 19:36:05.127291
persisted model performance metric: 

scalar performance:
{'acc': 0.95944864, 'precision': 0.6528922, 'recall': 0.5228758, 'specificity': 0.5228758, 'f1': 0.53295326, 'auroc': 0.93180937, 'binary_precision': 0.34285715, 'binary_recall': 0.049586777, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.0866426}
confusion matrix:
      0   1
0  5974  23
1   230  12
oracle model performance metric: 

scalar performance:
{'acc': 0.9706684, 'precision': 0.8026966, 'recall': 0.80629575, 'specificity': 0.80629575, 'f1': 0.8044843, 'auroc': 0.9317738, 'binary_precision': 0.6204082, 'binary_recall': 0.6280992, 'binary_specificity': 0.98449224, 'binary_f1_score': 0.62423}
confusion matrix:
      0    1
0  5904   93
1    90  152
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456213 KiB |  13219 MiB |   4382 TiB |   4382 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   4332 TiB |   4332 TiB |
|       from small pool |  41681 KiB |     61 MiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456213 KiB |  13219 MiB |   4382 TiB |   4382 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   4332 TiB |   4332 TiB |
|       from small pool |  41681 KiB |     61 MiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |  13213 MiB |   4372 TiB |   4372 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   4322 TiB |   4322 TiB |
|       from small pool |  40678 KiB |     60 MiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14484 MiB |  41668 MiB |  27194 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     70 MiB |     98 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 446955 KiB |   1251 MiB |   3089 TiB |   3089 TiB |
|       from large pool | 435388 KiB |   1244 MiB |   3039 TiB |   3039 TiB |
|       from small pool |  11566 KiB |     44 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8185    |     757 M  |     757 M  |
|       from large pool |     187    |    1413    |     398 M  |     398 M  |
|       from small pool |    3289    |    7996    |     358 M  |     358 M  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8185    |     757 M  |     757 M  |
|       from large pool |     187    |    1413    |     398 M  |     398 M  |
|       from small pool |    3289    |    7996    |     358 M  |     358 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    1778    |    1144    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      35    |      49    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      83    |    3656    |  479941 K  |  479941 K  |
|       from large pool |      40    |     604    |  287532 K  |  287532 K  |
|       from small pool |      43    |    3614    |  192409 K  |  192409 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   4382 TiB |   4382 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   4332 TiB |   4332 TiB |
|       from small pool |      0 KiB |     61 MiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   4382 TiB |   4382 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   4332 TiB |   4332 TiB |
|       from small pool |      0 KiB |     61 MiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   4372 TiB |   4372 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   4322 TiB |   4322 TiB |
|       from small pool |      0 KiB |     60 MiB |     49 TiB |     49 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14484 MiB |  41668 MiB |  40786 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     52 MiB |     70 MiB |     98 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1251 MiB |   3089 TiB |   3089 TiB |
|       from large pool |  24320 KiB |   1244 MiB |   3039 TiB |   3039 TiB |
|       from small pool |      0 KiB |     44 MiB |     50 TiB |     50 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8185    |     757 M  |     757 M  |
|       from large pool |       2    |    1413    |     398 M  |     398 M  |
|       from small pool |       0    |    7996    |     358 M  |     358 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8185    |     757 M  |     757 M  |
|       from large pool |       2    |    1413    |     398 M  |     398 M  |
|       from small pool |       0    |    7996    |     358 M  |     358 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1778    |    1715    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      26    |      35    |      49    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3656    |  479942 K  |  479942 K  |
|       from large pool |       4    |     604    |  287532 K  |  287532 K  |
|       from small pool |       0    |    3614    |  192410 K  |  192410 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jun 28 19:37:10 2024]
Finished job 0.
1 of 1 steps (100%) done
