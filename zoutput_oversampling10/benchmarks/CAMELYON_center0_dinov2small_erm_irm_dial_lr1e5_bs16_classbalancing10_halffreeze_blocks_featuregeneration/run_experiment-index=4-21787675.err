Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul  9 16:40:58 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675

 Experiment start at: 2024-07-09 16:48:48.693646
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94125175, 'precision': 0.9590113, 'recall': 0.888996, 'specificity': 0.888996, 'f1': 0.9172956, 'auroc': 0.9658457, 'binary_precision': 0.9889873, 'binary_recall': 0.78101647, 'binary_specificity': 0.99697554, 'binary_f1_score': 0.8727839}
confusion matrix:
       0      1
0  42194    128
1   3223  11495
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.94795656, 'precision': 0.52349067, 'recall': 0.51477265, 'specificity': 0.51477265, 'f1': 0.5173283, 'auroc': 0.78982043, 'binary_precision': 0.0802005, 'binary_recall': 0.04976672, 'binary_specificity': 0.9797785, 'binary_f1_score': 0.061420348}
confusion matrix:
       0    1
0  17782  367
1    611   32
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9496644, 'precision': 0.5803016, 'recall': 0.52847975, 'specificity': 0.52847975, 'f1': 0.5383351, 'auroc': 0.82608736, 'binary_precision': 0.2, 'binary_recall': 0.06896552, 'binary_specificity': 0.987994, 'binary_f1_score': 0.102564104}
confusion matrix:
      0   1
0  5925  72
1   243  18
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-09 17:12:43.839281,epoch time: 0:23:55.145635,used: 0:23:55.145635,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9556101, 'precision': 0.9657116, 'recall': 0.9184818, 'specificity': 0.9184818, 'f1': 0.9390439, 'auroc': 0.9816916, 'binary_precision': 0.98379666, 'binary_recall': 0.84178334, 'binary_specificity': 0.99518025, 'binary_f1_score': 0.9072664}
confusion matrix:
       0      1
0  42122    204
1   2328  12386
---- Validation: 
scalar performance:
{'acc': 0.9542891, 'precision': 0.634395, 'recall': 0.6110579, 'specificity': 0.6110579, 'f1': 0.6214242, 'auroc': 0.8594683, 'binary_precision': 0.29545453, 'binary_recall': 0.24261275, 'binary_specificity': 0.979503, 'binary_f1_score': 0.26643893}
confusion matrix:
       0    1
0  17777  372
1    487  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95605624, 'precision': 0.7153159, 'recall': 0.6472518, 'specificity': 0.6472518, 'f1': 0.6739713, 'auroc': 0.8832552, 'binary_precision': 0.46022728, 'binary_recall': 0.31034482, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.3707094}
confusion matrix:
      0   1
0  5902  95
1   180  81
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-09 17:34:32.004004,epoch time: 0:21:48.164723,used: 0:45:43.310358,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96342915, 'precision': 0.96843356, 'recall': 0.93565285, 'specificity': 0.93565285, 'f1': 0.9505618, 'auroc': 0.9866619, 'binary_precision': 0.97776264, 'binary_recall': 0.8782526, 'binary_specificity': 0.9930531, 'binary_f1_score': 0.92534006}
confusion matrix:
       0      1
0  42027    294
1   1792  12927
---- Validation: 
scalar performance:
{'acc': 0.95317155, 'precision': 0.66040736, 'recall': 0.68623495, 'specificity': 0.68623495, 'f1': 0.67220354, 'auroc': 0.8813968, 'binary_precision': 0.34221038, 'binary_recall': 0.39968896, 'binary_specificity': 0.9727809, 'binary_f1_score': 0.3687231}
confusion matrix:
       0    1
0  17655  494
1    386  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.7309147, 'recall': 0.7283747, 'specificity': 0.7283747, 'f1': 0.7296366, 'auroc': 0.89897954, 'binary_precision': 0.48449612, 'binary_recall': 0.4789272, 'binary_specificity': 0.97782224, 'binary_f1_score': 0.48169556}
confusion matrix:
      0    1
0  5864  133
1   136  125
new oracle model saved
early stop counter: 1
val acc:0.9531715512275696, best validation acc: 0.9542890787124634, corresponding to test acc:                         0.9560562372207642 / 0.9570150375366211
after epoch: 3,now: 2024-07-09 17:56:18.323936,epoch time: 0:21:46.319932,used: 1:07:29.630290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96658486, 'precision': 0.9701859, 'recall': 0.9420961, 'specificity': 0.9420961, 'f1': 0.9550531, 'auroc': 0.9875673, 'binary_precision': 0.97699183, 'binary_recall': 0.8914934, 'binary_specificity': 0.99269885, 'binary_f1_score': 0.9322865}
confusion matrix:
       0      1
0  42013    309
1   1597  13121
---- Validation: 
scalar performance:
{'acc': 0.9551405, 'precision': 0.67039573, 'recall': 0.6910045, 'specificity': 0.6910045, 'f1': 0.68002236, 'auroc': 0.8888743, 'binary_precision': 0.36187845, 'binary_recall': 0.407465, 'binary_specificity': 0.97454405, 'binary_f1_score': 0.3833211}
confusion matrix:
       0    1
0  17687  462
1    381  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96276766, 'precision': 0.76646364, 'recall': 0.7771846, 'specificity': 0.7771846, 'f1': 0.77170384, 'auroc': 0.9060501, 'binary_precision': 0.5514706, 'binary_recall': 0.57471263, 'binary_specificity': 0.9796565, 'binary_f1_score': 0.5628518}
confusion matrix:
      0    1
0  5875  122
1   111  150
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-09 18:17:39.549988,epoch time: 0:21:21.226052,used: 1:28:50.856342,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9690919, 'precision': 0.97208667, 'recall': 0.9467703, 'specificity': 0.9467703, 'f1': 0.9585468, 'auroc': 0.9892372, 'binary_precision': 0.9777942, 'binary_recall': 0.90065235, 'binary_specificity': 0.9928882, 'binary_f1_score': 0.93763924}
confusion matrix:
       0      1
0  42023    301
1   1462  13254
---- Validation: 
scalar performance:
{'acc': 0.9574287, 'precision': 0.68300253, 'recall': 0.6966895, 'specificity': 0.6966895, 'f1': 0.6895637, 'auroc': 0.8937427, 'binary_precision': 0.38672438, 'binary_recall': 0.41679627, 'binary_specificity': 0.9765827, 'binary_f1_score': 0.40119758}
confusion matrix:
       0    1
0  17724  425
1    375  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9654842, 'precision': 0.783139, 'recall': 0.7914283, 'specificity': 0.7914283, 'f1': 0.78721595, 'auroc': 0.91054976, 'binary_precision': 0.58364314, 'binary_recall': 0.6015326, 'binary_specificity': 0.981324, 'binary_f1_score': 0.5924529}
confusion matrix:
      0    1
0  5885  112
1   104  157
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-09 19:09:21.919947,epoch time: 0:51:42.369959,used: 2:20:33.226301,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9718268, 'precision': 0.9740975, 'recall': 0.9519406, 'specificity': 0.9519406, 'f1': 0.9623449, 'auroc': 0.9908475, 'binary_precision': 0.97846717, 'binary_recall': 0.9108514, 'binary_specificity': 0.9930298, 'binary_f1_score': 0.9434494}
confusion matrix:
       0      1
0  42028    295
1   1312  13405
---- Validation: 
scalar performance:
{'acc': 0.957003, 'precision': 0.68722975, 'recall': 0.7234711, 'specificity': 0.7234711, 'f1': 0.70351917, 'auroc': 0.90040934, 'binary_precision': 0.39327297, 'binary_recall': 0.47278383, 'binary_specificity': 0.97415835, 'binary_f1_score': 0.42937854}
confusion matrix:
       0    1
0  17680  469
1    339  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9642058, 'precision': 0.77393985, 'recall': 0.79992294, 'specificity': 0.79992294, 'f1': 0.78626215, 'auroc': 0.91329443, 'binary_precision': 0.5644599, 'binary_recall': 0.62068963, 'binary_specificity': 0.97915626, 'binary_f1_score': 0.5912409}
confusion matrix:
      0    1
0  5872  125
1    99  162
early stop counter: 1
val acc:0.9570029973983765, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 6,now: 2024-07-09 19:33:57.125968,epoch time: 0:24:35.206021,used: 2:45:08.432322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9736676, 'precision': 0.9734218, 'recall': 0.9573422, 'specificity': 0.9573422, 'f1': 0.9650238, 'auroc': 0.9915465, 'binary_precision': 0.9729401, 'binary_recall': 0.92361534, 'binary_specificity': 0.9910691, 'binary_f1_score': 0.9476363}
confusion matrix:
       0      1
0  41947    378
1   1124  13591
---- Validation: 
scalar performance:
{'acc': 0.9537569, 'precision': 0.67816865, 'recall': 0.7442922, 'specificity': 0.7442922, 'f1': 0.70525277, 'auroc': 0.9039281, 'binary_precision': 0.3736018, 'binary_recall': 0.5194401, 'binary_specificity': 0.9691443, 'binary_f1_score': 0.43461287}
confusion matrix:
       0    1
0  17589  560
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.7432834, 'recall': 0.81707716, 'specificity': 0.81707716, 'f1': 0.7745633, 'auroc': 0.91546416, 'binary_precision': 0.5014493, 'binary_recall': 0.66283524, 'binary_specificity': 0.971319, 'binary_f1_score': 0.5709571}
confusion matrix:
      0    1
0  5825  172
1    88  173
early stop counter: 2
val acc:0.9537569284439087, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 7,now: 2024-07-09 19:54:55.941236,epoch time: 0:20:58.815268,used: 3:06:07.247590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97480714, 'precision': 0.9751606, 'recall': 0.9586519, 'specificity': 0.9586519, 'f1': 0.96653044, 'auroc': 0.9925884, 'binary_precision': 0.97585267, 'binary_recall': 0.9252667, 'binary_specificity': 0.99203706, 'binary_f1_score': 0.9498866}
confusion matrix:
       0      1
0  41984    337
1   1100  13619
---- Validation: 
scalar performance:
{'acc': 0.95391655, 'precision': 0.6772665, 'recall': 0.73762435, 'specificity': 0.73762435, 'f1': 0.7023748, 'auroc': 0.9043985, 'binary_precision': 0.3722795, 'binary_recall': 0.5054432, 'binary_specificity': 0.9698055, 'binary_f1_score': 0.42875987}
confusion matrix:
       0    1
0  17601  548
1    318  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7524326, 'recall': 0.8254069, 'specificity': 0.8254069, 'f1': 0.783612, 'auroc': 0.9180665, 'binary_precision': 0.51906157, 'binary_recall': 0.6781609, 'binary_specificity': 0.972653, 'binary_f1_score': 0.5880399}
confusion matrix:
      0    1
0  5833  164
1    84  177
early stop counter: 3
val acc:0.9539165496826172, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 8,now: 2024-07-09 20:18:29.993727,epoch time: 0:23:34.052491,used: 3:29:41.300081,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9768934, 'precision': 0.9765196, 'recall': 0.9627764, 'specificity': 0.9627764, 'f1': 0.96938777, 'auroc': 0.99367493, 'binary_precision': 0.97578126, 'binary_recall': 0.93360966, 'binary_specificity': 0.9919431, 'binary_f1_score': 0.9542298}
confusion matrix:
       0      1
0  41983    341
1    977  13739
---- Validation: 
scalar performance:
{'acc': 0.9553533, 'precision': 0.68305635, 'recall': 0.73761815, 'specificity': 0.73761815, 'f1': 0.70626694, 'auroc': 0.904709, 'binary_precision': 0.38388625, 'binary_recall': 0.503888, 'binary_specificity': 0.9713483, 'binary_f1_score': 0.43577674}
confusion matrix:
       0    1
0  17629  520
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9579738, 'precision': 0.7416596, 'recall': 0.827821, 'specificity': 0.827821, 'f1': 0.7771897, 'auroc': 0.91816986, 'binary_precision': 0.49722221, 'binary_recall': 0.68582374, 'binary_specificity': 0.96981823, 'binary_f1_score': 0.5764895}
confusion matrix:
      0    1
0  5816  181
1    82  179
early stop counter: 4
val acc:0.955353319644928, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 9,now: 2024-07-09 20:39:18.395517,epoch time: 0:20:48.401790,used: 3:50:29.701871,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9773492, 'precision': 0.97677064, 'recall': 0.96372837, 'specificity': 0.96372837, 'f1': 0.97001505, 'auroc': 0.9939029, 'binary_precision': 0.97562534, 'binary_recall': 0.9355847, 'binary_specificity': 0.991872, 'binary_f1_score': 0.9551856}
confusion matrix:
       0      1
0  41979    344
1    948  13769
---- Validation: 
scalar performance:
{'acc': 0.9522137, 'precision': 0.67586017, 'recall': 0.75924444, 'specificity': 0.75924444, 'f1': 0.7082906, 'auroc': 0.90703124, 'binary_precision': 0.36787564, 'binary_recall': 0.5520995, 'binary_specificity': 0.96638936, 'binary_f1_score': 0.44154227}
confusion matrix:
       0    1
0  17539  610
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.950783, 'precision': 0.71681714, 'recall': 0.8478894, 'specificity': 0.8478894, 'f1': 0.7644323, 'auroc': 0.9195613, 'binary_precision': 0.44547564, 'binary_recall': 0.7356322, 'binary_specificity': 0.9601467, 'binary_f1_score': 0.55491334}
confusion matrix:
      0    1
0  5758  239
1    69  192
early stop counter: 5
val acc:0.952213704586029, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 10,now: 2024-07-09 21:00:10.293638,epoch time: 0:20:51.898121,used: 4:11:21.599992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9778752, 'precision': 0.9774072, 'recall': 0.9644755, 'specificity': 0.9644755, 'f1': 0.9707113, 'auroc': 0.99358743, 'binary_precision': 0.9764806, 'binary_recall': 0.9367949, 'binary_specificity': 0.99215615, 'binary_f1_score': 0.95622617}
confusion matrix:
       0      1
0  41994    332
1    930  13784
---- Validation: 
scalar performance:
{'acc': 0.9531183, 'precision': 0.6777078, 'recall': 0.75296223, 'specificity': 0.75296223, 'f1': 0.70772946, 'auroc': 0.9053699, 'binary_precision': 0.372043, 'binary_recall': 0.5381026, 'binary_specificity': 0.9678219, 'binary_f1_score': 0.4399237}
confusion matrix:
       0    1
0  17565  584
1    297  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95238096, 'precision': 0.7201886, 'recall': 0.8303999, 'specificity': 0.8303999, 'f1': 0.76235485, 'auroc': 0.9160877, 'binary_precision': 0.45386535, 'binary_recall': 0.697318, 'binary_specificity': 0.9634817, 'binary_f1_score': 0.5498489}
confusion matrix:
      0    1
0  5778  219
1    79  182
early stop counter: 6
val acc:0.9531183242797852, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 11,now: 2024-07-09 21:20:59.773926,epoch time: 0:20:49.480288,used: 4:32:11.080280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9796634, 'precision': 0.98105866, 'recall': 0.9656265, 'specificity': 0.9656265, 'f1': 0.973019, 'auroc': 0.995353, 'binary_precision': 0.9838019, 'binary_recall': 0.93661684, 'binary_specificity': 0.9946361, 'binary_f1_score': 0.9596297}
confusion matrix:
       0      1
0  42093    227
1    933  13787
---- Validation: 
scalar performance:
{'acc': 0.9554598, 'precision': 0.6860528, 'recall': 0.74967414, 'specificity': 0.74967414, 'f1': 0.71252316, 'auroc': 0.90516067, 'binary_precision': 0.38901603, 'binary_recall': 0.5287714, 'binary_specificity': 0.9705769, 'binary_f1_score': 0.44825312}
confusion matrix:
       0    1
0  17615  534
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95206136, 'precision': 0.71906006, 'recall': 0.8302331, 'specificity': 0.8302331, 'f1': 0.7614403, 'auroc': 0.91550756, 'binary_precision': 0.4516129, 'binary_recall': 0.697318, 'binary_specificity': 0.96314824, 'binary_f1_score': 0.54819274}
confusion matrix:
      0    1
0  5776  221
1    79  182
early stop counter: 7
val acc:0.9554597735404968, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 12,now: 2024-07-09 21:41:52.482737,epoch time: 0:20:52.708811,used: 4:53:03.789091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98059255, 'precision': 0.98201823, 'recall': 0.9671126, 'specificity': 0.9671126, 'f1': 0.9742642, 'auroc': 0.9954356, 'binary_precision': 0.9848258, 'binary_recall': 0.93925804, 'binary_specificity': 0.99496716, 'binary_f1_score': 0.9615023}
confusion matrix:
       0      1
0  42109    213
1    894  13824
---- Validation: 
scalar performance:
{'acc': 0.95663047, 'precision': 0.6899046, 'recall': 0.7442798, 'specificity': 0.7442798, 'f1': 0.7131895, 'auroc': 0.9067507, 'binary_precision': 0.39712918, 'binary_recall': 0.5163297, 'binary_specificity': 0.9722299, 'binary_f1_score': 0.448952}
confusion matrix:
       0    1
0  17645  504
1    311  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9533397, 'precision': 0.72234213, 'recall': 0.81807375, 'specificity': 0.81807375, 'f1': 0.7602899, 'auroc': 0.9140074, 'binary_precision': 0.4593176, 'binary_recall': 0.6704981, 'binary_specificity': 0.9656495, 'binary_f1_score': 0.5451713}
confusion matrix:
      0    1
0  5791  206
1    86  175
early stop counter: 8
val acc:0.9566304683685303, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 13,now: 2024-07-09 22:02:41.170221,epoch time: 0:20:48.687484,used: 5:13:52.476575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98145163, 'precision': 0.97989106, 'recall': 0.97143614, 'specificity': 0.97143614, 'f1': 0.9755653, 'auroc': 0.99568784, 'binary_precision': 0.97675556, 'binary_recall': 0.9507406, 'binary_specificity': 0.99213177, 'binary_f1_score': 0.9635725}
confusion matrix:
       0      1
0  41989    333
1    725  13993
---- Validation: 
scalar performance:
{'acc': 0.9430609, 'precision': 0.6557421, 'recall': 0.78675824, 'specificity': 0.78675824, 'f1': 0.698312, 'auroc': 0.9061842, 'binary_precision': 0.32542926, 'binary_recall': 0.61897355, 'binary_specificity': 0.95454293, 'binary_f1_score': 0.4265809}
confusion matrix:
       0    1
0  17324  825
1    245  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9298498, 'precision': 0.66657495, 'recall': 0.846129, 'specificity': 0.846129, 'f1': 0.71770656, 'auroc': 0.9165521, 'binary_precision': 0.3444056, 'binary_recall': 0.7547893, 'binary_specificity': 0.9374687, 'binary_f1_score': 0.4729892}
confusion matrix:
      0    1
0  5622  375
1    64  197
early stop counter: 9
val acc:0.9430608749389648, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 14,now: 2024-07-09 22:23:24.937358,epoch time: 0:20:43.767137,used: 5:34:36.243712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98213536, 'precision': 0.98433316, 'recall': 0.9688998, 'specificity': 0.9688998, 'f1': 0.9762958, 'auroc': 0.9957142, 'binary_precision': 0.9886542, 'binary_recall': 0.9415562, 'binary_specificity': 0.99624336, 'binary_f1_score': 0.96453065}
confusion matrix:
       0      1
0  42166    159
1    860  13855
---- Validation: 
scalar performance:
{'acc': 0.95572585, 'precision': 0.6849873, 'recall': 0.7393111, 'specificity': 0.7393111, 'f1': 0.708153, 'auroc': 0.9017993, 'binary_precision': 0.38763377, 'binary_recall': 0.5069984, 'binary_specificity': 0.9716238, 'binary_f1_score': 0.43935308}
confusion matrix:
       0    1
0  17634  515
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95158195, 'precision': 0.71653616, 'recall': 0.82265365, 'specificity': 0.82265365, 'f1': 0.757329, 'auroc': 0.9124684, 'binary_precision': 0.44723618, 'binary_recall': 0.68199235, 'binary_specificity': 0.963315, 'binary_f1_score': 0.54021245}
confusion matrix:
      0    1
0  5777  220
1    83  178
early stop counter: 10
val acc:0.9557258486747742, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 15,now: 2024-07-09 22:44:14.584229,epoch time: 0:20:49.646871,used: 5:55:25.890583,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9826262, 'precision': 0.98312914, 'recall': 0.97131926, 'specificity': 0.97131926, 'f1': 0.977035, 'auroc': 0.995908, 'binary_precision': 0.98412925, 'binary_recall': 0.9479549, 'binary_specificity': 0.9946836, 'binary_f1_score': 0.9657035}
confusion matrix:
       0      1
0  42097    225
1    766  13952
---- Validation: 
scalar performance:
{'acc': 0.95008516, 'precision': 0.67105687, 'recall': 0.7693933, 'specificity': 0.7693933, 'f1': 0.7074387, 'auroc': 0.90653205, 'binary_precision': 0.35748792, 'binary_recall': 0.5754277, 'binary_specificity': 0.9633589, 'binary_f1_score': 0.4410012}
confusion matrix:
       0    1
0  17484  665
1    273  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9443912, 'precision': 0.69614774, 'recall': 0.83356047, 'specificity': 0.83356047, 'f1': 0.7435826, 'auroc': 0.91169727, 'binary_precision': 0.40522876, 'binary_recall': 0.7126437, 'binary_specificity': 0.95447725, 'binary_f1_score': 0.51666665}
confusion matrix:
      0    1
0  5724  273
1    75  186
early stop counter: 11
val acc:0.9500851631164551, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 16,now: 2024-07-09 23:05:01.237370,epoch time: 0:20:46.653141,used: 6:16:12.543724,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9815042, 'precision': 0.98381364, 'recall': 0.9677652, 'specificity': 0.9677652, 'f1': 0.9754425, 'auroc': 0.9956955, 'binary_precision': 0.9883455, 'binary_recall': 0.9393816, 'binary_specificity': 0.9961488, 'binary_f1_score': 0.96324176}
confusion matrix:
       0      1
0  42162    163
1    892  13823
---- Validation: 
scalar performance:
{'acc': 0.95583224, 'precision': 0.6807152, 'recall': 0.7183647, 'specificity': 0.7183647, 'f1': 0.69749874, 'auroc': 0.8980204, 'binary_precision': 0.3805875, 'binary_recall': 0.46345258, 'binary_specificity': 0.9732768, 'binary_f1_score': 0.41795233}
confusion matrix:
       0    1
0  17664  485
1    345  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9511026, 'precision': 0.7113531, 'recall': 0.79491854, 'specificity': 0.79491854, 'f1': 0.74503696, 'auroc': 0.90556836, 'binary_precision': 0.4393531, 'binary_recall': 0.6245211, 'binary_specificity': 0.965316, 'binary_f1_score': 0.51582277}
confusion matrix:
      0    1
0  5789  208
1    98  163
early stop counter: 12
val acc:0.9558322429656982, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 17,now: 2024-07-09 23:25:52.159356,epoch time: 0:20:50.921986,used: 6:37:03.465710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9839937, 'precision': 0.9841362, 'recall': 0.97390413, 'specificity': 0.97390413, 'f1': 0.9788782, 'auroc': 0.9965211, 'binary_precision': 0.9844211, 'binary_recall': 0.9530539, 'binary_specificity': 0.9947544, 'binary_f1_score': 0.96848357}
confusion matrix:
       0      1
0  42099    222
1    691  14028
---- Validation: 
scalar performance:
{'acc': 0.95232016, 'precision': 0.67389685, 'recall': 0.7487987, 'specificity': 0.7487987, 'f1': 0.70365393, 'auroc': 0.9022628, 'binary_precision': 0.3647059, 'binary_recall': 0.5303266, 'binary_specificity': 0.9672709, 'binary_f1_score': 0.43219265}
confusion matrix:
       0    1
0  17555  594
1    302  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94503033, 'precision': 0.69314784, 'recall': 0.80457664, 'specificity': 0.80457664, 'f1': 0.73400116, 'auroc': 0.9052387, 'binary_precision': 0.40189126, 'binary_recall': 0.651341, 'binary_specificity': 0.95781225, 'binary_f1_score': 0.497076}
confusion matrix:
      0    1
0  5744  253
1    91  170
early stop counter: 13
val acc:0.9523201584815979, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 18,now: 2024-07-09 23:46:43.411468,epoch time: 0:20:51.252112,used: 6:57:54.717822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98411644, 'precision': 0.9847441, 'recall': 0.97362924, 'specificity': 0.97362924, 'f1': 0.9790196, 'auroc': 0.9964559, 'binary_precision': 0.9859948, 'binary_recall': 0.9519603, 'binary_specificity': 0.9952981, 'binary_f1_score': 0.9686787}
confusion matrix:
       0      1
0  42124    199
1    707  14010
---- Validation: 
scalar performance:
{'acc': 0.9499255, 'precision': 0.6671176, 'recall': 0.75430954, 'specificity': 0.75430954, 'f1': 0.7001944, 'auroc': 0.9025817, 'binary_precision': 0.3507014, 'binary_recall': 0.5443235, 'binary_specificity': 0.96429557, 'binary_f1_score': 0.42656916}
confusion matrix:
       0    1
0  17501  648
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93847877, 'precision': 0.6789362, 'recall': 0.8194816, 'specificity': 0.8194816, 'f1': 0.72525704, 'auroc': 0.9049771, 'binary_precision': 0.37190083, 'binary_recall': 0.6896552, 'binary_specificity': 0.949308, 'binary_f1_score': 0.48322153}
confusion matrix:
      0    1
0  5693  304
1    81  180
early stop counter: 14
val acc:0.9499254822731018, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 19,now: 2024-07-10 00:07:47.393347,epoch time: 0:21:03.981879,used: 7:18:58.699701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9836956, 'precision': 0.9850122, 'recall': 0.97228533, 'specificity': 0.97228533, 'f1': 0.9784303, 'auroc': 0.9968725, 'binary_precision': 0.9876229, 'binary_recall': 0.94870573, 'binary_specificity': 0.9958649, 'binary_f1_score': 0.9677732}
confusion matrix:
       0      1
0  42146    175
1    755  13964
---- Validation: 
scalar performance:
{'acc': 0.94971263, 'precision': 0.66497576, 'recall': 0.74819887, 'specificity': 0.74819887, 'f1': 0.69680333, 'auroc': 0.9029255, 'binary_precision': 0.346856, 'binary_recall': 0.5318818, 'binary_specificity': 0.9645159, 'binary_f1_score': 0.4198895}
confusion matrix:
       0    1
0  17505  644
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93688077, 'precision': 0.67333794, 'recall': 0.80948615, 'specificity': 0.80948615, 'f1': 0.7181208, 'auroc': 0.90575814, 'binary_precision': 0.36157024, 'binary_recall': 0.6704981, 'binary_specificity': 0.9484742, 'binary_f1_score': 0.46979868}
confusion matrix:
      0    1
0  5688  309
1    86  175
early stop counter: 15
val acc:0.9497126340866089, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 20,now: 2024-07-10 00:28:41.331940,epoch time: 0:20:53.938593,used: 7:39:52.638294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9855715, 'precision': 0.98770404, 'recall': 0.9745686, 'specificity': 0.9745686, 'f1': 0.9809054, 'auroc': 0.996976, 'binary_precision': 0.99192864, 'binary_recall': 0.951831, 'binary_specificity': 0.9973063, 'binary_f1_score': 0.9714662}
confusion matrix:
       0      1
0  42207    114
1    709  14010
---- Validation: 
scalar performance:
{'acc': 0.9550341, 'precision': 0.67619365, 'recall': 0.71420115, 'specificity': 0.71420115, 'f1': 0.6930655, 'auroc': 0.90122795, 'binary_precision': 0.37182742, 'binary_recall': 0.45567653, 'binary_specificity': 0.97272575, 'binary_f1_score': 0.40950388}
confusion matrix:
       0    1
0  17654  495
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9479067, 'precision': 0.69827896, 'recall': 0.782257, 'specificity': 0.782257, 'f1': 0.73158735, 'auroc': 0.9017986, 'binary_precision': 0.41424802, 'binary_recall': 0.6015326, 'binary_specificity': 0.96298146, 'binary_f1_score': 0.49062502}
confusion matrix:
      0    1
0  5775  222
1   104  157
early stop counter: 16
val acc:0.955034077167511, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 21,now: 2024-07-10 00:49:35.932761,epoch time: 0:20:54.600821,used: 8:00:47.239115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.984467, 'precision': 0.98618674, 'recall': 0.9731597, 'specificity': 0.9731597, 'f1': 0.9794451, 'auroc': 0.9966451, 'binary_precision': 0.9895944, 'binary_recall': 0.9497928, 'binary_specificity': 0.99652654, 'binary_f1_score': 0.9692852}
confusion matrix:
       0      1
0  42174    147
1    739  13980
---- Validation: 
scalar performance:
{'acc': 0.95285225, 'precision': 0.6768764, 'recall': 0.7535746, 'specificity': 0.7535746, 'f1': 0.70731604, 'auroc': 0.90889364, 'binary_precision': 0.37033084, 'binary_recall': 0.53965783, 'binary_specificity': 0.9674913, 'binary_f1_score': 0.43924052}
confusion matrix:
       0    1
0  17559  590
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94630873, 'precision': 0.69581294, 'recall': 0.79791427, 'specificity': 0.79791427, 'f1': 0.7343234, 'auroc': 0.9076804, 'binary_precision': 0.4078624, 'binary_recall': 0.6360153, 'binary_specificity': 0.95981324, 'binary_f1_score': 0.49700594}
confusion matrix:
      0    1
0  5756  241
1    95  166
early stop counter: 17
val acc:0.9528522491455078, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 22,now: 2024-07-10 01:10:42.105972,epoch time: 0:21:06.173211,used: 8:21:53.412326,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98525596, 'precision': 0.9857513, 'recall': 0.9756174, 'specificity': 0.9756174, 'f1': 0.9805457, 'auroc': 0.9969573, 'binary_precision': 0.9867415, 'binary_recall': 0.9557005, 'binary_specificity': 0.99553424, 'binary_f1_score': 0.970973}
confusion matrix:
       0      1
0  42133    189
1    652  14066
---- Validation: 
scalar performance:
{'acc': 0.9546083, 'precision': 0.6788883, 'recall': 0.7327321, 'specificity': 0.7327321, 'f1': 0.7017501, 'auroc': 0.9004043, 'binary_precision': 0.37588653, 'binary_recall': 0.49455675, 'binary_specificity': 0.9709075, 'binary_f1_score': 0.42713228}
confusion matrix:
       0    1
0  17621  528
1    325  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9471077, 'precision': 0.69525385, 'recall': 0.78000784, 'specificity': 0.78000784, 'f1': 0.7286736, 'auroc': 0.90183985, 'binary_precision': 0.40837696, 'binary_recall': 0.59770113, 'binary_specificity': 0.9623145, 'binary_f1_score': 0.48522547}
confusion matrix:
      0    1
0  5771  226
1   105  156
early stop counter: 18
val acc:0.9546083211898804, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 23,now: 2024-07-10 01:31:33.908142,epoch time: 0:20:51.802170,used: 8:42:45.214496,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9856767, 'precision': 0.98615205, 'recall': 0.9763191, 'specificity': 0.9763191, 'f1': 0.9811051, 'auroc': 0.99721134, 'binary_precision': 0.9871031, 'binary_recall': 0.9569856, 'binary_specificity': 0.99565256, 'binary_f1_score': 0.97181106}
confusion matrix:
       0      1
0  42140    184
1    633  14083
---- Validation: 
scalar performance:
{'acc': 0.9484887, 'precision': 0.6615691, 'recall': 0.7498154, 'specificity': 0.7498154, 'f1': 0.6946099, 'auroc': 0.8999059, 'binary_precision': 0.33990148, 'binary_recall': 0.5365474, 'binary_specificity': 0.9630834, 'binary_f1_score': 0.41616404}
confusion matrix:
       0    1
0  17479  670
1    298  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9335251, 'precision': 0.661374, 'recall': 0.7875796, 'specificity': 0.7875796, 'f1': 0.70276105, 'auroc': 0.8970456, 'binary_precision': 0.3395445, 'binary_recall': 0.62835246, 'binary_specificity': 0.9468067, 'binary_f1_score': 0.4408602}
confusion matrix:
      0    1
0  5678  319
1    97  164
early stop counter: 19
val acc:0.948488712310791, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 24,now: 2024-07-10 01:52:41.702115,epoch time: 0:21:07.793973,used: 9:03:53.008469,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9862202, 'precision': 0.986819, 'recall': 0.97708285, 'specificity': 0.97708285, 'f1': 0.9818233, 'auroc': 0.99695843, 'binary_precision': 0.9880177, 'binary_recall': 0.95820594, 'binary_specificity': 0.9959598, 'binary_f1_score': 0.97288346}
confusion matrix:
       0      1
0  42154    171
1    615  14100
---- Validation: 
scalar performance:
{'acc': 0.95407623, 'precision': 0.675066, 'recall': 0.7257061, 'specificity': 0.7257061, 'f1': 0.6966909, 'auroc': 0.9001193, 'binary_precision': 0.36873507, 'binary_recall': 0.4805599, 'binary_specificity': 0.9708524, 'binary_f1_score': 0.41728562}
confusion matrix:
       0    1
0  17620  529
1    334  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495046, 'precision': 0.7018656, 'recall': 0.77026445, 'specificity': 0.77026445, 'f1': 0.7302292, 'auroc': 0.89703476, 'binary_precision': 0.4225352, 'binary_recall': 0.57471263, 'binary_specificity': 0.96581626, 'binary_f1_score': 0.487013}
confusion matrix:
      0    1
0  5792  205
1   111  150
early stop counter: 20
val acc:0.9540762305259705, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 25,now: 2024-07-10 02:13:40.857170,epoch time: 0:20:59.155055,used: 9:24:52.163524,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9862553, 'precision': 0.98677444, 'recall': 0.9772173, 'specificity': 0.9772173, 'f1': 0.98187286, 'auroc': 0.9970497, 'binary_precision': 0.98781425, 'binary_recall': 0.9585457, 'binary_specificity': 0.99588895, 'binary_f1_score': 0.97295994}
confusion matrix:
       0      1
0  42151    174
1    610  14105
---- Validation: 
scalar performance:
{'acc': 0.9499255, 'precision': 0.6665846, 'recall': 0.75205934, 'specificity': 0.75205934, 'f1': 0.6991444, 'auroc': 0.9042531, 'binary_precision': 0.34979838, 'binary_recall': 0.53965783, 'binary_specificity': 0.96446085, 'binary_f1_score': 0.42446482}
confusion matrix:
       0    1
0  17504  645
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94183445, 'precision': 0.6800988, 'recall': 0.78275347, 'specificity': 0.78275347, 'f1': 0.71775836, 'auroc': 0.89863896, 'binary_precision': 0.3776722, 'binary_recall': 0.6091954, 'binary_specificity': 0.95631146, 'binary_f1_score': 0.46627563}
confusion matrix:
      0    1
0  5735  262
1   102  159
early stop counter: 21
val acc:0.9499254822731018, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 26,now: 2024-07-10 02:34:46.824461,epoch time: 0:21:05.967291,used: 9:45:58.130815,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9868338, 'precision': 0.9870784, 'recall': 0.9784273, 'specificity': 0.9784273, 'f1': 0.98265207, 'auroc': 0.997447, 'binary_precision': 0.9875698, 'binary_recall': 0.96106017, 'binary_specificity': 0.9957945, 'binary_f1_score': 0.9741347}
confusion matrix:
       0      1
0  42147    178
1    573  14142
---- Validation: 
scalar performance:
{'acc': 0.9536505, 'precision': 0.67825484, 'recall': 0.74648726, 'specificity': 0.74648726, 'f1': 0.70603883, 'auroc': 0.9067415, 'binary_precision': 0.3736142, 'binary_recall': 0.5241057, 'binary_specificity': 0.9688688, 'binary_f1_score': 0.43624595}
confusion matrix:
       0    1
0  17584  565
1    306  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9496644, 'precision': 0.7039199, 'recall': 0.7795095, 'specificity': 0.7795095, 'f1': 0.7347547, 'auroc': 0.9009837, 'binary_precision': 0.42582417, 'binary_recall': 0.59386975, 'binary_specificity': 0.9651492, 'binary_f1_score': 0.49600002}
confusion matrix:
      0    1
0  5788  209
1   106  155
early stop counter: 22
val acc:0.9536504745483398, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 27,now: 2024-07-10 02:55:55.673456,epoch time: 0:21:08.848995,used: 10:07:06.979810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98669356, 'precision': 0.9865992, 'recall': 0.97853476, 'specificity': 0.97853476, 'f1': 0.9824791, 'auroc': 0.9971137, 'binary_precision': 0.98640925, 'binary_recall': 0.96167696, 'binary_specificity': 0.99539256, 'binary_f1_score': 0.9738861}
confusion matrix:
       0      1
0  42128    195
1    564  14153
---- Validation: 
scalar performance:
{'acc': 0.9559919, 'precision': 0.6805494, 'recall': 0.71469706, 'specificity': 0.71469706, 'f1': 0.69592845, 'auroc': 0.8985791, 'binary_precision': 0.38051948, 'binary_recall': 0.45567653, 'binary_specificity': 0.9737176, 'binary_f1_score': 0.41472048}
confusion matrix:
       0    1
0  17672  477
1    350  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95653564, 'precision': 0.73154813, 'recall': 0.77026826, 'specificity': 0.77026826, 'f1': 0.7491807, 'auroc': 0.89653206, 'binary_precision': 0.4820847, 'binary_recall': 0.5670498, 'binary_specificity': 0.9734867, 'binary_f1_score': 0.52112675}
confusion matrix:
      0    1
0  5838  159
1   113  148
early stop counter: 23
val acc:0.9559919238090515, best validation acc: 0.9574286937713623, corresponding to test acc:                         0.9654842019081116 / 0.9654842019081116
after epoch: 28,now: 2024-07-10 03:17:08.166539,epoch time: 0:21:12.493083,used: 10:28:19.472893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9867111, 'precision': 0.98713136, 'recall': 0.97805905, 'specificity': 0.97805905, 'f1': 0.9824844, 'auroc': 0.9974508, 'binary_precision': 0.9879745, 'binary_recall': 0.96018213, 'binary_specificity': 0.99593604, 'binary_f1_score': 0.9738801}
confusion matrix:
       0      1
0  42151    172
1    586  14131
---- Validation: 
scalar performance:
{'acc': 0.95796084, 'precision': 0.6883294, 'recall': 0.70746577, 'specificity': 0.70746577, 'f1': 0.6973692, 'auroc': 0.89890337, 'binary_precision': 0.39662448, 'binary_recall': 0.43856922, 'binary_specificity': 0.97636235, 'binary_f1_score': 0.4165436}
confusion matrix:
       0    1
0  17720  429
1    361  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.73266315, 'recall': 0.75219506, 'specificity': 0.75219506, 'f1': 0.74197555, 'auroc': 0.8939459, 'binary_precision': 0.48591548, 'binary_recall': 0.52873564, 'binary_specificity': 0.9756545, 'binary_f1_score': 0.50642204}
confusion matrix:
      0    1
0  5851  146
1   123  138
better model found
persisted
after epoch: 29,now: 2024-07-10 03:38:14.749196,epoch time: 0:21:06.582657,used: 10:49:26.055550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9871143, 'precision': 0.9859555, 'recall': 0.9802809, 'specificity': 0.9802809, 'f1': 0.9830744, 'auroc': 0.9975073, 'binary_precision': 0.98360544, 'binary_recall': 0.9661616, 'binary_specificity': 0.9944002, 'binary_f1_score': 0.9748054}
confusion matrix:
       0      1
0  42086    237
1    498  14219
---- Validation: 
scalar performance:
{'acc': 0.952533, 'precision': 0.67132413, 'recall': 0.7346579, 'specificity': 0.7346579, 'f1': 0.69726306, 'auroc': 0.90118015, 'binary_precision': 0.3605823, 'binary_recall': 0.5007776, 'binary_specificity': 0.9685382, 'binary_f1_score': 0.41927084}
confusion matrix:
       0    1
0  17578  571
1    321  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95158195, 'precision': 0.70991695, 'recall': 0.77134836, 'specificity': 0.77134836, 'f1': 0.73603904, 'auroc': 0.8962034, 'binary_precision': 0.4385965, 'binary_recall': 0.57471263, 'binary_specificity': 0.967984, 'binary_f1_score': 0.49751243}
confusion matrix:
      0    1
0  5805  192
1   111  150
early stop counter: 1
val acc:0.9525330066680908, best validation acc: 0.957960844039917, corresponding to test acc:                         0.9570150375366211 / 0.9654842019081116
after epoch: 30,now: 2024-07-10 03:59:20.552439,epoch time: 0:21:05.803243,used: 11:10:31.858793,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_48_seed_0_21787675
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:10:31.858793 at 2024-07-10 03:59:20.552439
persisted model performance metric: 

scalar performance:
{'acc': 0.95701504, 'precision': 0.73266315, 'recall': 0.75219506, 'specificity': 0.75219506, 'f1': 0.74197555, 'auroc': 0.8939459, 'binary_precision': 0.48591548, 'binary_recall': 0.52873564, 'binary_specificity': 0.9756545, 'binary_f1_score': 0.50642204}
confusion matrix:
      0    1
0  5851  146
1   123  138
oracle model performance metric: 

scalar performance:
{'acc': 0.9654842, 'precision': 0.783139, 'recall': 0.7914283, 'specificity': 0.7914283, 'f1': 0.78721595, 'auroc': 0.91054976, 'binary_precision': 0.58364314, 'binary_recall': 0.6015326, 'binary_specificity': 0.981324, 'binary_f1_score': 0.5924529}
confusion matrix:
      0    1
0  5885  112
1   104  157
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  16482 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59895 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |   9133 KiB |  11093 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7625    |  195064 K  |  195061 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84572 K  |   84569 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7625    |  195064 K  |  195061 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84572 K  |   84569 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3589    |  120671 K  |  120671 K  |
|       from large pool |      10    |     350    |   85092 K  |   85092 K  |
|       from small pool |      26    |    3579    |   35578 K  |   35578 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84572 K  |   84572 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84572 K  |   84572 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  120672 K  |  120672 K  |
|       from large pool |       3    |     350    |   85092 K  |   85092 K  |
|       from small pool |       0    |    3579    |   35580 K  |   35580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 10 04:11:05 2024]
Finished job 0.
1 of 1 steps (100%) done
