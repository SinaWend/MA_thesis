Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul  9 16:40:58 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674

 Experiment start at: 2024-07-09 16:49:01.101216
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93981415, 'precision': 0.95873225, 'recall': 0.88578856, 'specificity': 0.88578856, 'f1': 0.91499114, 'auroc': 0.9658679, 'binary_precision': 0.99043643, 'binary_recall': 0.774176, 'binary_specificity': 0.99740106, 'binary_f1_score': 0.8690544}
confusion matrix:
       0      1
0  42215    110
1   3323  11392
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.95008516, 'precision': 0.5461988, 'recall': 0.52862555, 'specificity': 0.52862555, 'f1': 0.53446484, 'auroc': 0.79778326, 'binary_precision': 0.124681935, 'binary_recall': 0.07620529, 'binary_specificity': 0.9810458, 'binary_f1_score': 0.09459459}
confusion matrix:
       0    1
0  17805  344
1    594   49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9493448, 'precision': 0.5987438, 'recall': 0.54113936, 'specificity': 0.54113936, 'f1': 0.55507356, 'auroc': 0.8288014, 'binary_precision': 0.23584905, 'binary_recall': 0.09578544, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.13623978}
confusion matrix:
      0   1
0  5916  81
1   236  25
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-09 17:13:22.203420,epoch time: 0:24:21.102204,used: 0:24:21.102204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9545582, 'precision': 0.964977, 'recall': 0.9164927, 'specificity': 0.9164927, 'f1': 0.93751466, 'auroc': 0.9814584, 'binary_precision': 0.983566, 'binary_recall': 0.83785254, 'binary_specificity': 0.9951329, 'binary_f1_score': 0.90488076}
confusion matrix:
       0      1
0  42119    206
1   2386  12329
---- Validation: 
scalar performance:
{'acc': 0.95184124, 'precision': 0.6216699, 'recall': 0.6082905, 'specificity': 0.6082905, 'f1': 0.61451674, 'auroc': 0.85558796, 'binary_precision': 0.27017543, 'binary_recall': 0.23950233, 'binary_specificity': 0.9770786, 'binary_f1_score': 0.2539159}
confusion matrix:
       0    1
0  17733  416
1    489  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542985, 'precision': 0.69994974, 'recall': 0.6390053, 'specificity': 0.6390053, 'f1': 0.66315836, 'auroc': 0.8812095, 'binary_precision': 0.4301676, 'binary_recall': 0.29501915, 'binary_specificity': 0.9829915, 'binary_f1_score': 0.35}
confusion matrix:
      0    1
0  5895  102
1   184   77
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-09 17:35:06.054293,epoch time: 0:21:43.850873,used: 0:46:04.953077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9612728, 'precision': 0.9681454, 'recall': 0.93049085, 'specificity': 0.93049085, 'f1': 0.9473721, 'auroc': 0.98563814, 'binary_precision': 0.9807811, 'binary_recall': 0.86688864, 'binary_specificity': 0.99409306, 'binary_f1_score': 0.9203246}
confusion matrix:
       0      1
0  42073    250
1   1959  12758
---- Validation: 
scalar performance:
{'acc': 0.95508724, 'precision': 0.66129017, 'recall': 0.66322494, 'specificity': 0.66322494, 'f1': 0.6622509, 'auroc': 0.8778895, 'binary_precision': 0.34562212, 'binary_recall': 0.34992224, 'binary_specificity': 0.97652763, 'binary_f1_score': 0.3477589}
confusion matrix:
       0    1
0  17723  426
1    418  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.75162905, 'recall': 0.7135512, 'specificity': 0.7135512, 'f1': 0.73081934, 'auroc': 0.89880514, 'binary_precision': 0.5272727, 'binary_recall': 0.44444445, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.48232847}
confusion matrix:
      0    1
0  5893  104
1   145  116
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-09 17:56:53.269054,epoch time: 0:21:47.214761,used: 1:07:52.167838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9670582, 'precision': 0.9696702, 'recall': 0.94376326, 'specificity': 0.94376326, 'f1': 0.9557879, 'auroc': 0.9886694, 'binary_precision': 0.9746377, 'binary_recall': 0.8956309, 'binary_specificity': 0.9918957, 'binary_f1_score': 0.93346554}
confusion matrix:
       0      1
0  41980    343
1   1536  13181
---- Validation: 
scalar performance:
{'acc': 0.95317155, 'precision': 0.66599715, 'recall': 0.7049863, 'specificity': 0.7049863, 'f1': 0.68311596, 'auroc': 0.890291, 'binary_precision': 0.35205993, 'binary_recall': 0.43856922, 'binary_specificity': 0.97140336, 'binary_f1_score': 0.39058173}
confusion matrix:
       0    1
0  17630  519
1    361  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.75924283, 'recall': 0.7875949, 'specificity': 0.7875949, 'f1': 0.7725786, 'auroc': 0.9064756, 'binary_precision': 0.53608245, 'binary_recall': 0.59770113, 'binary_specificity': 0.97748876, 'binary_f1_score': 0.5652174}
confusion matrix:
      0    1
0  5862  135
1   105  156
new oracle model saved
early stop counter: 1
val acc:0.9531715512275696, best validation acc: 0.9550872445106506, corresponding to test acc:                         0.960210919380188 / 0.9616490602493286
after epoch: 4,now: 2024-07-09 18:18:13.185211,epoch time: 0:21:19.916157,used: 1:29:12.083995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9705996, 'precision': 0.97172797, 'recall': 0.95098364, 'specificity': 0.95098364, 'f1': 0.96076, 'auroc': 0.99008834, 'binary_precision': 0.973908, 'binary_recall': 0.9104498, 'binary_specificity': 0.9915174, 'binary_f1_score': 0.94111043}
confusion matrix:
       0      1
0  41963    359
1   1318  13400
---- Validation: 
scalar performance:
{'acc': 0.9526394, 'precision': 0.6708087, 'recall': 0.73096275, 'specificity': 0.73096275, 'f1': 0.69566476, 'auroc': 0.89738643, 'binary_precision': 0.3598184, 'binary_recall': 0.49300155, 'binary_specificity': 0.9689239, 'binary_f1_score': 0.4160105}
confusion matrix:
       0    1
0  17585  564
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.75306594, 'recall': 0.81266403, 'specificity': 0.81266403, 'f1': 0.7792553, 'auroc': 0.9113414, 'binary_precision': 0.5214724, 'binary_recall': 0.651341, 'binary_specificity': 0.973987, 'binary_f1_score': 0.57921636}
confusion matrix:
      0    1
0  5841  156
1    91  170
early stop counter: 2
val acc:0.9526394009590149, best validation acc: 0.9550872445106506, corresponding to test acc:                         0.960210919380188 / 0.9616490602493286
after epoch: 5,now: 2024-07-09 19:09:21.562990,epoch time: 0:51:08.377779,used: 2:20:20.461774,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97207224, 'precision': 0.9721, 'recall': 0.954455, 'specificity': 0.954455, 'f1': 0.9628453, 'auroc': 0.9908602, 'binary_precision': 0.97215426, 'binary_recall': 0.9180539, 'binary_specificity': 0.99085605, 'binary_f1_score': 0.94432986}
confusion matrix:
       0      1
0  41936    387
1   1206  13511
---- Validation: 
scalar performance:
{'acc': 0.9513091, 'precision': 0.6723307, 'recall': 0.75727594, 'specificity': 0.75727594, 'f1': 0.7050454, 'auroc': 0.9033822, 'binary_precision': 0.3609407, 'binary_recall': 0.5489891, 'binary_specificity': 0.9655628, 'binary_f1_score': 0.4355336}
confusion matrix:
       0    1
0  17524  625
1    290  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9541387, 'precision': 0.72626346, 'recall': 0.82765234, 'specificity': 0.82765234, 'f1': 0.76611674, 'auroc': 0.91548455, 'binary_precision': 0.46632123, 'binary_recall': 0.6896552, 'binary_specificity': 0.9656495, 'binary_f1_score': 0.5564142}
confusion matrix:
      0    1
0  5791  206
1    81  180
early stop counter: 3
val acc:0.951309084892273, best validation acc: 0.9550872445106506, corresponding to test acc:                         0.960210919380188 / 0.9616490602493286
after epoch: 6,now: 2024-07-09 19:33:57.125878,epoch time: 0:24:35.562888,used: 2:44:56.024662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9741936, 'precision': 0.97667193, 'recall': 0.9556352, 'specificity': 0.9556352, 'f1': 0.96554947, 'auroc': 0.99243116, 'binary_precision': 0.9814586, 'binary_recall': 0.9172953, 'binary_specificity': 0.99397516, 'binary_f1_score': 0.9482928}
confusion matrix:
       0      1
0  42070    255
1   1217  13498
---- Validation: 
scalar performance:
{'acc': 0.95732224, 'precision': 0.69051015, 'recall': 0.731887, 'specificity': 0.731887, 'f1': 0.70888, 'auroc': 0.9027353, 'binary_precision': 0.39923954, 'binary_recall': 0.48989114, 'binary_specificity': 0.97388285, 'binary_f1_score': 0.43994412}
confusion matrix:
       0    1
0  17675  474
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9606903, 'precision': 0.75386953, 'recall': 0.81274736, 'specificity': 0.81274736, 'f1': 0.77979225, 'auroc': 0.91591084, 'binary_precision': 0.52307695, 'binary_recall': 0.651341, 'binary_specificity': 0.97415376, 'binary_f1_score': 0.5802048}
confusion matrix:
      0    1
0  5842  155
1    91  170
better model found
persisted
after epoch: 7,now: 2024-07-09 19:55:09.645326,epoch time: 0:21:12.519448,used: 3:06:08.544110,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97587657, 'precision': 0.97671187, 'recall': 0.95994854, 'specificity': 0.95994854, 'f1': 0.96794456, 'auroc': 0.99227893, 'binary_precision': 0.9783466, 'binary_recall': 0.92703307, 'binary_specificity': 0.9928641, 'binary_f1_score': 0.9519989}
confusion matrix:
       0      1
0  42019    302
1   1074  13645
---- Validation: 
scalar performance:
{'acc': 0.9527991, 'precision': 0.6778246, 'recall': 0.7587974, 'specificity': 0.7587974, 'f1': 0.70962036, 'auroc': 0.90608156, 'binary_precision': 0.37184873, 'binary_recall': 0.5505443, 'binary_specificity': 0.96705055, 'binary_f1_score': 0.4438871}
confusion matrix:
       0    1
0  17551  598
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95222116, 'precision': 0.71942174, 'recall': 0.8284842, 'specificity': 0.8284842, 'f1': 0.76121676, 'auroc': 0.9173615, 'binary_precision': 0.4525, 'binary_recall': 0.6934866, 'binary_specificity': 0.9634817, 'binary_f1_score': 0.54765505}
confusion matrix:
      0    1
0  5778  219
1    80  181
early stop counter: 1
val acc:0.9527990818023682, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 8,now: 2024-07-09 20:18:30.012588,epoch time: 0:23:20.367262,used: 3:29:28.911372,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9768408, 'precision': 0.97823846, 'recall': 0.9609901, 'specificity': 0.9609901, 'f1': 0.969208, 'auroc': 0.9931396, 'binary_precision': 0.9809695, 'binary_recall': 0.9282414, 'binary_specificity': 0.9937388, 'binary_f1_score': 0.9538773}
confusion matrix:
       0      1
0  42059    265
1   1056  13660
---- Validation: 
scalar performance:
{'acc': 0.9533844, 'precision': 0.68262327, 'recall': 0.7718514, 'specificity': 0.7718514, 'f1': 0.71711725, 'auroc': 0.91005254, 'binary_precision': 0.38051283, 'binary_recall': 0.5769829, 'binary_specificity': 0.9667199, 'binary_f1_score': 0.45859087}
confusion matrix:
       0    1
0  17545  604
1    272  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949185, 'precision': 0.7105876, 'recall': 0.837894, 'specificity': 0.837894, 'f1': 0.75678396, 'auroc': 0.91812444, 'binary_precision': 0.4338747, 'binary_recall': 0.71647507, 'binary_specificity': 0.959313, 'binary_f1_score': 0.54046243}
confusion matrix:
      0    1
0  5753  244
1    74  187
early stop counter: 2
val acc:0.9533843994140625, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 9,now: 2024-07-09 20:39:20.631893,epoch time: 0:20:50.619305,used: 3:50:19.530677,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97908485, 'precision': 0.9795474, 'recall': 0.96556276, 'specificity': 0.96556276, 'f1': 0.97228783, 'auroc': 0.9945837, 'binary_precision': 0.9804604, 'binary_recall': 0.93762314, 'binary_specificity': 0.9935024, 'binary_f1_score': 0.9585634}
confusion matrix:
       0      1
0  42048    275
1    918  13799
---- Validation: 
scalar performance:
{'acc': 0.94971263, 'precision': 0.6724495, 'recall': 0.7812013, 'specificity': 0.7812013, 'f1': 0.711637, 'auroc': 0.9106665, 'binary_precision': 0.3594041, 'binary_recall': 0.60031104, 'binary_specificity': 0.96209157, 'binary_f1_score': 0.4496214}
confusion matrix:
       0    1
0  17461  688
1    257  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94103545, 'precision': 0.6891386, 'recall': 0.8428036, 'specificity': 0.8428036, 'f1': 0.7392953, 'auroc': 0.9173399, 'binary_precision': 0.3902439, 'binary_recall': 0.7356322, 'binary_specificity': 0.949975, 'binary_f1_score': 0.5099602}
confusion matrix:
      0    1
0  5697  300
1    69  192
early stop counter: 3
val acc:0.9497126340866089, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 10,now: 2024-07-09 21:00:13.282970,epoch time: 0:20:52.651077,used: 4:11:12.181754,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9789271, 'precision': 0.98093367, 'recall': 0.963832, 'specificity': 0.963832, 'f1': 0.9719864, 'auroc': 0.9945233, 'binary_precision': 0.9848572, 'binary_recall': 0.9326492, 'binary_specificity': 0.9950149, 'binary_f1_score': 0.95804244}
confusion matrix:
       0      1
0  42115    211
1    991  13723
---- Validation: 
scalar performance:
{'acc': 0.9533844, 'precision': 0.680003, 'recall': 0.75910044, 'specificity': 0.75910044, 'f1': 0.7113182, 'auroc': 0.9082718, 'binary_precision': 0.37619555, 'binary_recall': 0.5505443, 'binary_specificity': 0.9676566, 'binary_f1_score': 0.44696972}
confusion matrix:
       0    1
0  17562  587
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9483861, 'precision': 0.7075979, 'recall': 0.8338125, 'specificity': 0.8338125, 'f1': 0.7532954, 'auroc': 0.9173348, 'binary_precision': 0.42824075, 'binary_recall': 0.70881224, 'binary_specificity': 0.9588127, 'binary_f1_score': 0.5339105}
confusion matrix:
      0    1
0  5750  247
1    76  185
early stop counter: 4
val acc:0.9533843994140625, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 11,now: 2024-07-09 21:21:02.745837,epoch time: 0:20:49.462867,used: 4:32:01.644621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98054, 'precision': 0.9792284, 'recall': 0.9696901, 'specificity': 0.9696901, 'f1': 0.9743341, 'auroc': 0.99504924, 'binary_precision': 0.97660244, 'binary_recall': 0.9472719, 'binary_specificity': 0.9921083, 'binary_f1_score': 0.96171355}
confusion matrix:
       0      1
0  41989    334
1    776  13941
---- Validation: 
scalar performance:
{'acc': 0.9454555, 'precision': 0.6609759, 'recall': 0.7834977, 'specificity': 0.7834977, 'f1': 0.7023687, 'auroc': 0.9094089, 'binary_precision': 0.3361921, 'binary_recall': 0.6096423, 'binary_specificity': 0.957353, 'binary_f1_score': 0.43338862}
confusion matrix:
       0    1
0  17375  774
1    251  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93208694, 'precision': 0.66949797, 'recall': 0.8399669, 'specificity': 0.8399669, 'f1': 0.7198231, 'auroc': 0.91745555, 'binary_precision': 0.35090908, 'binary_recall': 0.7394636, 'binary_specificity': 0.9404702, 'binary_f1_score': 0.4759556}
confusion matrix:
      0    1
0  5640  357
1    68  193
early stop counter: 5
val acc:0.9454554915428162, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 12,now: 2024-07-09 21:41:56.818277,epoch time: 0:20:54.072440,used: 4:52:55.717061,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9810659, 'precision': 0.9827151, 'recall': 0.96767735, 'specificity': 0.96767735, 'f1': 0.9748902, 'auroc': 0.99542224, 'binary_precision': 0.9859617, 'binary_recall': 0.94000953, 'binary_specificity': 0.9953451, 'binary_f1_score': 0.9624374}
confusion matrix:
       0      1
0  42124    197
1    883  13836
---- Validation: 
scalar performance:
{'acc': 0.95210725, 'precision': 0.67380446, 'recall': 0.7516888, 'specificity': 0.7516888, 'f1': 0.70447904, 'auroc': 0.9080664, 'binary_precision': 0.36430833, 'binary_recall': 0.5365474, 'binary_specificity': 0.96683013, 'binary_f1_score': 0.43396223}
confusion matrix:
       0    1
0  17547  602
1    298  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94263345, 'precision': 0.6898402, 'recall': 0.8234817, 'specificity': 0.8234817, 'f1': 0.73582196, 'auroc': 0.9124607, 'binary_precision': 0.39347827, 'binary_recall': 0.6934866, 'binary_specificity': 0.9534767, 'binary_f1_score': 0.5020805}
confusion matrix:
      0    1
0  5718  279
1    80  181
early stop counter: 6
val acc:0.9521072506904602, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 13,now: 2024-07-09 22:02:49.610027,epoch time: 0:20:52.791750,used: 5:13:48.508811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98211783, 'precision': 0.9831718, 'recall': 0.9699483, 'specificity': 0.9699483, 'f1': 0.97632337, 'auroc': 0.9954361, 'binary_precision': 0.9852576, 'binary_recall': 0.9448107, 'binary_specificity': 0.9950859, 'binary_f1_score': 0.96461034}
confusion matrix:
       0      1
0  42119    208
1    812  13901
---- Validation: 
scalar performance:
{'acc': 0.9538633, 'precision': 0.6780824, 'recall': 0.74209714, 'specificity': 0.74209714, 'f1': 0.7044581, 'auroc': 0.9067675, 'binary_precision': 0.37358916, 'binary_recall': 0.5147745, 'binary_specificity': 0.9694198, 'binary_f1_score': 0.43296272}
confusion matrix:
       0    1
0  17594  555
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94503033, 'precision': 0.69469655, 'recall': 0.8137383, 'specificity': 0.8137383, 'f1': 0.73761225, 'auroc': 0.91052485, 'binary_precision': 0.40415704, 'binary_recall': 0.6704981, 'binary_specificity': 0.9569785, 'binary_f1_score': 0.5043228}
confusion matrix:
      0    1
0  5739  258
1    86  175
early stop counter: 7
val acc:0.9538633227348328, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 14,now: 2024-07-09 22:23:34.404624,epoch time: 0:20:44.794597,used: 5:34:33.303408,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98211783, 'precision': 0.98472595, 'recall': 0.968487, 'specificity': 0.968487, 'f1': 0.9762523, 'auroc': 0.9956603, 'binary_precision': 0.98984116, 'binary_recall': 0.94032896, 'binary_specificity': 0.9966451, 'binary_f1_score': 0.96445006}
confusion matrix:
       0      1
0  42184    142
1    878  13836
---- Validation: 
scalar performance:
{'acc': 0.95455515, 'precision': 0.6783167, 'recall': 0.73120445, 'specificity': 0.73120445, 'f1': 0.70082253, 'auroc': 0.9044806, 'binary_precision': 0.37485173, 'binary_recall': 0.49144635, 'binary_specificity': 0.9709626, 'binary_f1_score': 0.42530283}
confusion matrix:
       0    1
0  17622  527
1    327  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.944551, 'precision': 0.69236445, 'recall': 0.80799115, 'specificity': 0.80799115, 'f1': 0.7342423, 'auroc': 0.90977865, 'binary_precision': 0.4, 'binary_recall': 0.65900385, 'binary_specificity': 0.9569785, 'binary_f1_score': 0.49782926}
confusion matrix:
      0    1
0  5739  258
1    89  172
early stop counter: 8
val acc:0.9545551538467407, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 15,now: 2024-07-09 22:44:24.025439,epoch time: 0:20:49.620815,used: 5:55:22.924223,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98364305, 'precision': 0.98382616, 'recall': 0.9732865, 'specificity': 0.9732865, 'f1': 0.9784057, 'auroc': 0.9961302, 'binary_precision': 0.98419166, 'binary_recall': 0.9518891, 'binary_specificity': 0.99468386, 'binary_f1_score': 0.96777093}
confusion matrix:
       0      1
0  42099    225
1    708  14008
---- Validation: 
scalar performance:
{'acc': 0.94827586, 'precision': 0.6629054, 'recall': 0.7579558, 'specificity': 0.7579558, 'f1': 0.6978638, 'auroc': 0.90554816, 'binary_precision': 0.34197888, 'binary_recall': 0.55365473, 'binary_specificity': 0.96225685, 'binary_f1_score': 0.42280287}
confusion matrix:
       0    1
0  17464  685
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92969, 'precision': 0.6602861, 'recall': 0.81672823, 'specificity': 0.81672823, 'f1': 0.7069048, 'auroc': 0.90974224, 'binary_precision': 0.3345656, 'binary_recall': 0.6934866, 'binary_specificity': 0.93996996, 'binary_f1_score': 0.45137155}
confusion matrix:
      0    1
0  5637  360
1    80  181
early stop counter: 9
val acc:0.9482758641242981, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 16,now: 2024-07-09 23:05:10.409013,epoch time: 0:20:46.383574,used: 6:16:09.307797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98392355, 'precision': 0.98287463, 'recall': 0.97495615, 'specificity': 0.97495615, 'f1': 0.97882986, 'auroc': 0.9962176, 'binary_precision': 0.98076385, 'binary_recall': 0.95643306, 'binary_specificity': 0.9934793, 'binary_f1_score': 0.9684456}
confusion matrix:
       0      1
0  42051    276
1    641  14072
---- Validation: 
scalar performance:
{'acc': 0.9402937, 'precision': 0.6508135, 'recall': 0.7928262, 'specificity': 0.7928262, 'f1': 0.6947882, 'auroc': 0.9114442, 'binary_precision': 0.3150579, 'binary_recall': 0.63452566, 'binary_specificity': 0.95112675, 'binary_f1_score': 0.42105263}
confusion matrix:
       0    1
0  17262  887
1    235  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91722596, 'precision': 0.64077955, 'recall': 0.81755435, 'specificity': 0.81755435, 'f1': 0.6860595, 'auroc': 0.91310215, 'binary_precision': 0.2950558, 'binary_recall': 0.70881224, 'binary_specificity': 0.9262965, 'binary_f1_score': 0.41666663}
confusion matrix:
      0    1
0  5555  442
1    76  185
early stop counter: 10
val acc:0.9402937293052673, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 17,now: 2024-07-09 23:26:02.618418,epoch time: 0:20:52.209405,used: 6:37:01.517202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9840638, 'precision': 0.9817294, 'recall': 0.9764943, 'specificity': 0.9764943, 'f1': 0.97907424, 'auroc': 0.9962779, 'binary_precision': 0.97699004, 'binary_recall': 0.96085626, 'binary_specificity': 0.9921323, 'binary_f1_score': 0.968856}
confusion matrix:
       0      1
0  41992    333
1    576  14139
---- Validation: 
scalar performance:
{'acc': 0.9371541, 'precision': 0.639236, 'recall': 0.77169937, 'specificity': 0.77169937, 'f1': 0.6798321, 'auroc': 0.9047475, 'binary_precision': 0.29339477, 'binary_recall': 0.5940902, 'binary_specificity': 0.9493085, 'binary_f1_score': 0.39280203}
confusion matrix:
       0    1
0  17229  920
1    261  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91706616, 'precision': 0.63929373, 'recall': 0.811974, 'specificity': 0.811974, 'f1': 0.68380827, 'auroc': 0.90734404, 'binary_precision': 0.2926045, 'binary_recall': 0.697318, 'binary_specificity': 0.92662996, 'binary_f1_score': 0.41223103}
confusion matrix:
      0    1
0  5557  440
1    79  182
early stop counter: 11
val acc:0.9371541142463684, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 18,now: 2024-07-09 23:46:51.142669,epoch time: 0:20:48.524251,used: 6:57:50.041453,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9844495, 'precision': 0.9845839, 'recall': 0.9746485, 'specificity': 0.9746485, 'f1': 0.9794824, 'auroc': 0.99677557, 'binary_precision': 0.98485273, 'binary_recall': 0.9544003, 'binary_specificity': 0.99489665, 'binary_f1_score': 0.96938735}
confusion matrix:
       0      1
0  42109    216
1    671  14044
---- Validation: 
scalar performance:
{'acc': 0.94896764, 'precision': 0.65949595, 'recall': 0.7358123, 'specificity': 0.7358123, 'f1': 0.68902934, 'auroc': 0.90201557, 'binary_precision': 0.33677685, 'binary_recall': 0.5069984, 'binary_specificity': 0.96462613, 'binary_f1_score': 0.40471753}
confusion matrix:
       0    1
0  17507  642
1    317  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93799937, 'precision': 0.67377985, 'recall': 0.7990758, 'specificity': 0.7990758, 'f1': 0.7163277, 'auroc': 0.9030545, 'binary_precision': 0.36344087, 'binary_recall': 0.6475096, 'binary_specificity': 0.950642, 'binary_f1_score': 0.46556476}
confusion matrix:
      0    1
0  5701  296
1    92  169
early stop counter: 12
val acc:0.9489676356315613, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 19,now: 2024-07-10 00:07:50.436833,epoch time: 0:20:59.294164,used: 7:18:49.335617,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9858871, 'precision': 0.9840927, 'recall': 0.9789187, 'specificity': 0.9789187, 'f1': 0.98146915, 'auroc': 0.9969865, 'binary_precision': 0.980449, 'binary_recall': 0.96452355, 'binary_specificity': 0.9933138, 'binary_f1_score': 0.9724211}
confusion matrix:
       0      1
0  42043    283
1    522  14192
---- Validation: 
scalar performance:
{'acc': 0.9476905, 'precision': 0.6603843, 'recall': 0.75465256, 'specificity': 0.75465256, 'f1': 0.6949625, 'auroc': 0.9046596, 'binary_precision': 0.33716476, 'binary_recall': 0.5474339, 'binary_specificity': 0.9618712, 'binary_f1_score': 0.41730884}
confusion matrix:
       0    1
0  17457  692
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93720037, 'precision': 0.67297596, 'recall': 0.80415595, 'specificity': 0.80415595, 'f1': 0.7166963, 'auroc': 0.903782, 'binary_precision': 0.36134455, 'binary_recall': 0.65900385, 'binary_specificity': 0.949308, 'binary_f1_score': 0.46675715}
confusion matrix:
      0    1
0  5693  304
1    89  172
early stop counter: 13
val acc:0.947690486907959, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 20,now: 2024-07-10 00:28:43.163888,epoch time: 0:20:52.727055,used: 7:39:42.062672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9856066, 'precision': 0.98529017, 'recall': 0.97698236, 'specificity': 0.97698236, 'f1': 0.98104274, 'auroc': 0.996784, 'binary_precision': 0.984654, 'binary_recall': 0.9591629, 'binary_specificity': 0.9948019, 'binary_f1_score': 0.9717413}
confusion matrix:
       0      1
0  42103    220
1    601  14116
---- Validation: 
scalar performance:
{'acc': 0.94737124, 'precision': 0.65941817, 'recall': 0.7544873, 'specificity': 0.7544873, 'f1': 0.6941371, 'auroc': 0.9038286, 'binary_precision': 0.3352381, 'binary_recall': 0.5474339, 'binary_specificity': 0.9615406, 'binary_f1_score': 0.4158299}
confusion matrix:
       0    1
0  17451  698
1    291  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9338447, 'precision': 0.6660967, 'recall': 0.80606973, 'specificity': 0.80606973, 'f1': 0.71073544, 'auroc': 0.9056139, 'binary_precision': 0.3473054, 'binary_recall': 0.6666667, 'binary_specificity': 0.9454727, 'binary_f1_score': 0.4566929}
confusion matrix:
      0    1
0  5670  327
1    87  174
early stop counter: 14
val acc:0.947371244430542, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 21,now: 2024-07-10 00:49:37.682159,epoch time: 0:20:54.518271,used: 8:00:36.580943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98704416, 'precision': 0.9860602, 'recall': 0.9799876, 'specificity': 0.9799876, 'f1': 0.98297393, 'auroc': 0.9973546, 'binary_precision': 0.9840676, 'binary_recall': 0.96540946, 'binary_specificity': 0.99456584, 'binary_f1_score': 0.97464925}
confusion matrix:
       0      1
0  42095    230
1    509  14206
---- Validation: 
scalar performance:
{'acc': 0.9415709, 'precision': 0.6441912, 'recall': 0.75373447, 'specificity': 0.75373447, 'f1': 0.68100405, 'auroc': 0.90087247, 'binary_precision': 0.30472103, 'binary_recall': 0.5520995, 'binary_specificity': 0.9553694, 'binary_f1_score': 0.3926991}
confusion matrix:
       0    1
0  17339  810
1    288  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9303292, 'precision': 0.65502286, 'recall': 0.78774446, 'specificity': 0.78774446, 'f1': 0.6968515, 'auroc': 0.89929754, 'binary_precision': 0.32673267, 'binary_recall': 0.6321839, 'binary_specificity': 0.943305, 'binary_f1_score': 0.4308094}
confusion matrix:
      0    1
0  5657  340
1    96  165
early stop counter: 15
val acc:0.9415708780288696, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 22,now: 2024-07-10 01:10:43.086412,epoch time: 0:21:05.404253,used: 8:21:41.985196,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9865007, 'precision': 0.98577344, 'recall': 0.97884804, 'specificity': 0.97884804, 'f1': 0.9822457, 'auroc': 0.9971094, 'binary_precision': 0.9843045, 'binary_recall': 0.96303594, 'binary_specificity': 0.99466014, 'binary_f1_score': 0.9735541}
confusion matrix:
       0      1
0  42097    226
1    544  14173
---- Validation: 
scalar performance:
{'acc': 0.9438591, 'precision': 0.64751714, 'recall': 0.74516845, 'specificity': 0.74516845, 'f1': 0.6819486, 'auroc': 0.8997567, 'binary_precision': 0.3120438, 'binary_recall': 0.5318818, 'binary_specificity': 0.958455, 'binary_f1_score': 0.3933295}
confusion matrix:
       0    1
0  17395  754
1    301  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9338447, 'precision': 0.66082764, 'recall': 0.78224933, 'specificity': 0.78224933, 'f1': 0.70117784, 'auroc': 0.89960563, 'binary_precision': 0.33894736, 'binary_recall': 0.61685824, 'binary_specificity': 0.9476405, 'binary_f1_score': 0.4375}
confusion matrix:
      0    1
0  5683  314
1   100  161
early stop counter: 16
val acc:0.9438591003417969, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 23,now: 2024-07-10 01:31:36.745370,epoch time: 0:20:53.658958,used: 8:42:35.644154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9867812, 'precision': 0.98550296, 'recall': 0.9798537, 'specificity': 0.9798537, 'f1': 0.98263496, 'auroc': 0.99764234, 'binary_precision': 0.9829113, 'binary_recall': 0.96554303, 'binary_specificity': 0.99416435, 'binary_f1_score': 0.9741497}
confusion matrix:
       0      1
0  42079    247
1    507  14207
---- Validation: 
scalar performance:
{'acc': 0.9483823, 'precision': 0.659158, 'recall': 0.7415097, 'specificity': 0.7415097, 'f1': 0.69041467, 'auroc': 0.9004922, 'binary_precision': 0.3356784, 'binary_recall': 0.5194401, 'binary_specificity': 0.96357924, 'binary_f1_score': 0.40781438}
confusion matrix:
       0    1
0  17488  661
1    309  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94183445, 'precision': 0.6800988, 'recall': 0.78275347, 'specificity': 0.78275347, 'f1': 0.71775836, 'auroc': 0.8982468, 'binary_precision': 0.3776722, 'binary_recall': 0.6091954, 'binary_specificity': 0.95631146, 'binary_f1_score': 0.46627563}
confusion matrix:
      0    1
0  5735  262
1   102  159
early stop counter: 17
val acc:0.9483823180198669, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 24,now: 2024-07-10 01:52:42.959350,epoch time: 0:21:06.213980,used: 9:03:41.858134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98648316, 'precision': 0.98683864, 'recall': 0.97774637, 'specificity': 0.97774637, 'f1': 0.9821811, 'auroc': 0.9973661, 'binary_precision': 0.98755157, 'binary_recall': 0.95969826, 'binary_specificity': 0.99579453, 'binary_f1_score': 0.9734257}
confusion matrix:
       0      1
0  42148    178
1    593  14121
---- Validation: 
scalar performance:
{'acc': 0.9537037, 'precision': 0.67390513, 'recall': 0.72701335, 'specificity': 0.72701335, 'f1': 0.6963925, 'auroc': 0.9011928, 'binary_precision': 0.3663133, 'binary_recall': 0.4836703, 'binary_specificity': 0.97035646, 'binary_f1_score': 0.41689008}
confusion matrix:
       0    1
0  17611  538
1    332  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.733897, 'recall': 0.78142905, 'specificity': 0.78142905, 'f1': 0.75512755, 'auroc': 0.8993213, 'binary_precision': 0.4858044, 'binary_recall': 0.5900383, 'binary_specificity': 0.97281975, 'binary_f1_score': 0.53287196}
confusion matrix:
      0    1
0  5834  163
1   107  154
early stop counter: 18
val acc:0.9537037014961243, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9606903195381165 / 0.9616490602493286
after epoch: 25,now: 2024-07-10 02:13:43.988003,epoch time: 0:21:01.028653,used: 9:24:42.886787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9876753, 'precision': 0.9880388, 'recall': 0.9796839, 'specificity': 0.9796839, 'f1': 0.98376745, 'auroc': 0.997246, 'binary_precision': 0.98876953, 'binary_recall': 0.96317184, 'binary_specificity': 0.9961959, 'binary_f1_score': 0.97580284}
confusion matrix:
       0      1
0  42162    161
1    542  14175
---- Validation: 
scalar performance:
{'acc': 0.9593976, 'precision': 0.69601727, 'recall': 0.70745957, 'specificity': 0.70745957, 'f1': 0.70155394, 'auroc': 0.90578675, 'binary_precision': 0.41202345, 'binary_recall': 0.43701398, 'binary_specificity': 0.9779051, 'binary_f1_score': 0.42415094}
confusion matrix:
       0    1
0  17748  401
1    362  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.75843656, 'recall': 0.74894917, 'specificity': 0.74894917, 'f1': 0.7535919, 'auroc': 0.8990803, 'binary_precision': 0.5378486, 'binary_recall': 0.51724136, 'binary_specificity': 0.980657, 'binary_f1_score': 0.5273437}
confusion matrix:
      0    1
0  5881  116
1   126  135
better model found
persisted
after epoch: 26,now: 2024-07-10 02:34:47.244108,epoch time: 0:21:03.256105,used: 9:45:46.142892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9882188, 'precision': 0.9869623, 'recall': 0.98217463, 'specificity': 0.98217463, 'f1': 0.98453736, 'auroc': 0.9978634, 'binary_precision': 0.98440737, 'binary_recall': 0.9696887, 'binary_specificity': 0.9946605, 'binary_f1_score': 0.9769926}
confusion matrix:
       0      1
0  42100    226
1    446  14268
---- Validation: 
scalar performance:
{'acc': 0.951788, 'precision': 0.67054784, 'recall': 0.74252284, 'specificity': 0.74252284, 'f1': 0.6992529, 'auroc': 0.9073839, 'binary_precision': 0.35844994, 'binary_recall': 0.5178849, 'binary_specificity': 0.9671607, 'binary_f1_score': 0.42366412}
confusion matrix:
       0    1
0  17553  596
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.7341788, 'recall': 0.77418303, 'specificity': 0.77418303, 'f1': 0.7523623, 'auroc': 0.89948374, 'binary_precision': 0.48701298, 'binary_recall': 0.57471263, 'binary_specificity': 0.9736535, 'binary_f1_score': 0.52724075}
confusion matrix:
      0    1
0  5839  158
1   111  150
early stop counter: 1
val acc:0.9517880082130432, best validation acc: 0.9593976140022278, corresponding to test acc:                         0.9613295197486877 / 0.9616490602493286
after epoch: 27,now: 2024-07-10 02:55:55.673455,epoch time: 0:21:08.429347,used: 10:06:54.572239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98830646, 'precision': 0.98835504, 'recall': 0.9810111, 'specificity': 0.9810111, 'f1': 0.98461056, 'auroc': 0.9974611, 'binary_precision': 0.988453, 'binary_recall': 0.9659439, 'binary_specificity': 0.9960783, 'binary_f1_score': 0.97706884}
confusion matrix:
       0      1
0  42163    166
1    501  14210
---- Validation: 
scalar performance:
{'acc': 0.95769477, 'precision': 0.68996143, 'recall': 0.720829, 'specificity': 0.720829, 'f1': 0.70406973, 'auroc': 0.9069258, 'binary_precision': 0.39893618, 'binary_recall': 0.466563, 'binary_specificity': 0.97509503, 'binary_f1_score': 0.43010753}
confusion matrix:
       0    1
0  17697  452
1    343  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.778721, 'recall': 0.76335967, 'specificity': 0.76335967, 'f1': 0.77079415, 'auroc': 0.90031797, 'binary_precision': 0.57723576, 'binary_recall': 0.5440613, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.5601577}
confusion matrix:
      0    1
0  5893  104
1   119  142
new oracle model saved
early stop counter: 2
val acc:0.9576947689056396, best validation acc: 0.9593976140022278, corresponding to test acc:                         0.9613295197486877 / 0.9643656015396118
after epoch: 28,now: 2024-07-10 03:17:08.365963,epoch time: 0:21:12.692508,used: 10:28:07.264747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9889025, 'precision': 0.9891919, 'recall': 0.9817507, 'specificity': 0.9817507, 'f1': 0.985397, 'auroc': 0.9979702, 'binary_precision': 0.98977536, 'binary_recall': 0.96697474, 'binary_specificity': 0.9965268, 'binary_f1_score': 0.97824216}
confusion matrix:
       0      1
0  42177    147
1    486  14230
---- Validation: 
scalar performance:
{'acc': 0.9571094, 'precision': 0.6853758, 'recall': 0.71302545, 'specificity': 0.71302545, 'f1': 0.698102, 'auroc': 0.90590215, 'binary_precision': 0.39030954, 'binary_recall': 0.45101088, 'binary_specificity': 0.97503996, 'binary_f1_score': 0.41847044}
confusion matrix:
       0    1
0  17696  453
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9653244, 'precision': 0.78625166, 'recall': 0.76202756, 'specificity': 0.76202756, 'f1': 0.7735362, 'auroc': 0.9004935, 'binary_precision': 0.59243697, 'binary_recall': 0.54022986, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.56513023}
confusion matrix:
      0    1
0  5900   97
1   120  141
new oracle model saved
early stop counter: 3
val acc:0.9571093916893005, best validation acc: 0.9593976140022278, corresponding to test acc:                         0.9613295197486877 / 0.9653244018554688
after epoch: 29,now: 2024-07-10 03:38:14.657337,epoch time: 0:21:06.291374,used: 10:49:13.556121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9876578, 'precision': 0.9893371, 'recall': 0.9783854, 'specificity': 0.9783854, 'f1': 0.9837011, 'auroc': 0.99751866, 'binary_precision': 0.99268633, 'binary_recall': 0.95922804, 'binary_specificity': 0.99754274, 'binary_f1_score': 0.97567046}
confusion matrix:
       0      1
0  42220    104
1    600  14116
---- Validation: 
scalar performance:
{'acc': 0.9605683, 'precision': 0.6972332, 'recall': 0.6803136, 'specificity': 0.6803136, 'f1': 0.68834424, 'auroc': 0.90110767, 'binary_precision': 0.41638225, 'binary_recall': 0.37947124, 'binary_specificity': 0.981156, 'binary_f1_score': 0.3970708}
confusion matrix:
       0    1
0  17807  342
1    399  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.81162417, 'recall': 0.7318784, 'specificity': 0.7318784, 'f1': 0.7652336, 'auroc': 0.8959154, 'binary_precision': 0.6458333, 'binary_recall': 0.47509578, 'binary_specificity': 0.988661, 'binary_f1_score': 0.54746133}
confusion matrix:
      0    1
0  5929   68
1   137  124
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-10 03:59:20.777734,epoch time: 0:21:06.120397,used: 11:10:19.676518,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_49_01_seed_0_21787674
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:10:19.676518 at 2024-07-10 03:59:20.777734
persisted model performance metric: 

scalar performance:
{'acc': 0.96724194, 'precision': 0.81162417, 'recall': 0.7318784, 'specificity': 0.7318784, 'f1': 0.7652336, 'auroc': 0.8959154, 'binary_precision': 0.6458333, 'binary_recall': 0.47509578, 'binary_specificity': 0.988661, 'binary_f1_score': 0.54746133}
confusion matrix:
      0    1
0  5929   68
1   137  124
oracle model performance metric: 

scalar performance:
{'acc': 0.96724194, 'precision': 0.81162417, 'recall': 0.7318784, 'specificity': 0.7318784, 'f1': 0.7652336, 'auroc': 0.8959154, 'binary_precision': 0.6458333, 'binary_recall': 0.47509578, 'binary_specificity': 0.988661, 'binary_f1_score': 0.54746133}
confusion matrix:
      0    1
0  5929   68
1   137  124
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  16482 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59895 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |   9133 KiB |  11093 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7625    |  195065 K  |  195062 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84573 K  |   84570 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7625    |  195065 K  |  195062 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84573 K  |   84570 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3589    |  120671 K  |  120671 K  |
|       from large pool |      10    |     350    |   85092 K  |   85092 K  |
|       from small pool |      26    |    3579    |   35579 K  |   35579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  195065 K  |  195065 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84573 K  |   84573 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  195065 K  |  195065 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84573 K  |   84573 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  120672 K  |  120672 K  |
|       from large pool |       3    |     350    |   85092 K  |   85092 K  |
|       from small pool |       0    |    3579    |   35580 K  |   35580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 10 04:11:05 2024]
Finished job 0.
1 of 1 steps (100%) done
