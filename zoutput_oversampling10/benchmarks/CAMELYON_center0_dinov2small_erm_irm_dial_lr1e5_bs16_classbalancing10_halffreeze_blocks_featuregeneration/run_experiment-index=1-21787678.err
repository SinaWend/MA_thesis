Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul  9 16:41:00 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678

 Experiment start at: 2024-07-09 16:48:03.191595
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9392006, 'precision': 0.9586282, 'recall': 0.8844452, 'specificity': 0.8844452, 'f1': 0.9140209, 'auroc': 0.9648646, 'binary_precision': 0.9910948, 'binary_recall': 0.77130044, 'binary_specificity': 0.9975899, 'binary_f1_score': 0.867492}
confusion matrix:
       0      1
0  42220    102
1   3366  11352
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.94971263, 'precision': 0.5431443, 'recall': 0.5269326, 'specificity': 0.5269326, 'f1': 0.53230655, 'auroc': 0.79039824, 'binary_precision': 0.11868687, 'binary_recall': 0.07309487, 'binary_specificity': 0.9807703, 'binary_f1_score': 0.09047161}
confusion matrix:
       0    1
0  17800  349
1    596   47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9483861, 'precision': 0.58981633, 'recall': 0.53880674, 'specificity': 0.53880674, 'f1': 0.5513924, 'auroc': 0.82777464, 'binary_precision': 0.21818182, 'binary_recall': 0.09195402, 'binary_specificity': 0.9856595, 'binary_f1_score': 0.12938006}
confusion matrix:
      0   1
0  5911  86
1   237  24
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-09 17:12:43.823159,epoch time: 0:24:40.631564,used: 0:24:40.631564,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95368165, 'precision': 0.9660721, 'recall': 0.9135532, 'specificity': 0.9135532, 'f1': 0.93605745, 'auroc': 0.980698, 'binary_precision': 0.9879596, 'binary_recall': 0.8306271, 'binary_specificity': 0.9964793, 'binary_f1_score': 0.90248764}
confusion matrix:
       0      1
0  42172    149
1   2493  12226
---- Validation: 
scalar performance:
{'acc': 0.9535441, 'precision': 0.62579566, 'recall': 0.6024216, 'specificity': 0.6024216, 'f1': 0.6126927, 'auroc': 0.85408676, 'binary_precision': 0.27884614, 'binary_recall': 0.22550544, 'binary_specificity': 0.9793377, 'binary_f1_score': 0.2493551}
confusion matrix:
       0    1
0  17774  375
1    498  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550975, 'precision': 0.70531225, 'recall': 0.63575757, 'specificity': 0.63575757, 'f1': 0.66238797, 'auroc': 0.8815169, 'binary_precision': 0.44117647, 'binary_recall': 0.28735632, 'binary_specificity': 0.98415875, 'binary_f1_score': 0.34802786}
confusion matrix:
      0   1
0  5902  95
1   186  75
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-09 17:34:44.737094,epoch time: 0:22:00.913935,used: 0:46:41.545499,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9629208, 'precision': 0.9697645, 'recall': 0.93323696, 'specificity': 0.93323696, 'f1': 0.9496757, 'auroc': 0.9867871, 'binary_precision': 0.98239034, 'binary_recall': 0.8719081, 'binary_specificity': 0.9945657, 'binary_f1_score': 0.9238579}
confusion matrix:
       0      1
0  42094    230
1   1885  12831
---- Validation: 
scalar performance:
{'acc': 0.9551405, 'precision': 0.6628537, 'recall': 0.66700274, 'specificity': 0.66700274, 'f1': 0.66489804, 'auroc': 0.87676513, 'binary_precision': 0.34848484, 'binary_recall': 0.3576983, 'binary_specificity': 0.9763072, 'binary_f1_score': 0.35303146}
confusion matrix:
       0    1
0  17719  430
1    413  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.74135166, 'recall': 0.71646553, 'specificity': 0.71646553, 'f1': 0.72813606, 'auroc': 0.8990536, 'binary_precision': 0.5064378, 'binary_recall': 0.45210728, 'binary_specificity': 0.98082376, 'binary_f1_score': 0.47773278}
confusion matrix:
      0    1
0  5882  115
1   143  118
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-09 17:56:16.719265,epoch time: 0:21:31.982171,used: 1:08:13.527670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9658836, 'precision': 0.9704907, 'recall': 0.9400428, 'specificity': 0.9400428, 'f1': 0.9539931, 'auroc': 0.9878646, 'binary_precision': 0.97913855, 'binary_recall': 0.88665396, 'binary_specificity': 0.9934316, 'binary_f1_score': 0.9306041}
confusion matrix:
       0      1
0  42046    278
1   1668  13048
---- Validation: 
scalar performance:
{'acc': 0.9549276, 'precision': 0.6655173, 'recall': 0.6781434, 'specificity': 0.6781434, 'f1': 0.6715623, 'auroc': 0.8858825, 'binary_precision': 0.35302594, 'binary_recall': 0.38102645, 'binary_specificity': 0.9752603, 'binary_f1_score': 0.36649212}
confusion matrix:
       0    1
0  17700  449
1    398  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.7646624, 'recall': 0.7549465, 'specificity': 0.7549465, 'f1': 0.75970113, 'auroc': 0.9050317, 'binary_precision': 0.5498008, 'binary_recall': 0.52873564, 'binary_specificity': 0.98115724, 'binary_f1_score': 0.53906244}
confusion matrix:
      0    1
0  5884  113
1   123  138
new oracle model saved
early stop counter: 1
val acc:0.9549276232719421, best validation acc: 0.9551404714584351, corresponding to test acc:                         0.9587727785110474 / 0.9622882604598999
after epoch: 4,now: 2024-07-09 18:17:58.973517,epoch time: 0:21:42.254252,used: 1:29:55.781922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96796983, 'precision': 0.9727524, 'recall': 0.9433325, 'specificity': 0.9433325, 'f1': 0.95685935, 'auroc': 0.9887984, 'binary_precision': 0.9817597, 'binary_recall': 0.89243, 'binary_specificity': 0.994235, 'binary_f1_score': 0.934966}
confusion matrix:
       0      1
0  42080    244
1   1583  13133
---- Validation: 
scalar performance:
{'acc': 0.957748, 'precision': 0.68524987, 'recall': 0.69910496, 'specificity': 0.69910496, 'f1': 0.69189197, 'auroc': 0.89460206, 'binary_precision': 0.39105338, 'binary_recall': 0.4214619, 'binary_specificity': 0.97674805, 'binary_f1_score': 0.4056886}
confusion matrix:
       0    1
0  17727  422
1    372  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9643656, 'precision': 0.77625066, 'recall': 0.78534764, 'specificity': 0.78534764, 'f1': 0.7807156, 'auroc': 0.9106629, 'binary_precision': 0.5703704, 'binary_recall': 0.5900383, 'binary_specificity': 0.980657, 'binary_f1_score': 0.58003765}
confusion matrix:
      0    1
0  5881  116
1   107  154
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-09 19:09:21.782029,epoch time: 0:51:22.808512,used: 2:21:18.590434,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97217745, 'precision': 0.9733609, 'recall': 0.9535259, 'specificity': 0.9535259, 'f1': 0.96290064, 'auroc': 0.99114215, 'binary_precision': 0.97565395, 'binary_recall': 0.9149905, 'binary_specificity': 0.99206126, 'binary_f1_score': 0.944349}
confusion matrix:
       0      1
0  41988    336
1   1251  13465
---- Validation: 
scalar performance:
{'acc': 0.9542891, 'precision': 0.6801211, 'recall': 0.7438177, 'specificity': 0.7438177, 'f1': 0.70644957, 'auroc': 0.8993136, 'binary_precision': 0.37755102, 'binary_recall': 0.5178849, 'binary_specificity': 0.9697504, 'binary_f1_score': 0.4367213}
confusion matrix:
       0    1
0  17600  549
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.75152683, 'recall': 0.81616193, 'specificity': 0.81616193, 'f1': 0.7796086, 'auroc': 0.9117191, 'binary_precision': 0.5180723, 'binary_recall': 0.65900385, 'binary_specificity': 0.97332, 'binary_f1_score': 0.58010125}
confusion matrix:
      0    1
0  5837  160
1    89  172
early stop counter: 1
val acc:0.9542890787124634, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 6,now: 2024-07-09 19:33:57.216698,epoch time: 0:24:35.434669,used: 2:45:54.025103,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9735098, 'precision': 0.9741188, 'recall': 0.9562606, 'specificity': 0.9562606, 'f1': 0.9647497, 'auroc': 0.9916169, 'binary_precision': 0.975306, 'binary_recall': 0.9206252, 'binary_specificity': 0.99189603, 'binary_f1_score': 0.94717705}
confusion matrix:
       0      1
0  41982    343
1   1168  13547
---- Validation: 
scalar performance:
{'acc': 0.95349085, 'precision': 0.6792841, 'recall': 0.7539052, 'specificity': 0.7539052, 'f1': 0.7091675, 'auroc': 0.90306115, 'binary_precision': 0.37513512, 'binary_recall': 0.53965783, 'binary_specificity': 0.9681525, 'binary_f1_score': 0.44260204}
confusion matrix:
       0    1
0  17571  578
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.7444577, 'recall': 0.8281545, 'specificity': 0.8281545, 'f1': 0.77923024, 'auroc': 0.91413784, 'binary_precision': 0.502809, 'binary_recall': 0.68582374, 'binary_specificity': 0.97048527, 'binary_f1_score': 0.5802269}
confusion matrix:
      0    1
0  5820  177
1    82  179
early stop counter: 2
val acc:0.9534908533096313, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 7,now: 2024-07-09 19:57:15.018647,epoch time: 0:23:17.801949,used: 3:09:11.827052,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97512275, 'precision': 0.97649765, 'recall': 0.95819986, 'specificity': 0.95819986, 'f1': 0.9668898, 'auroc': 0.9924555, 'binary_precision': 0.9791757, 'binary_recall': 0.9232285, 'binary_specificity': 0.9931712, 'binary_f1_score': 0.95037943}
confusion matrix:
       0      1
0  42032    289
1   1130  13589
---- Validation: 
scalar performance:
{'acc': 0.9553533, 'precision': 0.68576217, 'recall': 0.7503691, 'specificity': 0.7503691, 'f1': 0.7125622, 'auroc': 0.9068903, 'binary_precision': 0.38838267, 'binary_recall': 0.5303266, 'binary_specificity': 0.9704116, 'binary_f1_score': 0.4483892}
confusion matrix:
       0    1
0  17612  537
1    302  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.74820817, 'recall': 0.8340684, 'specificity': 0.8340684, 'f1': 0.7838243, 'auroc': 0.91584045, 'binary_precision': 0.50980395, 'binary_recall': 0.697318, 'binary_specificity': 0.97081876, 'binary_f1_score': 0.58899677}
confusion matrix:
      0    1
0  5822  175
1    79  182
early stop counter: 3
val acc:0.955353319644928, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 8,now: 2024-07-09 20:19:38.662701,epoch time: 0:22:23.644054,used: 3:31:35.471106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9764551, 'precision': 0.9753337, 'recall': 0.96278924, 'specificity': 0.96278924, 'f1': 0.9688436, 'auroc': 0.99310005, 'binary_precision': 0.9731107, 'binary_recall': 0.9345566, 'binary_specificity': 0.9910219, 'binary_f1_score': 0.953444}
confusion matrix:
       0      1
0  41945    380
1    963  13752
---- Validation: 
scalar performance:
{'acc': 0.9519476, 'precision': 0.67779744, 'recall': 0.7726077, 'specificity': 0.7726077, 'f1': 0.7136333, 'auroc': 0.90799975, 'binary_precision': 0.37077534, 'binary_recall': 0.5800933, 'binary_specificity': 0.96512204, 'binary_f1_score': 0.45239538}
confusion matrix:
       0    1
0  17516  633
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95190156, 'precision': 0.72030604, 'recall': 0.84664077, 'specificity': 0.84664077, 'f1': 0.7669299, 'auroc': 0.91659176, 'binary_precision': 0.45260665, 'binary_recall': 0.7318008, 'binary_specificity': 0.96148074, 'binary_f1_score': 0.55929726}
confusion matrix:
      0    1
0  5766  231
1    70  191
early stop counter: 4
val acc:0.9519476294517517, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 9,now: 2024-07-09 20:40:56.253667,epoch time: 0:21:17.590966,used: 3:52:53.062072,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9781206, 'precision': 0.9767077, 'recall': 0.96581966, 'specificity': 0.96581966, 'f1': 0.97109985, 'auroc': 0.99405706, 'binary_precision': 0.9738916, 'binary_recall': 0.940405, 'binary_specificity': 0.9912343, 'binary_f1_score': 0.9568554}
confusion matrix:
       0      1
0  41953    371
1    877  13839
---- Validation: 
scalar performance:
{'acc': 0.952533, 'precision': 0.6760285, 'recall': 0.7549094, 'specificity': 0.7549094, 'f1': 0.7071059, 'auroc': 0.9067399, 'binary_precision': 0.3685322, 'binary_recall': 0.5427683, 'binary_specificity': 0.96705055, 'binary_f1_score': 0.4389937}
confusion matrix:
       0    1
0  17551  598
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95270056, 'precision': 0.72171223, 'recall': 0.83423126, 'specificity': 0.83423126, 'f1': 0.76462114, 'auroc': 0.91532993, 'binary_precision': 0.4565757, 'binary_recall': 0.70498085, 'binary_specificity': 0.9634817, 'binary_f1_score': 0.5542169}
confusion matrix:
      0    1
0  5778  219
1    77  184
early stop counter: 5
val acc:0.9525330066680908, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 10,now: 2024-07-09 21:02:16.976935,epoch time: 0:21:20.723268,used: 4:14:13.785340,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9797861, 'precision': 0.98025984, 'recall': 0.96669817, 'specificity': 0.96669817, 'f1': 0.9732281, 'auroc': 0.99499667, 'binary_precision': 0.98119634, 'binary_recall': 0.9396575, 'binary_specificity': 0.9937388, 'binary_f1_score': 0.95997775}
confusion matrix:
       0      1
0  42059    265
1    888  13828
---- Validation: 
scalar performance:
{'acc': 0.95109624, 'precision': 0.67326814, 'recall': 0.7646663, 'specificity': 0.7646663, 'f1': 0.7078831, 'auroc': 0.9083654, 'binary_precision': 0.36227545, 'binary_recall': 0.5645412, 'binary_specificity': 0.9647915, 'binary_f1_score': 0.44133738}
confusion matrix:
       0    1
0  17510  639
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94678813, 'precision': 0.7030095, 'recall': 0.8348111, 'specificity': 0.8348111, 'f1': 0.74973273, 'auroc': 0.91623384, 'binary_precision': 0.4189189, 'binary_recall': 0.7126437, 'binary_specificity': 0.9569785, 'binary_f1_score': 0.52765954}
confusion matrix:
      0    1
0  5739  258
1    75  186
early stop counter: 6
val acc:0.95109623670578, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 11,now: 2024-07-09 21:23:38.603462,epoch time: 0:21:21.626527,used: 4:35:35.411867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9798913, 'precision': 0.9783745, 'recall': 0.96883017, 'specificity': 0.96883017, 'f1': 0.97347677, 'auroc': 0.995192, 'binary_precision': 0.97533804, 'binary_recall': 0.94597715, 'binary_specificity': 0.9916832, 'binary_f1_score': 0.96043324}
confusion matrix:
       0      1
0  41972    352
1    795  13921
---- Validation: 
scalar performance:
{'acc': 0.945083, 'precision': 0.6611409, 'recall': 0.7885552, 'specificity': 0.7885552, 'f1': 0.7036008, 'auroc': 0.9123479, 'binary_precision': 0.33614153, 'binary_recall': 0.62052876, 'binary_specificity': 0.95658165, 'binary_f1_score': 0.43606555}
confusion matrix:
       0    1
0  17361  788
1    244  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9348034, 'precision': 0.67813396, 'recall': 0.8578753, 'specificity': 0.8578753, 'f1': 0.7313385, 'auroc': 0.92005324, 'binary_precision': 0.36660618, 'binary_recall': 0.77394634, 'binary_specificity': 0.94180423, 'binary_f1_score': 0.49753696}
confusion matrix:
      0    1
0  5648  349
1    59  202
early stop counter: 7
val acc:0.9450830221176147, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 12,now: 2024-07-09 21:44:52.113476,epoch time: 0:21:13.510014,used: 4:56:48.921881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98153925, 'precision': 0.98243123, 'recall': 0.96916866, 'specificity': 0.96916866, 'f1': 0.97556126, 'auroc': 0.9951204, 'binary_precision': 0.9841967, 'binary_recall': 0.9436065, 'binary_specificity': 0.9947309, 'binary_f1_score': 0.9634743}
confusion matrix:
       0      1
0  42099    223
1    830  13888
---- Validation: 
scalar performance:
{'acc': 0.95083016, 'precision': 0.6701641, 'recall': 0.7547779, 'specificity': 0.7547779, 'f1': 0.7026696, 'auroc': 0.90655184, 'binary_precision': 0.3567788, 'binary_recall': 0.5443235, 'binary_specificity': 0.96523225, 'binary_f1_score': 0.4310345}
confusion matrix:
       0    1
0  17518  631
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94231385, 'precision': 0.69024324, 'recall': 0.83064425, 'specificity': 0.83064425, 'f1': 0.7377619, 'auroc': 0.9139864, 'binary_precision': 0.39361703, 'binary_recall': 0.70881224, 'binary_specificity': 0.95247626, 'binary_f1_score': 0.50615597}
confusion matrix:
      0    1
0  5712  285
1    76  185
early stop counter: 8
val acc:0.9508301615715027, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 13,now: 2024-07-09 22:06:05.515137,epoch time: 0:21:13.401661,used: 5:18:02.323542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9818022, 'precision': 0.9794619, 'recall': 0.9727996, 'specificity': 0.9727996, 'f1': 0.9760695, 'auroc': 0.9956342, 'binary_precision': 0.97473276, 'binary_recall': 0.9541995, 'binary_specificity': 0.9913997, 'binary_f1_score': 0.96435684}
confusion matrix:
       0      1
0  41960    364
1    674  14042
---- Validation: 
scalar performance:
{'acc': 0.9474244, 'precision': 0.6650147, 'recall': 0.7777665, 'specificity': 0.7777665, 'f1': 0.7045707, 'auroc': 0.9078366, 'binary_precision': 0.34473446, 'binary_recall': 0.5956454, 'binary_specificity': 0.9598876, 'binary_f1_score': 0.43671608}
confusion matrix:
       0    1
0  17421  728
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9333653, 'precision': 0.6703173, 'recall': 0.8314723, 'specificity': 0.8314723, 'f1': 0.7192888, 'auroc': 0.91306573, 'binary_precision': 0.35338345, 'binary_recall': 0.7203065, 'binary_specificity': 0.942638, 'binary_f1_score': 0.4741488}
confusion matrix:
      0    1
0  5653  344
1    73  188
early stop counter: 9
val acc:0.9474244117736816, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 14,now: 2024-07-09 22:27:41.670913,epoch time: 0:21:36.155776,used: 5:39:38.479318,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98117113, 'precision': 0.98187816, 'recall': 0.9687377, 'specificity': 0.9687377, 'f1': 0.9750733, 'auroc': 0.99547327, 'binary_precision': 0.98327786, 'binary_recall': 0.9430513, 'binary_specificity': 0.9944241, 'binary_f1_score': 0.96274453}
confusion matrix:
       0      1
0  42089    236
1    838  13877
---- Validation: 
scalar performance:
{'acc': 0.9502448, 'precision': 0.667117, 'recall': 0.7499745, 'specificity': 0.7499745, 'f1': 0.698953, 'auroc': 0.90361345, 'binary_precision': 0.3510204, 'binary_recall': 0.5349922, 'binary_specificity': 0.96495676, 'binary_f1_score': 0.42390633}
confusion matrix:
       0    1
0  17513  636
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93688077, 'precision': 0.6751599, 'recall': 0.81864786, 'specificity': 0.81864786, 'f1': 0.7216178, 'auroc': 0.90815055, 'binary_precision': 0.36437246, 'binary_recall': 0.6896552, 'binary_specificity': 0.9476405, 'binary_f1_score': 0.47682118}
confusion matrix:
      0    1
0  5683  314
1    81  180
early stop counter: 10
val acc:0.9502447843551636, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 15,now: 2024-07-09 22:49:33.677325,epoch time: 0:21:52.006412,used: 6:01:30.485730,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9820477, 'precision': 0.98222816, 'recall': 0.9706805, 'specificity': 0.9706805, 'f1': 0.97627294, 'auroc': 0.9956891, 'binary_precision': 0.9825872, 'binary_recall': 0.9471967, 'binary_specificity': 0.9941642, 'binary_f1_score': 0.9645675}
confusion matrix:
       0      1
0  42078    247
1    777  13938
---- Validation: 
scalar performance:
{'acc': 0.95157516, 'precision': 0.67067134, 'recall': 0.7461629, 'specificity': 0.7461629, 'f1': 0.70047516, 'auroc': 0.9049717, 'binary_precision': 0.35843053, 'binary_recall': 0.525661, 'binary_specificity': 0.96666485, 'binary_f1_score': 0.42622954}
confusion matrix:
       0    1
0  17544  605
1    305  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94135505, 'precision': 0.6851474, 'recall': 0.81548536, 'specificity': 0.81548536, 'f1': 0.72993493, 'auroc': 0.9093244, 'binary_precision': 0.3847826, 'binary_recall': 0.6781609, 'binary_specificity': 0.95280975, 'binary_f1_score': 0.49098474}
confusion matrix:
      0    1
0  5714  283
1    84  177
early stop counter: 11
val acc:0.9515751600265503, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 16,now: 2024-07-09 23:11:18.896084,epoch time: 0:21:45.218759,used: 6:23:15.704489,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98239833, 'precision': 0.98055446, 'recall': 0.9732648, 'specificity': 0.9732648, 'f1': 0.9768367, 'auroc': 0.9955215, 'binary_precision': 0.9768364, 'binary_recall': 0.9543972, 'binary_specificity': 0.9921325, 'binary_f1_score': 0.9654864}
confusion matrix:
       0      1
0  41993    333
1    671  14043
---- Validation: 
scalar performance:
{'acc': 0.94870156, 'precision': 0.6626106, 'recall': 0.7514257, 'specificity': 0.7514257, 'f1': 0.69587183, 'auroc': 0.9023092, 'binary_precision': 0.34187192, 'binary_recall': 0.53965783, 'binary_specificity': 0.96319354, 'binary_f1_score': 0.41857657}
confusion matrix:
       0    1
0  17481  668
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9352828, 'precision': 0.67079264, 'recall': 0.8141494, 'specificity': 0.8141494, 'f1': 0.71667606, 'auroc': 0.9054419, 'binary_precision': 0.356, 'binary_recall': 0.68199235, 'binary_specificity': 0.94630647, 'binary_f1_score': 0.46780553}
confusion matrix:
      0    1
0  5675  322
1    83  178
early stop counter: 12
val acc:0.9487015604972839, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 17,now: 2024-07-09 23:32:53.777544,epoch time: 0:21:34.881460,used: 6:44:50.585949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.984169, 'precision': 0.98631525, 'recall': 0.97227025, 'specificity': 0.97227025, 'f1': 0.9790281, 'auroc': 0.99627423, 'binary_precision': 0.99055463, 'binary_recall': 0.9476831, 'binary_specificity': 0.9968574, 'binary_f1_score': 0.9686448}
confusion matrix:
       0      1
0  42189    133
1    770  13948
---- Validation: 
scalar performance:
{'acc': 0.9526394, 'precision': 0.6702473, 'recall': 0.72871256, 'specificity': 0.72871256, 'f1': 0.6945126, 'auroc': 0.90186393, 'binary_precision': 0.35885715, 'binary_recall': 0.48833594, 'binary_specificity': 0.9690892, 'binary_f1_score': 0.41370222}
confusion matrix:
       0    1
0  17588  561
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9431128, 'precision': 0.6855415, 'recall': 0.7925821, 'specificity': 0.7925821, 'f1': 0.72472215, 'auroc': 0.9010917, 'binary_precision': 0.38770685, 'binary_recall': 0.62835246, 'binary_specificity': 0.9568117, 'binary_f1_score': 0.47953215}
confusion matrix:
      0    1
0  5738  259
1    97  164
early stop counter: 13
val acc:0.9526394009590149, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 18,now: 2024-07-09 23:55:10.720077,epoch time: 0:22:16.942533,used: 7:07:07.528482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.9844725, 'recall': 0.9760473, 'specificity': 0.9760473, 'f1': 0.9801635, 'auroc': 0.9967191, 'binary_precision': 0.9835322, 'binary_recall': 0.95767087, 'binary_specificity': 0.9944237, 'binary_f1_score': 0.97042924}
confusion matrix:
       0      1
0  42086    236
1    623  14095
---- Validation: 
scalar performance:
{'acc': 0.9461473, 'precision': 0.6552493, 'recall': 0.7516035, 'specificity': 0.7516035, 'f1': 0.6899886, 'auroc': 0.9022365, 'binary_precision': 0.3270853, 'binary_recall': 0.5427683, 'binary_specificity': 0.9604386, 'binary_f1_score': 0.40818712}
confusion matrix:
       0    1
0  17431  718
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92809206, 'precision': 0.65399396, 'recall': 0.80123585, 'specificity': 0.80123585, 'f1': 0.6981387, 'auroc': 0.90293217, 'binary_precision': 0.3233645, 'binary_recall': 0.66283524, 'binary_specificity': 0.93963647, 'binary_f1_score': 0.43467337}
confusion matrix:
      0    1
0  5635  362
1    88  173
early stop counter: 14
val acc:0.9461473226547241, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 19,now: 2024-07-10 00:17:40.857646,epoch time: 0:22:30.137569,used: 7:29:37.666051,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9842742, 'precision': 0.98466873, 'recall': 0.9741107, 'specificity': 0.9741107, 'f1': 0.97923887, 'auroc': 0.9968232, 'binary_precision': 0.98545635, 'binary_recall': 0.95311224, 'binary_specificity': 0.99510914, 'binary_f1_score': 0.96901447}
confusion matrix:
       0      1
0  42117    207
1    690  14026
---- Validation: 
scalar performance:
{'acc': 0.9498723, 'precision': 0.66440403, 'recall': 0.7437812, 'specificity': 0.7437812, 'f1': 0.6950842, 'auroc': 0.9038071, 'binary_precision': 0.346035, 'binary_recall': 0.5225505, 'binary_specificity': 0.96501184, 'binary_f1_score': 0.41635686}
confusion matrix:
       0    1
0  17514  635
1    307  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93863857, 'precision': 0.67536205, 'recall': 0.7994093, 'specificity': 0.7994093, 'f1': 0.7177926, 'auroc': 0.90089554, 'binary_precision': 0.36659437, 'binary_recall': 0.6475096, 'binary_specificity': 0.95130897, 'binary_f1_score': 0.4681441}
confusion matrix:
      0    1
0  5705  292
1    92  169
early stop counter: 15
val acc:0.9498723149299622, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 20,now: 2024-07-10 00:39:37.748338,epoch time: 0:21:56.890692,used: 7:51:34.556743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9854839, 'precision': 0.98518395, 'recall': 0.9767694, 'specificity': 0.9767694, 'f1': 0.9808807, 'auroc': 0.9968467, 'binary_precision': 0.98458105, 'binary_recall': 0.9587608, 'binary_specificity': 0.994778, 'binary_f1_score': 0.9714994}
confusion matrix:
       0      1
0  42100    221
1    607  14112
---- Validation: 
scalar performance:
{'acc': 0.9480098, 'precision': 0.66007113, 'recall': 0.74956745, 'specificity': 0.74956745, 'f1': 0.69335777, 'auroc': 0.9032438, 'binary_precision': 0.33691406, 'binary_recall': 0.5365474, 'binary_specificity': 0.9625875, 'binary_f1_score': 0.4139172}
confusion matrix:
       0    1
0  17470  679
1    298  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.935922, 'precision': 0.669979, 'recall': 0.8034889, 'specificity': 0.8034889, 'f1': 0.7138391, 'auroc': 0.90116, 'binary_precision': 0.3553719, 'binary_recall': 0.65900385, 'binary_specificity': 0.94797397, 'binary_f1_score': 0.461745}
confusion matrix:
      0    1
0  5685  312
1    89  172
early stop counter: 16
val acc:0.9480097889900208, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 21,now: 2024-07-10 01:01:08.767544,epoch time: 0:21:31.019206,used: 8:13:05.575949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98451966, 'precision': 0.9854783, 'recall': 0.97396576, 'specificity': 0.97396576, 'f1': 0.9795433, 'auroc': 0.9964144, 'binary_precision': 0.98738635, 'binary_recall': 0.9521609, 'binary_specificity': 0.9957707, 'binary_f1_score': 0.96945375}
confusion matrix:
       0      1
0  42145    179
1    704  14012
---- Validation: 
scalar performance:
{'acc': 0.948808, 'precision': 0.66146827, 'recall': 0.7454804, 'specificity': 0.7454804, 'f1': 0.6933254, 'auroc': 0.9053937, 'binary_precision': 0.34002006, 'binary_recall': 0.5272162, 'binary_specificity': 0.9637446, 'binary_f1_score': 0.41341466}
confusion matrix:
       0    1
0  17491  658
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9399169, 'precision': 0.6778779, 'recall': 0.79641163, 'specificity': 0.79641163, 'f1': 0.71928716, 'auroc': 0.89891225, 'binary_precision': 0.37193763, 'binary_recall': 0.63984674, 'binary_specificity': 0.95297647, 'binary_f1_score': 0.47042254}
confusion matrix:
      0    1
0  5715  282
1    94  167
early stop counter: 17
val acc:0.9488080143928528, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 22,now: 2024-07-10 01:22:35.143932,epoch time: 0:21:26.376388,used: 8:34:31.952337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98467743, 'precision': 0.98404497, 'recall': 0.97578144, 'specificity': 0.97578144, 'f1': 0.9798204, 'auroc': 0.9963896, 'binary_precision': 0.98277307, 'binary_recall': 0.95739913, 'binary_specificity': 0.9941638, 'binary_f1_score': 0.9699202}
confusion matrix:
       0      1
0  42075    247
1    627  14091
---- Validation: 
scalar performance:
{'acc': 0.9430609, 'precision': 0.64698625, 'recall': 0.7507556, 'specificity': 0.7507556, 'f1': 0.68280184, 'auroc': 0.90234286, 'binary_precision': 0.310559, 'binary_recall': 0.5443235, 'binary_specificity': 0.9571877, 'binary_f1_score': 0.39548025}
confusion matrix:
       0    1
0  17372  777
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9292106, 'precision': 0.6561469, 'recall': 0.80181944, 'specificity': 0.80181944, 'f1': 0.70037687, 'auroc': 0.897823, 'binary_precision': 0.3276515, 'binary_recall': 0.66283524, 'binary_specificity': 0.9408037, 'binary_f1_score': 0.43852976}
confusion matrix:
      0    1
0  5642  355
1    88  173
early stop counter: 18
val acc:0.9430608749389648, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 23,now: 2024-07-10 01:44:00.301192,epoch time: 0:21:25.157260,used: 8:55:57.109597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9865358, 'precision': 0.988047, 'recall': 0.9767192, 'specificity': 0.9767192, 'f1': 0.98221123, 'auroc': 0.99690473, 'binary_precision': 0.991057, 'binary_recall': 0.956439, 'binary_specificity': 0.9969994, 'binary_f1_score': 0.97344035}
confusion matrix:
       0      1
0  42198    127
1    641  14074
---- Validation: 
scalar performance:
{'acc': 0.95168155, 'precision': 0.662814, 'recall': 0.7139656, 'specificity': 0.7139656, 'f1': 0.68434817, 'auroc': 0.8979647, 'binary_precision': 0.34502923, 'binary_recall': 0.45878693, 'binary_specificity': 0.9691443, 'binary_f1_score': 0.39385846}
confusion matrix:
       0    1
0  17589  560
1    348  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94519013, 'precision': 0.68831867, 'recall': 0.77534264, 'specificity': 0.77534264, 'f1': 0.72210485, 'auroc': 0.8942728, 'binary_precision': 0.3948718, 'binary_recall': 0.5900383, 'binary_specificity': 0.960647, 'binary_f1_score': 0.47311828}
confusion matrix:
      0    1
0  5761  236
1   107  154
early stop counter: 19
val acc:0.9516815543174744, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 24,now: 2024-07-10 02:05:22.534159,epoch time: 0:21:22.232967,used: 9:17:19.342564,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9859747, 'precision': 0.98579025, 'recall': 0.9774507, 'specificity': 0.9774507, 'f1': 0.9815264, 'auroc': 0.9969053, 'binary_precision': 0.9854193, 'binary_recall': 0.95983964, 'binary_specificity': 0.9950619, 'binary_f1_score': 0.9724613}
confusion matrix:
       0      1
0  42115    209
1    591  14125
---- Validation: 
scalar performance:
{'acc': 0.94896764, 'precision': 0.6591032, 'recall': 0.7343122, 'specificity': 0.7343122, 'f1': 0.68828994, 'auroc': 0.9008982, 'binary_precision': 0.3360996, 'binary_recall': 0.503888, 'binary_specificity': 0.96473634, 'binary_f1_score': 0.40323582}
confusion matrix:
       0    1
0  17509  640
1    319  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9440716, 'precision': 0.6866152, 'recall': 0.7839207, 'specificity': 0.7839207, 'f1': 0.7232535, 'auroc': 0.8970679, 'binary_precision': 0.3906634, 'binary_recall': 0.6091954, 'binary_specificity': 0.958646, 'binary_f1_score': 0.4760479}
confusion matrix:
      0    1
0  5749  248
1   102  159
early stop counter: 20
val acc:0.9489676356315613, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 25,now: 2024-07-10 02:26:45.247364,epoch time: 0:21:22.713205,used: 9:38:42.055769,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98667604, 'precision': 0.9879799, 'recall': 0.9771532, 'specificity': 0.9771532, 'f1': 0.98240936, 'auroc': 0.99737436, 'binary_precision': 0.9905819, 'binary_recall': 0.9574728, 'binary_specificity': 0.9968336, 'binary_f1_score': 0.973746}
confusion matrix:
       0      1
0  42186    134
1    626  14094
---- Validation: 
scalar performance:
{'acc': 0.95184124, 'precision': 0.6656532, 'recall': 0.72229886, 'specificity': 0.72229886, 'f1': 0.6891678, 'auroc': 0.90088916, 'binary_precision': 0.3501144, 'binary_recall': 0.47589424, 'binary_specificity': 0.9687035, 'binary_f1_score': 0.40342778}
confusion matrix:
       0    1
0  17581  568
1    337  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9488655, 'precision': 0.69950527, 'recall': 0.76993096, 'specificity': 0.76993096, 'f1': 0.7284856, 'auroc': 0.89446163, 'binary_precision': 0.4178273, 'binary_recall': 0.57471263, 'binary_specificity': 0.9651492, 'binary_f1_score': 0.48387098}
confusion matrix:
      0    1
0  5788  209
1   111  150
early stop counter: 21
val acc:0.9518412351608276, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 26,now: 2024-07-10 02:48:07.391701,epoch time: 0:21:22.144337,used: 10:00:04.200106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98742986, 'precision': 0.98681533, 'recall': 0.9802509, 'specificity': 0.9802509, 'f1': 0.98347485, 'auroc': 0.99727136, 'binary_precision': 0.9855726, 'binary_recall': 0.9654165, 'binary_specificity': 0.9950853, 'binary_f1_score': 0.97539043}
confusion matrix:
       0      1
0  42114    208
1    509  14209
---- Validation: 
scalar performance:
{'acc': 0.94630694, 'precision': 0.6514037, 'recall': 0.7351849, 'specificity': 0.7351849, 'f1': 0.68258786, 'auroc': 0.8996495, 'binary_precision': 0.32058823, 'binary_recall': 0.5085537, 'binary_specificity': 0.9618161, 'binary_f1_score': 0.3932652}
confusion matrix:
       0    1
0  17456  693
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94183445, 'precision': 0.6800988, 'recall': 0.78275347, 'specificity': 0.78275347, 'f1': 0.71775836, 'auroc': 0.8936261, 'binary_precision': 0.3776722, 'binary_recall': 0.6091954, 'binary_specificity': 0.95631146, 'binary_f1_score': 0.46627563}
confusion matrix:
      0    1
0  5735  262
1   102  159
early stop counter: 22
val acc:0.9463069438934326, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 27,now: 2024-07-10 03:09:28.915861,epoch time: 0:21:21.524160,used: 10:21:25.724266,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9871669, 'precision': 0.985816, 'recall': 0.98055905, 'specificity': 0.98055905, 'f1': 0.98315, 'auroc': 0.99763507, 'binary_precision': 0.9830731, 'binary_recall': 0.9669068, 'binary_specificity': 0.9942113, 'binary_f1_score': 0.97492296}
confusion matrix:
       0      1
0  42079    245
1    487  14229
---- Validation: 
scalar performance:
{'acc': 0.9466794, 'precision': 0.6525149, 'recall': 0.7353777, 'specificity': 0.7353777, 'f1': 0.6835192, 'auroc': 0.8992256, 'binary_precision': 0.32280356, 'binary_recall': 0.5085537, 'binary_specificity': 0.9622018, 'binary_f1_score': 0.39492753}
confusion matrix:
       0    1
0  17463  686
1    316  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94119525, 'precision': 0.6771662, 'recall': 0.77692294, 'specificity': 0.77692294, 'f1': 0.713866, 'auroc': 0.8923081, 'binary_precision': 0.37231505, 'binary_recall': 0.59770113, 'binary_specificity': 0.95614475, 'binary_f1_score': 0.45882353}
confusion matrix:
      0    1
0  5734  263
1   105  156
early stop counter: 23
val acc:0.946679413318634, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 28,now: 2024-07-10 03:30:45.171589,epoch time: 0:21:16.255728,used: 10:42:41.979994,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9884993, 'precision': 0.98844385, 'recall': 0.98143685, 'specificity': 0.98143685, 'f1': 0.98487425, 'auroc': 0.99774754, 'binary_precision': 0.98833174, 'binary_recall': 0.9668433, 'binary_specificity': 0.99603045, 'binary_f1_score': 0.97746944}
confusion matrix:
       0      1
0  42154    168
1    488  14230
---- Validation: 
scalar performance:
{'acc': 0.9536505, 'precision': 0.6673732, 'recall': 0.7029841, 'specificity': 0.7029841, 'f1': 0.68319607, 'auroc': 0.8981501, 'binary_precision': 0.35496184, 'binary_recall': 0.43390357, 'binary_specificity': 0.97206455, 'binary_f1_score': 0.39048284}
confusion matrix:
       0    1
0  17642  507
1    364  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.7311017, 'recall': 0.7538606, 'specificity': 0.7538606, 'f1': 0.7418648, 'auroc': 0.89279604, 'binary_precision': 0.4826389, 'binary_recall': 0.532567, 'binary_specificity': 0.9751542, 'binary_f1_score': 0.50637525}
confusion matrix:
      0    1
0  5848  149
1   122  139
early stop counter: 24
val acc:0.9536504745483398, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 29,now: 2024-07-10 03:51:49.167865,epoch time: 0:21:03.996276,used: 11:03:45.976270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98790324, 'precision': 0.9881713, 'recall': 0.9801465, 'specificity': 0.9801465, 'f1': 0.9840723, 'auroc': 0.9979751, 'binary_precision': 0.9887108, 'binary_recall': 0.9641207, 'binary_specificity': 0.99617237, 'binary_f1_score': 0.97626096}
confusion matrix:
       0      1
0  42162    162
1    528  14188
---- Validation: 
scalar performance:
{'acc': 0.95721585, 'precision': 0.6782696, 'recall': 0.6830783, 'specificity': 0.6830783, 'f1': 0.6806373, 'auroc': 0.8996433, 'binary_precision': 0.37821484, 'binary_recall': 0.3888025, 'binary_specificity': 0.9773541, 'binary_f1_score': 0.38343558}
confusion matrix:
       0    1
0  17738  411
1    393  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959412, 'precision': 0.74603486, 'recall': 0.7406193, 'specificity': 0.7406193, 'f1': 0.74329257, 'auroc': 0.89405084, 'binary_precision': 0.5137255, 'binary_recall': 0.5019157, 'binary_specificity': 0.97932297, 'binary_f1_score': 0.50775194}
confusion matrix:
      0    1
0  5873  124
1   130  131
early stop counter: 25
val acc:0.9572158455848694, best validation acc: 0.9577479958534241, corresponding to test acc:                         0.9643656015396118 / 0.9643656015396118
after epoch: 30,now: 2024-07-10 04:12:44.880227,epoch time: 0:20:55.712362,used: 11:24:41.688632,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_03_seed_0_21787678
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:24:41.688632 at 2024-07-10 04:12:44.880227
persisted model performance metric: 

scalar performance:
{'acc': 0.9643656, 'precision': 0.77625066, 'recall': 0.78534764, 'specificity': 0.78534764, 'f1': 0.7807156, 'auroc': 0.9106629, 'binary_precision': 0.5703704, 'binary_recall': 0.5900383, 'binary_specificity': 0.980657, 'binary_f1_score': 0.58003765}
confusion matrix:
      0    1
0  5881  116
1   107  154
oracle model performance metric: 

scalar performance:
{'acc': 0.9643656, 'precision': 0.77625066, 'recall': 0.78534764, 'specificity': 0.78534764, 'f1': 0.7807156, 'auroc': 0.9106629, 'binary_precision': 0.5703704, 'binary_recall': 0.5900383, 'binary_specificity': 0.980657, 'binary_f1_score': 0.58003765}
confusion matrix:
      0    1
0  5881  116
1   107  154
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  16482 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59895 KiB | 732464 KiB | 678844 GiB | 678843 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |   9133 KiB |  11093 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7625    |  195064 K  |  195061 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84571 K  |   84568 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7625    |  195064 K  |  195061 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84571 K  |   84568 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3589    |  120683 K  |  120683 K  |
|       from large pool |      10    |     350    |   85092 K  |   85092 K  |
|       from small pool |      26    |    3579    |   35590 K  |   35590 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 678844 GiB | 678844 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 663471 GiB | 663471 GiB |
|       from small pool |      0 KiB |  21224 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84571 K  |   84571 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  195064 K  |  195064 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84571 K  |   84571 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  120684 K  |  120684 K  |
|       from large pool |       3    |     350    |   85092 K  |   85092 K  |
|       from small pool |       0    |    3579    |   35592 K  |   35592 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 10 04:24:43 2024]
Finished job 0.
1 of 1 steps (100%) done
