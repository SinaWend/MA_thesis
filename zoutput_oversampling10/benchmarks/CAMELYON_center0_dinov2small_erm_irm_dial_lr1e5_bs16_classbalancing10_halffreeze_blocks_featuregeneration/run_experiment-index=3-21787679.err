Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul  9 16:41:02 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679

 Experiment start at: 2024-07-09 16:47:37.974642
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9389201, 'precision': 0.95805824, 'recall': 0.884152, 'specificity': 0.884152, 'f1': 0.91363335, 'auroc': 0.96700037, 'binary_precision': 0.99005234, 'binary_recall': 0.7709975, 'binary_specificity': 0.99730647, 'binary_f1_score': 0.8669009}
confusion matrix:
       0      1
0  42210    114
1   3370  11346
---- Validation: 
scalar performance:
{'acc': 0.94785017, 'precision': 0.5382943, 'recall': 0.5259683, 'specificity': 0.5259683, 'f1': 0.5303407, 'auroc': 0.79557586, 'binary_precision': 0.109048724, 'binary_recall': 0.07309487, 'binary_specificity': 0.9788418, 'binary_f1_score': 0.087523274}
confusion matrix:
       0    1
0  17765  384
1    596   47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9482263, 'precision': 0.583376, 'recall': 0.53505874, 'specificity': 0.53505874, 'f1': 0.5464471, 'auroc': 0.82757473, 'binary_precision': 0.20560747, 'binary_recall': 0.08429119, 'binary_specificity': 0.98582625, 'binary_f1_score': 0.11956521}
confusion matrix:
      0   1
0  5912  85
1   239  22
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-09 17:13:38.192307,epoch time: 0:26:00.217665,used: 0:26:00.217665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9562237, 'precision': 0.96512806, 'recall': 0.9204676, 'specificity': 0.9204676, 'f1': 0.9400562, 'auroc': 0.9811523, 'binary_precision': 0.9811796, 'binary_recall': 0.8465824, 'binary_specificity': 0.9943528, 'binary_f1_score': 0.9089251}
confusion matrix:
       0      1
0  42083    239
1   2258  12460
---- Validation: 
scalar performance:
{'acc': 0.95013833, 'precision': 0.6210448, 'recall': 0.6194098, 'specificity': 0.6194098, 'f1': 0.62022066, 'auroc': 0.8580097, 'binary_precision': 0.2681388, 'binary_recall': 0.2643857, 'binary_specificity': 0.97443384, 'binary_f1_score': 0.26624906}
confusion matrix:
       0    1
0  17685  464
1    473  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9534995, 'precision': 0.7001488, 'recall': 0.6624088, 'specificity': 0.6624088, 'f1': 0.6790031, 'auroc': 0.8824821, 'binary_precision': 0.42857143, 'binary_recall': 0.3448276, 'binary_specificity': 0.97999, 'binary_f1_score': 0.3821656}
confusion matrix:
      0    1
0  5877  120
1   171   90
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-09 17:37:41.147229,epoch time: 0:24:02.954922,used: 0:50:03.172587,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.961378, 'precision': 0.9683209, 'recall': 0.9305972, 'specificity': 0.9305972, 'f1': 0.9475074, 'auroc': 0.9850638, 'binary_precision': 0.98108274, 'binary_recall': 0.8670065, 'binary_specificity': 0.99418783, 'binary_f1_score': 0.9205238}
confusion matrix:
       0      1
0  42079    246
1   1957  12758
---- Validation: 
scalar performance:
{'acc': 0.9524798, 'precision': 0.653747, 'recall': 0.67462593, 'specificity': 0.67462593, 'f1': 0.6634125, 'auroc': 0.879197, 'binary_precision': 0.32970026, 'binary_recall': 0.3763608, 'binary_specificity': 0.9728911, 'binary_f1_score': 0.35148874}
confusion matrix:
       0    1
0  17657  492
1    401  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95637584, 'precision': 0.7273751, 'recall': 0.72987354, 'specificity': 0.72987354, 'f1': 0.7286165, 'auroc': 0.89839363, 'binary_precision': 0.47727272, 'binary_recall': 0.4827586, 'binary_specificity': 0.9769885, 'binary_f1_score': 0.48}
confusion matrix:
      0    1
0  5859  138
1   135  126
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-09 18:01:45.145604,epoch time: 0:24:03.998375,used: 1:14:07.170962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96663743, 'precision': 0.97140324, 'recall': 0.9411492, 'specificity': 0.9411492, 'f1': 0.9550216, 'auroc': 0.98787856, 'binary_precision': 0.9803554, 'binary_recall': 0.8884887, 'binary_specificity': 0.99380964, 'binary_f1_score': 0.93216413}
confusion matrix:
       0      1
0  42062    262
1   1641  13075
---- Validation: 
scalar performance:
{'acc': 0.954768, 'precision': 0.66799355, 'recall': 0.6885615, 'specificity': 0.6885615, 'f1': 0.67759234, 'auroc': 0.8904017, 'binary_precision': 0.3572414, 'binary_recall': 0.40279937, 'binary_specificity': 0.97432363, 'binary_f1_score': 0.378655}
confusion matrix:
       0    1
0  17683  466
1    384  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.75109565, 'recall': 0.7685212, 'specificity': 0.7685212, 'f1': 0.7594739, 'auroc': 0.9053452, 'binary_precision': 0.5214286, 'binary_recall': 0.55938697, 'binary_specificity': 0.9776555, 'binary_f1_score': 0.5397412}
confusion matrix:
      0    1
0  5863  134
1   115  146
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-09 18:55:20.221850,epoch time: 0:53:35.076246,used: 2:07:42.247208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9694425, 'precision': 0.97164655, 'recall': 0.9480799, 'specificity': 0.9480799, 'f1': 0.95909655, 'auroc': 0.99004835, 'binary_precision': 0.9758692, 'binary_recall': 0.9039337, 'binary_specificity': 0.99222606, 'binary_f1_score': 0.938525}
confusion matrix:
       0      1
0  41992    329
1   1414  13305
---- Validation: 
scalar performance:
{'acc': 0.9552469, 'precision': 0.67542076, 'recall': 0.70756084, 'specificity': 0.70756084, 'f1': 0.68993735, 'auroc': 0.8936909, 'binary_precision': 0.3707572, 'binary_recall': 0.44167963, 'binary_specificity': 0.9734421, 'binary_f1_score': 0.40312278}
confusion matrix:
       0    1
0  17667  482
1    359  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9614893, 'precision': 0.7580371, 'recall': 0.8058349, 'specificity': 0.8058349, 'f1': 0.77961373, 'auroc': 0.90869653, 'binary_precision': 0.53205127, 'binary_recall': 0.6360153, 'binary_specificity': 0.9756545, 'binary_f1_score': 0.5794066}
confusion matrix:
      0    1
0  5851  146
1    95  166
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-09 19:33:57.576232,epoch time: 0:38:37.354382,used: 2:46:19.601590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97235274, 'precision': 0.9742175, 'recall': 0.9531814, 'specificity': 0.9531814, 'f1': 0.96309125, 'auroc': 0.99076575, 'binary_precision': 0.9778182, 'binary_recall': 0.91356933, 'binary_specificity': 0.9927935, 'binary_f1_score': 0.94460255}
confusion matrix:
       0      1
0  42018    305
1   1272  13445
---- Validation: 
scalar performance:
{'acc': 0.955513, 'precision': 0.68275094, 'recall': 0.7332005, 'specificity': 0.7332005, 'f1': 0.7044575, 'auroc': 0.9002308, 'binary_precision': 0.3835947, 'binary_recall': 0.49455675, 'binary_specificity': 0.9718442, 'binary_f1_score': 0.43206525}
confusion matrix:
       0    1
0  17638  511
1    325  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.7621416, 'recall': 0.8154135, 'specificity': 0.8154135, 'f1': 0.78596336, 'auroc': 0.91154003, 'binary_precision': 0.53943217, 'binary_recall': 0.6551724, 'binary_specificity': 0.9756545, 'binary_f1_score': 0.5916954}
confusion matrix:
      0    1
0  5851  146
1    90  171
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-09 20:00:58.831170,epoch time: 0:27:01.254938,used: 3:13:20.856528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9750351, 'precision': 0.97536385, 'recall': 0.95904434, 'specificity': 0.95904434, 'f1': 0.9668371, 'auroc': 0.99193, 'binary_precision': 0.976008, 'binary_recall': 0.92600393, 'binary_specificity': 0.9920847, 'binary_f1_score': 0.9503487}
confusion matrix:
       0      1
0  41988    335
1   1089  13628
---- Validation: 
scalar performance:
{'acc': 0.9564176, 'precision': 0.6874109, 'recall': 0.73666906, 'specificity': 0.73666906, 'f1': 0.70875883, 'auroc': 0.90269154, 'binary_precision': 0.39268294, 'binary_recall': 0.5007776, 'binary_specificity': 0.97256047, 'binary_f1_score': 0.44019142}
confusion matrix:
       0    1
0  17651  498
1    321  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96212846, 'precision': 0.76141036, 'recall': 0.80983305, 'specificity': 0.80983305, 'f1': 0.78327155, 'auroc': 0.9127859, 'binary_precision': 0.53846157, 'binary_recall': 0.6436782, 'binary_specificity': 0.975988, 'binary_f1_score': 0.58638746}
confusion matrix:
      0    1
0  5853  144
1    93  168
better model found
persisted
after epoch: 7,now: 2024-07-09 20:26:02.076961,epoch time: 0:25:03.245791,used: 3:38:24.102319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97547334, 'precision': 0.97457623, 'recall': 0.96095514, 'specificity': 0.96095514, 'f1': 0.9675087, 'auroc': 0.9923055, 'binary_precision': 0.97280407, 'binary_recall': 0.9309595, 'binary_specificity': 0.99095076, 'binary_f1_score': 0.9514219}
confusion matrix:
       0      1
0  41941    383
1   1016  13700
---- Validation: 
scalar performance:
{'acc': 0.95285225, 'precision': 0.67802054, 'recall': 0.75882494, 'specificity': 0.75882494, 'f1': 0.70977384, 'auroc': 0.90523845, 'binary_precision': 0.37223974, 'binary_recall': 0.5505443, 'binary_specificity': 0.9671056, 'binary_f1_score': 0.44416562}
confusion matrix:
       0    1
0  17552  597
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.7368386, 'recall': 0.83631563, 'specificity': 0.83631563, 'f1': 0.7765413, 'auroc': 0.9153728, 'binary_precision': 0.48677248, 'binary_recall': 0.70498085, 'binary_specificity': 0.9676505, 'binary_f1_score': 0.57589984}
confusion matrix:
      0    1
0  5803  194
1    77  184
early stop counter: 1
val acc:0.9528522491455078, best validation acc: 0.9564176201820374, corresponding to test acc:                         0.9621284604072571 / 0.9622882604598999
after epoch: 8,now: 2024-07-09 20:50:07.331472,epoch time: 0:24:05.254511,used: 4:02:29.356830,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9759993, 'precision': 0.97806597, 'recall': 0.95897484, 'specificity': 0.95897484, 'f1': 0.9680237, 'auroc': 0.9927398, 'binary_precision': 0.98208094, 'binary_recall': 0.9238089, 'binary_specificity': 0.99414086, 'binary_f1_score': 0.9520541}
confusion matrix:
       0      1
0  42079    248
1   1121  13592
---- Validation: 
scalar performance:
{'acc': 0.9571626, 'precision': 0.6940205, 'recall': 0.75355595, 'specificity': 0.75355595, 'f1': 0.7192562, 'auroc': 0.9069715, 'binary_precision': 0.40470588, 'binary_recall': 0.5349922, 'binary_specificity': 0.9721197, 'binary_f1_score': 0.46081716}
confusion matrix:
       0    1
0  17643  506
1    299  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9603707, 'precision': 0.7524864, 'recall': 0.82907164, 'specificity': 0.82907164, 'f1': 0.78496814, 'auroc': 0.91550183, 'binary_precision': 0.51884055, 'binary_recall': 0.68582374, 'binary_specificity': 0.9723195, 'binary_f1_score': 0.5907591}
confusion matrix:
      0    1
0  5831  166
1    82  179
better model found
persisted
after epoch: 9,now: 2024-07-09 21:14:09.619798,epoch time: 0:24:02.288326,used: 4:26:31.645156,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9784888, 'precision': 0.98007, 'recall': 0.96352345, 'specificity': 0.96352345, 'f1': 0.9714243, 'auroc': 0.9942819, 'binary_precision': 0.9831674, 'binary_recall': 0.93259954, 'binary_specificity': 0.99444735, 'binary_f1_score': 0.9572161}
confusion matrix:
       0      1
0  42087    235
1    992  13726
---- Validation: 
scalar performance:
{'acc': 0.955513, 'precision': 0.68778384, 'recall': 0.75720227, 'specificity': 0.75720227, 'f1': 0.7162689, 'auroc': 0.9062164, 'binary_precision': 0.3919373, 'binary_recall': 0.5443235, 'binary_specificity': 0.970081, 'binary_f1_score': 0.45572913}
confusion matrix:
       0    1
0  17606  543
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547779, 'precision': 0.7288674, 'recall': 0.8298181, 'specificity': 0.8298181, 'f1': 0.76870036, 'auroc': 0.9146873, 'binary_precision': 0.47135416, 'binary_recall': 0.6934866, 'binary_specificity': 0.96614975, 'binary_f1_score': 0.5612403}
confusion matrix:
      0    1
0  5794  203
1    80  181
early stop counter: 1
val acc:0.9555130004882812, best validation acc: 0.957162618637085, corresponding to test acc:                         0.9603707194328308 / 0.9622882604598999
after epoch: 10,now: 2024-07-09 21:37:56.812289,epoch time: 0:23:47.192491,used: 4:50:18.837647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9780856, 'precision': 0.97839844, 'recall': 0.9640716, 'specificity': 0.9640716, 'f1': 0.97095376, 'auroc': 0.99449694, 'binary_precision': 0.9790155, 'binary_recall': 0.9351135, 'binary_specificity': 0.99302965, 'binary_f1_score': 0.956561}
confusion matrix:
       0      1
0  42027    295
1    955  13763
---- Validation: 
scalar performance:
{'acc': 0.9522137, 'precision': 0.6773144, 'recall': 0.7659949, 'specificity': 0.7659949, 'f1': 0.7113754, 'auroc': 0.9068682, 'binary_precision': 0.37029502, 'binary_recall': 0.5660964, 'binary_specificity': 0.96589345, 'binary_f1_score': 0.44772446}
confusion matrix:
       0    1
0  17530  619
1    279  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9479067, 'precision': 0.7050839, 'recall': 0.826233, 'specificity': 0.826233, 'f1': 0.7493005, 'auroc': 0.91514015, 'binary_precision': 0.42388758, 'binary_recall': 0.6934866, 'binary_specificity': 0.9589795, 'binary_f1_score': 0.52616274}
confusion matrix:
      0    1
0  5751  246
1    80  181
early stop counter: 2
val acc:0.952213704586029, best validation acc: 0.957162618637085, corresponding to test acc:                         0.9603707194328308 / 0.9622882604598999
after epoch: 11,now: 2024-07-09 22:01:38.559688,epoch time: 0:23:41.747399,used: 5:14:00.585046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9807679, 'precision': 0.9827485, 'recall': 0.9668742, 'specificity': 0.9668742, 'f1': 0.9744708, 'auroc': 0.99469185, 'binary_precision': 0.9866371, 'binary_recall': 0.93816674, 'binary_specificity': 0.9955816, 'binary_f1_score': 0.9617917}
confusion matrix:
       0      1
0  42136    187
1    910  13807
---- Validation: 
scalar performance:
{'acc': 0.95391655, 'precision': 0.68124235, 'recall': 0.7556257, 'specificity': 0.7556257, 'f1': 0.71112466, 'auroc': 0.90651214, 'binary_precision': 0.37893593, 'binary_recall': 0.5427683, 'binary_specificity': 0.9684831, 'binary_f1_score': 0.44629157}
confusion matrix:
       0    1
0  17577  572
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9498242, 'precision': 0.7100227, 'recall': 0.81807184, 'specificity': 0.81807184, 'f1': 0.7510153, 'auroc': 0.91347265, 'binary_precision': 0.4345679, 'binary_recall': 0.6743295, 'binary_specificity': 0.9618142, 'binary_f1_score': 0.5285285}
confusion matrix:
      0    1
0  5768  229
1    85  176
early stop counter: 3
val acc:0.9539165496826172, best validation acc: 0.957162618637085, corresponding to test acc:                         0.9603707194328308 / 0.9622882604598999
after epoch: 12,now: 2024-07-09 22:25:22.723796,epoch time: 0:23:44.164108,used: 5:37:44.749154,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98069775, 'precision': 0.98178685, 'recall': 0.9676045, 'specificity': 0.9676045, 'f1': 0.9744226, 'auroc': 0.9949492, 'binary_precision': 0.9839363, 'binary_recall': 0.940549, 'binary_specificity': 0.99465996, 'binary_f1_score': 0.96175355}
confusion matrix:
       0      1
0  42096    226
1    875  13843
---- Validation: 
scalar performance:
{'acc': 0.9548744, 'precision': 0.6857842, 'recall': 0.75987184, 'specificity': 0.75987184, 'f1': 0.7157378, 'auroc': 0.9081702, 'binary_precision': 0.38773274, 'binary_recall': 0.5505443, 'binary_specificity': 0.9691994, 'binary_f1_score': 0.45501286}
confusion matrix:
       0    1
0  17590  559
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9509428, 'precision': 0.7129293, 'recall': 0.81132615, 'specificity': 0.81132615, 'f1': 0.7512717, 'auroc': 0.9126728, 'binary_precision': 0.44102564, 'binary_recall': 0.65900385, 'binary_specificity': 0.9636485, 'binary_f1_score': 0.5284179}
confusion matrix:
      0    1
0  5779  218
1    89  172
early stop counter: 4
val acc:0.9548743963241577, best validation acc: 0.957162618637085, corresponding to test acc:                         0.9603707194328308 / 0.9622882604598999
after epoch: 13,now: 2024-07-09 22:49:15.081530,epoch time: 0:23:52.357734,used: 6:01:37.106888,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98145163, 'precision': 0.98138607, 'recall': 0.96994984, 'specificity': 0.96994984, 'f1': 0.9754896, 'auroc': 0.9951415, 'binary_precision': 0.9812557, 'binary_recall': 0.9461847, 'binary_specificity': 0.993715, 'binary_f1_score': 0.96340114}
confusion matrix:
       0      1
0  42057    266
1    792  13925
---- Validation: 
scalar performance:
{'acc': 0.94854194, 'precision': 0.6685078, 'recall': 0.7790951, 'specificity': 0.7790951, 'f1': 0.70783854, 'auroc': 0.91011965, 'binary_precision': 0.35164836, 'binary_recall': 0.59720063, 'binary_specificity': 0.9609896, 'binary_f1_score': 0.44265133}
confusion matrix:
       0    1
0  17441  708
1    259  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9399169, 'precision': 0.68413925, 'recall': 0.8293936, 'specificity': 0.8293936, 'f1': 0.73201644, 'auroc': 0.912305, 'binary_precision': 0.3814433, 'binary_recall': 0.70881224, 'binary_specificity': 0.949975, 'binary_f1_score': 0.49597856}
confusion matrix:
      0    1
0  5697  300
1    76  185
early stop counter: 5
val acc:0.9485419392585754, best validation acc: 0.957162618637085, corresponding to test acc:                         0.9603707194328308 / 0.9622882604598999
after epoch: 14,now: 2024-07-09 23:13:32.872656,epoch time: 0:24:17.791126,used: 6:25:54.898014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9813114, 'precision': 0.98115414, 'recall': 0.96981454, 'specificity': 0.96981454, 'f1': 0.9753088, 'auroc': 0.9956703, 'binary_precision': 0.98084104, 'binary_recall': 0.9460561, 'binary_specificity': 0.99357295, 'binary_f1_score': 0.9631346}
confusion matrix:
       0      1
0  42049    272
1    794  13925
---- Validation: 
scalar performance:
{'acc': 0.94705194, 'precision': 0.66476774, 'recall': 0.7813239, 'specificity': 0.7813239, 'f1': 0.70519364, 'auroc': 0.90809405, 'binary_precision': 0.34397164, 'binary_recall': 0.60342145, 'binary_specificity': 0.9592264, 'binary_f1_score': 0.43817055}
confusion matrix:
       0    1
0  17409  740
1    255  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9357622, 'precision': 0.67475915, 'recall': 0.8290582, 'specificity': 0.8290582, 'f1': 0.72319204, 'auroc': 0.9087225, 'binary_precision': 0.3625731, 'binary_recall': 0.7126437, 'binary_specificity': 0.9454727, 'binary_f1_score': 0.48062015}
confusion matrix:
      0    1
0  5670  327
1    75  186
early stop counter: 6
val acc:0.9470519423484802, best validation acc: 0.957162618637085, corresponding to test acc:                         0.9603707194328308 / 0.9622882604598999
after epoch: 15,now: 2024-07-09 23:37:31.864906,epoch time: 0:23:58.992250,used: 6:49:53.890264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98252106, 'precision': 0.9812116, 'recall': 0.9729278, 'specificity': 0.9729278, 'f1': 0.97697574, 'auroc': 0.99603546, 'binary_precision': 0.9785794, 'binary_recall': 0.9531091, 'binary_specificity': 0.9927466, 'binary_f1_score': 0.9656763}
confusion matrix:
       0      1
0  42018    307
1    690  14025
---- Validation: 
scalar performance:
{'acc': 0.94710517, 'precision': 0.66408634, 'recall': 0.77760124, 'specificity': 0.77760124, 'f1': 0.70374024, 'auroc': 0.9067831, 'binary_precision': 0.34288272, 'binary_recall': 0.5956454, 'binary_specificity': 0.959557, 'binary_f1_score': 0.43522725}
confusion matrix:
       0    1
0  17415  734
1    260  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9344839, 'precision': 0.670879, 'recall': 0.8228942, 'specificity': 0.8228942, 'f1': 0.71836305, 'auroc': 0.9073728, 'binary_precision': 0.3553398, 'binary_recall': 0.7011494, 'binary_specificity': 0.94463897, 'binary_f1_score': 0.47164944}
confusion matrix:
      0    1
0  5665  332
1    78  183
early stop counter: 7
val acc:0.9471051692962646, best validation acc: 0.957162618637085, corresponding to test acc:                         0.9603707194328308 / 0.9622882604598999
after epoch: 16,now: 2024-07-10 00:02:16.683510,epoch time: 0:24:44.818604,used: 7:14:38.708868,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9832398, 'precision': 0.9818027, 'recall': 0.9742323, 'specificity': 0.9742323, 'f1': 0.97793907, 'auroc': 0.9960543, 'binary_precision': 0.97890705, 'binary_recall': 0.9556235, 'binary_specificity': 0.9928411, 'binary_f1_score': 0.9671252}
confusion matrix:
       0      1
0  42022    303
1    653  14062
---- Validation: 
scalar performance:
{'acc': 0.94524264, 'precision': 0.6593796, 'recall': 0.77888715, 'specificity': 0.77888715, 'f1': 0.699947, 'auroc': 0.9078477, 'binary_precision': 0.33333334, 'binary_recall': 0.60031104, 'binary_specificity': 0.9574632, 'binary_f1_score': 0.42865074}
confusion matrix:
       0    1
0  17377  772
1    257  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9352828, 'precision': 0.67153287, 'recall': 0.8178141, 'specificity': 0.8178141, 'f1': 0.71806157, 'auroc': 0.9058233, 'binary_precision': 0.35714287, 'binary_recall': 0.6896552, 'binary_specificity': 0.945973, 'binary_f1_score': 0.4705883}
confusion matrix:
      0    1
0  5673  324
1    81  180
early stop counter: 8
val acc:0.9452426433563232, best validation acc: 0.957162618637085, corresponding to test acc:                         0.9603707194328308 / 0.9622882604598999
after epoch: 17,now: 2024-07-10 00:27:13.546690,epoch time: 0:24:56.863180,used: 7:39:35.572048,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9835554, 'precision': 0.9826199, 'recall': 0.9742469, 'specificity': 0.9742469, 'f1': 0.97833776, 'auroc': 0.99641645, 'binary_precision': 0.9807397, 'binary_recall': 0.95501494, 'binary_specificity': 0.9934789, 'binary_f1_score': 0.9677064}
confusion matrix:
       0      1
0  42048    276
1    662  14054
---- Validation: 
scalar performance:
{'acc': 0.95019156, 'precision': 0.66747296, 'recall': 0.7521971, 'specificity': 0.7521971, 'f1': 0.69986683, 'auroc': 0.9028243, 'binary_precision': 0.35157043, 'binary_recall': 0.53965783, 'binary_specificity': 0.96473634, 'binary_f1_score': 0.4257669}
confusion matrix:
       0    1
0  17509  640
1    296  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94199425, 'precision': 0.6823758, 'recall': 0.7919985, 'specificity': 0.7919985, 'f1': 0.7219884, 'auroc': 0.90130126, 'binary_precision': 0.38139534, 'binary_recall': 0.62835246, 'binary_specificity': 0.9556445, 'binary_f1_score': 0.4746744}
confusion matrix:
      0    1
0  5731  266
1    97  164
early stop counter: 9
val acc:0.9501915574073792, best validation acc: 0.957162618637085, corresponding to test acc:                         0.9603707194328308 / 0.9622882604598999
after epoch: 18,now: 2024-07-10 00:51:27.065440,epoch time: 0:24:13.518750,used: 8:03:49.090798,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98448455, 'precision': 0.9843153, 'recall': 0.9750089, 'specificity': 0.9750089, 'f1': 0.9795445, 'auroc': 0.99651855, 'binary_precision': 0.98397595, 'binary_recall': 0.9554287, 'binary_specificity': 0.9945891, 'binary_f1_score': 0.9694922}
confusion matrix:
       0      1
0  42093    229
1    656  14062
---- Validation: 
scalar performance:
{'acc': 0.9461473, 'precision': 0.6571131, 'recall': 0.759104, 'specificity': 0.759104, 'f1': 0.69340163, 'auroc': 0.9036975, 'binary_precision': 0.3302668, 'binary_recall': 0.55832034, 'binary_specificity': 0.9598876, 'binary_f1_score': 0.4150289}
confusion matrix:
       0    1
0  17421  728
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9360818, 'precision': 0.6695797, 'recall': 0.7999076, 'specificity': 0.7999076, 'f1': 0.712746, 'auroc': 0.90130395, 'binary_precision': 0.35490605, 'binary_recall': 0.651341, 'binary_specificity': 0.9484742, 'binary_f1_score': 0.45945948}
confusion matrix:
      0    1
0  5688  309
1    91  170
early stop counter: 10
val acc:0.9461473226547241, best validation acc: 0.957162618637085, corresponding to test acc:                         0.9603707194328308 / 0.9622882604598999
after epoch: 19,now: 2024-07-10 01:15:32.412386,epoch time: 0:24:05.346946,used: 8:27:54.437744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98487025, 'precision': 0.98371255, 'recall': 0.9766191, 'specificity': 0.9766191, 'f1': 0.9800973, 'auroc': 0.9968921, 'binary_precision': 0.98137593, 'binary_recall': 0.9595706, 'binary_specificity': 0.9936677, 'binary_f1_score': 0.97035074}
confusion matrix:
       0      1
0  42055    268
1    595  14122
---- Validation: 
scalar performance:
{'acc': 0.945083, 'precision': 0.6570273, 'recall': 0.7705539, 'specificity': 0.7705539, 'f1': 0.69602513, 'auroc': 0.9067451, 'binary_precision': 0.32923618, 'binary_recall': 0.58320373, 'binary_specificity': 0.95790404, 'binary_f1_score': 0.42087543}
confusion matrix:
       0    1
0  17385  764
1    268  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9364014, 'precision': 0.6718464, 'recall': 0.8074037, 'specificity': 0.8074037, 'f1': 0.71633655, 'auroc': 0.903545, 'binary_precision': 0.3587629, 'binary_recall': 0.6666667, 'binary_specificity': 0.94814074, 'binary_f1_score': 0.4664879}
confusion matrix:
      0    1
0  5686  311
1    87  174
early stop counter: 11
val acc:0.9450830221176147, best validation acc: 0.957162618637085, corresponding to test acc:                         0.9603707194328308 / 0.9622882604598999
after epoch: 20,now: 2024-07-10 01:39:29.854322,epoch time: 0:23:57.441936,used: 8:51:51.879680,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9853787, 'precision': 0.98538166, 'recall': 0.97629976, 'specificity': 0.97629976, 'f1': 0.9807291, 'auroc': 0.9965779, 'binary_precision': 0.9853877, 'binary_recall': 0.9575379, 'binary_specificity': 0.9950616, 'binary_f1_score': 0.97126323}
confusion matrix:
       0      1
0  42112    209
1    625  14094
---- Validation: 
scalar performance:
{'acc': 0.9423691, 'precision': 0.64847034, 'recall': 0.7631484, 'specificity': 0.7631484, 'f1': 0.68684167, 'auroc': 0.9008285, 'binary_precision': 0.31260648, 'binary_recall': 0.57076204, 'binary_specificity': 0.95553476, 'binary_f1_score': 0.40396258}
confusion matrix:
       0    1
0  17342  807
1    276  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93240654, 'precision': 0.6618222, 'recall': 0.79982233, 'specificity': 0.79982233, 'f1': 0.70553094, 'auroc': 0.8978223, 'binary_precision': 0.3392857, 'binary_recall': 0.6551724, 'binary_specificity': 0.94447225, 'binary_f1_score': 0.44705883}
confusion matrix:
      0    1
0  5664  333
1    90  171
early stop counter: 12
val acc:0.9423691034317017, best validation acc: 0.957162618637085, corresponding to test acc:                         0.9603707194328308 / 0.9622882604598999
after epoch: 21,now: 2024-07-10 02:03:36.203589,epoch time: 0:24:06.349267,used: 9:15:58.228947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9859397, 'precision': 0.98722756, 'recall': 0.97596884, 'specificity': 0.97596884, 'f1': 0.9814279, 'auroc': 0.9972992, 'binary_precision': 0.9897938, 'binary_recall': 0.9553638, 'binary_specificity': 0.9965738, 'binary_f1_score': 0.9722741}
confusion matrix:
       0      1
0  42176    145
1    657  14062
---- Validation: 
scalar performance:
{'acc': 0.95732224, 'precision': 0.68860894, 'recall': 0.7228863, 'specificity': 0.7228863, 'f1': 0.70411414, 'auroc': 0.9022983, 'binary_precision': 0.39607844, 'binary_recall': 0.47122863, 'binary_specificity': 0.97454405, 'binary_f1_score': 0.43039772}
confusion matrix:
       0    1
0  17687  462
1    340  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549377, 'precision': 0.72336614, 'recall': 0.76393753, 'specificity': 0.76393753, 'f1': 0.74169135, 'auroc': 0.89558554, 'binary_precision': 0.46623793, 'binary_recall': 0.5555556, 'binary_specificity': 0.9723195, 'binary_f1_score': 0.506993}
confusion matrix:
      0    1
0  5831  166
1   116  145
better model found
persisted
after epoch: 22,now: 2024-07-10 02:27:44.746125,epoch time: 0:24:08.542536,used: 9:40:06.771483,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9868338, 'precision': 0.98712456, 'recall': 0.97838676, 'specificity': 0.97838676, 'f1': 0.9826528, 'auroc': 0.9972137, 'binary_precision': 0.9877086, 'binary_recall': 0.9609322, 'binary_specificity': 0.9958414, 'binary_f1_score': 0.9741364}
confusion matrix:
       0      1
0  42146    176
1    575  14143
---- Validation: 
scalar performance:
{'acc': 0.9539698, 'precision': 0.67983794, 'recall': 0.74815273, 'specificity': 0.74815273, 'f1': 0.7077017, 'auroc': 0.90545595, 'binary_precision': 0.37666667, 'binary_recall': 0.5272162, 'binary_specificity': 0.9690892, 'binary_f1_score': 0.43940377}
confusion matrix:
       0    1
0  17588  561
1    304  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95222116, 'precision': 0.71444094, 'recall': 0.7863405, 'specificity': 0.7863405, 'f1': 0.7443486, 'auroc': 0.89785886, 'binary_precision': 0.4463277, 'binary_recall': 0.60536397, 'binary_specificity': 0.967317, 'binary_f1_score': 0.5138211}
confusion matrix:
      0    1
0  5801  196
1   103  158
early stop counter: 1
val acc:0.9539697766304016, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9549376964569092 / 0.9622882604598999
after epoch: 23,now: 2024-07-10 02:51:49.425584,epoch time: 0:24:04.679459,used: 10:04:11.450942,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9867111, 'precision': 0.98688245, 'recall': 0.97830534, 'specificity': 0.97830534, 'f1': 0.9824947, 'auroc': 0.9967406, 'binary_precision': 0.9872269, 'binary_recall': 0.9609348, 'binary_specificity': 0.9956759, 'binary_f1_score': 0.9739035}
confusion matrix:
       0      1
0  42138    183
1    575  14144
---- Validation: 
scalar performance:
{'acc': 0.95168155, 'precision': 0.67295957, 'recall': 0.7544686, 'specificity': 0.7544686, 'f1': 0.7046913, 'auroc': 0.9060243, 'binary_precision': 0.36240914, 'binary_recall': 0.5427683, 'binary_specificity': 0.96616894, 'binary_f1_score': 0.43462017}
confusion matrix:
       0    1
0  17535  614
1    294  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9495046, 'precision': 0.7030457, 'recall': 0.77759373, 'specificity': 0.77759373, 'f1': 0.7335086, 'auroc': 0.89780474, 'binary_precision': 0.42424244, 'binary_recall': 0.5900383, 'binary_specificity': 0.9651492, 'binary_f1_score': 0.4935897}
confusion matrix:
      0    1
0  5788  209
1   107  154
early stop counter: 2
val acc:0.9516815543174744, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9549376964569092 / 0.9622882604598999
after epoch: 24,now: 2024-07-10 03:16:04.179540,epoch time: 0:24:14.753956,used: 10:28:26.204898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9861676, 'precision': 0.98626137, 'recall': 0.9774947, 'specificity': 0.9774947, 'f1': 0.9817742, 'auroc': 0.9973526, 'binary_precision': 0.98644966, 'binary_recall': 0.9595733, 'binary_specificity': 0.9954161, 'binary_f1_score': 0.9728259}
confusion matrix:
       0      1
0  42128    194
1    595  14123
---- Validation: 
scalar performance:
{'acc': 0.9524798, 'precision': 0.67019653, 'recall': 0.7308801, 'specificity': 0.7308801, 'f1': 0.69521344, 'auroc': 0.900105, 'binary_precision': 0.35859728, 'binary_recall': 0.49300155, 'binary_specificity': 0.9687586, 'binary_f1_score': 0.41519317}
confusion matrix:
       0    1
0  17582  567
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9536593, 'precision': 0.71816933, 'recall': 0.76876754, 'specificity': 0.76876754, 'f1': 0.74040544, 'auroc': 0.89606744, 'binary_precision': 0.4553846, 'binary_recall': 0.5670498, 'binary_specificity': 0.97048527, 'binary_f1_score': 0.5051194}
confusion matrix:
      0    1
0  5820  177
1   113  148
early stop counter: 3
val acc:0.9524797797203064, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9549376964569092 / 0.9622882604598999
after epoch: 25,now: 2024-07-10 03:40:05.140115,epoch time: 0:24:00.960575,used: 10:52:27.165473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98725456, 'precision': 0.98576725, 'recall': 0.98083866, 'specificity': 0.98083866, 'f1': 0.98327, 'auroc': 0.99745864, 'binary_precision': 0.98274434, 'binary_recall': 0.9675841, 'binary_specificity': 0.9940933, 'binary_f1_score': 0.9751053}
confusion matrix:
       0      1
0  42075    250
1    477  14238
---- Validation: 
scalar performance:
{'acc': 0.94705194, 'precision': 0.6586478, 'recall': 0.755072, 'specificity': 0.755072, 'f1': 0.6936605, 'auroc': 0.9040541, 'binary_precision': 0.33364838, 'binary_recall': 0.5489891, 'binary_specificity': 0.9611549, 'binary_f1_score': 0.41504997}
confusion matrix:
       0    1
0  17444  705
1    290  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94678813, 'precision': 0.6954727, 'recall': 0.7871704, 'specificity': 0.7871704, 'f1': 0.7309877, 'auroc': 0.8965471, 'binary_precision': 0.40816328, 'binary_recall': 0.6130268, 'binary_specificity': 0.96131396, 'binary_f1_score': 0.49004596}
confusion matrix:
      0    1
0  5765  232
1   101  160
early stop counter: 4
val acc:0.9470519423484802, best validation acc: 0.9573222398757935, corresponding to test acc:                         0.9549376964569092 / 0.9622882604598999
after epoch: 26,now: 2024-07-10 04:03:59.107264,epoch time: 0:23:53.967149,used: 11:16:21.132622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9867812, 'precision': 0.988051, 'recall': 0.97735703, 'specificity': 0.97735703, 'f1': 0.9825506, 'auroc': 0.9972513, 'binary_precision': 0.9905859, 'binary_recall': 0.95788044, 'binary_specificity': 0.9968336, 'binary_f1_score': 0.9739587}
confusion matrix:
       0      1
0  42186    134
1    620  14100
---- Validation: 
scalar performance:
{'acc': 0.96035546, 'precision': 0.6965026, 'recall': 0.68320364, 'specificity': 0.68320364, 'f1': 0.68958926, 'auroc': 0.89848024, 'binary_precision': 0.4147157, 'binary_recall': 0.38569206, 'binary_specificity': 0.9807152, 'binary_f1_score': 0.39967766}
confusion matrix:
       0    1
0  17799  350
1    395  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9605305, 'precision': 0.7534089, 'recall': 0.735706, 'specificity': 0.735706, 'f1': 0.7441926, 'auroc': 0.8925071, 'binary_precision': 0.5289256, 'binary_recall': 0.49042144, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.5089463}
confusion matrix:
      0    1
0  5883  114
1   133  128
better model found
persisted
after epoch: 27,now: 2024-07-10 04:27:45.247312,epoch time: 0:23:46.140048,used: 11:40:07.272670,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9869039, 'precision': 0.98744524, 'recall': 0.9782568, 'specificity': 0.9782568, 'f1': 0.9827374, 'auroc': 0.9972434, 'binary_precision': 0.9885307, 'binary_recall': 0.96038866, 'binary_specificity': 0.9961249, 'binary_f1_score': 0.9742565}
confusion matrix:
       0      1
0  42158    164
1    583  14135
---- Validation: 
scalar performance:
{'acc': 0.9566837, 'precision': 0.6832926, 'recall': 0.71280503, 'specificity': 0.71280503, 'f1': 0.69678825, 'auroc': 0.90029407, 'binary_precision': 0.3861518, 'binary_recall': 0.45101088, 'binary_specificity': 0.9745991, 'binary_f1_score': 0.41606888}
confusion matrix:
       0    1
0  17688  461
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95669544, 'precision': 0.73053277, 'recall': 0.7465313, 'specificity': 0.7465313, 'f1': 0.73822266, 'auroc': 0.8920281, 'binary_precision': 0.48214287, 'binary_recall': 0.51724136, 'binary_specificity': 0.97582126, 'binary_f1_score': 0.49907577}
confusion matrix:
      0    1
0  5852  145
1   126  135
early stop counter: 1
val acc:0.9566836953163147, best validation acc: 0.9603554606437683, corresponding to test acc:                         0.9605305194854736 / 0.9622882604598999
after epoch: 28,now: 2024-07-10 04:51:31.423288,epoch time: 0:23:46.175976,used: 12:03:53.448646,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9874474, 'precision': 0.9889401, 'recall': 0.97822416, 'specificity': 0.97822416, 'f1': 0.98342854, 'auroc': 0.9974208, 'binary_precision': 0.99191964, 'binary_recall': 0.95916563, 'binary_specificity': 0.99728274, 'binary_f1_score': 0.9752677}
confusion matrix:
       0      1
0  42207    115
1    601  14117
---- Validation: 
scalar performance:
{'acc': 0.95913154, 'precision': 0.69152343, 'recall': 0.69382083, 'specificity': 0.69382083, 'f1': 0.6926643, 'auroc': 0.8975638, 'binary_precision': 0.40399384, 'binary_recall': 0.40902022, 'binary_specificity': 0.9786214, 'binary_f1_score': 0.4064915}
confusion matrix:
       0    1
0  17761  388
1    380  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.7670303, 'recall': 0.7256291, 'specificity': 0.7256291, 'f1': 0.7443627, 'auroc': 0.89279425, 'binary_precision': 0.55707765, 'binary_recall': 0.46743295, 'binary_specificity': 0.98382527, 'binary_f1_score': 0.5083333}
confusion matrix:
      0    1
0  5900   97
1   139  122
early stop counter: 2
val acc:0.9591315388679504, best validation acc: 0.9603554606437683, corresponding to test acc:                         0.9605305194854736 / 0.9622882604598999
after epoch: 29,now: 2024-07-10 05:15:05.070243,epoch time: 0:23:33.646955,used: 12:27:27.095601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9889902, 'precision': 0.98893654, 'recall': 0.982232, 'specificity': 0.982232, 'f1': 0.9855238, 'auroc': 0.9979335, 'binary_precision': 0.988828, 'binary_recall': 0.968268, 'binary_specificity': 0.9961959, 'binary_f1_score': 0.97844}
confusion matrix:
       0      1
0  42162    161
1    467  14250
---- Validation: 
scalar performance:
{'acc': 0.95657724, 'precision': 0.6843596, 'recall': 0.7195004, 'specificity': 0.7195004, 'f1': 0.70017684, 'auroc': 0.90222585, 'binary_precision': 0.38780805, 'binary_recall': 0.46500778, 'binary_specificity': 0.97399306, 'binary_f1_score': 0.42291373}
confusion matrix:
       0    1
0  17677  472
1    344  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587728, 'precision': 0.7421762, 'recall': 0.7439505, 'specificity': 0.7439505, 'f1': 0.74305964, 'auroc': 0.892229, 'binary_precision': 0.50570345, 'binary_recall': 0.5095785, 'binary_specificity': 0.9783225, 'binary_f1_score': 0.5076336}
confusion matrix:
      0    1
0  5867  130
1   128  133
early stop counter: 3
val acc:0.9565772414207458, best validation acc: 0.9603554606437683, corresponding to test acc:                         0.9605305194854736 / 0.9622882604598999
after epoch: 30,now: 2024-07-10 05:38:50.650299,epoch time: 0:23:45.580056,used: 12:51:12.675657,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_47_37_seed_0_21787679
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 12:51:12.675657 at 2024-07-10 05:38:50.650299
persisted model performance metric: 

scalar performance:
{'acc': 0.9605305, 'precision': 0.7534089, 'recall': 0.735706, 'specificity': 0.735706, 'f1': 0.7441926, 'auroc': 0.8925071, 'binary_precision': 0.5289256, 'binary_recall': 0.49042144, 'binary_specificity': 0.98099047, 'binary_f1_score': 0.5089463}
confusion matrix:
      0    1
0  5883  114
1   133  128
oracle model performance metric: 

scalar performance:
{'acc': 0.96228826, 'precision': 0.7621416, 'recall': 0.8154135, 'specificity': 0.8154135, 'f1': 0.78596336, 'auroc': 0.91154003, 'binary_precision': 0.53943217, 'binary_recall': 0.6551724, 'binary_specificity': 0.9756545, 'binary_f1_score': 0.5916954}
confusion matrix:
      0    1
0  5851  146
1    90  171
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 180662 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  17491 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |  16482 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59895 KiB | 732464 KiB | 678845 GiB | 678845 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 663472 GiB | 663472 GiB |
|       from small pool |   9133 KiB |  11093 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7625    |  195066 K  |  195063 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84573 K  |   84570 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7625    |  195066 K  |  195063 K  |
|       from large pool |      79    |     762    |  110492 K  |  110492 K  |
|       from small pool |    2899    |    7544    |   84573 K  |   84570 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3589    |  120672 K  |  120672 K  |
|       from large pool |      10    |     350    |   85092 K  |   85092 K  |
|       from small pool |      26    |    3579    |   35579 K  |   35579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     37 MiB |     15 TiB |     15 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1179 TiB |   1179 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1164 TiB |   1164 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 678845 GiB | 678845 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 663472 GiB | 663472 GiB |
|       from small pool |      0 KiB |  23272 KiB |  15372 GiB |  15372 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7625    |  195066 K  |  195066 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84573 K  |   84573 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7625    |  195066 K  |  195066 K  |
|       from large pool |       2    |     762    |  110492 K  |  110492 K  |
|       from small pool |       0    |    7544    |   84573 K  |   84573 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3589    |  120673 K  |  120673 K  |
|       from large pool |       3    |     350    |   85092 K  |   85092 K  |
|       from small pool |       0    |    3579    |   35581 K  |   35581 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 10 05:50:35 2024]
Finished job 0.
1 of 1 steps (100%) done
