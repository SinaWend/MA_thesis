Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul  9 16:40:58 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676

 Experiment start at: 2024-07-09 16:48:54.016785
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9650947, 'precision': 0.97109586, 'recall': 0.9375347, 'specificity': 0.9375347, 'f1': 0.9527756, 'auroc': 0.98684454, 'binary_precision': 0.98226196, 'binary_recall': 0.880598, 'binary_specificity': 0.9944714, 'binary_f1_score': 0.92865586}
confusion matrix:
       0      1
0  42091    234
1   1757  12958
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96099406, 'precision': 0.69930303, 'recall': 0.67678374, 'specificity': 0.67678374, 'f1': 0.68728137, 'auroc': 0.89414036, 'binary_precision': 0.42077464, 'binary_recall': 0.3716952, 'binary_specificity': 0.98187226, 'binary_f1_score': 0.3947151}
confusion matrix:
       0    1
0  17820  329
1    404  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95733464, 'precision': 0.7255381, 'recall': 0.6405895, 'specificity': 0.6405895, 'f1': 0.6718602, 'auroc': 0.8987521, 'binary_precision': 0.48125, 'binary_recall': 0.29501915, 'binary_specificity': 0.98615974, 'binary_f1_score': 0.36579573}
confusion matrix:
      0   1
0  5914  83
1   184  77
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-09 17:29:06.389119,epoch time: 0:40:12.372334,used: 0:40:12.372334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97303647, 'precision': 0.9759371, 'recall': 0.953357, 'specificity': 0.953357, 'f1': 0.96395063, 'auroc': 0.99115074, 'binary_precision': 0.981514, 'binary_recall': 0.91269195, 'binary_specificity': 0.994022, 'binary_f1_score': 0.9458527}
confusion matrix:
       0      1
0  42069    253
1   1285  13433
---- Validation: 
scalar performance:
{'acc': 0.9527991, 'precision': 0.6786263, 'recall': 0.7625477, 'specificity': 0.7625477, 'f1': 0.71134937, 'auroc': 0.9136455, 'binary_precision': 0.37318087, 'binary_recall': 0.55832034, 'binary_specificity': 0.966775, 'binary_f1_score': 0.44735202}
confusion matrix:
       0    1
0  17546  603
1    284  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95206136, 'precision': 0.7182382, 'recall': 0.82290375, 'specificity': 0.82290375, 'f1': 0.75869393, 'auroc': 0.91488785, 'binary_precision': 0.4506329, 'binary_recall': 0.68199235, 'binary_specificity': 0.9638152, 'binary_f1_score': 0.54268295}
confusion matrix:
      0    1
0  5780  217
1    83  178
early stop counter: 1
val acc:0.9527990818023682, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9573346376419067 / 0.9573346376419067
after epoch: 2,now: 2024-07-09 18:07:36.654715,epoch time: 0:38:30.265596,used: 1:18:42.637930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97833097, 'precision': 0.97944593, 'recall': 0.9637008, 'specificity': 0.9637008, 'f1': 0.9712353, 'auroc': 0.9941462, 'binary_precision': 0.981635, 'binary_recall': 0.93347377, 'binary_specificity': 0.9939278, 'binary_f1_score': 0.9569488}
confusion matrix:
       0      1
0  42067    257
1    979  13737
---- Validation: 
scalar performance:
{'acc': 0.9499255, 'precision': 0.67467475, 'recall': 0.78881204, 'specificity': 0.78881204, 'f1': 0.71538174, 'auroc': 0.9188462, 'binary_precision': 0.36330274, 'binary_recall': 0.61586314, 'binary_specificity': 0.961761, 'binary_f1_score': 0.45701092}
confusion matrix:
       0    1
0  17455  694
1    247  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9439118, 'precision': 0.69656694, 'recall': 0.8443043, 'specificity': 0.8443043, 'f1': 0.74632764, 'auroc': 0.91797817, 'binary_precision': 0.4050633, 'binary_recall': 0.7356322, 'binary_specificity': 0.95297647, 'binary_f1_score': 0.522449}
confusion matrix:
      0    1
0  5715  282
1    69  192
early stop counter: 2
val acc:0.9499254822731018, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9573346376419067 / 0.9573346376419067
after epoch: 3,now: 2024-07-09 19:09:21.521537,epoch time: 1:01:44.866822,used: 2:20:27.504752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9821003, 'precision': 0.98251694, 'recall': 0.97054553, 'specificity': 0.97054553, 'f1': 0.9763365, 'auroc': 0.9952598, 'binary_precision': 0.9833451, 'binary_recall': 0.94666755, 'binary_specificity': 0.99442357, 'binary_f1_score': 0.9646578}
confusion matrix:
       0      1
0  42085    236
1    785  13934
---- Validation: 
scalar performance:
{'acc': 0.942848, 'precision': 0.6623104, 'recall': 0.8196505, 'specificity': 0.8196505, 'f1': 0.71066725, 'auroc': 0.921996, 'binary_precision': 0.33612168, 'binary_recall': 0.6874028, 'binary_specificity': 0.95189816, 'binary_f1_score': 0.45148107}
confusion matrix:
       0    1
0  17276  873
1    201  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93224674, 'precision': 0.6719204, 'recall': 0.8510443, 'specificity': 0.8510443, 'f1': 0.7239635, 'auroc': 0.91656494, 'binary_precision': 0.35472372, 'binary_recall': 0.7624521, 'binary_specificity': 0.93963647, 'binary_f1_score': 0.48418495}
confusion matrix:
      0    1
0  5635  362
1    62  199
early stop counter: 3
val acc:0.9428480267524719, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9573346376419067 / 0.9573346376419067
after epoch: 4,now: 2024-07-09 19:52:08.459134,epoch time: 0:42:46.937597,used: 3:03:14.442349,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98334503, 'precision': 0.98444843, 'recall': 0.971911, 'specificity': 0.971911, 'f1': 0.9779674, 'auroc': 0.99639505, 'binary_precision': 0.9866375, 'binary_recall': 0.9482876, 'binary_specificity': 0.9955344, 'binary_f1_score': 0.9670825}
confusion matrix:
       0      1
0  42135    189
1    761  13955
---- Validation: 
scalar performance:
{'acc': 0.946573, 'precision': 0.66957575, 'recall': 0.8103281, 'specificity': 0.8103281, 'f1': 0.71576566, 'auroc': 0.92096376, 'binary_precision': 0.35144034, 'binary_recall': 0.66407466, 'binary_specificity': 0.95658165, 'binary_f1_score': 0.45963404}
confusion matrix:
       0    1
0  17361  788
1    216  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93863857, 'precision': 0.68203884, 'recall': 0.8342236, 'specificity': 0.8342236, 'f1': 0.73103637, 'auroc': 0.9113274, 'binary_precision': 0.3767535, 'binary_recall': 0.7203065, 'binary_specificity': 0.94814074, 'binary_f1_score': 0.49473688}
confusion matrix:
      0    1
0  5686  311
1    73  188
early stop counter: 4
val acc:0.94657301902771, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9573346376419067 / 0.9573346376419067
after epoch: 5,now: 2024-07-09 20:29:57.539793,epoch time: 0:37:49.080659,used: 3:41:03.523008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98467743, 'precision': 0.98563147, 'recall': 0.97422576, 'specificity': 0.97422576, 'f1': 0.97975326, 'auroc': 0.9966787, 'binary_precision': 0.9875308, 'binary_recall': 0.9526334, 'binary_specificity': 0.9958181, 'binary_f1_score': 0.9697683}
confusion matrix:
       0      1
0  42148    177
1    697  14018
---- Validation: 
scalar performance:
{'acc': 0.9505641, 'precision': 0.6801893, 'recall': 0.807144, 'specificity': 0.807144, 'f1': 0.72445285, 'auroc': 0.9216765, 'binary_precision': 0.37300178, 'binary_recall': 0.65318817, 'binary_specificity': 0.9610998, 'binary_f1_score': 0.47484455}
confusion matrix:
       0    1
0  17443  706
1    223  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94662833, 'precision': 0.70199823, 'recall': 0.83106303, 'specificity': 0.83106303, 'f1': 0.7479725, 'auroc': 0.90721345, 'binary_precision': 0.41723356, 'binary_recall': 0.70498085, 'binary_specificity': 0.9571452, 'binary_f1_score': 0.52421653}
confusion matrix:
      0    1
0  5740  257
1    77  184
early stop counter: 5
val acc:0.9505640864372253, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9573346376419067 / 0.9573346376419067
after epoch: 6,now: 2024-07-09 21:07:20.992612,epoch time: 0:37:23.452819,used: 4:18:26.975827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98458976, 'precision': 0.9869995, 'recall': 0.97270894, 'specificity': 0.97270894, 'f1': 0.9795808, 'auroc': 0.99667776, 'binary_precision': 0.9917561, 'binary_recall': 0.94815874, 'binary_specificity': 0.9972591, 'binary_f1_score': 0.9694675}
confusion matrix:
       0      1
0  42206    116
1    763  13955
---- Validation: 
scalar performance:
{'acc': 0.958493, 'precision': 0.70367366, 'recall': 0.7759963, 'specificity': 0.7759963, 'f1': 0.73361397, 'auroc': 0.9181584, 'binary_precision': 0.42242354, 'binary_recall': 0.5800933, 'binary_specificity': 0.9718993, 'binary_f1_score': 0.48885977}
confusion matrix:
       0    1
0  17639  510
1    270  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9613295, 'precision': 0.75714487, 'recall': 0.81124854, 'specificity': 0.81124854, 'f1': 0.7812419, 'auroc': 0.90332735, 'binary_precision': 0.52978057, 'binary_recall': 0.6475096, 'binary_specificity': 0.9749875, 'binary_f1_score': 0.5827586}
confusion matrix:
      0    1
0  5847  150
1    92  169
new oracle model saved
early stop counter: 6
val acc:0.9584929943084717, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9573346376419067 / 0.9613295197486877
after epoch: 7,now: 2024-07-09 21:44:31.883654,epoch time: 0:37:10.891042,used: 4:55:37.866869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98543125, 'precision': 0.9879651, 'recall': 0.9739629, 'specificity': 0.9739629, 'f1': 0.9807021, 'auroc': 0.9972266, 'binary_precision': 0.99297124, 'binary_recall': 0.950265, 'binary_specificity': 0.9976608, 'binary_f1_score': 0.97114885}
confusion matrix:
       0      1
0  42223     99
1    732  13986
---- Validation: 
scalar performance:
{'acc': 0.95349085, 'precision': 0.6878207, 'recall': 0.7974084, 'specificity': 0.7974084, 'f1': 0.72832614, 'auroc': 0.92383045, 'binary_precision': 0.389049, 'binary_recall': 0.62986004, 'binary_specificity': 0.96495676, 'binary_f1_score': 0.48099768}
confusion matrix:
       0    1
0  17513  636
1    238  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95605624, 'precision': 0.7330891, 'recall': 0.81949115, 'specificity': 0.81949115, 'f1': 0.76843655, 'auroc': 0.90704376, 'binary_precision': 0.48076922, 'binary_recall': 0.6704981, 'binary_specificity': 0.9684842, 'binary_f1_score': 0.55999994}
confusion matrix:
      0    1
0  5808  189
1    86  175
early stop counter: 7
val acc:0.9534908533096313, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9573346376419067 / 0.9613295197486877
after epoch: 8,now: 2024-07-09 22:22:10.599927,epoch time: 0:37:38.716273,used: 5:33:16.583142,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9855014, 'precision': 0.9885369, 'recall': 0.9736079, 'specificity': 0.9736079, 'f1': 0.9807755, 'auroc': 0.9974444, 'binary_precision': 0.99451685, 'binary_recall': 0.94903505, 'binary_specificity': 0.9981807, 'binary_f1_score': 0.97124374}
confusion matrix:
       0      1
0  42247     77
1    750  13966
---- Validation: 
scalar performance:
{'acc': 0.9567369, 'precision': 0.69841516, 'recall': 0.78933823, 'specificity': 0.78933823, 'f1': 0.7341645, 'auroc': 0.9229533, 'binary_precision': 0.41090146, 'binary_recall': 0.6096423, 'binary_specificity': 0.96903414, 'binary_f1_score': 0.49092045}
confusion matrix:
       0    1
0  17587  562
1    251  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96260786, 'precision': 0.7642168, 'recall': 0.8045862, 'specificity': 0.8045862, 'f1': 0.782764, 'auroc': 0.90143025, 'binary_precision': 0.5445545, 'binary_recall': 0.6321839, 'binary_specificity': 0.9769885, 'binary_f1_score': 0.5851064}
confusion matrix:
      0    1
0  5859  138
1    96  165
new oracle model saved
early stop counter: 8
val acc:0.9567369222640991, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9573346376419067 / 0.9626078605651855
after epoch: 9,now: 2024-07-09 22:59:37.629363,epoch time: 0:37:27.029436,used: 6:10:43.612578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9876578, 'precision': 0.98943055, 'recall': 0.9782995, 'specificity': 0.9782995, 'f1': 0.98369956, 'auroc': 0.9974196, 'binary_precision': 0.9929647, 'binary_recall': 0.95896184, 'binary_specificity': 0.99763715, 'binary_f1_score': 0.9756671}
confusion matrix:
       0      1
0  42222    100
1    604  14114
---- Validation: 
scalar performance:
{'acc': 0.9521605, 'precision': 0.6854389, 'recall': 0.8087205, 'specificity': 0.8087205, 'f1': 0.7292743, 'auroc': 0.9221339, 'binary_precision': 0.3834244, 'binary_recall': 0.6547434, 'binary_specificity': 0.9626977, 'binary_f1_score': 0.4836301}
confusion matrix:
       0    1
0  17472  677
1    222  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9498242, 'precision': 0.70928216, 'recall': 0.81257486, 'specificity': 0.81257486, 'f1': 0.74887896, 'auroc': 0.9039515, 'binary_precision': 0.43358395, 'binary_recall': 0.66283524, 'binary_specificity': 0.9623145, 'binary_f1_score': 0.5242424}
confusion matrix:
      0    1
0  5771  226
1    88  173
early stop counter: 9
val acc:0.9521604776382446, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9573346376419067 / 0.9626078605651855
after epoch: 10,now: 2024-07-09 23:37:05.055966,epoch time: 0:37:27.426603,used: 6:48:11.039181,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98818374, 'precision': 0.98906773, 'recall': 0.9800019, 'specificity': 0.9800019, 'f1': 0.9844247, 'auroc': 0.9976478, 'binary_precision': 0.9908411, 'binary_recall': 0.9630989, 'binary_specificity': 0.9969049, 'binary_f1_score': 0.9767731}
confusion matrix:
       0      1
0  42194    131
1    543  14172
---- Validation: 
scalar performance:
{'acc': 0.95657724, 'precision': 0.7001293, 'recall': 0.8042567, 'specificity': 0.8042567, 'f1': 0.7398685, 'auroc': 0.92318296, 'binary_precision': 0.41323972, 'binary_recall': 0.6407465, 'binary_specificity': 0.9677668, 'binary_f1_score': 0.502439}
confusion matrix:
       0    1
0  17564  585
1    231  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.7687919, 'recall': 0.80500305, 'specificity': 0.80500305, 'f1': 0.785594, 'auroc': 0.900697, 'binary_precision': 0.55369127, 'binary_recall': 0.6321839, 'binary_specificity': 0.97782224, 'binary_f1_score': 0.5903399}
confusion matrix:
      0    1
0  5864  133
1    96  165
new oracle model saved
early stop counter: 10
val acc:0.9565772414207458, best validation acc: 0.9609940648078918, corresponding to test acc:                         0.9573346376419067 / 0.9634068608283997
after epoch: 11,now: 2024-07-10 00:15:06.323283,epoch time: 0:38:01.267317,used: 7:26:12.306498,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.988061, 'precision': 0.9902155, 'recall': 0.97859204, 'specificity': 0.97859204, 'f1': 0.9842238, 'auroc': 0.99755156, 'binary_precision': 0.994504, 'binary_recall': 0.959027, 'binary_specificity': 0.998157, 'binary_f1_score': 0.9764433}
confusion matrix:
       0      1
0  42245     78
1    603  14114
---- Validation: 
scalar performance:
{'acc': 0.9619519, 'precision': 0.7189007, 'recall': 0.763536, 'specificity': 0.763536, 'f1': 0.7388838, 'auroc': 0.9195916, 'binary_precision': 0.45384616, 'binary_recall': 0.5505443, 'binary_specificity': 0.97652763, 'binary_f1_score': 0.49754038}
confusion matrix:
       0    1
0  17723  426
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9712368, 'precision': 0.8317765, 'recall': 0.78526807, 'specificity': 0.78526807, 'f1': 0.8065696, 'auroc': 0.89368474, 'binary_precision': 0.68161434, 'binary_recall': 0.58237547, 'binary_specificity': 0.9881607, 'binary_f1_score': 0.62809914}
confusion matrix:
      0    1
0  5926   71
1   109  152
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-10 00:52:13.691585,epoch time: 0:37:07.368302,used: 8:03:19.674800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98846424, 'precision': 0.9906255, 'recall': 0.9792431, 'specificity': 0.9792431, 'f1': 0.98476183, 'auroc': 0.998147, 'binary_precision': 0.99493134, 'binary_recall': 0.9601875, 'binary_specificity': 0.9982987, 'binary_f1_score': 0.9772507}
confusion matrix:
       0      1
0  42249     72
1    586  14133
---- Validation: 
scalar performance:
{'acc': 0.9611537, 'precision': 0.71546036, 'recall': 0.76987326, 'specificity': 0.76987326, 'f1': 0.73921025, 'auroc': 0.9203355, 'binary_precision': 0.44649446, 'binary_recall': 0.5645412, 'binary_specificity': 0.97520524, 'binary_f1_score': 0.49862638}
confusion matrix:
       0    1
0  17699  450
1    280  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9688399, 'precision': 0.8134763, 'recall': 0.7730235, 'specificity': 0.7730235, 'f1': 0.7916892, 'auroc': 0.8919493, 'binary_precision': 0.6460177, 'binary_recall': 0.55938697, 'binary_specificity': 0.98666, 'binary_f1_score': 0.5995893}
confusion matrix:
      0    1
0  5917   80
1   115  146
early stop counter: 1
val acc:0.9611536860466003, best validation acc: 0.9619519114494324, corresponding to test acc:                         0.9712368249893188 / 0.9712368249893188
after epoch: 13,now: 2024-07-10 01:29:55.912725,epoch time: 0:37:42.221140,used: 8:41:01.895940,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98953366, 'precision': 0.9904624, 'recall': 0.9821583, 'specificity': 0.9821583, 'f1': 0.98621815, 'auroc': 0.99820614, 'binary_precision': 0.99233073, 'binary_recall': 0.9669158, 'binary_specificity': 0.99740076, 'binary_f1_score': 0.97945845}
confusion matrix:
       0      1
0  42210    110
1    487  14233
---- Validation: 
scalar performance:
{'acc': 0.95737547, 'precision': 0.7031814, 'recall': 0.80391985, 'specificity': 0.80391985, 'f1': 0.74209774, 'auroc': 0.9218519, 'binary_precision': 0.41938776, 'binary_recall': 0.63919127, 'binary_specificity': 0.96864843, 'binary_f1_score': 0.50646955}
confusion matrix:
       0    1
0  17580  569
1    232  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96660274, 'precision': 0.7889938, 'recall': 0.80483824, 'specificity': 0.80483824, 'f1': 0.79667675, 'auroc': 0.8946148, 'binary_precision': 0.5942029, 'binary_recall': 0.62835246, 'binary_specificity': 0.981324, 'binary_f1_score': 0.6108007}
confusion matrix:
      0    1
0  5885  112
1    97  164
early stop counter: 2
val acc:0.9573754668235779, best validation acc: 0.9619519114494324, corresponding to test acc:                         0.9712368249893188 / 0.9712368249893188
after epoch: 14,now: 2024-07-10 02:07:33.130612,epoch time: 0:37:37.217887,used: 9:18:39.113827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98895514, 'precision': 0.99139965, 'recall': 0.97976935, 'specificity': 0.97976935, 'f1': 0.98540497, 'auroc': 0.9982209, 'binary_precision': 0.99626553, 'binary_recall': 0.960791, 'binary_specificity': 0.99874777, 'binary_f1_score': 0.97820675}
confusion matrix:
       0      1
0  42271     53
1    577  14139
---- Validation: 
scalar performance:
{'acc': 0.9642401, 'precision': 0.7268812, 'recall': 0.7002159, 'specificity': 0.7002159, 'f1': 0.7126175, 'auroc': 0.9141637, 'binary_precision': 0.4743363, 'binary_recall': 0.41679627, 'binary_specificity': 0.9836355, 'binary_f1_score': 0.4437086}
confusion matrix:
       0    1
0  17852  297
1    375  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9694791, 'precision': 0.8528486, 'recall': 0.7092253, 'specificity': 0.7092253, 'f1': 0.76087457, 'auroc': 0.8867413, 'binary_precision': 0.7302632, 'binary_recall': 0.42528737, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.5375303}
confusion matrix:
      0    1
0  5956   41
1   150  111
better model found
persisted
after epoch: 15,now: 2024-07-10 02:45:37.252297,epoch time: 0:38:04.121685,used: 9:56:43.235512,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98895514, 'precision': 0.9911876, 'recall': 0.9799714, 'specificity': 0.9799714, 'f1': 0.9854123, 'auroc': 0.99815834, 'binary_precision': 0.9956375, 'binary_recall': 0.9614078, 'binary_specificity': 0.99853504, 'binary_f1_score': 0.97822326}
confusion matrix:
       0      1
0  42260     62
1    568  14150
---- Validation: 
scalar performance:
{'acc': 0.9645594, 'precision': 0.73144317, 'recall': 0.725883, 'specificity': 0.725883, 'f1': 0.7286253, 'auroc': 0.9163377, 'binary_precision': 0.4816587, 'binary_recall': 0.4696734, 'binary_specificity': 0.9820927, 'binary_f1_score': 0.47559056}
confusion matrix:
       0    1
0  17824  325
1    341  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.85089064, 'recall': 0.7053939, 'specificity': 0.7053939, 'f1': 0.7572349, 'auroc': 0.88841546, 'binary_precision': 0.7266667, 'binary_recall': 0.41762453, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.5304136}
confusion matrix:
      0    1
0  5956   41
1   152  109
better model found
persisted
after epoch: 16,now: 2024-07-10 03:23:59.285723,epoch time: 0:38:22.033426,used: 10:35:05.268938,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98913044, 'precision': 0.9917052, 'recall': 0.9799305, 'specificity': 0.9799305, 'f1': 0.98563397, 'auroc': 0.99802643, 'binary_precision': 0.99682766, 'binary_recall': 0.9609242, 'binary_specificity': 0.9989368, 'binary_f1_score': 0.97854674}
confusion matrix:
       0      1
0  42280     45
1    575  14140
---- Validation: 
scalar performance:
{'acc': 0.964453, 'precision': 0.7315268, 'recall': 0.7370788, 'specificity': 0.7370788, 'f1': 0.7342659, 'auroc': 0.91678876, 'binary_precision': 0.48103186, 'binary_recall': 0.49300155, 'binary_specificity': 0.981156, 'binary_f1_score': 0.4869432}
confusion matrix:
       0    1
0  17807  342
1    326  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970278, 'precision': 0.85611933, 'recall': 0.7206362, 'specificity': 0.7206362, 'f1': 0.77088296, 'auroc': 0.8870438, 'binary_precision': 0.7358491, 'binary_recall': 0.44827586, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.55714285}
confusion matrix:
      0    1
0  5955   42
1   144  117
early stop counter: 1
val acc:0.9644529819488525, best validation acc: 0.9645593762397766, corresponding to test acc:                         0.9691594839096069 / 0.9712368249893188
after epoch: 17,now: 2024-07-10 04:01:56.702424,epoch time: 0:37:57.416701,used: 11:13:02.685639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98892003, 'precision': 0.9919225, 'recall': 0.97919166, 'specificity': 0.97919166, 'f1': 0.98534256, 'auroc': 0.99802256, 'binary_precision': 0.99787897, 'binary_recall': 0.95909214, 'binary_specificity': 0.9992912, 'binary_f1_score': 0.9781012}
confusion matrix:
       0      1
0  42294     30
1    602  14114
---- Validation: 
scalar performance:
{'acc': 0.9642933, 'precision': 0.73002094, 'recall': 0.7317457, 'specificity': 0.7317457, 'f1': 0.7308797, 'auroc': 0.9177222, 'binary_precision': 0.47839507, 'binary_recall': 0.4821151, 'binary_specificity': 0.9813764, 'binary_f1_score': 0.48024788}
confusion matrix:
       0    1
0  17811  338
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9707574, 'precision': 0.8588054, 'recall': 0.7263833, 'specificity': 0.7263833, 'f1': 0.7761216, 'auroc': 0.88787687, 'binary_precision': 0.7407407, 'binary_recall': 0.4597701, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.5673759}
confusion matrix:
      0    1
0  5955   42
1   141  120
early stop counter: 2
val acc:0.9642933011054993, best validation acc: 0.9645593762397766, corresponding to test acc:                         0.9691594839096069 / 0.9712368249893188
after epoch: 18,now: 2024-07-10 04:39:47.351917,epoch time: 0:37:50.649493,used: 11:50:53.335132,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99069077, 'precision': 0.9920913, 'recall': 0.9835784, 'specificity': 0.9835784, 'f1': 0.98773843, 'auroc': 0.9985974, 'binary_precision': 0.99490684, 'binary_recall': 0.96888167, 'binary_specificity': 0.9982751, 'binary_f1_score': 0.9817218}
confusion matrix:
       0      1
0  42249     73
1    458  14260
---- Validation: 
scalar performance:
{'acc': 0.9642401, 'precision': 0.7303692, 'recall': 0.74071884, 'specificity': 0.74071884, 'f1': 0.7354165, 'auroc': 0.9169135, 'binary_precision': 0.47845468, 'binary_recall': 0.5007776, 'binary_specificity': 0.9806601, 'binary_f1_score': 0.4893617}
confusion matrix:
       0    1
0  17798  351
1    321  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96644294, 'precision': 0.8155875, 'recall': 0.70031184, 'specificity': 0.70031184, 'f1': 0.74367505, 'auroc': 0.88432, 'binary_precision': 0.6564417, 'binary_recall': 0.4099617, 'binary_specificity': 0.990662, 'binary_f1_score': 0.504717}
confusion matrix:
      0    1
0  5941   56
1   154  107
early stop counter: 3
val acc:0.9642400741577148, best validation acc: 0.9645593762397766, corresponding to test acc:                         0.9691594839096069 / 0.9712368249893188
after epoch: 19,now: 2024-07-10 05:17:14.088674,epoch time: 0:37:26.736757,used: 12:28:20.071889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9903927, 'precision': 0.9915457, 'recall': 0.98333216, 'specificity': 0.98333216, 'f1': 0.98734903, 'auroc': 0.9985539, 'binary_precision': 0.99386543, 'binary_recall': 0.9687436, 'binary_specificity': 0.99792075, 'binary_f1_score': 0.9811438}
confusion matrix:
       0      1
0  42235     88
1    460  14257
---- Validation: 
scalar performance:
{'acc': 0.96184546, 'precision': 0.72151756, 'recall': 0.7927331, 'specificity': 0.7927331, 'f1': 0.75154114, 'auroc': 0.9239495, 'binary_precision': 0.45697674, 'binary_recall': 0.61119753, 'binary_specificity': 0.97426856, 'binary_f1_score': 0.5229541}
confusion matrix:
       0    1
0  17682  467
1    250  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9705976, 'precision': 0.8348359, 'recall': 0.7629466, 'specificity': 0.7629466, 'f1': 0.7940905, 'auroc': 0.8903302, 'binary_precision': 0.6896552, 'binary_recall': 0.5363985, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.6034483}
confusion matrix:
      0    1
0  5934   63
1   121  140
early stop counter: 4
val acc:0.9618454575538635, best validation acc: 0.9645593762397766, corresponding to test acc:                         0.9691594839096069 / 0.9712368249893188
after epoch: 20,now: 2024-07-10 05:54:56.726391,epoch time: 0:37:42.637717,used: 13:06:02.709606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99026996, 'precision': 0.9918091, 'recall': 0.98275983, 'specificity': 0.98275983, 'f1': 0.9871756, 'auroc': 0.9986911, 'binary_precision': 0.99489725, 'binary_recall': 0.9672443, 'binary_specificity': 0.9982753, 'binary_f1_score': 0.98087597}
confusion matrix:
       0      1
0  42252     73
1    482  14233
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7359674, 'recall': 0.762051, 'specificity': 0.762051, 'f1': 0.748243, 'auroc': 0.92367387, 'binary_precision': 0.48814505, 'binary_recall': 0.5443235, 'binary_specificity': 0.9797785, 'binary_f1_score': 0.5147059}
confusion matrix:
       0    1
0  17782  367
1    293  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.88498396, 'recall': 0.7121415, 'specificity': 0.7121415, 'f1': 0.77126014, 'auroc': 0.8899344, 'binary_precision': 0.79432625, 'binary_recall': 0.42911878, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.5572139}
confusion matrix:
      0    1
0  5968   29
1   149  112
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-10 06:32:29.844868,epoch time: 0:37:33.118477,used: 13:43:35.828083,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99069077, 'precision': 0.9931407, 'recall': 0.9825778, 'specificity': 0.9825778, 'f1': 0.98771167, 'auroc': 0.9986907, 'binary_precision': 0.9980337, 'binary_recall': 0.9658172, 'binary_specificity': 0.99933845, 'binary_f1_score': 0.9816612}
confusion matrix:
       0      1
0  42297     28
1    503  14212
---- Validation: 
scalar performance:
{'acc': 0.9663687, 'precision': 0.74531287, 'recall': 0.72981995, 'specificity': 0.72981995, 'f1': 0.737285, 'auroc': 0.9143806, 'binary_precision': 0.5091514, 'binary_recall': 0.47589424, 'binary_specificity': 0.98374563, 'binary_f1_score': 0.4919614}
confusion matrix:
       0    1
0  17854  295
1    337  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.8403852, 'recall': 0.6693289, 'specificity': 0.6693289, 'f1': 0.72338355, 'auroc': 0.8753437, 'binary_precision': 0.70866144, 'binary_recall': 0.3448276, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.46391755}
confusion matrix:
      0   1
0  5960  37
1   171  90
better model found
persisted
after epoch: 22,now: 2024-07-10 07:10:12.681570,epoch time: 0:37:42.836702,used: 14:21:18.664785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99026996, 'precision': 0.9928384, 'recall': 0.98178566, 'specificity': 0.98178566, 'f1': 0.9871504, 'auroc': 0.9986371, 'binary_precision': 0.99796045, 'binary_recall': 0.9642566, 'binary_specificity': 0.9993148, 'binary_f1_score': 0.98081905}
confusion matrix:
       0      1
0  42295     29
1    526  14190
---- Validation: 
scalar performance:
{'acc': 0.96706045, 'precision': 0.75094783, 'recall': 0.7301781, 'specificity': 0.7301781, 'f1': 0.7400646, 'auroc': 0.9188949, 'binary_precision': 0.52040815, 'binary_recall': 0.47589424, 'binary_specificity': 0.98446196, 'binary_f1_score': 0.4971568}
confusion matrix:
       0    1
0  17867  282
1    337  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9691595, 'precision': 0.8933424, 'recall': 0.6669149, 'specificity': 0.6669149, 'f1': 0.730538, 'auroc': 0.87702227, 'binary_precision': 0.8148148, 'binary_recall': 0.33716476, 'binary_specificity': 0.996665, 'binary_f1_score': 0.47696477}
confusion matrix:
      0   1
0  5977  20
1   173  88
better model found
persisted
after epoch: 23,now: 2024-07-10 07:47:58.248120,epoch time: 0:37:45.566550,used: 14:59:04.231335,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99219847, 'precision': 0.99301296, 'recall': 0.98658365, 'specificity': 0.98658365, 'f1': 0.98974335, 'auroc': 0.99881506, 'binary_precision': 0.99466056, 'binary_recall': 0.97498643, 'binary_specificity': 0.99818087, 'binary_f1_score': 0.9847253}
confusion matrix:
       0      1
0  42251     77
1    368  14344
---- Validation: 
scalar performance:
{'acc': 0.9589187, 'precision': 0.7101729, 'recall': 0.8092191, 'specificity': 0.8092191, 'f1': 0.7489225, 'auroc': 0.9248924, 'binary_precision': 0.4330218, 'binary_recall': 0.64852256, 'binary_specificity': 0.9699157, 'binary_f1_score': 0.5193026}
confusion matrix:
       0    1
0  17603  546
1    226  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693193, 'precision': 0.82038647, 'recall': 0.76594424, 'specificity': 0.76594424, 'f1': 0.7903459, 'auroc': 0.886478, 'binary_precision': 0.6604651, 'binary_recall': 0.5440613, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.5966387}
confusion matrix:
      0    1
0  5924   73
1   119  142
early stop counter: 1
val acc:0.9589186906814575, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9691594839096069 / 0.9715564250946045
after epoch: 24,now: 2024-07-10 08:25:35.246446,epoch time: 0:37:36.998326,used: 15:36:41.229661,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99209327, 'precision': 0.9929881, 'recall': 0.98633957, 'specificity': 0.98633957, 'f1': 0.98960507, 'auroc': 0.998804, 'binary_precision': 0.99479747, 'binary_recall': 0.9744513, 'binary_specificity': 0.9982279, 'binary_f1_score': 0.9845193}
confusion matrix:
       0      1
0  42248     75
1    376  14341
---- Validation: 
scalar performance:
{'acc': 0.96471906, 'precision': 0.73306584, 'recall': 0.7327162, 'specificity': 0.7327162, 'f1': 0.73289084, 'auroc': 0.9131497, 'binary_precision': 0.48442367, 'binary_recall': 0.4836703, 'binary_specificity': 0.98176205, 'binary_f1_score': 0.4840467}
confusion matrix:
       0    1
0  17818  331
1    332  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9610099, 'precision': 0.7710848, 'recall': 0.6223514, 'specificity': 0.6223514, 'f1': 0.66548246, 'auroc': 0.86053884, 'binary_precision': 0.57391304, 'binary_recall': 0.25287357, 'binary_specificity': 0.9918293, 'binary_f1_score': 0.35106385}
confusion matrix:
      0   1
0  5948  49
1   195  66
early stop counter: 2
val acc:0.9647190570831299, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9691594839096069 / 0.9715564250946045
after epoch: 25,now: 2024-07-10 09:03:45.592354,epoch time: 0:38:10.345908,used: 16:14:51.575569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9920407, 'precision': 0.992318, 'recall': 0.9868574, 'specificity': 0.9868574, 'f1': 0.98954797, 'auroc': 0.9988704, 'binary_precision': 0.9928808, 'binary_recall': 0.9761484, 'binary_specificity': 0.9975664, 'binary_f1_score': 0.98444355}
confusion matrix:
       0      1
0  42221    103
1    351  14365
---- Validation: 
scalar performance:
{'acc': 0.9647722, 'precision': 0.7344114, 'recall': 0.74774486, 'specificity': 0.74774486, 'f1': 0.7408715, 'auroc': 0.91388834, 'binary_precision': 0.48604992, 'binary_recall': 0.5147745, 'binary_specificity': 0.9807152, 'binary_f1_score': 0.5}
confusion matrix:
       0    1
0  17799  350
1    312  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.82792723, 'recall': 0.6239355, 'specificity': 0.6239355, 'f1': 0.6756215, 'auroc': 0.86841285, 'binary_precision': 0.6875, 'binary_recall': 0.25287357, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.3697479}
confusion matrix:
      0   1
0  5967  30
1   195  66
early stop counter: 3
val acc:0.9647722244262695, best validation acc: 0.9670604467391968, corresponding to test acc:                         0.9691594839096069 / 0.9715564250946045
after epoch: 26,now: 2024-07-10 09:42:01.528406,epoch time: 0:38:15.936052,used: 16:53:07.511621,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99190044, 'precision': 0.9938266, 'recall': 0.98503613, 'specificity': 0.98503613, 'f1': 0.9893291, 'auroc': 0.9988569, 'binary_precision': 0.99769586, 'binary_recall': 0.970852, 'binary_specificity': 0.99922025, 'binary_f1_score': 0.984091}
confusion matrix:
       0      1
0  42289     33
1    429  14289
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.7554084, 'recall': 0.71842515, 'specificity': 0.71842515, 'f1': 0.735317, 'auroc': 0.9156195, 'binary_precision': 0.53016454, 'binary_recall': 0.45101088, 'binary_specificity': 0.9858394, 'binary_f1_score': 0.48739496}
confusion matrix:
       0    1
0  17892  257
1    353  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96708214, 'precision': 0.8826832, 'recall': 0.6401783, 'specificity': 0.6401783, 'f1': 0.7005705, 'auroc': 0.87697387, 'binary_precision': 0.79569894, 'binary_recall': 0.2835249, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.41807908}
confusion matrix:
      0   1
0  5978  19
1   187  74
better model found
persisted
after epoch: 27,now: 2024-07-10 10:21:44.545275,epoch time: 0:39:43.016869,used: 17:32:50.528490,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9917602, 'precision': 0.99292403, 'recall': 0.98553807, 'specificity': 0.98553807, 'f1': 0.9891585, 'auroc': 0.998932, 'binary_precision': 0.99527186, 'binary_recall': 0.9726828, 'binary_specificity': 0.99839336, 'binary_f1_score': 0.9838477}
confusion matrix:
       0      1
0  42256     68
1    402  14314
---- Validation: 
scalar performance:
{'acc': 0.9648787, 'precision': 0.7361399, 'recall': 0.76505125, 'specificity': 0.76505125, 'f1': 0.74966, 'auroc': 0.92028487, 'binary_precision': 0.48827586, 'binary_recall': 0.5505443, 'binary_specificity': 0.9795581, 'binary_f1_score': 0.5175439}
confusion matrix:
       0    1
0  17778  371
1    289  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9696389, 'precision': 0.8615339, 'recall': 0.70197934, 'specificity': 0.70197934, 'f1': 0.7570081, 'auroc': 0.88218373, 'binary_precision': 0.74825174, 'binary_recall': 0.4099617, 'binary_specificity': 0.993997, 'binary_f1_score': 0.529703}
confusion matrix:
      0    1
0  5961   36
1   154  107
early stop counter: 1
val acc:0.9648786783218384, best validation acc: 0.967539370059967, corresponding to test acc:                         0.967082142829895 / 0.9715564250946045
after epoch: 28,now: 2024-07-10 11:04:54.607437,epoch time: 0:43:10.062162,used: 18:16:00.590652,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9907784, 'precision': 0.99326944, 'recall': 0.9826812, 'specificity': 0.9826812, 'f1': 0.98782706, 'auroc': 0.9988406, 'binary_precision': 0.9982443, 'binary_recall': 0.9659531, 'binary_specificity': 0.9994093, 'binary_f1_score': 0.9818333}
confusion matrix:
       0      1
0  42300     25
1    501  14214
---- Validation: 
scalar performance:
{'acc': 0.9671669, 'precision': 0.7528333, 'recall': 0.69198036, 'specificity': 0.69198036, 'f1': 0.7178024, 'auroc': 0.91726136, 'binary_precision': 0.5268595, 'binary_recall': 0.39657855, 'binary_specificity': 0.98738223, 'binary_f1_score': 0.45252886}
confusion matrix:
       0    1
0  17920  229
1    388  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96308726, 'precision': 0.84643674, 'recall': 0.59045327, 'specificity': 0.59045327, 'f1': 0.63731325, 'auroc': 0.8665939, 'binary_precision': 0.72727275, 'binary_recall': 0.18390805, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.29357797}
confusion matrix:
      0   1
0  5979  18
1   213  48
early stop counter: 2
val acc:0.9671669006347656, best validation acc: 0.967539370059967, corresponding to test acc:                         0.967082142829895 / 0.9715564250946045
after epoch: 29,now: 2024-07-10 11:44:52.370884,epoch time: 0:39:57.763447,used: 18:55:58.354099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9922861, 'precision': 0.993232, 'recall': 0.9866034, 'specificity': 0.9866034, 'f1': 0.9898593, 'auroc': 0.99869025, 'binary_precision': 0.99514496, 'binary_recall': 0.9748607, 'binary_specificity': 0.99834603, 'binary_f1_score': 0.9848984}
confusion matrix:
       0      1
0  42252     70
1    370  14348
---- Validation: 
scalar performance:
{'acc': 0.9650383, 'precision': 0.73723596, 'recall': 0.766634, 'specificity': 0.766634, 'f1': 0.750973, 'auroc': 0.9246055, 'binary_precision': 0.4903581, 'binary_recall': 0.55365473, 'binary_specificity': 0.9796132, 'binary_f1_score': 0.52008766}
confusion matrix:
       0    1
0  17779  370
1    287  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96724194, 'precision': 0.8724725, 'recall': 0.64942336, 'specificity': 0.64942336, 'f1': 0.7091967, 'auroc': 0.87588954, 'binary_precision': 0.7745098, 'binary_recall': 0.30268198, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.4352617}
confusion matrix:
      0   1
0  5974  23
1   182  79
early stop counter: 3
val acc:0.9650382995605469, best validation acc: 0.967539370059967, corresponding to test acc:                         0.967082142829895 / 0.9715564250946045
after epoch: 30,now: 2024-07-10 12:23:53.481026,epoch time: 0:39:01.110142,used: 19:34:59.464241,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_53_seed_0_21787676
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 19:34:59.464241 at 2024-07-10 12:23:53.481026
persisted model performance metric: 

scalar performance:
{'acc': 0.96708214, 'precision': 0.8826832, 'recall': 0.6401783, 'specificity': 0.6401783, 'f1': 0.7005705, 'auroc': 0.87697387, 'binary_precision': 0.79569894, 'binary_recall': 0.2835249, 'binary_specificity': 0.9968318, 'binary_f1_score': 0.41807908}
confusion matrix:
      0   1
0  5978  19
1   187  74
oracle model performance metric: 

scalar performance:
{'acc': 0.9715564, 'precision': 0.88498396, 'recall': 0.7121415, 'specificity': 0.7121415, 'f1': 0.77126014, 'auroc': 0.8899344, 'binary_precision': 0.79432625, 'binary_recall': 0.42911878, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.5572139}
confusion matrix:
      0    1
0  5968   29
1   149  112
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   4047 MiB |   3071 TiB |   3071 TiB |
|       from large pool | 180662 KiB |   4027 MiB |   3037 TiB |   3037 TiB |
|       from small pool |  17491 KiB |     37 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   4047 MiB |   3071 TiB |   3071 TiB |
|       from large pool | 180662 KiB |   4027 MiB |   3037 TiB |   3037 TiB |
|       from small pool |  17491 KiB |     37 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   4045 MiB |   3071 TiB |   3071 TiB |
|       from large pool | 178979 KiB |   4026 MiB |   3037 TiB |   3037 TiB |
|       from small pool |  16482 KiB |     36 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4966 MiB |   4966 MiB |   4966 MiB |      0 B   |
|       from large pool |   4924 MiB |   4924 MiB |   4924 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  57847 KiB | 392988 KiB |   1541 TiB |   1541 TiB |
|       from large pool |  50762 KiB | 392048 KiB |   1507 TiB |   1507 TiB |
|       from small pool |   7085 KiB |   9982 KiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7605    |  401488 K  |  401485 K  |
|       from large pool |      79    |     423    |  274874 K  |  274874 K  |
|       from small pool |    2899    |    7525    |  126614 K  |  126611 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7605    |  401488 K  |  401485 K  |
|       from large pool |      79    |     423    |  274874 K  |  274874 K  |
|       from small pool |    2899    |    7525    |  126614 K  |  126611 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     204    |     204    |     204    |       0    |
|       from large pool |     183    |     183    |     183    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3586    |  281743 K  |  281743 K  |
|       from large pool |      10    |     183    |  214984 K  |  214984 K  |
|       from small pool |      22    |    3576    |   66759 K  |   66759 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4047 MiB |   3071 TiB |   3071 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   3037 TiB |   3037 TiB |
|       from small pool |      0 KiB |     37 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4047 MiB |   3071 TiB |   3071 TiB |
|       from large pool |  16640 KiB |   4027 MiB |   3037 TiB |   3037 TiB |
|       from small pool |      0 KiB |     37 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB |   3071 TiB |   3071 TiB |
|       from large pool |  16640 KiB |   4026 MiB |   3037 TiB |   3037 TiB |
|       from small pool |      0 KiB |     36 MiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   4966 MiB |   4966 MiB |   4716 MiB |
|       from large pool | 231424 KiB |   4924 MiB |   4924 MiB |   4698 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392988 KiB |   1541 TiB |   1541 TiB |
|       from large pool |  30464 KiB | 392048 KiB |   1507 TiB |   1507 TiB |
|       from small pool |      0 KiB |  18291 KiB |     33 TiB |     33 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |  401488 K  |  401488 K  |
|       from large pool |       2    |     423    |  274874 K  |  274874 K  |
|       from small pool |       0    |    7525    |  126614 K  |  126614 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |  401488 K  |  401488 K  |
|       from large pool |       2    |     423    |  274874 K  |  274874 K  |
|       from small pool |       0    |    7525    |  126614 K  |  126614 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     204    |     204    |     181    |
|       from large pool |      11    |     183    |     183    |     172    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3586    |  281744 K  |  281744 K  |
|       from large pool |       3    |     183    |  214984 K  |  214984 K  |
|       from small pool |       0    |    3576    |   66760 K  |   66760 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 10 12:36:21 2024]
Finished job 0.
1 of 1 steps (100%) done
