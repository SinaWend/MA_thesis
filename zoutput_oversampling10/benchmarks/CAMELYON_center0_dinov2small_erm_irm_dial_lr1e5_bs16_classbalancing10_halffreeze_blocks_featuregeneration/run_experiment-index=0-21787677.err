Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Tue Jul  9 16:41:00 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677

 Experiment start at: 2024-07-09 16:48:08.284648
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9632714, 'precision': 0.96758616, 'recall': 0.9359776, 'specificity': 0.9359776, 'f1': 0.9504, 'auroc': 0.9865545, 'binary_precision': 0.9756539, 'binary_recall': 0.8795868, 'binary_specificity': 0.9923684, 'binary_f1_score': 0.9251331}
confusion matrix:
       0      1
0  42001    323
1   1772  12944
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9543955, 'precision': 0.6632456, 'recall': 0.67861795, 'specificity': 0.67861795, 'f1': 0.67053175, 'auroc': 0.88117206, 'binary_precision': 0.34844193, 'binary_recall': 0.38258165, 'binary_specificity': 0.97465426, 'binary_f1_score': 0.36471462}
confusion matrix:
       0    1
0  17689  460
1    397  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9598913, 'precision': 0.7491183, 'recall': 0.7500311, 'specificity': 0.7500311, 'f1': 0.74957377, 'auroc': 0.9013844, 'binary_precision': 0.519084, 'binary_recall': 0.5210728, 'binary_specificity': 0.9789895, 'binary_f1_score': 0.52007645}
confusion matrix:
      0    1
0  5871  126
1   125  136
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-09 17:12:43.817574,epoch time: 0:24:35.532926,used: 0:24:35.532926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9729839, 'precision': 0.9745563, 'recall': 0.95449865, 'specificity': 0.95449865, 'f1': 0.96397436, 'auroc': 0.99166423, 'binary_precision': 0.9776022, 'binary_recall': 0.9162987, 'binary_specificity': 0.99269867, 'binary_f1_score': 0.9459583}
confusion matrix:
       0      1
0  42012    309
1   1232  13487
---- Validation: 
scalar performance:
{'acc': 0.94976586, 'precision': 0.6653342, 'recall': 0.74897647, 'specificity': 0.74897647, 'f1': 0.69730157, 'auroc': 0.9011936, 'binary_precision': 0.34751773, 'binary_recall': 0.533437, 'binary_specificity': 0.9645159, 'binary_f1_score': 0.4208589}
confusion matrix:
       0    1
0  17505  644
1    300  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95302016, 'precision': 0.72133493, 'recall': 0.81973934, 'specificity': 0.81973934, 'f1': 0.7600616, 'auroc': 0.9092324, 'binary_precision': 0.45714286, 'binary_recall': 0.6743295, 'binary_specificity': 0.9651492, 'binary_f1_score': 0.54489166}
confusion matrix:
      0    1
0  5788  209
1    85  176
early stop counter: 1
val acc:0.9497658610343933, best validation acc: 0.9543954730033875, corresponding to test acc:                         0.9598913192749023 / 0.9598913192749023
after epoch: 2,now: 2024-07-09 17:35:21.346542,epoch time: 0:22:37.528968,used: 0:47:13.061894,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97719145, 'precision': 0.9745827, 'recall': 0.9655057, 'specificity': 0.9655057, 'f1': 0.96992934, 'auroc': 0.9935535, 'binary_precision': 0.9693535, 'binary_recall': 0.94136035, 'binary_specificity': 0.989651, 'binary_f1_score': 0.9551518}
confusion matrix:
       0      1
0  41885    438
1    863  13854
---- Validation: 
scalar performance:
{'acc': 0.94364625, 'precision': 0.6565426, 'recall': 0.7840611, 'specificity': 0.7840611, 'f1': 0.6985023, 'auroc': 0.90685624, 'binary_precision': 0.32724252, 'binary_recall': 0.61275274, 'binary_specificity': 0.9553694, 'binary_f1_score': 0.4266378}
confusion matrix:
       0    1
0  17339  810
1    249  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92809206, 'precision': 0.6618433, 'recall': 0.8378825, 'specificity': 0.8378825, 'f1': 0.71159756, 'auroc': 0.90982527, 'binary_precision': 0.33565217, 'binary_recall': 0.7394636, 'binary_specificity': 0.93630147, 'binary_f1_score': 0.4617225}
confusion matrix:
      0    1
0  5615  382
1    68  193
early stop counter: 2
val acc:0.943646252155304, best validation acc: 0.9543954730033875, corresponding to test acc:                         0.9598913192749023 / 0.9598913192749023
after epoch: 3,now: 2024-07-09 17:57:15.776248,epoch time: 0:21:54.429706,used: 1:09:07.491600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9798738, 'precision': 0.98240787, 'recall': 0.9649021, 'specificity': 0.9649021, 'f1': 0.9732412, 'auroc': 0.99528205, 'binary_precision': 0.98735905, 'binary_recall': 0.9339629, 'binary_specificity': 0.9958413, 'binary_f1_score': 0.95991904}
confusion matrix:
       0      1
0  42145    176
1    972  13747
---- Validation: 
scalar performance:
{'acc': 0.9535441, 'precision': 0.67716473, 'recall': 0.7434319, 'specificity': 0.7434319, 'f1': 0.7042644, 'auroc': 0.9061068, 'binary_precision': 0.3716518, 'binary_recall': 0.5178849, 'binary_specificity': 0.968979, 'binary_f1_score': 0.43274853}
confusion matrix:
       0    1
0  17586  563
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94119525, 'precision': 0.68267655, 'recall': 0.80440795, 'specificity': 0.80440795, 'f1': 0.7252598, 'auroc': 0.90820956, 'binary_precision': 0.38084632, 'binary_recall': 0.6551724, 'binary_specificity': 0.9536435, 'binary_f1_score': 0.48169014}
confusion matrix:
      0    1
0  5719  278
1    90  171
early stop counter: 3
val acc:0.9535440802574158, best validation acc: 0.9543954730033875, corresponding to test acc:                         0.9598913192749023 / 0.9598913192749023
after epoch: 4,now: 2024-07-09 18:19:23.287874,epoch time: 0:22:07.511626,used: 1:31:15.003226,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9828541, 'precision': 0.9836292, 'recall': 0.97142684, 'specificity': 0.97142684, 'f1': 0.9773264, 'auroc': 0.99582464, 'binary_precision': 0.98516846, 'binary_recall': 0.9478155, 'binary_specificity': 0.99503815, 'binary_f1_score': 0.9661311}
confusion matrix:
       0      1
0  42113    210
1    768  13949
---- Validation: 
scalar performance:
{'acc': 0.95093656, 'precision': 0.6640966, 'recall': 0.728581, 'specificity': 0.728581, 'f1': 0.6901697, 'auroc': 0.89733005, 'binary_precision': 0.34653464, 'binary_recall': 0.48989114, 'binary_specificity': 0.9672709, 'binary_f1_score': 0.40592784}
confusion matrix:
       0    1
0  17555  594
1    328  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9356024, 'precision': 0.66402996, 'recall': 0.7795018, 'specificity': 0.7795018, 'f1': 0.7034435, 'auroc': 0.8949685, 'binary_precision': 0.34565216, 'binary_recall': 0.6091954, 'binary_specificity': 0.94980824, 'binary_f1_score': 0.44105408}
confusion matrix:
      0    1
0  5696  301
1   102  159
early stop counter: 4
val acc:0.9509365558624268, best validation acc: 0.9543954730033875, corresponding to test acc:                         0.9598913192749023 / 0.9598913192749023
after epoch: 5,now: 2024-07-09 19:09:21.506900,epoch time: 0:49:58.219026,used: 2:21:13.222252,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9820126, 'precision': 0.9856703, 'recall': 0.9673563, 'specificity': 0.9673563, 'f1': 0.9760649, 'auroc': 0.99640495, 'binary_precision': 0.9928006, 'binary_recall': 0.9370753, 'binary_specificity': 0.9976373, 'binary_f1_score': 0.96413344}
confusion matrix:
       0      1
0  42224    100
1    926  13790
---- Validation: 
scalar performance:
{'acc': 0.95732224, 'precision': 0.67624885, 'recall': 0.6741327, 'specificity': 0.6741327, 'f1': 0.6751835, 'auroc': 0.8873875, 'binary_precision': 0.37480316, 'binary_recall': 0.37013996, 'binary_specificity': 0.9781255, 'binary_f1_score': 0.37245694}
confusion matrix:
       0    1
0  17752  397
1    405  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95254076, 'precision': 0.7110751, 'recall': 0.7516929, 'specificity': 0.7516929, 'f1': 0.729303, 'auroc': 0.89068604, 'binary_precision': 0.44267517, 'binary_recall': 0.532567, 'binary_specificity': 0.97081876, 'binary_f1_score': 0.48347828}
confusion matrix:
      0    1
0  5822  175
1   122  139
better model found
persisted
after epoch: 6,now: 2024-07-09 19:33:57.411610,epoch time: 0:24:35.904710,used: 2:45:49.126962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9849404, 'precision': 0.98680973, 'recall': 0.9737839, 'specificity': 0.9737839, 'f1': 0.98006916, 'auroc': 0.9968108, 'binary_precision': 0.99051327, 'binary_recall': 0.9507339, 'binary_specificity': 0.9968339, 'binary_f1_score': 0.970216}
confusion matrix:
       0      1
0  42190    134
1    725  13991
---- Validation: 
scalar performance:
{'acc': 0.95950407, 'precision': 0.6963146, 'recall': 0.7060145, 'specificity': 0.7060145, 'f1': 0.7010317, 'auroc': 0.9035803, 'binary_precision': 0.4127219, 'binary_recall': 0.43390357, 'binary_specificity': 0.9781255, 'binary_f1_score': 0.42304778}
confusion matrix:
       0    1
0  17752  397
1    364  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9595717, 'precision': 0.7470479, 'recall': 0.74070275, 'specificity': 0.74070275, 'f1': 0.7438282, 'auroc': 0.89967144, 'binary_precision': 0.515748, 'binary_recall': 0.5019157, 'binary_specificity': 0.97948974, 'binary_f1_score': 0.50873786}
confusion matrix:
      0    1
0  5874  123
1   130  131
better model found
persisted
after epoch: 7,now: 2024-07-09 19:57:41.806503,epoch time: 0:23:44.394893,used: 3:09:33.521855,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9865182, 'precision': 0.98620826, 'recall': 0.9784572, 'specificity': 0.9784572, 'f1': 0.9822515, 'auroc': 0.9973322, 'binary_precision': 0.98558396, 'binary_recall': 0.9618051, 'binary_specificity': 0.9951094, 'binary_f1_score': 0.9735493}
confusion matrix:
       0      1
0  42119    207
1    562  14152
---- Validation: 
scalar performance:
{'acc': 0.9534376, 'precision': 0.6717014, 'recall': 0.72237533, 'specificity': 0.72237533, 'f1': 0.69326776, 'auroc': 0.9040527, 'binary_precision': 0.36223277, 'binary_recall': 0.47433904, 'binary_specificity': 0.9704116, 'binary_f1_score': 0.4107744}
confusion matrix:
       0    1
0  17612  537
1    338  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95158195, 'precision': 0.70776105, 'recall': 0.75668967, 'specificity': 0.75668967, 'f1': 0.7292079, 'auroc': 0.8994894, 'binary_precision': 0.43558282, 'binary_recall': 0.5440613, 'binary_specificity': 0.969318, 'binary_f1_score': 0.48381603}
confusion matrix:
      0    1
0  5813  184
1   119  142
early stop counter: 1
val acc:0.9534376263618469, best validation acc: 0.9595040678977966, corresponding to test acc:                         0.9595717191696167 / 0.9598913192749023
after epoch: 8,now: 2024-07-09 20:20:54.059414,epoch time: 0:23:12.252911,used: 3:32:45.774766,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9870968, 'precision': 0.9873264, 'recall': 0.9788717, 'specificity': 0.9788717, 'f1': 0.9830028, 'auroc': 0.997591, 'binary_precision': 0.98778784, 'binary_recall': 0.96187824, 'binary_specificity': 0.9958652, 'binary_f1_score': 0.97466093}
confusion matrix:
       0      1
0  42149    175
1    561  14155
---- Validation: 
scalar performance:
{'acc': 0.9568433, 'precision': 0.67127115, 'recall': 0.6663842, 'specificity': 0.6663842, 'f1': 0.66878706, 'auroc': 0.89356863, 'binary_precision': 0.3653846, 'binary_recall': 0.35458788, 'binary_specificity': 0.9781806, 'binary_f1_score': 0.35990527}
confusion matrix:
       0    1
0  17753  396
1    415  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.71948177, 'recall': 0.7073853, 'specificity': 0.7073853, 'f1': 0.7132358, 'auroc': 0.8865149, 'binary_precision': 0.46341464, 'binary_recall': 0.43678162, 'binary_specificity': 0.977989, 'binary_f1_score': 0.44970414}
confusion matrix:
      0    1
0  5865  132
1   147  114
early stop counter: 2
val acc:0.9568433165550232, best validation acc: 0.9595040678977966, corresponding to test acc:                         0.9595717191696167 / 0.9598913192749023
after epoch: 9,now: 2024-07-09 20:42:39.288292,epoch time: 0:21:45.228878,used: 3:54:31.003644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9877279, 'precision': 0.9893145, 'recall': 0.9785892, 'specificity': 0.9785892, 'f1': 0.9837981, 'auroc': 0.9977543, 'binary_precision': 0.99248123, 'binary_recall': 0.9597065, 'binary_specificity': 0.9974718, 'binary_f1_score': 0.9758187}
confusion matrix:
       0      1
0  42216    107
1    593  14124
---- Validation: 
scalar performance:
{'acc': 0.95929116, 'precision': 0.6813933, 'recall': 0.6526504, 'specificity': 0.6526504, 'f1': 0.66561455, 'auroc': 0.89004254, 'binary_precision': 0.3866171, 'binary_recall': 0.32348368, 'binary_specificity': 0.9818172, 'binary_f1_score': 0.35224384}
confusion matrix:
       0    1
0  17819  330
1    435  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.7482015, 'recall': 0.70047474, 'specificity': 0.70047474, 'f1': 0.721455, 'auroc': 0.8851768, 'binary_precision': 0.5215311, 'binary_recall': 0.41762453, 'binary_specificity': 0.983325, 'binary_f1_score': 0.4638298}
confusion matrix:
      0    1
0  5897  100
1   152  109
early stop counter: 3
val acc:0.9592911601066589, best validation acc: 0.9595040678977966, corresponding to test acc:                         0.9595717191696167 / 0.9598913192749023
after epoch: 10,now: 2024-07-09 21:04:30.696079,epoch time: 0:21:51.407787,used: 4:16:22.411431,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9878331, 'precision': 0.9867615, 'recall': 0.9813626, 'specificity': 0.9813626, 'f1': 0.9840226, 'auroc': 0.9976328, 'binary_precision': 0.98458666, 'binary_recall': 0.96799403, 'binary_specificity': 0.9947311, 'binary_f1_score': 0.9762199}
confusion matrix:
       0      1
0  42101    223
1    471  14245
---- Validation: 
scalar performance:
{'acc': 0.948808, 'precision': 0.66013926, 'recall': 0.74022996, 'specificity': 0.74022996, 'f1': 0.6908053, 'auroc': 0.90634686, 'binary_precision': 0.3377416, 'binary_recall': 0.5163297, 'binary_specificity': 0.9641303, 'binary_f1_score': 0.4083641}
confusion matrix:
       0    1
0  17498  651
1    311  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95302016, 'precision': 0.7127086, 'recall': 0.7482784, 'specificity': 0.7482784, 'f1': 0.7288939, 'auroc': 0.89161515, 'binary_precision': 0.44625407, 'binary_recall': 0.5249042, 'binary_specificity': 0.9716525, 'binary_f1_score': 0.48239437}
confusion matrix:
      0    1
0  5827  170
1   124  137
early stop counter: 4
val acc:0.9488080143928528, best validation acc: 0.9595040678977966, corresponding to test acc:                         0.9595717191696167 / 0.9598913192749023
after epoch: 11,now: 2024-07-09 21:26:22.761203,epoch time: 0:21:52.065124,used: 4:38:14.476555,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98907787, 'precision': 0.9883939, 'recall': 0.98299825, 'specificity': 0.98299825, 'f1': 0.98565686, 'auroc': 0.998173, 'binary_precision': 0.98700583, 'binary_recall': 0.9704383, 'binary_specificity': 0.9955582, 'binary_f1_score': 0.97865194}
confusion matrix:
       0      1
0  42137    188
1    435  14280
---- Validation: 
scalar performance:
{'acc': 0.9518944, 'precision': 0.65533763, 'recall': 0.68632376, 'specificity': 0.68632376, 'f1': 0.66919154, 'auroc': 0.8970621, 'binary_precision': 0.33204633, 'binary_recall': 0.40124416, 'binary_specificity': 0.97140336, 'binary_f1_score': 0.36338028}
confusion matrix:
       0    1
0  17630  519
1    385  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.72486407, 'recall': 0.71329916, 'specificity': 0.71329916, 'f1': 0.7189059, 'auroc': 0.8860423, 'binary_precision': 0.47368422, 'binary_recall': 0.44827586, 'binary_specificity': 0.9783225, 'binary_f1_score': 0.4606299}
confusion matrix:
      0    1
0  5867  130
1   144  117
early stop counter: 5
val acc:0.9518944025039673, best validation acc: 0.9595040678977966, corresponding to test acc:                         0.9595717191696167 / 0.9598913192749023
after epoch: 12,now: 2024-07-09 21:48:05.647233,epoch time: 0:21:42.886030,used: 4:59:57.362585,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98820126, 'precision': 0.9886462, 'recall': 0.980457, 'specificity': 0.980457, 'f1': 0.98446155, 'auroc': 0.9977591, 'binary_precision': 0.98954123, 'binary_recall': 0.96445805, 'binary_specificity': 0.99645597, 'binary_f1_score': 0.97683865}
confusion matrix:
       0      1
0  42175    150
1    523  14192
---- Validation: 
scalar performance:
{'acc': 0.9509898, 'precision': 0.6595855, 'recall': 0.7113573, 'specificity': 0.7113573, 'f1': 0.6812563, 'auroc': 0.90336406, 'binary_precision': 0.3387471, 'binary_recall': 0.4541213, 'binary_specificity': 0.9685933, 'binary_f1_score': 0.3880399}
confusion matrix:
       0    1
0  17579  570
1    351  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.7620264, 'recall': 0.7252956, 'specificity': 0.7252956, 'f1': 0.7420927, 'auroc': 0.8911135, 'binary_precision': 0.5470852, 'binary_recall': 0.46743295, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.5041322}
confusion matrix:
      0    1
0  5896  101
1   139  122
new oracle model saved
early stop counter: 6
val acc:0.9509897828102112, best validation acc: 0.9595040678977966, corresponding to test acc:                         0.9595717191696167 / 0.9616490602493286
after epoch: 13,now: 2024-07-09 22:09:57.666407,epoch time: 0:21:52.019174,used: 5:21:49.381759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9901297, 'precision': 0.98940575, 'recall': 0.98474884, 'specificity': 0.98474884, 'f1': 0.98704803, 'auroc': 0.9983107, 'binary_precision': 0.9879327, 'binary_recall': 0.97363234, 'binary_specificity': 0.99586535, 'binary_f1_score': 0.98073035}
confusion matrix:
       0      1
0  42150    175
1    388  14327
---- Validation: 
scalar performance:
{'acc': 0.9585994, 'precision': 0.6819293, 'recall': 0.6687935, 'specificity': 0.6687935, 'f1': 0.6750808, 'auroc': 0.89507973, 'binary_precision': 0.38655463, 'binary_recall': 0.3576983, 'binary_specificity': 0.9798887, 'binary_f1_score': 0.37156704}
confusion matrix:
       0    1
0  17784  365
1    413  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9592522, 'precision': 0.7444843, 'recall': 0.69655997, 'specificity': 0.69655997, 'f1': 0.7175614, 'auroc': 0.88666683, 'binary_precision': 0.5144231, 'binary_recall': 0.4099617, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.45628998}
confusion matrix:
      0    1
0  5896  101
1   154  107
early stop counter: 7
val acc:0.9585993885993958, best validation acc: 0.9595040678977966, corresponding to test acc:                         0.9595717191696167 / 0.9616490602493286
after epoch: 14,now: 2024-07-09 22:32:14.086249,epoch time: 0:22:16.419842,used: 5:44:05.801601,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98884994, 'precision': 0.990836, 'recall': 0.9800335, 'specificity': 0.9800335, 'f1': 0.98527944, 'auroc': 0.99769366, 'binary_precision': 0.99479973, 'binary_recall': 0.9618155, 'binary_specificity': 0.9982515, 'binary_f1_score': 0.97802955}
confusion matrix:
       0      1
0  42248     74
1    562  14156
---- Validation: 
scalar performance:
{'acc': 0.96051514, 'precision': 0.6758903, 'recall': 0.6127811, 'specificity': 0.6127811, 'f1': 0.63651174, 'auroc': 0.88698584, 'binary_precision': 0.3783784, 'binary_recall': 0.23950233, 'binary_specificity': 0.98605984, 'binary_f1_score': 0.29333335}
confusion matrix:
       0    1
0  17896  253
1    489  154
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589326, 'precision': 0.74175346, 'recall': 0.62859684, 'specificity': 0.62859684, 'f1': 0.6657193, 'auroc': 0.87939644, 'binary_precision': 0.5147059, 'binary_recall': 0.26819924, 'binary_specificity': 0.9889945, 'binary_f1_score': 0.35264486}
confusion matrix:
      0   1
0  5931  66
1   191  70
better model found
persisted
after epoch: 15,now: 2024-07-09 22:55:07.893977,epoch time: 0:22:53.807728,used: 6:06:59.609329,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99030507, 'precision': 0.9879645, 'recall': 0.9866858, 'specificity': 0.9866858, 'f1': 0.9873229, 'auroc': 0.9982478, 'binary_precision': 0.9831491, 'binary_recall': 0.9792077, 'binary_specificity': 0.99416393, 'binary_f1_score': 0.9811744}
confusion matrix:
       0      1
0  42076    247
1    306  14411
---- Validation: 
scalar performance:
{'acc': 0.9483823, 'precision': 0.65434444, 'recall': 0.72350836, 'specificity': 0.72350836, 'f1': 0.6814941, 'auroc': 0.9028026, 'binary_precision': 0.3273495, 'binary_recall': 0.4821151, 'binary_specificity': 0.9649016, 'binary_f1_score': 0.3899371}
confusion matrix:
       0    1
0  17512  637
1    333  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9487057, 'precision': 0.68857825, 'recall': 0.71670985, 'specificity': 0.71670985, 'f1': 0.7014924, 'auroc': 0.88082355, 'binary_precision': 0.40066224, 'binary_recall': 0.46360153, 'binary_specificity': 0.96981823, 'binary_f1_score': 0.42984012}
confusion matrix:
      0    1
0  5816  181
1   140  121
early stop counter: 1
val acc:0.9483823180198669, best validation acc: 0.9605151414871216, corresponding to test acc:                         0.9589325785636902 / 0.9616490602493286
after epoch: 16,now: 2024-07-09 23:17:42.617276,epoch time: 0:22:34.723299,used: 6:29:34.332628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98981416, 'precision': 0.98800695, 'recall': 0.98533416, 'specificity': 0.98533416, 'f1': 0.98666084, 'auroc': 0.99794424, 'binary_precision': 0.98430645, 'binary_recall': 0.9760788, 'binary_specificity': 0.9945895, 'binary_f1_score': 0.9801753}
confusion matrix:
       0      1
0  42096    229
1    352  14363
---- Validation: 
scalar performance:
{'acc': 0.9462005, 'precision': 0.6442099, 'recall': 0.711128, 'specificity': 0.711128, 'f1': 0.67021155, 'auroc': 0.8927783, 'binary_precision': 0.30793318, 'binary_recall': 0.45878693, 'binary_specificity': 0.9634691, 'binary_f1_score': 0.36851966}
confusion matrix:
       0    1
0  17486  663
1    348  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9496644, 'precision': 0.68854934, 'recall': 0.6988868, 'specificity': 0.6988868, 'f1': 0.69355595, 'auroc': 0.877292, 'binary_precision': 0.4021739, 'binary_recall': 0.42528737, 'binary_specificity': 0.97248626, 'binary_f1_score': 0.41340783}
confusion matrix:
      0    1
0  5832  165
1   150  111
early stop counter: 2
val acc:0.9462004899978638, best validation acc: 0.9605151414871216, corresponding to test acc:                         0.9589325785636902 / 0.9616490602493286
after epoch: 17,now: 2024-07-09 23:40:26.620675,epoch time: 0:22:44.003399,used: 6:52:18.336027,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99048036, 'precision': 0.989209, 'recall': 0.9858732, 'specificity': 0.9858732, 'f1': 0.98752606, 'auroc': 0.9986119, 'binary_precision': 0.98661083, 'binary_recall': 0.9763539, 'binary_specificity': 0.99539256, 'binary_f1_score': 0.98145556}
confusion matrix:
       0      1
0  42128    195
1    348  14369
---- Validation: 
scalar performance:
{'acc': 0.94960624, 'precision': 0.65697676, 'recall': 0.7188916, 'specificity': 0.7188916, 'f1': 0.6819648, 'auroc': 0.90238655, 'binary_precision': 0.33296704, 'binary_recall': 0.47122863, 'binary_specificity': 0.96655464, 'binary_f1_score': 0.39021254}
confusion matrix:
       0    1
0  17542  607
1    340  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95126235, 'precision': 0.69765484, 'recall': 0.70704985, 'specificity': 0.70704985, 'f1': 0.7022248, 'auroc': 0.8808326, 'binary_precision': 0.41970804, 'binary_recall': 0.44061303, 'binary_specificity': 0.9734867, 'binary_f1_score': 0.42990658}
confusion matrix:
      0    1
0  5838  159
1   146  115
early stop counter: 3
val acc:0.9496062397956848, best validation acc: 0.9605151414871216, corresponding to test acc:                         0.9589325785636902 / 0.9616490602493286
after epoch: 18,now: 2024-07-10 00:03:38.505206,epoch time: 0:23:11.884531,used: 7:15:30.220558,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9897265, 'precision': 0.99160826, 'recall': 0.9815537, 'specificity': 0.9815537, 'f1': 0.9864466, 'auroc': 0.99843574, 'binary_precision': 0.99537265, 'binary_recall': 0.9646667, 'binary_specificity': 0.99844056, 'binary_f1_score': 0.9797792}
confusion matrix:
       0      1
0  42257     66
1    520  14197
---- Validation: 
scalar performance:
{'acc': 0.9612069, 'precision': 0.6954756, 'recall': 0.65439224, 'specificity': 0.65439224, 'f1': 0.67221093, 'auroc': 0.8977232, 'binary_precision': 0.41468254, 'binary_recall': 0.32503888, 'binary_specificity': 0.98374563, 'binary_f1_score': 0.36442894}
confusion matrix:
       0    1
0  17854  295
1    434  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.73815745, 'recall': 0.6375918, 'specificity': 0.6375918, 'f1': 0.6726778, 'auroc': 0.87842995, 'binary_precision': 0.5067568, 'binary_recall': 0.28735632, 'binary_specificity': 0.98782724, 'binary_f1_score': 0.36674818}
confusion matrix:
      0   1
0  5924  73
1   186  75
better model found
persisted
after epoch: 19,now: 2024-07-10 00:26:46.846476,epoch time: 0:23:08.341270,used: 7:38:38.561828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99135697, 'precision': 0.99093515, 'recall': 0.986441, 'specificity': 0.986441, 'f1': 0.98866093, 'auroc': 0.9983697, 'binary_precision': 0.9900765, 'binary_recall': 0.9762843, 'binary_specificity': 0.99659765, 'binary_f1_score': 0.983132}
confusion matrix:
       0      1
0  42180    144
1    349  14367
---- Validation: 
scalar performance:
{'acc': 0.9511494, 'precision': 0.65931916, 'recall': 0.7084397, 'specificity': 0.7084397, 'f1': 0.6800529, 'auroc': 0.90428823, 'binary_precision': 0.33842537, 'binary_recall': 0.44790047, 'binary_specificity': 0.968979, 'binary_f1_score': 0.38554218}
confusion matrix:
       0    1
0  17586  563
1    355  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95605624, 'precision': 0.7220918, 'recall': 0.69672483, 'specificity': 0.69672483, 'f1': 0.70852476, 'auroc': 0.8813918, 'binary_precision': 0.4695652, 'binary_recall': 0.41379312, 'binary_specificity': 0.9796565, 'binary_f1_score': 0.43991855}
confusion matrix:
      0    1
0  5875  122
1   153  108
early stop counter: 1
val acc:0.9511494040489197, best validation acc: 0.9612069129943848, corresponding to test acc:                         0.9586129784584045 / 0.9616490602493286
after epoch: 20,now: 2024-07-10 00:49:16.189862,epoch time: 0:22:29.343386,used: 8:01:07.905214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99091864, 'precision': 0.98942554, 'recall': 0.9868113, 'specificity': 0.9868113, 'f1': 0.98810923, 'auroc': 0.9983094, 'binary_precision': 0.98636705, 'binary_recall': 0.9783244, 'binary_specificity': 0.9952981, 'binary_f1_score': 0.9823293}
confusion matrix:
       0      1
0  42124    199
1    319  14398
---- Validation: 
scalar performance:
{'acc': 0.9509898, 'precision': 0.66106176, 'recall': 0.7166077, 'specificity': 0.7166077, 'f1': 0.6840714, 'auroc': 0.9017941, 'binary_precision': 0.3413242, 'binary_recall': 0.46500778, 'binary_specificity': 0.9682076, 'binary_f1_score': 0.39368004}
confusion matrix:
       0    1
0  17572  577
1    344  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949185, 'precision': 0.69138336, 'recall': 0.7206247, 'specificity': 0.7206247, 'f1': 0.7047819, 'auroc': 0.8761194, 'binary_precision': 0.4059406, 'binary_recall': 0.47126436, 'binary_specificity': 0.969985, 'binary_f1_score': 0.43617022}
confusion matrix:
      0    1
0  5817  180
1   138  123
early stop counter: 2
val acc:0.9509897828102112, best validation acc: 0.9612069129943848, corresponding to test acc:                         0.9586129784584045 / 0.9616490602493286
after epoch: 21,now: 2024-07-10 01:11:32.477556,epoch time: 0:22:16.287694,used: 8:23:24.192908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9907959, 'precision': 0.99070823, 'recall': 0.9852003, 'specificity': 0.9852003, 'f1': 0.9879136, 'auroc': 0.9981755, 'binary_precision': 0.9905302, 'binary_recall': 0.9736377, 'binary_specificity': 0.99676293, 'binary_f1_score': 0.9820113}
confusion matrix:
       0      1
0  42185    137
1    388  14330
---- Validation: 
scalar performance:
{'acc': 0.96051514, 'precision': 0.6906732, 'recall': 0.6555342, 'specificity': 0.6555342, 'f1': 0.67108476, 'auroc': 0.90566206, 'binary_precision': 0.4049904, 'binary_recall': 0.3281493, 'binary_specificity': 0.98291916, 'binary_f1_score': 0.36254296}
confusion matrix:
       0    1
0  17839  310
1    432  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584532, 'precision': 0.73673385, 'recall': 0.64667004, 'specificity': 0.64667004, 'f1': 0.67972887, 'auroc': 0.8827533, 'binary_precision': 0.5031447, 'binary_recall': 0.3065134, 'binary_specificity': 0.9868267, 'binary_f1_score': 0.3809524}
confusion matrix:
      0   1
0  5918  79
1   181  80
early stop counter: 3
val acc:0.9605151414871216, best validation acc: 0.9612069129943848, corresponding to test acc:                         0.9586129784584045 / 0.9616490602493286
after epoch: 22,now: 2024-07-10 01:33:36.241708,epoch time: 0:22:03.764152,used: 8:45:27.957060,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99153227, 'precision': 0.9905253, 'recall': 0.9873113, 'specificity': 0.9873113, 'f1': 0.9889044, 'auroc': 0.9987366, 'binary_precision': 0.9884671, 'binary_recall': 0.9785918, 'binary_specificity': 0.9960308, 'binary_f1_score': 0.98350465}
confusion matrix:
       0      1
0  42158    168
1    315  14399
---- Validation: 
scalar performance:
{'acc': 0.954023, 'precision': 0.6683415, 'recall': 0.7009268, 'specificity': 0.7009268, 'f1': 0.682971, 'auroc': 0.9048157, 'binary_precision': 0.35705045, 'binary_recall': 0.42923796, 'binary_specificity': 0.9726156, 'binary_f1_score': 0.38983053}
confusion matrix:
       0    1
0  17652  497
1    367  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.72565323, 'recall': 0.6679077, 'specificity': 0.6679077, 'f1': 0.69194067, 'auroc': 0.88596356, 'binary_precision': 0.47916666, 'binary_recall': 0.35249043, 'binary_specificity': 0.983325, 'binary_f1_score': 0.406181}
confusion matrix:
      0    1
0  5897  100
1   169   92
early stop counter: 4
val acc:0.954023003578186, best validation acc: 0.9612069129943848, corresponding to test acc:                         0.9586129784584045 / 0.9616490602493286
after epoch: 23,now: 2024-07-10 01:55:50.354576,epoch time: 0:22:14.112868,used: 9:07:42.069928,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99230367, 'precision': 0.99184954, 'recall': 0.9880104, 'specificity': 0.9880104, 'f1': 0.98991024, 'auroc': 0.99878395, 'binary_precision': 0.99092287, 'binary_recall': 0.97913975, 'binary_specificity': 0.9968811, 'binary_f1_score': 0.9849961}
confusion matrix:
       0      1
0  42191    132
1    307  14410
---- Validation: 
scalar performance:
{'acc': 0.9547148, 'precision': 0.67014545, 'recall': 0.69678456, 'specificity': 0.69678456, 'f1': 0.68234855, 'auroc': 0.908041, 'binary_precision': 0.36096257, 'binary_recall': 0.41990668, 'binary_specificity': 0.97366244, 'binary_f1_score': 0.3882099}
confusion matrix:
       0    1
0  17671  478
1    373  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957814, 'precision': 0.7313299, 'recall': 0.6573306, 'specificity': 0.6573306, 'f1': 0.68632054, 'auroc': 0.88472223, 'binary_precision': 0.49142858, 'binary_recall': 0.32950193, 'binary_specificity': 0.9851592, 'binary_f1_score': 0.39449546}
confusion matrix:
      0   1
0  5908  89
1   175  86
early stop counter: 5
val acc:0.9547147750854492, best validation acc: 0.9612069129943848, corresponding to test acc:                         0.9586129784584045 / 0.9616490602493286
after epoch: 24,now: 2024-07-10 02:18:17.790328,epoch time: 0:22:27.435752,used: 9:30:09.505680,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9911115, 'precision': 0.9920523, 'recall': 0.98469925, 'specificity': 0.98469925, 'f1': 0.9883038, 'auroc': 0.9984621, 'binary_precision': 0.99394995, 'binary_recall': 0.97145385, 'binary_specificity': 0.9979446, 'binary_f1_score': 0.98257315}
confusion matrix:
       0      1
0  42240     87
1    420  14293
---- Validation: 
scalar performance:
{'acc': 0.96290976, 'precision': 0.71055937, 'recall': 0.66052425, 'specificity': 0.66052425, 'f1': 0.6817601, 'auroc': 0.9157741, 'binary_precision': 0.44444445, 'binary_recall': 0.33592534, 'binary_specificity': 0.98512316, 'binary_f1_score': 0.38263953}
confusion matrix:
       0    1
0  17879  270
1    427  216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96164906, 'precision': 0.7830517, 'recall': 0.6190202, 'specificity': 0.6190202, 'f1': 0.6640349, 'auroc': 0.8873417, 'binary_precision': 0.5981308, 'binary_recall': 0.24521072, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.3478261}
confusion matrix:
      0   1
0  5954  43
1   197  64
better model found
persisted
after epoch: 25,now: 2024-07-10 02:40:36.648198,epoch time: 0:22:18.857870,used: 9:52:28.363550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99153227, 'precision': 0.98948467, 'recall': 0.98837596, 'specificity': 0.98837596, 'f1': 0.98892856, 'auroc': 0.9989352, 'binary_precision': 0.98527, 'binary_recall': 0.9818553, 'binary_specificity': 0.99489665, 'binary_f1_score': 0.98355967}
confusion matrix:
       0      1
0  42109    216
1    267  14448
---- Validation: 
scalar performance:
{'acc': 0.954023, 'precision': 0.6790546, 'recall': 0.7436799, 'specificity': 0.7436799, 'f1': 0.70566505, 'auroc': 0.9203418, 'binary_precision': 0.37542278, 'binary_recall': 0.5178849, 'binary_specificity': 0.9694749, 'binary_f1_score': 0.43529412}
confusion matrix:
       0    1
0  17595  554
1    310  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.7321845, 'recall': 0.70480454, 'specificity': 0.70480454, 'f1': 0.7175121, 'auroc': 0.8904649, 'binary_precision': 0.48908296, 'binary_recall': 0.42911878, 'binary_specificity': 0.98049027, 'binary_f1_score': 0.45714286}
confusion matrix:
      0    1
0  5880  117
1   149  112
early stop counter: 1
val acc:0.954023003578186, best validation acc: 0.9629097580909729, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 26,now: 2024-07-10 03:02:53.539913,epoch time: 0:22:16.891715,used: 10:14:45.255265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99181277, 'precision': 0.9930972, 'recall': 0.98550797, 'specificity': 0.98550797, 'f1': 0.989226, 'auroc': 0.998667, 'binary_precision': 0.99568665, 'binary_recall': 0.97248083, 'binary_specificity': 0.9985351, 'binary_f1_score': 0.98394686}
confusion matrix:
       0      1
0  42261     62
1    405  14312
---- Validation: 
scalar performance:
{'acc': 0.9619519, 'precision': 0.70158404, 'recall': 0.655528, 'specificity': 0.655528, 'f1': 0.6752138, 'auroc': 0.90808725, 'binary_precision': 0.42682928, 'binary_recall': 0.32659408, 'binary_specificity': 0.98446196, 'binary_f1_score': 0.37004405}
confusion matrix:
       0    1
0  17867  282
1    433  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.71966493, 'recall': 0.5838705, 'specificity': 0.5838705, 'f1': 0.61755234, 'auroc': 0.87689435, 'binary_precision': 0.4742268, 'binary_recall': 0.17624521, 'binary_specificity': 0.9914957, 'binary_f1_score': 0.25698322}
confusion matrix:
      0   1
0  5946  51
1   215  46
early stop counter: 2
val acc:0.9619519114494324, best validation acc: 0.9629097580909729, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 27,now: 2024-07-10 03:25:03.943834,epoch time: 0:22:10.403921,used: 10:36:55.659186,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.991953, 'precision': 0.99287087, 'recall': 0.98609084, 'specificity': 0.98609084, 'f1': 0.9894197, 'auroc': 0.9984218, 'binary_precision': 0.99472624, 'binary_recall': 0.97397745, 'binary_specificity': 0.99820423, 'binary_f1_score': 0.98424244}
confusion matrix:
       0      1
0  42246     76
1    383  14335
---- Validation: 
scalar performance:
{'acc': 0.95992976, 'precision': 0.69194895, 'recall': 0.67548263, 'specificity': 0.67548263, 'f1': 0.68329716, 'auroc': 0.91255605, 'binary_precision': 0.40614334, 'binary_recall': 0.37013996, 'binary_specificity': 0.98082536, 'binary_f1_score': 0.38730675}
confusion matrix:
       0    1
0  17801  348
1    405  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95685524, 'precision': 0.7189845, 'recall': 0.6256807, 'specificity': 0.6256807, 'f1': 0.657968, 'auroc': 0.876616, 'binary_precision': 0.46938777, 'binary_recall': 0.26436782, 'binary_specificity': 0.9869935, 'binary_f1_score': 0.3382353}
confusion matrix:
      0   1
0  5919  78
1   192  69
early stop counter: 3
val acc:0.9599297642707825, best validation acc: 0.9629097580909729, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 28,now: 2024-07-10 03:47:03.979308,epoch time: 0:22:00.035474,used: 10:58:55.694660,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9915498, 'precision': 0.99230254, 'recall': 0.98559487, 'specificity': 0.98559487, 'f1': 0.98888874, 'auroc': 0.998811, 'binary_precision': 0.9938242, 'binary_recall': 0.9732925, 'binary_specificity': 0.9978972, 'binary_f1_score': 0.9834512}
confusion matrix:
       0      1
0  42236     89
1    393  14322
---- Validation: 
scalar performance:
{'acc': 0.95955724, 'precision': 0.68321, 'recall': 0.65278816, 'specificity': 0.65278816, 'f1': 0.66643345, 'auroc': 0.9035804, 'binary_precision': 0.3902439, 'binary_recall': 0.32348368, 'binary_specificity': 0.9820927, 'binary_f1_score': 0.35374147}
confusion matrix:
       0    1
0  17824  325
1    435  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9597315, 'precision': 0.75485134, 'recall': 0.6051934, 'specificity': 0.6051934, 'f1': 0.6453673, 'auroc': 0.88109076, 'binary_precision': 0.54285717, 'binary_recall': 0.21839081, 'binary_specificity': 0.991996, 'binary_f1_score': 0.31147543}
confusion matrix:
      0   1
0  5949  48
1   204  57
early stop counter: 4
val acc:0.9595572352409363, best validation acc: 0.9629097580909729, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 29,now: 2024-07-10 04:08:58.717864,epoch time: 0:21:54.738556,used: 11:20:50.433216,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9917602, 'precision': 0.9917009, 'recall': 0.98673487, 'specificity': 0.98673487, 'f1': 0.9891849, 'auroc': 0.99863005, 'binary_precision': 0.9915804, 'binary_recall': 0.9763523, 'binary_specificity': 0.99711746, 'binary_f1_score': 0.9839074}
confusion matrix:
       0      1
0  42202    122
1    348  14368
---- Validation: 
scalar performance:
{'acc': 0.95955724, 'precision': 0.6940412, 'recall': 0.6940412, 'specificity': 0.6940412, 'f1': 0.6940412, 'auroc': 0.91459304, 'binary_precision': 0.40902022, 'binary_recall': 0.40902022, 'binary_specificity': 0.9790622, 'binary_f1_score': 0.40902022}
confusion matrix:
       0    1
0  17769  380
1    380  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.72185665, 'recall': 0.6349257, 'specificity': 0.6349257, 'f1': 0.6663414, 'auroc': 0.8808445, 'binary_precision': 0.47435898, 'binary_recall': 0.2835249, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.35491604}
confusion matrix:
      0   1
0  5915  82
1   187  74
early stop counter: 5
val acc:0.9595572352409363, best validation acc: 0.9629097580909729, corresponding to test acc:                         0.9616490602493286 / 0.9616490602493286
after epoch: 30,now: 2024-07-10 04:31:00.186248,epoch time: 0:22:01.468384,used: 11:42:51.901600,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_09_16_48_08_seed_0_21787677
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 11:42:51.901600 at 2024-07-10 04:31:00.186248
persisted model performance metric: 

scalar performance:
{'acc': 0.96164906, 'precision': 0.7830517, 'recall': 0.6190202, 'specificity': 0.6190202, 'f1': 0.6640349, 'auroc': 0.8873417, 'binary_precision': 0.5981308, 'binary_recall': 0.24521072, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.3478261}
confusion matrix:
      0   1
0  5954  43
1   197  64
oracle model performance metric: 

scalar performance:
{'acc': 0.96164906, 'precision': 0.7620264, 'recall': 0.7252956, 'specificity': 0.7252956, 'f1': 0.7420927, 'auroc': 0.8911135, 'binary_precision': 0.5470852, 'binary_recall': 0.46743295, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.5041322}
confusion matrix:
      0    1
0  5896  101
1   139  122
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreeze_blocks_featuregeneration/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197608 KiB |   1195 MiB |    959 TiB |    959 TiB |
|       from large pool | 180117 KiB |   1178 MiB |    946 TiB |    946 TiB |
|       from small pool |  17491 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197608 KiB |   1195 MiB |    959 TiB |    959 TiB |
|       from large pool | 180117 KiB |   1178 MiB |    946 TiB |    946 TiB |
|       from small pool |  17491 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   1193 MiB |    959 TiB |    959 TiB |
|       from large pool | 178979 KiB |   1176 MiB |    946 TiB |    946 TiB |
|       from small pool |  16482 KiB |     36 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1352 MiB |   1352 MiB |   1352 MiB |      0 B   |
|       from large pool |   1310 MiB |   1310 MiB |   1310 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  52248 KiB | 147638 KiB | 544636 GiB | 544636 GiB |
|       from large pool |  45163 KiB | 146066 KiB | 531292 GiB | 531292 GiB |
|       from small pool |   7085 KiB |   9383 KiB |  13344 GiB |  13344 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7605    |  167693 K  |  167690 K  |
|       from large pool |      79    |     167    |   90492 K  |   90492 K  |
|       from small pool |    2899    |    7525    |   77201 K  |   77198 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7605    |  167693 K  |  167690 K  |
|       from large pool |      79    |     167    |   90492 K  |   90492 K  |
|       from small pool |    2899    |    7525    |   77201 K  |   77198 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      76    |      76    |      76    |       0    |
|       from large pool |      55    |      55    |      55    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3586    |  106442 K  |  106442 K  |
|       from large pool |      11    |      57    |   68910 K  |   68910 K  |
|       from small pool |      20    |    3575    |   37532 K  |   37532 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1195 MiB |    959 TiB |    959 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1195 MiB |    959 TiB |    959 TiB |
|       from large pool |  16640 KiB |   1178 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     37 MiB |     13 TiB |     13 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |    959 TiB |    959 TiB |
|       from large pool |  16640 KiB |   1176 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     36 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB |   1352 MiB |   1352 MiB |   1108 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   1310 MiB |   1090 MiB |
|       from small pool |  24576 KiB |     42 MiB |     42 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 147638 KiB | 544636 GiB | 544636 GiB |
|       from large pool |  24320 KiB | 146066 KiB | 531292 GiB | 531292 GiB |
|       from small pool |      0 KiB |  18291 KiB |  13344 GiB |  13344 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7605    |  167693 K  |  167693 K  |
|       from large pool |       2    |     167    |   90492 K  |   90492 K  |
|       from small pool |       0    |    7525    |   77201 K  |   77201 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7605    |  167693 K  |  167693 K  |
|       from large pool |       2    |     167    |   90492 K  |   90492 K  |
|       from small pool |       0    |    7525    |   77201 K  |   77201 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |      76    |      76    |      53    |
|       from large pool |      11    |      55    |      55    |      44    |
|       from small pool |      12    |      21    |      21    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3586    |  106444 K  |  106444 K  |
|       from large pool |       4    |      57    |   68910 K  |   68910 K  |
|       from small pool |       0    |    3575    |   37533 K  |   37533 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 10 04:42:59 2024]
Finished job 0.
1 of 1 steps (100%) done
