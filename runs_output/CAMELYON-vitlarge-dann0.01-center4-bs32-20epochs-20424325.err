Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)



no algorithm conf specified, going to use default



/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/arg_parser.py:355: UserWarning: no algorithm conf specified, going to use default
  warnings.warn("no algorithm conf specified, going to use default")

overriding args.task None to dset


using device: cuda

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'99b8035b'
model name: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424325

 Experiment start at: 2024-05-07 17:44:12.373799
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97936696, 'precision': 0.86240435, 'recall': 0.60781723, 'specificity': 0.60781723, 'f1': 0.66303724, 'auroc': 0.61651516}
confusion matrix:
       0    1
0  38903   72
1    752  209
---- Validation: 
scalar performance:
{'acc': 0.97917885, 'precision': 0.8697778, 'recall': 0.60160273, 'specificity': 0.60160273, 'f1': 0.65600383, 'auroc': 0.6188303}
confusion matrix:
       0   1
0  16704  27
1    330  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9238679, 'precision': 0.96192646, 'recall': 0.5012953, 'specificity': 0.5012953, 'f1': 0.4827937, 'auroc': 0.52389085}
confusion matrix:
      0  1
0  9342  0
1   770  2
new oracle model saved
after epoch: 1,now: 2024-05-07 17:59:25.799211,epoch time: 0:15:13.425412,used: 0:15:13.425412,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424325
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97636217, 'precision': 0.98817605, 'recall': 0.508845, 'specificity': 0.508845, 'f1': 0.5113997, 'auroc': 0.518693}
confusion matrix:
       0   1
0  38975   0
1    944  17
---- Validation: 
scalar performance:
{'acc': 0.97597104, 'precision': 0.98798347, 'recall': 0.5036145, 'specificity': 0.5036145, 'f1': 0.50109565, 'auroc': 0.5108434}
confusion matrix:
       0  1
0  16731  0
1    412  3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.50043327}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 1
val acc:0.9759710431098938, best validation acc: 0.9791788458824158, corresponding to test acc:                         0.9238678812980652 / 0.9238678812980652
after epoch: 2,now: 2024-05-07 18:11:47.060032,epoch time: 0:12:21.260821,used: 0:27:34.686233,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424325
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9783904, 'precision': 0.9841807, 'recall': 0.551496, 'specificity': 0.551496, 'f1': 0.5878331, 'auroc': 0.5991714}
confusion matrix:
       0   1
0  38974   1
1    862  99
---- Validation: 
scalar performance:
{'acc': 0.9782457, 'precision': 0.97776043, 'recall': 0.55177736, 'specificity': 0.55177736, 'f1': 0.5881696, 'auroc': 0.59258336}
confusion matrix:
       0   1
0  16730   1
1    372  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92376906, 'precision': 0.96188074, 'recall': 0.50064766, 'specificity': 0.50064766, 'f1': 0.4814787, 'auroc': 0.52415717}
confusion matrix:
      0  1
0  9342  0
1   771  1
early stop counter: 2
val acc:0.9782456755638123, best validation acc: 0.9791788458824158, corresponding to test acc:                         0.9238678812980652 / 0.9238678812980652
after epoch: 3,now: 2024-05-07 18:23:45.567940,epoch time: 0:11:58.507908,used: 0:39:33.194141,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424325
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9758864, 'precision': 0.48796764, 'recall': 0.49997434, 'specificity': 0.49997434, 'f1': 0.49389803, 'auroc': 0.50411075}
confusion matrix:
       0  1
0  38973  2
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.97567946, 'precision': 0.48789665, 'recall': 0.49994022, 'specificity': 0.49994022, 'f1': 0.49384505, 'auroc': 0.50111496}
confusion matrix:
       0  1
0  16729  2
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.49994648}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 3
val acc:0.9756794571876526, best validation acc: 0.9791788458824158, corresponding to test acc:                         0.9238678812980652 / 0.9238678812980652
after epoch: 4,now: 2024-05-07 18:36:28.004696,epoch time: 0:12:42.436756,used: 0:52:15.630897,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424325
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97596157, 'precision': 0.48798078, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4939173, 'auroc': 0.5007982}
confusion matrix:
       0  1
0  38976  0
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.49967128}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.49994648}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 4
val acc:0.975796103477478, best validation acc: 0.9791788458824158, corresponding to test acc:                         0.9238678812980652 / 0.9238678812980652
after epoch: 5,now: 2024-05-07 18:49:12.859004,epoch time: 0:12:44.854308,used: 1:05:00.485205,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424325
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.50308347}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.49988046}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 5
val acc:0.975796103477478, best validation acc: 0.9791788458824158, corresponding to test acc:                         0.9238678812980652 / 0.9238678812980652
after epoch: 6,now: 2024-05-07 19:02:20.552333,epoch time: 0:13:07.693329,used: 1:18:08.178534,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424325
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.50728405}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.5035844}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 6
val acc:0.975796103477478, best validation acc: 0.9791788458824158, corresponding to test acc:                         0.9238678812980652 / 0.9238678812980652
after epoch: 7,now: 2024-05-07 19:15:28.815105,epoch time: 0:13:08.262772,used: 1:31:16.441306,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424325
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.48796794, 'recall': 0.49998719, 'specificity': 0.49998719, 'f1': 0.49390444, 'auroc': 0.5040855}
confusion matrix:
       0  1
0  38974  1
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.97567946, 'precision': 0.48789665, 'recall': 0.49994022, 'specificity': 0.49994022, 'f1': 0.49384505, 'auroc': 0.50111496}
confusion matrix:
       0  1
0  16729  2
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.49994648}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 7
val acc:0.9756794571876526, best validation acc: 0.9791788458824158, corresponding to test acc:                         0.9238678812980652 / 0.9238678812980652
after epoch: 8,now: 2024-05-07 19:28:40.847342,epoch time: 0:13:12.032237,used: 1:44:28.473543,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424325
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9758614, 'precision': 0.48796734, 'recall': 0.49996153, 'specificity': 0.49996153, 'f1': 0.49389163, 'auroc': 0.5041106}
confusion matrix:
       0  1
0  38972  3
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9755045, 'precision': 0.48789454, 'recall': 0.49985057, 'specificity': 0.49985057, 'f1': 0.4938002, 'auroc': 0.501055}
confusion matrix:
       0  1
0  16726  5
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.49994648}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 8
val acc:0.9755045175552368, best validation acc: 0.9791788458824158, corresponding to test acc:                         0.9238678812980652 / 0.9238678812980652
after epoch: 9,now: 2024-05-07 19:41:39.125249,epoch time: 0:12:58.277907,used: 1:57:26.751450,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424325
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9758614, 'precision': 0.48796734, 'recall': 0.49996153, 'specificity': 0.49996153, 'f1': 0.49389163, 'auroc': 0.5108606}
confusion matrix:
       0  1
0  38972  3
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.97562116, 'precision': 0.48789594, 'recall': 0.49991035, 'specificity': 0.49991035, 'f1': 0.49383008, 'auroc': 0.5082818}
confusion matrix:
       0  1
0  16728  3
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 9
val acc:0.9756211638450623, best validation acc: 0.9791788458824158, corresponding to test acc:                         0.9238678812980652 / 0.9238678812980652
after epoch: 10,now: 2024-05-07 19:54:44.748706,epoch time: 0:13:05.623457,used: 2:10:32.374907,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424325
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97596157, 'precision': 0.48798078, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4939173, 'auroc': 0.50412804}
confusion matrix:
       0  1
0  38976  0
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.5023196}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.49994648}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 10
val acc:0.975796103477478, best validation acc: 0.9791788458824158, corresponding to test acc:                         0.9238678812980652 / 0.9238678812980652
after epoch: 11,now: 2024-05-07 20:07:54.960610,epoch time: 0:13:10.211904,used: 2:23:42.586811,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424325
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
early stop trigger
Experiment finished at epoch: 11 with time: 2:23:42.586811 at 2024-05-07 20:07:54.960610
[Errno 2] No such file or directory: 'zoutput/saved_models/dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424325.model'
this error can occur if model selection criteria                            is worsening, model never get persisted,                            no performance metric is reported
failed to remove model
/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/exp/exp_main.py:126: UserWarning: failed to remove model
  warnings.warn("failed to remove model")
