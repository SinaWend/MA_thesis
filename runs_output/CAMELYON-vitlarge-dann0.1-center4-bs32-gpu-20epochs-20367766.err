Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)



no algorithm conf specified, going to use default



/ictstr01/groups/aih/sina.wendrich/MA_code/test/domainlab/arg_parser.py:355: UserWarning: no algorithm conf specified, going to use default
  warnings.warn("no algorithm conf specified, going to use default")

overriding args.task None to dset


using device: cuda

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/test/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'99b8035b'
model name: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766

 Experiment start at: 2024-05-06 08:08:23.364538
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9702023, 'precision': 0.5023393, 'recall': 0.50060546, 'specificity': 0.50060546, 'f1': 0.4982505, 'auroc': 0.5657729}
confusion matrix:
       0    1
0  38739  237
1    953    7
---- Validation: 
scalar performance:
{'acc': 0.9703721, 'precision': 0.49819714, 'recall': 0.4995706, 'specificity': 0.4995706, 'f1': 0.49638703, 'auroc': 0.5672367}
confusion matrix:
       0   1
0  16636  95
1    413   2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9235713, 'precision': 0.4618313, 'recall': 0.49994648, 'specificity': 0.49994648, 'f1': 0.48013362, 'auroc': 0.52688634}
confusion matrix:
      0  1
0  9341  1
1   772  0
new oracle model saved
after epoch: 1,now: 2024-05-06 08:22:16.175968,epoch time: 0:13:52.811430,used: 0:13:52.811430,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9758864, 'precision': 0.48797986, 'recall': 0.49996153, 'specificity': 0.49996153, 'f1': 0.49389803, 'auroc': 0.50081074}
confusion matrix:
       0  1
0  38973  3
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.9757378, 'precision': 0.48789734, 'recall': 0.4999701, 'specificity': 0.4999701, 'f1': 0.49385992, 'auroc': 0.49988046}
confusion matrix:
       0  1
0  16730  1
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
new oracle model saved
after epoch: 2,now: 2024-05-06 08:35:46.651098,epoch time: 0:13:30.475130,used: 0:27:23.286560,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97596157, 'precision': 0.48798078, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4939173, 'auroc': 0.4999102}
confusion matrix:
       0  1
0  38976  0
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.49982068}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
after epoch: 3,now: 2024-05-06 08:49:29.097109,epoch time: 0:13:42.446011,used: 0:41:05.732571,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.49761385}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.49814716}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 1
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 4,now: 2024-05-06 09:02:54.215209,epoch time: 0:13:25.118100,used: 0:54:30.850671,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9758864, 'precision': 0.48797986, 'recall': 0.49996153, 'specificity': 0.49996153, 'f1': 0.49389803, 'auroc': 0.49920464}
confusion matrix:
       0  1
0  38973  3
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.97567946, 'precision': 0.48789665, 'recall': 0.49994022, 'specificity': 0.49994022, 'f1': 0.49384505, 'auroc': 0.49937242}
confusion matrix:
       0  1
0  16729  2
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 2
val acc:0.9756794571876526, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 5,now: 2024-05-06 09:16:02.606632,epoch time: 0:13:08.391423,used: 1:07:39.242094,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.49979475}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.49985057}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 3
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 6,now: 2024-05-06 09:29:22.528908,epoch time: 0:13:19.922276,used: 1:20:59.164370,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.4997819}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.49976093}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 4
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 7,now: 2024-05-06 09:42:25.340466,epoch time: 0:13:02.811558,used: 1:34:01.975928,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.4990122}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.499223}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 5
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 8,now: 2024-05-06 09:55:56.256385,epoch time: 0:13:30.915919,used: 1:47:32.891847,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.5004176}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.49988046}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 6
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 9,now: 2024-05-06 10:09:06.516881,epoch time: 0:13:10.260496,used: 2:00:43.152343,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.48796794, 'recall': 0.49998719, 'specificity': 0.49998719, 'f1': 0.49390444, 'auroc': 0.49975625}
confusion matrix:
       0  1
0  38974  1
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757378, 'precision': 0.48789734, 'recall': 0.4999701, 'specificity': 0.4999701, 'f1': 0.49385992, 'auroc': 0.49976093}
confusion matrix:
       0  1
0  16730  1
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 7
val acc:0.9757378101348877, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 10,now: 2024-05-06 10:22:35.536253,epoch time: 0:13:29.019372,used: 2:14:12.171715,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97596157, 'precision': 0.48798078, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4939173, 'auroc': 0.49894807}
confusion matrix:
       0  1
0  38976  0
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.499223}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 8
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 11,now: 2024-05-06 10:36:08.768846,epoch time: 0:13:33.232593,used: 2:27:45.404308,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.49575368}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.49662304}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 9
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 12,now: 2024-05-06 10:55:12.439057,epoch time: 0:19:03.670211,used: 2:46:49.074519,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.49521488}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.4960851}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 10
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 13,now: 2024-05-06 11:20:07.443857,epoch time: 0:24:55.004800,used: 3:11:44.079319,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
early stop trigger
Experiment finished at epoch: 13 with time: 3:11:44.079319 at 2024-05-06 11:20:07.443857
[Errno 2] No such file or directory: 'zoutput/saved_models/dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_06_08_08_23_seed_0_20367766.model'
this error can occur if model selection criteria                            is worsening, model never get persisted,                            no performance metric is reported
failed to remove model
/ictstr01/groups/aih/sina.wendrich/MA_code/test/domainlab/exp/exp_main.py:126: UserWarning: failed to remove model
  warnings.warn("failed to remove model")
