Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)



no algorithm conf specified, going to use default



/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/arg_parser.py:355: UserWarning: no algorithm conf specified, going to use default
  warnings.warn("no algorithm conf specified, going to use default")

overriding args.task None to dset


using device: cuda

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'99b8035b'
model name: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424350

 Experiment start at: 2024-05-07 17:44:12.372415
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.5}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.5}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
new oracle model saved
after epoch: 1,now: 2024-05-07 17:59:14.506291,epoch time: 0:15:02.133876,used: 0:15:02.133876,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424350
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48798046, 'recall': 0.49998719, 'specificity': 0.49998719, 'f1': 0.49391088, 'auroc': 0.49997434}
confusion matrix:
       0  1
0  38975  1
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.5}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.49994648}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 1
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 2,now: 2024-05-07 18:11:39.023873,epoch time: 0:12:24.517582,used: 0:27:26.651458,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424350
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.5}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.5}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 2
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 3,now: 2024-05-07 18:24:02.934621,epoch time: 0:12:23.910748,used: 0:39:50.562206,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424350
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.48796794, 'recall': 0.49998719, 'specificity': 0.49998719, 'f1': 0.49390444, 'auroc': 0.50046897}
confusion matrix:
       0  1
0  38974  1
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757378, 'precision': 0.48789734, 'recall': 0.4999701, 'specificity': 0.4999701, 'f1': 0.49385992, 'auroc': 0.4999701}
confusion matrix:
       0  1
0  16730  1
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 3
val acc:0.9757378101348877, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 4,now: 2024-05-07 18:36:29.849213,epoch time: 0:12:26.914592,used: 0:52:17.476798,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424350
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.5}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.5}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.49994648}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 4
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 5,now: 2024-05-07 18:48:50.129738,epoch time: 0:12:20.280525,used: 1:04:37.757323,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424350
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.48796794, 'recall': 0.49998719, 'specificity': 0.49998719, 'f1': 0.49390444, 'auroc': 0.49992302}
confusion matrix:
       0  1
0  38974  1
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757378, 'precision': 0.48789734, 'recall': 0.4999701, 'specificity': 0.4999701, 'f1': 0.49385992, 'auroc': 0.4999701}
confusion matrix:
       0  1
0  16730  1
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5018892}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 5
val acc:0.9757378101348877, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 6,now: 2024-05-07 19:01:17.187879,epoch time: 0:12:27.058141,used: 1:17:04.815464,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424350
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.48796794, 'recall': 0.49998719, 'specificity': 0.49998719, 'f1': 0.49390444, 'auroc': 0.49997434}
confusion matrix:
       0  1
0  38974  1
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757378, 'precision': 0.48789734, 'recall': 0.4999701, 'specificity': 0.4999701, 'f1': 0.49385992, 'auroc': 0.4999701}
confusion matrix:
       0  1
0  16730  1
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5005942}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 6
val acc:0.9757378101348877, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 7,now: 2024-05-07 19:14:19.727879,epoch time: 0:13:02.540000,used: 1:30:07.355464,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424350
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48798046, 'recall': 0.49998719, 'specificity': 0.49998719, 'f1': 0.49391088, 'auroc': 0.4999102}
confusion matrix:
       0  1
0  38975  1
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.9757378, 'precision': 0.48789734, 'recall': 0.4999701, 'specificity': 0.4999701, 'f1': 0.49385992, 'auroc': 0.4999701}
confusion matrix:
       0  1
0  16730  1
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5005942}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 7
val acc:0.9757378101348877, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 8,now: 2024-05-07 19:26:35.921332,epoch time: 0:12:16.193453,used: 1:42:23.548917,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424350
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.48796794, 'recall': 0.49998719, 'specificity': 0.49998719, 'f1': 0.49390444, 'auroc': 0.49993587}
confusion matrix:
       0  1
0  38974  1
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757378, 'precision': 0.48789734, 'recall': 0.4999701, 'specificity': 0.4999701, 'f1': 0.49385992, 'auroc': 0.49994022}
confusion matrix:
       0  1
0  16730  1
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5012419}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 8
val acc:0.9757378101348877, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 9,now: 2024-05-07 19:38:34.836506,epoch time: 0:11:58.915174,used: 1:54:22.464091,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424350
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.48796794, 'recall': 0.49998719, 'specificity': 0.49998719, 'f1': 0.49390444, 'auroc': 0.49998719}
confusion matrix:
       0  1
0  38974  1
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757378, 'precision': 0.48789734, 'recall': 0.4999701, 'specificity': 0.4999701, 'f1': 0.49385992, 'auroc': 0.4999701}
confusion matrix:
       0  1
0  16730  1
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5012419}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 9
val acc:0.9757378101348877, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 10,now: 2024-05-07 19:50:52.129547,epoch time: 0:12:17.293041,used: 2:06:39.757132,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424350
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.48796794, 'recall': 0.49998719, 'specificity': 0.49998719, 'f1': 0.49390444, 'auroc': 0.49997434}
confusion matrix:
       0  1
0  38974  1
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757378, 'precision': 0.48789734, 'recall': 0.4999701, 'specificity': 0.4999701, 'f1': 0.49385992, 'auroc': 0.4999701}
confusion matrix:
       0  1
0  16730  1
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5005941}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 10
val acc:0.9757378101348877, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 11,now: 2024-05-07 20:03:22.547544,epoch time: 0:12:30.417997,used: 2:19:10.175129,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424350
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
early stop trigger
Experiment finished at epoch: 11 with time: 2:19:10.175129 at 2024-05-07 20:03:22.547544
[Errno 2] No such file or directory: 'zoutput/saved_models/dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_17_44_12_seed_0_20424350.model'
this error can occur if model selection criteria                            is worsening, model never get persisted,                            no performance metric is reported
failed to remove model
/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/exp/exp_main.py:126: UserWarning: failed to remove model
  warnings.warn("failed to remove model")
