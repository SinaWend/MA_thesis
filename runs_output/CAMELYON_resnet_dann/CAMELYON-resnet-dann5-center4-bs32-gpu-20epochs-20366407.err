Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)



no algorithm conf specified, going to use default



/ictstr01/groups/aih/sina.wendrich/MA_code/test/domainlab/arg_parser.py:355: UserWarning: no algorithm conf specified, going to use default
  warnings.warn("no algorithm conf specified, going to use default")

overriding args.task None to dset


using device: cuda

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/test/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'b976d8c0'
model name: dset_te_center4_dann_bb976d8c0_not_commited_2024md_05md_05_18_09_10_seed_0_20366407

 Experiment start at: 2024-05-05 18:09:11.070594
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.48798016, 'recall': 0.49997434, 'specificity': 0.49997434, 'f1': 0.49390444, 'auroc': 0.50194204}
confusion matrix:
       0  1
0  38974  2
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.97567946, 'precision': 0.48789665, 'recall': 0.49994022, 'specificity': 0.49994022, 'f1': 0.49384505, 'auroc': 0.5011449}
confusion matrix:
       0  1
0  16729  2
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.4997859}
confusion matrix:
      0  1
0  9342  0
1   772  0
new oracle model saved
after epoch: 1,now: 2024-05-05 18:23:53.293134,epoch time: 0:14:42.222540,used: 0:14:42.222540,model: dset_te_center4_dann_bb976d8c0_not_commited_2024md_05md_05_18_09_10_seed_0_20366407
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9758614, 'precision': 0.48796734, 'recall': 0.49996153, 'specificity': 0.49996153, 'f1': 0.49389163, 'auroc': 0.49989736}
confusion matrix:
       0  1
0  38972  3
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.49991035}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
after epoch: 2,now: 2024-05-05 18:43:17.104453,epoch time: 0:19:23.811319,used: 0:34:06.033859,model: dset_te_center4_dann_bb976d8c0_not_commited_2024md_05md_05_18_09_10_seed_0_20366407
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9758864, 'precision': 0.48796764, 'recall': 0.49997434, 'specificity': 0.49997434, 'f1': 0.49389803, 'auroc': 0.4999102}
confusion matrix:
       0  1
0  38973  2
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.49994022}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 1
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 3,now: 2024-05-05 19:01:33.760629,epoch time: 0:18:16.656176,used: 0:52:22.690035,model: dset_te_center4_dann_bb976d8c0_not_commited_2024md_05md_05_18_09_10_seed_0_20366407
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97483474, 'precision': 0.48796722, 'recall': 0.49942273, 'specificity': 0.49942273, 'f1': 0.49362853, 'auroc': 0.4989994}
confusion matrix:
       0   1
0  38931  45
1    960   0
---- Validation: 
scalar performance:
{'acc': 0.9747463, 'precision': 0.48788533, 'recall': 0.49946207, 'specificity': 0.49946207, 'f1': 0.49360582, 'auroc': 0.49895403}
confusion matrix:
       0   1
0  16713  18
1    415   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 2
val acc:0.9747462868690491, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 4,now: 2024-05-05 19:19:45.116257,epoch time: 0:18:11.355628,used: 1:10:34.045663,model: dset_te_center4_dann_bb976d8c0_not_commited_2024md_05md_05_18_09_10_seed_0_20366407
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9758614, 'precision': 0.48797956, 'recall': 0.49994868, 'specificity': 0.49994868, 'f1': 0.4938916, 'auroc': 0.4998204}
confusion matrix:
       0  1
0  38972  4
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.97567946, 'precision': 0.48789665, 'recall': 0.49994022, 'specificity': 0.49994022, 'f1': 0.49384505, 'auroc': 0.49973103}
confusion matrix:
       0  1
0  16729  2
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 3
val acc:0.9756794571876526, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 5,now: 2024-05-05 19:35:06.739856,epoch time: 0:15:21.623599,used: 1:25:55.669262,model: dset_te_center4_dann_bb976d8c0_not_commited_2024md_05md_05_18_09_10_seed_0_20366407
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9757362, 'precision': 0.48796585, 'recall': 0.49989736, 'specificity': 0.49989736, 'f1': 0.49385956, 'auroc': 0.49948686}
confusion matrix:
       0  1
0  38967  8
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.97544616, 'precision': 0.48789382, 'recall': 0.49982068, 'specificity': 0.49982068, 'f1': 0.49378523, 'auroc': 0.49952185}
confusion matrix:
       0  1
0  16725  6
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 4
val acc:0.9754461646080017, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 6,now: 2024-05-05 19:48:07.004777,epoch time: 0:13:00.264921,used: 1:38:55.934183,model: dset_te_center4_dann_bb976d8c0_not_commited_2024md_05md_05_18_09_10_seed_0_20366407
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9750351, 'precision': 0.4879574, 'recall': 0.49953815, 'specificity': 0.49953815, 'f1': 0.49367985, 'auroc': 0.49677998}
confusion matrix:
       0   1
0  38939  36
1    961   0
---- Validation: 
scalar performance:
{'acc': 0.9749796, 'precision': 0.48788816, 'recall': 0.4995816, 'specificity': 0.4995816, 'f1': 0.49366564, 'auroc': 0.49713108}
confusion matrix:
       0   1
0  16717  14
1    415   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 5
val acc:0.9749795794487, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 7,now: 2024-05-05 20:01:13.727777,epoch time: 0:13:06.723000,used: 1:52:02.657183,model: dset_te_center4_dann_bb976d8c0_not_commited_2024md_05md_05_18_09_10_seed_0_20366407
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.48796794, 'recall': 0.49998719, 'specificity': 0.49998719, 'f1': 0.49390444, 'auroc': 0.49948686}
confusion matrix:
       0  1
0  38974  1
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757378, 'precision': 0.48789734, 'recall': 0.4999701, 'specificity': 0.4999701, 'f1': 0.49385992, 'auroc': 0.49937242}
confusion matrix:
       0  1
0  16730  1
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 6
val acc:0.9757378101348877, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 8,now: 2024-05-05 20:14:15.352176,epoch time: 0:13:01.624399,used: 2:05:04.281582,model: dset_te_center4_dann_bb976d8c0_not_commited_2024md_05md_05_18_09_10_seed_0_20366407
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48798046, 'recall': 0.49998719, 'specificity': 0.49998719, 'f1': 0.49391088, 'auroc': 0.49971777}
confusion matrix:
       0  1
0  38975  1
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.9757378, 'precision': 0.48789734, 'recall': 0.4999701, 'specificity': 0.4999701, 'f1': 0.49385992, 'auroc': 0.49970114}
confusion matrix:
       0  1
0  16730  1
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 7
val acc:0.9757378101348877, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 9,now: 2024-05-05 20:27:19.382159,epoch time: 0:13:04.029983,used: 2:18:08.311565,model: dset_te_center4_dann_bb976d8c0_not_commited_2024md_05md_05_18_09_10_seed_0_20366407
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96509415, 'precision': 0.48783636, 'recall': 0.49444515, 'specificity': 0.49444515, 'f1': 0.49111852, 'auroc': 0.4933547}
confusion matrix:
       0    1
0  38542  433
1    961    0
---- Validation: 
scalar performance:
{'acc': 0.9665811, 'precision': 0.4877855, 'recall': 0.49527824, 'specificity': 0.49527824, 'f1': 0.4915033, 'auroc': 0.49387366}
confusion matrix:
       0    1
0  16573  158
1    415    0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 8
val acc:0.9665811061859131, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 10,now: 2024-05-05 20:40:39.984228,epoch time: 0:13:20.602069,used: 2:31:28.913634,model: dset_te_center4_dann_bb976d8c0_not_commited_2024md_05md_05_18_09_10_seed_0_20366407
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.48796794, 'recall': 0.49998719, 'specificity': 0.49998719, 'f1': 0.49390444, 'auroc': 0.4991918}
confusion matrix:
       0  1
0  38974  1
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.97567946, 'precision': 0.48789665, 'recall': 0.49994022, 'specificity': 0.49994022, 'f1': 0.49384505, 'auroc': 0.4992529}
confusion matrix:
       0  1
0  16729  2
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 9
val acc:0.9756794571876526, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 11,now: 2024-05-05 20:53:32.082405,epoch time: 0:12:52.098177,used: 2:44:21.011811,model: dset_te_center4_dann_bb976d8c0_not_commited_2024md_05md_05_18_09_10_seed_0_20366407
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97483474, 'precision': 0.48795497, 'recall': 0.49943554, 'specificity': 0.49943554, 'f1': 0.4936285, 'auroc': 0.49817833}
confusion matrix:
       0   1
0  38931  44
1    961   0
---- Validation: 
scalar performance:
{'acc': 0.9749213, 'precision': 0.48788744, 'recall': 0.49955174, 'specificity': 0.49955174, 'f1': 0.4936507, 'auroc': 0.4982368}
confusion matrix:
       0   1
0  16716  15
1    415   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.5}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 10
val acc:0.9749212861061096, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 12,now: 2024-05-05 21:07:21.086064,epoch time: 0:13:49.003659,used: 2:58:10.015470,model: dset_te_center4_dann_bb976d8c0_not_commited_2024md_05md_05_18_09_10_seed_0_20366407
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
early stop trigger
Experiment finished at epoch: 12 with time: 2:58:10.015470 at 2024-05-05 21:07:21.086064
[Errno 2] No such file or directory: 'zoutput/saved_models/dset_te_center4_dann_bb976d8c0_not_commited_2024md_05md_05_18_09_10_seed_0_20366407.model'
this error can occur if model selection criteria                            is worsening, model never get persisted,                            no performance metric is reported
failed to remove model
/ictstr01/groups/aih/sina.wendrich/MA_code/test/domainlab/exp/exp_main.py:126: UserWarning: failed to remove model
  warnings.warn("failed to remove model")
