Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)



no algorithm conf specified, going to use default



/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/arg_parser.py:355: UserWarning: no algorithm conf specified, going to use default
  warnings.warn("no algorithm conf specified, going to use default")

overriding args.task None to blood_mon_eos_bas


using device: cuda

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
reading domain: matek
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: mll
list of subfolders ['neutrophil_segmented', 'erythroblast', 'myeloblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
reading domain: acevedo
list of subfolders ['neutrophil_segmented', 'erythroblast', 'lymphocyte_typical', 'monocyte', 'neutrophil_band', 'basophil', 'promyelocyte', 'eosinophil', 'myelocyte', 'metamyelocyte']
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'b976d8c0'
model name: blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702

 Experiment start at: 2024-05-04 17:04:01.442366
before training, model accuracy: 0.08150843530893326
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.74165237, 'precision': 0.42122898, 'recall': 0.3751651, 'specificity': 0.9698452, 'f1': 0.37664512, 'auroc': 0.91549575}
confusion matrix:
    0     1   2     3   4   5     6     7    8   9      10
0    1     0   0   196   0   0    95    22   79   0     90
1    0  1017   0    37   0   0     2   136    2   0    137
2    0     0   0    52   0   0    21    68   87   0     84
3    0     1   0  7919   0   0    24   306  164   0     24
4    0     1   0    63   0   0    37    63   69   0    306
5    0     0   0   504   0   0     3     1   13   0      0
6    0     0   0   450   0   0  1044    81  108   0    225
7    0    20   0  1071   0   0    37  5280  276   0    578
8    1     0   0  2102   0   0    62   223  773   0    135
9    0     0   0   344   0   0    28    25   74   0     21
10   1    15   0   145   0   0   288   394  265   0  11686
---- Validation: 
scalar performance:
{'acc': 0.74174136, 'precision': 0.42932445, 'recall': 0.37591642, 'specificity': 0.9698167, 'f1': 0.37820053, 'auroc': 0.91678256}
confusion matrix:
    0     1   2     3   4   5     6     7    8   9      10
0    2     1   0   179   0   0    86    24   87   0    104
1    0  1008   0    40   0   0     9   136    4   0    135
2    0     0   0    54   0   0    15    65   77   0    101
3    0     0   0  7915   0   0    17   345  136   0     27
4    0     1   0    68   0   0    32    57   69   0    312
5    0     0   0   500   0   0     7     2    9   0      3
6    2     0   0   439   0   0  1062    71  116   0    218
7    0    20   0  1103   0   0    30  5268  259   0    585
8    0     0   0  2081   0   0    66   222  798   0    129
9    0     0   0   342   0   0    31    18   80   0     22
10   1    11   0   128   0   0   278   415  286   0  11677
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.36325473, 'precision': 0.28509825, 'recall': 0.27582622, 'specificity': 0.9346499, 'f1': 0.23635288, 'auroc': 0.7516487}
confusion matrix:
    0    1   2    3   4   5     6    7    8   9     10
0    0    0   0   57   0   0    96  161  248   0   608
1    0  420   0   26   0   0    57   43   10   0   943
2    0    0   0    9   0   0   142   10   33   0   821
3    0    0   0    0   0   0     0    0    0   0     0
4    0    0   0    0   0   0     9    1    3   0  1620
5    0    0   0  350   0   0    78   10  148   0     6
6    0    0   0    0   0   0  1582    1    1   0  1483
7    0    0   0    3   0   0     2  858    8   0   293
8    0    0   0  161   0   0   113   51  688   0   357
9    0    0   0   50   0   0   219   33  188   0   647
10   0    0   0    0   0   0     2    0    0   0  1644
new oracle model saved
after epoch: 1,now: 2024-05-04 17:43:04.037581,epoch time: 0:39:02.595215,used: 0:39:02.595215,model: blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.78529, 'precision': 0.58365875, 'recall': 0.4664104, 'specificity': 0.9748782, 'f1': 0.49139494, 'auroc': 0.94391793}
confusion matrix:
    0     1   2     3   4   5     6     7     8   9      10
0   98    11   0    89   0   0    27    44    20   6    188
1    0  1135   0    14   0   0     2   121     3   0     57
2    2     4  32    26   0   0     0    86    34  12    116
3    4    24   2  7162   0  20    15   751   392  20     47
4    3     4  17    40   0   1     3    84    31  10    346
5    1     0   1   382   0  33     0     6    58  32      8
6   64    14   0   107   0   2  1321    41    30   8    320
7    3   104   3   586   0   1     3  6020   101   1    441
8   16    40   3   976   0   4     5   513  1499  12    228
9    5     1  17   189   0  20     6    47    91  73     44
10  27    41   0    61   0   0    27   600    50   9  11978
---- Validation: 
scalar performance:
{'acc': 0.7867059, 'precision': 0.59091467, 'recall': 0.47031108, 'specificity': 0.97502947, 'f1': 0.49716967, 'auroc': 0.9448957}
confusion matrix:
     0     1   2     3   4   5     6     7     8   9      10
0   106    11   1    86   0   0    20    39    23  10    187
1     1  1132   1     9   0   0     2   137     3   1     46
2     0     3  32    28   0   0     0    86    32   8    123
3     5    23   4  7202   0  16    20   730   394  14     32
4     4     4  19    40   0   2     6    67    26   6    365
5     0     0   2   366   0  47     1     6    68  28      3
6    61     9   0   100   0   4  1331    55    21   8    319
7     2    97   5   566   0   0     9  6038   104   2    442
8    13    42   5   979   0   5     7   513  1457  11    264
9     6     2  20   176   0  21     5    44   102  74     43
10   28    38   2    63   0   0    34   577    57   5  11992
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.45994544, 'precision': 0.45647156, 'recall': 0.34193438, 'specificity': 0.94551826, 'f1': 0.30026004, 'auroc': 0.79921776}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   164    0   0  144   0   0    19   292   21   0   530
1     3  491   2   27   0   0     7   302   10   2   655
2    35    0   0   13   0   1    14    61   11   0   880
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    2   0   0     5    19    1   0  1606
5    46    0   0  332   0  19    13    18  118  22    24
6     1    0   0    2   0   0  2459     1    0   0   604
7     1    0   0    7   0   0     2  1144    0   0    10
8     3    0   0  261   0   0     6   163  656   5   276
9    67    0   0   89   0   0    16   125  123   4   713
10    0    0   0    0   0   0     2     7    0   0  1637
new oracle model saved
after epoch: 2,now: 2024-05-04 18:50:56.142911,epoch time: 1:07:52.105330,used: 1:46:54.700545,model: blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8401113, 'precision': 0.6826462, 'recall': 0.5373911, 'specificity': 0.98129576, 'f1': 0.57845354, 'auroc': 0.97128177}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   114     2   2    85   0    0    51    32    10   3    184
1     1  1081   0    25   0    0     1   191     8   0     25
2     3     1  93    15   1    1     1    77    33  13     74
3     5     0   0  7663   0   14     6   650    93   0      7
4     5     2  46    19   0    2     2    62    31  15    355
5     2     0   0   318   0  131     0     8    22  38      2
6    11     1   1   110   0    0  1594    31     5   5    150
7     3     7   0   430   0    1     4  6666    43   0    110
8     3     7   5   869   2    6     5   528  1662  11    197
9     7     0  50   160   0   45     6    50    55  92     28
10   14    11  10    41   0    0    20   356    29   6  12304
---- Validation: 
scalar performance:
{'acc': 0.840444, 'precision': 0.68381035, 'recall': 0.5450523, 'specificity': 0.9813825, 'f1': 0.5852512, 'auroc': 0.971154}
confusion matrix:
     0     1    2     3   4    5     6     7     8   9      10
0   134     1    0    74   0    0    46    35     8   3    182
1     0  1095    0    21   0    0     1   174    13   0     28
2     2     2  104    20   0    2     0    67    30  13     72
3     4     0    1  7599   0    7     7   705   103   4     10
4     3     1   54    17   0    1     1    71    26  12    353
5     2     0    2   301   0  138     1     7    36  31      3
6    17     0    0   108   0    0  1581    44     9   3    146
7     4     2    0   441   0    0     4  6672    50   1     91
8     0     8   16   868   0   16     3   503  1692  12    178
9     6     0   61   174   0   47     6    41    50  86     22
10   16     7    4    37   0    2    27   348    31   5  12319
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.49017, 'precision': 0.4767431, 'recall': 0.369868, 'specificity': 0.94838953, 'f1': 0.3133065, 'auroc': 0.8166978}
confusion matrix:
     0    1   2    3   4   5     6     7    8   9     10
0   686    0   0   13   0   0    59   127    0   0   285
1     7  654   1   20   0   0     4   574    0   0   239
2    59    0   0    2   0   0    26    78    0   0   850
3     0    0   0    0   0   0     0     0    0   0     0
4     0    0   0    1   0   0     9    34    0   0  1589
5   214    0   1  193   0  38    15    30   13  25    63
6     1    1   0    0   0   0  2662     4    0   0   399
7     3    0   0    5   0   0     1  1147    0   0     8
8    52    0   0  112   0   0     7   630  177  10   382
9   151    0   2   28   0   0    23   223    7   6   697
10    0    0   0    0   0   0     1     9    0   0  1636
new oracle model saved
after epoch: 3,now: 2024-05-04 19:57:14.004241,epoch time: 1:06:17.861330,used: 2:53:12.561875,model: blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8596961, 'precision': 0.77228516, 'recall': 0.5814394, 'specificity': 0.9841573, 'f1': 0.618119, 'auroc': 0.9750904}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   138     3   2    64   0    2    19    69    48    6    132
1     0  1167   0    15   0    0     3    95    21    1     29
2     0     5  56    12   1    2     0    49    96   57     34
3     0     1   0  7723   0    4     7   446   250    2      4
4     0     7  52    11   3    1     3    46   101   29    286
5     1     0   0   182   0  237     3     1    54   42      1
6    14     0   0    72   0    0  1580    60    96    2     82
7     1    30   0   408   0    1     9  6570   154    0     92
8     0    15   0   733   0    3     5   224  2283    2     31
9     0     0  11    96   0   54     4    28   147  146      7
10    7    17   3    27   0    1    26   260   219    4  12229
---- Validation: 
scalar performance:
{'acc': 0.8577237, 'precision': 0.7414781, 'recall': 0.5789009, 'specificity': 0.98393005, 'f1': 0.6148497, 'auroc': 0.9747136}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   128     3   0    74   0    2    15    71    44    6    140
1     0  1169   0    20   0    0     1    96    27    0     19
2     1     7  65    16   1    1     1    36    94   48     42
3     1     1   0  7715   0    6     7   466   236    3      5
4     0     7  53    11   1    2     1    43   101   23    297
5     0     0   1   196   0  224     4     1    55   39      1
6    32     2   0    72   0    0  1568    60    95    6     73
7     0    26   0   426   0    1     9  6566   152    0     85
8     1    11   0   744   0    6     0   222  2271    3     38
9     0     1  10    97   0   62     3    25   144  149      2
10    8     8   4    31   0    1    33   252   241    8  12210
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5168264, 'precision': 0.5390331, 'recall': 0.3886386, 'specificity': 0.95185024, 'f1': 0.3528604, 'auroc': 0.8431476}
confusion matrix:
     0    1   2    3   4    5     6     7    8   9     10
0   206    0   0   55   0    0    31   544    0   0   334
1     0  703   1   33   0    1     5   681   16   1    58
2    25    2   3   59   0    5    54   451   52  41   323
3     0    0   0    0   0    0     0     0    0   0     0
4     1    2   0    1   0    0    88    73    3   0  1465
5     4    0   0  345   0  124     0    35   51  27     6
6     0    0   0    1   0    0  2927     6    0   0   133
7     0    0   0    5   0    0     3  1153    0   0     3
8     2    0   0  385   0    4     6   377  575   7    14
9    12    1   3  218   0   10    27   522  147  83   114
10    0    1   0    0   0    0    26     6    0   0  1613
new oracle model saved
after epoch: 4,now: 2024-05-04 20:30:40.065901,epoch time: 0:33:26.061660,used: 3:26:38.623535,model: blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8541042, 'precision': 0.7157709, 'recall': 0.55618316, 'specificity': 0.9832655, 'f1': 0.59492034, 'auroc': 0.97318304}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   162     1   0    48   0    0    90    42    16   0    124
1     0  1061   4    14   0    0     1   208     9   0     34
2     4     0  71    19  42    0     6    72    23   5     69
3     6     1   0  7521   1    2    56   681   166   0      5
4     6     0  33    11  43    1    12    60    25   8    339
5     2     0   3   293   1  115     8     6    53  39      1
6     8     2   1    35   0    0  1749    29    13   2     69
7     2     2   1   287   3    0    20  6820    44   0     84
8     4     6  16   625   9    2    39   481  1941   9    163
9    12     0  59   154  18   32    25    37    56  76     24
10   37     2  12    22   3    0    79   235    40   0  12364
---- Validation: 
scalar performance:
{'acc': 0.8556908, 'precision': 0.7282468, 'recall': 0.5648475, 'specificity': 0.9834516, 'f1': 0.60499084, 'auroc': 0.97368574}
confusion matrix:
     0     1   2     3   4    5     6     7     8   9      10
0   161     0   0    53   0    0    89    28    18   3    131
1     0  1069   2    13   1    0     2   203    10   0     32
2     1     0  88    17  38    1     8    65    20   6     68
3     4     2   0  7520   0    2    53   693   156   0     10
4     7     0  30    12  48    1    11    53    31   5    341
5     1     0   1   293   0  123     9     5    41  45      3
6    14     1   0    45   0    0  1734    27    13   1     73
7     3     1   4   287   0    0    22  6831    43   1     73
8     7     4  25   605  10    3    31   505  1961   8    137
9    12     0  73   166  13   23    12    47    51  83     13
10   39     2   5    21   4    0    81   231    40   1  12372
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.47911566, 'precision': 0.51975524, 'recall': 0.40278465, 'specificity': 0.94741017, 'f1': 0.375925, 'auroc': 0.8331202}
confusion matrix:
     0    1   2    3   4    5     6     7    8    9     10
0   749    0   0   21   0    0    59   113    2    2   224
1     3  556   6   23   1    6     8   706   22    5   163
2    24    0  28   26   0    4    97   251   23   43   519
3     0    0   0    0   0    0     0     0    0    0     0
4     1    0   0    0   0    0    25    27    1    0  1579
5    25    0   0  275   0  143    18    16   60   51     4
6     6    0   0    1   0    0  1830    56    0    0  1174
7     3    0   0    6   0    0     1  1151    0    0     3
8    10    0   3  146   1    8    16   462  613   77    34
9    66    0  37  143   1   18    77   324  110  137   224
10    0    0   0    0   0    0     2     3    0    0  1641
early stop counter: 1
val acc:0.8556907773017883, best validation acc: 0.8577237129211426, corresponding to test acc:                         0.5168263912200928 / 0.5168263912200928
after epoch: 5,now: 2024-05-04 21:02:06.647085,epoch time: 0:31:26.581184,used: 3:58:05.204719,model: blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.87617725, 'precision': 0.74841416, 'recall': 0.64919084, 'specificity': 0.9859519, 'f1': 0.6769626, 'auroc': 0.98163164}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   265     2   0    31   1    1    59    12    13   11     88
1     0  1164   0    14   0    0     3   121     9    0     21
2     2     0  95     8  23    2     6    39    15   64     58
3     3     1   0  7689   0   31    33   518   144   10     10
4     5     0  44     3  28    1     9    29    40   38    342
5     2     0   0   127   0  268    11     2    24   86      1
6    17     0   0    25   0    2  1793    10    15    8     37
7     6    12   2   324   2    1    23  6728    52    0    112
8     6     8   4   616   4    8    26   482  2012   28    101
9    14     0  23    42   2   68     9    21    63  239     12
10   34     4   4    18   4    2    83   110    58    9  12467
---- Validation: 
scalar performance:
{'acc': 0.872489, 'precision': 0.7447108, 'recall': 0.6428056, 'specificity': 0.98552585, 'f1': 0.6700976, 'auroc': 0.98145384}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   260     0   0    26   1    1    48    19    20    9     99
1     1  1178   0    11   0    1     3   115     6    0     17
2     2     3  82     9  18    1     3    43    23   69     59
3     5     0   0  7683   3   30    17   522   160   10     10
4     8     0  42     5  32    2     3    26    42   36    343
5     3     0   1   121   0  263     8     2    23   99      1
6    17     0   0    15   0    2  1797    14    21   10     32
7     4    12   0   385   0    1    28  6644    61    5    125
8     6    10   4   644   2   13    23   485  1985   26     98
9    11     0  23    53   6   68    11    29    47  236      9
10   40     6   4    26   4    0    81   111    58    8  12458
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.601973, 'precision': 0.52166164, 'recall': 0.48125362, 'specificity': 0.95943177, 'f1': 0.4523496, 'auroc': 0.8443586}
confusion matrix:
     0    1   2    3   4    5     6     7    8    9     10
0   670    0   0   39   0    0   116   118    1    1   225
1     5  903   3   17   0    3    23   459   17   21    48
2    58    5   4    4   0    6   134   142   16   74   572
3     0    0   0    0   0    0     0     0    0    0     0
4     1    7   0    0   0    0   101    10    3    0  1511
5    31    0   0   95   0  231    22    14   36  159     4
6     3    0   0    0   0    0  3043     1    0    0    20
7     0    0   0    4   0    0     4  1150    0    0     6
8     4    1   0  133   0   26    12   295  721  145    33
9    88    2   8   43   0   26   117   241   85  275   252
10    1    1   0    0   0    0    36     1    0    0  1607
new oracle model saved
after epoch: 6,now: 2024-05-04 22:04:00.699590,epoch time: 1:01:54.052505,used: 4:59:59.257224,model: blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8775685, 'precision': 0.78291124, 'recall': 0.61422807, 'specificity': 0.9862059, 'f1': 0.64444864, 'auroc': 0.98041815}
confusion matrix:
     0     1   2     3   4   5     6     7     8    9      10
0   210     0   0    68   1   0    17    38    16   14    119
1     0  1201   0    14   0   0     0    87    19    1     10
2     1     0  37     9  28   0     1    61    28  118     28
3     2     2   0  7798   0   3     4   428   200    0      0
4     0     2  26    16  62   0     1    71    36   61    264
5     0     0   0   199   0  98     2     2    71  149      0
6    13     2   0    79   0   0  1714    31    10   15     44
7     2    15   0   339   0   1     7  6765   108    0     27
8     3     4   1   516   0   0     5   304  2413   10     38
9     4     0   7    90   7   8     2    27    65  274      9
10   14    23   1    48   7   0    24   363    73   13  12228
---- Validation: 
scalar performance:
{'acc': 0.87623376, 'precision': 0.77976054, 'recall': 0.61438614, 'specificity': 0.98603487, 'f1': 0.64503413, 'auroc': 0.9799061}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   221     1   0    69   0    0    16    37    13   12    114
1     0  1188   0    14   0    0     2    90    25    1     12
2     0     2  33    13  33    0     2    56    29  114     30
3     0     0   0  7770   0    1     5   442   214    1      7
4     1     3  27    16  57    0     1    73    42   50    269
5     0     0   0   189   0  110     2     4    76  139      1
6    21     2   0    75   0    0  1694    35    11   15     55
7     0    18   0   350   2    0     5  6779    82    2     27
8     2     5   0   513   1    0    10   316  2395    8     46
9     4     1   5    77   6    5     2    28    80  277      8
10   19    23   1    44   9    0    20   371    59   16  12234
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6088995, 'precision': 0.581441, 'recall': 0.46589082, 'specificity': 0.9603549, 'f1': 0.4191918, 'auroc': 0.8566326}
confusion matrix:
     0     1   2    3   4   5     6     7     8    9     10
0   557     0   0  172   0   0   162   102     7    0   170
1     1  1053   0    8   0   0     5   251    71   13    97
2    20     0   2   17   1   0    60   166    60   63   626
3     0     0   0    0   0   0     0     0     0    0     0
4     1     4   1    2   0   0    70    16     4    1  1534
5    18     0   0  186   0  19    16     0   231  104    18
6     1     1   0    0   0   0  3031     0     0    0    34
7     0     0   0   12   0   0     2  1147     1    0     2
8     1     0   0   66   0   0     3   143  1109   30    18
9    52     0   0   93   1   0    41   172   332  164   282
10    0     0   0    0   0   0    17     8     0    0  1621
new oracle model saved
after epoch: 7,now: 2024-05-04 23:12:52.852844,epoch time: 1:08:52.153254,used: 6:08:51.410478,model: blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.88291955, 'precision': 0.7382628, 'recall': 0.6764336, 'specificity': 0.987077, 'f1': 0.68590295, 'auroc': 0.9830652}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   273     0    0    40   1    7    76     7     9    8     62
1     3  1159    1    17   1    2    10    91    21    0     27
2     3     0  138    11  21    6     3    23    39   36     32
3     8     1    0  7841   0   93    28   207   256    3      2
4    11     2   76    10  37    5     9    22    62   21    283
5     2     0    1    92   0  357     3     2    37   26      1
6    24     1    0    36   0    5  1787     6    12    6     31
7    11    13    0   664   0    6    14  6280   220    2     51
8     9     1    2   417   5   33    22   108  2636    3     60
9     3     0   43    48   2  140    13    10    76  155      3
10   93     7    7    26   3    4    90   148    71    7  12337
---- Validation: 
scalar performance:
{'acc': 0.881851, 'precision': 0.73599106, 'recall': 0.676756, 'specificity': 0.98694175, 'f1': 0.6864656, 'auroc': 0.98290604}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   267     0    0    51   1   11    68     5    11   12     57
1     1  1166    0    11   0    5     4    90    18    0     37
2     3     0  146     7  14    9     3    22    45   32     31
3     5     0    0  7854   0   97    25   194   257    3      5
4    11     1   74    12  39    7     7    18    55   27    288
5     0     0    1    96   0  351     3     1    33   34      2
6    17     1    0    32   0    2  1794    13    11    8     30
7     9    15    6   662   0    0    18  6277   223    1     54
8     9     2    3   407   4   46    26   106  2606    2     85
9     2     0   44    43   3  139    18     5    77  155      7
10   75     7    6    36  16    5   110   138    83    7  12313
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.52207375, 'precision': 0.47880778, 'recall': 0.41383144, 'specificity': 0.95183, 'f1': 0.38539556, 'auroc': 0.82514524}
confusion matrix:
     0    1   2    3   4    5     6    7    8   9     10
0   652    0   0  132   0    1   123   19    1   0   242
1    43  442   4   56   0   33    19  237   21  18   626
2   144    0   7   54   0   20   101   90   19  28   552
3     0    0   0    0   0    0     0    0    0   0     0
4     3    2   0    6   0    0   174   36    1   0  1411
5    42    0   0   96   0  371    14    1   38  25     5
6     1    0   0    0   0    0  3057    0    0   0     9
7     8    0   0  328   0    2     3  791    5   0    27
8    90    0   3  293   0  161     5  120  530  23   145
9   229    0  15  159   0  102    41   61  100  88   342
10    1    0   0    2   0    0   109   10    0   0  1524
after epoch: 8,now: 2024-05-05 00:07:21.952299,epoch time: 0:54:29.099455,used: 7:03:20.509933,model: blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.87981594, 'precision': 0.76365536, 'recall': 0.6589928, 'specificity': 0.9863842, 'f1': 0.6839513, 'auroc': 0.98396623}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   193     2   0    75   10    0    36     4    16   13    134
1     0  1214   0    16    0    2     0    61     3    0     35
2     1     2  41    15   72    7     0    19    25  103     27
3     0     0   0  8080    0   61    10   145   128    1     13
4     0     1   8     7  147    5     1    18    42   61    249
5     1     0   0    79    1  386     1     0    24   28      1
6    14     0   0    63    2    3  1666     8    52   18     81
7     2    64   4   681    2    1    12  6251   103    1    142
8     0    10   1   714    6   20     4   160  2272    8     99
9     1     2   6    46   12  142     5     8    42  217     12
10    7     4   1    41  133    0    41    66    72   13  12417
---- Validation: 
scalar performance:
{'acc': 0.88270694, 'precision': 0.7657037, 'recall': 0.6547128, 'specificity': 0.9866905, 'f1': 0.6807766, 'auroc': 0.98356086}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   192     3   0    57   10    3    29     7    25   15    142
1     0  1213   0    19    1    1     0    55     6    0     37
2     0     4  37    12   68    7     2    19    22  119     22
3     1     3   0  8115    0   55    12   136   107    3      8
4     0     2  10     7  143   10     1    15    34   60    257
5     0     0   0   107    0  361     2     0    24   25      2
6    18     0   0    58    1    2  1660    13    38   17    101
7     1    55   0   665    4    2     7  6309    98    1    123
8     0    12   1   706    8   23     3   146  2291    7     99
9     0     0   6    38   11  152     6     7    42  221     10
10    2     6   1    35  107    1    33    58    77   18  12458
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5780452, 'precision': 0.5470189, 'recall': 0.4537672, 'specificity': 0.9578074, 'f1': 0.4376107, 'auroc': 0.86129314}
confusion matrix:
     0     1   2    3   4    5     6     7    8    9     10
0   304     0   0  353   1    1   178    30    2    2   299
1     0  1084   1   46   1    6     8   206   65    2    80
2     1     2   2   91  18   20    87    99  101   85   509
3     0     0   0    0   0    0     0     0    0    0     0
4     0     3   1    7   1    0   154     9    1    0  1457
5     0     0   0  267   0  261     5     0   41   16     2
6     4     0   0    5   0    0  3050     1    0    0     7
7     0     0   0   56   0    0     4  1101    2    0     1
8     0     0   0  486   0   47     1    65  746    5    20
9     3     0   3  320  11   71    49    67  289  145   179
10    0     1   0    0   0    0    74     3    0    0  1568
after epoch: 9,now: 2024-05-05 00:40:55.476698,epoch time: 0:33:33.524399,used: 7:36:54.034332,model: blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8834814, 'precision': 0.7817816, 'recall': 0.6522697, 'specificity': 0.9867611, 'f1': 0.68605137, 'auroc': 0.984149}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   265     3    0    60   0    0    14    36    11    4     90
1     0  1220    0    11   0    0     0    92     2    0      7
2     3     5  127     9  12    2     2    61    13   25     53
3     4     6    0  7845   0   19     4   471    86    1      3
4     4    11   56     7  35    2     2    50    32   21    319
5     6     0    1   159   0  270     1     6    46   31      1
6    41     1    0    79   0    2  1652    48    40    8     37
7     1    46    0   254   0    1     4  6908    22    0     27
8     3    18    2   442   1    5     0   535  2205    2     82
9     9     1   53    69   2   87     0    41    48  168     15
10   19    81    5    27   4    0    18   251    57    3  12326
---- Validation: 
scalar performance:
{'acc': 0.88594353, 'precision': 0.786214, 'recall': 0.65849817, 'specificity': 0.9870525, 'f1': 0.6911111, 'auroc': 0.98506725}
confusion matrix:
     0     1    2     3   4    5     6     7     8    9      10
0   273     3    0    54   0    0    16    34    13    5     85
1     0  1229    0    16   0    1     0    81     2    0      3
2     2     3  128     8  12    4     0    66    19   26     44
3     6     1    0  7840   0   11     3   470   106    1      2
4     4    11   53     6  34    0     0    41    33   22    335
5     2     0    1   137   0  282     1     1    60   36      1
6    36     4    0    66   0    4  1687    38    32    8     33
7     2    39    0   227   0    1     1  6938    25    0     32
8    10    19    3   439   2   10     1   544  2192    0     76
9     8     2   53    75   2   87     0    44    44  169      9
10   22    74    3    30   1    0    10   252    54    1  12349
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5266214, 'precision': 0.5057653, 'recall': 0.40831378, 'specificity': 0.9528, 'f1': 0.36707598, 'auroc': 0.8476022}
confusion matrix:
     0     1   2    3   4   5     6     7    8   9     10
0   506     0   0  112   0   0     0   139    1   0   412
1     3  1038   1   41   0   1     0   368   11   0    36
2    36    22   0   29   0   7     4   360   45   3   509
3     0     0   0    0   0   0     0     0    0   0     0
4     0    69   0    1   0   0     9    15    3   0  1536
5    17     0   0  370   0  73     0    12  111   4     5
6     8    57   0    6   0   0  2532    45    0   0   419
7     1     0   0   11   0   0     0  1147    0   0     5
8     0     0   0  234   0   1     0   503  590   0    42
9    53     6   0  198   0   6     2   512  139  17   204
10    0    20   0    0   0   0     0     2    0   0  1624
better model found, saving less frequently
model persisted
after epoch: 10,now: 2024-05-05 01:13:42.599517,epoch time: 0:32:47.122819,used: 8:09:41.157151,model: blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.89798266, 'precision': 0.7957914, 'recall': 0.66901803, 'specificity': 0.9884474, 'f1': 0.6985283, 'auroc': 0.9869529}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   246     2   0    30   0    1    24    12    30    7    131
1     1  1221   0    12   0    0     2    76     7    0     13
2     1     2  35    15  18    3     1    12    32  151     42
3     2     1   0  8071   0    8    15   162   173    3      3
4     1     0  22    12  77    6     2     8    49   60    301
5     0     0   0   119   0  308    12     0    21   59      2
6     7     0   0    17   0    0  1796     9    16    5     58
7     0    23   1   618   1    1     6  6283   254    3     75
8     1     4   2   433   0    7     7    82  2691    4     65
9     4     0   6    52   3   81    18     5    55  258     10
10    3     3   3    31  16    0    27    41    85    5  12577
---- Validation: 
scalar performance:
{'acc': 0.8949044, 'precision': 0.7940364, 'recall': 0.6681069, 'specificity': 0.98810995, 'f1': 0.6973885, 'auroc': 0.987179}
confusion matrix:
     0     1   2     3   4    5     6     7     8    9      10
0   254     2   0    34   0    0    23    11    19    8    132
1     1  1219   0    10   0    0     1    76     9    1     15
2     1     4  36    10  25    2     3    14    35  143     39
3     0     2   0  8029   0    6    12   181   203    3      4
4     3     3  27    10  76    6     4    10    46   68    286
5     0     0   0   135   0  287     9     0    31   56      3
6     8     1   0    29   0    0  1773     7    20    3     67
7     4    32   1   645   0    0     9  6249   248    2     75
8     1     4   0   425   0    6    11    93  2682    9     65
9     2     0   5    60   1   74    14     5    43  278     11
10    7     3   4    28   9    0    24    46    97    5  12573
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.50150424, 'precision': 0.46511596, 'recall': 0.3650549, 'specificity': 0.94971097, 'f1': 0.3412382, 'auroc': 0.8321035}
confusion matrix:
     0    1   2    3   4   5     6    7    8   9     10
0   122    0   0    8   0   0    33    0    1   0  1006
1     5  598   1   63   2   2     5  434   50  12   327
2    33    0   0   54   0   2    41   18   29   6   832
3     0    0   0    0   0   0     0    0    0   0     0
4     1    0   0    4   0   0    63    3    1   0  1561
5    10    0   0  270   0  85    30    0   67  21   109
6     2    0   0    1   0   0  2966    0    0   0    98
7     0    0   0  164   0   0     1  894    6   0    99
8    24    0   0  317   0   8     3   46  837  42    93
9    83    0   2  187   2   7    47   29  157  39   584
10    0    0   0    0   0   0    19    0    0   0  1627
after epoch: 11,now: 2024-05-05 01:44:25.855697,epoch time: 0:30:43.256180,used: 8:40:24.413331,model: blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8970462, 'precision': 0.79865426, 'recall': 0.64056623, 'specificity': 0.98841405, 'f1': 0.6856933, 'auroc': 0.98614234}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   223     0   0    57    0    0    65    34    16    2     86
1     0  1189   0    16    0    0     1   119     6    0      1
2     1     0  48    11   86    4     1    52    46   37     25
3     1     0   0  7969    0    3     4   319   143    0      0
4     1     1  10    12  117    3     4    37    56   13    285
5     0     0   0   219    0  233     2     2    44   20      1
6     4     0   0    70    0    0  1780    20     9    1     24
7     1    16   0   266    1    0     5  6869    88    0     17
8     0     1   0   379    0    4     4   284  2589    1     34
9     3     0  15    85   28   90     9    24    84  147      8
10    7    32   0    29   29    1    49   190    89    1  12364
---- Validation: 
scalar performance:
{'acc': 0.8984085, 'precision': 0.8011438, 'recall': 0.64438975, 'specificity': 0.9885973, 'f1': 0.68846196, 'auroc': 0.9863031}
confusion matrix:
     0     1   2     3    4    5     6     7     8    9      10
0   234     0   0    52    1    0    50    32    22    2     90
1     0  1174   0    16    0    0     1   134     4    0      3
2     1     1  36    10   98    4     4    57    49   31     21
3     0     0   0  7993    0    2     3   288   152    1      1
4     2     2   9    11  139    3     3    37    57   14    262
5     2     0   1   212    0  231     3     0    50   21      1
6     7     2   0    78    1    1  1768    19    10    1     21
7     1    22   0   269    1    1     6  6861    83    0     21
8     0     1   0   367    0    1     6   263  2618    0     40
9     6     0  11    76   26   82     6    25    92  161      8
10    4    45   0    23   26    1    62   177    86    0  12372
---- Test Domain (oracle): 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.57426715, 'precision': 0.49924415, 'recall': 0.42922854, 'specificity': 0.95718217, 'f1': 0.37516612, 'auroc': 0.8625641}
confusion matrix:
     0     1   2    3   4   5     6     7    8   9     10
0   326     0   0   79   0   0   147   257   18   0   343
1     0  1072   0   27   0   1     3   362   17   1    16
2    10    35   0   37   0   2    69   254  129  19   460
3     0     0   0    0   0   0     0     0    0   0     0
4     0    61   0    1   0   0    71     9    5   0  1486
5     4     0   0  385   0  35     8    10  140   7     3
6     0     0   0    0   0   0  3055     8    0   0     4
7     0     0   0    8   0   0     2  1150    0   0     4
8     0     0   0  182   0   1     2   239  931   1    14
9    12    11   0  185   2   4    52   333  360  34   144
10    0    11   0    0   0   0    27     2    1   0  1605
after epoch: 12,now: 2024-05-05 02:14:57.911677,epoch time: 0:30:32.055980,used: 9:10:56.469311,model: blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
Experiment finished at epoch: 12 with time: 9:10:56.469311 at 2024-05-05 02:14:57.911677
persisted model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.5266214, 'precision': 0.5057653, 'recall': 0.40831378, 'specificity': 0.9528, 'f1': 0.36707598, 'auroc': 0.8476022}
confusion matrix:
     0     1   2    3   4   5     6     7    8   9     10
0   506     0   0  112   0   0     0   139    1   0   412
1     3  1038   1   41   0   1     0   368   11   0    36
2    36    22   0   29   0   7     4   360   45   3   509
3     0     0   0    0   0   0     0     0    0   0     0
4     0    69   0    1   0   0     9    15    3   0  1536
5    17     0   0  370   0  73     0    12  111   4     5
6     8    57   0    6   0   0  2532    45    0   0   419
7     1     0   0   11   0   0     0  1147    0   0     5
8     0     0   0  234   0   1     0   503  590   0    42
9    53     6   0  198   0   6     2   512  139  17   204
10    0    20   0    0   0   0     0     2    0   0  1624
oracle model performance metric: 

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: No positive samples in targets, true positive value should be meaningless. Returning zero tensor in true positive score
  warnings.warn(*args, **kwargs)
scalar performance:
{'acc': 0.6088995, 'precision': 0.581441, 'recall': 0.46589082, 'specificity': 0.9603549, 'f1': 0.4191918, 'auroc': 0.8566326}
confusion matrix:
     0     1   2    3   4   5     6     7     8    9     10
0   557     0   0  172   0   0   162   102     7    0   170
1     1  1053   0    8   0   0     5   251    71   13    97
2    20     0   2   17   1   0    60   166    60   63   626
3     0     0   0    0   0   0     0     0     0    0     0
4     1     4   1    2   0   0    70    16     4    1  1534
5    18     0   0  186   0  19    16     0   231  104    18
6     1     1   0    0   0   0  3031     0     0    0    34
7     0     0   0   12   0   0     2  1147     1    0     2
8     1     0   0   66   0   0     3   143  1109   30    18
9    52     0   0   93   1   0    41   172   332  164   282
10    0     0   0    0   0   0    17     8     0    0  1621
prediction saved in file zoutput/saved_predicts/blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702_instance_wise_predictions.txt
accuracy from prediction file 0.5266214230742321
results aggregation path: zoutput/aggrsts/blood_mon_eos_bas_te_acevedo_exptag.csv
confusion matrix saved in file: zoutput/aggrsts/blood_mon_eos_bas_te_acevedo_erm_bb976d8c0_not_commited_2024md_05md_04_17_04_01_seed_0_20339702_conf_mat.png
