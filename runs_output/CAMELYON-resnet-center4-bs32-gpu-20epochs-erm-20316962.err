Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)



no algorithm conf specified, going to use default



/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/arg_parser.py:355: UserWarning: no algorithm conf specified, going to use default
  warnings.warn("no algorithm conf specified, going to use default")

patient_073_node_1_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_015_node_2_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_017_node_1_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_099_node_4_0:   0%|          | 0/114 [00:00<?, ?it/s][A
                                                             [A
patient_004_node_4_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_024_node_1_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_016_node_1_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_038_node_2_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_086_node_4_0:   0%|          | 0/176 [00:00<?, ?it/s][A
                                                             [A
patient_020_node_4_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_064_node_0_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_021_node_3_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_009_node_1_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_081_node_4_0:   0%|          | 0/110 [00:00<?, ?it/s][A
                                                             [A
patient_096_node_0_0:   0%|          | 0/165 [00:00<?, ?it/s][A
                                                             [A
patient_017_node_4_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_061_node_4_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_051_node_2_0:   0%|          | 0/144 [00:00<?, ?it/s][A
                                                             [A
patient_045_node_1_0:   0%|          | 0/116 [00:00<?, ?it/s][A
                                                             [A
patient_092_node_1_0:   0%|          | 0/180 [00:00<?, ?it/s][A
                                                             [A
patient_052_node_1_0:   0%|          | 0/124 [00:00<?, ?it/s][A
                                                             [A
patient_086_node_0_0:   0%|          | 0/141 [00:00<?, ?it/s][A
                                                             [A
patient_040_node_2_0:   0%|          | 0/172 [00:00<?, ?it/s][A
                                                             [A
patient_012_node_0_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_072_node_0_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_034_node_3_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_015_node_1_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_062_node_2_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_066_node_2_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_068_node_1_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_042_node_3_0:   0%|          | 0/136 [00:00<?, ?it/s][A
                                                             [A
patient_036_node_3_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_060_node_3_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_010_node_4_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_075_node_4_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_067_node_4_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_017_node_2_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_024_node_2_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_087_node_0_0:   0%|          | 0/172 [00:00<?, ?it/s][A
                                                             [A
patient_039_node_1_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_088_node_1_0:   0%|          | 0/140 [00:00<?, ?it/s][A
                                                             [A
patient_046_node_3_0:   0%|          | 0/128 [00:00<?, ?it/s][A
                                                             [A
patient_046_node_4_0:   0%|          | 0/64 [00:00<?, ?it/s][A
                                                            [A
patient_044_node_4_0:   0%|          | 0/56 [00:00<?, ?it/s][A
                                                            [A
patient_048_node_1_0:   0%|          | 0/140 [00:00<?, ?it/s][A
                                                             [A
patient_089_node_3_0:   0%|          | 0/149 [00:00<?, ?it/s][A
                                                             [A
patient_020_node_2_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_080_node_1_0:   0%|          | 0/163 [00:00<?, ?it/s][A
                                                             [A
patient_041_node_0_0:   0%|          | 0/144 [00:00<?, ?it/s][A
                                                             [A
patient_022_node_4_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
overriding args.task None to dset


using device: cuda

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'b976d8c0'
model name: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962

 Experiment start at: 2024-05-03 15:57:14.961657
before training, model accuracy: 0.6328148245811462
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9877554, 'precision': 0.9028144, 'recall': 0.8290609, 'specificity': 0.8290609, 'f1': 0.8620084, 'auroc': 0.98774284}
confusion matrix:
       0    1
0  38785  151
1    338  662
---- Validation: 
scalar performance:
{'acc': 0.9852452, 'precision': 0.84996486, 'recall': 0.77406156, 'specificity': 0.77406156, 'f1': 0.8071497, 'auroc': 0.95407486}
confusion matrix:
       0    1
0  16686   85
1    168  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9241058, 'precision': 0.77189475, 'recall': 0.5080015, 'specificity': 0.5080015, 'f1': 0.49666578, 'auroc': 0.79459274}
confusion matrix:
      0   1
0  9314   8
1   758  13
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-03 16:09:55.896631,epoch time: 0:12:40.934974,used: 0:12:40.934974,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99013424, 'precision': 0.97976065, 'recall': 0.8127432, 'specificity': 0.8127432, 'f1': 0.87779754, 'auroc': 0.9951805}
confusion matrix:
       0    1
0  38916   20
1    374  626
---- Validation: 
scalar performance:
{'acc': 0.9865283, 'precision': 0.94183886, 'recall': 0.7175187, 'specificity': 0.7175187, 'f1': 0.7899573, 'auroc': 0.95706004}
confusion matrix:
       0    1
0  16752   19
1    212  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9227187, 'precision': 0.46177113, 'recall': 0.49951726, 'specificity': 0.49951726, 'f1': 0.4799031, 'auroc': 0.4400756}
confusion matrix:
      0  1
0  9313  9
1   771  0
better model found
persisted
after epoch: 2,now: 2024-05-03 16:25:14.623047,epoch time: 0:15:18.726416,used: 0:27:59.661390,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99684495, 'precision': 0.9877009, 'recall': 0.94674313, 'specificity': 0.94674313, 'f1': 0.96627647, 'auroc': 0.9983042}
confusion matrix:
       0    1
0  38916   20
1    106  894
---- Validation: 
scalar performance:
{'acc': 0.98903596, 'precision': 0.9262687, 'recall': 0.79679906, 'specificity': 0.79679906, 'f1': 0.84940845, 'auroc': 0.9562798}
confusion matrix:
       0    1
0  16735   36
1    152  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92361045, 'precision': 0.46180522, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48014423, 'auroc': 0.64764297}
confusion matrix:
      0  1
0  9322  0
1   771  0
better model found
persisted
after epoch: 3,now: 2024-05-03 16:39:04.523204,epoch time: 0:13:49.900157,used: 0:41:49.561547,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99792165, 'precision': 0.9691044, 'recall': 0.98966867, 'specificity': 0.98966867, 'f1': 0.9791535, 'auroc': 0.9998292}
confusion matrix:
       0    1
0  38873   64
1     19  980
---- Validation: 
scalar performance:
{'acc': 0.9890943, 'precision': 0.8700725, 'recall': 0.8787272, 'specificity': 0.8787272, 'f1': 0.8743471, 'auroc': 0.9730561}
confusion matrix:
       0    1
0  16673   98
1     89  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9227187, 'precision': 0.65154994, 'recall': 0.50784546, 'specificity': 0.50784546, 'f1': 0.49720082, 'auroc': 0.7121295}
confusion matrix:
      0   1
0  9299  23
1   757  14
better model found
persisted
after epoch: 4,now: 2024-05-03 16:50:51.892051,epoch time: 0:11:47.368847,used: 0:53:36.930394,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9991737, 'precision': 0.9956099, 'recall': 0.9873973, 'specificity': 0.9873973, 'f1': 0.9914674, 'auroc': 0.9999528}
confusion matrix:
       0    1
0  38928    8
1     25  975
---- Validation: 
scalar performance:
{'acc': 0.9893859, 'precision': 0.9307319, 'recall': 0.8021778, 'specificity': 0.8021778, 'f1': 0.8546629, 'auroc': 0.9676791}
confusion matrix:
       0    1
0  16737   34
1    148  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92341226, 'precision': 0.46179765, 'recall': 0.49989274, 'specificity': 0.49989274, 'f1': 0.48009065, 'auroc': 0.7112359}
confusion matrix:
      0  1
0  9320  2
1   771  0
better model found
persisted
after epoch: 5,now: 2024-05-03 17:01:51.390677,epoch time: 0:10:59.498626,used: 1:04:36.429020,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9990735, 'precision': 0.99120045, 'recall': 0.98976165, 'specificity': 0.98976165, 'f1': 0.99047995, 'auroc': 0.9999114}
confusion matrix:
       0    1
0  38921   17
1     20  978
---- Validation: 
scalar performance:
{'acc': 0.9885111, 'precision': 0.8985771, 'recall': 0.81213045, 'specificity': 0.81213045, 'f1': 0.849836, 'auroc': 0.9645987}
confusion matrix:
       0    1
0  16714   57
1    140  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9181611, 'precision': 0.6250154, 'recall': 0.5267936, 'specificity': 0.5267936, 'f1': 0.53255224, 'auroc': 0.847862}
confusion matrix:
      0    1
0  9217  105
1   721   50
early stop counter: 1
val acc:0.9885110855102539, best validation acc: 0.9893859028816223, corresponding to test acc:                         0.9234122633934021 / 0.9241058230400085
after epoch: 6,now: 2024-05-03 17:12:29.385698,epoch time: 0:10:37.995021,used: 1:15:14.424041,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9984976, 'precision': 0.97499293, 'recall': 0.99533224, 'specificity': 0.99533224, 'f1': 0.9849374, 'auroc': 0.9998951}
confusion matrix:
       0    1
0  38884   52
1      8  992
---- Validation: 
scalar performance:
{'acc': 0.98804456, 'precision': 0.85922253, 'recall': 0.8638909, 'specificity': 0.8638909, 'f1': 0.8615408, 'auroc': 0.95252013}
confusion matrix:
       0    1
0  16666  105
1    100  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91944915, 'precision': 0.60997546, 'recall': 0.5155934, 'specificity': 0.5155934, 'f1': 0.5133163, 'auroc': 0.6266606}
confusion matrix:
      0   1
0  9250  72
1   741  30
early stop counter: 2
val acc:0.9880445599555969, best validation acc: 0.9893859028816223, corresponding to test acc:                         0.9234122633934021 / 0.9241058230400085
after epoch: 7,now: 2024-05-03 17:22:05.421717,epoch time: 0:09:36.036019,used: 1:24:50.460060,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99927384, 'precision': 0.99519324, 'recall': 0.98988444, 'specificity': 0.98988444, 'f1': 0.9925237, 'auroc': 0.99996233}
confusion matrix:
       0    1
0  38927    9
1     20  980
---- Validation: 
scalar performance:
{'acc': 0.98856944, 'precision': 0.9121931, 'recall': 0.7978605, 'specificity': 0.7978605, 'f1': 0.8453847, 'auroc': 0.962283}
confusion matrix:
       0    1
0  16726   45
1    151  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9235113, 'precision': 0.67621315, 'recall': 0.501731, 'specificity': 0.501731, 'f1': 0.48396733, 'auroc': 0.70585686}
confusion matrix:
      0  1
0  9318  4
1   768  3
early stop counter: 3
val acc:0.988569438457489, best validation acc: 0.9893859028816223, corresponding to test acc:                         0.9234122633934021 / 0.9241058230400085
after epoch: 8,now: 2024-05-03 17:32:17.897191,epoch time: 0:10:12.475474,used: 1:35:02.935534,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99877304, 'precision': 0.9938539, 'recall': 0.9808397, 'specificity': 0.9808397, 'f1': 0.9872552, 'auroc': 0.99971247}
confusion matrix:
       0    1
0  38926   11
1     38  961
---- Validation: 
scalar performance:
{'acc': 0.98956084, 'precision': 0.91091704, 'recall': 0.82826674, 'specificity': 0.82826674, 'f1': 0.86474526, 'auroc': 0.9610391}
confusion matrix:
       0    1
0  16720   51
1    128  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92341226, 'precision': 0.5868396, 'recall': 0.5004876, 'specificity': 0.5004876, 'f1': 0.4813789, 'auroc': 0.73358727}
confusion matrix:
      0  1
0  9319  3
1   770  1
better model found
persisted
after epoch: 9,now: 2024-05-03 17:42:26.073260,epoch time: 0:10:08.176069,used: 1:45:11.111603,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9986228, 'precision': 0.9927669, 'recall': 0.9788331, 'specificity': 0.9788331, 'f1': 0.98569465, 'auroc': 0.9998789}
confusion matrix:
       0    1
0  38923   13
1     42  958
---- Validation: 
scalar performance:
{'acc': 0.987753, 'precision': 0.90847254, 'recall': 0.77794355, 'specificity': 0.77794355, 'f1': 0.8302143, 'auroc': 0.95645595}
confusion matrix:
       0    1
0  16727   44
1    166  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92361045, 'precision': 0.7119312, 'recall': 0.5017846, 'specificity': 0.5017846, 'f1': 0.4839991, 'auroc': 0.69574785}
confusion matrix:
      0  1
0  9319  3
1   768  3
early stop counter: 1
val acc:0.9877529740333557, best validation acc: 0.9895608425140381, corresponding to test acc:                         0.9234122633934021 / 0.9241058230400085
after epoch: 10,now: 2024-05-03 17:52:34.569839,epoch time: 0:10:08.496579,used: 1:55:19.608182,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9989233, 'precision': 0.98197913, 'recall': 0.9965249, 'specificity': 0.9965249, 'f1': 0.9891379, 'auroc': 0.9999562}
confusion matrix:
       0    1
0  38899   37
1      6  994
---- Validation: 
scalar performance:
{'acc': 0.9876946, 'precision': 0.8673084, 'recall': 0.8338126, 'specificity': 0.8338126, 'f1': 0.84971714, 'auroc': 0.95835084}
confusion matrix:
       0    1
0  16683   88
1    123  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91637766, 'precision': 0.5835396, 'recall': 0.51631016, 'specificity': 0.51631016, 'f1': 0.5153859, 'auroc': 0.78588194}
confusion matrix:
      0    1
0  9215  107
1   737   34
early stop counter: 2
val acc:0.9876946210861206, best validation acc: 0.9895608425140381, corresponding to test acc:                         0.9234122633934021 / 0.9241058230400085
after epoch: 11,now: 2024-05-03 18:02:14.486802,epoch time: 0:09:39.916963,used: 2:04:59.525145,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99944913, 'precision': 0.99388355, 'recall': 0.99484587, 'specificity': 0.99484587, 'f1': 0.9943642, 'auroc': 0.9999757}
confusion matrix:
       0    1
0  38924   12
1     10  990
---- Validation: 
scalar performance:
{'acc': 0.9890943, 'precision': 0.90108836, 'recall': 0.8267283, 'specificity': 0.8267283, 'f1': 0.85992026, 'auroc': 0.96935403}
confusion matrix:
       0    1
0  16713   58
1    129  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9235113, 'precision': 0.46180144, 'recall': 0.49994636, 'specificity': 0.49994636, 'f1': 0.48011747, 'auroc': 0.6802459}
confusion matrix:
      0  1
0  9321  1
1   771  0
early stop counter: 3
val acc:0.9890943169593811, best validation acc: 0.9895608425140381, corresponding to test acc:                         0.9234122633934021 / 0.9241058230400085
after epoch: 12,now: 2024-05-03 18:11:47.387116,epoch time: 0:09:32.900314,used: 2:14:32.425459,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9997496, 'precision': 0.9969546, 'recall': 0.99792296, 'specificity': 0.99792296, 'f1': 0.9974383, 'auroc': 0.99999857}
confusion matrix:
       0    1
0  38930    6
1      4  996
---- Validation: 
scalar performance:
{'acc': 0.98921096, 'precision': 0.89609134, 'recall': 0.83718765, 'specificity': 0.83718765, 'f1': 0.8641534, 'auroc': 0.97259104}
confusion matrix:
       0    1
0  16707   64
1    121  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91637766, 'precision': 0.5314266, 'recall': 0.5044127, 'specificity': 0.5044127, 'f1': 0.4942056, 'auroc': 0.791166}
confusion matrix:
      0   1
0  9235  87
1   757  14
early stop counter: 4
val acc:0.9892109632492065, best validation acc: 0.9895608425140381, corresponding to test acc:                         0.9234122633934021 / 0.9241058230400085
after epoch: 13,now: 2024-05-03 18:21:30.883814,epoch time: 0:09:43.496698,used: 2:24:15.922157,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9965445, 'precision': 0.939314, 'recall': 0.9982279, 'specificity': 0.9982279, 'f1': 0.966809, 'auroc': 0.9999819}
confusion matrix:
       0    1
0  38799  138
1      0  999
---- Validation: 
scalar performance:
{'acc': 0.9853036, 'precision': 0.8138411, 'recall': 0.8884891, 'specificity': 0.8884891, 'f1': 0.8469441, 'auroc': 0.97297513}
confusion matrix:
       0    1
0  16599  172
1     80  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92034084, 'precision': 0.61333966, 'recall': 0.5131018, 'specificity': 0.5131018, 'f1': 0.5084795, 'auroc': 0.7705948}
confusion matrix:
      0   1
0  9264  58
1   746  25
early stop counter: 5
val acc:0.9853035807609558, best validation acc: 0.9895608425140381, corresponding to test acc:                         0.9234122633934021 / 0.9241058230400085
after epoch: 14,now: 2024-05-03 18:31:21.684686,epoch time: 0:09:50.800872,used: 2:34:06.723029,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9999249, 'precision': 0.9994738, 'recall': 0.9989872, 'specificity': 0.9989872, 'f1': 0.9992304, 'auroc': 0.9999995}
confusion matrix:
       0    1
0  38935    1
1      2  998
---- Validation: 
scalar performance:
{'acc': 0.99072725, 'precision': 0.9222108, 'recall': 0.8483626, 'specificity': 0.8483626, 'f1': 0.8815762, 'auroc': 0.97242504}
confusion matrix:
       0    1
0  16725   46
1    113  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9149906, 'precision': 0.55138135, 'recall': 0.50961053, 'specificity': 0.50961053, 'f1': 0.504239, 'auroc': 0.754621}
confusion matrix:
      0    1
0  9211  111
1   747   24
better model found
persisted
after epoch: 15,now: 2024-05-03 18:41:00.773309,epoch time: 0:09:39.088623,used: 2:43:45.811652,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99919873, 'precision': 0.99709725, 'recall': 0.9864358, 'specificity': 0.9864358, 'f1': 0.9917056, 'auroc': 0.99994665}
confusion matrix:
       0    1
0  38931    5
1     27  973
---- Validation: 
scalar performance:
{'acc': 0.9887444, 'precision': 0.9304594, 'recall': 0.78495026, 'specificity': 0.78495026, 'f1': 0.8422384, 'auroc': 0.9446182}
confusion matrix:
       0    1
0  16739   32
1    161  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8823937, 'precision': 0.602566, 'recall': 0.6156975, 'specificity': 0.6156975, 'f1': 0.60850036, 'auroc': 0.8141476}
confusion matrix:
      0    1
0  8674  648
1   539  232
early stop counter: 1
val acc:0.9887443780899048, best validation acc: 0.9907272458076477, corresponding to test acc:                         0.9149906039237976 / 0.9241058230400085
after epoch: 16,now: 2024-05-03 18:50:38.695108,epoch time: 0:09:37.921799,used: 2:53:23.733451,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9996745, 'precision': 0.9959477, 'recall': 0.9973973, 'specificity': 0.9973973, 'f1': 0.99667144, 'auroc': 0.9997852}
confusion matrix:
       0    1
0  38928    8
1      5  995
---- Validation: 
scalar performance:
{'acc': 0.9882195, 'precision': 0.8789059, 'recall': 0.831481, 'specificity': 0.831481, 'f1': 0.8535272, 'auroc': 0.9644209}
confusion matrix:
       0    1
0  16694   77
1    125  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91806203, 'precision': 0.6071459, 'recall': 0.51960146, 'specificity': 0.51960146, 'f1': 0.52063817, 'auroc': 0.8145404}
confusion matrix:
      0   1
0  9228  94
1   733  38
early stop counter: 2
val acc:0.9882194995880127, best validation acc: 0.9907272458076477, corresponding to test acc:                         0.9149906039237976 / 0.9241058230400085
after epoch: 17,now: 2024-05-03 19:01:23.815572,epoch time: 0:10:45.120464,used: 3:04:08.853915,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99989986, 'precision': 0.99848866, 'recall': 0.99946094, 'specificity': 0.99946094, 'f1': 0.9989743, 'auroc': 0.9999995}
confusion matrix:
       0    1
0  38934    3
1      1  998
---- Validation: 
scalar performance:
{'acc': 0.98856944, 'precision': 0.8811916, 'recall': 0.83945966, 'specificity': 0.83945966, 'f1': 0.8590538, 'auroc': 0.966694}
confusion matrix:
       0    1
0  16694   77
1    119  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9229169, 'precision': 0.6090477, 'recall': 0.5025989, 'specificity': 0.5025989, 'f1': 0.4862916, 'auroc': 0.8713183}
confusion matrix:
      0   1
0  9310  12
1   766   5
early stop counter: 3
val acc:0.988569438457489, best validation acc: 0.9907272458076477, corresponding to test acc:                         0.9149906039237976 / 0.9241058230400085
after epoch: 18,now: 2024-05-03 19:11:27.663385,epoch time: 0:10:03.847813,used: 3:14:12.701728,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9954677, 'precision': 0.9354523, 'recall': 0.97818935, 'specificity': 0.97818935, 'f1': 0.95576155, 'auroc': 0.9986596}
confusion matrix:
       0    1
0  38795  141
1     40  960
---- Validation: 
scalar performance:
{'acc': 0.9830874, 'precision': 0.80001986, 'recall': 0.8171576, 'specificity': 0.8171576, 'f1': 0.8083357, 'auroc': 0.93703043}
confusion matrix:
       0    1
0  16615  156
1    134  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9196473, 'precision': 0.6108406, 'recall': 0.51510584, 'specificity': 0.51510584, 'f1': 0.5123798, 'auroc': 0.8021142}
confusion matrix:
      0   1
0  9253  69
1   742  29
early stop counter: 4
val acc:0.983087420463562, best validation acc: 0.9907272458076477, corresponding to test acc:                         0.9149906039237976 / 0.9241058230400085
after epoch: 19,now: 2024-05-03 19:21:24.037814,epoch time: 0:09:56.374429,used: 3:24:09.076157,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9993239, 'precision': 0.9882083, 'recall': 0.99819183, 'specificity': 0.99819183, 'f1': 0.9931468, 'auroc': 0.99996555}
confusion matrix:
       0    1
0  38912   24
1      3  997
---- Validation: 
scalar performance:
{'acc': 0.9878696, 'precision': 0.855855, 'recall': 0.86510146, 'specificity': 0.86510146, 'f1': 0.8604155, 'auroc': 0.964739}
confusion matrix:
       0    1
0  16662  109
1     99  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92152977, 'precision': 0.5840981, 'recall': 0.5048224, 'specificity': 0.5048224, 'f1': 0.4918755, 'auroc': 0.6523062}
confusion matrix:
      0   1
0  9291  31
1   761  10
early stop counter: 5
val acc:0.9878696203231812, best validation acc: 0.9907272458076477, corresponding to test acc:                         0.9149906039237976 / 0.9241058230400085
after epoch: 20,now: 2024-05-03 19:32:24.158143,epoch time: 0:11:00.120329,used: 3:35:09.196486,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99997497, 'precision': 0.9995005, 'recall': 0.9999871, 'specificity': 0.9999871, 'f1': 0.9997437, 'auroc': 1.0}
confusion matrix:
       0     1
0  38935     1
1      0  1000
---- Validation: 
scalar performance:
{'acc': 0.98932755, 'precision': 0.90243703, 'recall': 0.83204746, 'specificity': 0.83204746, 'f1': 0.86370087, 'auroc': 0.9664577}
confusion matrix:
       0    1
0  16713   58
1    125  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92152977, 'precision': 0.51740736, 'recall': 0.5006582, 'specificity': 0.5006582, 'f1': 0.4833344, 'auroc': 0.6933144}
confusion matrix:
      0   1
0  9298  24
1   768   3
early stop counter: 6
val acc:0.9893275499343872, best validation acc: 0.9907272458076477, corresponding to test acc:                         0.9149906039237976 / 0.9241058230400085
after epoch: 21,now: 2024-05-03 19:42:15.529558,epoch time: 0:09:51.371415,used: 3:45:00.567901,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99952424, 'precision': 0.9972975, 'recall': 0.9929358, 'specificity': 0.9929358, 'f1': 0.9951065, 'auroc': 0.99997187}
confusion matrix:
       0    1
0  38931    5
1     14  986
---- Validation: 
scalar performance:
{'acc': 0.9893859, 'precision': 0.92031085, 'recall': 0.8125776, 'specificity': 0.8125776, 'f1': 0.8581512, 'auroc': 0.96515566}
confusion matrix:
       0    1
0  16729   42
1    140  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92212427, 'precision': 0.63897806, 'recall': 0.50990313, 'specificity': 0.50990313, 'f1': 0.5016024, 'auroc': 0.78975177}
confusion matrix:
      0   1
0  9289  33
1   753  18
early stop counter: 7
val acc:0.9893859028816223, best validation acc: 0.9907272458076477, corresponding to test acc:                         0.9149906039237976 / 0.9241058230400085
after epoch: 22,now: 2024-05-03 19:52:49.717251,epoch time: 0:10:34.187693,used: 3:55:34.755594,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99934894, 'precision': 0.99285984, 'recall': 0.9938202, 'specificity': 0.9938202, 'f1': 0.9933396, 'auroc': 0.99996257}
confusion matrix:
       0    1
0  38922   14
1     12  988
---- Validation: 
scalar performance:
{'acc': 0.9879862, 'precision': 0.889338, 'recall': 0.8079622, 'specificity': 0.8079622, 'f1': 0.84366274, 'auroc': 0.9660001}
confusion matrix:
       0    1
0  16708   63
1    143  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9237095, 'precision': 0.961851, 'recall': 0.5006485, 'specificity': 0.5006485, 'f1': 0.48146427, 'auroc': 0.61154723}
confusion matrix:
      0  1
0  9322  0
1   770  1
early stop counter: 8
val acc:0.9879862070083618, best validation acc: 0.9907272458076477, corresponding to test acc:                         0.9149906039237976 / 0.9241058230400085
after epoch: 23,now: 2024-05-03 20:03:28.502214,epoch time: 0:10:38.784963,used: 4:06:13.540557,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99984974, 'precision': 0.9984615, 'recall': 0.9984615, 'specificity': 0.9984615, 'f1': 0.9984615, 'auroc': 0.99869055}
confusion matrix:
       0    1
0  38933    3
1      3  997
---- Validation: 
scalar performance:
{'acc': 0.990319, 'precision': 0.92027915, 'recall': 0.8390541, 'specificity': 0.8390541, 'f1': 0.87511206, 'auroc': 0.97121274}
confusion matrix:
       0    1
0  16725   46
1    120  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9237095, 'precision': 0.79522634, 'recall': 0.50124335, 'specificity': 0.50124335, 'f1': 0.4827509, 'auroc': 0.60264486}
confusion matrix:
      0  1
0  9321  1
1   769  2
early stop counter: 9
val acc:0.990319013595581, best validation acc: 0.9907272458076477, corresponding to test acc:                         0.9149906039237976 / 0.9241058230400085
after epoch: 24,now: 2024-05-03 20:13:54.238418,epoch time: 0:10:25.736204,used: 4:16:39.276761,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99877304, 'precision': 0.9993715, 'recall': 0.9755, 'specificity': 0.9755, 'f1': 0.9871279, 'auroc': 0.99999726}
confusion matrix:
       0    1
0  38936    0
1     49  951
---- Validation: 
scalar performance:
{'acc': 0.9882195, 'precision': 0.970871, 'recall': 0.74308276, 'specificity': 0.74308276, 'f1': 0.81918836, 'auroc': 0.9638333}
confusion matrix:
       0    1
0  16762    9
1    193  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92321414, 'precision': 0.61191607, 'recall': 0.50157005, 'specificity': 0.50157005, 'f1': 0.48387215, 'auroc': 0.81525505}
confusion matrix:
      0  1
0  9315  7
1   768  3
early stop counter: 10
val acc:0.9882194995880127, best validation acc: 0.9907272458076477, corresponding to test acc:                         0.9149906039237976 / 0.9241058230400085
after epoch: 25,now: 2024-05-03 20:24:30.174919,epoch time: 0:10:35.936501,used: 4:27:15.213262,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
early stop trigger
Experiment finished at epoch: 25 with time: 4:27:15.213262 at 2024-05-03 20:24:30.174919
persisted model performance metric: 

scalar performance:
{'acc': 0.9149906, 'precision': 0.55138135, 'recall': 0.50961053, 'specificity': 0.50961053, 'f1': 0.504239, 'auroc': 0.754621}
confusion matrix:
      0    1
0  9211  111
1   747   24
oracle model performance metric: 

scalar performance:
{'acc': 0.9241058, 'precision': 0.77189475, 'recall': 0.5080015, 'specificity': 0.5080015, 'f1': 0.49666578, 'auroc': 0.79459274}
confusion matrix:
      0   1
0  9314   8
1   758  13
results aggregation path: zoutput/aggrsts/dset_te_center4_exptag.csv
confusion matrix saved in file: zoutput/aggrsts/dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_03_15_57_14_seed_0_20316962_conf_mat.png
