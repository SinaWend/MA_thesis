Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)



no algorithm conf specified, going to use default



/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/arg_parser.py:355: UserWarning: no algorithm conf specified, going to use default
  warnings.warn("no algorithm conf specified, going to use default")

overriding args.task None to dset


using device: cuda

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'b976d8c0'
model name: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222

 Experiment start at: 2024-05-05 10:27:16.381586
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.7770535}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.7649597}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.8644335}
confusion matrix:
      0  1
0  9342  0
1   772  0
new oracle model saved
after epoch: 1,now: 2024-05-05 10:44:29.001609,epoch time: 0:17:12.620023,used: 0:17:12.620023,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.8945206}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.8934488}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.85371745}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 1
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 2,now: 2024-05-05 11:00:43.277740,epoch time: 0:16:14.276131,used: 0:33:26.896154,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9790915, 'precision': 0.78514844, 'recall': 0.7230937, 'specificity': 0.7230937, 'f1': 0.7500776, 'auroc': 0.92303675}
confusion matrix:
       0    1
0  38665  311
1    524  436
---- Validation: 
scalar performance:
{'acc': 0.976496, 'precision': 0.7518897, 'recall': 0.6989226, 'specificity': 0.6989226, 'f1': 0.7220644, 'auroc': 0.91294485}
confusion matrix:
       0    1
0  16574  157
1    246  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90597194, 'precision': 0.7071918, 'recall': 0.84393686, 'specificity': 0.84393686, 'f1': 0.7516179, 'auroc': 0.89885175}
confusion matrix:
      0    1
0  8568  774
1   177  595
after epoch: 3,now: 2024-05-05 11:18:12.621895,epoch time: 0:17:29.344155,used: 0:50:56.240309,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9783403, 'precision': 0.89946866, 'recall': 0.5636495, 'specificity': 0.5636495, 'f1': 0.60521984, 'auroc': 0.9314951}
confusion matrix:
       0    1
0  38948   27
1    838  123
---- Validation: 
scalar performance:
{'acc': 0.9770792, 'precision': 0.84471273, 'recall': 0.5441301, 'specificity': 0.5441301, 'f1': 0.5734198, 'auroc': 0.91935396}
confusion matrix:
       0   1
0  16716  15
1    378  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91813326, 'precision': 0.7257937, 'recall': 0.82616, 'specificity': 0.82616, 'f1': 0.7635242, 'auroc': 0.9034095}
confusion matrix:
      0    1
0  8732  610
1   218  554
after epoch: 4,now: 2024-05-05 11:34:10.514969,epoch time: 0:15:57.893074,used: 1:06:54.133383,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97896636, 'precision': 0.8242489, 'recall': 0.62435824, 'specificity': 0.62435824, 'f1': 0.6774324, 'auroc': 0.9340395}
confusion matrix:
       0    1
0  38854  121
1    719  242
---- Validation: 
scalar performance:
{'acc': 0.9770792, 'precision': 0.7760921, 'recall': 0.6040517, 'specificity': 0.6040517, 'f1': 0.6488304, 'auroc': 0.90957737}
confusion matrix:
       0   1
0  16665  66
1    327  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9187265, 'precision': 0.7172, 'recall': 0.7492421, 'specificity': 0.7492421, 'f1': 0.7317455, 'auroc': 0.88817185}
confusion matrix:
      0    1
0  8868  474
1   348  424
early stop counter: 1
val acc:0.9770792126655579, best validation acc: 0.9770792126655579, corresponding to test acc:                         0.9181332588195801 / 0.9236701726913452
after epoch: 5,now: 2024-05-05 11:50:06.096264,epoch time: 0:15:55.581295,used: 1:22:49.714678,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.80413055, 'recall': 0.7370074, 'specificity': 0.7370074, 'f1': 0.7661375, 'auroc': 0.9387783}
confusion matrix:
       0    1
0  38694  282
1    498  462
---- Validation: 
scalar performance:
{'acc': 0.9773125, 'precision': 0.76395965, 'recall': 0.69464123, 'specificity': 0.69464123, 'f1': 0.72369206, 'auroc': 0.91246045}
confusion matrix:
       0    1
0  16592  139
1    250  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.919122, 'precision': 0.71475935, 'recall': 0.7239079, 'specificity': 0.7239079, 'f1': 0.7192066, 'auroc': 0.8811245}
confusion matrix:
      0    1
0  8915  427
1   391  381
after epoch: 6,now: 2024-05-05 12:05:53.401551,epoch time: 0:15:47.305287,used: 1:38:37.019965,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.8000263, 'recall': 0.7734738, 'specificity': 0.7734738, 'f1': 0.78609383, 'auroc': 0.9467758}
confusion matrix:
       0    1
0  38635  340
1    427  534
---- Validation: 
scalar performance:
{'acc': 0.97637933, 'precision': 0.75010335, 'recall': 0.7164868, 'specificity': 0.7164868, 'f1': 0.73199224, 'auroc': 0.91386616}
confusion matrix:
       0    1
0  16557  174
1    231  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9002373, 'precision': 0.6959951, 'recall': 0.8289497, 'specificity': 0.8289497, 'f1': 0.73840624, 'auroc': 0.88744795}
confusion matrix:
      0    1
0  8530  812
1   197  575
early stop counter: 1
val acc:0.9763793349266052, best validation acc: 0.9773125052452087, corresponding to test acc:                         0.9191219806671143 / 0.9236701726913452
after epoch: 7,now: 2024-05-05 12:21:50.254047,epoch time: 0:15:56.852496,used: 1:54:33.872461,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9807692, 'precision': 0.857953, 'recall': 0.6567446, 'specificity': 0.6567446, 'f1': 0.7160383, 'auroc': 0.95219517}
confusion matrix:
       0    1
0  38864  111
1    657  304
---- Validation: 
scalar performance:
{'acc': 0.97795403, 'precision': 0.796815, 'recall': 0.6197741, 'specificity': 0.6197741, 'f1': 0.6685316, 'auroc': 0.9270747}
confusion matrix:
       0    1
0  16667   64
1    314  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9235713, 'precision': 0.7331186, 'recall': 0.777413, 'specificity': 0.777413, 'f1': 0.7527112, 'auroc': 0.89466226}
confusion matrix:
      0    1
0  8874  468
1   305  467
after epoch: 8,now: 2024-05-05 12:37:49.109390,epoch time: 0:15:58.855343,used: 2:10:32.727804,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.82505375, 'recall': 0.7576535, 'specificity': 0.7576535, 'f1': 0.7872138, 'auroc': 0.9538334}
confusion matrix:
       0    1
0  38720  256
1    459  501
---- Validation: 
scalar performance:
{'acc': 0.9765543, 'precision': 0.7526877, 'recall': 0.69895244, 'specificity': 0.69895244, 'f1': 0.7223877, 'auroc': 0.923058}
confusion matrix:
       0    1
0  16575  156
1    246  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9177378, 'precision': 0.716369, 'recall': 0.761184, 'specificity': 0.761184, 'f1': 0.7359413, 'auroc': 0.8789581}
confusion matrix:
      0    1
0  8837  505
1   327  445
early stop counter: 1
val acc:0.976554274559021, best validation acc: 0.9779540300369263, corresponding to test acc:                         0.9235712885856628 / 0.9236701726913452
after epoch: 9,now: 2024-05-05 12:53:41.208491,epoch time: 0:15:52.099101,used: 2:26:24.826905,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.982522, 'precision': 0.8227769, 'recall': 0.78400075, 'specificity': 0.78400075, 'f1': 0.80207056, 'auroc': 0.95794785}
confusion matrix:
       0    1
0  38685  290
1    408  553
---- Validation: 
scalar performance:
{'acc': 0.97725415, 'precision': 0.7620969, 'recall': 0.7063607, 'specificity': 0.7063607, 'f1': 0.7306746, 'auroc': 0.9256806}
confusion matrix:
       0    1
0  16581  150
1    240  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9159581, 'precision': 0.711608, 'recall': 0.757844, 'specificity': 0.757844, 'f1': 0.731641, 'auroc': 0.88396204}
confusion matrix:
      0    1
0  8823  519
1   331  441
early stop counter: 2
val acc:0.9772541522979736, best validation acc: 0.9779540300369263, corresponding to test acc:                         0.9235712885856628 / 0.9236701726913452
after epoch: 10,now: 2024-05-05 13:09:39.724088,epoch time: 0:15:58.515597,used: 2:42:23.342502,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9822716, 'precision': 0.8189304, 'recall': 0.7838725, 'specificity': 0.7838725, 'f1': 0.80031604, 'auroc': 0.95744723}
confusion matrix:
       0    1
0  38675  300
1    408  553
---- Validation: 
scalar performance:
{'acc': 0.9760877, 'precision': 0.74657166, 'recall': 0.71751237, 'specificity': 0.71751237, 'f1': 0.73106223, 'auroc': 0.9159556}
confusion matrix:
       0    1
0  16551  180
1    230  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92011076, 'precision': 0.71963716, 'recall': 0.7392968, 'specificity': 0.7392968, 'f1': 0.72890615, 'auroc': 0.86273766}
confusion matrix:
      0    1
0  8900  442
1   366  406
early stop counter: 3
val acc:0.9760876893997192, best validation acc: 0.9779540300369263, corresponding to test acc:                         0.9235712885856628 / 0.9236701726913452
after epoch: 11,now: 2024-05-05 13:25:45.911148,epoch time: 0:16:06.187060,used: 2:58:29.529562,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97661257, 'precision': 0.812857, 'recall': 0.53028667, 'specificity': 0.53028667, 'f1': 0.55015874, 'auroc': 0.9480138}
confusion matrix:
       0   1
0  38943  32
1    902  59
---- Validation: 
scalar performance:
{'acc': 0.97597104, 'precision': 0.757715, 'recall': 0.5247633, 'specificity': 0.5247633, 'f1': 0.5401677, 'auroc': 0.9162129}
confusion matrix:
       0   1
0  16713  18
1    394  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92653745, 'precision': 0.96316314, 'recall': 0.5187824, 'specificity': 0.5187824, 'f1': 0.51708186, 'auroc': 0.8690153}
confusion matrix:
      0   1
0  9342   0
1   743  29
new oracle model saved
early stop counter: 4
val acc:0.9759710431098938, best validation acc: 0.9779540300369263, corresponding to test acc:                         0.9235712885856628 / 0.9265374541282654
after epoch: 12,now: 2024-05-05 13:41:28.370449,epoch time: 0:15:42.459301,used: 3:14:11.988863,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9810948, 'precision': 0.8191376, 'recall': 0.7274487, 'specificity': 0.7274487, 'f1': 0.7651319, 'auroc': 0.95604926}
confusion matrix:
       0    1
0  38738  237
1    518  443
---- Validation: 
scalar performance:
{'acc': 0.97678757, 'precision': 0.7579221, 'recall': 0.6661738, 'specificity': 0.6661738, 'f1': 0.70143247, 'auroc': 0.91204965}
confusion matrix:
       0    1
0  16607  124
1    274  141
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9137829, 'precision': 0.67216927, 'recall': 0.61823034, 'specificity': 0.61823034, 'f1': 0.6384706, 'auroc': 0.86569035}
confusion matrix:
      0    1
0  9034  308
1   564  208
early stop counter: 5
val acc:0.9767875671386719, best validation acc: 0.9779540300369263, corresponding to test acc:                         0.9235712885856628 / 0.9265374541282654
after epoch: 13,now: 2024-05-05 13:56:47.770186,epoch time: 0:15:19.399737,used: 3:29:31.388600,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.982497, 'precision': 0.81912726, 'recall': 0.79413724, 'specificity': 0.79413724, 'f1': 0.8060899, 'auroc': 0.9588835}
confusion matrix:
       0    1
0  38664  311
1    388  573
---- Validation: 
scalar performance:
{'acc': 0.97678757, 'precision': 0.755355, 'recall': 0.71317124, 'specificity': 0.71317124, 'f1': 0.7322233, 'auroc': 0.91612124}
confusion matrix:
       0    1
0  16567  164
1    234  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9154637, 'precision': 0.70935, 'recall': 0.75104076, 'specificity': 0.75104076, 'f1': 0.72763693, 'auroc': 0.89018524}
confusion matrix:
      0    1
0  8829  513
1   342  430
early stop counter: 6
val acc:0.9767875671386719, best validation acc: 0.9779540300369263, corresponding to test acc:                         0.9235712885856628 / 0.9265374541282654
after epoch: 14,now: 2024-05-05 14:12:21.755411,epoch time: 0:15:33.985225,used: 3:45:05.373825,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97836536, 'precision': 0.79332554, 'recall': 0.64434886, 'specificity': 0.64434886, 'f1': 0.6919719, 'auroc': 0.9593438}
confusion matrix:
       0    1
0  38790  185
1    679  282
---- Validation: 
scalar performance:
{'acc': 0.97597104, 'precision': 0.7445047, 'recall': 0.618758, 'specificity': 0.618758, 'f1': 0.65837836, 'auroc': 0.9110359}
confusion matrix:
       0    1
0  16633   98
1    314  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92268145, 'precision': 0.53330976, 'recall': 0.5006531, 'specificity': 0.5006531, 'f1': 0.4824334, 'auroc': 0.8265593}
confusion matrix:
      0   1
0  9330  12
1   770   2
early stop counter: 7
val acc:0.9759710431098938, best validation acc: 0.9779540300369263, corresponding to test acc:                         0.9235712885856628 / 0.9265374541282654
after epoch: 15,now: 2024-05-05 14:28:04.217927,epoch time: 0:15:42.462516,used: 4:00:47.836341,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9816206, 'precision': 0.7972405, 'recall': 0.8429121, 'specificity': 0.8429121, 'f1': 0.8183299, 'auroc': 0.9638382}
confusion matrix:
       0    1
0  38532  443
1    291  670
---- Validation: 
scalar performance:
{'acc': 0.97334653, 'precision': 0.71980876, 'recall': 0.7337318, 'specificity': 0.7337318, 'f1': 0.72653806, 'auroc': 0.9196892}
confusion matrix:
       0    1
0  16489  242
1    215  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9186276, 'precision': 0.64396954, 'recall': 0.5358899, 'specificity': 0.5358899, 'f1': 0.54685676, 'auroc': 0.7806699}
confusion matrix:
      0    1
0  9226  116
1   707   65
early stop counter: 8
val acc:0.9733465313911438, best validation acc: 0.9779540300369263, corresponding to test acc:                         0.9235712885856628 / 0.9265374541282654
after epoch: 16,now: 2024-05-05 14:43:46.959096,epoch time: 0:15:42.741169,used: 4:16:30.577510,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9804938, 'precision': 0.7837629, 'recall': 0.8579254, 'specificity': 0.8579254, 'f1': 0.81623495, 'auroc': 0.9659964}
confusion matrix:
       0    1
0  38457  519
1    260  700
---- Validation: 
scalar performance:
{'acc': 0.97258836, 'precision': 0.71608174, 'recall': 0.7544921, 'specificity': 0.7544921, 'f1': 0.7335792, 'auroc': 0.9153528}
confusion matrix:
       0    1
0  16458  273
1    197  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8976666, 'precision': 0.67212045, 'recall': 0.7402185, 'specificity': 0.7402185, 'f1': 0.6981137, 'auroc': 0.86953187}
confusion matrix:
      0    1
0  8651  691
1   344  428
early stop counter: 9
val acc:0.9725883603096008, best validation acc: 0.9779540300369263, corresponding to test acc:                         0.9235712885856628 / 0.9265374541282654
after epoch: 17,now: 2024-05-05 14:59:19.756764,epoch time: 0:15:32.797668,used: 4:32:03.375178,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9830228, 'precision': 0.82191086, 'recall': 0.810138, 'specificity': 0.810138, 'f1': 0.8159076, 'auroc': 0.967412}
confusion matrix:
       0    1
0  38654  321
1    357  604
---- Validation: 
scalar performance:
{'acc': 0.9750962, 'precision': 0.7350027, 'recall': 0.7123046, 'specificity': 0.7123046, 'f1': 0.72303176, 'auroc': 0.919917}
confusion matrix:
       0    1
0  16538  193
1    234  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9209017, 'precision': 0.66895306, 'recall': 0.53593266, 'specificity': 0.53593266, 'f1': 0.5473113, 'auroc': 0.77635014}
confusion matrix:
      0   1
0  9251  91
1   709  63
early stop counter: 10
val acc:0.9750962257385254, best validation acc: 0.9779540300369263, corresponding to test acc:                         0.9235712885856628 / 0.9265374541282654
after epoch: 18,now: 2024-05-05 15:15:27.238730,epoch time: 0:16:07.481966,used: 4:48:10.857144,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
early stop trigger
Experiment finished at epoch: 18 with time: 4:48:10.857144 at 2024-05-05 15:15:27.238730
[Errno 2] No such file or directory: 'zoutput/saved_models/dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_05_10_27_16_seed_0_20364222.model'
this error can occur if model selection criteria                            is worsening, model never get persisted,                            no performance metric is reported
