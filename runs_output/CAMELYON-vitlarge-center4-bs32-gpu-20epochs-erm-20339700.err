Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)



no algorithm conf specified, going to use default



/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/arg_parser.py:355: UserWarning: no algorithm conf specified, going to use default
  warnings.warn("no algorithm conf specified, going to use default")

patient_073_node_1_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_015_node_2_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_017_node_1_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_099_node_4_0:   0%|          | 0/114 [00:00<?, ?it/s][A
                                                             [A
patient_004_node_4_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_024_node_1_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_016_node_1_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_038_node_2_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_086_node_4_0:   0%|          | 0/176 [00:00<?, ?it/s][A
                                                             [A
patient_020_node_4_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_064_node_0_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_021_node_3_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_009_node_1_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_081_node_4_0:   0%|          | 0/110 [00:00<?, ?it/s][A
                                                             [A
patient_096_node_0_0:   0%|          | 0/165 [00:00<?, ?it/s][A
                                                             [A
patient_017_node_4_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_061_node_4_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_051_node_2_0:   0%|          | 0/144 [00:00<?, ?it/s][A
                                                             [A
patient_045_node_1_0:   0%|          | 0/116 [00:00<?, ?it/s][A
                                                             [A
patient_092_node_1_0:   0%|          | 0/180 [00:00<?, ?it/s][A
                                                             [A
patient_052_node_1_0:   0%|          | 0/124 [00:00<?, ?it/s][A
                                                             [A
patient_086_node_0_0:   0%|          | 0/141 [00:00<?, ?it/s][A
                                                             [A
patient_040_node_2_0:   0%|          | 0/172 [00:00<?, ?it/s][A
patient_040_node_2_0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 172/172 [00:00<00:00, 286.60it/s][A
                                                                        [A
patient_012_node_0_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_072_node_0_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_034_node_3_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_015_node_1_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_062_node_2_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_066_node_2_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_068_node_1_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_042_node_3_0:   0%|          | 0/136 [00:00<?, ?it/s][A
                                                             [A
patient_036_node_3_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_060_node_3_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_010_node_4_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_075_node_4_0:   0%|          | 0/95 [00:00<?, ?it/s][A
                                                            [A
patient_067_node_4_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_017_node_2_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_024_node_2_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_087_node_0_0:   0%|          | 0/172 [00:00<?, ?it/s][A
                                                             [A
patient_039_node_1_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_088_node_1_0:   0%|          | 0/140 [00:00<?, ?it/s][A
                                                             [A
patient_046_node_3_0:   0%|          | 0/128 [00:00<?, ?it/s][A
                                                             [A
patient_046_node_4_0:   0%|          | 0/64 [00:00<?, ?it/s][A
                                                            [A
patient_044_node_4_0:   0%|          | 0/56 [00:00<?, ?it/s][A
                                                            [A
patient_048_node_1_0:   0%|          | 0/140 [00:00<?, ?it/s][A
                                                             [A
patient_089_node_3_0:   0%|          | 0/149 [00:00<?, ?it/s][A
                                                             [A
patient_020_node_2_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
patient_080_node_1_0:   0%|          | 0/163 [00:00<?, ?it/s][A
                                                             [A
patient_041_node_0_0:   0%|          | 0/144 [00:00<?, ?it/s][A
                                                             [A
patient_022_node_4_0:   0%|          | 0/93 [00:00<?, ?it/s][A
                                                            [A
overriding args.task None to dset


using device: cuda

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'b976d8c0'
model name: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700

 Experiment start at: 2024-05-04 16:50:00.143497
before training, model accuracy: 0.9192509651184082
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97566104, 'precision': 0.74944395, 'recall': 0.5115375, 'specificity': 0.5115375, 'f1': 0.51643, 'auroc': 0.9425719}
confusion matrix:
       0   1
0  38941  21
1    951  23
---- Validation: 
scalar performance:
{'acc': 0.97702223, 'precision': 0.8296098, 'recall': 0.5184477, 'specificity': 0.5184477, 'f1': 0.529561, 'auroc': 0.9516631}
confusion matrix:
       0   1
0  16738   7
1    387  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92529476, 'precision': 0.90710807, 'recall': 0.50520265, 'specificity': 0.50520265, 'f1': 0.4909726, 'auroc': 0.80415344}
confusion matrix:
      0  1
0  9331  1
1   753  8
new oracle model saved
after epoch: 1,now: 2024-05-04 18:17:57.883240,epoch time: 1:27:57.739743,used: 1:27:57.739743,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97911656, 'precision': 0.868068, 'recall': 0.605403, 'specificity': 0.605403, 'f1': 0.6605617, 'auroc': 0.9685725}
confusion matrix:
       0    1
0  38895   67
1    767  207
---- Validation: 
scalar performance:
{'acc': 0.9787718, 'precision': 0.84121215, 'recall': 0.58125347, 'specificity': 0.58125347, 'f1': 0.6276796, 'auroc': 0.9635223}
confusion matrix:
       0   1
0  16717  28
1    336  66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9247994, 'precision': 0.9623922, 'recall': 0.50131404, 'specificity': 0.50131404, 'f1': 0.48308256, 'auroc': 0.8766788}
confusion matrix:
      0  1
0  9332  0
1   759  2
after epoch: 2,now: 2024-05-04 19:47:01.361455,epoch time: 1:29:03.478215,used: 2:57:01.217958,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97566104, 'precision': 0.48783052, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938403, 'auroc': 0.9845457}
confusion matrix:
       0  1
0  38964  0
1    972  0
---- Validation: 
scalar performance:
{'acc': 0.97655565, 'precision': 0.48827782, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4940694, 'auroc': 0.9696901}
confusion matrix:
       0  1
0  16745  0
1    402  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9246012, 'precision': 0.4623006, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48041183, 'auroc': 0.92514443}
confusion matrix:
      0  1
0  9332  0
1   761  0
early stop counter: 1
val acc:0.9765556454658508, best validation acc: 0.9787718057632446, corresponding to test acc:                         0.924799382686615 / 0.9252947568893433
after epoch: 3,now: 2024-05-04 21:06:03.776353,epoch time: 1:19:02.414898,used: 4:16:03.632856,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9842498, 'precision': 0.81212735, 'recall': 0.9293638, 'specificity': 0.9293638, 'f1': 0.86079174, 'auroc': 0.9856285}
confusion matrix:
       0    1
0  38458  504
1    125  849
---- Validation: 
scalar performance:
{'acc': 0.97987986, 'precision': 0.7735863, 'recall': 0.8585949, 'specificity': 0.8585949, 'f1': 0.80994177, 'auroc': 0.96853197}
confusion matrix:
       0    1
0  16508  237
1    108  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92450213, 'precision': 0.7096409, 'recall': 0.5186534, 'specificity': 0.5186534, 'f1': 0.5179436, 'auroc': 0.91781616}
confusion matrix:
      0   1
0  9300  32
1   730  31
after epoch: 4,now: 2024-05-04 22:38:09.140594,epoch time: 1:32:05.364241,used: 5:48:08.997097,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98938304, 'precision': 0.8577564, 'recall': 0.9615249, 'specificity': 0.9615249, 'f1': 0.90262634, 'auroc': 0.99396616}
confusion matrix:
       0    1
0  38604  358
1     66  908
---- Validation: 
scalar performance:
{'acc': 0.9800548, 'precision': 0.7760688, 'recall': 0.8453313, 'specificity': 0.8453313, 'f1': 0.8065521, 'auroc': 0.96721536}
confusion matrix:
       0    1
0  16522  223
1    119  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9229169, 'precision': 0.6224453, 'recall': 0.5081409, 'specificity': 0.5081409, 'f1': 0.49849007, 'auroc': 0.8854243}
confusion matrix:
      0   1
0  9300  32
1   746  15
better model found, saving less frequently
model persisted
after epoch: 5,now: 2024-05-05 00:05:10.792911,epoch time: 1:27:01.652317,used: 7:15:10.649414,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98710436, 'precision': 0.9508275, 'recall': 0.75965095, 'specificity': 0.75965095, 'f1': 0.8283024, 'auroc': 0.9957008}
confusion matrix:
       0    1
0  38914   48
1    467  507
---- Validation: 
scalar performance:
{'acc': 0.98104626, 'precision': 0.8706936, 'recall': 0.6394723, 'specificity': 0.6394723, 'f1': 0.7002659, 'auroc': 0.95742005}
confusion matrix:
       0    1
0  16709   36
1    289  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9246012, 'precision': 0.7123848, 'recall': 0.5012069, 'specificity': 0.5012069, 'f1': 0.48302218, 'auroc': 0.8944754}
confusion matrix:
      0  1
0  9330  2
1   759  2
after epoch: 6,now: 2024-05-05 01:22:15.031741,epoch time: 1:17:04.238830,used: 8:32:14.888244,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99013424, 'precision': 0.94563115, 'recall': 0.8342788, 'specificity': 0.8342788, 'f1': 0.8815975, 'auroc': 0.9968511}
confusion matrix:
       0    1
0  38889   73
1    321  653
---- Validation: 
scalar performance:
{'acc': 0.98087126, 'precision': 0.83379424, 'recall': 0.6697308, 'specificity': 0.6697308, 'f1': 0.7236089, 'auroc': 0.9582612}
confusion matrix:
       0    1
0  16681   64
1    264  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9246012, 'precision': 0.7124269, 'recall': 0.5018104, 'specificity': 0.5018104, 'f1': 0.48431712, 'auroc': 0.91147375}
confusion matrix:
      0  1
0  9329  3
1   758  3
early stop counter: 1
val acc:0.9808712601661682, best validation acc: 0.9810462594032288, corresponding to test acc:                         0.9246011972427368 / 0.9252947568893433
after epoch: 7,now: 2024-05-05 02:30:26.263914,epoch time: 1:08:11.232173,used: 9:40:26.120417,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98652846, 'precision': 0.99206066, 'recall': 0.7243198, 'specificity': 0.7243198, 'f1': 0.80606157, 'auroc': 0.9987174}
confusion matrix:
       0    1
0  38961    1
1    537  437
---- Validation: 
scalar performance:
{'acc': 0.9787718, 'precision': 0.9155123, 'recall': 0.55697507, 'specificity': 0.55697507, 'f1': 0.5954986, 'auroc': 0.9470842}
confusion matrix:
       0   1
0  16737   8
1    356  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9233132, 'precision': 0.60052043, 'recall': 0.5041311, 'specificity': 0.5041311, 'f1': 0.490174, 'auroc': 0.8997837}
confusion matrix:
      0   1
0  9311  21
1   753   8
early stop counter: 2
val acc:0.9787718057632446, best validation acc: 0.9810462594032288, corresponding to test acc:                         0.9246011972427368 / 0.9252947568893433
after epoch: 8,now: 2024-05-05 03:38:12.740115,epoch time: 1:07:46.476201,used: 10:48:12.596618,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99666965, 'precision': 0.9639025, 'recall': 0.9662266, 'specificity': 0.9662266, 'f1': 0.9650614, 'auroc': 0.9991816}
confusion matrix:
       0    1
0  38894   69
1     64  909
---- Validation: 
scalar performance:
{'acc': 0.9826209, 'precision': 0.8296485, 'recall': 0.7507454, 'specificity': 0.7507454, 'f1': 0.78451574, 'auroc': 0.9539051}
confusion matrix:
       0    1
0  16645  100
1    198  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9158823, 'precision': 0.6837349, 'recall': 0.63950986, 'specificity': 0.63950986, 'f1': 0.65759635, 'auroc': 0.90308636}
confusion matrix:
      0    1
0  9005  327
1   522  239
after epoch: 9,now: 2024-05-05 04:46:27.400842,epoch time: 1:08:14.660727,used: 11:56:27.257345,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99692005, 'precision': 0.95208526, 'recall': 0.9868976, 'specificity': 0.9868976, 'f1': 0.9688096, 'auroc': 0.99964964}
confusion matrix:
       0    1
0  38863  100
1     23  950
---- Validation: 
scalar performance:
{'acc': 0.9824459, 'precision': 0.81053185, 'recall': 0.7992127, 'specificity': 0.7992127, 'f1': 0.80476034, 'auroc': 0.9712823}
confusion matrix:
       0    1
0  16602  143
1    158  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92321414, 'precision': 0.6603187, 'recall': 0.5149396, 'specificity': 0.5149396, 'f1': 0.5114224, 'auroc': 0.8997824}
confusion matrix:
      0   1
0  9292  40
1   735  26
early stop counter: 1
val acc:0.9824458956718445, best validation acc: 0.982620894908905, corresponding to test acc:                         0.9158822894096375 / 0.9252947568893433
after epoch: 10,now: 2024-05-05 05:52:56.136154,epoch time: 1:06:28.735312,used: 13:02:55.992657,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9976462, 'precision': 0.98818207, 'recall': 0.96175563, 'specificity': 0.96175563, 'f1': 0.9745821, 'auroc': 0.99976265}
confusion matrix:
       0    1
0  38942   20
1     74  900
---- Validation: 
scalar performance:
{'acc': 0.9830874, 'precision': 0.8581281, 'recall': 0.7194223, 'specificity': 0.7194223, 'f1': 0.7712325, 'auroc': 0.9526438}
confusion matrix:
       0    1
0  16679   66
1    224  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9238086, 'precision': 0.6460681, 'recall': 0.5062094, 'specificity': 0.5062094, 'f1': 0.49408177, 'auroc': 0.9165379}
confusion matrix:
      0   1
0  9313  19
1   750  11
after epoch: 11,now: 2024-05-05 06:59:40.019443,epoch time: 1:06:43.883289,used: 14:09:39.875946,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9945413, 'precision': 0.9860817, 'recall': 0.8970996, 'specificity': 0.8970996, 'f1': 0.9368831, 'auroc': 0.9992609}
confusion matrix:
       0    1
0  38944   18
1    200  774
---- Validation: 
scalar performance:
{'acc': 0.98034644, 'precision': 0.8335286, 'recall': 0.64882535, 'specificity': 0.64882535, 'f1': 0.7039832, 'auroc': 0.9383657}
confusion matrix:
       0    1
0  16689   56
1    281  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92430395, 'precision': 0.4622894, 'recall': 0.49983928, 'specificity': 0.49983928, 'f1': 0.4803316, 'auroc': 0.9082791}
confusion matrix:
      0  1
0  9329  3
1   761  0
early stop counter: 1
val acc:0.9803464412689209, best validation acc: 0.983087420463562, corresponding to test acc:                         0.9238085746765137 / 0.9252947568893433
after epoch: 12,now: 2024-05-05 08:08:09.293938,epoch time: 1:08:29.274495,used: 15:18:09.150441,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99551785, 'precision': 0.9249941, 'recall': 0.9931983, 'specificity': 0.9931983, 'f1': 0.95641184, 'auroc': 0.9997628}
confusion matrix:
       0    1
0  38792  170
1      9  965
---- Validation: 
scalar performance:
{'acc': 0.9795299, 'precision': 0.77211154, 'recall': 0.8292816, 'specificity': 0.8292816, 'f1': 0.79777634, 'auroc': 0.95432615}
confusion matrix:
       0    1
0  16526  219
1    132  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91558504, 'precision': 0.6255262, 'recall': 0.54400384, 'specificity': 0.54400384, 'f1': 0.5576617, 'auroc': 0.8929433}
confusion matrix:
      0    1
0  9160  172
1   680   81
early stop counter: 2
val acc:0.9795299172401428, best validation acc: 0.983087420463562, corresponding to test acc:                         0.9238085746765137 / 0.9252947568893433
after epoch: 13,now: 2024-05-05 09:24:34.475017,epoch time: 1:16:25.181079,used: 16:34:34.331520,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99834734, 'precision': 0.98449934, 'recall': 0.9806145, 'specificity': 0.9806145, 'f1': 0.9825487, 'auroc': 0.9996745}
confusion matrix:
       0    1
0  38934   29
1     37  936
---- Validation: 
scalar performance:
{'acc': 0.9814545, 'precision': 0.81603664, 'recall': 0.7295115, 'specificity': 0.7295115, 'f1': 0.76549935, 'auroc': 0.9525742}
confusion matrix:
       0    1
0  16642  103
1    215  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210344, 'precision': 0.63763857, 'recall': 0.52281266, 'specificity': 0.52281266, 'f1': 0.5260037, 'auroc': 0.8912031}
confusion matrix:
      0   1
0  9255  77
1   720  41
early stop counter: 3
val acc:0.9814544916152954, best validation acc: 0.983087420463562, corresponding to test acc:                         0.9238085746765137 / 0.9252947568893433
after epoch: 14,now: 2024-05-05 10:35:26.875138,epoch time: 1:10:52.400121,used: 17:45:26.731641,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99894834, 'precision': 0.99234915, 'recall': 0.98544663, 'specificity': 0.98544663, 'f1': 0.9888722, 'auroc': 0.99992746}
confusion matrix:
       0    1
0  38948   14
1     28  946
---- Validation: 
scalar performance:
{'acc': 0.98326236, 'precision': 0.8462655, 'recall': 0.74379027, 'specificity': 0.74379027, 'f1': 0.7856281, 'auroc': 0.9607196}
confusion matrix:
       0    1
0  16662   83
1    204  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210344, 'precision': 0.63763857, 'recall': 0.52281266, 'specificity': 0.52281266, 'f1': 0.5260037, 'auroc': 0.91097754}
confusion matrix:
      0   1
0  9255  77
1   720  41
better model found, saving less frequently
model persisted
after epoch: 15,now: 2024-05-05 11:42:49.975685,epoch time: 1:07:23.100547,used: 18:52:49.832188,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9759866, 'precision': 0.98798877, 'recall': 0.5077002, 'specificity': 0.5077002, 'f1': 0.5090882, 'auroc': 0.9616333}
confusion matrix:
       0   1
0  38962   0
1    959  15
---- Validation: 
scalar performance:
{'acc': 0.97655565, 'precision': 0.48827782, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4940694, 'auroc': 0.904288}
confusion matrix:
       0  1
0  16745  0
1    402  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9246012, 'precision': 0.4623006, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48041183, 'auroc': 0.89334834}
confusion matrix:
      0  1
0  9332  0
1   761  0
early stop counter: 1
val acc:0.9765556454658508, best validation acc: 0.9832623600959778, corresponding to test acc:                         0.9210343956947327 / 0.9252947568893433
after epoch: 16,now: 2024-05-05 12:50:02.052204,epoch time: 1:07:12.076519,used: 20:00:01.908707,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97914165, 'precision': 0.8179398, 'recall': 0.65246415, 'specificity': 0.65246415, 'f1': 0.7044461, 'auroc': 0.9552236}
confusion matrix:
       0    1
0  38802  160
1    673  301
---- Validation: 
scalar performance:
{'acc': 0.97894675, 'precision': 0.80122334, 'recall': 0.6298999, 'specificity': 0.6298999, 'f1': 0.67963856, 'auroc': 0.93749917}
confusion matrix:
       0    1
0  16680   65
1    296  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92489845, 'precision': 0.79589784, 'recall': 0.50378144, 'specificity': 0.50378144, 'f1': 0.48827222, 'auroc': 0.8892099}
confusion matrix:
      0  1
0  9329  3
1   755  6
early stop counter: 2
val acc:0.9789467453956604, best validation acc: 0.9832623600959778, corresponding to test acc:                         0.9210343956947327 / 0.9252947568893433
after epoch: 17,now: 2024-05-05 13:57:14.074363,epoch time: 1:07:12.022159,used: 21:07:13.930866,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9944411, 'precision': 0.9725486, 'recall': 0.9069636, 'specificity': 0.9069636, 'f1': 0.9371843, 'auroc': 0.9975165}
confusion matrix:
       0    1
0  38921   42
1    180  793
---- Validation: 
scalar performance:
{'acc': 0.982096, 'precision': 0.8466188, 'recall': 0.6994919, 'specificity': 0.6994919, 'f1': 0.75217545, 'auroc': 0.9438866}
confusion matrix:
       0    1
0  16678   67
1    240  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92509663, 'precision': 0.740014, 'recall': 0.51595765, 'specificity': 0.51595765, 'f1': 0.51267153, 'auroc': 0.88146883}
confusion matrix:
      0   1
0  9311  21
1   735  26
early stop counter: 3
val acc:0.9820960164070129, best validation acc: 0.9832623600959778, corresponding to test acc:                         0.9210343956947327 / 0.9252947568893433
after epoch: 18,now: 2024-05-05 15:04:43.012420,epoch time: 1:07:28.938057,used: 22:14:42.868923,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9975711, 'precision': 0.95886713, 'recall': 0.99324954, 'specificity': 0.99324954, 'f1': 0.9754027, 'auroc': 0.9997804}
confusion matrix:
       0    1
0  38876   86
1     11  963
---- Validation: 
scalar performance:
{'acc': 0.9809296, 'precision': 0.79125994, 'recall': 0.79479456, 'specificity': 0.79479456, 'f1': 0.79301584, 'auroc': 0.95534456}
confusion matrix:
       0    1
0  16579  166
1    161  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91944915, 'precision': 0.62378895, 'recall': 0.5249726, 'specificity': 0.5249726, 'f1': 0.5297458, 'auroc': 0.88594127}
confusion matrix:
      0   1
0  9234  98
1   715  46
early stop counter: 4
val acc:0.9809296131134033, best validation acc: 0.9832623600959778, corresponding to test acc:                         0.9210343956947327 / 0.9252947568893433
after epoch: 19,now: 2024-05-05 16:12:28.190300,epoch time: 1:07:45.177880,used: 23:22:28.046803,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99296373, 'precision': 0.9943115, 'recall': 0.85725105, 'specificity': 0.85725105, 'f1': 0.9142224, 'auroc': 0.9997742}
confusion matrix:
       0    1
0  38959    3
1    278  696
---- Validation: 
scalar performance:
{'acc': 0.97923833, 'precision': 0.84892535, 'recall': 0.59363157, 'specificity': 0.59363157, 'f1': 0.64433783, 'auroc': 0.9429059}
confusion matrix:
       0   1
0  16715  30
1    326  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92450213, 'precision': 0.6846875, 'recall': 0.5023602, 'specificity': 0.5023602, 'f1': 0.4855718, 'auroc': 0.89754736}
confusion matrix:
      0  1
0  9327  5
1   757  4
early stop counter: 5
val acc:0.9792383313179016, best validation acc: 0.9832623600959778, corresponding to test acc:                         0.9210343956947327 / 0.9252947568893433
after epoch: 20,now: 2024-05-05 17:20:28.181083,epoch time: 1:07:59.990783,used: 1 day, 0:30:28.037586,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
Experiment finished at epoch: 20 with time: 1 day, 0:30:28.037586 at 2024-05-05 17:20:28.181083
persisted model performance metric: 

scalar performance:
{'acc': 0.9210344, 'precision': 0.63763857, 'recall': 0.52281266, 'specificity': 0.52281266, 'f1': 0.5260037, 'auroc': 0.91097754}
confusion matrix:
      0   1
0  9255  77
1   720  41
oracle model performance metric: 

scalar performance:
{'acc': 0.92529476, 'precision': 0.90710807, 'recall': 0.50520265, 'specificity': 0.50520265, 'f1': 0.4909726, 'auroc': 0.80415344}
confusion matrix:
      0  1
0  9331  1
1   753  8
results aggregation path: zoutput/aggrsts/dset_te_center4_exptag.csv
confusion matrix saved in file: zoutput/aggrsts/dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_50_00_seed_0_20339700_conf_mat.png
