Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)



no algorithm conf specified, going to use default



/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/arg_parser.py:365: UserWarning: no algorithm conf specified, going to use default
  warnings.warn("no algorithm conf specified, going to use default")

overriding args.task None to dset


using device: cuda

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'e948af6'
model name: dset_te_center4_dann_be948af6_not_commited_2024md_05md_22_17_42_52_seed_0_20739712

 Experiment start at: 2024-05-22 17:42:52.964417
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.48796794, 'recall': 0.49998719, 'specificity': 0.49998719, 'f1': 0.49390444, 'auroc': 0.8964501, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99997437, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  38974  1
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.8913008, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.8586647, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20739712.png
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-05-22 18:45:02.055913,epoch time: 1:02:09.091496,used: 1:02:09.091496,model: dset_te_center4_dann_be948af6_not_commited_2024md_05md_22_17_42_52_seed_0_20739712
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97596157, 'precision': 0.9879805, 'recall': 0.5005203, 'specificity': 0.5005203, 'f1': 0.4949566, 'auroc': 0.9233013, 'binary_precision': 1.0, 'binary_recall': 0.0010405828, 'binary_specificity': 1.0, 'binary_f1_score': 0.002079002}
confusion matrix:
       0  1
0  38975  0
1    960  1
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9193538, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.90142095, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20739712.png
early stop counter: 1
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 2,now: 2024-05-22 19:45:07.066049,epoch time: 1:00:05.010136,used: 2:02:14.101632,model: dset_te_center4_dann_be948af6_not_commited_2024md_05md_22_17_42_52_seed_0_20739712
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97596157, 'precision': 0.48798078, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4939173, 'auroc': 0.9352597, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  38976  0
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9297207, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.91779184, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20739712.png
early stop counter: 2
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 3,now: 2024-05-22 20:33:15.523533,epoch time: 0:48:08.457484,used: 2:50:22.559116,model: dset_te_center4_dann_be948af6_not_commited_2024md_05md_22_17_42_52_seed_0_20739712
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9759866, 'precision': 0.98799264, 'recall': 0.5010406, 'specificity': 0.5010406, 'f1': 0.49600023, 'auroc': 0.94104487, 'binary_precision': 1.0, 'binary_recall': 0.0020811656, 'binary_specificity': 1.0, 'binary_f1_score': 0.0041536866}
confusion matrix:
       0  1
0  38975  0
1    959  2
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9382101, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.9120685, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20739712.png
early stop counter: 3
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 4,now: 2024-05-22 21:23:27.318399,epoch time: 0:50:11.794866,used: 3:40:34.353982,model: dset_te_center4_dann_be948af6_not_commited_2024md_05md_22_17_42_52_seed_0_20739712
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.9479136, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.94471246, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.91112304, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20739712.png
early stop counter: 4
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 5,now: 2024-05-22 22:13:54.613104,epoch time: 0:50:27.294705,used: 4:31:01.648687,model: dset_te_center4_dann_be948af6_not_commited_2024md_05md_22_17_42_52_seed_0_20739712
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.9547502, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9490137, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.91212803, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20739712.png
early stop counter: 5
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 6,now: 2024-05-22 23:07:41.270972,epoch time: 0:53:46.657868,used: 5:24:48.306555,model: dset_te_center4_dann_be948af6_not_commited_2024md_05md_22_17_42_52_seed_0_20739712
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.95448613, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.95155805, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.9172735, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20739712.png
early stop counter: 6
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 7,now: 2024-05-23 00:01:03.002616,epoch time: 0:53:21.731644,used: 6:18:10.038199,model: dset_te_center4_dann_be948af6_not_commited_2024md_05md_22_17_42_52_seed_0_20739712
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97596157, 'precision': 0.48798078, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4939173, 'auroc': 0.960629, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  38976  0
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.95487833, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9235713, 'precision': 0.4618313, 'recall': 0.49994648, 'specificity': 0.49994648, 'f1': 0.48013362, 'auroc': 0.91425467, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99989295, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9341  1
1   772  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20739712.png
early stop counter: 7
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 8,now: 2024-05-23 00:55:35.651266,epoch time: 0:54:32.648650,used: 7:12:42.686849,model: dset_te_center4_dann_be948af6_not_commited_2024md_05md_22_17_42_52_seed_0_20739712
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97596157, 'precision': 0.9879805, 'recall': 0.5005203, 'specificity': 0.5005203, 'f1': 0.4949566, 'auroc': 0.9618463, 'binary_precision': 1.0, 'binary_recall': 0.0010405828, 'binary_specificity': 1.0, 'binary_f1_score': 0.002079002}
confusion matrix:
       0  1
0  38975  0
1    960  1
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9570206, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.9135018, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20739712.png
early stop counter: 8
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 9,now: 2024-05-23 01:49:41.106044,epoch time: 0:54:05.454778,used: 8:06:48.141627,model: dset_te_center4_dann_be948af6_not_commited_2024md_05md_22_17_42_52_seed_0_20739712
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97596157, 'precision': 0.48798078, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4939173, 'auroc': 0.96317756, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  38976  0
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.95924807, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9235713, 'precision': 0.4618313, 'recall': 0.49994648, 'specificity': 0.49994648, 'f1': 0.48013362, 'auroc': 0.9130261, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99989295, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9341  1
1   772  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20739712.png
early stop counter: 9
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 10,now: 2024-05-23 02:43:36.696457,epoch time: 0:53:55.590413,used: 9:00:43.732040,model: dset_te_center4_dann_be948af6_not_commited_2024md_05md_22_17_42_52_seed_0_20739712
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97596157, 'precision': 0.9879805, 'recall': 0.5005203, 'specificity': 0.5005203, 'f1': 0.4949566, 'auroc': 0.9649658, 'binary_precision': 1.0, 'binary_recall': 0.0010405828, 'binary_specificity': 1.0, 'binary_f1_score': 0.002079002}
confusion matrix:
       0  1
0  38975  0
1    960  1
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.95953095, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.9131371, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
t-SNE plot saved as zoutput/tsne/t-SNE_Test_center4_20739712.png
early stop counter: 10
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 11,now: 2024-05-23 03:39:09.814787,epoch time: 0:55:33.118330,used: 9:56:16.850370,model: dset_te_center4_dann_be948af6_not_commited_2024md_05md_22_17_42_52_seed_0_20739712
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis
early stop trigger
Experiment finished at epoch: 11 with time: 9:56:16.850370 at 2024-05-23 03:39:09.814787
persisted model performance metric: 

scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.855382, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.85397416, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  9342  0
1   772  0
results aggregation path: zoutput/aggrsts/dset_te_center4_exptag.csv
results aggregation path: zoutput/aggrsts/dset_te_center4_exptag.csv
confusion matrix saved in file: zoutput/aggrsts/dset_te_center4_dann_be948af6_not_commited_2024md_05md_22_17_42_52_seed_0_20739712_conf_mat.png
