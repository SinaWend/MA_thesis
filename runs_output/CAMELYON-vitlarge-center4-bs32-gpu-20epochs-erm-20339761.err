Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)



no algorithm conf specified, going to use default



/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/arg_parser.py:355: UserWarning: no algorithm conf specified, going to use default
  warnings.warn("no algorithm conf specified, going to use default")

overriding args.task None to dset


using device: cuda

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/lustre/groups/aih/sina.wendrich/MA_code/test/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'b976d8c0'
model name: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761

 Experiment start at: 2024-05-04 16:49:38.688410
before training, model accuracy: 0.9185287952423096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9798678, 'precision': 0.7772348, 'recall': 0.8682728, 'specificity': 0.8682728, 'f1': 0.8158364, 'auroc': 0.9701805}
confusion matrix:
       0    1
0  38411  565
1    239  721
---- Validation: 
scalar performance:
{'acc': 0.9762627, 'precision': 0.74970806, 'recall': 0.83979523, 'specificity': 0.83979523, 'f1': 0.78729117, 'auroc': 0.9594423}
confusion matrix:
       0    1
0  16450  281
1    126  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9137829, 'precision': 0.6602033, 'recall': 0.59208786, 'specificity': 0.59208786, 'f1': 0.6137531, 'auroc': 0.9179968}
confusion matrix:
      0    1
0  9078  264
1   608  164
new oracle model saved
after epoch: 1,now: 2024-05-04 18:18:59.785707,epoch time: 1:29:21.097297,used: 1:29:21.097297,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.95720047}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9459408}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.9191011}
confusion matrix:
      0  1
0  9342  0
1   772  0
new oracle model saved
early stop counter: 1
val acc:0.975796103477478, best validation acc: 0.9762626886367798, corresponding to test acc:                         0.9137828946113586 / 0.9236701726913452
after epoch: 2,now: 2024-05-04 19:46:24.576220,epoch time: 1:27:24.790513,used: 2:56:45.887810,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9694511, 'precision': 0.69363284, 'recall': 0.75599074, 'specificity': 0.75599074, 'f1': 0.7200637, 'auroc': 0.96521753}
confusion matrix:
       0    1
0  38205  770
1    450  511
---- Validation: 
scalar performance:
{'acc': 0.96383995, 'precision': 0.65592796, 'recall': 0.71828616, 'specificity': 0.71828616, 'f1': 0.68130666, 'auroc': 0.94811374}
confusion matrix:
       0    1
0  16335  396
1    224  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8638521, 'precision': 0.658241, 'recall': 0.8336137, 'specificity': 0.8336137, 'f1': 0.69702864, 'auroc': 0.88962495}
confusion matrix:
      0     1
0  8121  1221
1   156   616
early stop counter: 2
val acc:0.9638399481773376, best validation acc: 0.9762626886367798, corresponding to test acc:                         0.9137828946113586 / 0.9236701726913452
after epoch: 3,now: 2024-05-04 21:04:46.515275,epoch time: 1:18:21.939055,used: 4:15:07.826865,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9842498, 'precision': 0.80859244, 'recall': 0.9369493, 'specificity': 0.9369493, 'f1': 0.8609077, 'auroc': 0.9855633}
confusion matrix:
       0    1
0  38457  521
1    108  850
---- Validation: 
scalar performance:
{'acc': 0.9780707, 'precision': 0.76350343, 'recall': 0.87009495, 'specificity': 0.87009495, 'f1': 0.80710137, 'auroc': 0.9624323}
confusion matrix:
       0    1
0  16456  275
1    101  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90834486, 'precision': 0.6225321, 'recall': 0.5677549, 'specificity': 0.5677549, 'f1': 0.58386236, 'auroc': 0.89025027}
confusion matrix:
      0    1
0  9059  283
1   644  128
after epoch: 4,now: 2024-05-04 22:34:46.967714,epoch time: 1:30:00.452439,used: 5:45:08.279304,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98920774, 'precision': 0.9408809, 'recall': 0.8133067, 'specificity': 0.8133067, 'f1': 0.86576277, 'auroc': 0.9927231}
confusion matrix:
       0    1
0  38901   74
1    357  604
---- Validation: 
scalar performance:
{'acc': 0.98157007, 'precision': 0.85066, 'recall': 0.69564784, 'specificity': 0.69564784, 'f1': 0.7499627, 'auroc': 0.9690105}
confusion matrix:
       0    1
0  16666   65
1    251  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9234724, 'precision': 0.6703705, 'recall': 0.5028637, 'specificity': 0.5028637, 'f1': 0.48647425, 'auroc': 0.8539469}
confusion matrix:
      0  1
0  9335  7
1   767  5
better model found, saving less frequently
model persisted
after epoch: 5,now: 2024-05-05 00:02:41.868734,epoch time: 1:27:54.901020,used: 7:13:03.180324,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98071915, 'precision': 0.9050088, 'recall': 0.62474877, 'specificity': 0.62474877, 'f1': 0.68759507, 'auroc': 0.98603874}
confusion matrix:
       0    1
0  38925   50
1    720  241
---- Validation: 
scalar performance:
{'acc': 0.97585446, 'precision': 0.7418436, 'recall': 0.5576017, 'specificity': 0.5576017, 'f1': 0.58957523, 'auroc': 0.9415193}
confusion matrix:
       0   1
0  16683  48
1    366  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.8032783}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 1
val acc:0.9758544564247131, best validation acc: 0.9815700650215149, corresponding to test acc:                         0.9234724044799805 / 0.9236701726913452
after epoch: 6,now: 2024-05-05 01:19:03.457328,epoch time: 1:16:21.588594,used: 8:29:24.768918,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99010915, 'precision': 0.8638797, 'recall': 0.96397746, 'specificity': 0.96397746, 'f1': 0.9074802, 'auroc': 0.9969462}
confusion matrix:
       0    1
0  38641  334
1     61  900
---- Validation: 
scalar performance:
{'acc': 0.9791205, 'precision': 0.77470124, 'recall': 0.82481045, 'specificity': 0.82481045, 'f1': 0.7975016, 'auroc': 0.95958424}
confusion matrix:
       0    1
0  16513  218
1    140  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9219893, 'precision': 0.66553897, 'recall': 0.52047944, 'specificity': 0.52047944, 'f1': 0.5214421, 'auroc': 0.8508999}
confusion matrix:
      0   1
0  9289  53
1   736  36
early stop counter: 2
val acc:0.9791204929351807, best validation acc: 0.9815700650215149, corresponding to test acc:                         0.9234724044799805 / 0.9236701726913452
after epoch: 7,now: 2024-05-05 02:27:07.861576,epoch time: 1:08:04.404248,used: 9:37:29.173166,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9019477, 'recall': 0.9043976, 'specificity': 0.9043976, 'f1': 0.9031687, 'auroc': 0.9953959}
confusion matrix:
       0    1
0  38791  185
1    179  781
---- Validation: 
scalar performance:
{'acc': 0.98075354, 'precision': 0.8046765, 'recall': 0.75867593, 'specificity': 0.75867593, 'f1': 0.77967376, 'auroc': 0.9578178}
confusion matrix:
       0    1
0  16598  133
1    197  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9223848, 'precision': 0.6193911, 'recall': 0.5058398, 'specificity': 0.5058398, 'f1': 0.49342063, 'auroc': 0.8805755}
confusion matrix:
      0   1
0  9318  24
1   761  11
early stop counter: 3
val acc:0.9807535409927368, best validation acc: 0.9815700650215149, corresponding to test acc:                         0.9234724044799805 / 0.9236701726913452
after epoch: 8,now: 2024-05-05 03:36:46.891644,epoch time: 1:09:39.030068,used: 10:47:08.203234,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9945413, 'precision': 0.9841083, 'recall': 0.8972332, 'specificity': 0.8972332, 'f1': 0.9361764, 'auroc': 0.99909997}
confusion matrix:
       0    1
0  38954   21
1    197  764
---- Validation: 
scalar performance:
{'acc': 0.98081183, 'precision': 0.84174025, 'recall': 0.67998517, 'specificity': 0.67998517, 'f1': 0.7344157, 'auroc': 0.9663615}
confusion matrix:
       0    1
0  16666   65
1    264  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92287916, 'precision': 0.58697265, 'recall': 0.5019484, 'specificity': 0.5019484, 'f1': 0.48501438, 'auroc': 0.84633183}
confusion matrix:
      0   1
0  9330  12
1   768   4
early stop counter: 4
val acc:0.9808118343353271, best validation acc: 0.9815700650215149, corresponding to test acc:                         0.9234724044799805 / 0.9236701726913452
after epoch: 9,now: 2024-05-05 04:45:26.708623,epoch time: 1:08:39.816979,used: 11:55:48.020213,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9972456, 'precision': 0.95844907, 'recall': 0.98539484, 'specificity': 0.98539484, 'f1': 0.97151613, 'auroc': 0.99966}
confusion matrix:
       0    1
0  38891   84
1     26  935
---- Validation: 
scalar performance:
{'acc': 0.9816867, 'precision': 0.8069561, 'recall': 0.8026267, 'specificity': 0.8026267, 'f1': 0.80477494, 'auroc': 0.9592053}
confusion matrix:
       0    1
0  16577  154
1    160  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9137829, 'precision': 0.6765781, 'recall': 0.63011324, 'specificity': 0.63011324, 'f1': 0.648618, 'auroc': 0.90063703}
confusion matrix:
      0    1
0  9014  328
1   544  228
better model found, saving less frequently
model persisted
after epoch: 10,now: 2024-05-05 05:52:10.967665,epoch time: 1:06:44.259042,used: 13:02:32.279255,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9965695, 'precision': 0.9473368, 'recall': 0.9840335, 'specificity': 0.9840335, 'f1': 0.9649216, 'auroc': 0.99927104}
confusion matrix:
       0    1
0  38866  109
1     28  933
---- Validation: 
scalar performance:
{'acc': 0.98139507, 'precision': 0.8026936, 'recall': 0.8048271, 'specificity': 0.8048271, 'f1': 0.80375636, 'auroc': 0.959204}
confusion matrix:
       0    1
0  16570  161
1    158  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9224837, 'precision': 0.65258944, 'recall': 0.5106465, 'specificity': 0.5106465, 'f1': 0.5029144, 'auroc': 0.8330787}
confusion matrix:
      0   1
0  9311  31
1   753  19
early stop counter: 1
val acc:0.9813950657844543, best validation acc: 0.9816867113113403, corresponding to test acc:                         0.9137828946113586 / 0.9236701726913452
after epoch: 11,now: 2024-05-05 06:59:20.602717,epoch time: 1:07:09.635052,used: 14:09:41.914307,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99321413, 'precision': 0.98762006, 'recall': 0.86545825, 'specificity': 0.86545825, 'f1': 0.9173717, 'auroc': 0.9984164}
confusion matrix:
       0    1
0  38963   13
1    258  702
---- Validation: 
scalar performance:
{'acc': 0.9802286, 'precision': 0.8518932, 'recall': 0.6479631, 'specificity': 0.6479631, 'f1': 0.70621467, 'auroc': 0.954774}
confusion matrix:
       0    1
0  16683   48
1    291  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92297804, 'precision': 0.46180865, 'recall': 0.49962536, 'specificity': 0.49962536, 'f1': 0.47997326, 'auroc': 0.89452004}
confusion matrix:
      0  1
0  9335  7
1   772  0
early stop counter: 2
val acc:0.9802286028862, best validation acc: 0.9816867113113403, corresponding to test acc:                         0.9137828946113586 / 0.9236701726913452
after epoch: 12,now: 2024-05-05 08:08:11.777995,epoch time: 1:08:51.175278,used: 15:18:33.089585,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9945663, 'precision': 0.9603958, 'recall': 0.9205893, 'specificity': 0.9205893, 'f1': 0.9395459, 'auroc': 0.99815965}
confusion matrix:
       0    1
0  38909   66
1    151  810
---- Validation: 
scalar performance:
{'acc': 0.9795871, 'precision': 0.8010403, 'recall': 0.7040312, 'specificity': 0.7040312, 'f1': 0.74262995, 'auroc': 0.9509593}
confusion matrix:
       0    1
0  16624  107
1    243  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9234724, 'precision': 0.6494533, 'recall': 0.5016754, 'specificity': 0.5016754, 'f1': 0.48394692, 'auroc': 0.7756921}
confusion matrix:
      0  1
0  9337  5
1   769  3
early stop counter: 3
val acc:0.9795870780944824, best validation acc: 0.9816867113113403, corresponding to test acc:                         0.9137828946113586 / 0.9236701726913452
after epoch: 13,now: 2024-05-05 09:25:07.202535,epoch time: 1:16:55.424540,used: 16:35:28.514125,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9965695, 'precision': 0.9444498, 'recall': 0.9880932, 'specificity': 0.9880932, 'f1': 0.96519244, 'auroc': 0.99966633}
confusion matrix:
       0    1
0  38858  117
1     20  941
---- Validation: 
scalar performance:
{'acc': 0.97923714, 'precision': 0.7809541, 'recall': 0.774348, 'specificity': 0.774348, 'f1': 0.77760893, 'auroc': 0.96160877}
confusion matrix:
       0    1
0  16558  173
1    183  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9196164, 'precision': 0.5026643, 'recall': 0.5001822, 'specificity': 0.5001822, 'f1': 0.4839261, 'auroc': 0.8345237}
confusion matrix:
      0   1
0  9297  45
1   768   4
early stop counter: 4
val acc:0.9792371392250061, best validation acc: 0.9816867113113403, corresponding to test acc:                         0.9137828946113586 / 0.9236701726913452
after epoch: 14,now: 2024-05-05 10:35:35.751135,epoch time: 1:10:28.548600,used: 17:45:57.062725,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9945663, 'precision': 0.90866435, 'recall': 0.9956938, 'specificity': 0.9956938, 'f1': 0.947737, 'auroc': 0.999861}
confusion matrix:
       0    1
0  38761  214
1      3  958
---- Validation: 
scalar performance:
{'acc': 0.9781873, 'precision': 0.76546454, 'recall': 0.8360816, 'specificity': 0.8360816, 'f1': 0.7962993, 'auroc': 0.9497322}
confusion matrix:
       0    1
0  16487  244
1    130  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9064663, 'precision': 0.6439259, 'recall': 0.6089224, 'specificity': 0.6089224, 'f1': 0.6230178, 'auroc': 0.8706993}
confusion matrix:
      0    1
0  8969  373
1   573  199
early stop counter: 5
val acc:0.9781873226165771, best validation acc: 0.9816867113113403, corresponding to test acc:                         0.9137828946113586 / 0.9236701726913452
after epoch: 15,now: 2024-05-05 11:42:21.617720,epoch time: 1:06:45.866585,used: 18:52:42.929310,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9982222, 'precision': 0.97942394, 'recall': 0.982833, 'specificity': 0.982833, 'f1': 0.98112214, 'auroc': 0.99980617}
confusion matrix:
       0    1
0  38937   39
1     32  928
---- Validation: 
scalar performance:
{'acc': 0.9813368, 'precision': 0.8161529, 'recall': 0.75192523, 'specificity': 0.75192523, 'f1': 0.780177, 'auroc': 0.9583245}
confusion matrix:
       0    1
0  16614  117
1    203  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.919122, 'precision': 0.6000995, 'recall': 0.5141741, 'specificity': 0.5141741, 'f1': 0.510904, 'auroc': 0.8842559}
confusion matrix:
      0   1
0  9268  74
1   744  28
early stop counter: 6
val acc:0.981336772441864, best validation acc: 0.9816867113113403, corresponding to test acc:                         0.9137828946113586 / 0.9236701726913452
after epoch: 16,now: 2024-05-05 12:49:03.779777,epoch time: 1:06:42.162057,used: 19:59:25.091367,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9970703, 'precision': 0.99850357, 'recall': 0.9391259, 'specificity': 0.9391259, 'f1': 0.9668407, 'auroc': 0.99997425}
confusion matrix:
       0    1
0  38975    0
1    117  844
---- Validation: 
scalar performance:
{'acc': 0.97987866, 'precision': 0.857694, 'recall': 0.6313348, 'specificity': 0.6313348, 'f1': 0.6895757, 'auroc': 0.9502395}
confusion matrix:
       0    1
0  16691   40
1    305  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9223848, 'precision': 0.46178597, 'recall': 0.4993042, 'specificity': 0.4993042, 'f1': 0.47981277, 'auroc': 0.73273385}
confusion matrix:
      0   1
0  9329  13
1   772   0
early stop counter: 7
val acc:0.9798786640167236, best validation acc: 0.9816867113113403, corresponding to test acc:                         0.9137828946113586 / 0.9236701726913452
after epoch: 17,now: 2024-05-05 13:55:39.241524,epoch time: 1:06:35.461747,used: 21:06:00.553114,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9983974, 'precision': 0.9848478, 'recall': 0.9809103, 'specificity': 0.9809103, 'f1': 0.9828706, 'auroc': 0.9996631}
confusion matrix:
       0    1
0  38947   28
1     36  925
---- Validation: 
scalar performance:
{'acc': 0.9804036, 'precision': 0.80090415, 'recall': 0.752622, 'specificity': 0.752622, 'f1': 0.7745171, 'auroc': 0.9531541}
confusion matrix:
       0    1
0  16597  134
1    202  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9173423, 'precision': 0.65374136, 'recall': 0.55420685, 'specificity': 0.55420685, 'f1': 0.57240164, 'auroc': 0.88204515}
confusion matrix:
      0    1
0  9181  161
1   675   97
early stop counter: 8
val acc:0.9804036021232605, best validation acc: 0.9816867113113403, corresponding to test acc:                         0.9137828946113586 / 0.9236701726913452
after epoch: 18,now: 2024-05-05 15:02:23.941126,epoch time: 1:06:44.699602,used: 22:12:45.252716,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99809694, 'precision': 0.9711989, 'recall': 0.98937297, 'specificity': 0.98937297, 'f1': 0.98010474, 'auroc': 0.99989665}
confusion matrix:
       0    1
0  38919   57
1     19  941
---- Validation: 
scalar performance:
{'acc': 0.98005366, 'precision': 0.79251695, 'recall': 0.76771677, 'specificity': 0.76771677, 'f1': 0.7795299, 'auroc': 0.9553465}
confusion matrix:
       0    1
0  16578  153
1    189  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91803443, 'precision': 0.57424164, 'recall': 0.51061463, 'specificity': 0.51061463, 'f1': 0.50486785, 'auroc': 0.87435037}
confusion matrix:
      0   1
0  9262  80
1   749  23
early stop counter: 9
val acc:0.9800536632537842, best validation acc: 0.9816867113113403, corresponding to test acc:                         0.9137828946113586 / 0.9236701726913452
after epoch: 19,now: 2024-05-05 16:09:59.784951,epoch time: 1:07:35.843825,used: 23:20:21.096541,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9994241, 'precision': 0.98973656, 'recall': 0.99818254, 'specificity': 0.99818254, 'f1': 0.9939216, 'auroc': 0.9999953}
confusion matrix:
       0    1
0  38955   20
1      3  958
---- Validation: 
scalar performance:
{'acc': 0.9822116, 'precision': 0.816949, 'recall': 0.7923212, 'specificity': 0.7923212, 'f1': 0.80410457, 'auroc': 0.95699114}
confusion matrix:
       0    1
0  16595  136
1    169  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9140795, 'precision': 0.5498173, 'recall': 0.5102562, 'specificity': 0.5102562, 'f1': 0.5057254, 'auroc': 0.8564004}
confusion matrix:
      0    1
0  9219  123
1   746   26
better model found, saving less frequently
model persisted
after epoch: 20,now: 2024-05-05 17:16:54.117681,epoch time: 1:06:54.332730,used: 1 day, 0:27:15.429271,model: dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761
working direcotry: /lustre/groups/aih/sina.wendrich/MA_code/test
Experiment finished at epoch: 20 with time: 1 day, 0:27:15.429271 at 2024-05-05 17:16:54.117681
persisted model performance metric: 

scalar performance:
{'acc': 0.9140795, 'precision': 0.5498173, 'recall': 0.5102562, 'specificity': 0.5102562, 'f1': 0.5057254, 'auroc': 0.8564004}
confusion matrix:
      0    1
0  9219  123
1   746   26
oracle model performance metric: 

scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.9191011}
confusion matrix:
      0  1
0  9342  0
1   772  0
results aggregation path: zoutput/aggrsts/dset_te_center4_exptag.csv
confusion matrix saved in file: zoutput/aggrsts/dset_te_center4_erm_bb976d8c0_not_commited_2024md_05md_04_16_49_38_seed_0_20339761_conf_mat.png
