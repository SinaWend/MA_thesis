Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)



no algorithm conf specified, going to use default



/ictstr01/groups/aih/sina.wendrich/MA_code/test/domainlab/arg_parser.py:355: UserWarning: no algorithm conf specified, going to use default
  warnings.warn("no algorithm conf specified, going to use default")

overriding args.task None to dset


using device: cuda

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/test/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'99b8035b'
model name: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_18_25_51_seed_0_20426418

 Experiment start at: 2024-05-07 18:25:51.760761
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.91668713}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9181724}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.89360726}
confusion matrix:
      0  1
0  9342  0
1   772  0
new oracle model saved
after epoch: 1,now: 2024-05-07 19:29:32.353690,epoch time: 1:03:40.592929,used: 1:03:40.592929,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_18_25_51_seed_0_20426418
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.9585162}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9527029}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.90889895}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 1
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 2,now: 2024-05-07 20:35:20.440512,epoch time: 1:05:48.086822,used: 2:09:28.679751,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_18_25_51_seed_0_20426418
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97596157, 'precision': 0.48798078, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4939173, 'auroc': 0.966925}
confusion matrix:
       0  1
0  38976  0
1    960  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9538448}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.90469575}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 2
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 3,now: 2024-05-07 21:42:04.493621,epoch time: 1:06:44.053109,used: 3:16:12.732860,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_18_25_51_seed_0_20426418
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9759866, 'precision': 0.4879933, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4939237, 'auroc': 0.9445}
confusion matrix:
       0  1
0  38977  0
1    959  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9251437}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.87865317}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 3
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 4,now: 2024-05-07 22:47:42.334254,epoch time: 1:05:37.840633,used: 4:21:50.573493,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_18_25_51_seed_0_20426418
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.9752642}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.95733273}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.9028682}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 4
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 5,now: 2024-05-07 23:53:37.287989,epoch time: 1:05:54.953735,used: 5:27:45.527228,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_18_25_51_seed_0_20426418
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.973485}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9538975}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.90526813}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 5
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 6,now: 2024-05-08 01:03:08.588238,epoch time: 1:09:31.300249,used: 6:37:16.827477,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_18_25_51_seed_0_20426418
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.9677616}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9355863}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.90070605}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 6
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 7,now: 2024-05-08 02:17:44.080229,epoch time: 1:14:35.491991,used: 7:51:52.319468,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_18_25_51_seed_0_20426418
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.9769645}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9570074}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.89327705}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 7
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 8,now: 2024-05-08 03:27:39.733262,epoch time: 1:09:55.653033,used: 9:01:47.972501,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_18_25_51_seed_0_20426418
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.9651708}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9401181}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.8669512}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 8
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 9,now: 2024-05-08 04:38:44.654286,epoch time: 1:11:04.921024,used: 10:12:52.893525,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_18_25_51_seed_0_20426418
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.97596276}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9486277}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.90400255}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 9
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 10,now: 2024-05-08 05:56:37.948394,epoch time: 1:17:53.294108,used: 11:30:46.187633,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_18_25_51_seed_0_20426418
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9759365, 'precision': 0.48796824, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.49391088, 'auroc': 0.9782511}
confusion matrix:
       0  1
0  38975  0
1    961  0
---- Validation: 
scalar performance:
{'acc': 0.9757961, 'precision': 0.48789805, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4938749, 'auroc': 0.9479358}
confusion matrix:
       0  1
0  16731  0
1    415  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236702, 'precision': 0.4618351, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48016036, 'auroc': 0.9145942}
confusion matrix:
      0  1
0  9342  0
1   772  0
early stop counter: 10
val acc:0.975796103477478, best validation acc: 0.975796103477478, corresponding to test acc:                         0.9236701726913452 / 0.9236701726913452
after epoch: 11,now: 2024-05-08 07:30:56.734333,epoch time: 1:34:18.785939,used: 13:05:04.973572,model: dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_18_25_51_seed_0_20426418
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/test
early stop trigger
Experiment finished at epoch: 11 with time: 13:05:04.973572 at 2024-05-08 07:30:56.734333
[Errno 2] No such file or directory: 'zoutput/saved_models/dset_te_center4_dann_b99b8035b_not_commited_2024md_05md_07_18_25_51_seed_0_20426418.model'
this error can occur if model selection criteria                            is worsening, model never get persisted,                            no performance metric is reported
failed to remove model
/ictstr01/groups/aih/sina.wendrich/MA_code/test/domainlab/exp/exp_main.py:126: UserWarning: failed to remove model
  warnings.warn("failed to remove model")
