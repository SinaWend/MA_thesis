Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  8 19:02:18 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078

 Experiment start at: 2024-08-08 19:11:54.952484
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6217427, 'precision': 0.6463878, 'recall': 0.621621, 'specificity': 0.621621, 'f1': 0.6049868, 'auroc': 0.7580791, 'binary_precision': 0.5864712, 'binary_recall': 0.82721066, 'binary_specificity': 0.4160313, 'binary_f1_score': 0.68634284}
confusion matrix:
       0      1
0  10531  14782
1   4379  20964
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.7003966, 'precision': 0.5166361, 'recall': 0.64909357, 'specificity': 0.64909357, 'f1': 0.4542477, 'auroc': 0.7228694, 'binary_precision': 0.047354296, 'binary_recall': 0.59518075, 'binary_specificity': 0.7030064, 'binary_f1_score': 0.08772865}
confusion matrix:
       0     1
0  11762  4969
1    168   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56397074, 'precision': 0.5230526, 'recall': 0.58097196, 'specificity': 0.58097196, 'f1': 0.438838, 'auroc': 0.60312396, 'binary_precision': 0.101620674, 'binary_recall': 0.60103625, 'binary_specificity': 0.5609077, 'binary_f1_score': 0.17384788}
confusion matrix:
      0     1
0  5240  4102
1   308   464
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 19:29:29.439413,epoch time: 0:17:34.486929,used: 0:17:34.486929,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.66136295, 'precision': 0.68430054, 'recall': 0.6612722, 'specificity': 0.6612722, 'f1': 0.65041095, 'auroc': 0.80441546, 'binary_precision': 0.61941016, 'binary_recall': 0.8379306, 'binary_specificity': 0.48461387, 'binary_f1_score': 0.7122875}
confusion matrix:
       0      1
0  12268  13047
1   4107  21234
---- Validation: 
scalar performance:
{'acc': 0.74542165, 'precision': 0.5186745, 'recall': 0.65101564, 'specificity': 0.65101564, 'f1': 0.4734199, 'auroc': 0.7297994, 'binary_precision': 0.051951, 'binary_recall': 0.5518072, 'binary_specificity': 0.7502241, 'binary_f1_score': 0.09496164}
confusion matrix:
       0     1
0  12552  4179
1    186   229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.615879, 'precision': 0.5240427, 'recall': 0.581146, 'specificity': 0.581146, 'f1': 0.46311638, 'auroc': 0.617808, 'binary_precision': 0.10564986, 'binary_recall': 0.5401554, 'binary_specificity': 0.6221366, 'binary_f1_score': 0.17673236}
confusion matrix:
      0     1
0  5812  3530
1   355   417
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-08 19:46:23.663862,epoch time: 0:16:54.224449,used: 0:34:28.711378,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.6638108, 'precision': 0.6902174, 'recall': 0.66369295, 'specificity': 0.66369295, 'f1': 0.6516251, 'auroc': 0.8196454, 'binary_precision': 0.6195021, 'binary_recall': 0.8502999, 'binary_specificity': 0.47708598, 'binary_f1_score': 0.71678036}
confusion matrix:
       0      1
0  12076  13236
1   3794  21550
---- Validation: 
scalar performance:
{'acc': 0.7131109, 'precision': 0.5187049, 'recall': 0.66383296, 'specificity': 0.66383296, 'f1': 0.461596, 'auroc': 0.7345261, 'binary_precision': 0.050678372, 'binary_recall': 0.6120482, 'binary_specificity': 0.7156177, 'binary_f1_score': 0.09360605}
confusion matrix:
       0     1
0  11973  4758
1    161   254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5803836, 'precision': 0.53062975, 'recall': 0.6070869, 'specificity': 0.6070869, 'f1': 0.45277834, 'auroc': 0.62929887, 'binary_precision': 0.11058771, 'binary_recall': 0.63860106, 'binary_specificity': 0.57557267, 'binary_f1_score': 0.18852773}
confusion matrix:
      0     1
0  5377  3965
1   279   493
early stop counter: 1
val acc:0.7131109237670898, best validation acc: 0.7454216480255127, corresponding to test acc:                         0.6158789992332458 / 0.6158789992332458
after epoch: 3,now: 2024-08-08 20:03:30.449397,epoch time: 0:17:06.785535,used: 0:51:35.496913,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.627211, 'precision': 0.67523813, 'recall': 0.62705576, 'specificity': 0.62705576, 'f1': 0.59962785, 'auroc': 0.83470464, 'binary_precision': 0.5836463, 'binary_recall': 0.8891607, 'binary_specificity': 0.3649508, 'binary_f1_score': 0.7047161}
confusion matrix:
      0      1
0  9238  16075
1  2809  22534
---- Validation: 
scalar performance:
{'acc': 0.61448735, 'precision': 0.51777625, 'recall': 0.68026924, 'specificity': 0.68026924, 'f1': 0.4208673, 'auroc': 0.7371086, 'binary_precision': 0.045621242, 'binary_recall': 0.7493976, 'binary_specificity': 0.61114097, 'binary_f1_score': 0.08600664}
confusion matrix:
       0     1
0  10225  6506
1    104   311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47221673, 'precision': 0.5299847, 'recall': 0.6043839, 'specificity': 0.6043839, 'f1': 0.395551, 'auroc': 0.63627744, 'binary_precision': 0.10226481, 'binary_recall': 0.7603627, 'binary_specificity': 0.44840506, 'binary_f1_score': 0.18028255}
confusion matrix:
      0     1
0  4189  5153
1   185   587
early stop counter: 2
val acc:0.61448734998703, best validation acc: 0.7454216480255127, corresponding to test acc:                         0.6158789992332458 / 0.6158789992332458
after epoch: 4,now: 2024-08-08 20:20:23.611935,epoch time: 0:16:53.162538,used: 1:08:28.659451,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.6697134, 'precision': 0.7045558, 'recall': 0.6695746, 'specificity': 0.6695746, 'f1': 0.654912, 'auroc': 0.84995896, 'binary_precision': 0.62030053, 'binary_recall': 0.87622803, 'binary_specificity': 0.46292126, 'binary_f1_score': 0.7263807}
confusion matrix:
       0      1
0  11717  13594
1   3137  22208
---- Validation: 
scalar performance:
{'acc': 0.6363, 'precision': 0.5181157, 'recall': 0.6796968, 'specificity': 0.6796968, 'f1': 0.43044692, 'auroc': 0.7391125, 'binary_precision': 0.046862837, 'binary_recall': 0.7253012, 'binary_specificity': 0.6340924, 'binary_f1_score': 0.08803744}
confusion matrix:
       0     1
0  10609  6122
1    114   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49990112, 'precision': 0.53183216, 'recall': 0.6122402, 'specificity': 0.6122402, 'f1': 0.4122373, 'auroc': 0.6453352, 'binary_precision': 0.1057763, 'binary_recall': 0.7448186, 'binary_specificity': 0.47966173, 'binary_f1_score': 0.18524484}
confusion matrix:
      0     1
0  4481  4861
1   197   575
early stop counter: 3
val acc:0.6363000273704529, best validation acc: 0.7454216480255127, corresponding to test acc:                         0.6158789992332458 / 0.6158789992332458
after epoch: 5,now: 2024-08-08 20:36:46.587913,epoch time: 0:16:22.975978,used: 1:24:51.635429,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.6353048, 'precision': 0.68870425, 'recall': 0.6351576, 'specificity': 0.6351576, 'f1': 0.60739565, 'auroc': 0.8619268, 'binary_precision': 0.58845955, 'binary_recall': 0.90142846, 'binary_specificity': 0.36888677, 'binary_f1_score': 0.71207255}
confusion matrix:
      0      1
0  9338  15976
1  2498  22844
---- Validation: 
scalar performance:
{'acc': 0.61804503, 'precision': 0.51789737, 'recall': 0.6809173, 'specificity': 0.6809173, 'f1': 0.42251396, 'auroc': 0.73794734, 'binary_precision': 0.045898728, 'binary_recall': 0.74698794, 'binary_specificity': 0.6148467, 'binary_f1_score': 0.08648347}
confusion matrix:
       0     1
0  10287  6444
1    105   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4740953, 'precision': 0.5318111, 'recall': 0.6107481, 'specificity': 0.6107481, 'f1': 0.39765388, 'auroc': 0.64175713, 'binary_precision': 0.10385084, 'binary_recall': 0.7720207, 'binary_specificity': 0.4494755, 'binary_f1_score': 0.18307479}
confusion matrix:
      0     1
0  4199  5143
1   176   596
early stop counter: 4
val acc:0.6180450320243835, best validation acc: 0.7454216480255127, corresponding to test acc:                         0.6158789992332458 / 0.6158789992332458
after epoch: 6,now: 2024-08-08 20:53:28.683339,epoch time: 0:16:42.095426,used: 1:41:33.730855,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.6642846, 'precision': 0.70280564, 'recall': 0.66415536, 'specificity': 0.66415536, 'f1': 0.6474415, 'auroc': 0.85935175, 'binary_precision': 0.61456645, 'binary_recall': 0.88233435, 'binary_specificity': 0.44597638, 'binary_f1_score': 0.724501}
confusion matrix:
       0      1
0  11289  14024
1   2982  22361
---- Validation: 
scalar performance:
{'acc': 0.6535052, 'precision': 0.5183226, 'recall': 0.67793834, 'specificity': 0.67793834, 'f1': 0.43777147, 'auroc': 0.73855996, 'binary_precision': 0.04779051, 'binary_recall': 0.7036145, 'binary_specificity': 0.6522623, 'binary_f1_score': 0.08950192}
confusion matrix:
       0     1
0  10913  5818
1    123   292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5202689, 'precision': 0.53126496, 'recall': 0.6107886, 'specificity': 0.6107886, 'f1': 0.42292222, 'auroc': 0.639241, 'binary_precision': 0.10678489, 'binary_recall': 0.71761656, 'binary_specificity': 0.5039606, 'binary_f1_score': 0.18590604}
confusion matrix:
      0     1
0  4708  4634
1   218   554
early stop counter: 5
val acc:0.6535052061080933, best validation acc: 0.7454216480255127, corresponding to test acc:                         0.6158789992332458 / 0.6158789992332458
after epoch: 7,now: 2024-08-08 21:10:02.213613,epoch time: 0:16:33.530274,used: 1:58:07.261129,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.68566406, 'precision': 0.72334576, 'recall': 0.68555856, 'specificity': 0.68555856, 'f1': 0.6717453, 'auroc': 0.87493926, 'binary_precision': 0.631735, 'binary_recall': 0.8911251, 'binary_specificity': 0.4799921, 'binary_f1_score': 0.739339}
confusion matrix:
       0      1
0  12151  13164
1   2759  22582
---- Validation: 
scalar performance:
{'acc': 0.637933, 'precision': 0.5183485, 'recall': 0.6817085, 'specificity': 0.6817085, 'f1': 0.43137863, 'auroc': 0.73903966, 'binary_precision': 0.047209628, 'binary_recall': 0.72771084, 'binary_specificity': 0.6357062, 'binary_f1_score': 0.08866706}
confusion matrix:
       0     1
0  10636  6095
1    113   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5068222, 'precision': 0.53079706, 'recall': 0.608857, 'specificity': 0.608857, 'f1': 0.41537976, 'auroc': 0.63729453, 'binary_precision': 0.10539124, 'binary_recall': 0.72927463, 'binary_specificity': 0.4884393, 'binary_f1_score': 0.18416749}
confusion matrix:
      0     1
0  4563  4779
1   209   563
early stop counter: 6
val acc:0.6379330158233643, best validation acc: 0.7454216480255127, corresponding to test acc:                         0.6158789992332458 / 0.6158789992332458
after epoch: 8,now: 2024-08-08 21:27:17.972039,epoch time: 0:17:15.758426,used: 2:15:23.019555,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.67837965, 'precision': 0.72006977, 'recall': 0.6782506, 'specificity': 0.6782506, 'f1': 0.6622927, 'auroc': 0.8789165, 'binary_precision': 0.6244329, 'binary_recall': 0.8961054, 'binary_specificity': 0.46039584, 'binary_f1_score': 0.7359995}
confusion matrix:
       0      1
0  11654  13659
1   2633  22710
---- Validation: 
scalar performance:
{'acc': 0.68949026, 'precision': 0.5187014, 'recall': 0.6717036, 'specificity': 0.6717036, 'f1': 0.45255175, 'auroc': 0.73516816, 'binary_precision': 0.04971565, 'binary_recall': 0.65301204, 'binary_specificity': 0.69039506, 'binary_f1_score': 0.09239687}
confusion matrix:
       0     1
0  11551  5180
1    144   271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5620921, 'precision': 0.52976114, 'recall': 0.60490924, 'specificity': 0.60490924, 'f1': 0.4432377, 'auroc': 0.63148916, 'binary_precision': 0.10837439, 'binary_recall': 0.6554404, 'binary_specificity': 0.5543781, 'binary_f1_score': 0.1859952}
confusion matrix:
      0     1
0  5179  4163
1   266   506
early stop counter: 7
val acc:0.6894902586936951, best validation acc: 0.7454216480255127, corresponding to test acc:                         0.6158789992332458 / 0.6158789992332458
after epoch: 9,now: 2024-08-08 21:44:10.099859,epoch time: 0:16:52.127820,used: 2:32:15.147375,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.6728127, 'precision': 0.7160553, 'recall': 0.67265356, 'specificity': 0.67265356, 'f1': 0.6554545, 'auroc': 0.8753985, 'binary_precision': 0.6195747, 'binary_recall': 0.89663064, 'binary_specificity': 0.4486764, 'binary_f1_score': 0.7327896}
confusion matrix:
       0      1
0  11356  13954
1   2620  22726
---- Validation: 
scalar performance:
{'acc': 0.64289045, 'precision': 0.5189412, 'recall': 0.68659854, 'specificity': 0.68659854, 'f1': 0.43408328, 'auroc': 0.7412395, 'binary_precision': 0.04813173, 'binary_recall': 0.7325301, 'binary_specificity': 0.640667, 'binary_f1_score': 0.090328336}
confusion matrix:
       0     1
0  10719  6012
1    111   304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51611626, 'precision': 0.53047734, 'recall': 0.6079465, 'specificity': 0.6079465, 'f1': 0.42018184, 'auroc': 0.6396642, 'binary_precision': 0.105776586, 'binary_recall': 0.71632123, 'binary_specificity': 0.49957183, 'binary_f1_score': 0.18433332}
confusion matrix:
      0     1
0  4667  4675
1   219   553
early stop counter: 8
val acc:0.642890453338623, best validation acc: 0.7454216480255127, corresponding to test acc:                         0.6158789992332458 / 0.6158789992332458
after epoch: 10,now: 2024-08-08 22:00:51.079562,epoch time: 0:16:40.979703,used: 2:48:56.127078,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.7140319, 'precision': 0.7398741, 'recall': 0.7139281, 'specificity': 0.7139281, 'f1': 0.7060526, 'auroc': 0.8814913, 'binary_precision': 0.66129893, 'binary_recall': 0.87823546, 'binary_specificity': 0.54962075, 'binary_f1_score': 0.75448287}
confusion matrix:
       0      1
0  13912  11400
1   3086  22258
---- Validation: 
scalar performance:
{'acc': 0.6465648, 'precision': 0.5188617, 'recall': 0.6849565, 'specificity': 0.6849565, 'f1': 0.4355182, 'auroc': 0.7430084, 'binary_precision': 0.04818313, 'binary_recall': 0.7253012, 'binary_specificity': 0.6446118, 'binary_f1_score': 0.09036325}
confusion matrix:
       0     1
0  10785  5946
1    114   301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52966183, 'precision': 0.530835, 'recall': 0.60933757, 'specificity': 0.60933757, 'f1': 0.42758584, 'auroc': 0.6389944, 'binary_precision': 0.10707947, 'binary_recall': 0.7033679, 'binary_specificity': 0.5153072, 'binary_f1_score': 0.18586342}
confusion matrix:
      0     1
0  4814  4528
1   229   543
early stop counter: 9
val acc:0.646564781665802, best validation acc: 0.7454216480255127, corresponding to test acc:                         0.6158789992332458 / 0.6158789992332458
after epoch: 11,now: 2024-08-08 22:17:25.600089,epoch time: 0:16:34.520527,used: 3:05:30.647605,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.7095704, 'precision': 0.7448629, 'recall': 0.7094654, 'specificity': 0.7094654, 'f1': 0.6986478, 'auroc': 0.8926047, 'binary_precision': 0.6520396, 'binary_recall': 0.8994554, 'binary_specificity': 0.5194754, 'binary_f1_score': 0.7560199}
confusion matrix:
       0      1
0  13150  12164
1   2548  22794
---- Validation: 
scalar performance:
{'acc': 0.6036393, 'precision': 0.5186631, 'recall': 0.69115984, 'specificity': 0.69115984, 'f1': 0.41707382, 'auroc': 0.7510642, 'binary_precision': 0.046223864, 'binary_recall': 0.78313255, 'binary_specificity': 0.59918714, 'binary_f1_score': 0.08729519}
confusion matrix:
       0     1
0  10025  6706
1     90   325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4849713, 'precision': 0.53452945, 'recall': 0.62079453, 'specificity': 0.62079453, 'f1': 0.40544415, 'auroc': 0.6537683, 'binary_precision': 0.10685805, 'binary_recall': 0.78108805, 'binary_specificity': 0.46050096, 'binary_f1_score': 0.18799686}
confusion matrix:
      0     1
0  4302  5040
1   169   603
early stop counter: 10
val acc:0.6036393046379089, best validation acc: 0.7454216480255127, corresponding to test acc:                         0.6158789992332458 / 0.6158789992332458
after epoch: 12,now: 2024-08-08 22:33:56.922947,epoch time: 0:16:31.322858,used: 3:22:01.970463,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.7156507, 'precision': 0.75008166, 'recall': 0.71551865, 'specificity': 0.71551865, 'f1': 0.70543396, 'auroc': 0.8959147, 'binary_precision': 0.65746605, 'binary_recall': 0.9012467, 'binary_specificity': 0.5297906, 'binary_f1_score': 0.76029295}
confusion matrix:
       0      1
0  13409  11901
1   2503  22843
---- Validation: 
scalar performance:
{'acc': 0.6470897, 'precision': 0.51972115, 'recall': 0.69345, 'specificity': 0.69345, 'f1': 0.43667737, 'auroc': 0.74855435, 'binary_precision': 0.049264237, 'binary_recall': 0.74216866, 'binary_specificity': 0.64473134, 'binary_f1_score': 0.09239538}
confusion matrix:
       0     1
0  10787  5944
1    107   308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5325292, 'precision': 0.5336185, 'recall': 0.61920774, 'specificity': 0.61920774, 'f1': 0.43101764, 'auroc': 0.6529453, 'binary_precision': 0.10986193, 'binary_recall': 0.7215026, 'binary_specificity': 0.5169129, 'binary_f1_score': 0.19068812}
confusion matrix:
      0     1
0  4829  4513
1   215   557
early stop counter: 11
val acc:0.6470897197723389, best validation acc: 0.7454216480255127, corresponding to test acc:                         0.6158789992332458 / 0.6158789992332458
after epoch: 13,now: 2024-08-08 22:50:34.203352,epoch time: 0:16:37.280405,used: 3:38:39.250868,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.7414916, 'precision': 0.76474166, 'recall': 0.7413979, 'specificity': 0.7413979, 'f1': 0.7356392, 'auroc': 0.8994596, 'binary_precision': 0.68644404, 'binary_recall': 0.88971746, 'binary_specificity': 0.5930784, 'binary_f1_score': 0.7749729}
confusion matrix:
       0      1
0  15012  10300
1   2795  22549
---- Validation: 
scalar performance:
{'acc': 0.697947, 'precision': 0.5213376, 'recall': 0.69366086, 'specificity': 0.69366086, 'f1': 0.45900133, 'auroc': 0.7505918, 'binary_precision': 0.0535982, 'binary_recall': 0.68915665, 'binary_specificity': 0.69816506, 'binary_f1_score': 0.09946096}
confusion matrix:
       0     1
0  11681  5050
1    129   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59125966, 'precision': 0.5331679, 'recall': 0.61535084, 'specificity': 0.61535084, 'f1': 0.46003148, 'auroc': 0.6478406, 'binary_precision': 0.1140955, 'binary_recall': 0.6437824, 'binary_specificity': 0.5869193, 'binary_f1_score': 0.19383776}
confusion matrix:
      0     1
0  5483  3859
1   275   497
early stop counter: 12
val acc:0.6979470252990723, best validation acc: 0.7454216480255127, corresponding to test acc:                         0.6158789992332458 / 0.6158789992332458
after epoch: 14,now: 2024-08-08 23:07:00.884249,epoch time: 0:16:26.680897,used: 3:55:05.931765,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.74761134, 'precision': 0.76865184, 'recall': 0.74751735, 'specificity': 0.74751735, 'f1': 0.74252325, 'auroc': 0.90120804, 'binary_precision': 0.69363594, 'binary_recall': 0.88759124, 'binary_specificity': 0.6074434, 'binary_f1_score': 0.77871823}
confusion matrix:
       0      1
0  15375   9936
1   2849  22496
---- Validation: 
scalar performance:
{'acc': 0.69998837, 'precision': 0.52127975, 'recall': 0.69235694, 'specificity': 0.69235694, 'f1': 0.45972693, 'auroc': 0.7480428, 'binary_precision': 0.053615253, 'binary_recall': 0.6843374, 'binary_specificity': 0.7003766, 'binary_f1_score': 0.09943977}
confusion matrix:
       0     1
0  11718  5013
1    131   284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5910619, 'precision': 0.5333006, 'recall': 0.61583793, 'specificity': 0.61583793, 'f1': 0.46004826, 'auroc': 0.64824414, 'binary_precision': 0.11422019, 'binary_recall': 0.6450777, 'binary_specificity': 0.58659816, 'binary_f1_score': 0.19407637}
confusion matrix:
      0     1
0  5480  3862
1   274   498
early stop counter: 13
val acc:0.6999883651733398, best validation acc: 0.7454216480255127, corresponding to test acc:                         0.6158789992332458 / 0.6158789992332458
after epoch: 15,now: 2024-08-08 23:23:25.684521,epoch time: 0:16:24.800272,used: 4:11:30.732037,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_19_11_54_seed_0_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:11:30.732037 at 2024-08-08 23:23:25.684521
persisted model performance metric: 

scalar performance:
{'acc': 0.615879, 'precision': 0.5240427, 'recall': 0.581146, 'specificity': 0.581146, 'f1': 0.46311638, 'auroc': 0.617808, 'binary_precision': 0.10564986, 'binary_recall': 0.5401554, 'binary_specificity': 0.6221366, 'binary_f1_score': 0.17673236}
confusion matrix:
      0     1
0  5812  3530
1   355   417
oracle model performance metric: 

scalar performance:
{'acc': 0.615879, 'precision': 0.5240427, 'recall': 0.581146, 'specificity': 0.581146, 'f1': 0.46311638, 'auroc': 0.617808, 'binary_precision': 0.10564986, 'binary_recall': 0.5401554, 'binary_specificity': 0.6221366, 'binary_f1_score': 0.17673236}
confusion matrix:
      0     1
0  5812  3530
1   355   417
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198876 KiB |   7828 MiB | 362921 GiB | 362920 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |  18214 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198876 KiB |   7828 MiB | 362921 GiB | 362920 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |  18214 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   7827 MiB | 362901 GiB | 362901 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 357414 GiB | 357414 GiB |
|       from small pool |  16663 KiB |     36 MiB |   5486 GiB |   5486 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59172 KiB | 732464 KiB | 204855 GiB | 204855 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 199353 GiB | 199353 GiB |
|       from small pool |   8410 KiB |  10852 KiB |   5501 GiB |   5501 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    6827    |   68596 K  |   68591 K  |
|       from large pool |      79    |     762    |   33765 K  |   33765 K  |
|       from small pool |    4345    |    6746    |   34830 K  |   34826 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    6827    |   68596 K  |   68591 K  |
|       from large pool |      79    |     762    |   33765 K  |   33765 K  |
|       from small pool |    4345    |    6746    |   34830 K  |   34826 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3191    |   40259 K  |   40259 K  |
|       from large pool |      10    |     350    |   25587 K  |   25587 K  |
|       from small pool |      23    |    3181    |   14671 K  |   14671 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 362921 GiB | 362921 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |      0 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 362921 GiB | 362921 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |      0 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 362901 GiB | 362901 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 357414 GiB | 357414 GiB |
|       from small pool |      0 KiB |     36 MiB |   5486 GiB |   5486 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 204855 GiB | 204855 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 199353 GiB | 199353 GiB |
|       from small pool |      0 KiB |  22549 KiB |   5501 GiB |   5501 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   68596 K  |   68596 K  |
|       from large pool |       2    |     762    |   33765 K  |   33765 K  |
|       from small pool |       0    |    6746    |   34830 K  |   34830 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   68596 K  |   68596 K  |
|       from large pool |       2    |     762    |   33765 K  |   33765 K  |
|       from small pool |       0    |    6746    |   34830 K  |   34830 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3191    |   40261 K  |   40261 K  |
|       from large pool |       3    |     350    |   25587 K  |   25587 K  |
|       from small pool |       0    |    3181    |   14673 K  |   14673 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 362921 GiB | 362921 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |      0 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 362921 GiB | 362921 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |      0 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 362901 GiB | 362901 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 357414 GiB | 357414 GiB |
|       from small pool |      0 KiB |     36 MiB |   5486 GiB |   5486 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 204855 GiB | 204855 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 199353 GiB | 199353 GiB |
|       from small pool |      0 KiB |  22549 KiB |   5501 GiB |   5501 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   68596 K  |   68596 K  |
|       from large pool |       2    |     762    |   33765 K  |   33765 K  |
|       from small pool |       0    |    6746    |   34830 K  |   34830 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   68596 K  |   68596 K  |
|       from large pool |       2    |     762    |   33765 K  |   33765 K  |
|       from small pool |       0    |    6746    |   34830 K  |   34830 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3191    |   40261 K  |   40261 K  |
|       from large pool |       3    |     350    |   25587 K  |   25587 K  |
|       from small pool |       0    |    3181    |   14673 K  |   14673 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078

 Experiment start at: 2024-08-08 23:43:45.838074
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.64943343, 'precision': 0.6504644, 'recall': 0.6494038, 'specificity': 0.6494038, 'f1': 0.648804, 'auroc': 0.69624865, 'binary_precision': 0.63818514, 'binary_recall': 0.6912794, 'binary_specificity': 0.60752815, 'binary_f1_score': 0.6636721}
confusion matrix:
       0      1
0  15430   9968
1   7852  17582
---- Validation: 
scalar performance:
{'acc': 0.86608654, 'precision': 0.5012658, 'recall': 0.50525224, 'specificity': 0.50525224, 'f1': 0.4864881, 'auroc': 0.67649597, 'binary_precision': 0.027411168, 'binary_recall': 0.12529002, 'binary_specificity': 0.88521445, 'binary_f1_score': 0.04498126}
confusion matrix:
       0     1
0  14776  1916
1    377    54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78753346, 'precision': 0.47317114, 'recall': 0.4517999, 'specificity': 0.4517999, 'f1': 0.4595677, 'auroc': 0.48025936, 'binary_precision': 0.029192125, 'binary_recall': 0.05680317, 'binary_specificity': 0.84679663, 'binary_f1_score': 0.038565025}
confusion matrix:
      0     1
0  7904  1430
1   714    43
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 00:01:33.283166,epoch time: 0:17:47.445092,used: 0:17:47.445092,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6962543, 'precision': 0.7012211, 'recall': 0.69619226, 'specificity': 0.69619226, 'f1': 0.6943253, 'auroc': 0.76427674, 'binary_precision': 0.6698036, 'binary_recall': 0.7750826, 'binary_specificity': 0.61730194, 'binary_f1_score': 0.7186076}
confusion matrix:
       0      1
0  15677   9719
1   5721  19715
---- Validation: 
scalar performance:
{'acc': 0.84722304, 'precision': 0.50191647, 'recall': 0.5091386, 'specificity': 0.5091386, 'f1': 0.48249102, 'auroc': 0.6772109, 'binary_precision': 0.02848511, 'binary_recall': 0.15313224, 'binary_specificity': 0.86514497, 'binary_f1_score': 0.048034936}
confusion matrix:
       0     1
0  14441  2251
1    365    66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7617679, 'precision': 0.4833801, 'recall': 0.46457747, 'specificity': 0.46457747, 'f1': 0.46546715, 'auroc': 0.51957846, 'binary_precision': 0.047775947, 'binary_recall': 0.114927344, 'binary_specificity': 0.8142276, 'binary_f1_score': 0.067494184}
confusion matrix:
      0     1
0  7600  1734
1   670    87
early stop counter: 1
val acc:0.8472230434417725, best validation acc: 0.8660865426063538, corresponding to test acc:                         0.7875334620475769 / 0.7875334620475769
after epoch: 2,now: 2024-08-09 00:18:12.189029,epoch time: 0:16:38.905863,used: 0:34:26.350955,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7103793, 'precision': 0.7152747, 'recall': 0.71031976, 'specificity': 0.71031976, 'f1': 0.7086855, 'auroc': 0.7837839, 'binary_precision': 0.68300766, 'binary_recall': 0.78601193, 'binary_specificity': 0.6346275, 'binary_f1_score': 0.73089856}
confusion matrix:
       0      1
0  16117   9279
1   5443  19993
---- Validation: 
scalar performance:
{'acc': 0.8561584, 'precision': 0.5030495, 'recall': 0.51372164, 'specificity': 0.51372164, 'f1': 0.48652482, 'auroc': 0.68344223, 'binary_precision': 0.030499076, 'binary_recall': 0.15313224, 'binary_specificity': 0.87431103, 'binary_f1_score': 0.050867055}
confusion matrix:
       0     1
0  14594  2098
1    365    66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.774948, 'precision': 0.4849536, 'recall': 0.46988115, 'specificity': 0.46988115, 'f1': 0.47044325, 'auroc': 0.5379622, 'binary_precision': 0.049940545, 'binary_recall': 0.110964336, 'binary_specificity': 0.82879794, 'binary_f1_score': 0.068880685}
confusion matrix:
      0     1
0  7736  1598
1   673    84
early stop counter: 2
val acc:0.8561583757400513, best validation acc: 0.8660865426063538, corresponding to test acc:                         0.7875334620475769 / 0.7875334620475769
after epoch: 3,now: 2024-08-09 00:34:53.115835,epoch time: 0:16:40.926806,used: 0:51:07.277761,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7144712, 'precision': 0.72113276, 'recall': 0.7144027, 'specificity': 0.7144027, 'f1': 0.7122621, 'auroc': 0.8000326, 'binary_precision': 0.68294805, 'binary_recall': 0.8014625, 'binary_specificity': 0.6273429, 'binary_f1_score': 0.73747426}
confusion matrix:
       0      1
0  15932   9464
1   5050  20386
---- Validation: 
scalar performance:
{'acc': 0.85756, 'precision': 0.50248533, 'recall': 0.5110501, 'specificity': 0.5110501, 'f1': 0.48606828, 'auroc': 0.6834444, 'binary_precision': 0.029522024, 'binary_recall': 0.14617169, 'binary_specificity': 0.8759286, 'binary_f1_score': 0.049122803}
confusion matrix:
       0     1
0  14621  2071
1    368    63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731642, 'precision': 0.48772457, 'recall': 0.47498626, 'specificity': 0.47498626, 'f1': 0.4733064, 'auroc': 0.5544214, 'binary_precision': 0.054651164, 'binary_recall': 0.12417437, 'binary_specificity': 0.82579815, 'binary_f1_score': 0.07589827}
confusion matrix:
      0     1
0  7708  1626
1   663    94
early stop counter: 3
val acc:0.8575599789619446, best validation acc: 0.8660865426063538, corresponding to test acc:                         0.7875334620475769 / 0.7875334620475769
after epoch: 4,now: 2024-08-09 00:51:45.831875,epoch time: 0:16:52.716040,used: 1:07:59.993801,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.7106941, 'precision': 0.7188659, 'recall': 0.7106178, 'specificity': 0.7106178, 'f1': 0.7079198, 'auroc': 0.7960671, 'binary_precision': 0.676771, 'binary_recall': 0.80751693, 'binary_specificity': 0.6137187, 'binary_f1_score': 0.7363854}
confusion matrix:
       0      1
0  15586   9810
1   4896  20540
---- Validation: 
scalar performance:
{'acc': 0.8671378, 'precision': 0.503038, 'recall': 0.5125723, 'specificity': 0.5125723, 'f1': 0.48933902, 'auroc': 0.69487923, 'binary_precision': 0.030549899, 'binary_recall': 0.13921113, 'binary_specificity': 0.8859334, 'binary_f1_score': 0.050104383}
confusion matrix:
       0     1
0  14788  1904
1    371    60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7873353, 'precision': 0.48346233, 'recall': 0.46929386, 'specificity': 0.46929386, 'f1': 0.47147012, 'auroc': 0.55508924, 'binary_precision': 0.04696673, 'binary_recall': 0.09511229, 'binary_specificity': 0.84347546, 'binary_f1_score': 0.062882096}
confusion matrix:
      0     1
0  7873  1461
1   685    72
better model found
persisted
after epoch: 5,now: 2024-08-09 01:08:23.271640,epoch time: 0:16:37.439765,used: 1:24:37.433566,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.72188777, 'precision': 0.7290397, 'recall': 0.72182155, 'specificity': 0.72182155, 'f1': 0.7196604, 'auroc': 0.8142586, 'binary_precision': 0.688753, 'binary_recall': 0.8104187, 'binary_specificity': 0.63322437, 'binary_f1_score': 0.74464893}
confusion matrix:
       0      1
0  16082   9315
1   4822  20613
---- Validation: 
scalar performance:
{'acc': 0.86591136, 'precision': 0.5031272, 'recall': 0.5130733, 'specificity': 0.5130733, 'f1': 0.48915857, 'auroc': 0.6900553, 'binary_precision': 0.030699547, 'binary_recall': 0.14153132, 'binary_specificity': 0.88461536, 'binary_f1_score': 0.050454922}
confusion matrix:
       0     1
0  14766  1926
1    370    61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7845605, 'precision': 0.48858705, 'recall': 0.47811186, 'specificity': 0.47811186, 'f1': 0.47687548, 'auroc': 0.5669365, 'binary_precision': 0.055799372, 'binary_recall': 0.11756935, 'binary_specificity': 0.8386544, 'binary_f1_score': 0.07568027}
confusion matrix:
      0     1
0  7828  1506
1   668    89
early stop counter: 1
val acc:0.8659113645553589, best validation acc: 0.8671377897262573, corresponding to test acc:                         0.7873352766036987 / 0.7875334620475769
after epoch: 6,now: 2024-08-09 01:25:12.080152,epoch time: 0:16:48.808512,used: 1:41:26.242078,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.7406358, 'precision': 0.74150014, 'recall': 0.74065804, 'specificity': 0.74065804, 'f1': 0.74041516, 'auroc': 0.80777717, 'binary_precision': 0.7561363, 'binary_recall': 0.7109495, 'binary_specificity': 0.77036655, 'binary_f1_score': 0.732847}
confusion matrix:
       0      1
0  19565   5832
1   7352  18083
---- Validation: 
scalar performance:
{'acc': 0.904748, 'precision': 0.49512616, 'recall': 0.4866574, 'specificity': 0.4866574, 'f1': 0.4869344, 'auroc': 0.6835838, 'binary_precision': 0.016129032, 'binary_recall': 0.046403714, 'binary_specificity': 0.9269111, 'binary_f1_score': 0.023937762}
confusion matrix:
       0     1
0  15472  1220
1    411    20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8401546, 'precision': 0.47451538, 'recall': 0.46992642, 'specificity': 0.46992642, 'f1': 0.472061, 'auroc': 0.54017466, 'binary_precision': 0.028634362, 'binary_recall': 0.034346104, 'binary_specificity': 0.90550673, 'binary_f1_score': 0.03123123}
confusion matrix:
      0    1
0  8452  882
1   731   26
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-09 01:42:04.719763,epoch time: 0:16:52.639611,used: 1:58:18.881689,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.74809176, 'precision': 0.74897873, 'recall': 0.7481128, 'specificity': 0.7481128, 'f1': 0.7478777, 'auroc': 0.8165511, 'binary_precision': 0.7640172, 'binary_recall': 0.71844774, 'binary_specificity': 0.7777778, 'binary_f1_score': 0.74053204}
confusion matrix:
       0      1
0  19754   5644
1   7161  18273
---- Validation: 
scalar performance:
{'acc': 0.91374177, 'precision': 0.49352622, 'recall': 0.48448956, 'specificity': 0.48448956, 'f1': 0.4867465, 'auroc': 0.68295455, 'binary_precision': 0.013035382, 'binary_recall': 0.032482598, 'binary_specificity': 0.9364965, 'binary_f1_score': 0.018604651}
confusion matrix:
       0     1
0  15632  1060
1    417    14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8508572, 'precision': 0.47627968, 'recall': 0.47510478, 'specificity': 0.47510478, 'f1': 0.47567883, 'auroc': 0.54368496, 'binary_precision': 0.03132832, 'binary_recall': 0.0330251, 'binary_specificity': 0.9171845, 'binary_f1_score': 0.03215434}
confusion matrix:
      0    1
0  8561  773
1   732   25
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-09 01:59:10.563347,epoch time: 0:17:05.843584,used: 2:15:24.725273,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.7652266, 'precision': 0.76536036, 'recall': 0.76523495, 'specificity': 0.76523495, 'f1': 0.76520073, 'auroc': 0.8366695, 'binary_precision': 0.77150786, 'binary_recall': 0.75415766, 'binary_specificity': 0.7763122, 'binary_f1_score': 0.7627341}
confusion matrix:
       0      1
0  19716   5681
1   6253  19182
---- Validation: 
scalar performance:
{'acc': 0.8943526, 'precision': 0.49581945, 'recall': 0.48697618, 'specificity': 0.48697618, 'f1': 0.4855202, 'auroc': 0.68490314, 'binary_precision': 0.017507004, 'binary_recall': 0.05800464, 'binary_specificity': 0.91594774, 'binary_f1_score': 0.026896182}
confusion matrix:
       0     1
0  15289  1403
1    406    25
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8287583, 'precision': 0.48082322, 'recall': 0.47408405, 'specificity': 0.47408405, 'f1': 0.47666618, 'auroc': 0.58793044, 'binary_precision': 0.040681172, 'binary_recall': 0.05680317, 'binary_specificity': 0.89136493, 'binary_f1_score': 0.04740904}
confusion matrix:
      0     1
0  8320  1014
1   714    43
early stop counter: 1
val acc:0.8943526148796082, best validation acc: 0.9137417674064636, corresponding to test acc:                         0.8508571982383728 / 0.8508571982383728
after epoch: 9,now: 2024-08-09 02:16:25.514645,epoch time: 0:17:14.951298,used: 2:32:39.676571,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.7602691, 'precision': 0.7609699, 'recall': 0.76028836, 'specificity': 0.76028836, 'f1': 0.76011693, 'auroc': 0.8301666, 'binary_precision': 0.77468175, 'binary_recall': 0.73453903, 'binary_specificity': 0.78603774, 'binary_f1_score': 0.7540765}
confusion matrix:
       0      1
0  19963   5434
1   6752  18683
---- Validation: 
scalar performance:
{'acc': 0.90019274, 'precision': 0.49498233, 'recall': 0.48545107, 'specificity': 0.48545107, 'f1': 0.48569682, 'auroc': 0.66386473, 'binary_precision': 0.01590909, 'binary_recall': 0.0487239, 'binary_specificity': 0.92217827, 'binary_f1_score': 0.023986293}
confusion matrix:
       0     1
0  15393  1299
1    410    21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8351006, 'precision': 0.48088515, 'recall': 0.47569156, 'specificity': 0.47569156, 'f1': 0.4778116, 'auroc': 0.57010007, 'binary_precision': 0.04052685, 'binary_recall': 0.05284016, 'binary_specificity': 0.89854294, 'binary_f1_score': 0.04587156}
confusion matrix:
      0    1
0  8387  947
1   717   40
early stop counter: 2
val acc:0.9001927375793457, best validation acc: 0.9137417674064636, corresponding to test acc:                         0.8508571982383728 / 0.8508571982383728
after epoch: 10,now: 2024-08-09 02:33:38.994857,epoch time: 0:17:13.480212,used: 2:49:53.156783,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.7679808, 'precision': 0.7679967, 'recall': 0.76798344, 'specificity': 0.76798344, 'f1': 0.7679784, 'auroc': 0.84329116, 'binary_precision': 0.77024883, 'binary_recall': 0.7642526, 'binary_specificity': 0.7717143, 'binary_f1_score': 0.767239}
confusion matrix:
       0      1
0  19600   5798
1   5996  19438
---- Validation: 
scalar performance:
{'acc': 0.892659, 'precision': 0.49706072, 'recall': 0.49062806, 'specificity': 0.49062806, 'f1': 0.4868873, 'auroc': 0.68355775, 'binary_precision': 0.019795222, 'binary_recall': 0.06728538, 'binary_specificity': 0.91397077, 'binary_f1_score': 0.030590719}
confusion matrix:
       0     1
0  15256  1436
1    402    29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82509166, 'precision': 0.48457685, 'recall': 0.47817138, 'specificity': 0.47817138, 'f1': 0.48013207, 'auroc': 0.5826265, 'binary_precision': 0.0475763, 'binary_recall': 0.07001321, 'binary_specificity': 0.88632953, 'binary_f1_score': 0.056654193}
confusion matrix:
      0     1
0  8273  1061
1   704    53
early stop counter: 3
val acc:0.8926590085029602, best validation acc: 0.9137417674064636, corresponding to test acc:                         0.8508571982383728 / 0.8508571982383728
after epoch: 11,now: 2024-08-09 02:50:50.782945,epoch time: 0:17:11.788088,used: 3:07:04.944871,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.76959395, 'precision': 0.77243686, 'recall': 0.769634, 'specificity': 0.769634, 'f1': 0.769009, 'auroc': 0.838537, 'binary_precision': 0.80046415, 'binary_recall': 0.7187058, 'binary_specificity': 0.8205623, 'binary_f1_score': 0.7573849}
confusion matrix:
       0      1
0  20839   4557
1   7155  18281
---- Validation: 
scalar performance:
{'acc': 0.9154354, 'precision': 0.49471727, 'recall': 0.4876185, 'specificity': 0.4876185, 'f1': 0.48871472, 'auroc': 0.6929368, 'binary_precision': 0.015252622, 'binary_recall': 0.03712297, 'binary_specificity': 0.93811405, 'binary_f1_score': 0.02162162}
confusion matrix:
       0     1
0  15659  1033
1    415    16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.857695, 'precision': 0.47317827, 'recall': 0.47455242, 'specificity': 0.47455242, 'f1': 0.47385305, 'auroc': 0.5643133, 'binary_precision': 0.025174825, 'binary_recall': 0.023778072, 'binary_specificity': 0.92532676, 'binary_f1_score': 0.024456523}
confusion matrix:
      0    1
0  8637  697
1   739   18
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-09 03:08:28.956895,epoch time: 0:17:38.173950,used: 3:24:43.118821,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.7622167, 'precision': 0.76233673, 'recall': 0.7622254, 'specificity': 0.7622254, 'f1': 0.7621934, 'auroc': 0.8396882, 'binary_precision': 0.76815844, 'binary_recall': 0.7517003, 'binary_specificity': 0.77275056, 'binary_f1_score': 0.7598402}
confusion matrix:
       0      1
0  19624   5771
1   6316  19121
---- Validation: 
scalar performance:
{'acc': 0.9060328, 'precision': 0.4961408, 'recall': 0.4895767, 'specificity': 0.4895767, 'f1': 0.4886259, 'auroc': 0.6959498, 'binary_precision': 0.018003274, 'binary_recall': 0.051044084, 'binary_specificity': 0.9281093, 'binary_f1_score': 0.026618268}
confusion matrix:
       0     1
0  15492  1200
1    409    22
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84927166, 'precision': 0.4733935, 'recall': 0.47181997, 'specificity': 0.47181997, 'f1': 0.4725903, 'auroc': 0.5617641, 'binary_precision': 0.026054591, 'binary_recall': 0.027741084, 'binary_specificity': 0.91589886, 'binary_f1_score': 0.026871402}
confusion matrix:
      0    1
0  8549  785
1   736   21
early stop counter: 1
val acc:0.9060328006744385, best validation acc: 0.9154353737831116, corresponding to test acc:                         0.8576949834823608 / 0.8576949834823608
after epoch: 13,now: 2024-08-09 03:25:57.111160,epoch time: 0:17:28.154265,used: 3:42:11.273086,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.7814172, 'precision': 0.78591037, 'recall': 0.7814714, 'specificity': 0.7814714, 'f1': 0.78057724, 'auroc': 0.8464303, 'binary_precision': 0.8219695, 'binary_recall': 0.71892446, 'binary_specificity': 0.8440183, 'binary_f1_score': 0.76700145}
confusion matrix:
       0      1
0  21433   3961
1   7150  18288
---- Validation: 
scalar performance:
{'acc': 0.91450095, 'precision': 0.49458984, 'recall': 0.48713925, 'specificity': 0.48713925, 'f1': 0.48834407, 'auroc': 0.6787272, 'binary_precision': 0.015023475, 'binary_recall': 0.03712297, 'binary_specificity': 0.93715554, 'binary_f1_score': 0.021390373}
confusion matrix:
       0     1
0  15643  1049
1    415    16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85165, 'precision': 0.47389546, 'recall': 0.47310558, 'specificity': 0.47310558, 'f1': 0.4734961, 'auroc': 0.559899, 'binary_precision': 0.02685422, 'binary_recall': 0.027741084, 'binary_specificity': 0.9184701, 'binary_f1_score': 0.027290449}
confusion matrix:
      0    1
0  8573  761
1   736   21
early stop counter: 2
val acc:0.9145009517669678, best validation acc: 0.9154353737831116, corresponding to test acc:                         0.8576949834823608 / 0.8576949834823608
after epoch: 14,now: 2024-08-09 03:42:32.251101,epoch time: 0:16:35.139941,used: 3:58:46.413027,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.7913716, 'precision': 0.79603505, 'recall': 0.79141843, 'specificity': 0.79141843, 'f1': 0.7905648, 'auroc': 0.85788655, 'binary_precision': 0.8333783, 'binary_recall': 0.7287596, 'binary_specificity': 0.8540773, 'binary_f1_score': 0.7775657}
confusion matrix:
       0      1
0  21691   3706
1   6899  18536
---- Validation: 
scalar performance:
{'acc': 0.90702564, 'precision': 0.49324176, 'recall': 0.48217493, 'specificity': 0.48217493, 'f1': 0.4848486, 'auroc': 0.686859, 'binary_precision': 0.012594459, 'binary_recall': 0.034802783, 'binary_specificity': 0.9295471, 'binary_f1_score': 0.018495684}
confusion matrix:
       0     1
0  15516  1176
1    416    15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84867704, 'precision': 0.47760755, 'recall': 0.4757471, 'specificity': 0.4757471, 'f1': 0.47663736, 'auroc': 0.581444, 'binary_precision': 0.033898305, 'binary_recall': 0.03698811, 'binary_specificity': 0.9145061, 'binary_f1_score': 0.035375867}
confusion matrix:
      0    1
0  8536  798
1   729   28
early stop counter: 3
val acc:0.9070256352424622, best validation acc: 0.9154353737831116, corresponding to test acc:                         0.8576949834823608 / 0.8576949834823608
after epoch: 15,now: 2024-08-09 03:59:13.662094,epoch time: 0:16:41.410993,used: 4:15:27.824020,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_43_45_seed_1_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:15:27.824020 at 2024-08-09 03:59:13.662094
persisted model performance metric: 

scalar performance:
{'acc': 0.857695, 'precision': 0.47317827, 'recall': 0.47455242, 'specificity': 0.47455242, 'f1': 0.47385305, 'auroc': 0.5643133, 'binary_precision': 0.025174825, 'binary_recall': 0.023778072, 'binary_specificity': 0.92532676, 'binary_f1_score': 0.024456523}
confusion matrix:
      0    1
0  8637  697
1   739   18
oracle model performance metric: 

scalar performance:
{'acc': 0.857695, 'precision': 0.47317827, 'recall': 0.47455242, 'specificity': 0.47455242, 'f1': 0.47385305, 'auroc': 0.5643133, 'binary_precision': 0.025174825, 'binary_recall': 0.023778072, 'binary_specificity': 0.92532676, 'binary_f1_score': 0.024456523}
confusion matrix:
      0    1
0  8637  697
1   739   18
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB | 730851 GiB | 730851 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 719809 GiB | 719808 GiB |
|       from small pool |  18208 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB | 730851 GiB | 730851 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 719809 GiB | 719808 GiB |
|       from small pool |  18208 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB | 730780 GiB | 730779 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 719761 GiB | 719761 GiB |
|       from small pool |  16662 KiB |     36 MiB |  11018 GiB |  11018 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8530 MiB |  16788 MiB |   8278 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     38 MiB |     44 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38101 KiB | 732464 KiB | 398038 GiB | 398038 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 386977 GiB | 386977 GiB |
|       from small pool |   6368 KiB |  22549 KiB |  11060 GiB |  11060 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6849    |  137812 K  |  137808 K  |
|       from large pool |      79    |     762    |   67979 K  |   67979 K  |
|       from small pool |    4333    |    6768    |   69832 K  |   69828 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6849    |  137812 K  |  137808 K  |
|       from large pool |      79    |     762    |   67979 K  |   67979 K  |
|       from small pool |    4333    |    6768    |   69832 K  |   69828 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     371    |     714    |     347    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      19    |      22    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3199    |   77949 K  |   77949 K  |
|       from large pool |      11    |     351    |   47689 K  |   47689 K  |
|       from small pool |      23    |    3189    |   30259 K  |   30259 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 730851 GiB | 730851 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |      0 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 730851 GiB | 730851 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |      0 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 730780 GiB | 730780 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 719761 GiB | 719761 GiB |
|       from small pool |      0 KiB |     36 MiB |  11018 GiB |  11018 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 398038 GiB | 398038 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 386977 GiB | 386977 GiB |
|       from small pool |      0 KiB |  22549 KiB |  11060 GiB |  11060 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  137812 K  |  137812 K  |
|       from large pool |       2    |     762    |   67979 K  |   67979 K  |
|       from small pool |       0    |    6768    |   69832 K  |   69832 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  137812 K  |  137812 K  |
|       from large pool |       2    |     762    |   67979 K  |   67979 K  |
|       from small pool |       0    |    6768    |   69832 K  |   69832 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     714    |     692    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |   77951 K  |   77951 K  |
|       from large pool |       3    |     351    |   47689 K  |   47689 K  |
|       from small pool |       0    |    3189    |   30261 K  |   30261 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 730851 GiB | 730851 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |      0 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 730851 GiB | 730851 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |      0 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 730780 GiB | 730780 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 719761 GiB | 719761 GiB |
|       from small pool |      0 KiB |     36 MiB |  11018 GiB |  11018 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 398038 GiB | 398038 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 386977 GiB | 386977 GiB |
|       from small pool |      0 KiB |  22549 KiB |  11060 GiB |  11060 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  137812 K  |  137812 K  |
|       from large pool |       2    |     762    |   67979 K  |   67979 K  |
|       from small pool |       0    |    6768    |   69832 K  |   69832 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  137812 K  |  137812 K  |
|       from large pool |       2    |     762    |   67979 K  |   67979 K  |
|       from small pool |       0    |    6768    |   69832 K  |   69832 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     714    |     692    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |   77951 K  |   77951 K  |
|       from large pool |       3    |     351    |   47689 K  |   47689 K  |
|       from small pool |       0    |    3189    |   30261 K  |   30261 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078

 Experiment start at: 2024-08-09 04:19:35.484383
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6581167, 'precision': 0.664415, 'recall': 0.6581242, 'specificity': 0.6581242, 'f1': 0.65481746, 'auroc': 0.72295237, 'binary_precision': 0.6966141, 'binary_recall': 0.56030947, 'binary_specificity': 0.755939, 'binary_f1_score': 0.6210711}
confusion matrix:
       0      1
0  19538   6308
1  11366  14484
---- Validation: 
scalar performance:
{'acc': 0.64540994, 'precision': 0.5071534, 'recall': 0.5686929, 'specificity': 0.5686929, 'f1': 0.42214698, 'auroc': 0.59268296, 'binary_precision': 0.03365226, 'binary_recall': 0.48803827, 'binary_specificity': 0.64934754, 'binary_f1_score': 0.06296296}
confusion matrix:
       0     1
0  10848  5858
1    214   204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6217796, 'precision': 0.5569399, 'recall': 0.69086015, 'specificity': 0.69086015, 'f1': 0.49590588, 'auroc': 0.7507615, 'binary_precision': 0.14487301, 'binary_recall': 0.7728984, 'binary_specificity': 0.6088219, 'binary_f1_score': 0.24400873}
confusion matrix:
      0     1
0  5659  3636
1   181   616
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 04:37:33.892942,epoch time: 0:17:58.408559,used: 0:17:58.408559,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.69154286, 'precision': 0.6947027, 'recall': 0.69155025, 'specificity': 0.69155025, 'f1': 0.6902915, 'auroc': 0.7640712, 'binary_precision': 0.71953547, 'binary_recall': 0.6279061, 'binary_specificity': 0.7551944, 'binary_f1_score': 0.67060524}
confusion matrix:
       0      1
0  19518   6327
1   9619  16232
---- Validation: 
scalar performance:
{'acc': 0.6013198, 'precision': 0.508494, 'recall': 0.58574855, 'specificity': 0.58574855, 'f1': 0.40590537, 'auroc': 0.6127305, 'binary_precision': 0.0345679, 'binary_recall': 0.569378, 'binary_specificity': 0.602119, 'binary_f1_score': 0.06517869}
confusion matrix:
       0     1
0  10059  6647
1    180   238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5864051, 'precision': 0.5541058, 'recall': 0.6848482, 'specificity': 0.6848482, 'f1': 0.47554028, 'auroc': 0.7618565, 'binary_precision': 0.13727175, 'binary_recall': 0.80175656, 'binary_specificity': 0.56793976, 'binary_f1_score': 0.23440938}
confusion matrix:
      0     1
0  5279  4016
1   158   639
early stop counter: 1
val acc:0.6013197898864746, best validation acc: 0.6454099416732788, corresponding to test acc:                         0.6217796206474304 / 0.6217796206474304
after epoch: 2,now: 2024-08-09 04:54:43.215008,epoch time: 0:17:09.322066,used: 0:35:07.730625,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.6925294, 'precision': 0.7129109, 'recall': 0.69254136, 'specificity': 0.69254136, 'f1': 0.684999, 'auroc': 0.7788429, 'binary_precision': 0.77880466, 'binary_recall': 0.5378723, 'binary_specificity': 0.8472104, 'binary_f1_score': 0.63629496}
confusion matrix:
       0      1
0  21897   3949
1  11946  13904
---- Validation: 
scalar performance:
{'acc': 0.71081525, 'precision': 0.51012915, 'recall': 0.58705264, 'specificity': 0.58705264, 'f1': 0.45017478, 'auroc': 0.6144259, 'binary_precision': 0.038852725, 'binary_recall': 0.4569378, 'binary_specificity': 0.7171675, 'binary_f1_score': 0.071616046}
confusion matrix:
       0     1
0  11981  4725
1    227   191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.688367, 'precision': 0.567849, 'recall': 0.7120961, 'specificity': 0.7120961, 'f1': 0.5372611, 'auroc': 0.76703095, 'binary_precision': 0.16723356, 'binary_recall': 0.74027604, 'binary_specificity': 0.6839161, 'binary_f1_score': 0.27283236}
confusion matrix:
      0     1
0  6357  2938
1   207   590
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 05:11:54.372157,epoch time: 0:17:11.157149,used: 0:52:18.887774,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7043098, 'precision': 0.7331743, 'recall': 0.704337, 'specificity': 0.704337, 'f1': 0.69488454, 'auroc': 0.8053931, 'binary_precision': 0.8152524, 'binary_recall': 0.52846974, 'binary_specificity': 0.8802043, 'binary_f1_score': 0.64125794}
confusion matrix:
       0      1
0  22748   3096
1  12190  13662
---- Validation: 
scalar performance:
{'acc': 0.7422331, 'precision': 0.5107683, 'recall': 0.585661, 'specificity': 0.585661, 'f1': 0.462069, 'auroc': 0.61821866, 'binary_precision': 0.040478382, 'binary_recall': 0.42105263, 'binary_specificity': 0.75026935, 'binary_f1_score': 0.07385649}
confusion matrix:
       0     1
0  12534  4172
1    242   176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7024376, 'precision': 0.56667113, 'recall': 0.70252776, 'specificity': 0.70252776, 'f1': 0.5423361, 'auroc': 0.7590591, 'binary_precision': 0.16837041, 'binary_recall': 0.7026349, 'binary_specificity': 0.70242065, 'binary_f1_score': 0.27164683}
confusion matrix:
      0     1
0  6529  2766
1   237   560
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-09 05:29:07.788991,epoch time: 0:17:13.416834,used: 1:09:32.304608,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.720578, 'precision': 0.7388162, 'recall': 0.7205887, 'specificity': 0.7205887, 'f1': 0.7151457, 'auroc': 0.8134078, 'binary_precision': 0.8048324, 'binary_recall': 0.58243716, 'binary_specificity': 0.8587402, 'binary_f1_score': 0.67580855}
confusion matrix:
       0      1
0  22195   3651
1  10794  15056
---- Validation: 
scalar performance:
{'acc': 0.7356926, 'precision': 0.51003504, 'recall': 0.58114266, 'specificity': 0.58114266, 'f1': 0.4588439, 'auroc': 0.6149235, 'binary_precision': 0.039255273, 'binary_recall': 0.41866028, 'binary_specificity': 0.74362504, 'binary_f1_score': 0.071780145}
confusion matrix:
       0     1
0  12423  4283
1    243   175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6978795, 'precision': 0.56724834, 'recall': 0.7063625, 'specificity': 0.7063625, 'f1': 0.5409214, 'auroc': 0.7633717, 'binary_precision': 0.16823807, 'binary_recall': 0.7164366, 'binary_specificity': 0.69628835, 'binary_f1_score': 0.27248868}
confusion matrix:
      0     1
0  6472  2823
1   226   571
early stop counter: 1
val acc:0.7356926202774048, best validation acc: 0.7422330975532532, corresponding to test acc:                         0.7024375796318054 / 0.7024375796318054
after epoch: 5,now: 2024-08-09 05:46:11.825220,epoch time: 0:17:04.036229,used: 1:26:36.340837,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.70543176, 'precision': 0.7383365, 'recall': 0.70546055, 'specificity': 0.70546055, 'f1': 0.6949198, 'auroc': 0.8101374, 'binary_precision': 0.82693255, 'binary_recall': 0.5197277, 'binary_specificity': 0.89119333, 'binary_f1_score': 0.6382898}
confusion matrix:
       0      1
0  23032   2812
1  12416  13436
---- Validation: 
scalar performance:
{'acc': 0.75630695, 'precision': 0.50914586, 'recall': 0.56954914, 'specificity': 0.56954914, 'f1': 0.4646788, 'auroc': 0.6024799, 'binary_precision': 0.03835751, 'binary_recall': 0.37320575, 'binary_specificity': 0.7658925, 'binary_f1_score': 0.069565214}
confusion matrix:
       0     1
0  12795  3911
1    262   156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7218589, 'precision': 0.57124704, 'recall': 0.70905614, 'specificity': 0.70905614, 'f1': 0.55506605, 'auroc': 0.7663245, 'binary_precision': 0.17747112, 'binary_recall': 0.69385195, 'binary_specificity': 0.72426033, 'binary_f1_score': 0.28264758}
confusion matrix:
      0     1
0  6732  2563
1   244   553
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-09 06:03:23.745811,epoch time: 0:17:11.920591,used: 1:43:48.261428,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.7184308, 'precision': 0.7493502, 'recall': 0.7184853, 'specificity': 0.7184853, 'f1': 0.7094556, 'auroc': 0.8203845, 'binary_precision': 0.8372329, 'binary_recall': 0.54250467, 'binary_specificity': 0.8944659, 'binary_f1_score': 0.65839005}
confusion matrix:
       0      1
0  23113   2727
1  11829  14027
---- Validation: 
scalar performance:
{'acc': 0.7693296, 'precision': 0.50902116, 'recall': 0.5657272, 'specificity': 0.5657272, 'f1': 0.46881258, 'auroc': 0.6041983, 'binary_precision': 0.03842133, 'binary_recall': 0.35167465, 'binary_specificity': 0.77977973, 'binary_f1_score': 0.06927428}
confusion matrix:
       0     1
0  13027  3679
1    271   147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73246133, 'precision': 0.57363987, 'recall': 0.7113706, 'specificity': 0.7113706, 'f1': 0.5618077, 'auroc': 0.7672787, 'binary_precision': 0.18251584, 'binary_recall': 0.6863237, 'binary_specificity': 0.7364174, 'binary_f1_score': 0.28835005}
confusion matrix:
      0     1
0  6845  2450
1   250   547
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-09 06:20:36.931032,epoch time: 0:17:13.185221,used: 2:01:01.446649,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.7297083, 'precision': 0.7608958, 'recall': 0.729735, 'specificity': 0.729735, 'f1': 0.7213968, 'auroc': 0.8321537, 'binary_precision': 0.85113806, 'binary_recall': 0.5569008, 'binary_specificity': 0.90256923, 'binary_f1_score': 0.6732761}
confusion matrix:
       0      1
0  23326   2518
1  11455  14397
---- Validation: 
scalar performance:
{'acc': 0.7857977, 'precision': 0.5089411, 'recall': 0.5613386, 'specificity': 0.5613386, 'f1': 0.47400573, 'auroc': 0.60009766, 'binary_precision': 0.038614422, 'binary_recall': 0.32535884, 'binary_specificity': 0.79731834, 'binary_f1_score': 0.06903553}
confusion matrix:
       0     1
0  13320  3386
1    282   136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74336106, 'precision': 0.57548547, 'recall': 0.71097857, 'specificity': 0.71097857, 'f1': 0.5679878, 'auroc': 0.7632717, 'binary_precision': 0.18708551, 'binary_recall': 0.67252195, 'binary_specificity': 0.7494352, 'binary_f1_score': 0.2927362}
confusion matrix:
      0     1
0  6966  2329
1   261   536
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-09 06:37:59.223962,epoch time: 0:17:22.292930,used: 2:18:23.739579,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.7501934, 'precision': 0.76694953, 'recall': 0.75020313, 'specificity': 0.75020313, 'f1': 0.7462158, 'auroc': 0.84457886, 'binary_precision': 0.8338495, 'binary_recall': 0.62495166, 'binary_specificity': 0.8754546, 'binary_f1_score': 0.7144436}
confusion matrix:
       0      1
0  22627   3219
1   9695  16155
---- Validation: 
scalar performance:
{'acc': 0.7331231, 'precision': 0.5103712, 'recall': 0.5844907, 'specificity': 0.5844907, 'f1': 0.45838988, 'auroc': 0.6196718, 'binary_precision': 0.039689578, 'binary_recall': 0.42822966, 'binary_specificity': 0.7407518, 'binary_f1_score': 0.072646104}
confusion matrix:
       0     1
0  12375  4331
1    239   179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.704023, 'precision': 0.5671194, 'recall': 0.70338845, 'specificity': 0.70338845, 'f1': 0.5434559, 'auroc': 0.7614007, 'binary_precision': 0.1691843, 'binary_recall': 0.7026349, 'binary_specificity': 0.70414203, 'binary_f1_score': 0.27270517}
confusion matrix:
      0     1
0  6545  2750
1   237   560
early stop counter: 1
val acc:0.7331231236457825, best validation acc: 0.7857977151870728, corresponding to test acc:                         0.7433610558509827 / 0.7433610558509827
after epoch: 9,now: 2024-08-09 06:55:20.544117,epoch time: 0:17:21.320155,used: 2:35:45.059734,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.7421077, 'precision': 0.77095306, 'recall': 0.7421329, 'specificity': 0.7421329, 'f1': 0.7350695, 'auroc': 0.84588456, 'binary_precision': 0.8593983, 'binary_recall': 0.57902676, 'binary_specificity': 0.9052391, 'binary_f1_score': 0.69188815}
confusion matrix:
       0      1
0  23395   2449
1  10883  14969
---- Validation: 
scalar performance:
{'acc': 0.802733, 'precision': 0.508585, 'recall': 0.55485696, 'specificity': 0.55485696, 'f1': 0.47878757, 'auroc': 0.597633, 'binary_precision': 0.038365565, 'binary_recall': 0.2942584, 'binary_specificity': 0.8154555, 'binary_f1_score': 0.067880794}
confusion matrix:
       0     1
0  13623  3083
1    295   123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7582243, 'precision': 0.5751914, 'recall': 0.70012, 'specificity': 0.70012, 'f1': 0.5730783, 'auroc': 0.7527988, 'binary_precision': 0.18988298, 'binary_recall': 0.6311167, 'binary_specificity': 0.7691232, 'binary_f1_score': 0.29193267}
confusion matrix:
      0     1
0  7149  2146
1   294   503
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-09 07:12:31.745507,epoch time: 0:17:11.201390,used: 2:52:56.261124,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.74808496, 'precision': 0.7833996, 'recall': 0.7481191, 'specificity': 0.7481191, 'f1': 0.74000204, 'auroc': 0.8570781, 'binary_precision': 0.8834888, 'binary_recall': 0.57165515, 'binary_specificity': 0.9245831, 'binary_f1_score': 0.6941594}
confusion matrix:
       0      1
0  23894   1949
1  11074  14779
---- Validation: 
scalar performance:
{'acc': 0.8001635, 'precision': 0.50793797, 'recall': 0.55120754, 'specificity': 0.55120754, 'f1': 0.47707972, 'auroc': 0.58634526, 'binary_precision': 0.037276648, 'binary_recall': 0.28947368, 'binary_specificity': 0.81294143, 'binary_f1_score': 0.06604803}
confusion matrix:
       0     1
0  13581  3125
1    297   121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7585216, 'precision': 0.57726705, 'recall': 0.7065905, 'specificity': 0.7065905, 'f1': 0.5754594, 'auroc': 0.7563409, 'binary_precision': 0.19265367, 'binary_recall': 0.64491844, 'binary_specificity': 0.7682625, 'binary_f1_score': 0.2966811}
confusion matrix:
      0     1
0  7141  2154
1   283   514
new oracle model saved
early stop counter: 1
val acc:0.8001635074615479, best validation acc: 0.8027330040931702, corresponding to test acc:                         0.7582243084907532 / 0.7585216164588928
after epoch: 11,now: 2024-08-09 07:29:47.918809,epoch time: 0:17:16.173302,used: 3:10:12.434426,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.74609256, 'precision': 0.78474474, 'recall': 0.7461353, 'specificity': 0.7461353, 'f1': 0.73719513, 'auroc': 0.8567983, 'binary_precision': 0.8897122, 'binary_recall': 0.5619633, 'binary_specificity': 0.93030727, 'binary_f1_score': 0.6888394}
confusion matrix:
       0      1
0  24041   1801
1  11325  14529
---- Validation: 
scalar performance:
{'acc': 0.8100327, 'precision': 0.5070572, 'recall': 0.543437, 'specificity': 0.543437, 'f1': 0.47882158, 'auroc': 0.5880792, 'binary_precision': 0.036006548, 'binary_recall': 0.2631579, 'binary_specificity': 0.82371604, 'binary_f1_score': 0.06334581}
confusion matrix:
       0     1
0  13761  2945
1    308   110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7608997, 'precision': 0.5771346, 'recall': 0.7044401, 'specificity': 0.7044401, 'f1': 0.5761398, 'auroc': 0.75625706, 'binary_precision': 0.19300912, 'binary_recall': 0.6373902, 'binary_specificity': 0.77149004, 'binary_f1_score': 0.2962963}
confusion matrix:
      0     1
0  7171  2124
1   289   508
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-09 07:46:59.904704,epoch time: 0:17:11.985895,used: 3:27:24.420321,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.7642951, 'precision': 0.77793634, 'recall': 0.76432085, 'specificity': 0.76432085, 'f1': 0.7613788, 'auroc': 0.8576726, 'binary_precision': 0.83956873, 'binary_recall': 0.65359324, 'binary_specificity': 0.8750484, 'binary_f1_score': 0.73499924}
confusion matrix:
       0      1
0  22613   3229
1   8956  16898
---- Validation: 
scalar performance:
{'acc': 0.7106984, 'precision': 0.50824857, 'recall': 0.57066536, 'specificity': 0.57066536, 'f1': 0.44775498, 'auroc': 0.59916246, 'binary_precision': 0.036196318, 'binary_recall': 0.423445, 'binary_specificity': 0.7178858, 'binary_f1_score': 0.066691786}
confusion matrix:
       0     1
0  11993  4713
1    241   177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6797463, 'precision': 0.5628039, 'recall': 0.6976656, 'specificity': 0.6976656, 'f1': 0.52864206, 'auroc': 0.7549367, 'binary_precision': 0.16001117, 'binary_recall': 0.71894604, 'binary_specificity': 0.67638516, 'binary_f1_score': 0.26176336}
confusion matrix:
      0     1
0  6287  3008
1   224   573
early stop counter: 1
val acc:0.7106984257698059, best validation acc: 0.8100327253341675, corresponding to test acc:                         0.7608997225761414 / 0.7608997225761414
after epoch: 13,now: 2024-08-09 08:04:13.547276,epoch time: 0:17:13.642572,used: 3:44:38.062893,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.7594785, 'precision': 0.7788331, 'recall': 0.75947845, 'specificity': 0.75947845, 'f1': 0.7552309, 'auroc': 0.85616875, 'binary_precision': 0.8522954, 'binary_recall': 0.6277468, 'binary_specificity': 0.89121014, 'binary_f1_score': 0.7229871}
confusion matrix:
       0      1
0  23036   2812
1   9622  16226
---- Validation: 
scalar performance:
{'acc': 0.6899673, 'precision': 0.5078906, 'recall': 0.5705366, 'specificity': 0.5705366, 'f1': 0.4398188, 'auroc': 0.5947567, 'binary_precision': 0.03534106, 'binary_recall': 0.4449761, 'binary_specificity': 0.6960972, 'binary_f1_score': 0.06548143}
confusion matrix:
       0     1
0  11629  5077
1    232   186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6639913, 'precision': 0.5593037, 'recall': 0.6902597, 'specificity': 0.6902597, 'f1': 0.51823694, 'auroc': 0.74738574, 'binary_precision': 0.15357906, 'binary_recall': 0.72145545, 'binary_specificity': 0.659064, 'binary_f1_score': 0.25324818}
confusion matrix:
      0     1
0  6126  3169
1   222   575
early stop counter: 2
val acc:0.6899672746658325, best validation acc: 0.8100327253341675, corresponding to test acc:                         0.7608997225761414 / 0.7608997225761414
after epoch: 14,now: 2024-08-09 08:21:18.267065,epoch time: 0:17:04.719789,used: 4:01:42.782682,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.7756306, 'precision': 0.782633, 'recall': 0.77564275, 'specificity': 0.77564275, 'f1': 0.77423745, 'auroc': 0.8614899, 'binary_precision': 0.8271588, 'binary_recall': 0.69696736, 'binary_specificity': 0.8543182, 'binary_f1_score': 0.75650257}
confusion matrix:
       0      1
0  22079   3765
1   7834  18018
---- Validation: 
scalar performance:
{'acc': 0.5723546, 'precision': 0.50789964, 'recall': 0.5813997, 'specificity': 0.5813997, 'f1': 0.3930673, 'auroc': 0.59506774, 'binary_precision': 0.03338289, 'binary_recall': 0.59090906, 'binary_specificity': 0.57189035, 'binary_f1_score': 0.0631956}
confusion matrix:
      0     1
0  9554  7152
1   171   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5735236, 'precision': 0.55171996, 'recall': 0.6772816, 'specificity': 0.6772816, 'f1': 0.46698, 'auroc': 0.7517768, 'binary_precision': 0.13338909, 'binary_recall': 0.8005019, 'binary_specificity': 0.5540613, 'binary_f1_score': 0.22867383}
confusion matrix:
      0     1
0  5150  4145
1   159   638
early stop counter: 3
val acc:0.5723546147346497, best validation acc: 0.8100327253341675, corresponding to test acc:                         0.7608997225761414 / 0.7608997225761414
after epoch: 15,now: 2024-08-09 08:38:38.806804,epoch time: 0:17:20.539739,used: 4:19:03.322421,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_19_35_seed_2_24116078
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:19:03.322421 at 2024-08-09 08:38:38.806804
persisted model performance metric: 

scalar performance:
{'acc': 0.7608997, 'precision': 0.5771346, 'recall': 0.7044401, 'specificity': 0.7044401, 'f1': 0.5761398, 'auroc': 0.75625706, 'binary_precision': 0.19300912, 'binary_recall': 0.6373902, 'binary_specificity': 0.77149004, 'binary_f1_score': 0.2962963}
confusion matrix:
      0     1
0  7171  2124
1   289   508
oracle model performance metric: 

scalar performance:
{'acc': 0.7608997, 'precision': 0.5771346, 'recall': 0.7044401, 'specificity': 0.7044401, 'f1': 0.5761398, 'auroc': 0.75625706, 'binary_precision': 0.19300912, 'binary_recall': 0.6373902, 'binary_specificity': 0.77149004, 'binary_f1_score': 0.2962963}
confusion matrix:
      0     1
0  7171  2124
1   289   508
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |   1087 TiB |   1087 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1071 TiB |   1071 TiB |
|       from small pool |  18208 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |   1087 TiB |   1087 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1071 TiB |   1071 TiB |
|       from small pool |  18208 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |   1087 TiB |   1087 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1071 TiB |   1071 TiB |
|       from small pool |  16662 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  25070 MiB |  16558 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  24998 MiB |  16526 MiB |
|       from small pool |     40 MiB |     44 MiB |     72 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40149 KiB | 732464 KiB | 598822 GiB | 598822 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 582055 GiB | 582055 GiB |
|       from small pool |   8416 KiB |  22549 KiB |  16766 GiB |  16766 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6957    |  209036 K  |  209032 K  |
|       from large pool |      79    |     762    |  103525 K  |  103525 K  |
|       from small pool |    4333    |    6876    |  105511 K  |  105506 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6957    |  209036 K  |  209032 K  |
|       from large pool |      79    |     762    |  103525 K  |  103525 K  |
|       from small pool |    4333    |    6876    |  105511 K  |  105506 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |    1060    |     692    |
|       from large pool |     348    |     349    |    1024    |     676    |
|       from small pool |      20    |      22    |      36    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3255    |  115936 K  |  115936 K  |
|       from large pool |      11    |     351    |   70782 K  |   70782 K  |
|       from small pool |      24    |    3245    |   45154 K  |   45154 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1087 TiB |   1087 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1071 TiB |   1071 TiB |
|       from small pool |      0 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1087 TiB |   1087 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1071 TiB |   1071 TiB |
|       from small pool |      0 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1087 TiB |   1087 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1071 TiB |   1071 TiB |
|       from small pool |      0 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  25070 MiB |  24838 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  24998 MiB |  24792 MiB |
|       from small pool |  26624 KiB |     44 MiB |     72 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 598822 GiB | 598822 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 582055 GiB | 582055 GiB |
|       from small pool |      0 KiB |  22555 KiB |  16766 GiB |  16766 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6957    |  209036 K  |  209036 K  |
|       from large pool |       2    |     762    |  103525 K  |  103525 K  |
|       from small pool |       0    |    6876    |  105511 K  |  105511 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6957    |  209036 K  |  209036 K  |
|       from large pool |       2    |     762    |  103525 K  |  103525 K  |
|       from small pool |       0    |    6876    |  105511 K  |  105511 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1060    |    1037    |
|       from large pool |      10    |     349    |    1024    |    1014    |
|       from small pool |      13    |      22    |      36    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3255    |  115938 K  |  115938 K  |
|       from large pool |       3    |     351    |   70782 K  |   70782 K  |
|       from small pool |       0    |    3245    |   45156 K  |   45156 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  9 08:52:19 2024]
Finished job 0.
1 of 1 steps (100%) done
