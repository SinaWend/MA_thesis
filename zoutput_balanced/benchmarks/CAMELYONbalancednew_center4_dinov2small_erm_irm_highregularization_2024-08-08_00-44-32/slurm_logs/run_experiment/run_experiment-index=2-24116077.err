Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  8 18:39:54 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077

 Experiment start at: 2024-08-08 18:51:43.080536
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7610747, 'precision': 0.763718, 'recall': 0.761045, 'specificity': 0.761045, 'f1': 0.7604605, 'auroc': 0.8506942, 'binary_precision': 0.73746324, 'binary_recall': 0.81122994, 'binary_specificity': 0.71086, 'binary_f1_score': 0.77258974}
confusion matrix:
       0      1
0  17994   7319
1   4784  20559
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.80129474, 'precision': 0.51983887, 'recall': 0.63264775, 'specificity': 0.63264775, 'f1': 0.4940943, 'auroc': 0.7260971, 'binary_precision': 0.056083087, 'binary_recall': 0.4554217, 'binary_specificity': 0.8098739, 'binary_f1_score': 0.0998679}
confusion matrix:
       0     1
0  13550  3181
1    226   189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6791576, 'precision': 0.5194956, 'recall': 0.55895597, 'specificity': 0.55895597, 'f1': 0.48349535, 'auroc': 0.61090547, 'binary_precision': 0.10330446, 'binary_recall': 0.41709843, 'binary_specificity': 0.70081353, 'binary_f1_score': 0.16559526}
confusion matrix:
      0     1
0  6547  2795
1   450   322
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 19:09:51.349048,epoch time: 0:18:08.268512,used: 0:18:08.268512,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8265556, 'precision': 0.8265948, 'recall': 0.82655925, 'specificity': 0.82655925, 'f1': 0.82655144, 'auroc': 0.89440525, 'binary_precision': 0.83034754, 'binary_recall': 0.8211087, 'binary_specificity': 0.8320098, 'binary_f1_score': 0.8257023}
confusion matrix:
       0      1
0  21059   4252
1   4534  20811
---- Validation: 
scalar performance:
{'acc': 0.88924533, 'precision': 0.5200891, 'recall': 0.5754945, 'specificity': 0.5754945, 'f1': 0.51900446, 'auroc': 0.7260446, 'binary_precision': 0.06042654, 'binary_recall': 0.24578314, 'binary_specificity': 0.9052059, 'binary_f1_score': 0.09700428}
confusion matrix:
       0     1
0  15145  1586
1    313   102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7988926, 'precision': 0.5063092, 'recall': 0.5114771, 'specificity': 0.5114771, 'f1': 0.5010992, 'auroc': 0.6111638, 'binary_precision': 0.087041885, 'binary_recall': 0.17227979, 'binary_specificity': 0.8506744, 'binary_f1_score': 0.11565217}
confusion matrix:
      0     1
0  7947  1395
1   639   133
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-08 19:26:45.477808,epoch time: 0:16:54.128760,used: 0:35:02.397272,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8737958, 'precision': 0.88546777, 'recall': 0.87385076, 'specificity': 0.87385076, 'f1': 0.8728447, 'auroc': 0.9211718, 'binary_precision': 0.95270175, 'binary_recall': 0.78681344, 'binary_specificity': 0.9608881, 'binary_f1_score': 0.8618477}
confusion matrix:
       0      1
0  24322    990
1   5403  19941
---- Validation: 
scalar performance:
{'acc': 0.91274935, 'precision': 0.517833, 'recall': 0.5499401, 'specificity': 0.5499401, 'f1': 0.51988184, 'auroc': 0.728341, 'binary_precision': 0.057330057, 'binary_recall': 0.16867469, 'binary_specificity': 0.9312056, 'binary_f1_score': 0.085574575}
confusion matrix:
       0     1
0  15580  1151
1    345    70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8405181, 'precision': 0.49182075, 'recall': 0.49004287, 'specificity': 0.49004287, 'f1': 0.49048272, 'auroc': 0.62450737, 'binary_precision': 0.06152242, 'binary_recall': 0.07642487, 'binary_specificity': 0.9036609, 'binary_f1_score': 0.06816869}
confusion matrix:
      0    1
0  8442  900
1   713   59
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-08 19:44:11.785335,epoch time: 0:17:26.307527,used: 0:52:28.704799,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.89448434, 'precision': 0.90371037, 'recall': 0.89453214, 'specificity': 0.89453214, 'f1': 0.8938863, 'auroc': 0.94232845, 'binary_precision': 0.9648984, 'binary_recall': 0.81889206, 'binary_specificity': 0.9701722, 'binary_f1_score': 0.8859198}
confusion matrix:
       0      1
0  24557    755
1   4590  20754
---- Validation: 
scalar performance:
{'acc': 0.87623936, 'precision': 0.5231518, 'recall': 0.5993785, 'specificity': 0.5993785, 'f1': 0.5205811, 'auroc': 0.7531148, 'binary_precision': 0.06520632, 'binary_recall': 0.30843374, 'binary_specificity': 0.89032334, 'binary_f1_score': 0.10765349}
confusion matrix:
       0     1
0  14896  1835
1    287   128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79483885, 'precision': 0.5105497, 'recall': 0.51997733, 'specificity': 0.51997733, 'f1': 0.5054054, 'auroc': 0.6561352, 'binary_precision': 0.094081, 'binary_recall': 0.19559586, 'binary_specificity': 0.8443588, 'binary_f1_score': 0.1270509}
confusion matrix:
      0     1
0  7888  1454
1   621   151
early stop counter: 1
val acc:0.8762393593788147, best validation acc: 0.9127493500709534, corresponding to test acc:                         0.8405181169509888 / 0.8405181169509888
after epoch: 4,now: 2024-08-08 20:01:14.761880,epoch time: 0:17:02.976545,used: 1:09:31.681344,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9015319, 'precision': 0.9060176, 'recall': 0.90156305, 'specificity': 0.90156305, 'f1': 0.9012641, 'auroc': 0.95308375, 'binary_precision': 0.94884235, 'binary_recall': 0.84895235, 'binary_specificity': 0.95417374, 'binary_f1_score': 0.8961223}
confusion matrix:
       0      1
0  24153   1160
1   3828  21515
---- Validation: 
scalar performance:
{'acc': 0.838038, 'precision': 0.5296721, 'recall': 0.6702741, 'specificity': 0.6702741, 'f1': 0.5196847, 'auroc': 0.77835387, 'binary_precision': 0.07395382, 'binary_recall': 0.4939759, 'binary_specificity': 0.8465722, 'binary_f1_score': 0.12864763}
confusion matrix:
       0     1
0  14164  2567
1    210   205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7499506, 'precision': 0.5310565, 'recall': 0.57826483, 'specificity': 0.57826483, 'f1': 0.5194123, 'auroc': 0.68872577, 'binary_precision': 0.124090716, 'binary_recall': 0.37564766, 'binary_specificity': 0.78088206, 'binary_f1_score': 0.18655515}
confusion matrix:
      0     1
0  7295  2047
1   482   290
early stop counter: 2
val acc:0.8380380272865295, best validation acc: 0.9127493500709534, corresponding to test acc:                         0.8405181169509888 / 0.8405181169509888
after epoch: 5,now: 2024-08-08 20:18:12.257593,epoch time: 0:16:57.495713,used: 1:26:29.177057,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.908461, 'precision': 0.91548777, 'recall': 0.90849435, 'specificity': 0.90849435, 'f1': 0.90807724, 'auroc': 0.96095705, 'binary_precision': 0.96964884, 'binary_recall': 0.8434158, 'binary_specificity': 0.97357297, 'binary_f1_score': 0.90213794}
confusion matrix:
       0      1
0  24646    669
1   3968  21373
---- Validation: 
scalar performance:
{'acc': 0.823749, 'precision': 0.5335041, 'recall': 0.70994973, 'specificity': 0.70994973, 'f1': 0.52067053, 'auroc': 0.7941681, 'binary_precision': 0.07910881, 'binary_recall': 0.5903614, 'binary_specificity': 0.829538, 'binary_f1_score': 0.13952163}
confusion matrix:
       0     1
0  13879  2852
1    170   245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7308681, 'precision': 0.5446022, 'recall': 0.6243791, 'specificity': 0.6243791, 'f1': 0.5289303, 'auroc': 0.7128203, 'binary_precision': 0.14154412, 'binary_recall': 0.49870467, 'binary_specificity': 0.7500535, 'binary_f1_score': 0.22050402}
confusion matrix:
      0     1
0  7007  2335
1   387   385
early stop counter: 3
val acc:0.8237490057945251, best validation acc: 0.9127493500709534, corresponding to test acc:                         0.8405181169509888 / 0.8405181169509888
after epoch: 6,now: 2024-08-08 20:34:50.326784,epoch time: 0:16:38.069191,used: 1:43:07.246248,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9100798, 'precision': 0.9179728, 'recall': 0.9101232, 'specificity': 0.9101232, 'f1': 0.9096595, 'auroc': 0.9640602, 'binary_precision': 0.9755685, 'binary_recall': 0.8413431, 'binary_specificity': 0.9789033, 'binary_f1_score': 0.90349776}
confusion matrix:
       0      1
0  24778    534
1   4021  21323
---- Validation: 
scalar performance:
{'acc': 0.8281815, 'precision': 0.53556794, 'recall': 0.7192706, 'specificity': 0.7192706, 'f1': 0.5250394, 'auroc': 0.80303454, 'binary_precision': 0.08275635, 'binary_recall': 0.6048193, 'binary_specificity': 0.8337218, 'binary_f1_score': 0.14559165}
confusion matrix:
       0     1
0  13949  2782
1    164   251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7382836, 'precision': 0.5509091, 'recall': 0.64087033, 'specificity': 0.64087033, 'f1': 0.5384496, 'auroc': 0.728487, 'binary_precision': 0.15109788, 'binary_recall': 0.52590674, 'binary_specificity': 0.75583386, 'binary_f1_score': 0.23474993}
confusion matrix:
      0     1
0  7061  2281
1   366   406
early stop counter: 4
val acc:0.8281815052032471, best validation acc: 0.9127493500709534, corresponding to test acc:                         0.8405181169509888 / 0.8405181169509888
after epoch: 7,now: 2024-08-08 20:52:04.547895,epoch time: 0:17:14.221111,used: 2:00:21.467359,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9122315, 'precision': 0.9195926, 'recall': 0.91226554, 'specificity': 0.91226554, 'f1': 0.9118496, 'auroc': 0.9671899, 'binary_precision': 0.97529685, 'binary_recall': 0.8459808, 'binary_specificity': 0.97855026, 'binary_f1_score': 0.90604794}
confusion matrix:
       0      1
0  24772    543
1   3903  21438
---- Validation: 
scalar performance:
{'acc': 0.8038026, 'precision': 0.53541416, 'recall': 0.74437666, 'specificity': 0.74437666, 'f1': 0.516612, 'auroc': 0.8206016, 'binary_precision': 0.08051209, 'binary_recall': 0.68192774, 'binary_specificity': 0.80682564, 'binary_f1_score': 0.14402035}
confusion matrix:
       0     1
0  13499  3232
1    132   283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7148507, 'precision': 0.5631763, 'recall': 0.69175935, 'specificity': 0.69175935, 'f1': 0.5428333, 'auroc': 0.7508185, 'binary_precision': 0.16347992, 'binary_recall': 0.66450775, 'binary_specificity': 0.7190109, 'binary_f1_score': 0.26240408}
confusion matrix:
      0     1
0  6717  2625
1   259   513
early stop counter: 5
val acc:0.8038026094436646, best validation acc: 0.9127493500709534, corresponding to test acc:                         0.8405181169509888 / 0.8405181169509888
after epoch: 8,now: 2024-08-08 21:09:31.081990,epoch time: 0:17:26.534095,used: 2:17:48.001454,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.922181, 'precision': 0.9283738, 'recall': 0.92221904, 'specificity': 0.92221904, 'f1': 0.9219035, 'auroc': 0.9731804, 'binary_precision': 0.9800377, 'binary_recall': 0.86201864, 'binary_specificity': 0.98241943, 'binary_f1_score': 0.91724753}
confusion matrix:
       0      1
0  24867    445
1   3497  21847
---- Validation: 
scalar performance:
{'acc': 0.8330223, 'precision': 0.54057425, 'recall': 0.74759954, 'specificity': 0.74759954, 'f1': 0.5337298, 'auroc': 0.828797, 'binary_precision': 0.091182366, 'binary_recall': 0.6578313, 'binary_specificity': 0.8373678, 'binary_f1_score': 0.16016428}
confusion matrix:
       0     1
0  14010  2721
1    142   273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.742634, 'precision': 0.5682083, 'recall': 0.6943219, 'specificity': 0.6943219, 'f1': 0.5589515, 'auroc': 0.76656234, 'binary_precision': 0.17477797, 'binary_recall': 0.6373057, 'binary_specificity': 0.75133806, 'binary_f1_score': 0.27432394}
confusion matrix:
      0     1
0  7019  2323
1   280   492
early stop counter: 6
val acc:0.8330222964286804, best validation acc: 0.9127493500709534, corresponding to test acc:                         0.8405181169509888 / 0.8405181169509888
after epoch: 9,now: 2024-08-08 21:27:17.963851,epoch time: 0:17:46.881861,used: 2:35:34.883315,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9270175, 'precision': 0.93099725, 'recall': 0.9270499, 'specificity': 0.9270499, 'f1': 0.92685235, 'auroc': 0.97471666, 'binary_precision': 0.9725812, 'binary_recall': 0.878911, 'binary_specificity': 0.9751887, 'binary_f1_score': 0.9233767}
confusion matrix:
       0      1
0  24683    628
1   3069  22276
---- Validation: 
scalar performance:
{'acc': 0.8228741, 'precision': 0.5424254, 'recall': 0.77412283, 'specificity': 0.77412283, 'f1': 0.53295046, 'auroc': 0.84197736, 'binary_precision': 0.09310987, 'binary_recall': 0.72289157, 'binary_specificity': 0.82535416, 'binary_f1_score': 0.16497113}
confusion matrix:
       0     1
0  13809  2922
1    115   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7276053, 'precision': 0.5746058, 'recall': 0.7248061, 'specificity': 0.7248061, 'f1': 0.55976045, 'auroc': 0.78667414, 'binary_precision': 0.17985147, 'binary_recall': 0.7215026, 'binary_specificity': 0.7281096, 'binary_f1_score': 0.2879297}
confusion matrix:
      0     1
0  6802  2540
1   215   557
early stop counter: 7
val acc:0.822874128818512, best validation acc: 0.9127493500709534, corresponding to test acc:                         0.8405181169509888 / 0.8405181169509888
after epoch: 10,now: 2024-08-08 21:44:18.346739,epoch time: 0:17:00.382888,used: 2:52:35.266203,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.92895216, 'precision': 0.93335384, 'recall': 0.928982, 'specificity': 0.928982, 'f1': 0.92877465, 'auroc': 0.97723365, 'binary_precision': 0.97717696, 'binary_recall': 0.8785069, 'binary_specificity': 0.9794572, 'binary_f1_score': 0.92521876}
confusion matrix:
       0      1
0  24793    520
1   3079  22264
---- Validation: 
scalar performance:
{'acc': 0.83704656, 'precision': 0.5466309, 'recall': 0.7837347, 'specificity': 0.7837347, 'f1': 0.5436567, 'auroc': 0.84902805, 'binary_precision': 0.10124036, 'binary_recall': 0.72771084, 'binary_specificity': 0.8397585, 'binary_f1_score': 0.17775163}
confusion matrix:
       0     1
0  14050  2681
1    113   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74332607, 'precision': 0.57912636, 'recall': 0.7309395, 'specificity': 0.7309395, 'f1': 0.57083577, 'auroc': 0.79789877, 'binary_precision': 0.1887372, 'binary_recall': 0.71632123, 'binary_specificity': 0.7455577, 'binary_f1_score': 0.2987574}
confusion matrix:
      0     1
0  6965  2377
1   219   553
early stop counter: 8
val acc:0.8370465636253357, best validation acc: 0.9127493500709534, corresponding to test acc:                         0.8405181169509888 / 0.8405181169509888
after epoch: 11,now: 2024-08-08 22:01:33.764883,epoch time: 0:17:15.418144,used: 3:09:50.684347,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9349534, 'precision': 0.93753123, 'recall': 0.9349777, 'specificity': 0.9349777, 'f1': 0.93485993, 'auroc': 0.9780581, 'binary_precision': 0.9712735, 'binary_recall': 0.8965041, 'binary_specificity': 0.9734513, 'binary_f1_score': 0.93239224}
confusion matrix:
       0      1
0  24640    672
1   2623  22721
---- Validation: 
scalar performance:
{'acc': 0.81074303, 'precision': 0.5423289, 'recall': 0.78905565, 'specificity': 0.78905565, 'f1': 0.52858526, 'auroc': 0.85755956, 'binary_precision': 0.09174842, 'binary_recall': 0.76626503, 'binary_specificity': 0.81184626, 'binary_f1_score': 0.1638753}
confusion matrix:
       0     1
0  13583  3148
1     97   318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70773184, 'precision': 0.57802415, 'recall': 0.7473204, 'specificity': 0.7473204, 'f1': 0.5544704, 'auroc': 0.8072802, 'binary_precision': 0.1797654, 'binary_recall': 0.79404145, 'binary_specificity': 0.70059943, 'binary_f1_score': 0.29316118}
confusion matrix:
      0     1
0  6545  2797
1   159   613
early stop counter: 9
val acc:0.8107430338859558, best validation acc: 0.9127493500709534, corresponding to test acc:                         0.8405181169509888 / 0.8405181169509888
after epoch: 12,now: 2024-08-08 22:18:18.273324,epoch time: 0:16:44.508441,used: 3:26:35.192788,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9348152, 'precision': 0.93787336, 'recall': 0.93484336, 'specificity': 0.93484336, 'f1': 0.93470407, 'auroc': 0.98046494, 'binary_precision': 0.974635, 'binary_recall': 0.8929572, 'binary_specificity': 0.9767295, 'binary_f1_score': 0.93201}
confusion matrix:
       0      1
0  24722    589
1   2713  22632
---- Validation: 
scalar performance:
{'acc': 0.82369065, 'precision': 0.54552484, 'recall': 0.79569006, 'specificity': 0.79569006, 'f1': 0.5375668, 'auroc': 0.8593497, 'binary_precision': 0.098027125, 'binary_recall': 0.76626503, 'binary_specificity': 0.8251151, 'binary_f1_score': 0.17381798}
confusion matrix:
       0     1
0  13805  2926
1     97   318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7392723, 'precision': 0.5828311, 'recall': 0.7465695, 'specificity': 0.7465695, 'f1': 0.57302606, 'auroc': 0.8079941, 'binary_precision': 0.19234575, 'binary_recall': 0.7551814, 'binary_specificity': 0.7379576, 'binary_f1_score': 0.30660003}
confusion matrix:
      0     1
0  6894  2448
1   189   583
early stop counter: 10
val acc:0.82369065284729, best validation acc: 0.9127493500709534, corresponding to test acc:                         0.8405181169509888 / 0.8405181169509888
after epoch: 13,now: 2024-08-08 22:34:45.777257,epoch time: 0:16:27.503933,used: 3:43:02.696721,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9355259, 'precision': 0.9390874, 'recall': 0.9355544, 'specificity': 0.9355544, 'f1': 0.93539774, 'auroc': 0.9804292, 'binary_precision': 0.97879076, 'binary_recall': 0.8904277, 'binary_specificity': 0.9806811, 'binary_f1_score': 0.9325206}
confusion matrix:
       0      1
0  24823    489
1   2777  22567
---- Validation: 
scalar performance:
{'acc': 0.8381547, 'precision': 0.54830736, 'recall': 0.793702, 'specificity': 0.793702, 'f1': 0.54640347, 'auroc': 0.86215734, 'binary_precision': 0.10402685, 'binary_recall': 0.74698794, 'binary_specificity': 0.840416, 'binary_f1_score': 0.1826215}
confusion matrix:
       0     1
0  14061  2670
1    105   310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75657505, 'precision': 0.5864998, 'recall': 0.7470236, 'specificity': 0.7470236, 'f1': 0.58384264, 'auroc': 0.81482047, 'binary_precision': 0.2009908, 'binary_recall': 0.7357513, 'binary_specificity': 0.7582959, 'binary_f1_score': 0.31573093}
confusion matrix:
      0     1
0  7084  2258
1   204   568
early stop counter: 11
val acc:0.838154673576355, best validation acc: 0.9127493500709534, corresponding to test acc:                         0.8405181169509888 / 0.8405181169509888
after epoch: 14,now: 2024-08-08 22:51:29.274471,epoch time: 0:16:43.497214,used: 3:59:46.193935,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9367696, 'precision': 0.94083333, 'recall': 0.9367924, 'specificity': 0.9367924, 'f1': 0.93662584, 'auroc': 0.98154134, 'binary_precision': 0.9832773, 'binary_recall': 0.8887135, 'binary_specificity': 0.9848712, 'binary_f1_score': 0.933607}
confusion matrix:
       0      1
0  24933    383
1   2820  22520
---- Validation: 
scalar performance:
{'acc': 0.8392628, 'precision': 0.5494851, 'recall': 0.80014443, 'specificity': 0.80014443, 'f1': 0.5484433, 'auroc': 0.87071025, 'binary_precision': 0.106024906, 'binary_recall': 0.7590361, 'binary_specificity': 0.84125274, 'binary_f1_score': 0.18606023}
confusion matrix:
       0     1
0  14075  2656
1    100   315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76052994, 'precision': 0.5902287, 'recall': 0.7568884, 'specificity': 0.7568884, 'f1': 0.58935046, 'auroc': 0.82803184, 'binary_precision': 0.20661451, 'binary_recall': 0.75259066, 'binary_specificity': 0.76118606, 'binary_f1_score': 0.32421875}
confusion matrix:
      0     1
0  7111  2231
1   191   581
early stop counter: 12
val acc:0.8392627835273743, best validation acc: 0.9127493500709534, corresponding to test acc:                         0.8405181169509888 / 0.8405181169509888
after epoch: 15,now: 2024-08-08 23:08:11.470149,epoch time: 0:16:42.195678,used: 4:16:28.389613,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_51_42_seed_0_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:16:28.389613 at 2024-08-08 23:08:11.470149
persisted model performance metric: 

scalar performance:
{'acc': 0.8405181, 'precision': 0.49182075, 'recall': 0.49004287, 'specificity': 0.49004287, 'f1': 0.49048272, 'auroc': 0.62450737, 'binary_precision': 0.06152242, 'binary_recall': 0.07642487, 'binary_specificity': 0.9036609, 'binary_f1_score': 0.06816869}
confusion matrix:
      0    1
0  8442  900
1   713   59
oracle model performance metric: 

scalar performance:
{'acc': 0.8405181, 'precision': 0.49182075, 'recall': 0.49004287, 'specificity': 0.49004287, 'f1': 0.49048272, 'auroc': 0.62450737, 'binary_precision': 0.06152242, 'binary_recall': 0.07642487, 'binary_specificity': 0.9036609, 'binary_f1_score': 0.06816869}
confusion matrix:
      0    1
0  8442  900
1   713   59
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198876 KiB |   7828 MiB | 362921 GiB | 362921 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |  18214 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198876 KiB |   7828 MiB | 362921 GiB | 362921 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |  18214 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   7827 MiB | 362901 GiB | 362901 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 357414 GiB | 357414 GiB |
|       from small pool |  16663 KiB |     36 MiB |   5486 GiB |   5486 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  61220 KiB | 732464 KiB | 204855 GiB | 204855 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 199353 GiB | 199353 GiB |
|       from small pool |  10458 KiB |  12158 KiB |   5501 GiB |   5501 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    6827    |   68596 K  |   68592 K  |
|       from large pool |      79    |     762    |   33765 K  |   33765 K  |
|       from small pool |    4345    |    6746    |   34830 K  |   34826 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    6827    |   68596 K  |   68592 K  |
|       from large pool |      79    |     762    |   33765 K  |   33765 K  |
|       from small pool |    4345    |    6746    |   34830 K  |   34826 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3188    |   40268 K  |   40268 K  |
|       from large pool |      10    |     350    |   25587 K  |   25587 K  |
|       from small pool |      25    |    3178    |   14680 K  |   14680 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 362921 GiB | 362921 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |      0 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 362921 GiB | 362921 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |      0 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 362901 GiB | 362901 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 357414 GiB | 357414 GiB |
|       from small pool |      0 KiB |     36 MiB |   5486 GiB |   5486 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 260096 KiB |   8530 MiB |   8530 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  28672 KiB |     44 MiB |     44 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 204855 GiB | 204855 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 199353 GiB | 199353 GiB |
|       from small pool |      0 KiB |  24597 KiB |   5501 GiB |   5501 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   68596 K  |   68596 K  |
|       from large pool |       2    |     762    |   33765 K  |   33765 K  |
|       from small pool |       0    |    6746    |   34830 K  |   34830 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   68596 K  |   68596 K  |
|       from large pool |       2    |     762    |   33765 K  |   33765 K  |
|       from small pool |       0    |    6746    |   34830 K  |   34830 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     371    |     371    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      14    |      22    |      22    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3188    |   40270 K  |   40270 K  |
|       from large pool |       3    |     350    |   25587 K  |   25587 K  |
|       from small pool |       0    |    3178    |   14682 K  |   14682 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 362921 GiB | 362921 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |      0 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 362921 GiB | 362921 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |      0 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 362901 GiB | 362901 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 357414 GiB | 357414 GiB |
|       from small pool |      0 KiB |     36 MiB |   5486 GiB |   5486 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 260096 KiB |   8530 MiB |   8530 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  28672 KiB |     44 MiB |     44 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 204855 GiB | 204855 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 199353 GiB | 199353 GiB |
|       from small pool |      0 KiB |  24597 KiB |   5501 GiB |   5501 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   68596 K  |   68596 K  |
|       from large pool |       2    |     762    |   33765 K  |   33765 K  |
|       from small pool |       0    |    6746    |   34830 K  |   34830 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   68596 K  |   68596 K  |
|       from large pool |       2    |     762    |   33765 K  |   33765 K  |
|       from small pool |       0    |    6746    |   34830 K  |   34830 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     371    |     371    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      14    |      22    |      22    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3188    |   40270 K  |   40270 K  |
|       from large pool |       3    |     350    |   25587 K  |   25587 K  |
|       from small pool |       0    |    3178    |   14682 K  |   14682 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077

 Experiment start at: 2024-08-08 23:29:08.371242
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7030807, 'precision': 0.7063782, 'recall': 0.7030307, 'specificity': 0.7030307, 'f1': 0.70185673, 'auroc': 0.7715302, 'binary_precision': 0.6804872, 'binary_recall': 0.7665513, 'binary_specificity': 0.63951015, 'binary_f1_score': 0.7209599}
confusion matrix:
       0      1
0  16241   9155
1   5938  19498
---- Validation: 
scalar performance:
{'acc': 0.85902005, 'precision': 0.5031891, 'recall': 0.5140593, 'specificity': 0.5140593, 'f1': 0.487477, 'auroc': 0.6843426, 'binary_precision': 0.03076195, 'binary_recall': 0.15081206, 'binary_specificity': 0.8773065, 'binary_f1_score': 0.051100627}
confusion matrix:
       0     1
0  14644  2048
1    366    65
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7839659, 'precision': 0.48177296, 'recall': 0.46565178, 'specificity': 0.46565178, 'f1': 0.46875048, 'auroc': 0.5306405, 'binary_precision': 0.044202436, 'binary_recall': 0.09114927, 'binary_specificity': 0.8401543, 'binary_f1_score': 0.059534084}
confusion matrix:
      0     1
0  7842  1492
1   688    69
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 23:47:30.301256,epoch time: 0:18:21.930014,used: 0:18:21.930014,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.78251886, 'precision': 0.78252864, 'recall': 0.78252125, 'specificity': 0.78252125, 'f1': 0.7825179, 'auroc': 0.8557986, 'binary_precision': 0.7844091, 'binary_recall': 0.779691, 'binary_specificity': 0.78535146, 'binary_f1_score': 0.782043}
confusion matrix:
       0      1
0  19944   5451
1   5604  19833
---- Validation: 
scalar performance:
{'acc': 0.86620337, 'precision': 0.5001916, 'recall': 0.5007916, 'specificity': 0.5007916, 'f1': 0.48495194, 'auroc': 0.70481503, 'binary_precision': 0.025510205, 'binary_recall': 0.11600928, 'binary_specificity': 0.8855739, 'binary_f1_score': 0.041823503}
confusion matrix:
       0     1
0  14782  1910
1    381    50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.781984, 'precision': 0.4893109, 'recall': 0.47914684, 'specificity': 0.47914684, 'f1': 0.47716573, 'auroc': 0.6006044, 'binary_precision': 0.057090238, 'binary_recall': 0.12285337, 'binary_specificity': 0.83544034, 'binary_f1_score': 0.07795473}
confusion matrix:
      0     1
0  7798  1536
1   664    93
better model found
persisted
after epoch: 2,now: 2024-08-09 00:04:35.409374,epoch time: 0:17:05.108118,used: 0:35:27.038132,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8253659, 'precision': 0.8267188, 'recall': 0.825395, 'specificity': 0.825395, 'f1': 0.82519376, 'auroc': 0.8921368, 'binary_precision': 0.8479704, 'binary_recall': 0.7932702, 'binary_specificity': 0.8575198, 'binary_f1_score': 0.81970876}
confusion matrix:
       0      1
0  21775   3618
1   5259  20180
---- Validation: 
scalar performance:
{'acc': 0.8742043, 'precision': 0.5049896, 'recall': 0.51958716, 'specificity': 0.51958716, 'f1': 0.49393955, 'auroc': 0.73137844, 'binary_precision': 0.03407247, 'binary_recall': 0.14617169, 'binary_specificity': 0.8930026, 'binary_f1_score': 0.055263154}
confusion matrix:
       0     1
0  14906  1786
1    368    63
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7834704, 'precision': 0.488345, 'recall': 0.4775226, 'specificity': 0.4775226, 'f1': 0.47635302, 'auroc': 0.6347975, 'binary_precision': 0.055417184, 'binary_recall': 0.11756935, 'binary_specificity': 0.8374759, 'binary_f1_score': 0.07532797}
confusion matrix:
      0     1
0  7817  1517
1   668    89
better model found
persisted
after epoch: 3,now: 2024-08-09 00:21:31.944406,epoch time: 0:16:56.535032,used: 0:52:23.573164,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.853006, 'precision': 0.85599196, 'recall': 0.8530438, 'specificity': 0.8530438, 'f1': 0.85270655, 'auroc': 0.9121394, 'binary_precision': 0.88880235, 'binary_recall': 0.8072493, 'binary_specificity': 0.89883834, 'binary_f1_score': 0.84606516}
confusion matrix:
       0      1
0  22826   2569
1   4903  20534
---- Validation: 
scalar performance:
{'acc': 0.88506687, 'precision': 0.5042348, 'recall': 0.51498747, 'specificity': 0.51498747, 'f1': 0.49542406, 'auroc': 0.74558127, 'binary_precision': 0.032826748, 'binary_recall': 0.12529002, 'binary_specificity': 0.9046849, 'binary_f1_score': 0.05202312}
confusion matrix:
       0     1
0  15101  1591
1    377    54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977406, 'precision': 0.48748058, 'recall': 0.47795314, 'specificity': 0.47795314, 'f1': 0.4783443, 'auroc': 0.6511998, 'binary_precision': 0.053546593, 'binary_recall': 0.10171731, 'binary_specificity': 0.854189, 'binary_f1_score': 0.07015945}
confusion matrix:
      0     1
0  7973  1361
1   680    77
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-09 00:38:55.991804,epoch time: 0:17:24.047398,used: 1:09:47.620562,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.86107177, 'precision': 0.86339855, 'recall': 0.8611033, 'specificity': 0.8611033, 'f1': 0.8608563, 'auroc': 0.923301, 'binary_precision': 0.89267397, 'binary_recall': 0.8210804, 'binary_specificity': 0.90112615, 'binary_f1_score': 0.85538167}
confusion matrix:
       0      1
0  22885   2511
1   4551  20885
---- Validation: 
scalar performance:
{'acc': 0.88530046, 'precision': 0.5083206, 'recall': 0.5297991, 'specificity': 0.5297991, 'f1': 0.50138897, 'auroc': 0.7590712, 'binary_precision': 0.040191963, 'binary_recall': 0.15545243, 'binary_specificity': 0.9041457, 'binary_f1_score': 0.063870355}
confusion matrix:
       0     1
0  15092  1600
1    364    67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8035874, 'precision': 0.48963135, 'recall': 0.48232752, 'specificity': 0.48232752, 'f1': 0.48198852, 'auroc': 0.663615, 'binary_precision': 0.057122197, 'binary_recall': 0.104359314, 'binary_specificity': 0.8602957, 'binary_f1_score': 0.073831774}
confusion matrix:
      0     1
0  8030  1304
1   678    79
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-09 00:55:59.972321,epoch time: 0:17:03.980517,used: 1:26:51.601079,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8767312, 'precision': 0.8811374, 'recall': 0.8767756, 'specificity': 0.8767756, 'f1': 0.87638295, 'auroc': 0.9335445, 'binary_precision': 0.92232454, 'binary_recall': 0.8229744, 'binary_specificity': 0.93057686, 'binary_f1_score': 0.8698218}
confusion matrix:
       0      1
0  23632   1763
1   4503  20934
---- Validation: 
scalar performance:
{'acc': 0.89417744, 'precision': 0.5087847, 'recall': 0.5287014, 'specificity': 0.5287014, 'f1': 0.5039839, 'auroc': 0.7654872, 'binary_precision': 0.041196015, 'binary_recall': 0.1438515, 'binary_specificity': 0.9135514, 'binary_f1_score': 0.06404959}
confusion matrix:
       0     1
0  15249  1443
1    369    62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8076504, 'precision': 0.49659884, 'recall': 0.4942347, 'specificity': 0.4942347, 'f1': 0.4908157, 'auroc': 0.6877066, 'binary_precision': 0.069141194, 'binary_recall': 0.12549537, 'binary_specificity': 0.86297405, 'binary_f1_score': 0.08916002}
confusion matrix:
      0     1
0  8055  1279
1   662    95
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-09 01:13:10.258347,epoch time: 0:17:10.286026,used: 1:44:01.887105,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.88035095, 'precision': 0.8836617, 'recall': 0.88038754, 'specificity': 0.88038754, 'f1': 0.8800994, 'auroc': 0.93710065, 'binary_precision': 0.91949886, 'binary_recall': 0.8338968, 'binary_specificity': 0.9268783, 'binary_f1_score': 0.8746082}
confusion matrix:
       0      1
0  23539   1857
1   4225  21211
---- Validation: 
scalar performance:
{'acc': 0.8930678, 'precision': 0.5140456, 'recall': 0.5473447, 'specificity': 0.5473447, 'f1': 0.511337, 'auroc': 0.77497566, 'binary_precision': 0.050706033, 'binary_recall': 0.18329467, 'binary_specificity': 0.91139466, 'binary_f1_score': 0.079436906}
confusion matrix:
       0     1
0  15213  1479
1    352    79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79942524, 'precision': 0.50531596, 'recall': 0.5098174, 'specificity': 0.5098174, 'f1': 0.4996103, 'auroc': 0.6955919, 'binary_precision': 0.08404465, 'binary_recall': 0.16908851, 'binary_specificity': 0.85054636, 'binary_f1_score': 0.1122807}
confusion matrix:
      0     1
0  7939  1395
1   629   128
early stop counter: 1
val acc:0.8930677771568298, best validation acc: 0.8941774368286133, corresponding to test acc:                         0.8076503872871399 / 0.8076503872871399
after epoch: 7,now: 2024-08-09 01:30:16.027372,epoch time: 0:17:05.769025,used: 2:01:07.656130,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.88764954, 'precision': 0.89237803, 'recall': 0.88769054, 'specificity': 0.88769054, 'f1': 0.8873176, 'auroc': 0.9441339, 'binary_precision': 0.9356392, 'binary_recall': 0.83275014, 'binary_specificity': 0.942631, 'binary_f1_score': 0.88120157}
confusion matrix:
       0      1
0  23940   1457
1   4254  21181
---- Validation: 
scalar performance:
{'acc': 0.892951, 'precision': 0.52115464, 'recall': 0.57327795, 'specificity': 0.57327795, 'f1': 0.52161884, 'auroc': 0.78725624, 'binary_precision': 0.06351183, 'binary_recall': 0.23665893, 'binary_specificity': 0.90989697, 'binary_f1_score': 0.10014728}
confusion matrix:
       0     1
0  15188  1504
1    329   102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7965514, 'precision': 0.5227104, 'recall': 0.545287, 'specificity': 0.545287, 'f1': 0.519918, 'auroc': 0.7202117, 'binary_precision': 0.11290322, 'binary_recall': 0.24966975, 'binary_specificity': 0.84090424, 'binary_f1_score': 0.15549156}
confusion matrix:
      0     1
0  7849  1485
1   568   189
early stop counter: 2
val acc:0.8929510116577148, best validation acc: 0.8941774368286133, corresponding to test acc:                         0.8076503872871399 / 0.8076503872871399
after epoch: 8,now: 2024-08-09 01:47:09.693360,epoch time: 0:16:53.665988,used: 2:18:01.322118,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8932365, 'precision': 0.89941514, 'recall': 0.893288, 'specificity': 0.893288, 'f1': 0.89283097, 'auroc': 0.9498732, 'binary_precision': 0.94929945, 'binary_recall': 0.8310335, 'binary_specificity': 0.95554245, 'binary_f1_score': 0.8862383}
confusion matrix:
       0      1
0  24266   1129
1   4298  21139
---- Validation: 
scalar performance:
{'acc': 0.8993751, 'precision': 0.52324456, 'recall': 0.5754428, 'specificity': 0.5754428, 'f1': 0.52581304, 'auroc': 0.7926508, 'binary_precision': 0.06760375, 'binary_recall': 0.23433875, 'binary_specificity': 0.9165468, 'binary_f1_score': 0.10493507}
confusion matrix:
       0     1
0  15299  1393
1    330   101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8060648, 'precision': 0.53883004, 'recall': 0.5771346, 'specificity': 0.5771346, 'f1': 0.54106295, 'auroc': 0.74432635, 'binary_precision': 0.13985594, 'binary_recall': 0.30779392, 'binary_specificity': 0.84647524, 'binary_f1_score': 0.19232357}
confusion matrix:
      0     1
0  7901  1433
1   524   233
better model found
persisted
after epoch: 9,now: 2024-08-09 02:04:55.329734,epoch time: 0:17:45.636374,used: 2:35:46.958492,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9001023, 'precision': 0.9068798, 'recall': 0.90015316, 'specificity': 0.90015316, 'f1': 0.8996928, 'auroc': 0.9560999, 'binary_precision': 0.95959, 'binary_recall': 0.83554804, 'binary_specificity': 0.9647582, 'binary_f1_score': 0.8932834}
confusion matrix:
       0      1
0  24501    895
1   4183  21253
---- Validation: 
scalar performance:
{'acc': 0.90708405, 'precision': 0.52729326, 'recall': 0.58165705, 'specificity': 0.58165705, 'f1': 0.53280234, 'auroc': 0.8015065, 'binary_precision': 0.07540263, 'binary_recall': 0.23897912, 'binary_specificity': 0.924335, 'binary_f1_score': 0.1146355}
confusion matrix:
       0     1
0  15429  1263
1    328   103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.820335, 'precision': 0.534923, 'recall': 0.5617848, 'specificity': 0.5617848, 'f1': 0.5380957, 'auroc': 0.75131524, 'binary_precision': 0.13485478, 'binary_recall': 0.25759578, 'binary_specificity': 0.86597383, 'binary_f1_score': 0.17703132}
confusion matrix:
      0     1
0  8083  1251
1   562   195
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-08-09 02:22:47.791465,epoch time: 0:17:52.461731,used: 2:53:39.420223,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9003777, 'precision': 0.9097556, 'recall': 0.90044624, 'specificity': 0.90044624, 'f1': 0.89981544, 'auroc': 0.95678484, 'binary_precision': 0.9719713, 'binary_recall': 0.82471794, 'binary_specificity': 0.97617453, 'binary_f1_score': 0.89231026}
confusion matrix:
       0      1
0  24788    605
1   4459  20980
---- Validation: 
scalar performance:
{'acc': 0.9149098, 'precision': 0.52850115, 'recall': 0.5766299, 'specificity': 0.5766299, 'f1': 0.5353333, 'auroc': 0.80396986, 'binary_precision': 0.078125, 'binary_recall': 0.22041763, 'binary_specificity': 0.9328421, 'binary_f1_score': 0.11536127}
confusion matrix:
       0     1
0  15571  1121
1    336    95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8276682, 'precision': 0.54638344, 'recall': 0.5809222, 'specificity': 0.5809222, 'f1': 0.55266625, 'auroc': 0.76553214, 'binary_precision': 0.15471168, 'binary_recall': 0.29062086, 'binary_specificity': 0.8712235, 'binary_f1_score': 0.20192751}
confusion matrix:
      0     1
0  8132  1202
1   537   220
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-08-09 02:39:58.751721,epoch time: 0:17:10.960256,used: 3:10:50.380479,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9082861, 'precision': 0.9152029, 'recall': 0.90833443, 'specificity': 0.90833443, 'f1': 0.90790963, 'auroc': 0.96291083, 'binary_precision': 0.96898, 'binary_recall': 0.8437193, 'binary_specificity': 0.97294956, 'binary_f1_score': 0.90202177}
confusion matrix:
       0      1
0  24710    687
1   3975  21460
---- Validation: 
scalar performance:
{'acc': 0.91339135, 'precision': 0.5373061, 'recall': 0.6063647, 'specificity': 0.6063647, 'f1': 0.54784065, 'auroc': 0.8116975, 'binary_precision': 0.094135806, 'binary_recall': 0.28306264, 'binary_specificity': 0.9296669, 'binary_f1_score': 0.14128546}
confusion matrix:
       0     1
0  15518  1174
1    309   122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8290556, 'precision': 0.5543655, 'recall': 0.5968455, 'specificity': 0.5968455, 'f1': 0.56260484, 'auroc': 0.7731919, 'binary_precision': 0.16803841, 'binary_recall': 0.32364598, 'binary_specificity': 0.870045, 'binary_f1_score': 0.22121897}
confusion matrix:
      0     1
0  8121  1213
1   512   245
new oracle model saved
early stop counter: 1
val acc:0.9133913516998291, best validation acc: 0.9149097800254822, corresponding to test acc:                         0.8276681900024414 / 0.8290556073188782
after epoch: 12,now: 2024-08-09 02:57:42.885644,epoch time: 0:17:44.133923,used: 3:28:34.514402,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9124961, 'precision': 0.9165783, 'recall': 0.9125351, 'specificity': 0.9125351, 'f1': 0.91228664, 'auroc': 0.9648025, 'binary_precision': 0.9580133, 'binary_recall': 0.86295015, 'binary_specificity': 0.96212, 'binary_f1_score': 0.9080004}
confusion matrix:
       0      1
0  24434    962
1   3486  21950
---- Validation: 
scalar performance:
{'acc': 0.90685046, 'precision': 0.55016196, 'recall': 0.66516745, 'specificity': 0.66516745, 'f1': 0.5661231, 'auroc': 0.82525325, 'binary_precision': 0.11660079, 'binary_recall': 0.41067284, 'binary_specificity': 0.9196621, 'binary_f1_score': 0.1816316}
confusion matrix:
       0     1
0  15351  1341
1    254   177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81538004, 'precision': 0.565924, 'recall': 0.6361871, 'specificity': 0.6361871, 'f1': 0.5757388, 'auroc': 0.7816638, 'binary_precision': 0.184, 'binary_recall': 0.42536327, 'binary_specificity': 0.8470109, 'binary_f1_score': 0.25688076}
confusion matrix:
      0     1
0  7906  1428
1   435   322
early stop counter: 2
val acc:0.9068504571914673, best validation acc: 0.9149097800254822, corresponding to test acc:                         0.8276681900024414 / 0.8290556073188782
after epoch: 13,now: 2024-08-09 03:15:32.762280,epoch time: 0:17:49.876636,used: 3:46:24.391038,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9181225, 'precision': 0.9227805, 'recall': 0.9181638, 'specificity': 0.9181638, 'f1': 0.91790164, 'auroc': 0.9696076, 'binary_precision': 0.967355, 'binary_recall': 0.8655842, 'binary_specificity': 0.9707434, 'binary_f1_score': 0.91364425}
confusion matrix:
       0      1
0  24653    743
1   3419  22017
---- Validation: 
scalar performance:
{'acc': 0.9120481, 'precision': 0.5558798, 'recall': 0.6757444, 'specificity': 0.6757444, 'f1': 0.5749249, 'auroc': 0.8308115, 'binary_precision': 0.12751213, 'binary_recall': 0.42691416, 'binary_specificity': 0.9245747, 'binary_f1_score': 0.19637139}
confusion matrix:
       0     1
0  15433  1259
1    247   184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8248935, 'precision': 0.57985866, 'recall': 0.6631792, 'specificity': 0.6631792, 'f1': 0.59426236, 'auroc': 0.7982764, 'binary_precision': 0.207416, 'binary_recall': 0.4729194, 'binary_specificity': 0.85343903, 'binary_f1_score': 0.28836086}
confusion matrix:
      0     1
0  7966  1368
1   399   358
early stop counter: 3
val acc:0.9120481014251709, best validation acc: 0.9149097800254822, corresponding to test acc:                         0.8276681900024414 / 0.8290556073188782
after epoch: 14,now: 2024-08-09 03:33:00.252051,epoch time: 0:17:27.489771,used: 4:03:51.880809,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.91668636, 'precision': 0.921255, 'recall': 0.9167274, 'specificity': 0.9167274, 'f1': 0.9164652, 'auroc': 0.9704257, 'binary_precision': 0.96532196, 'binary_recall': 0.86456203, 'binary_specificity': 0.96889275, 'binary_f1_score': 0.91216785}
confusion matrix:
       0      1
0  24606    790
1   3445  21991
---- Validation: 
scalar performance:
{'acc': 0.9074928, 'precision': 0.5580493, 'recall': 0.6960107, 'specificity': 0.6960107, 'f1': 0.5778545, 'auroc': 0.83909655, 'binary_precision': 0.13068546, 'binary_recall': 0.47331786, 'binary_specificity': 0.91870356, 'binary_f1_score': 0.20481929}
confusion matrix:
       0     1
0  15335  1357
1    227   204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8280646, 'precision': 0.58032924, 'recall': 0.6606449, 'specificity': 0.6606449, 'f1': 0.59514254, 'auroc': 0.79764235, 'binary_precision': 0.20892857, 'binary_recall': 0.4636724, 'binary_specificity': 0.8576173, 'binary_f1_score': 0.2880591}
confusion matrix:
      0     1
0  8005  1329
1   406   351
early stop counter: 4
val acc:0.9074928164482117, best validation acc: 0.9149097800254822, corresponding to test acc:                         0.8276681900024414 / 0.8290556073188782
after epoch: 15,now: 2024-08-09 03:50:06.515677,epoch time: 0:17:06.263626,used: 4:20:58.144435,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_29_08_seed_1_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:20:58.144435 at 2024-08-09 03:50:06.515677
persisted model performance metric: 

scalar performance:
{'acc': 0.8276682, 'precision': 0.54638344, 'recall': 0.5809222, 'specificity': 0.5809222, 'f1': 0.55266625, 'auroc': 0.76553214, 'binary_precision': 0.15471168, 'binary_recall': 0.29062086, 'binary_specificity': 0.8712235, 'binary_f1_score': 0.20192751}
confusion matrix:
      0     1
0  8132  1202
1   537   220
oracle model performance metric: 

scalar performance:
{'acc': 0.8290556, 'precision': 0.5543655, 'recall': 0.5968455, 'specificity': 0.5968455, 'f1': 0.56260484, 'auroc': 0.7731919, 'binary_precision': 0.16803841, 'binary_recall': 0.32364598, 'binary_specificity': 0.870045, 'binary_f1_score': 0.22121897}
confusion matrix:
      0     1
0  8121  1213
1   512   245
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB | 730852 GiB | 730852 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |  18208 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB | 730852 GiB | 730852 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |  18208 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB | 730780 GiB | 730780 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 719761 GiB | 719761 GiB |
|       from small pool |  16662 KiB |     36 MiB |  11019 GiB |  11019 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8530 MiB |  16786 MiB |   8276 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     38 MiB |     44 MiB |     54 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38101 KiB | 732464 KiB | 398040 GiB | 398040 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 386978 GiB | 386978 GiB |
|       from small pool |   6368 KiB |  24597 KiB |  11061 GiB |  11061 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6849    |  137815 K  |  137811 K  |
|       from large pool |      79    |     762    |   67980 K  |   67979 K  |
|       from small pool |    4333    |    6768    |   69835 K  |   69831 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6849    |  137815 K  |  137811 K  |
|       from large pool |      79    |     762    |   67980 K  |   67979 K  |
|       from small pool |    4333    |    6768    |   69835 K  |   69831 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     371    |     713    |     346    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      19    |      22    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |    3199    |   77695 K  |   77695 K  |
|       from large pool |      11    |     351    |   47689 K  |   47689 K  |
|       from small pool |      21    |    3189    |   30006 K  |   30006 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 730852 GiB | 730852 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |      0 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 730852 GiB | 730852 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |      0 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 730780 GiB | 730780 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 719761 GiB | 719761 GiB |
|       from small pool |      0 KiB |     36 MiB |  11019 GiB |  11019 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16786 MiB |  16556 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     54 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 398040 GiB | 398040 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 386978 GiB | 386978 GiB |
|       from small pool |      0 KiB |  24597 KiB |  11061 GiB |  11061 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  137815 K  |  137815 K  |
|       from large pool |       2    |     762    |   67980 K  |   67980 K  |
|       from small pool |       0    |    6768    |   69835 K  |   69835 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  137815 K  |  137815 K  |
|       from large pool |       2    |     762    |   67980 K  |   67980 K  |
|       from small pool |       0    |    6768    |   69835 K  |   69835 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     713    |     691    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      27    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |   77697 K  |   77697 K  |
|       from large pool |       3    |     351    |   47689 K  |   47689 K  |
|       from small pool |       0    |    3189    |   30008 K  |   30008 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 730852 GiB | 730852 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |      0 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 730852 GiB | 730852 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |      0 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 730780 GiB | 730780 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 719761 GiB | 719761 GiB |
|       from small pool |      0 KiB |     36 MiB |  11019 GiB |  11019 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16786 MiB |  16556 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     54 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 398040 GiB | 398040 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 386978 GiB | 386978 GiB |
|       from small pool |      0 KiB |  24597 KiB |  11061 GiB |  11061 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  137815 K  |  137815 K  |
|       from large pool |       2    |     762    |   67980 K  |   67980 K  |
|       from small pool |       0    |    6768    |   69835 K  |   69835 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  137815 K  |  137815 K  |
|       from large pool |       2    |     762    |   67980 K  |   67980 K  |
|       from small pool |       0    |    6768    |   69835 K  |   69835 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     713    |     691    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      27    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |   77697 K  |   77697 K  |
|       from large pool |       3    |     351    |   47689 K  |   47689 K  |
|       from small pool |       0    |    3189    |   30008 K  |   30008 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077

 Experiment start at: 2024-08-09 04:12:59.882583
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.72690344, 'precision': 0.7315932, 'recall': 0.72691166, 'specificity': 0.72691166, 'f1': 0.7255186, 'auroc': 0.8028251, 'binary_precision': 0.7645785, 'binary_recall': 0.6557967, 'binary_specificity': 0.7980267, 'binary_f1_score': 0.706022}
confusion matrix:
       0      1
0  20625   5220
1   8898  16953
---- Validation: 
scalar performance:
{'acc': 0.7090049, 'precision': 0.509851, 'recall': 0.5849586, 'specificity': 0.5849586, 'f1': 0.4491721, 'auroc': 0.6154219, 'binary_precision': 0.038422648, 'binary_recall': 0.45454547, 'binary_specificity': 0.7153717, 'binary_f1_score': 0.07085586}
confusion matrix:
       0     1
0  11951  4755
1    228   190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67112565, 'precision': 0.56381977, 'recall': 0.7038833, 'specificity': 0.7038833, 'f1': 0.5256392, 'auroc': 0.7563273, 'binary_precision': 0.15974095, 'binary_recall': 0.74278545, 'binary_specificity': 0.6649812, 'binary_f1_score': 0.26293582}
confusion matrix:
      0     1
0  6181  3114
1   205   592
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 04:31:24.819143,epoch time: 0:18:24.936560,used: 0:18:24.936560,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.81675565, 'precision': 0.82593423, 'recall': 0.8167751, 'specificity': 0.8167751, 'f1': 0.81546277, 'auroc': 0.89100444, 'binary_precision': 0.8806879, 'binary_recall': 0.73288465, 'binary_specificity': 0.9006656, 'binary_f1_score': 0.8000168}
confusion matrix:
       0      1
0  23275   2567
1   6906  18948
---- Validation: 
scalar performance:
{'acc': 0.82106984, 'precision': 0.5148852, 'recall': 0.5887459, 'specificity': 0.5887459, 'f1': 0.49337372, 'auroc': 0.6364759, 'binary_precision': 0.049079753, 'binary_recall': 0.34449762, 'binary_specificity': 0.83299416, 'binary_f1_score': 0.08591885}
confusion matrix:
       0     1
0  13916  2790
1    274   144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7625842, 'precision': 0.5774485, 'recall': 0.7042075, 'specificity': 0.7042075, 'f1': 0.5770627, 'auroc': 0.7551948, 'binary_precision': 0.19379549, 'binary_recall': 0.6348808, 'binary_specificity': 0.7735342, 'binary_f1_score': 0.29694837}
confusion matrix:
      0     1
0  7190  2105
1   291   506
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 04:49:26.054970,epoch time: 0:18:01.235827,used: 0:36:26.172387,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.86157537, 'precision': 0.87254465, 'recall': 0.86158204, 'specificity': 0.86158204, 'f1': 0.8605504, 'auroc': 0.9245999, 'binary_precision': 0.9364901, 'binary_recall': 0.77578336, 'binary_specificity': 0.94738066, 'binary_f1_score': 0.8485951}
confusion matrix:
       0      1
0  24486   1360
1   5796  20054
---- Validation: 
scalar performance:
{'acc': 0.909951, 'precision': 0.51973915, 'recall': 0.5573263, 'specificity': 0.5573263, 'f1': 0.52224976, 'auroc': 0.647336, 'binary_precision': 0.0609375, 'binary_recall': 0.18660288, 'binary_specificity': 0.9280498, 'binary_f1_score': 0.0918728}
confusion matrix:
       0     1
0  15504  1202
1    340    78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84254855, 'precision': 0.58613104, 'recall': 0.6455242, 'specificity': 0.6455242, 'f1': 0.6018135, 'auroc': 0.74729025, 'binary_precision': 0.22651933, 'binary_recall': 0.41154328, 'binary_specificity': 0.8795051, 'binary_f1_score': 0.2922049}
confusion matrix:
      0     1
0  8175  1120
1   469   328
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 05:07:13.347612,epoch time: 0:17:47.292642,used: 0:54:13.465029,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.87946844, 'precision': 0.89069295, 'recall': 0.8794848, 'specificity': 0.8794848, 'f1': 0.8785997, 'auroc': 0.9379974, 'binary_precision': 0.9569632, 'binary_recall': 0.794724, 'binary_specificity': 0.9642456, 'binary_f1_score': 0.86833036}
confusion matrix:
       0      1
0  24919    924
1   5307  20546
---- Validation: 
scalar performance:
{'acc': 0.9356459, 'precision': 0.52004, 'recall': 0.5366742, 'specificity': 0.5366742, 'f1': 0.5241606, 'auroc': 0.66611594, 'binary_precision': 0.062659845, 'binary_recall': 0.11722488, 'binary_specificity': 0.95612353, 'binary_f1_score': 0.08166666}
confusion matrix:
       0    1
0  15973  733
1    369   49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87168056, 'precision': 0.5847569, 'recall': 0.59767395, 'specificity': 0.59767395, 'f1': 0.5904207, 'auroc': 0.74733126, 'binary_precision': 0.23283261, 'binary_recall': 0.272271, 'binary_specificity': 0.9230769, 'binary_f1_score': 0.25101215}
confusion matrix:
      0    1
0  8580  715
1   580  217
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-09 05:24:53.360113,epoch time: 0:17:40.012501,used: 1:11:53.477530,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.89333797, 'precision': 0.9016578, 'recall': 0.8933519, 'specificity': 0.8933519, 'f1': 0.8927852, 'auroc': 0.94664824, 'binary_precision': 0.9595138, 'binary_recall': 0.8213747, 'binary_specificity': 0.9653291, 'binary_f1_score': 0.8850867}
confusion matrix:
       0      1
0  24947    896
1   4618  21235
---- Validation: 
scalar performance:
{'acc': 0.9390913, 'precision': 0.52450335, 'recall': 0.5419388, 'specificity': 0.5419388, 'f1': 0.5295809, 'auroc': 0.68202806, 'binary_precision': 0.07133059, 'binary_recall': 0.12440191, 'binary_specificity': 0.95947564, 'binary_f1_score': 0.090671316}
confusion matrix:
       0    1
0  16029  677
1    366   52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87772495, 'precision': 0.5850409, 'recall': 0.5877634, 'specificity': 0.5877634, 'f1': 0.58636546, 'auroc': 0.7554803, 'binary_precision': 0.23515151, 'binary_recall': 0.2434128, 'binary_specificity': 0.93211406, 'binary_f1_score': 0.23921084}
confusion matrix:
      0    1
0  8664  631
1   603  194
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-09 05:42:32.037044,epoch time: 0:17:38.676931,used: 1:29:32.154461,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90248764, 'precision': 0.9062412, 'recall': 0.9024895, 'specificity': 0.9024895, 'f1': 0.90226215, 'auroc': 0.9543412, 'binary_precision': 0.94530046, 'binary_recall': 0.85442376, 'binary_specificity': 0.9505552, 'binary_f1_score': 0.8975677}
confusion matrix:
       0      1
0  24569   1278
1   3763  22086
---- Validation: 
scalar performance:
{'acc': 0.9303317, 'precision': 0.53139204, 'recall': 0.5677717, 'specificity': 0.5677717, 'f1': 0.53968936, 'auroc': 0.7085465, 'binary_precision': 0.08378088, 'binary_recall': 0.18660288, 'binary_specificity': 0.9489405, 'binary_f1_score': 0.115641214}
confusion matrix:
       0    1
0  15853  853
1    340   78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.867717, 'precision': 0.5871861, 'recall': 0.60871416, 'specificity': 0.60871416, 'f1': 0.595893, 'auroc': 0.7713506, 'binary_precision': 0.23575638, 'binary_recall': 0.30112922, 'binary_specificity': 0.9162991, 'binary_f1_score': 0.2644628}
confusion matrix:
      0    1
0  8517  778
1   557  240
early stop counter: 1
val acc:0.9303317070007324, best validation acc: 0.9390913248062134, corresponding to test acc:                         0.8777249455451965 / 0.8777249455451965
after epoch: 6,now: 2024-08-09 06:00:20.302089,epoch time: 0:17:48.265045,used: 1:47:20.419506,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.90858096, 'precision': 0.91598487, 'recall': 0.9085913, 'specificity': 0.9085913, 'f1': 0.9081738, 'auroc': 0.96062374, 'binary_precision': 0.9715204, 'binary_recall': 0.8418691, 'binary_specificity': 0.9753134, 'binary_f1_score': 0.9020599}
confusion matrix:
       0      1
0  25206    638
1   4088  21764
---- Validation: 
scalar performance:
{'acc': 0.93833214, 'precision': 0.53599924, 'recall': 0.5660408, 'specificity': 0.5660408, 'f1': 0.5447544, 'auroc': 0.7210333, 'binary_precision': 0.093112245, 'binary_recall': 0.17464115, 'binary_specificity': 0.95744044, 'binary_f1_score': 0.12146422}
confusion matrix:
       0    1
0  15995  711
1    345   73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8745541, 'precision': 0.580538, 'recall': 0.58604205, 'specificity': 0.58604205, 'f1': 0.5831306, 'auroc': 0.7722306, 'binary_precision': 0.22637106, 'binary_recall': 0.2434128, 'binary_specificity': 0.9286713, 'binary_f1_score': 0.23458284}
confusion matrix:
      0    1
0  8632  663
1   603  194
early stop counter: 2
val acc:0.9383321404457092, best validation acc: 0.9390913248062134, corresponding to test acc:                         0.8777249455451965 / 0.8777249455451965
after epoch: 7,now: 2024-08-09 06:17:51.150293,epoch time: 0:17:30.848204,used: 2:04:51.267710,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9126625, 'precision': 0.9190848, 'recall': 0.91266966, 'specificity': 0.91266966, 'f1': 0.91232765, 'auroc': 0.96344113, 'binary_precision': 0.9709934, 'binary_recall': 0.8507601, 'binary_specificity': 0.9745792, 'binary_f1_score': 0.90690917}
confusion matrix:
       0      1
0  25188    657
1   3858  21993
---- Validation: 
scalar performance:
{'acc': 0.9323756, 'precision': 0.5397218, 'recall': 0.5851466, 'specificity': 0.5851466, 'f1': 0.5509588, 'auroc': 0.7403792, 'binary_precision': 0.0995671, 'binary_recall': 0.2200957, 'binary_specificity': 0.9501975, 'binary_f1_score': 0.13710879}
confusion matrix:
       0    1
0  15874  832
1    326   92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8708878, 'precision': 0.5892502, 'recall': 0.60699415, 'specificity': 0.60699415, 'f1': 0.5967461, 'auroc': 0.7843006, 'binary_precision': 0.2402464, 'binary_recall': 0.293601, 'binary_specificity': 0.9203873, 'binary_f1_score': 0.2642575}
confusion matrix:
      0    1
0  8555  740
1   563  234
early stop counter: 3
val acc:0.9323756098747253, best validation acc: 0.9390913248062134, corresponding to test acc:                         0.8777249455451965 / 0.8777249455451965
after epoch: 8,now: 2024-08-09 06:35:28.770972,epoch time: 0:17:37.620679,used: 2:22:28.888389,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9182335, 'precision': 0.92345905, 'recall': 0.9182421, 'specificity': 0.9182421, 'f1': 0.9179816, 'auroc': 0.9674486, 'binary_precision': 0.9705383, 'binary_recall': 0.8626799, 'binary_specificity': 0.97380435, 'binary_f1_score': 0.9134361}
confusion matrix:
       0      1
0  25167    677
1   3550  22302
---- Validation: 
scalar performance:
{'acc': 0.93658024, 'precision': 0.5454326, 'recall': 0.5908002, 'specificity': 0.5908002, 'f1': 0.55798286, 'auroc': 0.74625427, 'binary_precision': 0.11072261, 'binary_recall': 0.22727273, 'binary_specificity': 0.95432776, 'binary_f1_score': 0.14890282}
confusion matrix:
       0    1
0  15943  763
1    323   95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8772295, 'precision': 0.6006998, 'recall': 0.6155989, 'specificity': 0.6155989, 'f1': 0.60730875, 'auroc': 0.79247826, 'binary_precision': 0.26185346, 'binary_recall': 0.30489334, 'binary_specificity': 0.92630446, 'binary_f1_score': 0.28173912}
confusion matrix:
      0    1
0  8610  685
1   554  243
early stop counter: 4
val acc:0.936580240726471, best validation acc: 0.9390913248062134, corresponding to test acc:                         0.8777249455451965 / 0.8777249455451965
after epoch: 9,now: 2024-08-09 06:53:09.262766,epoch time: 0:17:40.491794,used: 2:40:09.380183,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9231662, 'precision': 0.92823875, 'recall': 0.92317045, 'specificity': 0.92317045, 'f1': 0.9229386, 'auroc': 0.97099245, 'binary_precision': 0.97486544, 'binary_recall': 0.86874276, 'binary_specificity': 0.9775981, 'binary_f1_score': 0.9187498}
confusion matrix:
       0      1
0  25267    579
1   3393  22457
---- Validation: 
scalar performance:
{'acc': 0.9295725, 'precision': 0.54870534, 'recall': 0.6151986, 'specificity': 0.6151986, 'f1': 0.564028, 'auroc': 0.7582526, 'binary_precision': 0.1159844, 'binary_recall': 0.284689, 'binary_specificity': 0.94570816, 'binary_f1_score': 0.16481993}
confusion matrix:
       0    1
0  15799  907
1    299  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87445503, 'precision': 0.60820407, 'recall': 0.63703513, 'specificity': 0.63703513, 'f1': 0.6198704, 'auroc': 0.8007859, 'binary_precision': 0.27316603, 'binary_recall': 0.35508156, 'binary_specificity': 0.9189887, 'binary_f1_score': 0.3087834}
confusion matrix:
      0    1
0  8542  753
1   514  283
early stop counter: 5
val acc:0.9295725226402283, best validation acc: 0.9390913248062134, corresponding to test acc:                         0.8777249455451965 / 0.8777249455451965
after epoch: 10,now: 2024-08-09 07:10:39.198876,epoch time: 0:17:29.936110,used: 2:57:39.316293,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9260098, 'precision': 0.92926383, 'recall': 0.9260199, 'specificity': 0.9260199, 'f1': 0.9258705, 'auroc': 0.97391033, 'binary_precision': 0.9666963, 'binary_recall': 0.88245535, 'binary_specificity': 0.9695844, 'binary_f1_score': 0.922657}
confusion matrix:
       0      1
0  25056    786
1   3039  22815
---- Validation: 
scalar performance:
{'acc': 0.9177762, 'precision': 0.54802537, 'recall': 0.63947517, 'specificity': 0.63947517, 'f1': 0.5637663, 'auroc': 0.77217984, 'binary_precision': 0.11328125, 'binary_recall': 0.34688994, 'binary_specificity': 0.93206036, 'binary_f1_score': 0.17078917}
confusion matrix:
       0     1
0  15571  1135
1    273   145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8692033, 'precision': 0.6144444, 'recall': 0.6640093, 'specificity': 0.6640093, 'f1': 0.632066, 'auroc': 0.80928814, 'binary_precision': 0.2808047, 'binary_recall': 0.42032623, 'binary_specificity': 0.9076923, 'binary_f1_score': 0.33668342}
confusion matrix:
      0    1
0  8437  858
1   462  335
early stop counter: 6
val acc:0.9177762269973755, best validation acc: 0.9390913248062134, corresponding to test acc:                         0.8777249455451965 / 0.8777249455451965
after epoch: 11,now: 2024-08-09 07:28:36.529250,epoch time: 0:17:57.330374,used: 3:15:36.646667,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9291628, 'precision': 0.9334099, 'recall': 0.9291686, 'specificity': 0.9291686, 'f1': 0.9289895, 'auroc': 0.97615886, 'binary_precision': 0.9763428, 'binary_recall': 0.8796565, 'binary_specificity': 0.9786806, 'binary_f1_score': 0.9254813}
confusion matrix:
       0      1
0  25294    551
1   3111  22740
---- Validation: 
scalar performance:
{'acc': 0.91468114, 'precision': 0.5501975, 'recall': 0.6542163, 'specificity': 0.6542163, 'f1': 0.56687766, 'auroc': 0.7803384, 'binary_precision': 0.11682586, 'binary_recall': 0.38038278, 'binary_specificity': 0.9280498, 'binary_f1_score': 0.1787521}
confusion matrix:
       0     1
0  15504  1202
1    259   159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87158144, 'precision': 0.6178611, 'recall': 0.6664474, 'specificity': 0.6664474, 'f1': 0.635489, 'auroc': 0.81458485, 'binary_precision': 0.28729752, 'binary_recall': 0.42283565, 'binary_specificity': 0.91005915, 'binary_f1_score': 0.34213197}
confusion matrix:
      0    1
0  8459  836
1   460  337
early stop counter: 7
val acc:0.9146811366081238, best validation acc: 0.9390913248062134, corresponding to test acc:                         0.8777249455451965 / 0.8777249455451965
after epoch: 12,now: 2024-08-09 07:46:19.188335,epoch time: 0:17:42.659085,used: 3:33:19.305752,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9339407, 'precision': 0.9356098, 'recall': 0.9339491, 'specificity': 0.9339491, 'f1': 0.93387824, 'auroc': 0.97842383, 'binary_precision': 0.96264225, 'binary_recall': 0.9029588, 'binary_specificity': 0.9649394, 'binary_f1_score': 0.93184584}
confusion matrix:
       0      1
0  24935    906
1   2509  23346
---- Validation: 
scalar performance:
{'acc': 0.9043448, 'precision': 0.5509486, 'recall': 0.68040735, 'specificity': 0.68040735, 'f1': 0.5671325, 'auroc': 0.79391, 'binary_precision': 0.11683417, 'binary_recall': 0.4449761, 'binary_specificity': 0.9158386, 'binary_f1_score': 0.18507463}
confusion matrix:
       0     1
0  15300  1406
1    232   186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8697979, 'precision': 0.61995447, 'recall': 0.67637676, 'specificity': 0.67637676, 'f1': 0.6395333, 'auroc': 0.81776845, 'binary_precision': 0.28966638, 'binary_recall': 0.44667503, 'binary_specificity': 0.9060785, 'binary_f1_score': 0.35143137}
confusion matrix:
      0    1
0  8422  873
1   441  356
early stop counter: 8
val acc:0.9043447971343994, best validation acc: 0.9390913248062134, corresponding to test acc:                         0.8777249455451965 / 0.8777249455451965
after epoch: 13,now: 2024-08-09 08:03:30.812697,epoch time: 0:17:11.624362,used: 3:50:30.930114,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9314067, 'precision': 0.9357301, 'recall': 0.93141246, 'specificity': 0.93141246, 'f1': 0.93123674, 'auroc': 0.9791795, 'binary_precision': 0.9791622, 'binary_recall': 0.88159066, 'binary_specificity': 0.98123425, 'binary_f1_score': 0.9278183}
confusion matrix:
       0      1
0  25360    485
1   3061  22790
---- Validation: 
scalar performance:
{'acc': 0.923032, 'precision': 0.56266403, 'recall': 0.6783223, 'specificity': 0.6783223, 'f1': 0.58516085, 'auroc': 0.79640687, 'binary_precision': 0.14057508, 'binary_recall': 0.42105263, 'binary_specificity': 0.935592, 'binary_f1_score': 0.21077845}
confusion matrix:
       0     1
0  15630  1076
1    242   176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8849584, 'precision': 0.6303101, 'recall': 0.6570761, 'specificity': 0.6570761, 'f1': 0.64178896, 'auroc': 0.82267404, 'binary_precision': 0.31428573, 'binary_recall': 0.3864492, 'binary_specificity': 0.9277031, 'binary_f1_score': 0.34665167}
confusion matrix:
      0    1
0  8623  672
1   489  308
new oracle model saved
early stop counter: 9
val acc:0.9230319857597351, best validation acc: 0.9390913248062134, corresponding to test acc:                         0.8777249455451965 / 0.8849583864212036
after epoch: 14,now: 2024-08-09 08:21:42.665004,epoch time: 0:18:11.852307,used: 4:08:42.782421,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9372485, 'precision': 0.93921566, 'recall': 0.937255, 'specificity': 0.937255, 'f1': 0.93717885, 'auroc': 0.979609, 'binary_precision': 0.96865803, 'binary_recall': 0.9037636, 'binary_specificity': 0.97074646, 'binary_f1_score': 0.93508625}
confusion matrix:
       0      1
0  25087    756
1   2488  23365
---- Validation: 
scalar performance:
{'acc': 0.8987386, 'precision': 0.55546296, 'recall': 0.71368766, 'specificity': 0.71368766, 'f1': 0.57306606, 'auroc': 0.81081104, 'binary_precision': 0.124, 'binary_recall': 0.51913875, 'binary_specificity': 0.90823656, 'binary_f1_score': 0.2001845}
confusion matrix:
       0     1
0  15173  1533
1    201   217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8765359, 'precision': 0.6340911, 'recall': 0.69494724, 'specificity': 0.69494724, 'f1': 0.65577, 'auroc': 0.82541406, 'binary_precision': 0.31492168, 'binary_recall': 0.47929737, 'binary_specificity': 0.9105971, 'binary_f1_score': 0.3800995}
confusion matrix:
      0    1
0  8464  831
1   415  382
early stop counter: 10
val acc:0.8987386226654053, best validation acc: 0.9390913248062134, corresponding to test acc:                         0.8777249455451965 / 0.8849583864212036
after epoch: 15,now: 2024-08-09 08:40:23.908919,epoch time: 0:18:41.243915,used: 4:27:24.026336,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_12_59_seed_2_24116077
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:27:24.026336 at 2024-08-09 08:40:23.908919
persisted model performance metric: 

scalar performance:
{'acc': 0.87772495, 'precision': 0.5850409, 'recall': 0.5877634, 'specificity': 0.5877634, 'f1': 0.58636546, 'auroc': 0.7554803, 'binary_precision': 0.23515151, 'binary_recall': 0.2434128, 'binary_specificity': 0.93211406, 'binary_f1_score': 0.23921084}
confusion matrix:
      0    1
0  8664  631
1   603  194
oracle model performance metric: 

scalar performance:
{'acc': 0.8849584, 'precision': 0.6303101, 'recall': 0.6570761, 'specificity': 0.6570761, 'f1': 0.64178896, 'auroc': 0.82267404, 'binary_precision': 0.31428573, 'binary_recall': 0.3864492, 'binary_specificity': 0.9277031, 'binary_f1_score': 0.34665167}
confusion matrix:
      0    1
0  8623  672
1   489  308
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |   1087 TiB |   1087 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1071 TiB |   1071 TiB |
|       from small pool |  18208 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |   1087 TiB |   1087 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1071 TiB |   1071 TiB |
|       from small pool |  18208 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |   1087 TiB |   1087 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1071 TiB |   1071 TiB |
|       from small pool |  16662 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  25068 MiB |  16556 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  24998 MiB |  16526 MiB |
|       from small pool |     40 MiB |     44 MiB |     70 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40149 KiB | 732464 KiB | 598823 GiB | 598823 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 582055 GiB | 582055 GiB |
|       from small pool |   8416 KiB |  24597 KiB |  16767 GiB |  16767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6957    |  209037 K  |  209033 K  |
|       from large pool |      79    |     762    |  103525 K  |  103525 K  |
|       from small pool |    4333    |    6876    |  105512 K  |  105507 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6957    |  209037 K  |  209033 K  |
|       from large pool |      79    |     762    |  103525 K  |  103525 K  |
|       from small pool |    4333    |    6876    |  105512 K  |  105507 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |    1059    |     691    |
|       from large pool |     348    |     349    |    1024    |     676    |
|       from small pool |      20    |      22    |      35    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3255    |  115682 K  |  115682 K  |
|       from large pool |      11    |     351    |   70782 K  |   70782 K  |
|       from small pool |      24    |    3245    |   44899 K  |   44899 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1087 TiB |   1087 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1071 TiB |   1071 TiB |
|       from small pool |      0 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1087 TiB |   1087 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1071 TiB |   1071 TiB |
|       from small pool |      0 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1087 TiB |   1087 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1071 TiB |   1071 TiB |
|       from small pool |      0 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  25068 MiB |  24836 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  24998 MiB |  24792 MiB |
|       from small pool |  26624 KiB |     44 MiB |     70 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 598823 GiB | 598823 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 582056 GiB | 582056 GiB |
|       from small pool |      0 KiB |  24597 KiB |  16767 GiB |  16767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6957    |  209037 K  |  209037 K  |
|       from large pool |       2    |     762    |  103525 K  |  103525 K  |
|       from small pool |       0    |    6876    |  105512 K  |  105512 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6957    |  209037 K  |  209037 K  |
|       from large pool |       2    |     762    |  103525 K  |  103525 K  |
|       from small pool |       0    |    6876    |  105512 K  |  105512 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1059    |    1036    |
|       from large pool |      10    |     349    |    1024    |    1014    |
|       from small pool |      13    |      22    |      35    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3255    |  115684 K  |  115684 K  |
|       from large pool |       3    |     351    |   70782 K  |   70782 K  |
|       from small pool |       0    |    3245    |   44901 K  |   44901 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  9 08:54:35 2024]
Finished job 0.
1 of 1 steps (100%) done
