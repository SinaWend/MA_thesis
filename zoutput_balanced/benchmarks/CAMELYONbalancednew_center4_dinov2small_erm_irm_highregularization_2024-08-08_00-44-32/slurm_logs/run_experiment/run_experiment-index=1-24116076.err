Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Aug  8 17:53:44 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076

 Experiment start at: 2024-08-08 18:01:52.002829
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6631401777267456
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.86157614, 'precision': 0.87135017, 'recall': 0.8616242, 'specificity': 0.8616242, 'f1': 0.86067057, 'auroc': 0.9108887, 'binary_precision': 0.93174434, 'binary_recall': 0.78049165, 'binary_specificity': 0.9427567, 'binary_f1_score': 0.8494375}
confusion matrix:
       0      1
0  23864   1449
1   5563  19780
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8894203, 'precision': 0.5250196, 'recall': 0.59555805, 'specificity': 0.59555805, 'f1': 0.5262844, 'auroc': 0.7359538, 'binary_precision': 0.069226295, 'binary_recall': 0.28674698, 'binary_specificity': 0.9043691, 'binary_f1_score': 0.11152765}
confusion matrix:
       0     1
0  15131  1600
1    296   119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953332, 'precision': 0.5155005, 'recall': 0.5297513, 'specificity': 0.5297513, 'f1': 0.51139975, 'auroc': 0.6492618, 'binary_precision': 0.102328435, 'binary_recall': 0.21632124, 'binary_specificity': 0.8431813, 'binary_f1_score': 0.13893512}
confusion matrix:
      0     1
0  7877  1465
1   605   167
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 18:22:00.470898,epoch time: 0:20:08.468069,used: 0:20:08.468069,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9016898, 'precision': 0.9091166, 'recall': 0.9017271, 'specificity': 0.9017271, 'f1': 0.90124756, 'auroc': 0.95610476, 'binary_precision': 0.9643769, 'binary_recall': 0.83430666, 'binary_specificity': 0.9691475, 'binary_f1_score': 0.89463884}
confusion matrix:
       0      1
0  24533    781
1   4199  21143
---- Validation: 
scalar performance:
{'acc': 0.8515689, 'precision': 0.52975726, 'recall': 0.6572334, 'specificity': 0.6572334, 'f1': 0.5237986, 'auroc': 0.77581084, 'binary_precision': 0.075019956, 'binary_recall': 0.45301205, 'binary_specificity': 0.8614548, 'binary_f1_score': 0.12872304}
confusion matrix:
       0     1
0  14413  2318
1    227   188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7537077, 'precision': 0.54696035, 'recall': 0.62188894, 'specificity': 0.62188894, 'f1': 0.5389231, 'auroc': 0.7131996, 'binary_precision': 0.14760147, 'binary_recall': 0.46632123, 'binary_specificity': 0.77745664, 'binary_f1_score': 0.2242292}
confusion matrix:
      0     1
0  7263  2079
1   412   360
early stop counter: 1
val acc:0.851568877696991, best validation acc: 0.8894202709197998, corresponding to test acc:                         0.795333206653595 / 0.795333206653595
after epoch: 2,now: 2024-08-08 18:40:43.556976,epoch time: 0:18:43.086078,used: 0:38:51.554147,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9192988, 'precision': 0.92407036, 'recall': 0.91932607, 'specificity': 0.91932607, 'f1': 0.91907465, 'auroc': 0.9701588, 'binary_precision': 0.96918184, 'binary_recall': 0.8662247, 'binary_specificity': 0.9724274, 'binary_f1_score': 0.9148156}
confusion matrix:
       0      1
0  24617    698
1   3390  21951
---- Validation: 
scalar performance:
{'acc': 0.82853144, 'precision': 0.53685486, 'recall': 0.7276744, 'specificity': 0.7276744, 'f1': 0.52698123, 'auroc': 0.8120495, 'binary_precision': 0.084840514, 'binary_recall': 0.62168676, 'binary_specificity': 0.8336621, 'binary_f1_score': 0.14930555}
confusion matrix:
       0     1
0  13948  2783
1    157   258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7272098, 'precision': 0.5665446, 'recall': 0.6972613, 'specificity': 0.6972613, 'f1': 0.55127394, 'auroc': 0.75792134, 'binary_precision': 0.16982386, 'binary_recall': 0.6619171, 'binary_specificity': 0.73260546, 'binary_f1_score': 0.27029884}
confusion matrix:
      0     1
0  6844  2498
1   261   511
early stop counter: 2
val acc:0.8285314440727234, best validation acc: 0.8894202709197998, corresponding to test acc:                         0.795333206653595 / 0.795333206653595
after epoch: 3,now: 2024-08-08 19:00:01.868416,epoch time: 0:19:18.311440,used: 0:58:09.865587,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92920876, 'precision': 0.93373895, 'recall': 0.92923504, 'specificity': 0.92923504, 'f1': 0.92902637, 'auroc': 0.9758017, 'binary_precision': 0.97819495, 'binary_recall': 0.8780632, 'binary_specificity': 0.9804069, 'binary_f1_score': 0.9254284}
confusion matrix:
       0      1
0  24819    496
1   3090  22251
---- Validation: 
scalar performance:
{'acc': 0.85145223, 'precision': 0.54697347, 'recall': 0.76291776, 'specificity': 0.76291776, 'f1': 0.54875904, 'auroc': 0.8402059, 'binary_precision': 0.10342262, 'binary_recall': 0.6698795, 'binary_specificity': 0.855956, 'binary_f1_score': 0.17918143}
confusion matrix:
       0     1
0  14321  2410
1    137   278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7525213, 'precision': 0.57807475, 'recall': 0.7210634, 'specificity': 0.7210634, 'f1': 0.57327676, 'auroc': 0.7908982, 'binary_precision': 0.18945102, 'binary_recall': 0.68393785, 'binary_specificity': 0.75818884, 'binary_f1_score': 0.29671255}
confusion matrix:
      0     1
0  7083  2259
1   244   528
early stop counter: 3
val acc:0.8514522314071655, best validation acc: 0.8894202709197998, corresponding to test acc:                         0.795333206653595 / 0.795333206653595
after epoch: 4,now: 2024-08-08 19:18:16.880897,epoch time: 0:18:15.012481,used: 1:16:24.878068,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9384081, 'precision': 0.94075024, 'recall': 0.93842685, 'specificity': 0.93842685, 'f1': 0.9383279, 'auroc': 0.9802673, 'binary_precision': 0.97300863, 'binary_recall': 0.9018981, 'binary_specificity': 0.97495556, 'binary_f1_score': 0.9361048}
confusion matrix:
       0      1
0  24681    634
1   2486  22855
---- Validation: 
scalar performance:
{'acc': 0.8317975, 'precision': 0.5472634, 'recall': 0.79631925, 'specificity': 0.79631925, 'f1': 0.5427898, 'auroc': 0.86324155, 'binary_precision': 0.10164569, 'binary_recall': 0.7590361, 'binary_specificity': 0.8336023, 'binary_f1_score': 0.17928286}
confusion matrix:
       0     1
0  13947  2784
1    100   315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7359106, 'precision': 0.5855443, 'recall': 0.7584151, 'specificity': 0.7584151, 'f1': 0.5743579, 'auroc': 0.8178259, 'binary_precision': 0.19479267, 'binary_recall': 0.7849741, 'binary_specificity': 0.7318561, 'binary_f1_score': 0.3121298}
confusion matrix:
      0     1
0  6837  2505
1   166   606
early stop counter: 4
val acc:0.8317974805831909, best validation acc: 0.8894202709197998, corresponding to test acc:                         0.795333206653595 / 0.795333206653595
after epoch: 5,now: 2024-08-08 19:36:36.703861,epoch time: 0:18:19.822964,used: 1:34:44.701032,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9385068, 'precision': 0.94224954, 'recall': 0.9385359, 'specificity': 0.9385359, 'f1': 0.93837917, 'auroc': 0.9813063, 'binary_precision': 0.9830921, 'binary_recall': 0.89244, 'binary_specificity': 0.9846318, 'binary_f1_score': 0.93557525}
confusion matrix:
       0      1
0  24923    389
1   2726  22618
---- Validation: 
scalar performance:
{'acc': 0.8688324, 'precision': 0.5575302, 'recall': 0.796497, 'specificity': 0.796497, 'f1': 0.56926197, 'auroc': 0.872831, 'binary_precision': 0.12294408, 'binary_recall': 0.72048193, 'binary_specificity': 0.8725121, 'binary_f1_score': 0.21004567}
confusion matrix:
       0     1
0  14598  2133
1    116   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7920704, 'precision': 0.59797776, 'recall': 0.7531667, 'specificity': 0.7531667, 'f1': 0.6091589, 'auroc': 0.8318448, 'binary_precision': 0.22534049, 'binary_recall': 0.7072539, 'binary_specificity': 0.7990794, 'binary_f1_score': 0.34178403}
confusion matrix:
      0     1
0  7465  1877
1   226   546
early stop counter: 5
val acc:0.8688324093818665, best validation acc: 0.8894202709197998, corresponding to test acc:                         0.795333206653595 / 0.795333206653595
after epoch: 6,now: 2024-08-08 19:54:59.907992,epoch time: 0:18:23.204131,used: 1:53:07.905163,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9463045, 'precision': 0.9475698, 'recall': 0.9463171, 'specificity': 0.9463171, 'f1': 0.94626755, 'auroc': 0.98462725, 'binary_precision': 0.97148573, 'binary_recall': 0.9196527, 'binary_specificity': 0.9729815, 'binary_f1_score': 0.94485885}
confusion matrix:
       0      1
0  24632    684
1   2036  23304
---- Validation: 
scalar performance:
{'acc': 0.8379797, 'precision': 0.550253, 'recall': 0.80771154, 'specificity': 0.80771154, 'f1': 0.5491019, 'auroc': 0.88198906, 'binary_precision': 0.10708347, 'binary_recall': 0.77590364, 'binary_specificity': 0.83951944, 'binary_f1_score': 0.18819402}
confusion matrix:
       0     1
0  14046  2685
1     93   322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.758157, 'precision': 0.5951663, 'recall': 0.77639896, 'specificity': 0.77639896, 'f1': 0.593585, 'auroc': 0.8467687, 'binary_precision': 0.21197522, 'binary_recall': 0.79792744, 'binary_specificity': 0.7548705, 'binary_f1_score': 0.33496463}
confusion matrix:
      0     1
0  7052  2290
1   156   616
early stop counter: 6
val acc:0.8379796743392944, best validation acc: 0.8894202709197998, corresponding to test acc:                         0.795333206653595 / 0.795333206653595
after epoch: 7,now: 2024-08-08 20:13:22.680000,epoch time: 0:18:22.772008,used: 2:11:30.677171,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9498184, 'precision': 0.9512756, 'recall': 0.9498353, 'specificity': 0.9498353, 'f1': 0.94977915, 'auroc': 0.9861922, 'binary_precision': 0.97706825, 'binary_recall': 0.9213195, 'binary_specificity': 0.97835106, 'binary_f1_score': 0.94837534}
confusion matrix:
       0      1
0  24765    548
1   1994  23349
---- Validation: 
scalar performance:
{'acc': 0.85693455, 'precision': 0.55646294, 'recall': 0.8150742, 'specificity': 0.8150742, 'f1': 0.5641473, 'auroc': 0.88706756, 'binary_precision': 0.11949216, 'binary_recall': 0.7710843, 'binary_specificity': 0.85906404, 'binary_f1_score': 0.20691885}
confusion matrix:
       0     1
0  14373  2358
1     95   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7872256, 'precision': 0.6048642, 'recall': 0.782628, 'specificity': 0.782628, 'f1': 0.6152384, 'auroc': 0.8529277, 'binary_precision': 0.23255815, 'binary_recall': 0.77720207, 'binary_specificity': 0.78805393, 'binary_f1_score': 0.35799524}
confusion matrix:
      0     1
0  7362  1980
1   172   600
early stop counter: 7
val acc:0.8569345474243164, best validation acc: 0.8894202709197998, corresponding to test acc:                         0.795333206653595 / 0.795333206653595
after epoch: 8,now: 2024-08-08 20:31:42.957326,epoch time: 0:18:20.277326,used: 2:29:50.954497,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9534902, 'precision': 0.95458114, 'recall': 0.95350575, 'specificity': 0.95350575, 'f1': 0.9534634, 'auroc': 0.9871491, 'binary_precision': 0.97700864, 'binary_recall': 0.92889833, 'binary_specificity': 0.9781132, 'binary_f1_score': 0.95234627}
confusion matrix:
       0      1
0  24758    554
1   1802  23542
---- Validation: 
scalar performance:
{'acc': 0.8660329, 'precision': 0.55964756, 'recall': 0.81621134, 'specificity': 0.81621134, 'f1': 0.57153225, 'auroc': 0.8919704, 'binary_precision': 0.12599364, 'binary_recall': 0.7638554, 'binary_specificity': 0.86856735, 'binary_f1_score': 0.21630841}
confusion matrix:
       0     1
0  14532  2199
1     98   317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8106585, 'precision': 0.6143056, 'recall': 0.7858063, 'specificity': 0.7858063, 'f1': 0.6335787, 'auroc': 0.8573381, 'binary_precision': 0.25270447, 'binary_recall': 0.7564767, 'binary_specificity': 0.81513596, 'binary_f1_score': 0.3788518}
confusion matrix:
      0     1
0  7615  1727
1   188   584
new oracle model saved
early stop counter: 8
val acc:0.8660328984260559, best validation acc: 0.8894202709197998, corresponding to test acc:                         0.795333206653595 / 0.8106585144996643
after epoch: 9,now: 2024-08-08 20:50:45.417172,epoch time: 0:19:02.459846,used: 2:48:53.414343,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.956708, 'precision': 0.9576942, 'recall': 0.95672274, 'specificity': 0.95672274, 'f1': 0.95668566, 'auroc': 0.98862666, 'binary_precision': 0.97909856, 'binary_recall': 0.93339646, 'binary_specificity': 0.980049, 'binary_f1_score': 0.9557015}
confusion matrix:
       0      1
0  24807    505
1   1688  23656
---- Validation: 
scalar performance:
{'acc': 0.84486175, 'precision': 0.55431664, 'recall': 0.82416224, 'specificity': 0.82416224, 'f1': 0.5571699, 'auroc': 0.8940939, 'binary_precision': 0.11439368, 'binary_recall': 0.80240965, 'binary_specificity': 0.8459148, 'binary_f1_score': 0.20024052}
confusion matrix:
       0     1
0  14153  2578
1     82   333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866324, 'precision': 0.6062491, 'recall': 0.7882483, 'specificity': 0.7882483, 'f1': 0.6165446, 'auroc': 0.8632205, 'binary_precision': 0.23407522, 'binary_recall': 0.7901554, 'binary_specificity': 0.78634125, 'binary_f1_score': 0.3611605}
confusion matrix:
      0     1
0  7346  1996
1   162   610
early stop counter: 9
val acc:0.8448617458343506, best validation acc: 0.8894202709197998, corresponding to test acc:                         0.795333206653595 / 0.8106585144996643
after epoch: 10,now: 2024-08-08 21:10:18.178750,epoch time: 0:19:32.761578,used: 3:08:26.175921,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95832676, 'precision': 0.9592827, 'recall': 0.9583376, 'specificity': 0.9583376, 'f1': 0.9583058, 'auroc': 0.98972523, 'binary_precision': 0.98035485, 'binary_recall': 0.93543804, 'binary_specificity': 0.9812372, 'binary_f1_score': 0.95736986}
confusion matrix:
       0      1
0  24841    475
1   1636  23704
---- Validation: 
scalar performance:
{'acc': 0.8653914, 'precision': 0.5608193, 'recall': 0.8252821, 'specificity': 0.8252821, 'f1': 0.5730426, 'auroc': 0.89608717, 'binary_precision': 0.1278018, 'binary_recall': 0.78313255, 'binary_specificity': 0.8674317, 'binary_f1_score': 0.21974307}
confusion matrix:
       0     1
0  14513  2218
1     90   325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82024914, 'precision': 0.61847985, 'recall': 0.7856506, 'specificity': 0.7856506, 'f1': 0.64106804, 'auroc': 0.86357737, 'binary_precision': 0.26183972, 'binary_recall': 0.7448186, 'binary_specificity': 0.82648253, 'binary_f1_score': 0.38746634}
confusion matrix:
      0     1
0  7721  1621
1   197   575
new oracle model saved
early stop counter: 10
val acc:0.8653913736343384, best validation acc: 0.8894202709197998, corresponding to test acc:                         0.795333206653595 / 0.8202491402626038
after epoch: 11,now: 2024-08-08 21:29:03.518154,epoch time: 0:18:45.339404,used: 3:27:11.515325,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95884, 'precision': 0.9597995, 'recall': 0.9588518, 'specificity': 0.9588518, 'f1': 0.95881927, 'auroc': 0.9897653, 'binary_precision': 0.98093307, 'binary_recall': 0.93591416, 'binary_specificity': 0.98178947, 'binary_f1_score': 0.9578949}
confusion matrix:
       0      1
0  24854    461
1   1624  23717
---- Validation: 
scalar performance:
{'acc': 0.85279363, 'precision': 0.5573183, 'recall': 0.8294015, 'specificity': 0.8294015, 'f1': 0.5640578, 'auroc': 0.89972675, 'binary_precision': 0.12027368, 'binary_recall': 0.8048193, 'binary_specificity': 0.85398364, 'binary_f1_score': 0.20927319}
confusion matrix:
       0     1
0  14288  2443
1     81   334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8181728, 'precision': 0.6180481, 'recall': 0.7874974, 'specificity': 0.7874974, 'f1': 0.6400285, 'auroc': 0.8661201, 'binary_precision': 0.26044005, 'binary_recall': 0.7512953, 'binary_specificity': 0.8236994, 'binary_f1_score': 0.38679558}
confusion matrix:
      0     1
0  7695  1647
1   192   580
early stop counter: 11
val acc:0.8527936339378357, best validation acc: 0.8894202709197998, corresponding to test acc:                         0.795333206653595 / 0.8202491402626038
after epoch: 12,now: 2024-08-08 21:48:19.180027,epoch time: 0:19:15.661873,used: 3:46:27.177198,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9609918, 'precision': 0.9616804, 'recall': 0.96100485, 'specificity': 0.96100485, 'f1': 0.96097803, 'auroc': 0.99050796, 'binary_precision': 0.979679, 'binary_recall': 0.9415664, 'binary_specificity': 0.9804433, 'binary_f1_score': 0.9602447}
confusion matrix:
       0      1
0  24816    495
1   1481  23864
---- Validation: 
scalar performance:
{'acc': 0.86854076, 'precision': 0.5633057, 'recall': 0.8339455, 'specificity': 0.8339455, 'f1': 0.5775925, 'auroc': 0.9034592, 'binary_precision': 0.13234706, 'binary_recall': 0.7975904, 'binary_specificity': 0.87030065, 'binary_f1_score': 0.22702333}
confusion matrix:
       0     1
0  14561  2170
1     84   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.839826, 'precision': 0.62842315, 'recall': 0.784365, 'specificity': 0.784365, 'f1': 0.6570057, 'auroc': 0.86937344, 'binary_precision': 0.2834525, 'binary_recall': 0.71891195, 'binary_specificity': 0.84981805, 'binary_f1_score': 0.40659347}
confusion matrix:
      0     1
0  7939  1403
1   217   555
new oracle model saved
early stop counter: 12
val acc:0.8685407638549805, best validation acc: 0.8894202709197998, corresponding to test acc:                         0.795333206653595 / 0.8398259878158569
after epoch: 13,now: 2024-08-08 22:08:01.020151,epoch time: 0:19:41.840124,used: 4:06:09.017322,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9622947, 'precision': 0.96288437, 'recall': 0.9623039, 'specificity': 0.9623039, 'f1': 0.9622832, 'auroc': 0.9909662, 'binary_precision': 0.9795342, 'binary_recall': 0.94435894, 'binary_specificity': 0.98024887, 'binary_f1_score': 0.961625}
confusion matrix:
       0      1
0  24815    500
1   1410  23931
---- Validation: 
scalar performance:
{'acc': 0.8544267, 'precision': 0.55845153, 'recall': 0.833763, 'specificity': 0.833763, 'f1': 0.5662089, 'auroc': 0.90469635, 'binary_precision': 0.12232305, 'binary_recall': 0.8120482, 'binary_specificity': 0.85547787, 'binary_f1_score': 0.2126183}
confusion matrix:
       0     1
0  14313  2418
1     78   337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8361677, 'precision': 0.62556446, 'recall': 0.7817905, 'specificity': 0.7817905, 'f1': 0.6529185, 'auroc': 0.8676678, 'binary_precision': 0.2779729, 'binary_recall': 0.71761656, 'binary_specificity': 0.8459645, 'binary_f1_score': 0.4007233}
confusion matrix:
      0     1
0  7903  1439
1   218   554
early stop counter: 13
val acc:0.8544266819953918, best validation acc: 0.8894202709197998, corresponding to test acc:                         0.795333206653595 / 0.8398259878158569
after epoch: 14,now: 2024-08-08 22:26:39.139452,epoch time: 0:18:38.119301,used: 4:24:47.136623,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96213675, 'precision': 0.9627553, 'recall': 0.96214616, 'specificity': 0.96214616, 'f1': 0.96212465, 'auroc': 0.99148345, 'binary_precision': 0.97980255, 'binary_recall': 0.943767, 'binary_specificity': 0.9805254, 'binary_f1_score': 0.96144724}
confusion matrix:
       0      1
0  24822    493
1   1425  23916
---- Validation: 
scalar performance:
{'acc': 0.8563513, 'precision': 0.5595438, 'recall': 0.8370991, 'specificity': 0.8370991, 'f1': 0.5683942, 'auroc': 0.90486574, 'binary_precision': 0.124358036, 'binary_recall': 0.8168675, 'binary_specificity': 0.8573307, 'binary_f1_score': 0.21585482}
confusion matrix:
       0     1
0  14344  2387
1     76   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8394305, 'precision': 0.62728155, 'recall': 0.78118014, 'specificity': 0.78118014, 'f1': 0.6555196, 'auroc': 0.86760986, 'binary_precision': 0.2817623, 'binary_recall': 0.71243525, 'binary_specificity': 0.84992504, 'binary_f1_score': 0.40381795}
confusion matrix:
      0     1
0  7940  1402
1   222   550
early stop counter: 14
val acc:0.8563513159751892, best validation acc: 0.8894202709197998, corresponding to test acc:                         0.795333206653595 / 0.8398259878158569
after epoch: 15,now: 2024-08-08 22:45:05.869139,epoch time: 0:18:26.729687,used: 4:43:13.866310,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_18_01_51_seed_0_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:43:13.866310 at 2024-08-08 22:45:05.869139
persisted model performance metric: 

scalar performance:
{'acc': 0.7953332, 'precision': 0.5155005, 'recall': 0.5297513, 'specificity': 0.5297513, 'f1': 0.51139975, 'auroc': 0.6492618, 'binary_precision': 0.102328435, 'binary_recall': 0.21632124, 'binary_specificity': 0.8431813, 'binary_f1_score': 0.13893512}
confusion matrix:
      0     1
0  7877  1465
1   605   167
oracle model performance metric: 

scalar performance:
{'acc': 0.839826, 'precision': 0.62842315, 'recall': 0.784365, 'specificity': 0.784365, 'f1': 0.6570057, 'auroc': 0.86937344, 'binary_precision': 0.2834525, 'binary_recall': 0.71891195, 'binary_specificity': 0.84981805, 'binary_f1_score': 0.40659347}
confusion matrix:
      0     1
0  7939  1403
1   217   555
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198876 KiB |   7828 MiB | 362921 GiB | 362920 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |  18214 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198876 KiB |   7828 MiB | 362921 GiB | 362920 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |  18214 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195642 KiB |   7827 MiB | 362901 GiB | 362901 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 357414 GiB | 357414 GiB |
|       from small pool |  16663 KiB |     36 MiB |   5486 GiB |   5486 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8528 MiB |   8528 MiB |   8528 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59172 KiB | 732464 KiB | 204856 GiB | 204855 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 199353 GiB | 199353 GiB |
|       from small pool |   8410 KiB |  10852 KiB |   5502 GiB |   5502 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4424    |    6827    |   68596 K  |   68592 K  |
|       from large pool |      79    |     762    |   33765 K  |   33765 K  |
|       from small pool |    4345    |    6746    |   34830 K  |   34826 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4424    |    6827    |   68596 K  |   68592 K  |
|       from large pool |      79    |     762    |   33765 K  |   33765 K  |
|       from small pool |    4345    |    6746    |   34830 K  |   34826 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     370    |     370    |     370    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      31    |    3190    |   40318 K  |   40318 K  |
|       from large pool |      10    |     350    |   25587 K  |   25587 K  |
|       from small pool |      21    |    3180    |   14731 K  |   14730 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 362921 GiB | 362921 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |      0 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 362921 GiB | 362921 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |      0 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 362901 GiB | 362901 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 357414 GiB | 357414 GiB |
|       from small pool |      0 KiB |     36 MiB |   5486 GiB |   5486 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8528 MiB |   8528 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     42 MiB |     42 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 204856 GiB | 204856 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 199353 GiB | 199353 GiB |
|       from small pool |      0 KiB |  22549 KiB |   5502 GiB |   5502 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   68596 K  |   68596 K  |
|       from large pool |       2    |     762    |   33765 K  |   33765 K  |
|       from small pool |       0    |    6746    |   34830 K  |   34830 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   68596 K  |   68596 K  |
|       from large pool |       2    |     762    |   33765 K  |   33765 K  |
|       from small pool |       0    |    6746    |   34830 K  |   34830 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     370    |     370    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   40320 K  |   40320 K  |
|       from large pool |       3    |     350    |   25587 K  |   25587 K  |
|       from small pool |       0    |    3180    |   14732 K  |   14732 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 362921 GiB | 362921 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |      0 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 362921 GiB | 362921 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 357422 GiB | 357422 GiB |
|       from small pool |      0 KiB |     38 MiB |   5498 GiB |   5498 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 362901 GiB | 362901 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 357414 GiB | 357414 GiB |
|       from small pool |      0 KiB |     36 MiB |   5486 GiB |   5486 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8528 MiB |   8528 MiB |   8276 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     42 MiB |     42 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 204856 GiB | 204856 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 199353 GiB | 199353 GiB |
|       from small pool |      0 KiB |  22549 KiB |   5502 GiB |   5502 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6827    |   68596 K  |   68596 K  |
|       from large pool |       2    |     762    |   33765 K  |   33765 K  |
|       from small pool |       0    |    6746    |   34830 K  |   34830 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6827    |   68596 K  |   68596 K  |
|       from large pool |       2    |     762    |   33765 K  |   33765 K  |
|       from small pool |       0    |    6746    |   34830 K  |   34830 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     370    |     370    |     346    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      21    |      21    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3190    |   40320 K  |   40320 K  |
|       from large pool |       3    |     350    |   25587 K  |   25587 K  |
|       from small pool |       0    |    3180    |   14732 K  |   14732 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076

 Experiment start at: 2024-08-08 23:09:10.092442
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5408779978752136
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.79809964, 'precision': 0.7982359, 'recall': 0.7981084, 'specificity': 0.7981084, 'f1': 0.7980797, 'auroc': 0.8726746, 'binary_precision': 0.8048212, 'binary_recall': 0.78751427, 'binary_specificity': 0.8087025, 'binary_f1_score': 0.7960737}
confusion matrix:
       0      1
0  20537   4858
1   5405  20032
---- Validation: 
scalar performance:
{'acc': 0.86474335, 'precision': 0.50028056, 'recall': 0.5011729, 'specificity': 0.5011729, 'f1': 0.48470876, 'auroc': 0.7111796, 'binary_precision': 0.025666835, 'binary_recall': 0.118329465, 'binary_specificity': 0.8840163, 'binary_f1_score': 0.042183623}
confusion matrix:
       0     1
0  14756  1936
1    380    51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78059655, 'precision': 0.48900265, 'recall': 0.4783969, 'specificity': 0.4783969, 'f1': 0.476496, 'auroc': 0.6112873, 'binary_precision': 0.056603774, 'binary_recall': 0.12285337, 'binary_specificity': 0.83394045, 'binary_f1_score': 0.0775}
confusion matrix:
      0     1
0  7784  1550
1   664    93
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-08 23:28:55.305549,epoch time: 0:19:45.213107,used: 0:19:45.213107,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.86500627, 'precision': 0.86796105, 'recall': 0.8650416, 'specificity': 0.8650416, 'f1': 0.8647427, 'auroc': 0.9280556, 'binary_precision': 0.90113163, 'binary_recall': 0.82021546, 'binary_specificity': 0.9098677, 'binary_f1_score': 0.8587717}
confusion matrix:
       0      1
0  23107   2289
1   4573  20863
---- Validation: 
scalar performance:
{'acc': 0.8854757, 'precision': 0.5092775, 'recall': 0.53327936, 'specificity': 0.53327936, 'f1': 0.50281507, 'auroc': 0.7575401, 'binary_precision': 0.04191617, 'binary_recall': 0.16241299, 'binary_specificity': 0.9041457, 'binary_f1_score': 0.06663493}
confusion matrix:
       0     1
0  15092  1600
1    361    70
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8068576, 'precision': 0.49815658, 'recall': 0.49684086, 'specificity': 0.49684086, 'f1': 0.49249345, 'auroc': 0.6708474, 'binary_precision': 0.07183908, 'binary_recall': 0.1321004, 'binary_specificity': 0.8615813, 'binary_f1_score': 0.09306654}
confusion matrix:
      0     1
0  8042  1292
1   657   100
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-08 23:48:53.070467,epoch time: 0:19:57.764918,used: 0:39:42.978025,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.89229226, 'precision': 0.8966156, 'recall': 0.8923334, 'specificity': 0.8923334, 'f1': 0.8920051, 'auroc': 0.9486121, 'binary_precision': 0.93822175, 'binary_recall': 0.8400692, 'binary_specificity': 0.9445976, 'binary_f1_score': 0.8864367}
confusion matrix:
       0      1
0  23989   1407
1   4068  21368
---- Validation: 
scalar performance:
{'acc': 0.8992583, 'precision': 0.523836, 'recall': 0.57764316, 'specificity': 0.57764316, 'f1': 0.52664983, 'auroc': 0.79204714, 'binary_precision': 0.06866667, 'binary_recall': 0.23897912, 'binary_specificity': 0.9163072, 'binary_f1_score': 0.106680475}
confusion matrix:
       0     1
0  15295  1397
1    328   103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82628083, 'precision': 0.52911, 'recall': 0.5480047, 'specificity': 0.5480047, 'f1': 0.5315804, 'auroc': 0.7343834, 'binary_precision': 0.1255639, 'binary_recall': 0.22060767, 'binary_specificity': 0.87540174, 'binary_f1_score': 0.16003834}
confusion matrix:
      0     1
0  8171  1163
1   590   167
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 00:08:42.604920,epoch time: 0:19:49.534453,used: 0:59:32.512478,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9077943, 'precision': 0.91389894, 'recall': 0.90784454, 'specificity': 0.90784454, 'f1': 0.90746045, 'auroc': 0.9634429, 'binary_precision': 0.96437204, 'binary_recall': 0.84703386, 'binary_specificity': 0.9686552, 'binary_f1_score': 0.90190256}
confusion matrix:
       0      1
0  24599    796
1   3891  21546
---- Validation: 
scalar performance:
{'acc': 0.9095953, 'precision': 0.5379707, 'recall': 0.614589, 'specificity': 0.614589, 'f1': 0.54851335, 'auroc': 0.8145137, 'binary_precision': 0.09499638, 'binary_recall': 0.30394432, 'binary_specificity': 0.92523366, 'binary_f1_score': 0.14475138}
confusion matrix:
       0     1
0  15444  1248
1    300   131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84084827, 'precision': 0.55932885, 'recall': 0.5971507, 'specificity': 0.5971507, 'f1': 0.5688485, 'auroc': 0.7727168, 'binary_precision': 0.17816527, 'binary_recall': 0.31043592, 'binary_specificity': 0.8838654, 'binary_f1_score': 0.2263969}
confusion matrix:
      0     1
0  8250  1084
1   522   235
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-09 00:28:08.144843,epoch time: 0:19:25.539923,used: 1:18:58.052401,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9192044, 'precision': 0.9248646, 'recall': 0.91924536, 'specificity': 0.91924536, 'f1': 0.9189397, 'auroc': 0.971738, 'binary_precision': 0.9740808, 'binary_recall': 0.8614453, 'binary_specificity': 0.9770454, 'binary_f1_score': 0.9143072}
confusion matrix:
       0      1
0  24815    583
1   3524  21910
---- Validation: 
scalar performance:
{'acc': 0.92577237, 'precision': 0.56047714, 'recall': 0.6556604, 'specificity': 0.6556604, 'f1': 0.58110464, 'auroc': 0.83262455, 'binary_precision': 0.13793103, 'binary_recall': 0.3712297, 'binary_specificity': 0.9400911, 'binary_f1_score': 0.20113136}
confusion matrix:
       0     1
0  15692  1000
1    271   160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85412747, 'precision': 0.58699554, 'recall': 0.64135176, 'specificity': 0.64135176, 'f1': 0.60278827, 'auroc': 0.8031656, 'binary_precision': 0.22647284, 'binary_recall': 0.39101717, 'binary_specificity': 0.8916863, 'binary_f1_score': 0.28682172}
confusion matrix:
      0     1
0  8323  1011
1   461   296
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-09 00:47:08.245784,epoch time: 0:19:00.100941,used: 1:37:58.153342,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93041784, 'precision': 0.93336535, 'recall': 0.930452, 'specificity': 0.930452, 'f1': 0.9303031, 'auroc': 0.97700036, 'binary_precision': 0.96931255, 'binary_recall': 0.8890986, 'binary_specificity': 0.97180545, 'binary_f1_score': 0.9274745}
confusion matrix:
       0      1
0  24679    716
1   2821  22616
---- Validation: 
scalar performance:
{'acc': 0.9266484, 'precision': 0.5755822, 'recall': 0.7058358, 'specificity': 0.7058358, 'f1': 0.60332173, 'auroc': 0.8487502, 'binary_precision': 0.16545013, 'binary_recall': 0.47331786, 'binary_specificity': 0.9383537, 'binary_f1_score': 0.24519232}
confusion matrix:
       0     1
0  15663  1029
1    227   204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8493707, 'precision': 0.6084881, 'recall': 0.7061502, 'specificity': 0.7061502, 'f1': 0.63179696, 'auroc': 0.82763726, 'binary_precision': 0.25808498, 'binary_recall': 0.5376486, 'binary_specificity': 0.8746518, 'binary_f1_score': 0.3487575}
confusion matrix:
      0     1
0  8164  1170
1   350   407
better model found
persisted
after epoch: 6,now: 2024-08-09 01:05:53.794208,epoch time: 0:18:45.548424,used: 1:56:43.701766,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.933113, 'precision': 0.93748176, 'recall': 0.9331504, 'specificity': 0.9331504, 'f1': 0.93294954, 'auroc': 0.9815433, 'binary_precision': 0.98138684, 'binary_recall': 0.8830745, 'binary_specificity': 0.98322636, 'binary_f1_score': 0.9296387}
confusion matrix:
       0      1
0  24971    426
1   2974  22461
---- Validation: 
scalar performance:
{'acc': 0.93260527, 'precision': 0.58371234, 'recall': 0.7111514, 'specificity': 0.7111514, 'f1': 0.6138893, 'auroc': 0.8546225, 'binary_precision': 0.1814978, 'binary_recall': 0.47795823, 'binary_specificity': 0.9443446, 'binary_f1_score': 0.2630907}
confusion matrix:
       0    1
0  15763  929
1    225  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85531664, 'precision': 0.61738944, 'recall': 0.7202891, 'specificity': 0.7202891, 'f1': 0.6431366, 'auroc': 0.841604, 'binary_precision': 0.27366388, 'binary_recall': 0.5614267, 'binary_specificity': 0.87915146, 'binary_f1_score': 0.36796537}
confusion matrix:
      0     1
0  8206  1128
1   332   425
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-09 01:24:59.144346,epoch time: 0:19:05.350138,used: 2:15:49.051904,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9416509, 'precision': 0.9444327, 'recall': 0.9416837, 'specificity': 0.9416837, 'f1': 0.9415624, 'auroc': 0.9841584, 'binary_precision': 0.979801, 'binary_recall': 0.90199316, 'binary_specificity': 0.98137426, 'binary_f1_score': 0.9392885}
confusion matrix:
       0      1
0  24922    473
1   2493  22944
---- Validation: 
scalar performance:
{'acc': 0.93202126, 'precision': 0.5915167, 'recall': 0.7436259, 'specificity': 0.7436259, 'f1': 0.6259726, 'auroc': 0.8613641, 'binary_precision': 0.19534497, 'binary_recall': 0.5452436, 'binary_specificity': 0.94200814, 'binary_f1_score': 0.2876377}
confusion matrix:
       0    1
0  15724  968
1    196  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8460014, 'precision': 0.6210836, 'recall': 0.7522768, 'specificity': 0.7522768, 'f1': 0.64839137, 'auroc': 0.8521155, 'binary_precision': 0.2747315, 'binary_recall': 0.64200795, 'binary_specificity': 0.86254555, 'binary_f1_score': 0.3847981}
confusion matrix:
      0     1
0  8051  1283
1   271   486
early stop counter: 1
val acc:0.9320212602615356, best validation acc: 0.9326052665710449, corresponding to test acc:                         0.8553166389465332 / 0.8553166389465332
after epoch: 8,now: 2024-08-09 01:43:31.808883,epoch time: 0:18:32.664537,used: 2:34:21.716441,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9453297, 'precision': 0.94813037, 'recall': 0.94536406, 'specificity': 0.94536406, 'f1': 0.94524705, 'auroc': 0.98601675, 'binary_precision': 0.9837739, 'binary_recall': 0.9056923, 'binary_specificity': 0.98503584, 'binary_f1_score': 0.9431197}
confusion matrix:
       0      1
0  25014    380
1   2399  23039
---- Validation: 
scalar performance:
{'acc': 0.9381534, 'precision': 0.59972614, 'recall': 0.74225056, 'specificity': 0.74225056, 'f1': 0.63569343, 'auroc': 0.8658954, 'binary_precision': 0.21192661, 'binary_recall': 0.5359629, 'binary_specificity': 0.94853824, 'binary_f1_score': 0.30374753}
confusion matrix:
       0    1
0  15833  859
1    200  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85125357, 'precision': 0.6275963, 'recall': 0.762399, 'specificity': 0.762399, 'f1': 0.6570023, 'auroc': 0.8610594, 'binary_precision': 0.2862069, 'binary_recall': 0.65786, 'binary_specificity': 0.86693805, 'binary_f1_score': 0.39887866}
confusion matrix:
      0     1
0  8092  1242
1   259   498
better model found
persisted
after epoch: 9,now: 2024-08-09 02:02:23.715358,epoch time: 0:18:51.906475,used: 2:53:13.622916,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94881177, 'precision': 0.95082283, 'recall': 0.9488368, 'specificity': 0.9488368, 'f1': 0.9487566, 'auroc': 0.9869213, 'binary_precision': 0.98112017, 'binary_recall': 0.91531354, 'binary_specificity': 0.9823601, 'binary_f1_score': 0.9470751}
confusion matrix:
       0      1
0  24949    448
1   2154  23281
---- Validation: 
scalar performance:
{'acc': 0.9369853, 'precision': 0.6023868, 'recall': 0.7597337, 'specificity': 0.7597337, 'f1': 0.6405127, 'auroc': 0.8711596, 'binary_precision': 0.21628721, 'binary_recall': 0.57308584, 'binary_specificity': 0.9463815, 'binary_f1_score': 0.31404957}
confusion matrix:
       0    1
0  15797  895
1    184  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8477852, 'precision': 0.63222927, 'recall': 0.78662235, 'specificity': 0.78662235, 'f1': 0.6629205, 'auroc': 0.87036157, 'binary_precision': 0.29070392, 'binary_recall': 0.71466315, 'binary_specificity': 0.85858154, 'binary_f1_score': 0.41329262}
confusion matrix:
      0     1
0  8014  1320
1   216   541
early stop counter: 1
val acc:0.9369853138923645, best validation acc: 0.9381533861160278, corresponding to test acc:                         0.8512535691261292 / 0.8553166389465332
after epoch: 10,now: 2024-08-09 02:21:35.648628,epoch time: 0:19:11.933270,used: 3:12:25.556186,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95197904, 'precision': 0.9534942, 'recall': 0.9520042, 'specificity': 0.9520042, 'f1': 0.9519408, 'auroc': 0.9883553, 'binary_precision': 0.979924, 'binary_recall': 0.9229499, 'binary_specificity': 0.98105854, 'binary_f1_score': 0.950584}
confusion matrix:
       0      1
0  24913    481
1   1960  23478
---- Validation: 
scalar performance:
{'acc': 0.93681014, 'precision': 0.6037601, 'recall': 0.76642466, 'specificity': 0.76642466, 'f1': 0.6427543, 'auroc': 0.87512946, 'binary_precision': 0.21866897, 'binary_recall': 0.587007, 'binary_specificity': 0.9458423, 'binary_f1_score': 0.31863979}
confusion matrix:
       0    1
0  15788  904
1    178  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8573977, 'precision': 0.64235735, 'recall': 0.7991016, 'specificity': 0.7991016, 'f1': 0.6764939, 'auroc': 0.877409, 'binary_precision': 0.30928412, 'binary_recall': 0.7305152, 'binary_specificity': 0.867688, 'binary_f1_score': 0.43457758}
confusion matrix:
      0     1
0  8099  1235
1   204   553
new oracle model saved
early stop counter: 2
val acc:0.9368101358413696, best validation acc: 0.9381533861160278, corresponding to test acc:                         0.8512535691261292 / 0.8573976755142212
after epoch: 11,now: 2024-08-09 02:40:01.505906,epoch time: 0:18:25.857278,used: 3:30:51.413464,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95443815, 'precision': 0.9560809, 'recall': 0.9544607, 'specificity': 0.9544607, 'f1': 0.95439863, 'auroc': 0.9898285, 'binary_precision': 0.98364085, 'binary_recall': 0.9243169, 'binary_specificity': 0.9846045, 'binary_f1_score': 0.9530566}
confusion matrix:
       0      1
0  25006    391
1   1925  23510
---- Validation: 
scalar performance:
{'acc': 0.93908775, 'precision': 0.60786265, 'recall': 0.768723, 'specificity': 0.768723, 'f1': 0.64781487, 'auroc': 0.87882507, 'binary_precision': 0.22678572, 'binary_recall': 0.58932716, 'binary_specificity': 0.94811887, 'binary_f1_score': 0.32753065}
confusion matrix:
       0    1
0  15826  866
1    177  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86294717, 'precision': 0.6490414, 'recall': 0.80817074, 'specificity': 0.80817074, 'f1': 0.6852647, 'auroc': 0.8828126, 'binary_precision': 0.32134703, 'binary_recall': 0.74372524, 'binary_specificity': 0.87261623, 'binary_f1_score': 0.44878435}
confusion matrix:
      0     1
0  8145  1189
1   194   563
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-08-09 02:58:45.666365,epoch time: 0:18:44.160459,used: 3:49:35.573923,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95738906, 'precision': 0.9581641, 'recall': 0.9574045, 'specificity': 0.9574045, 'f1': 0.95737207, 'auroc': 0.9905745, 'binary_precision': 0.9771954, 'binary_recall': 0.9367014, 'binary_specificity': 0.97810763, 'binary_f1_score': 0.95652}
confusion matrix:
       0      1
0  24841    556
1   1610  23825
---- Validation: 
scalar performance:
{'acc': 0.93003565, 'precision': 0.6026916, 'recall': 0.8025048, 'specificity': 0.8025048, 'f1': 0.64389837, 'auroc': 0.8814118, 'binary_precision': 0.21444528, 'binary_recall': 0.6682135, 'binary_specificity': 0.93679607, 'binary_f1_score': 0.32468998}
confusion matrix:
       0     1
0  15637  1055
1    143   288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84292936, 'precision': 0.6391517, 'recall': 0.8234483, 'specificity': 0.8234483, 'f1': 0.67107546, 'auroc': 0.8867567, 'binary_precision': 0.29705882, 'binary_recall': 0.8005284, 'binary_specificity': 0.84636813, 'binary_f1_score': 0.43332142}
confusion matrix:
      0     1
0  7900  1434
1   151   606
early stop counter: 1
val acc:0.9300356507301331, best validation acc: 0.9390877485275269, corresponding to test acc:                         0.8629471659660339 / 0.8629471659660339
after epoch: 13,now: 2024-08-09 03:17:39.817798,epoch time: 0:18:54.151433,used: 4:08:29.725356,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9603006, 'precision': 0.9610227, 'recall': 0.96031785, 'specificity': 0.96031785, 'f1': 0.9602861, 'auroc': 0.99125814, 'binary_precision': 0.9794857, 'binary_recall': 0.94036484, 'binary_specificity': 0.9802709, 'binary_f1_score': 0.95952666}
confusion matrix:
       0      1
0  24893    501
1   1517  23921
---- Validation: 
scalar performance:
{'acc': 0.92799157, 'precision': 0.60044163, 'recall': 0.80371666, 'specificity': 0.80371666, 'f1': 0.64094746, 'auroc': 0.88276976, 'binary_precision': 0.2098408, 'binary_recall': 0.6728538, 'binary_specificity': 0.93457943, 'binary_f1_score': 0.31991175}
confusion matrix:
       0     1
0  15600  1092
1    141   290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84055096, 'precision': 0.6378757, 'recall': 0.82398343, 'specificity': 0.82398343, 'f1': 0.6690672, 'auroc': 0.88832724, 'binary_precision': 0.2942029, 'binary_recall': 0.8044914, 'binary_specificity': 0.84347546, 'binary_f1_score': 0.4308454}
confusion matrix:
      0     1
0  7873  1461
1   148   609
early stop counter: 2
val acc:0.9279915690422058, best validation acc: 0.9390877485275269, corresponding to test acc:                         0.8629471659660339 / 0.8629471659660339
after epoch: 14,now: 2024-08-09 03:35:52.982110,epoch time: 0:18:13.164312,used: 4:26:42.889668,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9600842, 'precision': 0.96092236, 'recall': 0.9601011, 'specificity': 0.9601011, 'f1': 0.96006715, 'auroc': 0.99138415, 'binary_precision': 0.98077476, 'binary_recall': 0.9386303, 'binary_specificity': 0.9815719, 'binary_f1_score': 0.9592399}
confusion matrix:
       0      1
0  24928    468
1   1561  23875
---- Validation: 
scalar performance:
{'acc': 0.9272908, 'precision': 0.600493, 'recall': 0.8078777, 'specificity': 0.8078777, 'f1': 0.64118755, 'auroc': 0.8823024, 'binary_precision': 0.20970044, 'binary_recall': 0.68213457, 'binary_specificity': 0.93362087, 'binary_f1_score': 0.3207856}
confusion matrix:
       0     1
0  15584  1108
1    137   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83569515, 'precision': 0.6372851, 'recall': 0.83228344, 'specificity': 0.83228344, 'f1': 0.66731364, 'auroc': 0.892454, 'binary_precision': 0.29095128, 'binary_recall': 0.8282695, 'binary_specificity': 0.8362974, 'binary_f1_score': 0.43063188}
confusion matrix:
      0     1
0  7806  1528
1   130   627
early stop counter: 3
val acc:0.9272907972335815, best validation acc: 0.9390877485275269, corresponding to test acc:                         0.8629471659660339 / 0.8629471659660339
after epoch: 15,now: 2024-08-09 03:54:53.767211,epoch time: 0:19:00.785101,used: 4:45:43.674769,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_08_23_09_09_seed_1_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:45:43.674769 at 2024-08-09 03:54:53.767211
persisted model performance metric: 

scalar performance:
{'acc': 0.86294717, 'precision': 0.6490414, 'recall': 0.80817074, 'specificity': 0.80817074, 'f1': 0.6852647, 'auroc': 0.8828126, 'binary_precision': 0.32134703, 'binary_recall': 0.74372524, 'binary_specificity': 0.87261623, 'binary_f1_score': 0.44878435}
confusion matrix:
      0     1
0  8145  1189
1   194   563
oracle model performance metric: 

scalar performance:
{'acc': 0.86294717, 'precision': 0.6490414, 'recall': 0.80817074, 'specificity': 0.80817074, 'f1': 0.6852647, 'auroc': 0.8828126, 'binary_precision': 0.32134703, 'binary_recall': 0.74372524, 'binary_specificity': 0.87261623, 'binary_f1_score': 0.44878435}
confusion matrix:
      0     1
0  8145  1189
1   194   563
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB | 730852 GiB | 730852 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |  18208 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB | 730852 GiB | 730852 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |  18208 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB | 730780 GiB | 730780 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 719761 GiB | 719761 GiB |
|       from small pool |  16662 KiB |     36 MiB |  11019 GiB |  11019 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8528 MiB |  16786 MiB |   8276 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     38 MiB |     42 MiB |     54 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38101 KiB | 732464 KiB | 398040 GiB | 398040 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 386978 GiB | 386978 GiB |
|       from small pool |   6368 KiB |  22549 KiB |  11061 GiB |  11061 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6849    |  137815 K  |  137811 K  |
|       from large pool |      79    |     762    |   67980 K  |   67979 K  |
|       from small pool |    4333    |    6768    |   69835 K  |   69831 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6849    |  137815 K  |  137811 K  |
|       from large pool |      79    |     762    |   67980 K  |   67979 K  |
|       from small pool |    4333    |    6768    |   69835 K  |   69831 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     370    |     713    |     346    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      19    |      21    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3199    |   78009 K  |   78009 K  |
|       from large pool |      11    |     351    |   47689 K  |   47689 K  |
|       from small pool |      23    |    3189    |   30320 K  |   30320 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 730852 GiB | 730852 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |      0 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 730852 GiB | 730852 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |      0 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 730780 GiB | 730780 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 719761 GiB | 719761 GiB |
|       from small pool |      0 KiB |     36 MiB |  11019 GiB |  11019 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8528 MiB |  16786 MiB |  16556 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     42 MiB |     54 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 398040 GiB | 398040 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 386978 GiB | 386978 GiB |
|       from small pool |      0 KiB |  22549 KiB |  11061 GiB |  11061 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  137815 K  |  137815 K  |
|       from large pool |       2    |     762    |   67980 K  |   67980 K  |
|       from small pool |       0    |    6768    |   69835 K  |   69835 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  137815 K  |  137815 K  |
|       from large pool |       2    |     762    |   67980 K  |   67980 K  |
|       from small pool |       0    |    6768    |   69835 K  |   69835 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     370    |     713    |     691    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      21    |      27    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |   78011 K  |   78011 K  |
|       from large pool |       3    |     351    |   47689 K  |   47689 K  |
|       from small pool |       0    |    3189    |   30322 K  |   30322 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 730852 GiB | 730852 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |      0 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 730852 GiB | 730852 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 719809 GiB | 719809 GiB |
|       from small pool |      0 KiB |     38 MiB |  11042 GiB |  11042 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 730780 GiB | 730780 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 719761 GiB | 719761 GiB |
|       from small pool |      0 KiB |     36 MiB |  11019 GiB |  11019 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8528 MiB |  16786 MiB |  16556 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     42 MiB |     54 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 398040 GiB | 398040 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 386978 GiB | 386978 GiB |
|       from small pool |      0 KiB |  22549 KiB |  11061 GiB |  11061 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6849    |  137815 K  |  137815 K  |
|       from large pool |       2    |     762    |   67980 K  |   67980 K  |
|       from small pool |       0    |    6768    |   69835 K  |   69835 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6849    |  137815 K  |  137815 K  |
|       from large pool |       2    |     762    |   67980 K  |   67980 K  |
|       from small pool |       0    |    6768    |   69835 K  |   69835 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     370    |     713    |     691    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      21    |      27    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3199    |   78011 K  |   78011 K  |
|       from large pool |       3    |     351    |   47689 K  |   47689 K  |
|       from small pool |       0    |    3189    |   30322 K  |   30322 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076

 Experiment start at: 2024-08-09 04:18:48.547034
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.8581054210662842
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.849969, 'precision': 0.85638404, 'recall': 0.84998727, 'specificity': 0.84998727, 'f1': 0.84929556, 'auroc': 0.91695774, 'binary_precision': 0.90426624, 'binary_recall': 0.7829047, 'binary_specificity': 0.9170698, 'binary_f1_score': 0.8392206}
confusion matrix:
       0      1
0  23698   2143
1   5613  20242
---- Validation: 
scalar performance:
{'acc': 0.8361948, 'precision': 0.51783395, 'recall': 0.59883004, 'specificity': 0.59883004, 'f1': 0.5021198, 'auroc': 0.6680255, 'binary_precision': 0.054497946, 'binary_recall': 0.3492823, 'binary_specificity': 0.8483778, 'binary_f1_score': 0.09428479}
confusion matrix:
       0     1
0  14173  2533
1    272   146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7758621, 'precision': 0.58357203, 'recall': 0.7131363, 'specificity': 0.7131363, 'f1': 0.5882757, 'auroc': 0.7670747, 'binary_precision': 0.20499396, 'binary_recall': 0.63864493, 'binary_specificity': 0.78762776, 'binary_f1_score': 0.31036586}
confusion matrix:
      0     1
0  7321  1974
1   288   509
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-09 04:38:52.840655,epoch time: 0:20:04.293621,used: 0:20:04.293621,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8984448, 'precision': 0.90330994, 'recall': 0.89846176, 'specificity': 0.89846176, 'f1': 0.8981403, 'auroc': 0.9537112, 'binary_precision': 0.947684, 'binary_recall': 0.84351796, 'binary_specificity': 0.95340556, 'binary_f1_score': 0.8925721}
confusion matrix:
       0      1
0  24636   1204
1   4046  21810
---- Validation: 
scalar performance:
{'acc': 0.9056295, 'precision': 0.5276612, 'recall': 0.58776635, 'specificity': 0.58776635, 'f1': 0.53306395, 'auroc': 0.71600235, 'binary_precision': 0.075177304, 'binary_recall': 0.25358853, 'binary_specificity': 0.9219442, 'binary_f1_score': 0.11597374}
confusion matrix:
       0     1
0  15402  1304
1    312   106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84780025, 'precision': 0.600075, 'recall': 0.67189115, 'specificity': 0.67189115, 'f1': 0.61938804, 'auroc': 0.7831279, 'binary_precision': 0.24983074, 'binary_recall': 0.4629862, 'binary_specificity': 0.88079613, 'binary_f1_score': 0.32453826}
confusion matrix:
      0     1
0  8187  1108
1   428   369
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-09 04:58:23.903177,epoch time: 0:19:31.062522,used: 0:39:35.356143,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.916628, 'precision': 0.9207616, 'recall': 0.91663754, 'specificity': 0.91663754, 'f1': 0.91642404, 'auroc': 0.9682436, 'binary_precision': 0.9625145, 'binary_recall': 0.8670561, 'binary_specificity': 0.96621907, 'binary_f1_score': 0.91229504}
confusion matrix:
       0      1
0  24970    873
1   3437  22416
---- Validation: 
scalar performance:
{'acc': 0.9128124, 'precision': 0.5392363, 'recall': 0.61827123, 'specificity': 0.61827123, 'f1': 0.55070084, 'auroc': 0.7514968, 'binary_precision': 0.09677419, 'binary_recall': 0.30861244, 'binary_specificity': 0.92793006, 'binary_f1_score': 0.14734438}
confusion matrix:
       0     1
0  15502  1204
1    289   129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85969085, 'precision': 0.6076575, 'recall': 0.66859573, 'specificity': 0.66859573, 'f1': 0.62684375, 'auroc': 0.80325603, 'binary_precision': 0.266062, 'binary_recall': 0.4416562, 'binary_specificity': 0.89553523, 'binary_f1_score': 0.33207548}
confusion matrix:
      0    1
0  8324  971
1   445  352
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-09 05:17:17.489684,epoch time: 0:18:53.586507,used: 0:58:28.942650,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92852443, 'precision': 0.9326437, 'recall': 0.9285282, 'specificity': 0.9285282, 'f1': 0.9283544, 'auroc': 0.9753971, 'binary_precision': 0.9748789, 'binary_recall': 0.8797292, 'binary_specificity': 0.9773272, 'binary_f1_score': 0.92486334}
confusion matrix:
       0      1
0  25260    586
1   3109  22741
---- Validation: 
scalar performance:
{'acc': 0.91970336, 'precision': 0.547151, 'recall': 0.6322991, 'specificity': 0.6322991, 'f1': 0.5624948, 'auroc': 0.7712543, 'binary_precision': 0.11192214, 'binary_recall': 0.33014354, 'binary_specificity': 0.9344547, 'binary_f1_score': 0.1671714}
confusion matrix:
       0     1
0  15611  1095
1    280   138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8714824, 'precision': 0.61819804, 'recall': 0.6675407, 'specificity': 0.6675407, 'f1': 0.6360313, 'auroc': 0.81700087, 'binary_precision': 0.2877759, 'binary_recall': 0.42534503, 'binary_specificity': 0.9097364, 'binary_f1_score': 0.34329116}
confusion matrix:
      0    1
0  8456  839
1   458  339
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-09 05:36:19.709054,epoch time: 0:19:02.219370,used: 1:17:31.162020,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93558496, 'precision': 0.937966, 'recall': 0.93559206, 'specificity': 0.93559206, 'f1': 0.935498, 'auroc': 0.97999775, 'binary_precision': 0.97030693, 'binary_recall': 0.8986965, 'binary_specificity': 0.9724877, 'binary_f1_score': 0.93312985}
confusion matrix:
       0      1
0  25132    711
1   2619  23234
---- Validation: 
scalar performance:
{'acc': 0.90936697, 'precision': 0.55404425, 'recall': 0.681815, 'specificity': 0.681815, 'f1': 0.5722484, 'auroc': 0.7934785, 'binary_precision': 0.123005316, 'binary_recall': 0.44258374, 'binary_specificity': 0.9210463, 'binary_f1_score': 0.19250779}
confusion matrix:
       0     1
0  15387  1319
1    233   185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87187874, 'precision': 0.63584846, 'recall': 0.71478784, 'specificity': 0.71478784, 'f1': 0.6613706, 'auroc': 0.8348321, 'binary_precision': 0.31464872, 'binary_recall': 0.52823085, 'binary_specificity': 0.90134484, 'binary_f1_score': 0.3943794}
confusion matrix:
      0    1
0  8378  917
1   376  421
new oracle model saved
early stop counter: 1
val acc:0.9093669652938843, best validation acc: 0.9197033643722534, corresponding to test acc:                         0.8714823722839355 / 0.8718787431716919
after epoch: 5,now: 2024-08-09 05:55:12.078645,epoch time: 0:18:52.369591,used: 1:36:23.531611,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94281954, 'precision': 0.9447439, 'recall': 0.94282466, 'specificity': 0.94282466, 'f1': 0.9427581, 'auroc': 0.9824246, 'binary_precision': 0.9740373, 'binary_recall': 0.90991026, 'binary_specificity': 0.97573906, 'binary_f1_score': 0.9408823}
confusion matrix:
       0      1
0  25217    627
1   2329  23523
---- Validation: 
scalar performance:
{'acc': 0.9183018, 'precision': 0.56138086, 'recall': 0.68756044, 'specificity': 0.68756044, 'f1': 0.5834871, 'auroc': 0.8033937, 'binary_precision': 0.13747229, 'binary_recall': 0.4449761, 'binary_specificity': 0.93014485, 'binary_f1_score': 0.21005084}
confusion matrix:
       0     1
0  15539  1167
1    232   186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88555294, 'precision': 0.6476752, 'recall': 0.701563, 'specificity': 0.701563, 'f1': 0.6683718, 'auroc': 0.84066105, 'binary_precision': 0.34131205, 'binary_recall': 0.4830615, 'binary_specificity': 0.92006457, 'binary_f1_score': 0.39999998}
confusion matrix:
      0    1
0  8552  743
1   412  385
new oracle model saved
early stop counter: 2
val acc:0.9183018207550049, best validation acc: 0.9197033643722534, corresponding to test acc:                         0.8714823722839355 / 0.8855529427528381
after epoch: 6,now: 2024-08-09 06:14:13.261990,epoch time: 0:19:01.183345,used: 1:55:24.714956,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9448313, 'precision': 0.94730914, 'recall': 0.9448385, 'specificity': 0.9448385, 'f1': 0.94475543, 'auroc': 0.98515344, 'binary_precision': 0.9806495, 'binary_recall': 0.90759295, 'binary_specificity': 0.9820841, 'binary_f1_score': 0.9427079}
confusion matrix:
       0      1
0  25380    463
1   2389  23464
---- Validation: 
scalar performance:
{'acc': 0.9232656, 'precision': 0.5699761, 'recall': 0.70526564, 'specificity': 0.70526564, 'f1': 0.59604526, 'auroc': 0.81404054, 'binary_precision': 0.1537867, 'binary_recall': 0.47607654, 'binary_specificity': 0.9344547, 'binary_f1_score': 0.23247662}
confusion matrix:
       0     1
0  15611  1095
1    219   199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8921918, 'precision': 0.65753645, 'recall': 0.7017257, 'specificity': 0.7017257, 'f1': 0.6756436, 'auroc': 0.84599304, 'binary_precision': 0.36129647, 'binary_recall': 0.47553325, 'binary_specificity': 0.92791826, 'binary_f1_score': 0.41061753}
confusion matrix:
      0    1
0  8625  670
1   418  379
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-09 06:33:12.854958,epoch time: 0:18:59.592968,used: 2:14:24.307924,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9488742, 'precision': 0.95104396, 'recall': 0.9488809, 'specificity': 0.9488809, 'f1': 0.9488132, 'auroc': 0.98667574, 'binary_precision': 0.9823759, 'binary_recall': 0.9141686, 'binary_specificity': 0.9835932, 'binary_f1_score': 0.9470458}
confusion matrix:
       0      1
0  25419    424
1   2219  23634
---- Validation: 
scalar performance:
{'acc': 0.9253679, 'precision': 0.5739911, 'recall': 0.7133405, 'specificity': 0.7133405, 'f1': 0.6018202, 'auroc': 0.8198732, 'binary_precision': 0.16141732, 'binary_recall': 0.49043062, 'binary_specificity': 0.93625045, 'binary_f1_score': 0.24289098}
confusion matrix:
       0     1
0  15641  1065
1    213   205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8971462, 'precision': 0.6609901, 'recall': 0.68606144, 'specificity': 0.68606144, 'f1': 0.6722194, 'auroc': 0.84653926, 'binary_precision': 0.371123, 'binary_recall': 0.4353827, 'binary_specificity': 0.93674016, 'binary_f1_score': 0.40069285}
confusion matrix:
      0    1
0  8707  588
1   450  347
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-09 06:52:15.025645,epoch time: 0:19:02.170687,used: 2:33:26.478611,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95365214, 'precision': 0.9552383, 'recall': 0.95365787, 'specificity': 0.95365787, 'f1': 0.95361215, 'auroc': 0.9884504, 'binary_precision': 0.98215824, 'binary_recall': 0.9241094, 'binary_specificity': 0.9832063, 'binary_f1_score': 0.95225}
confusion matrix:
       0      1
0  25409    434
1   1962  23891
---- Validation: 
scalar performance:
{'acc': 0.9148563, 'precision': 0.5674576, 'recall': 0.7231144, 'specificity': 0.7231144, 'f1': 0.5925683, 'auroc': 0.8239477, 'binary_precision': 0.14769648, 'binary_recall': 0.5215311, 'binary_specificity': 0.9246977, 'binary_f1_score': 0.23020065}
confusion matrix:
       0     1
0  15448  1258
1    200   218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89546174, 'precision': 0.66487306, 'recall': 0.70808935, 'specificity': 0.70808935, 'f1': 0.68285227, 'auroc': 0.8528017, 'binary_precision': 0.375, 'binary_recall': 0.48557088, 'binary_specificity': 0.93060786, 'binary_f1_score': 0.42318204}
confusion matrix:
      0    1
0  8650  645
1   410  387
early stop counter: 1
val acc:0.9148563146591187, best validation acc: 0.9253678917884827, corresponding to test acc:                         0.8971462249755859 / 0.8971462249755859
after epoch: 9,now: 2024-08-09 07:11:11.361277,epoch time: 0:18:56.335632,used: 2:52:22.814243,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9553157, 'precision': 0.9563697, 'recall': 0.9553194, 'specificity': 0.9553194, 'f1': 0.9552902, 'auroc': 0.98894453, 'binary_precision': 0.9783404, 'binary_recall': 0.93126255, 'binary_specificity': 0.97937626, 'binary_f1_score': 0.9542212}
confusion matrix:
       0      1
0  25311    533
1   1777  24075
---- Validation: 
scalar performance:
{'acc': 0.9186522, 'precision': 0.57198405, 'recall': 0.72972476, 'specificity': 0.72972476, 'f1': 0.5993596, 'auroc': 0.83077574, 'binary_precision': 0.1564482, 'binary_recall': 0.53110045, 'binary_specificity': 0.9283491, 'binary_f1_score': 0.24169841}
confusion matrix:
       0     1
0  15509  1197
1    196   222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89704716, 'precision': 0.6633581, 'recall': 0.6940375, 'specificity': 0.6940375, 'f1': 0.6767987, 'auroc': 0.85219496, 'binary_precision': 0.37448132, 'binary_recall': 0.45294857, 'binary_specificity': 0.9351264, 'binary_f1_score': 0.40999433}
confusion matrix:
      0    1
0  8692  603
1   436  361
early stop counter: 2
val acc:0.9186521768569946, best validation acc: 0.9253678917884827, corresponding to test acc:                         0.8971462249755859 / 0.8971462249755859
after epoch: 10,now: 2024-08-09 07:30:24.667041,epoch time: 0:19:13.305764,used: 3:11:36.120007,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95688254, 'precision': 0.95837057, 'recall': 0.9568881, 'specificity': 0.9568881, 'f1': 0.9568478, 'auroc': 0.9902382, 'binary_precision': 0.9845352, 'binary_recall': 0.9283642, 'binary_specificity': 0.9854119, 'binary_f1_score': 0.95562494}
confusion matrix:
       0      1
0  25466    377
1   1852  24001
---- Validation: 
scalar performance:
{'acc': 0.9189442, 'precision': 0.5736222, 'recall': 0.7357056, 'specificity': 0.7357056, 'f1': 0.6018198, 'auroc': 0.8363856, 'binary_precision': 0.15941012, 'binary_recall': 0.5430622, 'binary_specificity': 0.9283491, 'binary_f1_score': 0.24647124}
confusion matrix:
       0     1
0  15509  1197
1    191   227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89962345, 'precision': 0.6687879, 'recall': 0.69600964, 'specificity': 0.69600964, 'f1': 0.68094826, 'auroc': 0.85768616, 'binary_precision': 0.38510638, 'binary_recall': 0.45420325, 'binary_specificity': 0.937816, 'binary_f1_score': 0.41681057}
confusion matrix:
      0    1
0  8717  578
1   435  362
new oracle model saved
early stop counter: 3
val acc:0.9189441800117493, best validation acc: 0.9253678917884827, corresponding to test acc:                         0.8971462249755859 / 0.899623453617096
after epoch: 11,now: 2024-08-09 07:49:34.742331,epoch time: 0:19:10.075290,used: 3:30:46.195297,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96024835, 'precision': 0.9615123, 'recall': 0.9602535, 'specificity': 0.9602535, 'f1': 0.96022147, 'auroc': 0.9913593, 'binary_precision': 0.9857131, 'binary_recall': 0.9340502, 'binary_specificity': 0.9864567, 'binary_f1_score': 0.95918655}
confusion matrix:
       0      1
0  25493    350
1   1705  24148
---- Validation: 
scalar performance:
{'acc': 0.91450596, 'precision': 0.5700804, 'recall': 0.73576355, 'specificity': 0.73576355, 'f1': 0.5965024, 'auroc': 0.8353014, 'binary_precision': 0.15226063, 'binary_recall': 0.5478469, 'binary_specificity': 0.9236801, 'binary_f1_score': 0.23829342}
confusion matrix:
       0     1
0  15431  1275
1    189   229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9003171, 'precision': 0.67041993, 'recall': 0.69695973, 'specificity': 0.69695973, 'f1': 0.6823244, 'auroc': 0.8581254, 'binary_precision': 0.3882353, 'binary_recall': 0.45545796, 'binary_specificity': 0.93846154, 'binary_f1_score': 0.4191686}
confusion matrix:
      0    1
0  8723  572
1   434  363
new oracle model saved
early stop counter: 4
val acc:0.9145059585571289, best validation acc: 0.9253678917884827, corresponding to test acc:                         0.8971462249755859 / 0.9003170728683472
after epoch: 12,now: 2024-08-09 08:08:24.747895,epoch time: 0:18:50.005564,used: 3:49:36.200861,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96121556, 'precision': 0.9621346, 'recall': 0.9612199, 'specificity': 0.9612199, 'f1': 0.96119654, 'auroc': 0.9917236, 'binary_precision': 0.98279214, 'binary_recall': 0.9388852, 'binary_specificity': 0.98355454, 'binary_f1_score': 0.9603371}
confusion matrix:
       0      1
0  25418    425
1   1580  24273
---- Validation: 
scalar performance:
{'acc': 0.89289886, 'precision': 0.55949146, 'recall': 0.74801445, 'specificity': 0.74801445, 'f1': 0.57804364, 'auroc': 0.8332058, 'binary_precision': 0.13009404, 'binary_recall': 0.59569377, 'binary_specificity': 0.9003352, 'binary_f1_score': 0.21355058}
confusion matrix:
       0     1
0  15041  1665
1    169   249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8956599, 'precision': 0.6626278, 'recall': 0.69959354, 'specificity': 0.69959354, 'f1': 0.67837733, 'auroc': 0.85535157, 'binary_precision': 0.372, 'binary_recall': 0.46675032, 'binary_specificity': 0.93243676, 'binary_f1_score': 0.41402337}
confusion matrix:
      0    1
0  8667  628
1   425  372
early stop counter: 5
val acc:0.8928988575935364, best validation acc: 0.9253678917884827, corresponding to test acc:                         0.8971462249755859 / 0.9003170728683472
after epoch: 13,now: 2024-08-09 08:28:08.168290,epoch time: 0:19:43.420395,used: 4:09:19.621256,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96332407, 'precision': 0.9638076, 'recall': 0.9633259, 'specificity': 0.9633259, 'f1': 0.9633146, 'auroc': 0.9923599, 'binary_precision': 0.9788127, 'binary_recall': 0.9471587, 'binary_specificity': 0.97949314, 'binary_f1_score': 0.9627256}
confusion matrix:
       0      1
0  25315    530
1   1366  24485
---- Validation: 
scalar performance:
{'acc': 0.9037024, 'precision': 0.56722903, 'recall': 0.75705016, 'specificity': 0.75705016, 'f1': 0.5913566, 'auroc': 0.84129584, 'binary_precision': 0.14524496, 'binary_recall': 0.6028708, 'binary_specificity': 0.9112295, 'binary_f1_score': 0.23409197}
confusion matrix:
       0     1
0  15223  1483
1    166   252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89962345, 'precision': 0.6703131, 'recall': 0.7011717, 'specificity': 0.7011717, 'f1': 0.68391216, 'auroc': 0.8592485, 'binary_precision': 0.38726515, 'binary_recall': 0.46549562, 'binary_specificity': 0.93684775, 'binary_f1_score': 0.42279202}
confusion matrix:
      0    1
0  8708  587
1   426  371
early stop counter: 6
val acc:0.9037023782730103, best validation acc: 0.9253678917884827, corresponding to test acc:                         0.8971462249755859 / 0.9003170728683472
after epoch: 14,now: 2024-08-09 08:47:43.399308,epoch time: 0:19:35.231018,used: 4:28:54.852274,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96638036, 'precision': 0.966955, 'recall': 0.9663851, 'specificity': 0.9663851, 'f1': 0.9663702, 'auroc': 0.9935305, 'binary_precision': 0.9834035, 'binary_recall': 0.9487913, 'binary_specificity': 0.9839789, 'binary_f1_score': 0.9657874}
confusion matrix:
       0      1
0  25427    414
1   1324  24531
---- Validation: 
scalar performance:
{'acc': 0.89774585, 'precision': 0.5622392, 'recall': 0.74933237, 'specificity': 0.74933237, 'f1': 0.58301085, 'auroc': 0.8376391, 'binary_precision': 0.13559322, 'binary_recall': 0.5933014, 'binary_specificity': 0.9053633, 'binary_f1_score': 0.22073877}
confusion matrix:
       0     1
0  15125  1581
1    170   248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90071344, 'precision': 0.6742065, 'recall': 0.707499, 'specificity': 0.707499, 'f1': 0.6887877, 'auroc': 0.86002886, 'binary_precision': 0.39400208, 'binary_recall': 0.47804266, 'binary_specificity': 0.93695533, 'binary_f1_score': 0.43197277}
confusion matrix:
      0    1
0  8709  586
1   416  381
new oracle model saved
early stop counter: 7
val acc:0.8977458477020264, best validation acc: 0.9253678917884827, corresponding to test acc:                         0.8971462249755859 / 0.9007134437561035
after epoch: 15,now: 2024-08-09 09:06:39.962260,epoch time: 0:18:56.562952,used: 4:47:51.415226,model: dset_te_center4_erm_b8efecac6_not_commited_2024md_08md_09_04_18_48_seed_2_24116076
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 15 with time: 4:47:51.415226 at 2024-08-09 09:06:39.962260
persisted model performance metric: 

scalar performance:
{'acc': 0.8971462, 'precision': 0.6609901, 'recall': 0.68606144, 'specificity': 0.68606144, 'f1': 0.6722194, 'auroc': 0.84653926, 'binary_precision': 0.371123, 'binary_recall': 0.4353827, 'binary_specificity': 0.93674016, 'binary_f1_score': 0.40069285}
confusion matrix:
      0    1
0  8707  588
1   450  347
oracle model performance metric: 

scalar performance:
{'acc': 0.90071344, 'precision': 0.6742065, 'recall': 0.707499, 'specificity': 0.707499, 'f1': 0.6887877, 'auroc': 0.86002886, 'binary_precision': 0.39400208, 'binary_recall': 0.47804266, 'binary_specificity': 0.93695533, 'binary_f1_score': 0.43197277}
confusion matrix:
      0    1
0  8709  586
1   416  381
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center4_dinov2small_erm_irm_highregularization_2024-08-08_00-44-32/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197419 KiB |   7828 MiB |   1087 TiB |   1087 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1071 TiB |   1071 TiB |
|       from small pool |  18208 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197419 KiB |   7828 MiB |   1087 TiB |   1087 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1071 TiB |   1071 TiB |
|       from small pool |  18208 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195641 KiB |   7827 MiB |   1087 TiB |   1087 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1071 TiB |   1071 TiB |
|       from small pool |  16662 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8528 MiB |  25070 MiB |  16556 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25000 MiB |  16526 MiB |
|       from small pool |     40 MiB |     42 MiB |     70 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40149 KiB | 732464 KiB | 607083 GiB | 607083 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 590316 GiB | 590316 GiB |
|       from small pool |   8416 KiB |  22549 KiB |  16767 GiB |  16767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    4412    |    6957    |  209039 K  |  209035 K  |
|       from large pool |      79    |     762    |  103525 K  |  103525 K  |
|       from small pool |    4333    |    6876    |  105514 K  |  105509 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    4412    |    6957    |  209039 K  |  209035 K  |
|       from large pool |      79    |     762    |  103525 K  |  103525 K  |
|       from small pool |    4333    |    6876    |  105514 K  |  105509 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     370    |    1060    |     691    |
|       from large pool |     349    |     349    |    1025    |     676    |
|       from small pool |      20    |      21    |      35    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3255    |  115517 K  |  115517 K  |
|       from large pool |      11    |     352    |   70302 K  |   70302 K  |
|       from small pool |      24    |    3245    |   45214 K  |   45214 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1087 TiB |   1087 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1071 TiB |   1071 TiB |
|       from small pool |      0 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1087 TiB |   1087 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1071 TiB |   1071 TiB |
|       from small pool |      0 KiB |     38 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1087 TiB |   1087 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1071 TiB |   1071 TiB |
|       from small pool |      0 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8528 MiB |  25070 MiB |  24838 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25000 MiB |  24794 MiB |
|       from small pool |  26624 KiB |     42 MiB |     70 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 607083 GiB | 607083 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 590316 GiB | 590316 GiB |
|       from small pool |      0 KiB |  22555 KiB |  16767 GiB |  16767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    6957    |  209039 K  |  209039 K  |
|       from large pool |       2    |     762    |  103525 K  |  103525 K  |
|       from small pool |       0    |    6876    |  105514 K  |  105514 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    6957    |  209039 K  |  209039 K  |
|       from large pool |       2    |     762    |  103525 K  |  103525 K  |
|       from small pool |       0    |    6876    |  105514 K  |  105514 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     370    |    1060    |    1037    |
|       from large pool |      10    |     349    |    1025    |    1015    |
|       from small pool |      13    |      21    |      35    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3255    |  115519 K  |  115519 K  |
|       from large pool |       3    |     352    |   70302 K  |   70302 K  |
|       from small pool |       0    |    3245    |   45216 K  |   45216 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  9 09:22:29 2024]
Finished job 0.
1 of 1 steps (100%) done
