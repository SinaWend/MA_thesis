Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  2 13:00:04 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_halffreeze_2024-08-02_12-56-38/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_halffreeze_2024-08-02_12-56-38/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_13_10_34_seed_0_24046582

 Experiment start at: 2024-08-02 13:10:35.295017
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.22451263666152954
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93929565, 'precision': 0.9420956, 'recall': 0.9393263, 'specificity': 0.9393263, 'f1': 0.9392023, 'auroc': 0.97722363, 'binary_precision': 0.97747064, 'binary_recall': 0.89941466, 'binary_specificity': 0.9792379, 'binary_f1_score': 0.93681955}
confusion matrix:
       0      1
0  28063    595
1   2887  25815
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.95274585, 'precision': 0.5440198, 'recall': 0.5225025, 'specificity': 0.5225025, 'f1': 0.52824754, 'auroc': 0.7514295, 'binary_precision': 0.120743036, 'binary_recall': 0.060653187, 'binary_specificity': 0.98435175, 'binary_f1_score': 0.08074535}
confusion matrix:
       0    1
0  17865  284
1    604   39
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9328859, 'precision': 0.5493675, 'recall': 0.54171336, 'specificity': 0.54171336, 'f1': 0.54505235, 'auroc': 0.80491334, 'binary_precision': 0.1369863, 'binary_recall': 0.11494253, 'binary_specificity': 0.9684842, 'binary_f1_score': 0.125}
confusion matrix:
      0    1
0  5808  189
1   231   30
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 13:45:06.555237,epoch time: 0:34:31.260220,used: 0:34:31.260220,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_13_10_34_seed_0_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9576883, 'precision': 0.95867467, 'recall': 0.9577078, 'specificity': 0.9577078, 'f1': 0.95766675, 'auroc': 0.98716164, 'binary_precision': 0.9801557, 'binary_recall': 0.93436456, 'binary_specificity': 0.9810511, 'binary_f1_score': 0.9567125}
confusion matrix:
       0      1
0  28113    543
1   1884  26820
---- Validation: 
scalar performance:
{'acc': 0.94790334, 'precision': 0.6205042, 'recall': 0.6340039, 'specificity': 0.6340039, 'f1': 0.62682444, 'auroc': 0.8293979, 'binary_precision': 0.26601672, 'binary_recall': 0.2970451, 'binary_specificity': 0.9709626, 'binary_f1_score': 0.28067598}
confusion matrix:
       0    1
0  17622  527
1    452  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9292106, 'precision': 0.6346926, 'recall': 0.71936446, 'specificity': 0.71936446, 'f1': 0.6643746, 'auroc': 0.8511047, 'binary_precision': 0.29223743, 'binary_recall': 0.49042144, 'binary_specificity': 0.9483075, 'binary_f1_score': 0.36623746}
confusion matrix:
      0    1
0  5687  310
1   133  128
early stop counter: 1
val acc:0.9479033350944519, best validation acc: 0.9527458548545837, corresponding to test acc:                         0.9328858852386475 / 0.9328858852386475
after epoch: 2,now: 2024-08-02 14:19:07.524176,epoch time: 0:34:00.968939,used: 1:08:32.229159,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_13_10_34_seed_0_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96445256, 'precision': 0.9648507, 'recall': 0.9644655, 'specificity': 0.9644655, 'f1': 0.9644456, 'auroc': 0.99071264, 'binary_precision': 0.97867453, 'binary_recall': 0.94966036, 'binary_specificity': 0.97927064, 'binary_f1_score': 0.96394914}
confusion matrix:
       0      1
0  28061    594
1   1445  27260
---- Validation: 
scalar performance:
{'acc': 0.9390166, 'precision': 0.6222104, 'recall': 0.6984081, 'specificity': 0.6984081, 'f1': 0.64933026, 'auroc': 0.8542323, 'binary_precision': 0.2647334, 'binary_recall': 0.44012442, 'binary_specificity': 0.9566918, 'binary_f1_score': 0.33060747}
confusion matrix:
       0    1
0  17363  786
1    360  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.915628, 'precision': 0.63242805, 'recall': 0.79106796, 'specificity': 0.79106796, 'f1': 0.673883, 'auroc': 0.8689351, 'binary_precision': 0.28078818, 'binary_recall': 0.6551724, 'binary_specificity': 0.9269635, 'binary_f1_score': 0.39310345}
confusion matrix:
      0    1
0  5559  438
1    90  171
early stop counter: 2
val acc:0.939016580581665, best validation acc: 0.9527458548545837, corresponding to test acc:                         0.9328858852386475 / 0.9328858852386475
after epoch: 3,now: 2024-08-02 14:50:36.821275,epoch time: 0:31:29.297099,used: 1:40:01.526258,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_13_10_34_seed_0_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9686192, 'precision': 0.9693901, 'recall': 0.9686371, 'specificity': 0.9686371, 'f1': 0.9686072, 'auroc': 0.99252295, 'binary_precision': 0.988631, 'binary_recall': 0.9481972, 'binary_specificity': 0.989077, 'binary_f1_score': 0.96799207}
confusion matrix:
       0      1
0  28342    313
1   1487  27218
---- Validation: 
scalar performance:
{'acc': 0.9349191, 'precision': 0.6176162, 'recall': 0.7097878, 'specificity': 0.7097878, 'f1': 0.6478309, 'auroc': 0.8551028, 'binary_precision': 0.25465313, 'binary_recall': 0.4681182, 'binary_specificity': 0.9514574, 'binary_f1_score': 0.32986304}
confusion matrix:
       0    1
0  17268  881
1    342  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90715885, 'precision': 0.62765574, 'recall': 0.8141341, 'specificity': 0.8141341, 'f1': 0.6700499, 'auroc': 0.877288, 'binary_precision': 0.26878613, 'binary_recall': 0.7126437, 'binary_specificity': 0.9156245, 'binary_f1_score': 0.39034626}
confusion matrix:
      0    1
0  5491  506
1    75  186
early stop counter: 3
val acc:0.9349191188812256, best validation acc: 0.9527458548545837, corresponding to test acc:                         0.9328858852386475 / 0.9328858852386475
after epoch: 4,now: 2024-08-02 15:21:21.501758,epoch time: 0:30:44.680483,used: 2:10:46.206741,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_13_10_34_seed_0_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 4 with time: 2:10:46.206741 at 2024-08-02 15:21:21.501758
persisted model performance metric: 

scalar performance:
{'acc': 0.9328859, 'precision': 0.5493675, 'recall': 0.54171336, 'specificity': 0.54171336, 'f1': 0.54505235, 'auroc': 0.80491334, 'binary_precision': 0.1369863, 'binary_recall': 0.11494253, 'binary_specificity': 0.9684842, 'binary_f1_score': 0.125}
confusion matrix:
      0    1
0  5808  189
1   231   30
oracle model performance metric: 

scalar performance:
{'acc': 0.9328859, 'precision': 0.5493675, 'recall': 0.54171336, 'specificity': 0.54171336, 'f1': 0.54505235, 'auroc': 0.80491334, 'binary_precision': 0.1369863, 'binary_recall': 0.11494253, 'binary_specificity': 0.9684842, 'binary_f1_score': 0.125}
confusion matrix:
      0    1
0  5808  189
1   231   30
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_halffreeze_2024-08-02_12-56-38/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_halffreeze_2024-08-02_12-56-38/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_halffreeze_2024-08-02_12-56-38/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198163 KiB |   2142 MiB | 212231 GiB | 212231 GiB |
|       from large pool | 180662 KiB |   2124 MiB | 209660 GiB | 209659 GiB |
|       from small pool |  17501 KiB |     37 MiB |   2571 GiB |   2571 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198163 KiB |   2142 MiB | 212231 GiB | 212231 GiB |
|       from large pool | 180662 KiB |   2124 MiB | 209660 GiB | 209659 GiB |
|       from small pool |  17501 KiB |     37 MiB |   2571 GiB |   2571 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   2141 MiB | 212210 GiB | 212210 GiB |
|       from large pool | 178979 KiB |   2123 MiB | 209642 GiB | 209642 GiB |
|       from small pool |  16482 KiB |     36 MiB |   2567 GiB |   2567 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2372 MiB |   2372 MiB |   2372 MiB |      0 B   |
|       from large pool |   2330 MiB |   2330 MiB |   2330 MiB |      0 B   |
|       from small pool |     42 MiB |     42 MiB |     42 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55789 KiB | 225565 KiB | 114197 GiB | 114197 GiB |
|       from large pool |  50762 KiB | 224940 KiB | 111602 GiB | 111602 GiB |
|       from small pool |   5027 KiB |   9264 KiB |   2595 GiB |   2595 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2998    |    7665    |   32064 K  |   32061 K  |
|       from large pool |      79    |     252    |   19300 K  |   19300 K  |
|       from small pool |    2919    |    7585    |   12764 K  |   12761 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2998    |    7665    |   32064 K  |   32061 K  |
|       from large pool |      79    |     252    |   19300 K  |   19300 K  |
|       from small pool |    2919    |    7585    |   12764 K  |   12761 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     118    |     118    |     118    |       0    |
|       from large pool |      97    |      97    |      97    |       0    |
|       from small pool |      21    |      21    |      21    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    3602    |   20815 K  |   20815 K  |
|       from large pool |      10    |      97    |   14983 K  |   14983 K  |
|       from small pool |      27    |    3592    |    5831 K  |    5831 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 212231 GiB | 212231 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 209660 GiB | 209660 GiB |
|       from small pool |      0 KiB |     37 MiB |   2571 GiB |   2571 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 212231 GiB | 212231 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 209660 GiB | 209660 GiB |
|       from small pool |      0 KiB |     37 MiB |   2571 GiB |   2571 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 212210 GiB | 212210 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 209642 GiB | 209642 GiB |
|       from small pool |      0 KiB |     36 MiB |   2567 GiB |   2567 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 253952 KiB |   2372 MiB |   2372 MiB |   2124 MiB |
|       from large pool | 231424 KiB |   2330 MiB |   2330 MiB |   2104 MiB |
|       from small pool |  22528 KiB |     42 MiB |     42 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 225565 KiB | 114197 GiB | 114197 GiB |
|       from large pool |  30464 KiB | 224940 KiB | 111602 GiB | 111602 GiB |
|       from small pool |      0 KiB |  17126 KiB |   2595 GiB |   2595 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7665    |   32064 K  |   32064 K  |
|       from large pool |       2    |     252    |   19300 K  |   19300 K  |
|       from small pool |       0    |    7585    |   12764 K  |   12764 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7665    |   32064 K  |   32064 K  |
|       from large pool |       2    |     252    |   19300 K  |   19300 K  |
|       from small pool |       0    |    7585    |   12764 K  |   12764 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     118    |     118    |      96    |
|       from large pool |      11    |      97    |      97    |      86    |
|       from small pool |      11    |      21    |      21    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3602    |   20816 K  |   20816 K  |
|       from large pool |       3    |      97    |   14983 K  |   14983 K  |
|       from small pool |       0    |    3592    |    5832 K  |    5832 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 212231 GiB | 212231 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 209660 GiB | 209660 GiB |
|       from small pool |      0 KiB |     37 MiB |   2571 GiB |   2571 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 212231 GiB | 212231 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 209660 GiB | 209660 GiB |
|       from small pool |      0 KiB |     37 MiB |   2571 GiB |   2571 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 212210 GiB | 212210 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 209642 GiB | 209642 GiB |
|       from small pool |      0 KiB |     36 MiB |   2567 GiB |   2567 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 253952 KiB |   2372 MiB |   2372 MiB |   2124 MiB |
|       from large pool | 231424 KiB |   2330 MiB |   2330 MiB |   2104 MiB |
|       from small pool |  22528 KiB |     42 MiB |     42 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 225565 KiB | 114197 GiB | 114197 GiB |
|       from large pool |  30464 KiB | 224940 KiB | 111602 GiB | 111602 GiB |
|       from small pool |      0 KiB |  17126 KiB |   2595 GiB |   2595 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7665    |   32064 K  |   32064 K  |
|       from large pool |       2    |     252    |   19300 K  |   19300 K  |
|       from small pool |       0    |    7585    |   12764 K  |   12764 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7665    |   32064 K  |   32064 K  |
|       from large pool |       2    |     252    |   19300 K  |   19300 K  |
|       from small pool |       0    |    7585    |   12764 K  |   12764 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     118    |     118    |      96    |
|       from large pool |      11    |      97    |      97    |      86    |
|       from small pool |      11    |      21    |      21    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3602    |   20816 K  |   20816 K  |
|       from large pool |       3    |      97    |   14983 K  |   14983 K  |
|       from small pool |       0    |    3592    |    5832 K  |    5832 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_15_32_36_seed_1_24046582

 Experiment start at: 2024-08-02 15:32:37.149550
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6890106797218323
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9383331, 'precision': 0.9413135, 'recall': 0.9383646, 'specificity': 0.9383646, 'f1': 0.9382318, 'auroc': 0.9795134, 'binary_precision': 0.9777719, 'binary_recall': 0.89715576, 'binary_specificity': 0.9795734, 'binary_f1_score': 0.9357307}
confusion matrix:
       0      1
0  28198    588
1   2965  25865
---- Validation: 
scalar performance:
{'acc': 0.9533084, 'precision': 0.64337486, 'recall': 0.6167204, 'specificity': 0.6167204, 'f1': 0.6284448, 'auroc': 0.8211137, 'binary_precision': 0.31433824, 'binary_recall': 0.25408617, 'binary_specificity': 0.9793546, 'binary_f1_score': 0.28101888}
confusion matrix:
       0    1
0  17694  373
1    502  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9461811, 'precision': 0.6666464, 'recall': 0.6703201, 'specificity': 0.6703201, 'f1': 0.66845936, 'auroc': 0.8579724, 'binary_precision': 0.36090225, 'binary_recall': 0.36923078, 'binary_specificity': 0.9714094, 'binary_f1_score': 0.365019}
confusion matrix:
      0    1
0  5776  170
1   164   96
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 16:05:24.055417,epoch time: 0:32:46.905867,used: 0:32:46.905867,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_15_32_36_seed_1_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95666134, 'precision': 0.9576626, 'recall': 0.9566785, 'specificity': 0.9566785, 'f1': 0.9566388, 'auroc': 0.9892665, 'binary_precision': 0.9792516, 'binary_recall': 0.93315756, 'binary_specificity': 0.9801994, 'binary_f1_score': 0.95564914}
confusion matrix:
       0      1
0  28217    570
1   1927  26902
---- Validation: 
scalar performance:
{'acc': 0.95715046, 'precision': 0.6872997, 'recall': 0.6773649, 'specificity': 0.6773649, 'f1': 0.68217725, 'auroc': 0.8501851, 'binary_precision': 0.39779875, 'binary_recall': 0.37592867, 'binary_specificity': 0.97880113, 'binary_f1_score': 0.38655463}
confusion matrix:
       0    1
0  17684  383
1    420  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95520467, 'precision': 0.72304434, 'recall': 0.73939365, 'specificity': 0.73939365, 'f1': 0.73088443, 'auroc': 0.89826226, 'binary_precision': 0.46785715, 'binary_recall': 0.50384617, 'binary_specificity': 0.97494113, 'binary_f1_score': 0.48518524}
confusion matrix:
      0    1
0  5797  149
1   129  131
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 16:36:08.996721,epoch time: 0:30:44.941304,used: 1:03:31.847171,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_15_32_36_seed_1_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9628402, 'precision': 0.96295375, 'recall': 0.96284604, 'specificity': 0.96284604, 'f1': 0.96283823, 'auroc': 0.99258375, 'binary_precision': 0.9703892, 'binary_recall': 0.95487183, 'binary_specificity': 0.9708202, 'binary_f1_score': 0.962568}
confusion matrix:
       0      1
0  27947    840
1   1301  27528
---- Validation: 
scalar performance:
{'acc': 0.9585912, 'precision': 0.6982088, 'recall': 0.6874106, 'specificity': 0.6874106, 'f1': 0.6926374, 'auroc': 0.8637198, 'binary_precision': 0.41889763, 'binary_recall': 0.39524516, 'binary_specificity': 0.97957605, 'binary_f1_score': 0.40672782}
confusion matrix:
       0    1
0  17698  369
1    407  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.7469256, 'recall': 0.7874706, 'specificity': 0.7874706, 'f1': 0.7654284, 'auroc': 0.9060474, 'binary_precision': 0.5114754, 'binary_recall': 0.6, 'binary_specificity': 0.97494113, 'binary_f1_score': 0.55221236}
confusion matrix:
      0    1
0  5797  149
1   104  156
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-02 17:07:19.630532,epoch time: 0:31:10.633811,used: 1:34:42.480982,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_15_32_36_seed_1_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9673008, 'precision': 0.9677023, 'recall': 0.9673115, 'specificity': 0.9673115, 'f1': 0.9672943, 'auroc': 0.9936624, 'binary_precision': 0.9815907, 'binary_recall': 0.9525131, 'binary_specificity': 0.98210996, 'binary_f1_score': 0.96683335}
confusion matrix:
       0      1
0  28272    515
1   1369  27460
---- Validation: 
scalar performance:
{'acc': 0.9590715, 'precision': 0.6919837, 'recall': 0.6490352, 'specificity': 0.6490352, 'f1': 0.6674338, 'auroc': 0.8450863, 'binary_precision': 0.4092664, 'binary_recall': 0.31500742, 'binary_specificity': 0.98306304, 'binary_f1_score': 0.35600337}
confusion matrix:
       0    1
0  17761  306
1    461  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9611666, 'precision': 0.7585005, 'recall': 0.74802196, 'specificity': 0.74802196, 'f1': 0.75313777, 'auroc': 0.89249337, 'binary_precision': 0.53815264, 'binary_recall': 0.5153846, 'binary_specificity': 0.98065925, 'binary_f1_score': 0.5265226}
confusion matrix:
      0    1
0  5831  115
1   126  134
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-02 17:38:06.591399,epoch time: 0:30:46.960867,used: 2:05:29.441849,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_15_32_36_seed_1_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96976537, 'precision': 0.97009087, 'recall': 0.9697751, 'specificity': 0.9697751, 'f1': 0.96976054, 'auroc': 0.99436396, 'binary_precision': 0.982645, 'binary_recall': 0.95646745, 'binary_specificity': 0.98308265, 'binary_f1_score': 0.9693795}
confusion matrix:
       0      1
0  28300    487
1   1255  27574
---- Validation: 
scalar performance:
{'acc': 0.95720387, 'precision': 0.6929505, 'recall': 0.6995659, 'specificity': 0.6995659, 'f1': 0.6961943, 'auroc': 0.87873614, 'binary_precision': 0.40746054, 'binary_recall': 0.42199108, 'binary_specificity': 0.97714067, 'binary_f1_score': 0.41459852}
confusion matrix:
       0    1
0  17654  413
1    389  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96358365, 'precision': 0.7711496, 'recall': 0.7989359, 'specificity': 0.7989359, 'f1': 0.784271, 'auroc': 0.9141575, 'binary_precision': 0.5590278, 'binary_recall': 0.61923075, 'binary_specificity': 0.9786411, 'binary_f1_score': 0.58759123}
confusion matrix:
      0    1
0  5819  127
1    99  161
new oracle model saved
early stop counter: 1
val acc:0.9572038650512695, best validation acc: 0.9590715169906616, corresponding to test acc:                         0.9611666202545166 / 0.9635836482048035
after epoch: 5,now: 2024-08-02 18:08:34.586709,epoch time: 0:30:27.995310,used: 2:35:57.437159,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_15_32_36_seed_1_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9733234, 'precision': 0.9738247, 'recall': 0.9733353, 'specificity': 0.9733353, 'f1': 0.9733168, 'auroc': 0.995916, 'binary_precision': 0.9894197, 'binary_recall': 0.95691836, 'binary_specificity': 0.9897523, 'binary_f1_score': 0.97289765}
confusion matrix:
       0      1
0  28492    295
1   1242  27587
---- Validation: 
scalar performance:
{'acc': 0.96168625, 'precision': 0.70910126, 'recall': 0.62893325, 'specificity': 0.62893325, 'f1': 0.6583438, 'auroc': 0.87876725, 'binary_precision': 0.44498777, 'binary_recall': 0.2704309, 'binary_specificity': 0.98743564, 'binary_f1_score': 0.336414}
confusion matrix:
       0    1
0  17840  227
1    491  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9690622, 'precision': 0.82528937, 'recall': 0.7503034, 'specificity': 0.7503034, 'f1': 0.7823622, 'auroc': 0.9124744, 'binary_precision': 0.67171717, 'binary_recall': 0.51153845, 'binary_specificity': 0.98906827, 'binary_f1_score': 0.580786}
confusion matrix:
      0    1
0  5881   65
1   127  133
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-02 18:39:18.790520,epoch time: 0:30:44.203811,used: 3:06:41.640970,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_15_32_36_seed_1_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.972282, 'precision': 0.97301376, 'recall': 0.9722965, 'specificity': 0.9722965, 'f1': 0.9722719, 'auroc': 0.9956571, 'binary_precision': 0.9918009, 'binary_recall': 0.9524784, 'binary_specificity': 0.9921145, 'binary_f1_score': 0.97174203}
confusion matrix:
       0      1
0  28560    227
1   1370  27459
---- Validation: 
scalar performance:
{'acc': 0.96195304, 'precision': 0.7075328, 'recall': 0.6104747, 'specificity': 0.6104747, 'f1': 0.64241594, 'auroc': 0.86876416, 'binary_precision': 0.4431818, 'binary_recall': 0.23179792, 'binary_specificity': 0.9891515, 'binary_f1_score': 0.30439022}
confusion matrix:
       0    1
0  17871  196
1    517  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97115695, 'precision': 0.8547708, 'recall': 0.7422016, 'specificity': 0.7422016, 'f1': 0.78678024, 'auroc': 0.90664166, 'binary_precision': 0.73142856, 'binary_recall': 0.4923077, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.58850574}
confusion matrix:
      0    1
0  5899   47
1   132  128
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-08-02 19:10:11.069927,epoch time: 0:30:52.279407,used: 3:37:33.920377,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_15_32_36_seed_1_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9774195, 'precision': 0.97759795, 'recall': 0.97742665, 'specificity': 0.97742665, 'f1': 0.9774176, 'auroc': 0.9967427, 'binary_precision': 0.98701435, 'binary_recall': 0.9676021, 'binary_specificity': 0.98725116, 'binary_f1_score': 0.9772118}
confusion matrix:
       0      1
0  28420    367
1    934  27895
---- Validation: 
scalar performance:
{'acc': 0.9585912, 'precision': 0.68848276, 'recall': 0.6487862, 'specificity': 0.6487862, 'f1': 0.66597205, 'auroc': 0.88459766, 'binary_precision': 0.40227705, 'binary_recall': 0.31500742, 'binary_specificity': 0.9825649, 'binary_f1_score': 0.35333332}
confusion matrix:
       0    1
0  17752  315
1    461  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97019017, 'precision': 0.8234839, 'recall': 0.7839938, 'specificity': 0.7839938, 'f1': 0.80230474, 'auroc': 0.92149794, 'binary_precision': 0.66519827, 'binary_recall': 0.58076924, 'binary_specificity': 0.9872183, 'binary_f1_score': 0.6201232}
confusion matrix:
      0    1
0  5870   76
1   109  151
early stop counter: 1
val acc:0.9585912227630615, best validation acc: 0.9619530439376831, corresponding to test acc:                         0.9711569547653198 / 0.9711569547653198
after epoch: 8,now: 2024-08-02 19:40:30.611919,epoch time: 0:30:19.541992,used: 4:07:53.462369,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_15_32_36_seed_1_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97896415, 'precision': 0.9791733, 'recall': 0.9789719, 'specificity': 0.9789719, 'f1': 0.9789621, 'auroc': 0.99712, 'binary_precision': 0.98936814, 'binary_recall': 0.9683652, 'binary_specificity': 0.9895786, 'binary_f1_score': 0.978754}
confusion matrix:
       0      1
0  28487    300
1    912  27917
---- Validation: 
scalar performance:
{'acc': 0.95490927, 'precision': 0.6469973, 'recall': 0.60682166, 'specificity': 0.60682166, 'f1': 0.6231997, 'auroc': 0.87804544, 'binary_precision': 0.32231405, 'binary_recall': 0.23179792, 'binary_specificity': 0.9818454, 'binary_f1_score': 0.26966292}
confusion matrix:
       0    1
0  17739  328
1    517  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9687399, 'precision': 0.818398, 'recall': 0.75933015, 'specificity': 0.75933015, 'f1': 0.78549445, 'auroc': 0.91939175, 'binary_precision': 0.6571429, 'binary_recall': 0.5307692, 'binary_specificity': 0.987891, 'binary_f1_score': 0.587234}
confusion matrix:
      0    1
0  5874   72
1   122  138
early stop counter: 2
val acc:0.9549092650413513, best validation acc: 0.9619530439376831, corresponding to test acc:                         0.9711569547653198 / 0.9711569547653198
after epoch: 9,now: 2024-08-02 20:11:17.729061,epoch time: 0:30:47.117142,used: 4:38:40.579511,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_15_32_36_seed_1_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97990143, 'precision': 0.9800304, 'recall': 0.9799072, 'specificity': 0.9799072, 'f1': 0.97990024, 'auroc': 0.99717903, 'binary_precision': 0.9880759, 'binary_recall': 0.9715554, 'binary_specificity': 0.988259, 'binary_f1_score': 0.979746}
confusion matrix:
       0      1
0  28450    338
1    820  28008
---- Validation: 
scalar performance:
{'acc': 0.95597655, 'precision': 0.6650125, 'recall': 0.63097894, 'specificity': 0.63097894, 'f1': 0.6457364, 'auroc': 0.8772875, 'binary_precision': 0.35660377, 'binary_recall': 0.28083208, 'binary_specificity': 0.98112583, 'binary_f1_score': 0.31421447}
confusion matrix:
       0    1
0  17726  341
1    484  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97147924, 'precision': 0.8305174, 'recall': 0.79753935, 'specificity': 0.79753935, 'f1': 0.8130617, 'auroc': 0.9245485, 'binary_precision': 0.6781116, 'binary_recall': 0.6076923, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.6409736}
confusion matrix:
      0    1
0  5871   75
1   102  158
new oracle model saved
early stop counter: 3
val acc:0.9559765458106995, best validation acc: 0.9619530439376831, corresponding to test acc:                         0.9711569547653198 / 0.9714792370796204
after epoch: 10,now: 2024-08-02 20:41:30.179609,epoch time: 0:30:12.450548,used: 5:08:53.030059,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_15_32_36_seed_1_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 5:08:53.030059 at 2024-08-02 20:41:30.179609
persisted model performance metric: 

scalar performance:
{'acc': 0.97115695, 'precision': 0.8547708, 'recall': 0.7422016, 'specificity': 0.7422016, 'f1': 0.78678024, 'auroc': 0.90664166, 'binary_precision': 0.73142856, 'binary_recall': 0.4923077, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.58850574}
confusion matrix:
      0    1
0  5899   47
1   132  128
oracle model performance metric: 

scalar performance:
{'acc': 0.97147924, 'precision': 0.8305174, 'recall': 0.79753935, 'specificity': 0.79753935, 'f1': 0.8130617, 'auroc': 0.9245485, 'binary_precision': 0.6781116, 'binary_recall': 0.6076923, 'binary_specificity': 0.98738647, 'binary_f1_score': 0.6409736}
confusion matrix:
      0    1
0  5871   75
1   102  158
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_halffreeze_2024-08-02_12-56-38/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_halffreeze_2024-08-02_12-56-38/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196700 KiB |   2142 MiB | 740565 GiB | 740565 GiB |
|       from large pool | 179211 KiB |   2124 MiB | 731635 GiB | 731635 GiB |
|       from small pool |  17489 KiB |     37 MiB |   8930 GiB |   8930 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 196700 KiB |   2142 MiB | 740565 GiB | 740565 GiB |
|       from large pool | 179211 KiB |   2124 MiB | 731635 GiB | 731635 GiB |
|       from small pool |  17489 KiB |     37 MiB |   8930 GiB |   8930 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   2141 MiB | 740474 GiB | 740473 GiB |
|       from large pool | 178979 KiB |   2123 MiB | 731557 GiB | 731557 GiB |
|       from small pool |  16480 KiB |     36 MiB |   8916 GiB |   8916 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2354 MiB |   2372 MiB |   4478 MiB |   2124 MiB |
|       from large pool |   2316 MiB |   2330 MiB |   4420 MiB |   2104 MiB |
|       from small pool |     38 MiB |     42 MiB |     58 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38820 KiB | 232750 KiB | 406281 GiB | 406281 GiB |
|       from large pool |  31733 KiB | 230336 KiB | 397303 GiB | 397303 GiB |
|       from small pool |   7087 KiB |  17126 KiB |   8977 GiB |   8977 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2974    |    7697    |  111529 K  |  111526 K  |
|       from large pool |      79    |     252    |   67319 K  |   67319 K  |
|       from small pool |    2895    |    7617    |   44210 K  |   44207 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2974    |    7697    |  111529 K  |  111526 K  |
|       from large pool |      79    |     252    |   67319 K  |   67319 K  |
|       from small pool |    2895    |    7617    |   44210 K  |   44207 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     118    |     211    |      96    |
|       from large pool |      96    |      97    |     182    |      86    |
|       from small pool |      19    |      21    |      29    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    3619    |   70747 K  |   70747 K  |
|       from large pool |      11    |     100    |   51114 K  |   51114 K  |
|       from small pool |      29    |    3608    |   19632 K  |   19632 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 740565 GiB | 740565 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 731635 GiB | 731635 GiB |
|       from small pool |      0 KiB |     37 MiB |   8930 GiB |   8930 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 740565 GiB | 740565 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 731635 GiB | 731635 GiB |
|       from small pool |      0 KiB |     37 MiB |   8930 GiB |   8930 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 740474 GiB | 740474 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 731557 GiB | 731557 GiB |
|       from small pool |      0 KiB |     36 MiB |   8916 GiB |   8916 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   2372 MiB |   4478 MiB |   4248 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   4420 MiB |   4214 MiB |
|       from small pool |  24576 KiB |     42 MiB |     58 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 232750 KiB | 406281 GiB | 406281 GiB |
|       from large pool |  30464 KiB | 230336 KiB | 397303 GiB | 397303 GiB |
|       from small pool |      0 KiB |  19186 KiB |   8977 GiB |   8977 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  111529 K  |  111529 K  |
|       from large pool |       2    |     252    |   67319 K  |   67319 K  |
|       from small pool |       0    |    7617    |   44210 K  |   44210 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  111529 K  |  111529 K  |
|       from large pool |       2    |     252    |   67319 K  |   67319 K  |
|       from small pool |       0    |    7617    |   44210 K  |   44210 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     118    |     211    |     189    |
|       from large pool |      10    |      97    |     182    |     172    |
|       from small pool |      12    |      21    |      29    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3619    |   70748 K  |   70748 K  |
|       from large pool |       3    |     100    |   51114 K  |   51114 K  |
|       from small pool |       0    |    3608    |   19633 K  |   19633 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB | 740565 GiB | 740565 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 731635 GiB | 731635 GiB |
|       from small pool |      0 KiB |     37 MiB |   8930 GiB |   8930 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB | 740565 GiB | 740565 GiB |
|       from large pool |  16640 KiB |   2124 MiB | 731635 GiB | 731635 GiB |
|       from small pool |      0 KiB |     37 MiB |   8930 GiB |   8930 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB | 740474 GiB | 740474 GiB |
|       from large pool |  16640 KiB |   2123 MiB | 731557 GiB | 731557 GiB |
|       from small pool |      0 KiB |     36 MiB |   8916 GiB |   8916 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   2372 MiB |   4478 MiB |   4248 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   4420 MiB |   4214 MiB |
|       from small pool |  24576 KiB |     42 MiB |     58 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 232750 KiB | 406281 GiB | 406281 GiB |
|       from large pool |  30464 KiB | 230336 KiB | 397303 GiB | 397303 GiB |
|       from small pool |      0 KiB |  19186 KiB |   8977 GiB |   8977 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  111529 K  |  111529 K  |
|       from large pool |       2    |     252    |   67319 K  |   67319 K  |
|       from small pool |       0    |    7617    |   44210 K  |   44210 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  111529 K  |  111529 K  |
|       from large pool |       2    |     252    |   67319 K  |   67319 K  |
|       from small pool |       0    |    7617    |   44210 K  |   44210 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     118    |     211    |     189    |
|       from large pool |      10    |      97    |     182    |     172    |
|       from small pool |      12    |      21    |      29    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3619    |   70748 K  |   70748 K  |
|       from large pool |       3    |     100    |   51114 K  |   51114 K  |
|       from small pool |       0    |    3608    |   19633 K  |   19633 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_20_51_20_seed_2_24046582

 Experiment start at: 2024-08-02 20:51:20.929717
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.10803013294935226
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91990256, 'precision': 0.92702115, 'recall': 0.91991365, 'specificity': 0.91991365, 'f1': 0.9195688, 'auroc': 0.9576733, 'binary_precision': 0.9821984, 'binary_recall': 0.85533494, 'binary_specificity': 0.9844924, 'binary_f1_score': 0.91438735}
confusion matrix:
       0      1
0  28695    452
1   4218  24939
---- Validation: 
scalar performance:
{'acc': 0.96494967, 'precision': 0.55470645, 'recall': 0.5072926, 'specificity': 0.5072926, 'f1': 0.5072523, 'auroc': 0.558347, 'binary_precision': 0.14102565, 'binary_recall': 0.018272426, 'binary_specificity': 0.9963128, 'binary_f1_score': 0.03235294}
confusion matrix:
       0   1
0  18104  67
1    591  11
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9548004, 'precision': 0.4924599, 'recall': 0.49864772, 'specificity': 0.49864772, 'f1': 0.49195805, 'auroc': 0.55383205, 'binary_precision': 0.023809524, 'binary_recall': 0.004132231, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.007042253}
confusion matrix:
      0   1
0  5956  41
1   241   1
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 21:23:28.888552,epoch time: 0:32:07.958835,used: 0:32:07.958835,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_20_51_20_seed_2_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9409475, 'precision': 0.9444252, 'recall': 0.94095504, 'specificity': 0.94095504, 'f1': 0.9408324, 'auroc': 0.9762131, 'binary_precision': 0.98378235, 'binary_recall': 0.89669716, 'binary_specificity': 0.98521286, 'binary_f1_score': 0.93822324}
confusion matrix:
       0      1
0  28716    431
1   3012  26145
---- Validation: 
scalar performance:
{'acc': 0.964417, 'precision': 0.66085136, 'recall': 0.56001866, 'specificity': 0.56001866, 'f1': 0.58457905, 'auroc': 0.7042538, 'binary_precision': 0.35, 'binary_recall': 0.12790698, 'binary_specificity': 0.99213034, 'binary_f1_score': 0.18734793}
confusion matrix:
       0    1
0  18028  143
1    525   77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9549607, 'precision': 0.5903002, 'recall': 0.5264895, 'specificity': 0.5264895, 'f1': 0.5366839, 'auroc': 0.71550167, 'binary_precision': 0.2173913, 'binary_recall': 0.06198347, 'binary_specificity': 0.9909955, 'binary_f1_score': 0.09646302}
confusion matrix:
      0   1
0  5943  54
1   227  15
new oracle model saved
early stop counter: 1
val acc:0.9644169807434082, best validation acc: 0.9649496674537659, corresponding to test acc:                         0.9548004269599915 / 0.9549607038497925
after epoch: 2,now: 2024-08-02 21:55:03.073132,epoch time: 0:31:34.184580,used: 1:03:42.143415,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_20_51_20_seed_2_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95180434, 'precision': 0.9543916, 'recall': 0.95181084, 'specificity': 0.95181084, 'f1': 0.9517361, 'auroc': 0.98286384, 'binary_precision': 0.98872197, 'binary_recall': 0.91405153, 'binary_specificity': 0.9895701, 'binary_f1_score': 0.9499216}
confusion matrix:
       0      1
0  28843    304
1   2506  26651
---- Validation: 
scalar performance:
{'acc': 0.9634049, 'precision': 0.62854505, 'recall': 0.54343486, 'specificity': 0.54343486, 'f1': 0.5618128, 'auroc': 0.73961186, 'binary_precision': 0.28643215, 'binary_recall': 0.094684385, 'binary_specificity': 0.99218535, 'binary_f1_score': 0.1423221}
confusion matrix:
       0    1
0  18029  142
1    545   57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9567238, 'precision': 0.651296, 'recall': 0.555165, 'specificity': 0.555165, 'f1': 0.5773035, 'auroc': 0.799852, 'binary_precision': 0.3372093, 'binary_recall': 0.11983471, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.17682928}
confusion matrix:
      0   1
0  5940  57
1   213  29
new oracle model saved
early stop counter: 2
val acc:0.9634048938751221, best validation acc: 0.9649496674537659, corresponding to test acc:                         0.9548004269599915 / 0.9567238092422485
after epoch: 3,now: 2024-08-02 22:27:25.280999,epoch time: 0:32:22.207867,used: 1:36:04.351282,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_20_51_20_seed_2_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96134055, 'precision': 0.96229017, 'recall': 0.96134526, 'specificity': 0.96134526, 'f1': 0.961321, 'auroc': 0.9879029, 'binary_precision': 0.98329383, 'binary_recall': 0.93864465, 'binary_specificity': 0.98404586, 'binary_f1_score': 0.96045065}
confusion matrix:
       0      1
0  28681    465
1   1789  27369
---- Validation: 
scalar performance:
{'acc': 0.96036863, 'precision': 0.6272809, 'recall': 0.5699731, 'specificity': 0.5699731, 'f1': 0.588979, 'auroc': 0.7792609, 'binary_precision': 0.2822086, 'binary_recall': 0.15282393, 'binary_specificity': 0.98712236, 'binary_f1_score': 0.19827588}
confusion matrix:
       0    1
0  17937  234
1    510   92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9501523, 'precision': 0.6447222, 'recall': 0.6151943, 'specificity': 0.6151943, 'f1': 0.62796766, 'auroc': 0.82951325, 'binary_precision': 0.31937173, 'binary_recall': 0.2520661, 'binary_specificity': 0.9783225, 'binary_f1_score': 0.28175518}
confusion matrix:
      0    1
0  5867  130
1   181   61
early stop counter: 3
val acc:0.9603686332702637, best validation acc: 0.9649496674537659, corresponding to test acc:                         0.9548004269599915 / 0.9567238092422485
after epoch: 4,now: 2024-08-02 22:58:24.723211,epoch time: 0:30:59.442212,used: 2:07:03.793494,model: dset_te_center0_dann_b8efecac6_not_commited_2024md_08md_02_20_51_20_seed_2_24046582
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 4 with time: 2:07:03.793494 at 2024-08-02 22:58:24.723211
persisted model performance metric: 

scalar performance:
{'acc': 0.9548004, 'precision': 0.4924599, 'recall': 0.49864772, 'specificity': 0.49864772, 'f1': 0.49195805, 'auroc': 0.55383205, 'binary_precision': 0.023809524, 'binary_recall': 0.004132231, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.007042253}
confusion matrix:
      0   1
0  5956  41
1   241   1
oracle model performance metric: 

scalar performance:
{'acc': 0.9567238, 'precision': 0.651296, 'recall': 0.555165, 'specificity': 0.555165, 'f1': 0.5773035, 'auroc': 0.799852, 'binary_precision': 0.3372093, 'binary_recall': 0.11983471, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.17682928}
confusion matrix:
      0   1
0  5940  57
1   213  29
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_halffreeze_2024-08-02_12-56-38/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_dannratio_10seeds_halffreeze_2024-08-02_12-56-38/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196706 KiB |   2142 MiB |    933 TiB |    933 TiB |
|       from large pool | 179211 KiB |   2124 MiB |    922 TiB |    922 TiB |
|       from small pool |  17495 KiB |     37 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196706 KiB |   2142 MiB |    933 TiB |    933 TiB |
|       from large pool | 179211 KiB |   2124 MiB |    922 TiB |    922 TiB |
|       from small pool |  17495 KiB |     37 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   2141 MiB |    933 TiB |    933 TiB |
|       from large pool | 178979 KiB |   2123 MiB |    922 TiB |    922 TiB |
|       from small pool |  16482 KiB |     36 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2354 MiB |   2372 MiB |   6602 MiB |   4248 MiB |
|       from large pool |   2316 MiB |   2330 MiB |   6530 MiB |   4214 MiB |
|       from small pool |     38 MiB |     42 MiB |     72 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  36766 KiB | 232750 KiB | 525507 GiB | 525507 GiB |
|       from large pool |  31733 KiB | 230336 KiB | 513899 GiB | 513899 GiB |
|       from small pool |   5033 KiB |  19186 KiB |  11607 GiB |  11607 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2986    |    7783    |  144036 K  |  144033 K  |
|       from large pool |      79    |     252    |   86905 K  |   86905 K  |
|       from small pool |    2907    |    7703    |   57130 K  |   57127 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2986    |    7783    |  144036 K  |  144033 K  |
|       from large pool |      79    |     252    |   86905 K  |   86905 K  |
|       from small pool |    2907    |    7703    |   57130 K  |   57127 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     118    |     304    |     189    |
|       from large pool |      96    |      97    |     268    |     172    |
|       from small pool |      19    |      21    |      36    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    3660    |   91401 K  |   91401 K  |
|       from large pool |      11    |     100    |   65839 K  |   65839 K  |
|       from small pool |      29    |    3649    |   25561 K  |   25561 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2142 MiB |    933 TiB |    933 TiB |
|       from large pool |  16640 KiB |   2124 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     37 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2142 MiB |    933 TiB |    933 TiB |
|       from large pool |  16640 KiB |   2124 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     37 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2141 MiB |    933 TiB |    933 TiB |
|       from large pool |  16640 KiB |   2123 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     36 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 233472 KiB |   2372 MiB |   6602 MiB |   6374 MiB |
|       from large pool | 210944 KiB |   2330 MiB |   6530 MiB |   6324 MiB |
|       from small pool |  22528 KiB |     42 MiB |     72 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 232750 KiB | 525507 GiB | 525507 GiB |
|       from large pool |  30464 KiB | 230336 KiB | 513899 GiB | 513899 GiB |
|       from small pool |      0 KiB |  19390 KiB |  11607 GiB |  11607 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7783    |  144036 K  |  144036 K  |
|       from large pool |       2    |     252    |   86905 K  |   86905 K  |
|       from small pool |       0    |    7703    |   57130 K  |   57130 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7783    |  144036 K  |  144036 K  |
|       from large pool |       2    |     252    |   86905 K  |   86905 K  |
|       from small pool |       0    |    7703    |   57130 K  |   57130 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     118    |     304    |     283    |
|       from large pool |      10    |      97    |     268    |     258    |
|       from small pool |      11    |      21    |      36    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3660    |   91402 K  |   91402 K  |
|       from large pool |       3    |     100    |   65839 K  |   65839 K  |
|       from small pool |       0    |    3649    |   25562 K  |   25562 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Aug  2 22:59:48 2024]
Finished job 0.
1 of 1 steps (100%) done
