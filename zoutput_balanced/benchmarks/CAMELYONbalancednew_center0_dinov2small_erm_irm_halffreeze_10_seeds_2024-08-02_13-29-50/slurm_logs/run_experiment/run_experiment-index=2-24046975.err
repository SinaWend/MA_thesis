Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  2 13:32:02 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975

 Experiment start at: 2024-08-02 13:40:40.783880
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8560844, 'precision': 0.86300766, 'recall': 0.8561325, 'specificity': 0.8561325, 'f1': 0.85540664, 'auroc': 0.91025615, 'binary_precision': 0.9133142, 'binary_recall': 0.7870732, 'binary_specificity': 0.9251919, 'binary_f1_score': 0.84550744}
confusion matrix:
       0      1
0  26516   2144
1   6111  22589
---- Validation: 
scalar performance:
{'acc': 0.8946892, 'precision': 0.5323038, 'recall': 0.577952, 'specificity': 0.577952, 'f1': 0.5389265, 'auroc': 0.74062276, 'binary_precision': 0.09317905, 'binary_recall': 0.23794712, 'binary_specificity': 0.9179569, 'binary_f1_score': 0.13391685}
confusion matrix:
       0     1
0  16660  1489
1    490   153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89613295, 'precision': 0.5479295, 'recall': 0.5921658, 'specificity': 0.5921658, 'f1': 0.55880725, 'auroc': 0.7591822, 'binary_precision': 0.12952381, 'binary_recall': 0.2605364, 'binary_specificity': 0.9237952, 'binary_f1_score': 0.17302799}
confusion matrix:
      0    1
0  5540  457
1   193   68
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 14:04:09.625464,epoch time: 0:23:28.841584,used: 0:23:28.841584,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.89531034, 'precision': 0.90211284, 'recall': 0.8953625, 'specificity': 0.8953625, 'f1': 0.8948746, 'auroc': 0.952307, 'binary_precision': 0.95461464, 'binary_recall': 0.83026165, 'binary_specificity': 0.9604634, 'binary_f1_score': 0.8881063}
confusion matrix:
       0      1
0  27524   1133
1   4872  23831
---- Validation: 
scalar performance:
{'acc': 0.88223714, 'precision': 0.54411167, 'recall': 0.6285096, 'specificity': 0.6285096, 'f1': 0.5540426, 'auroc': 0.78258705, 'binary_precision': 0.11291913, 'binary_recall': 0.3561431, 'binary_specificity': 0.9008761, 'binary_f1_score': 0.17147136}
confusion matrix:
       0     1
0  16350  1799
1    414   229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89133906, 'precision': 0.57382375, 'recall': 0.67028725, 'specificity': 0.67028725, 'f1': 0.5946138, 'auroc': 0.8254012, 'binary_precision': 0.17418352, 'binary_recall': 0.42911878, 'binary_specificity': 0.91145575, 'binary_f1_score': 0.24778761}
confusion matrix:
      0    1
0  5466  531
1   149  112
early stop counter: 1
val acc:0.8822371363639832, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.8961329460144043
after epoch: 2,now: 2024-08-02 14:23:49.684355,epoch time: 0:19:40.058891,used: 0:43:08.900475,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.912901, 'precision': 0.9189375, 'recall': 0.9129492, 'specificity': 0.9129492, 'f1': 0.91259277, 'auroc': 0.9676685, 'binary_precision': 0.96942693, 'binary_recall': 0.8528377, 'binary_specificity': 0.97306067, 'binary_f1_score': 0.9074026}
confusion matrix:
       0      1
0  27885    772
1   4224  24479
---- Validation: 
scalar performance:
{'acc': 0.8889421, 'precision': 0.55779296, 'recall': 0.66573334, 'specificity': 0.66573334, 'f1': 0.574127, 'auroc': 0.8150747, 'binary_precision': 0.1375502, 'binary_recall': 0.42612752, 'binary_specificity': 0.9053391, 'binary_f1_score': 0.20796965}
confusion matrix:
       0     1
0  16431  1718
1    369   274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8994886, 'precision': 0.602347, 'recall': 0.74416804, 'specificity': 0.74416804, 'f1': 0.63432145, 'auroc': 0.86443925, 'binary_precision': 0.2245509, 'binary_recall': 0.57471263, 'binary_specificity': 0.91362345, 'binary_f1_score': 0.32292786}
confusion matrix:
      0    1
0  5479  518
1   111  150
new oracle model saved
early stop counter: 2
val acc:0.8889421224594116, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 3,now: 2024-08-02 14:43:26.586343,epoch time: 0:19:36.901988,used: 1:02:45.802463,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9232915, 'precision': 0.92766917, 'recall': 0.92332685, 'specificity': 0.92332685, 'f1': 0.923099, 'auroc': 0.9752586, 'binary_precision': 0.97111285, 'binary_recall': 0.87264806, 'binary_specificity': 0.9740056, 'binary_f1_score': 0.9192512}
confusion matrix:
       0      1
0  27915    745
1   3655  25045
---- Validation: 
scalar performance:
{'acc': 0.8799489, 'precision': 0.56908816, 'recall': 0.7278323, 'specificity': 0.7278323, 'f1': 0.5891311, 'auroc': 0.84093904, 'binary_precision': 0.15519452, 'binary_recall': 0.5645412, 'binary_specificity': 0.8911235, 'binary_f1_score': 0.24346074}
confusion matrix:
       0     1
0  16173  1976
1    280   363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8830297, 'precision': 0.60465187, 'recall': 0.8070414, 'specificity': 0.8070414, 'f1': 0.63818187, 'auroc': 0.88644326, 'binary_precision': 0.22261484, 'binary_recall': 0.7241379, 'binary_specificity': 0.889945, 'binary_f1_score': 0.34054056}
confusion matrix:
      0    1
0  5337  660
1    72  189
early stop counter: 3
val acc:0.8799489140510559, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 4,now: 2024-08-02 15:01:48.538436,epoch time: 0:18:21.952093,used: 1:21:07.754556,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9308403, 'precision': 0.9349163, 'recall': 0.9308741, 'specificity': 0.9308741, 'f1': 0.9306816, 'auroc': 0.97916824, 'binary_precision': 0.97719467, 'binary_recall': 0.88236934, 'binary_specificity': 0.97937894, 'binary_f1_score': 0.9273643}
confusion matrix:
       0      1
0  28069    591
1   3376  25324
---- Validation: 
scalar performance:
{'acc': 0.8886228, 'precision': 0.57839733, 'recall': 0.74657404, 'specificity': 0.74657404, 'f1': 0.6035716, 'auroc': 0.8580553, 'binary_precision': 0.17253838, 'binary_recall': 0.5940902, 'binary_specificity': 0.8990578, 'binary_f1_score': 0.26741335}
confusion matrix:
       0     1
0  16317  1832
1    261   382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8847875, 'precision': 0.6118272, 'recall': 0.83361125, 'specificity': 0.83361125, 'f1': 0.6484709, 'auroc': 0.9002739, 'binary_precision': 0.23441109, 'binary_recall': 0.7777778, 'binary_specificity': 0.8894447, 'binary_f1_score': 0.36024845}
confusion matrix:
      0    1
0  5334  663
1    58  203
early stop counter: 4
val acc:0.8886228203773499, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 5,now: 2024-08-02 15:20:36.653322,epoch time: 0:18:48.114886,used: 1:39:55.869442,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93891215, 'precision': 0.94114697, 'recall': 0.93893707, 'specificity': 0.93893707, 'f1': 0.93883705, 'auroc': 0.9823897, 'binary_precision': 0.97272044, 'binary_recall': 0.90324044, 'binary_specificity': 0.97463363, 'binary_f1_score': 0.9366938}
confusion matrix:
       0      1
0  27933    727
1   2777  25923
---- Validation: 
scalar performance:
{'acc': 0.8853235, 'precision': 0.5816694, 'recall': 0.76961774, 'specificity': 0.76961774, 'f1': 0.60788596, 'auroc': 0.8704517, 'binary_precision': 0.17719898, 'binary_recall': 0.64541215, 'binary_specificity': 0.8938233, 'binary_f1_score': 0.27805698}
confusion matrix:
       0     1
0  16222  1927
1    228   415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87599874, 'precision': 0.60712165, 'recall': 0.84001964, 'specificity': 0.84001964, 'f1': 0.6407723, 'auroc': 0.90844905, 'binary_precision': 0.22400858, 'binary_recall': 0.8007663, 'binary_specificity': 0.879273, 'binary_f1_score': 0.35008374}
confusion matrix:
      0    1
0  5273  724
1    52  209
early stop counter: 5
val acc:0.8853235244750977, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 6,now: 2024-08-02 15:39:00.521774,epoch time: 0:18:23.868452,used: 1:58:19.737894,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9420851, 'precision': 0.943536, 'recall': 0.9421071, 'specificity': 0.9421071, 'f1': 0.9420396, 'auroc': 0.9840425, 'binary_precision': 0.96909654, 'binary_recall': 0.9133858, 'binary_specificity': 0.9708284, 'binary_f1_score': 0.9404168}
confusion matrix:
       0      1
0  27822    836
1   2486  26216
---- Validation: 
scalar performance:
{'acc': 0.87521285, 'precision': 0.5797299, 'recall': 0.78688496, 'specificity': 0.78688496, 'f1': 0.60342306, 'auroc': 0.87422204, 'binary_precision': 0.1716821, 'binary_recall': 0.69206846, 'binary_specificity': 0.88170147, 'binary_f1_score': 0.27511594}
confusion matrix:
       0     1
0  16002  2147
1    198   445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8630553, 'precision': 0.6000023, 'recall': 0.84242797, 'specificity': 0.84242797, 'f1': 0.62838364, 'auroc': 0.9125358, 'binary_precision': 0.20898438, 'binary_recall': 0.8199234, 'binary_specificity': 0.8649325, 'binary_f1_score': 0.33307394}
confusion matrix:
      0    1
0  5187  810
1    47  214
early stop counter: 6
val acc:0.8752128481864929, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 7,now: 2024-08-02 15:57:13.415117,epoch time: 0:18:12.893343,used: 2:16:32.631237,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94443864, 'precision': 0.94650877, 'recall': 0.944466, 'specificity': 0.944466, 'f1': 0.94437647, 'auroc': 0.98584867, 'binary_precision': 0.97711295, 'binary_recall': 0.9102881, 'binary_specificity': 0.97864395, 'binary_f1_score': 0.9425175}
confusion matrix:
       0      1
0  28045    612
1   2575  26128
---- Validation: 
scalar performance:
{'acc': 0.8879843, 'precision': 0.5852977, 'recall': 0.7784958, 'specificity': 0.7784958, 'f1': 0.61343044, 'auroc': 0.87695843, 'binary_precision': 0.18382353, 'binary_recall': 0.66096425, 'binary_specificity': 0.8960273, 'binary_f1_score': 0.28764805}
confusion matrix:
       0     1
0  16262  1887
1    218   425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8774369, 'precision': 0.6109092, 'recall': 0.8535963, 'specificity': 0.8535963, 'f1': 0.646263, 'auroc': 0.91576755, 'binary_precision': 0.23027718, 'binary_recall': 0.82758623, 'binary_specificity': 0.8796065, 'binary_f1_score': 0.36030024}
confusion matrix:
      0    1
0  5275  722
1    45  216
early stop counter: 7
val acc:0.8879842758178711, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 8,now: 2024-08-02 16:15:39.951133,epoch time: 0:18:26.536016,used: 2:34:59.167253,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9463389, 'precision': 0.9479226, 'recall': 0.9463639, 'specificity': 0.9463639, 'f1': 0.9462935, 'auroc': 0.9858644, 'binary_precision': 0.97476655, 'binary_recall': 0.91649246, 'binary_specificity': 0.97623533, 'binary_f1_score': 0.9447318}
confusion matrix:
       0      1
0  27975    681
1   2397  26307
---- Validation: 
scalar performance:
{'acc': 0.87414855, 'precision': 0.58123595, 'recall': 0.7968347, 'specificity': 0.7968347, 'f1': 0.6053369, 'auroc': 0.8812202, 'binary_precision': 0.17386363, 'binary_recall': 0.7138414, 'binary_specificity': 0.8798281, 'binary_f1_score': 0.2796223}
confusion matrix:
       0     1
0  15968  2181
1    184   459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8553851, 'precision': 0.59677374, 'recall': 0.8457553, 'specificity': 0.8457553, 'f1': 0.62207305, 'auroc': 0.9196731, 'binary_precision': 0.20185184, 'binary_recall': 0.83524907, 'binary_specificity': 0.8562615, 'binary_f1_score': 0.3251305}
confusion matrix:
      0    1
0  5135  862
1    43  218
early stop counter: 8
val acc:0.8741485476493835, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 9,now: 2024-08-02 16:33:51.355255,epoch time: 0:18:11.404122,used: 2:53:10.571375,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95116806, 'precision': 0.95247674, 'recall': 0.9511945, 'specificity': 0.9511945, 'f1': 0.9511347, 'auroc': 0.9884751, 'binary_precision': 0.97705597, 'binary_recall': 0.92413265, 'binary_specificity': 0.97825634, 'binary_f1_score': 0.9498577}
confusion matrix:
       0      1
0  28029    623
1   2178  26530
---- Validation: 
scalar performance:
{'acc': 0.880215, 'precision': 0.5826774, 'recall': 0.7879745, 'specificity': 0.7879745, 'f1': 0.6085443, 'auroc': 0.88013256, 'binary_precision': 0.1776263, 'binary_recall': 0.688958, 'binary_specificity': 0.886991, 'binary_f1_score': 0.28243542}
confusion matrix:
       0     1
0  16098  2051
1    200   443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8644934, 'precision': 0.6020675, 'recall': 0.84867525, 'specificity': 0.84867525, 'f1': 0.6315242, 'auroc': 0.92174697, 'binary_precision': 0.21253672, 'binary_recall': 0.8314176, 'binary_specificity': 0.86593294, 'binary_f1_score': 0.33853352}
confusion matrix:
      0    1
0  5193  804
1    44  217
early stop counter: 9
val acc:0.8802149891853333, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 10,now: 2024-08-02 16:52:04.649499,epoch time: 0:18:13.294244,used: 3:11:23.865619,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95346934, 'precision': 0.95435894, 'recall': 0.9534864, 'specificity': 0.9534864, 'f1': 0.9534477, 'auroc': 0.9888809, 'binary_precision': 0.9746563, 'binary_recall': 0.9312243, 'binary_specificity': 0.9757485, 'binary_f1_score': 0.9524454}
confusion matrix:
       0      1
0  27963    695
1   1974  26728
---- Validation: 
scalar performance:
{'acc': 0.87106216, 'precision': 0.58146644, 'recall': 0.8057376, 'specificity': 0.8057376, 'f1': 0.6049893, 'auroc': 0.88436425, 'binary_precision': 0.1735143, 'binary_recall': 0.7356143, 'binary_specificity': 0.8758609, 'binary_f1_score': 0.28079548}
confusion matrix:
       0     1
0  15896  2253
1    170   473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84611696, 'precision': 0.5923152, 'recall': 0.84458417, 'specificity': 0.84458417, 'f1': 0.6134792, 'auroc': 0.9230746, 'binary_precision': 0.19264448, 'binary_recall': 0.8429119, 'binary_specificity': 0.84625643, 'binary_f1_score': 0.31361368}
confusion matrix:
      0    1
0  5075  922
1    41  220
early stop counter: 10
val acc:0.871062159538269, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 11,now: 2024-08-02 17:10:24.531470,epoch time: 0:18:19.881971,used: 3:29:43.747590,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95631105, 'precision': 0.95681167, 'recall': 0.95632446, 'specificity': 0.95632446, 'f1': 0.9562999, 'auroc': 0.9903239, 'binary_precision': 0.9721371, 'binary_recall': 0.93962306, 'binary_specificity': 0.9730258, 'binary_f1_score': 0.9556036}
confusion matrix:
       0      1
0  27884    773
1   1733  26970
---- Validation: 
scalar performance:
{'acc': 0.85265005, 'precision': 0.57300925, 'recall': 0.80370593, 'specificity': 0.80370593, 'f1': 0.588415, 'auroc': 0.88308513, 'binary_precision': 0.15620957, 'binary_recall': 0.7511664, 'binary_specificity': 0.8562455, 'binary_f1_score': 0.25863454}
confusion matrix:
       0     1
0  15540  2609
1    160   483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82214767, 'precision': 0.58207077, 'recall': 0.8375749, 'specificity': 0.8375749, 'f1': 0.59225094, 'auroc': 0.9235486, 'binary_precision': 0.17180277, 'binary_recall': 0.8544061, 'binary_specificity': 0.8207437, 'binary_f1_score': 0.28608084}
confusion matrix:
      0     1
0  4922  1075
1    38   223
early stop counter: 11
val acc:0.8526500463485718, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 12,now: 2024-08-02 17:28:37.201409,epoch time: 0:18:12.669939,used: 3:47:56.417529,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95657253, 'precision': 0.95719635, 'recall': 0.9565861, 'specificity': 0.9565861, 'f1': 0.9565586, 'auroc': 0.98987114, 'binary_precision': 0.974269, 'binary_recall': 0.93798125, 'binary_specificity': 0.97519106, 'binary_f1_score': 0.95578074}
confusion matrix:
       0      1
0  27948    711
1   1780  26921
---- Validation: 
scalar performance:
{'acc': 0.8575458, 'precision': 0.57398677, 'recall': 0.79873997, 'specificity': 0.79873997, 'f1': 0.59114194, 'auroc': 0.8828527, 'binary_precision': 0.15872483, 'binary_recall': 0.7356143, 'binary_specificity': 0.86186564, 'binary_f1_score': 0.26110956}
confusion matrix:
       0     1
0  15642  2507
1    170   473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8269415, 'precision': 0.58448005, 'recall': 0.8419085, 'specificity': 0.8419085, 'f1': 0.59701514, 'auroc': 0.92391026, 'binary_precision': 0.17637795, 'binary_recall': 0.85823756, 'binary_specificity': 0.82557946, 'binary_f1_score': 0.29261923}
confusion matrix:
      0     1
0  4951  1046
1    37   224
early stop counter: 12
val acc:0.857545793056488, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 13,now: 2024-08-02 17:46:48.957322,epoch time: 0:18:11.755913,used: 4:06:08.173442,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95850766, 'precision': 0.9591912, 'recall': 0.95852464, 'specificity': 0.95852464, 'f1': 0.9584933, 'auroc': 0.9909699, 'binary_precision': 0.9771269, 'binary_recall': 0.93906987, 'binary_specificity': 0.9779794, 'binary_f1_score': 0.95772046}
confusion matrix:
       0      1
0  28024    631
1   1749  26956
---- Validation: 
scalar performance:
{'acc': 0.8524372, 'precision': 0.5719075, 'recall': 0.7983453, 'specificity': 0.7983453, 'f1': 0.586836, 'auroc': 0.88090074, 'binary_precision': 0.15444517, 'binary_recall': 0.7402799, 'binary_specificity': 0.8564108, 'binary_f1_score': 0.25557047}
confusion matrix:
       0     1
0  15543  2606
1    167   476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.817194, 'precision': 0.5807413, 'recall': 0.838655, 'specificity': 0.838655, 'f1': 0.58878297, 'auroc': 0.92450887, 'binary_precision': 0.1687922, 'binary_recall': 0.86206895, 'binary_specificity': 0.815241, 'binary_f1_score': 0.28230867}
confusion matrix:
      0     1
0  4889  1108
1    36   225
early stop counter: 13
val acc:0.8524371981620789, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 14,now: 2024-08-02 18:05:03.643964,epoch time: 0:18:14.686642,used: 4:24:22.860084,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9605823, 'precision': 0.9610291, 'recall': 0.96059436, 'specificity': 0.96059436, 'f1': 0.96057343, 'auroc': 0.9921831, 'binary_precision': 0.9755747, 'binary_recall': 0.9448819, 'binary_specificity': 0.9763068, 'binary_f1_score': 0.959983}
confusion matrix:
       0      1
0  27979    679
1   1582  27120
---- Validation: 
scalar performance:
{'acc': 0.84626436, 'precision': 0.56948984, 'recall': 0.79739976, 'specificity': 0.79739976, 'f1': 0.5816961, 'auroc': 0.8774952, 'binary_precision': 0.14950062, 'binary_recall': 0.7449456, 'binary_specificity': 0.849854, 'binary_f1_score': 0.24902521}
confusion matrix:
       0     1
0  15424  2725
1    164   479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.809364, 'precision': 0.578401, 'recall': 0.83823425, 'specificity': 0.83823425, 'f1': 0.5829455, 'auroc': 0.9262652, 'binary_precision': 0.16378066, 'binary_recall': 0.8697318, 'binary_specificity': 0.8067367, 'binary_f1_score': 0.2756527}
confusion matrix:
      0     1
0  4838  1159
1    34   227
early stop counter: 14
val acc:0.8462643623352051, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 15,now: 2024-08-02 18:23:28.335954,epoch time: 0:18:24.691990,used: 4:42:47.552074,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9607566, 'precision': 0.9612556, 'recall': 0.96076876, 'specificity': 0.96076876, 'f1': 0.96074677, 'auroc': 0.9923217, 'binary_precision': 0.9766109, 'binary_recall': 0.9441831, 'binary_specificity': 0.9773544, 'binary_f1_score': 0.9601233}
confusion matrix:
       0      1
0  28010    649
1   1602  27099
---- Validation: 
scalar performance:
{'acc': 0.85594934, 'precision': 0.5730406, 'recall': 0.7971634, 'specificity': 0.7971634, 'f1': 0.5893922, 'auroc': 0.8804896, 'binary_precision': 0.15691489, 'binary_recall': 0.7340591, 'binary_specificity': 0.86026776, 'binary_f1_score': 0.2585593}
confusion matrix:
       0     1
0  15613  2536
1    171   472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8203899, 'precision': 0.5823912, 'recall': 0.8421548, 'specificity': 0.8421548, 'f1': 0.5920299, 'auroc': 0.92628115, 'binary_precision': 0.17186312, 'binary_recall': 0.8659004, 'binary_specificity': 0.8184092, 'binary_f1_score': 0.28680205}
confusion matrix:
      0     1
0  4908  1089
1    35   226
early stop counter: 15
val acc:0.855949342250824, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 16,now: 2024-08-02 18:41:56.450478,epoch time: 0:18:28.114524,used: 5:01:15.666598,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9649756, 'precision': 0.96520996, 'recall': 0.96498513, 'specificity': 0.96498513, 'f1': 0.96497166, 'auroc': 0.9932494, 'binary_precision': 0.9758637, 'binary_recall': 0.95359534, 'binary_specificity': 0.9763749, 'binary_f1_score': 0.964601}
confusion matrix:
       0      1
0  27979    677
1   1332  27372
---- Validation: 
scalar performance:
{'acc': 0.86494255, 'precision': 0.57552695, 'recall': 0.79056853, 'specificity': 0.79056853, 'f1': 0.5952078, 'auroc': 0.87923026, 'binary_precision': 0.16269135, 'binary_recall': 0.71073097, 'binary_specificity': 0.8704061, 'binary_f1_score': 0.26477405}
confusion matrix:
       0     1
0  15797  2352
1    186   457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8280601, 'precision': 0.58532774, 'recall': 0.84432447, 'specificity': 0.84432447, 'f1': 0.5984907, 'auroc': 0.9274765, 'binary_precision': 0.17786561, 'binary_recall': 0.86206895, 'binary_specificity': 0.8265799, 'binary_f1_score': 0.2948886}
confusion matrix:
      0     1
0  4957  1040
1    36   225
early stop counter: 16
val acc:0.8649425506591797, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 17,now: 2024-08-02 19:00:27.813095,epoch time: 0:18:31.362617,used: 5:19:47.029215,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9646095, 'precision': 0.9647981, 'recall': 0.9646174, 'specificity': 0.9646174, 'f1': 0.9646063, 'auroc': 0.9932841, 'binary_precision': 0.9743544, 'binary_recall': 0.95439345, 'binary_specificity': 0.97484124, 'binary_f1_score': 0.9642706}
confusion matrix:
       0      1
0  27937    721
1   1309  27393
---- Validation: 
scalar performance:
{'acc': 0.83982545, 'precision': 0.56824684, 'recall': 0.8023169, 'specificity': 0.8023169, 'f1': 0.57800734, 'auroc': 0.8783752, 'binary_precision': 0.14639977, 'binary_recall': 0.7620529, 'binary_specificity': 0.84258085, 'binary_f1_score': 0.24561405}
confusion matrix:
       0     1
0  15292  2857
1    153   490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79050815, 'precision': 0.57255995, 'recall': 0.8320607, 'specificity': 0.8320607, 'f1': 0.5684579, 'auroc': 0.9281921, 'binary_precision': 0.15185677, 'binary_recall': 0.8773946, 'binary_specificity': 0.7867267, 'binary_f1_score': 0.25890335}
confusion matrix:
      0     1
0  4718  1279
1    32   229
early stop counter: 17
val acc:0.839825451374054, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 18,now: 2024-08-02 19:18:58.488634,epoch time: 0:18:30.675539,used: 5:38:17.704754,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96504533, 'precision': 0.9656764, 'recall': 0.9650609, 'specificity': 0.9650609, 'f1': 0.9650343, 'auroc': 0.99374855, 'binary_precision': 0.98303, 'binary_recall': 0.9464883, 'binary_specificity': 0.98363346, 'binary_f1_score': 0.96441317}
confusion matrix:
       0      1
0  28187    469
1   1536  27168
---- Validation: 
scalar performance:
{'acc': 0.87031716, 'precision': 0.57813865, 'recall': 0.79110086, 'specificity': 0.79110086, 'f1': 0.6001369, 'auroc': 0.87785274, 'binary_precision': 0.16802369, 'binary_recall': 0.7060653, 'binary_specificity': 0.8761364, 'binary_f1_score': 0.27144992}
confusion matrix:
       0     1
0  15901  2248
1    189   454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8349313, 'precision': 0.5884879, 'recall': 0.84790957, 'specificity': 0.84790957, 'f1': 0.60490537, 'auroc': 0.9276401, 'binary_precision': 0.18412438, 'binary_recall': 0.86206895, 'binary_specificity': 0.8337502, 'binary_f1_score': 0.30343896}
confusion matrix:
      0    1
0  5000  997
1    36  225
early stop counter: 18
val acc:0.8703171610832214, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 19,now: 2024-08-02 19:37:25.348445,epoch time: 0:18:26.859811,used: 5:56:44.564565,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9683403, 'precision': 0.9684836, 'recall': 0.96834713, 'specificity': 0.96834713, 'f1': 0.96833825, 'auroc': 0.9944725, 'binary_precision': 0.97687125, 'binary_recall': 0.95944536, 'binary_specificity': 0.9772489, 'binary_f1_score': 0.9680799}
confusion matrix:
       0      1
0  28006    652
1   1164  27538
---- Validation: 
scalar performance:
{'acc': 0.84541297, 'precision': 0.5707901, 'recall': 0.80595964, 'specificity': 0.80595964, 'f1': 0.58321375, 'auroc': 0.8794483, 'binary_precision': 0.15135635, 'binary_recall': 0.7636081, 'binary_specificity': 0.8483112, 'binary_f1_score': 0.252637}
confusion matrix:
       0     1
0  15396  2753
1    152   491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8079259, 'precision': 0.57752275, 'recall': 0.8356515, 'specificity': 0.8356515, 'f1': 0.58130795, 'auroc': 0.92772436, 'binary_precision': 0.16223978, 'binary_recall': 0.8659004, 'binary_specificity': 0.8054027, 'binary_f1_score': 0.2732769}
confusion matrix:
      0     1
0  4830  1167
1    35   226
early stop counter: 19
val acc:0.8454129695892334, best validation acc: 0.8946892023086548, corresponding to test acc:                         0.8961329460144043 / 0.899488627910614
after epoch: 20,now: 2024-08-02 19:55:56.992638,epoch time: 0:18:31.644193,used: 6:15:16.208758,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_40_40_seed_0_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:15:16.208758 at 2024-08-02 19:55:56.992638
persisted model performance metric: 

scalar performance:
{'acc': 0.89613295, 'precision': 0.5479295, 'recall': 0.5921658, 'specificity': 0.5921658, 'f1': 0.55880725, 'auroc': 0.7591822, 'binary_precision': 0.12952381, 'binary_recall': 0.2605364, 'binary_specificity': 0.9237952, 'binary_f1_score': 0.17302799}
confusion matrix:
      0    1
0  5540  457
1   193   68
oracle model performance metric: 

scalar performance:
{'acc': 0.8994886, 'precision': 0.602347, 'recall': 0.74416804, 'specificity': 0.74416804, 'f1': 0.63432145, 'auroc': 0.86443925, 'binary_precision': 0.2245509, 'binary_recall': 0.57471263, 'binary_specificity': 0.91362345, 'binary_f1_score': 0.32292786}
confusion matrix:
      0    1
0  5479  518
1   111  150
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB | 478505 GiB | 478505 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 471284 GiB | 471283 GiB |
|       from small pool |  17491 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB | 478505 GiB | 478505 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 471284 GiB | 471283 GiB |
|       from small pool |  17491 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB | 478478 GiB | 478478 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 471273 GiB | 471273 GiB |
|       from small pool |  16482 KiB |     36 MiB |   7204 GiB |   7204 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59895 KiB | 732464 KiB | 269418 GiB | 269418 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 262194 GiB | 262194 GiB |
|       from small pool |   9133 KiB |  11093 KiB |   7223 GiB |   7223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7665    |   92081 K  |   92078 K  |
|       from large pool |      79    |     762    |   44500 K  |   44500 K  |
|       from small pool |    2899    |    7584    |   47580 K  |   47578 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7665    |   92081 K  |   92078 K  |
|       from large pool |      79    |     762    |   44500 K  |   44500 K  |
|       from small pool |    2899    |    7584    |   47580 K  |   47578 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3606    |   53673 K  |   53673 K  |
|       from large pool |      10    |     350    |   33590 K  |   33590 K  |
|       from small pool |      24    |    3596    |   20083 K  |   20083 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 478505 GiB | 478505 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471284 GiB | 471284 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 478505 GiB | 478505 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471284 GiB | 471284 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 478478 GiB | 478478 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 471273 GiB | 471273 GiB |
|       from small pool |      0 KiB |     36 MiB |   7204 GiB |   7204 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 269418 GiB | 269418 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 262194 GiB | 262194 GiB |
|       from small pool |      0 KiB |  23272 KiB |   7223 GiB |   7223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7665    |   92081 K  |   92081 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47580 K  |   47580 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7665    |   92081 K  |   92081 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47580 K  |   47580 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3606    |   53674 K  |   53674 K  |
|       from large pool |       3    |     350    |   33590 K  |   33590 K  |
|       from small pool |       0    |    3596    |   20084 K  |   20084 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 478505 GiB | 478505 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471284 GiB | 471284 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 478505 GiB | 478505 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471284 GiB | 471284 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 478478 GiB | 478478 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 471273 GiB | 471273 GiB |
|       from small pool |      0 KiB |     36 MiB |   7204 GiB |   7204 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 269418 GiB | 269418 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 262194 GiB | 262194 GiB |
|       from small pool |      0 KiB |  23272 KiB |   7223 GiB |   7223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7665    |   92081 K  |   92081 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47580 K  |   47580 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7665    |   92081 K  |   92081 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47580 K  |   47580 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3606    |   53674 K  |   53674 K  |
|       from large pool |       3    |     350    |   33590 K  |   33590 K  |
|       from small pool |       0    |    3596    |   20084 K  |   20084 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975

 Experiment start at: 2024-08-02 20:03:44.863168
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.83702445, 'precision': 0.8386313, 'recall': 0.8370495, 'specificity': 0.8370495, 'f1': 0.83683795, 'auroc': 0.90215844, 'binary_precision': 0.8621409, 'binary_recall': 0.8026293, 'binary_specificity': 0.87146974, 'binary_f1_score': 0.8313214}
confusion matrix:
       0      1
0  25087   3700
1   5690  23139
---- Validation: 
scalar performance:
{'acc': 0.87838846, 'precision': 0.50546676, 'recall': 0.513491, 'specificity': 0.513491, 'f1': 0.50066215, 'auroc': 0.72856313, 'binary_precision': 0.04581448, 'binary_recall': 0.12035661, 'binary_specificity': 0.90662533, 'binary_f1_score': 0.06636624}
confusion matrix:
       0     1
0  16380  1687
1    592    81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9057364, 'precision': 0.5282601, 'recall': 0.5425522, 'specificity': 0.5425522, 'f1': 0.5325972, 'auroc': 0.7882494, 'binary_precision': 0.09476309, 'binary_recall': 0.14615385, 'binary_specificity': 0.93895054, 'binary_f1_score': 0.114977315}
confusion matrix:
      0    1
0  5583  363
1   222   38
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 20:23:09.773822,epoch time: 0:19:24.910654,used: 0:19:24.910654,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8911934, 'precision': 0.8960782, 'recall': 0.8912339, 'specificity': 0.8912339, 'f1': 0.890864, 'auroc': 0.9461906, 'binary_precision': 0.94024664, 'binary_recall': 0.8356516, 'binary_specificity': 0.94681627, 'binary_f1_score': 0.8848689}
confusion matrix:
       0      1
0  27256   1531
1   4738  24091
---- Validation: 
scalar performance:
{'acc': 0.8930096, 'precision': 0.5315004, 'recall': 0.5725731, 'specificity': 0.5725731, 'f1': 0.5376999, 'auroc': 0.78405714, 'binary_precision': 0.093406595, 'binary_recall': 0.22734027, 'binary_specificity': 0.91780597, 'binary_f1_score': 0.13241021}
confusion matrix:
       0     1
0  16582  1485
1    520   153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9087979, 'precision': 0.55219394, 'recall': 0.5827686, 'specificity': 0.5827686, 'f1': 0.56212705, 'auroc': 0.8370488, 'binary_precision': 0.13915095, 'binary_recall': 0.22692308, 'binary_specificity': 0.9386142, 'binary_f1_score': 0.17251463}
confusion matrix:
      0    1
0  5581  365
1   201   59
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 20:42:01.182638,epoch time: 0:18:51.408816,used: 0:38:16.319470,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9098861, 'precision': 0.9148769, 'recall': 0.9099262, 'specificity': 0.9099262, 'f1': 0.90962005, 'auroc': 0.96143705, 'binary_precision': 0.9605627, 'binary_recall': 0.8550071, 'binary_specificity': 0.96484524, 'binary_f1_score': 0.90471643}
confusion matrix:
       0      1
0  27775   1012
1   4180  24649
---- Validation: 
scalar performance:
{'acc': 0.9032017, 'precision': 0.56211376, 'recall': 0.642233, 'specificity': 0.642233, 'f1': 0.57987046, 'auroc': 0.81537366, 'binary_precision': 0.14935464, 'binary_recall': 0.36106983, 'binary_specificity': 0.9233962, 'binary_f1_score': 0.21130432}
confusion matrix:
       0     1
0  16683  1384
1    430   243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91347086, 'precision': 0.58368313, 'recall': 0.64221585, 'specificity': 0.64221585, 'f1': 0.6025645, 'auroc': 0.8625171, 'binary_precision': 0.19693655, 'binary_recall': 0.34615386, 'binary_specificity': 0.93827784, 'binary_f1_score': 0.25104603}
confusion matrix:
      0    1
0  5579  367
1   170   90
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-02 21:00:44.905259,epoch time: 0:18:43.722621,used: 0:57:00.042091,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92196614, 'precision': 0.92500937, 'recall': 0.9219955, 'specificity': 0.9219955, 'f1': 0.92182976, 'auroc': 0.97049475, 'binary_precision': 0.9611477, 'binary_recall': 0.87959623, 'binary_specificity': 0.96439487, 'binary_f1_score': 0.91856545}
confusion matrix:
       0      1
0  27763   1025
1   3471  25357
---- Validation: 
scalar performance:
{'acc': 0.90565634, 'precision': 0.5803591, 'recall': 0.6935748, 'specificity': 0.6935748, 'f1': 0.60554826, 'auroc': 0.8396615, 'binary_precision': 0.18187101, 'binary_recall': 0.46508172, 'binary_specificity': 0.9220679, 'binary_f1_score': 0.26148707}
confusion matrix:
       0     1
0  16659  1408
1    360   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9152433, 'precision': 0.61760443, 'recall': 0.7350902, 'specificity': 0.7350902, 'f1': 0.6510366, 'auroc': 0.88088113, 'binary_precision': 0.25641027, 'binary_recall': 0.53846157, 'binary_specificity': 0.9317188, 'binary_f1_score': 0.3473946}
confusion matrix:
      0    1
0  5540  406
1   120  140
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-02 21:19:46.092620,epoch time: 0:19:01.187361,used: 1:16:01.229452,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.92913425, 'precision': 0.93285394, 'recall': 0.92916656, 'specificity': 0.92916656, 'f1': 0.92898524, 'auroc': 0.97682357, 'binary_precision': 0.9731538, 'binary_recall': 0.8827182, 'binary_specificity': 0.97561485, 'binary_f1_score': 0.92573255}
confusion matrix:
       0      1
0  28086    702
1   3381  25447
---- Validation: 
scalar performance:
{'acc': 0.91979724, 'precision': 0.5972952, 'recall': 0.70162386, 'specificity': 0.70162386, 'f1': 0.6260892, 'auroc': 0.85042167, 'binary_precision': 0.21536352, 'binary_recall': 0.4665676, 'binary_specificity': 0.93668014, 'binary_f1_score': 0.29469734}
confusion matrix:
       0     1
0  16923  1144
1    359   314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92620045, 'precision': 0.6364838, 'recall': 0.7426473, 'specificity': 0.7426473, 'f1': 0.67092097, 'auroc': 0.89256513, 'binary_precision': 0.29375, 'binary_recall': 0.5423077, 'binary_specificity': 0.9429869, 'binary_f1_score': 0.38108107}
confusion matrix:
      0    1
0  5607  339
1   119  141
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-02 21:38:34.202857,epoch time: 0:18:48.110237,used: 1:34:49.339689,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9371008, 'precision': 0.93865526, 'recall': 0.9371226, 'specificity': 0.9371226, 'f1': 0.9370471, 'auroc': 0.98136175, 'binary_precision': 0.9649511, 'binary_recall': 0.9072462, 'binary_specificity': 0.966999, 'binary_f1_score': 0.93520933}
confusion matrix:
       0      1
0  27837    950
1   2674  26155
---- Validation: 
scalar performance:
{'acc': 0.91979724, 'precision': 0.61076206, 'recall': 0.74811625, 'specificity': 0.74811625, 'f1': 0.646287, 'auroc': 0.8632529, 'binary_precision': 0.23866498, 'binary_recall': 0.56315005, 'binary_specificity': 0.9330824, 'binary_f1_score': 0.33524987}
confusion matrix:
       0     1
0  16858  1209
1    294   379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9231389, 'precision': 0.6446372, 'recall': 0.7943802, 'specificity': 0.7943802, 'f1': 0.6875091, 'auroc': 0.9055228, 'binary_precision': 0.30520648, 'binary_recall': 0.65384614, 'binary_specificity': 0.93491423, 'binary_f1_score': 0.41615668}
confusion matrix:
      0    1
0  5559  387
1    90  170
early stop counter: 1
val acc:0.9197972416877747, best validation acc: 0.9197972416877747, corresponding to test acc:                         0.9262004494667053 / 0.9262004494667053
after epoch: 6,now: 2024-08-02 21:57:06.768419,epoch time: 0:18:32.565562,used: 1:53:21.905251,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9417523, 'precision': 0.9440235, 'recall': 0.94177973, 'specificity': 0.94177973, 'f1': 0.9416802, 'auroc': 0.9839499, 'binary_precision': 0.9759716, 'binary_recall': 0.90589666, 'binary_specificity': 0.97766274, 'binary_f1_score': 0.93962944}
confusion matrix:
       0      1
0  28143    643
1   2713  26117
---- Validation: 
scalar performance:
{'acc': 0.9227321, 'precision': 0.61829114, 'recall': 0.7617979, 'specificity': 0.7617979, 'f1': 0.6562409, 'auroc': 0.87237704, 'binary_precision': 0.2527122, 'binary_recall': 0.5884101, 'binary_specificity': 0.9351857, 'binary_f1_score': 0.35357144}
confusion matrix:
       0     1
0  16896  1171
1    277   396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9250725, 'precision': 0.6505543, 'recall': 0.8064232, 'specificity': 0.8064232, 'f1': 0.69537055, 'auroc': 0.91332316, 'binary_precision': 0.31597847, 'binary_recall': 0.6769231, 'binary_specificity': 0.93592334, 'binary_f1_score': 0.43084455}
confusion matrix:
      0    1
0  5565  381
1    84  176
better model found
persisted
after epoch: 7,now: 2024-08-02 22:15:45.466372,epoch time: 0:18:38.697953,used: 2:12:00.603204,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94475496, 'precision': 0.94672215, 'recall': 0.9447792, 'specificity': 0.9447792, 'f1': 0.9446961, 'auroc': 0.9866469, 'binary_precision': 0.97654974, 'binary_recall': 0.91147804, 'binary_specificity': 0.9780804, 'binary_f1_score': 0.9428925}
confusion matrix:
       0      1
0  28156    631
1   2552  26277
---- Validation: 
scalar performance:
{'acc': 0.9239061, 'precision': 0.62320364, 'recall': 0.7745663, 'specificity': 0.7745663, 'f1': 0.66315293, 'auroc': 0.8753905, 'binary_precision': 0.26155794, 'binary_recall': 0.6136701, 'binary_specificity': 0.9354625, 'binary_f1_score': 0.36678505}
confusion matrix:
       0     1
0  16901  1166
1    260   413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236223, 'precision': 0.65050983, 'recall': 0.81670034, 'specificity': 0.81670034, 'f1': 0.6967069, 'auroc': 0.9172721, 'binary_precision': 0.31487888, 'binary_recall': 0.7, 'binary_specificity': 0.93340063, 'binary_f1_score': 0.43436754}
confusion matrix:
      0    1
0  5550  396
1    78  182
better model found
persisted
after epoch: 8,now: 2024-08-02 22:34:22.987502,epoch time: 0:18:37.521130,used: 2:30:38.124334,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94720215, 'precision': 0.94923663, 'recall': 0.94722676, 'specificity': 0.94722676, 'f1': 0.94714427, 'auroc': 0.98779833, 'binary_precision': 0.97965103, 'binary_recall': 0.9134552, 'binary_specificity': 0.9809984, 'binary_f1_score': 0.94539577}
confusion matrix:
       0      1
0  28240    547
1   2495  26334
---- Validation: 
scalar performance:
{'acc': 0.9228922, 'precision': 0.62550056, 'recall': 0.7897763, 'specificity': 0.7897763, 'f1': 0.66735893, 'auroc': 0.8811023, 'binary_precision': 0.26492083, 'binary_recall': 0.64635956, 'binary_specificity': 0.9331931, 'binary_f1_score': 0.37580994}
confusion matrix:
       0     1
0  16860  1207
1    238   435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9199162, 'precision': 0.64889526, 'recall': 0.83499503, 'specificity': 0.83499503, 'f1': 0.6970187, 'auroc': 0.9212625, 'binary_precision': 0.30979133, 'binary_recall': 0.74230766, 'binary_specificity': 0.92768246, 'binary_f1_score': 0.43714607}
confusion matrix:
      0    1
0  5516  430
1    67  193
early stop counter: 1
val acc:0.9228922128677368, best validation acc: 0.9239060878753662, corresponding to test acc:                         0.9236223101615906 / 0.9262004494667053
after epoch: 9,now: 2024-08-02 22:52:54.433314,epoch time: 0:18:31.445812,used: 2:49:09.570146,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95109, 'precision': 0.95287794, 'recall': 0.95111406, 'specificity': 0.95111406, 'f1': 0.9510435, 'auroc': 0.9891137, 'binary_precision': 0.98152536, 'binary_recall': 0.91956294, 'binary_specificity': 0.9826652, 'binary_f1_score': 0.9495344}
confusion matrix:
       0      1
0  28287    499
1   2319  26511
---- Validation: 
scalar performance:
{'acc': 0.9244931, 'precision': 0.6291675, 'recall': 0.79561347, 'specificity': 0.79561347, 'f1': 0.67214715, 'auroc': 0.8852725, 'binary_precision': 0.2718327, 'binary_recall': 0.65676075, 'binary_specificity': 0.9344662, 'binary_f1_score': 0.384515}
confusion matrix:
       0     1
0  16883  1184
1    231   442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91814375, 'precision': 0.6489234, 'recall': 0.846943, 'specificity': 0.846943, 'f1': 0.698185, 'auroc': 0.9249379, 'binary_precision': 0.30864197, 'binary_recall': 0.7692308, 'binary_specificity': 0.92465526, 'binary_f1_score': 0.44052863}
confusion matrix:
      0    1
0  5498  448
1    60  200
better model found
persisted
after epoch: 10,now: 2024-08-02 23:11:31.122164,epoch time: 0:18:36.688850,used: 3:07:46.258996,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9526867, 'precision': 0.95375615, 'recall': 0.95270455, 'specificity': 0.95270455, 'f1': 0.9526601, 'auroc': 0.98935807, 'binary_precision': 0.97596735, 'binary_recall': 0.92830133, 'binary_specificity': 0.9771077, 'binary_f1_score': 0.9515377}
confusion matrix:
       0      1
0  28128    659
1   2067  26762
---- Validation: 
scalar performance:
{'acc': 0.9259872, 'precision': 0.634533, 'recall': 0.80926317, 'specificity': 0.80926317, 'f1': 0.67967635, 'auroc': 0.8896907, 'binary_precision': 0.28151774, 'binary_recall': 0.68350667, 'binary_specificity': 0.9350197, 'binary_f1_score': 0.3987863}
confusion matrix:
       0     1
0  16893  1174
1    213   460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9170158, 'precision': 0.6506662, 'recall': 0.86290526, 'specificity': 0.86290526, 'f1': 0.7015763, 'auroc': 0.9287789, 'binary_precision': 0.31054977, 'binary_recall': 0.8038462, 'binary_specificity': 0.92196435, 'binary_f1_score': 0.44801712}
confusion matrix:
      0    1
0  5482  464
1    51  209
better model found
persisted
after epoch: 11,now: 2024-08-02 23:30:05.293216,epoch time: 0:18:34.171052,used: 3:26:20.430048,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9559497, 'precision': 0.9567349, 'recall': 0.9559649, 'specificity': 0.9559649, 'f1': 0.9559318, 'auroc': 0.9905411, 'binary_precision': 0.97585523, 'binary_recall': 0.9351001, 'binary_specificity': 0.9768298, 'binary_f1_score': 0.9550431}
confusion matrix:
       0      1
0  28120    667
1   1871  26958
---- Validation: 
scalar performance:
{'acc': 0.92310566, 'precision': 0.631468, 'recall': 0.8142061, 'specificity': 0.8142061, 'f1': 0.6766152, 'auroc': 0.891974, 'binary_precision': 0.2749121, 'binary_recall': 0.6968796, 'binary_specificity': 0.9315326, 'binary_f1_score': 0.39428332}
confusion matrix:
       0     1
0  16830  1237
1    204   469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91588783, 'precision': 0.64943326, 'recall': 0.8641556, 'specificity': 0.8641556, 'f1': 0.700175, 'auroc': 0.93057585, 'binary_precision': 0.3079179, 'binary_recall': 0.8076923, 'binary_specificity': 0.9206189, 'binary_f1_score': 0.4458599}
confusion matrix:
      0    1
0  5474  472
1    50  210
early stop counter: 1
val acc:0.9231056571006775, best validation acc: 0.925987184047699, corresponding to test acc:                         0.917015790939331 / 0.9262004494667053
after epoch: 12,now: 2024-08-02 23:48:34.878579,epoch time: 0:18:29.585363,used: 3:44:50.015411,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95732087, 'precision': 0.9581547, 'recall': 0.95733726, 'specificity': 0.95733726, 'f1': 0.9573025, 'auroc': 0.99128246, 'binary_precision': 0.9778913, 'binary_recall': 0.9358654, 'binary_specificity': 0.9788091, 'binary_f1_score': 0.9564169}
confusion matrix:
       0      1
0  28176    610
1   1849  26981
---- Validation: 
scalar performance:
{'acc': 0.9171825, 'precision': 0.62683827, 'recall': 0.82830065, 'specificity': 0.82830065, 'f1': 0.6720392, 'auroc': 0.89439094, 'binary_precision': 0.26434317, 'binary_recall': 0.73254085, 'binary_specificity': 0.92406046, 'binary_f1_score': 0.38849488}
confusion matrix:
       0     1
0  16695  1372
1    180   493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.901708, 'precision': 0.6332948, 'recall': 0.8641116, 'specificity': 0.8641116, 'f1': 0.67935014, 'auroc': 0.933257, 'binary_precision': 0.27506426, 'binary_recall': 0.8230769, 'binary_specificity': 0.9051463, 'binary_f1_score': 0.41233137}
confusion matrix:
      0    1
0  5382  564
1    46  214
early stop counter: 2
val acc:0.9171825051307678, best validation acc: 0.925987184047699, corresponding to test acc:                         0.917015790939331 / 0.9262004494667053
after epoch: 13,now: 2024-08-03 00:07:22.673898,epoch time: 0:18:47.795319,used: 4:03:37.810730,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95825815, 'precision': 0.9591496, 'recall': 0.9582743, 'specificity': 0.9582743, 'f1': 0.9582389, 'auroc': 0.9918716, 'binary_precision': 0.9795644, 'binary_recall': 0.936106, 'binary_specificity': 0.9804426, 'binary_f1_score': 0.9573423}
confusion matrix:
       0      1
0  28224    563
1   1842  26987
---- Validation: 
scalar performance:
{'acc': 0.92161155, 'precision': 0.6327115, 'recall': 0.8291671, 'specificity': 0.8291671, 'f1': 0.67935807, 'auroc': 0.8947165, 'binary_precision': 0.27615297, 'binary_recall': 0.7295691, 'binary_specificity': 0.9287652, 'binary_f1_score': 0.4006528}
confusion matrix:
       0     1
0  16780  1287
1    182   491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9047696, 'precision': 0.63637424, 'recall': 0.8638704, 'specificity': 0.8638704, 'f1': 0.6835071, 'auroc': 0.934986, 'binary_precision': 0.28137386, 'binary_recall': 0.8192308, 'binary_specificity': 0.9085099, 'binary_f1_score': 0.41887906}
confusion matrix:
      0    1
0  5402  544
1    47  213
early stop counter: 3
val acc:0.9216115474700928, best validation acc: 0.925987184047699, corresponding to test acc:                         0.917015790939331 / 0.9262004494667053
after epoch: 14,now: 2024-08-03 00:25:59.029225,epoch time: 0:18:36.355327,used: 4:22:14.166057,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9608789, 'precision': 0.96135384, 'recall': 0.96089077, 'specificity': 0.96089077, 'f1': 0.96086955, 'auroc': 0.99252033, 'binary_precision': 0.9763398, 'binary_recall': 0.94470847, 'binary_specificity': 0.977073, 'binary_f1_score': 0.9602637}
confusion matrix:
       0      1
0  28127    660
1   1594  27235
---- Validation: 
scalar performance:
{'acc': 0.91515476, 'precision': 0.62557757, 'recall': 0.8336864, 'specificity': 0.8336864, 'f1': 0.670735, 'auroc': 0.8949547, 'binary_precision': 0.26132223, 'binary_recall': 0.7459138, 'binary_specificity': 0.921459, 'binary_f1_score': 0.38704705}
confusion matrix:
       0     1
0  16648  1419
1    171   502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8951015, 'precision': 0.6267596, 'recall': 0.86250293, 'specificity': 0.86250293, 'f1': 0.6701634, 'auroc': 0.9366859, 'binary_precision': 0.26187575, 'binary_recall': 0.8269231, 'binary_specificity': 0.89808273, 'binary_f1_score': 0.39777982}
confusion matrix:
      0    1
0  5340  606
1    45  215
early stop counter: 4
val acc:0.915154755115509, best validation acc: 0.925987184047699, corresponding to test acc:                         0.917015790939331 / 0.9262004494667053
after epoch: 15,now: 2024-08-03 00:44:34.734800,epoch time: 0:18:35.705575,used: 4:40:49.871632,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96150374, 'precision': 0.96215665, 'recall': 0.96151686, 'specificity': 0.96151686, 'f1': 0.96149087, 'auroc': 0.9927652, 'binary_precision': 0.97970146, 'binary_recall': 0.94259053, 'binary_specificity': 0.98044324, 'binary_f1_score': 0.9607878}
confusion matrix:
       0      1
0  28225    563
1   1655  27173
---- Validation: 
scalar performance:
{'acc': 0.91109926, 'precision': 0.62210745, 'recall': 0.8387358, 'specificity': 0.8387358, 'f1': 0.6663909, 'auroc': 0.89660776, 'binary_precision': 0.25384235, 'binary_recall': 0.76077265, 'binary_specificity': 0.91669893, 'binary_f1_score': 0.38066915}
confusion matrix:
       0     1
0  16562  1505
1    161   512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8904286, 'precision': 0.6234112, 'recall': 0.8655813, 'specificity': 0.8655813, 'f1': 0.66524136, 'auroc': 0.93740976, 'binary_precision': 0.25467288, 'binary_recall': 0.8384615, 'binary_specificity': 0.89270097, 'binary_f1_score': 0.390681}
confusion matrix:
      0    1
0  5308  638
1    42  218
early stop counter: 5
val acc:0.9110992550849915, best validation acc: 0.925987184047699, corresponding to test acc:                         0.917015790939331 / 0.9262004494667053
after epoch: 16,now: 2024-08-03 01:03:05.985106,epoch time: 0:18:31.250306,used: 4:59:21.121938,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9639163, 'precision': 0.96412146, 'recall': 0.9639237, 'specificity': 0.9639237, 'f1': 0.9639127, 'auroc': 0.9933469, 'binary_precision': 0.9740545, 'binary_recall': 0.9532746, 'binary_specificity': 0.9745727, 'binary_f1_score': 0.96355253}
confusion matrix:
       0      1
0  28056    732
1   1347  27481
---- Validation: 
scalar performance:
{'acc': 0.9081644, 'precision': 0.619025, 'recall': 0.83864427, 'specificity': 0.83864427, 'f1': 0.6622009, 'auroc': 0.8966635, 'binary_precision': 0.24759153, 'binary_recall': 0.7637444, 'binary_specificity': 0.91354406, 'binary_f1_score': 0.37395415}
confusion matrix:
       0     1
0  16505  1562
1    159   514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8818885, 'precision': 0.6170795, 'recall': 0.86664146, 'specificity': 0.86664146, 'f1': 0.65546966, 'auroc': 0.93878496, 'binary_precision': 0.24153006, 'binary_recall': 0.85, 'binary_specificity': 0.8832829, 'binary_f1_score': 0.37617022}
confusion matrix:
      0    1
0  5252  694
1    39  221
early stop counter: 6
val acc:0.908164381980896, best validation acc: 0.925987184047699, corresponding to test acc:                         0.917015790939331 / 0.9262004494667053
after epoch: 17,now: 2024-08-03 01:21:33.739997,epoch time: 0:18:27.754891,used: 5:17:48.876829,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9641072, 'precision': 0.9642416, 'recall': 0.9641135, 'specificity': 0.9641135, 'f1': 0.9641049, 'auroc': 0.9937843, 'binary_precision': 0.9723252, 'binary_recall': 0.9554615, 'binary_specificity': 0.9727655, 'binary_f1_score': 0.96381956}
confusion matrix:
       0      1
0  28003    784
1   1284  27545
---- Validation: 
scalar performance:
{'acc': 0.90522945, 'precision': 0.6158141, 'recall': 0.8371221, 'specificity': 0.8371221, 'f1': 0.6577011, 'auroc': 0.8971376, 'binary_precision': 0.24120131, 'binary_recall': 0.7637444, 'binary_specificity': 0.9104998, 'binary_f1_score': 0.3666191}
confusion matrix:
       0     1
0  16450  1617
1    159   514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87802124, 'precision': 0.6150971, 'recall': 0.87014025, 'specificity': 0.87014025, 'f1': 0.6521186, 'auroc': 0.93946546, 'binary_precision': 0.23703703, 'binary_recall': 0.86153847, 'binary_specificity': 0.87874204, 'binary_f1_score': 0.37178424}
confusion matrix:
      0    1
0  5225  721
1    36  224
early stop counter: 7
val acc:0.9052294492721558, best validation acc: 0.925987184047699, corresponding to test acc:                         0.917015790939331 / 0.9262004494667053
after epoch: 18,now: 2024-08-03 01:40:02.371284,epoch time: 0:18:28.631287,used: 5:36:17.508116,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9645411, 'precision': 0.9650829, 'recall': 0.9645536, 'specificity': 0.9645536, 'f1': 0.9645314, 'auroc': 0.99376637, 'binary_precision': 0.98113954, 'binary_recall': 0.94734466, 'binary_specificity': 0.9817626, 'binary_f1_score': 0.96394604}
confusion matrix:
       0      1
0  28262    525
1   1518  27311
---- Validation: 
scalar performance:
{'acc': 0.90885806, 'precision': 0.6185934, 'recall': 0.8332819, 'specificity': 0.8332819, 'f1': 0.66146094, 'auroc': 0.89655805, 'binary_precision': 0.24719101, 'binary_recall': 0.75185734, 'binary_specificity': 0.91470635, 'binary_f1_score': 0.37205884}
confusion matrix:
       0     1
0  16526  1541
1    167   506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.877699, 'precision': 0.6148455, 'recall': 0.86997205, 'specificity': 0.86997205, 'f1': 0.6517153, 'auroc': 0.93918794, 'binary_precision': 0.23653643, 'binary_recall': 0.86153847, 'binary_specificity': 0.87840563, 'binary_f1_score': 0.37116817}
confusion matrix:
      0    1
0  5223  723
1    36  224
early stop counter: 8
val acc:0.908858060836792, best validation acc: 0.925987184047699, corresponding to test acc:                         0.917015790939331 / 0.9262004494667053
after epoch: 19,now: 2024-08-03 01:58:32.806483,epoch time: 0:18:30.435199,used: 5:54:47.943315,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96634614, 'precision': 0.9664278, 'recall': 0.9663511, 'specificity': 0.9663511, 'f1': 0.96634495, 'auroc': 0.9939096, 'binary_precision': 0.9727829, 'binary_recall': 0.9595893, 'binary_specificity': 0.9731129, 'binary_f1_score': 0.9661411}
confusion matrix:
       0      1
0  28013    774
1   1165  27664
---- Validation: 
scalar performance:
{'acc': 0.9041089, 'precision': 0.6150829, 'recall': 0.8386867, 'specificity': 0.8386867, 'f1': 0.65668947, 'auroc': 0.89748865, 'binary_precision': 0.23957367, 'binary_recall': 0.76820207, 'binary_specificity': 0.9091714, 'binary_f1_score': 0.36524194}
confusion matrix:
       0     1
0  16426  1641
1    156   517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.877699, 'precision': 0.6148455, 'recall': 0.86997205, 'specificity': 0.86997205, 'f1': 0.6517153, 'auroc': 0.93978107, 'binary_precision': 0.23653643, 'binary_recall': 0.86153847, 'binary_specificity': 0.87840563, 'binary_f1_score': 0.37116817}
confusion matrix:
      0    1
0  5223  723
1    36  224
early stop counter: 9
val acc:0.9041088819503784, best validation acc: 0.925987184047699, corresponding to test acc:                         0.917015790939331 / 0.9262004494667053
after epoch: 20,now: 2024-08-03 02:17:09.913815,epoch time: 0:18:37.107332,used: 6:13:25.050647,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_03_44_seed_1_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:13:25.050647 at 2024-08-03 02:17:09.913815
persisted model performance metric: 

scalar performance:
{'acc': 0.9170158, 'precision': 0.6506662, 'recall': 0.86290526, 'specificity': 0.86290526, 'f1': 0.7015763, 'auroc': 0.9287789, 'binary_precision': 0.31054977, 'binary_recall': 0.8038462, 'binary_specificity': 0.92196435, 'binary_f1_score': 0.44801712}
confusion matrix:
      0    1
0  5482  464
1    51  209
oracle model performance metric: 

scalar performance:
{'acc': 0.92620045, 'precision': 0.6364838, 'recall': 0.7426473, 'specificity': 0.7426473, 'f1': 0.67092097, 'auroc': 0.89256513, 'binary_precision': 0.29375, 'binary_recall': 0.5423077, 'binary_specificity': 0.9429869, 'binary_f1_score': 0.38108107}
confusion matrix:
      0    1
0  5607  339
1   119  141
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |  17479 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |  17479 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   7827 MiB |    941 TiB |    941 TiB |
|       from large pool | 178979 KiB |   7804 MiB |    926 TiB |    926 TiB |
|       from small pool |  16480 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8530 MiB |  16792 MiB |   8278 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  16734 MiB |   8260 MiB |
|       from small pool |     40 MiB |     44 MiB |     58 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38830 KiB | 732464 KiB | 532482 GiB | 532482 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 517957 GiB | 517957 GiB |
|       from small pool |   7097 KiB |  23272 KiB |  14524 GiB |  14524 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7697    |  184999 K  |  184996 K  |
|       from large pool |      79    |     762    |   89600 K  |   89600 K  |
|       from small pool |    2875    |    7616    |   95399 K  |   95396 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7697    |  184999 K  |  184996 K  |
|       from large pool |      79    |     762    |   89600 K  |   89600 K  |
|       from small pool |    2875    |    7616    |   95399 K  |   95396 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     371    |     716    |     347    |
|       from large pool |     349    |     349    |     687    |     338    |
|       from small pool |      20    |      22    |      29    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3623    |  102906 K  |  102906 K  |
|       from large pool |      11    |     352    |   61935 K  |   61935 K  |
|       from small pool |      24    |    3613    |   40970 K  |   40970 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16792 MiB |  16562 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     44 MiB |     58 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 532482 GiB | 532482 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 517957 GiB | 517957 GiB |
|       from small pool |      0 KiB |  23272 KiB |  14524 GiB |  14524 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  184999 K  |  184999 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95399 K  |   95399 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  184999 K  |  184999 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95399 K  |   95399 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     716    |     694    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      22    |      29    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3623    |  102907 K  |  102907 K  |
|       from large pool |       3    |     352    |   61935 K  |   61935 K  |
|       from small pool |       0    |    3613    |   40972 K  |   40972 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16792 MiB |  16562 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16734 MiB |  16528 MiB |
|       from small pool |  24576 KiB |     44 MiB |     58 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 532482 GiB | 532482 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 517957 GiB | 517957 GiB |
|       from small pool |      0 KiB |  23272 KiB |  14524 GiB |  14524 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  184999 K  |  184999 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95399 K  |   95399 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  184999 K  |  184999 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95399 K  |   95399 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     716    |     694    |
|       from large pool |      10    |     349    |     687    |     677    |
|       from small pool |      12    |      22    |      29    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3623    |  102907 K  |  102907 K  |
|       from large pool |       3    |     352    |   61935 K  |   61935 K  |
|       from small pool |       0    |    3613    |   40972 K  |   40972 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975

 Experiment start at: 2024-08-03 02:24:57.767569
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8621707, 'precision': 0.863891, 'recall': 0.8621766, 'specificity': 0.8621766, 'f1': 0.8620089, 'auroc': 0.9303061, 'binary_precision': 0.88895434, 'binary_recall': 0.8277944, 'binary_specificity': 0.8965588, 'binary_f1_score': 0.8572849}
confusion matrix:
       0      1
0  26132   3015
1   5021  24136
---- Validation: 
scalar performance:
{'acc': 0.8420604, 'precision': 0.544339, 'recall': 0.69195426, 'specificity': 0.69195426, 'f1': 0.54508686, 'auroc': 0.7547792, 'binary_precision': 0.1065601, 'binary_recall': 0.53156143, 'binary_specificity': 0.85234714, 'binary_f1_score': 0.1775312}
confusion matrix:
       0     1
0  15488  2683
1    282   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6858471, 'precision': 0.50377274, 'recall': 0.52132916, 'specificity': 0.52132916, 'f1': 0.44437277, 'auroc': 0.552806, 'binary_precision': 0.0440552, 'binary_recall': 0.3429752, 'binary_specificity': 0.6996832, 'binary_f1_score': 0.07808091}
confusion matrix:
      0     1
0  4196  1801
1   159    83
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 02:44:31.654646,epoch time: 0:19:33.887077,used: 0:19:33.887077,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9023909, 'precision': 0.90472686, 'recall': 0.9023987, 'specificity': 0.9023987, 'f1': 0.9022511, 'auroc': 0.9598671, 'binary_precision': 0.9355258, 'binary_recall': 0.864394, 'binary_specificity': 0.94040346, 'binary_f1_score': 0.8985543}
confusion matrix:
       0      1
0  27409   1737
1   3954  25204
---- Validation: 
scalar performance:
{'acc': 0.9081127, 'precision': 0.5660298, 'recall': 0.6674521, 'specificity': 0.6674521, 'f1': 0.58689666, 'auroc': 0.77584636, 'binary_precision': 0.15275201, 'binary_recall': 0.410299, 'binary_specificity': 0.92460513, 'binary_f1_score': 0.22262283}
confusion matrix:
       0     1
0  16801  1370
1    355   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8281776, 'precision': 0.51655006, 'recall': 0.55769414, 'specificity': 0.55769414, 'f1': 0.50580716, 'auroc': 0.658797, 'binary_precision': 0.06680585, 'binary_recall': 0.2644628, 'binary_specificity': 0.85092545, 'binary_f1_score': 0.10666666}
confusion matrix:
      0    1
0  5103  894
1   178   64
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 03:03:32.787524,epoch time: 0:19:01.132878,used: 0:38:35.019955,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9214462, 'precision': 0.9243723, 'recall': 0.92145765, 'specificity': 0.92145765, 'f1': 0.921312, 'auroc': 0.970912, 'binary_precision': 0.95967984, 'binary_recall': 0.879904, 'binary_specificity': 0.96301126, 'binary_f1_score': 0.9180621}
confusion matrix:
       0      1
0  28066   1078
1   3502  25658
---- Validation: 
scalar performance:
{'acc': 0.9203111, 'precision': 0.5766687, 'recall': 0.66732895, 'specificity': 0.66732895, 'f1': 0.60004616, 'auroc': 0.791515, 'binary_precision': 0.17419825, 'binary_recall': 0.39700997, 'binary_specificity': 0.9376479, 'binary_f1_score': 0.24214792}
confusion matrix:
       0     1
0  17038  1133
1    363   239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8531816, 'precision': 0.53467983, 'recall': 0.6083727, 'specificity': 0.6083727, 'f1': 0.53652024, 'auroc': 0.7232401, 'binary_precision': 0.098809525, 'binary_recall': 0.3429752, 'binary_specificity': 0.87377024, 'binary_f1_score': 0.15341958}
confusion matrix:
      0    1
0  5240  757
1   159   83
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-03 03:22:32.662982,epoch time: 0:18:59.875458,used: 0:57:34.895413,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9333322, 'precision': 0.9352919, 'recall': 0.93334025, 'specificity': 0.93334025, 'f1': 0.93325794, 'auroc': 0.9778081, 'binary_precision': 0.96455884, 'binary_recall': 0.8997565, 'binary_specificity': 0.966924, 'binary_f1_score': 0.93103147}
confusion matrix:
       0      1
0  28181    964
1   2923  26236
---- Validation: 
scalar performance:
{'acc': 0.9260108, 'precision': 0.59044445, 'recall': 0.68954635, 'specificity': 0.68954635, 'f1': 0.6178454, 'auroc': 0.8074356, 'binary_precision': 0.20030464, 'binary_recall': 0.43687707, 'binary_specificity': 0.9422156, 'binary_f1_score': 0.27467364}
confusion matrix:
       0     1
0  17121  1050
1    339   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8608751, 'precision': 0.5527737, 'recall': 0.6659087, 'specificity': 0.6659087, 'f1': 0.5629993, 'auroc': 0.771303, 'binary_precision': 0.13002364, 'binary_recall': 0.45454547, 'binary_specificity': 0.87727195, 'binary_f1_score': 0.20220588}
confusion matrix:
      0    1
0  5261  736
1   132  110
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-03 03:41:30.874345,epoch time: 0:18:58.211363,used: 1:16:33.106776,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9393352, 'precision': 0.94080335, 'recall': 0.9393412, 'specificity': 0.9393412, 'f1': 0.9392852, 'auroc': 0.9814327, 'binary_precision': 0.96629417, 'binary_recall': 0.9104534, 'binary_specificity': 0.96822894, 'binary_f1_score': 0.93754303}
confusion matrix:
       0      1
0  28220    926
1   2611  26547
---- Validation: 
scalar performance:
{'acc': 0.92302775, 'precision': 0.59407854, 'recall': 0.713703, 'specificity': 0.713703, 'f1': 0.62461734, 'auroc': 0.8224733, 'binary_precision': 0.20586182, 'binary_recall': 0.4900332, 'binary_specificity': 0.93737274, 'binary_f1_score': 0.2899263}
confusion matrix:
       0     1
0  17033  1138
1    307   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8494951, 'precision': 0.5573185, 'recall': 0.6996439, 'specificity': 0.6996439, 'f1': 0.5667976, 'auroc': 0.80473435, 'binary_precision': 0.13584118, 'binary_recall': 0.5371901, 'binary_specificity': 0.86209774, 'binary_f1_score': 0.21684736}
confusion matrix:
      0    1
0  5170  827
1   112  130
early stop counter: 1
val acc:0.923027753829956, best validation acc: 0.92601078748703, corresponding to test acc:                         0.860875129699707 / 0.860875129699707
after epoch: 5,now: 2024-08-03 04:00:35.156503,epoch time: 0:19:04.282158,used: 1:35:37.388934,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9426626, 'precision': 0.9444455, 'recall': 0.94266915, 'specificity': 0.94266915, 'f1': 0.9426056, 'auroc': 0.9837611, 'binary_precision': 0.97264636, 'binary_recall': 0.9109678, 'binary_specificity': 0.9743704, 'binary_f1_score': 0.9407972}
confusion matrix:
       0      1
0  28399    747
1   2596  26562
---- Validation: 
scalar performance:
{'acc': 0.9210036, 'precision': 0.5950347, 'recall': 0.7255061, 'specificity': 0.7255061, 'f1': 0.6268214, 'auroc': 0.8301516, 'binary_precision': 0.20691949, 'binary_recall': 0.5166113, 'binary_specificity': 0.934401, 'binary_f1_score': 0.29548693}
confusion matrix:
       0     1
0  16979  1192
1    291   311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84212214, 'precision': 0.56218386, 'recall': 0.731498, 'specificity': 0.731498, 'f1': 0.5715498, 'auroc': 0.83059436, 'binary_precision': 0.14244466, 'binary_recall': 0.61157024, 'binary_specificity': 0.8514257, 'binary_f1_score': 0.23106948}
confusion matrix:
      0    1
0  5106  891
1    94  148
early stop counter: 2
val acc:0.9210035800933838, best validation acc: 0.92601078748703, corresponding to test acc:                         0.860875129699707 / 0.860875129699707
after epoch: 6,now: 2024-08-03 04:19:33.894263,epoch time: 0:18:58.737760,used: 1:54:36.126694,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9469505, 'precision': 0.9483701, 'recall': 0.9469563, 'specificity': 0.9469563, 'f1': 0.94690895, 'auroc': 0.98637533, 'binary_precision': 0.97365075, 'binary_recall': 0.9187873, 'binary_specificity': 0.97512525, 'binary_f1_score': 0.9454237}
confusion matrix:
       0      1
0  28421    725
1   2368  26790
---- Validation: 
scalar performance:
{'acc': 0.9210036, 'precision': 0.59570134, 'recall': 0.7279153, 'specificity': 0.7279153, 'f1': 0.62781906, 'auroc': 0.83137083, 'binary_precision': 0.20808482, 'binary_recall': 0.5215947, 'binary_specificity': 0.9342359, 'binary_f1_score': 0.29748935}
confusion matrix:
       0     1
0  16976  1195
1    288   314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85109794, 'precision': 0.57417274, 'recall': 0.7718563, 'specificity': 0.7718563, 'f1': 0.5902312, 'auroc': 0.85228086, 'binary_precision': 0.16290481, 'binary_recall': 0.6859504, 'binary_specificity': 0.8577622, 'binary_f1_score': 0.2632831}
confusion matrix:
      0    1
0  5144  853
1    76  166
early stop counter: 3
val acc:0.9210035800933838, best validation acc: 0.92601078748703, corresponding to test acc:                         0.860875129699707 / 0.860875129699707
after epoch: 7,now: 2024-08-03 04:38:32.513413,epoch time: 0:18:58.619150,used: 2:13:34.745844,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9505523, 'precision': 0.95220864, 'recall': 0.95055854, 'specificity': 0.95055854, 'f1': 0.9505074, 'auroc': 0.9879986, 'binary_precision': 0.9796283, 'binary_recall': 0.92026204, 'binary_specificity': 0.980855, 'binary_f1_score': 0.94901764}
confusion matrix:
       0      1
0  28588    558
1   2325  26833
---- Validation: 
scalar performance:
{'acc': 0.9325627, 'precision': 0.61305267, 'recall': 0.7330833, 'specificity': 0.7330833, 'f1': 0.6476794, 'auroc': 0.8370044, 'binary_precision': 0.24263565, 'binary_recall': 0.5199336, 'binary_specificity': 0.94623303, 'binary_f1_score': 0.33086678}
confusion matrix:
       0    1
0  17194  977
1    289  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8724154, 'precision': 0.5861362, 'recall': 0.78096247, 'specificity': 0.78096247, 'f1': 0.61147654, 'auroc': 0.8639761, 'binary_precision': 0.18665159, 'binary_recall': 0.6818182, 'binary_specificity': 0.88010675, 'binary_f1_score': 0.29307282}
confusion matrix:
      0    1
0  5278  719
1    77  165
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-08-03 04:57:34.825624,epoch time: 0:19:02.312211,used: 2:32:37.058055,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9538454, 'precision': 0.9542996, 'recall': 0.9538492, 'specificity': 0.9538492, 'f1': 0.95383406, 'auroc': 0.9887723, 'binary_precision': 0.9687256, 'binary_recall': 0.93799514, 'binary_specificity': 0.9697032, 'binary_f1_score': 0.9531128}
confusion matrix:
       0      1
0  28262    883
1   1808  27351
---- Validation: 
scalar performance:
{'acc': 0.92105687, 'precision': 0.60136384, 'recall': 0.7488221, 'specificity': 0.7488221, 'f1': 0.6363201, 'auroc': 0.8403443, 'binary_precision': 0.21794872, 'binary_recall': 0.56478405, 'binary_specificity': 0.9328601, 'binary_f1_score': 0.31452358}
confusion matrix:
       0     1
0  16951  1220
1    262   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85109794, 'precision': 0.58039594, 'recall': 0.8015974, 'specificity': 0.8015974, 'f1': 0.59868, 'auroc': 0.8730185, 'binary_precision': 0.17254528, 'binary_recall': 0.74793386, 'binary_specificity': 0.85526097, 'binary_f1_score': 0.28040278}
confusion matrix:
      0    1
0  5129  868
1    61  181
early stop counter: 1
val acc:0.921056866645813, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 9,now: 2024-08-03 05:16:38.010017,epoch time: 0:19:03.184393,used: 2:51:40.242448,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95466864, 'precision': 0.95589626, 'recall': 0.9546731, 'specificity': 0.9546731, 'f1': 0.9546384, 'auroc': 0.9898608, 'binary_precision': 0.97959626, 'binary_recall': 0.9286964, 'binary_specificity': 0.9806498, 'binary_f1_score': 0.95346755}
confusion matrix:
       0      1
0  28583    564
1   2079  27078
---- Validation: 
scalar performance:
{'acc': 0.92904705, 'precision': 0.6108813, 'recall': 0.74491906, 'specificity': 0.74491906, 'f1': 0.6469306, 'auroc': 0.8435845, 'binary_precision': 0.23741007, 'binary_recall': 0.5481728, 'binary_specificity': 0.9416653, 'binary_f1_score': 0.3313253}
confusion matrix:
       0     1
0  17111  1060
1    272   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8693701, 'precision': 0.58977556, 'recall': 0.80515397, 'specificity': 0.80515397, 'f1': 0.6159672, 'auroc': 0.8791138, 'binary_precision': 0.19160387, 'binary_recall': 0.7355372, 'binary_specificity': 0.8747707, 'binary_f1_score': 0.30401364}
confusion matrix:
      0    1
0  5246  751
1    64  178
early stop counter: 2
val acc:0.9290470480918884, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 10,now: 2024-08-03 05:35:40.797081,epoch time: 0:19:02.787064,used: 3:10:43.029512,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95753294, 'precision': 0.958132, 'recall': 0.9575354, 'specificity': 0.9575354, 'f1': 0.95751923, 'auroc': 0.9905349, 'binary_precision': 0.9747331, 'binary_recall': 0.9394293, 'binary_specificity': 0.97564155, 'binary_f1_score': 0.95675564}
confusion matrix:
       0      1
0  28438    710
1   1766  27390
---- Validation: 
scalar performance:
{'acc': 0.92169607, 'precision': 0.6038733, 'recall': 0.7555766, 'specificity': 0.7555766, 'f1': 0.63989043, 'auroc': 0.8459326, 'binary_precision': 0.22250639, 'binary_recall': 0.5780731, 'binary_specificity': 0.9330802, 'binary_f1_score': 0.32132965}
confusion matrix:
       0     1
0  16955  1216
1    254   348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8533419, 'precision': 0.5827975, 'recall': 0.8087129, 'specificity': 0.8087129, 'f1': 0.6025474, 'auroc': 0.88262606, 'binary_precision': 0.17675312, 'binary_recall': 0.76033056, 'binary_specificity': 0.85709524, 'binary_f1_score': 0.28682774}
confusion matrix:
      0    1
0  5140  857
1    58  184
early stop counter: 3
val acc:0.9216960668563843, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 11,now: 2024-08-03 05:54:39.179063,epoch time: 0:18:58.381982,used: 3:29:41.411494,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9602257, 'precision': 0.96088946, 'recall': 0.96022964, 'specificity': 0.96022964, 'f1': 0.96021163, 'auroc': 0.99175847, 'binary_precision': 0.9784306, 'binary_recall': 0.9412168, 'binary_specificity': 0.97924244, 'binary_f1_score': 0.959463}
confusion matrix:
       0      1
0  28541    605
1   1714  27444
---- Validation: 
scalar performance:
{'acc': 0.9244127, 'precision': 0.6082629, 'recall': 0.7593891, 'specificity': 0.7593891, 'f1': 0.6454598, 'auroc': 0.85010356, 'binary_precision': 0.23107308, 'binary_recall': 0.58305645, 'binary_specificity': 0.93572176, 'binary_f1_score': 0.33097598}
confusion matrix:
       0     1
0  17003  1168
1    251   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8560667, 'precision': 0.58670175, 'recall': 0.8220267, 'specificity': 0.8220267, 'f1': 0.6085805, 'auroc': 0.8877393, 'binary_precision': 0.18339768, 'binary_recall': 0.78512394, 'binary_specificity': 0.85892946, 'binary_f1_score': 0.2973396}
confusion matrix:
      0    1
0  5151  846
1    52  190
early stop counter: 4
val acc:0.924412727355957, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 12,now: 2024-08-03 06:13:42.683415,epoch time: 0:19:03.504352,used: 3:48:44.915846,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9627298, 'precision': 0.96303976, 'recall': 0.9627325, 'specificity': 0.9627325, 'f1': 0.96272373, 'auroc': 0.9925767, 'binary_precision': 0.9750713, 'binary_recall': 0.9497565, 'binary_specificity': 0.9757085, 'binary_f1_score': 0.9622475}
confusion matrix:
       0      1
0  28438    708
1   1465  27693
---- Validation: 
scalar performance:
{'acc': 0.9099771, 'precision': 0.5926201, 'recall': 0.7599627, 'specificity': 0.7599627, 'f1': 0.62561756, 'auroc': 0.8469573, 'binary_precision': 0.19944751, 'binary_recall': 0.5996678, 'binary_specificity': 0.92025757, 'binary_f1_score': 0.29933664}
confusion matrix:
       0     1
0  16722  1449
1    241   361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82705563, 'precision': 0.5743971, 'recall': 0.8148668, 'specificity': 0.8148668, 'f1': 0.58324623, 'auroc': 0.8867257, 'binary_precision': 0.15836735, 'binary_recall': 0.8016529, 'binary_specificity': 0.8280807, 'binary_f1_score': 0.26448536}
confusion matrix:
      0     1
0  4966  1031
1    48   194
early stop counter: 5
val acc:0.9099770784378052, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 13,now: 2024-08-03 06:32:42.947795,epoch time: 0:19:00.264380,used: 4:07:45.180226,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96226674, 'precision': 0.9626658, 'recall': 0.96226877, 'specificity': 0.96226877, 'f1': 0.9622587, 'auroc': 0.9927057, 'binary_precision': 0.9762881, 'binary_recall': 0.947558, 'binary_specificity': 0.97697955, 'binary_f1_score': 0.9617085}
confusion matrix:
       0      1
0  28477    671
1   1529  27627
---- Validation: 
scalar performance:
{'acc': 0.920684, 'precision': 0.60211855, 'recall': 0.7534478, 'specificity': 0.7534478, 'f1': 0.63759094, 'auroc': 0.84830236, 'binary_precision': 0.21912603, 'binary_recall': 0.57475084, 'binary_specificity': 0.93214464, 'binary_f1_score': 0.31728566}
confusion matrix:
       0     1
0  16938  1233
1    256   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8454881, 'precision': 0.5815377, 'recall': 0.8185067, 'specificity': 0.8185067, 'f1': 0.5986033, 'auroc': 0.88955426, 'binary_precision': 0.17300725, 'binary_recall': 0.7892562, 'binary_specificity': 0.8477572, 'binary_f1_score': 0.28380385}
confusion matrix:
      0    1
0  5084  913
1    51  191
early stop counter: 6
val acc:0.9206839799880981, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 14,now: 2024-08-03 06:51:38.749308,epoch time: 0:18:55.801513,used: 4:26:40.981739,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96312433, 'precision': 0.96386933, 'recall': 0.9631298, 'specificity': 0.9631298, 'f1': 0.96310973, 'auroc': 0.99258256, 'binary_precision': 0.9825282, 'binary_recall': 0.9430384, 'binary_specificity': 0.98322123, 'binary_f1_score': 0.9623783}
confusion matrix:
       0      1
0  28655    489
1   1661  27499
---- Validation: 
scalar performance:
{'acc': 0.9150908, 'precision': 0.59863937, 'recall': 0.76421034, 'specificity': 0.76421034, 'f1': 0.6338402, 'auroc': 0.8536264, 'binary_precision': 0.2112922, 'binary_recall': 0.60299003, 'binary_specificity': 0.92543066, 'binary_f1_score': 0.31293103}
confusion matrix:
       0     1
0  16816  1355
1    239   363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8393973, 'precision': 0.5805481, 'recall': 0.8252522, 'specificity': 0.8252522, 'f1': 0.5954023, 'auroc': 0.89222157, 'binary_precision': 0.1701389, 'binary_recall': 0.80991733, 'binary_specificity': 0.84058696, 'binary_f1_score': 0.28120518}
confusion matrix:
      0    1
0  5041  956
1    46  196
early stop counter: 7
val acc:0.915090799331665, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 15,now: 2024-08-03 07:10:36.012257,epoch time: 0:18:57.262949,used: 4:45:38.244688,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9654569, 'precision': 0.9656118, 'recall': 0.9654585, 'specificity': 0.9654585, 'f1': 0.9654541, 'auroc': 0.993581, 'binary_precision': 0.97414666, 'binary_recall': 0.9563055, 'binary_specificity': 0.97461146, 'binary_f1_score': 0.9651436}
confusion matrix:
       0      1
0  28407    740
1   1274  27883
---- Validation: 
scalar performance:
{'acc': 0.901614, 'precision': 0.5872202, 'recall': 0.7668853, 'specificity': 0.7668853, 'f1': 0.61797315, 'auroc': 0.8546324, 'binary_precision': 0.18796992, 'binary_recall': 0.6229236, 'binary_specificity': 0.91084695, 'binary_f1_score': 0.28879476}
confusion matrix:
       0     1
0  16551  1620
1    227   375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8147139, 'precision': 0.57256705, 'recall': 0.8243089, 'specificity': 0.8243089, 'f1': 0.57654715, 'auroc': 0.8934984, 'binary_precision': 0.15326253, 'binary_recall': 0.8347107, 'binary_specificity': 0.81390697, 'binary_f1_score': 0.25897437}
confusion matrix:
      0     1
0  4881  1116
1    40   202
early stop counter: 8
val acc:0.9016140103340149, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 16,now: 2024-08-03 07:29:40.213874,epoch time: 0:19:04.201617,used: 5:04:42.446305,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96650314, 'precision': 0.967064, 'recall': 0.9665067, 'specificity': 0.9665067, 'f1': 0.96649325, 'auroc': 0.9942485, 'binary_precision': 0.98330075, 'binary_recall': 0.9491392, 'binary_specificity': 0.98387426, 'binary_f1_score': 0.96591806}
confusion matrix:
       0      1
0  28676    470
1   1483  27675
---- Validation: 
scalar performance:
{'acc': 0.9257977, 'precision': 0.6077852, 'recall': 0.75046796, 'specificity': 0.75046796, 'f1': 0.6440555, 'auroc': 0.8566202, 'binary_precision': 0.23076923, 'binary_recall': 0.5631229, 'binary_specificity': 0.937813, 'binary_f1_score': 0.3273781}
confusion matrix:
       0     1
0  17041  1130
1    263   339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8573489, 'precision': 0.588222, 'recall': 0.8266592, 'specificity': 0.8266592, 'f1': 0.6109885, 'auroc': 0.8930588, 'binary_precision': 0.18604651, 'binary_recall': 0.7933884, 'binary_specificity': 0.85993, 'binary_f1_score': 0.30141285}
confusion matrix:
      0    1
0  5157  840
1    50  192
early stop counter: 9
val acc:0.925797700881958, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 17,now: 2024-08-03 07:48:45.907460,epoch time: 0:19:05.693586,used: 5:23:48.139891,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96778953, 'precision': 0.9681369, 'recall': 0.9677914, 'specificity': 0.9677914, 'f1': 0.96778363, 'auroc': 0.9946079, 'binary_precision': 0.98092383, 'binary_recall': 0.9541432, 'binary_specificity': 0.98143953, 'binary_f1_score': 0.9673482}
confusion matrix:
       0      1
0  28607    541
1   1337  27819
---- Validation: 
scalar performance:
{'acc': 0.91786075, 'precision': 0.6023528, 'recall': 0.76724726, 'specificity': 0.76724726, 'f1': 0.63879395, 'auroc': 0.8605856, 'binary_precision': 0.21856287, 'binary_recall': 0.6063123, 'binary_specificity': 0.92818224, 'binary_f1_score': 0.32130283}
confusion matrix:
       0     1
0  16866  1305
1    237   365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8483731, 'precision': 0.58494395, 'recall': 0.8299211, 'specificity': 0.8299211, 'f1': 0.6040277, 'auroc': 0.8948207, 'binary_precision': 0.17883211, 'binary_recall': 0.80991733, 'binary_specificity': 0.849925, 'binary_f1_score': 0.2929746}
confusion matrix:
      0    1
0  5097  900
1    46  196
early stop counter: 10
val acc:0.917860746383667, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 18,now: 2024-08-03 08:07:44.449856,epoch time: 0:18:58.542396,used: 5:42:46.682287,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9695561, 'precision': 0.96958697, 'recall': 0.9695569, 'specificity': 0.9695569, 'f1': 0.9695557, 'auroc': 0.9948399, 'binary_precision': 0.9734431, 'binary_recall': 0.965464, 'binary_specificity': 0.9736499, 'binary_f1_score': 0.9694371}
confusion matrix:
       0      1
0  28378    768
1   1007  28151
---- Validation: 
scalar performance:
{'acc': 0.8838225, 'precision': 0.5790873, 'recall': 0.78339237, 'specificity': 0.78339237, 'f1': 0.60433114, 'auroc': 0.8659922, 'binary_precision': 0.1700794, 'binary_recall': 0.67607975, 'binary_specificity': 0.890705, 'binary_f1_score': 0.2717863}
confusion matrix:
       0     1
0  16185  1986
1    195   407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79019076, 'precision': 0.56551254, 'recall': 0.8175007, 'specificity': 0.8175007, 'f1': 0.55842257, 'auroc': 0.8973743, 'binary_precision': 0.13879485, 'binary_recall': 0.8471074, 'binary_specificity': 0.78789395, 'binary_f1_score': 0.23851076}
confusion matrix:
      0     1
0  4725  1272
1    37   205
early stop counter: 11
val acc:0.883822500705719, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 19,now: 2024-08-03 08:26:41.615842,epoch time: 0:18:57.165986,used: 6:01:43.848273,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9703451, 'precision': 0.9706809, 'recall': 0.9703474, 'specificity': 0.9703474, 'f1': 0.9703399, 'auroc': 0.99528086, 'binary_precision': 0.98329574, 'binary_recall': 0.95695716, 'binary_specificity': 0.9837376, 'binary_f1_score': 0.9699477}
confusion matrix:
       0      1
0  28673    474
1   1255  27902
---- Validation: 
scalar performance:
{'acc': 0.9206307, 'precision': 0.6046908, 'recall': 0.76385987, 'specificity': 0.76385987, 'f1': 0.6415084, 'auroc': 0.8655586, 'binary_precision': 0.22353673, 'binary_recall': 0.59634554, 'binary_specificity': 0.9313742, 'binary_f1_score': 0.32518116}
confusion matrix:
       0     1
0  16924  1247
1    243   359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8549447, 'precision': 0.58806115, 'recall': 0.83135676, 'specificity': 0.83135676, 'f1': 0.61011595, 'auroc': 0.8965585, 'binary_precision': 0.18518518, 'binary_recall': 0.8057851, 'binary_specificity': 0.85692847, 'binary_f1_score': 0.3011583}
confusion matrix:
      0    1
0  5139  858
1    47  195
early stop counter: 12
val acc:0.920630693435669, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 20,now: 2024-08-03 08:45:44.685663,epoch time: 0:19:03.069821,used: 6:20:46.918094,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_24_57_seed_2_24046975
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:20:46.918094 at 2024-08-03 08:45:44.685663
persisted model performance metric: 

scalar performance:
{'acc': 0.8724154, 'precision': 0.5861362, 'recall': 0.78096247, 'specificity': 0.78096247, 'f1': 0.61147654, 'auroc': 0.8639761, 'binary_precision': 0.18665159, 'binary_recall': 0.6818182, 'binary_specificity': 0.88010675, 'binary_f1_score': 0.29307282}
confusion matrix:
      0    1
0  5278  719
1    77  165
oracle model performance metric: 

scalar performance:
{'acc': 0.8724154, 'precision': 0.5861362, 'recall': 0.78096247, 'specificity': 0.78096247, 'f1': 0.61147654, 'auroc': 0.8639761, 'binary_precision': 0.18665159, 'binary_recall': 0.6818182, 'binary_specificity': 0.88010675, 'binary_f1_score': 0.29307282}
confusion matrix:
      0    1
0  5278  719
1    77  165
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |  17485 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |  17485 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   7827 MiB |   1433 TiB |   1433 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1412 TiB |   1412 TiB |
|       from small pool |  16481 KiB |     36 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  25074 MiB |  16562 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25002 MiB |  16528 MiB |
|       from small pool |     38 MiB |     44 MiB |     72 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40872 KiB | 732464 KiB |    787 TiB |    787 TiB |
|       from large pool |  31733 KiB | 730714 KiB |    765 TiB |    765 TiB |
|       from small pool |   9139 KiB |  23272 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7783    |  280478 K  |  280475 K  |
|       from large pool |      79    |     762    |  136426 K  |  136426 K  |
|       from small pool |    2887    |    7702    |  144051 K  |  144049 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7783    |  280478 K  |  280475 K  |
|       from large pool |      79    |     762    |  136426 K  |  136426 K  |
|       from small pool |    2887    |    7702    |  144051 K  |  144049 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |    1062    |     694    |
|       from large pool |     349    |     349    |    1026    |     677    |
|       from small pool |      19    |      22    |      36    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    3667    |  152966 K  |  152966 K  |
|       from large pool |      11    |     352    |   91531 K  |   91531 K  |
|       from small pool |      28    |    3657    |   61434 K  |   61434 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     36 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  25074 MiB |  24842 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25002 MiB |  24796 MiB |
|       from small pool |  26624 KiB |     44 MiB |     72 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |    787 TiB |    787 TiB |
|       from large pool |  30464 KiB | 730714 KiB |    765 TiB |    765 TiB |
|       from small pool |      0 KiB |  23278 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7783    |  280478 K  |  280478 K  |
|       from large pool |       2    |     762    |  136426 K  |  136426 K  |
|       from small pool |       0    |    7702    |  144051 K  |  144051 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7783    |  280478 K  |  280478 K  |
|       from large pool |       2    |     762    |  136426 K  |  136426 K  |
|       from small pool |       0    |    7702    |  144051 K  |  144051 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1062    |    1039    |
|       from large pool |      10    |     349    |    1026    |    1016    |
|       from small pool |      13    |      22    |      36    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3667    |  152967 K  |  152967 K  |
|       from large pool |       3    |     352    |   91531 K  |   91531 K  |
|       from small pool |       0    |    3657    |   61436 K  |   61436 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Aug  3 08:47:06 2024]
Finished job 0.
1 of 1 steps (100%) done
