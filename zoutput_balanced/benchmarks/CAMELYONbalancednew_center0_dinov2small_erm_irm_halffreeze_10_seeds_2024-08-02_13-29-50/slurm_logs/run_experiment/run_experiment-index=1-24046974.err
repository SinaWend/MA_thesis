Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  2 13:32:01 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974

 Experiment start at: 2024-08-02 13:41:28.369782
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.85803694, 'precision': 0.867741, 'recall': 0.85809076, 'specificity': 0.85809076, 'f1': 0.85710716, 'auroc': 0.910424, 'binary_precision': 0.9276442, 'binary_recall': 0.77685636, 'binary_specificity': 0.9393252, 'binary_f1_score': 0.84558064}
confusion matrix:
       0      1
0  26922   1739
1   6404  22295
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8927735, 'precision': 0.5318154, 'recall': 0.57846034, 'specificity': 0.57846034, 'f1': 0.5380924, 'auroc': 0.7414415, 'binary_precision': 0.0921522, 'binary_recall': 0.24105754, 'binary_specificity': 0.91586316, 'binary_f1_score': 0.13333333}
confusion matrix:
       0     1
0  16622  1527
1    488   155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89661235, 'precision': 0.55295366, 'recall': 0.60340995, 'specificity': 0.60340995, 'f1': 0.5654817, 'auroc': 0.7643062, 'binary_precision': 0.13857678, 'binary_recall': 0.2835249, 'binary_specificity': 0.92329496, 'binary_f1_score': 0.18616351}
confusion matrix:
      0    1
0  5537  460
1   187   74
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 14:04:09.581341,epoch time: 0:22:41.211559,used: 0:22:41.211559,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.89738494, 'precision': 0.90434337, 'recall': 0.8974307, 'specificity': 0.8974307, 'f1': 0.8969492, 'auroc': 0.95269006, 'binary_precision': 0.9575612, 'binary_recall': 0.831777, 'binary_specificity': 0.96308446, 'binary_f1_score': 0.89024806}
confusion matrix:
       0      1
0  27602   1058
1   4828  23872
---- Validation: 
scalar performance:
{'acc': 0.88016176, 'precision': 0.54473996, 'recall': 0.6334356, 'specificity': 0.6334356, 'f1': 0.554638, 'auroc': 0.7856325, 'binary_precision': 0.113778204, 'binary_recall': 0.36858475, 'binary_specificity': 0.8982864, 'binary_f1_score': 0.17388114}
confusion matrix:
       0     1
0  16303  1846
1    406   237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8894215, 'precision': 0.5756674, 'recall': 0.68028075, 'specificity': 0.68028075, 'f1': 0.5972967, 'auroc': 0.8271103, 'binary_precision': 0.17691155, 'binary_recall': 0.45210728, 'binary_specificity': 0.90845424, 'binary_f1_score': 0.25431034}
confusion matrix:
      0    1
0  5448  549
1   143  118
early stop counter: 1
val acc:0.8801617622375488, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 2,now: 2024-08-02 14:23:26.644973,epoch time: 0:19:17.063632,used: 0:41:58.275191,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9132497, 'precision': 0.919866, 'recall': 0.91330224, 'specificity': 0.91330224, 'f1': 0.9129138, 'auroc': 0.9697671, 'binary_precision': 0.9727823, 'binary_recall': 0.85043895, 'binary_specificity': 0.97616553, 'binary_f1_score': 0.90750587}
confusion matrix:
       0      1
0  27973    683
1   4293  24411
---- Validation: 
scalar performance:
{'acc': 0.88032144, 'precision': 0.56147707, 'recall': 0.6957728, 'specificity': 0.6957728, 'f1': 0.57835394, 'auroc': 0.8239709, 'binary_precision': 0.14247552, 'binary_recall': 0.4976672, 'binary_specificity': 0.89387846, 'binary_f1_score': 0.22152995}
confusion matrix:
       0     1
0  16223  1926
1    323   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.887504, 'precision': 0.5975163, 'recall': 0.76356757, 'specificity': 0.76356757, 'f1': 0.6282634, 'auroc': 0.86730915, 'binary_precision': 0.21271077, 'binary_recall': 0.62835246, 'binary_specificity': 0.89878273, 'binary_f1_score': 0.31782946}
confusion matrix:
      0    1
0  5390  607
1    97  164
early stop counter: 2
val acc:0.8803214430809021, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 3,now: 2024-08-02 14:43:15.185835,epoch time: 0:19:48.540862,used: 1:01:46.816053,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92395395, 'precision': 0.92905104, 'recall': 0.92399967, 'specificity': 0.92399967, 'f1': 0.923733, 'auroc': 0.97728837, 'binary_precision': 0.97602475, 'binary_recall': 0.869391, 'binary_specificity': 0.9786083, 'binary_f1_score': 0.9196271}
confusion matrix:
       0      1
0  28043    613
1   3749  24955
---- Validation: 
scalar performance:
{'acc': 0.8883035, 'precision': 0.575839, 'recall': 0.736658, 'specificity': 0.736658, 'f1': 0.59986293, 'auroc': 0.8489572, 'binary_precision': 0.16818596, 'binary_recall': 0.57387245, 'binary_specificity': 0.8994435, 'binary_f1_score': 0.26013395}
confusion matrix:
       0     1
0  16324  1825
1    274   369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8876638, 'precision': 0.6082049, 'recall': 0.80762696, 'specificity': 0.80762696, 'f1': 0.6435018, 'auroc': 0.8896955, 'binary_precision': 0.22982885, 'binary_recall': 0.7203065, 'binary_specificity': 0.89494747, 'binary_f1_score': 0.3484708}
confusion matrix:
      0    1
0  5367  630
1    73  188
early stop counter: 3
val acc:0.8883035182952881, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 4,now: 2024-08-02 15:01:43.491213,epoch time: 0:18:28.305378,used: 1:20:15.121431,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9329324, 'precision': 0.9362395, 'recall': 0.93296736, 'specificity': 0.93296736, 'f1': 0.93280864, 'auroc': 0.9803177, 'binary_precision': 0.9744236, 'binary_recall': 0.8893147, 'binary_specificity': 0.97662, 'binary_f1_score': 0.92992586}
confusion matrix:
       0      1
0  27987    670
1   3177  25526
---- Validation: 
scalar performance:
{'acc': 0.88463175, 'precision': 0.5805048, 'recall': 0.7662594, 'specificity': 0.7662594, 'f1': 0.60612327, 'auroc': 0.8622801, 'binary_precision': 0.17511716, 'binary_recall': 0.63919127, 'binary_specificity': 0.8933275, 'binary_f1_score': 0.27491638}
confusion matrix:
       0     1
0  16213  1936
1    232   411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88079256, 'precision': 0.6089095, 'recall': 0.83335924, 'specificity': 0.83335924, 'f1': 0.6439477, 'auroc': 0.9023471, 'binary_precision': 0.22844344, 'binary_recall': 0.7816092, 'binary_specificity': 0.88510925, 'binary_f1_score': 0.35355282}
confusion matrix:
      0    1
0  5308  689
1    57  204
early stop counter: 4
val acc:0.8846317529678345, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 5,now: 2024-08-02 15:20:30.241942,epoch time: 0:18:46.750729,used: 1:39:01.872160,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93711644, 'precision': 0.9402839, 'recall': 0.937152, 'specificity': 0.937152, 'f1': 0.9370067, 'auroc': 0.98250365, 'binary_precision': 0.97783786, 'binary_recall': 0.894614, 'binary_specificity': 0.97969013, 'binary_f1_score': 0.9343765}
confusion matrix:
       0      1
0  28074    582
1   3025  25679
---- Validation: 
scalar performance:
{'acc': 0.8864943, 'precision': 0.5838549, 'recall': 0.77622426, 'specificity': 0.77622426, 'f1': 0.6111747, 'auroc': 0.8689057, 'binary_precision': 0.18107876, 'binary_recall': 0.6578538, 'binary_specificity': 0.8945947, 'binary_f1_score': 0.2839879}
confusion matrix:
       0     1
0  16236  1913
1    220   423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88271016, 'precision': 0.6124395, 'recall': 0.84352136, 'specificity': 0.84352136, 'f1': 0.6491287, 'auroc': 0.9104239, 'binary_precision': 0.2345679, 'binary_recall': 0.8007663, 'binary_specificity': 0.8862765, 'binary_f1_score': 0.3628472}
confusion matrix:
      0    1
0  5315  682
1    52  209
early stop counter: 5
val acc:0.8864942789077759, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 6,now: 2024-08-02 15:39:55.559046,epoch time: 0:19:25.317104,used: 1:58:27.189264,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94341004, 'precision': 0.9457452, 'recall': 0.9434391, 'specificity': 0.9434391, 'f1': 0.9433384, 'auroc': 0.98498666, 'binary_precision': 0.97820944, 'binary_recall': 0.9071177, 'binary_specificity': 0.9797606, 'binary_f1_score': 0.9413232}
confusion matrix:
       0      1
0  28077    580
1   2666  26037
---- Validation: 
scalar performance:
{'acc': 0.8803746, 'precision': 0.58373743, 'recall': 0.7925575, 'specificity': 0.7925575, 'f1': 0.61008257, 'auroc': 0.87739813, 'binary_precision': 0.17938474, 'binary_recall': 0.6982893, 'binary_specificity': 0.88682574, 'binary_f1_score': 0.28544185}
confusion matrix:
       0     1
0  16095  2054
1    194   449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8702461, 'precision': 0.6048436, 'recall': 0.84617984, 'specificity': 0.84617984, 'f1': 0.636575, 'auroc': 0.9154463, 'binary_precision': 0.2185904, 'binary_recall': 0.8199234, 'binary_specificity': 0.8724362, 'binary_f1_score': 0.3451613}
confusion matrix:
      0    1
0  5232  765
1    47  214
early stop counter: 6
val acc:0.8803746104240417, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 7,now: 2024-08-02 15:58:23.990417,epoch time: 0:18:28.431371,used: 2:16:55.620635,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9479254, 'precision': 0.9495816, 'recall': 0.9479498, 'specificity': 0.9479498, 'f1': 0.9478793, 'auroc': 0.98636293, 'binary_precision': 0.97707033, 'binary_recall': 0.9174651, 'binary_specificity': 0.97843456, 'binary_f1_score': 0.9463301}
confusion matrix:
       0      1
0  28039    618
1   2369  26334
---- Validation: 
scalar performance:
{'acc': 0.87478715, 'precision': 0.58209836, 'recall': 0.79941547, 'specificity': 0.79941547, 'f1': 0.60668933, 'auroc': 0.8788296, 'binary_precision': 0.17539863, 'binary_recall': 0.718507, 'binary_specificity': 0.880324, 'binary_f1_score': 0.2819652}
confusion matrix:
       0     1
0  15977  2172
1    181   462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.858581, 'precision': 0.597197, 'recall': 0.84009343, 'specificity': 0.84009343, 'f1': 0.62348723, 'auroc': 0.91830915, 'binary_precision': 0.20342205, 'binary_recall': 0.8199234, 'binary_specificity': 0.86026347, 'binary_f1_score': 0.32597107}
confusion matrix:
      0    1
0  5159  838
1    47  214
early stop counter: 7
val acc:0.8747871518135071, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 8,now: 2024-08-02 16:16:39.908937,epoch time: 0:18:15.918520,used: 2:35:11.539155,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94811714, 'precision': 0.94979346, 'recall': 0.9481439, 'specificity': 0.9481439, 'f1': 0.9480709, 'auroc': 0.98696315, 'binary_precision': 0.97747093, 'binary_recall': 0.9174708, 'binary_specificity': 0.978817, 'binary_f1_score': 0.9465209}
confusion matrix:
       0      1
0  28048    607
1   2369  26336
---- Validation: 
scalar performance:
{'acc': 0.88080037, 'precision': 0.58622384, 'recall': 0.8032787, 'specificity': 0.8032787, 'f1': 0.6137002, 'auroc': 0.8831184, 'binary_precision': 0.18351169, 'binary_recall': 0.7200622, 'binary_specificity': 0.8864951, 'binary_f1_score': 0.29248264}
confusion matrix:
       0     1
0  16089  2060
1    180   463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86721, 'precision': 0.6031257, 'recall': 0.84642804, 'specificity': 0.84642804, 'f1': 0.6335827, 'auroc': 0.9188198, 'binary_precision': 0.215, 'binary_recall': 0.8237548, 'binary_specificity': 0.8691012, 'binary_f1_score': 0.34099922}
confusion matrix:
      0    1
0  5212  785
1    46  215
early stop counter: 8
val acc:0.8808003664016724, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 9,now: 2024-08-02 16:34:57.786209,epoch time: 0:18:17.877272,used: 2:53:29.416427,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95245814, 'precision': 0.9535899, 'recall': 0.9524783, 'specificity': 0.9524783, 'f1': 0.9524299, 'auroc': 0.9882941, 'binary_precision': 0.976449, 'binary_recall': 0.9273595, 'binary_specificity': 0.9775971, 'binary_f1_score': 0.95127136}
confusion matrix:
       0      1
0  28015    642
1   2085  26618
---- Validation: 
scalar performance:
{'acc': 0.8722861, 'precision': 0.58326274, 'recall': 0.81162167, 'specificity': 0.81162167, 'f1': 0.60779405, 'auroc': 0.8862629, 'binary_precision': 0.17666544, 'binary_recall': 0.7465008, 'binary_specificity': 0.87674254, 'binary_f1_score': 0.2857143}
confusion matrix:
       0     1
0  15912  2237
1    163   480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85027164, 'precision': 0.5945795, 'recall': 0.8467519, 'specificity': 0.8467519, 'f1': 0.61770815, 'auroc': 0.9224823, 'binary_precision': 0.19713262, 'binary_recall': 0.8429119, 'binary_specificity': 0.85059196, 'binary_f1_score': 0.3195352}
confusion matrix:
      0    1
0  5101  896
1    41  220
early stop counter: 9
val acc:0.8722860813140869, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 10,now: 2024-08-02 16:53:07.188102,epoch time: 0:18:09.401893,used: 3:11:38.818320,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9525279, 'precision': 0.95337415, 'recall': 0.95254457, 'specificity': 0.95254457, 'f1': 0.95250696, 'auroc': 0.98901176, 'binary_precision': 0.9731541, 'binary_recall': 0.9308062, 'binary_specificity': 0.9742829, 'binary_f1_score': 0.95150924}
confusion matrix:
       0      1
0  27921    737
1   1986  26716
---- Validation: 
scalar performance:
{'acc': 0.8607918, 'precision': 0.5782806, 'recall': 0.8139215, 'specificity': 0.8139215, 'f1': 0.59797823, 'auroc': 0.8854476, 'binary_precision': 0.16615905, 'binary_recall': 0.7636081, 'binary_specificity': 0.8642349, 'binary_f1_score': 0.2729294}
confusion matrix:
       0     1
0  15685  2464
1    152   491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83700866, 'precision': 0.58769095, 'recall': 0.8398318, 'specificity': 0.8398318, 'f1': 0.6045561, 'auroc': 0.9225296, 'binary_precision': 0.18348624, 'binary_recall': 0.8429119, 'binary_specificity': 0.8367517, 'binary_f1_score': 0.30136985}
confusion matrix:
      0    1
0  5018  979
1    41  220
early stop counter: 10
val acc:0.860791802406311, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 11,now: 2024-08-02 17:11:21.740164,epoch time: 0:18:14.552062,used: 3:29:53.370382,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95575315, 'precision': 0.95655835, 'recall': 0.9557686, 'specificity': 0.9557686, 'f1': 0.9557347, 'auroc': 0.9899229, 'binary_precision': 0.9759159, 'binary_recall': 0.9346364, 'binary_specificity': 0.9769008, 'binary_f1_score': 0.9548302}
confusion matrix:
       0      1
0  27997    662
1   1876  26825
---- Validation: 
scalar performance:
{'acc': 0.86696464, 'precision': 0.58214724, 'recall': 0.8193674, 'specificity': 0.8193674, 'f1': 0.60496724, 'auroc': 0.89050645, 'binary_precision': 0.17363796, 'binary_recall': 0.7682737, 'binary_specificity': 0.87046117, 'binary_f1_score': 0.2832569}
confusion matrix:
       0     1
0  15798  2351
1    149   494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8446788, 'precision': 0.59155494, 'recall': 0.8438338, 'specificity': 0.8438338, 'f1': 0.6120393, 'auroc': 0.92475617, 'binary_precision': 0.19113813, 'binary_recall': 0.8429119, 'binary_specificity': 0.8447557, 'binary_f1_score': 0.31161472}
confusion matrix:
      0    1
0  5066  931
1    41  220
early stop counter: 11
val acc:0.8669646382331848, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 12,now: 2024-08-02 17:29:50.187135,epoch time: 0:18:28.446971,used: 3:48:21.817353,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9578452, 'precision': 0.95862085, 'recall': 0.9578618, 'specificity': 0.9578618, 'f1': 0.9578284, 'auroc': 0.99085844, 'binary_precision': 0.9776833, 'binary_recall': 0.9371494, 'binary_specificity': 0.97857416, 'binary_f1_score': 0.9569873}
confusion matrix:
       0      1
0  28043    614
1   1804  26899
---- Validation: 
scalar performance:
{'acc': 0.8557365, 'precision': 0.57736176, 'recall': 0.820305, 'specificity': 0.820305, 'f1': 0.5953, 'auroc': 0.88689566, 'binary_precision': 0.16363046, 'binary_recall': 0.7822706, 'binary_specificity': 0.8583393, 'binary_f1_score': 0.2706484}
confusion matrix:
       0     1
0  15578  2571
1    140   503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8269415, 'precision': 0.58377147, 'recall': 0.83824384, 'specificity': 0.83824384, 'f1': 0.5961065, 'auroc': 0.9268745, 'binary_precision': 0.17535545, 'binary_recall': 0.85057473, 'binary_specificity': 0.82591295, 'binary_f1_score': 0.2907662}
confusion matrix:
      0     1
0  4953  1044
1    39   222
early stop counter: 12
val acc:0.855736494064331, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 13,now: 2024-08-02 17:47:57.942492,epoch time: 0:18:07.755357,used: 4:06:29.572710,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9592922, 'precision': 0.9597113, 'recall': 0.9593049, 'specificity': 0.9593049, 'f1': 0.9592837, 'auroc': 0.9916105, 'binary_precision': 0.97380245, 'binary_recall': 0.9440496, 'binary_specificity': 0.9745603, 'binary_f1_score': 0.95869523}
confusion matrix:
       0      1
0  27927    729
1   1606  27098
---- Validation: 
scalar performance:
{'acc': 0.84248614, 'precision': 0.57184124, 'recall': 0.8171953, 'specificity': 0.8171953, 'f1': 0.58372945, 'auroc': 0.885556, 'binary_precision': 0.15241525, 'binary_recall': 0.79004663, 'binary_specificity': 0.844344, 'binary_f1_score': 0.25553322}
confusion matrix:
       0     1
0  15324  2825
1    135   508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8076063, 'precision': 0.57706106, 'recall': 0.83365244, 'specificity': 0.83365244, 'f1': 0.58061135, 'auroc': 0.9265357, 'binary_precision': 0.1615219, 'binary_recall': 0.86206895, 'binary_specificity': 0.8052359, 'binary_f1_score': 0.27206773}
confusion matrix:
      0     1
0  4829  1168
1    36   225
early stop counter: 13
val acc:0.8424861431121826, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 14,now: 2024-08-02 18:06:12.213700,epoch time: 0:18:14.271208,used: 4:24:43.843918,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96053, 'precision': 0.9613992, 'recall': 0.9605452, 'specificity': 0.9605452, 'f1': 0.9605123, 'auroc': 0.9920064, 'binary_precision': 0.9816002, 'binary_recall': 0.9387108, 'binary_specificity': 0.9823796, 'binary_f1_score': 0.9596766}
confusion matrix:
       0      1
0  28155    505
1   1759  26941
---- Validation: 
scalar performance:
{'acc': 0.86041933, 'precision': 0.57765007, 'recall': 0.8114785, 'specificity': 0.8114785, 'f1': 0.5970026, 'auroc': 0.88457954, 'binary_precision': 0.16508795, 'binary_recall': 0.7589425, 'binary_specificity': 0.86401457, 'binary_f1_score': 0.27118644}
confusion matrix:
       0     1
0  15681  2468
1    155   488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83636945, 'precision': 0.58882, 'recall': 0.8468276, 'specificity': 0.8468276, 'f1': 0.6058139, 'auroc': 0.927228, 'binary_precision': 0.1849711, 'binary_recall': 0.85823756, 'binary_specificity': 0.8354177, 'binary_f1_score': 0.30434784}
confusion matrix:
      0    1
0  5010  987
1    37  224
early stop counter: 14
val acc:0.8604193329811096, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 15,now: 2024-08-02 18:24:37.383310,epoch time: 0:18:25.169610,used: 4:43:09.013528,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96190727, 'precision': 0.96266985, 'recall': 0.96192366, 'specificity': 0.96192366, 'f1': 0.96189255, 'auroc': 0.99273646, 'binary_precision': 0.98165506, 'binary_recall': 0.94146955, 'binary_specificity': 0.98237777, 'binary_f1_score': 0.9611425}
confusion matrix:
       0      1
0  28152    505
1   1680  27023
---- Validation: 
scalar performance:
{'acc': 0.86760324, 'precision': 0.5806114, 'recall': 0.8099474, 'specificity': 0.8099474, 'f1': 0.6029757, 'auroc': 0.8799896, 'binary_precision': 0.17135732, 'binary_recall': 0.748056, 'binary_specificity': 0.8718387, 'binary_f1_score': 0.27884057}
confusion matrix:
       0     1
0  15823  2326
1    162   481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8434004, 'precision': 0.59015906, 'recall': 0.8395021, 'specificity': 0.8395021, 'f1': 0.60981065, 'auroc': 0.92668104, 'binary_precision': 0.18874459, 'binary_recall': 0.83524907, 'binary_specificity': 0.8437552, 'binary_f1_score': 0.3079096}
confusion matrix:
      0    1
0  5060  937
1    43  218
early stop counter: 15
val acc:0.8676032423973083, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 16,now: 2024-08-02 18:42:43.564952,epoch time: 0:18:06.181642,used: 5:01:15.195170,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9661611, 'precision': 0.9663284, 'recall': 0.9661695, 'specificity': 0.9661695, 'f1': 0.96615845, 'auroc': 0.993718, 'binary_precision': 0.9753819, 'binary_recall': 0.95652324, 'binary_specificity': 0.9758157, 'binary_f1_score': 0.96586055}
confusion matrix:
       0      1
0  27962    693
1   1248  27457
---- Validation: 
scalar performance:
{'acc': 0.845679, 'precision': 0.57229316, 'recall': 0.8135979, 'specificity': 0.8135979, 'f1': 0.585346, 'auroc': 0.88492334, 'binary_precision': 0.15372814, 'binary_recall': 0.7791602, 'binary_specificity': 0.8480357, 'binary_f1_score': 0.2567914}
confusion matrix:
       0     1
0  15391  2758
1    142   501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8203899, 'precision': 0.58308834, 'recall': 0.8458195, 'specificity': 0.8458195, 'f1': 0.59291387, 'auroc': 0.9301592, 'binary_precision': 0.17285822, 'binary_recall': 0.87356323, 'binary_specificity': 0.8180757, 'binary_f1_score': 0.2886076}
confusion matrix:
      0     1
0  4906  1091
1    33   228
early stop counter: 16
val acc:0.845678985118866, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 17,now: 2024-08-02 19:01:12.772343,epoch time: 0:18:29.207391,used: 5:19:44.402561,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96488845, 'precision': 0.9653845, 'recall': 0.9649028, 'specificity': 0.9649028, 'f1': 0.9648798, 'auroc': 0.9941753, 'binary_precision': 0.98079765, 'binary_recall': 0.9484062, 'binary_specificity': 0.9813994, 'binary_f1_score': 0.96433}
confusion matrix:
       0      1
0  28122    533
1   1481  27224
---- Validation: 
scalar performance:
{'acc': 0.8627607, 'precision': 0.5797783, 'recall': 0.817191, 'specificity': 0.817191, 'f1': 0.6005842, 'auroc': 0.8818693, 'binary_precision': 0.16894665, 'binary_recall': 0.7682737, 'binary_specificity': 0.8661083, 'binary_f1_score': 0.2769835}
confusion matrix:
       0     1
0  15719  2430
1    149   494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.839086, 'precision': 0.5908654, 'recall': 0.85190964, 'specificity': 0.85190964, 'f1': 0.60936385, 'auroc': 0.92943275, 'binary_precision': 0.18864775, 'binary_recall': 0.8659004, 'binary_specificity': 0.83791894, 'binary_f1_score': 0.30980125}
confusion matrix:
      0    1
0  5025  972
1    35  226
early stop counter: 17
val acc:0.8627607226371765, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 18,now: 2024-08-02 19:19:28.323370,epoch time: 0:18:15.551027,used: 5:37:59.953588,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9669979, 'precision': 0.9674749, 'recall': 0.9670086, 'specificity': 0.9670086, 'f1': 0.96699, 'auroc': 0.9944066, 'binary_precision': 0.9825736, 'binary_recall': 0.9509042, 'binary_specificity': 0.98311293, 'binary_f1_score': 0.96647954}
confusion matrix:
       0      1
0  28177    484
1   1409  27290
---- Validation: 
scalar performance:
{'acc': 0.88085353, 'precision': 0.5884192, 'recall': 0.813807, 'specificity': 0.813807, 'f1': 0.6168372, 'auroc': 0.8820303, 'binary_precision': 0.18705882, 'binary_recall': 0.7418352, 'binary_specificity': 0.88577884, 'binary_f1_score': 0.29877856}
confusion matrix:
       0     1
0  16076  2073
1    166   477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8665708, 'precision': 0.6041985, 'recall': 0.85342383, 'specificity': 0.85342383, 'f1': 0.6349004, 'auroc': 0.92990947, 'binary_precision': 0.21640316, 'binary_recall': 0.83908045, 'binary_specificity': 0.8677672, 'binary_f1_score': 0.34406915}
confusion matrix:
      0    1
0  5204  793
1    42  219
early stop counter: 18
val acc:0.880853533744812, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 19,now: 2024-08-02 19:37:27.765508,epoch time: 0:17:59.442138,used: 5:55:59.395726,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9684449, 'precision': 0.9686879, 'recall': 0.9684526, 'specificity': 0.9684526, 'f1': 0.9684412, 'auroc': 0.994406, 'binary_precision': 0.97952706, 'binary_recall': 0.9569323, 'binary_specificity': 0.9799728, 'binary_f1_score': 0.9680979}
confusion matrix:
       0      1
0  28087    574
1   1236  27463
---- Validation: 
scalar performance:
{'acc': 0.86552787, 'precision': 0.5798653, 'recall': 0.811123, 'specificity': 0.811123, 'f1': 0.6014188, 'auroc': 0.88245517, 'binary_precision': 0.16970547, 'binary_recall': 0.7527216, 'binary_specificity': 0.8695245, 'binary_f1_score': 0.27696708}
confusion matrix:
       0     1
0  15781  2368
1    159   484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84739536, 'precision': 0.5948194, 'recall': 0.8544128, 'specificity': 0.8544128, 'f1': 0.61716694, 'auroc': 0.92929995, 'binary_precision': 0.19667833, 'binary_recall': 0.86206895, 'binary_specificity': 0.8467567, 'binary_f1_score': 0.32028472}
confusion matrix:
      0    1
0  5078  919
1    36  225
early stop counter: 19
val acc:0.865527868270874, best validation acc: 0.8927735090255737, corresponding to test acc:                         0.8966123461723328 / 0.8966123461723328
after epoch: 20,now: 2024-08-02 19:55:43.432074,epoch time: 0:18:15.666566,used: 6:14:15.062292,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_41_28_seed_0_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:14:15.062292 at 2024-08-02 19:55:43.432074
persisted model performance metric: 

scalar performance:
{'acc': 0.89661235, 'precision': 0.55295366, 'recall': 0.60340995, 'specificity': 0.60340995, 'f1': 0.5654817, 'auroc': 0.7643062, 'binary_precision': 0.13857678, 'binary_recall': 0.2835249, 'binary_specificity': 0.92329496, 'binary_f1_score': 0.18616351}
confusion matrix:
      0    1
0  5537  460
1   187   74
oracle model performance metric: 

scalar performance:
{'acc': 0.89661235, 'precision': 0.55295366, 'recall': 0.60340995, 'specificity': 0.60340995, 'f1': 0.5654817, 'auroc': 0.7643062, 'binary_precision': 0.13857678, 'binary_recall': 0.2835249, 'binary_specificity': 0.92329496, 'binary_f1_score': 0.18616351}
confusion matrix:
      0    1
0  5537  460
1   187   74
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 198153 KiB |   7828 MiB | 478504 GiB | 478504 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |  17491 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 198153 KiB |   7828 MiB | 478504 GiB | 478504 GiB |
|       from large pool | 180662 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |  17491 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195461 KiB |   7827 MiB | 478478 GiB | 478477 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 471273 GiB | 471273 GiB |
|       from small pool |  16482 KiB |     36 MiB |   7204 GiB |   7204 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  59895 KiB | 732464 KiB | 269417 GiB | 269417 GiB |
|       from large pool |  50762 KiB | 730714 KiB | 262193 GiB | 262193 GiB |
|       from small pool |   9133 KiB |  11093 KiB |   7223 GiB |   7223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2978    |    7665    |   92081 K  |   92078 K  |
|       from large pool |      79    |     762    |   44500 K  |   44500 K  |
|       from small pool |    2899    |    7584    |   47580 K  |   47577 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2978    |    7665    |   92081 K  |   92078 K  |
|       from large pool |      79    |     762    |   44500 K  |   44500 K  |
|       from small pool |    2899    |    7584    |   47580 K  |   47577 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3606    |   53673 K  |   53673 K  |
|       from large pool |      10    |     350    |   33590 K  |   33590 K  |
|       from small pool |      24    |    3596    |   20082 K  |   20082 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 478504 GiB | 478504 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 478504 GiB | 478504 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 478478 GiB | 478478 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 471273 GiB | 471273 GiB |
|       from small pool |      0 KiB |     36 MiB |   7204 GiB |   7204 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 269417 GiB | 269417 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 262193 GiB | 262193 GiB |
|       from small pool |      0 KiB |  23272 KiB |   7223 GiB |   7223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7665    |   92081 K  |   92081 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47580 K  |   47580 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7665    |   92081 K  |   92081 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47580 K  |   47580 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3606    |   53674 K  |   53674 K  |
|       from large pool |       3    |     350    |   33590 K  |   33590 K  |
|       from small pool |       0    |    3596    |   20084 K  |   20084 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 478504 GiB | 478504 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 478504 GiB | 478504 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 471283 GiB | 471283 GiB |
|       from small pool |      0 KiB |     37 MiB |   7221 GiB |   7221 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 478478 GiB | 478478 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 471273 GiB | 471273 GiB |
|       from small pool |      0 KiB |     36 MiB |   7204 GiB |   7204 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 258048 KiB |   8530 MiB |   8530 MiB |   8278 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  26624 KiB |     44 MiB |     44 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 269417 GiB | 269417 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 262193 GiB | 262193 GiB |
|       from small pool |      0 KiB |  23272 KiB |   7223 GiB |   7223 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7665    |   92081 K  |   92081 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47580 K  |   47580 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7665    |   92081 K  |   92081 K  |
|       from large pool |       2    |     762    |   44500 K  |   44500 K  |
|       from small pool |       0    |    7584    |   47580 K  |   47580 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     371    |     371    |     347    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      13    |      22    |      22    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3606    |   53674 K  |   53674 K  |
|       from large pool |       3    |     350    |   33590 K  |   33590 K  |
|       from small pool |       0    |    3596    |   20084 K  |   20084 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974

 Experiment start at: 2024-08-02 20:05:06.208345
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8321126, 'precision': 0.83252573, 'recall': 0.832126, 'specificity': 0.832126, 'f1': 0.83206433, 'auroc': 0.90070236, 'binary_precision': 0.84443885, 'binary_recall': 0.8145335, 'binary_specificity': 0.84971863, 'binary_f1_score': 0.82921666}
confusion matrix:
       0      1
0  24460   4326
1   5347  23483
---- Validation: 
scalar performance:
{'acc': 0.87251866, 'precision': 0.50509053, 'recall': 0.5133078, 'specificity': 0.5133078, 'f1': 0.4990103, 'auroc': 0.7284076, 'binary_precision': 0.045068927, 'binary_recall': 0.12630014, 'binary_specificity': 0.90031546, 'binary_f1_score': 0.06643219}
confusion matrix:
       0     1
0  16266  1801
1    588    85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9020303, 'precision': 0.5307415, 'recall': 0.5498131, 'specificity': 0.5498131, 'f1': 0.5360167, 'auroc': 0.7930936, 'binary_precision': 0.09907834, 'binary_recall': 0.16538462, 'binary_specificity': 0.93424153, 'binary_f1_score': 0.123919316}
confusion matrix:
      0    1
0  5555  391
1   217   43
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 20:23:49.540108,epoch time: 0:18:43.331763,used: 0:18:43.331763,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.88928425, 'precision': 0.8936846, 'recall': 0.88932097, 'specificity': 0.88932097, 'f1': 0.88898057, 'auroc': 0.94493955, 'binary_precision': 0.9354801, 'binary_recall': 0.83640903, 'binary_specificity': 0.94223285, 'binary_f1_score': 0.88317484}
confusion matrix:
       0      1
0  27125   1663
1   4716  24112
---- Validation: 
scalar performance:
{'acc': 0.89130205, 'precision': 0.5255842, 'recall': 0.5588127, 'specificity': 0.5588127, 'f1': 0.5295607, 'auroc': 0.7772621, 'binary_precision': 0.08261934, 'binary_recall': 0.20059435, 'binary_specificity': 0.91703105, 'binary_f1_score': 0.11703511}
confusion matrix:
       0     1
0  16568  1499
1    538   135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90976477, 'precision': 0.5513164, 'recall': 0.5795952, 'specificity': 0.5795952, 'f1': 0.5607156, 'auroc': 0.8331406, 'binary_precision': 0.13768116, 'binary_recall': 0.21923077, 'binary_specificity': 0.93995965, 'binary_f1_score': 0.16913947}
confusion matrix:
      0    1
0  5589  357
1   203   57
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 20:41:46.719835,epoch time: 0:17:57.179727,used: 0:36:40.511490,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.90917456, 'precision': 0.91335374, 'recall': 0.9092113, 'specificity': 0.9092113, 'f1': 0.9089497, 'auroc': 0.96209896, 'binary_precision': 0.9550995, 'binary_recall': 0.8588574, 'binary_specificity': 0.9595651, 'binary_f1_score': 0.90442526}
confusion matrix:
       0      1
0  27623   1164
1   4069  24760
---- Validation: 
scalar performance:
{'acc': 0.9002668, 'precision': 0.5564791, 'recall': 0.63141245, 'specificity': 0.63141245, 'f1': 0.57216954, 'auroc': 0.8101125, 'binary_precision': 0.1388889, 'binary_recall': 0.34175333, 'binary_specificity': 0.9210716, 'binary_f1_score': 0.19750966}
confusion matrix:
       0     1
0  16641  1426
1    443   230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91411537, 'precision': 0.58456284, 'recall': 0.6425522, 'specificity': 0.6425522, 'f1': 0.6034475, 'auroc': 0.8612125, 'binary_precision': 0.1986755, 'binary_recall': 0.34615386, 'binary_specificity': 0.93895054, 'binary_f1_score': 0.2524544}
confusion matrix:
      0    1
0  5583  363
1   170   90
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-02 21:00:33.677021,epoch time: 0:18:46.957186,used: 0:55:27.468676,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9204214, 'precision': 0.92432857, 'recall': 0.9204564, 'specificity': 0.9204564, 'f1': 0.9202422, 'auroc': 0.97068894, 'binary_precision': 0.96522874, 'binary_recall': 0.87238544, 'binary_specificity': 0.96852744, 'binary_f1_score': 0.9164617}
confusion matrix:
       0      1
0  27881    906
1   3679  25150
---- Validation: 
scalar performance:
{'acc': 0.90149415, 'precision': 0.5736104, 'recall': 0.6821177, 'specificity': 0.6821177, 'f1': 0.59630334, 'auroc': 0.83399, 'binary_precision': 0.16920474, 'binary_recall': 0.44576523, 'binary_specificity': 0.91847014, 'binary_f1_score': 0.24529845}
confusion matrix:
       0     1
0  16594  1473
1    373   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9168547, 'precision': 0.6162229, 'recall': 0.72305816, 'specificity': 0.72305816, 'f1': 0.6478927, 'auroc': 0.87952095, 'binary_precision': 0.25478926, 'binary_recall': 0.51153845, 'binary_specificity': 0.9345779, 'binary_f1_score': 0.3401534}
confusion matrix:
      0    1
0  5557  389
1   127  133
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-08-02 21:19:27.368254,epoch time: 0:18:53.691233,used: 1:14:21.159909,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9310782, 'precision': 0.93445694, 'recall': 0.93110883, 'specificity': 0.93110883, 'f1': 0.93094724, 'auroc': 0.97775555, 'binary_precision': 0.9729442, 'binary_recall': 0.8869155, 'binary_specificity': 0.9753022, 'binary_f1_score': 0.9279402}
confusion matrix:
       0      1
0  28077    711
1   3260  25568
---- Validation: 
scalar performance:
{'acc': 0.910619, 'precision': 0.5941429, 'recall': 0.7254745, 'specificity': 0.7254745, 'f1': 0.6246898, 'auroc': 0.84981275, 'binary_precision': 0.20701754, 'binary_recall': 0.52600294, 'binary_specificity': 0.924946, 'binary_f1_score': 0.29710448}
confusion matrix:
       0     1
0  16711  1356
1    319   354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.918466, 'precision': 0.62863445, 'recall': 0.75883985, 'specificity': 0.75883985, 'f1': 0.66584766, 'auroc': 0.89244163, 'binary_precision': 0.27636364, 'binary_recall': 0.5846154, 'binary_specificity': 0.9330642, 'binary_f1_score': 0.37530863}
confusion matrix:
      0    1
0  5548  398
1   108  152
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-02 21:38:24.408692,epoch time: 0:18:57.040438,used: 1:33:18.200347,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93421966, 'precision': 0.9381411, 'recall': 0.93425256, 'specificity': 0.93425256, 'f1': 0.93407553, 'auroc': 0.98154294, 'binary_precision': 0.9797655, 'binary_recall': 0.8868461, 'binary_specificity': 0.981659, 'binary_f1_score': 0.930993}
confusion matrix:
       0      1
0  28260    528
1   3262  25566
---- Validation: 
scalar performance:
{'acc': 0.9226254, 'precision': 0.6078837, 'recall': 0.72454864, 'specificity': 0.72454864, 'f1': 0.6403842, 'auroc': 0.858703, 'binary_precision': 0.23481229, 'binary_recall': 0.5111441, 'binary_specificity': 0.9379532, 'binary_f1_score': 0.32179606}
confusion matrix:
       0     1
0  16946  1121
1    329   344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92942315, 'precision': 0.6523249, 'recall': 0.78110886, 'specificity': 0.78110886, 'f1': 0.69304705, 'auroc': 0.90181446, 'binary_precision': 0.322, 'binary_recall': 0.61923075, 'binary_specificity': 0.9429869, 'binary_f1_score': 0.4236842}
confusion matrix:
      0    1
0  5607  339
1    99  161
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-02 21:57:08.460200,epoch time: 0:18:44.051508,used: 1:52:02.251855,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9430019, 'precision': 0.9451847, 'recall': 0.9430263, 'specificity': 0.9430263, 'f1': 0.94293416, 'auroc': 0.9851239, 'binary_precision': 0.9765316, 'binary_recall': 0.90790206, 'binary_specificity': 0.9781506, 'binary_f1_score': 0.9409671}
confusion matrix:
       0      1
0  28159    629
1   2655  26173
---- Validation: 
scalar performance:
{'acc': 0.91680896, 'precision': 0.6131641, 'recall': 0.77160084, 'specificity': 0.77160084, 'f1': 0.65122706, 'auroc': 0.869057, 'binary_precision': 0.24154025, 'binary_recall': 0.615156, 'binary_specificity': 0.92804563, 'binary_f1_score': 0.34687892}
confusion matrix:
       0     1
0  16767  1300
1    259   414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91927165, 'precision': 0.6426139, 'recall': 0.8107519, 'specificity': 0.8107519, 'f1': 0.6873728, 'auroc': 0.9109621, 'binary_precision': 0.29950082, 'binary_recall': 0.6923077, 'binary_specificity': 0.9291961, 'binary_f1_score': 0.41811845}
confusion matrix:
      0    1
0  5525  421
1    80  180
early stop counter: 1
val acc:0.9168089628219604, best validation acc: 0.9226254224777222, corresponding to test acc:                         0.9294231534004211 / 0.9294231534004211
after epoch: 7,now: 2024-08-02 22:15:57.191790,epoch time: 0:18:48.731590,used: 2:10:50.983445,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94780964, 'precision': 0.9489114, 'recall': 0.94782865, 'specificity': 0.94782865, 'f1': 0.94777906, 'auroc': 0.987491, 'binary_precision': 0.97134304, 'binary_recall': 0.9229275, 'binary_specificity': 0.9727298, 'binary_f1_score': 0.9465165}
confusion matrix:
       0      1
0  28001    785
1   2222  26608
---- Validation: 
scalar performance:
{'acc': 0.9191035, 'precision': 0.61824286, 'recall': 0.7806587, 'specificity': 0.7806587, 'f1': 0.65804124, 'auroc': 0.87635505, 'binary_precision': 0.25103366, 'binary_recall': 0.6315007, 'binary_specificity': 0.9298168, 'binary_f1_score': 0.35925612}
confusion matrix:
       0     1
0  16799  1268
1    248   425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92217207, 'precision': 0.65010905, 'recall': 0.82513845, 'specificity': 0.82513845, 'f1': 0.697303, 'auroc': 0.91647196, 'binary_precision': 0.31323284, 'binary_recall': 0.7192308, 'binary_specificity': 0.93104607, 'binary_f1_score': 0.4364061}
confusion matrix:
      0    1
0  5536  410
1    73  187
early stop counter: 2
val acc:0.9191035032272339, best validation acc: 0.9226254224777222, corresponding to test acc:                         0.9294231534004211 / 0.9294231534004211
after epoch: 8,now: 2024-08-02 22:34:22.177060,epoch time: 0:18:24.985270,used: 2:29:15.968715,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94999653, 'precision': 0.9516131, 'recall': 0.9500184, 'specificity': 0.9500184, 'f1': 0.94995344, 'auroc': 0.9883958, 'binary_precision': 0.97881603, 'binary_recall': 0.9199764, 'binary_specificity': 0.98006046, 'binary_f1_score': 0.94848454}
confusion matrix:
       0      1
0  28213    574
1   2307  26522
---- Validation: 
scalar performance:
{'acc': 0.9210779, 'precision': 0.62245494, 'recall': 0.7874049, 'specificity': 0.7874049, 'f1': 0.6636008, 'auroc': 0.8817225, 'binary_precision': 0.2589713, 'binary_recall': 0.6433878, 'binary_specificity': 0.93142194, 'binary_f1_score': 0.36929637}
confusion matrix:
       0     1
0  16828  1239
1    240   433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9210442, 'precision': 0.6510524, 'recall': 0.8374227, 'specificity': 0.8374227, 'f1': 0.69971514, 'auroc': 0.9222263, 'binary_precision': 0.31391585, 'binary_recall': 0.74615383, 'binary_specificity': 0.92869157, 'binary_f1_score': 0.44191346}
confusion matrix:
      0    1
0  5522  424
1    66  194
early stop counter: 3
val acc:0.9210779070854187, best validation acc: 0.9226254224777222, corresponding to test acc:                         0.9294231534004211 / 0.9294231534004211
after epoch: 9,now: 2024-08-02 22:52:24.762842,epoch time: 0:18:02.585782,used: 2:47:18.554497,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95157593, 'precision': 0.9525442, 'recall': 0.9515929, 'specificity': 0.9515929, 'f1': 0.9515513, 'auroc': 0.9887505, 'binary_precision': 0.9736603, 'binary_recall': 0.928336, 'binary_specificity': 0.97484976, 'binary_f1_score': 0.9504581}
confusion matrix:
       0      1
0  28063    724
1   2066  26763
---- Validation: 
scalar performance:
{'acc': 0.91963714, 'precision': 0.62327653, 'recall': 0.79881716, 'specificity': 0.79881716, 'f1': 0.6655635, 'auroc': 0.88672256, 'binary_precision': 0.2596653, 'binary_recall': 0.6686478, 'binary_specificity': 0.92898655, 'binary_f1_score': 0.37406483}
confusion matrix:
       0     1
0  16784  1283
1    223   450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9165324, 'precision': 0.6492293, 'recall': 0.858975, 'specificity': 0.858975, 'f1': 0.69954205, 'auroc': 0.9267984, 'binary_precision': 0.3080357, 'binary_recall': 0.79615384, 'binary_specificity': 0.92179614, 'binary_f1_score': 0.444206}
confusion matrix:
      0    1
0  5481  465
1    53  207
early stop counter: 4
val acc:0.919637143611908, best validation acc: 0.9226254224777222, corresponding to test acc:                         0.9294231534004211 / 0.9294231534004211
after epoch: 10,now: 2024-08-02 23:10:39.987192,epoch time: 0:18:15.224350,used: 3:05:33.778847,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9530165, 'precision': 0.95390356, 'recall': 0.95303273, 'specificity': 0.95303273, 'f1': 0.9529947, 'auroc': 0.989923, 'binary_precision': 0.9741523, 'binary_recall': 0.9307988, 'binary_specificity': 0.97526664, 'binary_f1_score': 0.95198226}
confusion matrix:
       0      1
0  28075    712
1   1995  26834
---- Validation: 
scalar performance:
{'acc': 0.9142476, 'precision': 0.62066865, 'recall': 0.8160495, 'specificity': 0.8160495, 'f1': 0.66348845, 'auroc': 0.88897276, 'binary_precision': 0.25291005, 'binary_recall': 0.7102526, 'binary_specificity': 0.92184645, 'binary_f1_score': 0.37300035}
confusion matrix:
       0     1
0  16655  1412
1    195   478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9047696, 'precision': 0.6356133, 'recall': 0.86019236, 'specificity': 0.86019236, 'f1': 0.6823689, 'auroc': 0.92863595, 'binary_precision': 0.2802125, 'binary_recall': 0.81153846, 'binary_specificity': 0.90884626, 'binary_f1_score': 0.4165844}
confusion matrix:
      0    1
0  5404  542
1    49  211
early stop counter: 5
val acc:0.9142475724220276, best validation acc: 0.9226254224777222, corresponding to test acc:                         0.9294231534004211 / 0.9294231534004211
after epoch: 11,now: 2024-08-02 23:29:13.034307,epoch time: 0:18:33.047115,used: 3:24:06.825962,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9555332, 'precision': 0.9561672, 'recall': 0.9555476, 'specificity': 0.9555476, 'f1': 0.9555187, 'auroc': 0.9911079, 'binary_precision': 0.97336555, 'binary_recall': 0.9367673, 'binary_specificity': 0.9743278, 'binary_f1_score': 0.9547158}
confusion matrix:
       0      1
0  28047    739
1   1823  27007
---- Validation: 
scalar performance:
{'acc': 0.9146745, 'precision': 0.6218456, 'recall': 0.819132, 'specificity': 0.819132, 'f1': 0.66516376, 'auroc': 0.88938195, 'binary_precision': 0.25502646, 'binary_recall': 0.7161961, 'binary_specificity': 0.9220679, 'binary_f1_score': 0.37612173}
confusion matrix:
       0     1
0  16659  1408
1    191   482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90267485, 'precision': 0.6339886, 'recall': 0.8627772, 'specificity': 0.8627772, 'f1': 0.680263, 'auroc': 0.9299691, 'binary_precision': 0.27662337, 'binary_recall': 0.8192308, 'binary_specificity': 0.90632355, 'binary_f1_score': 0.41359222}
confusion matrix:
      0    1
0  5389  557
1    47  213
early stop counter: 6
val acc:0.9146745204925537, best validation acc: 0.9226254224777222, corresponding to test acc:                         0.9294231534004211 / 0.9294231534004211
after epoch: 12,now: 2024-08-02 23:47:44.800307,epoch time: 0:18:31.766000,used: 3:42:38.591962,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95907384, 'precision': 0.95955986, 'recall': 0.9590852, 'specificity': 0.9590852, 'f1': 0.95906377, 'auroc': 0.9918258, 'binary_precision': 0.974679, 'binary_recall': 0.9426946, 'binary_specificity': 0.9754759, 'binary_f1_score': 0.95842}
confusion matrix:
       0      1
0  28082    706
1   1652  27176
---- Validation: 
scalar performance:
{'acc': 0.9110459, 'precision': 0.6212845, 'recall': 0.83513176, 'specificity': 0.83513176, 'f1': 0.6651567, 'auroc': 0.89149046, 'binary_precision': 0.25249004, 'binary_recall': 0.7533432, 'binary_specificity': 0.91692036, 'binary_f1_score': 0.3782171}
confusion matrix:
       0     1
0  16566  1501
1    166   507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8905898, 'precision': 0.6231817, 'recall': 0.8638264, 'specificity': 0.8638264, 'f1': 0.66492164, 'auroc': 0.9328327, 'binary_precision': 0.25439626, 'binary_recall': 0.8346154, 'binary_specificity': 0.8930373, 'binary_f1_score': 0.38993713}
confusion matrix:
      0    1
0  5310  636
1    43  217
early stop counter: 7
val acc:0.9110459089279175, best validation acc: 0.9226254224777222, corresponding to test acc:                         0.9294231534004211 / 0.9294231534004211
after epoch: 13,now: 2024-08-03 00:08:45.085127,epoch time: 0:21:00.284820,used: 4:03:38.876782,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96020204, 'precision': 0.96082103, 'recall': 0.96021485, 'specificity': 0.96021485, 'f1': 0.96018946, 'auroc': 0.99225646, 'binary_precision': 0.97788423, 'binary_recall': 0.94175804, 'binary_specificity': 0.97867167, 'binary_f1_score': 0.95948124}
confusion matrix:
       0      1
0  28174    614
1   1679  27149
---- Validation: 
scalar performance:
{'acc': 0.9198506, 'precision': 0.63018507, 'recall': 0.82825387, 'specificity': 0.82825387, 'f1': 0.6762055, 'auroc': 0.8931081, 'binary_precision': 0.27112094, 'binary_recall': 0.7295691, 'binary_specificity': 0.9269386, 'binary_f1_score': 0.39533013}
confusion matrix:
       0     1
0  16747  1320
1    182   491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90638095, 'precision': 0.6390178, 'recall': 0.86838925, 'specificity': 0.86838925, 'f1': 0.6871805, 'auroc': 0.934268, 'binary_precision': 0.28628495, 'binary_recall': 0.8269231, 'binary_specificity': 0.90985537, 'binary_f1_score': 0.42532143}
confusion matrix:
      0    1
0  5410  536
1    45  215
early stop counter: 8
val acc:0.9198505878448486, best validation acc: 0.9226254224777222, corresponding to test acc:                         0.9294231534004211 / 0.9294231534004211
after epoch: 14,now: 2024-08-03 00:30:26.662999,epoch time: 0:21:41.577872,used: 4:25:20.454654,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96072274, 'precision': 0.96125793, 'recall': 0.9607352, 'specificity': 0.9607352, 'f1': 0.9607121, 'auroc': 0.99232465, 'binary_precision': 0.97715354, 'binary_recall': 0.94356376, 'binary_specificity': 0.9779067, 'binary_f1_score': 0.96006495}
confusion matrix:
       0      1
0  28151    636
1   1627  27202
---- Validation: 
scalar performance:
{'acc': 0.9151014, 'precision': 0.62566257, 'recall': 0.834374, 'specificity': 0.834374, 'f1': 0.6708802, 'auroc': 0.89340293, 'binary_precision': 0.26143453, 'binary_recall': 0.7473997, 'binary_specificity': 0.92134833, 'binary_f1_score': 0.38737005}
confusion matrix:
       0     1
0  16646  1421
1    170   503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90364164, 'precision': 0.63545877, 'recall': 0.86512065, 'specificity': 0.86512065, 'f1': 0.68231666, 'auroc': 0.93411344, 'binary_precision': 0.27937338, 'binary_recall': 0.8230769, 'binary_specificity': 0.90716445, 'binary_f1_score': 0.417154}
confusion matrix:
      0    1
0  5394  552
1    46  214
early stop counter: 9
val acc:0.9151014089584351, best validation acc: 0.9226254224777222, corresponding to test acc:                         0.9294231534004211 / 0.9294231534004211
after epoch: 15,now: 2024-08-03 00:51:52.766118,epoch time: 0:21:26.103119,used: 4:46:46.557773,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9636212, 'precision': 0.96398103, 'recall': 0.9636315, 'specificity': 0.9636315, 'f1': 0.9636147, 'auroc': 0.9930741, 'binary_precision': 0.97708535, 'binary_recall': 0.9495647, 'binary_specificity': 0.97769827, 'binary_f1_score': 0.9631285}
confusion matrix:
       0      1
0  28145    642
1   1454  27375
---- Validation: 
scalar performance:
{'acc': 0.90901816, 'precision': 0.61953706, 'recall': 0.83694124, 'specificity': 0.83694124, 'f1': 0.66285515, 'auroc': 0.8928039, 'binary_precision': 0.24878286, 'binary_recall': 0.75928676, 'binary_specificity': 0.91459566, 'binary_f1_score': 0.37477082}
confusion matrix:
       0     1
0  16524  1543
1    162   511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89300674, 'precision': 0.6269766, 'recall': 0.8724437, 'specificity': 0.8724437, 'f1': 0.6704542, 'auroc': 0.9350345, 'binary_precision': 0.2612293, 'binary_recall': 0.85, 'binary_specificity': 0.8948873, 'binary_f1_score': 0.39963832}
confusion matrix:
      0    1
0  5321  625
1    39  221
early stop counter: 10
val acc:0.9090181589126587, best validation acc: 0.9226254224777222, corresponding to test acc:                         0.9294231534004211 / 0.9294231534004211
after epoch: 16,now: 2024-08-03 01:13:15.174550,epoch time: 0:21:22.408432,used: 5:08:08.966205,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96233684, 'precision': 0.9628922, 'recall': 0.9623502, 'specificity': 0.9623502, 'f1': 0.9623263, 'auroc': 0.9930371, 'binary_precision': 0.9791173, 'binary_recall': 0.9448838, 'binary_specificity': 0.97981656, 'binary_f1_score': 0.96169597}
confusion matrix:
       0      1
0  28205    581
1   1589  27241
---- Validation: 
scalar performance:
{'acc': 0.9018677, 'precision': 0.6139783, 'recall': 0.8432466, 'specificity': 0.8432466, 'f1': 0.6551417, 'auroc': 0.89393514, 'binary_precision': 0.23691335, 'binary_recall': 0.78008914, 'binary_specificity': 0.90640396, 'binary_f1_score': 0.36344755}
confusion matrix:
       0     1
0  16376  1691
1    148   525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88108283, 'precision': 0.6182833, 'recall': 0.8754159, 'specificity': 0.8754159, 'f1': 0.6570341, 'auroc': 0.9366121, 'binary_precision': 0.24301076, 'binary_recall': 0.86923075, 'binary_specificity': 0.8816011, 'binary_f1_score': 0.37983194}
confusion matrix:
      0    1
0  5242  704
1    34  226
early stop counter: 11
val acc:0.901867687702179, best validation acc: 0.9226254224777222, corresponding to test acc:                         0.9294231534004211 / 0.9294231534004211
after epoch: 17,now: 2024-08-03 01:34:46.525057,epoch time: 0:21:31.350507,used: 5:29:40.316712,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96443695, 'precision': 0.96466255, 'recall': 0.9644455, 'specificity': 0.9644455, 'f1': 0.9644331, 'auroc': 0.9936879, 'binary_precision': 0.9750931, 'binary_recall': 0.9532778, 'binary_specificity': 0.9756131, 'binary_f1_score': 0.9640621}
confusion matrix:
       0      1
0  28084    702
1   1347  27483
---- Validation: 
scalar performance:
{'acc': 0.9018677, 'precision': 0.6138298, 'recall': 0.84253126, 'specificity': 0.84253126, 'f1': 0.6549227, 'auroc': 0.8932428, 'binary_precision': 0.2366757, 'binary_recall': 0.77860326, 'binary_specificity': 0.9064593, 'binary_f1_score': 0.36300656}
confusion matrix:
       0     1
0  16377  1690
1    149   524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8822108, 'precision': 0.619209, 'recall': 0.8760046, 'specificity': 0.8760046, 'f1': 0.6584901, 'auroc': 0.9365301, 'binary_precision': 0.24485373, 'binary_recall': 0.86923075, 'binary_specificity': 0.88277835, 'binary_f1_score': 0.38207945}
confusion matrix:
      0    1
0  5249  697
1    34  226
early stop counter: 12
val acc:0.901867687702179, best validation acc: 0.9226254224777222, corresponding to test acc:                         0.9294231534004211 / 0.9294231534004211
after epoch: 18,now: 2024-08-03 01:56:26.480096,epoch time: 0:21:39.955039,used: 5:51:20.271751,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96337825, 'precision': 0.9641079, 'recall': 0.96339273, 'specificity': 0.96339273, 'f1': 0.9633646, 'auroc': 0.9941189, 'binary_precision': 0.9826932, 'binary_recall': 0.943425, 'binary_specificity': 0.9833605, 'binary_f1_score': 0.9626588}
confusion matrix:
       0      1
0  28308    479
1   1631  27198
---- Validation: 
scalar performance:
{'acc': 0.9102455, 'precision': 0.6203439, 'recall': 0.8347167, 'specificity': 0.8347167, 'f1': 0.66387856, 'auroc': 0.8917159, 'binary_precision': 0.2506179, 'binary_recall': 0.7533432, 'binary_specificity': 0.91609013, 'binary_f1_score': 0.37611276}
confusion matrix:
       0     1
0  16551  1516
1    166   507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8975185, 'precision': 0.6303432, 'recall': 0.8692812, 'specificity': 0.8692812, 'f1': 0.67531586, 'auroc': 0.9334892, 'binary_precision': 0.2684729, 'binary_recall': 0.8384615, 'binary_specificity': 0.9001009, 'binary_f1_score': 0.4067164}
confusion matrix:
      0    1
0  5352  594
1    42  218
early stop counter: 13
val acc:0.9102454781532288, best validation acc: 0.9226254224777222, corresponding to test acc:                         0.9294231534004211 / 0.9294231534004211
after epoch: 19,now: 2024-08-03 02:18:02.648571,epoch time: 0:21:36.168475,used: 6:12:56.440226,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96681476, 'precision': 0.96717477, 'recall': 0.9668255, 'specificity': 0.9668255, 'f1': 0.9668089, 'auroc': 0.9942491, 'binary_precision': 0.9803355, 'binary_recall': 0.9527922, 'binary_specificity': 0.98085874, 'binary_f1_score': 0.96636766}
confusion matrix:
       0      1
0  28235    551
1   1361  27469
---- Validation: 
scalar performance:
{'acc': 0.8858058, 'precision': 0.60045743, 'recall': 0.83849275, 'specificity': 0.83849275, 'f1': 0.63441145, 'auroc': 0.8925899, 'binary_precision': 0.20973486, 'binary_recall': 0.78751856, 'binary_specificity': 0.889467, 'binary_f1_score': 0.33124998}
confusion matrix:
       0     1
0  16070  1997
1    143   530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86094105, 'precision': 0.6045401, 'recall': 0.8685826, 'specificity': 0.8685826, 'f1': 0.63395983, 'auroc': 0.934942, 'binary_precision': 0.21529745, 'binary_recall': 0.8769231, 'binary_specificity': 0.8602422, 'binary_f1_score': 0.34571645}
confusion matrix:
      0    1
0  5115  831
1    32  228
early stop counter: 14
val acc:0.8858057856559753, best validation acc: 0.9226254224777222, corresponding to test acc:                         0.9294231534004211 / 0.9294231534004211
after epoch: 20,now: 2024-08-03 02:39:39.789471,epoch time: 0:21:37.140900,used: 6:34:33.581126,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_05_06_seed_1_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:34:33.581126 at 2024-08-03 02:39:39.789471
persisted model performance metric: 

scalar performance:
{'acc': 0.92942315, 'precision': 0.6523249, 'recall': 0.78110886, 'specificity': 0.78110886, 'f1': 0.69304705, 'auroc': 0.90181446, 'binary_precision': 0.322, 'binary_recall': 0.61923075, 'binary_specificity': 0.9429869, 'binary_f1_score': 0.4236842}
confusion matrix:
      0    1
0  5607  339
1    99  161
oracle model performance metric: 

scalar performance:
{'acc': 0.92942315, 'precision': 0.6523249, 'recall': 0.78110886, 'specificity': 0.78110886, 'f1': 0.69304705, 'auroc': 0.90181446, 'binary_precision': 0.322, 'binary_recall': 0.61923075, 'binary_specificity': 0.9429869, 'binary_f1_score': 0.4236842}
confusion matrix:
      0    1
0  5607  339
1    99  161
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196690 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |  17479 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196690 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool | 179211 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |  17479 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   7827 MiB |    941 TiB |    941 TiB |
|       from large pool | 178979 KiB |   7804 MiB |    926 TiB |    926 TiB |
|       from small pool |  16480 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8530 MiB |  16790 MiB |   8278 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     40 MiB |     44 MiB |     58 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  38830 KiB | 732464 KiB | 522212 GiB | 522212 GiB |
|       from large pool |  31733 KiB | 730714 KiB | 507687 GiB | 507687 GiB |
|       from small pool |   7097 KiB |  23272 KiB |  14524 GiB |  14524 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7697    |  184998 K  |  184995 K  |
|       from large pool |      79    |     762    |   89600 K  |   89600 K  |
|       from small pool |    2875    |    7616    |   95398 K  |   95395 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7697    |  184998 K  |  184995 K  |
|       from large pool |      79    |     762    |   89600 K  |   89600 K  |
|       from small pool |    2875    |    7616    |   95398 K  |   95395 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |     715    |     347    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      20    |      22    |      29    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |    3621    |  103490 K  |  103490 K  |
|       from large pool |      11    |     351    |   62532 K  |   62532 K  |
|       from small pool |      23    |    3611    |   40958 K  |   40958 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16790 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     58 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 522212 GiB | 522212 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 507687 GiB | 507687 GiB |
|       from small pool |      0 KiB |  23272 KiB |  14524 GiB |  14524 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  184998 K  |  184998 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95398 K  |   95398 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  184998 K  |  184998 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95398 K  |   95398 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     715    |     693    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      29    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3621    |  103492 K  |  103492 K  |
|       from large pool |       3    |     351    |   62532 K  |   62532 K  |
|       from small pool |       0    |    3611    |   40959 K  |   40959 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7805 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     37 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |    941 TiB |    941 TiB |
|       from large pool |  16640 KiB |   7804 MiB |    926 TiB |    926 TiB |
|       from small pool |      0 KiB |     36 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8530 MiB |  16790 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     58 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 522212 GiB | 522212 GiB |
|       from large pool |  30464 KiB | 730714 KiB | 507687 GiB | 507687 GiB |
|       from small pool |      0 KiB |  23272 KiB |  14524 GiB |  14524 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  184998 K  |  184998 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95398 K  |   95398 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  184998 K  |  184998 K  |
|       from large pool |       2    |     762    |   89600 K  |   89600 K  |
|       from small pool |       0    |    7616    |   95398 K  |   95398 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |     715    |     693    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      29    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3621    |  103492 K  |  103492 K  |
|       from large pool |       3    |     351    |   62532 K  |   62532 K  |
|       from small pool |       0    |    3611    |   40959 K  |   40959 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974

 Experiment start at: 2024-08-03 02:51:08.714243
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8621021, 'precision': 0.8646268, 'recall': 0.86211205, 'specificity': 0.86211205, 'f1': 0.8618653, 'auroc': 0.93019253, 'binary_precision': 0.89502823, 'binary_recall': 0.8205014, 'binary_specificity': 0.90372276, 'binary_f1_score': 0.856146}
confusion matrix:
       0      1
0  26339   2806
1   5234  23925
---- Validation: 
scalar performance:
{'acc': 0.851329, 'precision': 0.54467696, 'recall': 0.6822873, 'specificity': 0.6822873, 'f1': 0.5480917, 'auroc': 0.7502228, 'binary_precision': 0.10812746, 'binary_recall': 0.5016611, 'binary_specificity': 0.8629134, 'binary_f1_score': 0.17790867}
confusion matrix:
       0     1
0  15680  2491
1    300   302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70251644, 'precision': 0.5022363, 'recall': 0.51215553, 'specificity': 0.51215553, 'f1': 0.4483258, 'auroc': 0.5482686, 'binary_precision': 0.04199773, 'binary_recall': 0.30578512, 'binary_specificity': 0.71852595, 'binary_f1_score': 0.07385229}
confusion matrix:
      0     1
0  4309  1688
1   168    74
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 03:13:52.436542,epoch time: 0:22:43.722299,used: 0:22:43.722299,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90563256, 'precision': 0.9090331, 'recall': 0.90564036, 'specificity': 0.90564036, 'f1': 0.90543723, 'auroc': 0.9610313, 'binary_precision': 0.9463713, 'binary_recall': 0.86003363, 'binary_specificity': 0.95124716, 'binary_f1_score': 0.9011392}
confusion matrix:
       0      1
0  27726   1421
1   4081  25076
---- Validation: 
scalar performance:
{'acc': 0.91221434, 'precision': 0.5635032, 'recall': 0.64949465, 'specificity': 0.64949465, 'f1': 0.58287716, 'auroc': 0.7674582, 'binary_precision': 0.14899328, 'binary_recall': 0.36877078, 'binary_specificity': 0.93021846, 'binary_f1_score': 0.21223707}
confusion matrix:
       0     1
0  16903  1268
1    380   222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8446866, 'precision': 0.5191343, 'recall': 0.56033355, 'specificity': 0.56033355, 'f1': 0.5133635, 'auroc': 0.656025, 'binary_precision': 0.071849234, 'binary_recall': 0.2520661, 'binary_specificity': 0.86860096, 'binary_f1_score': 0.11182401}
confusion matrix:
      0    1
0  5209  788
1   181   61
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 03:35:52.509461,epoch time: 0:22:00.072919,used: 0:44:43.795218,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.91913074, 'precision': 0.92223346, 'recall': 0.9191381, 'specificity': 0.9191381, 'f1': 0.91898286, 'auroc': 0.9697513, 'binary_precision': 0.9584709, 'binary_recall': 0.8762561, 'binary_specificity': 0.9620201, 'binary_f1_score': 0.91552144}
confusion matrix:
       0      1
0  28040   1107
1   3608  25549
---- Validation: 
scalar performance:
{'acc': 0.9205774, 'precision': 0.57069737, 'recall': 0.6489964, 'specificity': 0.6489964, 'f1': 0.591397, 'auroc': 0.7853124, 'binary_precision': 0.16351248, 'binary_recall': 0.358804, 'binary_specificity': 0.93918884, 'binary_f1_score': 0.22464898}
confusion matrix:
       0     1
0  17066  1105
1    386   216
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8629588, 'precision': 0.53205085, 'recall': 0.59164846, 'specificity': 0.59164846, 'f1': 0.53483015, 'auroc': 0.7155734, 'binary_precision': 0.09511229, 'binary_recall': 0.29752067, 'binary_specificity': 0.8857762, 'binary_f1_score': 0.14414415}
confusion matrix:
      0    1
0  5312  685
1   170   72
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-08-03 03:58:10.250399,epoch time: 0:22:17.740938,used: 1:07:01.536156,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9311368, 'precision': 0.93280476, 'recall': 0.93114, 'specificity': 0.93114, 'f1': 0.9310707, 'auroc': 0.97693336, 'binary_precision': 0.9596987, 'binary_recall': 0.90008575, 'binary_specificity': 0.96219426, 'binary_f1_score': 0.9289368}
confusion matrix:
       0      1
0  28047   1102
1   2913  26242
---- Validation: 
scalar performance:
{'acc': 0.9189261, 'precision': 0.5809101, 'recall': 0.6850836, 'specificity': 0.6850836, 'f1': 0.6066181, 'auroc': 0.80103123, 'binary_precision': 0.18144044, 'binary_recall': 0.43521595, 'binary_specificity': 0.9349513, 'binary_f1_score': 0.25610948}
confusion matrix:
       0     1
0  16989  1182
1    340   262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8522199, 'precision': 0.5502675, 'recall': 0.6673547, 'specificity': 0.6673547, 'f1': 0.5577436, 'auroc': 0.7657769, 'binary_precision': 0.12472406, 'binary_recall': 0.46694216, 'binary_specificity': 0.8677672, 'binary_f1_score': 0.19686411}
confusion matrix:
      0    1
0  5204  793
1   129  113
early stop counter: 1
val acc:0.9189261198043823, best validation acc: 0.9205774068832397, corresponding to test acc:                         0.8629587888717651 / 0.8629587888717651
after epoch: 4,now: 2024-08-03 04:20:04.019604,epoch time: 0:21:53.769205,used: 1:28:55.305361,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93782586, 'precision': 0.94044125, 'recall': 0.9378338, 'specificity': 0.9378338, 'f1': 0.93773425, 'auroc': 0.98073614, 'binary_precision': 0.97443235, 'binary_recall': 0.8992729, 'binary_specificity': 0.9763947, 'binary_f1_score': 0.9353452}
confusion matrix:
       0      1
0  28458    688
1   2937  26221
---- Validation: 
scalar performance:
{'acc': 0.93053854, 'precision': 0.59397686, 'recall': 0.6814456, 'specificity': 0.6814456, 'f1': 0.6203391, 'auroc': 0.8114625, 'binary_precision': 0.20798668, 'binary_recall': 0.4152824, 'binary_specificity': 0.9476088, 'binary_f1_score': 0.27716187}
confusion matrix:
       0    1
0  17219  952
1    352  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8730566, 'precision': 0.5599102, 'recall': 0.67422795, 'specificity': 0.67422795, 'f1': 0.5749245, 'auroc': 0.7970011, 'binary_precision': 0.14378238, 'binary_recall': 0.45867768, 'binary_specificity': 0.8897782, 'binary_f1_score': 0.21893492}
confusion matrix:
      0    1
0  5336  661
1   131  111
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-08-03 04:41:49.139021,epoch time: 0:21:45.119417,used: 1:50:40.424778,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9406559, 'precision': 0.94324446, 'recall': 0.94066244, 'specificity': 0.94066244, 'f1': 0.9405697, 'auroc': 0.9840137, 'binary_precision': 0.97716045, 'binary_recall': 0.9024248, 'binary_specificity': 0.9789001, 'binary_f1_score': 0.9383068}
confusion matrix:
       0      1
0  28532    615
1   2845  26312
---- Validation: 
scalar performance:
{'acc': 0.9342673, 'precision': 0.6054987, 'recall': 0.6986297, 'specificity': 0.6986297, 'f1': 0.6345587, 'auroc': 0.8221031, 'binary_precision': 0.22991453, 'binary_recall': 0.44684386, 'binary_specificity': 0.9504155, 'binary_f1_score': 0.30361176}
confusion matrix:
       0    1
0  17270  901
1    333  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8785062, 'precision': 0.57707405, 'recall': 0.728614, 'specificity': 0.728614, 'f1': 0.5996399, 'auroc': 0.82654274, 'binary_precision': 0.17341772, 'binary_recall': 0.5661157, 'binary_specificity': 0.8911122, 'binary_f1_score': 0.26550385}
confusion matrix:
      0    1
0  5344  653
1   105  137
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-03 05:03:21.999759,epoch time: 0:21:32.860738,used: 2:12:13.285516,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94840837, 'precision': 0.94962716, 'recall': 0.9484128, 'specificity': 0.9484128, 'f1': 0.9483737, 'auroc': 0.9868672, 'binary_precision': 0.97307956, 'binary_recall': 0.9223514, 'binary_specificity': 0.9744742, 'binary_f1_score': 0.9470366}
confusion matrix:
       0      1
0  28403    744
1   2264  26893
---- Validation: 
scalar performance:
{'acc': 0.9271827, 'precision': 0.60397, 'recall': 0.72950107, 'specificity': 0.72950107, 'f1': 0.63748145, 'auroc': 0.83115363, 'binary_precision': 0.22462203, 'binary_recall': 0.5182724, 'binary_specificity': 0.94072974, 'binary_f1_score': 0.31341034}
confusion matrix:
       0     1
0  17094  1077
1    290   312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85718864, 'precision': 0.57695025, 'recall': 0.77304184, 'specificity': 0.77304184, 'f1': 0.5955597, 'auroc': 0.848068, 'binary_precision': 0.16853933, 'binary_recall': 0.6818182, 'binary_specificity': 0.86426544, 'binary_f1_score': 0.27027026}
confusion matrix:
      0    1
0  5183  814
1    77  165
early stop counter: 1
val acc:0.927182674407959, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.8785061836242676 / 0.8785061836242676
after epoch: 7,now: 2024-08-03 05:25:08.510746,epoch time: 0:21:46.510987,used: 2:33:59.796503,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9521131, 'precision': 0.9533893, 'recall': 0.9521158, 'specificity': 0.9521158, 'f1': 0.9520796, 'auroc': 0.98826456, 'binary_precision': 0.9774695, 'binary_recall': 0.92557025, 'binary_specificity': 0.97866136, 'binary_f1_score': 0.9508122}
confusion matrix:
       0      1
0  28527    622
1   2170  26985
---- Validation: 
scalar performance:
{'acc': 0.9255846, 'precision': 0.60158116, 'recall': 0.7286756, 'specificity': 0.7286756, 'f1': 0.6347168, 'auroc': 0.8332, 'binary_precision': 0.21987315, 'binary_recall': 0.5182724, 'binary_specificity': 0.93907875, 'binary_f1_score': 0.30875802}
confusion matrix:
       0     1
0  17064  1107
1    290   312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85638726, 'precision': 0.58075213, 'recall': 0.79245234, 'specificity': 0.79245234, 'f1': 0.6005634, 'auroc': 0.8614714, 'binary_precision': 0.17430279, 'binary_recall': 0.7231405, 'binary_specificity': 0.8617642, 'binary_f1_score': 0.28089887}
confusion matrix:
      0    1
0  5168  829
1    67  175
early stop counter: 2
val acc:0.925584614276886, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.8785061836242676 / 0.8785061836242676
after epoch: 8,now: 2024-08-03 05:46:52.818922,epoch time: 0:21:44.308176,used: 2:55:44.104679,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9547715, 'precision': 0.95524466, 'recall': 0.95477545, 'specificity': 0.95477545, 'f1': 0.9547601, 'auroc': 0.98905534, 'binary_precision': 0.96998155, 'binary_recall': 0.93861246, 'binary_specificity': 0.9709384, 'binary_f1_score': 0.9540392}
confusion matrix:
       0      1
0  28298    847
1   1790  27369
---- Validation: 
scalar performance:
{'acc': 0.9284611, 'precision': 0.60841465, 'recall': 0.738995, 'specificity': 0.738995, 'f1': 0.643508, 'auroc': 0.83941656, 'binary_precision': 0.23287672, 'binary_recall': 0.53654486, 'binary_specificity': 0.9414452, 'binary_f1_score': 0.32478634}
confusion matrix:
       0     1
0  17107  1064
1    279   323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86536306, 'precision': 0.5889095, 'recall': 0.8110006, 'specificity': 0.8110006, 'f1': 0.61390895, 'auroc': 0.8721248, 'binary_precision': 0.1891892, 'binary_recall': 0.75206614, 'binary_specificity': 0.869935, 'binary_f1_score': 0.30232558}
confusion matrix:
      0    1
0  5217  780
1    60  182
early stop counter: 3
val acc:0.9284610748291016, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.8785061836242676 / 0.8785061836242676
after epoch: 9,now: 2024-08-03 06:07:49.299773,epoch time: 0:20:56.480851,used: 3:16:40.585530,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9566582, 'precision': 0.9575269, 'recall': 0.95666265, 'specificity': 0.95666265, 'f1': 0.956638, 'auroc': 0.9907534, 'binary_precision': 0.9775148, 'binary_recall': 0.93483776, 'binary_specificity': 0.9784876, 'binary_f1_score': 0.9557001}
confusion matrix:
       0      1
0  28519    627
1   1900  27258
---- Validation: 
scalar performance:
{'acc': 0.9201513, 'precision': 0.602855, 'recall': 0.75879395, 'specificity': 0.75879395, 'f1': 0.63888305, 'auroc': 0.84537125, 'binary_precision': 0.2202121, 'binary_recall': 0.58637875, 'binary_specificity': 0.9312091, 'binary_f1_score': 0.3201814}
confusion matrix:
       0     1
0  16921  1250
1    249   353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8506171, 'precision': 0.5837551, 'recall': 0.81919193, 'specificity': 0.81919193, 'f1': 0.60308325, 'auroc': 0.8804581, 'binary_precision': 0.17757009, 'binary_recall': 0.78512394, 'binary_specificity': 0.85326, 'binary_f1_score': 0.28963414}
confusion matrix:
      0    1
0  5117  880
1    52  190
early stop counter: 4
val acc:0.9201512932777405, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.8785061836242676 / 0.8785061836242676
after epoch: 10,now: 2024-08-03 06:26:58.981571,epoch time: 0:19:09.681798,used: 3:35:50.267328,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9585792, 'precision': 0.95970196, 'recall': 0.9585834, 'specificity': 0.9585834, 'f1': 0.95855415, 'auroc': 0.9910805, 'binary_precision': 0.9824637, 'binary_recall': 0.93384093, 'binary_specificity': 0.9833259, 'binary_f1_score': 0.9575355}
confusion matrix:
       0      1
0  28661    486
1   1929  27228
---- Validation: 
scalar performance:
{'acc': 0.9284611, 'precision': 0.6088544, 'recall': 0.74060106, 'specificity': 0.74060106, 'f1': 0.64418346, 'auroc': 0.8439826, 'binary_precision': 0.23364486, 'binary_recall': 0.5398671, 'binary_specificity': 0.9413351, 'binary_f1_score': 0.32614148}
confusion matrix:
       0     1
0  17105  1066
1    277   325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8680878, 'precision': 0.59311193, 'recall': 0.82431436, 'specificity': 0.82431436, 'f1': 0.6203136, 'auroc': 0.8849294, 'binary_precision': 0.19644724, 'binary_recall': 0.7768595, 'binary_specificity': 0.8717692, 'binary_f1_score': 0.31359467}
confusion matrix:
      0    1
0  5228  769
1    54  188
early stop counter: 5
val acc:0.9284610748291016, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.8785061836242676 / 0.8785061836242676
after epoch: 11,now: 2024-08-03 06:45:36.617794,epoch time: 0:18:37.636223,used: 3:54:27.903551,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.959917, 'precision': 0.9605546, 'recall': 0.95992017, 'specificity': 0.95992017, 'f1': 0.9599033, 'auroc': 0.99208236, 'binary_precision': 0.9777342, 'binary_recall': 0.9412834, 'binary_specificity': 0.978557, 'binary_f1_score': 0.95916265}
confusion matrix:
       0      1
0  28522    625
1   1712  27445
---- Validation: 
scalar performance:
{'acc': 0.9206307, 'precision': 0.6028695, 'recall': 0.7566324, 'specificity': 0.7566324, 'f1': 0.63874596, 'auroc': 0.849212, 'binary_precision': 0.22040302, 'binary_recall': 0.5813953, 'binary_specificity': 0.93186945, 'binary_f1_score': 0.3196347}
confusion matrix:
       0     1
0  16933  1238
1    252   350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8560667, 'precision': 0.58670175, 'recall': 0.8220267, 'specificity': 0.8220267, 'f1': 0.6085805, 'auroc': 0.88938403, 'binary_precision': 0.18339768, 'binary_recall': 0.78512394, 'binary_specificity': 0.85892946, 'binary_f1_score': 0.2973396}
confusion matrix:
      0    1
0  5151  846
1    52  190
early stop counter: 6
val acc:0.920630693435669, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.8785061836242676 / 0.8785061836242676
after epoch: 12,now: 2024-08-03 07:04:09.057167,epoch time: 0:18:32.439373,used: 4:13:00.342924,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9618037, 'precision': 0.9624246, 'recall': 0.9618074, 'specificity': 0.9618074, 'f1': 0.96179104, 'auroc': 0.9925576, 'binary_precision': 0.9794211, 'binary_recall': 0.94344604, 'binary_specificity': 0.9801688, 'binary_f1_score': 0.96109706}
confusion matrix:
       0      1
0  28568    578
1   1649  27509
---- Validation: 
scalar performance:
{'acc': 0.92356044, 'precision': 0.6078679, 'recall': 0.762161, 'specificity': 0.762161, 'f1': 0.64523333, 'auroc': 0.852476, 'binary_precision': 0.23007129, 'binary_recall': 0.589701, 'binary_specificity': 0.9346211, 'binary_f1_score': 0.33100232}
confusion matrix:
       0     1
0  16983  1188
1    247   355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8615163, 'precision': 0.5890367, 'recall': 0.820896, 'specificity': 0.820896, 'f1': 0.61317194, 'auroc': 0.8932923, 'binary_precision': 0.18837675, 'binary_recall': 0.7768595, 'binary_specificity': 0.8649325, 'binary_f1_score': 0.30322582}
confusion matrix:
      0    1
0  5187  810
1    54  188
early stop counter: 7
val acc:0.9235604405403137, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.8785061836242676 / 0.8785061836242676
after epoch: 13,now: 2024-08-03 07:22:37.181708,epoch time: 0:18:28.124541,used: 4:31:28.467465,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96410197, 'precision': 0.9647074, 'recall': 0.96410567, 'specificity': 0.96410567, 'f1': 0.96409047, 'auroc': 0.9930357, 'binary_precision': 0.9815322, 'binary_recall': 0.9460182, 'binary_specificity': 0.9821931, 'binary_f1_score': 0.9634481}
confusion matrix:
       0      1
0  28627    519
1   1574  27584
---- Validation: 
scalar performance:
{'acc': 0.91839343, 'precision': 0.60281783, 'recall': 0.7667194, 'specificity': 0.7667194, 'f1': 0.63935363, 'auroc': 0.8558247, 'binary_precision': 0.21954161, 'binary_recall': 0.60465115, 'binary_specificity': 0.92878765, 'binary_f1_score': 0.3221239}
confusion matrix:
       0     1
0  16877  1294
1    238   364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85350215, 'precision': 0.586481, 'recall': 0.82664096, 'specificity': 0.82664096, 'f1': 0.6075777, 'auroc': 0.8967445, 'binary_precision': 0.18241966, 'binary_recall': 0.79752064, 'binary_specificity': 0.85576123, 'binary_f1_score': 0.2969231}
confusion matrix:
      0    1
0  5132  865
1    49  193
early stop counter: 8
val acc:0.9183934330940247, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.8785061836242676 / 0.8785061836242676
after epoch: 14,now: 2024-08-03 07:41:05.917573,epoch time: 0:18:28.735865,used: 4:49:57.203330,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96300423, 'precision': 0.9638794, 'recall': 0.96300876, 'specificity': 0.96300876, 'f1': 0.962987, 'auroc': 0.9929991, 'binary_precision': 0.9840797, 'binary_recall': 0.9412511, 'binary_specificity': 0.98476636, 'binary_f1_score': 0.962189}
confusion matrix:
       0      1
0  28702    444
1   1713  27445
---- Validation: 
scalar performance:
{'acc': 0.9272359, 'precision': 0.6132815, 'recall': 0.76405966, 'specificity': 0.76405966, 'f1': 0.6517462, 'auroc': 0.85770905, 'binary_precision': 0.24084125, 'binary_recall': 0.589701, 'binary_specificity': 0.9384184, 'binary_f1_score': 0.34200385}
confusion matrix:
       0     1
0  17052  1119
1    247   355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86680555, 'precision': 0.59188014, 'recall': 0.8216646, 'specificity': 0.8216646, 'f1': 0.61832875, 'auroc': 0.8988668, 'binary_precision': 0.19418484, 'binary_recall': 0.77272725, 'binary_specificity': 0.87060195, 'binary_f1_score': 0.31037346}
confusion matrix:
      0    1
0  5221  776
1    55  187
early stop counter: 9
val acc:0.9272359013557434, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.8785061836242676 / 0.8785061836242676
after epoch: 15,now: 2024-08-03 07:59:44.966337,epoch time: 0:18:39.048764,used: 5:08:36.252094,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9652511, 'precision': 0.9658843, 'recall': 0.96525556, 'specificity': 0.96525556, 'f1': 0.9652395, 'auroc': 0.9936174, 'binary_precision': 0.98312026, 'binary_recall': 0.9467746, 'binary_specificity': 0.9837365, 'binary_f1_score': 0.96460515}
confusion matrix:
       0      1
0  28671    474
1   1552  27607
---- Validation: 
scalar performance:
{'acc': 0.9250519, 'precision': 0.61201817, 'recall': 0.770962, 'specificity': 0.770962, 'f1': 0.6509323, 'auroc': 0.86285543, 'binary_precision': 0.23778501, 'binary_recall': 0.6063123, 'binary_specificity': 0.93561167, 'binary_f1_score': 0.34160036}
confusion matrix:
       0     1
0  17001  1170
1    237   365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8680878, 'precision': 0.59474164, 'recall': 0.83224535, 'specificity': 0.83224535, 'f1': 0.62256247, 'auroc': 0.9034276, 'binary_precision': 0.19896373, 'binary_recall': 0.7933884, 'binary_specificity': 0.8711022, 'binary_f1_score': 0.31814417}
confusion matrix:
      0    1
0  5224  773
1    50  192
early stop counter: 10
val acc:0.9250519275665283, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.8785061836242676 / 0.8785061836242676
after epoch: 16,now: 2024-08-03 08:18:07.736730,epoch time: 0:18:22.770393,used: 5:26:59.022487,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96628016, 'precision': 0.9667337, 'recall': 0.9662839, 'specificity': 0.9662839, 'f1': 0.9662722, 'auroc': 0.99385417, 'binary_precision': 0.98134315, 'binary_recall': 0.95064986, 'binary_specificity': 0.981918, 'binary_f1_score': 0.96575266}
confusion matrix:
       0      1
0  28618    527
1   1439  27720
---- Validation: 
scalar performance:
{'acc': 0.9153039, 'precision': 0.6023659, 'recall': 0.7787752, 'specificity': 0.7787752, 'f1': 0.6394007, 'auroc': 0.8666539, 'binary_precision': 0.21771428, 'binary_recall': 0.63289034, 'binary_specificity': 0.92466015, 'binary_f1_score': 0.32397956}
confusion matrix:
       0     1
0  16802  1369
1    221   381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85366243, 'precision': 0.5885298, 'recall': 0.836638, 'specificity': 0.836638, 'f1': 0.6103884, 'auroc': 0.9067172, 'binary_precision': 0.185567, 'binary_recall': 0.8181818, 'binary_specificity': 0.8550942, 'binary_f1_score': 0.302521}
confusion matrix:
      0    1
0  5128  869
1    44  198
early stop counter: 11
val acc:0.9153038859367371, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.8785061836242676 / 0.8785061836242676
after epoch: 17,now: 2024-08-03 08:36:43.357022,epoch time: 0:18:35.620292,used: 5:45:34.642779,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9681154, 'precision': 0.9685558, 'recall': 0.9681191, 'specificity': 0.9681191, 'f1': 0.96810806, 'auroc': 0.99440765, 'binary_precision': 0.98298067, 'binary_recall': 0.95274186, 'binary_specificity': 0.9834963, 'binary_f1_score': 0.967625}
confusion matrix:
       0      1
0  28664    481
1   1378  27781
---- Validation: 
scalar performance:
{'acc': 0.9084323, 'precision': 0.59614396, 'recall': 0.78084695, 'specificity': 0.78084695, 'f1': 0.63098955, 'auroc': 0.8700909, 'binary_precision': 0.20496567, 'binary_recall': 0.64451826, 'binary_specificity': 0.9171757, 'binary_f1_score': 0.31102204}
confusion matrix:
       0     1
0  16666  1505
1    214   388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84805256, 'precision': 0.58632475, 'recall': 0.83768535, 'specificity': 0.83768535, 'f1': 0.60578036, 'auroc': 0.90842736, 'binary_precision': 0.18083182, 'binary_recall': 0.8264463, 'binary_specificity': 0.84892446, 'binary_f1_score': 0.2967359}
confusion matrix:
      0    1
0  5091  906
1    42  200
early stop counter: 12
val acc:0.9084323048591614, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.8785061836242676 / 0.8785061836242676
after epoch: 18,now: 2024-08-03 08:55:22.554662,epoch time: 0:18:39.197640,used: 6:04:13.840419,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9681154, 'precision': 0.9685503, 'recall': 0.96811855, 'specificity': 0.96811855, 'f1': 0.9681082, 'auroc': 0.99466014, 'binary_precision': 0.98287755, 'binary_recall': 0.9528431, 'binary_specificity': 0.98339397, 'binary_f1_score': 0.96762735}
confusion matrix:
       0      1
0  28662    484
1   1375  27783
---- Validation: 
scalar performance:
{'acc': 0.9211101, 'precision': 0.6082867, 'recall': 0.7761532, 'specificity': 0.7761532, 'f1': 0.646821, 'auroc': 0.8692595, 'binary_precision': 0.22987093, 'binary_recall': 0.62126243, 'binary_specificity': 0.931044, 'binary_f1_score': 0.33557647}
confusion matrix:
       0     1
0  16918  1253
1    228   374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8647219, 'precision': 0.5934075, 'recall': 0.8344599, 'specificity': 0.8344599, 'f1': 0.6199431, 'auroc': 0.90835154, 'binary_precision': 0.1959596, 'binary_recall': 0.8016529, 'binary_specificity': 0.86726695, 'binary_f1_score': 0.3149351}
confusion matrix:
      0    1
0  5201  796
1    48  194
early stop counter: 13
val acc:0.9211100935935974, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.8785061836242676 / 0.8785061836242676
after epoch: 19,now: 2024-08-03 09:14:09.670238,epoch time: 0:18:47.115576,used: 6:23:00.955995,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96869856, 'precision': 0.9691508, 'recall': 0.96870065, 'specificity': 0.96870065, 'f1': 0.9686911, 'auroc': 0.99463713, 'binary_precision': 0.98375165, 'binary_recall': 0.9531486, 'binary_specificity': 0.98425275, 'binary_f1_score': 0.9682084}
confusion matrix:
       0      1
0  28689    459
1   1366  27790
---- Validation: 
scalar performance:
{'acc': 0.91903263, 'precision': 0.60616064, 'recall': 0.7774892, 'specificity': 0.7774892, 'f1': 0.6442403, 'auroc': 0.87104964, 'binary_precision': 0.22547847, 'binary_recall': 0.62624586, 'binary_specificity': 0.9287326, 'binary_f1_score': 0.33157432}
confusion matrix:
       0     1
0  16876  1295
1    225   377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86263824, 'precision': 0.59252506, 'recall': 0.8353588, 'specificity': 0.8353588, 'f1': 0.618222, 'auroc': 0.9095925, 'binary_precision': 0.19402985, 'binary_recall': 0.8057851, 'binary_specificity': 0.8649325, 'binary_f1_score': 0.3127506}
confusion matrix:
      0    1
0  5187  810
1    47  195
early stop counter: 14
val acc:0.919032633304596, best validation acc: 0.9342672824859619, corresponding to test acc:                         0.8785061836242676 / 0.8785061836242676
after epoch: 20,now: 2024-08-03 09:32:45.048308,epoch time: 0:18:35.378070,used: 6:41:36.334065,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_51_08_seed_2_24046974
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 20 with time: 6:41:36.334065 at 2024-08-03 09:32:45.048308
persisted model performance metric: 

scalar performance:
{'acc': 0.8785062, 'precision': 0.57707405, 'recall': 0.728614, 'specificity': 0.728614, 'f1': 0.5996399, 'auroc': 0.82654274, 'binary_precision': 0.17341772, 'binary_recall': 0.5661157, 'binary_specificity': 0.8911122, 'binary_f1_score': 0.26550385}
confusion matrix:
      0    1
0  5344  653
1   105  137
oracle model performance metric: 

scalar performance:
{'acc': 0.8785062, 'precision': 0.57707405, 'recall': 0.728614, 'specificity': 0.728614, 'f1': 0.5996399, 'auroc': 0.82654274, 'binary_precision': 0.17341772, 'binary_recall': 0.5661157, 'binary_specificity': 0.8911122, 'binary_f1_score': 0.26550385}
confusion matrix:
      0    1
0  5344  653
1   105  137
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_halffreeze_2024-08-02_13-29-50/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196696 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |  17485 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 196696 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool | 179211 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |  17485 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   7827 MiB |   1433 TiB |   1433 TiB |
|       from large pool | 178979 KiB |   7804 MiB |   1412 TiB |   1412 TiB |
|       from small pool |  16481 KiB |     36 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8530 MiB |  25074 MiB |  16560 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25000 MiB |  16526 MiB |
|       from small pool |     40 MiB |     44 MiB |     74 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  40872 KiB | 732464 KiB |    777 TiB |    777 TiB |
|       from large pool |  31733 KiB | 730714 KiB |    755 TiB |    755 TiB |
|       from small pool |   9139 KiB |  23272 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7783    |  280477 K  |  280474 K  |
|       from large pool |      79    |     762    |  136426 K  |  136426 K  |
|       from small pool |    2887    |    7702    |  144051 K  |  144048 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7783    |  280477 K  |  280474 K  |
|       from large pool |      79    |     762    |  136426 K  |  136426 K  |
|       from small pool |    2887    |    7702    |  144051 K  |  144048 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     371    |    1062    |     693    |
|       from large pool |     349    |     349    |    1025    |     676    |
|       from small pool |      20    |      22    |      37    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    3667    |  153593 K  |  153593 K  |
|       from large pool |      11    |     352    |   92128 K  |   92128 K  |
|       from small pool |      24    |    3657    |   61464 K  |   61464 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7805 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     37 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |   1433 TiB |   1433 TiB |
|       from large pool |  16640 KiB |   7804 MiB |   1412 TiB |   1412 TiB |
|       from small pool |      0 KiB |     36 MiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 237568 KiB |   8530 MiB |  25074 MiB |  24842 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25000 MiB |  24794 MiB |
|       from small pool |  26624 KiB |     44 MiB |     74 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |    777 TiB |    777 TiB |
|       from large pool |  30464 KiB | 730714 KiB |    755 TiB |    755 TiB |
|       from small pool |      0 KiB |  23272 KiB |     21 TiB |     21 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7783    |  280477 K  |  280477 K  |
|       from large pool |       2    |     762    |  136426 K  |  136426 K  |
|       from small pool |       0    |    7702    |  144051 K  |  144051 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7783    |  280477 K  |  280477 K  |
|       from large pool |       2    |     762    |  136426 K  |  136426 K  |
|       from small pool |       0    |    7702    |  144051 K  |  144051 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |    1062    |    1039    |
|       from large pool |      10    |     349    |    1025    |    1015    |
|       from small pool |      13    |      22    |      37    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3667    |  153594 K  |  153594 K  |
|       from large pool |       3    |     352    |   92128 K  |   92128 K  |
|       from small pool |       0    |    3657    |   61465 K  |   61465 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Aug  3 09:34:04 2024]
Finished job 0.
1 of 1 steps (100%) done
