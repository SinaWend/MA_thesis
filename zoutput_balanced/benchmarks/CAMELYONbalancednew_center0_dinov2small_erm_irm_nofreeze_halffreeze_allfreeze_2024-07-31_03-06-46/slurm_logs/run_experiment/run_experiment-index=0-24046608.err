Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Aug  2 13:08:12 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-02_13-07-07/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-02_13-07-07/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608

 Experiment start at: 2024-08-02 13:15:35.550084
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9880927, 'precision': 0.9882995, 'recall': 0.98810077, 'specificity': 0.98810077, 'f1': 0.9880917, 'auroc': 0.999218, 'binary_precision': 0.998541, 'binary_recall': 0.9776322, 'binary_specificity': 0.9985693, 'binary_f1_score': 0.9879761}
confusion matrix:
       0      1
0  28617     41
1    642  28060
---- Validation: 
scalar performance:
{'acc': 0.95274585, 'precision': 0.6749628, 'recall': 0.746769, 'specificity': 0.746769, 'f1': 0.7037861, 'auroc': 0.920642, 'binary_precision': 0.3669924, 'binary_recall': 0.525661, 'binary_specificity': 0.96787703, 'binary_f1_score': 0.43222508}
confusion matrix:
       0    1
0  17566  583
1    305  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96676254, 'precision': 0.83451104, 'recall': 0.6766583, 'specificity': 0.6766583, 'f1': 0.7287929, 'auroc': 0.938866, 'binary_precision': 0.6962963, 'binary_recall': 0.36015326, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.47474748}
confusion matrix:
      0   1
0  5956  41
1   167  94
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 13:47:26.262223,epoch time: 0:31:50.712139,used: 0:31:50.712139,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.993811, 'precision': 0.9938407, 'recall': 0.993814, 'specificity': 0.993814, 'f1': 0.99381095, 'auroc': 0.9996308, 'binary_precision': 0.9978573, 'binary_recall': 0.98975646, 'binary_specificity': 0.9978715, 'binary_f1_score': 0.9937904}
confusion matrix:
       0      1
0  28598     61
1    294  28407
---- Validation: 
scalar performance:
{'acc': 0.9627501, 'precision': 0.7291072, 'recall': 0.828454, 'specificity': 0.828454, 'f1': 0.76875985, 'auroc': 0.94352305, 'binary_precision': 0.46958378, 'binary_recall': 0.6842924, 'binary_specificity': 0.9726156, 'binary_f1_score': 0.556962}
confusion matrix:
       0    1
0  17652  497
1    203  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97235537, 'precision': 0.84933364, 'recall': 0.7730254, 'specificity': 0.7730254, 'f1': 0.8059983, 'auroc': 0.9448137, 'binary_precision': 0.7178218, 'binary_recall': 0.5555556, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.62634987}
confusion matrix:
      0    1
0  5940   57
1   116  145
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-02 14:19:07.804546,epoch time: 0:31:41.542323,used: 1:03:32.254462,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99351466, 'precision': 0.9935826, 'recall': 0.9935186, 'specificity': 0.9935186, 'f1': 0.9935144, 'auroc': 0.9997272, 'binary_precision': 0.9995415, 'binary_recall': 0.98749083, 'binary_specificity': 0.9995464, 'binary_f1_score': 0.9934796}
confusion matrix:
       0      1
0  28648     13
1    359  28340
---- Validation: 
scalar performance:
{'acc': 0.9564176, 'precision': 0.7001944, 'recall': 0.80867434, 'specificity': 0.80867434, 'f1': 0.7411705, 'auroc': 0.9355806, 'binary_precision': 0.41304347, 'binary_recall': 0.65007776, 'binary_specificity': 0.9672709, 'binary_f1_score': 0.50513595}
confusion matrix:
       0    1
0  17555  594
1    225  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97794825, 'precision': 0.8730204, 'recall': 0.84007525, 'specificity': 0.84007525, 'f1': 0.8557044, 'auroc': 0.9558055, 'binary_precision': 0.75949365, 'binary_recall': 0.6896552, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.72289157}
confusion matrix:
      0    1
0  5940   57
1    81  180
new oracle model saved
early stop counter: 1
val acc:0.9564176201820374, best validation acc: 0.9627500772476196, corresponding to test acc:                         0.9723553657531738 / 0.9779482483863831
after epoch: 3,now: 2024-08-02 14:50:21.048697,epoch time: 0:31:13.244151,used: 1:34:45.498613,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99478734, 'precision': 0.9948164, 'recall': 0.9947904, 'specificity': 0.9947904, 'f1': 0.9947873, 'auroc': 0.9997182, 'binary_precision': 0.9988058, 'binary_recall': 0.9907672, 'binary_specificity': 0.99881357, 'binary_f1_score': 0.9947703}
confusion matrix:
       0      1
0  28624     34
1    265  28437
---- Validation: 
scalar performance:
{'acc': 0.95987654, 'precision': 0.6928875, 'recall': 0.68070555, 'specificity': 0.68070555, 'f1': 0.6865711, 'auroc': 0.9179668, 'binary_precision': 0.4076539, 'binary_recall': 0.38102645, 'binary_specificity': 0.9803846, 'binary_f1_score': 0.39389068}
confusion matrix:
       0    1
0  17793  356
1    398  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.964046, 'precision': 0.8037352, 'recall': 0.6569176, 'specificity': 0.6569176, 'f1': 0.70446056, 'auroc': 0.94575876, 'binary_precision': 0.6363636, 'binary_recall': 0.3218391, 'binary_specificity': 0.991996, 'binary_f1_score': 0.4274809}
confusion matrix:
      0   1
0  5949  48
1   177  84
early stop counter: 2
val acc:0.959876537322998, best validation acc: 0.9627500772476196, corresponding to test acc:                         0.9723553657531738 / 0.9779482483863831
after epoch: 4,now: 2024-08-02 15:20:29.602964,epoch time: 0:30:08.554267,used: 2:04:54.052880,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99351466, 'precision': 0.99354696, 'recall': 0.9935176, 'specificity': 0.9935176, 'f1': 0.99351454, 'auroc': 0.9996029, 'binary_precision': 0.99771595, 'binary_recall': 0.9893031, 'binary_specificity': 0.99773204, 'binary_f1_score': 0.9934917}
confusion matrix:
       0      1
0  28595     65
1    307  28393
---- Validation: 
scalar performance:
{'acc': 0.9401341, 'precision': 0.64267087, 'recall': 0.7604912, 'specificity': 0.7604912, 'f1': 0.681022, 'auroc': 0.910877, 'binary_precision': 0.30115512, 'binary_recall': 0.5676516, 'binary_specificity': 0.95333076, 'binary_f1_score': 0.393531}
confusion matrix:
       0    1
0  17302  847
1    278  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96228826, 'precision': 0.76800156, 'recall': 0.71646744, 'specificity': 0.71646744, 'f1': 0.7391404, 'auroc': 0.9286374, 'binary_precision': 0.5598086, 'binary_recall': 0.44827586, 'binary_specificity': 0.984659, 'binary_f1_score': 0.49787232}
confusion matrix:
      0    1
0  5905   92
1   144  117
early stop counter: 3
val acc:0.9401341080665588, best validation acc: 0.9627500772476196, corresponding to test acc:                         0.9723553657531738 / 0.9779482483863831
after epoch: 5,now: 2024-08-02 15:50:33.033898,epoch time: 0:30:03.430934,used: 2:34:57.483814,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9952929, 'precision': 0.99529624, 'recall': 0.99529195, 'specificity': 0.99529195, 'f1': 0.9952929, 'auroc': 0.99985313, 'binary_precision': 0.9941949, 'binary_recall': 0.9964116, 'binary_specificity': 0.9941723, 'binary_f1_score': 0.995302}
confusion matrix:
       0      1
0  28489    167
1    103  28601
---- Validation: 
scalar performance:
{'acc': 0.9596637, 'precision': 0.7021914, 'recall': 0.73234916, 'specificity': 0.73234916, 'f1': 0.716081, 'auroc': 0.9279996, 'binary_precision': 0.42261103, 'binary_recall': 0.48833594, 'binary_specificity': 0.97636235, 'binary_f1_score': 0.45310244}
confusion matrix:
       0    1
0  17720  429
1    329  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95541704, 'precision': 0.6402674, 'recall': 0.5278166, 'specificity': 0.5278166, 'f1': 0.5400172, 'auroc': 0.9345521, 'binary_precision': 0.32, 'binary_recall': 0.06130268, 'binary_specificity': 0.9943305, 'binary_f1_score': 0.10289388}
confusion matrix:
      0   1
0  5963  34
1   245  16
early stop counter: 4
val acc:0.9596636891365051, best validation acc: 0.9627500772476196, corresponding to test acc:                         0.9723553657531738 / 0.9779482483863831
after epoch: 6,now: 2024-08-02 16:20:04.183473,epoch time: 0:29:31.149575,used: 3:04:28.633389,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98872036, 'precision': 0.98896015, 'recall': 0.98872817, 'specificity': 0.98872817, 'f1': 0.9887191, 'auroc': 0.99970543, 'binary_precision': 0.99996436, 'binary_recall': 0.97749126, 'binary_specificity': 0.99996513, 'binary_f1_score': 0.9886001}
confusion matrix:
       0      1
0  28659      1
1    646  28054
---- Validation: 
scalar performance:
{'acc': 0.96647507, 'precision': 0.76650226, 'recall': 0.5431113, 'specificity': 0.5431113, 'f1': 0.5680624, 'auroc': 0.9365252, 'binary_precision': 0.56435645, 'binary_recall': 0.08864697, 'binary_specificity': 0.99757564, 'binary_f1_score': 0.15322581}
confusion matrix:
       0   1
0  18105  44
1    586  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.47912335, 'recall': 0.49941638, 'specificity': 0.49941638, 'f1': 0.48905948, 'auroc': 0.9165758, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5990  7
1   261  0
better model found
persisted
after epoch: 7,now: 2024-08-02 16:49:28.516191,epoch time: 0:29:24.332718,used: 3:33:52.966107,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9964261, 'precision': 0.9964385, 'recall': 0.99642783, 'specificity': 0.99642783, 'f1': 0.9964261, 'auroc': 0.9998379, 'binary_precision': 0.9990892, 'binary_recall': 0.99376285, 'binary_specificity': 0.9990928, 'binary_f1_score': 0.9964189}
confusion matrix:
       0      1
0  28635     26
1    179  28520
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.7364293, 'recall': 0.72399104, 'specificity': 0.72399104, 'f1': 0.7300225, 'auroc': 0.92947507, 'binary_precision': 0.49177632, 'binary_recall': 0.46500778, 'binary_specificity': 0.9829743, 'binary_f1_score': 0.4780176}
confusion matrix:
       0    1
0  17840  309
1    344  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95717484, 'precision': 0.66958773, 'recall': 0.519572, 'specificity': 0.519572, 'f1': 0.5269708, 'auroc': 0.94064355, 'binary_precision': 0.37931034, 'binary_recall': 0.042145595, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.07586207}
confusion matrix:
      0   1
0  5979  18
1   250  11
early stop counter: 1
val acc:0.9652511477470398, best validation acc: 0.9664750695228577, corresponding to test acc:                         0.9571748375892639 / 0.9779482483863831
after epoch: 8,now: 2024-08-02 17:18:54.075148,epoch time: 0:29:25.558957,used: 4:03:18.525064,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9947699, 'precision': 0.9948111, 'recall': 0.99477386, 'specificity': 0.99477386, 'f1': 0.9947698, 'auroc': 0.99980545, 'binary_precision': 0.9995427, 'binary_recall': 0.9900014, 'binary_specificity': 0.99954635, 'binary_f1_score': 0.9947491}
confusion matrix:
       0      1
0  28643     13
1    287  28417
---- Validation: 
scalar performance:
{'acc': 0.97190297, 'precision': 0.8447033, 'recall': 0.6471788, 'specificity': 0.6471788, 'f1': 0.70332736, 'auroc': 0.941168, 'binary_precision': 0.71375465, 'binary_recall': 0.29860032, 'binary_specificity': 0.99575734, 'binary_f1_score': 0.42105263}
confusion matrix:
       0    1
0  18072   77
1    451  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.47912, 'recall': 0.499333, 'specificity': 0.499333, 'f1': 0.48901772, 'auroc': 0.90418184, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5989  8
1   261  0
better model found
persisted
after epoch: 9,now: 2024-08-02 17:48:25.919603,epoch time: 0:29:31.844455,used: 4:32:50.369519,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9945084, 'precision': 0.99451554, 'recall': 0.9945071, 'specificity': 0.9945071, 'f1': 0.9945084, 'auroc': 0.99980116, 'binary_precision': 0.9928125, 'binary_recall': 0.99623704, 'binary_specificity': 0.9927771, 'binary_f1_score': 0.99452186}
confusion matrix:
       0      1
0  28452    207
1    108  28593
---- Validation: 
scalar performance:
{'acc': 0.93555766, 'precision': 0.64558905, 'recall': 0.8121259, 'specificity': 0.8121259, 'f1': 0.6925355, 'auroc': 0.9120997, 'binary_precision': 0.30305132, 'binary_recall': 0.67962676, 'binary_specificity': 0.944625, 'binary_f1_score': 0.41918468}
confusion matrix:
       0     1
0  17144  1005
1    206   437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9715564, 'precision': 0.8186018, 'recall': 0.8349079, 'specificity': 0.8349079, 'f1': 0.82652617, 'auroc': 0.93822455, 'binary_precision': 0.65090907, 'binary_recall': 0.68582374, 'binary_specificity': 0.983992, 'binary_f1_score': 0.6679104}
confusion matrix:
      0    1
0  5901   96
1    82  179
early stop counter: 1
val acc:0.9355576634407043, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9570150375366211 / 0.9779482483863831
after epoch: 10,now: 2024-08-02 18:17:52.831546,epoch time: 0:29:26.911943,used: 5:02:17.281462,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9901325, 'precision': 0.99031425, 'recall': 0.99014074, 'specificity': 0.99014074, 'f1': 0.99013174, 'auroc': 0.999761, 'binary_precision': 0.9999645, 'binary_recall': 0.98031634, 'binary_specificity': 0.99996513, 'binary_f1_score': 0.9900429}
confusion matrix:
       0      1
0  28655      1
1    565  28139
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.89561117, 'recall': 0.5740715, 'specificity': 0.5740715, 'f1': 0.6186034, 'auroc': 0.93123263, 'binary_precision': 0.82051283, 'binary_recall': 0.14930016, 'binary_specificity': 0.9988429, 'binary_f1_score': 0.25263157}
confusion matrix:
       0   1
0  18128  21
1    547  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.4791467, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.48935127, 'auroc': 0.91478753, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5997  0
1   261  0
early stop counter: 2
val acc:0.9697743654251099, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9570150375366211 / 0.9779482483863831
after epoch: 11,now: 2024-08-02 18:47:21.936837,epoch time: 0:29:29.105291,used: 5:31:46.386753,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.997228, 'precision': 0.9972346, 'recall': 0.9972297, 'specificity': 0.9972297, 'f1': 0.997228, 'auroc': 0.99987906, 'binary_precision': 0.9992654, 'binary_recall': 0.9951923, 'binary_specificity': 0.99926716, 'binary_f1_score': 0.9972246}
confusion matrix:
       0      1
0  28635     21
1    138  28566
---- Validation: 
scalar performance:
{'acc': 0.9687633, 'precision': 0.77955675, 'recall': 0.6485536, 'specificity': 0.6485536, 'f1': 0.69218624, 'auroc': 0.9178257, 'binary_precision': 0.5833333, 'binary_recall': 0.30482116, 'binary_specificity': 0.9922861, 'binary_f1_score': 0.40040857}
confusion matrix:
       0    1
0  18009  140
1    447  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95621604, 'precision': 0.51251, 'recall': 0.50074846, 'specificity': 0.50074846, 'f1': 0.49243036, 'auroc': 0.94061047, 'binary_precision': 0.06666667, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.007246377}
confusion matrix:
      0   1
0  5983  14
1   260   1
early stop counter: 3
val acc:0.9687632918357849, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9570150375366211 / 0.9779482483863831
after epoch: 12,now: 2024-08-02 19:16:43.481391,epoch time: 0:29:21.544554,used: 6:01:07.931307,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99775106, 'precision': 0.9977573, 'recall': 0.9977525, 'specificity': 0.9977525, 'f1': 0.9977511, 'auroc': 0.9999589, 'binary_precision': 0.99972016, 'binary_recall': 0.9957841, 'binary_specificity': 0.9997209, 'binary_f1_score': 0.99774826}
confusion matrix:
       0      1
0  28651      8
1    121  28580
---- Validation: 
scalar performance:
{'acc': 0.9661558, 'precision': 0.74427235, 'recall': 0.57744855, 'specificity': 0.57744855, 'f1': 0.61367285, 'auroc': 0.91340065, 'binary_precision': 0.51758796, 'binary_recall': 0.16018662, 'binary_specificity': 0.99471045, 'binary_f1_score': 0.24465558}
confusion matrix:
       0    1
0  18053   96
1    540  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95557684, 'precision': 0.4790899, 'recall': 0.49858263, 'specificity': 0.49858263, 'f1': 0.48864195, 'auroc': 0.91662914, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5980  17
1   261   0
early stop counter: 4
val acc:0.9661558270454407, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9570150375366211 / 0.9779482483863831
after epoch: 13,now: 2024-08-02 19:45:59.858245,epoch time: 0:29:16.376854,used: 6:30:24.308161,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99672246, 'precision': 0.99673986, 'recall': 0.9967246, 'specificity': 0.9967246, 'f1': 0.9967224, 'auroc': 0.9999093, 'binary_precision': 0.99985975, 'binary_recall': 0.99358886, 'binary_specificity': 0.9998604, 'binary_f1_score': 0.9967144}
confusion matrix:
       0      1
0  28656      4
1    184  28516
---- Validation: 
scalar performance:
{'acc': 0.96753937, 'precision': 0.7920416, 'recall': 0.5676641, 'specificity': 0.5676641, 'f1': 0.6046552, 'auroc': 0.92536855, 'binary_precision': 0.6137931, 'binary_recall': 0.13841368, 'binary_specificity': 0.99691445, 'binary_f1_score': 0.22588833}
confusion matrix:
       0   1
0  18093  56
1    554  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95317996, 'precision': 0.47903952, 'recall': 0.497332, 'specificity': 0.497332, 'f1': 0.4880144, 'auroc': 0.880431, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.994664, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5965  32
1   261   0
early stop counter: 5
val acc:0.967539370059967, best validation acc: 0.9719029664993286, corresponding to test acc:                         0.9570150375366211 / 0.9779482483863831
after epoch: 14,now: 2024-08-02 20:15:20.545067,epoch time: 0:29:20.686822,used: 6:59:44.994983,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_13_15_35_seed_0_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 6:59:44.994983 at 2024-08-02 20:15:20.545067
persisted model performance metric: 

scalar performance:
{'acc': 0.95701504, 'precision': 0.47912, 'recall': 0.499333, 'specificity': 0.499333, 'f1': 0.48901772, 'auroc': 0.90418184, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5989  8
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.97794825, 'precision': 0.8730204, 'recall': 0.84007525, 'specificity': 0.84007525, 'f1': 0.8557044, 'auroc': 0.9558055, 'binary_precision': 0.75949365, 'binary_recall': 0.6896552, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.72289157}
confusion matrix:
      0    1
0  5940   57
1    81  180
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-02_13-07-07/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-02_13-07-07/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-02_13-07-07/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454140 KiB |   2002 MiB | 548596 GiB | 548596 GiB |
|       from large pool | 412453 KiB |   1969 MiB | 541663 GiB | 541662 GiB |
|       from small pool |  41687 KiB |     61 MiB |   6933 GiB |   6933 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454140 KiB |   2002 MiB | 548596 GiB | 548596 GiB |
|       from large pool | 412453 KiB |   1969 MiB | 541663 GiB | 541662 GiB |
|       from small pool |  41687 KiB |     61 MiB |   6933 GiB |   6933 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   1998 MiB | 548413 GiB | 548413 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 541494 GiB | 541493 GiB |
|       from small pool |  40679 KiB |     60 MiB |   6919 GiB |   6919 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2280 MiB |   2280 MiB |   2280 MiB |      0 B   |
|       from large pool |   2210 MiB |   2210 MiB |   2210 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 391683 KiB | 391854 KiB | 416940 GiB | 416940 GiB |
|       from large pool | 384219 KiB | 384219 KiB | 409655 GiB | 409655 GiB |
|       from small pool |   7464 KiB |  12776 KiB |   7285 GiB |   7285 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8155    |  103839 K  |  103835 K  |
|       from large pool |     187    |     311    |   50604 K  |   50604 K  |
|       from small pool |    3301    |    7967    |   53234 K  |   53231 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8155    |  103839 K  |  103835 K  |
|       from large pool |     187    |     311    |   50604 K  |   50604 K  |
|       from small pool |    3301    |    7967    |   53234 K  |   53231 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     128    |     128    |       0    |
|       from large pool |      93    |      93    |      93    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      69    |    3639    |   47496 K  |   47496 K  |
|       from large pool |      39    |      92    |   26934 K  |   26934 K  |
|       from small pool |      30    |    3600    |   20561 K  |   20561 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB | 548596 GiB | 548596 GiB |
|       from large pool |  16640 KiB |   1969 MiB | 541663 GiB | 541663 GiB |
|       from small pool |      0 KiB |     61 MiB |   6933 GiB |   6933 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB | 548596 GiB | 548596 GiB |
|       from large pool |  16640 KiB |   1969 MiB | 541663 GiB | 541663 GiB |
|       from small pool |      0 KiB |     61 MiB |   6933 GiB |   6933 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 548413 GiB | 548413 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 541494 GiB | 541494 GiB |
|       from small pool |      0 KiB |     60 MiB |   6919 GiB |   6919 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    826 MiB |   2280 MiB |   2280 MiB |   1454 MiB |
|       from large pool |    778 MiB |   2210 MiB |   2210 MiB |   1432 MiB |
|       from small pool |     48 MiB |     70 MiB |     70 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 471136 KiB | 416941 GiB | 416941 GiB |
|       from large pool |  24320 KiB | 449880 KiB | 409655 GiB | 409655 GiB |
|       from small pool |      0 KiB |  21264 KiB |   7285 GiB |   7285 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8155    |  103839 K  |  103839 K  |
|       from large pool |       2    |     311    |   50604 K  |   50604 K  |
|       from small pool |       0    |    7967    |   53234 K  |   53234 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8155    |  103839 K  |  103839 K  |
|       from large pool |       2    |     311    |   50604 K  |   50604 K  |
|       from small pool |       0    |    7967    |   53234 K  |   53234 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     128    |     128    |      69    |
|       from large pool |      35    |      93    |      93    |      58    |
|       from small pool |      24    |      35    |      35    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3639    |   47497 K  |   47497 K  |
|       from large pool |       4    |      92    |   26934 K  |   26934 K  |
|       from small pool |       0    |    3600    |   20563 K  |   20563 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB | 548596 GiB | 548596 GiB |
|       from large pool |  16640 KiB |   1969 MiB | 541663 GiB | 541663 GiB |
|       from small pool |      0 KiB |     61 MiB |   6933 GiB |   6933 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB | 548596 GiB | 548596 GiB |
|       from large pool |  16640 KiB |   1969 MiB | 541663 GiB | 541663 GiB |
|       from small pool |      0 KiB |     61 MiB |   6933 GiB |   6933 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 548413 GiB | 548413 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 541494 GiB | 541494 GiB |
|       from small pool |      0 KiB |     60 MiB |   6919 GiB |   6919 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    826 MiB |   2280 MiB |   2280 MiB |   1454 MiB |
|       from large pool |    778 MiB |   2210 MiB |   2210 MiB |   1432 MiB |
|       from small pool |     48 MiB |     70 MiB |     70 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 471136 KiB | 416941 GiB | 416941 GiB |
|       from large pool |  24320 KiB | 449880 KiB | 409655 GiB | 409655 GiB |
|       from small pool |      0 KiB |  21264 KiB |   7285 GiB |   7285 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8155    |  103839 K  |  103839 K  |
|       from large pool |       2    |     311    |   50604 K  |   50604 K  |
|       from small pool |       0    |    7967    |   53234 K  |   53234 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8155    |  103839 K  |  103839 K  |
|       from large pool |       2    |     311    |   50604 K  |   50604 K  |
|       from small pool |       0    |    7967    |   53234 K  |   53234 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     128    |     128    |      69    |
|       from large pool |      35    |      93    |      93    |      58    |
|       from small pool |      24    |      35    |      35    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3639    |   47497 K  |   47497 K  |
|       from large pool |       4    |      92    |   26934 K  |   26934 K  |
|       from small pool |       0    |    3600    |   20563 K  |   20563 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_23_35_seed_1_24046608

 Experiment start at: 2024-08-02 20:23:36.068183
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97813106, 'precision': 0.97835976, 'recall': 0.97813916, 'specificity': 0.97813916, 'f1': 0.97812873, 'auroc': 0.9977622, 'binary_precision': 0.9890028, 'binary_recall': 0.9670471, 'binary_specificity': 0.9892312, 'binary_f1_score': 0.97790176}
confusion matrix:
       0      1
0  28477    310
1    950  27879
---- Validation: 
scalar performance:
{'acc': 0.95176095, 'precision': 0.67985326, 'recall': 0.74824226, 'specificity': 0.74824226, 'f1': 0.7076939, 'auroc': 0.928912, 'binary_precision': 0.37751856, 'binary_recall': 0.5289747, 'binary_specificity': 0.9675098, 'binary_f1_score': 0.44059405}
confusion matrix:
       0    1
0  17480  587
1    317  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.972446, 'precision': 0.8436015, 'recall': 0.788849, 'specificity': 0.788849, 'f1': 0.8135909, 'auroc': 0.92163527, 'binary_precision': 0.7050691, 'binary_recall': 0.5884615, 'binary_specificity': 0.9892365, 'binary_f1_score': 0.6415094}
confusion matrix:
      0    1
0  5882   64
1   107  153
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-02 20:53:29.546756,epoch time: 0:29:53.478573,used: 0:29:53.478573,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_23_35_seed_1_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9872431, 'precision': 0.9874264, 'recall': 0.9872503, 'specificity': 0.9872503, 'f1': 0.987242, 'auroc': 0.99891686, 'binary_precision': 0.997063, 'binary_recall': 0.9773839, 'binary_specificity': 0.99711674, 'binary_f1_score': 0.98712534}
confusion matrix:
       0      1
0  28704     83
1    652  28177
---- Validation: 
scalar performance:
{'acc': 0.94967985, 'precision': 0.6558913, 'recall': 0.6870805, 'specificity': 0.6870805, 'f1': 0.6698188, 'auroc': 0.9101895, 'binary_precision': 0.33415234, 'binary_recall': 0.40416047, 'binary_specificity': 0.97000057, 'binary_f1_score': 0.36583722}
confusion matrix:
       0    1
0  17525  542
1    401  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9473091, 'precision': 0.7116865, 'recall': 0.88423115, 'specificity': 0.88423115, 'f1': 0.7682692, 'auroc': 0.9312091, 'binary_precision': 0.4317719, 'binary_recall': 0.8153846, 'binary_specificity': 0.9530777, 'binary_f1_score': 0.56458056}
confusion matrix:
      0    1
0  5667  279
1    48  212
early stop counter: 1
val acc:0.9496798515319824, best validation acc: 0.9517609477043152, corresponding to test acc:                         0.9724460244178772 / 0.9724460244178772
after epoch: 2,now: 2024-08-02 21:22:54.406355,epoch time: 0:29:24.859599,used: 0:59:18.338172,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_23_35_seed_1_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9930054, 'precision': 0.9930054, 'recall': 0.99300563, 'specificity': 0.99300563, 'f1': 0.9930054, 'auroc': 0.9995538, 'binary_precision': 0.9933359, 'binary_recall': 0.9926812, 'binary_specificity': 0.99333006, 'binary_f1_score': 0.99300843}
confusion matrix:
       0      1
0  28594    192
1    211  28619
---- Validation: 
scalar performance:
{'acc': 0.9582711, 'precision': 0.7038077, 'recall': 0.725869, 'specificity': 0.725869, 'f1': 0.7141915, 'auroc': 0.92491484, 'binary_precision': 0.42723632, 'binary_recall': 0.4754829, 'binary_specificity': 0.97625506, 'binary_f1_score': 0.4500703}
confusion matrix:
       0    1
0  17638  429
1    353  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.7718554, 'recall': 0.5819245, 'specificity': 0.5819245, 'f1': 0.62068415, 'auroc': 0.94357646, 'binary_precision': 0.57894737, 'binary_recall': 0.16923077, 'binary_specificity': 0.99461824, 'binary_f1_score': 0.26190478}
confusion matrix:
      0   1
0  5914  32
1   216  44
better model found
persisted
after epoch: 3,now: 2024-08-02 21:52:10.090241,epoch time: 0:29:15.683886,used: 1:28:34.022058,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_23_35_seed_1_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.994741, 'precision': 0.9947447, 'recall': 0.99474216, 'specificity': 0.99474216, 'f1': 0.9947411, 'auroc': 0.99967325, 'binary_precision': 0.99627686, 'binary_recall': 0.9932011, 'binary_specificity': 0.9962832, 'binary_f1_score': 0.9947366}
confusion matrix:
       0      1
0  28681    107
1    196  28632
---- Validation: 
scalar performance:
{'acc': 0.9442903, 'precision': 0.6816463, 'recall': 0.87240064, 'specificity': 0.87240064, 'f1': 0.7383148, 'auroc': 0.9395796, 'binary_precision': 0.37126994, 'binary_recall': 0.794948, 'binary_specificity': 0.9498533, 'binary_f1_score': 0.5061495}
confusion matrix:
       0    1
0  17161  906
1    138  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9709958, 'precision': 0.8086733, 'recall': 0.86716866, 'specificity': 0.86716866, 'f1': 0.835056, 'auroc': 0.9499767, 'binary_precision': 0.6282051, 'binary_recall': 0.75384617, 'binary_specificity': 0.9804911, 'binary_f1_score': 0.6853147}
confusion matrix:
      0    1
0  5830  116
1    64  196
early stop counter: 1
val acc:0.944290280342102, best validation acc: 0.9582710862159729, corresponding to test acc:                         0.9600386619567871 / 0.9724460244178772
after epoch: 4,now: 2024-08-02 22:22:02.936887,epoch time: 0:29:52.846646,used: 1:58:26.868704,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_23_35_seed_1_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9910615, 'precision': 0.9911463, 'recall': 0.99105704, 'specificity': 0.99105704, 'f1': 0.9910611, 'auroc': 0.99975216, 'binary_precision': 0.98486143, 'binary_recall': 0.99746776, 'binary_specificity': 0.9846464, 'binary_f1_score': 0.9911245}
confusion matrix:
       0      1
0  28346    442
1     73  28755
---- Validation: 
scalar performance:
{'acc': 0.9124333, 'precision': 0.6288608, 'recall': 0.864462, 'specificity': 0.864462, 'f1': 0.6763851, 'auroc': 0.9334865, 'binary_precision': 0.26527643, 'binary_recall': 0.8127786, 'binary_specificity': 0.91614544, 'binary_f1_score': 0.4}
confusion matrix:
       0     1
0  16552  1515
1    126   547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.970029, 'precision': 0.80138373, 'recall': 0.875859, 'specificity': 0.875859, 'f1': 0.8339714, 'auroc': 0.9516409, 'binary_precision': 0.6128049, 'binary_recall': 0.77307695, 'binary_specificity': 0.9786411, 'binary_f1_score': 0.6836735}
confusion matrix:
      0    1
0  5819  127
1    59  201
early stop counter: 2
val acc:0.9124333262443542, best validation acc: 0.9582710862159729, corresponding to test acc:                         0.9600386619567871 / 0.9724460244178772
after epoch: 5,now: 2024-08-02 22:51:56.470652,epoch time: 0:29:53.533765,used: 2:28:20.402469,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_23_35_seed_1_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99699736, 'precision': 0.9970084, 'recall': 0.99699926, 'specificity': 0.99699926, 'f1': 0.99699736, 'auroc': 0.999863, 'binary_precision': 0.99954677, 'binary_recall': 0.9944502, 'binary_specificity': 0.9995484, 'binary_f1_score': 0.996992}
confusion matrix:
       0      1
0  28773     13
1    160  28670
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.75441206, 'recall': 0.7420137, 'specificity': 0.7420137, 'f1': 0.74803984, 'auroc': 0.94234216, 'binary_precision': 0.52738655, 'binary_recall': 0.5007429, 'binary_specificity': 0.9832844, 'binary_f1_score': 0.5137195}
confusion matrix:
       0    1
0  17765  302
1    336  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97631323, 'precision': 0.8966998, 'recall': 0.77983326, 'specificity': 0.77983326, 'f1': 0.8271935, 'auroc': 0.951911, 'binary_precision': 0.8121547, 'binary_recall': 0.5653846, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.6666666}
confusion matrix:
      0    1
0  5912   34
1   113  147
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-08-02 23:21:44.746649,epoch time: 0:29:48.275997,used: 2:58:08.678466,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_23_35_seed_1_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99224174, 'precision': 0.9923496, 'recall': 0.9922472, 'specificity': 0.9922472, 'f1': 0.9922414, 'auroc': 0.9998157, 'binary_precision': 0.99982387, 'binary_recall': 0.9846682, 'binary_specificity': 0.9998263, 'binary_f1_score': 0.99218816}
confusion matrix:
       0      1
0  28782      5
1    442  28387
---- Validation: 
scalar performance:
{'acc': 0.9646745, 'precision': 0.74419254, 'recall': 0.6426426, 'specificity': 0.6426426, 'f1': 0.6786474, 'auroc': 0.93964815, 'binary_precision': 0.5142119, 'binary_recall': 0.29569092, 'binary_specificity': 0.9895943, 'binary_f1_score': 0.37547168}
confusion matrix:
       0    1
0  17879  188
1    474  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95278764, 'precision': 0.5280181, 'recall': 0.504581, 'specificity': 0.504581, 'f1': 0.5011926, 'auroc': 0.9398366, 'binary_precision': 0.09756097, 'binary_recall': 0.015384615, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.026578074}
confusion matrix:
      0   1
0  5909  37
1   256   4
early stop counter: 1
val acc:0.9646744728088379, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9763132333755493 / 0.9763132333755493
after epoch: 7,now: 2024-08-02 23:51:39.811403,epoch time: 0:29:55.064754,used: 3:28:03.743220,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_23_35_seed_1_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9963552, 'precision': 0.9963727, 'recall': 0.9963575, 'specificity': 0.9963575, 'f1': 0.9963552, 'auroc': 0.9998293, 'binary_precision': 0.9995113, 'binary_recall': 0.9932013, 'binary_specificity': 0.9995137, 'binary_f1_score': 0.99634635}
confusion matrix:
       0      1
0  28773     14
1    196  28633
---- Validation: 
scalar performance:
{'acc': 0.95218784, 'precision': 0.6415016, 'recall': 0.62400717, 'specificity': 0.62400717, 'f1': 0.63207555, 'auroc': 0.91569334, 'binary_precision': 0.3100511, 'binary_recall': 0.2704309, 'binary_specificity': 0.97758347, 'binary_f1_score': 0.28888887}
confusion matrix:
       0    1
0  17662  405
1    491  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95278764, 'precision': 0.5280181, 'recall': 0.504581, 'specificity': 0.504581, 'f1': 0.5011926, 'auroc': 0.9272868, 'binary_precision': 0.09756097, 'binary_recall': 0.015384615, 'binary_specificity': 0.99377733, 'binary_f1_score': 0.026578074}
confusion matrix:
      0   1
0  5909  37
1   256   4
early stop counter: 2
val acc:0.9521878361701965, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9763132333755493 / 0.9763132333755493
after epoch: 8,now: 2024-08-03 00:24:06.917659,epoch time: 0:32:27.106256,used: 4:00:30.849476,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_23_35_seed_1_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.994203, 'precision': 0.9942371, 'recall': 0.9942062, 'specificity': 0.9942062, 'f1': 0.994203, 'auroc': 0.99964416, 'binary_precision': 0.9985304, 'binary_recall': 0.9898713, 'binary_specificity': 0.998541, 'binary_f1_score': 0.99418205}
confusion matrix:
       0      1
0  28745     42
1    292  28537
---- Validation: 
scalar performance:
{'acc': 0.9307364, 'precision': 0.645488, 'recall': 0.82460105, 'specificity': 0.82460105, 'f1': 0.69364357, 'auroc': 0.91704094, 'binary_precision': 0.3023403, 'binary_recall': 0.7102526, 'binary_specificity': 0.93894947, 'binary_f1_score': 0.42413488}
confusion matrix:
       0     1
0  16964  1103
1    195   478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96003866, 'precision': 0.7510916, 'recall': 0.76766217, 'specificity': 0.76766217, 'f1': 0.75907373, 'auroc': 0.9315734, 'binary_precision': 0.5215827, 'binary_recall': 0.5576923, 'binary_specificity': 0.97763205, 'binary_f1_score': 0.5390335}
confusion matrix:
      0    1
0  5813  133
1   115  145
early stop counter: 3
val acc:0.9307364225387573, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9763132333755493 / 0.9763132333755493
after epoch: 9,now: 2024-08-03 00:54:23.195435,epoch time: 0:30:16.277776,used: 4:30:47.127252,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_23_35_seed_1_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9960428, 'precision': 0.996067, 'recall': 0.9960455, 'specificity': 0.9960455, 'f1': 0.9960427, 'auroc': 0.9999008, 'binary_precision': 0.99972045, 'binary_recall': 0.9923688, 'binary_specificity': 0.9997221, 'binary_f1_score': 0.9960311}
confusion matrix:
       0      1
0  28779      8
1    220  28609
---- Validation: 
scalar performance:
{'acc': 0.96221983, 'precision': 0.7058448, 'recall': 0.5927314, 'specificity': 0.5927314, 'f1': 0.6253556, 'auroc': 0.937826, 'binary_precision': 0.44107744, 'binary_recall': 0.19465081, 'binary_specificity': 0.990812, 'binary_f1_score': 0.2701031}
confusion matrix:
       0    1
0  17901  166
1    542  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9555269, 'precision': 0.4789984, 'recall': 0.49865454, 'specificity': 0.49865454, 'f1': 0.48862886, 'auroc': 0.9305996, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9973091, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5930  16
1   260   0
early stop counter: 4
val acc:0.9622198343276978, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9763132333755493 / 0.9763132333755493
after epoch: 10,now: 2024-08-03 01:26:30.277774,epoch time: 0:32:07.082339,used: 5:02:54.209591,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_23_35_seed_1_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99350876, 'precision': 0.99358475, 'recall': 0.9935134, 'specificity': 0.9935134, 'f1': 0.9935085, 'auroc': 0.999846, 'binary_precision': 0.9998946, 'binary_recall': 0.987131, 'binary_specificity': 0.9998958, 'binary_f1_score': 0.9934718}
confusion matrix:
       0      1
0  28784      3
1    371  28458
---- Validation: 
scalar performance:
{'acc': 0.9627535, 'precision': 0.68326616, 'recall': 0.5350715, 'specificity': 0.5350715, 'f1': 0.5531424, 'auroc': 0.9260005, 'binary_precision': 0.4, 'binary_recall': 0.0742942, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.12531328}
confusion matrix:
       0   1
0  17992  75
1    623  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95230424, 'precision': 0.4789303, 'recall': 0.49697277, 'specificity': 0.49697277, 'f1': 0.48778474, 'auroc': 0.8429597, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5910  36
1   260   0
early stop counter: 5
val acc:0.9627534747123718, best validation acc: 0.9659551978111267, corresponding to test acc:                         0.9763132333755493 / 0.9763132333755493
after epoch: 11,now: 2024-08-03 01:58:36.209416,epoch time: 0:32:05.931642,used: 5:35:00.141233,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_02_20_23_35_seed_1_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 5:35:00.141233 at 2024-08-03 01:58:36.209416
persisted model performance metric: 

scalar performance:
{'acc': 0.97631323, 'precision': 0.8966998, 'recall': 0.77983326, 'specificity': 0.77983326, 'f1': 0.8271935, 'auroc': 0.951911, 'binary_precision': 0.8121547, 'binary_recall': 0.5653846, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.6666666}
confusion matrix:
      0    1
0  5912   34
1   113  147
oracle model performance metric: 

scalar performance:
{'acc': 0.97631323, 'precision': 0.8966998, 'recall': 0.77983326, 'specificity': 0.77983326, 'f1': 0.8271935, 'auroc': 0.951911, 'binary_precision': 0.8121547, 'binary_recall': 0.5653846, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.6666666}
confusion matrix:
      0    1
0  5912   34
1   113  147
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-02_13-07-07/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-02_13-07-07/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454195 KiB |   2002 MiB |    958 TiB |    958 TiB |
|       from large pool | 412519 KiB |   1969 MiB |    946 TiB |    946 TiB |
|       from small pool |  41675 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 454195 KiB |   2002 MiB |    958 TiB |    958 TiB |
|       from large pool | 412519 KiB |   1969 MiB |    946 TiB |    946 TiB |
|       from small pool |  41675 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   1998 MiB |    958 TiB |    958 TiB |
|       from large pool | 407075 KiB |   1966 MiB |    946 TiB |    946 TiB |
|       from small pool |  40676 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2280 MiB |   3730 MiB |   1454 MiB |
|       from large pool |   2212 MiB |   2212 MiB |   3644 MiB |   1432 MiB |
|       from small pool |     64 MiB |     70 MiB |     86 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 365005 KiB | 471136 KiB | 741745 GiB | 741744 GiB |
|       from large pool | 357528 KiB | 449880 KiB | 728749 GiB | 728749 GiB |
|       from small pool |   7476 KiB |  21264 KiB |  12995 GiB |  12995 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8187    |  185821 K  |  185818 K  |
|       from large pool |     187    |     311    |   90564 K  |   90564 K  |
|       from small pool |    3277    |    7999    |   95256 K  |   95253 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8187    |  185821 K  |  185818 K  |
|       from large pool |     187    |     311    |   90564 K  |   90564 K  |
|       from small pool |    3277    |    7999    |   95256 K  |   95253 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     128    |     195    |      69    |
|       from large pool |      94    |      94    |     152    |      58    |
|       from small pool |      32    |      35    |      43    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |    3655    |   85061 K  |   85061 K  |
|       from large pool |      39    |      95    |   48208 K  |   48208 K  |
|       from small pool |      31    |    3616    |   36853 K  |   36853 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB |    958 TiB |    958 TiB |
|       from large pool |  16640 KiB |   1969 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB |    958 TiB |    958 TiB |
|       from large pool |  16640 KiB |   1969 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    958 TiB |    958 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    800 MiB |   2280 MiB |   3730 MiB |   2930 MiB |
|       from large pool |    752 MiB |   2212 MiB |   3644 MiB |   2892 MiB |
|       from small pool |     48 MiB |     70 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 471136 KiB | 741745 GiB | 741745 GiB |
|       from large pool |  24320 KiB | 449880 KiB | 728750 GiB | 728750 GiB |
|       from small pool |      0 KiB |  22399 KiB |  12995 GiB |  12995 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8187    |  185821 K  |  185821 K  |
|       from large pool |       2    |     311    |   90564 K  |   90564 K  |
|       from small pool |       0    |    7999    |   95256 K  |   95256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8187    |  185821 K  |  185821 K  |
|       from large pool |       2    |     311    |   90564 K  |   90564 K  |
|       from small pool |       0    |    7999    |   95256 K  |   95256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     128    |     195    |     137    |
|       from large pool |      34    |      94    |     152    |     118    |
|       from small pool |      24    |      35    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3655    |   85063 K  |   85063 K  |
|       from large pool |       4    |      95    |   48208 K  |   48208 K  |
|       from small pool |       0    |    3616    |   36854 K  |   36854 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB |    958 TiB |    958 TiB |
|       from large pool |  16640 KiB |   1969 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB |    958 TiB |    958 TiB |
|       from large pool |  16640 KiB |   1969 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     61 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    958 TiB |    958 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    946 TiB |    946 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    800 MiB |   2280 MiB |   3730 MiB |   2930 MiB |
|       from large pool |    752 MiB |   2212 MiB |   3644 MiB |   2892 MiB |
|       from small pool |     48 MiB |     70 MiB |     86 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 471136 KiB | 741745 GiB | 741745 GiB |
|       from large pool |  24320 KiB | 449880 KiB | 728750 GiB | 728750 GiB |
|       from small pool |      0 KiB |  22399 KiB |  12995 GiB |  12995 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8187    |  185821 K  |  185821 K  |
|       from large pool |       2    |     311    |   90564 K  |   90564 K  |
|       from small pool |       0    |    7999    |   95256 K  |   95256 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8187    |  185821 K  |  185821 K  |
|       from large pool |       2    |     311    |   90564 K  |   90564 K  |
|       from small pool |       0    |    7999    |   95256 K  |   95256 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     128    |     195    |     137    |
|       from large pool |      34    |      94    |     152    |     118    |
|       from small pool |      24    |      35    |      43    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3655    |   85063 K  |   85063 K  |
|       from large pool |       4    |      95    |   48208 K  |   48208 K  |
|       from small pool |       0    |    3616    |   36854 K  |   36854 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608

 Experiment start at: 2024-08-03 02:06:57.947833
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9910298, 'precision': 0.99103063, 'recall': 0.9910299, 'specificity': 0.9910299, 'f1': 0.9910298, 'auroc': 0.99943715, 'binary_precision': 0.99172276, 'binary_recall': 0.99032825, 'binary_specificity': 0.9917316, 'binary_f1_score': 0.99102503}
confusion matrix:
       0      1
0  28906    241
1    282  28875
---- Validation: 
scalar performance:
{'acc': 0.8589996, 'precision': 0.5742545, 'recall': 0.8195557, 'specificity': 0.8195557, 'f1': 0.5916479, 'auroc': 0.8901371, 'binary_precision': 0.1569943, 'binary_recall': 0.77740866, 'binary_specificity': 0.86170274, 'binary_f1_score': 0.2612336}
confusion matrix:
       0     1
0  15658  2513
1    134   468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.873858, 'precision': 0.59984744, 'recall': 0.84119505, 'specificity': 0.84119505, 'f1': 0.6308555, 'auroc': 0.8979088, 'binary_precision': 0.20855615, 'binary_recall': 0.8057851, 'binary_specificity': 0.876605, 'binary_f1_score': 0.3313509}
confusion matrix:
      0    1
0  5257  740
1    47  195
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-08-03 02:37:03.693215,epoch time: 0:30:05.745382,used: 0:30:05.745382,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99259055, 'precision': 0.99259496, 'recall': 0.99259025, 'specificity': 0.99259025, 'f1': 0.9925905, 'auroc': 0.99965894, 'binary_precision': 0.9911771, 'binary_recall': 0.9940325, 'binary_specificity': 0.991148, 'binary_f1_score': 0.9926027}
confusion matrix:
       0      1
0  28888    258
1    174  28984
---- Validation: 
scalar performance:
{'acc': 0.9573856, 'precision': 0.6813551, 'recall': 0.7434968, 'specificity': 0.7434968, 'f1': 0.7072375, 'auroc': 0.9301569, 'binary_precision': 0.3789731, 'binary_recall': 0.51495016, 'binary_specificity': 0.9720434, 'binary_f1_score': 0.4366197}
confusion matrix:
       0    1
0  17663  508
1    292  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97547686, 'precision': 0.8836864, 'recall': 0.7493147, 'specificity': 0.7493147, 'f1': 0.80097246, 'auroc': 0.93686444, 'binary_precision': 0.7870968, 'binary_recall': 0.5041322, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.61460954}
confusion matrix:
      0    1
0  5964   33
1   120  122
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-08-03 03:06:32.784428,epoch time: 0:29:29.091213,used: 0:59:34.836595,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.990824, 'precision': 0.990824, 'recall': 0.990824, 'specificity': 0.990824, 'f1': 0.9908239, 'auroc': 0.9993969, 'binary_precision': 0.9910108, 'binary_recall': 0.9906369, 'binary_specificity': 0.9910111, 'binary_f1_score': 0.99082375}
confusion matrix:
       0      1
0  28885    262
1    273  28884
---- Validation: 
scalar performance:
{'acc': 0.88664573, 'precision': 0.5731818, 'recall': 0.74871355, 'specificity': 0.74871355, 'f1': 0.5962603, 'auroc': 0.8582634, 'binary_precision': 0.1608889, 'binary_recall': 0.6013289, 'binary_specificity': 0.8960982, 'binary_f1_score': 0.25385696}
confusion matrix:
       0     1
0  16283  1888
1    240   362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9044719, 'precision': 0.61552966, 'recall': 0.8055684, 'specificity': 0.8055684, 'f1': 0.6551279, 'auroc': 0.8508476, 'binary_precision': 0.24421965, 'binary_recall': 0.6983471, 'binary_specificity': 0.9127897, 'binary_f1_score': 0.36188436}
confusion matrix:
      0    1
0  5474  523
1    73  169
early stop counter: 1
val acc:0.8866457343101501, best validation acc: 0.9573855996131897, corresponding to test acc:                         0.975476861000061 / 0.975476861000061
after epoch: 3,now: 2024-08-03 03:36:01.175030,epoch time: 0:29:28.390602,used: 1:29:03.227197,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.99435717, 'precision': 0.9943576, 'recall': 0.9943571, 'specificity': 0.9943571, 'f1': 0.9943571, 'auroc': 0.9997523, 'binary_precision': 0.9939348, 'binary_recall': 0.99478704, 'binary_specificity': 0.9939271, 'binary_f1_score': 0.9943607}
confusion matrix:
       0      1
0  28969    177
1    152  29006
---- Validation: 
scalar performance:
{'acc': 0.96777284, 'precision': 0.73792064, 'recall': 0.6773912, 'specificity': 0.6773912, 'f1': 0.70279133, 'auroc': 0.925676, 'binary_precision': 0.4966292, 'binary_recall': 0.36710963, 'binary_specificity': 0.9876727, 'binary_f1_score': 0.42215854}
confusion matrix:
       0    1
0  17947  224
1    381  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96602017, 'precision': 0.94148666, 'recall': 0.5679317, 'specificity': 0.5679317, 'f1': 0.6100165, 'auroc': 0.9248998, 'binary_precision': 0.9166667, 'binary_recall': 0.13636364, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.23741005}
confusion matrix:
      0   1
0  5994   3
1   209  33
better model found
persisted
after epoch: 4,now: 2024-08-03 04:05:30.246956,epoch time: 0:29:29.071926,used: 1:58:32.299123,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99595225, 'precision': 0.9959544, 'recall': 0.9959525, 'specificity': 0.9959525, 'f1': 0.99595225, 'auroc': 0.99985933, 'binary_precision': 0.99704415, 'binary_recall': 0.99485576, 'binary_specificity': 0.9970492, 'binary_f1_score': 0.99594873}
confusion matrix:
       0      1
0  29059     86
1    150  29009
---- Validation: 
scalar performance:
{'acc': 0.9438023, 'precision': 0.61061007, 'recall': 0.6593874, 'specificity': 0.6593874, 'f1': 0.6296749, 'auroc': 0.91180074, 'binary_precision': 0.2429058, 'binary_recall': 0.3554817, 'binary_specificity': 0.96329314, 'binary_f1_score': 0.2886042}
confusion matrix:
       0    1
0  17504  667
1    388  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9685847, 'precision': 0.81484205, 'recall': 0.69814384, 'specificity': 0.69814384, 'f1': 0.74189144, 'auroc': 0.93118906, 'binary_precision': 0.6533333, 'binary_recall': 0.40495867, 'binary_specificity': 0.991329, 'binary_f1_score': 0.5}
confusion matrix:
      0   1
0  5945  52
1   144  98
early stop counter: 1
val acc:0.9438022971153259, best validation acc: 0.9677728414535522, corresponding to test acc:                         0.9660201668739319 / 0.975476861000061
after epoch: 5,now: 2024-08-03 04:35:04.579002,epoch time: 0:29:34.332046,used: 2:28:06.631169,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99099547, 'precision': 0.99115145, 'recall': 0.9909976, 'specificity': 0.9909976, 'f1': 0.9909948, 'auroc': 0.9998223, 'binary_precision': 0.9999651, 'binary_recall': 0.98202956, 'binary_specificity': 0.99996567, 'binary_f1_score': 0.9909162}
confusion matrix:
       0      1
0  29144      1
1    524  28635
---- Validation: 
scalar performance:
{'acc': 0.9687849, 'precision': 0.75587624, 'recall': 0.59118474, 'specificity': 0.59118474, 'f1': 0.63118625, 'auroc': 0.94394255, 'binary_precision': 0.53809524, 'binary_recall': 0.18770765, 'binary_specificity': 0.9946618, 'binary_f1_score': 0.27832514}
confusion matrix:
       0    1
0  18074   97
1    489  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96121174, 'precision': 0.73186946, 'recall': 0.5337066, 'specificity': 0.5337066, 'f1': 0.5516778, 'auroc': 0.9194952, 'binary_precision': 0.5, 'binary_recall': 0.07024793, 'binary_specificity': 0.99716526, 'binary_f1_score': 0.1231884}
confusion matrix:
      0   1
0  5980  17
1   225  17
better model found
persisted
after epoch: 6,now: 2024-08-03 05:04:34.933046,epoch time: 0:29:30.354044,used: 2:57:36.985213,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99464875, 'precision': 0.99468493, 'recall': 0.9946495, 'specificity': 0.9946495, 'f1': 0.99464864, 'auroc': 0.99973905, 'binary_precision': 0.9989621, 'binary_recall': 0.99032825, 'binary_specificity': 0.99897075, 'binary_f1_score': 0.9946264}
confusion matrix:
       0      1
0  29117     30
1    282  28875
---- Validation: 
scalar performance:
{'acc': 0.96612155, 'precision': 0.69874835, 'recall': 0.5761571, 'specificity': 0.5761571, 'f1': 0.60728145, 'auroc': 0.9242098, 'binary_precision': 0.42477876, 'binary_recall': 0.15946844, 'binary_specificity': 0.9928457, 'binary_f1_score': 0.23188406}
confusion matrix:
       0    1
0  18041  130
1    506   96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9560827, 'precision': 0.48050588, 'recall': 0.497332, 'specificity': 0.497332, 'f1': 0.48877415, 'auroc': 0.9242376, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.994664, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5965  32
1   242   0
early stop counter: 1
val acc:0.9661215543746948, best validation acc: 0.9687849283218384, corresponding to test acc:                         0.9612117409706116 / 0.975476861000061
after epoch: 7,now: 2024-08-03 05:34:07.311670,epoch time: 0:29:32.378624,used: 3:27:09.363837,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99694705, 'precision': 0.9969475, 'recall': 0.99694693, 'specificity': 0.99694693, 'f1': 0.99694705, 'auroc': 0.9999047, 'binary_precision': 0.9965051, 'binary_recall': 0.9973936, 'binary_specificity': 0.99650025, 'binary_f1_score': 0.9969492}
confusion matrix:
       0      1
0  29043    102
1     76  29083
---- Validation: 
scalar performance:
{'acc': 0.9262771, 'precision': 0.62073153, 'recall': 0.8005046, 'specificity': 0.8005046, 'f1': 0.6638699, 'auroc': 0.9094279, 'binary_precision': 0.25315657, 'binary_recall': 0.66611296, 'binary_specificity': 0.9348963, 'binary_f1_score': 0.36688012}
confusion matrix:
       0     1
0  16988  1183
1    201   401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.97691935, 'precision': 0.83146477, 'recall': 0.88885695, 'specificity': 0.88885695, 'f1': 0.8576112, 'auroc': 0.9531884, 'binary_precision': 0.67132866, 'binary_recall': 0.7933884, 'binary_specificity': 0.98432547, 'binary_f1_score': 0.7272726}
confusion matrix:
      0    1
0  5903   94
1    50  192
new oracle model saved
early stop counter: 2
val acc:0.9262771010398865, best validation acc: 0.9687849283218384, corresponding to test acc:                         0.9612117409706116 / 0.9769193530082703
after epoch: 8,now: 2024-08-03 06:03:36.690429,epoch time: 0:29:29.378759,used: 3:56:38.742596,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9956264, 'precision': 0.9956617, 'recall': 0.9956273, 'specificity': 0.9956273, 'f1': 0.99562633, 'auroc': 0.99984866, 'binary_precision': 0.9998962, 'binary_recall': 0.99135745, 'binary_specificity': 0.99989706, 'binary_f1_score': 0.99560857}
confusion matrix:
       0      1
0  29143      3
1    252  28906
---- Validation: 
scalar performance:
{'acc': 0.96564215, 'precision': 0.6782553, 'recall': 0.5566363, 'specificity': 0.5566363, 'f1': 0.5824809, 'auroc': 0.94614565, 'binary_precision': 0.38502672, 'binary_recall': 0.11960133, 'binary_specificity': 0.99367124, 'binary_f1_score': 0.18250951}
confusion matrix:
       0    1
0  18056  115
1    530   72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95640326, 'precision': 0.5224018, 'recall': 0.503447, 'specificity': 0.503447, 'f1': 0.49964383, 'auroc': 0.94101644, 'binary_precision': 0.083333336, 'binary_recall': 0.012396694, 'binary_specificity': 0.99449724, 'binary_f1_score': 0.021582736}
confusion matrix:
      0   1
0  5964  33
1   239   3
early stop counter: 3
val acc:0.9656421542167664, best validation acc: 0.9687849283218384, corresponding to test acc:                         0.9612117409706116 / 0.9769193530082703
after epoch: 9,now: 2024-08-03 06:33:16.575525,epoch time: 0:29:39.885096,used: 4:26:18.627692,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99615806, 'precision': 0.9961831, 'recall': 0.99615884, 'specificity': 0.99615884, 'f1': 0.996158, 'auroc': 0.9998616, 'binary_precision': 0.9997582, 'binary_recall': 0.99255776, 'binary_specificity': 0.99975985, 'binary_f1_score': 0.99614495}
confusion matrix:
       0      1
0  29139      7
1    217  28941
---- Validation: 
scalar performance:
{'acc': 0.9701699, 'precision': 0.818167, 'recall': 0.5694148, 'specificity': 0.5694148, 'f1': 0.60883296, 'auroc': 0.92844665, 'binary_precision': 0.6640625, 'binary_recall': 0.14119601, 'binary_specificity': 0.9976336, 'binary_f1_score': 0.23287672}
confusion matrix:
       0   1
0  18128  43
1    517  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9596089, 'precision': 0.48057473, 'recall': 0.49916625, 'specificity': 0.49916625, 'f1': 0.4896941, 'auroc': 0.91248345, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5987  10
1   242   0
better model found
persisted
after epoch: 10,now: 2024-08-03 07:02:54.739881,epoch time: 0:29:38.164356,used: 4:55:56.792048,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9935339, 'precision': 0.99353683, 'recall': 0.993534, 'specificity': 0.993534, 'f1': 0.99353385, 'auroc': 0.9995581, 'binary_precision': 0.9947734, 'binary_recall': 0.9922826, 'binary_specificity': 0.9947854, 'binary_f1_score': 0.99352646}
confusion matrix:
       0      1
0  28997    152
1    225  28930
---- Validation: 
scalar performance:
{'acc': 0.9650562, 'precision': 0.6549963, 'recall': 0.54428786, 'specificity': 0.54428786, 'f1': 0.5651071, 'auroc': 0.93764687, 'binary_precision': 0.3392857, 'binary_recall': 0.094684385, 'binary_specificity': 0.99389136, 'binary_f1_score': 0.14805195}
confusion matrix:
       0    1
0  18060  111
1    545   57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95512104, 'precision': 0.48048702, 'recall': 0.49683174, 'specificity': 0.49683174, 'f1': 0.4885227, 'auroc': 0.93178344, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9936635, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5959  38
1   242   0
early stop counter: 1
val acc:0.9650561809539795, best validation acc: 0.9701699018478394, corresponding to test acc:                         0.9596089124679565 / 0.9769193530082703
after epoch: 11,now: 2024-08-03 07:32:27.731215,epoch time: 0:29:32.991334,used: 5:25:29.783382,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9960037, 'precision': 0.99600595, 'recall': 0.9960035, 'specificity': 0.9960035, 'f1': 0.9960037, 'auroc': 0.9998491, 'binary_precision': 0.9950029, 'binary_recall': 0.99701625, 'binary_specificity': 0.99499077, 'binary_f1_score': 0.9960086}
confusion matrix:
       0      1
0  29000    146
1     87  29071
---- Validation: 
scalar performance:
{'acc': 0.9458797, 'precision': 0.618765, 'recall': 0.666885, 'specificity': 0.666885, 'f1': 0.63797736, 'auroc': 0.90750337, 'binary_precision': 0.25874126, 'binary_recall': 0.36877078, 'binary_specificity': 0.9649992, 'binary_f1_score': 0.3041096}
confusion matrix:
       0    1
0  17535  636
1    380  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95031255, 'precision': 0.6634064, 'recall': 0.65691525, 'specificity': 0.65691525, 'f1': 0.6600834, 'auroc': 0.90896654, 'binary_precision': 0.35344827, 'binary_recall': 0.338843, 'binary_specificity': 0.9749875, 'binary_f1_score': 0.34599158}
confusion matrix:
      0    1
0  5847  150
1   160   82
early stop counter: 2
val acc:0.9458796977996826, best validation acc: 0.9701699018478394, corresponding to test acc:                         0.9596089124679565 / 0.9769193530082703
after epoch: 12,now: 2024-08-03 08:01:58.362232,epoch time: 0:29:30.631017,used: 5:55:00.414399,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9960037, 'precision': 0.9960203, 'recall': 0.9960042, 'specificity': 0.9960042, 'f1': 0.9960036, 'auroc': 0.99983335, 'binary_precision': 0.9989305, 'binary_recall': 0.993072, 'binary_specificity': 0.9989364, 'binary_f1_score': 0.9959926}
confusion matrix:
       0      1
0  29116     31
1    202  28955
---- Validation: 
scalar performance:
{'acc': 0.963618, 'precision': 0.6621485, 'recall': 0.57486385, 'specificity': 0.57486385, 'f1': 0.60040176, 'auroc': 0.9131099, 'binary_precision': 0.35164836, 'binary_recall': 0.15946844, 'binary_specificity': 0.99025923, 'binary_f1_score': 0.21942858}
confusion matrix:
       0    1
0  17994  177
1    506   96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96826416, 'precision': 0.8606934, 'recall': 0.6345294, 'specificity': 0.6345294, 'f1': 0.69185054, 'auroc': 0.9425541, 'binary_precision': 0.75, 'binary_recall': 0.27272728, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.40000004}
confusion matrix:
      0   1
0  5975  22
1   176  66
early stop counter: 3
val acc:0.9636179804801941, best validation acc: 0.9701699018478394, corresponding to test acc:                         0.9596089124679565 / 0.9769193530082703
after epoch: 13,now: 2024-08-03 08:31:28.913195,epoch time: 0:29:30.550963,used: 6:24:30.965362,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99715286, 'precision': 0.9971579, 'recall': 0.9971533, 'specificity': 0.9971533, 'f1': 0.99715286, 'auroc': 0.9998387, 'binary_precision': 0.99879575, 'binary_recall': 0.9955074, 'binary_specificity': 0.9987991, 'binary_f1_score': 0.9971489}
confusion matrix:
       0      1
0  29110     35
1    131  29028
---- Validation: 
scalar performance:
{'acc': 0.96132743, 'precision': 0.6226173, 'recall': 0.5568166, 'specificity': 0.5568166, 'f1': 0.57571733, 'auroc': 0.90521556, 'binary_precision': 0.27372262, 'binary_recall': 0.12458472, 'binary_specificity': 0.9890485, 'binary_f1_score': 0.17123288}
confusion matrix:
       0    1
0  17972  199
1    527   75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9559224, 'precision': 0.51918733, 'recall': 0.50319684, 'specificity': 0.50319684, 'f1': 0.49940285, 'auroc': 0.9363227, 'binary_precision': 0.07692308, 'binary_recall': 0.012396694, 'binary_specificity': 0.993997, 'binary_f1_score': 0.021352313}
confusion matrix:
      0   1
0  5961  36
1   239   3
early stop counter: 4
val acc:0.9613274335861206, best validation acc: 0.9701699018478394, corresponding to test acc:                         0.9596089124679565 / 0.9769193530082703
after epoch: 14,now: 2024-08-03 09:01:05.585661,epoch time: 0:29:36.672466,used: 6:54:07.637828,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99775314, 'precision': 0.997761, 'recall': 0.9977536, 'specificity': 0.9977536, 'f1': 0.99775314, 'auroc': 0.99994314, 'binary_precision': 0.9997934, 'binary_recall': 0.9957132, 'binary_specificity': 0.9997941, 'binary_f1_score': 0.99774915}
confusion matrix:
       0      1
0  29139      6
1    125  29034
---- Validation: 
scalar performance:
{'acc': 0.9689448, 'precision': 0.76301044, 'recall': 0.5800246, 'specificity': 0.5800246, 'f1': 0.6188318, 'auroc': 0.9330478, 'binary_precision': 0.55307263, 'binary_recall': 0.16445182, 'binary_specificity': 0.99559736, 'binary_f1_score': 0.2535211}
confusion matrix:
       0   1
0  18091  80
1    503  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95816636, 'precision': 0.52417326, 'recall': 0.5023813, 'specificity': 0.5023813, 'f1': 0.49686185, 'auroc': 0.9486596, 'binary_precision': 0.08695652, 'binary_recall': 0.008264462, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.015094339}
confusion matrix:
      0   1
0  5976  21
1   240   2
early stop counter: 5
val acc:0.968944787979126, best validation acc: 0.9701699018478394, corresponding to test acc:                         0.9596089124679565 / 0.9769193530082703
after epoch: 15,now: 2024-08-03 09:30:31.826605,epoch time: 0:29:26.240944,used: 7:23:33.878772,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_08md_03_02_06_57_seed_2_24046608
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 7:23:33.878772 at 2024-08-03 09:30:31.826605
persisted model performance metric: 

scalar performance:
{'acc': 0.9596089, 'precision': 0.48057473, 'recall': 0.49916625, 'specificity': 0.49916625, 'f1': 0.4896941, 'auroc': 0.91248345, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983325, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5987  10
1   242   0
oracle model performance metric: 

scalar performance:
{'acc': 0.97691935, 'precision': 0.83146477, 'recall': 0.88885695, 'specificity': 0.88885695, 'f1': 0.8576112, 'auroc': 0.9531884, 'binary_precision': 0.67132866, 'binary_recall': 0.7933884, 'binary_specificity': 0.98432547, 'binary_f1_score': 0.7272726}
confusion matrix:
      0    1
0  5903   94
1    50  192
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-02_13-07-07/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-08-02_13-07-07/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454660 KiB |   2002 MiB |   1541 TiB |   1541 TiB |
|       from large pool | 412979 KiB |   1969 MiB |   1521 TiB |   1521 TiB |
|       from small pool |  41681 KiB |     61 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 454660 KiB |   2002 MiB |   1541 TiB |   1541 TiB |
|       from large pool | 412979 KiB |   1969 MiB |   1521 TiB |   1521 TiB |
|       from small pool |  41681 KiB |     61 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |   1998 MiB |   1540 TiB |   1540 TiB |
|       from large pool | 407075 KiB |   1966 MiB |   1521 TiB |   1521 TiB |
|       from small pool |  40678 KiB |     60 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2282 MiB |   2282 MiB |   5212 MiB |   2930 MiB |
|       from large pool |   2218 MiB |   2218 MiB |   5110 MiB |   2892 MiB |
|       from small pool |     64 MiB |     70 MiB |    102 MiB |     38 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 346107 KiB | 471136 KiB |   1137 TiB |   1137 TiB |
|       from large pool | 336589 KiB | 449880 KiB |   1117 TiB |   1117 TiB |
|       from small pool |   9518 KiB |  22399 KiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8273    |  298576 K  |  298573 K  |
|       from large pool |     187    |     311    |  145553 K  |  145553 K  |
|       from small pool |    3289    |    8085    |  153023 K  |  153020 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8273    |  298576 K  |  298573 K  |
|       from large pool |     187    |     311    |  145553 K  |  145553 K  |
|       from small pool |    3289    |    8085    |  153023 K  |  153020 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     128    |     263    |     137    |
|       from large pool |      94    |      94    |     212    |     118    |
|       from small pool |      32    |      35    |      51    |      19    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      67    |    3695    |  142286 K  |  142286 K  |
|       from large pool |      36    |      95    |   83007 K  |   83007 K  |
|       from small pool |      31    |    3659    |   59278 K  |   59278 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2002 MiB |   1541 TiB |   1541 TiB |
|       from large pool |  16640 KiB |   1969 MiB |   1521 TiB |   1521 TiB |
|       from small pool |      0 KiB |     61 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2002 MiB |   1541 TiB |   1541 TiB |
|       from large pool |  16640 KiB |   1969 MiB |   1521 TiB |   1521 TiB |
|       from small pool |      0 KiB |     61 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1540 TiB |   1540 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1521 TiB |   1521 TiB |
|       from small pool |      0 KiB |     60 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    782 MiB |   2282 MiB |   5212 MiB |   4430 MiB |
|       from large pool |    732 MiB |   2218 MiB |   5110 MiB |   4378 MiB |
|       from small pool |     50 MiB |     70 MiB |    102 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 471136 KiB |   1138 TiB |   1138 TiB |
|       from large pool |  24320 KiB | 449880 KiB |   1117 TiB |   1117 TiB |
|       from small pool |      0 KiB |  22399 KiB |     20 TiB |     20 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8273    |  298576 K  |  298576 K  |
|       from large pool |       2    |     311    |  145553 K  |  145553 K  |
|       from small pool |       0    |    8085    |  153023 K  |  153023 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8273    |  298576 K  |  298576 K  |
|       from large pool |       2    |     311    |  145553 K  |  145553 K  |
|       from small pool |       0    |    8085    |  153023 K  |  153023 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     128    |     263    |     205    |
|       from large pool |      33    |      94    |     212    |     179    |
|       from small pool |      25    |      35    |      51    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    3695    |  142287 K  |  142287 K  |
|       from large pool |       4    |      95    |   83007 K  |   83007 K  |
|       from small pool |       0    |    3659    |   59279 K  |   59279 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Aug  3 09:31:58 2024]
Finished job 0.
1 of 1 steps (100%) done
