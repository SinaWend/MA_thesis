Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 31 03:10:53 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385

 Experiment start at: 2024-07-31 03:20:17.796057
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.8589006662368774
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8727336, 'precision': 0.8760991, 'recall': 0.872699, 'specificity': 0.872699, 'f1': 0.8724408, 'auroc': 0.9563609, 'binary_precision': 0.8407043, 'binary_recall': 0.91996795, 'binary_specificity': 0.82543004, 'binary_f1_score': 0.87855196}
confusion matrix:
       0      1
0  23656   5003
1   2297  26404
---- Validation: 
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8174755, 'precision': 0.5378174, 'recall': 0.6714872, 'specificity': 0.6714872, 'f1': 0.5296833, 'auroc': 0.7351198, 'binary_precision': 0.09596985, 'binary_recall': 0.5147745, 'binary_specificity': 0.8281999, 'binary_f1_score': 0.16177908}
confusion matrix:
       0     1
0  15031  3118
1    312   331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8381272, 'precision': 0.5623491, 'recall': 0.71948135, 'specificity': 0.71948135, 'f1': 0.57133496, 'auroc': 0.82777023, 'binary_precision': 0.14528301, 'binary_recall': 0.5900383, 'binary_specificity': 0.84892446, 'binary_f1_score': 0.23315671}
confusion matrix:
      0    1
0  5091  906
1   107  154
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 03:40:11.152574,epoch time: 0:19:53.356517,used: 0:19:53.356517,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9180439, 'precision': 0.91811466, 'recall': 0.91804945, 'specificity': 0.91804945, 'f1': 0.9180411, 'auroc': 0.97172475, 'binary_precision': 0.9237668, 'binary_recall': 0.9114409, 'binary_specificity': 0.924658, 'binary_f1_score': 0.9175624}
confusion matrix:
       0      1
0  26497   2159
1   2542  26162
---- Validation: 
scalar performance:
{'acc': 0.90330994, 'precision': 0.57447714, 'recall': 0.6926732, 'specificity': 0.6926732, 'f1': 0.5982869, 'auroc': 0.796814, 'binary_precision': 0.16910936, 'binary_recall': 0.466563, 'binary_specificity': 0.9187834, 'binary_f1_score': 0.24824162}
confusion matrix:
       0     1
0  16675  1474
1    343   300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9154682, 'precision': 0.63483083, 'recall': 0.8019786, 'specificity': 0.8019786, 'f1': 0.67771596, 'auroc': 0.88438725, 'binary_precision': 0.28456593, 'binary_recall': 0.6781609, 'binary_specificity': 0.9257962, 'binary_f1_score': 0.400906}
confusion matrix:
      0    1
0  5552  445
1    84  177
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 03:59:18.655450,epoch time: 0:19:07.502876,used: 0:39:00.859393,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93912137, 'precision': 0.9392897, 'recall': 0.9391296, 'specificity': 0.9391296, 'f1': 0.93911624, 'auroc': 0.9810773, 'binary_precision': 0.9481018, 'binary_recall': 0.92920846, 'binary_specificity': 0.9490508, 'binary_f1_score': 0.93856007}
confusion matrix:
       0      1
0  27196   1460
1   2032  26672
---- Validation: 
scalar performance:
{'acc': 0.90378886, 'precision': 0.5832013, 'recall': 0.7229234, 'specificity': 0.7229234, 'f1': 0.610898, 'auroc': 0.82207847, 'binary_precision': 0.18428184, 'binary_recall': 0.5287714, 'binary_specificity': 0.91707534, 'binary_f1_score': 0.2733119}
confusion matrix:
       0     1
0  16644  1505
1    303   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91738576, 'precision': 0.6434587, 'recall': 0.82863176, 'specificity': 0.82863176, 'f1': 0.6902064, 'auroc': 0.89937305, 'binary_precision': 0.29937303, 'binary_recall': 0.7318008, 'binary_specificity': 0.9254627, 'binary_f1_score': 0.42491657}
confusion matrix:
      0    1
0  5550  447
1    70  191
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-31 04:18:46.973744,epoch time: 0:19:28.318294,used: 0:58:29.177687,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9450488, 'precision': 0.94603586, 'recall': 0.94506526, 'specificity': 0.94506526, 'f1': 0.9450198, 'auroc': 0.9846314, 'binary_precision': 0.9671933, 'binary_recall': 0.92142856, 'binary_specificity': 0.968702, 'binary_f1_score': 0.94375646}
confusion matrix:
       0      1
0  27763    897
1   2255  26445
---- Validation: 
scalar performance:
{'acc': 0.9010217, 'precision': 0.5860485, 'recall': 0.7424923, 'specificity': 0.7424923, 'f1': 0.61517596, 'auroc': 0.8330519, 'binary_precision': 0.18842806, 'binary_recall': 0.57231724, 'binary_specificity': 0.9126674, 'binary_f1_score': 0.2835131}
confusion matrix:
       0     1
0  16564  1585
1    275   368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9149888, 'precision': 0.6408094, 'recall': 0.8310458, 'specificity': 0.8310458, 'f1': 0.6873047, 'auroc': 0.9049001, 'binary_precision': 0.29375952, 'binary_recall': 0.7394636, 'binary_specificity': 0.922628, 'binary_f1_score': 0.4204793}
confusion matrix:
      0    1
0  5533  464
1    68  193
early stop counter: 1
val acc:0.9010217189788818, best validation acc: 0.9037888646125793, corresponding to test acc:                         0.9173857569694519 / 0.9173857569694519
after epoch: 4,now: 2024-07-31 04:36:30.928323,epoch time: 0:17:43.954579,used: 1:16:13.132266,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9507845, 'precision': 0.951553, 'recall': 0.9508004, 'specificity': 0.9508004, 'f1': 0.9507648, 'auroc': 0.9877231, 'binary_precision': 0.97037333, 'binary_recall': 0.9300397, 'binary_specificity': 0.9715612, 'binary_f1_score': 0.9497785}
confusion matrix:
       0      1
0  27843    815
1   2008  26694
---- Validation: 
scalar performance:
{'acc': 0.917252, 'precision': 0.59859765, 'recall': 0.73214364, 'specificity': 0.73214364, 'f1': 0.631058, 'auroc': 0.83984375, 'binary_precision': 0.2146433, 'binary_recall': 0.533437, 'binary_specificity': 0.9308502, 'binary_f1_score': 0.30611333}
confusion matrix:
       0     1
0  16894  1255
1    300   343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93208694, 'precision': 0.66805613, 'recall': 0.83263755, 'specificity': 0.83263755, 'f1': 0.71722513, 'auroc': 0.9080683, 'binary_precision': 0.34870848, 'binary_recall': 0.7241379, 'binary_specificity': 0.94113725, 'binary_f1_score': 0.47073472}
confusion matrix:
      0    1
0  5644  353
1    72  189
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-31 04:54:11.456029,epoch time: 0:17:40.527706,used: 1:33:53.659972,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9535565, 'precision': 0.95433813, 'recall': 0.9535732, 'specificity': 0.9535732, 'f1': 0.9535377, 'auroc': 0.9886819, 'binary_precision': 0.97338474, 'binary_recall': 0.93268996, 'binary_specificity': 0.9744565, 'binary_f1_score': 0.9526029}
confusion matrix:
       0      1
0  27925    732
1   1932  26771
---- Validation: 
scalar performance:
{'acc': 0.90911025, 'precision': 0.5944575, 'recall': 0.74818003, 'specificity': 0.74818003, 'f1': 0.6268382, 'auroc': 0.842452, 'binary_precision': 0.20498616, 'binary_recall': 0.5754277, 'binary_specificity': 0.9209323, 'binary_f1_score': 0.3022876}
confusion matrix:
       0     1
0  16714  1435
1    273   370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92186004, 'precision': 0.6495712, 'recall': 0.82730156, 'specificity': 0.82730156, 'f1': 0.6970042, 'auroc': 0.9073502, 'binary_precision': 0.31188118, 'binary_recall': 0.7241379, 'binary_specificity': 0.9304652, 'binary_f1_score': 0.43598616}
confusion matrix:
      0    1
0  5580  417
1    72  189
early stop counter: 1
val acc:0.9091102480888367, best validation acc: 0.9172520041465759, corresponding to test acc:                         0.9320869445800781 / 0.9320869445800781
after epoch: 6,now: 2024-07-31 05:11:51.426201,epoch time: 0:17:39.970172,used: 1:51:33.630144,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95709556, 'precision': 0.9573865, 'recall': 0.95710486, 'specificity': 0.95710486, 'f1': 0.9570893, 'auroc': 0.9901106, 'binary_precision': 0.96910757, 'binary_recall': 0.94435734, 'binary_specificity': 0.9698524, 'binary_f1_score': 0.9565724}
confusion matrix:
       0      1
0  27795    864
1   1597  27104
---- Validation: 
scalar performance:
{'acc': 0.90490633, 'precision': 0.5933007, 'recall': 0.7587545, 'specificity': 0.7587545, 'f1': 0.62560105, 'auroc': 0.8458208, 'binary_precision': 0.20177267, 'binary_recall': 0.60186625, 'binary_specificity': 0.91564274, 'binary_f1_score': 0.30222568}
confusion matrix:
       0     1
0  16618  1531
1    256   387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91690636, 'precision': 0.64315593, 'recall': 0.83021396, 'specificity': 0.83021396, 'f1': 0.68999875, 'auroc': 0.90768373, 'binary_precision': 0.29860032, 'binary_recall': 0.7356322, 'binary_specificity': 0.92479575, 'binary_f1_score': 0.42477876}
confusion matrix:
      0    1
0  5546  451
1    69  192
early stop counter: 2
val acc:0.9049063324928284, best validation acc: 0.9172520041465759, corresponding to test acc:                         0.9320869445800781 / 0.9320869445800781
after epoch: 7,now: 2024-07-31 05:29:32.032552,epoch time: 0:17:40.606351,used: 2:09:14.236495,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9598152, 'precision': 0.9599687, 'recall': 0.95982295, 'specificity': 0.95982295, 'f1': 0.95981234, 'auroc': 0.9912584, 'binary_precision': 0.9685825, 'binary_recall': 0.9505295, 'binary_specificity': 0.9691164, 'binary_f1_score': 0.95947117}
confusion matrix:
       0      1
0  27771    885
1   1420  27284
---- Validation: 
scalar performance:
{'acc': 0.9081524, 'precision': 0.59775007, 'recall': 0.7649354, 'specificity': 0.7649354, 'f1': 0.63184255, 'auroc': 0.84791684, 'binary_precision': 0.21027288, 'binary_recall': 0.61119753, 'binary_specificity': 0.9186732, 'binary_f1_score': 0.31289813}
confusion matrix:
       0     1
0  16673  1476
1    250   393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91626716, 'precision': 0.6418265, 'recall': 0.8280481, 'specificity': 0.8280481, 'f1': 0.68825006, 'auroc': 0.9071902, 'binary_precision': 0.29612404, 'binary_recall': 0.7318008, 'binary_specificity': 0.9242955, 'binary_f1_score': 0.42163357}
confusion matrix:
      0    1
0  5543  454
1    70  191
early stop counter: 3
val acc:0.9081524014472961, best validation acc: 0.9172520041465759, corresponding to test acc:                         0.9320869445800781 / 0.9320869445800781
after epoch: 8,now: 2024-07-31 05:47:08.384413,epoch time: 0:17:36.351861,used: 2:26:50.588356,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9616457, 'precision': 0.9618707, 'recall': 0.96165514, 'specificity': 0.96165514, 'f1': 0.9616416, 'auroc': 0.99192065, 'binary_precision': 0.9722737, 'binary_recall': 0.95045984, 'binary_specificity': 0.9728504, 'binary_f1_score': 0.96124303}
confusion matrix:
       0      1
0  27878    778
1   1422  27282
---- Validation: 
scalar performance:
{'acc': 0.912037, 'precision': 0.5998088, 'recall': 0.75794584, 'specificity': 0.75794584, 'f1': 0.63426316, 'auroc': 0.8473151, 'binary_precision': 0.21501128, 'binary_recall': 0.592535, 'binary_specificity': 0.92335665, 'binary_f1_score': 0.31552795}
confusion matrix:
       0     1
0  16758  1391
1    262   381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9197827, 'precision': 0.6458796, 'recall': 0.8243854, 'specificity': 0.8243854, 'f1': 0.6925557, 'auroc': 0.9052711, 'binary_precision': 0.30470017, 'binary_recall': 0.7203065, 'binary_specificity': 0.92846423, 'binary_f1_score': 0.42824605}
confusion matrix:
      0    1
0  5568  429
1    73  188
early stop counter: 4
val acc:0.9120370149612427, best validation acc: 0.9172520041465759, corresponding to test acc:                         0.9320869445800781 / 0.9320869445800781
after epoch: 9,now: 2024-07-31 06:04:41.612643,epoch time: 0:17:33.228230,used: 2:44:23.816586,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96331936, 'precision': 0.9635574, 'recall': 0.9633298, 'specificity': 0.9633298, 'f1': 0.96331525, 'auroc': 0.99239355, 'binary_precision': 0.97429043, 'binary_recall': 0.9518219, 'binary_specificity': 0.9748377, 'binary_f1_score': 0.9629251}
confusion matrix:
       0      1
0  27933    721
1   1383  27323
---- Validation: 
scalar performance:
{'acc': 0.912782, 'precision': 0.5993353, 'recall': 0.75308114, 'specificity': 0.75308114, 'f1': 0.6333988, 'auroc': 0.84941924, 'binary_precision': 0.21444954, 'binary_recall': 0.5816485, 'binary_specificity': 0.92451376, 'binary_f1_score': 0.31336406}
confusion matrix:
       0     1
0  16779  1370
1    269   374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91770536, 'precision': 0.64190394, 'recall': 0.8196368, 'specificity': 0.8196368, 'f1': 0.6875527, 'auroc': 0.9037398, 'binary_precision': 0.2971246, 'binary_recall': 0.7126437, 'binary_specificity': 0.92662996, 'binary_f1_score': 0.4193912}
confusion matrix:
      0    1
0  5557  440
1    75  186
early stop counter: 5
val acc:0.9127820134162903, best validation acc: 0.9172520041465759, corresponding to test acc:                         0.9320869445800781 / 0.9320869445800781
after epoch: 10,now: 2024-07-31 06:22:17.630777,epoch time: 0:17:36.018134,used: 3:01:59.834720,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96467924, 'precision': 0.96490335, 'recall': 0.96468776, 'specificity': 0.96468776, 'f1': 0.9646754, 'auroc': 0.9929333, 'binary_precision': 0.97530466, 'binary_recall': 0.95355725, 'binary_specificity': 0.9758183, 'binary_f1_score': 0.9643084}
confusion matrix:
       0      1
0  27965    693
1   1333  27369
---- Validation: 
scalar performance:
{'acc': 0.91762453, 'precision': 0.60508597, 'recall': 0.7548381, 'specificity': 0.7548381, 'f1': 0.64066553, 'auroc': 0.8482344, 'binary_precision': 0.22592369, 'binary_recall': 0.5800933, 'binary_specificity': 0.9295829, 'binary_f1_score': 0.32519615}
confusion matrix:
       0     1
0  16871  1278
1    270   373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9201023, 'precision': 0.6451615, 'recall': 0.8190551, 'specificity': 0.8190551, 'f1': 0.69117707, 'auroc': 0.90277326, 'binary_precision': 0.30377668, 'binary_recall': 0.70881224, 'binary_specificity': 0.929298, 'binary_f1_score': 0.42528734}
confusion matrix:
      0    1
0  5573  424
1    76  185
better model found
persisted
after epoch: 11,now: 2024-07-31 06:39:56.415079,epoch time: 0:17:38.784302,used: 3:19:38.619022,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9652022, 'precision': 0.9653785, 'recall': 0.9652095, 'specificity': 0.9652095, 'f1': 0.96519935, 'auroc': 0.99361396, 'binary_precision': 0.9746206, 'binary_recall': 0.9553326, 'binary_specificity': 0.97508633, 'binary_f1_score': 0.9648802}
confusion matrix:
       0      1
0  27945    714
1   1282  27419
---- Validation: 
scalar performance:
{'acc': 0.90644956, 'precision': 0.59541583, 'recall': 0.7618036, 'specificity': 0.7618036, 'f1': 0.628583, 'auroc': 0.8520509, 'binary_precision': 0.20580475, 'binary_recall': 0.60653186, 'binary_specificity': 0.91707534, 'binary_f1_score': 0.3073286}
confusion matrix:
       0     1
0  16644  1505
1    253   390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91051453, 'precision': 0.63477504, 'recall': 0.8287113, 'specificity': 0.8287113, 'f1': 0.6798164, 'auroc': 0.90488863, 'binary_precision': 0.2817518, 'binary_recall': 0.7394636, 'binary_specificity': 0.917959, 'binary_f1_score': 0.40803382}
confusion matrix:
      0    1
0  5505  492
1    68  193
early stop counter: 1
val acc:0.906449556350708, best validation acc: 0.9176245331764221, corresponding to test acc:                         0.9201022982597351 / 0.9320869445800781
after epoch: 12,now: 2024-07-31 06:57:21.419168,epoch time: 0:17:25.004089,used: 3:37:03.623111,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.966841, 'precision': 0.9669206, 'recall': 0.96684563, 'specificity': 0.96684563, 'f1': 0.9668398, 'auroc': 0.9940268, 'binary_precision': 0.9731954, 'binary_recall': 0.9601742, 'binary_specificity': 0.9735171, 'binary_f1_score': 0.9666409}
confusion matrix:
       0      1
0  27901    759
1   1143  27557
---- Validation: 
scalar performance:
{'acc': 0.9107067, 'precision': 0.6001723, 'recall': 0.76475763, 'specificity': 0.76475763, 'f1': 0.63505626, 'auroc': 0.85654664, 'binary_precision': 0.21518987, 'binary_recall': 0.60808706, 'binary_specificity': 0.9214282, 'binary_f1_score': 0.31788617}
confusion matrix:
       0     1
0  16723  1426
1    252   391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9125919, 'precision': 0.63751453, 'recall': 0.8297952, 'specificity': 0.8297952, 'f1': 0.6832474, 'auroc': 0.9046401, 'binary_precision': 0.2872024, 'binary_recall': 0.7394636, 'binary_specificity': 0.92012674, 'binary_f1_score': 0.41371918}
confusion matrix:
      0    1
0  5518  479
1    68  193
early stop counter: 2
val acc:0.9107066988945007, best validation acc: 0.9176245331764221, corresponding to test acc:                         0.9201022982597351 / 0.9320869445800781
after epoch: 13,now: 2024-07-31 07:14:58.119547,epoch time: 0:17:36.700379,used: 3:54:40.323490,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9673466, 'precision': 0.9674998, 'recall': 0.96735466, 'specificity': 0.96735466, 'f1': 0.9673443, 'auroc': 0.9942225, 'binary_precision': 0.9761837, 'binary_recall': 0.95812577, 'binary_specificity': 0.9765835, 'binary_f1_score': 0.96707046}
confusion matrix:
       0      1
0  27984    671
1   1202  27503
---- Validation: 
scalar performance:
{'acc': 0.9078863, 'precision': 0.59964734, 'recall': 0.7737983, 'specificity': 0.7737983, 'f1': 0.63468784, 'auroc': 0.8577491, 'binary_precision': 0.21338251, 'binary_recall': 0.62986004, 'binary_specificity': 0.91773653, 'binary_f1_score': 0.31877214}
confusion matrix:
       0     1
0  16656  1493
1    238   405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9082774, 'precision': 0.63275075, 'recall': 0.8312087, 'specificity': 0.8312087, 'f1': 0.677438, 'auroc': 0.9058733, 'binary_precision': 0.27738264, 'binary_recall': 0.74712646, 'binary_specificity': 0.91529095, 'binary_f1_score': 0.40456432}
confusion matrix:
      0    1
0  5489  508
1    66  195
early stop counter: 3
val acc:0.9078863263130188, best validation acc: 0.9176245331764221, corresponding to test acc:                         0.9201022982597351 / 0.9320869445800781
after epoch: 14,now: 2024-07-31 07:32:43.732918,epoch time: 0:17:45.613371,used: 4:12:25.936861,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9693515, 'precision': 0.9694228, 'recall': 0.96935725, 'specificity': 0.96935725, 'f1': 0.9693505, 'auroc': 0.994717, 'binary_precision': 0.9754411, 'binary_recall': 0.96300423, 'binary_specificity': 0.9757102, 'binary_f1_score': 0.9691827}
confusion matrix:
       0      1
0  27958    696
1   1062  27644
---- Validation: 
scalar performance:
{'acc': 0.899851, 'precision': 0.5915445, 'recall': 0.76888824, 'specificity': 0.76888824, 'f1': 0.6232185, 'auroc': 0.8535316, 'binary_precision': 0.19736199, 'binary_recall': 0.62830484, 'binary_specificity': 0.9094716, 'binary_f1_score': 0.30037174}
confusion matrix:
       0     1
0  16506  1643
1    239   404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8990093, 'precision': 0.6225259, 'recall': 0.8282053, 'specificity': 0.8282053, 'f1': 0.66390884, 'auroc': 0.9032512, 'binary_precision': 0.25688073, 'binary_recall': 0.75095785, 'binary_specificity': 0.9054527, 'binary_f1_score': 0.3828125}
confusion matrix:
      0    1
0  5430  567
1    65  196
early stop counter: 4
val acc:0.8998510241508484, best validation acc: 0.9176245331764221, corresponding to test acc:                         0.9201022982597351 / 0.9320869445800781
after epoch: 15,now: 2024-07-31 07:50:41.273010,epoch time: 0:17:57.540092,used: 4:30:23.476953,model: dset_te_center0_erm_no_git_version_2024md_07md_31_03_20_17_seed_0_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 4:30:23.476953 at 2024-07-31 07:50:41.273010
persisted model performance metric: 

scalar performance:
{'acc': 0.9201023, 'precision': 0.6451615, 'recall': 0.8190551, 'specificity': 0.8190551, 'f1': 0.69117707, 'auroc': 0.90277326, 'binary_precision': 0.30377668, 'binary_recall': 0.70881224, 'binary_specificity': 0.929298, 'binary_f1_score': 0.42528734}
confusion matrix:
      0    1
0  5573  424
1    76  185
oracle model performance metric: 

scalar performance:
{'acc': 0.93208694, 'precision': 0.66805613, 'recall': 0.83263755, 'specificity': 0.83263755, 'f1': 0.71722513, 'auroc': 0.9080683, 'binary_precision': 0.34870848, 'binary_recall': 0.7241379, 'binary_specificity': 0.94113725, 'binary_f1_score': 0.47073472}
confusion matrix:
      0    1
0  5644  353
1    72  189
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 205600 KiB |   7837 MiB | 361711 GiB | 361710 GiB |
|       from large pool | 188109 KiB |   7813 MiB | 356160 GiB | 356159 GiB |
|       from small pool |  17491 KiB |     37 MiB |   5550 GiB |   5550 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 205600 KiB |   7837 MiB | 361711 GiB | 361710 GiB |
|       from large pool | 188109 KiB |   7813 MiB | 356160 GiB | 356159 GiB |
|       from small pool |  17491 KiB |     37 MiB |   5550 GiB |   5550 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 203141 KiB |   7835 MiB | 359743 GiB | 359743 GiB |
|       from large pool | 186659 KiB |   7812 MiB | 354205 GiB | 354204 GiB |
|       from small pool |  16482 KiB |     36 MiB |   5538 GiB |   5538 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |   8530 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     44 MiB |     44 MiB |     44 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  74975 KiB | 724416 KiB | 242816 GiB | 242816 GiB |
|       from large pool |  69938 KiB | 723497 KiB | 237257 GiB | 237257 GiB |
|       from small pool |   5037 KiB |  11093 KiB |   5558 GiB |   5558 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2988    |    7675    |   69870 K  |   69867 K  |
|       from large pool |      84    |     767    |   33482 K  |   33482 K  |
|       from small pool |    2904    |    7589    |   36388 K  |   36385 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2988    |    7675    |   69870 K  |   69867 K  |
|       from large pool |      84    |     767    |   33482 K  |   33482 K  |
|       from small pool |    2904    |    7589    |   36388 K  |   36385 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     371    |     371    |     371    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    3607    |   41225 K  |   41225 K  |
|       from large pool |      11    |     349    |   24150 K  |   24150 K  |
|       from small pool |      22    |    3597    |   17075 K  |   17075 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7837 MiB | 361711 GiB | 361711 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 356160 GiB | 356160 GiB |
|       from small pool |      0 KiB |     37 MiB |   5550 GiB |   5550 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7837 MiB | 361711 GiB | 361711 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 356160 GiB | 356160 GiB |
|       from small pool |      0 KiB |     37 MiB |   5550 GiB |   5550 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7835 MiB | 359743 GiB | 359743 GiB |
|       from large pool |  16640 KiB |   7812 MiB | 354205 GiB | 354205 GiB |
|       from small pool |      0 KiB |     36 MiB |   5538 GiB |   5538 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 280576 KiB |   8530 MiB |   8530 MiB |   8256 MiB |
|       from large pool | 258048 KiB |   8486 MiB |   8486 MiB |   8234 MiB |
|       from small pool |  22528 KiB |     44 MiB |     44 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 724416 KiB | 242816 GiB | 242816 GiB |
|       from large pool |  30464 KiB | 723497 KiB | 237257 GiB | 237257 GiB |
|       from small pool |      0 KiB |  19176 KiB |   5558 GiB |   5558 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7675    |   69870 K  |   69870 K  |
|       from large pool |       2    |     767    |   33482 K  |   33482 K  |
|       from small pool |       0    |    7589    |   36388 K  |   36388 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7675    |   69870 K  |   69870 K  |
|       from large pool |       2    |     767    |   33482 K  |   33482 K  |
|       from small pool |       0    |    7589    |   36388 K  |   36388 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     371    |     348    |
|       from large pool |      12    |     349    |     349    |     337    |
|       from small pool |      11    |      22    |      22    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3607    |   41227 K  |   41227 K  |
|       from large pool |       2    |     349    |   24150 K  |   24150 K  |
|       from small pool |       0    |    3597    |   17076 K  |   17076 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7837 MiB | 361711 GiB | 361711 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 356160 GiB | 356160 GiB |
|       from small pool |      0 KiB |     37 MiB |   5550 GiB |   5550 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7837 MiB | 361711 GiB | 361711 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 356160 GiB | 356160 GiB |
|       from small pool |      0 KiB |     37 MiB |   5550 GiB |   5550 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7835 MiB | 359743 GiB | 359743 GiB |
|       from large pool |  16640 KiB |   7812 MiB | 354205 GiB | 354205 GiB |
|       from small pool |      0 KiB |     36 MiB |   5538 GiB |   5538 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 280576 KiB |   8530 MiB |   8530 MiB |   8256 MiB |
|       from large pool | 258048 KiB |   8486 MiB |   8486 MiB |   8234 MiB |
|       from small pool |  22528 KiB |     44 MiB |     44 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 724416 KiB | 242816 GiB | 242816 GiB |
|       from large pool |  30464 KiB | 723497 KiB | 237257 GiB | 237257 GiB |
|       from small pool |      0 KiB |  19176 KiB |   5558 GiB |   5558 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7675    |   69870 K  |   69870 K  |
|       from large pool |       2    |     767    |   33482 K  |   33482 K  |
|       from small pool |       0    |    7589    |   36388 K  |   36388 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7675    |   69870 K  |   69870 K  |
|       from large pool |       2    |     767    |   33482 K  |   33482 K  |
|       from small pool |       0    |    7589    |   36388 K  |   36388 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     371    |     348    |
|       from large pool |      12    |     349    |     349    |     337    |
|       from small pool |      11    |      22    |      22    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3607    |   41227 K  |   41227 K  |
|       from large pool |       2    |     349    |   24150 K  |   24150 K  |
|       from small pool |       0    |    3597    |   17076 K  |   17076 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385

 Experiment start at: 2024-07-31 08:00:11.974648
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.83702445, 'precision': 0.8386313, 'recall': 0.8370495, 'specificity': 0.8370495, 'f1': 0.83683795, 'auroc': 0.90216017, 'binary_precision': 0.8621409, 'binary_recall': 0.8026293, 'binary_specificity': 0.87146974, 'binary_f1_score': 0.8313214}
confusion matrix:
       0      1
0  25087   3700
1   5690  23139
---- Validation: 
scalar performance:
{'acc': 0.87838846, 'precision': 0.50546676, 'recall': 0.513491, 'specificity': 0.513491, 'f1': 0.50066215, 'auroc': 0.7285657, 'binary_precision': 0.04581448, 'binary_recall': 0.12035661, 'binary_specificity': 0.90662533, 'binary_f1_score': 0.06636624}
confusion matrix:
       0     1
0  16380  1687
1    592    81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9057364, 'precision': 0.5282601, 'recall': 0.5425522, 'specificity': 0.5425522, 'f1': 0.5325972, 'auroc': 0.78825116, 'binary_precision': 0.09476309, 'binary_recall': 0.14615385, 'binary_specificity': 0.93895054, 'binary_f1_score': 0.114977315}
confusion matrix:
      0    1
0  5583  363
1   222   38
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 08:18:24.394701,epoch time: 0:18:12.420053,used: 0:18:12.420053,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8911934, 'precision': 0.8960782, 'recall': 0.8912339, 'specificity': 0.8912339, 'f1': 0.890864, 'auroc': 0.94619155, 'binary_precision': 0.94024664, 'binary_recall': 0.8356516, 'binary_specificity': 0.94681627, 'binary_f1_score': 0.8848689}
confusion matrix:
       0      1
0  27256   1531
1   4738  24091
---- Validation: 
scalar performance:
{'acc': 0.8930096, 'precision': 0.5315004, 'recall': 0.5725731, 'specificity': 0.5725731, 'f1': 0.5376999, 'auroc': 0.7840588, 'binary_precision': 0.093406595, 'binary_recall': 0.22734027, 'binary_specificity': 0.91780597, 'binary_f1_score': 0.13241021}
confusion matrix:
       0     1
0  16582  1485
1    520   153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9087979, 'precision': 0.55219394, 'recall': 0.5827686, 'specificity': 0.5827686, 'f1': 0.56212705, 'auroc': 0.8370527, 'binary_precision': 0.13915095, 'binary_recall': 0.22692308, 'binary_specificity': 0.9386142, 'binary_f1_score': 0.17251463}
confusion matrix:
      0    1
0  5581  365
1   201   59
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 08:36:05.914422,epoch time: 0:17:41.519721,used: 0:35:53.939774,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9098861, 'precision': 0.9148769, 'recall': 0.9099262, 'specificity': 0.9099262, 'f1': 0.90962005, 'auroc': 0.9614377, 'binary_precision': 0.9605627, 'binary_recall': 0.8550071, 'binary_specificity': 0.96484524, 'binary_f1_score': 0.90471643}
confusion matrix:
       0      1
0  27775   1012
1   4180  24649
---- Validation: 
scalar performance:
{'acc': 0.9032017, 'precision': 0.56211376, 'recall': 0.642233, 'specificity': 0.642233, 'f1': 0.57987046, 'auroc': 0.8153753, 'binary_precision': 0.14935464, 'binary_recall': 0.36106983, 'binary_specificity': 0.9233962, 'binary_f1_score': 0.21130432}
confusion matrix:
       0     1
0  16683  1384
1    430   243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91347086, 'precision': 0.58368313, 'recall': 0.64221585, 'specificity': 0.64221585, 'f1': 0.6025645, 'auroc': 0.862521, 'binary_precision': 0.19693655, 'binary_recall': 0.34615386, 'binary_specificity': 0.93827784, 'binary_f1_score': 0.25104603}
confusion matrix:
      0    1
0  5579  367
1   170   90
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-31 08:53:41.075322,epoch time: 0:17:35.160900,used: 0:53:29.100674,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92196614, 'precision': 0.92500937, 'recall': 0.9219955, 'specificity': 0.9219955, 'f1': 0.92182976, 'auroc': 0.97049534, 'binary_precision': 0.9611477, 'binary_recall': 0.87959623, 'binary_specificity': 0.96439487, 'binary_f1_score': 0.91856545}
confusion matrix:
       0      1
0  27763   1025
1   3471  25357
---- Validation: 
scalar performance:
{'acc': 0.90565634, 'precision': 0.5803591, 'recall': 0.6935748, 'specificity': 0.6935748, 'f1': 0.60554826, 'auroc': 0.8396622, 'binary_precision': 0.18187101, 'binary_recall': 0.46508172, 'binary_specificity': 0.9220679, 'binary_f1_score': 0.26148707}
confusion matrix:
       0     1
0  16659  1408
1    360   313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9152433, 'precision': 0.61760443, 'recall': 0.7350902, 'specificity': 0.7350902, 'f1': 0.6510366, 'auroc': 0.8808811, 'binary_precision': 0.25641027, 'binary_recall': 0.53846157, 'binary_specificity': 0.9317188, 'binary_f1_score': 0.3473946}
confusion matrix:
      0    1
0  5540  406
1   120  140
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-31 09:11:11.859675,epoch time: 0:17:30.784353,used: 1:10:59.885027,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.92913425, 'precision': 0.93285394, 'recall': 0.92916656, 'specificity': 0.92916656, 'f1': 0.92898524, 'auroc': 0.9768239, 'binary_precision': 0.9731538, 'binary_recall': 0.8827182, 'binary_specificity': 0.97561485, 'binary_f1_score': 0.92573255}
confusion matrix:
       0      1
0  28086    702
1   3381  25447
---- Validation: 
scalar performance:
{'acc': 0.91979724, 'precision': 0.5972952, 'recall': 0.70162386, 'specificity': 0.70162386, 'f1': 0.6260892, 'auroc': 0.8504224, 'binary_precision': 0.21536352, 'binary_recall': 0.4665676, 'binary_specificity': 0.93668014, 'binary_f1_score': 0.29469734}
confusion matrix:
       0     1
0  16923  1144
1    359   314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92620045, 'precision': 0.6364838, 'recall': 0.7426473, 'specificity': 0.7426473, 'f1': 0.67092097, 'auroc': 0.89256454, 'binary_precision': 0.29375, 'binary_recall': 0.5423077, 'binary_specificity': 0.9429869, 'binary_f1_score': 0.38108107}
confusion matrix:
      0    1
0  5607  339
1   119  141
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-31 09:28:42.471135,epoch time: 0:17:30.611460,used: 1:28:30.496487,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9371008, 'precision': 0.93865526, 'recall': 0.9371226, 'specificity': 0.9371226, 'f1': 0.9370471, 'auroc': 0.9813621, 'binary_precision': 0.9649511, 'binary_recall': 0.9072462, 'binary_specificity': 0.966999, 'binary_f1_score': 0.93520933}
confusion matrix:
       0      1
0  27837    950
1   2674  26155
---- Validation: 
scalar performance:
{'acc': 0.91979724, 'precision': 0.61076206, 'recall': 0.74811625, 'specificity': 0.74811625, 'f1': 0.646287, 'auroc': 0.8632535, 'binary_precision': 0.23866498, 'binary_recall': 0.56315005, 'binary_specificity': 0.9330824, 'binary_f1_score': 0.33524987}
confusion matrix:
       0     1
0  16858  1209
1    294   379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9231389, 'precision': 0.6446372, 'recall': 0.7943802, 'specificity': 0.7943802, 'f1': 0.6875091, 'auroc': 0.9055228, 'binary_precision': 0.30520648, 'binary_recall': 0.65384614, 'binary_specificity': 0.93491423, 'binary_f1_score': 0.41615668}
confusion matrix:
      0    1
0  5559  387
1    90  170
early stop counter: 1
val acc:0.9197972416877747, best validation acc: 0.9197972416877747, corresponding to test acc:                         0.9262004494667053 / 0.9262004494667053
after epoch: 6,now: 2024-07-31 09:46:21.828449,epoch time: 0:17:39.357314,used: 1:46:09.853801,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9417523, 'precision': 0.9440235, 'recall': 0.94177973, 'specificity': 0.94177973, 'f1': 0.9416802, 'auroc': 0.98395014, 'binary_precision': 0.9759716, 'binary_recall': 0.90589666, 'binary_specificity': 0.97766274, 'binary_f1_score': 0.93962944}
confusion matrix:
       0      1
0  28143    643
1   2713  26117
---- Validation: 
scalar performance:
{'acc': 0.9227321, 'precision': 0.61829114, 'recall': 0.7617979, 'specificity': 0.7617979, 'f1': 0.6562409, 'auroc': 0.87237716, 'binary_precision': 0.2527122, 'binary_recall': 0.5884101, 'binary_specificity': 0.9351857, 'binary_f1_score': 0.35357144}
confusion matrix:
       0     1
0  16896  1171
1    277   396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9250725, 'precision': 0.6505543, 'recall': 0.8064232, 'specificity': 0.8064232, 'f1': 0.69537055, 'auroc': 0.91332185, 'binary_precision': 0.31597847, 'binary_recall': 0.6769231, 'binary_specificity': 0.93592334, 'binary_f1_score': 0.43084455}
confusion matrix:
      0    1
0  5565  381
1    84  176
better model found
persisted
after epoch: 7,now: 2024-07-31 10:04:08.338696,epoch time: 0:17:46.510247,used: 2:03:56.364048,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.94473755, 'precision': 0.9467027, 'recall': 0.9447619, 'specificity': 0.9447619, 'f1': 0.9446788, 'auroc': 0.98664707, 'binary_precision': 0.97651345, 'binary_recall': 0.91147804, 'binary_specificity': 0.97804564, 'binary_f1_score': 0.9428756}
confusion matrix:
       0      1
0  28155    632
1   2552  26277
---- Validation: 
scalar performance:
{'acc': 0.9239061, 'precision': 0.62320364, 'recall': 0.7745663, 'specificity': 0.7745663, 'f1': 0.66315293, 'auroc': 0.8753901, 'binary_precision': 0.26155794, 'binary_recall': 0.6136701, 'binary_specificity': 0.9354625, 'binary_f1_score': 0.36678505}
confusion matrix:
       0     1
0  16901  1166
1    260   413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9236223, 'precision': 0.65050983, 'recall': 0.81670034, 'specificity': 0.81670034, 'f1': 0.6967069, 'auroc': 0.9172741, 'binary_precision': 0.31487888, 'binary_recall': 0.7, 'binary_specificity': 0.93340063, 'binary_f1_score': 0.43436754}
confusion matrix:
      0    1
0  5550  396
1    78  182
better model found
persisted
after epoch: 8,now: 2024-07-31 10:21:46.599207,epoch time: 0:17:38.260511,used: 2:21:34.624559,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.94720215, 'precision': 0.94923663, 'recall': 0.94722676, 'specificity': 0.94722676, 'f1': 0.94714427, 'auroc': 0.9877986, 'binary_precision': 0.97965103, 'binary_recall': 0.9134552, 'binary_specificity': 0.9809984, 'binary_f1_score': 0.94539577}
confusion matrix:
       0      1
0  28240    547
1   2495  26334
---- Validation: 
scalar performance:
{'acc': 0.9228922, 'precision': 0.62550056, 'recall': 0.7897763, 'specificity': 0.7897763, 'f1': 0.66735893, 'auroc': 0.8811034, 'binary_precision': 0.26492083, 'binary_recall': 0.64635956, 'binary_specificity': 0.9331931, 'binary_f1_score': 0.37580994}
confusion matrix:
       0     1
0  16860  1207
1    238   435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9199162, 'precision': 0.64889526, 'recall': 0.83499503, 'specificity': 0.83499503, 'f1': 0.6970187, 'auroc': 0.9212625, 'binary_precision': 0.30979133, 'binary_recall': 0.74230766, 'binary_specificity': 0.92768246, 'binary_f1_score': 0.43714607}
confusion matrix:
      0    1
0  5516  430
1    67  193
early stop counter: 1
val acc:0.9228922128677368, best validation acc: 0.9239060878753662, corresponding to test acc:                         0.9236223101615906 / 0.9262004494667053
after epoch: 9,now: 2024-07-31 10:39:20.053472,epoch time: 0:17:33.454265,used: 2:39:08.078824,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95109, 'precision': 0.95287794, 'recall': 0.95111406, 'specificity': 0.95111406, 'f1': 0.9510435, 'auroc': 0.9891138, 'binary_precision': 0.98152536, 'binary_recall': 0.91956294, 'binary_specificity': 0.9826652, 'binary_f1_score': 0.9495344}
confusion matrix:
       0      1
0  28287    499
1   2319  26511
---- Validation: 
scalar performance:
{'acc': 0.9244931, 'precision': 0.6291675, 'recall': 0.79561347, 'specificity': 0.79561347, 'f1': 0.67214715, 'auroc': 0.8852729, 'binary_precision': 0.2718327, 'binary_recall': 0.65676075, 'binary_specificity': 0.9344662, 'binary_f1_score': 0.384515}
confusion matrix:
       0     1
0  16883  1184
1    231   442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91814375, 'precision': 0.6489234, 'recall': 0.846943, 'specificity': 0.846943, 'f1': 0.698185, 'auroc': 0.92493784, 'binary_precision': 0.30864197, 'binary_recall': 0.7692308, 'binary_specificity': 0.92465526, 'binary_f1_score': 0.44052863}
confusion matrix:
      0    1
0  5498  448
1    60  200
better model found
persisted
after epoch: 10,now: 2024-07-31 10:57:08.083771,epoch time: 0:17:48.030299,used: 2:56:56.109123,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9526867, 'precision': 0.95375615, 'recall': 0.95270455, 'specificity': 0.95270455, 'f1': 0.9526601, 'auroc': 0.9893581, 'binary_precision': 0.97596735, 'binary_recall': 0.92830133, 'binary_specificity': 0.9771077, 'binary_f1_score': 0.9515377}
confusion matrix:
       0      1
0  28128    659
1   2067  26762
---- Validation: 
scalar performance:
{'acc': 0.9259872, 'precision': 0.634533, 'recall': 0.80926317, 'specificity': 0.80926317, 'f1': 0.67967635, 'auroc': 0.8896911, 'binary_precision': 0.28151774, 'binary_recall': 0.68350667, 'binary_specificity': 0.9350197, 'binary_f1_score': 0.3987863}
confusion matrix:
       0     1
0  16893  1174
1    213   460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9170158, 'precision': 0.6506662, 'recall': 0.86290526, 'specificity': 0.86290526, 'f1': 0.7015763, 'auroc': 0.9287789, 'binary_precision': 0.31054977, 'binary_recall': 0.8038462, 'binary_specificity': 0.92196435, 'binary_f1_score': 0.44801712}
confusion matrix:
      0    1
0  5482  464
1    51  209
better model found
persisted
after epoch: 11,now: 2024-07-31 11:15:00.656938,epoch time: 0:17:52.573167,used: 3:14:48.682290,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9559497, 'precision': 0.9567349, 'recall': 0.9559649, 'specificity': 0.9559649, 'f1': 0.9559318, 'auroc': 0.9905412, 'binary_precision': 0.97585523, 'binary_recall': 0.9351001, 'binary_specificity': 0.9768298, 'binary_f1_score': 0.9550431}
confusion matrix:
       0      1
0  28120    667
1   1871  26958
---- Validation: 
scalar performance:
{'acc': 0.92310566, 'precision': 0.631468, 'recall': 0.8142061, 'specificity': 0.8142061, 'f1': 0.6766152, 'auroc': 0.8919731, 'binary_precision': 0.2749121, 'binary_recall': 0.6968796, 'binary_specificity': 0.9315326, 'binary_f1_score': 0.39428332}
confusion matrix:
       0     1
0  16830  1237
1    204   469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91588783, 'precision': 0.64943326, 'recall': 0.8641556, 'specificity': 0.8641556, 'f1': 0.700175, 'auroc': 0.93057585, 'binary_precision': 0.3079179, 'binary_recall': 0.8076923, 'binary_specificity': 0.9206189, 'binary_f1_score': 0.4458599}
confusion matrix:
      0    1
0  5474  472
1    50  210
early stop counter: 1
val acc:0.9231056571006775, best validation acc: 0.925987184047699, corresponding to test acc:                         0.917015790939331 / 0.9262004494667053
after epoch: 12,now: 2024-07-31 11:32:46.363583,epoch time: 0:17:45.706645,used: 3:32:34.388935,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95732087, 'precision': 0.9581547, 'recall': 0.95733726, 'specificity': 0.95733726, 'f1': 0.9573025, 'auroc': 0.9912826, 'binary_precision': 0.9778913, 'binary_recall': 0.9358654, 'binary_specificity': 0.9788091, 'binary_f1_score': 0.9564169}
confusion matrix:
       0      1
0  28176    610
1   1849  26981
---- Validation: 
scalar performance:
{'acc': 0.9171825, 'precision': 0.62683827, 'recall': 0.82830065, 'specificity': 0.82830065, 'f1': 0.6720392, 'auroc': 0.8943908, 'binary_precision': 0.26434317, 'binary_recall': 0.73254085, 'binary_specificity': 0.92406046, 'binary_f1_score': 0.38849488}
confusion matrix:
       0     1
0  16695  1372
1    180   493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.901708, 'precision': 0.6332948, 'recall': 0.8641116, 'specificity': 0.8641116, 'f1': 0.67935014, 'auroc': 0.9332576, 'binary_precision': 0.27506426, 'binary_recall': 0.8230769, 'binary_specificity': 0.9051463, 'binary_f1_score': 0.41233137}
confusion matrix:
      0    1
0  5382  564
1    46  214
early stop counter: 2
val acc:0.9171825051307678, best validation acc: 0.925987184047699, corresponding to test acc:                         0.917015790939331 / 0.9262004494667053
after epoch: 13,now: 2024-07-31 11:50:36.877444,epoch time: 0:17:50.513861,used: 3:50:24.902796,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.95825815, 'precision': 0.9591496, 'recall': 0.9582743, 'specificity': 0.9582743, 'f1': 0.9582389, 'auroc': 0.9918717, 'binary_precision': 0.9795644, 'binary_recall': 0.936106, 'binary_specificity': 0.9804426, 'binary_f1_score': 0.9573423}
confusion matrix:
       0      1
0  28224    563
1   1842  26987
---- Validation: 
scalar performance:
{'acc': 0.92161155, 'precision': 0.6327115, 'recall': 0.8291671, 'specificity': 0.8291671, 'f1': 0.67935807, 'auroc': 0.8947159, 'binary_precision': 0.27615297, 'binary_recall': 0.7295691, 'binary_specificity': 0.9287652, 'binary_f1_score': 0.4006528}
confusion matrix:
       0     1
0  16780  1287
1    182   491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9047696, 'precision': 0.63637424, 'recall': 0.8638704, 'specificity': 0.8638704, 'f1': 0.6835071, 'auroc': 0.9349867, 'binary_precision': 0.28137386, 'binary_recall': 0.8192308, 'binary_specificity': 0.9085099, 'binary_f1_score': 0.41887906}
confusion matrix:
      0    1
0  5402  544
1    47  213
early stop counter: 3
val acc:0.9216115474700928, best validation acc: 0.925987184047699, corresponding to test acc:                         0.917015790939331 / 0.9262004494667053
after epoch: 14,now: 2024-07-31 12:08:25.583468,epoch time: 0:17:48.706024,used: 4:08:13.608820,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9608789, 'precision': 0.96135384, 'recall': 0.96089077, 'specificity': 0.96089077, 'f1': 0.96086955, 'auroc': 0.99252045, 'binary_precision': 0.9763398, 'binary_recall': 0.94470847, 'binary_specificity': 0.977073, 'binary_f1_score': 0.9602637}
confusion matrix:
       0      1
0  28127    660
1   1594  27235
---- Validation: 
scalar performance:
{'acc': 0.91515476, 'precision': 0.62557757, 'recall': 0.8336864, 'specificity': 0.8336864, 'f1': 0.670735, 'auroc': 0.8949549, 'binary_precision': 0.26132223, 'binary_recall': 0.7459138, 'binary_specificity': 0.921459, 'binary_f1_score': 0.38704705}
confusion matrix:
       0     1
0  16648  1419
1    171   502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8951015, 'precision': 0.6267596, 'recall': 0.86250293, 'specificity': 0.86250293, 'f1': 0.6701634, 'auroc': 0.93668413, 'binary_precision': 0.26187575, 'binary_recall': 0.8269231, 'binary_specificity': 0.89808273, 'binary_f1_score': 0.39777982}
confusion matrix:
      0    1
0  5340  606
1    45  215
early stop counter: 4
val acc:0.915154755115509, best validation acc: 0.925987184047699, corresponding to test acc:                         0.917015790939331 / 0.9262004494667053
after epoch: 15,now: 2024-07-31 12:27:16.575449,epoch time: 0:18:50.991981,used: 4:27:04.600801,model: dset_te_center0_erm_no_git_version_2024md_07md_31_08_00_11_seed_1_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 4:27:04.600801 at 2024-07-31 12:27:16.575449
persisted model performance metric: 

scalar performance:
{'acc': 0.9170158, 'precision': 0.6506662, 'recall': 0.86290526, 'specificity': 0.86290526, 'f1': 0.7015763, 'auroc': 0.9287789, 'binary_precision': 0.31054977, 'binary_recall': 0.8038462, 'binary_specificity': 0.92196435, 'binary_f1_score': 0.44801712}
confusion matrix:
      0    1
0  5482  464
1    51  209
oracle model performance metric: 

scalar performance:
{'acc': 0.92620045, 'precision': 0.6364838, 'recall': 0.7426473, 'specificity': 0.7426473, 'f1': 0.67092097, 'auroc': 0.89256454, 'binary_precision': 0.29375, 'binary_recall': 0.5423077, 'binary_specificity': 0.9429869, 'binary_f1_score': 0.38108107}
confusion matrix:
      0    1
0  5607  339
1   119  141
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197546 KiB |   7837 MiB | 726302 GiB | 726302 GiB |
|       from large pool | 180067 KiB |   7813 MiB | 715274 GiB | 715274 GiB |
|       from small pool |  17479 KiB |     37 MiB |  11027 GiB |  11027 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197546 KiB |   7837 MiB | 726302 GiB | 726302 GiB |
|       from large pool | 180067 KiB |   7813 MiB | 715274 GiB | 715274 GiB |
|       from small pool |  17479 KiB |     37 MiB |  11027 GiB |  11027 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195459 KiB |   7835 MiB | 724305 GiB | 724305 GiB |
|       from large pool | 178979 KiB |   7812 MiB | 713302 GiB | 713302 GiB |
|       from small pool |  16480 KiB |     36 MiB |  11002 GiB |  11002 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8530 MiB |   8530 MiB |  16786 MiB |   8256 MiB |
|       from large pool |   8492 MiB |   8492 MiB |  16726 MiB |   8234 MiB |
|       from small pool |     38 MiB |     44 MiB |     60 MiB |     22 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  46166 KiB | 738183 KiB | 465437 GiB | 465437 GiB |
|       from large pool |  37021 KiB | 736500 KiB | 454399 GiB | 454399 GiB |
|       from small pool |   9145 KiB |  19176 KiB |  11037 GiB |  11037 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2954    |    7697    |  139716 K  |  139714 K  |
|       from large pool |      79    |     767    |   67375 K  |   67375 K  |
|       from small pool |    2875    |    7616    |   72341 K  |   72338 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2954    |    7697    |  139716 K  |  139714 K  |
|       from large pool |      79    |     767    |   67375 K  |   67375 K  |
|       from small pool |    2875    |    7616    |   72341 K  |   72338 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     371    |     716    |     348    |
|       from large pool |     349    |     349    |     686    |     337    |
|       from small pool |      19    |      22    |      30    |      11    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3626    |   81619 K  |   81619 K  |
|       from large pool |       9    |     352    |   49380 K  |   49380 K  |
|       from small pool |      27    |    3616    |   32238 K  |   32238 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7837 MiB | 726302 GiB | 726302 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 715274 GiB | 715274 GiB |
|       from small pool |      0 KiB |     37 MiB |  11027 GiB |  11027 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7837 MiB | 726302 GiB | 726302 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 715274 GiB | 715274 GiB |
|       from small pool |      0 KiB |     37 MiB |  11027 GiB |  11027 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7835 MiB | 724305 GiB | 724305 GiB |
|       from large pool |  16640 KiB |   7812 MiB | 713302 GiB | 713302 GiB |
|       from small pool |      0 KiB |     36 MiB |  11002 GiB |  11002 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 243712 KiB |   8530 MiB |  16786 MiB |  16548 MiB |
|       from large pool | 217088 KiB |   8492 MiB |  16726 MiB |  16514 MiB |
|       from small pool |  26624 KiB |     44 MiB |     60 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 738183 KiB | 465437 GiB | 465437 GiB |
|       from large pool |  30464 KiB | 736500 KiB | 454400 GiB | 454400 GiB |
|       from small pool |      0 KiB |  22399 KiB |  11037 GiB |  11037 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  139716 K  |  139716 K  |
|       from large pool |       2    |     767    |   67375 K  |   67375 K  |
|       from small pool |       0    |    7616    |   72341 K  |   72341 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  139716 K  |  139716 K  |
|       from large pool |       2    |     767    |   67375 K  |   67375 K  |
|       from small pool |       0    |    7616    |   72341 K  |   72341 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     716    |     693    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      13    |      22    |      30    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3626    |   81621 K  |   81621 K  |
|       from large pool |       2    |     352    |   49380 K  |   49380 K  |
|       from small pool |       0    |    3616    |   32240 K  |   32240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7837 MiB | 726302 GiB | 726302 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 715274 GiB | 715274 GiB |
|       from small pool |      0 KiB |     37 MiB |  11027 GiB |  11027 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7837 MiB | 726302 GiB | 726302 GiB |
|       from large pool |  16640 KiB |   7813 MiB | 715274 GiB | 715274 GiB |
|       from small pool |      0 KiB |     37 MiB |  11027 GiB |  11027 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7835 MiB | 724305 GiB | 724305 GiB |
|       from large pool |  16640 KiB |   7812 MiB | 713302 GiB | 713302 GiB |
|       from small pool |      0 KiB |     36 MiB |  11002 GiB |  11002 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 243712 KiB |   8530 MiB |  16786 MiB |  16548 MiB |
|       from large pool | 217088 KiB |   8492 MiB |  16726 MiB |  16514 MiB |
|       from small pool |  26624 KiB |     44 MiB |     60 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 738183 KiB | 465437 GiB | 465437 GiB |
|       from large pool |  30464 KiB | 736500 KiB | 454400 GiB | 454400 GiB |
|       from small pool |      0 KiB |  22399 KiB |  11037 GiB |  11037 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7697    |  139716 K  |  139716 K  |
|       from large pool |       2    |     767    |   67375 K  |   67375 K  |
|       from small pool |       0    |    7616    |   72341 K  |   72341 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7697    |  139716 K  |  139716 K  |
|       from large pool |       2    |     767    |   67375 K  |   67375 K  |
|       from small pool |       0    |    7616    |   72341 K  |   72341 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     371    |     716    |     693    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      13    |      22    |      30    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3626    |   81621 K  |   81621 K  |
|       from large pool |       2    |     352    |   49380 K  |   49380 K  |
|       from small pool |       0    |    3616    |   32240 K  |   32240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/gizem.mert/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab



!!!: not committed yet
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



warning: Not a git repository. Use --no-index to compare two paths outside a working tree
usage: git diff --no-index [<options>] <path> <path>

Diff output format options
    -p, --patch           generate patch
    -s, --no-patch        suppress diff output
    -u                    generate patch
    -U, --unified[=<n>]   generate diffs with <n> lines context
    -W, --function-context
                          generate diffs with <n> lines context
    --raw                 generate the diff in raw format
    --patch-with-raw      synonym for '-p --raw'
    --patch-with-stat     synonym for '-p --stat'
    --numstat             machine friendly --stat
    --shortstat           output only the last line of --stat
    -X, --dirstat[=<param1,param2>...]
                          output the distribution of relative amount of changes for each sub-directory
    --cumulative          synonym for --dirstat=cumulative
    --dirstat-by-file[=<param1,param2>...]
                          synonym for --dirstat=files,param1,param2...
    --check               warn if changes introduce conflict markers or whitespace errors
    --summary             condensed summary such as creations, renames and mode changes
    --name-only           show only names of changed files
    --name-status         show only names and status of changed files
    --stat[=<width>[,<name-width>[,<count>]]]
                          generate diffstat
    --stat-width <width>  generate diffstat with a given width
    --stat-name-width <width>
                          generate diffstat with a given name width
    --stat-graph-width <width>
                          generate diffstat with a given graph width
    --stat-count <count>  generate diffstat with limited lines
    --compact-summary     generate compact summary in diffstat
    --binary              output a binary diff that can be applied
    --full-index          show full pre- and post-image object names on the "index" lines
    --color[=<when>]      show colored diff
    --ws-error-highlight <kind>
                          highlight whitespace errors in the 'context', 'old' or 'new' lines in the diff
    -z                    do not munge pathnames and use NULs as output field terminators in --raw or --numstat
    --abbrev[=<n>]        use <n> digits to display object names
    --src-prefix <prefix>
                          show the given source prefix instead of "a/"
    --dst-prefix <prefix>
                          show the given destination prefix instead of "b/"
    --line-prefix <prefix>
                          prepend an additional prefix to every line of output
    --no-prefix           do not show any source or destination prefix
    --inter-hunk-context <n>
                          show context between diff hunks up to the specified number of lines
    --output-indicator-new <char>
                          specify the character to indicate a new line instead of '+'
    --output-indicator-old <char>
                          specify the character to indicate an old line instead of '-'
    --output-indicator-context <char>
                          specify the character to indicate a context instead of ' '

Diff rename options
    -B, --break-rewrites[=<n>[/<m>]]
                          break complete rewrite changes into pairs of delete and create
    -M, --find-renames[=<n>]
                          detect renames
    -D, --irreversible-delete
                          omit the preimage for deletes
    -C, --find-copies[=<n>]
                          detect copies
    --find-copies-harder  use unmodified files as source to find copies
    --no-renames          disable rename detection
    --rename-empty        use empty blobs as rename source
    --follow              continue listing the history of a file beyond renames
    -l <n>                prevent rename/copy detection if the number of rename/copy targets exceeds given limit

Diff algorithm options
    --minimal             produce the smallest possible diff
    -w, --ignore-all-space
                          ignore whitespace when comparing lines
    -b, --ignore-space-change
                          ignore changes in amount of whitespace
    --ignore-space-at-eol
                          ignore changes in whitespace at EOL
    --ignore-cr-at-eol    ignore carrier-return at the end of line
    --ignore-blank-lines  ignore changes whose lines are all blank
    -I, --ignore-matching-lines <regex>
                          ignore changes whose all lines match <regex>
    --indent-heuristic    heuristic to shift diff hunk boundaries for easy reading
    --patience            generate diff using the "patience diff" algorithm
    --histogram           generate diff using the "histogram diff" algorithm
    --diff-algorithm <algorithm>
                          choose a diff algorithm
    --anchored <text>     generate diff using the "anchored diff" algorithm
    --word-diff[=<mode>]  show word diff, using <mode> to delimit changed words
    --word-diff-regex <regex>
                          use <regex> to decide what a word is
    --color-words[=<regex>]
                          equivalent to --word-diff=color --word-diff-regex=<regex>
    --color-moved[=<mode>]
                          moved lines of code are colored differently
    --color-moved-ws <mode>
                          how white spaces are ignored in --color-moved

Other diff options
    --relative[=<prefix>]
                          when run from subdir, exclude changes outside and show relative paths
    -a, --text            treat all files as text
    -R                    swap two inputs, reverse the diff
    --exit-code           exit with 1 if there were differences, 0 otherwise
    --quiet               disable all output of the program
    --ext-diff            allow an external diff helper to be executed
    --textconv            run external text conversion filters when comparing binary files
    --ignore-submodules[=<when>]
                          ignore changes to submodules in the diff generation
    --submodule[=<format>]
                          specify how differences in submodules are shown
    --ita-invisible-in-index
                          hide 'git add -N' entries from the index
    --ita-visible-in-index
                          treat 'git add -N' entries as real in the index
    -S <string>           look for differences that change the number of occurrences of the specified string
    -G <regex>            look for differences that change the number of occurrences of the specified regex
    --pickaxe-all         show all changes in the changeset with -S or -G
    --pickaxe-regex       treat <string> in -S as extended POSIX regular expression
    -O <file>             control the order in which files appear in the output
    --rotate-to <path>    show the change in the specified path first
    --skip-to <path>      skip the output to the specified path
    --find-object <object-id>
                          look for differences that change the number of occurrences of the specified object
    --diff-filter [(A|C|D|M|R|T|U|X|B)...[*]]
                          select files by diff type
    --output <file>       output to a specific file

not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:26: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
fatal: detected dubious ownership in repository at '/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab'
To add an exception for this directory, call:

	git config --global --add safe.directory /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
not in a git repository
/ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab/domainlab/utils/get_git_tag.py:38: UserWarning: not in a git repository
  warnings.warn("not in a git repository")
model name: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385

 Experiment start at: 2024-07-31 12:37:02.424170
/home/aih/gizem.mert/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8621707, 'precision': 0.863891, 'recall': 0.8621766, 'specificity': 0.8621766, 'f1': 0.8620089, 'auroc': 0.9303069, 'binary_precision': 0.88895434, 'binary_recall': 0.8277944, 'binary_specificity': 0.8965588, 'binary_f1_score': 0.8572849}
confusion matrix:
       0      1
0  26132   3015
1   5021  24136
---- Validation: 
scalar performance:
{'acc': 0.8420604, 'precision': 0.544339, 'recall': 0.69195426, 'specificity': 0.69195426, 'f1': 0.54508686, 'auroc': 0.7547809, 'binary_precision': 0.1065601, 'binary_recall': 0.53156143, 'binary_specificity': 0.85234714, 'binary_f1_score': 0.1775312}
confusion matrix:
       0     1
0  15488  2683
1    282   320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6858471, 'precision': 0.50377274, 'recall': 0.52132916, 'specificity': 0.52132916, 'f1': 0.44437277, 'auroc': 0.5528122, 'binary_precision': 0.0440552, 'binary_recall': 0.3429752, 'binary_specificity': 0.6996832, 'binary_f1_score': 0.07808091}
confusion matrix:
      0     1
0  4196  1801
1   159    83
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-31 12:56:00.192584,epoch time: 0:18:57.768414,used: 0:18:57.768414,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9023909, 'precision': 0.90472686, 'recall': 0.9023987, 'specificity': 0.9023987, 'f1': 0.9022511, 'auroc': 0.9598675, 'binary_precision': 0.9355258, 'binary_recall': 0.864394, 'binary_specificity': 0.94040346, 'binary_f1_score': 0.8985543}
confusion matrix:
       0      1
0  27409   1737
1   3954  25204
---- Validation: 
scalar performance:
{'acc': 0.9081127, 'precision': 0.5660298, 'recall': 0.6674521, 'specificity': 0.6674521, 'f1': 0.58689666, 'auroc': 0.77584726, 'binary_precision': 0.15275201, 'binary_recall': 0.410299, 'binary_specificity': 0.92460513, 'binary_f1_score': 0.22262283}
confusion matrix:
       0     1
0  16801  1370
1    355   247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8281776, 'precision': 0.51655006, 'recall': 0.55769414, 'specificity': 0.55769414, 'f1': 0.50580716, 'auroc': 0.65879905, 'binary_precision': 0.06680585, 'binary_recall': 0.2644628, 'binary_specificity': 0.85092545, 'binary_f1_score': 0.10666666}
confusion matrix:
      0    1
0  5103  894
1   178   64
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-31 13:14:28.955447,epoch time: 0:18:28.762863,used: 0:37:26.531277,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92142904, 'precision': 0.92435265, 'recall': 0.9214405, 'specificity': 0.9214405, 'f1': 0.9212949, 'auroc': 0.9709122, 'binary_precision': 0.95964396, 'binary_recall': 0.879904, 'binary_specificity': 0.96297693, 'binary_f1_score': 0.9180457}
confusion matrix:
       0      1
0  28065   1079
1   3502  25658
---- Validation: 
scalar performance:
{'acc': 0.9203111, 'precision': 0.5766687, 'recall': 0.66732895, 'specificity': 0.66732895, 'f1': 0.60004616, 'auroc': 0.79151475, 'binary_precision': 0.17419825, 'binary_recall': 0.39700997, 'binary_specificity': 0.9376479, 'binary_f1_score': 0.24214792}
confusion matrix:
       0     1
0  17038  1133
1    363   239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8531816, 'precision': 0.53467983, 'recall': 0.6083727, 'specificity': 0.6083727, 'f1': 0.53652024, 'auroc': 0.72323966, 'binary_precision': 0.098809525, 'binary_recall': 0.3429752, 'binary_specificity': 0.87377024, 'binary_f1_score': 0.15341958}
confusion matrix:
      0    1
0  5240  757
1   159   83
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-31 13:33:09.710302,epoch time: 0:18:40.754855,used: 0:56:07.286132,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9333322, 'precision': 0.9352919, 'recall': 0.93334025, 'specificity': 0.93334025, 'f1': 0.93325794, 'auroc': 0.97780836, 'binary_precision': 0.96455884, 'binary_recall': 0.8997565, 'binary_specificity': 0.966924, 'binary_f1_score': 0.93103147}
confusion matrix:
       0      1
0  28181    964
1   2923  26236
---- Validation: 
scalar performance:
{'acc': 0.9260108, 'precision': 0.59044445, 'recall': 0.68954635, 'specificity': 0.68954635, 'f1': 0.6178454, 'auroc': 0.8074353, 'binary_precision': 0.20030464, 'binary_recall': 0.43687707, 'binary_specificity': 0.9422156, 'binary_f1_score': 0.27467364}
confusion matrix:
       0     1
0  17121  1050
1    339   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8608751, 'precision': 0.5527737, 'recall': 0.6659087, 'specificity': 0.6659087, 'f1': 0.5629993, 'auroc': 0.7713027, 'binary_precision': 0.13002364, 'binary_recall': 0.45454547, 'binary_specificity': 0.87727195, 'binary_f1_score': 0.20220588}
confusion matrix:
      0    1
0  5261  736
1   132  110
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-31 13:52:26.698194,epoch time: 0:19:16.987892,used: 1:15:24.274024,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9393352, 'precision': 0.94080335, 'recall': 0.9393412, 'specificity': 0.9393412, 'f1': 0.9392852, 'auroc': 0.9814329, 'binary_precision': 0.96629417, 'binary_recall': 0.9104534, 'binary_specificity': 0.96822894, 'binary_f1_score': 0.93754303}
confusion matrix:
       0      1
0  28220    926
1   2611  26547
---- Validation: 
scalar performance:
{'acc': 0.92302775, 'precision': 0.59407854, 'recall': 0.713703, 'specificity': 0.713703, 'f1': 0.62461734, 'auroc': 0.82247406, 'binary_precision': 0.20586182, 'binary_recall': 0.4900332, 'binary_specificity': 0.93737274, 'binary_f1_score': 0.2899263}
confusion matrix:
       0     1
0  17033  1138
1    307   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8494951, 'precision': 0.5573185, 'recall': 0.6996439, 'specificity': 0.6996439, 'f1': 0.5667976, 'auroc': 0.80473566, 'binary_precision': 0.13584118, 'binary_recall': 0.5371901, 'binary_specificity': 0.86209774, 'binary_f1_score': 0.21684736}
confusion matrix:
      0    1
0  5170  827
1   112  130
early stop counter: 1
val acc:0.923027753829956, best validation acc: 0.92601078748703, corresponding to test acc:                         0.860875129699707 / 0.860875129699707
after epoch: 5,now: 2024-07-31 14:12:41.740516,epoch time: 0:20:15.042322,used: 1:35:39.316346,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9426626, 'precision': 0.9444455, 'recall': 0.94266915, 'specificity': 0.94266915, 'f1': 0.9426056, 'auroc': 0.9837612, 'binary_precision': 0.97264636, 'binary_recall': 0.9109678, 'binary_specificity': 0.9743704, 'binary_f1_score': 0.9407972}
confusion matrix:
       0      1
0  28399    747
1   2596  26562
---- Validation: 
scalar performance:
{'acc': 0.9210036, 'precision': 0.5950347, 'recall': 0.7255061, 'specificity': 0.7255061, 'f1': 0.6268214, 'auroc': 0.8301517, 'binary_precision': 0.20691949, 'binary_recall': 0.5166113, 'binary_specificity': 0.934401, 'binary_f1_score': 0.29548693}
confusion matrix:
       0     1
0  16979  1192
1    291   311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84212214, 'precision': 0.56218386, 'recall': 0.731498, 'specificity': 0.731498, 'f1': 0.5715498, 'auroc': 0.8305944, 'binary_precision': 0.14244466, 'binary_recall': 0.61157024, 'binary_specificity': 0.8514257, 'binary_f1_score': 0.23106948}
confusion matrix:
      0    1
0  5106  891
1    94  148
early stop counter: 2
val acc:0.9210035800933838, best validation acc: 0.92601078748703, corresponding to test acc:                         0.860875129699707 / 0.860875129699707
after epoch: 6,now: 2024-07-31 14:33:17.978406,epoch time: 0:20:36.237890,used: 1:56:15.554236,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9469676, 'precision': 0.9483856, 'recall': 0.94697344, 'specificity': 0.94697344, 'f1': 0.9469261, 'auroc': 0.9863754, 'binary_precision': 0.9736517, 'binary_recall': 0.9188216, 'binary_specificity': 0.97512525, 'binary_f1_score': 0.9454424}
confusion matrix:
       0      1
0  28421    725
1   2367  26791
---- Validation: 
scalar performance:
{'acc': 0.9210036, 'precision': 0.59570134, 'recall': 0.7279153, 'specificity': 0.7279153, 'f1': 0.62781906, 'auroc': 0.8313706, 'binary_precision': 0.20808482, 'binary_recall': 0.5215947, 'binary_specificity': 0.9342359, 'binary_f1_score': 0.29748935}
confusion matrix:
       0     1
0  16976  1195
1    288   314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85109794, 'precision': 0.57417274, 'recall': 0.7718563, 'specificity': 0.7718563, 'f1': 0.5902312, 'auroc': 0.8522781, 'binary_precision': 0.16290481, 'binary_recall': 0.6859504, 'binary_specificity': 0.8577622, 'binary_f1_score': 0.2632831}
confusion matrix:
      0    1
0  5144  853
1    76  166
early stop counter: 3
val acc:0.9210035800933838, best validation acc: 0.92601078748703, corresponding to test acc:                         0.860875129699707 / 0.860875129699707
after epoch: 7,now: 2024-07-31 14:53:58.748584,epoch time: 0:20:40.770178,used: 2:16:56.324414,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9505523, 'precision': 0.95220864, 'recall': 0.95055854, 'specificity': 0.95055854, 'f1': 0.9505074, 'auroc': 0.98799884, 'binary_precision': 0.9796283, 'binary_recall': 0.92026204, 'binary_specificity': 0.980855, 'binary_f1_score': 0.94901764}
confusion matrix:
       0      1
0  28588    558
1   2325  26833
---- Validation: 
scalar performance:
{'acc': 0.9325627, 'precision': 0.61305267, 'recall': 0.7330833, 'specificity': 0.7330833, 'f1': 0.6476794, 'auroc': 0.83700395, 'binary_precision': 0.24263565, 'binary_recall': 0.5199336, 'binary_specificity': 0.94623303, 'binary_f1_score': 0.33086678}
confusion matrix:
       0    1
0  17194  977
1    289  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8724154, 'precision': 0.5861362, 'recall': 0.78096247, 'specificity': 0.78096247, 'f1': 0.61147654, 'auroc': 0.86397696, 'binary_precision': 0.18665159, 'binary_recall': 0.6818182, 'binary_specificity': 0.88010675, 'binary_f1_score': 0.29307282}
confusion matrix:
      0    1
0  5278  719
1    77  165
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-31 15:13:40.012452,epoch time: 0:19:41.263868,used: 2:36:37.588282,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9538454, 'precision': 0.9542996, 'recall': 0.9538492, 'specificity': 0.9538492, 'f1': 0.95383406, 'auroc': 0.9887724, 'binary_precision': 0.9687256, 'binary_recall': 0.93799514, 'binary_specificity': 0.9697032, 'binary_f1_score': 0.9531128}
confusion matrix:
       0      1
0  28262    883
1   1808  27351
---- Validation: 
scalar performance:
{'acc': 0.92105687, 'precision': 0.60136384, 'recall': 0.7488221, 'specificity': 0.7488221, 'f1': 0.6363201, 'auroc': 0.8403456, 'binary_precision': 0.21794872, 'binary_recall': 0.56478405, 'binary_specificity': 0.9328601, 'binary_f1_score': 0.31452358}
confusion matrix:
       0     1
0  16951  1220
1    262   340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85109794, 'precision': 0.58039594, 'recall': 0.8015974, 'specificity': 0.8015974, 'f1': 0.59868, 'auroc': 0.87301433, 'binary_precision': 0.17254528, 'binary_recall': 0.74793386, 'binary_specificity': 0.85526097, 'binary_f1_score': 0.28040278}
confusion matrix:
      0    1
0  5129  868
1    61  181
early stop counter: 1
val acc:0.921056866645813, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 9,now: 2024-07-31 15:33:41.218590,epoch time: 0:20:01.206138,used: 2:56:38.794420,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95466864, 'precision': 0.95589626, 'recall': 0.9546731, 'specificity': 0.9546731, 'f1': 0.9546384, 'auroc': 0.9898609, 'binary_precision': 0.97959626, 'binary_recall': 0.9286964, 'binary_specificity': 0.9806498, 'binary_f1_score': 0.95346755}
confusion matrix:
       0      1
0  28583    564
1   2079  27078
---- Validation: 
scalar performance:
{'acc': 0.92904705, 'precision': 0.6108813, 'recall': 0.74491906, 'specificity': 0.74491906, 'f1': 0.6469306, 'auroc': 0.84358305, 'binary_precision': 0.23741007, 'binary_recall': 0.5481728, 'binary_specificity': 0.9416653, 'binary_f1_score': 0.3313253}
confusion matrix:
       0     1
0  17111  1060
1    272   330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8693701, 'precision': 0.58977556, 'recall': 0.80515397, 'specificity': 0.80515397, 'f1': 0.6159672, 'auroc': 0.87911177, 'binary_precision': 0.19160387, 'binary_recall': 0.7355372, 'binary_specificity': 0.8747707, 'binary_f1_score': 0.30401364}
confusion matrix:
      0    1
0  5246  751
1    64  178
early stop counter: 2
val acc:0.9290470480918884, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 10,now: 2024-07-31 15:53:00.477033,epoch time: 0:19:19.258443,used: 3:15:58.052863,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95753294, 'precision': 0.958132, 'recall': 0.9575354, 'specificity': 0.9575354, 'f1': 0.95751923, 'auroc': 0.9905343, 'binary_precision': 0.9747331, 'binary_recall': 0.9394293, 'binary_specificity': 0.97564155, 'binary_f1_score': 0.95675564}
confusion matrix:
       0      1
0  28438    710
1   1766  27390
---- Validation: 
scalar performance:
{'acc': 0.92169607, 'precision': 0.6038733, 'recall': 0.7555766, 'specificity': 0.7555766, 'f1': 0.63989043, 'auroc': 0.8459345, 'binary_precision': 0.22250639, 'binary_recall': 0.5780731, 'binary_specificity': 0.9330802, 'binary_f1_score': 0.32132965}
confusion matrix:
       0     1
0  16955  1216
1    254   348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8533419, 'precision': 0.5827975, 'recall': 0.8087129, 'specificity': 0.8087129, 'f1': 0.6025474, 'auroc': 0.8826252, 'binary_precision': 0.17675312, 'binary_recall': 0.76033056, 'binary_specificity': 0.85709524, 'binary_f1_score': 0.28682774}
confusion matrix:
      0    1
0  5140  857
1    58  184
early stop counter: 3
val acc:0.9216960668563843, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 11,now: 2024-07-31 16:11:37.739882,epoch time: 0:18:37.262849,used: 3:34:35.315712,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9602257, 'precision': 0.96088946, 'recall': 0.96022964, 'specificity': 0.96022964, 'f1': 0.96021163, 'auroc': 0.9917586, 'binary_precision': 0.9784306, 'binary_recall': 0.9412168, 'binary_specificity': 0.97924244, 'binary_f1_score': 0.959463}
confusion matrix:
       0      1
0  28541    605
1   1714  27444
---- Validation: 
scalar performance:
{'acc': 0.92435944, 'precision': 0.6081864, 'recall': 0.7593616, 'specificity': 0.7593616, 'f1': 0.6453671, 'auroc': 0.8501049, 'binary_precision': 0.23092106, 'binary_recall': 0.58305645, 'binary_specificity': 0.93566674, 'binary_f1_score': 0.33082}
confusion matrix:
       0     1
0  17002  1169
1    251   351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8560667, 'precision': 0.58670175, 'recall': 0.8220267, 'specificity': 0.8220267, 'f1': 0.6085805, 'auroc': 0.887738, 'binary_precision': 0.18339768, 'binary_recall': 0.78512394, 'binary_specificity': 0.85892946, 'binary_f1_score': 0.2973396}
confusion matrix:
      0    1
0  5151  846
1    52  190
early stop counter: 4
val acc:0.9243594408035278, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 12,now: 2024-07-31 16:31:05.934754,epoch time: 0:19:28.194872,used: 3:54:03.510584,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9627298, 'precision': 0.96303976, 'recall': 0.9627325, 'specificity': 0.9627325, 'f1': 0.96272373, 'auroc': 0.9925769, 'binary_precision': 0.9750713, 'binary_recall': 0.9497565, 'binary_specificity': 0.9757085, 'binary_f1_score': 0.9622475}
confusion matrix:
       0      1
0  28438    708
1   1465  27693
---- Validation: 
scalar performance:
{'acc': 0.9099771, 'precision': 0.5926201, 'recall': 0.7599627, 'specificity': 0.7599627, 'f1': 0.62561756, 'auroc': 0.84695756, 'binary_precision': 0.19944751, 'binary_recall': 0.5996678, 'binary_specificity': 0.92025757, 'binary_f1_score': 0.29933664}
confusion matrix:
       0     1
0  16722  1449
1    241   361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82705563, 'precision': 0.5743971, 'recall': 0.8148668, 'specificity': 0.8148668, 'f1': 0.58324623, 'auroc': 0.8867264, 'binary_precision': 0.15836735, 'binary_recall': 0.8016529, 'binary_specificity': 0.8280807, 'binary_f1_score': 0.26448536}
confusion matrix:
      0     1
0  4966  1031
1    48   194
early stop counter: 5
val acc:0.9099770784378052, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 13,now: 2024-07-31 16:50:44.028152,epoch time: 0:19:38.093398,used: 4:13:41.603982,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96226674, 'precision': 0.9626658, 'recall': 0.96226877, 'specificity': 0.96226877, 'f1': 0.9622587, 'auroc': 0.99270576, 'binary_precision': 0.9762881, 'binary_recall': 0.947558, 'binary_specificity': 0.97697955, 'binary_f1_score': 0.9617085}
confusion matrix:
       0      1
0  28477    671
1   1529  27627
---- Validation: 
scalar performance:
{'acc': 0.920684, 'precision': 0.60211855, 'recall': 0.7534478, 'specificity': 0.7534478, 'f1': 0.63759094, 'auroc': 0.8483008, 'binary_precision': 0.21912603, 'binary_recall': 0.57475084, 'binary_specificity': 0.93214464, 'binary_f1_score': 0.31728566}
confusion matrix:
       0     1
0  16938  1233
1    256   346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8454881, 'precision': 0.5815377, 'recall': 0.8185067, 'specificity': 0.8185067, 'f1': 0.5986033, 'auroc': 0.889555, 'binary_precision': 0.17300725, 'binary_recall': 0.7892562, 'binary_specificity': 0.8477572, 'binary_f1_score': 0.28380385}
confusion matrix:
      0    1
0  5084  913
1    51  191
early stop counter: 6
val acc:0.9206839799880981, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 14,now: 2024-07-31 17:09:44.581091,epoch time: 0:19:00.552939,used: 4:32:42.156921,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96312433, 'precision': 0.96386933, 'recall': 0.9631298, 'specificity': 0.9631298, 'f1': 0.96310973, 'auroc': 0.9925827, 'binary_precision': 0.9825282, 'binary_recall': 0.9430384, 'binary_specificity': 0.98322123, 'binary_f1_score': 0.9623783}
confusion matrix:
       0      1
0  28655    489
1   1661  27499
---- Validation: 
scalar performance:
{'acc': 0.9150908, 'precision': 0.59863937, 'recall': 0.76421034, 'specificity': 0.76421034, 'f1': 0.6338402, 'auroc': 0.8536267, 'binary_precision': 0.2112922, 'binary_recall': 0.60299003, 'binary_specificity': 0.92543066, 'binary_f1_score': 0.31293103}
confusion matrix:
       0     1
0  16816  1355
1    239   363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83923703, 'precision': 0.5804735, 'recall': 0.8251687, 'specificity': 0.8251687, 'f1': 0.5952523, 'auroc': 0.8922188, 'binary_precision': 0.16999133, 'binary_recall': 0.80991733, 'binary_specificity': 0.8404202, 'binary_f1_score': 0.2810036}
confusion matrix:
      0    1
0  5040  957
1    46  196
early stop counter: 7
val acc:0.915090799331665, best validation acc: 0.9325627088546753, corresponding to test acc:                         0.8724154233932495 / 0.8724154233932495
after epoch: 15,now: 2024-07-31 17:29:38.332224,epoch time: 0:19:53.751133,used: 4:52:35.908054,model: dset_te_center0_erm_no_git_version_2024md_07md_31_12_37_02_seed_2_23775385
working direcotry: /ictstr01/groups/aih/sina.wendrich/MA_code/MA_thesis_new/DomainLab
Experiment finished at epoch: 15 with time: 4:52:35.908054 at 2024-07-31 17:29:38.332224
persisted model performance metric: 

scalar performance:
{'acc': 0.8724154, 'precision': 0.5861362, 'recall': 0.78096247, 'specificity': 0.78096247, 'f1': 0.61147654, 'auroc': 0.86397696, 'binary_precision': 0.18665159, 'binary_recall': 0.6818182, 'binary_specificity': 0.88010675, 'binary_f1_score': 0.29307282}
confusion matrix:
      0    1
0  5278  719
1    77  165
oracle model performance metric: 

scalar performance:
{'acc': 0.8724154, 'precision': 0.5861362, 'recall': 0.78096247, 'specificity': 0.78096247, 'f1': 0.61147654, 'auroc': 0.86397696, 'binary_precision': 0.18665159, 'binary_recall': 0.6818182, 'binary_specificity': 0.88010675, 'binary_f1_score': 0.29307282}
confusion matrix:
      0    1
0  5278  719
1    77  165
results aggregation path: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalancednew_center0_dinov2small_erm_irm_nofreeze_halffreeze_allfreeze_2024-07-31_03-06-46/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197552 KiB |   7837 MiB |   1079 TiB |   1079 TiB |
|       from large pool | 180067 KiB |   7813 MiB |   1063 TiB |   1063 TiB |
|       from small pool |  17485 KiB |     37 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 197552 KiB |   7837 MiB |   1079 TiB |   1079 TiB |
|       from large pool | 180067 KiB |   7813 MiB |   1063 TiB |   1063 TiB |
|       from small pool |  17485 KiB |     37 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195460 KiB |   7835 MiB |   1077 TiB |   1077 TiB |
|       from large pool | 178979 KiB |   7812 MiB |   1061 TiB |   1061 TiB |
|       from small pool |  16481 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8532 MiB |   8532 MiB |  25080 MiB |  16548 MiB |
|       from large pool |   8492 MiB |   8492 MiB |  25006 MiB |  16514 MiB |
|       from small pool |     40 MiB |     44 MiB |     74 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  44112 KiB | 738183 KiB | 696480 GiB | 696480 GiB |
|       from large pool |  37021 KiB | 736500 KiB | 679803 GiB | 679803 GiB |
|       from small pool |   7091 KiB |  22399 KiB |  16677 GiB |  16677 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2966    |    7783    |  211485 K  |  211482 K  |
|       from large pool |      79    |     767    |  102563 K  |  102563 K  |
|       from small pool |    2887    |    7702    |  108921 K  |  108918 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2966    |    7783    |  211485 K  |  211482 K  |
|       from large pool |      79    |     767    |  102563 K  |  102563 K  |
|       from small pool |    2887    |    7702    |  108921 K  |  108918 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     371    |    1062    |     693    |
|       from large pool |     349    |     349    |    1025    |     676    |
|       from small pool |      20    |      22    |      37    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    3665    |  124020 K  |  124020 K  |
|       from large pool |       9    |     352    |   75635 K  |   75635 K  |
|       from small pool |      27    |    3655    |   48385 K  |   48385 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7837 MiB |   1079 TiB |   1079 TiB |
|       from large pool |  16640 KiB |   7813 MiB |   1063 TiB |   1063 TiB |
|       from small pool |      0 KiB |     37 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7837 MiB |   1079 TiB |   1079 TiB |
|       from large pool |  16640 KiB |   7813 MiB |   1063 TiB |   1063 TiB |
|       from small pool |      0 KiB |     37 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7835 MiB |   1077 TiB |   1077 TiB |
|       from large pool |  16640 KiB |   7812 MiB |   1061 TiB |   1061 TiB |
|       from small pool |      0 KiB |     36 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 241664 KiB |   8532 MiB |  25080 MiB |  24844 MiB |
|       from large pool | 217088 KiB |   8492 MiB |  25006 MiB |  24794 MiB |
|       from small pool |  24576 KiB |     44 MiB |     74 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 738183 KiB | 696480 GiB | 696480 GiB |
|       from large pool |  30464 KiB | 736500 KiB | 679803 GiB | 679803 GiB |
|       from small pool |      0 KiB |  22399 KiB |  16677 GiB |  16677 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    7783    |  211485 K  |  211484 K  |
|       from large pool |       2    |     767    |  102563 K  |  102563 K  |
|       from small pool |       0    |    7702    |  108921 K  |  108921 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    7783    |  211485 K  |  211484 K  |
|       from large pool |       2    |     767    |  102563 K  |  102563 K  |
|       from small pool |       0    |    7702    |  108921 K  |  108921 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     371    |    1062    |    1040    |
|       from large pool |      10    |     349    |    1025    |    1015    |
|       from small pool |      12    |      22    |      37    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |    3665    |  124021 K  |  124021 K  |
|       from large pool |       2    |     352    |   75635 K  |   75635 K  |
|       from small pool |       0    |    3655    |   48386 K  |   48386 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Wed Jul 31 17:31:02 2024]
Finished job 0.
1 of 1 steps (100%) done
